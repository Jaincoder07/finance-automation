(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function lF(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ew={exports:{}},fp={},tw={exports:{}},Tt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var p0=Symbol.for("react.element"),cF=Symbol.for("react.portal"),uF=Symbol.for("react.fragment"),fF=Symbol.for("react.strict_mode"),dF=Symbol.for("react.profiler"),hF=Symbol.for("react.provider"),pF=Symbol.for("react.context"),mF=Symbol.for("react.forward_ref"),gF=Symbol.for("react.suspense"),xF=Symbol.for("react.memo"),vF=Symbol.for("react.lazy"),py=Symbol.iterator;function yF(t){return t===null||typeof t!="object"?null:(t=py&&t[py]||t["@@iterator"],typeof t=="function"?t:null)}var rw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},nw=Object.assign,iw={};function fu(t,e,r){this.props=t,this.context=e,this.refs=iw,this.updater=r||rw}fu.prototype.isReactComponent={};fu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};fu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function sw(){}sw.prototype=fu.prototype;function bx(t,e,r){this.props=t,this.context=e,this.refs=iw,this.updater=r||rw}var Rx=bx.prototype=new sw;Rx.constructor=bx;nw(Rx,fu.prototype);Rx.isPureReactComponent=!0;var my=Array.isArray,aw=Object.prototype.hasOwnProperty,Nx={current:null},ow={key:!0,ref:!0,__self:!0,__source:!0};function lw(t,e,r){var n,i={},s=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)aw.call(e,n)&&!ow.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:p0,type:t,key:s,ref:a,props:i,_owner:Nx.current}}function _F(t,e){return{$$typeof:p0,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Dx(t){return typeof t=="object"&&t!==null&&t.$$typeof===p0}function EF(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var gy=/\/+/g;function Jp(t,e){return typeof t=="object"&&t!==null&&t.key!=null?EF(""+t.key):e.toString(36)}function Wd(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case p0:case cF:a=!0}}if(a)return a=t,i=i(a),t=n===""?"."+Jp(a,0):n,my(i)?(r="",t!=null&&(r=t.replace(gy,"$&/")+"/"),Wd(i,e,r,"",function(c){return c})):i!=null&&(Dx(i)&&(i=_F(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(gy,"$&/")+"/")+t)),e.push(i)),1;if(a=0,n=n===""?".":n+":",my(t))for(var o=0;o<t.length;o++){s=t[o];var l=n+Jp(s,o);a+=Wd(s,e,r,l,i)}else if(l=yF(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=n+Jp(s,o++),a+=Wd(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function sd(t,e,r){if(t==null)return t;var n=[],i=0;return Wd(t,n,"","",function(s){return e.call(r,s,i++)}),n}function wF(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var pi={current:null},Hd={transition:null},TF={ReactCurrentDispatcher:pi,ReactCurrentBatchConfig:Hd,ReactCurrentOwner:Nx};function cw(){throw Error("act(...) is not supported in production builds of React.")}Tt.Children={map:sd,forEach:function(t,e,r){sd(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return sd(t,function(){e++}),e},toArray:function(t){return sd(t,function(e){return e})||[]},only:function(t){if(!Dx(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Tt.Component=fu;Tt.Fragment=uF;Tt.Profiler=dF;Tt.PureComponent=bx;Tt.StrictMode=fF;Tt.Suspense=gF;Tt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=TF;Tt.act=cw;Tt.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=nw({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=Nx.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)aw.call(e,l)&&!ow.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:p0,type:t.type,key:i,ref:s,props:n,_owner:a}};Tt.createContext=function(t){return t={$$typeof:pF,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:hF,_context:t},t.Consumer=t};Tt.createElement=lw;Tt.createFactory=function(t){var e=lw.bind(null,t);return e.type=t,e};Tt.createRef=function(){return{current:null}};Tt.forwardRef=function(t){return{$$typeof:mF,render:t}};Tt.isValidElement=Dx;Tt.lazy=function(t){return{$$typeof:vF,_payload:{_status:-1,_result:t},_init:wF}};Tt.memo=function(t,e){return{$$typeof:xF,type:t,compare:e===void 0?null:e}};Tt.startTransition=function(t){var e=Hd.transition;Hd.transition={};try{t()}finally{Hd.transition=e}};Tt.unstable_act=cw;Tt.useCallback=function(t,e){return pi.current.useCallback(t,e)};Tt.useContext=function(t){return pi.current.useContext(t)};Tt.useDebugValue=function(){};Tt.useDeferredValue=function(t){return pi.current.useDeferredValue(t)};Tt.useEffect=function(t,e){return pi.current.useEffect(t,e)};Tt.useId=function(){return pi.current.useId()};Tt.useImperativeHandle=function(t,e,r){return pi.current.useImperativeHandle(t,e,r)};Tt.useInsertionEffect=function(t,e){return pi.current.useInsertionEffect(t,e)};Tt.useLayoutEffect=function(t,e){return pi.current.useLayoutEffect(t,e)};Tt.useMemo=function(t,e){return pi.current.useMemo(t,e)};Tt.useReducer=function(t,e,r){return pi.current.useReducer(t,e,r)};Tt.useRef=function(t){return pi.current.useRef(t)};Tt.useState=function(t){return pi.current.useState(t)};Tt.useSyncExternalStore=function(t,e,r){return pi.current.useSyncExternalStore(t,e,r)};Tt.useTransition=function(){return pi.current.useTransition()};Tt.version="18.3.1";tw.exports=Tt;var ye=tw.exports;const $d=lF(ye);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SF=ye,AF=Symbol.for("react.element"),kF=Symbol.for("react.fragment"),CF=Object.prototype.hasOwnProperty,FF=SF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,IF={key:!0,ref:!0,__self:!0,__source:!0};function uw(t,e,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)CF.call(e,n)&&!IF.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:AF,type:t,key:s,ref:a,props:i,_owner:FF.current}}fp.Fragment=kF;fp.jsx=uw;fp.jsxs=uw;ew.exports=fp;var f=ew.exports,ng={},fw={exports:{}},$i={},dw={exports:{}},hw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Ee,Z){var Ce=Ee.length;Ee.push(Z);e:for(;0<Ce;){var Le=Ce-1>>>1,U=Ee[Le];if(0<i(U,Z))Ee[Le]=Z,Ee[Ce]=U,Ce=Le;else break e}}function r(Ee){return Ee.length===0?null:Ee[0]}function n(Ee){if(Ee.length===0)return null;var Z=Ee[0],Ce=Ee.pop();if(Ce!==Z){Ee[0]=Ce;e:for(var Le=0,U=Ee.length,G=U>>>1;Le<G;){var J=2*(Le+1)-1,q=Ee[J],he=J+1,Se=Ee[he];if(0>i(q,Ce))he<U&&0>i(Se,q)?(Ee[Le]=Se,Ee[he]=Ce,Le=he):(Ee[Le]=q,Ee[J]=Ce,Le=J);else if(he<U&&0>i(Se,Ce))Ee[Le]=Se,Ee[he]=Ce,Le=he;else break e}}return Z}function i(Ee,Z){var Ce=Ee.sortIndex-Z.sortIndex;return Ce!==0?Ce:Ee.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],c=[],d=1,h=null,p=3,g=!1,y=!1,x=!1,E=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(Ee){for(var Z=r(c);Z!==null;){if(Z.callback===null)n(c);else if(Z.startTime<=Ee)n(c),Z.sortIndex=Z.expirationTime,e(l,Z);else break;Z=r(c)}}function P(Ee){if(x=!1,_(Ee),!y)if(r(l)!==null)y=!0,be(W);else{var Z=r(c);Z!==null&&Ae(P,Z.startTime-Ee)}}function W(Ee,Z){y=!1,x&&(x=!1,T(F),F=-1),g=!0;var Ce=p;try{for(_(Z),h=r(l);h!==null&&(!(h.expirationTime>Z)||Ee&&!N());){var Le=h.callback;if(typeof Le=="function"){h.callback=null,p=h.priorityLevel;var U=Le(h.expirationTime<=Z);Z=t.unstable_now(),typeof U=="function"?h.callback=U:h===r(l)&&n(l),_(Z)}else n(l);h=r(l)}if(h!==null)var G=!0;else{var J=r(c);J!==null&&Ae(P,J.startTime-Z),G=!1}return G}finally{h=null,p=Ce,g=!1}}var j=!1,w=null,F=-1,S=5,b=-1;function N(){return!(t.unstable_now()-b<S)}function D(){if(w!==null){var Ee=t.unstable_now();b=Ee;var Z=!0;try{Z=w(!0,Ee)}finally{Z?R():(j=!1,w=null)}}else j=!1}var R;if(typeof A=="function")R=function(){A(D)};else if(typeof MessageChannel<"u"){var He=new MessageChannel,xe=He.port2;He.port1.onmessage=D,R=function(){xe.postMessage(null)}}else R=function(){E(D,0)};function be(Ee){w=Ee,j||(j=!0,R())}function Ae(Ee,Z){F=E(function(){Ee(t.unstable_now())},Z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Ee){Ee.callback=null},t.unstable_continueExecution=function(){y||g||(y=!0,be(W))},t.unstable_forceFrameRate=function(Ee){0>Ee||125<Ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<Ee?Math.floor(1e3/Ee):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(Ee){switch(p){case 1:case 2:case 3:var Z=3;break;default:Z=p}var Ce=p;p=Z;try{return Ee()}finally{p=Ce}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Ee,Z){switch(Ee){case 1:case 2:case 3:case 4:case 5:break;default:Ee=3}var Ce=p;p=Ee;try{return Z()}finally{p=Ce}},t.unstable_scheduleCallback=function(Ee,Z,Ce){var Le=t.unstable_now();switch(typeof Ce=="object"&&Ce!==null?(Ce=Ce.delay,Ce=typeof Ce=="number"&&0<Ce?Le+Ce:Le):Ce=Le,Ee){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=Ce+U,Ee={id:d++,callback:Z,priorityLevel:Ee,startTime:Ce,expirationTime:U,sortIndex:-1},Ce>Le?(Ee.sortIndex=Ce,e(c,Ee),r(l)===null&&Ee===r(c)&&(x?(T(F),F=-1):x=!0,Ae(P,Ce-Le))):(Ee.sortIndex=U,e(l,Ee),y||g||(y=!0,be(W))),Ee},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(Ee){var Z=p;return function(){var Ce=p;p=Z;try{return Ee.apply(this,arguments)}finally{p=Ce}}}})(hw);dw.exports=hw;var bF=dw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RF=ye,Wi=bF;function Pe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var pw=new Set,Cf={};function Vl(t,e){Gc(t,e),Gc(t+"Capture",e)}function Gc(t,e){for(Cf[t]=e,t=0;t<e.length;t++)pw.add(e[t])}var Oa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ig=Object.prototype.hasOwnProperty,NF=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,xy={},vy={};function DF(t){return ig.call(vy,t)?!0:ig.call(xy,t)?!1:NF.test(t)?vy[t]=!0:(xy[t]=!0,!1)}function PF(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function OF(t,e,r,n){if(e===null||typeof e>"u"||PF(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function mi(t,e,r,n,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var Dn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Dn[t]=new mi(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Dn[e]=new mi(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Dn[t]=new mi(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Dn[t]=new mi(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Dn[t]=new mi(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Dn[t]=new mi(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Dn[t]=new mi(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Dn[t]=new mi(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Dn[t]=new mi(t,5,!1,t.toLowerCase(),null,!1,!1)});var Px=/[\-:]([a-z])/g;function Ox(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Px,Ox);Dn[e]=new mi(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Px,Ox);Dn[e]=new mi(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Px,Ox);Dn[e]=new mi(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Dn[t]=new mi(t,1,!1,t.toLowerCase(),null,!1,!1)});Dn.xlinkHref=new mi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Dn[t]=new mi(t,1,!1,t.toLowerCase(),null,!0,!0)});function Mx(t,e,r,n){var i=Dn.hasOwnProperty(e)?Dn[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(OF(e,r,i,n)&&(r=null),n||i===null?DF(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var $a=RF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ad=Symbol.for("react.element"),xc=Symbol.for("react.portal"),vc=Symbol.for("react.fragment"),Lx=Symbol.for("react.strict_mode"),sg=Symbol.for("react.profiler"),mw=Symbol.for("react.provider"),gw=Symbol.for("react.context"),Bx=Symbol.for("react.forward_ref"),ag=Symbol.for("react.suspense"),og=Symbol.for("react.suspense_list"),jx=Symbol.for("react.memo"),lo=Symbol.for("react.lazy"),xw=Symbol.for("react.offscreen"),yy=Symbol.iterator;function Pu(t){return t===null||typeof t!="object"?null:(t=yy&&t[yy]||t["@@iterator"],typeof t=="function"?t:null)}var Fr=Object.assign,Zp;function Ku(t){if(Zp===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Zp=e&&e[1]||""}return`
`+Zp+t}var em=!1;function tm(t,e){if(!t||em)return"";em=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{em=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Ku(t):""}function MF(t){switch(t.tag){case 5:return Ku(t.type);case 16:return Ku("Lazy");case 13:return Ku("Suspense");case 19:return Ku("SuspenseList");case 0:case 2:case 15:return t=tm(t.type,!1),t;case 11:return t=tm(t.type.render,!1),t;case 1:return t=tm(t.type,!0),t;default:return""}}function lg(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case vc:return"Fragment";case xc:return"Portal";case sg:return"Profiler";case Lx:return"StrictMode";case ag:return"Suspense";case og:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case gw:return(t.displayName||"Context")+".Consumer";case mw:return(t._context.displayName||"Context")+".Provider";case Bx:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case jx:return e=t.displayName||null,e!==null?e:lg(t.type)||"Memo";case lo:e=t._payload,t=t._init;try{return lg(t(e))}catch{}}return null}function LF(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return lg(e);case 8:return e===Lx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Mo(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function vw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function BF(t){var e=vw(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function od(t){t._valueTracker||(t._valueTracker=BF(t))}function yw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=vw(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function fh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function cg(t,e){var r=e.checked;return Fr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function _y(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Mo(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function _w(t,e){e=e.checked,e!=null&&Mx(t,"checked",e,!1)}function ug(t,e){_w(t,e);var r=Mo(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?fg(t,e.type,r):e.hasOwnProperty("defaultValue")&&fg(t,e.type,Mo(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Ey(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function fg(t,e,r){(e!=="number"||fh(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Xu=Array.isArray;function Nc(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Mo(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function dg(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Pe(91));return Fr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function wy(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Pe(92));if(Xu(r)){if(1<r.length)throw Error(Pe(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Mo(r)}}function Ew(t,e){var r=Mo(e.value),n=Mo(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function Ty(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function ww(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function hg(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?ww(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ld,Tw=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ld=ld||document.createElement("div"),ld.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ld.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ff(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var sf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},jF=["Webkit","ms","Moz","O"];Object.keys(sf).forEach(function(t){jF.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),sf[e]=sf[t]})});function Sw(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||sf.hasOwnProperty(t)&&sf[t]?(""+e).trim():e+"px"}function Aw(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Sw(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var VF=Fr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function pg(t,e){if(e){if(VF[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Pe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Pe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Pe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Pe(62))}}function mg(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gg=null;function Vx(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var xg=null,Dc=null,Pc=null;function Sy(t){if(t=x0(t)){if(typeof xg!="function")throw Error(Pe(280));var e=t.stateNode;e&&(e=gp(e),xg(t.stateNode,t.type,e))}}function kw(t){Dc?Pc?Pc.push(t):Pc=[t]:Dc=t}function Cw(){if(Dc){var t=Dc,e=Pc;if(Pc=Dc=null,Sy(t),e)for(t=0;t<e.length;t++)Sy(e[t])}}function Fw(t,e){return t(e)}function Iw(){}var rm=!1;function bw(t,e,r){if(rm)return t(e,r);rm=!0;try{return Fw(t,e,r)}finally{rm=!1,(Dc!==null||Pc!==null)&&(Iw(),Cw())}}function If(t,e){var r=t.stateNode;if(r===null)return null;var n=gp(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Pe(231,e,typeof r));return r}var vg=!1;if(Oa)try{var Ou={};Object.defineProperty(Ou,"passive",{get:function(){vg=!0}}),window.addEventListener("test",Ou,Ou),window.removeEventListener("test",Ou,Ou)}catch{vg=!1}function UF(t,e,r,n,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(d){this.onError(d)}}var af=!1,dh=null,hh=!1,yg=null,zF={onError:function(t){af=!0,dh=t}};function WF(t,e,r,n,i,s,a,o,l){af=!1,dh=null,UF.apply(zF,arguments)}function HF(t,e,r,n,i,s,a,o,l){if(WF.apply(this,arguments),af){if(af){var c=dh;af=!1,dh=null}else throw Error(Pe(198));hh||(hh=!0,yg=c)}}function Ul(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function Rw(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Ay(t){if(Ul(t)!==t)throw Error(Pe(188))}function $F(t){var e=t.alternate;if(!e){if(e=Ul(t),e===null)throw Error(Pe(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Ay(i),t;if(s===n)return Ay(i),e;s=s.sibling}throw Error(Pe(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(Pe(189))}}if(r.alternate!==n)throw Error(Pe(190))}if(r.tag!==3)throw Error(Pe(188));return r.stateNode.current===r?t:e}function Nw(t){return t=$F(t),t!==null?Dw(t):null}function Dw(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Dw(t);if(e!==null)return e;t=t.sibling}return null}var Pw=Wi.unstable_scheduleCallback,ky=Wi.unstable_cancelCallback,GF=Wi.unstable_shouldYield,KF=Wi.unstable_requestPaint,Wr=Wi.unstable_now,XF=Wi.unstable_getCurrentPriorityLevel,Ux=Wi.unstable_ImmediatePriority,Ow=Wi.unstable_UserBlockingPriority,ph=Wi.unstable_NormalPriority,YF=Wi.unstable_LowPriority,Mw=Wi.unstable_IdlePriority,dp=null,Zs=null;function qF(t){if(Zs&&typeof Zs.onCommitFiberRoot=="function")try{Zs.onCommitFiberRoot(dp,t,void 0,(t.current.flags&128)===128)}catch{}}var Rs=Math.clz32?Math.clz32:ZF,QF=Math.log,JF=Math.LN2;function ZF(t){return t>>>=0,t===0?32:31-(QF(t)/JF|0)|0}var cd=64,ud=4194304;function Yu(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function mh(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=Yu(o):(s&=a,s!==0&&(n=Yu(s)))}else a=r&~i,a!==0?n=Yu(a):s!==0&&(n=Yu(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Rs(e),i=1<<r,n|=t[r],e&=~i;return n}function eI(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function tI(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-Rs(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=eI(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function _g(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Lw(){var t=cd;return cd<<=1,!(cd&4194240)&&(cd=64),t}function nm(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function m0(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Rs(e),t[e]=r}function rI(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-Rs(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function zx(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Rs(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var Kt=0;function Bw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var jw,Wx,Vw,Uw,zw,Eg=!1,fd=[],To=null,So=null,Ao=null,bf=new Map,Rf=new Map,uo=[],nI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Cy(t,e){switch(t){case"focusin":case"focusout":To=null;break;case"dragenter":case"dragleave":So=null;break;case"mouseover":case"mouseout":Ao=null;break;case"pointerover":case"pointerout":bf.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rf.delete(e.pointerId)}}function Mu(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=x0(e),e!==null&&Wx(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function iI(t,e,r,n,i){switch(e){case"focusin":return To=Mu(To,t,e,r,n,i),!0;case"dragenter":return So=Mu(So,t,e,r,n,i),!0;case"mouseover":return Ao=Mu(Ao,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return bf.set(s,Mu(bf.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Rf.set(s,Mu(Rf.get(s)||null,t,e,r,n,i)),!0}return!1}function Ww(t){var e=fl(t.target);if(e!==null){var r=Ul(e);if(r!==null){if(e=r.tag,e===13){if(e=Rw(r),e!==null){t.blockedOn=e,zw(t.priority,function(){Vw(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Gd(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=wg(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);gg=n,r.target.dispatchEvent(n),gg=null}else return e=x0(r),e!==null&&Wx(e),t.blockedOn=r,!1;e.shift()}return!0}function Fy(t,e,r){Gd(t)&&r.delete(e)}function sI(){Eg=!1,To!==null&&Gd(To)&&(To=null),So!==null&&Gd(So)&&(So=null),Ao!==null&&Gd(Ao)&&(Ao=null),bf.forEach(Fy),Rf.forEach(Fy)}function Lu(t,e){t.blockedOn===e&&(t.blockedOn=null,Eg||(Eg=!0,Wi.unstable_scheduleCallback(Wi.unstable_NormalPriority,sI)))}function Nf(t){function e(i){return Lu(i,t)}if(0<fd.length){Lu(fd[0],t);for(var r=1;r<fd.length;r++){var n=fd[r];n.blockedOn===t&&(n.blockedOn=null)}}for(To!==null&&Lu(To,t),So!==null&&Lu(So,t),Ao!==null&&Lu(Ao,t),bf.forEach(e),Rf.forEach(e),r=0;r<uo.length;r++)n=uo[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<uo.length&&(r=uo[0],r.blockedOn===null);)Ww(r),r.blockedOn===null&&uo.shift()}var Oc=$a.ReactCurrentBatchConfig,gh=!0;function aI(t,e,r,n){var i=Kt,s=Oc.transition;Oc.transition=null;try{Kt=1,Hx(t,e,r,n)}finally{Kt=i,Oc.transition=s}}function oI(t,e,r,n){var i=Kt,s=Oc.transition;Oc.transition=null;try{Kt=4,Hx(t,e,r,n)}finally{Kt=i,Oc.transition=s}}function Hx(t,e,r,n){if(gh){var i=wg(t,e,r,n);if(i===null)hm(t,e,n,xh,r),Cy(t,n);else if(iI(i,t,e,r,n))n.stopPropagation();else if(Cy(t,n),e&4&&-1<nI.indexOf(t)){for(;i!==null;){var s=x0(i);if(s!==null&&jw(s),s=wg(t,e,r,n),s===null&&hm(t,e,n,xh,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else hm(t,e,n,null,r)}}var xh=null;function wg(t,e,r,n){if(xh=null,t=Vx(n),t=fl(t),t!==null)if(e=Ul(t),e===null)t=null;else if(r=e.tag,r===13){if(t=Rw(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return xh=t,null}function Hw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(XF()){case Ux:return 1;case Ow:return 4;case ph:case YF:return 16;case Mw:return 536870912;default:return 16}default:return 16}}var xo=null,$x=null,Kd=null;function $w(){if(Kd)return Kd;var t,e=$x,r=e.length,n,i="value"in xo?xo.value:xo.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===i[s-n];n++);return Kd=i.slice(t,1<n?1-n:void 0)}function Xd(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function dd(){return!0}function Iy(){return!1}function Gi(t){function e(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?dd:Iy,this.isPropagationStopped=Iy,this}return Fr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=dd)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=dd)},persist:function(){},isPersistent:dd}),e}var du={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Gx=Gi(du),g0=Fr({},du,{view:0,detail:0}),lI=Gi(g0),im,sm,Bu,hp=Fr({},g0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Kx,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Bu&&(Bu&&t.type==="mousemove"?(im=t.screenX-Bu.screenX,sm=t.screenY-Bu.screenY):sm=im=0,Bu=t),im)},movementY:function(t){return"movementY"in t?t.movementY:sm}}),by=Gi(hp),cI=Fr({},hp,{dataTransfer:0}),uI=Gi(cI),fI=Fr({},g0,{relatedTarget:0}),am=Gi(fI),dI=Fr({},du,{animationName:0,elapsedTime:0,pseudoElement:0}),hI=Gi(dI),pI=Fr({},du,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),mI=Gi(pI),gI=Fr({},du,{data:0}),Ry=Gi(gI),xI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _I(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=yI[t])?!!e[t]:!1}function Kx(){return _I}var EI=Fr({},g0,{key:function(t){if(t.key){var e=xI[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Xd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?vI[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Kx,charCode:function(t){return t.type==="keypress"?Xd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Xd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),wI=Gi(EI),TI=Fr({},hp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ny=Gi(TI),SI=Fr({},g0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Kx}),AI=Gi(SI),kI=Fr({},du,{propertyName:0,elapsedTime:0,pseudoElement:0}),CI=Gi(kI),FI=Fr({},hp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),II=Gi(FI),bI=[9,13,27,32],Xx=Oa&&"CompositionEvent"in window,of=null;Oa&&"documentMode"in document&&(of=document.documentMode);var RI=Oa&&"TextEvent"in window&&!of,Gw=Oa&&(!Xx||of&&8<of&&11>=of),Dy=" ",Py=!1;function Kw(t,e){switch(t){case"keyup":return bI.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var yc=!1;function NI(t,e){switch(t){case"compositionend":return Xw(e);case"keypress":return e.which!==32?null:(Py=!0,Dy);case"textInput":return t=e.data,t===Dy&&Py?null:t;default:return null}}function DI(t,e){if(yc)return t==="compositionend"||!Xx&&Kw(t,e)?(t=$w(),Kd=$x=xo=null,yc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Gw&&e.locale!=="ko"?null:e.data;default:return null}}var PI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Oy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!PI[t.type]:e==="textarea"}function Yw(t,e,r,n){kw(n),e=vh(e,"onChange"),0<e.length&&(r=new Gx("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var lf=null,Df=null;function OI(t){aT(t,0)}function pp(t){var e=wc(t);if(yw(e))return t}function MI(t,e){if(t==="change")return e}var qw=!1;if(Oa){var om;if(Oa){var lm="oninput"in document;if(!lm){var My=document.createElement("div");My.setAttribute("oninput","return;"),lm=typeof My.oninput=="function"}om=lm}else om=!1;qw=om&&(!document.documentMode||9<document.documentMode)}function Ly(){lf&&(lf.detachEvent("onpropertychange",Qw),Df=lf=null)}function Qw(t){if(t.propertyName==="value"&&pp(Df)){var e=[];Yw(e,Df,t,Vx(t)),bw(OI,e)}}function LI(t,e,r){t==="focusin"?(Ly(),lf=e,Df=r,lf.attachEvent("onpropertychange",Qw)):t==="focusout"&&Ly()}function BI(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return pp(Df)}function jI(t,e){if(t==="click")return pp(e)}function VI(t,e){if(t==="input"||t==="change")return pp(e)}function UI(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Os=typeof Object.is=="function"?Object.is:UI;function Pf(t,e){if(Os(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!ig.call(e,i)||!Os(t[i],e[i]))return!1}return!0}function By(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function jy(t,e){var r=By(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=By(r)}}function Jw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Jw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Zw(){for(var t=window,e=fh();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=fh(t.document)}return e}function Yx(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function zI(t){var e=Zw(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&Jw(r.ownerDocument.documentElement,r)){if(n!==null&&Yx(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=jy(r,s);var a=jy(r,n);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var WI=Oa&&"documentMode"in document&&11>=document.documentMode,_c=null,Tg=null,cf=null,Sg=!1;function Vy(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Sg||_c==null||_c!==fh(n)||(n=_c,"selectionStart"in n&&Yx(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),cf&&Pf(cf,n)||(cf=n,n=vh(Tg,"onSelect"),0<n.length&&(e=new Gx("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=_c)))}function hd(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Ec={animationend:hd("Animation","AnimationEnd"),animationiteration:hd("Animation","AnimationIteration"),animationstart:hd("Animation","AnimationStart"),transitionend:hd("Transition","TransitionEnd")},cm={},eT={};Oa&&(eT=document.createElement("div").style,"AnimationEvent"in window||(delete Ec.animationend.animation,delete Ec.animationiteration.animation,delete Ec.animationstart.animation),"TransitionEvent"in window||delete Ec.transitionend.transition);function mp(t){if(cm[t])return cm[t];if(!Ec[t])return t;var e=Ec[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in eT)return cm[t]=e[r];return t}var tT=mp("animationend"),rT=mp("animationiteration"),nT=mp("animationstart"),iT=mp("transitionend"),sT=new Map,Uy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $o(t,e){sT.set(t,e),Vl(e,[t])}for(var um=0;um<Uy.length;um++){var fm=Uy[um],HI=fm.toLowerCase(),$I=fm[0].toUpperCase()+fm.slice(1);$o(HI,"on"+$I)}$o(tT,"onAnimationEnd");$o(rT,"onAnimationIteration");$o(nT,"onAnimationStart");$o("dblclick","onDoubleClick");$o("focusin","onFocus");$o("focusout","onBlur");$o(iT,"onTransitionEnd");Gc("onMouseEnter",["mouseout","mouseover"]);Gc("onMouseLeave",["mouseout","mouseover"]);Gc("onPointerEnter",["pointerout","pointerover"]);Gc("onPointerLeave",["pointerout","pointerover"]);Vl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Vl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Vl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Vl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Vl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Vl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),GI=new Set("cancel close invalid load scroll toggle".split(" ").concat(qu));function zy(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,HF(n,e,void 0,t),t.currentTarget=null}function aT(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;zy(i,o,c),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;zy(i,o,c),s=l}}}if(hh)throw t=yg,hh=!1,yg=null,t}function ur(t,e){var r=e[Ig];r===void 0&&(r=e[Ig]=new Set);var n=t+"__bubble";r.has(n)||(oT(e,t,2,!1),r.add(n))}function dm(t,e,r){var n=0;e&&(n|=4),oT(r,t,n,e)}var pd="_reactListening"+Math.random().toString(36).slice(2);function Of(t){if(!t[pd]){t[pd]=!0,pw.forEach(function(r){r!=="selectionchange"&&(GI.has(r)||dm(r,!1,t),dm(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[pd]||(e[pd]=!0,dm("selectionchange",!1,e))}}function oT(t,e,r,n){switch(Hw(e)){case 1:var i=aI;break;case 4:i=oI;break;default:i=Hx}r=i.bind(null,e,r,t),i=void 0,!vg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function hm(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=fl(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}bw(function(){var c=s,d=Vx(r),h=[];e:{var p=sT.get(t);if(p!==void 0){var g=Gx,y=t;switch(t){case"keypress":if(Xd(r)===0)break e;case"keydown":case"keyup":g=wI;break;case"focusin":y="focus",g=am;break;case"focusout":y="blur",g=am;break;case"beforeblur":case"afterblur":g=am;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=by;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=uI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=AI;break;case tT:case rT:case nT:g=hI;break;case iT:g=CI;break;case"scroll":g=lI;break;case"wheel":g=II;break;case"copy":case"cut":case"paste":g=mI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=Ny}var x=(e&4)!==0,E=!x&&t==="scroll",T=x?p!==null?p+"Capture":null:p;x=[];for(var A=c,_;A!==null;){_=A;var P=_.stateNode;if(_.tag===5&&P!==null&&(_=P,T!==null&&(P=If(A,T),P!=null&&x.push(Mf(A,P,_)))),E)break;A=A.return}0<x.length&&(p=new g(p,y,null,r,d),h.push({event:p,listeners:x}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",p&&r!==gg&&(y=r.relatedTarget||r.fromElement)&&(fl(y)||y[Ma]))break e;if((g||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,g?(y=r.relatedTarget||r.toElement,g=c,y=y?fl(y):null,y!==null&&(E=Ul(y),y!==E||y.tag!==5&&y.tag!==6)&&(y=null)):(g=null,y=c),g!==y)){if(x=by,P="onMouseLeave",T="onMouseEnter",A="mouse",(t==="pointerout"||t==="pointerover")&&(x=Ny,P="onPointerLeave",T="onPointerEnter",A="pointer"),E=g==null?p:wc(g),_=y==null?p:wc(y),p=new x(P,A+"leave",g,r,d),p.target=E,p.relatedTarget=_,P=null,fl(d)===c&&(x=new x(T,A+"enter",y,r,d),x.target=_,x.relatedTarget=E,P=x),E=P,g&&y)t:{for(x=g,T=y,A=0,_=x;_;_=cc(_))A++;for(_=0,P=T;P;P=cc(P))_++;for(;0<A-_;)x=cc(x),A--;for(;0<_-A;)T=cc(T),_--;for(;A--;){if(x===T||T!==null&&x===T.alternate)break t;x=cc(x),T=cc(T)}x=null}else x=null;g!==null&&Wy(h,p,g,x,!1),y!==null&&E!==null&&Wy(h,E,y,x,!0)}}e:{if(p=c?wc(c):window,g=p.nodeName&&p.nodeName.toLowerCase(),g==="select"||g==="input"&&p.type==="file")var W=MI;else if(Oy(p))if(qw)W=VI;else{W=BI;var j=LI}else(g=p.nodeName)&&g.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(W=jI);if(W&&(W=W(t,c))){Yw(h,W,r,d);break e}j&&j(t,p,c),t==="focusout"&&(j=p._wrapperState)&&j.controlled&&p.type==="number"&&fg(p,"number",p.value)}switch(j=c?wc(c):window,t){case"focusin":(Oy(j)||j.contentEditable==="true")&&(_c=j,Tg=c,cf=null);break;case"focusout":cf=Tg=_c=null;break;case"mousedown":Sg=!0;break;case"contextmenu":case"mouseup":case"dragend":Sg=!1,Vy(h,r,d);break;case"selectionchange":if(WI)break;case"keydown":case"keyup":Vy(h,r,d)}var w;if(Xx)e:{switch(t){case"compositionstart":var F="onCompositionStart";break e;case"compositionend":F="onCompositionEnd";break e;case"compositionupdate":F="onCompositionUpdate";break e}F=void 0}else yc?Kw(t,r)&&(F="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(F="onCompositionStart");F&&(Gw&&r.locale!=="ko"&&(yc||F!=="onCompositionStart"?F==="onCompositionEnd"&&yc&&(w=$w()):(xo=d,$x="value"in xo?xo.value:xo.textContent,yc=!0)),j=vh(c,F),0<j.length&&(F=new Ry(F,t,null,r,d),h.push({event:F,listeners:j}),w?F.data=w:(w=Xw(r),w!==null&&(F.data=w)))),(w=RI?NI(t,r):DI(t,r))&&(c=vh(c,"onBeforeInput"),0<c.length&&(d=new Ry("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:c}),d.data=w))}aT(h,e)})}function Mf(t,e,r){return{instance:t,listener:e,currentTarget:r}}function vh(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=If(t,r),s!=null&&n.unshift(Mf(t,s,i)),s=If(t,e),s!=null&&n.push(Mf(t,s,i))),t=t.return}return n}function cc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Wy(t,e,r,n,i){for(var s=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,i?(l=If(r,s),l!=null&&a.unshift(Mf(r,l,o))):i||(l=If(r,s),l!=null&&a.push(Mf(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var KI=/\r\n?/g,XI=/\u0000|\uFFFD/g;function Hy(t){return(typeof t=="string"?t:""+t).replace(KI,`
`).replace(XI,"")}function md(t,e,r){if(e=Hy(e),Hy(t)!==e&&r)throw Error(Pe(425))}function yh(){}var Ag=null,kg=null;function Cg(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Fg=typeof setTimeout=="function"?setTimeout:void 0,YI=typeof clearTimeout=="function"?clearTimeout:void 0,$y=typeof Promise=="function"?Promise:void 0,qI=typeof queueMicrotask=="function"?queueMicrotask:typeof $y<"u"?function(t){return $y.resolve(null).then(t).catch(QI)}:Fg;function QI(t){setTimeout(function(){throw t})}function pm(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),Nf(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Nf(e)}function ko(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Gy(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var hu=Math.random().toString(36).slice(2),Qs="__reactFiber$"+hu,Lf="__reactProps$"+hu,Ma="__reactContainer$"+hu,Ig="__reactEvents$"+hu,JI="__reactListeners$"+hu,ZI="__reactHandles$"+hu;function fl(t){var e=t[Qs];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Ma]||r[Qs]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Gy(t);t!==null;){if(r=t[Qs])return r;t=Gy(t)}return e}t=r,r=t.parentNode}return null}function x0(t){return t=t[Qs]||t[Ma],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function wc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Pe(33))}function gp(t){return t[Lf]||null}var bg=[],Tc=-1;function Go(t){return{current:t}}function dr(t){0>Tc||(t.current=bg[Tc],bg[Tc]=null,Tc--)}function rr(t,e){Tc++,bg[Tc]=t.current,t.current=e}var Lo={},Jn=Go(Lo),ki=Go(!1),Sl=Lo;function Kc(t,e){var r=t.type.contextTypes;if(!r)return Lo;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Ci(t){return t=t.childContextTypes,t!=null}function _h(){dr(ki),dr(Jn)}function Ky(t,e,r){if(Jn.current!==Lo)throw Error(Pe(168));rr(Jn,e),rr(ki,r)}function lT(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(Pe(108,LF(t)||"Unknown",i));return Fr({},r,n)}function Eh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Lo,Sl=Jn.current,rr(Jn,t),rr(ki,ki.current),!0}function Xy(t,e,r){var n=t.stateNode;if(!n)throw Error(Pe(169));r?(t=lT(t,e,Sl),n.__reactInternalMemoizedMergedChildContext=t,dr(ki),dr(Jn),rr(Jn,t)):dr(ki),rr(ki,r)}var Ta=null,xp=!1,mm=!1;function cT(t){Ta===null?Ta=[t]:Ta.push(t)}function eb(t){xp=!0,cT(t)}function Ko(){if(!mm&&Ta!==null){mm=!0;var t=0,e=Kt;try{var r=Ta;for(Kt=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Ta=null,xp=!1}catch(i){throw Ta!==null&&(Ta=Ta.slice(t+1)),Pw(Ux,Ko),i}finally{Kt=e,mm=!1}}return null}var Sc=[],Ac=0,wh=null,Th=0,is=[],ss=0,Al=null,Sa=1,Aa="";function al(t,e){Sc[Ac++]=Th,Sc[Ac++]=wh,wh=t,Th=e}function uT(t,e,r){is[ss++]=Sa,is[ss++]=Aa,is[ss++]=Al,Al=t;var n=Sa;t=Aa;var i=32-Rs(n)-1;n&=~(1<<i),r+=1;var s=32-Rs(e)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,Sa=1<<32-Rs(e)+i|r<<i|n,Aa=s+t}else Sa=1<<s|r<<i|n,Aa=t}function qx(t){t.return!==null&&(al(t,1),uT(t,1,0))}function Qx(t){for(;t===wh;)wh=Sc[--Ac],Sc[Ac]=null,Th=Sc[--Ac],Sc[Ac]=null;for(;t===Al;)Al=is[--ss],is[ss]=null,Aa=is[--ss],is[ss]=null,Sa=is[--ss],is[ss]=null}var Ui=null,Vi=null,yr=!1,Cs=null;function fT(t,e){var r=os(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Yy(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ui=t,Vi=ko(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ui=t,Vi=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Al!==null?{id:Sa,overflow:Aa}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=os(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Ui=t,Vi=null,!0):!1;default:return!1}}function Rg(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ng(t){if(yr){var e=Vi;if(e){var r=e;if(!Yy(t,e)){if(Rg(t))throw Error(Pe(418));e=ko(r.nextSibling);var n=Ui;e&&Yy(t,e)?fT(n,r):(t.flags=t.flags&-4097|2,yr=!1,Ui=t)}}else{if(Rg(t))throw Error(Pe(418));t.flags=t.flags&-4097|2,yr=!1,Ui=t}}}function qy(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ui=t}function gd(t){if(t!==Ui)return!1;if(!yr)return qy(t),yr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Cg(t.type,t.memoizedProps)),e&&(e=Vi)){if(Rg(t))throw dT(),Error(Pe(418));for(;e;)fT(t,e),e=ko(e.nextSibling)}if(qy(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Pe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Vi=ko(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Vi=null}}else Vi=Ui?ko(t.stateNode.nextSibling):null;return!0}function dT(){for(var t=Vi;t;)t=ko(t.nextSibling)}function Xc(){Vi=Ui=null,yr=!1}function Jx(t){Cs===null?Cs=[t]:Cs.push(t)}var tb=$a.ReactCurrentBatchConfig;function ju(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Pe(309));var n=r.stateNode}if(!n)throw Error(Pe(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(Pe(284));if(!r._owner)throw Error(Pe(290,t))}return t}function xd(t,e){throw t=Object.prototype.toString.call(e),Error(Pe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Qy(t){var e=t._init;return e(t._payload)}function hT(t){function e(T,A){if(t){var _=T.deletions;_===null?(T.deletions=[A],T.flags|=16):_.push(A)}}function r(T,A){if(!t)return null;for(;A!==null;)e(T,A),A=A.sibling;return null}function n(T,A){for(T=new Map;A!==null;)A.key!==null?T.set(A.key,A):T.set(A.index,A),A=A.sibling;return T}function i(T,A){return T=bo(T,A),T.index=0,T.sibling=null,T}function s(T,A,_){return T.index=_,t?(_=T.alternate,_!==null?(_=_.index,_<A?(T.flags|=2,A):_):(T.flags|=2,A)):(T.flags|=1048576,A)}function a(T){return t&&T.alternate===null&&(T.flags|=2),T}function o(T,A,_,P){return A===null||A.tag!==6?(A=wm(_,T.mode,P),A.return=T,A):(A=i(A,_),A.return=T,A)}function l(T,A,_,P){var W=_.type;return W===vc?d(T,A,_.props.children,P,_.key):A!==null&&(A.elementType===W||typeof W=="object"&&W!==null&&W.$$typeof===lo&&Qy(W)===A.type)?(P=i(A,_.props),P.ref=ju(T,A,_),P.return=T,P):(P=th(_.type,_.key,_.props,null,T.mode,P),P.ref=ju(T,A,_),P.return=T,P)}function c(T,A,_,P){return A===null||A.tag!==4||A.stateNode.containerInfo!==_.containerInfo||A.stateNode.implementation!==_.implementation?(A=Tm(_,T.mode,P),A.return=T,A):(A=i(A,_.children||[]),A.return=T,A)}function d(T,A,_,P,W){return A===null||A.tag!==7?(A=xl(_,T.mode,P,W),A.return=T,A):(A=i(A,_),A.return=T,A)}function h(T,A,_){if(typeof A=="string"&&A!==""||typeof A=="number")return A=wm(""+A,T.mode,_),A.return=T,A;if(typeof A=="object"&&A!==null){switch(A.$$typeof){case ad:return _=th(A.type,A.key,A.props,null,T.mode,_),_.ref=ju(T,null,A),_.return=T,_;case xc:return A=Tm(A,T.mode,_),A.return=T,A;case lo:var P=A._init;return h(T,P(A._payload),_)}if(Xu(A)||Pu(A))return A=xl(A,T.mode,_,null),A.return=T,A;xd(T,A)}return null}function p(T,A,_,P){var W=A!==null?A.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return W!==null?null:o(T,A,""+_,P);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case ad:return _.key===W?l(T,A,_,P):null;case xc:return _.key===W?c(T,A,_,P):null;case lo:return W=_._init,p(T,A,W(_._payload),P)}if(Xu(_)||Pu(_))return W!==null?null:d(T,A,_,P,null);xd(T,_)}return null}function g(T,A,_,P,W){if(typeof P=="string"&&P!==""||typeof P=="number")return T=T.get(_)||null,o(A,T,""+P,W);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case ad:return T=T.get(P.key===null?_:P.key)||null,l(A,T,P,W);case xc:return T=T.get(P.key===null?_:P.key)||null,c(A,T,P,W);case lo:var j=P._init;return g(T,A,_,j(P._payload),W)}if(Xu(P)||Pu(P))return T=T.get(_)||null,d(A,T,P,W,null);xd(A,P)}return null}function y(T,A,_,P){for(var W=null,j=null,w=A,F=A=0,S=null;w!==null&&F<_.length;F++){w.index>F?(S=w,w=null):S=w.sibling;var b=p(T,w,_[F],P);if(b===null){w===null&&(w=S);break}t&&w&&b.alternate===null&&e(T,w),A=s(b,A,F),j===null?W=b:j.sibling=b,j=b,w=S}if(F===_.length)return r(T,w),yr&&al(T,F),W;if(w===null){for(;F<_.length;F++)w=h(T,_[F],P),w!==null&&(A=s(w,A,F),j===null?W=w:j.sibling=w,j=w);return yr&&al(T,F),W}for(w=n(T,w);F<_.length;F++)S=g(w,T,F,_[F],P),S!==null&&(t&&S.alternate!==null&&w.delete(S.key===null?F:S.key),A=s(S,A,F),j===null?W=S:j.sibling=S,j=S);return t&&w.forEach(function(N){return e(T,N)}),yr&&al(T,F),W}function x(T,A,_,P){var W=Pu(_);if(typeof W!="function")throw Error(Pe(150));if(_=W.call(_),_==null)throw Error(Pe(151));for(var j=W=null,w=A,F=A=0,S=null,b=_.next();w!==null&&!b.done;F++,b=_.next()){w.index>F?(S=w,w=null):S=w.sibling;var N=p(T,w,b.value,P);if(N===null){w===null&&(w=S);break}t&&w&&N.alternate===null&&e(T,w),A=s(N,A,F),j===null?W=N:j.sibling=N,j=N,w=S}if(b.done)return r(T,w),yr&&al(T,F),W;if(w===null){for(;!b.done;F++,b=_.next())b=h(T,b.value,P),b!==null&&(A=s(b,A,F),j===null?W=b:j.sibling=b,j=b);return yr&&al(T,F),W}for(w=n(T,w);!b.done;F++,b=_.next())b=g(w,T,F,b.value,P),b!==null&&(t&&b.alternate!==null&&w.delete(b.key===null?F:b.key),A=s(b,A,F),j===null?W=b:j.sibling=b,j=b);return t&&w.forEach(function(D){return e(T,D)}),yr&&al(T,F),W}function E(T,A,_,P){if(typeof _=="object"&&_!==null&&_.type===vc&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case ad:e:{for(var W=_.key,j=A;j!==null;){if(j.key===W){if(W=_.type,W===vc){if(j.tag===7){r(T,j.sibling),A=i(j,_.props.children),A.return=T,T=A;break e}}else if(j.elementType===W||typeof W=="object"&&W!==null&&W.$$typeof===lo&&Qy(W)===j.type){r(T,j.sibling),A=i(j,_.props),A.ref=ju(T,j,_),A.return=T,T=A;break e}r(T,j);break}else e(T,j);j=j.sibling}_.type===vc?(A=xl(_.props.children,T.mode,P,_.key),A.return=T,T=A):(P=th(_.type,_.key,_.props,null,T.mode,P),P.ref=ju(T,A,_),P.return=T,T=P)}return a(T);case xc:e:{for(j=_.key;A!==null;){if(A.key===j)if(A.tag===4&&A.stateNode.containerInfo===_.containerInfo&&A.stateNode.implementation===_.implementation){r(T,A.sibling),A=i(A,_.children||[]),A.return=T,T=A;break e}else{r(T,A);break}else e(T,A);A=A.sibling}A=Tm(_,T.mode,P),A.return=T,T=A}return a(T);case lo:return j=_._init,E(T,A,j(_._payload),P)}if(Xu(_))return y(T,A,_,P);if(Pu(_))return x(T,A,_,P);xd(T,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,A!==null&&A.tag===6?(r(T,A.sibling),A=i(A,_),A.return=T,T=A):(r(T,A),A=wm(_,T.mode,P),A.return=T,T=A),a(T)):r(T,A)}return E}var Yc=hT(!0),pT=hT(!1),Sh=Go(null),Ah=null,kc=null,Zx=null;function e1(){Zx=kc=Ah=null}function t1(t){var e=Sh.current;dr(Sh),t._currentValue=e}function Dg(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Mc(t,e){Ah=t,Zx=kc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ai=!0),t.firstContext=null)}function us(t){var e=t._currentValue;if(Zx!==t)if(t={context:t,memoizedValue:e,next:null},kc===null){if(Ah===null)throw Error(Pe(308));kc=t,Ah.dependencies={lanes:0,firstContext:t}}else kc=kc.next=t;return e}var dl=null;function r1(t){dl===null?dl=[t]:dl.push(t)}function mT(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,r1(e)):(r.next=i.next,i.next=r),e.interleaved=r,La(t,n)}function La(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var co=!1;function n1(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function gT(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ba(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Co(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Dt&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,La(t,r)}return i=n.interleaved,i===null?(e.next=e,r1(n)):(e.next=i.next,i.next=e),n.interleaved=e,La(t,r)}function Yd(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,zx(t,r)}}function Jy(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function kh(t,e,r,n){var i=t.updateQueue;co=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var d=t.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==a&&(o===null?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;a=0,d=c=l=null,o=s;do{var p=o.lane,g=o.eventTime;if((n&p)===p){d!==null&&(d=d.next={eventTime:g,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=t,x=o;switch(p=e,g=r,x.tag){case 1:if(y=x.payload,typeof y=="function"){h=y.call(g,h,p);break e}h=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=x.payload,p=typeof y=="function"?y.call(g,h,p):y,p==null)break e;h=Fr({},h,p);break e;case 2:co=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,p=i.effects,p===null?i.effects=[o]:p.push(o))}else g={eventTime:g,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(c=d=g,l=h):d=d.next=g,a|=p;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;p=o,o=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(d===null&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Cl|=a,t.lanes=a,t.memoizedState=h}}function Zy(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Pe(191,i));i.call(n)}}}var v0={},ea=Go(v0),Bf=Go(v0),jf=Go(v0);function hl(t){if(t===v0)throw Error(Pe(174));return t}function i1(t,e){switch(rr(jf,e),rr(Bf,t),rr(ea,v0),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:hg(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=hg(e,t)}dr(ea),rr(ea,e)}function qc(){dr(ea),dr(Bf),dr(jf)}function xT(t){hl(jf.current);var e=hl(ea.current),r=hg(e,t.type);e!==r&&(rr(Bf,t),rr(ea,r))}function s1(t){Bf.current===t&&(dr(ea),dr(Bf))}var Sr=Go(0);function Ch(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var gm=[];function a1(){for(var t=0;t<gm.length;t++)gm[t]._workInProgressVersionPrimary=null;gm.length=0}var qd=$a.ReactCurrentDispatcher,xm=$a.ReactCurrentBatchConfig,kl=0,Cr=null,sn=null,xn=null,Fh=!1,uf=!1,Vf=0,rb=0;function Vn(){throw Error(Pe(321))}function o1(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Os(t[r],e[r]))return!1;return!0}function l1(t,e,r,n,i,s){if(kl=s,Cr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,qd.current=t===null||t.memoizedState===null?ab:ob,t=r(n,i),uf){s=0;do{if(uf=!1,Vf=0,25<=s)throw Error(Pe(301));s+=1,xn=sn=null,e.updateQueue=null,qd.current=lb,t=r(n,i)}while(uf)}if(qd.current=Ih,e=sn!==null&&sn.next!==null,kl=0,xn=sn=Cr=null,Fh=!1,e)throw Error(Pe(300));return t}function c1(){var t=Vf!==0;return Vf=0,t}function qs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xn===null?Cr.memoizedState=xn=t:xn=xn.next=t,xn}function fs(){if(sn===null){var t=Cr.alternate;t=t!==null?t.memoizedState:null}else t=sn.next;var e=xn===null?Cr.memoizedState:xn.next;if(e!==null)xn=e,sn=t;else{if(t===null)throw Error(Pe(310));sn=t,t={memoizedState:sn.memoizedState,baseState:sn.baseState,baseQueue:sn.baseQueue,queue:sn.queue,next:null},xn===null?Cr.memoizedState=xn=t:xn=xn.next=t}return xn}function Uf(t,e){return typeof e=="function"?e(t):e}function vm(t){var e=fs(),r=e.queue;if(r===null)throw Error(Pe(311));r.lastRenderedReducer=t;var n=sn,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,c=s;do{var d=c.lane;if((kl&d)===d)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,a=n):l=l.next=h,Cr.lanes|=d,Cl|=d}c=c.next}while(c!==null&&c!==s);l===null?a=n:l.next=o,Os(n,e.memoizedState)||(Ai=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,Cr.lanes|=s,Cl|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function ym(t){var e=fs(),r=e.queue;if(r===null)throw Error(Pe(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);Os(s,e.memoizedState)||(Ai=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function vT(){}function yT(t,e){var r=Cr,n=fs(),i=e(),s=!Os(n.memoizedState,i);if(s&&(n.memoizedState=i,Ai=!0),n=n.queue,u1(wT.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||xn!==null&&xn.memoizedState.tag&1){if(r.flags|=2048,zf(9,ET.bind(null,r,n,i,e),void 0,null),_n===null)throw Error(Pe(349));kl&30||_T(r,e,i)}return i}function _T(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Cr.updateQueue,e===null?(e={lastEffect:null,stores:null},Cr.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function ET(t,e,r,n){e.value=r,e.getSnapshot=n,TT(e)&&ST(t)}function wT(t,e,r){return r(function(){TT(e)&&ST(t)})}function TT(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Os(t,r)}catch{return!0}}function ST(t){var e=La(t,1);e!==null&&Ns(e,t,1,-1)}function e_(t){var e=qs();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Uf,lastRenderedState:t},e.queue=t,t=t.dispatch=sb.bind(null,Cr,t),[e.memoizedState,t]}function zf(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Cr.updateQueue,e===null?(e={lastEffect:null,stores:null},Cr.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function AT(){return fs().memoizedState}function Qd(t,e,r,n){var i=qs();Cr.flags|=t,i.memoizedState=zf(1|e,r,void 0,n===void 0?null:n)}function vp(t,e,r,n){var i=fs();n=n===void 0?null:n;var s=void 0;if(sn!==null){var a=sn.memoizedState;if(s=a.destroy,n!==null&&o1(n,a.deps)){i.memoizedState=zf(e,r,s,n);return}}Cr.flags|=t,i.memoizedState=zf(1|e,r,s,n)}function t_(t,e){return Qd(8390656,8,t,e)}function u1(t,e){return vp(2048,8,t,e)}function kT(t,e){return vp(4,2,t,e)}function CT(t,e){return vp(4,4,t,e)}function FT(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function IT(t,e,r){return r=r!=null?r.concat([t]):null,vp(4,4,FT.bind(null,e,t),r)}function f1(){}function bT(t,e){var r=fs();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&o1(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function RT(t,e){var r=fs();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&o1(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function NT(t,e,r){return kl&21?(Os(r,e)||(r=Lw(),Cr.lanes|=r,Cl|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ai=!0),t.memoizedState=r)}function nb(t,e){var r=Kt;Kt=r!==0&&4>r?r:4,t(!0);var n=xm.transition;xm.transition={};try{t(!1),e()}finally{Kt=r,xm.transition=n}}function DT(){return fs().memoizedState}function ib(t,e,r){var n=Io(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},PT(t))OT(e,r);else if(r=mT(t,e,r,n),r!==null){var i=di();Ns(r,t,n,i),MT(r,e,n)}}function sb(t,e,r){var n=Io(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(PT(t))OT(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,Os(o,a)){var l=e.interleaved;l===null?(i.next=i,r1(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=mT(t,e,i,n),r!==null&&(i=di(),Ns(r,t,n,i),MT(r,e,n))}}function PT(t){var e=t.alternate;return t===Cr||e!==null&&e===Cr}function OT(t,e){uf=Fh=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function MT(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,zx(t,r)}}var Ih={readContext:us,useCallback:Vn,useContext:Vn,useEffect:Vn,useImperativeHandle:Vn,useInsertionEffect:Vn,useLayoutEffect:Vn,useMemo:Vn,useReducer:Vn,useRef:Vn,useState:Vn,useDebugValue:Vn,useDeferredValue:Vn,useTransition:Vn,useMutableSource:Vn,useSyncExternalStore:Vn,useId:Vn,unstable_isNewReconciler:!1},ab={readContext:us,useCallback:function(t,e){return qs().memoizedState=[t,e===void 0?null:e],t},useContext:us,useEffect:t_,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Qd(4194308,4,FT.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Qd(4194308,4,t,e)},useInsertionEffect:function(t,e){return Qd(4,2,t,e)},useMemo:function(t,e){var r=qs();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=qs();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=ib.bind(null,Cr,t),[n.memoizedState,t]},useRef:function(t){var e=qs();return t={current:t},e.memoizedState=t},useState:e_,useDebugValue:f1,useDeferredValue:function(t){return qs().memoizedState=t},useTransition:function(){var t=e_(!1),e=t[0];return t=nb.bind(null,t[1]),qs().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Cr,i=qs();if(yr){if(r===void 0)throw Error(Pe(407));r=r()}else{if(r=e(),_n===null)throw Error(Pe(349));kl&30||_T(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,t_(wT.bind(null,n,s,t),[t]),n.flags|=2048,zf(9,ET.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=qs(),e=_n.identifierPrefix;if(yr){var r=Aa,n=Sa;r=(n&~(1<<32-Rs(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Vf++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=rb++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},ob={readContext:us,useCallback:bT,useContext:us,useEffect:u1,useImperativeHandle:IT,useInsertionEffect:kT,useLayoutEffect:CT,useMemo:RT,useReducer:vm,useRef:AT,useState:function(){return vm(Uf)},useDebugValue:f1,useDeferredValue:function(t){var e=fs();return NT(e,sn.memoizedState,t)},useTransition:function(){var t=vm(Uf)[0],e=fs().memoizedState;return[t,e]},useMutableSource:vT,useSyncExternalStore:yT,useId:DT,unstable_isNewReconciler:!1},lb={readContext:us,useCallback:bT,useContext:us,useEffect:u1,useImperativeHandle:IT,useInsertionEffect:kT,useLayoutEffect:CT,useMemo:RT,useReducer:ym,useRef:AT,useState:function(){return ym(Uf)},useDebugValue:f1,useDeferredValue:function(t){var e=fs();return sn===null?e.memoizedState=t:NT(e,sn.memoizedState,t)},useTransition:function(){var t=ym(Uf)[0],e=fs().memoizedState;return[t,e]},useMutableSource:vT,useSyncExternalStore:yT,useId:DT,unstable_isNewReconciler:!1};function As(t,e){if(t&&t.defaultProps){e=Fr({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Pg(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Fr({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var yp={isMounted:function(t){return(t=t._reactInternals)?Ul(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=di(),i=Io(t),s=ba(n,i);s.payload=e,r!=null&&(s.callback=r),e=Co(t,s,i),e!==null&&(Ns(e,t,i,n),Yd(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=di(),i=Io(t),s=ba(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=Co(t,s,i),e!==null&&(Ns(e,t,i,n),Yd(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=di(),n=Io(t),i=ba(r,n);i.tag=2,e!=null&&(i.callback=e),e=Co(t,i,n),e!==null&&(Ns(e,t,n,r),Yd(e,t,n))}};function r_(t,e,r,n,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,a):e.prototype&&e.prototype.isPureReactComponent?!Pf(r,n)||!Pf(i,s):!0}function LT(t,e,r){var n=!1,i=Lo,s=e.contextType;return typeof s=="object"&&s!==null?s=us(s):(i=Ci(e)?Sl:Jn.current,n=e.contextTypes,s=(n=n!=null)?Kc(t,i):Lo),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=yp,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function n_(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&yp.enqueueReplaceState(e,e.state,null)}function Og(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},n1(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=us(s):(s=Ci(e)?Sl:Jn.current,i.context=Kc(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Pg(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&yp.enqueueReplaceState(i,i.state,null),kh(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Qc(t,e){try{var r="",n=e;do r+=MF(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function _m(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Mg(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var cb=typeof WeakMap=="function"?WeakMap:Map;function BT(t,e,r){r=ba(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Rh||(Rh=!0,Gg=n),Mg(t,e)},r}function jT(t,e,r){r=ba(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){Mg(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Mg(t,e),typeof n!="function"&&(Fo===null?Fo=new Set([this]):Fo.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function i_(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new cb;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=Tb.bind(null,t,e,r),e.then(t,t))}function s_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function a_(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=ba(-1,1),e.tag=2,Co(r,e,1))),r.lanes|=1),t)}var ub=$a.ReactCurrentOwner,Ai=!1;function ci(t,e,r,n){e.child=t===null?pT(e,null,r,n):Yc(e,t.child,r,n)}function o_(t,e,r,n,i){r=r.render;var s=e.ref;return Mc(e,i),n=l1(t,e,r,n,s,i),r=c1(),t!==null&&!Ai?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ba(t,e,i)):(yr&&r&&qx(e),e.flags|=1,ci(t,e,n,i),e.child)}function l_(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!y1(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,VT(t,e,s,n,i)):(t=th(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:Pf,r(a,n)&&t.ref===e.ref)return Ba(t,e,i)}return e.flags|=1,t=bo(s,n),t.ref=e.ref,t.return=e,e.child=t}function VT(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(Pf(s,n)&&t.ref===e.ref)if(Ai=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(Ai=!0);else return e.lanes=t.lanes,Ba(t,e,i)}return Lg(t,e,r,n,i)}function UT(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},rr(Fc,Oi),Oi|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,rr(Fc,Oi),Oi|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,rr(Fc,Oi),Oi|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,rr(Fc,Oi),Oi|=n;return ci(t,e,i,r),e.child}function zT(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Lg(t,e,r,n,i){var s=Ci(r)?Sl:Jn.current;return s=Kc(e,s),Mc(e,i),r=l1(t,e,r,n,s,i),n=c1(),t!==null&&!Ai?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ba(t,e,i)):(yr&&n&&qx(e),e.flags|=1,ci(t,e,r,i),e.child)}function c_(t,e,r,n,i){if(Ci(r)){var s=!0;Eh(e)}else s=!1;if(Mc(e,i),e.stateNode===null)Jd(t,e),LT(e,r,n),Og(e,r,n,i),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=us(c):(c=Ci(r)?Sl:Jn.current,c=Kc(e,c));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&n_(e,a,n,c),co=!1;var p=e.memoizedState;a.state=p,kh(e,n,a,i),l=e.memoizedState,o!==n||p!==l||ki.current||co?(typeof d=="function"&&(Pg(e,r,d,n),l=e.memoizedState),(o=co||r_(e,r,o,n,p,l,c))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,gT(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:As(e.type,o),a.props=c,h=e.pendingProps,p=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=us(l):(l=Ci(r)?Sl:Jn.current,l=Kc(e,l));var g=r.getDerivedStateFromProps;(d=typeof g=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||p!==l)&&n_(e,a,n,l),co=!1,p=e.memoizedState,a.state=p,kh(e,n,a,i);var y=e.memoizedState;o!==h||p!==y||ki.current||co?(typeof g=="function"&&(Pg(e,r,g,n),y=e.memoizedState),(c=co||r_(e,r,c,n,p,y,l)||!1)?(d||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,y,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,y,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=y),a.props=n,a.state=y,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),n=!1)}return Bg(t,e,r,n,s,i)}function Bg(t,e,r,n,i,s){zT(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return i&&Xy(e,r,!1),Ba(t,e,s);n=e.stateNode,ub.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=Yc(e,t.child,null,s),e.child=Yc(e,null,o,s)):ci(t,e,o,s),e.memoizedState=n.state,i&&Xy(e,r,!0),e.child}function WT(t){var e=t.stateNode;e.pendingContext?Ky(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Ky(t,e.context,!1),i1(t,e.containerInfo)}function u_(t,e,r,n,i){return Xc(),Jx(i),e.flags|=256,ci(t,e,r,n),e.child}var jg={dehydrated:null,treeContext:null,retryLane:0};function Vg(t){return{baseLanes:t,cachePool:null,transitions:null}}function HT(t,e,r){var n=e.pendingProps,i=Sr.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),rr(Sr,i&1),t===null)return Ng(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,s?(n=e.mode,s=e.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=wp(a,n,0,null),t=xl(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Vg(r),e.memoizedState=jg,t):d1(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return fb(t,e,a,n,o,i,r);if(s){s=n.fallback,a=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=bo(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=bo(o,s):(s=xl(s,a,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,a=t.child.memoizedState,a=a===null?Vg(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~r,e.memoizedState=jg,n}return s=t.child,t=s.sibling,n=bo(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function d1(t,e){return e=wp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function vd(t,e,r,n){return n!==null&&Jx(n),Yc(e,t.child,null,r),t=d1(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function fb(t,e,r,n,i,s,a){if(r)return e.flags&256?(e.flags&=-257,n=_m(Error(Pe(422))),vd(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=wp({mode:"visible",children:n.children},i,0,null),s=xl(s,i,a,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&Yc(e,t.child,null,a),e.child.memoizedState=Vg(a),e.memoizedState=jg,s);if(!(e.mode&1))return vd(t,e,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(Pe(419)),n=_m(s,n,void 0),vd(t,e,a,n)}if(o=(a&t.childLanes)!==0,Ai||o){if(n=_n,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,La(t,i),Ns(n,t,i,-1))}return v1(),n=_m(Error(Pe(421))),vd(t,e,a,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=Sb.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Vi=ko(i.nextSibling),Ui=e,yr=!0,Cs=null,t!==null&&(is[ss++]=Sa,is[ss++]=Aa,is[ss++]=Al,Sa=t.id,Aa=t.overflow,Al=e),e=d1(e,n.children),e.flags|=4096,e)}function f_(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Dg(t.return,e,r)}function Em(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function $T(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(ci(t,e,n.children,r),n=Sr.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&f_(t,r,e);else if(t.tag===19)f_(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(rr(Sr,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&Ch(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),Em(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Ch(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}Em(e,!0,r,null,s);break;case"together":Em(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Jd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ba(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Cl|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Pe(153));if(e.child!==null){for(t=e.child,r=bo(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=bo(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function db(t,e,r){switch(e.tag){case 3:WT(e),Xc();break;case 5:xT(e);break;case 1:Ci(e.type)&&Eh(e);break;case 4:i1(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;rr(Sh,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(rr(Sr,Sr.current&1),e.flags|=128,null):r&e.child.childLanes?HT(t,e,r):(rr(Sr,Sr.current&1),t=Ba(t,e,r),t!==null?t.sibling:null);rr(Sr,Sr.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return $T(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),rr(Sr,Sr.current),n)break;return null;case 22:case 23:return e.lanes=0,UT(t,e,r)}return Ba(t,e,r)}var GT,Ug,KT,XT;GT=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Ug=function(){};KT=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,hl(ea.current);var s=null;switch(r){case"input":i=cg(t,i),n=cg(t,n),s=[];break;case"select":i=Fr({},i,{value:void 0}),n=Fr({},n,{value:void 0}),s=[];break;case"textarea":i=dg(t,i),n=dg(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=yh)}pg(r,n);var a;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Cf.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Cf.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&ur("scroll",t),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};XT=function(t,e,r,n){r!==n&&(e.flags|=4)};function Vu(t,e){if(!yr)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Un(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function hb(t,e,r){var n=e.pendingProps;switch(Qx(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Un(e),null;case 1:return Ci(e.type)&&_h(),Un(e),null;case 3:return n=e.stateNode,qc(),dr(ki),dr(Jn),a1(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(gd(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Cs!==null&&(Yg(Cs),Cs=null))),Ug(t,e),Un(e),null;case 5:s1(e);var i=hl(jf.current);if(r=e.type,t!==null&&e.stateNode!=null)KT(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Pe(166));return Un(e),null}if(t=hl(ea.current),gd(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[Qs]=e,n[Lf]=s,t=(e.mode&1)!==0,r){case"dialog":ur("cancel",n),ur("close",n);break;case"iframe":case"object":case"embed":ur("load",n);break;case"video":case"audio":for(i=0;i<qu.length;i++)ur(qu[i],n);break;case"source":ur("error",n);break;case"img":case"image":case"link":ur("error",n),ur("load",n);break;case"details":ur("toggle",n);break;case"input":_y(n,s),ur("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},ur("invalid",n);break;case"textarea":wy(n,s),ur("invalid",n)}pg(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&md(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&md(n.textContent,o,t),i=["children",""+o]):Cf.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&ur("scroll",n)}switch(r){case"input":od(n),Ey(n,s,!0);break;case"textarea":od(n),Ty(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=yh)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=ww(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[Qs]=e,t[Lf]=n,GT(t,e,!1,!1),e.stateNode=t;e:{switch(a=mg(r,n),r){case"dialog":ur("cancel",t),ur("close",t),i=n;break;case"iframe":case"object":case"embed":ur("load",t),i=n;break;case"video":case"audio":for(i=0;i<qu.length;i++)ur(qu[i],t);i=n;break;case"source":ur("error",t),i=n;break;case"img":case"image":case"link":ur("error",t),ur("load",t),i=n;break;case"details":ur("toggle",t),i=n;break;case"input":_y(t,n),i=cg(t,n),ur("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=Fr({},n,{value:void 0}),ur("invalid",t);break;case"textarea":wy(t,n),i=dg(t,n),ur("invalid",t);break;default:i=n}pg(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?Aw(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Tw(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Ff(t,l):typeof l=="number"&&Ff(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Cf.hasOwnProperty(s)?l!=null&&s==="onScroll"&&ur("scroll",t):l!=null&&Mx(t,s,l,a))}switch(r){case"input":od(t),Ey(t,n,!1);break;case"textarea":od(t),Ty(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Mo(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?Nc(t,!!n.multiple,s,!1):n.defaultValue!=null&&Nc(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=yh)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Un(e),null;case 6:if(t&&e.stateNode!=null)XT(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Pe(166));if(r=hl(jf.current),hl(ea.current),gd(e)){if(n=e.stateNode,r=e.memoizedProps,n[Qs]=e,(s=n.nodeValue!==r)&&(t=Ui,t!==null))switch(t.tag){case 3:md(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&md(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Qs]=e,e.stateNode=n}return Un(e),null;case 13:if(dr(Sr),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(yr&&Vi!==null&&e.mode&1&&!(e.flags&128))dT(),Xc(),e.flags|=98560,s=!1;else if(s=gd(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(Pe(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Pe(317));s[Qs]=e}else Xc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Un(e),s=!1}else Cs!==null&&(Yg(Cs),Cs=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Sr.current&1?ln===0&&(ln=3):v1())),e.updateQueue!==null&&(e.flags|=4),Un(e),null);case 4:return qc(),Ug(t,e),t===null&&Of(e.stateNode.containerInfo),Un(e),null;case 10:return t1(e.type._context),Un(e),null;case 17:return Ci(e.type)&&_h(),Un(e),null;case 19:if(dr(Sr),s=e.memoizedState,s===null)return Un(e),null;if(n=(e.flags&128)!==0,a=s.rendering,a===null)if(n)Vu(s,!1);else{if(ln!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Ch(t),a!==null){for(e.flags|=128,Vu(s,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return rr(Sr,Sr.current&1|2),e.child}t=t.sibling}s.tail!==null&&Wr()>Jc&&(e.flags|=128,n=!0,Vu(s,!1),e.lanes=4194304)}else{if(!n)if(t=Ch(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Vu(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!yr)return Un(e),null}else 2*Wr()-s.renderingStartTime>Jc&&r!==1073741824&&(e.flags|=128,n=!0,Vu(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(r=s.last,r!==null?r.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Wr(),e.sibling=null,r=Sr.current,rr(Sr,n?r&1|2:r&1),e):(Un(e),null);case 22:case 23:return x1(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Oi&1073741824&&(Un(e),e.subtreeFlags&6&&(e.flags|=8192)):Un(e),null;case 24:return null;case 25:return null}throw Error(Pe(156,e.tag))}function pb(t,e){switch(Qx(e),e.tag){case 1:return Ci(e.type)&&_h(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return qc(),dr(ki),dr(Jn),a1(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return s1(e),null;case 13:if(dr(Sr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Pe(340));Xc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return dr(Sr),null;case 4:return qc(),null;case 10:return t1(e.type._context),null;case 22:case 23:return x1(),null;case 24:return null;default:return null}}var yd=!1,Kn=!1,mb=typeof WeakSet=="function"?WeakSet:Set,qe=null;function Cc(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Mr(t,e,n)}else r.current=null}function zg(t,e,r){try{r()}catch(n){Mr(t,e,n)}}var d_=!1;function gb(t,e){if(Ag=gh,t=Zw(),Yx(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,d=0,h=t,p=null;t:for(;;){for(var g;h!==r||i!==0&&h.nodeType!==3||(o=a+i),h!==s||n!==0&&h.nodeType!==3||(l=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(g=h.firstChild)!==null;)p=h,h=g;for(;;){if(h===t)break t;if(p===r&&++c===i&&(o=a),p===s&&++d===n&&(l=a),(g=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=g}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(kg={focusedElem:t,selectionRange:r},gh=!1,qe=e;qe!==null;)if(e=qe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,qe=t;else for(;qe!==null;){e=qe;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var x=y.memoizedProps,E=y.memoizedState,T=e.stateNode,A=T.getSnapshotBeforeUpdate(e.elementType===e.type?x:As(e.type,x),E);T.__reactInternalSnapshotBeforeUpdate=A}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Pe(163))}}catch(P){Mr(e,e.return,P)}if(t=e.sibling,t!==null){t.return=e.return,qe=t;break}qe=e.return}return y=d_,d_=!1,y}function ff(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&zg(e,r,s)}i=i.next}while(i!==n)}}function _p(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Wg(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function YT(t){var e=t.alternate;e!==null&&(t.alternate=null,YT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Qs],delete e[Lf],delete e[Ig],delete e[JI],delete e[ZI])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function qT(t){return t.tag===5||t.tag===3||t.tag===4}function h_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||qT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Hg(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=yh));else if(n!==4&&(t=t.child,t!==null))for(Hg(t,e,r),t=t.sibling;t!==null;)Hg(t,e,r),t=t.sibling}function $g(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for($g(t,e,r),t=t.sibling;t!==null;)$g(t,e,r),t=t.sibling}var kn=null,ks=!1;function so(t,e,r){for(r=r.child;r!==null;)QT(t,e,r),r=r.sibling}function QT(t,e,r){if(Zs&&typeof Zs.onCommitFiberUnmount=="function")try{Zs.onCommitFiberUnmount(dp,r)}catch{}switch(r.tag){case 5:Kn||Cc(r,e);case 6:var n=kn,i=ks;kn=null,so(t,e,r),kn=n,ks=i,kn!==null&&(ks?(t=kn,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):kn.removeChild(r.stateNode));break;case 18:kn!==null&&(ks?(t=kn,r=r.stateNode,t.nodeType===8?pm(t.parentNode,r):t.nodeType===1&&pm(t,r),Nf(t)):pm(kn,r.stateNode));break;case 4:n=kn,i=ks,kn=r.stateNode.containerInfo,ks=!0,so(t,e,r),kn=n,ks=i;break;case 0:case 11:case 14:case 15:if(!Kn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&zg(r,e,a),i=i.next}while(i!==n)}so(t,e,r);break;case 1:if(!Kn&&(Cc(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Mr(r,e,o)}so(t,e,r);break;case 21:so(t,e,r);break;case 22:r.mode&1?(Kn=(n=Kn)||r.memoizedState!==null,so(t,e,r),Kn=n):so(t,e,r);break;default:so(t,e,r)}}function p_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new mb),e.forEach(function(n){var i=Ab.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Ts(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:kn=o.stateNode,ks=!1;break e;case 3:kn=o.stateNode.containerInfo,ks=!0;break e;case 4:kn=o.stateNode.containerInfo,ks=!0;break e}o=o.return}if(kn===null)throw Error(Pe(160));QT(s,a,i),kn=null,ks=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Mr(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)JT(e,t),e=e.sibling}function JT(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ts(e,t),Hs(t),n&4){try{ff(3,t,t.return),_p(3,t)}catch(x){Mr(t,t.return,x)}try{ff(5,t,t.return)}catch(x){Mr(t,t.return,x)}}break;case 1:Ts(e,t),Hs(t),n&512&&r!==null&&Cc(r,r.return);break;case 5:if(Ts(e,t),Hs(t),n&512&&r!==null&&Cc(r,r.return),t.flags&32){var i=t.stateNode;try{Ff(i,"")}catch(x){Mr(t,t.return,x)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=r!==null?r.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&_w(i,s),mg(o,a);var c=mg(o,s);for(a=0;a<l.length;a+=2){var d=l[a],h=l[a+1];d==="style"?Aw(i,h):d==="dangerouslySetInnerHTML"?Tw(i,h):d==="children"?Ff(i,h):Mx(i,d,h,c)}switch(o){case"input":ug(i,s);break;case"textarea":Ew(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var g=s.value;g!=null?Nc(i,!!s.multiple,g,!1):p!==!!s.multiple&&(s.defaultValue!=null?Nc(i,!!s.multiple,s.defaultValue,!0):Nc(i,!!s.multiple,s.multiple?[]:"",!1))}i[Lf]=s}catch(x){Mr(t,t.return,x)}}break;case 6:if(Ts(e,t),Hs(t),n&4){if(t.stateNode===null)throw Error(Pe(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(x){Mr(t,t.return,x)}}break;case 3:if(Ts(e,t),Hs(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Nf(e.containerInfo)}catch(x){Mr(t,t.return,x)}break;case 4:Ts(e,t),Hs(t);break;case 13:Ts(e,t),Hs(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(m1=Wr())),n&4&&p_(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(Kn=(c=Kn)||d,Ts(e,t),Kn=c):Ts(e,t),Hs(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(qe=t,d=t.child;d!==null;){for(h=qe=d;qe!==null;){switch(p=qe,g=p.child,p.tag){case 0:case 11:case 14:case 15:ff(4,p,p.return);break;case 1:Cc(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){n=p,r=p.return;try{e=n,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(x){Mr(n,r,x)}}break;case 5:Cc(p,p.return);break;case 22:if(p.memoizedState!==null){g_(h);continue}}g!==null?(g.return=p,qe=g):g_(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{i=h.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Sw("display",a))}catch(x){Mr(t,t.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(x){Mr(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Ts(e,t),Hs(t),n&4&&p_(t);break;case 21:break;default:Ts(e,t),Hs(t)}}function Hs(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(qT(r)){var n=r;break e}r=r.return}throw Error(Pe(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Ff(i,""),n.flags&=-33);var s=h_(t);$g(t,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=h_(t);Hg(t,o,a);break;default:throw Error(Pe(161))}}catch(l){Mr(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function xb(t,e,r){qe=t,ZT(t)}function ZT(t,e,r){for(var n=(t.mode&1)!==0;qe!==null;){var i=qe,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||yd;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||Kn;o=yd;var c=Kn;if(yd=a,(Kn=l)&&!c)for(qe=i;qe!==null;)a=qe,l=a.child,a.tag===22&&a.memoizedState!==null?x_(i):l!==null?(l.return=a,qe=l):x_(i);for(;s!==null;)qe=s,ZT(s),s=s.sibling;qe=i,yd=o,Kn=c}m_(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,qe=s):m_(t)}}function m_(t){for(;qe!==null;){var e=qe;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Kn||_p(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Kn)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:As(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Zy(e,s,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Zy(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Nf(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Pe(163))}Kn||e.flags&512&&Wg(e)}catch(p){Mr(e,e.return,p)}}if(e===t){qe=null;break}if(r=e.sibling,r!==null){r.return=e.return,qe=r;break}qe=e.return}}function g_(t){for(;qe!==null;){var e=qe;if(e===t){qe=null;break}var r=e.sibling;if(r!==null){r.return=e.return,qe=r;break}qe=e.return}}function x_(t){for(;qe!==null;){var e=qe;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{_p(4,e)}catch(l){Mr(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){Mr(e,i,l)}}var s=e.return;try{Wg(e)}catch(l){Mr(e,s,l)}break;case 5:var a=e.return;try{Wg(e)}catch(l){Mr(e,a,l)}}}catch(l){Mr(e,e.return,l)}if(e===t){qe=null;break}var o=e.sibling;if(o!==null){o.return=e.return,qe=o;break}qe=e.return}}var vb=Math.ceil,bh=$a.ReactCurrentDispatcher,h1=$a.ReactCurrentOwner,ls=$a.ReactCurrentBatchConfig,Dt=0,_n=null,en=null,Rn=0,Oi=0,Fc=Go(0),ln=0,Wf=null,Cl=0,Ep=0,p1=0,df=null,Si=null,m1=0,Jc=1/0,wa=null,Rh=!1,Gg=null,Fo=null,_d=!1,vo=null,Nh=0,hf=0,Kg=null,Zd=-1,eh=0;function di(){return Dt&6?Wr():Zd!==-1?Zd:Zd=Wr()}function Io(t){return t.mode&1?Dt&2&&Rn!==0?Rn&-Rn:tb.transition!==null?(eh===0&&(eh=Lw()),eh):(t=Kt,t!==0||(t=window.event,t=t===void 0?16:Hw(t.type)),t):1}function Ns(t,e,r,n){if(50<hf)throw hf=0,Kg=null,Error(Pe(185));m0(t,r,n),(!(Dt&2)||t!==_n)&&(t===_n&&(!(Dt&2)&&(Ep|=r),ln===4&&fo(t,Rn)),Fi(t,n),r===1&&Dt===0&&!(e.mode&1)&&(Jc=Wr()+500,xp&&Ko()))}function Fi(t,e){var r=t.callbackNode;tI(t,e);var n=mh(t,t===_n?Rn:0);if(n===0)r!==null&&ky(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&ky(r),e===1)t.tag===0?eb(v_.bind(null,t)):cT(v_.bind(null,t)),qI(function(){!(Dt&6)&&Ko()}),r=null;else{switch(Bw(n)){case 1:r=Ux;break;case 4:r=Ow;break;case 16:r=ph;break;case 536870912:r=Mw;break;default:r=ph}r=oS(r,eS.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function eS(t,e){if(Zd=-1,eh=0,Dt&6)throw Error(Pe(327));var r=t.callbackNode;if(Lc()&&t.callbackNode!==r)return null;var n=mh(t,t===_n?Rn:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Dh(t,n);else{e=n;var i=Dt;Dt|=2;var s=rS();(_n!==t||Rn!==e)&&(wa=null,Jc=Wr()+500,gl(t,e));do try{Eb();break}catch(o){tS(t,o)}while(!0);e1(),bh.current=s,Dt=i,en!==null?e=0:(_n=null,Rn=0,e=ln)}if(e!==0){if(e===2&&(i=_g(t),i!==0&&(n=i,e=Xg(t,i))),e===1)throw r=Wf,gl(t,0),fo(t,n),Fi(t,Wr()),r;if(e===6)fo(t,n);else{if(i=t.current.alternate,!(n&30)&&!yb(i)&&(e=Dh(t,n),e===2&&(s=_g(t),s!==0&&(n=s,e=Xg(t,s))),e===1))throw r=Wf,gl(t,0),fo(t,n),Fi(t,Wr()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(Pe(345));case 2:ol(t,Si,wa);break;case 3:if(fo(t,n),(n&130023424)===n&&(e=m1+500-Wr(),10<e)){if(mh(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){di(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Fg(ol.bind(null,t,Si,wa),e);break}ol(t,Si,wa);break;case 4:if(fo(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var a=31-Rs(n);s=1<<a,a=e[a],a>i&&(i=a),n&=~s}if(n=i,n=Wr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*vb(n/1960))-n,10<n){t.timeoutHandle=Fg(ol.bind(null,t,Si,wa),n);break}ol(t,Si,wa);break;case 5:ol(t,Si,wa);break;default:throw Error(Pe(329))}}}return Fi(t,Wr()),t.callbackNode===r?eS.bind(null,t):null}function Xg(t,e){var r=df;return t.current.memoizedState.isDehydrated&&(gl(t,e).flags|=256),t=Dh(t,e),t!==2&&(e=Si,Si=r,e!==null&&Yg(e)),t}function Yg(t){Si===null?Si=t:Si.push.apply(Si,t)}function yb(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Os(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function fo(t,e){for(e&=~p1,e&=~Ep,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Rs(e),n=1<<r;t[r]=-1,e&=~n}}function v_(t){if(Dt&6)throw Error(Pe(327));Lc();var e=mh(t,0);if(!(e&1))return Fi(t,Wr()),null;var r=Dh(t,e);if(t.tag!==0&&r===2){var n=_g(t);n!==0&&(e=n,r=Xg(t,n))}if(r===1)throw r=Wf,gl(t,0),fo(t,e),Fi(t,Wr()),r;if(r===6)throw Error(Pe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ol(t,Si,wa),Fi(t,Wr()),null}function g1(t,e){var r=Dt;Dt|=1;try{return t(e)}finally{Dt=r,Dt===0&&(Jc=Wr()+500,xp&&Ko())}}function Fl(t){vo!==null&&vo.tag===0&&!(Dt&6)&&Lc();var e=Dt;Dt|=1;var r=ls.transition,n=Kt;try{if(ls.transition=null,Kt=1,t)return t()}finally{Kt=n,ls.transition=r,Dt=e,!(Dt&6)&&Ko()}}function x1(){Oi=Fc.current,dr(Fc)}function gl(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,YI(r)),en!==null)for(r=en.return;r!==null;){var n=r;switch(Qx(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&_h();break;case 3:qc(),dr(ki),dr(Jn),a1();break;case 5:s1(n);break;case 4:qc();break;case 13:dr(Sr);break;case 19:dr(Sr);break;case 10:t1(n.type._context);break;case 22:case 23:x1()}r=r.return}if(_n=t,en=t=bo(t.current,null),Rn=Oi=e,ln=0,Wf=null,p1=Ep=Cl=0,Si=df=null,dl!==null){for(e=0;e<dl.length;e++)if(r=dl[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}dl=null}return t}function tS(t,e){do{var r=en;try{if(e1(),qd.current=Ih,Fh){for(var n=Cr.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Fh=!1}if(kl=0,xn=sn=Cr=null,uf=!1,Vf=0,h1.current=null,r===null||r.return===null){ln=1,Wf=e,en=null;break}e:{var s=t,a=r.return,o=r,l=e;if(e=Rn,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,d=o,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var g=s_(a);if(g!==null){g.flags&=-257,a_(g,a,o,s,e),g.mode&1&&i_(s,c,e),e=g,l=c;var y=e.updateQueue;if(y===null){var x=new Set;x.add(l),e.updateQueue=x}else y.add(l);break e}else{if(!(e&1)){i_(s,c,e),v1();break e}l=Error(Pe(426))}}else if(yr&&o.mode&1){var E=s_(a);if(E!==null){!(E.flags&65536)&&(E.flags|=256),a_(E,a,o,s,e),Jx(Qc(l,o));break e}}s=l=Qc(l,o),ln!==4&&(ln=2),df===null?df=[s]:df.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var T=BT(s,l,e);Jy(s,T);break e;case 1:o=l;var A=s.type,_=s.stateNode;if(!(s.flags&128)&&(typeof A.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(Fo===null||!Fo.has(_)))){s.flags|=65536,e&=-e,s.lanes|=e;var P=jT(s,o,e);Jy(s,P);break e}}s=s.return}while(s!==null)}iS(r)}catch(W){e=W,en===r&&r!==null&&(en=r=r.return);continue}break}while(!0)}function rS(){var t=bh.current;return bh.current=Ih,t===null?Ih:t}function v1(){(ln===0||ln===3||ln===2)&&(ln=4),_n===null||!(Cl&268435455)&&!(Ep&268435455)||fo(_n,Rn)}function Dh(t,e){var r=Dt;Dt|=2;var n=rS();(_n!==t||Rn!==e)&&(wa=null,gl(t,e));do try{_b();break}catch(i){tS(t,i)}while(!0);if(e1(),Dt=r,bh.current=n,en!==null)throw Error(Pe(261));return _n=null,Rn=0,ln}function _b(){for(;en!==null;)nS(en)}function Eb(){for(;en!==null&&!GF();)nS(en)}function nS(t){var e=aS(t.alternate,t,Oi);t.memoizedProps=t.pendingProps,e===null?iS(t):en=e,h1.current=null}function iS(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=pb(r,e),r!==null){r.flags&=32767,en=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ln=6,en=null;return}}else if(r=hb(r,e,Oi),r!==null){en=r;return}if(e=e.sibling,e!==null){en=e;return}en=e=t}while(e!==null);ln===0&&(ln=5)}function ol(t,e,r){var n=Kt,i=ls.transition;try{ls.transition=null,Kt=1,wb(t,e,r,n)}finally{ls.transition=i,Kt=n}return null}function wb(t,e,r,n){do Lc();while(vo!==null);if(Dt&6)throw Error(Pe(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Pe(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(rI(t,s),t===_n&&(en=_n=null,Rn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||_d||(_d=!0,oS(ph,function(){return Lc(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=ls.transition,ls.transition=null;var a=Kt;Kt=1;var o=Dt;Dt|=4,h1.current=null,gb(t,r),JT(r,t),zI(kg),gh=!!Ag,kg=Ag=null,t.current=r,xb(r),KF(),Dt=o,Kt=a,ls.transition=s}else t.current=r;if(_d&&(_d=!1,vo=t,Nh=i),s=t.pendingLanes,s===0&&(Fo=null),qF(r.stateNode),Fi(t,Wr()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Rh)throw Rh=!1,t=Gg,Gg=null,t;return Nh&1&&t.tag!==0&&Lc(),s=t.pendingLanes,s&1?t===Kg?hf++:(hf=0,Kg=t):hf=0,Ko(),null}function Lc(){if(vo!==null){var t=Bw(Nh),e=ls.transition,r=Kt;try{if(ls.transition=null,Kt=16>t?16:t,vo===null)var n=!1;else{if(t=vo,vo=null,Nh=0,Dt&6)throw Error(Pe(331));var i=Dt;for(Dt|=4,qe=t.current;qe!==null;){var s=qe,a=s.child;if(qe.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(qe=c;qe!==null;){var d=qe;switch(d.tag){case 0:case 11:case 15:ff(8,d,s)}var h=d.child;if(h!==null)h.return=d,qe=h;else for(;qe!==null;){d=qe;var p=d.sibling,g=d.return;if(YT(d),d===c){qe=null;break}if(p!==null){p.return=g,qe=p;break}qe=g}}}var y=s.alternate;if(y!==null){var x=y.child;if(x!==null){y.child=null;do{var E=x.sibling;x.sibling=null,x=E}while(x!==null)}}qe=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,qe=a;else e:for(;qe!==null;){if(s=qe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:ff(9,s,s.return)}var T=s.sibling;if(T!==null){T.return=s.return,qe=T;break e}qe=s.return}}var A=t.current;for(qe=A;qe!==null;){a=qe;var _=a.child;if(a.subtreeFlags&2064&&_!==null)_.return=a,qe=_;else e:for(a=A;qe!==null;){if(o=qe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:_p(9,o)}}catch(W){Mr(o,o.return,W)}if(o===a){qe=null;break e}var P=o.sibling;if(P!==null){P.return=o.return,qe=P;break e}qe=o.return}}if(Dt=i,Ko(),Zs&&typeof Zs.onPostCommitFiberRoot=="function")try{Zs.onPostCommitFiberRoot(dp,t)}catch{}n=!0}return n}finally{Kt=r,ls.transition=e}}return!1}function y_(t,e,r){e=Qc(r,e),e=BT(t,e,1),t=Co(t,e,1),e=di(),t!==null&&(m0(t,1,e),Fi(t,e))}function Mr(t,e,r){if(t.tag===3)y_(t,t,r);else for(;e!==null;){if(e.tag===3){y_(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Fo===null||!Fo.has(n))){t=Qc(r,t),t=jT(e,t,1),e=Co(e,t,1),t=di(),e!==null&&(m0(e,1,t),Fi(e,t));break}}e=e.return}}function Tb(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=di(),t.pingedLanes|=t.suspendedLanes&r,_n===t&&(Rn&r)===r&&(ln===4||ln===3&&(Rn&130023424)===Rn&&500>Wr()-m1?gl(t,0):p1|=r),Fi(t,e)}function sS(t,e){e===0&&(t.mode&1?(e=ud,ud<<=1,!(ud&130023424)&&(ud=4194304)):e=1);var r=di();t=La(t,e),t!==null&&(m0(t,e,r),Fi(t,r))}function Sb(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),sS(t,r)}function Ab(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Pe(314))}n!==null&&n.delete(e),sS(t,r)}var aS;aS=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||ki.current)Ai=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Ai=!1,db(t,e,r);Ai=!!(t.flags&131072)}else Ai=!1,yr&&e.flags&1048576&&uT(e,Th,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Jd(t,e),t=e.pendingProps;var i=Kc(e,Jn.current);Mc(e,r),i=l1(null,e,n,t,i,r);var s=c1();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ci(n)?(s=!0,Eh(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,n1(e),i.updater=yp,e.stateNode=i,i._reactInternals=e,Og(e,n,t,r),e=Bg(null,e,n,!0,s,r)):(e.tag=0,yr&&s&&qx(e),ci(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Jd(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=Cb(n),t=As(n,t),i){case 0:e=Lg(null,e,n,t,r);break e;case 1:e=c_(null,e,n,t,r);break e;case 11:e=o_(null,e,n,t,r);break e;case 14:e=l_(null,e,n,As(n.type,t),r);break e}throw Error(Pe(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:As(n,i),Lg(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:As(n,i),c_(t,e,n,i,r);case 3:e:{if(WT(e),t===null)throw Error(Pe(387));n=e.pendingProps,s=e.memoizedState,i=s.element,gT(t,e),kh(e,n,null,r);var a=e.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Qc(Error(Pe(423)),e),e=u_(t,e,n,r,i);break e}else if(n!==i){i=Qc(Error(Pe(424)),e),e=u_(t,e,n,r,i);break e}else for(Vi=ko(e.stateNode.containerInfo.firstChild),Ui=e,yr=!0,Cs=null,r=pT(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Xc(),n===i){e=Ba(t,e,r);break e}ci(t,e,n,r)}e=e.child}return e;case 5:return xT(e),t===null&&Ng(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,Cg(n,i)?a=null:s!==null&&Cg(n,s)&&(e.flags|=32),zT(t,e),ci(t,e,a,r),e.child;case 6:return t===null&&Ng(e),null;case 13:return HT(t,e,r);case 4:return i1(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Yc(e,null,n,r):ci(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:As(n,i),o_(t,e,n,i,r);case 7:return ci(t,e,e.pendingProps,r),e.child;case 8:return ci(t,e,e.pendingProps.children,r),e.child;case 12:return ci(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,rr(Sh,n._currentValue),n._currentValue=a,s!==null)if(Os(s.value,a)){if(s.children===i.children&&!ki.current){e=Ba(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=ba(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Dg(s.return,r,e),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(Pe(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Dg(a,r,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}ci(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,Mc(e,r),i=us(i),n=n(i),e.flags|=1,ci(t,e,n,r),e.child;case 14:return n=e.type,i=As(n,e.pendingProps),i=As(n.type,i),l_(t,e,n,i,r);case 15:return VT(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:As(n,i),Jd(t,e),e.tag=1,Ci(n)?(t=!0,Eh(e)):t=!1,Mc(e,r),LT(e,n,i),Og(e,n,i,r),Bg(null,e,n,!0,t,r);case 19:return $T(t,e,r);case 22:return UT(t,e,r)}throw Error(Pe(156,e.tag))};function oS(t,e){return Pw(t,e)}function kb(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function os(t,e,r,n){return new kb(t,e,r,n)}function y1(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Cb(t){if(typeof t=="function")return y1(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Bx)return 11;if(t===jx)return 14}return 2}function bo(t,e){var r=t.alternate;return r===null?(r=os(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function th(t,e,r,n,i,s){var a=2;if(n=t,typeof t=="function")y1(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case vc:return xl(r.children,i,s,e);case Lx:a=8,i|=8;break;case sg:return t=os(12,r,e,i|2),t.elementType=sg,t.lanes=s,t;case ag:return t=os(13,r,e,i),t.elementType=ag,t.lanes=s,t;case og:return t=os(19,r,e,i),t.elementType=og,t.lanes=s,t;case xw:return wp(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case mw:a=10;break e;case gw:a=9;break e;case Bx:a=11;break e;case jx:a=14;break e;case lo:a=16,n=null;break e}throw Error(Pe(130,t==null?t:typeof t,""))}return e=os(a,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function xl(t,e,r,n){return t=os(7,t,n,e),t.lanes=r,t}function wp(t,e,r,n){return t=os(22,t,n,e),t.elementType=xw,t.lanes=r,t.stateNode={isHidden:!1},t}function wm(t,e,r){return t=os(6,t,null,e),t.lanes=r,t}function Tm(t,e,r){return e=os(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Fb(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=nm(0),this.expirationTimes=nm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=nm(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function _1(t,e,r,n,i,s,a,o,l){return t=new Fb(t,e,r,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=os(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},n1(s),t}function Ib(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:xc,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function lS(t){if(!t)return Lo;t=t._reactInternals;e:{if(Ul(t)!==t||t.tag!==1)throw Error(Pe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ci(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Pe(171))}if(t.tag===1){var r=t.type;if(Ci(r))return lT(t,r,e)}return e}function cS(t,e,r,n,i,s,a,o,l){return t=_1(r,n,!0,t,i,s,a,o,l),t.context=lS(null),r=t.current,n=di(),i=Io(r),s=ba(n,i),s.callback=e??null,Co(r,s,i),t.current.lanes=i,m0(t,i,n),Fi(t,n),t}function Tp(t,e,r,n){var i=e.current,s=di(),a=Io(i);return r=lS(r),e.context===null?e.context=r:e.pendingContext=r,e=ba(s,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Co(i,e,a),t!==null&&(Ns(t,i,a,s),Yd(t,i,a)),a}function Ph(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function __(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function E1(t,e){__(t,e),(t=t.alternate)&&__(t,e)}function bb(){return null}var uS=typeof reportError=="function"?reportError:function(t){console.error(t)};function w1(t){this._internalRoot=t}Sp.prototype.render=w1.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Pe(409));Tp(t,e,null,null)};Sp.prototype.unmount=w1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Fl(function(){Tp(null,t,null,null)}),e[Ma]=null}};function Sp(t){this._internalRoot=t}Sp.prototype.unstable_scheduleHydration=function(t){if(t){var e=Uw();t={blockedOn:null,target:t,priority:e};for(var r=0;r<uo.length&&e!==0&&e<uo[r].priority;r++);uo.splice(r,0,t),r===0&&Ww(t)}};function T1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ap(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function E_(){}function Rb(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=Ph(a);s.call(c)}}var a=cS(e,n,t,0,null,!1,!1,"",E_);return t._reactRootContainer=a,t[Ma]=a.current,Of(t.nodeType===8?t.parentNode:t),Fl(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=Ph(l);o.call(c)}}var l=_1(t,0,!1,null,null,!1,!1,"",E_);return t._reactRootContainer=l,t[Ma]=l.current,Of(t.nodeType===8?t.parentNode:t),Fl(function(){Tp(e,l,r,n)}),l}function kp(t,e,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=Ph(a);o.call(l)}}Tp(e,a,t,i)}else a=Rb(r,e,t,i,n);return Ph(a)}jw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Yu(e.pendingLanes);r!==0&&(zx(e,r|1),Fi(e,Wr()),!(Dt&6)&&(Jc=Wr()+500,Ko()))}break;case 13:Fl(function(){var n=La(t,1);if(n!==null){var i=di();Ns(n,t,1,i)}}),E1(t,1)}};Wx=function(t){if(t.tag===13){var e=La(t,134217728);if(e!==null){var r=di();Ns(e,t,134217728,r)}E1(t,134217728)}};Vw=function(t){if(t.tag===13){var e=Io(t),r=La(t,e);if(r!==null){var n=di();Ns(r,t,e,n)}E1(t,e)}};Uw=function(){return Kt};zw=function(t,e){var r=Kt;try{return Kt=t,e()}finally{Kt=r}};xg=function(t,e,r){switch(e){case"input":if(ug(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=gp(n);if(!i)throw Error(Pe(90));yw(n),ug(n,i)}}}break;case"textarea":Ew(t,r);break;case"select":e=r.value,e!=null&&Nc(t,!!r.multiple,e,!1)}};Fw=g1;Iw=Fl;var Nb={usingClientEntryPoint:!1,Events:[x0,wc,gp,kw,Cw,g1]},Uu={findFiberByHostInstance:fl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Db={bundleType:Uu.bundleType,version:Uu.version,rendererPackageName:Uu.rendererPackageName,rendererConfig:Uu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:$a.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Nw(t),t===null?null:t.stateNode},findFiberByHostInstance:Uu.findFiberByHostInstance||bb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ed=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ed.isDisabled&&Ed.supportsFiber)try{dp=Ed.inject(Db),Zs=Ed}catch{}}$i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Nb;$i.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!T1(e))throw Error(Pe(200));return Ib(t,e,null,r)};$i.createRoot=function(t,e){if(!T1(t))throw Error(Pe(299));var r=!1,n="",i=uS;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=_1(t,1,!1,null,null,r,!1,n,i),t[Ma]=e.current,Of(t.nodeType===8?t.parentNode:t),new w1(e)};$i.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Pe(188)):(t=Object.keys(t).join(","),Error(Pe(268,t)));return t=Nw(e),t=t===null?null:t.stateNode,t};$i.flushSync=function(t){return Fl(t)};$i.hydrate=function(t,e,r){if(!Ap(e))throw Error(Pe(200));return kp(null,t,e,!0,r)};$i.hydrateRoot=function(t,e,r){if(!T1(t))throw Error(Pe(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=uS;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=cS(e,null,t,1,r??null,i,!1,s,a),t[Ma]=e.current,Of(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new Sp(e)};$i.render=function(t,e,r){if(!Ap(e))throw Error(Pe(200));return kp(null,t,e,!1,r)};$i.unmountComponentAtNode=function(t){if(!Ap(t))throw Error(Pe(40));return t._reactRootContainer?(Fl(function(){kp(null,null,t,!1,function(){t._reactRootContainer=null,t[Ma]=null})}),!0):!1};$i.unstable_batchedUpdates=g1;$i.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Ap(r))throw Error(Pe(200));if(t==null||t._reactInternals===void 0)throw Error(Pe(38));return kp(t,e,r,!1,n)};$i.version="18.3.1-next-f1338f8080-20240426";function fS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(fS)}catch(t){console.error(t)}}fS(),fw.exports=$i;var Pb=fw.exports,w_=Pb;ng.createRoot=w_.createRoot,ng.hydrateRoot=w_.hydrateRoot;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Oh={};Oh.version="0.18.5";var dS=1252,Ob=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],S1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},A1=function(t){Ob.indexOf(t)!=-1&&(dS=S1[0]=t)};function Mb(){A1(1252)}var Fs=function(t){A1(t)};function k1(){Fs(1200),Mb()}function T_(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function Lb(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function hS(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Qu=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?Lb(t.slice(2)):e==254&&r==255?hS(t.slice(2)):e==65279?t.slice(1):t},wd=function(e){return String.fromCharCode(e)},S_=function(e){return String.fromCharCode(e)},Hf,yo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function $f(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),s=r>>2,n=t.charCodeAt(c++),a=(r&3)<<4|n>>4,i=t.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=yo.charAt(s)+yo.charAt(a)+yo.charAt(o)+yo.charAt(l);return e}function Hi(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)s=yo.indexOf(t.charAt(c++)),a=yo.indexOf(t.charAt(c++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=yo.indexOf(t.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=yo.indexOf(t.charAt(c++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Et=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ga=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Bo(t){return Et?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function A_(t){return Et?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Bi=function(e){return Et?Ga(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Cp(t){if(typeof ArrayBuffer>"u")return Bi(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Xo(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function Bb(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function C1(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return C1(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var vn=Et?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Ga(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function jb(t){for(var e=[],r=0,n=t.length+250,i=Bo(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Bo(65535),n=65530)}return e.push(i.slice(0,r)),vn(e)}var hi=/\u0000/g,Ju=/[\u0001-\u0006]/g;function Bc(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Is(t,e){var r=""+t;return r.length>=e?r:Lr("0",e-r.length)+r}function F1(t,e){var r=""+t;return r.length>=e?r:Lr(" ",e-r.length)+r}function Mh(t,e){var r=""+t;return r.length>=e?r:r+Lr(" ",e-r.length)}function Vb(t,e){var r=""+Math.round(t);return r.length>=e?r:Lr("0",e-r.length)+r}function Ub(t,e){var r=""+t;return r.length>=e?r:Lr("0",e-r.length)+r}var k_=Math.pow(2,32);function uc(t,e){if(t>k_||t<-k_)return Vb(t,e);var r=Math.round(t);return Ub(r,e)}function Lh(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var C_=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Sm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function zb(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var at={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},F_={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Wb={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Bh(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,l=1,c=0,d=0,h=Math.floor(i);c<e&&(h=Math.floor(i),o=h*a+s,d=h*c+l,!(i-h<5e-8));)i=1/(i-h),s=a,a=o,l=c,c=d;if(d>e&&(c>e?(d=l,o=s):(d=c,o=a)),!r)return[0,n*o,d];var p=Math.floor(n*o/d);return[p,n*o-p*d,d]}function pl(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=Yb(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var pS=new Date(1899,11,31,0,0,0),Hb=pS.getTime(),$b=new Date(1900,2,1,0,0,0);function mS(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=$b&&(r+=24*60*60*1e3),(r-(Hb+(t.getTimezoneOffset()-pS.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function I1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Gb(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Kb(t){var e=t<0?12:11,r=I1(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function Xb(t){var e=I1(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Gf(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=Kb(t):e===10?r=t.toFixed(10).substr(0,12):r=Xb(t),I1(Gb(r.toUpperCase()))}function Il(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Gf(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return ds(14,mS(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function Yb(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function qb(t,e,r,n){var i="",s=0,a=0,o=r.y,l,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return Sm[r.m-1][1];case 5:return Sm[r.m-1][0];default:return Sm[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return C_[r.q][0];default:return C_[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Is(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=Is(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var d=c>0?Is(l,c):"";return d}function _o(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var gS=/%/g;function Qb(t,e,r){var n=e.replace(gS,""),i=e.length-n.length;return Ra(t,n,r*Math.pow(10,2*i))+Lr("%",i)}function Jb(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ra(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function xS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+xS(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,d){return l+c+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var vS=/# (\?+)( ?)\/( ?)(\d+)/;function Zb(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?Lr(" ",t[1].length+1+t[4].length):F1(a,t[1].length)+t[2]+"/"+t[3]+Is(o,t[4].length))}function eR(t,e,r){return r+(e===0?"":""+e)+Lr(" ",t[1].length+2+t[4].length)}var yS=/^#*0*\.([0#]+)/,_S=/\).*[0#]/,ES=/\(###\) ###\\?-####/;function ui(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function I_(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function b_(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function tR(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function rR(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Zi(t,e,r){if(t.charCodeAt(0)===40&&!e.match(_S)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Zi("n",n,r):"("+Zi("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Jb(t,e,r);if(e.indexOf("%")!==-1)return Qb(t,e,r);if(e.indexOf("E")!==-1)return xS(e,r);if(e.charCodeAt(0)===36)return"$"+Zi(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+uc(l,e.length);if(e.match(/^[#?]+$/))return i=uc(r,0),i==="0"&&(i=""),i.length>e.length?i:ui(e.substr(0,e.length-i.length))+i;if(s=e.match(vS))return Zb(s,l,c);if(e.match(/^#+0+$/))return c+uc(l,e.length-e.indexOf("0"));if(s=e.match(yS))return i=I_(r,s[1].length).replace(/^([^\.]+)$/,"$1."+ui(s[1])).replace(/\.$/,"."+ui(s[1])).replace(/\.(\d*)$/,function(y,x){return"."+x+Lr("0",ui(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+I_(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+_o(uc(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Zi(t,e,-r):_o(""+(Math.floor(r)+tR(r,s[1].length)))+"."+Is(b_(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Zi(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Bc(Zi(t,e.replace(/[\\-]/g,""),r)),a=0,Bc(Bc(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match(ES))return i=Zi(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Bh(l,Math.pow(10,a)-1,!1),i=""+c,d=Ra("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=Mh(o[2],a),d.length<s[4].length&&(d=ui(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Bh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?F1(o[1],a)+s[2]+"/"+s[3]+Mh(o[2],a):Lr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=uc(r,0),e.length<=i.length?i:ui(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,p=e.length-i.length-h;return ui(e.substr(0,h)+i+e.substr(e.length-p))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=b_(r,s[1].length),r<0?"-"+Zi(t,e,-r):_o(rR(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Is(0,3-y.length):"")+y})+"."+Is(a,s[1].length);switch(e){case"###,##0.00":return Zi(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=_o(uc(l,0));return g!=="0"?c+g:"";case"###,###.00":return Zi(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Zi(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function nR(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ra(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function iR(t,e,r){var n=e.replace(gS,""),i=e.length-n.length;return Ra(t,n,r*Math.pow(10,2*i))+Lr("%",i)}function wS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+wS(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,d){return l+c+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Xs(t,e,r){if(t.charCodeAt(0)===40&&!e.match(_S)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Xs("n",n,r):"("+Xs("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return nR(t,e,r);if(e.indexOf("%")!==-1)return iR(t,e,r);if(e.indexOf("E")!==-1)return wS(e,r);if(e.charCodeAt(0)===36)return"$"+Xs(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+Is(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:ui(e.substr(0,e.length-i.length))+i;if(s=e.match(vS))return eR(s,l,c);if(e.match(/^#+0+$/))return c+Is(l,e.length-e.indexOf("0"));if(s=e.match(yS))return i=(""+r).replace(/^([^\.]+)$/,"$1."+ui(s[1])).replace(/\.$/,"."+ui(s[1])),i=i.replace(/\.(\d*)$/,function(y,x){return"."+x+Lr("0",ui(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+_o(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Xs(t,e,-r):_o(""+r)+"."+Lr("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Xs(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Bc(Xs(t,e.replace(/[\\-]/g,""),r)),a=0,Bc(Bc(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match(ES))return i=Xs(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Bh(l,Math.pow(10,a)-1,!1),i=""+c,d=Ra("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=Mh(o[2],a),d.length<s[4].length&&(d=ui(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Bh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?F1(o[1],a)+s[2]+"/"+s[3]+Mh(o[2],a):Lr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:ui(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,p=e.length-i.length-h;return ui(e.substr(0,h)+i+e.substr(e.length-p))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Xs(t,e,-r):_o(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Is(0,3-y.length):"")+y})+"."+Is(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var g=_o(""+l);return g!=="0"?c+g:"";default:if(e.match(/\.[0#?]*$/))return Xs(t,e.slice(0,e.lastIndexOf(".")),r)+ui(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Ra(t,e,r){return(r|0)===r?Xs(t,e,r):Zi(t,e,r)}function sR(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var TS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function pu(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Lh(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(TS))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function aR(t,e,r,n){for(var i=[],s="",a=0,o="",l="t",c,d,h,p="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!Lh(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(h=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++a;break;case"\\":var g=t.charAt(++a),y=g==="("||g===")"?g:"t";i[i.length]={t:y,v:g},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(c==null&&(c=pl(e,r,t.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=pl(e,r),c==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var x={t:o,v:o};if(c==null&&(c=pl(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(x.v=c.H>=12?"P":"A"),x.t="T",p="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(x.v=c.H>=12?"PM":"AM"),x.t="T",a+=5,p="h"):t.substr(a,5).toUpperCase()==="/"?(c!=null&&(x.v=c.H>=12?"":""),x.t="T",a+=5,p="h"):(x.t="t",++a),c==null&&x.t==="T")return"";i[i.length]=x,l=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(TS)){if(c==null&&(c=pl(e,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",pu(t)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var E=0,T=0,A;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=p,l="h",E<1&&(E=1);break;case"s":(A=i[a].v.match(/\.0+$/))&&(T=Math.max(T,A[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&i[a].v.match(/[Hh]/)&&(E=1),E<2&&i[a].v.match(/[Mm]/)&&(E=2),E<3&&i[a].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var _="",P;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=qb(i[a].t.charCodeAt(0),i[a].v,c,T),i[a].t="t";break;case"n":case"?":for(P=a+1;i[P]!=null&&((o=i[P].t)==="?"||o==="D"||(o===" "||o==="t")&&i[P+1]!=null&&(i[P+1].t==="?"||i[P+1].t==="t"&&i[P+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[P].v==="/"||i[P].v===" "&&i[P+1]!=null&&i[P+1].t=="?"));)i[a].v+=i[P].v,i[P]={v:"",t:";"},++P;_+=i[a].v,a=P-1;break;case"G":i[a].t="t",i[a].v=Il(e,r);break}var W="",j,w;if(_.length>0){_.charCodeAt(0)==40?(j=e<0&&_.charCodeAt(0)===45?-e:e,w=Ra("n",_,j)):(j=e<0&&n>1?-e:e,w=Ra("n",_,j),j<0&&i[0]&&i[0].t=="t"&&(w=w.substr(1),i[0].v="-"+i[0].v)),P=w.length-1;var F=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){F=a;break}var S=i.length;if(F===i.length&&w.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(P>=i[a].v.length-1?(P-=i[a].v.length,i[a].v=w.substr(P+1,i[a].v.length)):P<0?i[a].v="":(i[a].v=w.substr(0,P+1),P=-1),i[a].t="t",S=a);P>=0&&S<i.length&&(i[S].v=w.substr(0,P+1)+i[S].v)}else if(F!==i.length&&w.indexOf("E")===-1){for(P=w.indexOf(".")-1,a=F;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(d=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")-1:i[a].v.length-1,W=i[a].v.substr(d+1);d>=0;--d)P>=0&&(i[a].v.charAt(d)==="0"||i[a].v.charAt(d)==="#")&&(W=w.charAt(P--)+W);i[a].v=W,i[a].t="t",S=a}for(P>=0&&S<i.length&&(i[S].v=w.substr(0,P+1)+i[S].v),P=w.indexOf(".")+1,a=F;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==F)){for(d=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")+1:0,W=i[a].v.substr(0,d);d<i[a].v.length;++d)P<w.length&&(W+=w.charAt(P++));i[a].v=W,i[a].t="t",S=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(j=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Ra(i[a].t,i[a].v,j),i[a].t="t");var b="";for(a=0;a!==i.length;++a)i[a]!=null&&(b+=i[a].v);return b}var R_=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function N_(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function oR(t,e){var r=sR(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(R_),o=r[1].match(R_);return N_(e,a)?[n,r[0]]:N_(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function ds(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:at)[t],n==null&&(n=r.table&&r.table[F_[t]]||at[F_[t]]),n==null&&(n=Wb[t]||"General");break}if(Lh(n,0))return Il(e,r);e instanceof Date&&(e=mS(e,r.date1904));var i=oR(n,e);if(Lh(i[1]))return Il(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return aR(i[1],e,r,i[0])}function Na(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(at[r]==null){e<0&&(e=r);continue}if(at[r]==t){e=r;break}}e<0&&(e=391)}return at[e]=t,e}function Fp(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Na(t[e],e)}function mu(){at=zb()}var lR={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},SS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function cR(t){var e=typeof t=="number"?at[t]:t;return e=e.replace(SS,"(\\d+)"),new RegExp("^"+e+"$")}function uR(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(SS)||[]).forEach(function(h,p){var g=parseInt(r[p+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=g;break;case"d":s=g;break;case"h":a=g;break;case"s":l=g;break;case"m":a>=0?o=g:i=g;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var d=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&s==-1?d:c+"T"+d}var fR=function(){var t={};t.version="1.2.0";function e(){for(var w=0,F=new Array(256),S=0;S!=256;++S)w=S,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,F[S]=w;return typeof Int32Array<"u"?new Int32Array(F):F}var r=e();function n(w){var F=0,S=0,b=0,N=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(b=0;b!=256;++b)N[b]=w[b];for(b=0;b!=256;++b)for(S=w[b],F=256+b;F<4096;F+=256)S=N[F]=S>>>8^w[S&255];var D=[];for(b=1;b!=16;++b)D[b-1]=typeof Int32Array<"u"?N.subarray(b*256,b*256+256):N.slice(b*256,b*256+256);return D}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],d=i[5],h=i[6],p=i[7],g=i[8],y=i[9],x=i[10],E=i[11],T=i[12],A=i[13],_=i[14];function P(w,F){for(var S=F^-1,b=0,N=w.length;b<N;)S=S>>>8^r[(S^w.charCodeAt(b++))&255];return~S}function W(w,F){for(var S=F^-1,b=w.length-15,N=0;N<b;)S=_[w[N++]^S&255]^A[w[N++]^S>>8&255]^T[w[N++]^S>>16&255]^E[w[N++]^S>>>24]^x[w[N++]]^y[w[N++]]^g[w[N++]]^p[w[N++]]^h[w[N++]]^d[w[N++]]^c[w[N++]]^l[w[N++]]^o[w[N++]]^a[w[N++]]^s[w[N++]]^r[w[N++]];for(b+=15;N<b;)S=S>>>8^r[(S^w[N++])&255];return~S}function j(w,F){for(var S=F^-1,b=0,N=w.length,D=0,R=0;b<N;)D=w.charCodeAt(b++),D<128?S=S>>>8^r[(S^D)&255]:D<2048?(S=S>>>8^r[(S^(192|D>>6&31))&255],S=S>>>8^r[(S^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,R=w.charCodeAt(b++)&1023,S=S>>>8^r[(S^(240|D>>8&7))&255],S=S>>>8^r[(S^(128|D>>2&63))&255],S=S>>>8^r[(S^(128|R>>6&15|(D&3)<<4))&255],S=S>>>8^r[(S^(128|R&63))&255]):(S=S>>>8^r[(S^(224|D>>12&15))&255],S=S>>>8^r[(S^(128|D>>6&63))&255],S=S>>>8^r[(S^(128|D&63))&255]);return~S}return t.table=r,t.bstr=P,t.buf=W,t.str=j,t}(),Ze=function(){var e={};e.version="1.2.1";function r(I,V){for(var M=I.split("/"),L=V.split("/"),z=0,B=0,ae=Math.min(M.length,L.length);z<ae;++z){if(B=M[z].length-L[z].length)return B;if(M[z]!=L[z])return M[z]<L[z]?-1:1}return M.length-L.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var V=I.lastIndexOf("/");return V===-1?I:I.slice(0,V+1)}function i(I){if(I.charAt(I.length-1)=="/")return i(I.slice(0,-1));var V=I.lastIndexOf("/");return V===-1?I:I.slice(V+1)}function s(I,V){typeof V=="string"&&(V=new Date(V));var M=V.getHours();M=M<<6|V.getMinutes(),M=M<<5|V.getSeconds()>>>1,I.write_shift(2,M);var L=V.getFullYear()-1980;L=L<<4|V.getMonth()+1,L=L<<5|V.getDate(),I.write_shift(2,L)}function a(I){var V=I.read_shift(2)&65535,M=I.read_shift(2)&65535,L=new Date,z=M&31;M>>>=5;var B=M&15;M>>>=4,L.setMilliseconds(0),L.setFullYear(M+1980),L.setMonth(B-1),L.setDate(z);var ae=V&31;V>>>=5;var ue=V&63;return V>>>=6,L.setHours(V),L.setMinutes(ue),L.setSeconds(ae<<1),L}function o(I){Fn(I,0);for(var V={},M=0;I.l<=I.length-4;){var L=I.read_shift(2),z=I.read_shift(2),B=I.l+z,ae={};switch(L){case 21589:M=I.read_shift(1),M&1&&(ae.mtime=I.read_shift(4)),z>5&&(M&2&&(ae.atime=I.read_shift(4)),M&4&&(ae.ctime=I.read_shift(4))),ae.mtime&&(ae.mt=new Date(ae.mtime*1e3));break}I.l=B,V[L]=ae}return V}var l;function c(){return l||(l={})}function d(I,V){if(I[0]==80&&I[1]==75)return Qa(I,V);if((I[0]|32)==109&&(I[1]|32)==105)return Mn(I,V);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var M=3,L=512,z=0,B=0,ae=0,ue=0,ie=0,te=[],le=I.slice(0,512);Fn(le,0);var pe=h(le);switch(M=pe[0],M){case 3:L=512;break;case 4:L=4096;break;case 0:if(pe[1]==0)return Qa(I,V);default:throw new Error("Major Version: Expected 3 or 4 saw "+M)}L!==512&&(le=I.slice(0,L),Fn(le,28));var De=I.slice(0,L);p(le,M);var Oe=le.read_shift(4,"i");if(M===3&&Oe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Oe);le.l+=4,ae=le.read_shift(4,"i"),le.l+=4,le.chk("00100000","Mini Stream Cutoff Size: "),ue=le.read_shift(4,"i"),z=le.read_shift(4,"i"),ie=le.read_shift(4,"i"),B=le.read_shift(4,"i");for(var Ie=-1,ze=0;ze<109&&(Ie=le.read_shift(4,"i"),!(Ie<0));++ze)te[ze]=Ie;var et=g(I,L);E(ie,B,et,L,te);var Mt=A(et,ae,te,L);Mt[ae].name="!Directory",z>0&&ue!==R&&(Mt[ue].name="!MiniFAT"),Mt[te[0]].name="!FAT",Mt.fat_addrs=te,Mt.ssz=L;var Nt={},Ft=[],ii=[],Kr=[];_(ae,Mt,et,Ft,z,Nt,ii,ue),y(ii,Kr,Ft),Ft.shift();var _i={FileIndex:ii,FullPaths:Kr};return V&&V.raw&&(_i.raw={header:De,sectors:et}),_i}function h(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(He,"Header Signature: "),I.l+=16;var V=I.read_shift(2,"u");return[I.read_shift(2,"u"),V]}function p(I,V){var M=9;switch(I.l+=2,M=I.read_shift(2)){case 9:if(V!=3)throw new Error("Sector Shift: Expected 9 saw "+M);break;case 12:if(V!=4)throw new Error("Sector Shift: Expected 12 saw "+M);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+M)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function g(I,V){for(var M=Math.ceil(I.length/V)-1,L=[],z=1;z<M;++z)L[z-1]=I.slice(z*V,(z+1)*V);return L[M-1]=I.slice(M*V),L}function y(I,V,M){for(var L=0,z=0,B=0,ae=0,ue=0,ie=M.length,te=[],le=[];L<ie;++L)te[L]=le[L]=L,V[L]=M[L];for(;ue<le.length;++ue)L=le[ue],z=I[L].L,B=I[L].R,ae=I[L].C,te[L]===L&&(z!==-1&&te[z]!==z&&(te[L]=te[z]),B!==-1&&te[B]!==B&&(te[L]=te[B])),ae!==-1&&(te[ae]=L),z!==-1&&L!=te[L]&&(te[z]=te[L],le.lastIndexOf(z)<ue&&le.push(z)),B!==-1&&L!=te[L]&&(te[B]=te[L],le.lastIndexOf(B)<ue&&le.push(B));for(L=1;L<ie;++L)te[L]===L&&(B!==-1&&te[B]!==B?te[L]=te[B]:z!==-1&&te[z]!==z&&(te[L]=te[z]));for(L=1;L<ie;++L)if(I[L].type!==0){if(ue=L,ue!=te[ue])do ue=te[ue],V[L]=V[ue]+"/"+V[L];while(ue!==0&&te[ue]!==-1&&ue!=te[ue]);te[L]=-1}for(V[0]+="/",L=1;L<ie;++L)I[L].type!==2&&(V[L]+="/")}function x(I,V,M){for(var L=I.start,z=I.size,B=[],ae=L;M&&z>0&&ae>=0;)B.push(V.slice(ae*D,ae*D+D)),z-=D,ae=ul(M,ae*4);return B.length===0?ge(0):vn(B).slice(0,I.size)}function E(I,V,M,L,z){var B=R;if(I===R){if(V!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var ae=M[I],ue=(L>>>2)-1;if(!ae)return;for(var ie=0;ie<ue&&(B=ul(ae,ie*4))!==R;++ie)z.push(B);E(ul(ae,L-4),V-1,M,L,z)}}function T(I,V,M,L,z){var B=[],ae=[];z||(z=[]);var ue=L-1,ie=0,te=0;for(ie=V;ie>=0;){z[ie]=!0,B[B.length]=ie,ae.push(I[ie]);var le=M[Math.floor(ie*4/L)];if(te=ie*4&ue,L<4+te)throw new Error("FAT boundary crossed: "+ie+" 4 "+L);if(!I[le])break;ie=ul(I[le],te)}return{nodes:B,data:H_([ae])}}function A(I,V,M,L){var z=I.length,B=[],ae=[],ue=[],ie=[],te=L-1,le=0,pe=0,De=0,Oe=0;for(le=0;le<z;++le)if(ue=[],De=le+V,De>=z&&(De-=z),!ae[De]){ie=[];var Ie=[];for(pe=De;pe>=0;){Ie[pe]=!0,ae[pe]=!0,ue[ue.length]=pe,ie.push(I[pe]);var ze=M[Math.floor(pe*4/L)];if(Oe=pe*4&te,L<4+Oe)throw new Error("FAT boundary crossed: "+pe+" 4 "+L);if(!I[ze]||(pe=ul(I[ze],Oe),Ie[pe]))break}B[De]={nodes:ue,data:H_([ie])}}return B}function _(I,V,M,L,z,B,ae,ue){for(var ie=0,te=L.length?2:0,le=V[I].data,pe=0,De=0,Oe;pe<le.length;pe+=128){var Ie=le.slice(pe,pe+128);Fn(Ie,64),De=Ie.read_shift(2),Oe=M1(Ie,0,De-te),L.push(Oe);var ze={name:Oe,type:Ie.read_shift(1),color:Ie.read_shift(1),L:Ie.read_shift(4,"i"),R:Ie.read_shift(4,"i"),C:Ie.read_shift(4,"i"),clsid:Ie.read_shift(16),state:Ie.read_shift(4,"i"),start:0,size:0},et=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);et!==0&&(ze.ct=P(Ie,Ie.l-8));var Mt=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);Mt!==0&&(ze.mt=P(Ie,Ie.l-8)),ze.start=Ie.read_shift(4,"i"),ze.size=Ie.read_shift(4,"i"),ze.size<0&&ze.start<0&&(ze.size=ze.type=0,ze.start=R,ze.name=""),ze.type===5?(ie=ze.start,z>0&&ie!==R&&(V[ie].name="!StreamData")):ze.size>=4096?(ze.storage="fat",V[ze.start]===void 0&&(V[ze.start]=T(M,ze.start,V.fat_addrs,V.ssz)),V[ze.start].name=ze.name,ze.content=V[ze.start].data.slice(0,ze.size)):(ze.storage="minifat",ze.size<0?ze.size=0:ie!==R&&ze.start!==R&&V[ie]&&(ze.content=x(ze,V[ie].data,(V[ue]||{}).data))),ze.content&&Fn(ze.content,0),B[Oe]=ze,ae.push(ze)}}function P(I,V){return new Date((Li(I,V+4)/1e7*Math.pow(2,32)+Li(I,V)/1e7-11644473600)*1e3)}function W(I,V){return c(),d(l.readFileSync(I),V)}function j(I,V){var M=V&&V.type;switch(M||Et&&Buffer.isBuffer(I)&&(M="buffer"),M||"base64"){case"file":return W(I,V);case"base64":return d(Bi(Hi(I)),V);case"binary":return d(Bi(I),V)}return d(I,V)}function w(I,V){var M=V||{},L=M.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=L+"/",I.FileIndex[0]={name:L,type:5}),M.CLSID&&(I.FileIndex[0].clsid=M.CLSID),F(I)}function F(I){var V="Sh33tJ5";if(!Ze.find(I,"/"+V)){var M=ge(4);M[0]=55,M[1]=M[3]=50,M[2]=54,I.FileIndex.push({name:V,type:2,content:M,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+V),S(I)}}function S(I,V){w(I);for(var M=!1,L=!1,z=I.FullPaths.length-1;z>=0;--z){var B=I.FileIndex[z];switch(B.type){case 0:L?M=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:L=!0,isNaN(B.R*B.L*B.C)&&(M=!0),B.R>-1&&B.L>-1&&B.R==B.L&&(M=!0);break;default:M=!0;break}}if(!(!M&&!V)){var ae=new Date(1987,1,19),ue=0,ie=Object.create?Object.create(null):{},te=[];for(z=0;z<I.FullPaths.length;++z)ie[I.FullPaths[z]]=!0,I.FileIndex[z].type!==0&&te.push([I.FullPaths[z],I.FileIndex[z]]);for(z=0;z<te.length;++z){var le=n(te[z][0]);L=ie[le],L||(te.push([le,{name:i(le).replace("/",""),type:1,clsid:be,ct:ae,mt:ae,content:null}]),ie[le]=!0)}for(te.sort(function(Oe,Ie){return r(Oe[0],Ie[0])}),I.FullPaths=[],I.FileIndex=[],z=0;z<te.length;++z)I.FullPaths[z]=te[z][0],I.FileIndex[z]=te[z][1];for(z=0;z<te.length;++z){var pe=I.FileIndex[z],De=I.FullPaths[z];if(pe.name=i(De).replace("/",""),pe.L=pe.R=pe.C=-(pe.color=1),pe.size=pe.content?pe.content.length:0,pe.start=0,pe.clsid=pe.clsid||be,z===0)pe.C=te.length>1?1:-1,pe.size=0,pe.type=5;else if(De.slice(-1)=="/"){for(ue=z+1;ue<te.length&&n(I.FullPaths[ue])!=De;++ue);for(pe.C=ue>=te.length?-1:ue,ue=z+1;ue<te.length&&n(I.FullPaths[ue])!=n(De);++ue);pe.R=ue>=te.length?-1:ue,pe.type=1}else n(I.FullPaths[z+1]||"")==n(De)&&(pe.R=z+1),pe.type=2}}}function b(I,V){var M=V||{};if(M.fileType=="mad")return Gr(I,M);switch(S(I),M.fileType){case"zip":return ua(I,M)}var L=function(Oe){for(var Ie=0,ze=0,et=0;et<Oe.FileIndex.length;++et){var Mt=Oe.FileIndex[et];if(Mt.content){var Nt=Mt.content.length;Nt>0&&(Nt<4096?Ie+=Nt+63>>6:ze+=Nt+511>>9)}}for(var Ft=Oe.FullPaths.length+3>>2,ii=Ie+7>>3,Kr=Ie+127>>7,_i=ii+ze+Ft+Kr,Xr=_i+127>>7,gs=Xr<=109?0:Math.ceil((Xr-109)/127);_i+Xr+gs+127>>7>Xr;)gs=++Xr<=109?0:Math.ceil((Xr-109)/127);var Yr=[1,gs,Xr,Kr,Ft,ze,Ie,0];return Oe.FileIndex[0].size=Ie<<6,Yr[7]=(Oe.FileIndex[0].start=Yr[0]+Yr[1]+Yr[2]+Yr[3]+Yr[4]+Yr[5])+(Yr[6]+7>>3),Yr}(I),z=ge(L[7]<<9),B=0,ae=0;{for(B=0;B<8;++B)z.write_shift(1,xe[B]);for(B=0;B<8;++B)z.write_shift(2,0);for(z.write_shift(2,62),z.write_shift(2,3),z.write_shift(2,65534),z.write_shift(2,9),z.write_shift(2,6),B=0;B<3;++B)z.write_shift(2,0);for(z.write_shift(4,0),z.write_shift(4,L[2]),z.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),z.write_shift(4,0),z.write_shift(4,4096),z.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:R),z.write_shift(4,L[3]),z.write_shift(-4,L[1]?L[0]-1:R),z.write_shift(4,L[1]),B=0;B<109;++B)z.write_shift(-4,B<L[2]?L[1]+B:-1)}if(L[1])for(ae=0;ae<L[1];++ae){for(;B<236+ae*127;++B)z.write_shift(-4,B<L[2]?L[1]+B:-1);z.write_shift(-4,ae===L[1]-1?R:ae+1)}var ue=function(Oe){for(ae+=Oe;B<ae-1;++B)z.write_shift(-4,B+1);Oe&&(++B,z.write_shift(-4,R))};for(ae=B=0,ae+=L[1];B<ae;++B)z.write_shift(-4,Ae.DIFSECT);for(ae+=L[2];B<ae;++B)z.write_shift(-4,Ae.FATSECT);ue(L[3]),ue(L[4]);for(var ie=0,te=0,le=I.FileIndex[0];ie<I.FileIndex.length;++ie)le=I.FileIndex[ie],le.content&&(te=le.content.length,!(te<4096)&&(le.start=ae,ue(te+511>>9)));for(ue(L[6]+7>>3);z.l&511;)z.write_shift(-4,Ae.ENDOFCHAIN);for(ae=B=0,ie=0;ie<I.FileIndex.length;++ie)le=I.FileIndex[ie],le.content&&(te=le.content.length,!(!te||te>=4096)&&(le.start=ae,ue(te+63>>6)));for(;z.l&511;)z.write_shift(-4,Ae.ENDOFCHAIN);for(B=0;B<L[4]<<2;++B){var pe=I.FullPaths[B];if(!pe||pe.length===0){for(ie=0;ie<17;++ie)z.write_shift(4,0);for(ie=0;ie<3;++ie)z.write_shift(4,-1);for(ie=0;ie<12;++ie)z.write_shift(4,0);continue}le=I.FileIndex[B],B===0&&(le.start=le.size?le.start-1:R);var De=B===0&&M.root||le.name;if(te=2*(De.length+1),z.write_shift(64,De,"utf16le"),z.write_shift(2,te),z.write_shift(1,le.type),z.write_shift(1,le.color),z.write_shift(-4,le.L),z.write_shift(-4,le.R),z.write_shift(-4,le.C),le.clsid)z.write_shift(16,le.clsid,"hex");else for(ie=0;ie<4;++ie)z.write_shift(4,0);z.write_shift(4,le.state||0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,le.start),z.write_shift(4,le.size),z.write_shift(4,0)}for(B=1;B<I.FileIndex.length;++B)if(le=I.FileIndex[B],le.size>=4096)if(z.l=le.start+1<<9,Et&&Buffer.isBuffer(le.content))le.content.copy(z,z.l,0,le.size),z.l+=le.size+511&-512;else{for(ie=0;ie<le.size;++ie)z.write_shift(1,le.content[ie]);for(;ie&511;++ie)z.write_shift(1,0)}for(B=1;B<I.FileIndex.length;++B)if(le=I.FileIndex[B],le.size>0&&le.size<4096)if(Et&&Buffer.isBuffer(le.content))le.content.copy(z,z.l,0,le.size),z.l+=le.size+63&-64;else{for(ie=0;ie<le.size;++ie)z.write_shift(1,le.content[ie]);for(;ie&63;++ie)z.write_shift(1,0)}if(Et)z.l=z.length;else for(;z.l<z.length;)z.write_shift(1,0);return z}function N(I,V){var M=I.FullPaths.map(function(ie){return ie.toUpperCase()}),L=M.map(function(ie){var te=ie.split("/");return te[te.length-(ie.slice(-1)=="/"?2:1)]}),z=!1;V.charCodeAt(0)===47?(z=!0,V=M[0].slice(0,-1)+V):z=V.indexOf("/")!==-1;var B=V.toUpperCase(),ae=z===!0?M.indexOf(B):L.indexOf(B);if(ae!==-1)return I.FileIndex[ae];var ue=!B.match(Ju);for(B=B.replace(hi,""),ue&&(B=B.replace(Ju,"!")),ae=0;ae<M.length;++ae)if((ue?M[ae].replace(Ju,"!"):M[ae]).replace(hi,"")==B||(ue?L[ae].replace(Ju,"!"):L[ae]).replace(hi,"")==B)return I.FileIndex[ae];return null}var D=64,R=-2,He="d0cf11e0a1b11ae1",xe=[208,207,17,224,161,177,26,225],be="00000000000000000000000000000000",Ae={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:R,FREESECT:-1,HEADER_SIGNATURE:He,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:be,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ee(I,V,M){c();var L=b(I,M);l.writeFileSync(V,L)}function Z(I){for(var V=new Array(I.length),M=0;M<I.length;++M)V[M]=String.fromCharCode(I[M]);return V.join("")}function Ce(I,V){var M=b(I,V);switch(V&&V.type||"buffer"){case"file":return c(),l.writeFileSync(V.filename,M),M;case"binary":return typeof M=="string"?M:Z(M);case"base64":return $f(typeof M=="string"?M:Z(M));case"buffer":if(Et)return Buffer.isBuffer(M)?M:Ga(M);case"array":return typeof M=="string"?Bi(M):M}return M}var Le;function U(I){try{var V=I.InflateRaw,M=new V;if(M._processChunk(new Uint8Array([3,0]),M._finishFlushFlag),M.bytesRead)Le=I;else throw new Error("zlib does not expose bytesRead")}catch(L){console.error("cannot use native zlib: "+(L.message||L))}}function G(I,V){if(!Le)return wr(I,V);var M=Le.InflateRaw,L=new M,z=L._processChunk(I.slice(I.l),L._finishFlushFlag);return I.l+=L.bytesRead,z}function J(I){return Le?Le.deflateRawSync(I):ut(I)}var q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],he=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ne(I){var V=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(V>>16|V>>8|V)&255}for(var ke=typeof Uint8Array<"u",Te=ke?new Uint8Array(256):[],nt=0;nt<256;++nt)Te[nt]=Ne(nt);function K(I,V){var M=Te[I&255];return V<=8?M>>>8-V:(M=M<<8|Te[I>>8&255],V<=16?M>>>16-V:(M=M<<8|Te[I>>16&255],M>>>24-V))}function Ct(I,V){var M=V&7,L=V>>>3;return(I[L]|(M<=6?0:I[L+1]<<8))>>>M&3}function xt(I,V){var M=V&7,L=V>>>3;return(I[L]|(M<=5?0:I[L+1]<<8))>>>M&7}function Rt(I,V){var M=V&7,L=V>>>3;return(I[L]|(M<=4?0:I[L+1]<<8))>>>M&15}function pt(I,V){var M=V&7,L=V>>>3;return(I[L]|(M<=3?0:I[L+1]<<8))>>>M&31}function $e(I,V){var M=V&7,L=V>>>3;return(I[L]|(M<=1?0:I[L+1]<<8))>>>M&127}function Yt(I,V,M){var L=V&7,z=V>>>3,B=(1<<M)-1,ae=I[z]>>>L;return M<8-L||(ae|=I[z+1]<<8-L,M<16-L)||(ae|=I[z+2]<<16-L,M<24-L)||(ae|=I[z+3]<<24-L),ae&B}function En(I,V,M){var L=V&7,z=V>>>3;return L<=5?I[z]|=(M&7)<<L:(I[z]|=M<<L&255,I[z+1]=(M&7)>>8-L),V+3}function fn(I,V,M){var L=V&7,z=V>>>3;return M=(M&1)<<L,I[z]|=M,V+1}function gi(I,V,M){var L=V&7,z=V>>>3;return M<<=L,I[z]|=M&255,M>>>=8,I[z+1]=M,V+8}function Ki(I,V,M){var L=V&7,z=V>>>3;return M<<=L,I[z]|=M&255,M>>>=8,I[z+1]=M&255,I[z+2]=M>>>8,V+16}function xi(I,V){var M=I.length,L=2*M>V?2*M:V+5,z=0;if(M>=V)return I;if(Et){var B=A_(L);if(I.copy)I.copy(B);else for(;z<I.length;++z)B[z]=I[z];return B}else if(ke){var ae=new Uint8Array(L);if(ae.set)ae.set(I);else for(;z<M;++z)ae[z]=I[z];return ae}return I.length=L,I}function br(I){for(var V=new Array(I),M=0;M<I;++M)V[M]=0;return V}function vi(I,V,M){var L=1,z=0,B=0,ae=0,ue=0,ie=I.length,te=ke?new Uint16Array(32):br(32);for(B=0;B<32;++B)te[B]=0;for(B=ie;B<M;++B)I[B]=0;ie=I.length;var le=ke?new Uint16Array(ie):br(ie);for(B=0;B<ie;++B)te[z=I[B]]++,L<z&&(L=z),le[B]=0;for(te[0]=0,B=1;B<=L;++B)te[B+16]=ue=ue+te[B-1]<<1;for(B=0;B<ie;++B)ue=I[B],ue!=0&&(le[B]=te[ue+16]++);var pe=0;for(B=0;B<ie;++B)if(pe=I[B],pe!=0)for(ue=K(le[B],L)>>L-pe,ae=(1<<L+4-pe)-1;ae>=0;--ae)V[ue|ae<<pe]=pe&15|B<<4;return L}var zt=ke?new Uint16Array(512):br(512),_r=ke?new Uint16Array(32):br(32);if(!ke){for(var Zt=0;Zt<512;++Zt)zt[Zt]=0;for(Zt=0;Zt<32;++Zt)_r[Zt]=0}(function(){for(var I=[],V=0;V<32;V++)I.push(5);vi(I,_r,32);var M=[];for(V=0;V<=143;V++)M.push(8);for(;V<=255;V++)M.push(9);for(;V<=279;V++)M.push(7);for(;V<=287;V++)M.push(8);vi(M,zt,288)})();var ri=function(){for(var V=ke?new Uint8Array(32768):[],M=0,L=0;M<Se.length-1;++M)for(;L<Se[M+1];++L)V[L]=M;for(;L<32768;++L)V[L]=29;var z=ke?new Uint8Array(259):[];for(M=0,L=0;M<he.length-1;++M)for(;L<he[M+1];++L)z[L]=M;function B(ue,ie){for(var te=0;te<ue.length;){var le=Math.min(65535,ue.length-te),pe=te+le==ue.length;for(ie.write_shift(1,+pe),ie.write_shift(2,le),ie.write_shift(2,~le&65535);le-- >0;)ie[ie.l++]=ue[te++]}return ie.l}function ae(ue,ie){for(var te=0,le=0,pe=ke?new Uint16Array(32768):[];le<ue.length;){var De=Math.min(65535,ue.length-le);if(De<10){for(te=En(ie,te,+(le+De==ue.length)),te&7&&(te+=8-(te&7)),ie.l=te/8|0,ie.write_shift(2,De),ie.write_shift(2,~De&65535);De-- >0;)ie[ie.l++]=ue[le++];te=ie.l*8;continue}te=En(ie,te,+(le+De==ue.length)+2);for(var Oe=0;De-- >0;){var Ie=ue[le];Oe=(Oe<<5^Ie)&32767;var ze=-1,et=0;if((ze=pe[Oe])&&(ze|=le&-32768,ze>le&&(ze-=32768),ze<le))for(;ue[ze+et]==ue[le+et]&&et<250;)++et;if(et>2){Ie=z[et],Ie<=22?te=gi(ie,te,Te[Ie+1]>>1)-1:(gi(ie,te,3),te+=5,gi(ie,te,Te[Ie-23]>>5),te+=3);var Mt=Ie<8?0:Ie-4>>2;Mt>0&&(Ki(ie,te,et-he[Ie]),te+=Mt),Ie=V[le-ze],te=gi(ie,te,Te[Ie]>>3),te-=3;var Nt=Ie<4?0:Ie-2>>1;Nt>0&&(Ki(ie,te,le-ze-Se[Ie]),te+=Nt);for(var Ft=0;Ft<et;++Ft)pe[Oe]=le&32767,Oe=(Oe<<5^ue[le])&32767,++le;De-=et-1}else Ie<=143?Ie=Ie+48:te=fn(ie,te,1),te=gi(ie,te,Te[Ie]),pe[Oe]=le&32767,++le}te=gi(ie,te,0)-1}return ie.l=(te+7)/8|0,ie.l}return function(ie,te){return ie.length<8?B(ie,te):ae(ie,te)}}();function ut(I){var V=ge(50+Math.floor(I.length*1.1)),M=ri(I,V);return V.slice(0,M)}var nr=ke?new Uint16Array(32768):br(32768),Er=ke?new Uint16Array(32768):br(32768),mr=ke?new Uint16Array(128):br(128),ni=1,qa=1;function ca(I,V){var M=pt(I,V)+257;V+=5;var L=pt(I,V)+1;V+=5;var z=Rt(I,V)+4;V+=4;for(var B=0,ae=ke?new Uint8Array(19):br(19),ue=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ie=1,te=ke?new Uint8Array(8):br(8),le=ke?new Uint8Array(8):br(8),pe=ae.length,De=0;De<z;++De)ae[q[De]]=B=xt(I,V),ie<B&&(ie=B),te[B]++,V+=3;var Oe=0;for(te[0]=0,De=1;De<=ie;++De)le[De]=Oe=Oe+te[De-1]<<1;for(De=0;De<pe;++De)(Oe=ae[De])!=0&&(ue[De]=le[Oe]++);var Ie=0;for(De=0;De<pe;++De)if(Ie=ae[De],Ie!=0){Oe=Te[ue[De]]>>8-Ie;for(var ze=(1<<7-Ie)-1;ze>=0;--ze)mr[Oe|ze<<Ie]=Ie&7|De<<3}var et=[];for(ie=1;et.length<M+L;)switch(Oe=mr[$e(I,V)],V+=Oe&7,Oe>>>=3){case 16:for(B=3+Ct(I,V),V+=2,Oe=et[et.length-1];B-- >0;)et.push(Oe);break;case 17:for(B=3+xt(I,V),V+=3;B-- >0;)et.push(0);break;case 18:for(B=11+$e(I,V),V+=7;B-- >0;)et.push(0);break;default:et.push(Oe),ie<Oe&&(ie=Oe);break}var Mt=et.slice(0,M),Nt=et.slice(M);for(De=M;De<286;++De)Mt[De]=0;for(De=L;De<30;++De)Nt[De]=0;return ni=vi(Mt,nr,286),qa=vi(Nt,Er,30),V}function se(I,V){if(I[0]==3&&!(I[1]&3))return[Bo(V),2];for(var M=0,L=0,z=A_(V||1<<18),B=0,ae=z.length>>>0,ue=0,ie=0;!(L&1);){if(L=xt(I,M),M+=3,L>>>1)L>>1==1?(ue=9,ie=5):(M=ca(I,M),ue=ni,ie=qa);else{M&7&&(M+=8-(M&7));var te=I[M>>>3]|I[(M>>>3)+1]<<8;if(M+=32,te>0)for(!V&&ae<B+te&&(z=xi(z,B+te),ae=z.length);te-- >0;)z[B++]=I[M>>>3],M+=8;continue}for(;;){!V&&ae<B+32767&&(z=xi(z,B+32767),ae=z.length);var le=Yt(I,M,ue),pe=L>>>1==1?zt[le]:nr[le];if(M+=pe&15,pe>>>=4,!(pe>>>8&255))z[B++]=pe;else{if(pe==256)break;pe-=257;var De=pe<8?0:pe-4>>2;De>5&&(De=0);var Oe=B+he[pe];De>0&&(Oe+=Yt(I,M,De),M+=De),le=Yt(I,M,ie),pe=L>>>1==1?_r[le]:Er[le],M+=pe&15,pe>>>=4;var Ie=pe<4?0:pe-2>>1,ze=Se[pe];for(Ie>0&&(ze+=Yt(I,M,Ie),M+=Ie),!V&&ae<Oe&&(z=xi(z,Oe+100),ae=z.length);B<Oe;)z[B]=z[B-ze],++B}}}return V?[z,M+7>>>3]:[z.slice(0,B),M+7>>>3]}function wr(I,V){var M=I.slice(I.l||0),L=se(M,V);return I.l+=L[1],L[0]}function ps(I,V){if(I)typeof console<"u"&&console.error(V);else throw new Error(V)}function Qa(I,V){var M=I;Fn(M,0);var L=[],z=[],B={FileIndex:L,FullPaths:z};w(B,{root:V.root});for(var ae=M.length-4;(M[ae]!=80||M[ae+1]!=75||M[ae+2]!=5||M[ae+3]!=6)&&ae>=0;)--ae;M.l=ae+4,M.l+=4;var ue=M.read_shift(2);M.l+=6;var ie=M.read_shift(4);for(M.l=ie,ae=0;ae<ue;++ae){M.l+=20;var te=M.read_shift(4),le=M.read_shift(4),pe=M.read_shift(2),De=M.read_shift(2),Oe=M.read_shift(2);M.l+=8;var Ie=M.read_shift(4),ze=o(M.slice(M.l+pe,M.l+pe+De));M.l+=pe+De+Oe;var et=M.l;M.l=Ie+4,Xi(M,te,le,B,ze),M.l=et}return B}function Xi(I,V,M,L,z){I.l+=2;var B=I.read_shift(2),ae=I.read_shift(2),ue=a(I);if(B&8257)throw new Error("Unsupported ZIP encryption");for(var ie=I.read_shift(4),te=I.read_shift(4),le=I.read_shift(4),pe=I.read_shift(2),De=I.read_shift(2),Oe="",Ie=0;Ie<pe;++Ie)Oe+=String.fromCharCode(I[I.l++]);if(De){var ze=o(I.slice(I.l,I.l+De));(ze[21589]||{}).mt&&(ue=ze[21589].mt),((z||{})[21589]||{}).mt&&(ue=z[21589].mt)}I.l+=De;var et=I.slice(I.l,I.l+te);switch(ae){case 8:et=G(I,le);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ae)}var Mt=!1;B&8&&(ie=I.read_shift(4),ie==134695760&&(ie=I.read_shift(4),Mt=!0),te=I.read_shift(4),le=I.read_shift(4)),te!=V&&ps(Mt,"Bad compressed size: "+V+" != "+te),le!=M&&ps(Mt,"Bad uncompressed size: "+M+" != "+le),Ln(L,Oe,et,{unsafe:!0,mt:ue})}function ua(I,V){var M=V||{},L=[],z=[],B=ge(1),ae=M.compression?8:0,ue=0,ie=0,te=0,le=0,pe=0,De=I.FullPaths[0],Oe=De,Ie=I.FileIndex[0],ze=[],et=0;for(ie=1;ie<I.FullPaths.length;++ie)if(Oe=I.FullPaths[ie].slice(De.length),Ie=I.FileIndex[ie],!(!Ie.size||!Ie.content||Oe=="Sh33tJ5")){var Mt=le,Nt=ge(Oe.length);for(te=0;te<Oe.length;++te)Nt.write_shift(1,Oe.charCodeAt(te)&127);Nt=Nt.slice(0,Nt.l),ze[pe]=fR.buf(Ie.content,0);var Ft=Ie.content;ae==8&&(Ft=J(Ft)),B=ge(30),B.write_shift(4,67324752),B.write_shift(2,20),B.write_shift(2,ue),B.write_shift(2,ae),Ie.mt?s(B,Ie.mt):B.write_shift(4,0),B.write_shift(-4,ze[pe]),B.write_shift(4,Ft.length),B.write_shift(4,Ie.content.length),B.write_shift(2,Nt.length),B.write_shift(2,0),le+=B.length,L.push(B),le+=Nt.length,L.push(Nt),le+=Ft.length,L.push(Ft),B=ge(46),B.write_shift(4,33639248),B.write_shift(2,0),B.write_shift(2,20),B.write_shift(2,ue),B.write_shift(2,ae),B.write_shift(4,0),B.write_shift(-4,ze[pe]),B.write_shift(4,Ft.length),B.write_shift(4,Ie.content.length),B.write_shift(2,Nt.length),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(4,0),B.write_shift(4,Mt),et+=B.l,z.push(B),et+=Nt.length,z.push(Nt),++pe}return B=ge(22),B.write_shift(4,101010256),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,pe),B.write_shift(2,pe),B.write_shift(4,et),B.write_shift(4,le),B.write_shift(2,0),vn([vn(L),vn(z),B])}var yi={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function On(I,V){if(I.ctype)return I.ctype;var M=I.name||"",L=M.match(/\.([^\.]+)$/);return L&&yi[L[1]]||V&&(L=(M=V).match(/[\.\\]([^\.\\])+$/),L&&yi[L[1]])?yi[L[1]]:"application/octet-stream"}function tn(I){for(var V=$f(I),M=[],L=0;L<V.length;L+=76)M.push(V.slice(L,L+76));return M.join(`\r
`)+`\r
`}function fa(I){var V=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(te){var le=te.charCodeAt(0).toString(16).toUpperCase();return"="+(le.length==1?"0"+le:le)});V=V.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),V.charAt(0)==`
`&&(V="=0D"+V.slice(1)),V=V.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var M=[],L=V.split(`\r
`),z=0;z<L.length;++z){var B=L[z];if(B.length==0){M.push("");continue}for(var ae=0;ae<B.length;){var ue=76,ie=B.slice(ae,ae+ue);ie.charAt(ue-1)=="="?ue--:ie.charAt(ue-2)=="="?ue-=2:ie.charAt(ue-3)=="="&&(ue-=3),ie=B.slice(ae,ae+ue),ae+=ue,ae<B.length&&(ie+="="),M.push(ie)}}return M.join(`\r
`)}function da(I){for(var V=[],M=0;M<I.length;++M){for(var L=I[M];M<=I.length&&L.charAt(L.length-1)=="=";)L=L.slice(0,L.length-1)+I[++M];V.push(L)}for(var z=0;z<V.length;++z)V[z]=V[z].replace(/[=][0-9A-Fa-f]{2}/g,function(B){return String.fromCharCode(parseInt(B.slice(1),16))});return Bi(V.join(`\r
`))}function ha(I,V,M){for(var L="",z="",B="",ae,ue=0;ue<10;++ue){var ie=V[ue];if(!ie||ie.match(/^\s*$/))break;var te=ie.match(/^(.*?):\s*([^\s].*)$/);if(te)switch(te[1].toLowerCase()){case"content-location":L=te[2].trim();break;case"content-type":B=te[2].trim();break;case"content-transfer-encoding":z=te[2].trim();break}}switch(++ue,z.toLowerCase()){case"base64":ae=Bi(Hi(V.slice(ue).join("")));break;case"quoted-printable":ae=da(V.slice(ue));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+z)}var le=Ln(I,L.slice(M.length),ae,{unsafe:!0});B&&(le.ctype=B)}function Mn(I,V){if(Z(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var M=V&&V.root||"",L=(Et&&Buffer.isBuffer(I)?I.toString("binary"):Z(I)).split(`\r
`),z=0,B="";for(z=0;z<L.length;++z)if(B=L[z],!!/^Content-Location:/i.test(B)&&(B=B.slice(B.indexOf("file")),M||(M=B.slice(0,B.lastIndexOf("/")+1)),B.slice(0,M.length)!=M))for(;M.length>0&&(M=M.slice(0,M.length-1),M=M.slice(0,M.lastIndexOf("/")+1),B.slice(0,M.length)!=M););var ae=(L[1]||"").match(/boundary="(.*?)"/);if(!ae)throw new Error("MAD cannot find boundary");var ue="--"+(ae[1]||""),ie=[],te=[],le={FileIndex:ie,FullPaths:te};w(le);var pe,De=0;for(z=0;z<L.length;++z){var Oe=L[z];Oe!==ue&&Oe!==ue+"--"||(De++&&ha(le,L.slice(pe,z),M),pe=z)}return le}function Gr(I,V){var M=V||{},L=M.boundary||"SheetJS";L="------="+L;for(var z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+L.slice(2)+'"',"","",""],B=I.FullPaths[0],ae=B,ue=I.FileIndex[0],ie=1;ie<I.FullPaths.length;++ie)if(ae=I.FullPaths[ie].slice(B.length),ue=I.FileIndex[ie],!(!ue.size||!ue.content||ae=="Sh33tJ5")){ae=ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(et){return"_x"+et.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(et){return"_u"+et.charCodeAt(0).toString(16)+"_"});for(var te=ue.content,le=Et&&Buffer.isBuffer(te)?te.toString("binary"):Z(te),pe=0,De=Math.min(1024,le.length),Oe=0,Ie=0;Ie<=De;++Ie)(Oe=le.charCodeAt(Ie))>=32&&Oe<128&&++pe;var ze=pe>=De*4/5;z.push(L),z.push("Content-Location: "+(M.root||"file:///C:/SheetJS/")+ae),z.push("Content-Transfer-Encoding: "+(ze?"quoted-printable":"base64")),z.push("Content-Type: "+On(ue,ae)),z.push(""),z.push(ze?fa(le):tn(le))}return z.push(L+`--\r
`),z.join(`\r
`)}function tr(I){var V={};return w(V,I),V}function Ln(I,V,M,L){var z=L&&L.unsafe;z||w(I);var B=!z&&Ze.find(I,V);if(!B){var ae=I.FullPaths[0];V.slice(0,ae.length)==ae?ae=V:(ae.slice(-1)!="/"&&(ae+="/"),ae=(ae+V).replace("//","/")),B={name:i(V),type:2},I.FileIndex.push(B),I.FullPaths.push(ae),z||Ze.utils.cfb_gc(I)}return B.content=M,B.size=M?M.length:0,L&&(L.CLSID&&(B.clsid=L.CLSID),L.mt&&(B.mt=L.mt),L.ct&&(B.ct=L.ct)),B}function Bn(I,V){w(I);var M=Ze.find(I,V);if(M){for(var L=0;L<I.FileIndex.length;++L)if(I.FileIndex[L]==M)return I.FileIndex.splice(L,1),I.FullPaths.splice(L,1),!0}return!1}function ms(I,V,M){w(I);var L=Ze.find(I,V);if(L){for(var z=0;z<I.FileIndex.length;++z)if(I.FileIndex[z]==L)return I.FileIndex[z].name=i(M),I.FullPaths[z]=M,!0}return!1}function Su(I){S(I,!0)}return e.find=N,e.read=j,e.parse=d,e.write=Ce,e.writeFile=Ee,e.utils={cfb_new:tr,cfb_add:Ln,cfb_del:Bn,cfb_mov:ms,cfb_gc:Su,ReadShift:pf,CheckField:GS,prep_blob:Fn,bconcat:vn,use_zlib:U,_deflateRaw:ut,_inflateRaw:wr,consts:Ae},e}();function dR(t){return typeof t=="string"?Cp(t):Array.isArray(t)?Bb(t):t}function y0(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Cp(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Js(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([dR(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=Xo(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function hR(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Vr(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function D_(t,e){for(var r=[],n=Vr(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function Ip(t){for(var e=[],r=Vr(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function bp(t){for(var e=[],r=Vr(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function pR(t){for(var e=[],r=Vr(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var jh=new Date(1899,11,30,0,0,0);function un(t,e){var r=t.getTime(),n=jh.getTime()+(t.getTimezoneOffset()-jh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var AS=new Date,mR=jh.getTime()+(AS.getTimezoneOffset()-jh.getTimezoneOffset())*6e4,P_=AS.getTimezoneOffset();function Rp(t){var e=new Date;return e.setTime(t*24*60*60*1e3+mR),e.getTimezoneOffset()!==P_&&e.setTime(e.getTime()+(e.getTimezoneOffset()-P_)*6e4),e}function gR(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[s],10)}return e}var O_=new Date("2017-02-19T19:06:09.000Z"),kS=isNaN(O_.getFullYear())?new Date("2/19/17"):O_,xR=kS.getFullYear()==2017;function hr(t,e){var r=new Date(t);if(xR)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(kS.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function bl(t,e){if(Et&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Js(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Js(hS(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Js(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Js(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function pr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=pr(t[r]));return e}function Lr(t,e){for(var r="";r.length<e;)r+=t;return r}function Ds(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var vR=["january","february","march","april","may","june","july","august","september","october","november","december"];function Zc(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&vR.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var yR=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function CS(t){return t?t.content&&t.type?bl(t.content,!0):t.data?Qu(t.data):t.asNodeBuffer&&Et?Qu(t.asNodeBuffer().toString("binary")):t.asBinary?Qu(t.asBinary()):t._data&&t._data.getContent?Qu(bl(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function FS(t){if(!t)return null;if(t.data)return T_(t.data);if(t.asNodeBuffer&&Et)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?T_(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function _R(t){return t&&t.name.slice(-4)===".bin"?FS(t):CS(t)}function rs(t,e){for(var r=t.FullPaths||Vr(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function b1(t,e){var r=rs(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Jr(t,e,r){if(!r)return _R(b1(t,e));if(!e)return null;try{return Jr(t,e)}catch{return null}}function ji(t,e,r){if(!r)return CS(b1(t,e));if(!e)return null;try{return ji(t,e)}catch{return null}}function ER(t,e,r){return FS(b1(t,e))}function M_(t){for(var e=t.FullPaths||Vr(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function _t(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Et?n=Ga(r):n=jb(r),Ze.utils.cfb_add(t,e,n)}Ze.utils.cfb_add(t,e,r)}else t.file(e,r)}function R1(){return Ze.utils.cfb_new()}function IS(t,e){switch(e.type){case"base64":return Ze.read(t,{type:"base64"});case"binary":return Ze.read(t,{type:"binary"});case"buffer":case"array":return Ze.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Zu(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var $r=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,wR=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,L_=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,TR=/<[^>]*>/g,ti=$r.match(L_)?L_:TR,SR=/<\w*:/,AR=/<(\/?)\w+:/;function ct(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var a=t.match(wR),o=0,l="",c=0,d="",h="",p=1;if(a)for(c=0;c!=a.length;++c){for(h=a[c],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(d=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(p=(i=h.charCodeAt(s+1))==34||i==39?1:0,l=h.slice(s+1+p,h.length-p),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=l,n[d.toLowerCase()]=l;else{var g=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[g]&&d.slice(o-3,o)=="ext")continue;n[g]=l,n[g.toLowerCase()]=l}}return n}function oa(t){return t.replace(AR,"<$1")}var bS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},N1=Ip(bS),Pt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(o,l){return bS[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),D1=/[&<>'"]/g,kR=/[\u0000-\u0008\u000b-\u001f]/g;function Gt(t){var e=t+"";return e.replace(D1,function(r){return N1[r]}).replace(kR,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function B_(t){return Gt(t).replace(/ /g,"_x0020_")}var RS=/[\u0000-\u001f]/g;function P1(t){var e=t+"";return e.replace(D1,function(r){return N1[r]}).replace(/\n/g,"<br/>").replace(RS,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function CR(t){var e=t+"";return e.replace(D1,function(r){return N1[r]}).replace(RS,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var j_=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function FR(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function fr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Am(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function V_(t){var e=Bo(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function U_(t){return Ga(t,"binary").toString("utf8")}var Td="foo bar baz",Jt=Et&&(U_(Td)==Am(Td)&&U_||V_(Td)==Am(Td)&&V_)||Am,Js=Et?function(t){return Ga(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Kf=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),NS=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),IR=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),bR=/<\/?(?:vt:)?variant>/g,RR=/<(?:vt:)([^>]*)>([\s\S]*)</;function z_(t,e){var r=ct(t),n=t.match(IR(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(bR,"").match(RR);a&&i.push({v:Jt(a[2]),t:a[1]})}),i}var DS=/(^\s|\s$|\n)/;function In(t,e){return"<"+t+(e.match(DS)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function Xf(t){return Vr(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Be(t,e,r){return"<"+t+(r!=null?Xf(r):"")+(e!=null?(e.match(DS)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function qg(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function NR(t,e){switch(typeof t){case"string":var r=Be("vt:lpwstr",Gt(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Be((t|0)==t?"vt:i4":"vt:r8",Gt(String(t)));case"boolean":return Be("vt:bool",t?"true":"false")}if(t instanceof Date)return Be("vt:filetime",qg(t));throw new Error("Unable to serialize "+t)}function O1(t){if(Et&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Jt(Xo(C1(t)));throw new Error("Bad input format: expected Buffer or string")}var Yf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,an={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},zl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Mi={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function DR(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function PR(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var W_=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},H_=Et?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Ga(e)})):W_(t)}:W_,$_=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(ka(t,i)));return n.join("").replace(hi,"")},M1=Et?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(hi,""):$_(t,e,r)}:$_,G_=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},PS=Et?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):G_(t,e,r)}:G_,K_=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(hc(t,i)));return n.join("")},_0=Et?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):K_(e,r,n)}:K_,OS=function(t,e){var r=Li(t,e);return r>0?_0(t,e+4,e+4+r-1):""},MS=OS,LS=function(t,e){var r=Li(t,e);return r>0?_0(t,e+4,e+4+r-1):""},BS=LS,jS=function(t,e){var r=2*Li(t,e);return r>0?_0(t,e+4,e+4+r-1):""},VS=jS,US=function(e,r){var n=Li(e,r);return n>0?M1(e,r+4,r+4+n):""},zS=US,WS=function(t,e){var r=Li(t,e);return r>0?_0(t,e+4,e+4+r):""},HS=WS,$S=function(t,e){return DR(t,e)},Vh=$S,L1=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Et&&(MS=function(e,r){if(!Buffer.isBuffer(e))return OS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},BS=function(e,r){if(!Buffer.isBuffer(e))return LS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},VS=function(e,r){if(!Buffer.isBuffer(e))return jS(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},zS=function(e,r){if(!Buffer.isBuffer(e))return US(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},HS=function(e,r){if(!Buffer.isBuffer(e))return WS(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Vh=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):$S(e,r)},L1=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var hc=function(t,e){return t[e]},ka=function(t,e){return t[e+1]*256+t[e]},OR=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Li=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},ul=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},MR=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function pf(t,e){var r="",n,i,s=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,Et&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(ka(this,c)),c+=2;t*=2;break;case"utf8":r=_0(this,this.l,this.l+t);break;case"utf16le":t*=2,r=M1(this,this.l,this.l+t);break;case"wstr":return pf.call(this,t,"dbcs");case"lpstr-ansi":r=MS(this,this.l),t=4+Li(this,this.l);break;case"lpstr-cp":r=BS(this,this.l),t=4+Li(this,this.l);break;case"lpwstr":r=VS(this,this.l),t=4+2*Li(this,this.l);break;case"lpp4":t=4+Li(this,this.l),r=zS(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Li(this,this.l),r=HS(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=hc(this,this.l+t++))!==0;)s.push(wd(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=ka(this,this.l+t))!==0;)s.push(wd(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=hc(this,c),this.l=c+1,o=pf.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(wd(ka(this,c))),c+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=hc(this,c),this.l=c+1,o=pf.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(wd(hc(this,c))),c+=1}r=s.join("");break;default:switch(t){case 1:return n=hc(this,this.l),this.l++,n;case 2:return n=(e==="i"?OR:ka)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?ul:MR)(this,this.l),this.l+=4,n):(i=Li(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=Vh(this,this.l):i=Vh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=PS(this,this.l,t);break}}return this.l+=t,r}var LR=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},BR=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},jR=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function VR(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)jR(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,LR(this,e,this.l);break;case 8:if(n=8,r==="f"){PR(this,e,this.l);break}case 16:break;case-4:n=4,BR(this,e,this.l);break}return this.l+=n,this}function GS(t,e){var r=PS(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Fn(t,e){t.l=e,t.read_shift=pf,t.chk=GS,t.write_shift=VR}function Zn(t,e){t.l+=e}function ge(t){var e=Bo(t);return Fn(e,0),e}function Ka(t,e,r){if(t){var n,i,s;Fn(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=t0[o]||t0[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;l=t.l+s;var d=c.f&&c.f(t,s,r);if(t.l=l,e(d,c,o))return}}}function Ii(){var t=[],e=Et?256:2048,r=function(c){var d=ge(c);return Fn(d,0),d},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,e)))},a=function(){return i(),vn(t)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function we(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=t0[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&L1(r)&&t.push(r)}}function mf(t,e,r){var n=pr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function X_(t,e,r){var n=pr(t);return n.s=mf(n.s,e.s,r),n.e=mf(n.e,e.s,r),n}function gf(t,e){if(t.cRel&&t.c<0)for(t=pr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=pr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=ot(t);return!t.cRel&&t.cRel!=null&&(r=WR(r)),!t.rRel&&t.rRel!=null&&(r=UR(r)),r}function km(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Ar(t.s.c)+":"+(t.e.cRel?"":"$")+Ar(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Hr(t.s.r)+":"+(t.e.rRel?"":"$")+Hr(t.e.r):gf(t.s,e.biff)+":"+gf(t.e,e.biff)}function B1(t){return parseInt(zR(t),10)-1}function Hr(t){return""+(t+1)}function UR(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function zR(t){return t.replace(/\$(\d+)$/,"$1")}function j1(t){for(var e=HR(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Ar(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function WR(t){return t.replace(/^([A-Z])/,"$$$1")}function HR(t){return t.replace(/^\$([A-Z])/,"$1")}function $R(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function kr(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function ot(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function bi(t){var e=t.indexOf(":");return e==-1?{s:kr(t),e:kr(t)}:{s:kr(t.slice(0,e)),e:kr(t.slice(e+1))}}function vt(t,e){return typeof e>"u"||typeof e=="number"?vt(t.s,t.e):(typeof t!="string"&&(t=ot(t)),typeof e!="string"&&(e=ot(e)),t==e?t:t+":"+e)}function Ot(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function Y_(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=ds(t.z,r?un(e):e)}catch{}try{return t.w=ds((t.XF||{}).numFmtId||(r?14:0),r?un(e):e)}catch{return""+e}}function ja(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Xa[t.v]||t.v:e==null?Y_(t,t.v):Y_(t,e))}function Yo(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function KS(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?kr(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=Ot(s["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),a==-1&&(c.e.r=a=d.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=e[h].length;++p)if(!(typeof e[h][p]>"u")){var g={v:e[h][p]},y=a+h,x=o+p;if(c.s.r>y&&(c.s.r=y),c.s.c>x&&(c.s.c=x),c.e.r<y&&(c.e.r=y),c.e.c<x&&(c.e.c=x),e[h][p]&&typeof e[h][p]=="object"&&!Array.isArray(e[h][p])&&!(e[h][p]instanceof Date))g=e[h][p];else if(Array.isArray(g.v)&&(g.f=e[h][p][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(n.nullError)g.t="e",g.v=0;else if(n.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=n.dateNF||at[14],n.cellDates?(g.t="d",g.w=ds(g.z,un(g.v))):(g.t="n",g.v=un(g.v),g.w=ds(g.z,g.v))):g.t="s";if(i)s[y]||(s[y]=[]),s[y][x]&&s[y][x].z&&(g.z=s[y][x].z),s[y][x]=g;else{var E=ot({c:x,r:y});s[E]&&s[E].z&&(g.z=s[E].z),s[E]=g}}}return c.s.c<1e7&&(s["!ref"]=vt(c)),s}function gu(t,e){return KS(null,t,e)}function GR(t){return t.read_shift(4,"i")}function Ps(t,e){return e||(e=ge(4)),e.write_shift(4,t),e}function Qn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function yn(t,e){var r=!1;return e==null&&(r=!0,e=ge(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function KR(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function XR(t,e){return e||(e=ge(4)),e.write_shift(2,0),e.write_shift(2,0),e}function V1(t,e){var r=t.l,n=t.read_shift(1),i=Qn(t),s=[],a={t:i,h:i};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)s.push(KR(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function YR(t,e){var r=!1;return e==null&&(r=!0,e=ge(15+4*t.t.length)),e.write_shift(1,0),yn(t.t,e),r?e.slice(0,e.l):e}var qR=V1;function QR(t,e){var r=!1;return e==null&&(r=!0,e=ge(23+4*t.t.length)),e.write_shift(1,1),yn(t.t,e),e.write_shift(4,1),XR({},e),r?e.slice(0,e.l):e}function hs(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Wl(t,e){return e==null&&(e=ge(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Hl(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function $l(t,e){return e==null&&(e=ge(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var JR=Qn,XS=yn;function U1(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Uh(t,e){var r=!1;return e==null&&(r=!0,e=ge(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var ZR=Qn,Qg=U1,z1=Uh;function W1(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?Vh([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):ul(e,0)>>2;return r?i/100:i}function YS(t,e){e==null&&(e=ge(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function qS(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function eN(t,e){return e||(e=ge(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Gl=qS,xu=eN;function qn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Rl(t,e){return(e||ge(8)).write_shift(8,t,"f")}function tN(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var c=vl[i];c&&(e.rgb=Qf(c));break;case 2:e.rgb=Qf([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function zh(t,e){if(e||(e=ge(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function rN(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function nN(t,e){e||(e=ge(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function QS(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function iN(t){return QS(t,1)}function sN(t){return QS(t,2)}var H1=2,Ti=3,Sd=11,q_=12,Wh=19,Ad=64,aN=65,oN=71,lN=4108,cN=4126,mn=80,JS=81,uN=[mn,JS],Jg={1:{n:"CodePage",t:H1},2:{n:"Category",t:mn},3:{n:"PresentationFormat",t:mn},4:{n:"ByteCount",t:Ti},5:{n:"LineCount",t:Ti},6:{n:"ParagraphCount",t:Ti},7:{n:"SlideCount",t:Ti},8:{n:"NoteCount",t:Ti},9:{n:"HiddenCount",t:Ti},10:{n:"MultimediaClipCount",t:Ti},11:{n:"ScaleCrop",t:Sd},12:{n:"HeadingPairs",t:lN},13:{n:"TitlesOfParts",t:cN},14:{n:"Manager",t:mn},15:{n:"Company",t:mn},16:{n:"LinksUpToDate",t:Sd},17:{n:"CharacterCount",t:Ti},19:{n:"SharedDoc",t:Sd},22:{n:"HyperlinksChanged",t:Sd},23:{n:"AppVersion",t:Ti,p:"version"},24:{n:"DigSig",t:aN},26:{n:"ContentType",t:mn},27:{n:"ContentStatus",t:mn},28:{n:"Language",t:mn},29:{n:"Version",t:mn},255:{},2147483648:{n:"Locale",t:Wh},2147483651:{n:"Behavior",t:Wh},1919054434:{}},Zg={1:{n:"CodePage",t:H1},2:{n:"Title",t:mn},3:{n:"Subject",t:mn},4:{n:"Author",t:mn},5:{n:"Keywords",t:mn},6:{n:"Comments",t:mn},7:{n:"Template",t:mn},8:{n:"LastAuthor",t:mn},9:{n:"RevNumber",t:mn},10:{n:"EditTime",t:Ad},11:{n:"LastPrinted",t:Ad},12:{n:"CreatedDate",t:Ad},13:{n:"ModifiedDate",t:Ad},14:{n:"PageCount",t:Ti},15:{n:"WordCount",t:Ti},16:{n:"CharCount",t:Ti},17:{n:"Thumbnail",t:oN},18:{n:"Application",t:mn},19:{n:"DocSecurity",t:Ti},255:{},2147483648:{n:"Locale",t:Wh},2147483651:{n:"Behavior",t:Wh},1919054434:{}},Q_={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},fN=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function dN(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var hN=dN([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),vl=pr(hN),Xa={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ZS={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ex={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},kd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function $1(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function pN(t){var e=$1();if(!t||!t.match)return e;var r={};if((t.match(ti)||[]).forEach(function(n){var i=ct(n);switch(i[0].replace(SR,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[ex[i.ContentType]]!==void 0&&e[ex[i.ContentType]].push(i.PartName);break}}),e.xmlns!==an.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function eA(t,e){var r=pR(ex),n=[],i;n[n.length]=$r,n[n.length]=Be("Types",null,{xmlns:an.CT,"xmlns:xsd":an.xsd,"xmlns:xsi":an.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Be("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],n[n.length]=Be("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:kd[l][e.bookType]||kd[l].xlsx}))},a=function(l){(t[l]||[]).forEach(function(c){n[n.length]=Be("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:kd[l][e.bookType]||kd[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(c){n[n.length]=Be("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var wt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function qf(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function xf(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(ti)||[]).forEach(function(i){var s=ct(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Zu(s.Target,e);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}function jc(t){var e=[$r,Be("Relationships",null,{xmlns:an.RELS})];return Vr(t["!id"]).forEach(function(r){e[e.length]=Be("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function $t(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[wt.HLINK,wt.XPATH,wt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var mN="application/vnd.oasis.opendocument.spreadsheet";function gN(t,e){for(var r=O1(t),n,i;n=Yf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=ct(n[0],!1),i.path=="/"&&i.type!==mN)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function xN(t){var e=[$r];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function J_(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function vN(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function yN(t){var e=[$r];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(J_(t[r][0],t[r][1])),e.push(vN("",t[r][0]));return e.push(J_("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function tA(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Oh.version+"</meta:generator></office:meta></office:document-meta>"}var cs=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],_N=function(){for(var t=new Array(cs.length),e=0;e<cs.length;++e){var r=cs[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function rA(t){var e={};t=Jt(t);for(var r=0;r<cs.length;++r){var n=cs[r],i=t.match(_N[r]);i!=null&&i.length>0&&(e[n[1]]=Pt(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=hr(e[n[1]]))}return e}function Cm(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=Gt(e),n[n.length]=r?Be(t,e,r):In(t,e))}function nA(t,e){var r=e||{},n=[$r,Be("cp:coreProperties",null,{"xmlns:cp":an.CORE_PROPS,"xmlns:dc":an.dc,"xmlns:dcterms":an.dcterms,"xmlns:dcmitype":an.dcmitype,"xmlns:xsi":an.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&Cm("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:qg(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&Cm("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:qg(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=cs.length;++s){var a=cs[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Cm(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var yl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],iA=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function sA(t,e,r,n){var i=[];if(typeof t=="string")i=z_(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(d){return{v:d}}));var a=typeof e=="string"?z_(e,n).map(function(d){return d.v}):e,o=0,l=0;if(a.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function EN(t,e,r){var n={};return e||(e={}),t=Jt(t),yl.forEach(function(i){var s=(t.match(Kf(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=Pt(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&sA(n.HeadingPairs,n.TitlesOfParts,e,r),e}function aA(t){var e=[],r=Be;return t||(t={}),t.Application="SheetJS",e[e.length]=$r,e[e.length]=Be("Properties",null,{xmlns:an.EXT_PROPS,"xmlns:vt":an.vt}),yl.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Gt(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Gt(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var wN=/<[^>]+>[^<]*/g;function TN(t,e){var r={},n="",i=t.match(wN);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=ct(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Pt(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),c=l[0].slice(4),d=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=Pt(d);break;case"bool":r[n]=fr(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=hr(d);break;case"cy":case"error":r[n]=Pt(d);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}function oA(t){var e=[$r,Be("Properties",null,{xmlns:an.CUST_PROPS,"xmlns:vt":an.vt})];if(!t)return e.join("");var r=1;return Vr(t).forEach(function(i){++r,e[e.length]=Be("property",NR(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Gt(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var tx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Fm;function SN(t,e,r){Fm||(Fm=Ip(tx)),e=Fm[e]||e,t[e]=r}function AN(t,e){var r=[];return Vr(tx).map(function(n){for(var i=0;i<cs.length;++i)if(cs[i][1]==n)return cs[i];for(i=0;i<yl.length;++i)if(yl[i][1]==n)return yl[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(In(tx[n[1]]||n[1],i))}}),Be("DocumentProperties",r.join(""),{xmlns:Mi.o})}function kN(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&Vr(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<cs.length;++a)if(s==cs[a][1])return;for(a=0;a<yl.length;++a)if(s==yl[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(Be(B_(s),o,{"dt:dt":l}))}}),e&&Vr(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(Be(B_(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Mi.o+'">'+i.join("")+"</"+n+">"}function G1(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function CN(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=ge(8);return a.write_shift(4,n),a.write_shift(4,i),a}function lA(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function cA(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function uA(t,e,r){return e===31?cA(t):lA(t,e,r)}function rx(t,e,r){return uA(t,e,r===!1?0:4)}function FN(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return uA(t,e,0)}function IN(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(hi,""),t.l-i&2&&(t.l+=2)}return r}function bN(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(hi,"");return r}function RN(t){var e=t.l,r=Hh(t,JS);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Hh(t,Ti);return[r,n]}function NN(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(RN(t));return r}function Z_(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),a=t.read_shift(4);n[s]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(hi,"").replace(Ju,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function fA(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function DN(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Hh(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==q_&&n!==e&&uN.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===q_?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return lA(t,n,4).replace(hi,"");case 31:return cA(t);case 64:return G1(t);case 65:return fA(t);case 71:return DN(t);case 80:return rx(t,n,!s.raw).replace(hi,"");case 81:return FN(t,n).replace(hi,"");case 4108:return NN(t);case 4126:case 4127:return n==4127?IN(t):bN(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function e2(t,e){var r=ge(4),n=ge(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=ge(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=CN(e);break;case 31:case 80:for(n=ge(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return vn([r,n])}function t2(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0,o=0,l=-1,c={};for(a=0;a!=i;++a){var d=t.read_shift(4),h=t.read_shift(4);s[a]=[d,h+r]}s.sort(function(A,_){return A[1]-_[1]});var p={};for(a=0;a!=i;++a){if(t.l!==s[a][1]){var g=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:t.l+2===s[a][1]&&(t.l+=2,g=!1);break;case 80:t.l<=s[a][1]&&(t.l=s[a][1],g=!1);break;case 4108:t.l<=s[a][1]&&(t.l=s[a][1],g=!1);break}if((!e||a==0)&&t.l<=s[a][1]&&(g=!1,t.l=s[a][1]),g)throw new Error("Read Error: Expected address "+s[a][1]+" at "+t.l+" :"+a)}if(e){var y=e[s[a][0]];if(p[y.n]=Hh(t,y.t,{raw:!0}),y.p==="version"&&(p[y.n]=String(p[y.n]>>16)+"."+("0000"+String(p[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(p[y.n]){case 0:p[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Fs(o=p[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[y.n])}}else if(s[a][0]===1){if(o=p.CodePage=Hh(t,H1),Fs(o),l!==-1){var x=t.l;t.l=s[l][1],c=Z_(t,o),t.l=x}}else if(s[a][0]===0){if(o===0){l=a,t.l=s[a+1][1];continue}c=Z_(t,o)}else{var E=c[s[a][0]],T;switch(t[t.l]){case 65:t.l+=4,T=fA(t);break;case 30:t.l+=4,T=rx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,T=rx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,T=t.read_shift(4,"i");break;case 19:t.l+=4,T=t.read_shift(4);break;case 5:t.l+=4,T=t.read_shift(8,"f");break;case 11:t.l+=4,T=Ur(t,4);break;case 64:t.l+=4,T=hr(G1(t));break;default:throw new Error("unparsed value: "+t[t.l])}p[E]=T}}return t.l=r+n,p}var dA=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function PN(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function r2(t,e,r){var n=ge(8),i=[],s=[],a=8,o=0,l=ge(8),c=ge(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),a+=8+l.length,!e){c=ge(8),c.write_shift(4,0),i.unshift(c);var d=[ge(4)];for(d[0].write_shift(4,t.length),o=0;o<t.length;++o){var h=t[o][0];for(l=ge(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);d.push(l)}l=vn(d),s.unshift(l),a+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(dA.indexOf(t[o][0])>-1||iA.indexOf(t[o][0])>-1)&&t[o][1]!=null){var p=t[o][1],g=0;if(e){g=+e[t[o][0]];var y=r[g];if(y.p=="version"&&typeof p=="string"){var x=p.split(".");p=(+x[0]<<16)+(+x[1]||0)}l=e2(y.t,p)}else{var E=PN(p);E==-1&&(E=31,p=String(p)),l=e2(E,p)}s.push(l),c=ge(8),c.write_shift(4,e?g:2+o),i.push(c),a+=8+l.length}var T=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,T),T+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),vn([n].concat(i).concat(s))}function n2(t,e,r){var n=t.content;if(!n)return{};Fn(n,0);var i,s,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),d=n.read_shift(16);if(d!==Ze.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),l=n.read_shift(4));var h=t2(n,e),p={SystemIdentifier:c};for(var g in h)p[g]=h[g];if(p.FMTID=s,i===1)return p;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var y;try{y=t2(n,null)}catch{}for(g in y)p[g]=y[g];return p.FMTID=[s,a],p}function i2(t,e,r,n,i,s){var a=ge(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Ze.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=r2(t,r,n);if(o.push(l),i){var c=r2(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(c)}return vn(o)}function ao(t,e){return t.read_shift(e),null}function ON(t,e){e||(e=ge(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function MN(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function Ur(t,e){return t.read_shift(e)===1}function fi(t,e){return e||(e=ge(2)),e.write_shift(2,+!!t),e}function Zr(t){return t.read_shift(2,"u")}function ns(t,e){return e||(e=ge(2)),e.write_shift(2,t),e}function hA(t,e){return MN(t,e,Zr)}function LN(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function pA(t,e,r){return r||(r=ge(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function E0(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return a}function BN(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,s=1+(r&1),a=0,o,l={};i&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",d=e===0?"":t.read_shift(e,c);return i&&(t.l+=4*a),n&&(t.l+=o),l.t=d,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function jN(t){var e=t.t||"",r=ge(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=ge(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return vn(i)}function Nl(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function w0(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Nl(t,n,r)}function Kl(t,e,r){if(r.biff>5)return w0(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function mA(t,e,r){return r||(r=ge(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function VN(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function UN(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(hi,"");return n&&(t.l+=24),i}function zN(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(s>>1,"utf16le").replace(hi,"");return r+a}function WN(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return UN(t);case"0303000000000000c000000000000046":return zN(t);default:throw new Error("Unsupported Moniker "+r)}}function Cd(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(hi,""):"";return r}function s2(t,e){e||(e=ge(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function HN(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,a,o,l,c="",d,h;i&16&&(s=Cd(t,r-t.l)),i&128&&(a=Cd(t,r-t.l)),(i&257)===257&&(o=Cd(t,r-t.l)),(i&257)===1&&(l=WN(t,r-t.l)),i&8&&(c=Cd(t,r-t.l)),i&32&&(d=t.read_shift(16)),i&64&&(h=G1(t)),t.l=r;var p=a||o||l||"";p&&c&&(p+="#"+c),p||(p="#"+c),i&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var g={Target:p};return d&&(g.guid=d),h&&(g.time=h),s&&(g.Tooltip=s),g}function $N(t){var e=ge(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),s2(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&s2(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function gA(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function xA(t,e){var r=gA(t);return r[3]=0,r}function la(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Dl(t,e,r,n){return n||(n=ge(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function GN(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function KN(t,e,r){return e===0?"":Kl(t,e,r)}function XN(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function vA(t){var e=t.read_shift(2),r=W1(t);return[e,r]}function YN(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=E0(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function Np(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function yA(t,e){return e||(e=ge(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function _A(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var qN=_A;function EA(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function QN(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function JN(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function zn(t){t.l+=2,t.l+=t.read_shift(2)}var ZN={0:zn,4:zn,5:zn,6:zn,7:JN,8:zn,9:zn,10:zn,11:zn,12:zn,13:QN,14:zn,15:zn,16:zn,17:zn,18:zn,19:zn,20:zn,21:EA};function e3(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(ZN[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Fd(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function K1(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ge(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function t3(t,e){return e===0||t.read_shift(2),1200}function r3(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=Kl(t,0,r);return t.read_shift(e+n-t.l),i}function n3(t,e){var r=!e||e.biff==8,n=ge(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function i3(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function s3(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=E0(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function a3(t,e){var r=!e||e.biff>=8?2:1,n=ge(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function o3(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0;a!=i&&t.l<r;++a)s.push(BN(t));return s.Count=n,s.Unique=i,s}function l3(t,e){var r=ge(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=jN(t[i]);var s=vn([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function c3(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function u3(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function f3(t){var e=GN(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function d3(t){return t.read_shift(2),t.read_shift(4)}function a2(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function h3(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:c}}function p3(){var t=ge(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function m3(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function g3(t){var e=ge(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function x3(){}function v3(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=E0(t,0,r),n}function y3(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=ge(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function _3(t){var e=la(t);return e.isst=t.read_shift(4),e}function E3(t,e,r,n){var i=ge(10);return Dl(t,e,n,i),i.write_shift(4,r),i}function w3(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=la(t);r.biff==2&&t.l++;var s=w0(t,n-t.l,r);return i.val=s,i}function T3(t,e,r,n,i){var s=!i||i.biff==8,a=ge(8+ +s+(1+s)*r.length);return Dl(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function S3(t,e,r){var n=t.read_shift(2),i=Kl(t,0,r);return[n,i]}function A3(t,e,r,n){var i=r&&r.biff==5;n||(n=ge(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var k3=Kl;function o2(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),a=t.read_shift(i),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:s,c:o},e:{r:a,c:l}}}function C3(t,e){var r=e.biff==8||!e.biff?4:2,n=ge(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function F3(t){var e=t.read_shift(2),r=t.read_shift(2),n=vA(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function I3(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(vA(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function b3(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function R3(t,e,r,n){var i={},s=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return i.patternType=fN[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function N3(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=R3(t,e,n.fStyle,r),n}function l2(t,e,r,n){var i=r&&r.biff==5;n||(n=ge(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function D3(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function P3(t){var e=ge(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function c2(t,e,r){var n=la(t);(r.biff==2||e==9)&&++t.l;var i=LN(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function O3(t,e,r,n,i,s){var a=ge(8);return Dl(t,e,n,a),pA(r,s,a),a}function M3(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=la(t),i=qn(t);return n.val=i,n}function L3(t,e,r,n){var i=ge(14);return Dl(t,e,n,i),Rl(r,i),i}var u2=KN;function B3(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=Nl(t,s),o=[];n>t.l;)o.push(w0(t));return[s,i,a,o]}function f2(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=YN(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var j3=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function d2(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=Nl(t,a,r);i&32&&(c=j3[c.charCodeAt(0)]);var d=n-t.l;r&&r.biff==2&&--d;var h=n==t.l||o===0||!(d>0)?[]:e5(t,d,r,o);return{chKey:s,Name:c,itab:l,rgce:h}}function wA(t,e,r){if(r.biff<8)return V3(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(XN(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function V3(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=E0(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function U3(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=Nl(t,n,r),a=Nl(t,i,r);return[s,a]}function z3(t,e,r){var n=_A(t);t.l++;var i=t.read_shift(1);return e-=8,[t5(t,e,r),i,n]}function h2(t,e,r){var n=qN(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,J8(t,e,r)]}function W3(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function H3(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=Kl(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},o,a,s]}}function $3(t,e,r){return H3(t,e,r)}function G3(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Np(t));return r}function K3(t){var e=ge(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)yA(t[r],e);return e}function X3(t,e,r){if(r&&r.biff<8)return q3(t,e,r);var n=EA(t),i=e3(t,e-22,n[1]);return{cmo:n,ft:i}}var Y3={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function q3(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((Y3[n]||Zn)(t,e,r)),{cmo:[i,n,s],ft:a}}function Q3(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:a=VN(t,6,r);var o=t.read_shift(2);t.read_shift(2),Zr(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var d=t[t.l],h=Nl(t,t.lens[c+1]-t.lens[c]-1);if(i+=h,i.length>=(d?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function J3(t,e){var r=Np(t);t.l+=16;var n=HN(t,e-24);return[r,n]}function Z3(t){var e=ge(24),r=kr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return vn([e,$N(t[1])])}function eD(t,e){t.read_shift(2);var r=Np(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(hi,""),[r,n]}function tD(t){var e=t[1].Tooltip,r=ge(10+2*(e.length+1));r.write_shift(2,2048);var n=kr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function rD(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=Q_[r]||r,r=t.read_shift(2),e[1]=Q_[r]||r,e}function nD(t){return t||(t=ge(4)),t.write_shift(2,1),t.write_shift(2,1),t}function iD(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(xA(t));return r}function sD(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(xA(t));return r}function aD(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function TA(t,e,r){if(!r.cellStyles)return Zn(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function oD(t,e){var r=ge(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function lD(t,e){var r={};return e<32||(t.l+=16,r.header=qn(t),r.footer=qn(t),t.l+=2),r}function cD(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}function uD(t){for(var e=ge(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var fD=la,dD=hA,hD=w0;function pD(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function mD(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=la(t);++t.l;var i=Kl(t,e-7,r);return n.t="str",n.val=i,n}function gD(t){var e=la(t);++t.l;var r=qn(t);return e.t="n",e.val=r,e}function xD(t,e,r){var n=ge(15);return k0(n,t,e),n.write_shift(8,r,"f"),n}function vD(t){var e=la(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function yD(t,e,r){var n=ge(9);return k0(n,t,e),n.write_shift(2,r),n}function _D(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function ED(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function wD(t,e,r){var n=t.l+e,i=la(t),s=t.read_shift(2),a=Nl(t,s,r);return t.l=n,i.t="str",i.val=a,i}var TD=[2,3,48,49,131,139,140,245],nx=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Ip({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],d=Bo(1);switch(l.type){case"base64":d=Bi(Hi(o));break;case"binary":d=Bi(o);break;case"buffer":case"array":d=o;break}Fn(d,0);var h=d.read_shift(1),p=!!(h&136),g=!1,y=!1;switch(h){case 2:break;case 3:break;case 48:g=!0,p=!0;break;case 49:g=!0,p=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var x=0,E=521;h==2&&(x=d.read_shift(2)),d.l+=3,h!=2&&(x=d.read_shift(4)),x>1048576&&(x=1e6),h!=2&&(E=d.read_shift(2));var T=d.read_shift(2),A=l.codepage||1252;h!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(A=t[d[d.l]]),d.l+=1,d.l+=2),y&&(d.l+=36);for(var _=[],P={},W=Math.min(d.length,h==2?521:E-10-(g?264:0)),j=y?32:11;d.l<W&&d[d.l]!=13;)switch(P={},P.name=Hf.utils.decode(A,d.slice(d.l,d.l+j)).replace(/[\u0000\r\n].*$/g,""),d.l+=j,P.type=String.fromCharCode(d.read_shift(1)),h!=2&&!y&&(P.offset=d.read_shift(4)),P.len=d.read_shift(1),h==2&&(P.offset=d.read_shift(2)),P.dec=d.read_shift(1),P.name.length&&_.push(P),h!=2&&(d.l+=y?13:14),P.type){case"B":(!g||P.len!=8)&&l.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+P.type)}if(d[d.l]!==13&&(d.l=E-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=E;var w=0,F=0;for(c[0]=[],F=0;F!=_.length;++F)c[0][F]=_[F].name;for(;x-- >0;){if(d[d.l]===42){d.l+=T;continue}for(++d.l,c[++w]=[],F=0,F=0;F!=_.length;++F){var S=d.slice(d.l,d.l+_[F].len);d.l+=_[F].len,Fn(S,0);var b=Hf.utils.decode(A,S);switch(_[F].type){case"C":b.trim().length&&(c[w][F]=b.replace(/\s+$/,""));break;case"D":b.length===8?c[w][F]=new Date(+b.slice(0,4),+b.slice(4,6)-1,+b.slice(6,8)):c[w][F]=b;break;case"F":c[w][F]=parseFloat(b.trim());break;case"+":case"I":c[w][F]=y?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(b.trim().toUpperCase()){case"Y":case"T":c[w][F]=!0;break;case"N":case"F":c[w][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+b+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[w][F]="##MEMO##"+(y?parseInt(b.trim(),10):S.read_shift(4));break;case"N":b=b.replace(/\u0000/g,"").trim(),b&&b!="."&&(c[w][F]=+b||0);break;case"@":c[w][F]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":c[w][F]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":c[w][F]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[w][F]=-S.read_shift(-8,"f");break;case"B":if(g&&_[F].len==8){c[w][F]=S.read_shift(8,"f");break}case"G":case"P":S.l+=_[F].len;break;case"0":if(_[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[F].type)}}}if(h!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=_,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var d=gu(r(o,c),c);return d["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,d}function i(o,l){try{return Yo(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&Fs(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var d=Ii(),h=Kh(o,{header:1,raw:!0,cellDates:!0}),p=h[0],g=h.slice(1),y=o["!cols"]||[],x=0,E=0,T=0,A=1;for(x=0;x<p.length;++x){if(((y[x]||{}).DBF||{}).name){p[x]=y[x].DBF.name,++T;continue}if(p[x]!=null){if(++T,typeof p[x]=="number"&&(p[x]=p[x].toString(10)),typeof p[x]!="string")throw new Error("DBF Invalid column name "+p[x]+" |"+typeof p[x]+"|");if(p.indexOf(p[x])!==x){for(E=0;E<1024;++E)if(p.indexOf(p[x]+"_"+E)==-1){p[x]+="_"+E;break}}}}var _=Ot(o["!ref"]),P=[],W=[],j=[];for(x=0;x<=_.e.c-_.s.c;++x){var w="",F="",S=0,b=[];for(E=0;E<g.length;++E)g[E][x]!=null&&b.push(g[E][x]);if(b.length==0||p[x]==null){P[x]="?";continue}for(E=0;E<b.length;++E){switch(typeof b[E]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=b[E]instanceof Date?"D":"C";break;default:F="C"}S=Math.max(S,String(b[E]).length),w=w&&w!=F?"C":F}S>250&&(S=250),F=((y[x]||{}).DBF||{}).type,F=="C"&&y[x].DBF.len>S&&(S=y[x].DBF.len),w=="B"&&F=="N"&&(w="N",j[x]=y[x].DBF.dec,S=y[x].DBF.len),W[x]=w=="C"||F=="N"?S:s[w]||0,A+=W[x],P[x]=w}var N=d.next(32);for(N.write_shift(4,318902576),N.write_shift(4,g.length),N.write_shift(2,296+32*T),N.write_shift(2,A),x=0;x<4;++x)N.write_shift(4,0);for(N.write_shift(4,0|(+e[dS]||3)<<8),x=0,E=0;x<p.length;++x)if(p[x]!=null){var D=d.next(32),R=(p[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,R,"sbcs"),D.write_shift(1,P[x]=="?"?"C":P[x],"sbcs"),D.write_shift(4,E),D.write_shift(1,W[x]||s[P[x]]||0),D.write_shift(1,j[x]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),E+=W[x]||s[P[x]]||0}var He=d.next(264);for(He.write_shift(4,13),x=0;x<65;++x)He.write_shift(4,0);for(x=0;x<g.length;++x){var xe=d.next(A);for(xe.write_shift(1,0),E=0;E<p.length;++E)if(p[E]!=null)switch(P[E]){case"L":xe.write_shift(1,g[x][E]==null?63:g[x][E]?84:70);break;case"B":xe.write_shift(8,g[x][E]||0,"f");break;case"N":var be="0";for(typeof g[x][E]=="number"&&(be=g[x][E].toFixed(j[E]||0)),T=0;T<W[E]-be.length;++T)xe.write_shift(1,32);xe.write_shift(1,be,"sbcs");break;case"D":g[x][E]?(xe.write_shift(4,("0000"+g[x][E].getFullYear()).slice(-4),"sbcs"),xe.write_shift(2,("00"+(g[x][E].getMonth()+1)).slice(-2),"sbcs"),xe.write_shift(2,("00"+g[x][E].getDate()).slice(-2),"sbcs")):xe.write_shift(8,"00000000","sbcs");break;case"C":var Ae=String(g[x][E]!=null?g[x][E]:"").slice(0,W[E]);for(xe.write_shift(1,Ae,"sbcs"),T=0;T<W[E]-Ae.length;++T)xe.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),SA=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Vr(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,g){var y=t[g];return typeof y=="number"?S_(y):y},n=function(p,g,y){var x=g.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return x==59?p:S_(x)};t["|"]=254;function i(p,g){switch(g.type){case"base64":return s(Hi(p),g);case"binary":return s(p,g);case"buffer":return s(Et&&Buffer.isBuffer(p)?p.toString("binary"):Xo(p),g);case"array":return s(bl(p),g)}throw new Error("Unrecognized type "+g.type)}function s(p,g){var y=p.split(/[\n\r]+/),x=-1,E=-1,T=0,A=0,_=[],P=[],W=null,j={},w=[],F=[],S=[],b=0,N;for(+g.codepage>=0&&Fs(+g.codepage);T!==y.length;++T){b=0;var D=y[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),R=D.replace(/;;/g,"\0").split(";").map(function(q){return q.replace(/\u0000/g,";")}),He=R[0],xe;if(D.length>0)switch(He){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":R[1].charAt(0)=="P"&&P.push(D.slice(3).replace(/;;/g,";"));break;case"C":var be=!1,Ae=!1,Ee=!1,Z=!1,Ce=-1,Le=-1;for(A=1;A<R.length;++A)switch(R[A].charAt(0)){case"A":break;case"X":E=parseInt(R[A].slice(1))-1,Ae=!0;break;case"Y":for(x=parseInt(R[A].slice(1))-1,Ae||(E=0),N=_.length;N<=x;++N)_[N]=[];break;case"K":xe=R[A].slice(1),xe.charAt(0)==='"'?xe=xe.slice(1,xe.length-1):xe==="TRUE"?xe=!0:xe==="FALSE"?xe=!1:isNaN(Ds(xe))?isNaN(Zc(xe).getDate())||(xe=hr(xe)):(xe=Ds(xe),W!==null&&pu(W)&&(xe=Rp(xe))),be=!0;break;case"E":Z=!0;var U=Vc(R[A].slice(1),{r:x,c:E});_[x][E]=[_[x][E],U];break;case"S":Ee=!0,_[x][E]=[_[x][E],"S5S"];break;case"G":break;case"R":Ce=parseInt(R[A].slice(1))-1;break;case"C":Le=parseInt(R[A].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+D)}if(be&&(_[x][E]&&_[x][E].length==2?_[x][E][0]=xe:_[x][E]=xe,W=null),Ee){if(Z)throw new Error("SYLK shared formula cannot have own formula");var G=Ce>-1&&_[Ce][Le];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");_[x][E][1]=zA(G[1],{r:x-Ce,c:E-Le})}break;case"F":var J=0;for(A=1;A<R.length;++A)switch(R[A].charAt(0)){case"X":E=parseInt(R[A].slice(1))-1,++J;break;case"Y":for(x=parseInt(R[A].slice(1))-1,N=_.length;N<=x;++N)_[N]=[];break;case"M":b=parseInt(R[A].slice(1))/20;break;case"F":break;case"G":break;case"P":W=P[parseInt(R[A].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=R[A].slice(1).split(" "),N=parseInt(S[0],10);N<=parseInt(S[1],10);++N)b=parseInt(S[2],10),F[N-1]=b===0?{hidden:!0}:{wch:b},jo(F[N-1]);break;case"C":E=parseInt(R[A].slice(1))-1,F[E]||(F[E]={});break;case"R":x=parseInt(R[A].slice(1))-1,w[x]||(w[x]={}),b>0?(w[x].hpt=b,w[x].hpx=tu(b)):b===0&&(w[x].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+D)}J<1&&(W=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+D)}}return w.length>0&&(j["!rows"]=w),F.length>0&&(j["!cols"]=F),g&&g.sheetRows&&(_=_.slice(0,g.sheetRows)),[_,j]}function a(p,g){var y=i(p,g),x=y[0],E=y[1],T=gu(x,g);return Vr(E).forEach(function(A){T[A]=E[A]}),T}function o(p,g){return Yo(a(p,g),g)}function l(p,g,y,x){var E="C;Y"+(y+1)+";X"+(x+1)+";K";switch(p.t){case"n":E+=p.v||0,p.f&&!p.F&&(E+=";E"+Z1(p.f,{r:y,c:x}));break;case"b":E+=p.v?"TRUE":"FALSE";break;case"e":E+=p.w||p.v;break;case"d":E+='"'+(p.w||p.v)+'"';break;case"s":E+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function c(p,g){g.forEach(function(y,x){var E="F;W"+(x+1)+" "+(x+1)+" ";y.hidden?E+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=Jf(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=Zf(y.wpx)),typeof y.wch=="number"&&(E+=Math.round(y.wch))),E.charAt(E.length-1)!=" "&&p.push(E)})}function d(p,g){g.forEach(function(y,x){var E="F;";y.hidden?E+="M0;":y.hpt?E+="M"+20*y.hpt+";":y.hpx&&(E+="M"+20*e0(y.hpx)+";"),E.length>2&&p.push(E+"R"+(x+1))})}function h(p,g){var y=["ID;PWXL;N;E"],x=[],E=Ot(p["!ref"]),T,A=Array.isArray(p),_=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),p["!cols"]&&c(y,p["!cols"]),p["!rows"]&&d(y,p["!rows"]),y.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var P=E.s.r;P<=E.e.r;++P)for(var W=E.s.c;W<=E.e.c;++W){var j=ot({r:P,c:W});T=A?(p[P]||[])[W]:p[j],!(!T||T.v==null&&(!T.f||T.F))&&x.push(l(T,p,P,W))}return y.join(_)+_+x.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),AA=function(){function t(s,a){switch(a.type){case"base64":return e(Hi(s),a);case"binary":return e(s,a);case"buffer":return e(Et&&Buffer.isBuffer(s)?s.toString("binary"):Xo(s),a);case"array":return e(bl(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,c=-1,d=0,h=[];d!==o.length;++d){if(o[d].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var p=o[d].trim().split(","),g=p[0],y=p[1];++d;for(var x=o[d]||"";(x.match(/["]/g)||[]).length&1&&d<o.length-1;)x+=`
`+o[++d];switch(x=x.trim(),+g){case-1:if(x==="BOT"){h[++l]=[],c=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?h[l][c]=!0:x==="FALSE"?h[l][c]=!1:isNaN(Ds(y))?isNaN(Zc(y).getDate())?h[l][c]=y:h[l][c]=hr(y):h[l][c]=Ds(y),++c;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),h[l][c++]=x!==""?x:null;break}if(x==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(s,a){return gu(t(s,a),a)}function n(s,a){return Yo(r(s,a),a)}var i=function(){var s=function(l,c,d,h,p){l.push(c),l.push(d+","+h),l.push('"'+p.replace(/"/g,'""')+'"')},a=function(l,c,d,h){l.push(c+","+d),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],d=Ot(l["!ref"]),h,p=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,d.e.r-d.s.r+1,""),s(c,"TUPLES",0,d.e.c-d.s.c+1,""),s(c,"DATA",0,0,"");for(var g=d.s.r;g<=d.e.r;++g){a(c,-1,0,"BOT");for(var y=d.s.c;y<=d.e.c;++y){var x=ot({r:g,c:y});if(h=p?(l[g]||[])[y]:l[x],!h){a(c,1,0,"");continue}switch(h.t){case"n":var E=h.w;!E&&h.v!=null&&(E=h.v),E==null?h.f&&!h.F?a(c,1,0,"="+h.f):a(c,1,0,""):a(c,0,E,"V");break;case"b":a(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=ds(h.z||at[14],un(hr(h.v)))),a(c,0,h.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var T=`\r
`,A=c.join(T);return A}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),kA=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,p){for(var g=h.split(`
`),y=-1,x=-1,E=0,T=[];E!==g.length;++E){var A=g[E].trim().split(":");if(A[0]==="cell"){var _=kr(A[1]);if(T.length<=_.r)for(y=T.length;y<=_.r;++y)T[y]||(T[y]=[]);switch(y=_.r,x=_.c,A[2]){case"t":T[y][x]=t(A[3]);break;case"v":T[y][x]=+A[3];break;case"vtf":var P=A[A.length-1];case"vtc":switch(A[3]){case"nl":T[y][x]=!!+A[4];break;default:T[y][x]=+A[4];break}A[2]=="vtf"&&(T[y][x]=[T[y][x],P])}}}return p&&p.sheetRows&&(T=T.slice(0,p.sheetRows)),T}function n(h,p){return gu(r(h,p),p)}function i(h,p){return Yo(n(h,p),p)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var p=[],g=[],y,x="",E=bi(h["!ref"]),T=Array.isArray(h),A=E.s.r;A<=E.e.r;++A)for(var _=E.s.c;_<=E.e.c;++_)if(x=ot({r:A,c:_}),y=T?(h[A]||[])[_]:h[x],!(!y||y.v==null||y.t==="z")){switch(g=["cell",x,"t"],y.t){case"s":case"str":g.push(e(y.v));break;case"n":y.f?(g[2]="vtf",g[3]="n",g[4]=y.v,g[5]=e(y.f)):(g[2]="v",g[3]=y.v);break;case"b":g[2]="vt"+(y.f?"f":"c"),g[3]="nl",g[4]=y.v?"1":"0",g[5]=e(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var P=un(hr(y.v));g[2]="vtc",g[3]="nd",g[4]=""+P,g[5]=y.w||ds(y.z||at[14],P);break;case"e":continue}p.push(g.join(":"))}return p.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function d(h){return[s,a,o,a,c(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),eu=function(){function t(d,h,p,g,y){y.raw?h[p][g]=d:d===""||(d==="TRUE"?h[p][g]=!0:d==="FALSE"?h[p][g]=!1:isNaN(Ds(d))?isNaN(Zc(d).getDate())?h[p][g]=d:h[p][g]=hr(d):h[p][g]=Ds(d))}function e(d,h){var p=h||{},g=[];if(!d||d.length===0)return g;for(var y=d.split(/[\r\n]/),x=y.length-1;x>=0&&y[x].length===0;)--x;for(var E=10,T=0,A=0;A<=x;++A)T=y[A].indexOf(" "),T==-1?T=y[A].length:T++,E=Math.max(E,T);for(A=0;A<=x;++A){g[A]=[];var _=0;for(t(y[A].slice(0,E).trim(),g,A,_,p),_=1;_<=(y[A].length-E)/10+1;++_)t(y[A].slice(E+(_-1)*10,E+_*10).trim(),g,A,_,p)}return p.sheetRows&&(g=g.slice(0,p.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var h={},p=!1,g=0,y=0;g<d.length;++g)(y=d.charCodeAt(g))==34?p=!p:!p&&y in r&&(h[y]=(h[y]||0)+1);y=[];for(g in h)Object.prototype.hasOwnProperty.call(h,g)&&y.push([h[g],g]);if(!y.length){h=n;for(g in h)Object.prototype.hasOwnProperty.call(h,g)&&y.push([h[g],g])}return y.sort(function(x,E){return x[0]-E[0]||n[x[1]]-n[E[1]]}),r[y.pop()[1]]||44}function s(d,h){var p=h||{},g="",y=p.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(g=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(g=d.charAt(4),d=d.slice(6)):g=i(d.slice(0,1024)):p&&p.FS?g=p.FS:g=i(d.slice(0,1024));var E=0,T=0,A=0,_=0,P=0,W=g.charCodeAt(0),j=!1,w=0,F=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var S=p.dateNF!=null?cR(p.dateNF):null;function b(){var N=d.slice(_,P),D={};if(N.charAt(0)=='"'&&N.charAt(N.length-1)=='"'&&(N=N.slice(1,-1).replace(/""/g,'"')),N.length===0)D.t="z";else if(p.raw)D.t="s",D.v=N;else if(N.trim().length===0)D.t="s",D.v=N;else if(N.charCodeAt(0)==61)N.charCodeAt(1)==34&&N.charCodeAt(N.length-1)==34?(D.t="s",D.v=N.slice(2,-1).replace(/""/g,'"')):B6(N)?(D.t="n",D.f=N.slice(1)):(D.t="s",D.v=N);else if(N=="TRUE")D.t="b",D.v=!0;else if(N=="FALSE")D.t="b",D.v=!1;else if(!isNaN(A=Ds(N)))D.t="n",p.cellText!==!1&&(D.w=N),D.v=A;else if(!isNaN(Zc(N).getDate())||S&&N.match(S)){D.z=p.dateNF||at[14];var R=0;S&&N.match(S)&&(N=uR(N,p.dateNF,N.match(S)||[]),R=1),p.cellDates?(D.t="d",D.v=hr(N,R)):(D.t="n",D.v=un(hr(N,R))),p.cellText!==!1&&(D.w=ds(D.z,D.v instanceof Date?un(D.v):D.v)),p.cellNF||delete D.z}else D.t="s",D.v=N;if(D.t=="z"||(p.dense?(y[E]||(y[E]=[]),y[E][T]=D):y[ot({c:T,r:E})]=D),_=P+1,F=d.charCodeAt(_),x.e.c<T&&(x.e.c=T),x.e.r<E&&(x.e.r=E),w==W)++T;else if(T=0,++E,p.sheetRows&&p.sheetRows<=E)return!0}e:for(;P<d.length;++P)switch(w=d.charCodeAt(P)){case 34:F===34&&(j=!j);break;case W:case 10:case 13:if(!j&&b())break e;break}return P-_>0&&b(),y["!ref"]=vt(x),y}function a(d,h){return!(h&&h.PRN)||h.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,h):gu(e(d,h),h)}function o(d,h){var p="",g=h.type=="string"?[0,0,0,0]:ov(d,h);switch(h.type){case"base64":p=Hi(d);break;case"binary":p=d;break;case"buffer":h.codepage==65001?p=d.toString("utf8"):h.codepage&&typeof Hf<"u"||(p=Et&&Buffer.isBuffer(d)?d.toString("binary"):Xo(d));break;case"array":p=bl(d);break;case"string":p=d;break;default:throw new Error("Unrecognized type "+h.type)}return g[0]==239&&g[1]==187&&g[2]==191?p=Jt(p.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?p=Jt(p):h.type=="binary"&&typeof Hf<"u",p.slice(0,19)=="socialcalc:version:"?kA.to_sheet(h.type=="string"?p:Jt(p),h):a(p,h)}function l(d,h){return Yo(o(d,h),h)}function c(d){for(var h=[],p=Ot(d["!ref"]),g,y=Array.isArray(d),x=p.s.r;x<=p.e.r;++x){for(var E=[],T=p.s.c;T<=p.e.c;++T){var A=ot({r:x,c:T});if(g=y?(d[x]||[])[T]:d[A],!g||g.v==null){E.push("          ");continue}for(var _=(g.w||(ja(g),g.w)||"").slice(0,10);_.length<10;)_+=" ";E.push(_+(T===0?" ":""))}h.push(E.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function SD(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=SA.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return eu.to_workbook(t,e)}}var _l=function(){function t(U,G,J){if(U){Fn(U,U.l||0);for(var q=J.Enum||Ce;U.l<U.length;){var he=U.read_shift(2),Se=q[he]||q[65535],Ne=U.read_shift(2),ke=U.l+Ne,Te=Se.f&&Se.f(U,Ne,J);if(U.l=ke,G(Te,Se,he))return}}}function e(U,G){switch(G.type){case"base64":return r(Bi(Hi(U)),G);case"binary":return r(Bi(U),G);case"buffer":case"array":return r(U,G)}throw"Unsupported type "+G.type}function r(U,G){if(!U)return U;var J=G||{},q=J.dense?[]:{},he="Sheet1",Se="",Ne=0,ke={},Te=[],nt=[],K={s:{r:0,c:0},e:{r:0,c:0}},Ct=J.sheetRows||0;if(U[2]==0&&(U[3]==8||U[3]==9)&&U.length>=16&&U[14]==5&&U[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(U[2]==2)J.Enum=Ce,t(U,function($e,Yt,En){switch(En){case 0:J.vers=$e,$e>=4096&&(J.qpro=!0);break;case 6:K=$e;break;case 204:$e&&(Se=$e);break;case 222:Se=$e;break;case 15:case 51:J.qpro||($e[1].v=$e[1].v.slice(1));case 13:case 14:case 16:En==14&&($e[2]&112)==112&&($e[2]&15)>1&&($e[2]&15)<15&&($e[1].z=J.dateNF||at[14],J.cellDates&&($e[1].t="d",$e[1].v=Rp($e[1].v))),J.qpro&&$e[3]>Ne&&(q["!ref"]=vt(K),ke[he]=q,Te.push(he),q=J.dense?[]:{},K={s:{r:0,c:0},e:{r:0,c:0}},Ne=$e[3],he=Se||"Sheet"+(Ne+1),Se="");var fn=J.dense?(q[$e[0].r]||[])[$e[0].c]:q[ot($e[0])];if(fn){fn.t=$e[1].t,fn.v=$e[1].v,$e[1].z!=null&&(fn.z=$e[1].z),$e[1].f!=null&&(fn.f=$e[1].f);break}J.dense?(q[$e[0].r]||(q[$e[0].r]=[]),q[$e[0].r][$e[0].c]=$e[1]):q[ot($e[0])]=$e[1];break}},J);else if(U[2]==26||U[2]==14)J.Enum=Le,U[2]==14&&(J.qpro=!0,U.l=0),t(U,function($e,Yt,En){switch(En){case 204:he=$e;break;case 22:$e[1].v=$e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if($e[3]>Ne&&(q["!ref"]=vt(K),ke[he]=q,Te.push(he),q=J.dense?[]:{},K={s:{r:0,c:0},e:{r:0,c:0}},Ne=$e[3],he="Sheet"+(Ne+1)),Ct>0&&$e[0].r>=Ct)break;J.dense?(q[$e[0].r]||(q[$e[0].r]=[]),q[$e[0].r][$e[0].c]=$e[1]):q[ot($e[0])]=$e[1],K.e.c<$e[0].c&&(K.e.c=$e[0].c),K.e.r<$e[0].r&&(K.e.r=$e[0].r);break;case 27:$e[14e3]&&(nt[$e[14e3][0]]=$e[14e3][1]);break;case 1537:nt[$e[0]]=$e[1],$e[0]==Ne&&(he=$e[1]);break}},J);else throw new Error("Unrecognized LOTUS BOF "+U[2]);if(q["!ref"]=vt(K),ke[Se||he]=q,Te.push(Se||he),!nt.length)return{SheetNames:Te,Sheets:ke};for(var xt={},Rt=[],pt=0;pt<nt.length;++pt)ke[Te[pt]]?(Rt.push(nt[pt]||Te[pt]),xt[nt[pt]]=ke[nt[pt]]||ke[Te[pt]]):(Rt.push(nt[pt]),xt[nt[pt]]={"!ref":"A1"});return{SheetNames:Rt,Sheets:xt}}function n(U,G){var J=G||{};if(+J.codepage>=0&&Fs(+J.codepage),J.type=="string")throw new Error("Cannot write WK1 to JS string");var q=Ii(),he=Ot(U["!ref"]),Se=Array.isArray(U),Ne=[];Ue(q,0,s(1030)),Ue(q,6,l(he));for(var ke=Math.min(he.e.r,8191),Te=he.s.r;Te<=ke;++Te)for(var nt=Hr(Te),K=he.s.c;K<=he.e.c;++K){Te===he.s.r&&(Ne[K]=Ar(K));var Ct=Ne[K]+nt,xt=Se?(U[Te]||[])[K]:U[Ct];if(!(!xt||xt.t=="z"))if(xt.t=="n")(xt.v|0)==xt.v&&xt.v>=-32768&&xt.v<=32767?Ue(q,13,g(Te,K,xt.v)):Ue(q,14,x(Te,K,xt.v));else{var Rt=ja(xt);Ue(q,15,h(Te,K,Rt.slice(0,239)))}}return Ue(q,1),q.end()}function i(U,G){var J=G||{};if(+J.codepage>=0&&Fs(+J.codepage),J.type=="string")throw new Error("Cannot write WK3 to JS string");var q=Ii();Ue(q,0,a(U));for(var he=0,Se=0;he<U.SheetNames.length;++he)(U.Sheets[U.SheetNames[he]]||{})["!ref"]&&Ue(q,27,Z(U.SheetNames[he],Se++));var Ne=0;for(he=0;he<U.SheetNames.length;++he){var ke=U.Sheets[U.SheetNames[he]];if(!(!ke||!ke["!ref"])){for(var Te=Ot(ke["!ref"]),nt=Array.isArray(ke),K=[],Ct=Math.min(Te.e.r,8191),xt=Te.s.r;xt<=Ct;++xt)for(var Rt=Hr(xt),pt=Te.s.c;pt<=Te.e.c;++pt){xt===Te.s.r&&(K[pt]=Ar(pt));var $e=K[pt]+Rt,Yt=nt?(ke[xt]||[])[pt]:ke[$e];if(!(!Yt||Yt.t=="z"))if(Yt.t=="n")Ue(q,23,b(xt,pt,Ne,Yt.v));else{var En=ja(Yt);Ue(q,22,w(xt,pt,Ne,En.slice(0,239)))}}++Ne}}return Ue(q,1),q.end()}function s(U){var G=ge(2);return G.write_shift(2,U),G}function a(U){var G=ge(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var J=0,q=0,he=0,Se=0;Se<U.SheetNames.length;++Se){var Ne=U.SheetNames[Se],ke=U.Sheets[Ne];if(!(!ke||!ke["!ref"])){++he;var Te=bi(ke["!ref"]);J<Te.e.r&&(J=Te.e.r),q<Te.e.c&&(q=Te.e.c)}}return J>8191&&(J=8191),G.write_shift(2,J),G.write_shift(1,he),G.write_shift(1,q),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function o(U,G,J){var q={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&J.qpro?(q.s.c=U.read_shift(1),U.l++,q.s.r=U.read_shift(2),q.e.c=U.read_shift(1),U.l++,q.e.r=U.read_shift(2),q):(q.s.c=U.read_shift(2),q.s.r=U.read_shift(2),G==12&&J.qpro&&(U.l+=2),q.e.c=U.read_shift(2),q.e.r=U.read_shift(2),G==12&&J.qpro&&(U.l+=2),q.s.c==65535&&(q.s.c=q.e.c=q.s.r=q.e.r=0),q)}function l(U){var G=ge(8);return G.write_shift(2,U.s.c),G.write_shift(2,U.s.r),G.write_shift(2,U.e.c),G.write_shift(2,U.e.r),G}function c(U,G,J){var q=[{c:0,r:0},{t:"n",v:0},0,0];return J.qpro&&J.vers!=20768?(q[0].c=U.read_shift(1),q[3]=U.read_shift(1),q[0].r=U.read_shift(2),U.l+=2):(q[2]=U.read_shift(1),q[0].c=U.read_shift(2),q[0].r=U.read_shift(2)),q}function d(U,G,J){var q=U.l+G,he=c(U,G,J);if(he[1].t="s",J.vers==20768){U.l++;var Se=U.read_shift(1);return he[1].v=U.read_shift(Se,"utf8"),he}return J.qpro&&U.l++,he[1].v=U.read_shift(q-U.l,"cstr"),he}function h(U,G,J){var q=ge(7+J.length);q.write_shift(1,255),q.write_shift(2,G),q.write_shift(2,U),q.write_shift(1,39);for(var he=0;he<q.length;++he){var Se=J.charCodeAt(he);q.write_shift(1,Se>=128?95:Se)}return q.write_shift(1,0),q}function p(U,G,J){var q=c(U,G,J);return q[1].v=U.read_shift(2,"i"),q}function g(U,G,J){var q=ge(7);return q.write_shift(1,255),q.write_shift(2,G),q.write_shift(2,U),q.write_shift(2,J,"i"),q}function y(U,G,J){var q=c(U,G,J);return q[1].v=U.read_shift(8,"f"),q}function x(U,G,J){var q=ge(13);return q.write_shift(1,255),q.write_shift(2,G),q.write_shift(2,U),q.write_shift(8,J,"f"),q}function E(U,G,J){var q=U.l+G,he=c(U,G,J);if(he[1].v=U.read_shift(8,"f"),J.qpro)U.l=q;else{var Se=U.read_shift(2);P(U.slice(U.l,U.l+Se),he),U.l+=Se}return he}function T(U,G,J){var q=G&32768;return G&=-32769,G=(q?U:0)+(G>=8192?G-16384:G),(q?"":"$")+(J?Ar(G):Hr(G))}var A={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function P(U,G){Fn(U,0);for(var J=[],q=0,he="",Se="",Ne="",ke="";U.l<U.length;){var Te=U[U.l++];switch(Te){case 0:J.push(U.read_shift(8,"f"));break;case 1:Se=T(G[0].c,U.read_shift(2),!0),he=T(G[0].r,U.read_shift(2),!1),J.push(Se+he);break;case 2:{var nt=T(G[0].c,U.read_shift(2),!0),K=T(G[0].r,U.read_shift(2),!1);Se=T(G[0].c,U.read_shift(2),!0),he=T(G[0].r,U.read_shift(2),!1),J.push(nt+K+":"+Se+he)}break;case 3:if(U.l<U.length){console.error("WK1 premature formula end");return}break;case 4:J.push("("+J.pop()+")");break;case 5:J.push(U.read_shift(2));break;case 6:{for(var Ct="";Te=U[U.l++];)Ct+=String.fromCharCode(Te);J.push('"'+Ct.replace(/"/g,'""')+'"')}break;case 8:J.push("-"+J.pop());break;case 23:J.push("+"+J.pop());break;case 22:J.push("NOT("+J.pop()+")");break;case 20:case 21:ke=J.pop(),Ne=J.pop(),J.push(["AND","OR"][Te-20]+"("+Ne+","+ke+")");break;default:if(Te<32&&_[Te])ke=J.pop(),Ne=J.pop(),J.push(Ne+_[Te]+ke);else if(A[Te]){if(q=A[Te][1],q==69&&(q=U[U.l++]),q>J.length){console.error("WK1 bad formula parse 0x"+Te.toString(16)+":|"+J.join("|")+"|");return}var xt=J.slice(-q);J.length-=q,J.push(A[Te][0]+"("+xt.join(",")+")")}else return Te<=7?console.error("WK1 invalid opcode "+Te.toString(16)):Te<=24?console.error("WK1 unsupported op "+Te.toString(16)):Te<=30?console.error("WK1 invalid opcode "+Te.toString(16)):Te<=115?console.error("WK1 unsupported function opcode "+Te.toString(16)):console.error("WK1 unrecognized opcode "+Te.toString(16))}}J.length==1?G[1].f=""+J[0]:console.error("WK1 bad formula parse |"+J.join("|")+"|")}function W(U){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=U.read_shift(2),G[3]=U[U.l++],G[0].c=U[U.l++],G}function j(U,G){var J=W(U);return J[1].t="s",J[1].v=U.read_shift(G-4,"cstr"),J}function w(U,G,J,q){var he=ge(6+q.length);he.write_shift(2,U),he.write_shift(1,J),he.write_shift(1,G),he.write_shift(1,39);for(var Se=0;Se<q.length;++Se){var Ne=q.charCodeAt(Se);he.write_shift(1,Ne>=128?95:Ne)}return he.write_shift(1,0),he}function F(U,G){var J=W(U);J[1].v=U.read_shift(2);var q=J[1].v>>1;if(J[1].v&1)switch(q&7){case 0:q=(q>>3)*5e3;break;case 1:q=(q>>3)*500;break;case 2:q=(q>>3)/20;break;case 3:q=(q>>3)/200;break;case 4:q=(q>>3)/2e3;break;case 5:q=(q>>3)/2e4;break;case 6:q=(q>>3)/16;break;case 7:q=(q>>3)/64;break}return J[1].v=q,J}function S(U,G){var J=W(U),q=U.read_shift(4),he=U.read_shift(4),Se=U.read_shift(2);if(Se==65535)return q===0&&he===3221225472?(J[1].t="e",J[1].v=15):q===0&&he===3489660928?(J[1].t="e",J[1].v=42):J[1].v=0,J;var Ne=Se&32768;return Se=(Se&32767)-16446,J[1].v=(1-Ne*2)*(he*Math.pow(2,Se+32)+q*Math.pow(2,Se)),J}function b(U,G,J,q){var he=ge(14);if(he.write_shift(2,U),he.write_shift(1,J),he.write_shift(1,G),q==0)return he.write_shift(4,0),he.write_shift(4,0),he.write_shift(2,65535),he;var Se=0,Ne=0,ke=0,Te=0;return q<0&&(Se=1,q=-q),Ne=Math.log2(q)|0,q/=Math.pow(2,Ne-31),Te=q>>>0,Te&2147483648||(q/=2,++Ne,Te=q>>>0),q-=Te,Te|=2147483648,Te>>>=0,q*=Math.pow(2,32),ke=q>>>0,he.write_shift(4,ke),he.write_shift(4,Te),Ne+=16383+(Se?32768:0),he.write_shift(2,Ne),he}function N(U,G){var J=S(U);return U.l+=G-14,J}function D(U,G){var J=W(U),q=U.read_shift(4);return J[1].v=q>>6,J}function R(U,G){var J=W(U),q=U.read_shift(8,"f");return J[1].v=q,J}function He(U,G){var J=R(U);return U.l+=G-10,J}function xe(U,G){return U[U.l+G-1]==0?U.read_shift(G,"cstr"):""}function be(U,G){var J=U[U.l++];J>G-1&&(J=G-1);for(var q="";q.length<J;)q+=String.fromCharCode(U[U.l++]);return q}function Ae(U,G,J){if(!(!J.qpro||G<21)){var q=U.read_shift(1);U.l+=17,U.l+=1,U.l+=2;var he=U.read_shift(G-21,"cstr");return[q,he]}}function Ee(U,G){for(var J={},q=U.l+G;U.l<q;){var he=U.read_shift(2);if(he==14e3){for(J[he]=[0,""],J[he][0]=U.read_shift(2);U[U.l];)J[he][1]+=String.fromCharCode(U[U.l]),U.l++;U.l++}}return J}function Z(U,G){var J=ge(5+U.length);J.write_shift(2,14e3),J.write_shift(2,G);for(var q=0;q<U.length;++q){var he=U.charCodeAt(q);J[J.l++]=he>127?95:he}return J[J.l++]=0,J}var Ce={0:{n:"BOF",f:Zr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:xe},222:{n:"SHEETNAMELP",f:be},65535:{n:""}},Le={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:j},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:N},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ee},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:R},40:{n:"FORMULA28",f:He},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:xe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ae},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function AD(t){var e={},r=t.match(ti),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=ct(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=S1[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var kD=function(){var t=Kf("t"),e=Kf("rPr");function r(s){var a=s.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:Pt(a[1])},l=s.match(e);return l&&(o.s=AD(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),CD=function(){var e=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),FD=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,ID=/<(?:\w+:)?r>/,bD=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function X1(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Pt(Jt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Jt(t),r&&(n.h=P1(n.t))):t.match(ID)&&(n.r=Jt(t),n.t=Pt(Jt((t.replace(bD,"").match(FD)||[]).join("").replace(ti,""))),r&&(n.h=CD(kD(n.r)))),n):{t:""}}var RD=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,ND=/<(?:\w+:)?(?:si|sstItem)>/g,DD=/<\/(?:\w+:)?(?:si|sstItem)>/;function PD(t,e){var r=[],n="";if(!t)return r;var i=t.match(RD);if(i){n=i[2].replace(ND,"").split(DD);for(var s=0;s!=n.length;++s){var a=X1(n[s].trim(),e);a!=null&&(r[r.length]=a)}i=ct(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var OD=/^\s|\s$|[\t\n\r]/;function CA(t,e){if(!e.bookSST)return"";var r=[$r];r[r.length]=Be("sst",null,{xmlns:zl[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(OD)&&(s+=' xml:space="preserve"'),s+=">"+Gt(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function MD(t){return[t.read_shift(4),t.read_shift(4)]}function LD(t,e){var r=[],n=!1;return Ka(t,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function BD(t,e){return e||(e=ge(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var jD=YR;function VD(t){var e=Ii();we(e,159,BD(t));for(var r=0;r<t.length;++r)we(e,19,jD(t[r]));return we(e,160),e.end()}function FA(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Da(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function UD(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Da(t,4),e.U=Da(t,4),e.W=Da(t,4),e}function zD(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function WD(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(zD(t));return e}function HD(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function $D(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Da(t,4),e.U=Da(t,4),e.W=Da(t,4),e}function GD(t){var e=$D(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function IA(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function bA(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function KD(t){var e=Da(t);switch(e.Minor){case 2:return[e.Minor,XD(t)];case 3:return[e.Minor,YD()];case 4:return[e.Minor,qD(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function XD(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=IA(t,r),i=bA(t,t.length-t.l);return{t:"Std",h:n,v:i}}function YD(){throw new Error("File is password-protected: ECMA-376 Extensible")}function qD(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(ti,function(s){var a=ct(s);switch(oa(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function QD(t,e){var r={},n=r.EncryptionVersionInfo=Da(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=IA(t,i),e-=i,r.EncryptionVerifier=bA(t,e),r}function JD(t){var e={},r=e.EncryptionVersionInfo=Da(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function Y1(t){var e=0,r,n=FA(t),i=n.length+1,s,a,o,l,c;for(r=Bo(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var RA=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],l=104,c=a.length-1;c>=0;--c)for(var d=a[c],h=0;h!=7;++h)d&64&&(o^=r[l]),d*=2,--l;return o};return function(a){for(var o=FA(a),l=s(o),c=o.length,d=Bo(16),h=0;h!=16;++h)d[h]=0;var p,g,y;for((c&1)===1&&(p=l>>8,d[c]=i(t[0],p),--c,p=l&255,g=o[o.length-1],d[c]=i(g,p));c>0;)--c,p=l>>8,d[c]=i(o[c],p),--c,p=l&255,d[c]=i(o[c],p);for(c=15,y=15-o.length;y>0;)p=l>>8,d[c]=i(t[y],p),--c,--y,p=l&255,d[c]=i(o[c],p),--c,--y;return d}}(),ZD=function(t,e,r,n,i){i||(i=e),n||(n=RA(t));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},eP=function(t){var e=0,r=RA(t);return function(n){var i=ZD("",n,e,r);return e=i[1],i[0]}};function tP(t,e,r,n){var i={key:Zr(t),verificationBytes:Zr(t)};return r.password&&(i.verifier=Y1(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=eP(r.password)),i}function rP(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=JD(t):n.Data=QD(t,e),n}function nP(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?rP(t,e-2,n):tP(t,r.biff>=8?e:e-2,r,n),n}var NA=function(){function t(i,s){switch(s.type){case"base64":return e(Hi(i),s);case"binary":return e(i,s);case"buffer":return e(Et&&Buffer.isBuffer(i)?i.toString("binary"):Xo(i),s);case"array":return e(bl(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(d,h){Array.isArray(o)&&(o[h]=[]);for(var p=/\\\w+\b/g,g=0,y,x=-1;y=p.exec(d);){switch(y[0]){case"\\cell":var E=d.slice(g,p.lastIndex-y[0].length);if(E[0]==" "&&(E=E.slice(1)),++x,E.length){var T={v:E,t:"s"};Array.isArray(o)?o[h][x]=T:o[ot({r:h,c:x})]=T}break}g=p.lastIndex}x>c.e.c&&(c.e.c=x)}),o["!ref"]=vt(c),o}function r(i,s){return Yo(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=Ot(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var d=a.s.c;d<=a.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=a.s.c;d<=a.e.c;++d){var h=ot({r:c,c:d});o=l?(i[c]||[])[d]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(ja(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function iP(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Qf(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function sP(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),a=i-s;if(a===0)return[0,0,e];var o=0,l=0,c=i+s;switch(l=a/(c>1?2-c:c),i){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,l,c/2]}function aP(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=i*o,a[0]+=i,a[1]+=l;break;case 1:l=i*(2-o),a[0]+=l,a[1]+=i;break;case 2:l=i*(o-2),a[1]+=i,a[2]+=l;break;case 3:l=i*(4-o),a[1]+=l,a[2]+=i;break;case 4:l=i*(o-4),a[2]+=i,a[0]+=l;break;case 5:l=i*(6-o),a[2]+=l,a[0]+=i;break}for(var c=0;c!=3;++c)a[c]=Math.round(a[c]*255);return a}function $h(t,e){if(e===0)return t;var r=sP(iP(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),Qf(aP(r))}var DA=6,oP=15,lP=1,Xn=DA;function Jf(t){return Math.floor((t+Math.round(128/Xn)/256)*Xn)}function Zf(t){return Math.floor((t-5)/Xn*100+.5)/100}function Gh(t){return Math.round((t*Xn+5)/Xn*256)/256}function Im(t){return Gh(Zf(Jf(t)))}function q1(t){var e=Math.abs(t-Im(t)),r=Xn;if(e>.005)for(Xn=lP;Xn<oP;++Xn)Math.abs(t-Im(t))<=e&&(e=Math.abs(t-Im(t)),r=Xn);Xn=r}function jo(t){t.width?(t.wpx=Jf(t.width),t.wch=Zf(t.wpx),t.MDW=Xn):t.wpx?(t.wch=Zf(t.wpx),t.width=Gh(t.wch),t.MDW=Xn):typeof t.wch=="number"&&(t.width=Gh(t.wch),t.wpx=Jf(t.width),t.MDW=Xn),t.customWidth&&delete t.customWidth}var cP=96,PA=cP;function e0(t){return t*96/PA}function tu(t){return t*PA/96}var uP={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function fP(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(ti)||[]).forEach(function(a){var o=ct(a);switch(oa(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=fr(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=fr(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function dP(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(ti)||[]).forEach(function(a){var o=ct(a);switch(oa(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function hP(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(ti)||[]).forEach(function(a){var o=ct(a);switch(oa(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=Jt(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?fr(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?fr(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?fr(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?fr(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?fr(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?fr(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?fr(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=S1[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=fr(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=vl[i.color.index];i.color.index==81&&(l=vl[1]),l||(l=vl[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=$h(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function pP(t,e,r){e.NumberFmt=[];for(var n=Vr(at),i=0;i<n.length;++i)e.NumberFmt[n[i]]=at[n[i]];var s=t[0].match(ti);if(s)for(i=0;i<s.length;++i){var a=ct(s[i]);switch(oa(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Pt(Jt(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}Na(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function mP(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Be("numFmt",null,{numFmtId:n,formatCode:Gt(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Be("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Id=["numFmtId","fillId","fontId","borderId","xfId"],bd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function gP(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(ti)||[]).forEach(function(s){var a=ct(s),o=0;switch(oa(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<Id.length;++o)n[Id[o]]&&(n[Id[o]]=parseInt(n[Id[o]],10));for(o=0;o<bd.length;++o)n[bd[o]]&&(n[bd[o]]=fr(n[bd[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=fr(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function xP(t){var e=[];return e[e.length]=Be("cellXfs",null),t.forEach(function(r){e[e.length]=Be("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Be("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var vP=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&pP(h,d,c),(h=o.match(i))&&hP(h,d,l,c),(h=o.match(n))&&dP(h,d,l,c),(h=o.match(s))&&fP(h,d,l,c),(h=o.match(r))&&gP(h,d,c),d}}();function OA(t,e){var r=[$r,Be("styleSheet",null,{xmlns:zl[0],"xmlns:vt":an.vt})],n;return t.SSF&&(n=mP(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=xP(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function yP(t,e){var r=t.read_shift(2),n=Qn(t);return[r,n]}function _P(t,e,r){r||(r=ge(6+4*e.length)),r.write_shift(2,t),yn(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function EP(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=rN(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=tN(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Qn(t),n}function wP(t,e){e||(e=ge(25+4*32)),e.write_shift(2,t.sz*20),nN(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),zh(t.color,e);var n=0;return n=2,e.write_shift(1,n),yn(t.name,e),e.length>e.l?e.slice(0,e.l):e}var TP=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],bm,SP=Zn;function p2(t,e){e||(e=ge(4*3+8*7+16*1)),bm||(bm=Ip(TP));var r=bm[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(zh({auto:1},e),zh({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function AP(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function MA(t,e,r){r||(r=ge(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function zu(t,e){return e||(e=ge(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var kP=Zn;function CP(t,e){return e||(e=ge(51)),e.write_shift(1,0),zu(null,e),zu(null,e),zu(null,e),zu(null,e),zu(null,e),e.length>e.l?e.slice(0,e.l):e}function FP(t,e){return e||(e=ge(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Uh(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function IP(t,e,r){var n=ge(2052);return n.write_shift(4,t),Uh(e,n),Uh(r,n),n.length>n.l?n.slice(0,n.l):n}function bP(t,e,r){var n={};n.NumberFmt=[];for(var i in at)n.NumberFmt[i]=at[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return Ka(t,function(l,c,d){switch(d){case 44:n.NumberFmt[l[0]]=l[1],Na(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=$h(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(d),a=!0;break;case 38:s.pop(),a=!1;break;default:if(c.T>0)s.push(d);else if(c.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function RP(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(we(t,615,Ps(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&we(t,44,_P(i,e[i]))}),we(t,616))}}function NP(t){var e=1;we(t,611,Ps(e)),we(t,43,wP({sz:12,color:{theme:1},name:"Calibri",family:2})),we(t,612)}function DP(t){var e=2;we(t,603,Ps(e)),we(t,45,p2({patternType:"none"})),we(t,45,p2({patternType:"gray125"})),we(t,604)}function PP(t){var e=1;we(t,613,Ps(e)),we(t,46,CP()),we(t,614)}function OP(t){var e=1;we(t,626,Ps(e)),we(t,47,MA({numFmtId:0},65535)),we(t,627)}function MP(t,e){we(t,617,Ps(e.length)),e.forEach(function(r){we(t,47,MA(r,0))}),we(t,618)}function LP(t){var e=1;we(t,619,Ps(e)),we(t,48,FP({xfId:0,name:"Normal"})),we(t,620)}function BP(t){var e=0;we(t,505,Ps(e)),we(t,506)}function jP(t){var e=0;we(t,508,IP(e,"TableStyleMedium9","PivotStyleMedium4")),we(t,509)}function VP(t,e){var r=Ii();return we(r,278),RP(r,t.SSF),NP(r),DP(r),PP(r),OP(r),MP(r,e.cellXfs),LP(r),BP(r),jP(r),we(r,279),r.end()}var UP=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function zP(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(ti)||[]).forEach(function(i){var s=ct(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[UP.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function WP(){}function HP(){}var $P=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,GP=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,KP=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function XP(t,e,r){e.themeElements={};var n;[["clrScheme",$P,zP],["fontScheme",GP,WP],["fmtScheme",KP,HP]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var YP=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function LA(t,e){(!t||t.length===0)&&(t=Q1());var r,n={};if(!(r=t.match(YP)))throw new Error("themeElements not found in theme");return XP(r[0],n,e),n.raw=t,n}function Q1(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[$r];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function qP(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var a;try{a=IS(s,{type:"array"})}catch{return}var o=ji(a,"theme/theme/theme1.xml",!0);if(o)return LA(o,r)}}function QP(t){return t.read_shift(4)}function JP(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=ZP(t,4);break;case 2:e.xclrValue=gA(t);break;case 3:e.xclrValue=QP(t);break;case 4:t.l+=4;break}return t.l+=8,e}function ZP(t,e){return Zn(t,e)}function e6(t,e){return Zn(t,e)}function t6(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=JP(t);break;case 6:n[1]=e6(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function r6(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push(t6(t,r-t.l));return{ixfe:n,ext:s}}function n6(t,e){e.forEach(function(r){switch(r[0]){}})}function i6(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Qn(t)}}function s6(t){var e=ge(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),yn(t.name,e),e.slice(0,e.l)}function a6(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function o6(t){var e=ge(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function l6(t,e){var r=ge(8+2*e.length);return r.write_shift(4,t),yn(e,r),r.slice(0,r.l)}function c6(t){return t.l+=4,t.read_shift(4)!=0}function u6(t,e){var r=ge(8);return r.write_shift(4,t),r.write_shift(4,1),r}function f6(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return Ka(t,function(l,c,d){switch(d){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(d),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!c.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function d6(){var t=Ii();return we(t,332),we(t,334,Ps(1)),we(t,335,s6({name:"XLDAPR",version:12e4,flags:3496657072})),we(t,336),we(t,339,l6(1,"XLDAPR")),we(t,52),we(t,35,Ps(514)),we(t,4096,Ps(0)),we(t,4097,ns(1)),we(t,36),we(t,53),we(t,340),we(t,337,u6(1)),we(t,51,o6([[1,0]])),we(t,338),we(t,333),t.end()}function h6(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,a;return t.replace(ti,function(o){var l=ct(o);switch(oa(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(a=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function BA(){var t=[$r];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function p6(t){var e=[];if(!t)return e;var r=1;return(t.match(ti)||[]).forEach(function(n){var i=ct(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function m6(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=ot(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function g6(t,e,r){var n=[];return Ka(t,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function x6(t,e,r,n){if(!t)return t;var i=n||{},s=!1;Ka(t,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function v6(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Ic=1024;function jA(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Be("xml",null,{"xmlns:v":Mi.v,"xmlns:o":Mi.o,"xmlns:x":Mi.x,"xmlns:mv":Mi.mv}).replace(/\/>/,">"),Be("o:shapelayout",Be("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Be("v:shapetype",[Be("v:stroke",null,{joinstyle:"miter"}),Be("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Ic<t*1e3;)Ic+=1e3;return e.forEach(function(s){var a=kr(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?Be("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=Be("v:fill",l,o),d={on:"t",obscured:"t"};++Ic,i=i.concat(["<v:shape"+Xf({id:"_x0000_s"+Ic,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,Be("v:shadow",null,d),Be("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",In("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),In("x:AutoFill","False"),In("x:Row",String(a.r)),In("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function m2(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(a){var o=kr(a.ref);if(i?(t[o.r]||(t[o.r]=[]),s=t[o.r][o.c]):s=t[a.ref],!s){s={t:"z"},i?t[o.r][o.c]=s:t[a.ref]=s;var l=Ot(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=vt(l);c!==t["!ref"]&&(t["!ref"]=c)}s.c||(s.c=[]);var d={a:a.author,t:a.t,r:a.r,T:r};a.h&&(d.h=a.h);for(var h=s.c.length-1;h>=0;--h){if(!r&&s.c[h].T)return;r&&!s.c[h].T&&s.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(d.a==n[h].id){d.a=n[h].name||d.a;break}}s.c.push(d)})}function y6(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=ct(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},d=kr(l.ref);if(!(e.sheetRows&&e.sheetRows<=d.r)){var h=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!h&&!!h[1]&&X1(h[1])||{r:"",t:"",h:""};c.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),c.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=p.h),n.push(c)}}}}),n}function VA(t){var e=[$r,Be("comments",null,{xmlns:zl[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=Gt(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(Gt(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(In("t",Gt(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(In("t",Gt(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function _6(t,e){var r=[],n=!1,i={},s=0;return t.replace(ti,function(o,l){var c=ct(o);switch(oa(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":i.t=t.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function E6(t,e,r){var n=[$r,Be("ThreadedComments",null,{xmlns:an.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(Be("threadedComment",In("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function w6(t,e){var r=[],n=!1;return t.replace(ti,function(s){var a=ct(s);switch(oa(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function T6(t){var e=[$r,Be("personList",null,{xmlns:an.TCMNT,"xmlns:x":zl[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Be("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function S6(t){var e={};e.iauthor=t.read_shift(4);var r=Gl(t);return e.rfx=r.s,e.ref=ot(r.s),t.l+=16,e}function A6(t,e){return e==null&&(e=ge(36)),e.write_shift(4,t[1].iauthor),xu(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var k6=Qn;function C6(t){return yn(t.slice(0,54))}function F6(t,e){var r=[],n=[],i={},s=!1;return Ka(t,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function I6(t){var e=Ii(),r=[];return we(e,628),we(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),we(e,632,C6(i.a)))})}),we(e,631),we(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:kr(n[0]),e:kr(n[0])};we(e,635,A6([s,i])),i.t&&i.t.length>0&&we(e,637,QR(i)),we(e,636),delete i.iauthor})}),we(e,634),we(e,629),e.end()}var b6="application/vnd.ms-office.vbaProject";function R6(t){var e=Ze.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ze.utils.cfb_add(e,i,t.FileIndex[n].content)}}),Ze.write(e)}function N6(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Ze.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var UA=["xlsb","xlsm","xlam","biff8","xla"];function D6(){return{"!type":"dialog"}}function P6(){return{"!type":"dialog"}}function O6(){return{"!type":"macro"}}function M6(){return{"!type":"macro"}}var Vc=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,d=a.length>0?parseInt(a,10)|0:0;return o?d+=e.c:--d,l?c+=e.r:--c,i+(o?"":"$")+Ar(d)+(l?"":"$")+Hr(c)}return function(i,s){return e=s,i.replace(t,r)}}(),J1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Z1=function(){return function(e,r){return e.replace(J1,function(n,i,s,a,o,l){var c=j1(a)-(s?0:r.c),d=B1(l)-(o?0:r.r),h=d==0?"":o?d+1:"["+d+"]",p=c==0?"":s?c+1:"["+c+"]";return i+"R"+h+"C"+p})}}();function zA(t,e){return t.replace(J1,function(r,n,i,s,a,o){return n+(i=="$"?i+s:Ar(j1(s)+e.c))+(a=="$"?a+o:Hr(B1(o)+e.r))})}function L6(t,e,r){var n=bi(e),i=n.s,s=kr(r),a={r:s.r-i.r,c:s.c-i.c};return zA(t,a)}function B6(t){return t.length!=1}function g2(t){return t.replace(/_xlfn\./g,"")}function qr(t){t.l+=1}function Vo(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function WA(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return HA(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=Vo(t),o=Vo(t);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function HA(t){var e=Vo(t),r=Vo(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function j6(t,e,r){if(r.biff<8)return HA(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=Vo(t),a=Vo(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function $A(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return V6(t);var n=t.read_shift(r&&r.biff==12?4:2),i=Vo(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function V6(t){var e=Vo(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function U6(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function z6(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return W6(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function W6(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function H6(t,e,r){var n=(t[t.l++]&96)>>5,i=WA(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function $6(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=WA(t,s,r);return[n,i,a]}function G6(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function K6(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function X6(t,e,r){var n=(t[t.l++]&96)>>5,i=j6(t,e-1,r);return[n,i]}function Y6(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function x2(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function q6(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function Q6(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function J6(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function Z6(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function e8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function GA(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function t8(t){return t.read_shift(2),GA(t)}function r8(t){return t.read_shift(2),GA(t)}function n8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=$A(t,0,r);return[n,i]}function i8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=z6(t,0,r);return[n,i]}function s8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=$A(t,0,r);return[n,i,s]}function a8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[c5[i],YA[i],n]}function o8(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:l8(t);return[i,(s[0]===0?YA:l5)[s[1]]]}function l8(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function c8(t,e,r){t.l+=r&&r.biff==2?3:4}function u8(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function f8(t){return t.l++,Xa[t.read_shift(1)]}function d8(t){return t.l++,t.read_shift(2)}function h8(t){return t.l++,t.read_shift(1)!==0}function p8(t){return t.l++,qn(t)}function m8(t,e,r){return t.l++,E0(t,e-1,r)}function g8(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ur(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Xa[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=qn(t);break;case 2:r[1]=Kl(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function x8(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Gl:Np)(t));return i}function v8(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=g8(t,r.biff);return a}function y8(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function _8(t,e,r){if(r.biff==5)return E8(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function E8(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function w8(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function T8(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function S8(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function A8(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var k8=Zn,C8=Zn,F8=Zn;function T0(t,e,r){return t.l+=2,[U6(t)]}function ev(t){return t.l+=6,[]}var I8=T0,b8=ev,R8=ev,N8=T0;function KA(t){return t.l+=2,[Zr(t),t.read_shift(2)&1]}var D8=T0,P8=KA,O8=ev,M8=T0,L8=T0,B8=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function j8(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=B8[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function V8(t){return t.l+=2,[t.read_shift(4)]}function U8(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function z8(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function W8(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function H8(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function $8(t){return t.l+=4,[0,0]}var v2={1:{n:"PtgExp",f:u8},2:{n:"PtgTbl",f:F8},3:{n:"PtgAdd",f:qr},4:{n:"PtgSub",f:qr},5:{n:"PtgMul",f:qr},6:{n:"PtgDiv",f:qr},7:{n:"PtgPower",f:qr},8:{n:"PtgConcat",f:qr},9:{n:"PtgLt",f:qr},10:{n:"PtgLe",f:qr},11:{n:"PtgEq",f:qr},12:{n:"PtgGe",f:qr},13:{n:"PtgGt",f:qr},14:{n:"PtgNe",f:qr},15:{n:"PtgIsect",f:qr},16:{n:"PtgUnion",f:qr},17:{n:"PtgRange",f:qr},18:{n:"PtgUplus",f:qr},19:{n:"PtgUminus",f:qr},20:{n:"PtgPercent",f:qr},21:{n:"PtgParen",f:qr},22:{n:"PtgMissArg",f:qr},23:{n:"PtgStr",f:m8},26:{n:"PtgSheet",f:U8},27:{n:"PtgEndSheet",f:z8},28:{n:"PtgErr",f:f8},29:{n:"PtgBool",f:h8},30:{n:"PtgInt",f:d8},31:{n:"PtgNum",f:p8},32:{n:"PtgArray",f:Y6},33:{n:"PtgFunc",f:a8},34:{n:"PtgFuncVar",f:o8},35:{n:"PtgName",f:y8},36:{n:"PtgRef",f:n8},37:{n:"PtgArea",f:H6},38:{n:"PtgMemArea",f:w8},39:{n:"PtgMemErr",f:k8},40:{n:"PtgMemNoMem",f:C8},41:{n:"PtgMemFunc",f:T8},42:{n:"PtgRefErr",f:S8},43:{n:"PtgAreaErr",f:G6},44:{n:"PtgRefN",f:i8},45:{n:"PtgAreaN",f:X6},46:{n:"PtgMemAreaN",f:W8},47:{n:"PtgMemNoMemN",f:H8},57:{n:"PtgNameX",f:_8},58:{n:"PtgRef3d",f:s8},59:{n:"PtgArea3d",f:$6},60:{n:"PtgRefErr3d",f:A8},61:{n:"PtgAreaErr3d",f:K6},255:{}},G8={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},K8={1:{n:"PtgElfLel",f:KA},2:{n:"PtgElfRw",f:M8},3:{n:"PtgElfCol",f:I8},6:{n:"PtgElfRwV",f:L8},7:{n:"PtgElfColV",f:N8},10:{n:"PtgElfRadical",f:D8},11:{n:"PtgElfRadicalS",f:O8},13:{n:"PtgElfColS",f:b8},15:{n:"PtgElfColSV",f:R8},16:{n:"PtgElfRadicalLel",f:P8},25:{n:"PtgList",f:j8},29:{n:"PtgSxName",f:V8},255:{}},X8={0:{n:"PtgAttrNoop",f:$8},1:{n:"PtgAttrSemi",f:e8},2:{n:"PtgAttrIf",f:J6},4:{n:"PtgAttrChoose",f:q6},8:{n:"PtgAttrGoto",f:Q6},16:{n:"PtgAttrSum",f:c8},32:{n:"PtgAttrBaxcel",f:x2},33:{n:"PtgAttrBaxcel",f:x2},64:{n:"PtgAttrSpace",f:t8},65:{n:"PtgAttrSpaceSemi",f:r8},128:{n:"PtgAttrIfError",f:Z6},255:{}};function S0(t,e,r,n){if(n.biff<8)return Zn(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=v8(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=x8(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(Zn(t,e)),s}function A0(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=v2[s]||v2[G8[s]],(s===24||s===25)&&(i=(s===24?K8:X8)[t[t.l+1]]),!i||!i.f?Zn(t,e):a.push([i.n,i.f(t,e,r)]);return a}function Y8(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var q8={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Q8(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function XA(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function y2(t,e,r){var n=XA(t,e,r);return n=="#REF"?n:Q8(n,r)}function Gn(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,c,d,h=0,p=0,g,y="";if(!t[0]||!t[0][0])return"";for(var x=-1,E="",T=0,A=t[0].length;T<A;++T){var _=t[0][T];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),x>=0){switch(t[0][x][1][0]){case 0:E=Lr(" ",t[0][x][1][1]);break;case 1:E=Lr("\r",t[0][x][1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}c=c+E,x=-1}o.push(c+q8[_[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=mf(_[1][1],a,i),o.push(gf(d,s));break;case"PtgRefN":d=r?mf(_[1][1],r,i):_[1][1],o.push(gf(d,s));break;case"PtgRef3d":h=_[1][1],d=mf(_[1][2],a,i),y=y2(n,h,i),o.push(y+"!"+gf(d,s));break;case"PtgFunc":case"PtgFuncVar":var P=_[1][0],W=_[1][1];P||(P=0),P&=127;var j=P==0?[]:o.slice(-P);o.length-=P,W==="User"&&(W=j.shift()),o.push(W+"("+j.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":g=X_(_[1][1],r?{s:r}:a,i),o.push(km(g,i));break;case"PtgArea":g=X_(_[1][1],a,i),o.push(km(g,i));break;case"PtgArea3d":h=_[1][1],g=_[1][2],y=y2(n,h,i),o.push(y+"!"+km(g,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=_[1][2];var w=(n.names||[])[p-1]||(n[0]||[])[p],F=w?w.Name:"SH33TJSNAME"+String(p);F&&F.slice(0,6)=="_xlfn."&&!i.xlfn&&(F=F.slice(6)),o.push(F);break;case"PtgNameX":var S=_[1][1];p=_[1][2];var b;if(i.biff<=5)S<0&&(S=-S),n[S]&&(b=n[S][p]);else{var N="";if(((n[S]||[])[0]||[])[0]==14849||(((n[S]||[])[0]||[])[0]==1025?n[S][p]&&n[S][p].itab>0&&(N=n.SheetNames[n[S][p].itab-1]+"!"):N=n.SheetNames[p-1]+"!"),n[S]&&n[S][p])N+=n[S][p].Name;else if(n[0]&&n[0][p])N+=n[0][p].Name;else{var D=(XA(n,S,i)||"").split(";;");D[p-1]?N=D[p-1]:N+="SH33TJSERRX"}o.push(N);break}b||(b={Name:"SH33TJSERRY"}),o.push(b.Name);break;case"PtgParen":var R="(",He=")";if(x>=0){switch(E="",t[0][x][1][0]){case 2:R=Lr(" ",t[0][x][1][1])+R;break;case 3:R=Lr("\r",t[0][x][1][1])+R;break;case 4:He=Lr(" ",t[0][x][1][1])+He;break;case 5:He=Lr("\r",t[0][x][1][1])+He;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}x=-1}o.push(R+o.pop()+He);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:_[1][1],r:_[1][0]};var xe={c:r.c,r:r.r};if(n.sharedf[ot(d)]){var be=n.sharedf[ot(d)];o.push(Gn(be,a,xe,n,i))}else{var Ae=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(d.c<c[0].s.c||d.c>c[0].e.c)&&!(d.r<c[0].s.r||d.r>c[0].e.r)){o.push(Gn(c[1],a,xe,n,i)),Ae=!0;break}Ae||o.push(_[1])}break;case"PtgArray":o.push("{"+Y8(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var Ee=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&Ee.indexOf(t[0][T][0])==-1){_=t[0][x];var Z=!0;switch(_[1][0]){case 4:Z=!1;case 0:E=Lr(" ",_[1][1]);break;case 5:Z=!1;case 1:E=Lr("\r",_[1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((Z?E:"")+o.pop()+(Z?"":E)),x=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function J8(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],Zn(t,e-2)];var o=A0(t,a,r);return e!==a+i&&(s=S0(t,e-a-i,o,r)),t.l=n,[o,s]}function Z8(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],Zn(t,e-2)];var o=A0(t,a,r);return e!==a+i&&(s=S0(t,e-a-i,o,r)),t.l=n,[o,s]}function e5(t,e,r,n){var i=t.l+e,s=A0(t,n,r),a;return i!==t.l&&(a=S0(t,i-t.l,s,r)),[s,a]}function t5(t,e,r){var n=t.l+e,i,s=t.read_shift(2),a=A0(t,s,r);return s==65535?[[],Zn(t,e-2)]:(e!==s+2&&(i=S0(t,n-s-2,a,r)),[a,i])}function r5(t){var e;if(ka(t,t.l+6)!==65535)return[qn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function n5(t){if(t==null){var e=ge(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Rl(t);return Rl(0)}function Rm(t,e,r){var n=t.l+e,i=la(t);r.biff==2&&++t.l;var s=r5(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=Z8(t,n-t.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function i5(t,e,r,n,i){var s=Dl(e,r,i),a=n5(t.v),o=ge(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=ge(t.bf.length),d=0;d<t.bf.length;++d)c[d]=t.bf[d];var h=vn([s,a,o,c]);return h}function Dp(t,e,r){var n=t.read_shift(4),i=A0(t,n,r),s=t.read_shift(4),a=s>0?S0(t,s,i,r):null;return[i,a]}var s5=Dp,Pp=Dp,a5=Dp,o5=Dp,l5={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},YA={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},c5={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function _2(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function u5(t){var e="of:="+t.replace(J1,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Nm(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function f5(t){return t.replace(/\./,"!")}var vf={},Uc={},yf=typeof Map<"u";function tv(t,e,r){var n=0,i=t.length;if(r){if(yf?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=yf?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(yf?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function Op(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Xn=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=Zf(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=Gh(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function El(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function qo(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Na(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function qA(t,e,r,n,i,s){try{n.cellNF&&(t.z=at[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=hr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(at[e]==null&&Na(lR[e]||"General",e),t.t==="e")t.w=t.w||Xa[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Gf(t.v);else if(t.t==="d"){var a=un(t.v);(a|0)===a?t.w=a.toString(10):t.w=Gf(a)}else{if(t.v===void 0)return"";t.w=Il(t.v,Uc)}else t.t==="d"?t.w=ds(e,un(t.v),Uc):t.w=ds(e,t.v,Uc)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=$h(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=$h(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function d5(t,e,r){if(t&&t["!ref"]){var n=Ot(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function h5(t,e){var r=Ot(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=vt(r))}var p5=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,m5=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,g5=/<(?:\w:)?hyperlink [^>]*>/mg,x5=/"(\w*:\w*)"/,v5=/<(?:\w:)?col\b[^>]*[\/]?>/g,y5=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,_5=/<(?:\w:)?pageMargins[^>]*\/>/g,QA=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,E5=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,w5=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function T5(t,e,r,n,i,s,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",d="",h=t.match(m5);h?(c=t.slice(0,h.index),d=t.slice(h.index+h[0].length)):c=d=t;var p=c.match(QA);p?rv(p[0],o,i,r):(p=c.match(E5))&&A5(p[0],p[1]||"",o,i,r);var g=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(g>0){var y=c.slice(g,g+50).match(x5);y&&h5(o,y[1])}var x=c.match(w5);x&&x[1]&&B5(x[1],i);var E=[];if(e.cellStyles){var T=c.match(v5);T&&D5(E,T)}h&&U5(h[1],o,e,l,s,a);var A=d.match(y5);A&&(o["!autofilter"]=O5(A[0]));var _=[],P=d.match(p5);if(P)for(g=0;g!=P.length;++g)_[g]=Ot(P[g].slice(P[g].indexOf('"')+1));var W=d.match(g5);W&&b5(o,W,n);var j=d.match(_5);if(j&&(o["!margins"]=R5(ct(j[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=vt(l)),e.sheetRows>0&&o["!ref"]){var w=Ot(o["!ref"]);e.sheetRows<=+w.e.r&&(w.e.r=e.sheetRows-1,w.e.r>l.e.r&&(w.e.r=l.e.r),w.e.r<w.s.r&&(w.s.r=w.e.r),w.e.c>l.e.c&&(w.e.c=l.e.c),w.e.c<w.s.c&&(w.s.c=w.e.c),o["!fullref"]=o["!ref"],o["!ref"]=vt(w))}return E.length>0&&(o["!cols"]=E),_.length>0&&(o["!merges"]=_),o}function S5(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+vt(t[r])+'"/>';return e+"</mergeCells>"}function rv(t,e,r,n){var i=ct(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Pt(Jt(i.codeName)))}function A5(t,e,r,n,i){rv(t.slice(0,t.indexOf(">")),r,n,i)}function k5(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=Js(Gt(l))}if(t&&t["!outline"]){var c={summaryBelow:1,summaryRight:1};t["!outline"].above&&(c.summaryBelow=0),t["!outline"].left&&(c.summaryRight=0),o=(o||"")+Be("outlinePr",null,c)}!s&&!o||(i[i.length]=Be("sheetPr",o,a))}var C5=["objects","scenarios","selectLockedCells","selectUnlockedCells"],F5=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function I5(t){var e={sheet:1};return C5.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),F5.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=Y1(t.password).toString(16).toUpperCase()),Be("sheetProtection",null,e)}function b5(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=ct(Jt(e[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+Pt(s.location))):(s.Target="#"+Pt(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Ot(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var d=ot({c,r:l});n?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=s):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=s)}}}function R5(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function N5(t){return El(t),Be("pageMargins",null,t)}function D5(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=ct(e[n],!0);i.hidden&&(i.hidden=fr(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,q1(i.width)),jo(i);s<=a;)t[s++]=pr(i)}}function P5(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=Be("col",null,Op(i,n)));return r[r.length]="</cols>",r.join("")}function O5(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function M5(t,e,r,n){var i=typeof t.ref=="string"?t.ref:vt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=bi(i);a.s.r==a.e.r&&(a.e.r=bi(e["!ref"]).e.r,i=vt(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Be("autoFilter",null,{ref:i})}var L5=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function B5(t,e){e.Views||(e.Views=[{}]),(t.match(L5)||[]).forEach(function(r,n){var i=ct(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),fr(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function j5(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Be("sheetViews",Be("sheetView",null,i),{})}function V5(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=Xa[t.v];break;case"d":n&&n.cellDates?i=hr(t.v,-1).toISOString():(t=pr(t),t.t="n",i=""+(t.v=un(hr(t.v)))),typeof t.z>"u"&&(t.z=at[14]);break;default:i=t.v;break}var o=In("v",Gt(i)),l={r:e},c=qo(n.cellXfs,t,n);switch(c!==0&&(l.s=c),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=In("v",""+tv(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=a),typeof t.f=="string"&&t.f){var d=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=Be("f",Gt(t.f),d)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),Be("c",o,l)}var U5=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=Kf("v"),a=Kf("f");return function(l,c,d,h,p,g){for(var y=0,x="",E=[],T=[],A=0,_=0,P=0,W="",j,w,F=0,S=0,b,N,D=0,R=0,He=Array.isArray(g.CellXf),xe,be=[],Ae=[],Ee=Array.isArray(c),Z=[],Ce={},Le=!1,U=!!d.sheetStubs,G=l.split(e),J=0,q=G.length;J!=q;++J){x=G[J].trim();var he=x.length;if(he!==0){var Se=0;e:for(y=0;y<he;++y)switch(x[y]){case">":if(x[y-1]!="/"){++y;break e}if(d&&d.cellStyles){if(w=ct(x.slice(Se,y),!0),F=w.r!=null?parseInt(w.r,10):F+1,S=-1,d.sheetRows&&d.sheetRows<F)continue;Ce={},Le=!1,w.ht&&(Le=!0,Ce.hpt=parseFloat(w.ht),Ce.hpx=tu(Ce.hpt)),w.hidden=="1"&&(Le=!0,Ce.hidden=!0),w.outlineLevel!=null&&(Le=!0,Ce.level=+w.outlineLevel),Le&&(Z[F-1]=Ce)}break;case"<":Se=y;break}if(Se>=y)break;if(w=ct(x.slice(Se,y),!0),F=w.r!=null?parseInt(w.r,10):F+1,S=-1,!(d.sheetRows&&d.sheetRows<F)){h.s.r>F-1&&(h.s.r=F-1),h.e.r<F-1&&(h.e.r=F-1),d&&d.cellStyles&&(Ce={},Le=!1,w.ht&&(Le=!0,Ce.hpt=parseFloat(w.ht),Ce.hpx=tu(Ce.hpt)),w.hidden=="1"&&(Le=!0,Ce.hidden=!0),w.outlineLevel!=null&&(Le=!0,Ce.level=+w.outlineLevel),Le&&(Z[F-1]=Ce)),E=x.slice(y).split(t);for(var Ne=0;Ne!=E.length&&E[Ne].trim().charAt(0)=="<";++Ne);for(E=E.slice(Ne),y=0;y!=E.length;++y)if(x=E[y].trim(),x.length!==0){if(T=x.match(r),A=y,_=0,P=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,T!=null&&T.length===2){for(A=0,W=T[1],_=0;_!=W.length&&!((P=W.charCodeAt(_)-64)<1||P>26);++_)A=26*A+P;--A,S=A}else++S;for(_=0;_!=x.length&&x.charCodeAt(_)!==62;++_);if(++_,w=ct(x.slice(0,_),!0),w.r||(w.r=ot({r:F-1,c:S})),W=x.slice(_),j={t:""},(T=W.match(s))!=null&&T[1]!==""&&(j.v=Pt(T[1])),d.cellFormula){if((T=W.match(a))!=null&&T[1]!==""){if(j.f=Pt(Jt(T[1])).replace(/\r\n/g,`
`),d.xlfn||(j.f=g2(j.f)),T[0].indexOf('t="array"')>-1)j.F=(W.match(i)||[])[1],j.F.indexOf(":")>-1&&be.push([Ot(j.F),j.F]);else if(T[0].indexOf('t="shared"')>-1){N=ct(T[0]);var ke=Pt(Jt(T[1]));d.xlfn||(ke=g2(ke)),Ae[parseInt(N.si,10)]=[N,ke,w.r]}}else(T=W.match(/<f[^>]*\/>/))&&(N=ct(T[0]),Ae[N.si]&&(j.f=L6(Ae[N.si][1],Ae[N.si][2],w.r)));var Te=kr(w.r);for(_=0;_<be.length;++_)Te.r>=be[_][0].s.r&&Te.r<=be[_][0].e.r&&Te.c>=be[_][0].s.c&&Te.c<=be[_][0].e.c&&(j.F=be[_][1])}if(w.t==null&&j.v===void 0)if(j.f||j.F)j.v=0,j.t="n";else if(U)j.t="z";else continue;else j.t=w.t||"n";switch(h.s.c>S&&(h.s.c=S),h.e.c<S&&(h.e.c=S),j.t){case"n":if(j.v==""||j.v==null){if(!U)continue;j.t="z"}else j.v=parseFloat(j.v);break;case"s":if(typeof j.v>"u"){if(!U)continue;j.t="z"}else b=vf[parseInt(j.v,10)],j.v=b.t,j.r=b.r,d.cellHTML&&(j.h=b.h);break;case"str":j.t="s",j.v=j.v!=null?Jt(j.v):"",d.cellHTML&&(j.h=P1(j.v));break;case"inlineStr":T=W.match(n),j.t="s",T!=null&&(b=X1(T[1]))?(j.v=b.t,d.cellHTML&&(j.h=b.h)):j.v="";break;case"b":j.v=fr(j.v);break;case"d":d.cellDates?j.v=hr(j.v,1):(j.v=un(hr(j.v,1)),j.t="n");break;case"e":(!d||d.cellText!==!1)&&(j.w=j.v),j.v=ZS[j.v];break}if(D=R=0,xe=null,He&&w.s!==void 0&&(xe=g.CellXf[w.s],xe!=null&&(xe.numFmtId!=null&&(D=xe.numFmtId),d.cellStyles&&xe.fillId!=null&&(R=xe.fillId))),qA(j,D,R,d,p,g),d.cellDates&&He&&j.t=="n"&&pu(at[D])&&(j.t="d",j.v=Rp(j.v)),w.cm&&d.xlmeta){var nt=(d.xlmeta.Cell||[])[+w.cm-1];nt&&nt.type=="XLDAPR"&&(j.D=!0)}if(Ee){var K=kr(w.r);c[K.r]||(c[K.r]=[]),c[K.r][K.c]=j}else c[w.r]=j}}}}Z.length>0&&(c["!rows"]=Z)}}();function z5(t,e,r,n){var i=[],s=[],a=Ot(t["!ref"]),o="",l,c="",d=[],h=0,p=0,g=t["!rows"],y=Array.isArray(t),x={r:c},E,T=-1;for(p=a.s.c;p<=a.e.c;++p)d[p]=Ar(p);for(h=a.s.r;h<=a.e.r;++h){for(s=[],c=Hr(h),p=a.s.c;p<=a.e.c;++p){l=d[p]+c;var A=y?(t[h]||[])[p]:t[l];A!==void 0&&(o=V5(A,l,t,e))!=null&&s.push(o)}(s.length>0||g&&g[h])&&(x={r:c},g&&g[h]&&(E=g[h],E.hidden&&(x.hidden=1),T=-1,E.hpx?T=e0(E.hpx):E.hpt&&(T=E.hpt),T>-1&&(x.ht=T,x.customHeight=1),E.level&&(x.outlineLevel=E.level)),i[i.length]=Be("row",s.join(""),x))}if(g)for(;h<g.length;++h)g&&g[h]&&(x={r:h+1},E=g[h],E.hidden&&(x.hidden=1),T=-1,E.hpx?T=e0(E.hpx):E.hpt&&(T=E.hpt),T>-1&&(x.ht=T,x.customHeight=1),E.level&&(x.outlineLevel=E.level),i[i.length]=Be("row","",x));return i.join("")}function JA(t,e,r,n){var i=[$r,Be("worksheet",null,{xmlns:zl[0],"xmlns:r":an.r})],s=r.SheetNames[t],a=0,o="",l=r.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",d=Ot(c);if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),c=vt(d)}n||(n={}),l["!comments"]=[];var h=[];k5(l,r,t,e,i),i[i.length]=Be("dimension",null,{ref:c}),i[i.length]=j5(l,e,t,r),e.sheetFormat&&(i[i.length]=Be("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=P5(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=z5(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=I5(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=M5(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=S5(l["!merges"]));var p=-1,g,y=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(g={ref:x[0]},x[1].Target.charAt(0)!="#"&&(y=$t(n,-1,Gt(x[1].Target).replace(/#.*$/,""),wt.HLINK),g["r:id"]="rId"+y),(p=x[1].Target.indexOf("#"))>-1&&(g.location=Gt(x[1].Target.slice(p+1))),x[1].Tooltip&&(g.tooltip=Gt(x[1].Tooltip)),i[i.length]=Be("hyperlink",null,g))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=N5(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=In("ignoredErrors",Be("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(y=$t(n,-1,"../drawings/drawing"+(t+1)+".xml",wt.DRAW),i[i.length]=Be("drawing",null,{"r:id":"rId"+y}),l["!drawing"]=h),l["!comments"].length>0&&(y=$t(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",wt.VML),i[i.length]=Be("legacyDrawing",null,{"r:id":"rId"+y}),l["!legacy"]=y),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function W5(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function H5(t,e,r){var n=ge(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=e0(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:t,c:0},d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var h=-1,p=-1,g=d<<10;g<d+1<<10;++g){c.c=g;var y=Array.isArray(r)?(r[c.r]||[])[c.c]:r[ot(c)];y&&(h<0&&(h=g),p=g)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,p))}var x=n.l;return n.l=l,n.write_shift(4,o),n.l=x,n.length>n.l?n.slice(0,n.l):n}function $5(t,e,r,n){var i=H5(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&we(t,0,i)}var G5=Gl,K5=xu;function X5(){}function Y5(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=JR(t),r}function q5(t,e,r){r==null&&(r=ge(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return zh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),XS(t,r),r.slice(0,r.l)}function Q5(t){var e=hs(t);return[e]}function J5(t,e,r){return r==null&&(r=ge(8)),Wl(e,r)}function Z5(t){var e=Hl(t);return[e]}function eO(t,e,r){return r==null&&(r=ge(4)),$l(e,r)}function tO(t){var e=hs(t),r=t.read_shift(1);return[e,r,"b"]}function rO(t,e,r){return r==null&&(r=ge(9)),Wl(e,r),r.write_shift(1,t.v?1:0),r}function nO(t){var e=Hl(t),r=t.read_shift(1);return[e,r,"b"]}function iO(t,e,r){return r==null&&(r=ge(5)),$l(e,r),r.write_shift(1,t.v?1:0),r}function sO(t){var e=hs(t),r=t.read_shift(1);return[e,r,"e"]}function aO(t,e,r){return r==null&&(r=ge(9)),Wl(e,r),r.write_shift(1,t.v),r}function oO(t){var e=Hl(t),r=t.read_shift(1);return[e,r,"e"]}function lO(t,e,r){return r==null&&(r=ge(8)),$l(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function cO(t){var e=hs(t),r=t.read_shift(4);return[e,r,"s"]}function uO(t,e,r){return r==null&&(r=ge(12)),Wl(e,r),r.write_shift(4,e.v),r}function fO(t){var e=Hl(t),r=t.read_shift(4);return[e,r,"s"]}function dO(t,e,r){return r==null&&(r=ge(8)),$l(e,r),r.write_shift(4,e.v),r}function hO(t){var e=hs(t),r=qn(t);return[e,r,"n"]}function pO(t,e,r){return r==null&&(r=ge(16)),Wl(e,r),Rl(t.v,r),r}function ZA(t){var e=Hl(t),r=qn(t);return[e,r,"n"]}function mO(t,e,r){return r==null&&(r=ge(12)),$l(e,r),Rl(t.v,r),r}function gO(t){var e=hs(t),r=W1(t);return[e,r,"n"]}function xO(t,e,r){return r==null&&(r=ge(12)),Wl(e,r),YS(t.v,r),r}function vO(t){var e=Hl(t),r=W1(t);return[e,r,"n"]}function yO(t,e,r){return r==null&&(r=ge(8)),$l(e,r),YS(t.v,r),r}function _O(t){var e=hs(t),r=V1(t);return[e,r,"is"]}function EO(t){var e=hs(t),r=Qn(t);return[e,r,"str"]}function wO(t,e,r){return r==null&&(r=ge(12+4*t.v.length)),Wl(e,r),yn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function TO(t){var e=Hl(t),r=Qn(t);return[e,r,"str"]}function SO(t,e,r){return r==null&&(r=ge(8+4*t.v.length)),$l(e,r),yn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function AO(t,e,r){var n=t.l+e,i=hs(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=Pp(t,n-t.l,r);a[3]=Gn(o,null,i,r.supbooks,r)}else t.l=n;return a}function kO(t,e,r){var n=t.l+e,i=hs(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=Pp(t,n-t.l,r);a[3]=Gn(o,null,i,r.supbooks,r)}else t.l=n;return a}function CO(t,e,r){var n=t.l+e,i=hs(t);i.r=r["!row"];var s=qn(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=Pp(t,n-t.l,r);a[3]=Gn(o,null,i,r.supbooks,r)}else t.l=n;return a}function FO(t,e,r){var n=t.l+e,i=hs(t);i.r=r["!row"];var s=Qn(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=Pp(t,n-t.l,r);a[3]=Gn(o,null,i,r.supbooks,r)}else t.l=n;return a}var IO=Gl,bO=xu;function RO(t,e){return e==null&&(e=ge(4)),e.write_shift(4,t),e}function NO(t,e){var r=t.l+e,n=Gl(t),i=U1(t),s=Qn(t),a=Qn(t),o=Qn(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function DO(t,e){var r=ge(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));xu({s:kr(t[0]),e:kr(t[0])},r),z1("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return yn(i||"",r),yn(t[1].Tooltip||"",r),yn("",r),r.slice(0,r.l)}function PO(){}function OO(t,e,r){var n=t.l+e,i=qS(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=s5(t,n-t.l,r);a[1]=o}else t.l=n;return a}function MO(t,e,r){var n=t.l+e,i=Gl(t),s=[i];if(r.cellFormula){var a=o5(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function LO(t,e,r){r==null&&(r=ge(18));var n=Op(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var ek=["left","right","top","bottom","header","footer"];function BO(t){var e={};return ek.forEach(function(r){e[r]=qn(t)}),e}function jO(t,e){return e==null&&(e=ge(6*8)),El(t),ek.forEach(function(r){Rl(t[r],e)}),e}function VO(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function UO(t,e,r){r==null&&(r=ge(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function zO(t){var e=ge(24);return e.write_shift(4,4),e.write_shift(4,1),xu(t,e),e}function WO(t,e){return e==null&&(e=ge(16*4+2)),e.write_shift(2,t.password?Y1(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function HO(){}function $O(){}function GO(t,e,r,n,i,s,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,p=!1,g,y,x,E,T,A,_,P,W,j=[];o.biff=12,o["!row"]=0;var w=0,F=!1,S=[],b={},N=o.supbooks||i.supbooks||[[]];if(N.sharedf=b,N.arrayf=S,N.SheetNames=i.SheetNames||i.Sheets.map(function(Ee){return Ee.name}),!o.supbooks&&(o.supbooks=N,i.Names))for(var D=0;D<i.Names.length;++D)N[0][D+1]=i.Names[D];var R=[],He=[],xe=!1;t0[16]={n:"BrtShortReal",f:ZA};var be;if(Ka(t,function(Z,Ce,Le){if(!p)switch(Le){case 148:c=Z;break;case 0:g=Z,o.sheetRows&&o.sheetRows<=g.r&&(p=!0),P=Hr(E=g.r),o["!row"]=g.r,(Z.hidden||Z.hpt||Z.level!=null)&&(Z.hpt&&(Z.hpx=tu(Z.hpt)),He[Z.r]=Z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:Z[2]},Z[2]){case"n":y.v=Z[1];break;case"s":_=vf[Z[1]],y.v=_.t,y.r=_.r;break;case"b":y.v=!!Z[1];break;case"e":y.v=Z[1],o.cellText!==!1&&(y.w=Xa[y.v]);break;case"str":y.t="s",y.v=Z[1];break;case"is":y.t="s",y.v=Z[1].t;break}if((x=a.CellXf[Z[0].iStyleRef])&&qA(y,x.numFmtId,null,o,s,a),T=Z[0].c==-1?T+1:Z[0].c,o.dense?(l[E]||(l[E]=[]),l[E][T]=y):l[Ar(T)+P]=y,o.cellFormula){for(F=!1,w=0;w<S.length;++w){var U=S[w];g.r>=U[0].s.r&&g.r<=U[0].e.r&&T>=U[0].s.c&&T<=U[0].e.c&&(y.F=vt(U[0]),F=!0)}!F&&Z.length>3&&(y.f=Z[3])}if(d.s.r>g.r&&(d.s.r=g.r),d.s.c>T&&(d.s.c=T),d.e.r<g.r&&(d.e.r=g.r),d.e.c<T&&(d.e.c=T),o.cellDates&&x&&y.t=="n"&&pu(at[x.numFmtId])){var G=pl(y.v);G&&(y.t="d",y.v=new Date(G.y,G.m-1,G.d,G.H,G.M,G.S,G.u))}be&&(be.type=="XLDAPR"&&(y.D=!0),be=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;y={t:"z",v:void 0},T=Z[0].c==-1?T+1:Z[0].c,o.dense?(l[E]||(l[E]=[]),l[E][T]=y):l[Ar(T)+P]=y,d.s.r>g.r&&(d.s.r=g.r),d.s.c>T&&(d.s.c=T),d.e.r<g.r&&(d.e.r=g.r),d.e.c<T&&(d.e.c=T),be&&(be.type=="XLDAPR"&&(y.D=!0),be=void 0);break;case 176:j.push(Z);break;case 49:be=((o.xlmeta||{}).Cell||[])[Z-1];break;case 494:var J=n["!id"][Z.relId];for(J?(Z.Target=J.Target,Z.loc&&(Z.Target+="#"+Z.loc),Z.Rel=J):Z.relId==""&&(Z.Target="#"+Z.loc),E=Z.rfx.s.r;E<=Z.rfx.e.r;++E)for(T=Z.rfx.s.c;T<=Z.rfx.e.c;++T)o.dense?(l[E]||(l[E]=[]),l[E][T]||(l[E][T]={t:"z",v:void 0}),l[E][T].l=Z):(A=ot({c:T,r:E}),l[A]||(l[A]={t:"z",v:void 0}),l[A].l=Z);break;case 426:if(!o.cellFormula)break;S.push(Z),W=o.dense?l[E][T]:l[Ar(T)+P],W.f=Gn(Z[1],d,{r:g.r,c:T},N,o),W.F=vt(Z[0]);break;case 427:if(!o.cellFormula)break;b[ot(Z[0].s)]=Z[1],W=o.dense?l[E][T]:l[Ar(T)+P],W.f=Gn(Z[1],d,{r:g.r,c:T},N,o);break;case 60:if(!o.cellStyles)break;for(;Z.e>=Z.s;)R[Z.e--]={width:Z.w/256,hidden:!!(Z.flags&1),level:Z.level},xe||(xe=!0,q1(Z.w/256)),jo(R[Z.e+1]);break;case 161:l["!autofilter"]={ref:vt(Z)};break;case 476:l["!margins"]=Z;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),Z.name&&(i.Sheets[r].CodeName=Z.name),(Z.above||Z.left)&&(l["!outline"]={above:Z.above,left:Z.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),Z.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!Ce.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+Le.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(d.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=vt(c||d)),o.sheetRows&&l["!ref"]){var Ae=Ot(l["!ref"]);o.sheetRows<=+Ae.e.r&&(Ae.e.r=o.sheetRows-1,Ae.e.r>d.e.r&&(Ae.e.r=d.e.r),Ae.e.r<Ae.s.r&&(Ae.s.r=Ae.e.r),Ae.e.c>d.e.c&&(Ae.e.c=d.e.c),Ae.e.c<Ae.s.c&&(Ae.s.c=Ae.e.c),l["!fullref"]=l["!ref"],l["!ref"]=vt(Ae))}return j.length>0&&(l["!merges"]=j),R.length>0&&(l["!cols"]=R),He.length>0&&(l["!rows"]=He),l}function KO(t,e,r,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=pr(e),e.z=e.z||at[14],e.v=un(hr(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r,c:n};switch(l.s=qo(i.cellXfs,e,i),e.l&&s["!links"].push([ot(l),e.l]),e.c&&s["!comments"].push([ot(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=tv(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?we(t,18,dO(e,l)):we(t,7,uO(e,l))):(l.t="str",a?we(t,17,SO(e,l)):we(t,6,wO(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?we(t,13,yO(e,l)):we(t,2,xO(e,l)):a?we(t,16,mO(e,l)):we(t,5,pO(e,l)),!0;case"b":return l.t="b",a?we(t,15,iO(e,l)):we(t,4,rO(e,l)),!0;case"e":return l.t="e",a?we(t,14,lO(e,l)):we(t,3,aO(e,l)),!0}return a?we(t,12,eO(e,l)):we(t,1,J5(e,l)),!0}function XO(t,e,r,n){var i=Ot(e["!ref"]||"A1"),s,a="",o=[];we(t,145);var l=Array.isArray(e),c=i.e.r;e["!rows"]&&(c=Math.max(i.e.r,e["!rows"].length-1));for(var d=i.s.r;d<=c;++d){a=Hr(d),$5(t,e,i,d);var h=!1;if(d<=i.e.r)for(var p=i.s.c;p<=i.e.c;++p){d===i.s.r&&(o[p]=Ar(p)),s=o[p]+a;var g=l?(e[d]||[])[p]:e[s];if(!g){h=!1;continue}h=KO(t,g,d,p,n,e,h)}}we(t,146)}function YO(t,e){!e||!e["!merges"]||(we(t,177,RO(e["!merges"].length)),e["!merges"].forEach(function(r){we(t,176,bO(r))}),we(t,178))}function qO(t,e){!e||!e["!cols"]||(we(t,390),e["!cols"].forEach(function(r,n){r&&we(t,60,LO(n,r))}),we(t,391))}function QO(t,e){!e||!e["!ref"]||(we(t,648),we(t,649,zO(Ot(e["!ref"]))),we(t,650))}function JO(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=$t(r,-1,n[1].Target.replace(/#.*$/,""),wt.HLINK);we(t,494,DO(n,i))}}),delete e["!links"]}function ZO(t,e,r,n){if(e["!comments"].length>0){var i=$t(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",wt.VML);we(t,551,z1("rId"+i)),e["!legacy"]=i}}function eM(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:vt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=bi(s);o.s.r==o.e.r&&(o.e.r=bi(e["!ref"]).e.r,s=vt(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),we(t,161,xu(Ot(s))),we(t,162)}}function tM(t,e,r){we(t,133),we(t,137,UO(e,r)),we(t,138),we(t,134)}function rM(t,e){e["!protect"]&&we(t,535,WO(e["!protect"]))}function nM(t,e,r,n){var i=Ii(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=Ot(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],we(i,129),(r.vbaraw||a["!outline"])&&we(i,147,q5(o,a["!outline"])),we(i,148,K5(l)),tM(i,a,r.Workbook),qO(i,a),XO(i,a,t,e),rM(i,a),eM(i,a,r,t),YO(i,a),JO(i,a,n),a["!margins"]&&we(i,476,jO(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&QO(i,a),ZO(i,a,t,n),we(i,130),i.end()}function iM(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var i=Pt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function sM(t,e,r,n,i,s){var a=s||{"!type":"chart"};if(!t)return s;var o=0,l=0,c="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var p=iM(h);d.s.r=d.s.c=0,d.e.c=o,c=Ar(o),p[0].forEach(function(g,y){a[c+Hr(y)]={t:"n",v:g,z:p[1]},l=y}),d.e.r<l&&(d.e.r=l),++o}),o>0&&(a["!ref"]=vt(d)),a}function aM(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(QA);return o&&rv(o[0],s,i,r),(a=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function oM(t,e){t.l+=10;var r=Qn(t);return{name:r}}function lM(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return Ka(t,function(l,c,d){switch(d){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var nv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],cM=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],uM=[],fM=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function E2(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=fr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function w2(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=fr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function tk(t){w2(t.WBProps,nv),w2(t.CalcPr,fM),E2(t.WBView,cM),E2(t.Sheets,uM),Uc.date1904=fr(t.WBProps.date1904)}function dM(t){return!t.Workbook||!t.Workbook.WBProps?"false":fr(t.Workbook.WBProps.date1904)?"true":"false"}var hM="][*?/\\".split("");function rk(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return hM.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function pM(t,e,r){t.forEach(function(n,i){rk(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function mM(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];pM(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)d5(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var gM=/<\w+:workbook/;function xM(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(t.replace(ti,function(l,c){var d=ct(l);switch(oa(d[0])){case"<?xml":break;case"<workbook":l.match(gM)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=d[i];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":nv.forEach(function(h){if(d[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=fr(d[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(d[h[0]],10);break;default:r.WBProps[h[0]]=d[h[0]]}}),d.codeName&&(r.WBProps.CodeName=Jt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Pt(Jt(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Jt(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),fr(d.hidden||"0")&&(s.Hidden=!0),a=c+l.length;break;case"</definedName>":s.Ref=Pt(Jt(t.slice(a,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return l}),zl.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return tk(r),r}function nk(t){var e=[$r];e[e.length]=Be("workbook",null,{xmlns:zl[0],"xmlns:r":an.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(nv.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Be("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:Gt(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=Be("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=Be("definedName",Gt(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function vM(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Qg(t),r.name=Qn(t),r}function yM(t,e){return e||(e=ge(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),z1(t.strRelID,e),yn(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function _M(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?Qn(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function EM(t,e){e||(e=ge(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),XS(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function wM(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function TM(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=ZR(t),a=a5(t,0,r),o=U1(t);t.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function SM(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],t0[16]={n:"BrtFRTArchID$",f:wM},Ka(t,function(l,c,d){switch(d){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=Gn(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([d,l]):a[0]=[d,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(d),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},e),tk(r),r.Names=s,r.supbooks=a,r}function AM(t,e){we(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};we(t,156,yM(i))}we(t,144)}function kM(t,e){e||(e=ge(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return yn("SheetJS",e),yn(Oh.version,e),yn(Oh.version,e),yn("7262",e),e.length>e.l?e.slice(0,e.l):e}function CM(t,e){e||(e=ge(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function FM(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(we(t,135),we(t,158,CM(i)),we(t,136))}}function IM(t,e){var r=Ii();return we(r,131),we(r,128,kM()),we(r,153,EM(t.Workbook&&t.Workbook.WBProps||null)),FM(r,t),AM(r,t),we(r,132),r.end()}function bM(t,e,r){return e.slice(-4)===".bin"?SM(t,r):xM(t,r)}function RM(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?GO(t,n,r,i,s,a,o):T5(t,n,r,i,s,a,o)}function NM(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?lM(t,n,r,i,s):aM(t,n,r,i,s)}function DM(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?O6():M6()}function PM(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?D6():P6()}function OM(t,e,r,n){return e.slice(-4)===".bin"?bP(t,r,n):vP(t,r,n)}function MM(t,e,r){return LA(t,r)}function LM(t,e,r){return e.slice(-4)===".bin"?LD(t,r):PD(t,r)}function BM(t,e,r){return e.slice(-4)===".bin"?F6(t,r):y6(t,r)}function jM(t,e,r){return e.slice(-4)===".bin"?g6(t):p6(t)}function VM(t,e,r,n){return r.slice(-4)===".bin"?x6(t,e,r,n):void 0}function UM(t,e,r){return e.slice(-4)===".bin"?f6(t,e,r):h6(t,e,r)}function zM(t,e,r){return(e.slice(-4)===".bin"?IM:nk)(t)}function WM(t,e,r,n,i){return(e.slice(-4)===".bin"?nM:JA)(t,r,n,i)}function HM(t,e,r){return(e.slice(-4)===".bin"?VP:OA)(t,r)}function $M(t,e,r){return(e.slice(-4)===".bin"?VD:CA)(t,r)}function GM(t,e,r){return(e.slice(-4)===".bin"?I6:VA)(t)}function KM(t){return(t.slice(-4)===".bin"?d6:BA)()}var ik=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,sk=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ss(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(ik),s,a,o,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(sk),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function XM(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(ik),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(sk),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var _f;function YM(t,e){var r=_f[t]||Pt(t);return r==="General"?Il(e):ds(r,e)}function qM(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=fr(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=hr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Pt(e)]=i}function QM(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Xa[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Gf(t.v):t.w=Il(t.v):t.w=YM(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=_f[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&pu(n)){var i=pl(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function JM(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=uP[n.Pattern]||n.Pattern)}t[e.ID]=e}function ZM(t,e,r,n,i,s,a,o,l,c){var d="General",h=n.StyleID,p={};c=c||{};var g=[],y=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&a&&(h=a.StyleID);s[h]!==void 0&&(s[h].nf&&(d=s[h].nf),s[h].Interior&&g.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=fr(t);break;case"String":n.t="s",n.r=j_(Pt(t)),n.v=t.indexOf("<")>-1?Pt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(hr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Pt(t):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=ZS[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=j_(e||t));break}if(QM(n,d,c),c.cellFormula!==!1)if(n.Formula){var x=Pt(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=Vc(x,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Vc("RC:RC",i):n.ArrayRange&&(n.F=Vc(n.ArrayRange,i),l.push([Ot(n.F),n.F]))}else for(y=0;y<l.length;++y)i.r>=l[y][0].s.r&&i.r<=l[y][0].e.r&&i.c>=l[y][0].s.c&&i.c<=l[y][0].e.c&&(n.F=l[y][1]);c.cellStyles&&(g.forEach(function(E){!p.patternType&&E.patternType&&(p.patternType=E.patternType)}),n.s=p),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function eL(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Dm(t,e){var r=e||{};mu();var n=Qu(O1(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Jt(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=pr(r);return a.type="string",eu.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Yt){i.indexOf("<"+Yt)>=0&&(s=!0)}),s)return jL(n,r);_f={"General Number":"General","General Date":at[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":at[15],"Short Date":at[14],"Long Time":at[19],"Medium Time":at[18],"Short Time":at[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:at[2],Standard:at[4],Percent:at[10],Scientific:at[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,d={},h=[],p=r.dense?[]:{},g="",y={},x={},E=Ss('<Data ss:Type="String">'),T=0,A=0,_=0,P={s:{r:2e6,c:2e6},e:{r:0,c:0}},W={},j={},w="",F=0,S=[],b={},N={},D=0,R=[],He=[],xe={},be=[],Ae,Ee=!1,Z=[],Ce=[],Le={},U=0,G=0,J={Sheets:[],WBProps:{date1904:!1}},q={};Yf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var he="";o=Yf.exec(n);)switch(o[3]=(he=o[3]).toLowerCase()){case"data":if(he=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?ZM(n.slice(T,o.index),w,E,l[l.length-1][0]=="comment"?xe:y,{c:A,r:_},W,be[A],x,Z,r):(w="",E=Ss(o[0]),T=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(He.length>0&&(y.c=He),(!r.sheetRows||r.sheetRows>_)&&y.v!==void 0&&(r.dense?(p[_]||(p[_]=[]),p[_][A]=y):p[Ar(A)+Hr(_)]=y),y.HRef&&(y.l={Target:Pt(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(U=A+(parseInt(y.MergeAcross,10)|0),G=_+(parseInt(y.MergeDown,10)|0),S.push({s:{c:A,r:_},e:{c:U,r:G}})),!r.sheetStubs)y.MergeAcross?A=U+1:++A;else if(y.MergeAcross||y.MergeDown){for(var Se=A;Se<=U;++Se)for(var Ne=_;Ne<=G;++Ne)(Se>A||Ne>_)&&(r.dense?(p[Ne]||(p[Ne]=[]),p[Ne][Se]={t:"z"}):p[Ar(Se)+Hr(Ne)]={t:"z"});A=U+1}else++A;else y=XM(o[0]),y.Index&&(A=+y.Index-1),A<P.s.c&&(P.s.c=A),A>P.e.c&&(P.e.c=A),o[0].slice(-2)==="/>"&&++A,He=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(_<P.s.r&&(P.s.r=_),_>P.e.r&&(P.e.r=_),o[0].slice(-2)==="/>"&&(x=Ss(o[0]),x.Index&&(_=+x.Index-1)),A=0,++_):(x=Ss(o[0]),x.Index&&(_=+x.Index-1),Le={},(x.AutoFitHeight=="0"||x.Height)&&(Le.hpx=parseInt(x.Height,10),Le.hpt=e0(Le.hpx),Ce[_]=Le),x.Hidden=="1"&&(Le.hidden=!0,Ce[_]=Le));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(g),P.s.r<=P.e.r&&P.s.c<=P.e.c&&(p["!ref"]=vt(P),r.sheetRows&&r.sheetRows<=P.e.r&&(p["!fullref"]=p["!ref"],P.e.r=r.sheetRows-1,p["!ref"]=vt(P))),S.length&&(p["!merges"]=S),be.length>0&&(p["!cols"]=be),Ce.length>0&&(p["!rows"]=Ce),d[g]=p}else P={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=A=0,l.push([o[3],!1]),c=Ss(o[0]),g=Pt(c.Name),p=r.dense?[]:{},S=[],Z=[],Ce=[],q={name:g,Hidden:0},J.Sheets.push(q);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),be=[],Ee=!1}break;case"style":o[1]==="/"?JM(W,j,r):j=Ss(o[0]);break;case"numberformat":j.nf=Pt(Ss(o[0]).Format||"General"),_f[j.nf]&&(j.nf=_f[j.nf]);for(var ke=0;ke!=392&&at[ke]!=j.nf;++ke);if(ke==392){for(ke=57;ke!=392;++ke)if(at[ke]==null){Na(j.nf,ke);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(Ae=Ss(o[0]),Ae.Hidden&&(Ae.hidden=!0,delete Ae.Hidden),Ae.Width&&(Ae.wpx=parseInt(Ae.Width,10)),!Ee&&Ae.wpx>10){Ee=!0,Xn=DA;for(var Te=0;Te<be.length;++Te)be[Te]&&jo(be[Te])}Ee&&jo(Ae),be[Ae.Index-1||be.length]=Ae;for(var nt=0;nt<+Ae.Span;++nt)be[be.length]=pr(Ae);break;case"namedrange":if(o[1]==="/")break;J.Names||(J.Names=[]);var K=ct(o[0]),Ct={Name:K.Name,Ref:Vc(K.RefersTo.slice(1),{r:0,c:0})};J.Sheets.length>0&&(Ct.Sheet=J.Sheets.length-1),J.Names.push(Ct);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?w+=n.slice(F,o.index):F=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;j.Interior=Ss(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?SN(b,he,n.slice(D,o.index)):D=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));eL(xe),He.push(xe)}else l.push([o[3],!1]),c=Ss(o[0]),xe={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var xt=Ss(o[0]);p["!autofilter"]={ref:Vc(xt.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return C2(n,r);var Rt=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Rt=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Rt=!1}break;case"excelworkbook":switch(o[3]){case"date1904":J.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Rt=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Rt=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(D,o.index)){case"SheetHidden":q.Hidden=1;break;case"SheetVeryHidden":q.Hidden=2;break}else D=o.index+o[0].length;break;case"header":p["!margins"]||El(p["!margins"]={},"xlml"),isNaN(+ct(o[0]).Margin)||(p["!margins"].header=+ct(o[0]).Margin);break;case"footer":p["!margins"]||El(p["!margins"]={},"xlml"),isNaN(+ct(o[0]).Margin)||(p["!margins"].footer=+ct(o[0]).Margin);break;case"pagemargins":var pt=ct(o[0]);p["!margins"]||El(p["!margins"]={},"xlml"),isNaN(+pt.Top)||(p["!margins"].top=+pt.Top),isNaN(+pt.Left)||(p["!margins"].left=+pt.Left),isNaN(+pt.Right)||(p["!margins"].right=+pt.Right),isNaN(+pt.Bottom)||(p["!margins"].bottom=+pt.Bottom);break;case"displayrighttoleft":J.Views||(J.Views=[]),J.Views[0]||(J.Views[0]={}),J.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Rt=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Rt=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Rt=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Rt=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Rt=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Rt=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Rt=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Rt=!1}break;case"smarttags":break;default:Rt=!1;break}if(Rt||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?qM(N,he,R,n.slice(D,o.index)):(R=o,D=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var $e={};return!r.bookSheets&&!r.bookProps&&($e.Sheets=d),$e.SheetNames=h,$e.Workbook=J,$e.SSF=pr(at),$e.Props=b,$e.Custprops=N,$e}function ix(t,e){switch(sv(e=e||{}),e.type||"base64"){case"base64":return Dm(Hi(t),e);case"binary":case"buffer":case"file":return Dm(t,e);case"array":return Dm(Xo(t),e)}}function tL(t,e){var r=[];return t.Props&&r.push(AN(t.Props,e)),t.Custprops&&r.push(kN(t.Props,t.Custprops)),r.join("")}function rL(){return""}function nL(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(Be("NumberFormat",null,{"ss:Format":Gt(at[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(Be("Style",s.join(""),a))}),Be("Styles",r.join(""))}function ak(t){return Be("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+Z1(t.Ref,{r:0,c:0})})}function iL(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(ak(i)))}return Be("Names",r.join(""))}function sL(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(ak(o)))}return s.join("")}function aL(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(Be("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(Be("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(Be("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Be("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(In("ProtectContents","True")),t["!protect"].objects&&i.push(In("ProtectObjects","True")),t["!protect"].scenarios&&i.push(In("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(In("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(In("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":Be("WorksheetOptions",i.join(""),{xmlns:Mi.x})}function oL(t){return t.map(function(e){var r=FR(e.t||""),n=Be("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Be("Comment",n,{"ss:Author":e.a})}).join("")}function lL(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+Gt(Z1(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var l=kr(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=Gt(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=Gt(t.l.Tooltip))),r["!merges"])for(var c=r["!merges"],d=0;d!=c.length;++d)c[d].s.c!=a.c||c[d].s.r!=a.r||(c[d].e.c>c[d].s.c&&(o["ss:MergeAcross"]=c[d].e.c-c[d].s.c),c[d].e.r>c[d].s.r&&(o["ss:MergeDown"]=c[d].e.r-c[d].s.r));var h="",p="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",p=String(t.v);break;case"b":h="Boolean",p=t.v?"1":"0";break;case"e":h="Error",p=Xa[t.v];break;case"d":h="DateTime",p=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||at[14]);break;case"s":h="String",p=CR(t.v||"");break}var g=qo(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+g),o["ss:Index"]=a.c+1;var y=t.v!=null?p:"",x=t.t=="z"?"":'<Data ss:Type="'+h+'">'+y+"</Data>";return(t.c||[]).length>0&&(x+=oL(t.c)),Be("Cell",x,o)}function cL(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=tu(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function uL(t,e,r,n){if(!t["!ref"])return"";var i=Ot(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(E,T){jo(E);var A=!!E.width,_=Op(T,E),P={"ss:Index":T+1};A&&(P["ss:Width"]=Jf(_.width)),E.hidden&&(P["ss:Hidden"]="1"),o.push(Be("Column",null,P))});for(var l=Array.isArray(t),c=i.s.r;c<=i.e.r;++c){for(var d=[cL(c,(t["!rows"]||[])[c])],h=i.s.c;h<=i.e.c;++h){var p=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>h)&&!(s[a].s.r>c)&&!(s[a].e.c<h)&&!(s[a].e.r<c)){(s[a].s.c!=h||s[a].s.r!=c)&&(p=!0);break}if(!p){var g={r:c,c:h},y=ot(g),x=l?(t[c]||[])[h]:t[y];d.push(lL(x,y,t,e,r,n,g))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function fL(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?sL(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?uL(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(aL(s,e,t,r)),n.join("")}function dL(t,e){e||(e={}),t.SSF||(t.SSF=pr(at)),t.SSF&&(mu(),Fp(t.SSF),e.revssf=bp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],qo(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(tL(t,e)),r.push(rL()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Be("Worksheet",fL(n,e,t),{"ss:Name":Gt(t.SheetNames[n])}));return r[2]=nL(t,e),r[3]=iL(t),$r+Be("Workbook",r.join(""),{xmlns:Mi.ss,"xmlns:o":Mi.o,"xmlns:x":Mi.x,"xmlns:ss":Mi.ss,"xmlns:dt":Mi.dt,"xmlns:html":Mi.html})}function hL(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=iN(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=sN(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var pL=[60,1084,2066,2165,2175];function mL(t,e,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var l=ka(r,r.l),c=sx[l],d=0;c!=null&&pL.indexOf(l)>-1;)s=ka(r,r.l+2),d=r.l+4,l==2066?d+=4:(l==2165||l==2175)&&(d+=12),o=r.slice(d,r.l+4+s),a.push(o),r.l+=4+s,c=sx[l=ka(r,r.l)];var h=vn(a);Fn(h,0);var p=0;h.lens=[];for(var g=0;g<a.length;++g)h.lens.push(p),p+=a[g].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,i)}function $s(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=at[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Xa[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Gf(t.v):t.w=Il(t.v):t.w=ds(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&pu(at[n]||String(n))){var i=pl(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Rd(t,e,r){return{v:t,ixfe:e,t:r}}function gL(t,e){var r={opts:{}},n={},i=e.dense?[]:{},s={},a={},o=null,l=[],c="",d={},h,p="",g,y,x,E,T={},A=[],_,P,W=[],j=[],w={Sheets:[],WBProps:{date1904:!1},Views:[{}]},F={},S=function(ut){return ut<8?vl[ut]:ut<64&&j[ut-8]||vl[ut]},b=function(ut,nr,Er){var mr=nr.XF.data;if(!(!mr||!mr.patternType||!Er||!Er.cellStyles)){nr.s={},nr.s.patternType=mr.patternType;var ni;(ni=Qf(S(mr.icvFore)))&&(nr.s.fgColor={rgb:ni}),(ni=Qf(S(mr.icvBack)))&&(nr.s.bgColor={rgb:ni})}},N=function(ut,nr,Er){if(!(Le>1)&&!(Er.sheetRows&&ut.r>=Er.sheetRows)){if(Er.cellStyles&&nr.XF&&nr.XF.data&&b(ut,nr,Er),delete nr.ixfe,delete nr.XF,h=ut,p=ot(ut),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),ut.r<a.s.r&&(a.s.r=ut.r),ut.c<a.s.c&&(a.s.c=ut.c),ut.r+1>a.e.r&&(a.e.r=ut.r+1),ut.c+1>a.e.c&&(a.e.c=ut.c+1),Er.cellFormula&&nr.f){for(var mr=0;mr<A.length;++mr)if(!(A[mr][0].s.c>ut.c||A[mr][0].s.r>ut.r)&&!(A[mr][0].e.c<ut.c||A[mr][0].e.r<ut.r)){nr.F=vt(A[mr][0]),(A[mr][0].s.c!=ut.c||A[mr][0].s.r!=ut.r)&&delete nr.f,nr.f&&(nr.f=""+Gn(A[mr][1],a,ut,Z,D));break}}Er.dense?(i[ut.r]||(i[ut.r]=[]),i[ut.r][ut.c]=nr):i[p]=nr}},D={enc:!1,sbcch:0,snames:[],sharedf:T,arrayf:A,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(D.password=e.password);var R,He=[],xe=[],be=[],Ae=[],Ee=!1,Z=[];Z.SheetNames=D.snames,Z.sharedf=D.sharedf,Z.arrayf=D.arrayf,Z.names=[],Z.XTI=[];var Ce=0,Le=0,U=0,G=[],J=[],q;D.codepage=1200,Fs(1200);for(var he=!1;t.l<t.length-1;){var Se=t.l,Ne=t.read_shift(2);if(Ne===0&&Ce===10)break;var ke=t.l===t.length?0:t.read_shift(2),Te=sx[Ne];if(Te&&Te.f){if(e.bookSheets&&Ce===133&&Ne!==133)break;if(Ce=Ne,Te.r===2||Te.r==12){var nt=t.read_shift(2);if(ke-=2,!D.enc&&nt!==Ne&&((nt&255)<<8|nt>>8)!==Ne)throw new Error("rt mismatch: "+nt+"!="+Ne);Te.r==12&&(t.l+=10,ke-=10)}var K={};if(Ne===10?K=Te.f(t,ke,D):K=mL(Ne,Te,t,ke,D),Le==0&&[9,521,1033,2057].indexOf(Ce)===-1)continue;switch(Ne){case 34:r.opts.Date1904=w.WBProps.date1904=K;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(t.l=0),D.enc=K,!e.password)throw new Error("File is password-protected");if(K.valid==null)throw new Error("Encryption scheme unsupported");if(!K.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=K;break;case 66:var Ct=Number(K);switch(Ct){case 21010:Ct=1200;break;case 32768:Ct=1e4;break;case 32769:Ct=1252;break}Fs(D.codepage=Ct),he=!0;break;case 317:D.rrtabid=K;break;case 25:D.winlocked=K;break;case 439:r.opts.RefreshAll=K;break;case 12:r.opts.CalcCount=K;break;case 16:r.opts.CalcDelta=K;break;case 17:r.opts.CalcIter=K;break;case 13:r.opts.CalcMode=K;break;case 14:r.opts.CalcPrecision=K;break;case 95:r.opts.CalcSaveRecalc=K;break;case 15:D.CalcRefMode=K;break;case 2211:r.opts.FullCalc=K;break;case 129:K.fDialog&&(i["!type"]="dialog"),K.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),K.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:W.push(K);break;case 430:Z.push([K]),Z[Z.length-1].XTI=[];break;case 35:case 547:Z[Z.length-1].push(K);break;case 24:case 536:q={Name:K.Name,Ref:Gn(K.rgce,a,null,Z,D)},K.itab>0&&(q.Sheet=K.itab-1),Z.names.push(q),Z[0]||(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].push(K),K.Name=="_xlnm._FilterDatabase"&&K.itab>0&&K.rgce&&K.rgce[0]&&K.rgce[0][0]&&K.rgce[0][0][0]=="PtgArea3d"&&(J[K.itab-1]={ref:vt(K.rgce[0][0][1][2])});break;case 22:D.ExternCount=K;break;case 23:Z.length==0&&(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].XTI=Z[Z.length-1].XTI.concat(K),Z.XTI=Z.XTI.concat(K);break;case 2196:if(D.biff<8)break;q!=null&&(q.Comment=K[1]);break;case 18:i["!protect"]=K;break;case 19:K!==0&&D.WTF&&console.error("Password verifier: "+K);break;case 133:s[K.pos]=K,D.snames.push(K.name);break;case 10:{if(--Le)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=vt(a),e.sheetRows&&e.sheetRows<=a.e.r){var xt=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=vt(a),a.e.r=xt}a.e.r++,a.e.c++}He.length>0&&(i["!merges"]=He),xe.length>0&&(i["!objects"]=xe),be.length>0&&(i["!cols"]=be),Ae.length>0&&(i["!rows"]=Ae),w.Sheets.push(F)}c===""?d=i:n[c]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[Ne]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[K.BIFFVer]||8),D.biffguess=K.BIFFVer==0,K.BIFFVer==0&&K.dt==4096&&(D.biff=5,he=!0,Fs(D.codepage=28591)),D.biff==8&&K.BIFFVer==0&&K.dt==16&&(D.biff=2),Le++)break;if(i=e.dense?[]:{},D.biff<8&&!he&&(he=!0,Fs(D.codepage=e.codepage||1252)),D.biff<5||K.BIFFVer==0&&K.dt==4096){c===""&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var Rt={pos:t.l-ke,name:c};s[Rt.pos]=Rt,D.snames.push(c)}else c=(s[Se]||{name:""}).name;K.dt==32&&(i["!type"]="chart"),K.dt==64&&(i["!type"]="macro"),He=[],xe=[],D.arrayf=A=[],be=[],Ae=[],Ee=!1,F={Hidden:(s[Se]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[K.r]||[])[K.c]:i[ot({c:K.c,r:K.r})])&&++K.c,_={ixfe:K.ixfe,XF:W[K.ixfe]||{},v:K.val,t:"n"},U>0&&(_.z=G[_.ixfe>>8&63]),$s(_,e,r.opts.Date1904),N({c:K.c,r:K.r},_,e);break;case 5:case 517:_={ixfe:K.ixfe,XF:W[K.ixfe],v:K.val,t:K.t},U>0&&(_.z=G[_.ixfe>>8&63]),$s(_,e,r.opts.Date1904),N({c:K.c,r:K.r},_,e);break;case 638:_={ixfe:K.ixfe,XF:W[K.ixfe],v:K.rknum,t:"n"},U>0&&(_.z=G[_.ixfe>>8&63]),$s(_,e,r.opts.Date1904),N({c:K.c,r:K.r},_,e);break;case 189:for(var pt=K.c;pt<=K.C;++pt){var $e=K.rkrec[pt-K.c][0];_={ixfe:$e,XF:W[$e],v:K.rkrec[pt-K.c][1],t:"n"},U>0&&(_.z=G[_.ixfe>>8&63]),$s(_,e,r.opts.Date1904),N({c:pt,r:K.r},_,e)}break;case 6:case 518:case 1030:{if(K.val=="String"){o=K;break}if(_=Rd(K.val,K.cell.ixfe,K.tt),_.XF=W[_.ixfe],e.cellFormula){var Yt=K.formula;if(Yt&&Yt[0]&&Yt[0][0]&&Yt[0][0][0]=="PtgExp"){var En=Yt[0][0][1][0],fn=Yt[0][0][1][1],gi=ot({r:En,c:fn});T[gi]?_.f=""+Gn(K.formula,a,K.cell,Z,D):_.F=((e.dense?(i[En]||[])[fn]:i[gi])||{}).F}else _.f=""+Gn(K.formula,a,K.cell,Z,D)}U>0&&(_.z=G[_.ixfe>>8&63]),$s(_,e,r.opts.Date1904),N(K.cell,_,e),o=K}break;case 7:case 519:if(o)o.val=K,_=Rd(K,o.cell.ixfe,"s"),_.XF=W[_.ixfe],e.cellFormula&&(_.f=""+Gn(o.formula,a,o.cell,Z,D)),U>0&&(_.z=G[_.ixfe>>8&63]),$s(_,e,r.opts.Date1904),N(o.cell,_,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{A.push(K);var Ki=ot(K[0].s);if(g=e.dense?(i[K[0].s.r]||[])[K[0].s.c]:i[Ki],e.cellFormula&&g){if(!o||!Ki||!g)break;g.f=""+Gn(K[1],a,K[0],Z,D),g.F=vt(K[0])}}break;case 1212:{if(!e.cellFormula)break;if(p){if(!o)break;T[ot(o.cell)]=K[0],g=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[ot(o.cell)],(g||{}).f=""+Gn(K[0],a,h,Z,D)}}break;case 253:_=Rd(l[K.isst].t,K.ixfe,"s"),l[K.isst].h&&(_.h=l[K.isst].h),_.XF=W[_.ixfe],U>0&&(_.z=G[_.ixfe>>8&63]),$s(_,e,r.opts.Date1904),N({c:K.c,r:K.r},_,e);break;case 513:e.sheetStubs&&(_={ixfe:K.ixfe,XF:W[K.ixfe],t:"z"},U>0&&(_.z=G[_.ixfe>>8&63]),$s(_,e,r.opts.Date1904),N({c:K.c,r:K.r},_,e));break;case 190:if(e.sheetStubs)for(var xi=K.c;xi<=K.C;++xi){var br=K.ixfe[xi-K.c];_={ixfe:br,XF:W[br],t:"z"},U>0&&(_.z=G[_.ixfe>>8&63]),$s(_,e,r.opts.Date1904),N({c:xi,r:K.r},_,e)}break;case 214:case 516:case 4:_=Rd(K.val,K.ixfe,"s"),_.XF=W[_.ixfe],U>0&&(_.z=G[_.ixfe>>8&63]),$s(_,e,r.opts.Date1904),N({c:K.c,r:K.r},_,e);break;case 0:case 512:Le===1&&(a=K);break;case 252:l=K;break;case 1054:if(D.biff==4){G[U++]=K[1];for(var vi=0;vi<U+163&&at[vi]!=K[1];++vi);vi>=163&&Na(K[1],U+163)}else Na(K[1],K[0]);break;case 30:{G[U++]=K;for(var zt=0;zt<U+163&&at[zt]!=K;++zt);zt>=163&&Na(K,U+163)}break;case 229:He=He.concat(K);break;case 93:xe[K.cmo[0]]=D.lastobj=K;break;case 438:D.lastobj.TxO=K;break;case 127:D.lastobj.ImData=K;break;case 440:for(E=K[0].s.r;E<=K[0].e.r;++E)for(x=K[0].s.c;x<=K[0].e.c;++x)g=e.dense?(i[E]||[])[x]:i[ot({c:x,r:E})],g&&(g.l=K[1]);break;case 2048:for(E=K[0].s.r;E<=K[0].e.r;++E)for(x=K[0].s.c;x<=K[0].e.c;++x)g=e.dense?(i[E]||[])[x]:i[ot({c:x,r:E})],g&&g.l&&(g.l.Tooltip=K[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;g=e.dense?(i[K[0].r]||[])[K[0].c]:i[ot(K[0])];var _r=xe[K[2]];g||(e.dense?(i[K[0].r]||(i[K[0].r]=[]),g=i[K[0].r][K[0].c]={t:"z"}):g=i[ot(K[0])]={t:"z"},a.e.r=Math.max(a.e.r,K[0].r),a.s.r=Math.min(a.s.r,K[0].r),a.e.c=Math.max(a.e.c,K[0].c),a.s.c=Math.min(a.s.c,K[0].c)),g.c||(g.c=[]),y={a:K[1],t:_r.TxO.t},g.c.push(y)}break;case 2173:n6(W[K.ixfe],K.ext);break;case 125:{if(!D.cellStyles)break;for(;K.e>=K.s;)be[K.e--]={width:K.w/256,level:K.level||0,hidden:!!(K.flags&1)},Ee||(Ee=!0,q1(K.w/256)),jo(be[K.e+1])}break;case 520:{var Zt={};K.level!=null&&(Ae[K.r]=Zt,Zt.level=K.level),K.hidden&&(Ae[K.r]=Zt,Zt.hidden=!0),K.hpt&&(Ae[K.r]=Zt,Zt.hpt=K.hpt,Zt.hpx=tu(K.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||El(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ne]]=K;break;case 161:i["!margins"]||El(i["!margins"]={}),i["!margins"].header=K.header,i["!margins"].footer=K.footer;break;case 574:K.RTL&&(w.Views[0].RTL=!0);break;case 146:j=K;break;case 2198:R=K;break;case 140:P=K;break;case 442:c?F.CodeName=K||F.name:w.WBProps.CodeName=K||"ThisWorkbook";break}}else Te||console.error("Missing Info for XLS Record 0x"+Ne.toString(16)),t.l+=ke}return r.SheetNames=Vr(s).sort(function(ri,ut){return Number(ri)-Number(ut)}).map(function(ri){return s[ri].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&J.forEach(function(ri,ut){r.Sheets[r.SheetNames[ut]]["!autofilter"]=ri}),r.Strings=l,r.SSF=pr(at),D.enc&&(r.Encryption=D.enc),R&&(r.Themes=R),r.Metadata={},P!==void 0&&(r.Metadata.Country=P),Z.names.length>0&&(w.Names=Z.names),r.Workbook=w,r}var Ef={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function xL(t,e,r){var n=Ze.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=n2(n,Jg,Ef.DSI);for(var s in i)e[s]=i[s]}catch(c){if(r.WTF)throw c}var a=Ze.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=n2(a,Zg,Ef.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(sA(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function vL(t,e){var r=[],n=[],i=[],s=0,a,o=D_(Jg,"n"),l=D_(Zg,"n");if(t.Props)for(a=Vr(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=Vr(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var c=[];for(s=0;s<i.length;++s)dA.indexOf(i[s][0])>-1||iA.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&Ze.utils.cfb_add(e,"/SummaryInformation",i2(n,Ef.SI,l,Zg)),(r.length||c.length)&&Ze.utils.cfb_add(e,"/DocumentSummaryInformation",i2(r,Ef.DSI,o,Jg,c.length?c:null,Ef.UDI))}function ok(t,e){e||(e={}),sv(e),k1(),e.codepage&&A1(e.codepage);var r,n;if(t.FullPaths){if(Ze.find(t,"/encryption"))throw new Error("File is password-protected");r=Ze.find(t,"!CompObj"),n=Ze.find(t,"/Workbook")||Ze.find(t,"/Book")}else{switch(e.type){case"base64":t=Bi(Hi(t));break;case"binary":t=Bi(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Fn(t,0),n={content:t}}var i,s;if(r&&hL(r),e.bookProps&&!e.bookSheets)i={};else{var a=Et?"buffer":"array";if(n&&n.content)i=gL(n.content,e);else if((s=Ze.find(t,"PerfectOffice_MAIN"))&&s.content)i=_l.to_workbook(s.content,(e.type=a,e));else if((s=Ze.find(t,"NativeContent_MAIN"))&&s.content)i=_l.to_workbook(s.content,(e.type=a,e));else throw(s=Ze.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Ze.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=R6(t))}var o={};return t.FullPaths&&xL(t,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=t),i}function yL(t,e){var r=e||{},n=Ze.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ze.utils.cfb_add(n,i,lk(t,r)),r.biff==8&&(t.Props||t.Custprops)&&vL(t,n),r.biff==8&&t.vbaraw&&N6(n,Ze.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var t0={0:{f:W5},1:{f:Q5},2:{f:gO},3:{f:sO},4:{f:tO},5:{f:hO},6:{f:EO},7:{f:cO},8:{f:FO},9:{f:CO},10:{f:AO},11:{f:kO},12:{f:Z5},13:{f:vO},14:{f:oO},15:{f:nO},16:{f:ZA},17:{f:TO},18:{f:fO},19:{f:V1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:TM},40:{},42:{},43:{f:EP},44:{f:yP},45:{f:SP},46:{f:kP},47:{f:AP},48:{},49:{f:GR},50:{},51:{f:a6},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:TA},62:{f:_O},63:{f:m6},64:{f:HO},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Zn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:VO},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Y5},148:{f:G5,p:16},151:{f:PO},152:{},153:{f:_M},154:{},155:{},156:{f:vM},157:{},158:{},159:{T:1,f:MD},160:{T:-1},161:{T:1,f:Gl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:IO},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:i6},336:{T:-1},337:{f:c6,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Qg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:wA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:OO},427:{f:MO},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:BO},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:X5},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:NO},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Qg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:k6},633:{T:1},634:{T:-1},635:{T:1,f:S6},636:{T:-1},637:{f:qR},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:oM},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:$O},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},sx={6:{f:Rm},10:{f:ao},12:{f:Zr},13:{f:Zr},14:{f:Ur},15:{f:Ur},16:{f:qn},17:{f:Ur},18:{f:Ur},19:{f:Zr},20:{f:u2},21:{f:u2},23:{f:wA},24:{f:d2},25:{f:Ur},26:{},27:{},28:{f:$3},29:{},34:{f:Ur},35:{f:f2},38:{f:qn},39:{f:qn},40:{f:qn},41:{f:qn},42:{f:Ur},43:{f:Ur},47:{f:nP},49:{f:v3},51:{f:Zr},60:{},61:{f:h3},64:{f:Ur},65:{f:x3},66:{f:Zr},77:{},80:{},81:{},82:{},85:{f:Zr},89:{},90:{},91:{},92:{f:r3},93:{f:X3},94:{},95:{f:Ur},96:{},97:{},99:{f:Ur},125:{f:TA},128:{f:D3},129:{f:i3},130:{f:Zr},131:{f:Ur},132:{f:Ur},133:{f:s3},134:{},140:{f:rD},141:{f:Zr},144:{},146:{f:sD},151:{},152:{},153:{},154:{},155:{},156:{f:Zr},157:{},158:{},160:{f:dD},161:{f:lD},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:I3},190:{f:b3},193:{f:ao},197:{},198:{},199:{},200:{},201:{},202:{f:Ur},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Zr},220:{},221:{f:Ur},222:{},224:{f:N3},225:{f:t3},226:{f:ao},227:{},229:{f:G3},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:o3},253:{f:_3},255:{f:c3},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:hA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ur},353:{f:ao},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:B3},431:{f:Ur},432:{},433:{},434:{},437:{},438:{f:Q3},439:{f:Ur},440:{f:J3},441:{},442:{f:w0},443:{},444:{f:Zr},445:{},446:{},448:{f:ao},449:{f:d3,r:2},450:{f:ao},512:{f:o2},513:{f:fD},515:{f:M3},516:{f:w3},517:{f:c2},519:{f:hD},520:{f:u3},523:{},545:{f:h2},549:{f:a2},566:{},574:{f:m3},638:{f:F3},659:{},1048:{},1054:{f:S3},1084:{},1212:{f:z3},2048:{f:eD},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Fd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ao},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:aD,r:12},2173:{f:r6,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ur,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:U3,r:12},2197:{},2198:{f:qP,r:12},2199:{},2200:{},2201:{},2202:{f:W3,r:12},2203:{f:ao},2204:{},2205:{},2206:{},2207:{},2211:{f:f3},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Zr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:cD},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:iD},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:o2},1:{},2:{f:vD},3:{f:gD},4:{f:mD},5:{f:c2},7:{f:_D},8:{},9:{f:Fd},11:{},22:{f:Zr},30:{f:k3},31:{},32:{},33:{f:h2},36:{},37:{f:a2},50:{f:ED},62:{},52:{},67:{},68:{f:Zr},69:{},86:{},126:{},127:{f:pD},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:wD},223:{},234:{},354:{},421:{},518:{f:Rm},521:{f:Fd},536:{f:d2},547:{f:f2},561:{},579:{},1030:{f:Rm},1033:{f:Fd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ue(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&L1(r)&&t.push(r)}}function _L(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return Ue(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var d=t.next(4);for(d.write_shift(2,s),d.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c;l<i;){for(d=t.next(4),d.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;d.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c}}}function k0(t,e,r){return t||(t=ge(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function EL(t,e,r,n){var i=ge(9);return k0(i,t,e),pA(r,n||"b",i),i}function wL(t,e,r){var n=ge(8+2*r.length);return k0(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function TL(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?un(hr(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?Ue(t,2,yD(r,n,i)):Ue(t,3,xD(r,n,i));return;case"b":case"e":Ue(t,5,EL(r,n,e.v,e.t));return;case"s":case"str":Ue(t,4,wL(r,n,(e.v||"").slice(0,255)));return}Ue(t,1,k0(null,r,n))}function SL(t,e,r,n){var i=Array.isArray(e),s=Ot(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=vt(s)}for(var c=s.s.r;c<=s.e.r;++c){o=Hr(c);for(var d=s.s.c;d<=s.e.c;++d){c===s.s.r&&(l[d]=Ar(d)),a=l[d]+o;var h=i?(e[c]||[])[d]:e[a];h&&TL(t,h,c,d)}}}function AL(t,e){for(var r=e||{},n=Ii(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ue(n,r.biff==4?1033:r.biff==3?521:9,K1(t,16,r)),SL(n,t.Sheets[t.SheetNames[i]],i,r),Ue(n,10),n.end()}function kL(t,e,r){Ue(t,49,y3({sz:12,name:"Arial"},r))}function CL(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Ue(t,1054,A3(i,e[i],r))})}function FL(t,e){var r=ge(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ue(t,2151,r),r=ge(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),yA(Ot(e["!ref"]||"A1"),r),r.write_shift(4,4),Ue(t,2152,r)}function IL(t,e){for(var r=0;r<16;++r)Ue(t,224,l2({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Ue(t,224,l2(n,0,e))})}function bL(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Ue(t,440,Z3(n)),n[1].Tooltip&&Ue(t,2048,tD(n))}delete e["!links"]}function RL(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&Ue(t,125,oD(Op(i,n),i))})}}function NL(t,e,r,n,i){var s=16+qo(i.cellXfs,e,i);if(e.v==null&&!e.bf){Ue(t,513,Dl(r,n,s));return}if(e.bf)Ue(t,6,i5(e,r,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?un(hr(e.v)):e.v;Ue(t,515,L3(r,n,a,s));break;case"b":case"e":Ue(t,517,O3(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=tv(i.Strings,e.v,i.revStrings);Ue(t,253,E3(r,n,o,s))}else Ue(t,516,T3(r,n,(e.v||"").slice(0,255),s,i));break;default:Ue(t,513,Dl(r,n,s))}}function DL(t,e,r){var n=Ii(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},l=Array.isArray(s),c=e.biff==8,d,h="",p=[],g=Ot(s["!ref"]||"A1"),y=c?65536:16384;if(g.e.c>255||g.e.r>=y){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,y-1)}Ue(n,2057,K1(r,16,e)),Ue(n,13,ns(1)),Ue(n,12,ns(100)),Ue(n,15,fi(!0)),Ue(n,17,fi(!1)),Ue(n,16,Rl(.001)),Ue(n,95,fi(!0)),Ue(n,42,fi(!1)),Ue(n,43,fi(!1)),Ue(n,130,ns(1)),Ue(n,128,P3()),Ue(n,131,fi(!1)),Ue(n,132,fi(!1)),c&&RL(n,s["!cols"]),Ue(n,512,C3(g,e)),c&&(s["!links"]=[]);for(var x=g.s.r;x<=g.e.r;++x){h=Hr(x);for(var E=g.s.c;E<=g.e.c;++E){x===g.s.r&&(p[E]=Ar(E)),d=p[E]+h;var T=l?(s[x]||[])[E]:s[d];T&&(NL(n,T,x,E,e),c&&T.l&&s["!links"].push([d,T.l]))}}var A=o.CodeName||o.name||i;return c&&Ue(n,574,g3((a.Views||[])[0])),c&&(s["!merges"]||[]).length&&Ue(n,229,K3(s["!merges"])),c&&bL(n,s),Ue(n,442,mA(A)),c&&FL(n,s),Ue(n,10),n.end()}function PL(t,e,r){var n=Ii(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(Ue(n,2057,K1(t,5,r)),r.bookType=="xla"&&Ue(n,135),Ue(n,225,o?ns(1200):null),Ue(n,193,ON(2)),l&&Ue(n,191),l&&Ue(n,192),Ue(n,226),Ue(n,92,n3("SheetJS",r)),Ue(n,66,ns(o?1200:1252)),o&&Ue(n,353,ns(0)),o&&Ue(n,448),Ue(n,317,uD(t.SheetNames.length)),o&&t.vbaraw&&Ue(n,211),o&&t.vbaraw){var c=a.CodeName||"ThisWorkbook";Ue(n,442,mA(c))}Ue(n,156,ns(17)),Ue(n,25,fi(!1)),Ue(n,18,fi(!1)),Ue(n,19,ns(0)),o&&Ue(n,431,fi(!1)),o&&Ue(n,444,ns(0)),Ue(n,61,p3()),Ue(n,64,fi(!1)),Ue(n,141,ns(0)),Ue(n,34,fi(dM(t)=="true")),Ue(n,14,fi(!0)),o&&Ue(n,439,fi(!1)),Ue(n,218,ns(0)),kL(n,t,r),CL(n,t.SSF,r),IL(n,r),o&&Ue(n,352,fi(!1));var d=n.end(),h=Ii();o&&Ue(h,140,nD()),o&&r.Strings&&_L(h,252,l3(r.Strings)),Ue(h,10);var p=h.end(),g=Ii(),y=0,x=0;for(x=0;x<t.SheetNames.length;++x)y+=(o?12:11)+(o?2:1)*t.SheetNames[x].length;var E=d.length+y+p.length;for(x=0;x<t.SheetNames.length;++x){var T=s[x]||{};Ue(g,133,a3({pos:E,hs:T.Hidden||0,dt:0,name:t.SheetNames[x]},r)),E+=e[x].length}var A=g.end();if(y!=A.length)throw new Error("BS8 "+y+" != "+A.length);var _=[];return d.length&&_.push(d),A.length&&_.push(A),p.length&&_.push(p),vn(_)}function OL(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=pr(at)),t&&t.SSF&&(mu(),Fp(t.SSF),r.revssf=bp(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,av(r),r.cellXfs=[],qo(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=DL(i,r,t);return n.unshift(PL(t,n,r)),vn(n)}function lk(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=bi(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return OL(t,e);case 4:case 3:case 2:return AL(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function T2(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),a=i.index,o=s&&s.index||t.length,l=yR(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,d=0,h=0,p=0,g={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(a=0;a<l.length;++a){var x=l[a].trim(),E=x.slice(0,3).toLowerCase();if(E=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}d=0;continue}if(!(E!="<td"&&E!="<th")){var T=x.split(/<\/t[dh]>/i);for(o=0;o<T.length;++o){var A=T[o].trim();if(A.match(/<t[dh]/i)){for(var _=A,P=0;_.charAt(0)=="<"&&(P=_.indexOf(">"))>-1;)_=_.slice(P+1);for(var W=0;W<y.length;++W){var j=y[W];j.s.c==d&&j.s.r<c&&c<=j.e.r&&(d=j.e.c+1,W=-1)}var w=ct(A.slice(0,A.indexOf(">")));p=w.colspan?+w.colspan:1,((h=+w.rowspan)>1||p>1)&&y.push({s:{r:c,c:d},e:{r:c+(h||1)-1,c:d+p-1}});var F=w.t||w["data-t"]||"";if(!_.length){d+=p;continue}if(_=NS(_),g.s.r>c&&(g.s.r=c),g.e.r<c&&(g.e.r=c),g.s.c>d&&(g.s.c=d),g.e.c<d&&(g.e.c=d),!_.length){d+=p;continue}var S={t:"s",v:_};r.raw||!_.trim().length||F=="s"||(_==="TRUE"?S={t:"b",v:!0}:_==="FALSE"?S={t:"b",v:!1}:isNaN(Ds(_))?isNaN(Zc(_).getDate())||(S={t:"d",v:hr(_)},r.cellDates||(S={t:"n",v:un(S.v)}),S.z=r.dateNF||at[14]):S={t:"n",v:Ds(_)}),r.dense?(n[c]||(n[c]=[]),n[c][d]=S):n[ot({r:c,c:d})]=S,d+=p}}}}return n["!ref"]=vt(g),y.length&&(n["!merges"]=y),n}function ML(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>a)&&!(i[c].e.r<r||i[c].e.c<a)){if(i[c].s.r<r||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var d=ot({r,c:a}),h=n.dense?(t[r]||[])[a]:t[d],p=h&&h.v!=null&&(h.h||P1(h.w||(ja(h),h.w)||""))||"",g={};o>1&&(g.rowspan=o),l>1&&(g.colspan=l),n.editable?p='<span contenteditable="true">'+p+"</span>":h&&(g["data-t"]=h&&h.t||"z",h.v!=null&&(g["data-v"]=h.v),h.z!=null&&(g["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+h.l.Target+'">'+p+"</a>")),g.id=(n.id||"sjs")+"-"+d,s.push(Be("td",p,g))}}var y="<tr>";return y+s.join("")+"</tr>"}var LL='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',BL="</body></html>";function jL(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Yo(T2(r[0],e),e);var n=cv();return r.forEach(function(i,s){uv(n,T2(i,e),"Sheet"+(s+1))}),n}function VL(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function ck(t,e){var r=e||{},n=r.header!=null?r.header:LL,i=r.footer!=null?r.footer:BL,s=[n],a=bi(t["!ref"]);r.dense=Array.isArray(t),s.push(VL(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(ML(t,a,o,r));return s.push("</table>"+i),s.join("")}function uk(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?kr(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var d=bi(t["!ref"]);c.s.r=Math.min(c.s.r,d.s.r),c.s.c=Math.min(c.s.c,d.s.c),c.e.r=Math.max(c.e.r,d.e.r),c.e.c=Math.max(c.e.c,d.e.c),i==-1&&(c.e.r=i=d.e.r+1)}var h=[],p=0,g=t["!rows"]||(t["!rows"]=[]),y=0,x=0,E=0,T=0,A=0,_=0;for(t["!cols"]||(t["!cols"]=[]);y<o.length&&x<l;++y){var P=o[y];if(S2(P)){if(n.display)continue;g[x]={hidden:!0}}var W=P.children;for(E=T=0;E<W.length;++E){var j=W[E];if(!(n.display&&S2(j))){var w=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):NS(j.innerHTML),F=j.getAttribute("data-z")||j.getAttribute("z");for(p=0;p<h.length;++p){var S=h[p];S.s.c==T+s&&S.s.r<x+i&&x+i<=S.e.r&&(T=S.e.c+1-s,p=-1)}_=+j.getAttribute("colspan")||1,((A=+j.getAttribute("rowspan")||1)>1||_>1)&&h.push({s:{r:x+i,c:T+s},e:{r:x+i+(A||1)-1,c:T+s+(_||1)-1}});var b={t:"s",v:w},N=j.getAttribute("data-t")||j.getAttribute("t")||"";w!=null&&(w.length==0?b.t=N||"z":n.raw||w.trim().length==0||N=="s"||(w==="TRUE"?b={t:"b",v:!0}:w==="FALSE"?b={t:"b",v:!1}:isNaN(Ds(w))?isNaN(Zc(w).getDate())||(b={t:"d",v:hr(w)},n.cellDates||(b={t:"n",v:un(b.v)}),b.z=n.dateNF||at[14]):b={t:"n",v:Ds(w)})),b.z===void 0&&F!=null&&(b.z=F);var D="",R=j.getElementsByTagName("A");if(R&&R.length)for(var He=0;He<R.length&&!(R[He].hasAttribute("href")&&(D=R[He].getAttribute("href"),D.charAt(0)!="#"));++He);D&&D.charAt(0)!="#"&&(b.l={Target:D}),n.dense?(t[x+i]||(t[x+i]=[]),t[x+i][T+s]=b):t[ot({c:T+s,r:x+i})]=b,c.e.c<T+s&&(c.e.c=T+s),T+=_}}++x}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,x-1+i),t["!ref"]=vt(c),x>=l&&(t["!fullref"]=vt((c.e.r=o.length-y+x-1+i,c))),t}function fk(t,e){var r=e||{},n=r.dense?[]:{};return uk(n,t,e)}function UL(t,e){return Yo(fk(t,e),e)}function S2(t){var e="",r=zL(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function zL(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function WL(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Pt(e.replace(/<[^>]*>/g,""));return[r]}var A2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function dk(t,e){var r=e||{},n=O1(t),i=[],s,a,o={name:""},l="",c=0,d,h,p={},g=[],y=r.dense?[]:{},x,E,T={value:""},A="",_=0,P=[],W=-1,j=-1,w={s:{r:1e6,c:1e7},e:{r:0,c:0}},F=0,S={},b=[],N={},D=0,R=0,He=[],xe=1,be=1,Ae=[],Ee={Names:[]},Z={},Ce=["",""],Le=[],U={},G="",J=0,q=!1,he=!1,Se=0;for(Yf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=Yf.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(w.e.c>=w.s.c&&w.e.r>=w.s.r?y["!ref"]=vt(w):y["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=w.e.r&&(y["!fullref"]=y["!ref"],w.e.r=r.sheetRows-1,y["!ref"]=vt(w)),b.length&&(y["!merges"]=b),He.length&&(y["!rows"]=He),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),g.push(d.name),p[d.name]=y,he=!1):x[0].charAt(x[0].length-2)!=="/"&&(d=ct(x[0],!1),W=j=-1,w.s.r=w.s.c=1e7,w.e.r=w.e.c=0,y=r.dense?[]:{},b=[],He=[],he=!0);break;case"table-row-group":x[1]==="/"?--F:++F;break;case"table-row":case"":if(x[1]==="/"){W+=xe,xe=1;break}if(h=ct(x[0],!1),h.?W=h.-1:W==-1&&(W=0),xe=+h["number-rows-repeated"]||1,xe<10)for(Se=0;Se<xe;++Se)F>0&&(He[W+Se]={level:F});j=-1;break;case"covered-table-cell":x[1]!=="/"&&++j,r.sheetStubs&&(r.dense?(y[W]||(y[W]=[]),y[W][j]={t:"z"}):y[ot({r:W,c:j})]={t:"z"}),A="",P=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++j,T=ct(x[0],!1),be=parseInt(T["number-columns-repeated"]||"1",10),E={t:"z",v:null},T.formula&&r.cellFormula!=!1&&(E.f=_2(Pt(T.formula))),(T.||T["value-type"])=="string"&&(E.t="s",E.v=Pt(T["string-value"]||""),r.dense?(y[W]||(y[W]=[]),y[W][j]=E):y[ot({r:W,c:j})]=E),j+=be-1;else if(x[1]!=="/"){++j,A="",_=0,P=[],be=1;var Ne=xe?W+xe-1:W;if(j>w.e.c&&(w.e.c=j),j<w.s.c&&(w.s.c=j),W<w.s.r&&(w.s.r=W),Ne>w.e.r&&(w.e.r=Ne),T=ct(x[0],!1),Le=[],U={},E={t:T.||T["value-type"],v:null},r.cellFormula)if(T.formula&&(T.formula=Pt(T.formula)),T["number-matrix-columns-spanned"]&&T["number-matrix-rows-spanned"]&&(D=parseInt(T["number-matrix-rows-spanned"],10)||0,R=parseInt(T["number-matrix-columns-spanned"],10)||0,N={s:{r:W,c:j},e:{r:W+D-1,c:j+R-1}},E.F=vt(N),Ae.push([N,E.F])),T.formula)E.f=_2(T.formula);else for(Se=0;Se<Ae.length;++Se)W>=Ae[Se][0].s.r&&W<=Ae[Se][0].e.r&&j>=Ae[Se][0].s.c&&j<=Ae[Se][0].e.c&&(E.F=Ae[Se][1]);switch((T["number-columns-spanned"]||T["number-rows-spanned"])&&(D=parseInt(T["number-rows-spanned"],10)||0,R=parseInt(T["number-columns-spanned"],10)||0,N={s:{r:W,c:j},e:{r:W+D-1,c:j+R-1}},b.push(N)),T["number-columns-repeated"]&&(be=parseInt(T["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=fr(T["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(T.value);break;case"percentage":E.t="n",E.v=parseFloat(T.value);break;case"currency":E.t="n",E.v=parseFloat(T.value);break;case"date":E.t="d",E.v=hr(T["date-value"]),r.cellDates||(E.t="n",E.v=un(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=gR(T["time-value"])/86400,r.cellDates&&(E.t="d",E.v=Rp(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(T.);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",T["string-value"]!=null&&(A=Pt(T["string-value"]),P=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(q=!1,E.t==="s"&&(E.v=A||"",P.length&&(E.R=P),q=_==0),Z.Target&&(E.l=Z),Le.length>0&&(E.c=Le,Le=[]),A&&r.cellText!==!1&&(E.w=A),q&&(E.t="z",delete E.v),(!q||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=W))for(var ke=0;ke<xe;++ke){if(be=parseInt(T["number-columns-repeated"]||"1",10),r.dense)for(y[W+ke]||(y[W+ke]=[]),y[W+ke][j]=ke==0?E:pr(E);--be>0;)y[W+ke][j+be]=pr(E);else for(y[ot({r:W+ke,c:j})]=E;--be>0;)y[ot({r:W+ke,c:j+be})]=pr(E);w.e.c<=j&&(w.e.c=j)}be=parseInt(T["number-columns-repeated"]||"1",10),j+=be-1,be=0,E={},A="",P=[]}Z={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s;U.t=A,P.length&&(U.R=P),U.a=G,Le.push(U)}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);G="",J=0,A="",_=0,P=[];break;case"creator":x[1]==="/"?G=n.slice(J,x.index):J=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);A="",_=0,P=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(S[o.name]=l,(s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&(l="",o=ct(x[0],!1),i.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=ct(x[0],!1),l+=A2[x[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=ct(x[0],!1),l+=A2[x[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,x.index);break}else c=x.index+x[0].length;break;case"named-range":a=ct(x[0],!1),Ce=Nm(a["cell-range-address"]);var Te={Name:a.name,Ref:Ce[0]+"!"+Ce[1]};he&&(Te.Sheet=g.length),Ee.Names.push(Te);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(x[1]==="/"&&(!T||!T["string-value"])){var nt=WL(n.slice(_,x.index));A=(A.length>0?A+`
`:"")+nt[0]}else ct(x[0],!1),_=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{Ce=Nm(ct(x[0])["target-range-address"]),p[Ce[0]]["!autofilter"]={ref:Ce[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(Z=ct(x[0],!1),!Z.href)break;Z.Target=Pt(Z.href),delete Z.href,Z.Target.charAt(0)=="#"&&Z.Target.indexOf(".")>-1?(Ce=Nm(Z.Target.slice(1)),Z.Target="#"+Ce[0]+"!"+Ce[1]):Z.Target.match(/^\.\.[\\\/]/)&&(Z.Target=Z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var K={Sheets:p,SheetNames:g,Workbook:Ee};return r.bookSheets&&delete K.Sheets,K}function k2(t,e){e=e||{},rs(t,"META-INF/manifest.xml")&&gN(Jr(t,"META-INF/manifest.xml"),e);var r=ji(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=dk(Jt(r),e);return rs(t,"meta.xml")&&(n.Props=rA(Jr(t,"meta.xml"))),n}function C2(t,e){return dk(t,e)}var HL=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Xf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return $r+e}}(),F2=function(){var t=function(s){return Gt(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+Gt(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,d=0,h=bi(s["!ref"]||"A1"),p=s["!merges"]||[],g=0,y=Array.isArray(s);if(s["!cols"])for(d=0;d<=h.e.c;++d)l.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var x="",E=s["!rows"]||[];for(c=0;c<h.s.r;++c)x=E[c]?' table:style-name="ro'+E[c].ods+'"':"",l.push("        <table:table-row"+x+`></table:table-row>
`);for(;c<=h.e.r;++c){for(x=E[c]?' table:style-name="ro'+E[c].ods+'"':"",l.push("        <table:table-row"+x+`>
`),d=0;d<h.s.c;++d)l.push(e);for(;d<=h.e.c;++d){var T=!1,A={},_="";for(g=0;g!=p.length;++g)if(!(p[g].s.c>d)&&!(p[g].s.r>c)&&!(p[g].e.c<d)&&!(p[g].e.r<c)){(p[g].s.c!=d||p[g].s.r!=c)&&(T=!0),A["table:number-columns-spanned"]=p[g].e.c-p[g].s.c+1,A["table:number-rows-spanned"]=p[g].e.r-p[g].s.r+1;break}if(T){l.push(r);continue}var P=ot({r:c,c:d}),W=y?(s[c]||[])[d]:s[P];if(W&&W.f&&(A["table:formula"]=Gt(u5(W.f)),W.F&&W.F.slice(0,P.length)==P)){var j=bi(W.F);A["table:number-matrix-columns-spanned"]=j.e.c-j.s.c+1,A["table:number-matrix-rows-spanned"]=j.e.r-j.s.r+1}if(!W){l.push(e);continue}switch(W.t){case"b":_=W.v?"TRUE":"FALSE",A["office:value-type"]="boolean",A["office:boolean-value"]=W.v?"true":"false";break;case"n":_=W.w||String(W.v||0),A["office:value-type"]="float",A["office:value"]=W.v||0;break;case"s":case"str":_=W.v==null?"":W.v,A["office:value-type"]="string";break;case"d":_=W.w||hr(W.v).toISOString(),A["office:value-type"]="date",A["office:date-value"]=hr(W.v).toISOString(),A["table:style-name"]="ce1";break;default:l.push(e);continue}var w=t(_);if(W.l&&W.l.Target){var F=W.l.Target;F=F.charAt(0)=="#"?"#"+f5(F.slice(1)):F,F.charAt(0)!="#"&&!F.match(/^\w+:/)&&(F="../"+F),w=Be("text:a",w,{"xlink:href":F.replace(/&/g,"&amp;")})}l.push("          "+Be("table:table-cell",Be("text:p",w,{}),A)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var d=0;d<c["!cols"].length;++d)if(c["!cols"][d]){var h=c["!cols"][d];if(h.width==null&&h.wpx==null&&h.wch==null)continue;jo(h),h.ods=o;var p=c["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var d=0;d<c["!rows"].length;++d)if(c["!rows"][d]){c["!rows"][d].ods=l;var h=c["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[$r],c=Xf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Xf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+d+`>
`),l.push(tA().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=a.SheetNames.length;++h)l.push(n(a.Sheets[a.SheetNames[h]],a,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function hk(t,e){if(e.bookType=="fods")return F2(t,e);var r=R1(),n="",i=[],s=[];return n="mimetype",_t(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",_t(r,n,F2(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",_t(r,n,HL(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",_t(r,n,$r+tA()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",_t(r,n,yN(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",_t(r,n,xN(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Pl(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function ax(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Jt(Xo(t))}function $L(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Bi(Js(t))}function GL(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Uo(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function I2(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function KL(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function XL(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function r0(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Ht(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function jr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Lt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=r0(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=r0(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function An(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(Ht(n*8+i.type)),i.type==2&&e.push(Ht(i.data.length)),e.push(i.data))})}),Uo(e)}function iv(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function es(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=r0(t,n),s=Lt(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:jr(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=Lt(o.data),c=jr(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=s[3])!=null&&e[0]&&(a.merge=jr(s[3][0].data)>>>0>0),r.push(a)}return r}function fc(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:Ht(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Ht(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Ht(a.data.length)}],n[2].push({data:An(a.meta),type:2})});var s=An(n);e.push(Ht(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),Uo(e)}function YL(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=r0(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Uo(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var d=Uo(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function ts(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(YL(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Uo(e)}function dc(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=Ht(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return Uo(e)}function qL(t,e,r,n){var i=Pl(t),s=i.getUint32(4,!0),a=(n>1?12:8)+I2(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,d=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=I2(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(a,!0),a+=4),s&32&&(c=i.getFloat64(a,!0),a+=8),s&64&&(d.setTime(d.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function QL(t,e,r){var n=Pl(t),i=n.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,c=NaN,d=new Date(2001,0,1);i&1&&(l=KL(t,s),s+=16),i&2&&(c=n.getFloat64(s,!0),s+=8),i&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return h}function Pm(t,e){var r=new Uint8Array(32),n=Pl(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,XL(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function Om(t,e){var r=new Uint8Array(32),n=Pl(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function JL(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return qL(t,e,r,t[0]);case 5:return QL(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Hn(t){var e=Lt(t);return r0(e[1][0].data)}function b2(t,e){var r=Lt(e.data),n=jr(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=Lt(a.data),l=jr(o[1][0].data)>>>0;switch(n){case 1:s[l]=ax(o[3][0].data);break;case 8:{var c=t[Hn(o[9][0].data)][0],d=Lt(c.data),h=t[Hn(d[1][0].data)][0],p=jr(h.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var g=Lt(h.data);s[l]=g[3].map(function(y){return ax(y.data)}).join("")}break}}),s}function ZL(t,e){var r,n,i,s,a,o,l,c,d,h,p,g,y,x,E=Lt(t),T=jr(E[1][0].data)>>>0,A=jr(E[2][0].data)>>>0,_=((n=(r=E[8])==null?void 0:r[0])==null?void 0:n.data)&&jr(E[8][0].data)>0||!1,P,W;if((s=(i=E[7])==null?void 0:i[0])!=null&&s.data&&e!=0)P=(o=(a=E[7])==null?void 0:a[0])==null?void 0:o.data,W=(c=(l=E[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(d=E[4])==null?void 0:d[0])!=null&&h.data&&e!=1)P=(g=(p=E[4])==null?void 0:p[0])==null?void 0:g.data,W=(x=(y=E[3])==null?void 0:y[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var j=_?4:1,w=Pl(P),F=[],S=0;S<P.length/2;++S){var b=w.getUint16(S*2,!0);b<65535&&F.push([S,b])}if(F.length!=A)throw"Expected ".concat(A," cells, found ").concat(F.length);var N=[];for(S=0;S<F.length-1;++S)N[F[S][0]]=W.subarray(F[S][1]*j,F[S+1][1]*j);return F.length>=1&&(N[F[F.length-1][0]]=W.subarray(F[F.length-1][1]*j)),{R:T,cells:N}}function eB(t,e){var r,n=Lt(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?jr(n[7][0].data)>>>0>0?1:0:-1,s=iv(n[5],function(a){return ZL(a,i)});return{nrows:jr(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,c){if(a[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));a[o.R][c]=l}),a},[])}}function tB(t,e,r){var n,i=Lt(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(jr(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(jr(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=vt(s);var a=Lt(i[4][0].data),o=b2(t,t[Hn(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?b2(t,t[Hn(a[17][0].data)][0]):[],c=Lt(a[3][0].data),d=0;c[1].forEach(function(h){var p=Lt(h.data),g=t[Hn(p[2][0].data)][0],y=jr(g.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var x=eB(t,g);x.data.forEach(function(E,T){E.forEach(function(A,_){var P=ot({r:d+T,c:_}),W=JL(A,o,l);W&&(r[P]=W)})}),d+=x.nrows})}function rB(t,e){var r=Lt(e.data),n={"!ref":"A1"},i=t[Hn(r[2][0].data)],s=jr(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return tB(t,i[0],n),n}function nB(t,e){var r,n=Lt(e.data),i={name:(r=n[1])!=null&&r[0]?ax(n[1][0].data):"",sheets:[]},s=iv(n[2],Hn);return s.forEach(function(a){t[a].forEach(function(o){var l=jr(o.meta[1][0].data);l==6e3&&i.sheets.push(rB(t,o))})}),i}function iB(t,e){var r=cv(),n=Lt(e.data),i=iv(n[1],Hn);if(i.forEach(function(s){t[s].forEach(function(a){var o=jr(a.meta[1][0].data);if(o==2){var l=nB(t,a);l.sheets.forEach(function(c,d){uv(r,c,d==0?l.name:l.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Mm(t){var e,r,n,i,s={},a=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=ts(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var d;try{d=es(c)}catch(h){return console.log("## "+(h.message||h))}d.forEach(function(h){s[h.id]=h.messages,a.push(h.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&jr(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(c){var d=jr(c.meta[1][0].data)>>>0;if(d==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return iB(s,o)}function sB(t,e,r){var n,i,s,a;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=t[8])==null?void 0:s[0])==null?void 0:a.data)&&jr(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=Pl(t[7][0].data),d=0,h=[],p=Pl(t[4][0].data),g=0,y=[],x=0;x<e.length;++x){if(e[x]==null){c.setUint16(x*2,65535,!0),p.setUint16(x*2,65535);continue}c.setUint16(x*2,d,!0),p.setUint16(x*2,g,!0);var E,T;switch(typeof e[x]){case"string":E=Pm({t:"s",v:e[x]},r),T=Om({t:"s",v:e[x]},r);break;case"number":E=Pm({t:"n",v:e[x]},r),T=Om({t:"n",v:e[x]},r);break;case"boolean":E=Pm({t:"b",v:e[x]},r),T=Om({t:"b",v:e[x]},r);break;default:throw new Error("Unsupported value "+e[x])}h.push(E),d+=E.length,y.push(T),g+=T.length,++l}for(t[2][0].data=Ht(l);x<t[7][0].data.length/2;++x)c.setUint16(x*2,65535,!0),p.setUint16(x*2,65535,!0);return t[6][0].data=Uo(h),t[3][0].data=Uo(y),l}function aB(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=bi(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(vt(n)));var s=Kh(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(G){return G.forEach(function(J){typeof J=="string"&&a.push(J)})});var o={},l=[],c=Ze.read(e.numbers,{type:"base64"});c.FileIndex.map(function(G,J){return[G,c.FullPaths[J]]}).forEach(function(G){var J=G[0],q=G[1];if(J.type==2&&J.name.match(/\.iwa/)){var he=J.content,Se=ts(he),Ne=es(Se);Ne.forEach(function(ke){l.push(ke.id),o[ke.id]={deps:[],location:q,type:jr(ke.messages[0].meta[1][0].data)}})}}),l.sort(function(G,J){return G-J});var d=l.filter(function(G){return G>1}).map(function(G){return[G,Ht(G)]});c.FileIndex.map(function(G,J){return[G,c.FullPaths[J]]}).forEach(function(G){var J=G[0];if(G[1],!!J.name.match(/\.iwa/)){var q=es(ts(J.content));q.forEach(function(he){he.messages.forEach(function(Se){d.forEach(function(Ne){he.messages.some(function(ke){return jr(ke.meta[1][0].data)!=11006&&GL(ke.data,Ne[1])})&&o[Ne[0]].deps.push(he.id)})})})}});for(var h=Ze.find(c,o[1].location),p=es(ts(h.content)),g,y=0;y<p.length;++y){var x=p[y];x.id==1&&(g=x)}var E=Hn(Lt(g.messages[0].data)[1][0].data);for(h=Ze.find(c,o[E].location),p=es(ts(h.content)),y=0;y<p.length;++y)x=p[y],x.id==E&&(g=x);for(E=Hn(Lt(g.messages[0].data)[2][0].data),h=Ze.find(c,o[E].location),p=es(ts(h.content)),y=0;y<p.length;++y)x=p[y],x.id==E&&(g=x);for(E=Hn(Lt(g.messages[0].data)[2][0].data),h=Ze.find(c,o[E].location),p=es(ts(h.content)),y=0;y<p.length;++y)x=p[y],x.id==E&&(g=x);var T=Lt(g.messages[0].data);{T[6][0].data=Ht(n.e.r+1),T[7][0].data=Ht(n.e.c+1);var A=Hn(T[46][0].data),_=Ze.find(c,o[A].location),P=es(ts(_.content));{for(var W=0;W<P.length&&P[W].id!=A;++W);if(P[W].id!=A)throw"Bad ColumnRowUIDMapArchive";var j=Lt(P[W].messages[0].data);j[1]=[],j[2]=[],j[3]=[];for(var w=0;w<=n.e.c;++w){var F=[];F[1]=F[2]=[{type:0,data:Ht(w+420690)}],j[1].push({type:2,data:An(F)}),j[2].push({type:0,data:Ht(w)}),j[3].push({type:0,data:Ht(w)})}j[4]=[],j[5]=[],j[6]=[];for(var S=0;S<=n.e.r;++S)F=[],F[1]=F[2]=[{type:0,data:Ht(S+726270)}],j[4].push({type:2,data:An(F)}),j[5].push({type:0,data:Ht(S)}),j[6].push({type:0,data:Ht(S)});P[W].messages[0].data=An(j)}_.content=dc(fc(P)),_.size=_.content.length,delete T[46];var b=Lt(T[4][0].data);{b[7][0].data=Ht(n.e.r+1);var N=Lt(b[1][0].data),D=Hn(N[2][0].data);_=Ze.find(c,o[D].location),P=es(ts(_.content));{if(P[0].id!=D)throw"Bad HeaderStorageBucket";var R=Lt(P[0].messages[0].data);for(S=0;S<s.length;++S){var He=Lt(R[2][0].data);He[1][0].data=Ht(S),He[4][0].data=Ht(s[S].length),R[2][S]={type:R[2][0].type,data:An(He)}}P[0].messages[0].data=An(R)}_.content=dc(fc(P)),_.size=_.content.length;var xe=Hn(b[2][0].data);_=Ze.find(c,o[xe].location),P=es(ts(_.content));{if(P[0].id!=xe)throw"Bad HeaderStorageBucket";for(R=Lt(P[0].messages[0].data),w=0;w<=n.e.c;++w)He=Lt(R[2][0].data),He[1][0].data=Ht(w),He[4][0].data=Ht(n.e.r+1),R[2][w]={type:R[2][0].type,data:An(He)};P[0].messages[0].data=An(R)}_.content=dc(fc(P)),_.size=_.content.length;var be=Hn(b[4][0].data);(function(){for(var G=Ze.find(c,o[be].location),J=es(ts(G.content)),q,he=0;he<J.length;++he){var Se=J[he];Se.id==be&&(q=Se)}var Ne=Lt(q.messages[0].data);{Ne[3]=[];var ke=[];a.forEach(function(K,Ct){ke[1]=[{type:0,data:Ht(Ct)}],ke[2]=[{type:0,data:Ht(1)}],ke[3]=[{type:2,data:$L(K)}],Ne[3].push({type:2,data:An(ke)})})}q.messages[0].data=An(Ne);var Te=fc(J),nt=dc(Te);G.content=nt,G.size=G.content.length})();var Ae=Lt(b[3][0].data);{var Ee=Ae[1][0];delete Ae[2];var Z=Lt(Ee.data);{var Ce=Hn(Z[2][0].data);(function(){for(var G=Ze.find(c,o[Ce].location),J=es(ts(G.content)),q,he=0;he<J.length;++he){var Se=J[he];Se.id==Ce&&(q=Se)}var Ne=Lt(q.messages[0].data);{delete Ne[6],delete Ae[7];var ke=new Uint8Array(Ne[5][0].data);Ne[5]=[];for(var Te=0,nt=0;nt<=n.e.r;++nt){var K=Lt(ke);Te+=sB(K,s[nt],a),K[1][0].data=Ht(nt),Ne[5].push({data:An(K),type:2})}Ne[1]=[{type:0,data:Ht(n.e.c+1)}],Ne[2]=[{type:0,data:Ht(n.e.r+1)}],Ne[3]=[{type:0,data:Ht(Te)}],Ne[4]=[{type:0,data:Ht(n.e.r+1)}]}q.messages[0].data=An(Ne);var Ct=fc(J),xt=dc(Ct);G.content=xt,G.size=G.content.length})()}Ee.data=An(Z)}b[3][0].data=An(Ae)}T[4][0].data=An(b)}g.messages[0].data=An(T);var Le=fc(p),U=dc(Le);return h.content=U,h.size=h.content.length,c}function pk(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function sv(t){pk([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function av(t){pk([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function oB(t){return wt.WS.indexOf(t)>-1?"sheet":t==wt.CS?"chart":t==wt.DS?"dialog":t==wt.MS?"macro":t&&t.length?t:"sheet"}function lB(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,oB(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function cB(t,e,r,n,i,s,a,o,l,c,d,h){try{s[n]=xf(ji(t,r,!0),e);var p=Jr(t,e),g;switch(o){case"sheet":g=RM(p,e,i,l,s[n],c,d,h);break;case"chart":if(g=NM(p,e,i,l,s[n],c,d,h),!g||!g["!drawel"])break;var y=Zu(g["!drawel"].Target,e),x=qf(y),E=v6(ji(t,y,!0),xf(ji(t,x,!0),y)),T=Zu(E,y),A=qf(T);g=sM(ji(t,T,!0),T,l,xf(ji(t,A,!0),T),c,g);break;case"macro":g=DM(p,e,i,l,s[n],c,d,h);break;case"dialog":g=PM(p,e,i,l,s[n],c,d,h);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=g;var _=[];s&&s[n]&&Vr(s[n]).forEach(function(P){var W="";if(s[n][P].Type==wt.CMNT){W=Zu(s[n][P].Target,e);var j=BM(Jr(t,W,!0),W,l);if(!j||!j.length)return;m2(g,j,!1)}s[n][P].Type==wt.TCMNT&&(W=Zu(s[n][P].Target,e),_=_.concat(_6(Jr(t,W,!0),l)))}),_&&_.length&&m2(g,_,!0,l.people||[])}catch(P){if(l.WTF)throw P}}function Ji(t){return t.charAt(0)=="/"?t.slice(1):t}function uB(t,e){if(mu(),e=e||{},sv(e),rs(t,"META-INF/manifest.xml")||rs(t,"objectdata.xml"))return k2(t,e);if(rs(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Mm<"u"){if(t.FileIndex)return Mm(t);var r=Ze.utils.cfb_new();return M_(t).forEach(function(He){_t(r,He,ER(t,He))}),Mm(r)}throw new Error("Unsupported NUMBERS file")}if(!rs(t,"[Content_Types].xml"))throw rs(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):rs(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=M_(t),i=pN(ji(t,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",Jr(t,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!Jr(t,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(vf=[],i.sst)try{vf=LM(Jr(t,Ji(i.sst)),i.sst,e)}catch(He){if(e.WTF)throw He}e.cellStyles&&i.themes.length&&(l=MM(ji(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(c=OM(Jr(t,Ji(i.style)),i.style,l,e))}i.links.map(function(He){try{var xe=xf(ji(t,qf(Ji(He))),He);return VM(Jr(t,Ji(He)),xe,He,e)}catch{}});var d=bM(Jr(t,Ji(i.workbooks[0])),i.workbooks[0],e),h={},p="";i.coreprops.length&&(p=Jr(t,Ji(i.coreprops[0]),!0),p&&(h=rA(p)),i.extprops.length!==0&&(p=Jr(t,Ji(i.extprops[0]),!0),p&&EN(p,h,e)));var g={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(p=ji(t,Ji(i.custprops[0]),!0),p&&(g=TN(p,e)));var y={};if((e.bookSheets||e.bookProps)&&(d.Sheets?a=d.Sheets.map(function(xe){return xe.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),e.bookProps&&(y.Props=h,y.Custprops=g),e.bookSheets&&typeof a<"u"&&(y.SheetNames=a),e.bookSheets?y.SheetNames:e.bookProps))return y;a={};var x={};e.bookDeps&&i.calcchain&&(x=jM(Jr(t,Ji(i.calcchain)),i.calcchain));var E=0,T={},A,_;{var P=d.Sheets;h.Worksheets=P.length,h.SheetNames=[];for(var W=0;W!=P.length;++W)h.SheetNames[W]=P[W].name}var j=s?"bin":"xml",w=i.workbooks[0].lastIndexOf("/"),F=(i.workbooks[0].slice(0,w+1)+"_rels/"+i.workbooks[0].slice(w+1)+".rels").replace(/^\//,"");rs(t,F)||(F="xl/_rels/workbook."+j+".rels");var S=xf(ji(t,F,!0),F.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=UM(Jr(t,Ji(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=w6(Jr(t,Ji(i.people[0])),e)),S&&(S=lB(S,d.Sheets));var b=Jr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=h.Worksheets;++E){var N="sheet";if(S&&S[E]?(A="xl/"+S[E][1].replace(/[\/]?xl\//,""),rs(t,A)||(A=S[E][1]),rs(t,A)||(A=F.replace(/_rels\/.*$/,"")+S[E][1]),N=S[E][2]):(A="xl/worksheets/sheet"+(E+1-b)+"."+j,A=A.replace(/sheet0\./,"sheet.")),_=A.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(E!=e.sheets)continue e;break;case"string":if(h.SheetNames[E].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var D=!1,R=0;R!=e.sheets.length;++R)typeof e.sheets[R]=="number"&&e.sheets[R]==E&&(D=1),typeof e.sheets[R]=="string"&&e.sheets[R].toLowerCase()==h.SheetNames[E].toLowerCase()&&(D=1);if(!D)continue e}}cB(t,A,_,h.SheetNames[E],E,T,a,N,e,d,l,c)}return y={Directory:i,Workbook:d,Props:h,Custprops:g,Deps:x,Sheets:a,SheetNames:h.SheetNames,Strings:vf,Styles:c,Themes:l,SSF:pr(at)},e&&e.bookFiles&&(t.files?(y.keys=n,y.files=t.files):(y.keys=[],y.files={},t.FullPaths.forEach(function(He,xe){He=He.replace(/^Root Entry[\/]/,""),y.keys.push(He),y.files[He]=t.FileIndex[xe]}))),e&&e.bookVBA&&(i.vba.length>0?y.vbaraw=Jr(t,Ji(i.vba[0]),!0):i.defaults&&i.defaults.bin===b6&&(y.vbaraw=Jr(t,"xl/vbaProject.bin",!0))),y}function fB(t,e){var r=e||{},n="Workbook",i=Ze.find(t,n);try{if(n="/!DataSpaces/Version",i=Ze.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(UD(i.content),n="/!DataSpaces/DataSpaceMap",i=Ze.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=WD(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Ze.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=HD(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Ze.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);GD(i.content)}catch{}if(n="/EncryptionInfo",i=Ze.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=KD(i.content);if(n="/EncryptedPackage",i=Ze.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function dB(t,e){return e.bookType=="ods"?hk(t,e):e.bookType=="numbers"?aB(t,e):e.bookType=="xlsb"?hB(t,e):pB(t,e)}function hB(t,e){Ic=1024,t&&!t.SSF&&(t.SSF=pr(at)),t&&t.SSF&&(mu(),Fp(t.SSF),e.revssf=bp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,yf?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=UA.indexOf(e.bookType)>-1,i=$1();av(e=e||{});var s=R1(),a="",o=0;if(e.cellXfs=[],qo(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",_t(s,a,nA(t.Props,e)),i.coreprops.push(a),$t(e.rels,2,a,wt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,_t(s,a,aA(t.Props)),i.extprops.push(a),$t(e.rels,3,a,wt.EXT_PROPS),t.Custprops!==t.Props&&Vr(t.Custprops||{}).length>0&&(a="docProps/custom.xml",_t(s,a,oA(t.Custprops)),i.custprops.push(a),$t(e.rels,4,a,wt.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var d={"!id":{}},h=t.Sheets[t.SheetNames[o-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,_t(s,a,WM(o-1,a,e,t,d)),i.sheets.push(a),$t(e.wbrels,-1,"worksheets/sheet"+o+"."+r,wt.WS[0])}if(h){var g=h["!comments"],y=!1,x="";g&&g.length>0&&(x="xl/comments"+o+"."+r,_t(s,x,GM(g,x)),i.comments.push(x),$t(d,-1,"../comments"+o+"."+r,wt.CMNT),y=!0),h["!legacy"]&&y&&_t(s,"xl/drawings/vmlDrawing"+o+".vml",jA(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&_t(s,qf(a),jc(d))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,_t(s,a,$M(e.Strings,a,e)),i.strs.push(a),$t(e.wbrels,-1,"sharedStrings."+r,wt.SST)),a="xl/workbook."+r,_t(s,a,zM(t,a)),i.workbooks.push(a),$t(e.rels,1,a,wt.WB),a="xl/theme/theme1.xml",_t(s,a,Q1(t.Themes,e)),i.themes.push(a),$t(e.wbrels,-1,"theme/theme1.xml",wt.THEME),a="xl/styles."+r,_t(s,a,HM(t,a,e)),i.styles.push(a),$t(e.wbrels,-1,"styles."+r,wt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",_t(s,a,t.vbaraw),i.vba.push(a),$t(e.wbrels,-1,"vbaProject.bin",wt.VBA)),a="xl/metadata."+r,_t(s,a,KM(a)),i.metadata.push(a),$t(e.wbrels,-1,"metadata."+r,wt.XLMETA),_t(s,"[Content_Types].xml",eA(i,e)),_t(s,"_rels/.rels",jc(e.rels)),_t(s,"xl/_rels/workbook."+r+".rels",jc(e.wbrels)),delete e.revssf,delete e.ssf,s}function pB(t,e){Ic=1024,t&&!t.SSF&&(t.SSF=pr(at)),t&&t.SSF&&(mu(),Fp(t.SSF),e.revssf=bp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,yf?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=UA.indexOf(e.bookType)>-1,i=$1();av(e=e||{});var s=R1(),a="",o=0;if(e.cellXfs=[],qo(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",_t(s,a,nA(t.Props,e)),i.coreprops.push(a),$t(e.rels,2,a,wt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,_t(s,a,aA(t.Props)),i.extprops.push(a),$t(e.rels,3,a,wt.EXT_PROPS),t.Custprops!==t.Props&&Vr(t.Custprops||{}).length>0&&(a="docProps/custom.xml",_t(s,a,oA(t.Custprops)),i.custprops.push(a),$t(e.rels,4,a,wt.CUST_PROPS));var d=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var h={"!id":{}},p=t.Sheets[t.SheetNames[o-1]],g=(p||{})["!type"]||"sheet";switch(g){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,_t(s,a,JA(o-1,e,t,h)),i.sheets.push(a),$t(e.wbrels,-1,"worksheets/sheet"+o+"."+r,wt.WS[0])}if(p){var y=p["!comments"],x=!1,E="";if(y&&y.length>0){var T=!1;y.forEach(function(A){A[1].forEach(function(_){_.T==!0&&(T=!0)})}),T&&(E="xl/threadedComments/threadedComment"+o+"."+r,_t(s,E,E6(y,d,e)),i.threadedcomments.push(E),$t(h,-1,"../threadedComments/threadedComment"+o+"."+r,wt.TCMNT)),E="xl/comments"+o+"."+r,_t(s,E,VA(y)),i.comments.push(E),$t(h,-1,"../comments"+o+"."+r,wt.CMNT),x=!0}p["!legacy"]&&x&&_t(s,"xl/drawings/vmlDrawing"+o+".vml",jA(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}h["!id"].rId1&&_t(s,qf(a),jc(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,_t(s,a,CA(e.Strings,e)),i.strs.push(a),$t(e.wbrels,-1,"sharedStrings."+r,wt.SST)),a="xl/workbook."+r,_t(s,a,nk(t)),i.workbooks.push(a),$t(e.rels,1,a,wt.WB),a="xl/theme/theme1.xml",_t(s,a,Q1(t.Themes,e)),i.themes.push(a),$t(e.wbrels,-1,"theme/theme1.xml",wt.THEME),a="xl/styles."+r,_t(s,a,OA(t,e)),i.styles.push(a),$t(e.wbrels,-1,"styles."+r,wt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",_t(s,a,t.vbaraw),i.vba.push(a),$t(e.wbrels,-1,"vbaProject.bin",wt.VBA)),a="xl/metadata."+r,_t(s,a,BA()),i.metadata.push(a),$t(e.wbrels,-1,"metadata."+r,wt.XLMETA),d.length>1&&(a="xl/persons/person.xml",_t(s,a,T6(d)),i.people.push(a),$t(e.wbrels,-1,"persons/person.xml",wt.PEOPLE)),_t(s,"[Content_Types].xml",eA(i,e)),_t(s,"_rels/.rels",jc(e.rels)),_t(s,"xl/_rels/workbook."+r+".rels",jc(e.wbrels)),delete e.revssf,delete e.ssf,s}function ov(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Hi(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function mB(t,e){return Ze.find(t,"EncryptedPackage")?fB(t,e):ok(t,e)}function gB(t,e){var r,n=t,i=e||{};return i.type||(i.type=Et&&Buffer.isBuffer(t)?"buffer":"base64"),r=IS(n,i),uB(r,i)}function mk(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return ix(t.slice(r),e);default:break e}return eu.to_workbook(t,e)}function xB(t,e){var r="",n=ov(t,e);switch(e.type){case"base64":r=Hi(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=bl(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Jt(r)),e.type="binary",mk(r,e)}function vB(t,e){var r=t;return e.type=="base64"&&(r=Hi(r)),r=Hf.utils.decode(1200,r.slice(2),"str"),e.type="binary",mk(r,e)}function yB(t){return t.match(/[^\x00-\x7F]/)?Js(t):t}function Lm(t,e,r,n){return n?(r.type="string",eu.to_workbook(t,r)):eu.to_workbook(e,r)}function bc(t,e){k1();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return bc(new Uint8Array(t),(r=pr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Uc={},r.dateNF&&(Uc.dateNF=r.dateNF),r.type||(r.type=Et&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Et?"buffer":"binary",n=hR(t),typeof Uint8Array<"u"&&!Et&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=yB(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=pr(r),r.type="array",bc(C1(n),r)}switch((i=ov(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return mB(Ze.read(n,r),r);break;case 9:if(i[1]<=8)return ok(n,r);break;case 60:return ix(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return SD(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return AA.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?gB(n,r):Lm(t,n,r,s);case 239:return i[3]===60?ix(n,r):Lm(t,n,r,s);case 255:if(i[1]===254)return vB(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return _l.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return _l.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return nx.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return NA.to_workbook(n,r);break;case 10:case 13:case 32:return xB(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return TD.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?nx.to_workbook(n,r):Lm(t,n,r,s)}function gk(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return y0(e.file,Ze.write(t,{type:Et?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Ze.write(t,e)}function _B(t,e){var r=pr(e||{}),n=dB(t,r);return EB(n,r)}function EB(t,e){var r={},n=Et?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?Ze.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Cp(i))}return e.password&&typeof encrypt_agile<"u"?gk(encrypt_agile(i,e.password),e):e.type==="file"?y0(e.file,i):e.type=="string"?Jt(i):i}function wB(t,e){var r=e||{},n=yL(t,r);return gk(n,r)}function Ys(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return $f(Js(n));case"binary":return Js(n);case"string":return t;case"file":return y0(e.file,n,"utf8");case"buffer":return Et?Ga(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ys(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function TB(t,e){switch(e.type){case"base64":return $f(t);case"binary":return t;case"string":return t;case"file":return y0(e.file,t,"binary");case"buffer":return Et?Ga(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Nd(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?$f(r):e.type=="string"?Jt(r):r;case"file":return y0(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function xk(t,e){k1(),mM(t);var r=pr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=xk(t,r);return r.type="array",Cp(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ys(dL(t,r),r);case"slk":case"sylk":return Ys(SA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return Ys(ck(t.Sheets[t.SheetNames[i]],r),r);case"txt":return TB(vk(t.Sheets[t.SheetNames[i]],r),r);case"csv":return Ys(lv(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return Ys(AA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return Nd(nx.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return Ys(eu.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return Ys(NA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return Ys(kA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return Ys(hk(t,r),r);case"wk1":return Nd(_l.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return Nd(_l.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Nd(lk(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),wB(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return _B(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function SB(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function Bm(t,e,r){var n={};return n.type="file",n.file=e,SB(n),xk(t,n)}function AB(t,e,r,n,i,s,a,o){var l=Hr(r),c=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,p=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!a||t[r])for(var g=e.s.c;g<=e.e.c;++g){var y=a?t[r][g]:t[n[g]+l];if(y===void 0||y.t===void 0){if(c===void 0)continue;s[g]!=null&&(p[s[g]]=c);continue}var x=y.v;switch(y.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(s[g]!=null){if(x==null)if(y.t=="e"&&x===null)p[s[g]]=null;else if(c!==void 0)p[s[g]]=c;else if(d&&x===null)p[s[g]]=null;else continue;else p[s[g]]=d&&(y.t!=="n"||y.t==="n"&&o.rawNumbers!==!1)?x:ja(y,x,o);x!=null&&(h=!1)}}return{row:p,isempty:h}}function Kh(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},d=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof d){case"string":l=Ot(d);break;case"number":l=Ot(t["!ref"]),l.s.r=d;break;default:l=d}n>0&&(i=0);var h=Hr(l.s.r),p=[],g=[],y=0,x=0,E=Array.isArray(t),T=l.s.r,A=0,_={};E&&!t[T]&&(t[T]=[]);var P=c.skipHidden&&t["!cols"]||[],W=c.skipHidden&&t["!rows"]||[];for(A=l.s.c;A<=l.e.c;++A)if(!(P[A]||{}).hidden)switch(p[A]=Ar(A),r=E?t[T][A]:t[p[A]+h],n){case 1:s[A]=A-l.s.c;break;case 2:s[A]=p[A];break;case 3:s[A]=c.header[A-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=ja(r,null,c),x=_[a]||0,!x)_[a]=1;else{do o=a+"_"+x++;while(_[o]);_[a]=x,_[o]=1}s[A]=o}for(T=l.s.r+i;T<=l.e.r;++T)if(!(W[T]||{}).hidden){var j=AB(t,l,T,p,n,s,E,c);(j.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(g[y++]=j.row)}return g.length=y,g}var R2=/"/g;function kB(t,e,r,n,i,s,a,o){for(var l=!0,c=[],d="",h=Hr(r),p=e.s.c;p<=e.e.c;++p)if(n[p]){var g=o.dense?(t[r]||[])[p]:t[n[p]+h];if(g==null)d="";else if(g.v!=null){l=!1,d=""+(o.rawNumbers&&g.t=="n"?g.v:ja(g,null,o));for(var y=0,x=0;y!==d.length;++y)if((x=d.charCodeAt(y))===i||x===s||x===34||o.forceQuotes){d='"'+d.replace(R2,'""')+'"';break}d=="ID"&&(d='"ID"')}else g.f!=null&&!g.F?(l=!1,d="="+g.f,d.indexOf(",")>=0&&(d='"'+d.replace(R2,'""')+'"')):d="";c.push(d)}return o.blankrows===!1&&l?null:c.join(a)}function lv(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=Ot(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),d="",h=[];n.dense=Array.isArray(t);for(var p=n.skipHidden&&t["!cols"]||[],g=n.skipHidden&&t["!rows"]||[],y=i.s.c;y<=i.e.c;++y)(p[y]||{}).hidden||(h[y]=Ar(y));for(var x=0,E=i.s.r;E<=i.e.r;++E)(g[E]||{}).hidden||(d=kB(t,i,E,h,a,l,s,n),d!=null&&(n.strip&&(d=d.replace(c,"")),(d||n.blankrows!==!1)&&r.push((x++?o:"")+d)));return delete n.dense,r.join("")}function vk(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=lv(t,e);return r}function CB(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=Ot(t["!ref"]),s="",a=[],o,l=[],c=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=Ar(o);for(var d=i.s.r;d<=i.e.r;++d)for(s=Hr(d),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=c?(t[d]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function yk(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?kr(n.origin):n.origin;a=l.r,o=l.c}var c,d={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var h=Ot(s["!ref"]);d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),a==-1&&(a=h.e.r+1,d.e.r=a+e.length-1+i)}else a==-1&&(a=0,d.e.r=e.length-1+i);var p=n.header||[],g=0;e.forEach(function(x,E){Vr(x).forEach(function(T){(g=p.indexOf(T))==-1&&(p[g=p.length]=T);var A=x[T],_="z",P="",W=ot({c:o+g,r:a+E+i});c=n0(s,W),A&&typeof A=="object"&&!(A instanceof Date)?s[W]=A:(typeof A=="number"?_="n":typeof A=="boolean"?_="b":typeof A=="string"?_="s":A instanceof Date?(_="d",n.cellDates||(_="n",A=un(A)),P=n.dateNF||at[14]):A===null&&n.nullError&&(_="e",A=0),c?(c.t=_,c.v=A,delete c.w,delete c.R,P&&(c.z=P)):s[W]=c={t:_,v:A},P&&(c.z=P))})}),d.e.c=Math.max(d.e.c,o+p.length-1);var y=Hr(a);if(i)for(g=0;g<p.length;++g)s[Ar(g+o)+y]={t:"s",v:p[g]};return s["!ref"]=vt(d),s}function FB(t,e){return yk(null,t,e)}function n0(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=kr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?n0(t,ot(e)):n0(t,ot({r:e,c:r||0}))}function IB(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function cv(){return{SheetNames:[],Sheets:{}}}function uv(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(rk(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function bB(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=IB(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function RB(t,e){return t.z=e,t}function _k(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function NB(t,e,r){return _k(t,"#"+e,r)}function DB(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function PB(t,e,r,n){for(var i=typeof e!="string"?e:Ot(e),s=typeof e=="string"?e:vt(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=n0(t,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var Pi={encode_col:Ar,encode_row:Hr,encode_cell:ot,encode_range:vt,decode_col:j1,decode_row:B1,split_cell:$R,decode_cell:kr,decode_range:bi,format_cell:ja,sheet_add_aoa:KS,sheet_add_json:yk,sheet_add_dom:uk,aoa_to_sheet:gu,json_to_sheet:FB,table_to_sheet:fk,table_to_book:UL,sheet_to_csv:lv,sheet_to_txt:vk,sheet_to_json:Kh,sheet_to_html:ck,sheet_to_formulae:CB,sheet_to_row_object_array:Kh,sheet_get_cell:n0,book_new:cv,book_append_sheet:uv,book_set_sheet_visibility:bB,cell_set_number_format:RB,cell_set_hyperlink:_k,cell_set_internal_link:NB,cell_add_comment:DB,sheet_set_array_formula:PB,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var OB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MB=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),St=(t,e)=>{const r=ye.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:l,...c},d)=>ye.createElement("svg",{ref:d,...OB,width:i,height:i,stroke:n,strokeWidth:a?Number(s)*24/Number(i):s,className:["lucide",`lucide-${MB(t)}`,o].join(" "),...c},[...e.map(([h,p])=>ye.createElement(h,p)),...Array.isArray(l)?l:[l]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N2=St("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D2=St("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LB=St("BellRing",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P2=St("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O2=St("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BB=St("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jB=St("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M2=St("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L2=St("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VB=St("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jm=St("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vm=St("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UB=St("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wu=St("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zB=St("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dd=St("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hu=St("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Um=St("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B2=St("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pd=St("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zm=St("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WB=St("Merge",[["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M12 2v10.3a4 4 0 0 1-1.172 2.872L4 22",key:"1hyw0i"}],["path",{d:"m20 22-5-5",key:"1m27yz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HB=St("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Od=St("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j2=St("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wm=St("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $u=St("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $B=St("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Md=St("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V2=St("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GB=St("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U2=St("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KB=St("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=St("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=St("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z2=St("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ll=St("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var W2={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ek=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},XB=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[r++],a=t[r++],o=t[r++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},wk={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,o=a?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,d=s>>2,h=(s&3)<<4|o>>4;let p=(o&15)<<2|c>>6,g=c&63;l||(g=64,a||(p=64)),n.push(r[d],r[h],r[p],r[g])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Ek(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):XB(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const c=i<t.length?r[t.charAt(i)]:64;++i;const h=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||c==null||h==null)throw new YB;const p=s<<2|o>>4;if(n.push(p),c!==64){const g=o<<4&240|c>>2;if(n.push(g),h!==64){const y=c<<6&192|h;n.push(y)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class YB extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const qB=function(t){const e=Ek(t);return wk.encodeByteArray(e,!0)},Xh=function(t){return qB(t).replace(/\./g,"")},Tk=function(t){try{return wk.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QB(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JB=()=>QB().__FIREBASE_DEFAULTS__,ZB=()=>{if(typeof process>"u"||typeof W2>"u")return;const t=W2.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},e9=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Tk(t[1]);return e&&JSON.parse(e)},Mp=()=>{try{return JB()||ZB()||e9()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Sk=t=>{var e,r;return(r=(e=Mp())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},t9=t=>{const e=Sk(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},Ak=()=>{var t;return(t=Mp())===null||t===void 0?void 0:t.config},kk=t=>{var e;return(e=Mp())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r9{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n9(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Xh(JSON.stringify(r)),Xh(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ei(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function i9(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ei())}function s9(){var t;const e=(t=Mp())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function a9(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function o9(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function l9(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function c9(){const t=ei();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function u9(){return!s9()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function f9(){try{return typeof indexedDB=="object"}catch{return!1}}function d9(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h9="FirebaseError";class Ya extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=h9,Object.setPrototypeOf(this,Ya.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,C0.prototype.create)}}class C0{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?p9(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new Ya(i,o,n)}}function p9(t,e){return t.replace(m9,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const m9=/\{\$([^}]+)}/g;function g9(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Yh(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const s=t[i],a=e[i];if(H2(s)&&H2(a)){if(!Yh(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function H2(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F0(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function x9(t,e){const r=new v9(t,e);return r.subscribe.bind(r)}class v9{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");y9(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=Hm),i.error===void 0&&(i.error=Hm),i.complete===void 0&&(i.complete=Hm);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function y9(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Hm(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ms(t){return t&&t._delegate?t._delegate:t}class Ol{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _9{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new r9;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(w9(e))try{this.getOrInitializeService({instanceIdentifier:cl})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=cl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=cl){return this.instances.has(e)}getOptions(e=cl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:E9(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=cl){return this.component?this.component.multipleInstances?e:cl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function E9(t){return t===cl?void 0:t}function w9(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T9{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new _9(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var kt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(kt||(kt={}));const S9={debug:kt.DEBUG,verbose:kt.VERBOSE,info:kt.INFO,warn:kt.WARN,error:kt.ERROR,silent:kt.SILENT},A9=kt.INFO,k9={[kt.DEBUG]:"log",[kt.VERBOSE]:"log",[kt.INFO]:"info",[kt.WARN]:"warn",[kt.ERROR]:"error"},C9=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=k9[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class fv{constructor(e){this.name=e,this._logLevel=A9,this._logHandler=C9,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in kt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?S9[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,kt.DEBUG,...e),this._logHandler(this,kt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,kt.VERBOSE,...e),this._logHandler(this,kt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,kt.INFO,...e),this._logHandler(this,kt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,kt.WARN,...e),this._logHandler(this,kt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,kt.ERROR,...e),this._logHandler(this,kt.ERROR,...e)}}const F9=(t,e)=>e.some(r=>t instanceof r);let $2,G2;function I9(){return $2||($2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function b9(){return G2||(G2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Ck=new WeakMap,ox=new WeakMap,Fk=new WeakMap,$m=new WeakMap,dv=new WeakMap;function R9(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(Ro(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&Ck.set(r,t)}).catch(()=>{}),dv.set(e,t),e}function N9(t){if(ox.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});ox.set(t,e)}let lx={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return ox.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Fk.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Ro(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function D9(t){lx=t(lx)}function P9(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Gm(this),e,...r);return Fk.set(n,e.sort?e.sort():[e]),Ro(n)}:b9().includes(t)?function(...e){return t.apply(Gm(this),e),Ro(Ck.get(this))}:function(...e){return Ro(t.apply(Gm(this),e))}}function O9(t){return typeof t=="function"?P9(t):(t instanceof IDBTransaction&&N9(t),F9(t,I9())?new Proxy(t,lx):t)}function Ro(t){if(t instanceof IDBRequest)return R9(t);if($m.has(t))return $m.get(t);const e=O9(t);return e!==t&&($m.set(t,e),dv.set(e,t)),e}const Gm=t=>dv.get(t);function M9(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),o=Ro(a);return n&&a.addEventListener("upgradeneeded",l=>{n(Ro(a.result),l.oldVersion,l.newVersion,Ro(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const L9=["get","getKey","getAll","getAllKeys","count"],B9=["put","add","delete","clear"],Km=new Map;function K2(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Km.get(e))return Km.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=B9.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||L9.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),i&&l.done]))[0]};return Km.set(e,s),s}D9(t=>({...t,get:(e,r,n)=>K2(e,r)||t.get(e,r,n),has:(e,r)=>!!K2(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j9{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(V9(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function V9(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const cx="@firebase/app",X2="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Va=new fv("@firebase/app"),U9="@firebase/app-compat",z9="@firebase/analytics-compat",W9="@firebase/analytics",H9="@firebase/app-check-compat",$9="@firebase/app-check",G9="@firebase/auth",K9="@firebase/auth-compat",X9="@firebase/database",Y9="@firebase/data-connect",q9="@firebase/database-compat",Q9="@firebase/functions",J9="@firebase/functions-compat",Z9="@firebase/installations",ej="@firebase/installations-compat",tj="@firebase/messaging",rj="@firebase/messaging-compat",nj="@firebase/performance",ij="@firebase/performance-compat",sj="@firebase/remote-config",aj="@firebase/remote-config-compat",oj="@firebase/storage",lj="@firebase/storage-compat",cj="@firebase/firestore",uj="@firebase/vertexai-preview",fj="@firebase/firestore-compat",dj="firebase",hj="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ux="[DEFAULT]",pj={[cx]:"fire-core",[U9]:"fire-core-compat",[W9]:"fire-analytics",[z9]:"fire-analytics-compat",[$9]:"fire-app-check",[H9]:"fire-app-check-compat",[G9]:"fire-auth",[K9]:"fire-auth-compat",[X9]:"fire-rtdb",[Y9]:"fire-data-connect",[q9]:"fire-rtdb-compat",[Q9]:"fire-fn",[J9]:"fire-fn-compat",[Z9]:"fire-iid",[ej]:"fire-iid-compat",[tj]:"fire-fcm",[rj]:"fire-fcm-compat",[nj]:"fire-perf",[ij]:"fire-perf-compat",[sj]:"fire-rc",[aj]:"fire-rc-compat",[oj]:"fire-gcs",[lj]:"fire-gcs-compat",[cj]:"fire-fst",[fj]:"fire-fst-compat",[uj]:"fire-vertex","fire-js":"fire-js",[dj]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qh=new Map,mj=new Map,fx=new Map;function Y2(t,e){try{t.container.addComponent(e)}catch(r){Va.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function ru(t){const e=t.name;if(fx.has(e))return Va.debug(`There were multiple attempts to register component ${e}.`),!1;fx.set(e,t);for(const r of qh.values())Y2(r,t);for(const r of mj.values())Y2(r,t);return!0}function hv(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Eo(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},No=new C0("app","Firebase",gj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xj{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ol("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw No.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vu=hj;function Ik(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:ux,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw No.create("bad-app-name",{appName:String(i)});if(r||(r=Ak()),!r)throw No.create("no-options");const s=qh.get(i);if(s){if(Yh(r,s.options)&&Yh(n,s.config))return s;throw No.create("duplicate-app",{appName:i})}const a=new T9(i);for(const l of fx.values())a.addComponent(l);const o=new xj(r,n,a);return qh.set(i,o),o}function bk(t=ux){const e=qh.get(t);if(!e&&t===ux&&Ak())return Ik();if(!e)throw No.create("no-app",{appName:t});return e}function Do(t,e,r){var n;let i=(n=pj[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Va.warn(o.join(" "));return}ru(new Ol(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vj="firebase-heartbeat-database",yj=1,i0="firebase-heartbeat-store";let Xm=null;function Rk(){return Xm||(Xm=M9(vj,yj,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(i0)}catch(r){console.warn(r)}}}}).catch(t=>{throw No.create("idb-open",{originalErrorMessage:t.message})})),Xm}async function _j(t){try{const r=(await Rk()).transaction(i0),n=await r.objectStore(i0).get(Nk(t));return await r.done,n}catch(e){if(e instanceof Ya)Va.warn(e.message);else{const r=No.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Va.warn(r.message)}}}async function q2(t,e){try{const n=(await Rk()).transaction(i0,"readwrite");await n.objectStore(i0).put(e,Nk(t)),await n.done}catch(r){if(r instanceof Ya)Va.warn(r.message);else{const n=No.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Va.warn(n.message)}}}function Nk(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ej=1024,wj=30*24*60*60*1e3;class Tj{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new Aj(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Q2();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=wj}),this._storage.overwrite(this._heartbeatsCache))}catch(n){Va.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Q2(),{heartbeatsToSend:n,unsentEntries:i}=Sj(this._heartbeatsCache.heartbeats),s=Xh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return Va.warn(r),""}}}function Q2(){return new Date().toISOString().substring(0,10)}function Sj(t,e=Ej){const r=[];let n=t.slice();for(const i of t){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),J2(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),J2(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class Aj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return f9()?d9().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await _j(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return q2(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return q2(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function J2(t){return Xh(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kj(t){ru(new Ol("platform-logger",e=>new j9(e),"PRIVATE")),ru(new Ol("heartbeat",e=>new Tj(e),"PRIVATE")),Do(cx,X2,t),Do(cx,X2,"esm2017"),Do("fire-js","")}kj("");var Cj="firebase",Fj="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Do(Cj,Fj,"app");var Z2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var wl,Dk;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,F){function S(){}S.prototype=F.prototype,w.D=F.prototype,w.prototype=new S,w.prototype.constructor=w,w.C=function(b,N,D){for(var R=Array(arguments.length-2),He=2;He<arguments.length;He++)R[He-2]=arguments[He];return F.prototype[N].apply(b,R)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,F,S){S||(S=0);var b=Array(16);if(typeof F=="string")for(var N=0;16>N;++N)b[N]=F.charCodeAt(S++)|F.charCodeAt(S++)<<8|F.charCodeAt(S++)<<16|F.charCodeAt(S++)<<24;else for(N=0;16>N;++N)b[N]=F[S++]|F[S++]<<8|F[S++]<<16|F[S++]<<24;F=w.g[0],S=w.g[1],N=w.g[2];var D=w.g[3],R=F+(D^S&(N^D))+b[0]+3614090360&4294967295;F=S+(R<<7&4294967295|R>>>25),R=D+(N^F&(S^N))+b[1]+3905402710&4294967295,D=F+(R<<12&4294967295|R>>>20),R=N+(S^D&(F^S))+b[2]+606105819&4294967295,N=D+(R<<17&4294967295|R>>>15),R=S+(F^N&(D^F))+b[3]+3250441966&4294967295,S=N+(R<<22&4294967295|R>>>10),R=F+(D^S&(N^D))+b[4]+4118548399&4294967295,F=S+(R<<7&4294967295|R>>>25),R=D+(N^F&(S^N))+b[5]+1200080426&4294967295,D=F+(R<<12&4294967295|R>>>20),R=N+(S^D&(F^S))+b[6]+2821735955&4294967295,N=D+(R<<17&4294967295|R>>>15),R=S+(F^N&(D^F))+b[7]+4249261313&4294967295,S=N+(R<<22&4294967295|R>>>10),R=F+(D^S&(N^D))+b[8]+1770035416&4294967295,F=S+(R<<7&4294967295|R>>>25),R=D+(N^F&(S^N))+b[9]+2336552879&4294967295,D=F+(R<<12&4294967295|R>>>20),R=N+(S^D&(F^S))+b[10]+4294925233&4294967295,N=D+(R<<17&4294967295|R>>>15),R=S+(F^N&(D^F))+b[11]+2304563134&4294967295,S=N+(R<<22&4294967295|R>>>10),R=F+(D^S&(N^D))+b[12]+1804603682&4294967295,F=S+(R<<7&4294967295|R>>>25),R=D+(N^F&(S^N))+b[13]+4254626195&4294967295,D=F+(R<<12&4294967295|R>>>20),R=N+(S^D&(F^S))+b[14]+2792965006&4294967295,N=D+(R<<17&4294967295|R>>>15),R=S+(F^N&(D^F))+b[15]+1236535329&4294967295,S=N+(R<<22&4294967295|R>>>10),R=F+(N^D&(S^N))+b[1]+4129170786&4294967295,F=S+(R<<5&4294967295|R>>>27),R=D+(S^N&(F^S))+b[6]+3225465664&4294967295,D=F+(R<<9&4294967295|R>>>23),R=N+(F^S&(D^F))+b[11]+643717713&4294967295,N=D+(R<<14&4294967295|R>>>18),R=S+(D^F&(N^D))+b[0]+3921069994&4294967295,S=N+(R<<20&4294967295|R>>>12),R=F+(N^D&(S^N))+b[5]+3593408605&4294967295,F=S+(R<<5&4294967295|R>>>27),R=D+(S^N&(F^S))+b[10]+38016083&4294967295,D=F+(R<<9&4294967295|R>>>23),R=N+(F^S&(D^F))+b[15]+3634488961&4294967295,N=D+(R<<14&4294967295|R>>>18),R=S+(D^F&(N^D))+b[4]+3889429448&4294967295,S=N+(R<<20&4294967295|R>>>12),R=F+(N^D&(S^N))+b[9]+568446438&4294967295,F=S+(R<<5&4294967295|R>>>27),R=D+(S^N&(F^S))+b[14]+3275163606&4294967295,D=F+(R<<9&4294967295|R>>>23),R=N+(F^S&(D^F))+b[3]+4107603335&4294967295,N=D+(R<<14&4294967295|R>>>18),R=S+(D^F&(N^D))+b[8]+1163531501&4294967295,S=N+(R<<20&4294967295|R>>>12),R=F+(N^D&(S^N))+b[13]+2850285829&4294967295,F=S+(R<<5&4294967295|R>>>27),R=D+(S^N&(F^S))+b[2]+4243563512&4294967295,D=F+(R<<9&4294967295|R>>>23),R=N+(F^S&(D^F))+b[7]+1735328473&4294967295,N=D+(R<<14&4294967295|R>>>18),R=S+(D^F&(N^D))+b[12]+2368359562&4294967295,S=N+(R<<20&4294967295|R>>>12),R=F+(S^N^D)+b[5]+4294588738&4294967295,F=S+(R<<4&4294967295|R>>>28),R=D+(F^S^N)+b[8]+2272392833&4294967295,D=F+(R<<11&4294967295|R>>>21),R=N+(D^F^S)+b[11]+1839030562&4294967295,N=D+(R<<16&4294967295|R>>>16),R=S+(N^D^F)+b[14]+4259657740&4294967295,S=N+(R<<23&4294967295|R>>>9),R=F+(S^N^D)+b[1]+2763975236&4294967295,F=S+(R<<4&4294967295|R>>>28),R=D+(F^S^N)+b[4]+1272893353&4294967295,D=F+(R<<11&4294967295|R>>>21),R=N+(D^F^S)+b[7]+4139469664&4294967295,N=D+(R<<16&4294967295|R>>>16),R=S+(N^D^F)+b[10]+3200236656&4294967295,S=N+(R<<23&4294967295|R>>>9),R=F+(S^N^D)+b[13]+681279174&4294967295,F=S+(R<<4&4294967295|R>>>28),R=D+(F^S^N)+b[0]+3936430074&4294967295,D=F+(R<<11&4294967295|R>>>21),R=N+(D^F^S)+b[3]+3572445317&4294967295,N=D+(R<<16&4294967295|R>>>16),R=S+(N^D^F)+b[6]+76029189&4294967295,S=N+(R<<23&4294967295|R>>>9),R=F+(S^N^D)+b[9]+3654602809&4294967295,F=S+(R<<4&4294967295|R>>>28),R=D+(F^S^N)+b[12]+3873151461&4294967295,D=F+(R<<11&4294967295|R>>>21),R=N+(D^F^S)+b[15]+530742520&4294967295,N=D+(R<<16&4294967295|R>>>16),R=S+(N^D^F)+b[2]+3299628645&4294967295,S=N+(R<<23&4294967295|R>>>9),R=F+(N^(S|~D))+b[0]+4096336452&4294967295,F=S+(R<<6&4294967295|R>>>26),R=D+(S^(F|~N))+b[7]+1126891415&4294967295,D=F+(R<<10&4294967295|R>>>22),R=N+(F^(D|~S))+b[14]+2878612391&4294967295,N=D+(R<<15&4294967295|R>>>17),R=S+(D^(N|~F))+b[5]+4237533241&4294967295,S=N+(R<<21&4294967295|R>>>11),R=F+(N^(S|~D))+b[12]+1700485571&4294967295,F=S+(R<<6&4294967295|R>>>26),R=D+(S^(F|~N))+b[3]+2399980690&4294967295,D=F+(R<<10&4294967295|R>>>22),R=N+(F^(D|~S))+b[10]+4293915773&4294967295,N=D+(R<<15&4294967295|R>>>17),R=S+(D^(N|~F))+b[1]+2240044497&4294967295,S=N+(R<<21&4294967295|R>>>11),R=F+(N^(S|~D))+b[8]+1873313359&4294967295,F=S+(R<<6&4294967295|R>>>26),R=D+(S^(F|~N))+b[15]+4264355552&4294967295,D=F+(R<<10&4294967295|R>>>22),R=N+(F^(D|~S))+b[6]+2734768916&4294967295,N=D+(R<<15&4294967295|R>>>17),R=S+(D^(N|~F))+b[13]+1309151649&4294967295,S=N+(R<<21&4294967295|R>>>11),R=F+(N^(S|~D))+b[4]+4149444226&4294967295,F=S+(R<<6&4294967295|R>>>26),R=D+(S^(F|~N))+b[11]+3174756917&4294967295,D=F+(R<<10&4294967295|R>>>22),R=N+(F^(D|~S))+b[2]+718787259&4294967295,N=D+(R<<15&4294967295|R>>>17),R=S+(D^(N|~F))+b[9]+3951481745&4294967295,w.g[0]=w.g[0]+F&4294967295,w.g[1]=w.g[1]+(N+(R<<21&4294967295|R>>>11))&4294967295,w.g[2]=w.g[2]+N&4294967295,w.g[3]=w.g[3]+D&4294967295}n.prototype.u=function(w,F){F===void 0&&(F=w.length);for(var S=F-this.blockSize,b=this.B,N=this.h,D=0;D<F;){if(N==0)for(;D<=S;)i(this,w,D),D+=this.blockSize;if(typeof w=="string"){for(;D<F;)if(b[N++]=w.charCodeAt(D++),N==this.blockSize){i(this,b),N=0;break}}else for(;D<F;)if(b[N++]=w[D++],N==this.blockSize){i(this,b),N=0;break}}this.h=N,this.o+=F},n.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var F=1;F<w.length-8;++F)w[F]=0;var S=8*this.o;for(F=w.length-8;F<w.length;++F)w[F]=S&255,S/=256;for(this.u(w),w=Array(16),F=S=0;4>F;++F)for(var b=0;32>b;b+=8)w[S++]=this.g[F]>>>b&255;return w};function s(w,F){var S=o;return Object.prototype.hasOwnProperty.call(S,w)?S[w]:S[w]=F(w)}function a(w,F){this.h=F;for(var S=[],b=!0,N=w.length-1;0<=N;N--){var D=w[N]|0;b&&D==F||(S[N]=D,b=!1)}this.g=S}var o={};function l(w){return-128<=w&&128>w?s(w,function(F){return new a([F|0],0>F?-1:0)}):new a([w|0],0>w?-1:0)}function c(w){if(isNaN(w)||!isFinite(w))return h;if(0>w)return E(c(-w));for(var F=[],S=1,b=0;w>=S;b++)F[b]=w/S|0,S*=4294967296;return new a(F,0)}function d(w,F){if(w.length==0)throw Error("number format error: empty string");if(F=F||10,2>F||36<F)throw Error("radix out of range: "+F);if(w.charAt(0)=="-")return E(d(w.substring(1),F));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=c(Math.pow(F,8)),b=h,N=0;N<w.length;N+=8){var D=Math.min(8,w.length-N),R=parseInt(w.substring(N,N+D),F);8>D?(D=c(Math.pow(F,D)),b=b.j(D).add(c(R))):(b=b.j(S),b=b.add(c(R)))}return b}var h=l(0),p=l(1),g=l(16777216);t=a.prototype,t.m=function(){if(x(this))return-E(this).m();for(var w=0,F=1,S=0;S<this.g.length;S++){var b=this.i(S);w+=(0<=b?b:4294967296+b)*F,F*=4294967296}return w},t.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(y(this))return"0";if(x(this))return"-"+E(this).toString(w);for(var F=c(Math.pow(w,6)),S=this,b="";;){var N=P(S,F).g;S=T(S,N.j(F));var D=((0<S.g.length?S.g[0]:S.h)>>>0).toString(w);if(S=N,y(S))return D+b;for(;6>D.length;)D="0"+D;b=D+b}},t.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function y(w){if(w.h!=0)return!1;for(var F=0;F<w.g.length;F++)if(w.g[F]!=0)return!1;return!0}function x(w){return w.h==-1}t.l=function(w){return w=T(this,w),x(w)?-1:y(w)?0:1};function E(w){for(var F=w.g.length,S=[],b=0;b<F;b++)S[b]=~w.g[b];return new a(S,~w.h).add(p)}t.abs=function(){return x(this)?E(this):this},t.add=function(w){for(var F=Math.max(this.g.length,w.g.length),S=[],b=0,N=0;N<=F;N++){var D=b+(this.i(N)&65535)+(w.i(N)&65535),R=(D>>>16)+(this.i(N)>>>16)+(w.i(N)>>>16);b=R>>>16,D&=65535,R&=65535,S[N]=R<<16|D}return new a(S,S[S.length-1]&-2147483648?-1:0)};function T(w,F){return w.add(E(F))}t.j=function(w){if(y(this)||y(w))return h;if(x(this))return x(w)?E(this).j(E(w)):E(E(this).j(w));if(x(w))return E(this.j(E(w)));if(0>this.l(g)&&0>w.l(g))return c(this.m()*w.m());for(var F=this.g.length+w.g.length,S=[],b=0;b<2*F;b++)S[b]=0;for(b=0;b<this.g.length;b++)for(var N=0;N<w.g.length;N++){var D=this.i(b)>>>16,R=this.i(b)&65535,He=w.i(N)>>>16,xe=w.i(N)&65535;S[2*b+2*N]+=R*xe,A(S,2*b+2*N),S[2*b+2*N+1]+=D*xe,A(S,2*b+2*N+1),S[2*b+2*N+1]+=R*He,A(S,2*b+2*N+1),S[2*b+2*N+2]+=D*He,A(S,2*b+2*N+2)}for(b=0;b<F;b++)S[b]=S[2*b+1]<<16|S[2*b];for(b=F;b<2*F;b++)S[b]=0;return new a(S,0)};function A(w,F){for(;(w[F]&65535)!=w[F];)w[F+1]+=w[F]>>>16,w[F]&=65535,F++}function _(w,F){this.g=w,this.h=F}function P(w,F){if(y(F))throw Error("division by zero");if(y(w))return new _(h,h);if(x(w))return F=P(E(w),F),new _(E(F.g),E(F.h));if(x(F))return F=P(w,E(F)),new _(E(F.g),F.h);if(30<w.g.length){if(x(w)||x(F))throw Error("slowDivide_ only works with positive integers.");for(var S=p,b=F;0>=b.l(w);)S=W(S),b=W(b);var N=j(S,1),D=j(b,1);for(b=j(b,2),S=j(S,2);!y(b);){var R=D.add(b);0>=R.l(w)&&(N=N.add(S),D=R),b=j(b,1),S=j(S,1)}return F=T(w,N.j(F)),new _(N,F)}for(N=h;0<=w.l(F);){for(S=Math.max(1,Math.floor(w.m()/F.m())),b=Math.ceil(Math.log(S)/Math.LN2),b=48>=b?1:Math.pow(2,b-48),D=c(S),R=D.j(F);x(R)||0<R.l(w);)S-=b,D=c(S),R=D.j(F);y(D)&&(D=p),N=N.add(D),w=T(w,R)}return new _(N,w)}t.A=function(w){return P(this,w).h},t.and=function(w){for(var F=Math.max(this.g.length,w.g.length),S=[],b=0;b<F;b++)S[b]=this.i(b)&w.i(b);return new a(S,this.h&w.h)},t.or=function(w){for(var F=Math.max(this.g.length,w.g.length),S=[],b=0;b<F;b++)S[b]=this.i(b)|w.i(b);return new a(S,this.h|w.h)},t.xor=function(w){for(var F=Math.max(this.g.length,w.g.length),S=[],b=0;b<F;b++)S[b]=this.i(b)^w.i(b);return new a(S,this.h^w.h)};function W(w){for(var F=w.g.length+1,S=[],b=0;b<F;b++)S[b]=w.i(b)<<1|w.i(b-1)>>>31;return new a(S,w.h)}function j(w,F){var S=F>>5;F%=32;for(var b=w.g.length-S,N=[],D=0;D<b;D++)N[D]=0<F?w.i(D+S)>>>F|w.i(D+S+1)<<32-F:w.i(D+S);return new a(N,w.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Dk=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=d,wl=a}).apply(typeof Z2<"u"?Z2:typeof self<"u"?self:typeof window<"u"?window:{});var Ld=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Pk,ef,Ok,rh,dx,Mk,Lk,Bk;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,v,k){return u==Array.prototype||u==Object.prototype||(u[v]=k.value),u};function r(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ld=="object"&&Ld];for(var v=0;v<u.length;++v){var k=u[v];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var n=r(this);function i(u,v){if(v)e:{var k=n;u=u.split(".");for(var O=0;O<u.length-1;O++){var ne=u[O];if(!(ne in k))break e;k=k[ne]}u=u[u.length-1],O=k[u],v=v(O),v!=O&&v!=null&&e(k,u,{configurable:!0,writable:!0,value:v})}}function s(u,v){u instanceof String&&(u+="");var k=0,O=!1,ne={next:function(){if(!O&&k<u.length){var fe=k++;return{value:v(fe,u[fe]),done:!1}}return O=!0,{done:!0,value:void 0}}};return ne[Symbol.iterator]=function(){return ne},ne}i("Array.prototype.values",function(u){return u||function(){return s(this,function(v,k){return k})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(u){var v=typeof u;return v=v!="object"?v:u?Array.isArray(u)?"array":v:"null",v=="array"||v=="object"&&typeof u.length=="number"}function c(u){var v=typeof u;return v=="object"&&u!=null||v=="function"}function d(u,v,k){return u.call.apply(u.bind,arguments)}function h(u,v,k){if(!u)throw Error();if(2<arguments.length){var O=Array.prototype.slice.call(arguments,2);return function(){var ne=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ne,O),u.apply(v,ne)}}return function(){return u.apply(v,arguments)}}function p(u,v,k){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,p.apply(null,arguments)}function g(u,v){var k=Array.prototype.slice.call(arguments,1);return function(){var O=k.slice();return O.push.apply(O,arguments),u.apply(this,O)}}function y(u,v){function k(){}k.prototype=v.prototype,u.aa=v.prototype,u.prototype=new k,u.prototype.constructor=u,u.Qb=function(O,ne,fe){for(var je=Array(arguments.length-2),Wt=2;Wt<arguments.length;Wt++)je[Wt-2]=arguments[Wt];return v.prototype[ne].apply(O,je)}}function x(u){const v=u.length;if(0<v){const k=Array(v);for(let O=0;O<v;O++)k[O]=u[O];return k}return[]}function E(u,v){for(let k=1;k<arguments.length;k++){const O=arguments[k];if(l(O)){const ne=u.length||0,fe=O.length||0;u.length=ne+fe;for(let je=0;je<fe;je++)u[ne+je]=O[je]}else u.push(O)}}class T{constructor(v,k){this.i=v,this.j=k,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function A(u){return/^[\s\xa0]*$/.test(u)}function _(){var u=o.navigator;return u&&(u=u.userAgent)?u:""}function P(u){return P[" "](u),u}P[" "]=function(){};var W=_().indexOf("Gecko")!=-1&&!(_().toLowerCase().indexOf("webkit")!=-1&&_().indexOf("Edge")==-1)&&!(_().indexOf("Trident")!=-1||_().indexOf("MSIE")!=-1)&&_().indexOf("Edge")==-1;function j(u,v,k){for(const O in u)v.call(k,u[O],O,u)}function w(u,v){for(const k in u)v.call(void 0,u[k],k,u)}function F(u){const v={};for(const k in u)v[k]=u[k];return v}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(u,v){let k,O;for(let ne=1;ne<arguments.length;ne++){O=arguments[ne];for(k in O)u[k]=O[k];for(let fe=0;fe<S.length;fe++)k=S[fe],Object.prototype.hasOwnProperty.call(O,k)&&(u[k]=O[k])}}function N(u){var v=1;u=u.split(":");const k=[];for(;0<v&&u.length;)k.push(u.shift()),v--;return u.length&&k.push(u.join(":")),k}function D(u){o.setTimeout(()=>{throw u},0)}function R(){var u=Z;let v=null;return u.g&&(v=u.g,u.g=u.g.next,u.g||(u.h=null),v.next=null),v}class He{constructor(){this.h=this.g=null}add(v,k){const O=xe.get();O.set(v,k),this.h?this.h.next=O:this.g=O,this.h=O}}var xe=new T(()=>new be,u=>u.reset());class be{constructor(){this.next=this.g=this.h=null}set(v,k){this.h=v,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let Ae,Ee=!1,Z=new He,Ce=()=>{const u=o.Promise.resolve(void 0);Ae=()=>{u.then(Le)}};var Le=()=>{for(var u;u=R();){try{u.h.call(u.g)}catch(k){D(k)}var v=xe;v.j(u),100>v.h&&(v.h++,u.next=v.g,v.g=u)}Ee=!1};function U(){this.s=this.s,this.C=this.C}U.prototype.s=!1,U.prototype.ma=function(){this.s||(this.s=!0,this.N())},U.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function G(u,v){this.type=u,this.g=this.target=v,this.defaultPrevented=!1}G.prototype.h=function(){this.defaultPrevented=!0};var J=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var u=!1,v=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const k=()=>{};o.addEventListener("test",k,v),o.removeEventListener("test",k,v)}catch{}return u}();function q(u,v){if(G.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var k=this.type=u.type,O=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=v,v=u.relatedTarget){if(W){e:{try{P(v.nodeName);var ne=!0;break e}catch{}ne=!1}ne||(v=null)}}else k=="mouseover"?v=u.fromElement:k=="mouseout"&&(v=u.toElement);this.relatedTarget=v,O?(this.clientX=O.clientX!==void 0?O.clientX:O.pageX,this.clientY=O.clientY!==void 0?O.clientY:O.pageY,this.screenX=O.screenX||0,this.screenY=O.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:he[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&q.aa.h.call(this)}}y(q,G);var he={2:"touch",3:"pen",4:"mouse"};q.prototype.h=function(){q.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Se="closure_listenable_"+(1e6*Math.random()|0),Ne=0;function ke(u,v,k,O,ne){this.listener=u,this.proxy=null,this.src=v,this.type=k,this.capture=!!O,this.ha=ne,this.key=++Ne,this.da=this.fa=!1}function Te(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function nt(u){this.src=u,this.g={},this.h=0}nt.prototype.add=function(u,v,k,O,ne){var fe=u.toString();u=this.g[fe],u||(u=this.g[fe]=[],this.h++);var je=Ct(u,v,O,ne);return-1<je?(v=u[je],k||(v.fa=!1)):(v=new ke(v,this.src,fe,!!O,ne),v.fa=k,u.push(v)),v};function K(u,v){var k=v.type;if(k in u.g){var O=u.g[k],ne=Array.prototype.indexOf.call(O,v,void 0),fe;(fe=0<=ne)&&Array.prototype.splice.call(O,ne,1),fe&&(Te(v),u.g[k].length==0&&(delete u.g[k],u.h--))}}function Ct(u,v,k,O){for(var ne=0;ne<u.length;++ne){var fe=u[ne];if(!fe.da&&fe.listener==v&&fe.capture==!!k&&fe.ha==O)return ne}return-1}var xt="closure_lm_"+(1e6*Math.random()|0),Rt={};function pt(u,v,k,O,ne){if(Array.isArray(v)){for(var fe=0;fe<v.length;fe++)pt(u,v[fe],k,O,ne);return null}return k=vi(k),u&&u[Se]?u.K(v,k,c(O)?!!O.capture:!1,ne):$e(u,v,k,!1,O,ne)}function $e(u,v,k,O,ne,fe){if(!v)throw Error("Invalid event type");var je=c(ne)?!!ne.capture:!!ne,Wt=xi(u);if(Wt||(u[xt]=Wt=new nt(u)),k=Wt.add(v,k,O,je,fe),k.proxy)return k;if(O=Yt(),k.proxy=O,O.src=u,O.listener=k,u.addEventListener)J||(ne=je),ne===void 0&&(ne=!1),u.addEventListener(v.toString(),O,ne);else if(u.attachEvent)u.attachEvent(gi(v.toString()),O);else if(u.addListener&&u.removeListener)u.addListener(O);else throw Error("addEventListener and attachEvent are unavailable.");return k}function Yt(){function u(k){return v.call(u.src,u.listener,k)}const v=Ki;return u}function En(u,v,k,O,ne){if(Array.isArray(v))for(var fe=0;fe<v.length;fe++)En(u,v[fe],k,O,ne);else O=c(O)?!!O.capture:!!O,k=vi(k),u&&u[Se]?(u=u.i,v=String(v).toString(),v in u.g&&(fe=u.g[v],k=Ct(fe,k,O,ne),-1<k&&(Te(fe[k]),Array.prototype.splice.call(fe,k,1),fe.length==0&&(delete u.g[v],u.h--)))):u&&(u=xi(u))&&(v=u.g[v.toString()],u=-1,v&&(u=Ct(v,k,O,ne)),(k=-1<u?v[u]:null)&&fn(k))}function fn(u){if(typeof u!="number"&&u&&!u.da){var v=u.src;if(v&&v[Se])K(v.i,u);else{var k=u.type,O=u.proxy;v.removeEventListener?v.removeEventListener(k,O,u.capture):v.detachEvent?v.detachEvent(gi(k),O):v.addListener&&v.removeListener&&v.removeListener(O),(k=xi(v))?(K(k,u),k.h==0&&(k.src=null,v[xt]=null)):Te(u)}}}function gi(u){return u in Rt?Rt[u]:Rt[u]="on"+u}function Ki(u,v){if(u.da)u=!0;else{v=new q(v,this);var k=u.listener,O=u.ha||u.src;u.fa&&fn(u),u=k.call(O,v)}return u}function xi(u){return u=u[xt],u instanceof nt?u:null}var br="__closure_events_fn_"+(1e9*Math.random()>>>0);function vi(u){return typeof u=="function"?u:(u[br]||(u[br]=function(v){return u.handleEvent(v)}),u[br])}function zt(){U.call(this),this.i=new nt(this),this.M=this,this.F=null}y(zt,U),zt.prototype[Se]=!0,zt.prototype.removeEventListener=function(u,v,k,O){En(this,u,v,k,O)};function _r(u,v){var k,O=u.F;if(O)for(k=[];O;O=O.F)k.push(O);if(u=u.M,O=v.type||v,typeof v=="string")v=new G(v,u);else if(v instanceof G)v.target=v.target||u;else{var ne=v;v=new G(O,u),b(v,ne)}if(ne=!0,k)for(var fe=k.length-1;0<=fe;fe--){var je=v.g=k[fe];ne=Zt(je,O,!0,v)&&ne}if(je=v.g=u,ne=Zt(je,O,!0,v)&&ne,ne=Zt(je,O,!1,v)&&ne,k)for(fe=0;fe<k.length;fe++)je=v.g=k[fe],ne=Zt(je,O,!1,v)&&ne}zt.prototype.N=function(){if(zt.aa.N.call(this),this.i){var u=this.i,v;for(v in u.g){for(var k=u.g[v],O=0;O<k.length;O++)Te(k[O]);delete u.g[v],u.h--}}this.F=null},zt.prototype.K=function(u,v,k,O){return this.i.add(String(u),v,!1,k,O)},zt.prototype.L=function(u,v,k,O){return this.i.add(String(u),v,!0,k,O)};function Zt(u,v,k,O){if(v=u.i.g[String(v)],!v)return!0;v=v.concat();for(var ne=!0,fe=0;fe<v.length;++fe){var je=v[fe];if(je&&!je.da&&je.capture==k){var Wt=je.listener,rn=je.ha||je.src;je.fa&&K(u.i,je),ne=Wt.call(rn,O)!==!1&&ne}}return ne&&!O.defaultPrevented}function ri(u,v,k){if(typeof u=="function")k&&(u=p(u,k));else if(u&&typeof u.handleEvent=="function")u=p(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:o.setTimeout(u,v||0)}function ut(u){u.g=ri(()=>{u.g=null,u.i&&(u.i=!1,ut(u))},u.l);const v=u.h;u.h=null,u.m.apply(null,v)}class nr extends U{constructor(v,k){super(),this.m=v,this.l=k,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:ut(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Er(u){U.call(this),this.h=u,this.g={}}y(Er,U);var mr=[];function ni(u){j(u.g,function(v,k){this.g.hasOwnProperty(k)&&fn(v)},u),u.g={}}Er.prototype.N=function(){Er.aa.N.call(this),ni(this)},Er.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var qa=o.JSON.stringify,ca=o.JSON.parse,se=class{stringify(u){return o.JSON.stringify(u,void 0)}parse(u){return o.JSON.parse(u,void 0)}};function wr(){}wr.prototype.h=null;function ps(u){return u.h||(u.h=u.i())}function Qa(){}var Xi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ua(){G.call(this,"d")}y(ua,G);function yi(){G.call(this,"c")}y(yi,G);var On={},tn=null;function fa(){return tn=tn||new zt}On.La="serverreachability";function da(u){G.call(this,On.La,u)}y(da,G);function ha(u){const v=fa();_r(v,new da(v))}On.STAT_EVENT="statevent";function Mn(u,v){G.call(this,On.STAT_EVENT,u),this.stat=v}y(Mn,G);function Gr(u){const v=fa();_r(v,new Mn(v,u))}On.Ma="timingevent";function tr(u,v){G.call(this,On.Ma,u),this.size=v}y(tr,G);function Ln(u,v){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){u()},v)}function Bn(){this.g=!0}Bn.prototype.xa=function(){this.g=!1};function ms(u,v,k,O,ne,fe){u.info(function(){if(u.g)if(fe)for(var je="",Wt=fe.split("&"),rn=0;rn<Wt.length;rn++){var It=Wt[rn].split("=");if(1<It.length){var hn=It[0];It=It[1];var pn=hn.split("_");je=2<=pn.length&&pn[1]=="type"?je+(hn+"="+It+"&"):je+(hn+"=redacted&")}}else je=null;else je=fe;return"XMLHTTP REQ ("+O+") [attempt "+ne+"]: "+v+`
`+k+`
`+je})}function Su(u,v,k,O,ne,fe,je){u.info(function(){return"XMLHTTP RESP ("+O+") [ attempt "+ne+"]: "+v+`
`+k+`
`+fe+" "+je})}function I(u,v,k,O){u.info(function(){return"XMLHTTP TEXT ("+v+"): "+M(u,k)+(O?" "+O:"")})}function V(u,v){u.info(function(){return"TIMEOUT: "+v})}Bn.prototype.info=function(){};function M(u,v){if(!u.g)return v;if(!v)return null;try{var k=JSON.parse(v);if(k){for(u=0;u<k.length;u++)if(Array.isArray(k[u])){var O=k[u];if(!(2>O.length)){var ne=O[1];if(Array.isArray(ne)&&!(1>ne.length)){var fe=ne[0];if(fe!="noop"&&fe!="stop"&&fe!="close")for(var je=1;je<ne.length;je++)ne[je]=""}}}}return qa(k)}catch{return v}}var L={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},z={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},B;function ae(){}y(ae,wr),ae.prototype.g=function(){return new XMLHttpRequest},ae.prototype.i=function(){return{}},B=new ae;function ue(u,v,k,O){this.j=u,this.i=v,this.l=k,this.R=O||1,this.U=new Er(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ie}function ie(){this.i=null,this.g="",this.h=!1}var te={},le={};function pe(u,v,k){u.L=1,u.v=Ja(ir(v)),u.m=k,u.P=!0,De(u,null)}function De(u,v){u.F=Date.now(),ze(u),u.A=ir(u.v);var k=u.A,O=u.R;Array.isArray(O)||(O=[String(O)]),Cu(k.i,"t",O),u.C=0,k=u.j.J,u.h=new ie,u.g=Ru(u.j,k?v:null,!u.m),0<u.O&&(u.M=new nr(p(u.Y,u,u.g),u.O)),v=u.U,k=u.g,O=u.ca;var ne="readystatechange";Array.isArray(ne)||(ne&&(mr[0]=ne.toString()),ne=mr);for(var fe=0;fe<ne.length;fe++){var je=pt(k,ne[fe],O||v.handleEvent,!1,v.h||v);if(!je)break;v.g[je.key]=je}v=u.H?F(u.H):{},u.m?(u.u||(u.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,v)):(u.u="GET",u.g.ea(u.A,u.u,null,v)),ha(),ms(u.i,u.u,u.A,u.l,u.R,u.m)}ue.prototype.ca=function(u){u=u.target;const v=this.M;v&&wi(u)==3?v.j():this.Y(u)},ue.prototype.Y=function(u){try{if(u==this.g)e:{const pn=wi(this.g);var v=this.g.Ba();const ro=this.g.Z();if(!(3>pn)&&(pn!=3||this.g&&(this.h.h||this.g.oa()||Yi(this.g)))){this.J||pn!=4||v==7||(v==8||0>=ro?ha(3):ha(2)),Mt(this);var k=this.g.Z();this.X=k;t:if(Oe(this)){var O=Yi(this.g);u="";var ne=O.length,fe=wi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ft(this),Nt(this);var je="";break t}this.h.i=new o.TextDecoder}for(v=0;v<ne;v++)this.h.h=!0,u+=this.h.i.decode(O[v],{stream:!(fe&&v==ne-1)});O.length=0,this.h.g+=u,this.C=0,je=this.h.g}else je=this.g.oa();if(this.o=k==200,Su(this.i,this.u,this.A,this.l,this.R,pn,k),this.o){if(this.T&&!this.K){t:{if(this.g){var Wt,rn=this.g;if((Wt=rn.g?rn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(Wt)){var It=Wt;break t}}It=null}if(k=It)I(this.i,this.l,k,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ii(this,k);else{this.o=!1,this.s=3,Gr(12),Ft(this),Nt(this);break e}}if(this.P){k=!0;let Di;for(;!this.J&&this.C<je.length;)if(Di=Ie(this,je),Di==le){pn==4&&(this.s=4,Gr(14),k=!1),I(this.i,this.l,null,"[Incomplete Response]");break}else if(Di==te){this.s=4,Gr(15),I(this.i,this.l,je,"[Invalid Chunk]"),k=!1;break}else I(this.i,this.l,Di,null),ii(this,Di);if(Oe(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),pn!=4||je.length!=0||this.h.h||(this.s=1,Gr(16),k=!1),this.o=this.o&&k,!k)I(this.i,this.l,je,"[Invalid Chunked Response]"),Ft(this),Nt(this);else if(0<je.length&&!this.W){this.W=!0;var hn=this.j;hn.g==this&&hn.ba&&!hn.M&&(hn.j.info("Great, no buffering proxy detected. Bytes received: "+je.length),ya(hn),hn.M=!0,Gr(11))}}else I(this.i,this.l,je,null),ii(this,je);pn==4&&Ft(this),this.o&&!this.J&&(pn==4?X0(this.j,this):(this.o=!1,ze(this)))}else W0(this.g),k==400&&0<je.indexOf("Unknown SID")?(this.s=3,Gr(12)):(this.s=0,Gr(13)),Ft(this),Nt(this)}}}catch{}finally{}};function Oe(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function Ie(u,v){var k=u.C,O=v.indexOf(`
`,k);return O==-1?le:(k=Number(v.substring(k,O)),isNaN(k)?te:(O+=1,O+k>v.length?le:(v=v.slice(O,O+k),u.C=O+k,v)))}ue.prototype.cancel=function(){this.J=!0,Ft(this)};function ze(u){u.S=Date.now()+u.I,et(u,u.I)}function et(u,v){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Ln(p(u.ba,u),v)}function Mt(u){u.B&&(o.clearTimeout(u.B),u.B=null)}ue.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(V(this.i,this.A),this.L!=2&&(ha(),Gr(17)),Ft(this),this.s=2,Nt(this)):et(this,this.S-u)};function Nt(u){u.j.G==0||u.J||X0(u.j,u)}function Ft(u){Mt(u);var v=u.M;v&&typeof v.ma=="function"&&v.ma(),u.M=null,ni(u.U),u.g&&(v=u.g,u.g=null,v.abort(),v.ma())}function ii(u,v){try{var k=u.j;if(k.G!=0&&(k.g==u||Yr(k.h,u))){if(!u.K&&Yr(k.h,u)&&k.G==3){try{var O=k.Da.g.parse(v)}catch{O=null}if(Array.isArray(O)&&O.length==3){var ne=O;if(ne[0]==0){e:if(!k.u){if(k.g)if(k.g.F+3e3<u.F)ic(k),dn(k);else break e;nl(k),Gr(18)}}else k.za=ne[1],0<k.za-k.T&&37500>ne[2]&&k.F&&k.v==0&&!k.C&&(k.C=Ln(p(k.Za,k),6e3));if(1>=gs(k.h)&&k.ca){try{k.ca()}catch{}k.ca=void 0}}else _a(k,11)}else if((u.K||k.g==u)&&ic(k),!A(v))for(ne=k.Da.g.parse(v),v=0;v<ne.length;v++){let It=ne[v];if(k.T=It[0],It=It[1],k.G==2)if(It[0]=="c"){k.K=It[1],k.ia=It[2];const hn=It[3];hn!=null&&(k.la=hn,k.j.info("VER="+k.la));const pn=It[4];pn!=null&&(k.Aa=pn,k.j.info("SVER="+k.Aa));const ro=It[5];ro!=null&&typeof ro=="number"&&0<ro&&(O=1.5*ro,k.L=O,k.j.info("backChannelRequestTimeoutMs_="+O)),O=k;const Di=u.g;if(Di){const ac=Di.g?Di.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ac){var fe=O.h;fe.g||ac.indexOf("spdy")==-1&&ac.indexOf("quic")==-1&&ac.indexOf("h2")==-1||(fe.j=fe.l,fe.g=new Set,fe.h&&(Ls(fe,fe.h),fe.h=null))}if(O.D){const Nu=Di.g?Di.g.getResponseHeader("X-HTTP-Session-Id"):null;Nu&&(O.ya=Nu,qt(O.I,O.D,Nu))}}k.G=3,k.l&&k.l.ua(),k.ba&&(k.R=Date.now()-u.F,k.j.info("Handshake RTT: "+k.R+"ms")),O=k;var je=u;if(O.qa=q0(O,O.J?O.ia:null,O.W),je.K){ql(O.h,je);var Wt=je,rn=O.L;rn&&(Wt.I=rn),Wt.B&&(Mt(Wt),ze(Wt)),O.g=je}else G0(O);0<k.i.length&&qi(k)}else It[0]!="stop"&&It[0]!="close"||_a(k,7);else k.G==3&&(It[0]=="stop"||It[0]=="close"?It[0]=="stop"?_a(k,7):Qt(k):It[0]!="noop"&&k.l&&k.l.ta(It),k.v=0)}}ha(4)}catch{}}var Kr=class{constructor(u,v){this.g=u,this.map=v}};function _i(u){this.l=u||10,o.PerformanceNavigationTiming?(u=o.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Xr(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function gs(u){return u.h?1:u.g?u.g.size:0}function Yr(u,v){return u.h?u.h==v:u.g?u.g.has(v):!1}function Ls(u,v){u.g?u.g.add(v):u.h=v}function ql(u,v){u.h&&u.h==v?u.h=null:u.g&&u.g.has(v)&&u.g.delete(v)}_i.prototype.cancel=function(){if(this.i=Qo(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function Qo(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let v=u.i;for(const k of u.g.values())v=v.concat(k.D);return v}return x(u.i)}function Ei(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var v=[],k=u.length,O=0;O<k;O++)v.push(u[O]);return v}v=[],k=0;for(O in u)v[k++]=u[O];return v}function Ql(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var v=[];u=u.length;for(var k=0;k<u;k++)v.push(k);return v}v=[],k=0;for(const O in u)v[k++]=O;return v}}}function si(u,v){if(u.forEach&&typeof u.forEach=="function")u.forEach(v,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,v,void 0);else for(var k=Ql(u),O=Ei(u),ne=O.length,fe=0;fe<ne;fe++)v.call(void 0,O[fe],k&&k[fe],u)}var Jo=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Bs(u,v){if(u){u=u.split("&");for(var k=0;k<u.length;k++){var O=u[k].indexOf("="),ne=null;if(0<=O){var fe=u[k].substring(0,O);ne=u[k].substring(O+1)}else fe=u[k];v(fe,ne?decodeURIComponent(ne.replace(/\+/g," ")):"")}}}function xs(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof xs){this.h=u.h,pa(this,u.j),this.o=u.o,this.g=u.g,Jl(this,u.s),this.l=u.l;var v=u.i,k=new Za;k.i=v.i,v.g&&(k.g=new Map(v.g),k.h=v.h),Zo(this,k),this.m=u.m}else u&&(v=String(u).match(Jo))?(this.h=!1,pa(this,v[1]||"",!0),this.o=lt(v[2]||""),this.g=lt(v[3]||"",!0),Jl(this,v[4]),this.l=lt(v[5]||"",!0),Zo(this,v[6]||"",!0),this.m=lt(v[7]||"")):(this.h=!1,this.i=new Za(null,this.h))}xs.prototype.toString=function(){var u=[],v=this.j;v&&u.push(vs(v,ma,!0),":");var k=this.g;return(k||v=="file")&&(u.push("//"),(v=this.o)&&u.push(vs(v,ma,!0),"@"),u.push(encodeURIComponent(String(k)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.s,k!=null&&u.push(":",String(k))),(k=this.l)&&(this.g&&k.charAt(0)!="/"&&u.push("/"),u.push(vs(k,k.charAt(0)=="/"?j0:B0,!0))),(k=this.i.toString())&&u.push("?",k),(k=this.m)&&u.push("#",vs(k,V0)),u.join("")};function ir(u){return new xs(u)}function pa(u,v,k){u.j=k?lt(v,!0):v,u.j&&(u.j=u.j.replace(/:$/,""))}function Jl(u,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);u.s=v}else u.s=null}function Zo(u,v,k){v instanceof Za?(u.i=v,Ri(u.i,u.h)):(k||(v=vs(v,Au)),u.i=new Za(v,u.h))}function qt(u,v,k){u.i.set(v,k)}function Ja(u){return qt(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function lt(u,v){return u?v?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function vs(u,v,k){return typeof u=="string"?(u=encodeURI(u).replace(v,gr),k&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function gr(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var ma=/[#\/\?@]/g,B0=/[#\?:]/g,j0=/[#\?]/g,Au=/[#\?@]/g,V0=/#/g;function Za(u,v){this.h=this.g=null,this.i=u||null,this.j=!!v}function ys(u){u.g||(u.g=new Map,u.h=0,u.i&&Bs(u.i,function(v,k){u.add(decodeURIComponent(v.replace(/\+/g," ")),k)}))}t=Za.prototype,t.add=function(u,v){ys(this),this.i=null,u=Rr(this,u);var k=this.g.get(u);return k||this.g.set(u,k=[]),k.push(v),this.h+=1,this};function eo(u,v){ys(u),v=Rr(u,v),u.g.has(v)&&(u.i=null,u.h-=u.g.get(v).length,u.g.delete(v))}function ku(u,v){return ys(u),v=Rr(u,v),u.g.has(v)}t.forEach=function(u,v){ys(this),this.g.forEach(function(k,O){k.forEach(function(ne){u.call(v,ne,O,this)},this)},this)},t.na=function(){ys(this);const u=Array.from(this.g.values()),v=Array.from(this.g.keys()),k=[];for(let O=0;O<v.length;O++){const ne=u[O];for(let fe=0;fe<ne.length;fe++)k.push(v[O])}return k},t.V=function(u){ys(this);let v=[];if(typeof u=="string")ku(this,u)&&(v=v.concat(this.g.get(Rr(this,u))));else{u=Array.from(this.g.values());for(let k=0;k<u.length;k++)v=v.concat(u[k])}return v},t.set=function(u,v){return ys(this),this.i=null,u=Rr(this,u),ku(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[v]),this.h+=1,this},t.get=function(u,v){return u?(u=this.V(u),0<u.length?String(u[0]):v):v};function Cu(u,v,k){eo(u,v),0<k.length&&(u.i=null,u.g.set(Rr(u,v),x(k)),u.h+=k.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],v=Array.from(this.g.keys());for(var k=0;k<v.length;k++){var O=v[k];const fe=encodeURIComponent(String(O)),je=this.V(O);for(O=0;O<je.length;O++){var ne=fe;je[O]!==""&&(ne+="="+encodeURIComponent(String(je[O]))),u.push(ne)}}return this.i=u.join("&")};function Rr(u,v){return v=String(v),u.j&&(v=v.toLowerCase()),v}function Ri(u,v){v&&!u.j&&(ys(u),u.i=null,u.g.forEach(function(k,O){var ne=O.toLowerCase();O!=ne&&(eo(this,O),Cu(this,ne,k))},u)),u.j=v}function Zl(u,v){const k=new Bn;if(o.Image){const O=new Image;O.onload=g(_s,k,"TestLoadImage: loaded",!0,v,O),O.onerror=g(_s,k,"TestLoadImage: error",!1,v,O),O.onabort=g(_s,k,"TestLoadImage: abort",!1,v,O),O.ontimeout=g(_s,k,"TestLoadImage: timeout",!1,v,O),o.setTimeout(function(){O.ontimeout&&O.ontimeout()},1e4),O.src=u}else v(!1)}function ec(u,v){const k=new Bn,O=new AbortController,ne=setTimeout(()=>{O.abort(),_s(k,"TestPingServer: timeout",!1,v)},1e4);fetch(u,{signal:O.signal}).then(fe=>{clearTimeout(ne),fe.ok?_s(k,"TestPingServer: ok",!0,v):_s(k,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(ne),_s(k,"TestPingServer: error",!1,v)})}function _s(u,v,k,O,ne){try{ne&&(ne.onload=null,ne.onerror=null,ne.onabort=null,ne.ontimeout=null),O(k)}catch{}}function tc(){this.g=new se}function Ni(u,v,k){const O=k||"";try{si(u,function(ne,fe){let je=ne;c(ne)&&(je=qa(ne)),v.push(O+fe+"="+encodeURIComponent(je))})}catch(ne){throw v.push(O+"type="+encodeURIComponent("_badmap")),ne}}function Es(u){this.l=u.Ub||null,this.j=u.eb||!1}y(Es,wr),Es.prototype.g=function(){return new er(this.l,this.j)},Es.prototype.i=function(u){return function(){return u}}({});function er(u,v){zt.call(this),this.D=u,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(er,zt),t=er.prototype,t.open=function(u,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=v,this.readyState=1,js(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(v.body=u),(this.D||o).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,xa(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,js(this)),this.g&&(this.readyState=3,js(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ga(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function ga(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var v=u.value?u.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!u.done}))&&(this.response=this.responseText+=v)}u.done?xa(this):js(this),this.readyState==3&&ga(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,xa(this))},t.Qa=function(u){this.g&&(this.response=u,xa(this))},t.ga=function(){this.g&&xa(this)};function xa(u){u.readyState=4,u.l=null,u.j=null,u.v=null,js(u)}t.setRequestHeader=function(u,v){this.u.append(u,v)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],v=this.h.entries();for(var k=v.next();!k.done;)k=k.value,u.push(k[0]+": "+k[1]),k=v.next();return u.join(`\r
`)};function js(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(er.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Vs(u){let v="";return j(u,function(k,O){v+=O,v+=":",v+=k,v+=`\r
`}),v}function rc(u,v,k){e:{for(O in k){var O=!1;break e}O=!0}O||(k=Vs(k),typeof u=="string"?k!=null&&encodeURIComponent(String(k)):qt(u,v,k))}function sr(u){zt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(sr,zt);var Qp=/^https?$/i,el=["POST","PUT"];t=sr.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,v,k,O){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);v=v?v.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():B.g(),this.v=this.o?ps(this.o):ps(B),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(v,String(u),!0),this.B=!1}catch(fe){Fu(this,fe);return}if(u=k||"",k=new Map(this.headers),O)if(Object.getPrototypeOf(O)===Object.prototype)for(var ne in O)k.set(ne,O[ne]);else if(typeof O.keys=="function"&&typeof O.get=="function")for(const fe of O.keys())k.set(fe,O.get(fe));else throw Error("Unknown input type for opt_headers: "+String(O));O=Array.from(k.keys()).find(fe=>fe.toLowerCase()=="content-type"),ne=o.FormData&&u instanceof o.FormData,!(0<=Array.prototype.indexOf.call(el,v,void 0))||O||ne||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[fe,je]of k)this.g.setRequestHeader(fe,je);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{z0(this),this.u=!0,this.g.send(u),this.u=!1}catch(fe){Fu(this,fe)}};function Fu(u,v){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=v,u.m=5,ws(u),nc(u)}function ws(u){u.A||(u.A=!0,_r(u,"complete"),_r(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,_r(this,"complete"),_r(this,"abort"),nc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),nc(this,!0)),sr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?U0(this):this.bb())},t.bb=function(){U0(this)};function U0(u){if(u.h&&typeof a<"u"&&(!u.v[1]||wi(u)!=4||u.Z()!=2)){if(u.u&&wi(u)==4)ri(u.Ea,0,u);else if(_r(u,"readystatechange"),wi(u)==4){u.h=!1;try{const je=u.Z();e:switch(je){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var k;if(!(k=v)){var O;if(O=je===0){var ne=String(u.D).match(Jo)[1]||null;!ne&&o.self&&o.self.location&&(ne=o.self.location.protocol.slice(0,-1)),O=!Qp.test(ne?ne.toLowerCase():"")}k=O}if(k)_r(u,"complete"),_r(u,"success");else{u.m=6;try{var fe=2<wi(u)?u.g.statusText:""}catch{fe=""}u.l=fe+" ["+u.Z()+"]",ws(u)}}finally{nc(u)}}}}function nc(u,v){if(u.g){z0(u);const k=u.g,O=u.v[0]?()=>{}:null;u.g=null,u.v=null,v||_r(u,"ready");try{k.onreadystatechange=O}catch{}}}function z0(u){u.I&&(o.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function wi(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<wi(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var v=this.g.responseText;return u&&v.indexOf(u)==0&&(v=v.substring(u.length)),ca(v)}};function Yi(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function W0(u){const v={};u=(u.g&&2<=wi(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let O=0;O<u.length;O++){if(A(u[O]))continue;var k=N(u[O]);const ne=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const fe=v[ne]||[];v[ne]=fe,fe.push(k)}w(v,function(O){return O.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function va(u,v,k){return k&&k.internalChannelParams&&k.internalChannelParams[u]||v}function H0(u){this.Aa=0,this.i=[],this.j=new Bn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=va("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=va("baseRetryDelayMs",5e3,u),this.cb=va("retryDelaySeedMs",1e4,u),this.Wa=va("forwardChannelMaxRetries",2,u),this.wa=va("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new _i(u&&u.concurrentRequestLimit),this.Da=new tc,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=H0.prototype,t.la=8,t.G=1,t.connect=function(u,v,k,O){Gr(0),this.W=u,this.H=v||{},k&&O!==void 0&&(this.H.OSID=k,this.H.OAID=O),this.F=this.X,this.I=q0(this,null,this.W),qi(this)};function Qt(u){if(tl(u),u.G==3){var v=u.U++,k=ir(u.I);if(qt(k,"SID",u.K),qt(k,"RID",v),qt(k,"TYPE","terminate"),rl(u,k),v=new ue(u,u.j,v),v.L=2,v.v=Ja(ir(k)),k=!1,o.navigator&&o.navigator.sendBeacon)try{k=o.navigator.sendBeacon(v.v.toString(),"")}catch{}!k&&o.Image&&(new Image().src=v.v,k=!0),k||(v.g=Ru(v.j,null),v.g.ea(v.v)),v.F=Date.now(),ze(v)}bu(u)}function dn(u){u.g&&(ya(u),u.g.cancel(),u.g=null)}function tl(u){dn(u),u.u&&(o.clearTimeout(u.u),u.u=null),ic(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&o.clearTimeout(u.s),u.s=null)}function qi(u){if(!Xr(u.h)&&!u.s){u.s=!0;var v=u.Ga;Ae||Ce(),Ee||(Ae(),Ee=!0),Z.add(v,u),u.B=0}}function Iu(u,v){return gs(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=v.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Ln(p(u.Ga,u,v),Y0(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const ne=new ue(this,this.j,u);let fe=this.o;if(this.S&&(fe?(fe=F(fe),b(fe,this.S)):fe=this.S),this.m!==null||this.O||(ne.H=fe,fe=null),this.P)e:{for(var v=0,k=0;k<this.i.length;k++){t:{var O=this.i[k];if("__data__"in O.map&&(O=O.map.__data__,typeof O=="string")){O=O.length;break t}O=void 0}if(O===void 0)break;if(v+=O,4096<v){v=k;break e}if(v===4096||k===this.i.length-1){v=k+1;break e}}v=1e3}else v=1e3;v=Us(this,ne,v),k=ir(this.I),qt(k,"RID",u),qt(k,"CVER",22),this.D&&qt(k,"X-HTTP-Session-Id",this.D),rl(this,k),fe&&(this.O?v="headers="+encodeURIComponent(String(Vs(fe)))+"&"+v:this.m&&rc(k,this.m,fe)),Ls(this.h,ne),this.Ua&&qt(k,"TYPE","init"),this.P?(qt(k,"$req",v),qt(k,"SID","null"),ne.T=!0,pe(ne,k,null)):pe(ne,k,v),this.G=2}}else this.G==3&&(u?$0(this,u):this.i.length==0||Xr(this.h)||$0(this))};function $0(u,v){var k;v?k=v.l:k=u.U++;const O=ir(u.I);qt(O,"SID",u.K),qt(O,"RID",k),qt(O,"AID",u.T),rl(u,O),u.m&&u.o&&rc(O,u.m,u.o),k=new ue(u,u.j,k,u.B+1),u.m===null&&(k.H=u.o),v&&(u.i=v.D.concat(u.i)),v=Us(u,k,1e3),k.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Ls(u.h,k),pe(k,O,v)}function rl(u,v){u.H&&j(u.H,function(k,O){qt(v,O,k)}),u.l&&si({},function(k,O){qt(v,O,k)})}function Us(u,v,k){k=Math.min(u.i.length,k);var O=u.l?p(u.l.Na,u.l,u):null;e:{var ne=u.i;let fe=-1;for(;;){const je=["count="+k];fe==-1?0<k?(fe=ne[0].g,je.push("ofs="+fe)):fe=0:je.push("ofs="+fe);let Wt=!0;for(let rn=0;rn<k;rn++){let It=ne[rn].g;const hn=ne[rn].map;if(It-=fe,0>It)fe=Math.max(0,ne[rn].g-100),Wt=!1;else try{Ni(hn,je,"req"+It+"_")}catch{O&&O(hn)}}if(Wt){O=je.join("&");break e}}}return u=u.i.splice(0,k),v.D=u,O}function G0(u){if(!u.g&&!u.u){u.Y=1;var v=u.Fa;Ae||Ce(),Ee||(Ae(),Ee=!0),Z.add(v,u),u.v=0}}function nl(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Ln(p(u.Fa,u),Y0(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,K0(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Ln(p(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Gr(10),dn(this),K0(this))};function ya(u){u.A!=null&&(o.clearTimeout(u.A),u.A=null)}function K0(u){u.g=new ue(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var v=ir(u.qa);qt(v,"RID","rpc"),qt(v,"SID",u.K),qt(v,"AID",u.T),qt(v,"CI",u.F?"0":"1"),!u.F&&u.ja&&qt(v,"TO",u.ja),qt(v,"TYPE","xmlhttp"),rl(u,v),u.m&&u.o&&rc(v,u.m,u.o),u.L&&(u.g.I=u.L);var k=u.g;u=u.ia,k.L=1,k.v=Ja(ir(v)),k.m=null,k.P=!0,De(k,u)}t.Za=function(){this.C!=null&&(this.C=null,dn(this),nl(this),Gr(19))};function ic(u){u.C!=null&&(o.clearTimeout(u.C),u.C=null)}function X0(u,v){var k=null;if(u.g==v){ic(u),ya(u),u.g=null;var O=2}else if(Yr(u.h,v))k=v.D,ql(u.h,v),O=1;else return;if(u.G!=0){if(v.o)if(O==1){k=v.m?v.m.length:0,v=Date.now()-v.F;var ne=u.B;O=fa(),_r(O,new tr(O,k)),qi(u)}else G0(u);else if(ne=v.s,ne==3||ne==0&&0<v.X||!(O==1&&Iu(u,v)||O==2&&nl(u)))switch(k&&0<k.length&&(v=u.h,v.i=v.i.concat(k)),ne){case 1:_a(u,5);break;case 4:_a(u,10);break;case 3:_a(u,6);break;default:_a(u,2)}}}function Y0(u,v){let k=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(k*=2),k*v}function _a(u,v){if(u.j.info("Error code "+v),v==2){var k=p(u.fb,u),O=u.Xa;const ne=!O;O=new xs(O||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||pa(O,"https"),Ja(O),ne?Zl(O.toString(),k):ec(O.toString(),k)}else Gr(2);u.G=0,u.l&&u.l.sa(v),bu(u),tl(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),Gr(2)):(this.j.info("Failed to ping google.com"),Gr(1))};function bu(u){if(u.G=0,u.ka=[],u.l){const v=Qo(u.h);(v.length!=0||u.i.length!=0)&&(E(u.ka,v),E(u.ka,u.i),u.h.i.length=0,x(u.i),u.i.length=0),u.l.ra()}}function q0(u,v,k){var O=k instanceof xs?ir(k):new xs(k);if(O.g!="")v&&(O.g=v+"."+O.g),Jl(O,O.s);else{var ne=o.location;O=ne.protocol,v=v?v+"."+ne.hostname:ne.hostname,ne=+ne.port;var fe=new xs(null);O&&pa(fe,O),v&&(fe.g=v),ne&&Jl(fe,ne),k&&(fe.l=k),O=fe}return k=u.D,v=u.ya,k&&v&&qt(O,k,v),qt(O,"VER",u.la),rl(u,O),O}function Ru(u,v,k){if(v&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=u.Ca&&!u.pa?new sr(new Es({eb:k})):new sr(u.pa),v.Ha(u.J),v}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Q0(){}t=Q0.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function sc(){}sc.prototype.g=function(u,v){return new wn(u,v)};function wn(u,v){zt.call(this),this.g=new H0(v),this.l=u,this.h=v&&v.messageUrlParams||null,u=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(u?u["X-WebChannel-Content-Type"]=v.messageContentType:u={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(u?u["X-WebChannel-Client-Profile"]=v.va:u={"X-WebChannel-Client-Profile":v.va}),this.g.S=u,(u=v&&v.Sb)&&!A(u)&&(this.g.m=u),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!A(v)&&(this.g.D=v,u=this.h,u!==null&&v in u&&(u=this.h,v in u&&delete u[v])),this.j=new to(this)}y(wn,zt),wn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},wn.prototype.close=function(){Qt(this.g)},wn.prototype.o=function(u){var v=this.g;if(typeof u=="string"){var k={};k.__data__=u,u=k}else this.u&&(k={},k.__data__=qa(u),u=k);v.i.push(new Kr(v.Ya++,u)),v.G==3&&qi(v)},wn.prototype.N=function(){this.g.l=null,delete this.j,Qt(this.g),delete this.g,wn.aa.N.call(this)};function J0(u){ua.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var v=u.__sm__;if(v){e:{for(const k in v){u=k;break e}u=void 0}(this.i=u)&&(u=this.i,v=v!==null&&u in v?v[u]:void 0),this.data=v}else this.data=u}y(J0,ua);function Z0(){yi.call(this),this.status=1}y(Z0,yi);function to(u){this.g=u}y(to,Q0),to.prototype.ua=function(){_r(this.g,"a")},to.prototype.ta=function(u){_r(this.g,new J0(u))},to.prototype.sa=function(u){_r(this.g,new Z0)},to.prototype.ra=function(){_r(this.g,"b")},sc.prototype.createWebChannel=sc.prototype.g,wn.prototype.send=wn.prototype.o,wn.prototype.open=wn.prototype.m,wn.prototype.close=wn.prototype.close,Bk=function(){return new sc},Lk=function(){return fa()},Mk=On,dx={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},L.NO_ERROR=0,L.TIMEOUT=8,L.HTTP_ERROR=6,rh=L,z.COMPLETE="complete",Ok=z,Qa.EventType=Xi,Xi.OPEN="a",Xi.CLOSE="b",Xi.ERROR="c",Xi.MESSAGE="d",zt.prototype.listen=zt.prototype.K,ef=Qa,sr.prototype.listenOnce=sr.prototype.L,sr.prototype.getLastError=sr.prototype.Ka,sr.prototype.getLastErrorCode=sr.prototype.Ba,sr.prototype.getStatus=sr.prototype.Z,sr.prototype.getResponseJson=sr.prototype.Oa,sr.prototype.getResponseText=sr.prototype.oa,sr.prototype.send=sr.prototype.ea,sr.prototype.setWithCredentials=sr.prototype.Ha,Pk=sr}).apply(typeof Ld<"u"?Ld:typeof self<"u"?self:typeof window<"u"?window:{});const eE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}$n.UNAUTHENTICATED=new $n(null),$n.GOOGLE_CREDENTIALS=new $n("google-credentials-uid"),$n.FIRST_PARTY=new $n("first-party-uid"),$n.MOCK_USER=new $n("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yu="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ml=new fv("@firebase/firestore");function Gu(){return Ml.logLevel}function Qe(t,...e){if(Ml.logLevel<=kt.DEBUG){const r=e.map(pv);Ml.debug(`Firestore (${yu}): ${t}`,...r)}}function Ua(t,...e){if(Ml.logLevel<=kt.ERROR){const r=e.map(pv);Ml.error(`Firestore (${yu}): ${t}`,...r)}}function nu(t,...e){if(Ml.logLevel<=kt.WARN){const r=e.map(pv);Ml.warn(`Firestore (${yu}): ${t}`,...r)}}function pv(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ht(t="Unexpected state"){const e=`FIRESTORE (${yu}) INTERNAL ASSERTION FAILED: `+t;throw Ua(e),new Error(e)}function Xt(t,e){t||ht()}function gt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Re={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class rt extends Ya{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jk{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Ij{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r($n.UNAUTHENTICATED))}shutdown(){}}class bj{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class Rj{constructor(e){this.t=e,this.currentUser=$n.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Xt(this.o===void 0);let n=this.i;const i=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let s=new Po;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Po,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{Qe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Qe("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Po)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Qe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Xt(typeof n.accessToken=="string"),new jk(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Xt(e===null||typeof e=="string"),new $n(e)}}class Nj{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=$n.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Dj{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new Nj(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r($n.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Pj{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Oj{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){Xt(this.o===void 0);const n=s=>{s.error!=null&&Qe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,Qe("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{Qe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Qe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Xt(typeof r.token=="string"),this.R=r.token,new Pj(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mj(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=Mj(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=e.charAt(i[s]%e.length))}return n}}function Bt(t,e){return t<e?-1:t>e?1:0}function iu(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new rt(Re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new rt(Re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new rt(Re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new rt(Re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return cn.fromMillis(Date.now())}static fromDate(e){return cn.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new cn(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Bt(this.nanoseconds,e.nanoseconds):Bt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new mt(e)}static min(){return new mt(new cn(0,0))}static max(){return new mt(new cn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0{constructor(e,r,n){r===void 0?r=0:r>e.length&&ht(),n===void 0?n=e.length-r:n>e.length-r&&ht(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return s0.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof s0?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const s=e.get(i),a=r.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class Br extends s0{construct(e,r,n){return new Br(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new rt(Re.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Br(r)}static emptyPath(){return new Br([])}}const Lj=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class bn extends s0{construct(e,r,n){return new bn(e,r,n)}static isValidIdentifier(e){return Lj.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),bn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new bn(["__name__"])}static fromServerFormat(e){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new rt(Re.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new rt(Re.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new rt(Re.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new rt(Re.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new bn(r)}static emptyPath(){return new bn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{constructor(e){this.path=e}static fromPath(e){return new st(Br.fromString(e))}static fromName(e){return new st(Br.fromString(e).popFirst(5))}static empty(){return new st(Br.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Br.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Br.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new st(new Br(e.slice()))}}function Bj(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=mt.fromTimestamp(n===1e9?new cn(r+1,0):new cn(r,n));return new zo(i,st.empty(),e)}function jj(t){return new zo(t.readTime,t.key,-1)}class zo{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new zo(mt.min(),st.empty(),-1)}static max(){return new zo(mt.max(),st.empty(),-1)}}function Vj(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=st.comparator(t.documentKey,e.documentKey),r!==0?r:Bt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uj="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class zj{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I0(t){if(t.code!==Re.FAILED_PRECONDITION||t.message!==Uj)throw t;Qe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&ht(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Fe((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Fe?r:Fe.resolve(r)}catch(r){return Fe.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Fe.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Fe.reject(r)}static resolve(e){return new Fe((r,n)=>{r(e)})}static reject(e){return new Fe((r,n)=>{n(e)})}static waitFor(e){return new Fe((r,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},l=>n(l))}),a=!0,s===i&&r()})}static or(e){let r=Fe.resolve(!1);for(const n of e)r=r.next(i=>i?Fe.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(e,r){return new Fe((n,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const c=l;r(e[c]).next(d=>{a[c]=d,++o,o===s&&n(a)},d=>i(d))}})}static doWhile(e,r){return new Fe((n,i)=>{const s=()=>{e()===!0?r().next(()=>{s()},i):n()};s()})}}function Wj(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function b0(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mv{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}mv.oe=-1;function Lp(t){return t==null}function Qh(t){return t===0&&1/t==-1/0}function Hj(t){return typeof t=="number"&&Number.isInteger(t)&&!Qh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tE(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function _u(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function Uk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(e,r){this.comparator=e,this.root=r||Cn.EMPTY}insert(e,r){return new Ir(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Cn.BLACK,null,null))}remove(e){return new Ir(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Cn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Bd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Bd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Bd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Bd(this.root,e,this.comparator,!0)}}class Bd{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Cn{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n??Cn.RED,this.left=i??Cn.EMPTY,this.right=s??Cn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,s){return new Cn(e??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Cn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return Cn.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Cn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Cn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ht();const e=this.left.check();if(e!==this.right.check())throw ht();return e+(this.isRed()?0:1)}}Cn.EMPTY=null,Cn.RED=!0,Cn.BLACK=!1;Cn.EMPTY=new class{constructor(){this.size=0}get key(){throw ht()}get value(){throw ht()}get color(){throw ht()}get left(){throw ht()}get right(){throw ht()}copy(e,r,n,i,s){return this}insert(e,r,n){return new Cn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e){this.comparator=e,this.data=new Ir(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new rE(this.data.getIterator())}getIteratorFrom(e){return new rE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Nn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Nn(this.comparator);return r.data=e,r}}class rE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(e){this.fields=e,e.sort(bn.comparator)}static empty(){return new bs([])}unionWith(e){let r=new Nn(bn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new bs(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return iu(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zk extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new zk("Invalid base64 string: "+s):s}}(e);return new Pn(r)}static fromUint8Array(e){const r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new Pn(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Bt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Pn.EMPTY_BYTE_STRING=new Pn("");const $j=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Wo(t){if(Xt(!!t),typeof t=="string"){let e=0;const r=$j.exec(t);if(Xt(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:zr(t.seconds),nanos:zr(t.nanos)}}function zr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ll(t){return typeof t=="string"?Pn.fromBase64String(t):Pn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gv(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function xv(t){const e=t.mapValue.fields.__previous_value__;return gv(e)?xv(e):e}function a0(t){const e=Wo(t.mapValue.fields.__local_write_time__.timestampValue);return new cn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gj{constructor(e,r,n,i,s,a,o,l,c){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class o0{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new o0("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof o0&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jd={mapValue:{}};function Bl(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?gv(t)?4:Xj(t)?9007199254740991:Kj(t)?10:11:ht()}function sa(t,e){if(t===e)return!0;const r=Bl(t);if(r!==Bl(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return a0(t).isEqual(a0(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=Wo(i.timestampValue),o=Wo(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Ll(i.bytesValue).isEqual(Ll(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return zr(i.geoPointValue.latitude)===zr(s.geoPointValue.latitude)&&zr(i.geoPointValue.longitude)===zr(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return zr(i.integerValue)===zr(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=zr(i.doubleValue),o=zr(s.doubleValue);return a===o?Qh(a)===Qh(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return iu(t.arrayValue.values||[],e.arrayValue.values||[],sa);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(tE(a)!==tE(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!sa(a[l],o[l])))return!1;return!0}(t,e);default:return ht()}}function l0(t,e){return(t.values||[]).find(r=>sa(r,e))!==void 0}function su(t,e){if(t===e)return 0;const r=Bl(t),n=Bl(e);if(r!==n)return Bt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Bt(t.booleanValue,e.booleanValue);case 2:return function(s,a){const o=zr(s.integerValue||s.doubleValue),l=zr(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return nE(t.timestampValue,e.timestampValue);case 4:return nE(a0(t),a0(e));case 5:return Bt(t.stringValue,e.stringValue);case 6:return function(s,a){const o=Ll(s),l=Ll(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const d=Bt(o[c],l[c]);if(d!==0)return d}return Bt(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const o=Bt(zr(s.latitude),zr(a.latitude));return o!==0?o:Bt(zr(s.longitude),zr(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return iE(t.arrayValue,e.arrayValue);case 10:return function(s,a){var o,l,c,d;const h=s.fields||{},p=a.fields||{},g=(o=h.value)===null||o===void 0?void 0:o.arrayValue,y=(l=p.value)===null||l===void 0?void 0:l.arrayValue,x=Bt(((c=g==null?void 0:g.values)===null||c===void 0?void 0:c.length)||0,((d=y==null?void 0:y.values)===null||d===void 0?void 0:d.length)||0);return x!==0?x:iE(g,y)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===jd.mapValue&&a===jd.mapValue)return 0;if(s===jd.mapValue)return 1;if(a===jd.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),c=a.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let h=0;h<l.length&&h<d.length;++h){const p=Bt(l[h],d[h]);if(p!==0)return p;const g=su(o[l[h]],c[d[h]]);if(g!==0)return g}return Bt(l.length,d.length)}(t.mapValue,e.mapValue);default:throw ht()}}function nE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Bt(t,e);const r=Wo(t),n=Wo(e),i=Bt(r.seconds,n.seconds);return i!==0?i:Bt(r.nanos,n.nanos)}function iE(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const s=su(r[i],n[i]);if(s)return s}return Bt(r.length,n.length)}function au(t){return hx(t)}function hx(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Wo(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Ll(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return st.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=hx(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${hx(r.fields[a])}`;return i+"}"}(t.mapValue):ht()}function px(t){return!!t&&"integerValue"in t}function vv(t){return!!t&&"arrayValue"in t}function sE(t){return!!t&&"nullValue"in t}function aE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function nh(t){return!!t&&"mapValue"in t}function Kj(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function wf(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return _u(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=wf(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=wf(t.arrayValue.values[r]);return e}return Object.assign({},t)}function Xj(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(e){this.value=e}static empty(){return new as({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!nh(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=wf(r)}setAll(e){let r=bn.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=wf(a):i.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(e){const r=this.field(e.popLast());nh(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return sa(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];nh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){_u(r,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new as(wf(this.value))}}function Wk(t){const e=[];return _u(t.fields,(r,n)=>{const i=new bn([r]);if(nh(n)){const s=Wk(n.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new bs(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(e,r,n,i,s,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Yn(e,0,mt.min(),mt.min(),mt.min(),as.empty(),0)}static newFoundDocument(e,r,n,i){return new Yn(e,1,r,mt.min(),n,i,0)}static newNoDocument(e,r){return new Yn(e,2,r,mt.min(),mt.min(),as.empty(),0)}static newUnknownDocument(e,r){return new Yn(e,3,r,mt.min(),mt.min(),as.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(mt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=as.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=as.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=mt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Yn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Yn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(e,r){this.position=e,this.inclusive=r}}function oE(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?n=st.comparator(st.fromName(a.referenceValue),r.key):n=su(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function lE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!sa(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zh{constructor(e,r="asc"){this.field=e,this.dir=r}}function Yj(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hk{}class on extends Hk{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new Qj(e,r,n):r==="array-contains"?new e7(e,n):r==="in"?new t7(e,n):r==="not-in"?new r7(e,n):r==="array-contains-any"?new n7(e,n):new on(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new Jj(e,n):new Zj(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(su(r,this.value)):r!==null&&Bl(this.value)===Bl(r)&&this.matchesComparison(su(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ht()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class aa extends Hk{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new aa(e,r)}matches(e){return $k(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function $k(t){return t.op==="and"}function Gk(t){return qj(t)&&$k(t)}function qj(t){for(const e of t.filters)if(e instanceof aa)return!1;return!0}function mx(t){if(t instanceof on)return t.field.canonicalString()+t.op.toString()+au(t.value);if(Gk(t))return t.filters.map(e=>mx(e)).join(",");{const e=t.filters.map(r=>mx(r)).join(",");return`${t.op}(${e})`}}function Kk(t,e){return t instanceof on?function(n,i){return i instanceof on&&n.op===i.op&&n.field.isEqual(i.field)&&sa(n.value,i.value)}(t,e):t instanceof aa?function(n,i){return i instanceof aa&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&Kk(a,i.filters[o]),!0):!1}(t,e):void ht()}function Xk(t){return t instanceof on?function(r){return`${r.field.canonicalString()} ${r.op} ${au(r.value)}`}(t):t instanceof aa?function(r){return r.op.toString()+" {"+r.getFilters().map(Xk).join(" ,")+"}"}(t):"Filter"}class Qj extends on{constructor(e,r,n){super(e,r,n),this.key=st.fromName(n.referenceValue)}matches(e){const r=st.comparator(e.key,this.key);return this.matchesComparison(r)}}class Jj extends on{constructor(e,r){super(e,"in",r),this.keys=Yk("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class Zj extends on{constructor(e,r){super(e,"not-in",r),this.keys=Yk("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function Yk(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>st.fromName(n.referenceValue))}class e7 extends on{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return vv(r)&&l0(r.arrayValue,this.value)}}class t7 extends on{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&l0(this.value.arrayValue,r)}}class r7 extends on{constructor(e,r){super(e,"not-in",r)}matches(e){if(l0(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!l0(this.value.arrayValue,r)}}class n7 extends on{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!vv(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>l0(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i7{constructor(e,r=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ue=null}}function cE(t,e=null,r=[],n=[],i=null,s=null,a=null){return new i7(t,e,r,n,i,s,a)}function yv(t){const e=gt(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>mx(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),Lp(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>au(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>au(n)).join(",")),e.ue=r}return e.ue}function _v(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!Yj(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!Kk(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!lE(t.startAt,e.startAt)&&lE(t.endAt,e.endAt)}function gx(t){return st.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bp{constructor(e,r=null,n=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function s7(t,e,r,n,i,s,a,o){return new Bp(t,e,r,n,i,s,a,o)}function jp(t){return new Bp(t)}function uE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function a7(t){return t.collectionGroup!==null}function Tf(t){const e=gt(t);if(e.ce===null){e.ce=[];const r=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Nn(bn.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Zh(s,n))}),r.has(bn.keyField().canonicalString())||e.ce.push(new Zh(bn.keyField(),n))}return e.ce}function ta(t){const e=gt(t);return e.le||(e.le=o7(e,Tf(t))),e.le}function o7(t,e){if(t.limitType==="F")return cE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Zh(i.field,s)});const r=t.endAt?new Jh(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Jh(t.startAt.position,t.startAt.inclusive):null;return cE(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function xx(t,e,r){return new Bp(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Vp(t,e){return _v(ta(t),ta(e))&&t.limitType===e.limitType}function qk(t){return`${yv(ta(t))}|lt:${t.limitType}`}function pc(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>Xk(i)).join(", ")}]`),Lp(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>au(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>au(i)).join(",")),`Target(${n})`}(ta(t))}; limitType=${t.limitType})`}function Up(t,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):st.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,i){for(const s of Tf(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,o,l){const c=oE(a,o,l);return a.inclusive?c<=0:c<0}(n.startAt,Tf(n),i)||n.endAt&&!function(a,o,l){const c=oE(a,o,l);return a.inclusive?c>=0:c>0}(n.endAt,Tf(n),i))}(t,e)}function l7(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Qk(t){return(e,r)=>{let n=!1;for(const i of Tf(t)){const s=c7(i,e,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function c7(t,e,r){const n=t.field.isKeyField()?st.comparator(e.key,r.key):function(s,a,o){const l=a.data.field(s),c=o.data.field(s);return l!==null&&c!==null?su(l,c):ht()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return ht()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eu{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){_u(this.inner,(r,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return Uk(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u7=new Ir(st.comparator);function za(){return u7}const Jk=new Ir(st.comparator);function tf(...t){let e=Jk;for(const r of t)e=e.insert(r.key,r);return e}function Zk(t){let e=Jk;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function ml(){return Sf()}function eC(){return Sf()}function Sf(){return new Eu(t=>t.toString(),(t,e)=>t.isEqual(e))}const f7=new Ir(st.comparator),d7=new Nn(st.comparator);function At(...t){let e=d7;for(const r of t)e=e.add(r);return e}const h7=new Nn(Bt);function p7(){return h7}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ev(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Qh(e)?"-0":e}}function tC(t){return{integerValue:""+t}}function m7(t,e){return Hj(e)?tC(e):Ev(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zp{constructor(){this._=void 0}}function g7(t,e,r){return t instanceof ep?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&gv(s)&&(s=xv(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(r,e):t instanceof c0?nC(t,e):t instanceof u0?iC(t,e):function(i,s){const a=rC(i,s),o=fE(a)+fE(i.Pe);return px(a)&&px(i.Pe)?tC(o):Ev(i.serializer,o)}(t,e)}function x7(t,e,r){return t instanceof c0?nC(t,e):t instanceof u0?iC(t,e):r}function rC(t,e){return t instanceof tp?function(n){return px(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class ep extends zp{}class c0 extends zp{constructor(e){super(),this.elements=e}}function nC(t,e){const r=sC(e);for(const n of t.elements)r.some(i=>sa(i,n))||r.push(n);return{arrayValue:{values:r}}}class u0 extends zp{constructor(e){super(),this.elements=e}}function iC(t,e){let r=sC(e);for(const n of t.elements)r=r.filter(i=>!sa(i,n));return{arrayValue:{values:r}}}class tp extends zp{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function fE(t){return zr(t.integerValue||t.doubleValue)}function sC(t){return vv(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function v7(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof c0&&i instanceof c0||n instanceof u0&&i instanceof u0?iu(n.elements,i.elements,sa):n instanceof tp&&i instanceof tp?sa(n.Pe,i.Pe):n instanceof ep&&i instanceof ep}(t.transform,e.transform)}class y7{constructor(e,r){this.version=e,this.transformResults=r}}class Pa{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Pa}static exists(e){return new Pa(void 0,e)}static updateTime(e){return new Pa(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ih(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Wp{}function aC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new lC(t.key,Pa.none()):new R0(t.key,t.data,Pa.none());{const r=t.data,n=as.empty();let i=new Nn(bn.comparator);for(let s of e.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new Xl(t.key,n,new bs(i.toArray()),Pa.none())}}function _7(t,e,r){t instanceof R0?function(i,s,a){const o=i.value.clone(),l=hE(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof Xl?function(i,s,a){if(!ih(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=hE(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(oC(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function Af(t,e,r,n){return t instanceof R0?function(s,a,o,l){if(!ih(s.precondition,a))return o;const c=s.value.clone(),d=pE(s.fieldTransforms,l,a);return c.setAll(d),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof Xl?function(s,a,o,l){if(!ih(s.precondition,a))return o;const c=pE(s.fieldTransforms,l,a),d=a.data;return d.setAll(oC(s)),d.setAll(c),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(s,a,o){return ih(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function E7(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),s=rC(n.transform,i||null);s!=null&&(r===null&&(r=as.empty()),r.set(n.field,s))}return r||null}function dE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&iu(n,i,(s,a)=>v7(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class R0 extends Wp{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Xl extends Wp{constructor(e,r,n,i,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function oC(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function hE(t,e,r){const n=new Map;Xt(t.length===r.length);for(let i=0;i<r.length;i++){const s=t[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,x7(a,o,r[i]))}return n}function pE(t,e,r){const n=new Map;for(const i of t){const s=i.transform,a=r.data.field(i.field);n.set(i.field,g7(s,a,e))}return n}class lC extends Wp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class w7 extends Wp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T7{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&_7(s,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Af(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Af(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=eC();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;const l=aC(a,o);l!==null&&n.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(mt.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),At())}isEqual(e){return this.batchId===e.batchId&&iu(this.mutations,e.mutations,(r,n)=>dE(r,n))&&iu(this.baseMutations,e.baseMutations,(r,n)=>dE(r,n))}}class wv{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){Xt(e.mutations.length===n.length);let i=function(){return f7}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new wv(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S7{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A7{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qr,bt;function k7(t){switch(t){default:return ht();case Re.CANCELLED:case Re.UNKNOWN:case Re.DEADLINE_EXCEEDED:case Re.RESOURCE_EXHAUSTED:case Re.INTERNAL:case Re.UNAVAILABLE:case Re.UNAUTHENTICATED:return!1;case Re.INVALID_ARGUMENT:case Re.NOT_FOUND:case Re.ALREADY_EXISTS:case Re.PERMISSION_DENIED:case Re.FAILED_PRECONDITION:case Re.ABORTED:case Re.OUT_OF_RANGE:case Re.UNIMPLEMENTED:case Re.DATA_LOSS:return!0}}function cC(t){if(t===void 0)return Ua("GRPC error has no .code"),Re.UNKNOWN;switch(t){case Qr.OK:return Re.OK;case Qr.CANCELLED:return Re.CANCELLED;case Qr.UNKNOWN:return Re.UNKNOWN;case Qr.DEADLINE_EXCEEDED:return Re.DEADLINE_EXCEEDED;case Qr.RESOURCE_EXHAUSTED:return Re.RESOURCE_EXHAUSTED;case Qr.INTERNAL:return Re.INTERNAL;case Qr.UNAVAILABLE:return Re.UNAVAILABLE;case Qr.UNAUTHENTICATED:return Re.UNAUTHENTICATED;case Qr.INVALID_ARGUMENT:return Re.INVALID_ARGUMENT;case Qr.NOT_FOUND:return Re.NOT_FOUND;case Qr.ALREADY_EXISTS:return Re.ALREADY_EXISTS;case Qr.PERMISSION_DENIED:return Re.PERMISSION_DENIED;case Qr.FAILED_PRECONDITION:return Re.FAILED_PRECONDITION;case Qr.ABORTED:return Re.ABORTED;case Qr.OUT_OF_RANGE:return Re.OUT_OF_RANGE;case Qr.UNIMPLEMENTED:return Re.UNIMPLEMENTED;case Qr.DATA_LOSS:return Re.DATA_LOSS;default:return ht()}}(bt=Qr||(Qr={}))[bt.OK=0]="OK",bt[bt.CANCELLED=1]="CANCELLED",bt[bt.UNKNOWN=2]="UNKNOWN",bt[bt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",bt[bt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",bt[bt.NOT_FOUND=5]="NOT_FOUND",bt[bt.ALREADY_EXISTS=6]="ALREADY_EXISTS",bt[bt.PERMISSION_DENIED=7]="PERMISSION_DENIED",bt[bt.UNAUTHENTICATED=16]="UNAUTHENTICATED",bt[bt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",bt[bt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",bt[bt.ABORTED=10]="ABORTED",bt[bt.OUT_OF_RANGE=11]="OUT_OF_RANGE",bt[bt.UNIMPLEMENTED=12]="UNIMPLEMENTED",bt[bt.INTERNAL=13]="INTERNAL",bt[bt.UNAVAILABLE=14]="UNAVAILABLE",bt[bt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C7(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F7=new wl([4294967295,4294967295],0);function mE(t){const e=C7().encode(t),r=new Dk;return r.update(e),new Uint8Array(r.digest())}function gE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new wl([r,n],0),new wl([i,s],0)]}class Tv{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new rf(`Invalid padding: ${r}`);if(n<0)throw new rf(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new rf(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new rf(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=wl.fromNumber(this.Ie)}Ee(e,r,n){let i=e.add(r.multiply(wl.fromNumber(n)));return i.compare(F7)===1&&(i=new wl([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=mE(e),[n,i]=gE(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);if(!this.de(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new Tv(s,i,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const r=mE(e),[n,i]=gE(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);this.Ae(a)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class rf extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hp{constructor(e,r,n,i,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,N0.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Hp(mt.min(),i,new Ir(Bt),za(),At())}}class N0{constructor(e,r,n,i,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new N0(n,r,At(),At(),At())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sh{constructor(e,r,n,i){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=i}}class uC{constructor(e,r){this.targetId=e,this.me=r}}class fC{constructor(e,r,n=Pn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class xE{constructor(){this.fe=0,this.ge=yE(),this.pe=Pn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=At(),r=At(),n=At();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:ht()}}),new N0(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=yE()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Xt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class I7{constructor(e){this.Le=e,this.Be=new Map,this.ke=za(),this.qe=vE(),this.Qe=new Ir(Bt)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:ht()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,i)=>{this.ze(i)&&r(i)})}He(e){const r=e.targetId,n=e.me.count,i=this.Je(r);if(i){const s=i.target;if(gx(s))if(n===0){const a=new st(s.path);this.Ue(r,a,Yn.newNoDocument(a,mt.min()))}else Xt(n===1);else{const a=this.Ye(r);if(a!==n){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,c)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let a,o;try{a=Ll(n).toUint8Array()}catch(l){if(l instanceof zk)return nu("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new Tv(a,i,s)}catch(l){return nu(l instanceof rf?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,s,null),i++)}),i}rt(e){const r=new Map;this.Be.forEach((s,a)=>{const o=this.Je(a);if(o){if(s.current&&gx(o.target)){const l=new st(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,Yn.newNoDocument(l,e))}s.be&&(r.set(a,s.ve()),s.Ce())}});let n=At();this.qe.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));const i=new Hp(e,r,this.Qe,this.ke,n);return this.ke=za(),this.qe=vE(),this.Qe=new Ir(Bt),i}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,r)?i.Fe(r,1):i.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new xE,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new Nn(Bt),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||Qe("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new xE),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function vE(){return new Ir(st.comparator)}function yE(){return new Ir(st.comparator)}const b7={asc:"ASCENDING",desc:"DESCENDING"},R7={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},N7={and:"AND",or:"OR"};class D7{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function vx(t,e){return t.useProto3Json||Lp(e)?e:{value:e}}function rp(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function dC(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function P7(t,e){return rp(t,e.toTimestamp())}function ra(t){return Xt(!!t),mt.fromTimestamp(function(r){const n=Wo(r);return new cn(n.seconds,n.nanos)}(t))}function Sv(t,e){return yx(t,e).canonicalString()}function yx(t,e){const r=function(i){return new Br(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function hC(t){const e=Br.fromString(t);return Xt(vC(e)),e}function _x(t,e){return Sv(t.databaseId,e.path)}function Ym(t,e){const r=hC(e);if(r.get(1)!==t.databaseId.projectId)throw new rt(Re.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new rt(Re.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new st(mC(r))}function pC(t,e){return Sv(t.databaseId,e)}function O7(t){const e=hC(t);return e.length===4?Br.emptyPath():mC(e)}function Ex(t){return new Br(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function mC(t){return Xt(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function _E(t,e,r){return{name:_x(t,e),fields:r.value.mapValue.fields}}function M7(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:ht()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,d){return c.useProto3Json?(Xt(d===void 0||typeof d=="string"),Pn.fromBase64String(d||"")):(Xt(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Pn.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(c){const d=c.code===void 0?Re.UNKNOWN:cC(c.code);return new rt(d,c.message||"")}(a);r=new fC(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Ym(t,n.document.name),s=ra(n.document.updateTime),a=n.document.createTime?ra(n.document.createTime):mt.min(),o=new as({mapValue:{fields:n.document.fields}}),l=Yn.newFoundDocument(i,s,a,o),c=n.targetIds||[],d=n.removedTargetIds||[];r=new sh(c,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Ym(t,n.document),s=n.readTime?ra(n.readTime):mt.min(),a=Yn.newNoDocument(i,s),o=n.removedTargetIds||[];r=new sh([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Ym(t,n.document),s=n.removedTargetIds||[];r=new sh([],s,i,null)}else{if(!("filter"in e))return ht();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new A7(i,s),o=n.targetId;r=new uC(o,a)}}return r}function L7(t,e){let r;if(e instanceof R0)r={update:_E(t,e.key,e.value)};else if(e instanceof lC)r={delete:_x(t,e.key)};else if(e instanceof Xl)r={update:_E(t,e.key,e.data),updateMask:G7(e.fieldMask)};else{if(!(e instanceof w7))return ht();r={verify:_x(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof ep)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof c0)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof u0)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof tp)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw ht()}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:P7(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ht()}(t,e.precondition)),r}function B7(t,e){return t&&t.length>0?(Xt(e!==void 0),t.map(r=>function(i,s){let a=i.updateTime?ra(i.updateTime):ra(s);return a.isEqual(mt.min())&&(a=ra(s)),new y7(a,i.transformResults||[])}(r,e))):[]}function j7(t,e){return{documents:[pC(t,e.path)]}}function V7(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=pC(t,i);const s=function(c){if(c.length!==0)return xC(aa.create(c,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const a=function(c){if(c.length!==0)return c.map(d=>function(p){return{field:mc(p.field),direction:W7(p.dir)}}(d))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=vx(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:r,parent:i}}function U7(t){let e=O7(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Xt(n===1);const d=r.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];r.where&&(s=function(h){const p=gC(h);return p instanceof aa&&Gk(p)?p.getFilters():[p]}(r.where));let a=[];r.orderBy&&(a=function(h){return h.map(p=>function(y){return new Zh(gc(y.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(p))}(r.orderBy));let o=null;r.limit&&(o=function(h){let p;return p=typeof h=="object"?h.value:h,Lp(p)?null:p}(r.limit));let l=null;r.startAt&&(l=function(h){const p=!!h.before,g=h.values||[];return new Jh(g,p)}(r.startAt));let c=null;return r.endAt&&(c=function(h){const p=!h.before,g=h.values||[];return new Jh(g,p)}(r.endAt)),s7(e,i,a,s,o,"F",l,c)}function z7(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ht()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function gC(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=gc(r.unaryFilter.field);return on.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=gc(r.unaryFilter.field);return on.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=gc(r.unaryFilter.field);return on.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=gc(r.unaryFilter.field);return on.create(a,"!=",{nullValue:"NULL_VALUE"});default:return ht()}}(t):t.fieldFilter!==void 0?function(r){return on.create(gc(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ht()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return aa.create(r.compositeFilter.filters.map(n=>gC(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ht()}}(r.compositeFilter.op))}(t):ht()}function W7(t){return b7[t]}function H7(t){return R7[t]}function $7(t){return N7[t]}function mc(t){return{fieldPath:t.canonicalString()}}function gc(t){return bn.fromServerFormat(t.fieldPath)}function xC(t){return t instanceof on?function(r){if(r.op==="=="){if(aE(r.value))return{unaryFilter:{field:mc(r.field),op:"IS_NAN"}};if(sE(r.value))return{unaryFilter:{field:mc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(aE(r.value))return{unaryFilter:{field:mc(r.field),op:"IS_NOT_NAN"}};if(sE(r.value))return{unaryFilter:{field:mc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:mc(r.field),op:H7(r.op),value:r.value}}}(t):t instanceof aa?function(r){const n=r.getFilters().map(i=>xC(i));return n.length===1?n[0]:{compositeFilter:{op:$7(r.op),filters:n}}}(t):ht()}function G7(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function vC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(e,r,n,i,s=mt.min(),a=mt.min(),o=Pn.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new wo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new wo(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new wo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new wo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K7{constructor(e){this.ct=e}}function X7(t){const e=U7({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?xx(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y7{constructor(){this.un=new q7}addToCollectionParentIndex(e,r){return this.un.add(r),Fe.resolve()}getCollectionParents(e,r){return Fe.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return Fe.resolve()}deleteFieldIndex(e,r){return Fe.resolve()}deleteAllFieldIndexes(e){return Fe.resolve()}createTargetIndexes(e,r){return Fe.resolve()}getDocumentsMatchingTarget(e,r){return Fe.resolve(null)}getIndexType(e,r){return Fe.resolve(0)}getFieldIndexes(e,r){return Fe.resolve([])}getNextCollectionGroupToUpdate(e){return Fe.resolve(null)}getMinOffset(e,r){return Fe.resolve(zo.min())}getMinOffsetFromCollectionGroup(e,r){return Fe.resolve(zo.min())}updateCollectionGroup(e,r,n){return Fe.resolve()}updateIndexEntries(e,r){return Fe.resolve()}}class q7{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new Nn(Br.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Nn(Br.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ou(0)}static kn(){return new ou(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q7{constructor(){this.changes=new Eu(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Yn.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Fe.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J7{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z7{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Af(n.mutation,i,bs.empty(),cn.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,At()).next(()=>n))}getLocalViewOfDocuments(e,r,n=At()){const i=ml();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(s=>{let a=tf();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=ml();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,At()))}populateOverlays(e,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,i){let s=za();const a=Sf(),o=function(){return Sf()}();return r.forEach((l,c)=>{const d=n.get(c.key);i.has(c.key)&&(d===void 0||d.mutation instanceof Xl)?s=s.insert(c.key,c):d!==void 0?(a.set(c.key,d.mutation.getFieldMask()),Af(d.mutation,c,d.mutation.getFieldMask(),cn.now())):a.set(c.key,bs.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,d)=>a.set(c,d)),r.forEach((c,d)=>{var h;return o.set(c,new J7(d,(h=a.get(c))!==null&&h!==void 0?h:null))}),o))}recalculateAndSaveOverlays(e,r){const n=Sf();let i=new Ir((a,o)=>a-o),s=At();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let d=n.get(l)||bs.empty();d=o.applyToLocalView(c,d),n.set(l,d);const h=(i.get(o.batchId)||At()).add(l);i=i.insert(o.batchId,h)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,d=l.value,h=eC();d.forEach(p=>{if(!s.has(p)){const g=aC(r.get(p),n.get(p));g!==null&&h.set(p,g),s=s.add(p)}}),a.push(this.documentOverlayCache.saveOverlays(e,c,h))}return Fe.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return st.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):a7(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-s.size):Fe.resolve(ml());let o=-1,l=s;return a.next(c=>Fe.forEach(c,(d,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),s.get(d)?Fe.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{l=l.insert(d,p)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,At())).next(d=>({batchId:o,changes:Zk(d)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new st(r)).next(n=>{let i=tf();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const s=r.collectionGroup;let a=tf();return this.indexManager.getCollectionParents(e,s).next(o=>Fe.forEach(o,l=>{const c=function(h,p){return new Bp(p,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,n,i).next(d=>{d.forEach((h,p)=>{a=a.insert(h,p)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,i))).next(a=>{s.forEach((l,c)=>{const d=c.getKey();a.get(d)===null&&(a=a.insert(d,Yn.newInvalidDocument(d)))});let o=tf();return a.forEach((l,c)=>{const d=s.get(l);d!==void 0&&Af(d.mutation,c,bs.empty(),cn.now()),Up(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eV{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return Fe.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:ra(i.createTime)}}(r)),Fe.resolve()}getNamedQuery(e,r){return Fe.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(i){return{name:i.name,query:X7(i.bundledQuery),readTime:ra(i.readTime)}}(r)),Fe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tV{constructor(){this.overlays=new Ir(st.comparator),this.Ir=new Map}getOverlay(e,r){return Fe.resolve(this.overlays.get(r))}getOverlays(e,r){const n=ml();return Fe.forEach(r,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,s)=>{this.ht(e,r,s)}),Fe.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.Ir.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),Fe.resolve()}getOverlaysForCollection(e,r,n){const i=ml(),s=r.length+1,a=new st(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>n&&i.set(l.getKey(),l)}return Fe.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let s=new Ir((c,d)=>c-d);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let d=s.get(c.largestBatchId);d===null&&(d=ml(),s=s.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const o=ml(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>o.set(c,d)),!(o.size()>=i)););return Fe.resolve(o)}ht(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new S7(r,n));let s=this.Ir.get(r);s===void 0&&(s=At(),this.Ir.set(r,s)),this.Ir.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rV{constructor(){this.sessionToken=Pn.EMPTY_BYTE_STRING}getSessionToken(e){return Fe.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Fe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Av{constructor(){this.Tr=new Nn(gn.Er),this.dr=new Nn(gn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new gn(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new gn(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new st(new Br([])),n=new gn(r,e),i=new gn(r,e+1),s=[];return this.dr.forEachInRange([n,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new st(new Br([])),n=new gn(r,e),i=new gn(r,e+1);let s=At();return this.dr.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const r=new gn(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class gn{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return st.comparator(e.key,r.key)||Bt(e.wr,r.wr)}static Ar(e,r){return Bt(e.wr,r.wr)||st.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nV{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new Nn(gn.Er)}checkEmpty(e){return Fe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new T7(s,r,n,i);this.mutationQueue.push(a);for(const o of i)this.br=this.br.add(new gn(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Fe.resolve(a)}lookupMutationBatch(e,r){return Fe.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.vr(n),s=i<0?0:i;return Fe.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Fe.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Fe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new gn(r,0),i=new gn(r,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,i],a=>{const o=this.Dr(a.wr);s.push(o)}),Fe.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Nn(Bt);return r.forEach(i=>{const s=new gn(i,0),a=new gn(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],o=>{n=n.add(o.wr)})}),Fe.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let s=n;st.isDocumentKey(s)||(s=s.child(""));const a=new gn(new st(s),0);let o=new Nn(Bt);return this.br.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===i&&(o=o.add(l.wr)),!0)},a),Fe.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const i=this.Dr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){Xt(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return Fe.forEach(r.mutations,i=>{const s=new gn(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new gn(r,0),i=this.br.firstAfterOrEqual(n);return Fe.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Fe.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iV{constructor(e){this.Mr=e,this.docs=function(){return new Ir(st.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Fe.resolve(n?n.document.mutableCopy():Yn.newInvalidDocument(r))}getEntries(e,r){let n=za();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():Yn.newInvalidDocument(i))}),Fe.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let s=za();const a=r.path,o=new st(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:d}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||Vj(jj(d),n)<=0||(i.has(d.key)||Up(r,d))&&(s=s.insert(d.key,d.mutableCopy()))}return Fe.resolve(s)}getAllFromCollectionGroup(e,r,n,i){ht()}Or(e,r){return Fe.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new sV(this)}getSize(e){return Fe.resolve(this.size)}}class sV extends Q7{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)}),Fe.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aV{constructor(e){this.persistence=e,this.Nr=new Eu(r=>yv(r),_v),this.lastRemoteSnapshotVersion=mt.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Av,this.targetCount=0,this.kr=ou.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,i)=>r(i)),Fe.resolve()}getLastRemoteSnapshotVersion(e){return Fe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Fe.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Fe.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),Fe.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new ou(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,Fe.resolve()}updateTargetData(e,r){return this.Kn(r),Fe.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,Fe.resolve()}removeTargets(e,r,n){let i=0;const s=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),Fe.waitFor(s).next(()=>i)}getTargetCount(e){return Fe.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return Fe.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),Fe.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),Fe.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),Fe.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return Fe.resolve(n)}containsKey(e,r){return Fe.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oV{constructor(e,r){this.qr={},this.overlays={},this.Qr=new mv(0),this.Kr=!1,this.Kr=!0,this.$r=new rV,this.referenceDelegate=e(this),this.Ur=new aV(this),this.indexManager=new Y7,this.remoteDocumentCache=function(i){return new iV(i)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new K7(r),this.Gr=new eV(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new tV,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new nV(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){Qe("MemoryPersistence","Starting transaction:",e);const i=new lV(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,r){return Fe.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class lV extends zj{constructor(e){super(),this.currentSequenceNumber=e}}class kv{constructor(e){this.persistence=e,this.Jr=new Av,this.Yr=null}static Zr(e){return new kv(e)}get Xr(){if(this.Yr)return this.Yr;throw ht()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),Fe.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),Fe.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),Fe.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(i=>this.Xr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Fe.forEach(this.Xr,n=>{const i=st.fromPath(n);return this.ei(e,i).next(s=>{s||r.removeEntry(i,mt.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return Fe.or([()=>Fe.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cv{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=i}static Wi(e,r){let n=At(),i=At();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Cv(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cV{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uV{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return u9()?8:Wj(ei())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,i){const s={result:null};return this.Yi(e,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new cV;return this.Xi(e,r,a).next(o=>{if(s.result=o,this.zi)return this.es(e,r,a,o.size)})}).next(()=>s.result)}es(e,r,n,i){return n.documentReadCount<this.ji?(Gu()<=kt.DEBUG&&Qe("QueryEngine","SDK will not create cache indexes for query:",pc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Fe.resolve()):(Gu()<=kt.DEBUG&&Qe("QueryEngine","Query:",pc(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(Gu()<=kt.DEBUG&&Qe("QueryEngine","The SDK decides to create cache indexes for query:",pc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ta(r))):Fe.resolve())}Yi(e,r){if(uE(r))return Fe.resolve(null);let n=ta(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=xx(r,null,"F"),n=ta(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=At(...s);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.ts(r,o);return this.ns(r,c,a,l.readTime)?this.Yi(e,xx(r,null,"F")):this.rs(e,c,r,l)}))})))}Zi(e,r,n,i){return uE(r)||i.isEqual(mt.min())?Fe.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const a=this.ts(r,s);return this.ns(r,a,n,i)?Fe.resolve(null):(Gu()<=kt.DEBUG&&Qe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),pc(r)),this.rs(e,a,r,Bj(i,-1)).next(o=>o))})}ts(e,r){let n=new Nn(Qk(e));return r.forEach((i,s)=>{Up(e,s)&&(n=n.add(s))}),n}ns(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,r,n){return Gu()<=kt.DEBUG&&Qe("QueryEngine","Using full collection scan to execute query:",pc(r)),this.Ji.getDocumentsMatchingQuery(e,r,zo.min(),n)}rs(e,r,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fV{constructor(e,r,n,i){this.persistence=e,this.ss=r,this.serializer=i,this.os=new Ir(Bt),this._s=new Eu(s=>yv(s),_v),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Z7(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function dV(t,e,r,n){return new fV(t,e,r,n)}async function yC(t,e){const r=gt(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let l=At();for(const c of i){a.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}for(const c of s){o.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}return r.localDocuments.getDocuments(n,l).next(c=>({hs:c,removedBatchIds:a,addedBatchIds:o}))})})}function hV(t,e){const r=gt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,c,d){const h=c.batch,p=h.keys();let g=Fe.resolve();return p.forEach(y=>{g=g.next(()=>d.getEntry(l,y)).next(x=>{const E=c.docVersions.get(y);Xt(E!==null),x.version.compareTo(E)<0&&(h.applyToRemoteDocument(x,c),x.isValidDocument()&&(x.setReadTime(c.commitVersion),d.addEntry(x)))})}),g.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=At();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function _C(t){const e=gt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function pV(t,e){const r=gt(t),n=e.snapshotVersion;let i=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.cs.newChangeBuffer({trackRemovals:!0});i=r.os;const o=[];e.targetChanges.forEach((d,h)=>{const p=i.get(h);if(!p)return;o.push(r.Ur.removeMatchingKeys(s,d.removedDocuments,h).next(()=>r.Ur.addMatchingKeys(s,d.addedDocuments,h)));let g=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?g=g.withResumeToken(Pn.EMPTY_BYTE_STRING,mt.min()).withLastLimboFreeSnapshotVersion(mt.min()):d.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(d.resumeToken,n)),i=i.insert(h,g),function(x,E,T){return x.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(p,g,d)&&o.push(r.Ur.updateTargetData(s,g))});let l=za(),c=At();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,d))}),o.push(mV(s,a,e.documentUpdates).next(d=>{l=d.Ps,c=d.Is})),!n.isEqual(mt.min())){const d=r.Ur.getLastRemoteSnapshotVersion(s).next(h=>r.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(d)}return Fe.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(r.os=i,s))}function mV(t,e,r){let n=At(),i=At();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let a=za();return r.forEach((o,l)=>{const c=s.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(mt.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):Qe("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{Ps:a,Is:i}})}function gV(t,e){const r=gt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function xV(t,e){const r=gt(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Ur.getTargetData(n,e).next(s=>s?(i=s,Fe.resolve(i)):r.Ur.allocateTargetId(n).next(a=>(i=new wo(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.os.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function wx(t,e,r){const n=gt(t),i=n.os.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!b0(a))throw a;Qe("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(i.target)}function EE(t,e,r){const n=gt(t);let i=mt.min(),s=At();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,c,d){const h=gt(l),p=h._s.get(d);return p!==void 0?Fe.resolve(h.os.get(p)):h.Ur.getTargetData(c,d)}(n,a,ta(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,r?i:mt.min(),r?s:At())).next(o=>(vV(n,l7(e),o),{documents:o,Ts:s})))}function vV(t,e,r){let n=t.us.get(e)||mt.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.us.set(e,n)}class wE{constructor(){this.activeTargetIds=p7()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class yV{constructor(){this.so=new wE,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new wE,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _V{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TE{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Qe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Qe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vd=null;function qm(){return Vd===null?Vd=function(){return 268435456+Math.round(2147483648*Math.random())}():Vd++,"0x"+Vd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EV={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wV{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wn="WebChannelConnection";class TV extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(r,n,i,s,a){const o=qm(),l=this.xo(r,n.toUriEncodedString());Qe("RestConnection",`Sending RPC '${r}' ${o}:`,l,i);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,s,a),this.No(r,l,c,i).then(d=>(Qe("RestConnection",`Received RPC '${r}' ${o}: `,d),d),d=>{throw nu("RestConnection",`RPC '${r}' ${o} failed with error: `,d,"url: ",l,"request:",i),d})}Lo(r,n,i,s,a,o){return this.Mo(r,n,i,s,a)}Oo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+yu}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>r[a]=s),i&&i.headers.forEach((s,a)=>r[a]=s)}xo(r,n){const i=EV[r];return`${this.Do}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,i){const s=qm();return new Promise((a,o)=>{const l=new Pk;l.setWithCredentials(!0),l.listenOnce(Ok.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case rh.NO_ERROR:const d=l.getResponseJson();Qe(Wn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),a(d);break;case rh.TIMEOUT:Qe(Wn,`RPC '${e}' ${s} timed out`),o(new rt(Re.DEADLINE_EXCEEDED,"Request time out"));break;case rh.HTTP_ERROR:const h=l.getStatus();if(Qe(Wn,`RPC '${e}' ${s} failed with status:`,h,"response text:",l.getResponseText()),h>0){let p=l.getResponseJson();Array.isArray(p)&&(p=p[0]);const g=p==null?void 0:p.error;if(g&&g.status&&g.message){const y=function(E){const T=E.toLowerCase().replace(/_/g,"-");return Object.values(Re).indexOf(T)>=0?T:Re.UNKNOWN}(g.status);o(new rt(y,g.message))}else o(new rt(Re.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new rt(Re.UNAVAILABLE,"Connection failed."));break;default:ht()}}finally{Qe(Wn,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);Qe(Wn,`RPC '${e}' ${s} sending request:`,i),l.send(r,"POST",c,n,15)})}Bo(e,r,n){const i=qm(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Bk(),o=Lk(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const d=s.join("");Qe(Wn,`Creating RPC '${e}' stream ${i}: ${d}`,l);const h=a.createWebChannel(d,l);let p=!1,g=!1;const y=new wV({Io:E=>{g?Qe(Wn,`Not sending because RPC '${e}' stream ${i} is closed:`,E):(p||(Qe(Wn,`Opening RPC '${e}' stream ${i} transport.`),h.open(),p=!0),Qe(Wn,`RPC '${e}' stream ${i} sending:`,E),h.send(E))},To:()=>h.close()}),x=(E,T,A)=>{E.listen(T,_=>{try{A(_)}catch(P){setTimeout(()=>{throw P},0)}})};return x(h,ef.EventType.OPEN,()=>{g||(Qe(Wn,`RPC '${e}' stream ${i} transport opened.`),y.yo())}),x(h,ef.EventType.CLOSE,()=>{g||(g=!0,Qe(Wn,`RPC '${e}' stream ${i} transport closed`),y.So())}),x(h,ef.EventType.ERROR,E=>{g||(g=!0,nu(Wn,`RPC '${e}' stream ${i} transport errored:`,E),y.So(new rt(Re.UNAVAILABLE,"The operation could not be completed")))}),x(h,ef.EventType.MESSAGE,E=>{var T;if(!g){const A=E.data[0];Xt(!!A);const _=A,P=_.error||((T=_[0])===null||T===void 0?void 0:T.error);if(P){Qe(Wn,`RPC '${e}' stream ${i} received error:`,P);const W=P.status;let j=function(S){const b=Qr[S];if(b!==void 0)return cC(b)}(W),w=P.message;j===void 0&&(j=Re.INTERNAL,w="Unknown error status: "+W+" with message "+P.message),g=!0,y.So(new rt(j,w)),h.close()}else Qe(Wn,`RPC '${e}' stream ${i} received:`,A),y.bo(A)}}),x(o,Mk.STAT_EVENT,E=>{E.stat===dx.PROXY?Qe(Wn,`RPC '${e}' stream ${i} detected buffering proxy`):E.stat===dx.NOPROXY&&Qe(Wn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{y.wo()},0),y}}function Qm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $p(t){return new D7(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EC{constructor(e,r,n=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,r-n);i>0&&Qe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{constructor(e,r,n,i,s,a,o,l){this.ui=e,this.Ho=n,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new EC(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===Re.RESOURCE_EXHAUSTED?(Ua(r.toString()),Ua("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===Re.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Yo===r&&this.P_(n,i)},n=>{e(()=>{const i=new rt(Re.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(i)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{n(()=>this.I_(i))}),this.stream.onMessage(i=>{n(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Qe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(Qe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class SV extends wC{constructor(e,r,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=M7(this.serializer,e),n=function(s){if(!("targetChange"in s))return mt.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?mt.min():a.readTime?ra(a.readTime):mt.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=Ex(this.serializer),r.addTarget=function(s,a){let o;const l=a.target;if(o=gx(l)?{documents:j7(s,l)}:{query:V7(s,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=dC(s,a.resumeToken);const c=vx(s,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(mt.min())>0){o.readTime=rp(s,a.snapshotVersion.toTimestamp());const c=vx(s,a.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const n=z7(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=Ex(this.serializer),r.removeTarget=e,this.a_(r)}}class AV extends wC{constructor(e,r,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return Xt(!!e.streamToken),this.lastStreamToken=e.streamToken,Xt(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Xt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=B7(e.writeResults,e.commitTime),n=ra(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=Ex(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>L7(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kV extends class{}{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new rt(Re.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,yx(r,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new rt(Re.UNKNOWN,s.toString())})}Lo(e,r,n,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,yx(r,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new rt(Re.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class CV{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ua(r),this.D_=!1):Qe("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FV{constructor(e,r,n,i,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{n.enqueueAndForget(async()=>{Yl(this)&&(Qe("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=gt(l);c.L_.add(4),await D0(c),c.q_.set("Unknown"),c.L_.delete(4),await Gp(c)}(this))})}),this.q_=new CV(n,i)}}async function Gp(t){if(Yl(t))for(const e of t.B_)await e(!0)}async function D0(t){for(const e of t.B_)await e(!1)}function TC(t,e){const r=gt(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),Rv(r)?bv(r):wu(r).r_()&&Iv(r,e))}function Fv(t,e){const r=gt(t),n=wu(r);r.N_.delete(e),n.r_()&&SC(r,e),r.N_.size===0&&(n.r_()?n.o_():Yl(r)&&r.q_.set("Unknown"))}function Iv(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(mt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}wu(t).A_(e)}function SC(t,e){t.Q_.xe(e),wu(t).R_(e)}function bv(t){t.Q_=new I7({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),wu(t).start(),t.q_.v_()}function Rv(t){return Yl(t)&&!wu(t).n_()&&t.N_.size>0}function Yl(t){return gt(t).L_.size===0}function AC(t){t.Q_=void 0}async function IV(t){t.q_.set("Online")}async function bV(t){t.N_.forEach((e,r)=>{Iv(t,e)})}async function RV(t,e){AC(t),Rv(t)?(t.q_.M_(e),bv(t)):t.q_.set("Unknown")}async function NV(t,e,r){if(t.q_.set("Online"),e instanceof fC&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.N_.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.N_.delete(o),i.Q_.removeTarget(o))}(t,e)}catch(n){Qe("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await np(t,n)}else if(e instanceof sh?t.Q_.Ke(e):e instanceof uC?t.Q_.He(e):t.Q_.We(e),!r.isEqual(mt.min()))try{const n=await _C(t.localStore);r.compareTo(n)>=0&&await function(s,a){const o=s.Q_.rt(a);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const d=s.N_.get(c);d&&s.N_.set(c,d.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,c)=>{const d=s.N_.get(l);if(!d)return;s.N_.set(l,d.withResumeToken(Pn.EMPTY_BYTE_STRING,d.snapshotVersion)),SC(s,l);const h=new wo(d.target,l,c,d.sequenceNumber);Iv(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Qe("RemoteStore","Failed to raise snapshot:",n),await np(t,n)}}async function np(t,e,r){if(!b0(e))throw e;t.L_.add(1),await D0(t),t.q_.set("Offline"),r||(r=()=>_C(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Qe("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await Gp(t)})}function kC(t,e){return e().catch(r=>np(t,r,e))}async function Kp(t){const e=gt(t),r=Ho(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;DV(e);)try{const i=await gV(e.localStore,n);if(i===null){e.O_.length===0&&r.o_();break}n=i.batchId,PV(e,i)}catch(i){await np(e,i)}CC(e)&&FC(e)}function DV(t){return Yl(t)&&t.O_.length<10}function PV(t,e){t.O_.push(e);const r=Ho(t);r.r_()&&r.V_&&r.m_(e.mutations)}function CC(t){return Yl(t)&&!Ho(t).n_()&&t.O_.length>0}function FC(t){Ho(t).start()}async function OV(t){Ho(t).p_()}async function MV(t){const e=Ho(t);for(const r of t.O_)e.m_(r.mutations)}async function LV(t,e,r){const n=t.O_.shift(),i=wv.from(n,e,r);await kC(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Kp(t)}async function BV(t,e){e&&Ho(t).V_&&await async function(n,i){if(function(a){return k7(a)&&a!==Re.ABORTED}(i.code)){const s=n.O_.shift();Ho(n).s_(),await kC(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Kp(n)}}(t,e),CC(t)&&FC(t)}async function SE(t,e){const r=gt(t);r.asyncQueue.verifyOperationInProgress(),Qe("RemoteStore","RemoteStore received new credentials");const n=Yl(r);r.L_.add(3),await D0(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await Gp(r)}async function jV(t,e){const r=gt(t);e?(r.L_.delete(2),await Gp(r)):e||(r.L_.add(2),await D0(r),r.q_.set("Unknown"))}function wu(t){return t.K_||(t.K_=function(r,n,i){const s=gt(r);return s.w_(),new SV(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:IV.bind(null,t),Ro:bV.bind(null,t),mo:RV.bind(null,t),d_:NV.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Rv(t)?bv(t):t.q_.set("Unknown")):(await t.K_.stop(),AC(t))})),t.K_}function Ho(t){return t.U_||(t.U_=function(r,n,i){const s=gt(r);return s.w_(),new AV(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:OV.bind(null,t),mo:BV.bind(null,t),f_:MV.bind(null,t),g_:LV.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Kp(t)):(await t.U_.stop(),t.O_.length>0&&(Qe("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nv{constructor(e,r,n,i,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Po,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,s){const a=Date.now()+n,o=new Nv(e,r,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new rt(Re.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Dv(t,e){if(Ua("AsyncQueue",`${e}: ${t}`),b0(t))return new rt(Re.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zc{constructor(e){this.comparator=e?(r,n)=>e(r,n)||st.comparator(r.key,n.key):(r,n)=>st.comparator(r.key,n.key),this.keyedMap=tf(),this.sortedSet=new Ir(this.comparator)}static emptySet(e){return new zc(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof zc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new zc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AE{constructor(){this.W_=new Ir(st.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):ht():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class lu{constructor(e,r,n,i,s,a,o,l,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,i,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new lu(e,r,zc.emptySet(r),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Vp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VV{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class UV{constructor(){this.queries=kE(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const i=gt(r),s=i.queries;i.queries=kE(),s.forEach((a,o)=>{for(const l of o.j_)l.onError(n)})})(this,new rt(Re.ABORTED,"Firestore shutting down"))}}function kE(){return new Eu(t=>qk(t),Vp)}async function IC(t,e){const r=gt(t);let n=3;const i=e.query;let s=r.queries.get(i);s?!s.H_()&&e.J_()&&(n=2):(s=new VV,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(i,!0);break;case 1:s.z_=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const o=Dv(a,`Initialization of query '${pc(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,s),s.j_.push(e),e.Z_(r.onlineState),s.z_&&e.X_(s.z_)&&Pv(r)}async function bC(t,e){const r=gt(t),n=e.query;let i=3;const s=r.queries.get(n);if(s){const a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function zV(t,e){const r=gt(t);let n=!1;for(const i of e){const s=i.query,a=r.queries.get(s);if(a){for(const o of a.j_)o.X_(i)&&(n=!0);a.z_=i}}n&&Pv(r)}function WV(t,e,r){const n=gt(t),i=n.queries.get(e);if(i)for(const s of i.j_)s.onError(r);n.queries.delete(e)}function Pv(t){t.Y_.forEach(e=>{e.next()})}var Tx,CE;(CE=Tx||(Tx={})).ea="default",CE.Cache="cache";class RC{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new lu(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=lu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Tx.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NC{constructor(e){this.key=e}}class DC{constructor(e){this.key=e}}class HV{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=At(),this.mutatedKeys=At(),this.Aa=Qk(e),this.Ra=new zc(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new AE,i=r?r.Ra:this.Ra;let s=r?r.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{const p=i.get(d),g=Up(this.query,h)?h:null,y=!!p&&this.mutatedKeys.has(p.key),x=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let E=!1;p&&g?p.data.isEqual(g.data)?y!==x&&(n.track({type:3,doc:g}),E=!0):this.ga(p,g)||(n.track({type:2,doc:g}),E=!0,(l&&this.Aa(g,l)>0||c&&this.Aa(g,c)<0)&&(o=!0)):!p&&g?(n.track({type:0,doc:g}),E=!0):p&&!g&&(n.track({type:1,doc:p}),E=!0,(l||c)&&(o=!0)),E&&(g?(a=a.add(g),s=x?s.add(d):s.delete(d)):(a=a.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const d=this.query.limitType==="F"?a.last():a.first();a=a.delete(d.key),s=s.delete(d.key),n.track({type:1,doc:d})}return{Ra:a,fa:n,ns:o,mutatedKeys:s}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((d,h)=>function(g,y){const x=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ht()}};return x(g)-x(y)}(d.type,h.type)||this.Aa(d.doc,h.doc)),this.pa(n),i=i!=null&&i;const o=r&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,c=l!==this.Ea;return this.Ea=l,a.length!==0||c?{snapshot:new lu(this.query,e.Ra,s,a,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new AE,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=At(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new DC(n))}),this.da.forEach(n=>{e.has(n)||r.push(new NC(n))}),r}ba(e){this.Ta=e.Ts,this.da=At();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return lu.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class $V{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class GV{constructor(e){this.key=e,this.va=!1}}class KV{constructor(e,r,n,i,s,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Eu(o=>qk(o),Vp),this.Ma=new Map,this.xa=new Set,this.Oa=new Ir(st.comparator),this.Na=new Map,this.La=new Av,this.Ba={},this.ka=new Map,this.qa=ou.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function XV(t,e,r=!0){const n=jC(t);let i;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await PC(n,e,r,!0),i}async function YV(t,e){const r=jC(t);await PC(r,e,!0,!1)}async function PC(t,e,r,n){const i=await xV(t.localStore,ta(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,r);let o;return n&&(o=await qV(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&TC(t.remoteStore,i),o}async function qV(t,e,r,n,i){t.Ka=(h,p,g)=>async function(x,E,T,A){let _=E.view.ma(T);_.ns&&(_=await EE(x.localStore,E.query,!1).then(({documents:w})=>E.view.ma(w,_)));const P=A&&A.targetChanges.get(E.targetId),W=A&&A.targetMismatches.get(E.targetId)!=null,j=E.view.applyChanges(_,x.isPrimaryClient,P,W);return IE(x,E.targetId,j.wa),j.snapshot}(t,h,p,g);const s=await EE(t.localStore,e,!0),a=new HV(e,s.Ts),o=a.ma(s.documents),l=N0.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),c=a.applyChanges(o,t.isPrimaryClient,l);IE(t,r,c.wa);const d=new $V(e,r,a);return t.Fa.set(e,d),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),c.snapshot}async function QV(t,e,r){const n=gt(t),i=n.Fa.get(e),s=n.Ma.get(i.targetId);if(s.length>1)return n.Ma.set(i.targetId,s.filter(a=>!Vp(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await wx(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Fv(n.remoteStore,i.targetId),Sx(n,i.targetId)}).catch(I0)):(Sx(n,i.targetId),await wx(n.localStore,i.targetId,!0))}async function JV(t,e){const r=gt(t),n=r.Fa.get(e),i=r.Ma.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Fv(r.remoteStore,n.targetId))}async function ZV(t,e,r){const n=aU(t);try{const i=await function(a,o){const l=gt(a),c=cn.now(),d=o.reduce((g,y)=>g.add(y.key),At());let h,p;return l.persistence.runTransaction("Locally write mutations","readwrite",g=>{let y=za(),x=At();return l.cs.getEntries(g,d).next(E=>{y=E,y.forEach((T,A)=>{A.isValidDocument()||(x=x.add(T))})}).next(()=>l.localDocuments.getOverlayedDocuments(g,y)).next(E=>{h=E;const T=[];for(const A of o){const _=E7(A,h.get(A.key).overlayedDocument);_!=null&&T.push(new Xl(A.key,_,Wk(_.value.mapValue),Pa.exists(!0)))}return l.mutationQueue.addMutationBatch(g,c,T,o)}).next(E=>{p=E;const T=E.applyToLocalDocumentSet(h,x);return l.documentOverlayCache.saveOverlays(g,E.batchId,T)})}).then(()=>({batchId:p.batchId,changes:Zk(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,l){let c=a.Ba[a.currentUser.toKey()];c||(c=new Ir(Bt)),c=c.insert(o,l),a.Ba[a.currentUser.toKey()]=c}(n,i.batchId,r),await P0(n,i.changes),await Kp(n.remoteStore)}catch(i){const s=Dv(i,"Failed to persist write");r.reject(s)}}async function OC(t,e){const r=gt(t);try{const n=await pV(r.localStore,e);e.targetChanges.forEach((i,s)=>{const a=r.Na.get(s);a&&(Xt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?Xt(a.va):i.removedDocuments.size>0&&(Xt(a.va),a.va=!1))}),await P0(r,n,e)}catch(n){await I0(n)}}function FE(t,e,r){const n=gt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Fa.forEach((s,a)=>{const o=a.view.Z_(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const l=gt(a);l.onlineState=o;let c=!1;l.queries.forEach((d,h)=>{for(const p of h.j_)p.Z_(o)&&(c=!0)}),c&&Pv(l)}(n.eventManager,e),i.length&&n.Ca.d_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function eU(t,e,r){const n=gt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Na.get(e),s=i&&i.key;if(s){let a=new Ir(st.comparator);a=a.insert(s,Yn.newNoDocument(s,mt.min()));const o=At().add(s),l=new Hp(mt.min(),new Map,new Ir(Bt),a,o);await OC(n,l),n.Oa=n.Oa.remove(s),n.Na.delete(e),Ov(n)}else await wx(n.localStore,e,!1).then(()=>Sx(n,e,r)).catch(I0)}async function tU(t,e){const r=gt(t),n=e.batch.batchId;try{const i=await hV(r.localStore,e);LC(r,n,null),MC(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await P0(r,i)}catch(i){await I0(i)}}async function rU(t,e,r){const n=gt(t);try{const i=await function(a,o){const l=gt(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return l.mutationQueue.lookupMutationBatch(c,o).next(h=>(Xt(h!==null),d=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,d,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>l.localDocuments.getDocuments(c,d))})}(n.localStore,e);LC(n,e,r),MC(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await P0(n,i)}catch(i){await I0(i)}}function MC(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function LC(t,e,r){const n=gt(t);let i=n.Ba[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(r?s.reject(r):s.resolve(),i=i.remove(e)),n.Ba[n.currentUser.toKey()]=i}}function Sx(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||BC(t,n)})}function BC(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(Fv(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),Ov(t))}function IE(t,e,r){for(const n of r)n instanceof NC?(t.La.addReference(n.key,e),nU(t,n)):n instanceof DC?(Qe("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||BC(t,n.key)):ht()}function nU(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(Qe("SyncEngine","New document in limbo: "+r),t.xa.add(n),Ov(t))}function Ov(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new st(Br.fromString(e)),n=t.qa.next();t.Na.set(n,new GV(r)),t.Oa=t.Oa.insert(r,n),TC(t.remoteStore,new wo(ta(jp(r.path)),n,"TargetPurposeLimboResolution",mv.oe))}}async function P0(t,e,r){const n=gt(t),i=[],s=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{a.push(n.Ka(l,e,r).then(c=>{var d;if((c||r)&&n.isPrimaryClient){const h=c?!c.fromCache:(d=r==null?void 0:r.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;n.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){i.push(c);const h=Cv.Wi(l.targetId,c);s.push(h)}}))}),await Promise.all(a),n.Ca.d_(i),await async function(l,c){const d=gt(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>Fe.forEach(c,p=>Fe.forEach(p.$i,g=>d.persistence.referenceDelegate.addReference(h,p.targetId,g)).next(()=>Fe.forEach(p.Ui,g=>d.persistence.referenceDelegate.removeReference(h,p.targetId,g)))))}catch(h){if(!b0(h))throw h;Qe("LocalStore","Failed to update sequence numbers: "+h)}for(const h of c){const p=h.targetId;if(!h.fromCache){const g=d.os.get(p),y=g.snapshotVersion,x=g.withLastLimboFreeSnapshotVersion(y);d.os=d.os.insert(p,x)}}}(n.localStore,s))}async function iU(t,e){const r=gt(t);if(!r.currentUser.isEqual(e)){Qe("SyncEngine","User change. New user:",e.toKey());const n=await yC(r.localStore,e);r.currentUser=e,function(s,a){s.ka.forEach(o=>{o.forEach(l=>{l.reject(new rt(Re.CANCELLED,a))})}),s.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await P0(r,n.hs)}}function sU(t,e){const r=gt(t),n=r.Na.get(e);if(n&&n.va)return At().add(n.key);{let i=At();const s=r.Ma.get(e);if(!s)return i;for(const a of s){const o=r.Fa.get(a);i=i.unionWith(o.view.Va)}return i}}function jC(t){const e=gt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=OC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=sU.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=eU.bind(null,e),e.Ca.d_=zV.bind(null,e.eventManager),e.Ca.$a=WV.bind(null,e.eventManager),e}function aU(t){const e=gt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=tU.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=rU.bind(null,e),e}class ip{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=$p(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return dV(this.persistence,new uV,e.initialUser,this.serializer)}Ga(e){return new oV(kv.Zr,this.serializer)}Wa(e){return new yV}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ip.provider={build:()=>new ip};class Ax{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>FE(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=iU.bind(null,this.syncEngine),await jV(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new UV}()}createDatastore(e){const r=$p(e.databaseInfo.databaseId),n=function(s){return new TV(s)}(e.databaseInfo);return function(s,a,o,l){return new kV(s,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,s,a,o){return new FV(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>FE(this.syncEngine,r,0),function(){return TE.D()?new TE:new _V}())}createSyncEngine(e,r){return function(i,s,a,o,l,c,d){const h=new KV(i,s,a,o,l,c);return d&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const s=gt(i);Qe("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await D0(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Ax.provider={build:()=>new Ax};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VC{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Ua("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oU{constructor(e,r,n,i,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=$n.UNAUTHENTICATED,this.clientId=Vk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{Qe("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(Qe("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Po;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Dv(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Jm(t,e){t.asyncQueue.verifyOperationInProgress(),Qe("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await yC(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function bE(t,e){t.asyncQueue.verifyOperationInProgress();const r=await lU(t);Qe("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>SE(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>SE(e.remoteStore,i)),t._onlineComponents=e}async function lU(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Qe("FirestoreClient","Using user provided OfflineComponentProvider");try{await Jm(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===Re.FAILED_PRECONDITION||i.code===Re.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;nu("Error using user provided cache. Falling back to memory cache: "+r),await Jm(t,new ip)}}else Qe("FirestoreClient","Using default OfflineComponentProvider"),await Jm(t,new ip);return t._offlineComponents}async function UC(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Qe("FirestoreClient","Using user provided OnlineComponentProvider"),await bE(t,t._uninitializedComponentsProvider._online)):(Qe("FirestoreClient","Using default OnlineComponentProvider"),await bE(t,new Ax))),t._onlineComponents}function cU(t){return UC(t).then(e=>e.syncEngine)}async function kx(t){const e=await UC(t),r=e.eventManager;return r.onListen=XV.bind(null,e.syncEngine),r.onUnlisten=QV.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=YV.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=JV.bind(null,e.syncEngine),r}function uU(t,e,r={}){const n=new Po;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,c){const d=new VC({next:p=>{d.Za(),a.enqueueAndForget(()=>bC(s,h));const g=p.docs.has(o);!g&&p.fromCache?c.reject(new rt(Re.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&p.fromCache&&l&&l.source==="server"?c.reject(new rt(Re.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(p)},error:p=>c.reject(p)}),h=new RC(jp(o.path),d,{includeMetadataChanges:!0,_a:!0});return IC(s,h)}(await kx(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zC(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RE=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fU(t,e,r){if(!r)throw new rt(Re.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function dU(t,e,r,n){if(e===!0&&n===!0)throw new rt(Re.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function NE(t){if(!st.isDocumentKey(t))throw new rt(Re.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Mv(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ht()}function Oo(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new rt(Re.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Mv(t);throw new rt(Re.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DE{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new rt(Re.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new rt(Re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}dU("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=zC((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new rt(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new rt(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new rt(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Lv{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new DE({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new rt(Re.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new rt(Re.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new DE(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new Ij;switch(n.type){case"firstParty":return new Dj(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new rt(Re.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=RE.get(r);n&&(Qe("ComponentProvider","Removing Datastore"),RE.delete(r),n.terminate())}(this),Promise.resolve()}}function hU(t,e,r,n={}){var i;const s=(t=Oo(t,Lv))._getSettings(),a=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&nu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=$n.MOCK_USER;else{o=n9(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new rt(Re.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new $n(c)}t._authCredentials=new bj(new jk(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xp{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Xp(this.firestore,e,this._query)}}class zi{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new f0(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new zi(this.firestore,e,this._key)}}class f0 extends Xp{constructor(e,r,n){super(e,r,jp(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new zi(this.firestore,null,new st(e))}withConverter(e){return new f0(this.firestore,e,this._path)}}function Bv(t,e,...r){if(t=Ms(t),arguments.length===1&&(e=Vk.newId()),fU("doc","path",e),t instanceof Lv){const n=Br.fromString(e,...r);return NE(n),new zi(t,null,new st(n))}{if(!(t instanceof zi||t instanceof f0))throw new rt(Re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Br.fromString(e,...r));return NE(n),new zi(t.firestore,t instanceof f0?t.converter:null,new st(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PE{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new EC(this,"async_queue_retry"),this.Vu=()=>{const n=Qm();n&&Qe("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=Qm();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=Qm();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new Po;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!b0(e))throw e;Qe("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw Ua("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const i=Nv.createAndSchedule(this,e,r,n,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&ht()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function OE(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const i=r;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class d0 extends Lv{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new PE,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new PE(e),this._firestoreClient=void 0,await e}}}function pU(t,e){const r=typeof t=="object"?t:bk(),n=typeof t=="string"?t:"(default)",i=hv(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=t9("firestore");s&&hU(i,...s)}return i}function jv(t){if(t._terminated)throw new rt(Re.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||mU(t),t._firestoreClient}function mU(t){var e,r,n;const i=t._freezeSettings(),s=function(o,l,c,d){return new Gj(o,l,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,zC(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new oU(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new cu(Pn.fromBase64String(e))}catch(r){throw new rt(Re.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new cu(Pn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vv{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new rt(Re.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WC{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uv{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new rt(Re.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new rt(Re.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Bt(this._lat,e._lat)||Bt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zv{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gU=/^__.*__$/;class xU{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Xl(e,this.data,this.fieldMask,r,this.fieldTransforms):new R0(e,this.data,r,this.fieldTransforms)}}function HC(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ht()}}class Wv{constructor(e,r,n,i,s,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Wv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return sp(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(HC(this.Cu)&&gU.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class vU{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||$p(e)}Qu(e,r,n,i=!1){return new Wv({Cu:e,methodName:r,qu:n,path:bn.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function yU(t){const e=t._freezeSettings(),r=$p(t._databaseId);return new vU(t._databaseId,!!e.ignoreUndefinedProperties,r)}function _U(t,e,r,n,i,s={}){const a=t.Qu(s.merge||s.mergeFields?2:0,e,r,i);XC("Data must be an object, but it was:",a,n);const o=GC(n,a);let l,c;if(s.merge)l=new bs(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const d=[];for(const h of s.mergeFields){const p=EU(e,h,r);if(!a.contains(p))throw new rt(Re.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);TU(d,p)||d.push(p)}l=new bs(d),c=a.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=a.fieldTransforms;return new xU(new as(o),l,c)}function $C(t,e){if(KC(t=Ms(t)))return XC("Unsupported field value:",e,t),GC(t,e);if(t instanceof WC)return function(n,i){if(!HC(i.Cu))throw i.Bu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let l=$C(o,i.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(t,e)}return function(n,i){if((n=Ms(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return m7(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=cn.fromDate(n);return{timestampValue:rp(i.serializer,s)}}if(n instanceof cn){const s=new cn(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:rp(i.serializer,s)}}if(n instanceof Uv)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof cu)return{bytesValue:dC(i.serializer,n._byteString)};if(n instanceof zi){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Sv(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof zv)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return Ev(o.serializer,l)})}}}}}}(n,i);throw i.Bu(`Unsupported field value: ${Mv(n)}`)}(t,e)}function GC(t,e){const r={};return Uk(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):_u(t,(n,i)=>{const s=$C(i,e.Mu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function KC(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof cn||t instanceof Uv||t instanceof cu||t instanceof zi||t instanceof WC||t instanceof zv)}function XC(t,e,r){if(!KC(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=Mv(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function EU(t,e,r){if((e=Ms(e))instanceof Vv)return e._internalPath;if(typeof e=="string")return YC(t,e);throw sp("Field path arguments must be of type string or ",t,!1,void 0,r)}const wU=new RegExp("[~\\*/\\[\\]]");function YC(t,e,r){if(e.search(wU)>=0)throw sp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Vv(...e.split("."))._internalPath}catch{throw sp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function sp(t,e,r,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${i}`),l+=")"),new rt(Re.INVALID_ARGUMENT,o+t+l)}function TU(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qC{constructor(e,r,n,i,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new zi(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new SU(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(QC("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class SU extends qC{data(){return super.data()}}function QC(t,e){return typeof e=="string"?YC(t,e):e instanceof Vv?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AU(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new rt(Re.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class kU{convertValue(e,r="none"){switch(Bl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return zr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Ll(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw ht()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return _u(e,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,i;const s=(i=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(a=>zr(a.doubleValue));return new zv(s)}convertGeoPoint(e){return new Uv(zr(e.latitude),zr(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=xv(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(a0(e));default:return null}}convertTimestamp(e){const r=Wo(e);return new cn(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Br.fromString(e);Xt(vC(n));const i=new o0(n.get(1),n.get(3)),s=new st(n.popFirst(5));return i.isEqual(r)||Ua(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CU(t,e,r){let n;return n=t?t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class JC extends qC{constructor(e,r,n,i,s,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new ah(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(QC("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class ah extends JC{data(e={}){return super.data(e)}}class FU{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new nf(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new ah(this._firestore,this._userDataWriter,n.key,n,new nf(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new rt(Re.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const l=new ah(i._firestore,i._userDataWriter,o.doc.key,o.doc,new nf(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new ah(i._firestore,i._userDataWriter,o.doc.key,o.doc,new nf(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,d=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),d=a.indexOf(o.doc.key)),{type:IU(o.type),doc:l,oldIndex:c,newIndex:d}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function IU(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ht()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bU(t){t=Oo(t,zi);const e=Oo(t.firestore,d0);return uU(jv(e),t._key).then(r=>e4(e,t,r))}class ZC extends kU{constructor(e){super(),this.firestore=e}convertBytes(e){return new cu(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new zi(this.firestore,null,r)}}function RU(t,e,r){t=Oo(t,zi);const n=Oo(t.firestore,d0),i=CU(t.converter,e);return DU(n,[_U(yU(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,Pa.none())])}function NU(t,...e){var r,n,i;t=Ms(t);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||OE(e[a])||(s=e[a],a++);const o={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(OE(e[a])){const h=e[a];e[a]=(r=h.next)===null||r===void 0?void 0:r.bind(h),e[a+1]=(n=h.error)===null||n===void 0?void 0:n.bind(h),e[a+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let l,c,d;if(t instanceof zi)c=Oo(t.firestore,d0),d=jp(t._key.path),l={next:h=>{e[a]&&e[a](e4(c,t,h))},error:e[a+1],complete:e[a+2]};else{const h=Oo(t,Xp);c=Oo(h.firestore,d0),d=h._query;const p=new ZC(c);l={next:g=>{e[a]&&e[a](new FU(c,p,h,g))},error:e[a+1],complete:e[a+2]},AU(t._query)}return function(p,g,y,x){const E=new VC(x),T=new RC(g,E,y);return p.asyncQueue.enqueueAndForget(async()=>IC(await kx(p),T)),()=>{E.Za(),p.asyncQueue.enqueueAndForget(async()=>bC(await kx(p),T))}}(jv(c),d,o,l)}function DU(t,e){return function(n,i){const s=new Po;return n.asyncQueue.enqueueAndForget(async()=>ZV(await cU(n),i,s)),s.promise}(jv(t),e)}function e4(t,e,r){const n=r.docs.get(e._key),i=new ZC(t);return new JC(t,i,e._key,n,new nf(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){yu=i})(vu),ru(new Ol("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new d0(new Rj(n.getProvider("auth-internal")),new Oj(n.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new rt(Re.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new o0(c.options.projectId,d)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),Do(eE,"4.7.3",e),Do(eE,"4.7.3","esm2017")})();function Hv(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function t4(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const PU=t4,r4=new C0("auth","Firebase",t4());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ap=new fv("@firebase/auth");function OU(t,...e){ap.logLevel<=kt.WARN&&ap.warn(`Auth (${vu}): ${t}`,...e)}function oh(t,...e){ap.logLevel<=kt.ERROR&&ap.error(`Auth (${vu}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wa(t,...e){throw $v(t,...e)}function na(t,...e){return $v(t,...e)}function n4(t,e,r){const n=Object.assign(Object.assign({},PU()),{[e]:r});return new C0("auth","Firebase",n).create(e,{appName:t.name})}function Tl(t){return n4(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function $v(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return r4.create(t,...e)}function dt(t,e,...r){if(!t)throw $v(e,...r)}function Ca(t){const e="INTERNAL ASSERTION FAILED: "+t;throw oh(e),new Error(e)}function Ha(t,e){t||Ca(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cx(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function MU(){return ME()==="http:"||ME()==="https:"}function ME(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LU(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(MU()||o9()||"connection"in navigator)?navigator.onLine:!0}function BU(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O0{constructor(e,r){this.shortDelay=e,this.longDelay=r,Ha(r>e,"Short delay should be less than long delay!"),this.isMobile=i9()||l9()}get(){return LU()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gv(t,e){Ha(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i4{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ca("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ca("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ca("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jU={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VU=new O0(3e4,6e4);function Kv(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Tu(t,e,r,n,i={}){return s4(t,i,async()=>{let s={},a={};n&&(e==="GET"?a=n:s={body:JSON.stringify(n)});const o=F0(Object.assign({key:t.config.apiKey},a)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},s);return a9()||(c.referrerPolicy="no-referrer"),i4.fetch()(a4(t,t.config.apiHost,r,o),c)})}async function s4(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},jU),e);try{const i=new zU(t),s=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw Ud(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ud(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw Ud(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw Ud(t,"user-disabled",a);const d=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw n4(t,d,c);Wa(t,d)}}catch(i){if(i instanceof Ya)throw i;Wa(t,"network-request-failed",{message:String(i)})}}async function UU(t,e,r,n,i={}){const s=await Tu(t,e,r,n,i);return"mfaPendingCredential"in s&&Wa(t,"multi-factor-auth-required",{_serverResponse:s}),s}function a4(t,e,r,n){const i=`${e}${r}?${n}`;return t.config.emulator?Gv(t.config,i):`${t.config.apiScheme}://${i}`}class zU{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(na(this.auth,"network-request-failed")),VU.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Ud(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=na(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WU(t,e){return Tu(t,"POST","/v1/accounts:delete",e)}async function o4(t,e){return Tu(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kf(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function HU(t,e=!1){const r=Ms(t),n=await r.getIdToken(e),i=Xv(n);dt(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:kf(Zm(i.auth_time)),issuedAtTime:kf(Zm(i.iat)),expirationTime:kf(Zm(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Zm(t){return Number(t)*1e3}function Xv(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return oh("JWT malformed, contained fewer than 3 sections"),null;try{const i=Tk(r);return i?JSON.parse(i):(oh("Failed to decode base64 JWT payload"),null)}catch(i){return oh("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function LE(t){const e=Xv(t);return dt(e,"internal-error"),dt(typeof e.exp<"u","internal-error"),dt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function h0(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Ya&&$U(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function $U({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GU{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fx{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=kf(this.lastLoginAt),this.creationTime=kf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function op(t){var e;const r=t.auth,n=await t.getIdToken(),i=await h0(t,o4(r,{idToken:n}));dt(i==null?void 0:i.users.length,r,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?l4(s.providerUserInfo):[],o=XU(t.providerData,a),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=l?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Fx(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function KU(t){const e=Ms(t);await op(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function XU(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function l4(t){return t.map(e=>{var{providerId:r}=e,n=Hv(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YU(t,e){const r=await s4(t,{},async()=>{const n=F0({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=a4(t,i,"/v1/token",`key=${s}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",i4.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function qU(t,e){return Tu(t,"POST","/v2/accounts:revokeToken",Kv(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){dt(e.idToken,"internal-error"),dt(typeof e.idToken<"u","internal-error"),dt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):LE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){dt(e.length!==0,"internal-error");const r=LE(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(dt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:s}=await YU(e,r);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new Wc;return n&&(dt(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(dt(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(dt(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Wc,this.toJSON())}_performRefresh(){return Ca("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oo(t,e){dt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Fa{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,s=Hv(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new GU(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Fx(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await h0(this,this.stsTokenManager.getToken(this.auth,e));return dt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return HU(this,e)}reload(){return KU(this)}_assign(e){this!==e&&(dt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Fa(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){dt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await op(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Eo(this.auth.app))return Promise.reject(Tl(this.auth));const e=await this.getIdToken();return await h0(this,WU(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,s,a,o,l,c,d;const h=(n=r.displayName)!==null&&n!==void 0?n:void 0,p=(i=r.email)!==null&&i!==void 0?i:void 0,g=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,y=(a=r.photoURL)!==null&&a!==void 0?a:void 0,x=(o=r.tenantId)!==null&&o!==void 0?o:void 0,E=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,T=(c=r.createdAt)!==null&&c!==void 0?c:void 0,A=(d=r.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:_,emailVerified:P,isAnonymous:W,providerData:j,stsTokenManager:w}=r;dt(_&&w,e,"internal-error");const F=Wc.fromJSON(this.name,w);dt(typeof _=="string",e,"internal-error"),oo(h,e.name),oo(p,e.name),dt(typeof P=="boolean",e,"internal-error"),dt(typeof W=="boolean",e,"internal-error"),oo(g,e.name),oo(y,e.name),oo(x,e.name),oo(E,e.name),oo(T,e.name),oo(A,e.name);const S=new Fa({uid:_,auth:e,email:p,emailVerified:P,displayName:h,isAnonymous:W,photoURL:y,phoneNumber:g,tenantId:x,stsTokenManager:F,createdAt:T,lastLoginAt:A});return j&&Array.isArray(j)&&(S.providerData=j.map(b=>Object.assign({},b))),E&&(S._redirectEventId=E),S}static async _fromIdTokenResponse(e,r,n=!1){const i=new Wc;i.updateFromServerResponse(r);const s=new Fa({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await op(s),s}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];dt(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?l4(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),o=new Wc;o.updateFromIdToken(n);const l=new Fa({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Fx(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BE=new Map;function Ia(t){Ha(t instanceof Function,"Expected a class definition");let e=BE.get(t);return e?(Ha(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,BE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c4{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}c4.type="NONE";const jE=c4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lh(t,e,r){return`firebase:${t}:${e}:${r}`}class Hc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=lh(this.userKey,i.apiKey,s),this.fullPersistenceKey=lh("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Fa._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Hc(Ia(jE),e,n);const i=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||Ia(jE);const a=lh(n,e.config.apiKey,e.name);let o=null;for(const c of r)try{const d=await c._get(a);if(d){const h=Fa._fromJSON(e,d);c!==s&&(o=h),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Hc(s,e,n):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==s)try{await c._remove(a)}catch{}})),new Hc(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(h4(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(u4(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(m4(e))return"Blackberry";if(g4(e))return"Webos";if(f4(e))return"Safari";if((e.includes("chrome/")||d4(e))&&!e.includes("edge/"))return"Chrome";if(p4(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function u4(t=ei()){return/firefox\//i.test(t)}function f4(t=ei()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function d4(t=ei()){return/crios\//i.test(t)}function h4(t=ei()){return/iemobile/i.test(t)}function p4(t=ei()){return/android/i.test(t)}function m4(t=ei()){return/blackberry/i.test(t)}function g4(t=ei()){return/webos/i.test(t)}function Yv(t=ei()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function QU(t=ei()){var e;return Yv(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function JU(){return c9()&&document.documentMode===10}function x4(t=ei()){return Yv(t)||p4(t)||g4(t)||m4(t)||/windows phone/i.test(t)||h4(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v4(t,e=[]){let r;switch(t){case"Browser":r=VE(ei());break;case"Worker":r=`${VE(ei())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${vu}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZU{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ez(t,e={}){return Tu(t,"GET","/v2/passwordPolicy",Kv(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tz=6;class rz{constructor(e){var r,n,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:tz,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nz{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new UE(this),this.idTokenSubscription=new UE(this),this.beforeStateQueue=new ZU(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=r4,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Ia(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Hc.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await o4(this,{idToken:e}),n=await Fa._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Eo(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return dt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await op(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=BU()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Eo(this.app))return Promise.reject(Tl(this));const r=e?Ms(e):null;return r&&dt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&dt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Eo(this.app)?Promise.reject(Tl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Eo(this.app)?Promise.reject(Tl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ia(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await ez(this),r=new rz(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new C0("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await qU(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Ia(e)||this._popupRedirectResolver;dt(r,this,"argument-error"),this.redirectPersistenceManager=await Hc.create(this,[Ia(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(dt(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,i);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return dt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=v4(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&OU(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function qv(t){return Ms(t)}class UE{constructor(e){this.auth=e,this.observer=null,this.addObserver=x9(r=>this.observer=r)}get next(){return dt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function iz(t){Qv=t}function sz(t){return Qv.loadJS(t)}function az(){return Qv.gapiScript}function oz(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lz(t,e){const r=hv(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),s=r.getOptions();if(Yh(s,e??{}))return i;Wa(i,"already-initialized")}return r.initialize({options:e})}function cz(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Ia);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function uz(t,e,r){const n=qv(t);dt(n._canInitEmulator,n,"emulator-config-failed"),dt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,s=y4(e),{host:a,port:o}=fz(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${s}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),dz()}function y4(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function fz(t){const e=y4(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:zE(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:zE(a)}}}function zE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function dz(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _4{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Ca("not implemented")}_getIdTokenResponse(e){return Ca("not implemented")}_linkToIdToken(e,r){return Ca("not implemented")}_getReauthenticationResolver(e){return Ca("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $c(t,e){return UU(t,"POST","/v1/accounts:signInWithIdp",Kv(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hz="http://localhost";class jl extends _4{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new jl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Wa("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,s=Hv(r,["providerId","signInMethod"]);if(!n||!i)return null;const a=new jl(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return $c(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,$c(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,$c(e,r)}buildRequest(){const e={requestUri:hz,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=F0(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E4{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0 extends E4{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ho extends M0{constructor(){super("facebook.com")}static credential(e){return jl._fromParams({providerId:ho.PROVIDER_ID,signInMethod:ho.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ho.credentialFromTaggedObject(e)}static credentialFromError(e){return ho.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ho.credential(e.oauthAccessToken)}catch{return null}}}ho.FACEBOOK_SIGN_IN_METHOD="facebook.com";ho.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po extends M0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return jl._fromParams({providerId:po.PROVIDER_ID,signInMethod:po.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return po.credentialFromTaggedObject(e)}static credentialFromError(e){return po.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return po.credential(r,n)}catch{return null}}}po.GOOGLE_SIGN_IN_METHOD="google.com";po.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mo extends M0{constructor(){super("github.com")}static credential(e){return jl._fromParams({providerId:mo.PROVIDER_ID,signInMethod:mo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return mo.credentialFromTaggedObject(e)}static credentialFromError(e){return mo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return mo.credential(e.oauthAccessToken)}catch{return null}}}mo.GITHUB_SIGN_IN_METHOD="github.com";mo.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go extends M0{constructor(){super("twitter.com")}static credential(e,r){return jl._fromParams({providerId:go.PROVIDER_ID,signInMethod:go.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return go.credentialFromTaggedObject(e)}static credentialFromError(e){return go.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return go.credential(r,n)}catch{return null}}}go.TWITTER_SIGN_IN_METHOD="twitter.com";go.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const s=await Fa._fromIdTokenResponse(e,n,i),a=WE(n);return new uu({user:s,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=WE(n);return new uu({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function WE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lp extends Ya{constructor(e,r,n,i){var s;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,lp.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new lp(e,r,n,i)}}function w4(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?lp._fromErrorAndOperation(t,s,e,n):s})}async function pz(t,e,r=!1){const n=await h0(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return uu._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mz(t,e,r=!1){const{auth:n}=t;if(Eo(n.app))return Promise.reject(Tl(n));const i="reauthenticate";try{const s=await h0(t,w4(n,i,e,t),r);dt(s.idToken,n,"internal-error");const a=Xv(s.idToken);dt(a,n,"internal-error");const{sub:o}=a;return dt(t.uid===o,n,"user-mismatch"),uu._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Wa(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gz(t,e,r=!1){if(Eo(t.app))return Promise.reject(Tl(t));const n="signIn",i=await w4(t,n,e),s=await uu._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(s.user),s}function xz(t,e,r,n){return Ms(t).onIdTokenChanged(e,r,n)}function vz(t,e,r){return Ms(t).beforeAuthStateChanged(e,r)}const cp="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T4{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(cp,"1"),this.storage.removeItem(cp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yz=1e3,_z=10;class S4 extends T4{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=x4(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);JU()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,_z):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},yz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}S4.type="LOCAL";const Ez=S4;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A4 extends T4{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}A4.type="SESSION";const k4=A4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wz(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new Yp(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:s}=r.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async c=>c(r.origin,s)),l=await wz(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Yp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jv(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tz{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const c=Jv("",20);i.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(h){const p=h;if(p.data.eventId===c)switch(p.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(p.data.response);break;default:clearTimeout(d),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ia(){return window}function Sz(t){ia().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C4(){return typeof ia().WorkerGlobalScope<"u"&&typeof ia().importScripts=="function"}async function Az(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function kz(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function Cz(){return C4()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F4="firebaseLocalStorageDb",Fz=1,up="firebaseLocalStorage",I4="fbase_key";class L0{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function qp(t,e){return t.transaction([up],e?"readwrite":"readonly").objectStore(up)}function Iz(){const t=indexedDB.deleteDatabase(F4);return new L0(t).toPromise()}function Ix(){const t=indexedDB.open(F4,Fz);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(up,{keyPath:I4})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(up)?e(n):(n.close(),await Iz(),e(await Ix()))})})}async function HE(t,e,r){const n=qp(t,!0).put({[I4]:e,value:r});return new L0(n).toPromise()}async function bz(t,e){const r=qp(t,!1).get(e),n=await new L0(r).toPromise();return n===void 0?null:n.value}function $E(t,e){const r=qp(t,!0).delete(e);return new L0(r).toPromise()}const Rz=800,Nz=3;class b4{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ix(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>Nz)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return C4()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Yp._getInstance(Cz()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await Az(),!this.activeServiceWorker)return;this.sender=new Tz(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||kz()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ix();return await HE(e,cp,"1"),await $E(e,cp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>HE(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>bz(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>$E(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=qp(i,!1).getAll();return new L0(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Rz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}b4.type="LOCAL";const Dz=b4;new O0(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pz(t,e){return e?Ia(e):(dt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zv extends _4{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return $c(e,this._buildIdpRequest())}_linkToIdToken(e,r){return $c(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return $c(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function Oz(t){return gz(t.auth,new Zv(t),t.bypassAuthState)}function Mz(t){const{auth:e,user:r}=t;return dt(r,e,"internal-error"),mz(r,new Zv(t),t.bypassAuthState)}async function Lz(t){const{auth:e,user:r}=t;return dt(r,e,"internal-error"),pz(r,new Zv(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R4{constructor(e,r,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Oz;case"linkViaPopup":case"linkViaRedirect":return Lz;case"reauthViaPopup":case"reauthViaRedirect":return Mz;default:Wa(this.auth,"internal-error")}}resolve(e){Ha(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ha(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bz=new O0(2e3,1e4);class Rc extends R4{constructor(e,r,n,i,s){super(e,r,i,s),this.provider=n,this.authWindow=null,this.pollId=null,Rc.currentPopupAction&&Rc.currentPopupAction.cancel(),Rc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return dt(e,this.auth,"internal-error"),e}async onExecution(){Ha(this.filter.length===1,"Popup operations only handle one event");const e=Jv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(na(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(na(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Rc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(na(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Bz.get())};e()}}Rc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jz="pendingRedirect",ch=new Map;class Vz extends R4{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=ch.get(this.auth._key());if(!e){try{const n=await Uz(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}ch.set(this.auth._key(),e)}return this.bypassAuthState||ch.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Uz(t,e){const r=Hz(e),n=Wz(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function zz(t,e){ch.set(t._key(),e)}function Wz(t){return Ia(t._redirectPersistence)}function Hz(t){return lh(jz,t.config.apiKey,t.name)}async function $z(t,e,r=!1){if(Eo(t.app))return Promise.reject(Tl(t));const n=qv(t),i=Pz(n,e),a=await new Vz(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gz=10*60*1e3;class Kz{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Xz(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!N4(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(na(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Gz&&this.cachedEventUids.clear(),this.cachedEventUids.has(GE(e))}saveEventToCache(e){this.cachedEventUids.add(GE(e)),this.lastProcessedEventTime=Date.now()}}function GE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function N4({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Xz(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return N4(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yz(t,e={}){return Tu(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qz=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Qz=/^https?/;async function Jz(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Yz(t);for(const r of e)try{if(Zz(r))return}catch{}Wa(t,"unauthorized-domain")}function Zz(t){const e=Cx(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!Qz.test(r))return!1;if(qz.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eW=new O0(3e4,6e4);function KE(){const t=ia().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function tW(t){return new Promise((e,r)=>{var n,i,s;function a(){KE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{KE(),r(na(t,"network-request-failed"))},timeout:eW.get()})}if(!((i=(n=ia().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=ia().gapi)===null||s===void 0)&&s.load)a();else{const o=oz("iframefcb");return ia()[o]=()=>{gapi.load?a():r(na(t,"network-request-failed"))},sz(`${az()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw uh=null,e})}let uh=null;function rW(t){return uh=uh||tW(t),uh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nW=new O0(5e3,15e3),iW="__/auth/iframe",sW="emulator/auth/iframe",aW={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},oW=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function lW(t){const e=t.config;dt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Gv(e,sW):`https://${t.config.authDomain}/${iW}`,n={apiKey:e.apiKey,appName:t.name,v:vu},i=oW.get(t.config.apiHost);i&&(n.eid=i);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${F0(n).slice(1)}`}async function cW(t){const e=await rW(t),r=ia().gapi;return dt(r,t,"internal-error"),e.open({where:document.body,url:lW(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:aW,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const a=na(t,"network-request-failed"),o=ia().setTimeout(()=>{s(a)},nW.get());function l(){ia().clearTimeout(o),i(n)}n.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uW={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},fW=500,dW=600,hW="_blank",pW="http://localhost";class XE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function mW(t,e,r,n=fW,i=dW){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},uW),{width:n.toString(),height:i.toString(),top:s,left:a}),c=ei().toLowerCase();r&&(o=d4(c)?hW:r),u4(c)&&(e=e||pW,l.scrollbars="yes");const d=Object.entries(l).reduce((p,[g,y])=>`${p}${g}=${y},`,"");if(QU(c)&&o!=="_self")return gW(e||"",o),new XE(null);const h=window.open(e||"",o,d);dt(h,t,"popup-blocked");try{h.focus()}catch{}return new XE(h)}function gW(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xW="__/auth/handler",vW="emulator/auth/handler",yW=encodeURIComponent("fac");async function YE(t,e,r,n,i,s){dt(t.config.authDomain,t,"auth-domain-config-required"),dt(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:vu,eventId:i};if(e instanceof E4){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",g9(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries({}))a[d]=h}if(e instanceof M0){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(a.scopes=d.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const d of Object.keys(o))o[d]===void 0&&delete o[d];const l=await t._getAppCheckToken(),c=l?`#${yW}=${encodeURIComponent(l)}`:"";return`${_W(t)}?${F0(o).slice(1)}${c}`}function _W({config:t}){return t.emulator?Gv(t,vW):`https://${t.authDomain}/${xW}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eg="webStorageSupport";class EW{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=k4,this._completeRedirectFn=$z,this._overrideRedirectResult=zz}async _openPopup(e,r,n,i){var s;Ha((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await YE(e,r,n,Cx(),i);return mW(e,a,Jv())}async _openRedirect(e,r,n,i){await this._originValidation(e);const s=await YE(e,r,n,Cx(),i);return Sz(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:s}=this.eventManagers[r];return i?Promise.resolve(i):(Ha(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await cW(e),n=new Kz(e);return r.register("authEvent",i=>(dt(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(eg,{type:eg},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[eg];a!==void 0&&r(!!a),Wa(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=Jz(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return x4()||f4()||Yv()}}const wW=EW;var qE="@firebase/auth",QE="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TW{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){dt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SW(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function AW(t){ru(new Ol("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;dt(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:v4(t)},c=new nz(n,i,s,l);return cz(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),ru(new Ol("auth-internal",e=>{const r=qv(e.getProvider("auth").getImmediate());return(n=>new TW(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Do(qE,QE,SW(t)),Do(qE,QE,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kW=5*60,CW=kk("authIdTokenMaxAge")||kW;let JE=null;const FW=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>CW)return;const i=r==null?void 0:r.token;JE!==i&&(JE=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function IW(t=bk()){const e=hv(t,"auth");if(e.isInitialized())return e.getImmediate();const r=lz(t,{popupRedirectResolver:wW,persistence:[Dz,Ez,k4]}),n=kk("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const a=FW(s.toString());vz(r,a,()=>a(r.currentUser)),xz(r,o=>a(o))}}const i=Sk("auth");return i&&uz(r,`http://${i}`),r}function bW(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}iz({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const s=na("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",bW().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});AW("Browser");const RW={apiKey:"AIzaSyAZZ0804o11q-hS6p7XJZNK_FPGJgXpmPc",authDomain:"finance-automation-b28e8.firebaseapp.com",projectId:"finance-automation-b28e8",storageBucket:"finance-automation-b28e8.firebasestorage.app",messagingSenderId:"832501526859",appId:"1:832501526859:web:3a64f40f9db732af1b78ce"},D4=Ik(RW),ey=pU(D4);IW(D4);const tg=async(t,e)=>{try{return await RU(Bv(ey,"appState",t),{masterData:e.masterData||[],ledgerEntries:e.ledgerEntries||[],receipts:e.receipts||[],creditNotes:e.creditNotes||[],openingBalances:e.openingBalances||{},mailerImages:e.mailerImages||{},mailerLogo:e.mailerLogo||null,companyConfig:e.companyConfig||{},nextInvoiceNo:e.nextInvoiceNo||1,nextCombineNo:e.nextCombineNo||1,nextReceiptNo:e.nextReceiptNo||1,nextCreditNoteNo:e.nextCreditNoteNo||1,invoiceValues:e.invoiceValues||{},notifications:e.notifications||[],whatsappSettings:e.whatsappSettings||{},partyMaster:e.partyMaster||[],followups:e.followups||[],updatedAt:new Date().toISOString()}),!0}catch(r){return console.error("Error saving app state:",r),!1}},ZE=async t=>{try{const e=await bU(Bv(ey,"appState",t));return e.exists()?e.data():null}catch(e){return console.error("Error loading app state:",e),null}},NW=(t,e)=>{const r=Bv(ey,"appState",t);return NU(r,n=>{n.exists()&&e(n.data())},n=>{console.error("Error in real-time listener:",n)})},ft=t=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2,maximumFractionDigits:2}).format(t||0),Ut=t=>""+new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t||0),xr=t=>{if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return t;const r=e.getDate().toString().padStart(2,"0"),n=e.toLocaleString("en-US",{month:"short"}),i=e.getFullYear();return`${r}-${n}-${i}`},DW=t=>{if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return t;const r=e.getDate(),n=e.toLocaleString("en-US",{month:"short"}),i=e.getFullYear();return`${r}${(a=>{if(a>3&&a<21)return"th";switch(a%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}})(r)} ${n}, ${i}`},PW=t=>{const e=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],r=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];if(t===0)return"Zero";const n=l=>l<20?e[l]:l<100?r[Math.floor(l/10)]+(l%10?" "+e[l%10]:""):e[Math.floor(l/100)]+" Hundred"+(l%100?" "+n(l%100):""),i=l=>l<1e3?n(l):l<1e5?n(Math.floor(l/1e3))+" Thousand"+(l%1e3?" "+n(l%1e3):""):l<1e7?n(Math.floor(l/1e5))+" Lakh"+(l%1e5?" "+i(l%1e5):""):n(Math.floor(l/1e7))+" Crore"+(l%1e7?" "+i(l%1e7):""),s=Math.floor(t),a=Math.round((t-s)*100);let o="INR "+i(s);return a>0&&(o+=" and "+i(a)+" Paise"),o+" Only"},OW=t=>{if(!t)return"";const e=/[\w.-]+@[\w.-]+\.\w+/g,r=t.match(e);return r?r[0]:""},MW=t=>({Approved:{bg:"#DCFCE7",text:"#166534",border:"#86EFAC"},Created:{bg:"#DBEAFE",text:"#1E40AF",border:"#93C5FD"},"Need Edits":{bg:"#FEE2E2",text:"#991B1B",border:"#FCA5A5"},Paid:{bg:"#D1FAE5",text:"#065F46",border:"#6EE7B7"},Individual:{bg:"#E0E7FF",text:"#3730A3",border:"#A5B4FC"},Combined:{bg:"#F3E8FF",text:"#6B21A8",border:"#DDD6FE"},Yes:{bg:"#DCFCE7",text:"#166534",border:"#86EFAC"},No:{bg:"#FEF3C7",text:"#92400E",border:"#FCD34D"},"Not Yet":{bg:"#F1F5F9",text:"#475569",border:"#CBD5E1"},Pending:{bg:"#FEF3C7",text:"#92400E",border:"#FCD34D"},Sent:{bg:"#D1FAE5",text:"#065F46",border:"#6EE7B7"}})[t]||{bg:"#F1F5F9",text:"#475569",border:"#CBD5E1"},rg=({status:t,small:e=!1})=>{const r=MW(t);return f.jsx("span",{style:{display:"inline-flex",alignItems:"center",padding:e?"2px 8px":"4px 12px",borderRadius:"6px",fontSize:e?"11px":"12px",fontWeight:"600",backgroundColor:r.bg,color:r.text,border:`1px solid ${r.border}`},children:t})},Xe=({icon:t,label:e,onClick:r,variant:n="default",disabled:i=!1,small:s=!1})=>{const o={default:{bg:"#F8FAFC",hoverBg:"#E2E8F0",text:"#475569",border:"#CBD5E1"},primary:{bg:"#2874A6",hoverBg:"#1a5276",text:"#FFFFFF",border:"#2874A6"},success:{bg:"#059669",hoverBg:"#047857",text:"#FFFFFF",border:"#059669"},warning:{bg:"#D97706",hoverBg:"#B45309",text:"#FFFFFF",border:"#D97706"},danger:{bg:"#DC2626",hoverBg:"#B91C1C",text:"#FFFFFF",border:"#DC2626"},brand:{bg:"#2874A6",hoverBg:"#1a5276",text:"#FFFFFF",border:"#2874A6"},purple:{bg:"#7C3AED",hoverBg:"#6D28D9",text:"#FFFFFF",border:"#7C3AED"}}[n];return f.jsxs("button",{onClick:r,disabled:i,title:e,style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:s?"5px 10px":"8px 14px",borderRadius:"6px",fontSize:s?"11px":"13px",fontWeight:"600",backgroundColor:i?"#F1F5F9":o.bg,color:i?"#94A3B8":o.text,border:`1px solid ${i?"#E2E8F0":o.border}`,cursor:i?"not-allowed":"pointer",transition:"all 0.15s ease",whiteSpace:"nowrap",opacity:i?.6:1},onMouseEnter:l=>!i&&(l.target.style.backgroundColor=o.hoverBg),onMouseLeave:l=>!i&&(l.target.style.backgroundColor=o.bg),children:[t&&f.jsx(t,{size:s?14:16}),e&&f.jsx("span",{children:e})]})},vr=({label:t,type:e="text",value:r,onChange:n,placeholder:i,disabled:s,small:a})=>f.jsxs("div",{style:{marginBottom:a?"12px":"16px"},children:[t&&f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:t}),f.jsx("input",{type:e,value:r,onChange:n,placeholder:i,disabled:s,style:{width:"100%",padding:a?"8px 12px":"10px 14px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:a?"13px":"14px",backgroundColor:s?"#F9FAFB":"#FFFFFF",boxSizing:"border-box"}})]}),zd=({label:t,value:e,onChange:r,options:n,small:i})=>f.jsxs("div",{style:{marginBottom:i?"12px":"16px"},children:[t&&f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:t}),f.jsx("select",{value:e,onChange:r,style:{width:"100%",padding:i?"8px 12px":"10px 14px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:i?"13px":"14px",backgroundColor:"#FFFFFF",boxSizing:"border-box"},children:n.map(s=>f.jsx("option",{value:s.value,children:s.label},s.value))})]}),Tn=({title:t,children:e,actions:r,noPadding:n=!1})=>f.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",boxShadow:"0 2px 8px rgba(0,0,0,0.06)",overflow:"hidden"},children:[t&&f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"14px 20px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FAFBFC"},children:[f.jsx("h3",{style:{margin:0,fontSize:"15px",fontWeight:"700",color:"#1E293B"},children:t}),r&&f.jsx("div",{style:{display:"flex",gap:"10px"},children:r})]}),f.jsx("div",{style:{padding:n?0:"20px"},children:e})]}),Sn=({isOpen:t,onClose:e,title:r,children:n,width:i="500px"})=>t?f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(15, 23, 42, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(4px)"},onClick:e,children:f.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"16px",width:i,maxWidth:"95vw",maxHeight:"90vh",overflow:"hidden",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},onClick:s=>s.stopPropagation(),children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FAFBFC"},children:[f.jsx("h2",{style:{margin:0,fontSize:"16px",fontWeight:"700",color:"#1E293B"},children:r}),f.jsx("button",{onClick:e,style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748B"},children:f.jsx(ll,{size:20})})]}),f.jsx("div",{style:{padding:"20px",maxHeight:"calc(90vh - 100px)",overflowY:"auto"},children:n})]})}):null;function LW(){const[t,e]=ye.useState(()=>{const m=localStorage.getItem("financeAppLogin");return m?JSON.parse(m).isLoggedIn:!1}),[r,n]=ye.useState(()=>{const m=localStorage.getItem("financeAppLogin");return m?JSON.parse(m).userRole:null}),[i,s]=ye.useState({username:"",password:""}),[a,o]=ye.useState(""),[l,c]=ye.useState(!1),[d,h]=ye.useState(!1),[p,g]=ye.useState(null),[y,x]=ye.useState({finance:"finance123",director:"director123"}),[E,T]=ye.useState(!1),[A,_]=ye.useState(!1),[P,W]=ye.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[j,w]=ye.useState(""),F={finance:{role:"finance",name:"Finance Team"},director:{role:"director",name:"Director"}};ye.useEffect(()=>{(async()=>{try{const C=await ZE("indreesh-media");C&&C.userPasswords&&(x(C.userPasswords),console.log("Passwords loaded from Firebase"))}catch(C){console.error("Error loading passwords:",C)}T(!0)})()},[]);const[S,b]=ye.useState({name:"Indreesh Media LLP",brand:"JAC",address:"A-1701 Sweet Home CHS LTD, SVP, Plot No: 24",addressLine2:"Andheri West, Nr Last Bus St",city:"Mumbai-400053",gstin:"27AAIFI6351A1ZM",stateCode:"27",stateName:"Maharashtra",email:"alliances@mediabrief.com",phone:"+91 7021911036",website:"www.mediabrief.com",pan:"AAIFI6351A",bank:{name:"Axis Bank",account:"921020009075531",branch:"Andheri",ifsc:"UTIB0000020",holder:"Indreesh Media LLP"},invoicePrefix:"MB/2025-26/",hsnCode:"998365",gstRate:18}),[N,D]=ye.useState("master"),[R,He]=ye.useState(!1),[xe,be]=ye.useState([]),[Ae,Ee]=ye.useState([]),[Z,Ce]=ye.useState([]),[Le,U]=ye.useState([]),[G,J]=ye.useState(null),[q,he]=ye.useState(null),[Se,Ne]=ye.useState(1),[ke,Te]=ye.useState(1),[nt,K]=ye.useState(1),[Ct,xt]=ye.useState(1),[Rt,pt]=ye.useState(!1),[$e,Yt]=ye.useState(!1),[En,fn]=ye.useState(!1),[gi,Ki]=ye.useState(!1),[xi,br]=ye.useState(!1),[vi,zt]=ye.useState(!1),[_r,Zt]=ye.useState(!1),[ri,ut]=ye.useState(!1),[nr,Er]=ye.useState(!1),[mr,ni]=ye.useState(!1),[qa,ca]=ye.useState(!1),[se,wr]=ye.useState(null),[ps,Qa]=ye.useState("reply"),[Xi,ua]=ye.useState(""),[yi,On]=ye.useState(""),[tn,fa]=ye.useState({fromDate:"2020-01-01",toDate:new Date().toISOString().split("T")[0]}),[da,ha]=ye.useState(""),[Mn,Gr]=ye.useState("open"),[tr,Ln]=ye.useState({party:"",invoiceStatus:"",receiptStatus:"",invoiceType:"",searchText:""}),[Bn,ms]=ye.useState([]),[Su,I]=ye.useState(!1),[V,M]=ye.useState([]),[L,z]=ye.useState(!1),[B,ae]=ye.useState(null),[ue,ie]=ye.useState({date:new Date().toISOString().split("T")[0],notes:"",nextFollowupDate:"",status:"Pending"}),[te,le]=ye.useState({enabled:!1,financePhone:"",financeApiKey:"",directorPhone:"",directorApiKey:""}),[pe,De]=ye.useState({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),[Oe,Ie]=ye.useState({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]}),[ze,et]=ye.useState({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1}),[Mt,Nt]=ye.useState(null),[Ft,ii]=ye.useState(new Set),[Kr,_i]=ye.useState({}),[Xr,gs]=ye.useState(null),[Yr,Ls]=ye.useState(null),[ql,Qo]=ye.useState(!1),[Ei,Ql]=ye.useState({}),[si,Jo]=ye.useState({partyName:"",amount:"",type:"Dr"}),[Bs,xs]=ye.useState({}),[ir,pa]=ye.useState({}),[Jl,Zo]=ye.useState(!1),[qt,Ja]=ye.useState(new Set),[lt,vs]=ye.useState({party:"",billStatus:"",invoiceStatus:"",mailingStatus:"",invoiceType:"",combinationCode:"",searchText:""}),[gr,ma]=ye.useState({amount:"",date:new Date().toISOString().split("T")[0],mode:"Bank",tds:"",discount:"",narration:""}),B0=ye.useRef(null),j0=ye.useRef(null),Au=ye.useRef(null),V0=ye.useRef(null),Za=ye.useRef(null),ys=ye.useRef(null),eo=ye.useRef(null),ku=ye.useRef(null),Cu=ye.useRef(null),Rr=ye.useMemo(()=>Array.isArray(xe)?xe:[],[xe]),Ri=ye.useMemo(()=>Array.isArray(Ae)?Ae:[],[Ae]),Zl=ye.useMemo(()=>Array.isArray(Z)?Z:[],[Z]),ec=ye.useMemo(()=>Array.isArray(Le)?Le:[],[Le]),_s=ye.useMemo(()=>Array.isArray(Bn)?Bn:[],[Bn]),tc=ye.useMemo(()=>Array.isArray(V)?V:[],[V]),Ni=ye.useMemo(()=>ir&&typeof ir=="object"&&!Array.isArray(ir)?ir:{},[ir]),Es=ye.useMemo(()=>Ei&&typeof Ei=="object"&&!Array.isArray(Ei)?Ei:{},[Ei]),er=(m,C)=>!m||!C?!1:m.trim().toUpperCase()===C.trim().toUpperCase(),ga=ye.useCallback(m=>{if(!m)return"";const C=m.toUpperCase().trim();return C.includes("MAHARASHTRA")||C==="MH"?"MAHARASHTRA":C.includes("DELHI")||C==="DL"||C.includes("NEW DELHI")?"DELHI":C.includes("KARNATAKA")||C==="KA"||C.includes("BANGALORE")||C.includes("BENGALURU")?"KARNATAKA":C.includes("TAMIL")||C==="TN"||C.includes("CHENNAI")?"TAMIL NADU":C.includes("TELANGANA")||C==="TG"||C==="TS"||C.includes("HYDERABAD")?"TELANGANA":C.includes("UTTAR PRADESH")||C==="UP"||C.includes("NOIDA")||C.includes("LUCKNOW")?"UTTAR PRADESH":C.includes("WEST BENGAL")||C==="WB"||C.includes("KOLKATA")?"WEST BENGAL":C.includes("GUJARAT")||C==="GJ"||C.includes("AHMEDABAD")?"GUJARAT":C.includes("RAJASTHAN")||C==="RJ"||C.includes("JAIPUR")?"RAJASTHAN":C.includes("PUNJAB")||C==="PB"?"PUNJAB":C.includes("HARYANA")||C==="HR"||C.includes("GURGAON")||C.includes("GURUGRAM")?"HARYANA":C.includes("MADHYA PRADESH")||C==="MP"||C.includes("BHOPAL")?"MADHYA PRADESH":C.includes("ANDHRA")||C==="AP"?"ANDHRA PRADESH":C.includes("KERALA")||C==="KL"?"KERALA":C.includes("ODISHA")||C.includes("ORISSA")||C==="OR"||C==="OD"?"ODISHA":C.includes("BIHAR")||C==="BR"?"BIHAR":C.includes("JHARKHAND")||C==="JH"?"JHARKHAND":C.includes("ASSAM")||C==="AS"?"ASSAM":C.includes("CHHATTISGARH")||C==="CG"?"CHHATTISGARH":C.includes("GOA")||C==="GA"?"GOA":C.includes("HIMACHAL")||C==="HP"?"HIMACHAL PRADESH":C.includes("JAMMU")||C==="JK"?"JAMMU AND KASHMIR":C.includes("UTTARAKHAND")||C.includes("UTTARANCHAL")||C==="UK"?"UTTARAKHAND":C.includes("MUMBAI")?"MAHARASHTRA":C.includes("CHANDIGARH")?"CHANDIGARH":C},[]),xa=ye.useCallback((m,C)=>{var X;if(!m)return"";const Q=ga(C),ee=m.trim().toUpperCase(),Y=`${ee}|${Q}`;if((X=Ni[Y])!=null&&X.gstin)return Ni[Y].gstin;for(const H in Ni){const ve=Ni[H];if((ve.partyName||"").trim().toUpperCase()===ee&&ve.normalizedState===Q)return ve.gstin||""}for(const H in Ni){const ve=Ni[H];if((ve.partyName||"").trim().toUpperCase()===ee&&ve.gstin)return ve.gstin}return""},[Ni,ga]),js=ye.useRef(!1),Vs=ye.useRef(null),rc=async()=>{c(!0);try{const m=await ZE("indreesh-media");m&&(Array.isArray(m.masterData)&&be(m.masterData),Array.isArray(m.ledgerEntries)&&Ee(m.ledgerEntries),Array.isArray(m.receipts)&&Ce(m.receipts),Array.isArray(m.creditNotes)&&U(m.creditNotes),Array.isArray(m.notifications)&&ms(m.notifications),Array.isArray(m.followups)&&M(m.followups),m.openingBalances&&typeof m.openingBalances=="object"&&!Array.isArray(m.openingBalances)&&Ql(m.openingBalances),m.mailerImages&&typeof m.mailerImages=="object"&&!Array.isArray(m.mailerImages)&&_i(m.mailerImages),m.partyMaster&&typeof m.partyMaster=="object"&&!Array.isArray(m.partyMaster)&&pa(m.partyMaster),m.userPasswords&&typeof m.userPasswords=="object"&&!Array.isArray(m.userPasswords)&&x(m.userPasswords),m.mailerLogo&&gs(m.mailerLogo),m.companyConfig&&b(C=>({...C,...m.companyConfig,name:"Indreesh Media LLP",bank:{...m.companyConfig.bank||C.bank,holder:"Indreesh Media LLP"}})),m.nextInvoiceNo&&Ne(m.nextInvoiceNo),m.nextCombineNo&&Te(m.nextCombineNo),m.nextReceiptNo&&K(m.nextReceiptNo),m.nextCreditNoteNo&&xt(m.nextCreditNoteNo),m.invoiceValues&&xs(m.invoiceValues),m.whatsappSettings&&le(C=>({...C,...m.whatsappSettings})),console.log("Data loaded from Firebase"))}catch(m){console.error("Error loading data:",m)}c(!1)},sr=ye.useCallback(async()=>{h(!0);try{await tg("indreesh-media",{masterData:xe,ledgerEntries:Ae,receipts:Z,creditNotes:Le,openingBalances:Ei,mailerImages:Kr,mailerLogo:Xr,companyConfig:S,nextInvoiceNo:Se,nextCombineNo:ke,nextReceiptNo:nt,nextCreditNoteNo:Ct,invoiceValues:Bs,notifications:Bn,whatsappSettings:te,partyMaster:ir,followups:V,userPasswords:y}),g(new Date),console.log("Data saved to Firebase")}catch(m){console.error("Error saving data:",m)}h(!1)},[xe,Ae,Z,Le,Ei,Kr,Xr,S,Se,ke,nt,Ct,Bs,Bn,te,ir,V,y]);ye.useEffect(()=>{if(t&&!js.current)return eo.current&&clearTimeout(eo.current),eo.current=setTimeout(()=>{js.current||sr()},1e3),()=>{eo.current&&clearTimeout(eo.current)}},[xe,Ae,Z,Le,Ei,Kr,Xr,S,Se,ke,nt,Ct,Bs,Bn,te,ir,V,y,t]);const Qp=async(m,C,Q)=>{if(!te.enabled){console.log("WhatsApp notifications not enabled");return}Q==="finance"&&te.financePhone&&te.financeApiKey?el(te.financePhone,te.financeApiKey,m,C):Q==="director"&&te.directorPhone&&te.directorApiKey?el(te.directorPhone,te.directorApiKey,m,C):Q==="all"&&(te.financePhone&&te.financeApiKey&&el(te.financePhone,te.financeApiKey,m,C),te.directorPhone&&te.directorApiKey&&el(te.directorPhone,te.directorApiKey,m,C))},el=async(m,C,Q,ee)=>{try{const X=`*${{upload:" DATA UPLOAD",invoice:" INVOICE",approval:" APPROVED",edit:" EDIT REQUIRED",receipt:" PAYMENT",info:" UPDATE"}[Q]||" NOTIFICATION"}*

${ee}

_${S.name}_
_${new Date().toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})}_`,H=`https://api.callmebot.com/whatsapp.php?phone=${m}&text=${encodeURIComponent(X)}&apikey=${C}`;fetch(H,{mode:"no-cors"}).then(()=>console.log("WhatsApp notification sent to:",m)).catch(ve=>console.log("WhatsApp send attempted:",m))}catch(Y){console.error("Failed to send WhatsApp notification:",Y)}},Fu=(m,C)=>{if(!m||!C){alert("Please enter phone number and API key first");return}el(m,C,"info","Test notification from Indreesh Media LLP. WhatsApp notifications are working!"),alert("Test message sent! Check your WhatsApp.")},ws=(m,C,Q="all")=>{const ee={id:Date.now()+Math.random(),type:m,message:C,forRole:Q,createdAt:new Date().toISOString(),createdBy:r,read:{finance:!1,director:!1}};ms(Y=>[ee,...Y].slice(0,50)),Qp(m,C,Q)},U0=m=>{ms(C=>(Array.isArray(C)?C:[]).map(ee=>ee.id===m?{...ee,read:{...ee.read,[r]:!0}}:ee))},nc=()=>{ms(m=>(Array.isArray(m)?m:[]).map(Q=>({...Q,read:{...Q.read,[r]:!0}})))},z0=()=>{ms([])},wi=ye.useMemo(()=>_s.filter(m=>m.forRole==="all"||m.forRole===r||m.createdBy!==r).map(m=>({...m,read:m.read||{finance:!1,director:!1}})),[_s,r]),Yi=ye.useMemo(()=>r?wi.filter(m=>!(m.read&&m.read[r])).length:0,[wi,r]),W0=async()=>{const m=F[i.username.toLowerCase()],C=y[i.username.toLowerCase()];m&&C===i.password?(e(!0),n(m.role),localStorage.setItem("financeAppLogin",JSON.stringify({isLoggedIn:!0,userRole:m.role})),o(""),s({username:"",password:""}),await rc()):o("Invalid username or password")},va=async()=>{if(!P.currentPassword||!P.newPassword||!P.confirmPassword){w("Please fill all fields");return}const m=r==="director"?"director":"finance";if(y[m]!==P.currentPassword){w("Current password is incorrect");return}if(P.newPassword!==P.confirmPassword){w("New passwords do not match");return}if(P.newPassword.length<6){w("Password must be at least 6 characters");return}const C={...y,[m]:P.newPassword};x(C);try{await tg("indreesh-media",{masterData:xe,ledgerEntries:Ae,receipts:Z,creditNotes:Le,openingBalances:Ei,mailerImages:Kr,mailerLogo:Xr,companyConfig:S,nextInvoiceNo:Se,nextCombineNo:ke,nextReceiptNo:nt,nextCreditNoteNo:Ct,invoiceValues:Bs,notifications:Bn,whatsappSettings:te,partyMaster:ir,followups:V,userPasswords:C}),console.log("Password saved to Firebase")}catch(Q){console.error("Error saving password:",Q),w("Failed to save password. Please try again.");return}_(!1),W({currentPassword:"",newPassword:"",confirmPassword:""}),w(""),alert(" Password changed successfully!")},H0=()=>{sr(),e(!1),n(null),D("master"),localStorage.removeItem("financeAppLogin")};ye.useEffect(()=>{const m=localStorage.getItem("financeAppLogin");if(m){const{isLoggedIn:C}=JSON.parse(m);C&&rc()}},[]),ye.useEffect(()=>{if(!t){Vs.current&&(Vs.current(),Vs.current=null);return}return Vs.current=NW("indreesh-media",m=>{m&&(js.current=!0,Array.isArray(m.masterData)&&be(m.masterData),Array.isArray(m.ledgerEntries)&&Ee(m.ledgerEntries),Array.isArray(m.receipts)&&Ce(m.receipts),Array.isArray(m.creditNotes)&&U(m.creditNotes),Array.isArray(m.notifications)&&ms(m.notifications),Array.isArray(m.followups)&&M(m.followups),m.openingBalances&&typeof m.openingBalances=="object"&&!Array.isArray(m.openingBalances)&&Ql(m.openingBalances),m.mailerImages&&typeof m.mailerImages=="object"&&!Array.isArray(m.mailerImages)&&_i(m.mailerImages),m.partyMaster&&typeof m.partyMaster=="object"&&!Array.isArray(m.partyMaster)&&pa(m.partyMaster),m.userPasswords&&typeof m.userPasswords=="object"&&!Array.isArray(m.userPasswords)&&x(m.userPasswords),m.mailerLogo&&gs(m.mailerLogo),m.companyConfig&&b(C=>({...C,...m.companyConfig,name:"Indreesh Media LLP",bank:{...m.companyConfig.bank||C.bank,holder:"Indreesh Media LLP"}})),m.nextInvoiceNo&&Ne(m.nextInvoiceNo),m.nextCombineNo&&Te(m.nextCombineNo),m.nextReceiptNo&&K(m.nextReceiptNo),m.nextCreditNoteNo&&xt(m.nextCreditNoteNo),m.invoiceValues&&xs(m.invoiceValues),m.whatsappSettings&&le(C=>({...C,...m.whatsappSettings})),setTimeout(()=>{js.current=!1},500),console.log("Real-time sync: Data updated from Firebase"))}),()=>{Vs.current&&(Vs.current(),Vs.current=null)}},[t]);const Qt=r==="finance",dn=r==="director",tl=ye.useMemo(()=>{const m=new Set;return Rr.forEach(C=>{C.partyName&&m.add(C.partyName)}),Object.values(Ni).forEach(C=>{C.partyName&&m.add(C.partyName)}),Ri.forEach(C=>{C.partyName&&m.add(C.partyName)}),Object.keys(Es).forEach(C=>{C&&m.add(C)}),Array.from(m).filter(Boolean).sort()},[Rr,Ni,Ri,Es]),qi=ye.useMemo(()=>{const m=[],C=new Set,Q=new Set,ee=Y=>{if(!Y)return"";const X=Y.toUpperCase().trim();return X.includes("MAHARASHTRA")||X==="MH"||X.includes("MUMBAI")?"MAHARASHTRA":X.includes("DELHI")||X==="DL"||X.includes("NEW DELHI")?"DELHI":X.includes("KARNATAKA")||X==="KA"||X.includes("BANGALORE")||X.includes("BENGALURU")?"KARNATAKA":X.includes("TAMIL")||X==="TN"||X.includes("CHENNAI")?"TAMIL NADU":X.includes("TELANGANA")||X==="TG"||X==="TS"||X.includes("HYDERABAD")?"TELANGANA":X.includes("UTTAR PRADESH")||X==="UP"||X.includes("NOIDA")||X.includes("LUCKNOW")?"UTTAR PRADESH":X.includes("WEST BENGAL")||X==="WB"||X.includes("KOLKATA")?"WEST BENGAL":X.includes("GUJARAT")||X==="GJ"||X.includes("AHMEDABAD")?"GUJARAT":X.includes("RAJASTHAN")||X==="RJ"||X.includes("JAIPUR")?"RAJASTHAN":X.includes("PUNJAB")||X==="PB"?"PUNJAB":X.includes("HARYANA")||X==="HR"||X.includes("GURGAON")||X.includes("GURUGRAM")?"HARYANA":X.includes("MADHYA PRADESH")||X==="MP"||X.includes("BHOPAL")?"MADHYA PRADESH":X.includes("ANDHRA")||X==="AP"?"ANDHRA PRADESH":X.includes("KERALA")||X==="KL"?"KERALA":X.includes("ODISHA")||X.includes("ORISSA")||X==="OR"||X==="OD"?"ODISHA":X.includes("BIHAR")||X==="BR"?"BIHAR":X.includes("JHARKHAND")||X==="JH"?"JHARKHAND":X.includes("ASSAM")||X==="AS"?"ASSAM":X.includes("CHHATTISGARH")||X==="CG"?"CHHATTISGARH":X.includes("GOA")||X==="GA"?"GOA":X.includes("HIMACHAL")||X==="HP"?"HIMACHAL PRADESH":X.includes("JAMMU")||X==="JK"?"JAMMU AND KASHMIR":X.includes("UTTARAKHAND")||X.includes("UTTARANCHAL")||X==="UK"?"UTTARAKHAND":X.includes("CHANDIGARH")?"CHANDIGARH":X};return Object.entries(Ni).forEach(([Y,X])=>{if(X.partyName){const H=X.normalizedState||ee(X.stateName),ve=X.partyName.trim().toUpperCase(),Me=`${ve}|${H}`;C.has(Me)||(C.add(Me),Q.add(ve),m.push({partyName:X.partyName,partyNameUpper:ve,state:X.stateName||"",normalizedState:H,gstin:X.gstin||"",fromPartyMaster:!0}))}}),Rr.forEach(Y=>{if(Y.partyName){const X=Y.partyName.trim().toUpperCase();if(!Q.has(X)){Q.add(X);const H=ee(Y.statePartyDetails);m.push({partyName:Y.partyName,partyNameUpper:X,state:Y.statePartyDetails||"",normalizedState:H,gstin:"",fromPartyMaster:!1})}}}),Ri.forEach(Y=>{if(Y.partyName){const X=Y.partyName.trim().toUpperCase();if(!Q.has(X)){Q.add(X);const H=ee(Y.state||Y.statePartyDetails||"");m.push({partyName:Y.partyName,partyNameUpper:X,state:Y.state||Y.statePartyDetails||"",normalizedState:H,gstin:"",fromPartyMaster:!1})}}}),Object.keys(Es).forEach(Y=>{const X=Y.trim().toUpperCase();Y&&!Q.has(X)&&(Q.add(X),m.push({partyName:Y,partyNameUpper:X,state:"",normalizedState:"",gstin:"",fromPartyMaster:!1}))}),m.sort((Y,X)=>Y.partyName.localeCompare(X.partyName))},[Rr,Ni,Ri,Es]);ye.useMemo(()=>[...new Set(Rr.filter(C=>C.combinationCode&&C.combinationCode!=="NA").map(C=>C.combinationCode))].sort((C,Q)=>parseInt(C)-parseInt(Q)),[Rr]);const Iu=ye.useMemo(()=>Rr.filter(m=>{var C,Q,ee,Y,X,H;if(lt.party&&m.partyName!==lt.party||lt.billStatus&&m.toBeBilled!==lt.billStatus||lt.invoiceStatus&&(lt.invoiceStatus==="Generated"&&!m.invoiceGenerated||lt.invoiceStatus==="Not Generated"&&m.invoiceGenerated||lt.invoiceStatus==="Paid"&&m.invoiceStatus!=="Paid")||lt.mailingStatus&&m.mailingSent!==lt.mailingStatus||lt.invoiceType&&m.invoiceType!==lt.invoiceType||lt.combinationCode&&m.combinationCode!==lt.combinationCode)return!1;if(lt.searchText){const ve=lt.searchText.toLowerCase();if(!(((C=m.senderName)==null?void 0:C.toLowerCase().includes(ve))||((Q=m.subject)==null?void 0:Q.toLowerCase().includes(ve))||((ee=m.campaignName)==null?void 0:ee.toLowerCase().includes(ve))||((Y=m.invoiceNo)==null?void 0:Y.toLowerCase().includes(ve))||((X=m.partyName)==null?void 0:X.toLowerCase().includes(ve))||((H=m.emailId)==null?void 0:H.toLowerCase().includes(ve))))return!1}return!0}),[Rr,lt]);ye.useMemo(()=>{const m={};return Iu.forEach(C=>{m[C.partyName]||(m[C.partyName]=[]),m[C.partyName].push(C)}),Object.keys(m).forEach(C=>{m[C].sort((Q,ee)=>Q.toBeBilled==="Yes"&&ee.toBeBilled!=="Yes"?-1:Q.toBeBilled!=="Yes"&&ee.toBeBilled==="Yes"?1:0)}),m},[Iu]),ye.useMemo(()=>{if(!G)return[];const m=Es[G]||0;let C=m;const Q=Ri.filter(ee=>er(ee.partyName,G)).sort((ee,Y)=>new Date(ee.date)-new Date(Y.date)).map(ee=>(C=C+ee.debit-ee.credit,{...ee,balance:C}));return m!==0?[{id:"opening",date:"",particulars:"Opening Balance",debit:m>0?m:0,credit:m<0?Math.abs(m):0,balance:m,isOpening:!0},...Q]:Q},[G,Ri,Es]);const $0=m=>Rr.filter(C=>er(C.partyName,m)&&C.toBeBilled==="Yes"&&!C.invoiceGenerated&&C.invoiceAmount),rl=m=>!m||m==="NA"?!1:Rr.some(C=>C.combinationCode===m&&C.mailingSent==="Yes"),Us=m=>m.invoiceType==="Combined"&&m.combinationCode!=="NA"?Rr.filter(C=>C.combinationCode===m.combinationCode):[m],G0=()=>{vs({party:"",billStatus:"",invoiceStatus:"",mailingStatus:"",invoiceType:"",combinationCode:"",searchText:""})},nl=Object.values(lt).some(m=>m!==""),ya=m=>{const C=[];return m.emailId&&C.push(m.emailId),m.additionalEmails&&m.additionalEmails.length>0&&C.push(...m.additionalEmails),C},K0=(m,C)=>{!C||!C.includes("@")||be(Q=>Q.map(ee=>{if(ee.id===m){const Y=ee.additionalEmails||[];if(!Y.includes(C)&&C!==ee.emailId)return{...ee,additionalEmails:[...Y,C]}}return ee}))},ic=(m,C)=>{be(Q=>Q.map(ee=>ee.id===m?{...ee,additionalEmails:(ee.additionalEmails||[]).filter(Y=>Y!==C)}:ee))},X0=m=>{wr(m),On(m.editComments||m.approvalRemarks||""),et({particularsApproved:m.particularsApproved||!1,emailApproved:m.emailApproved||!1,invoiceTypeApproved:m.invoiceTypeApproved||!1}),Zt(!0)},Y0=()=>{if(!se)return;if(!ze.particularsApproved||!ze.emailApproved||!ze.invoiceTypeApproved){alert("Please confirm all approval checkboxes before approving.");return}const m={invoiceStatus:"Approved",approvalRemarks:yi.trim()||"",editComments:"",particularsApproved:!0,emailApproved:!0,invoiceTypeApproved:!0,approvedBy:r,approvedDate:new Date().toISOString()};let C=[];se.invoiceType==="Combined"&&se.combinationCode!=="NA"?(C=xe.filter(H=>H.combinationCode===se.combinationCode),be(H=>H.map(ve=>ve.combinationCode===se.combinationCode?{...ve,...m}:ve))):(C=[se],be(H=>H.map(ve=>ve.id===se.id?{...ve,...m}:ve)));const Q=parseFloat(se.invoiceTotalAmount)||0,ee=C.map(H=>{var ve,Me;return H.senderName||((Me=(ve=H.campaignName)==null?void 0:ve.split("--")[0])==null?void 0:Me.trim())}).join(", "),Y=`${se.invoiceNo} - ${ee}`;Ee(H=>[...H,{id:Date.now(),partyName:se.partyName,date:se.invoiceDate,particulars:"Promotional Trade Mailer",narration:Y,debit:Q,credit:0,type:"invoice",invoiceNo:se.invoiceNo,combinationCode:se.combinationCode}]);const X=yi.trim()?` | Remarks: "${yi.trim()}"`:"";ws("approval",` Invoice ${se.invoiceNo} has been APPROVED by Director${X} - ready for mailing`,"finance"),Zt(!1),wr(null),et({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1}),On(""),alert(` Invoice Approved!

The invoice is now ready for mailing.`)},_a=()=>{if(!se)return;const m=yi.trim();se.invoiceType==="Combined"&&se.combinationCode!=="NA"?be(Q=>Q.map(ee=>ee.combinationCode===se.combinationCode?{...ee,invoiceStatus:"Need Edits",editComments:m,approvalRemarks:""}:ee)):be(Q=>Q.map(ee=>ee.id===se.id?{...ee,invoiceStatus:"Need Edits",editComments:m,approvalRemarks:""}:ee));const C=m?`: "${m}"`:"";ws("edit",` Invoice ${se.invoiceNo} marked as NEED EDITS by Director${C}`,"finance"),Zt(!1),wr(null),On("")},bu=m=>{wr(m);const C=parseFloat(m.invoiceTotalAmount)||0;De({amount:C.toFixed(2),tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),Er(!0)},q0=()=>{if(!se||!pe.amount){alert("Please enter receipt amount");return}if(se.invoiceStatus!=="Approved"){alert("Receipt cannot be posted. Invoice must be approved first.");return}if(!se.isHistorical&&se.mailingSent!=="Yes"){alert("Receipt cannot be posted. Invoice must be mailed first.");return}const m=`RCP/${new Date().getFullYear()}-${String(new Date().getFullYear()+1).slice(-2)}/${nt}`,C=parseFloat(pe.amount)||0,Q=parseFloat(pe.tds)||0,ee=parseFloat(pe.discount)||0,Y=C+Q+ee,X=Us(se),H=X.map(Ve=>Ve.subject||Ve.senderName).join(", "),ve=H.length>50?H.substring(0,47)+"...":H,Me={id:Date.now(),receiptNo:m,invoiceNo:se.invoiceNo,partyName:se.partyName,date:pe.date,amount:C,tds:Q,discount:ee,totalCredit:Y,narration:pe.narration,paymentAdvisory:pe.paymentAdvisory,mode:pe.mode,campaigns:X.map(Ve=>({senderName:Ve.senderName,subject:Ve.subject}))};Ce(Ve=>[...Ve,Me]);const ce=pe.narration||ve;C>0&&Ee(Ve=>[...Ve,{id:Date.now(),partyName:se.partyName,date:pe.date,particulars:`Payment Received - ${ce}`,narration:`${se.invoiceNo} | ${pe.mode}`,debit:0,credit:C,type:"receipt",receiptNo:m,invoiceNo:se.invoiceNo,paymentAdvisory:pe.paymentAdvisory}]),Q>0&&Ee(Ve=>[...Ve,{id:Date.now()+1,partyName:se.partyName,date:pe.date,particulars:"TDS Deducted",narration:`Against ${se.invoiceNo}`,debit:0,credit:Q,type:"tds",receiptNo:m,invoiceNo:se.invoiceNo}]),ee>0&&Ee(Ve=>[...Ve,{id:Date.now()+2,partyName:se.partyName,date:pe.date,particulars:"Discount Given",narration:`Against ${se.invoiceNo}`,debit:0,credit:ee,type:"discount",receiptNo:m,invoiceNo:se.invoiceNo}]);const me=parseFloat(se.invoiceTotalAmount)||0,We=Le.find(Ve=>Ve.invoiceNo===se.invoiceNo),re=We?Math.abs(parseFloat(We.totalAmount)||0):0,de=me-Y-re<=0;se.invoiceType==="Combined"&&se.combinationCode!=="NA"?be(Ve=>Ve.map(Ye=>Ye.combinationCode===se.combinationCode?{...Ye,receiptStatus:de?"Closed":"Received",receiptNo:m,receiptDate:pe.date}:Ye)):se.isHistorical||be(Ve=>Ve.map(Ye=>Ye.id===se.id?{...Ye,receiptStatus:de?"Closed":"Received",receiptNo:m,receiptDate:pe.date}:Ye)),K(Ve=>Ve+1),ws("receipt",` Payment received for ${se.partyName} - Receipt ${m} - ${ft(Y)}`,"director"),Er(!1),wr(null),De({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),alert(` Receipt Created!

Receipt No: ${m}
Amount: ${ft(Y)}`)},Ru=m=>{wr(m),Ie({amount:"",tds:"",discount:"",reason:"",date:new Date().toISOString().split("T")[0]}),ni(!0)},Q0=()=>{var Ve;if(!se||!Oe.amount&&!Oe.gst||!Oe.reason){alert("Please enter Amount and/or GST and reason");return}const m=se.invoiceNo.match(/(\d{4}-\d{2})/),C=m?m[1]:`${new Date().getFullYear()}-${String(new Date().getFullYear()+1).slice(-2)}`,Q=se.invoiceNo.split("/").pop(),ee=`CN/${C}/${Q}`,Y=parseFloat(Oe.amount)||0,X=parseFloat(Oe.gst)||0,H=Y+X,Me=((Ve=se.statePartyDetails)==null?void 0:Ve.toUpperCase().includes("MAHARASHTRA"))?"CGST/SGST":"IGST",ce={id:Date.now(),creditNoteNo:ee,invoiceNo:se.invoiceNo,partyName:se.partyName,date:Oe.date,amount:Y,gst:X,gstType:Me,totalAmount:H,reason:Oe.reason};U(Ye=>[...Ye,ce]);const me=parseFloat(se.invoiceTotalAmount)||0,We=Z.find(Ye=>Ye.invoiceNo===se.invoiceNo),re=We?parseFloat(We.amount)+parseFloat(We.tds||0)+parseFloat(We.discount||0):0,Ke=H>=me-re;se.isHistorical||be(Ye=>Ye.map(Je=>Je.invoiceNo===se.invoiceNo?{...Je,creditNoteNo:ee,receiptStatus:Ke?"Cancelled":Je.receiptStatus}:Je)),xt(Ye=>Ye+1),ni(!1),wr(null),Ie({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]});let de=` Credit Note Created!

Credit Note No: ${ee}`;Y>0&&(de+=`
Base Amount: ${ft(Y)}`),X>0&&(de+=`
${Me}: ${ft(X)}`),de+=`
Total: ${ft(H)}`,Ke&&(de+=`

 Invoice fully covered by CN - marked as Cancelled`),alert(de)},sc=m=>{var ee;const C=(ee=m.target.files)==null?void 0:ee[0];if(!C)return;const Q=new FileReader;Q.onload=Y=>{De(X=>({...X,paymentAdvisory:Y.target.result}))},Q.readAsDataURL(C),m.target.value=""},wn=m=>{wr(m),ut(!0)},J0=()=>{if(!se)return;const m=se.invoiceNo;se.invoiceType==="Combined"&&se.combinationCode!=="NA"?be(ee=>ee.map(Y=>Y.combinationCode===se.combinationCode?{...Y,invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",invoiceType:"Individual",combinationCode:"NA",mailingSent:"No",mailDate:"",editComments:"",receiptStatus:"",receiptNo:"",receiptDate:""}:Y)):be(ee=>ee.map(Y=>Y.id===se.id?{...Y,invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",invoiceType:"Individual",combinationCode:"NA",mailingSent:"No",mailDate:"",editComments:"",receiptStatus:"",receiptNo:"",receiptDate:""}:Y)),Ee(ee=>ee.filter(Y=>Y.invoiceNo!==m));const C=Z.filter(ee=>ee.invoiceNo===m);C.length>0&&Ce(ee=>ee.filter(Y=>Y.invoiceNo!==m)),ut(!1),wr(null);const Q=C.length>0?`
${C.length} receipt(s) also deleted.`:"";alert(` Invoice ${m} deleted.${Q}

You can now regenerate the invoice.`)},Z0=m=>{confirm(`Delete Receipt ${m.receiptNo}?

This will also update the invoice status back to Pending.`)&&(Ce(C=>C.filter(Q=>Q.id!==m.id)),be(C=>C.map(Q=>Q.invoiceNo===m.invoiceNo?{...Q,receiptStatus:"",receiptNo:"",receiptDate:""}:Q)),alert(` Receipt ${m.receiptNo} deleted.`))},to=m=>{confirm(`Delete Credit Note ${m.creditNoteNo}?

This will remove the CN association from the invoice.`)&&(U(C=>C.filter(Q=>Q.id!==m.id)),be(C=>C.map(Q=>Q.invoiceNo===m.invoiceNo?{...Q,creditNoteNo:""}:Q)),alert(` Credit Note ${m.creditNoteNo} deleted.`))},u=m=>{confirm(`Delete historical entry?

Vch No: ${m.vchNo||"N/A"}
Amount: ${m.debit||m.credit}

This action cannot be undone.`)&&(Ee(C=>C.filter(Q=>Q.id!==m.id)),alert(" Historical entry deleted."))},v=()=>{if(!G||!confirm(`Delete ALL historical entries for "${G}"?

This will remove all imported historical data for this party.`))return;const m=Ae.filter(C=>er(C.partyName,G)&&C.isHistorical).length;Ee(C=>C.filter(Q=>!(er(Q.partyName,G)&&Q.isHistorical))),alert(` ${m} historical entries deleted for ${G}.`)},k=m=>{ae(m),ie({date:new Date().toISOString().split("T")[0],notes:"",nextFollowupDate:"",status:"Pending"}),z(!0)},O=()=>{var C,Q;if(!B)return;const m={id:Date.now(),invoiceNo:B.invoiceNo,partyName:B.partyName,invoiceDate:B.invoiceDate||B.date,invoiceAmount:B.invoiceTotalAmount||B.totalAmount,subject:((Q=(C=B.campaigns)==null?void 0:C[0])==null?void 0:Q.subject)||B.subject||"",followupDate:ue.date,notes:ue.notes,nextFollowupDate:ue.nextFollowupDate,status:ue.status};M(ee=>[...ee,m]),z(!1),ae(null),ws("followup",`Followup added for ${B.invoiceNo}`,"all"),alert(` Followup recorded for ${B.invoiceNo}`)},ne=m=>{confirm("Delete this followup entry?")&&M(C=>C.filter(Q=>Q.id!==m))},fe=m=>{var ve,Me;const C=m.subject||((Me=(ve=m.campaigns)==null?void 0:ve[0])==null?void 0:Me.subject)||"",Q=m.partyName,ee=m.invoiceNo,Y=ft(m.invoiceTotalAmount||m.totalAmount||0),X=xr(m.invoiceDate||m.date);return`Subject: RE: ${C} - Payment Followup for Invoice ${ee}

Dear Sir/Madam,

Greetings from ${S.name}!

This is a gentle reminder regarding the outstanding payment for:

Invoice No: ${ee}
Invoice Date: ${X}
Amount: ${Y}
Party: ${Q}

We kindly request you to process the payment at the earliest. If the payment has already been made, please share the payment details for our records.

For any queries, please feel free to reach out.

Thanks & Regards,
Finance Team
${S.name}
Email: ${S.email}
Phone: ${S.phone}`},je=m=>{const C=fe(m);navigator.clipboard.writeText(C),alert(" Followup email template copied to clipboard!")},Wt=m=>{var ee,Y;const C=m.subject||((Y=(ee=m.campaigns)==null?void 0:ee[0])==null?void 0:Y.subject)||"",Q=encodeURIComponent(C);window.open(`https://mail.google.com/mail/u/0/#search/${Q}`,"_blank")},rn=m=>{var ee;const C=(ee=m.target.files)==null?void 0:ee[0];if(!C)return;const Q=new FileReader;Q.onload=Y=>{const X=bc(Y.target.result,{type:"binary"}),H=X.SheetNames[0],ve=X.Sheets[H],Me=Pi.sheet_to_json(ve),ce={};Me.forEach(me=>{const We=me["Party Name"]||me["PARTY NAME"]||me.PartyName||"",re=parseFloat(me.Amount||me.AMOUNT||me["Invoice Amount"]||0);We&&re>0&&(ce[We.trim()]=re)}),xs(me=>({...me,...ce})),alert(` Loaded ${Object.keys(ce).length} party invoice values!`)},Q.readAsBinaryString(C),m.target.value=""},It=()=>{const m=Pi.json_to_sheet([{"Party Name":"ABC Group Private Limited",Amount:5500},{"Party Name":"XYZ Media Pvt Ltd",Amount:7500}]),C=Pi.book_new();Pi.book_append_sheet(C,m,"Invoice Values"),Bm(C,"Invoice_Values_Template.xlsx")},hn=m=>{var ee;const C=(ee=m.target.files)==null?void 0:ee[0];if(!C)return;const Q=new FileReader;Q.onload=Y=>{const X=bc(Y.target.result,{type:"binary"}),H=X.SheetNames[0],ve=X.Sheets[H],Me=Pi.sheet_to_json(ve),ce={...ir};let me=0;Me.forEach(We=>{const re=(We["Name of Ledger"]||We["Party Name"]||We["NAME OF LEDGER"]||We["PARTY NAME"]||"").trim(),Ke=(We["State Name"]||We["STATE NAME"]||We.State||We.STATE||"").trim();if(re){const de=ga(Ke),Ve=`${re.toUpperCase()}|${de}`;ce[Ve]={partyName:re,partyNameUpper:re.toUpperCase(),ledgerGroup:We["Ledger Group"]||We["LEDGER GROUP"]||"Sundry Debtors",stateName:Ke,normalizedState:de,gstRegType:We["GST Registration Type"]||We["GST REGISTRATION TYPE"]||"Regular",gstin:(We["GSTIN/UIN"]||We.GSTIN||We.GST||"").trim()},me++}}),pa(ce),alert(` Party Master Updated!

${me} party-state combinations loaded.`)},Q.readAsBinaryString(C),m.target.value=""},pn=()=>{const m=Pi.json_to_sheet([{"Sl. No.":1,"Name of Ledger":"ABC PRIVATE LIMITED","Ledger Group":"Sundry Debtors","State Name":"Maharashtra","GST Registration Type":"Regular","GSTIN/UIN":"27AAACA1234A1ZQ"},{"Sl. No.":2,"Name of Ledger":"XYZ MEDIA PVT LTD","Ledger Group":"Sundry Debtors","State Name":"Delhi","GST Registration Type":"Regular","GSTIN/UIN":"07AAACX5678B1ZR"}]),C=Pi.book_new();Pi.book_append_sheet(C,m,"Party Master"),Bm(C,"Party_Master_Template.xlsx")},ro=m=>{var ee;const C=(ee=m.target.files)==null?void 0:ee[0];if(!C)return;if(!G){alert(" Please select a party first from the list, then import their historical ledger."),m.target.value="";return}const Q=new FileReader;Q.onload=Y=>{const X=bc(Y.target.result,{type:"binary",cellDates:!0}),H=X.SheetNames[0],ve=X.Sheets[H],Me=Pi.sheet_to_json(ve,{raw:!1}),ce=[];let me=0,We=null;const re=de=>{if(!de)return 0;const Ve=String(de).replace(/,/g,"").replace(/[^\d.-]/g,"");return parseFloat(Ve)||0},Ke=de=>{if(!de||typeof de!="string")return"";const Ve=de.trim(),Ye=Ve.split(/[-\/]/);if(Ye.length===3){const Je={jan:"01",feb:"02",mar:"03",apr:"04",may:"05",jun:"06",jul:"07",aug:"08",sep:"09",oct:"10",nov:"11",dec:"12"},yt=Ye[1].toLowerCase().substring(0,3);if(Je[yt]){const Ge=Ye[0].padStart(2,"0");return`${Ye[2].length===2?parseInt(Ye[2])>50?"19"+Ye[2]:"20"+Ye[2]:Ye[2]}-${Je[yt]}-${Ge}`}}return Ve};Me.forEach((de,Ve)=>{const Ye=Ke(de.Date||de.DATE||de.date||""),Je=(de.Particular||de.PARTICULAR||de.Particulars||de.PARTICULARS||"").trim(),yt=(de["Vch Type"]||de["VCH TYPE"]||de["Voucher Type"]||de["vch type"]||"").trim(),Ge=(de["Vch No."]||de["VCH NO."]||de["Voucher No"]||de["Invoice No"]||de["Vch No"]||de["vch no."]||"").trim(),it=re(de.Debit||de.DEBIT||de.debit),jt=re(de.Credit||de.CREDIT||de.credit),ar=de["Date of Receipt"]||de["DATE OF RECEIPT"]||de["Receipt Date"]||"",or=re(de["Amount Received"]||de["AMOUNT RECEIVED"]||de["amount received"]),Nr=re(de["TDS amount Received"]||de["TDS Received"]||de.TDS||de.tds),_e=re(de.Balance||de.BALANCE||de.balance),oe=(de["Payment Status"]||de["PAYMENT STATUS"]||de.Status||de.status||"").trim();if(!Ye&&(Je.toUpperCase().includes("PROMOTIONAL")||Je.toUpperCase().includes("IGST")||Je.toUpperCase().includes("CGST")||Je.toUpperCase().includes("SGST")||Je.toUpperCase().includes("TRADE EMAILER"))&&We)We.subRows||(We.subRows=[]),We.subRows.push({particular:Je,debit:it,credit:jt});else if(Ye&&(Ge||it>0||jt>0)){We&&(ce.push(We),me++);let Vt="invoice";yt.toLowerCase().includes("credit note")||Ge.toUpperCase().startsWith("CN")?Vt="creditnote":yt.toLowerCase().includes("receipt")?Vt="receipt":(yt.toLowerCase().includes("sale")||it>0)&&(Vt="invoice"),We={id:Date.now()+Ve,partyName:G,date:Ye,particulars:Je||G,narration:Ge,vchType:yt||"Sales",vchNo:Ge,debit:it,credit:jt,receiptDate:ar,amountReceived:or,tdsReceived:Nr,balance:_e,paymentStatus:oe,type:Vt,isHistorical:!0,subRows:[]}}}),We&&(ce.push(We),me++),console.log("Parsed entries with sub-rows:",ce),me>0?(Ee(de=>[...de,...ce]),alert(` Historical Ledger Uploaded!

${me} entries added for "${G}".`)):alert(` No valid ledger entries found in the file.

Make sure your file has these columns:
 Date (e.g., 02-Jun-21)
 Vch Type (e.g., Sales, Credit Note)
 Vch No. (e.g., MB/2022-23/128)
 Debit or Credit amount`)},Q.readAsBinaryString(C),m.target.value="",Zo(!1)},Di=()=>{const m=Pi.json_to_sheet([{Date:"02-Jun-21",Particular:"ABC Corp Ltd.","Vch Type":"Sales","Vch No.":"MB/2020-21/0411",Debit:6e3,Credit:"","Date of Receipt":"","Amount Received":44371,"TDS amount Received":5880,Balance:"","Payment Status":"Received"},{Date:"",Particular:"PROMOTIONAL TRADE EMAILERS","Vch Type":"","Vch No.":"",Debit:"",Credit:22500,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""},{Date:"",Particular:"IGST","Vch Type":"","Vch No.":"",Debit:"",Credit:4050,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""},{Date:"26-Mar-25",Particular:"ABC Corp Ltd.","Vch Type":"Credit Note","Vch No.":"CN/2022-23/128",Debit:"",Credit:26550,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""}]),C=Pi.book_new();Pi.book_append_sheet(C,m,"Historical Ledger"),Bm(C,"Historical_Ledger_Template.xlsx")},ac=m=>{const C=xe.find(Q=>Q.invoiceNo===m);C?Du(C):alert("Invoice not found in system. This may be a historical entry.")},Nu=m=>{xe.find(Q=>Q.invoiceNo===m.invoiceNo);let C=` RECEIPT DETAILS

`;C+=`Receipt No: ${m.receiptNo}
`,C+=`Date: ${xr(m.date)}
`,C+=`Party: ${m.partyName}
`,C+=`Invoice: ${m.invoiceNo}

`,C+=`
`,C+=`Amount Received: ${ft(m.amount||0)}
`,C+=`TDS: ${ft(m.tds||0)}
`,C+=`Discount: ${ft(m.discount||0)}
`,C+=`
`,C+=`Total: ${ft((m.amount||0)+(m.tds||0)+(m.discount||0))}
`,m.remarks&&(C+=`
Remarks: ${m.remarks}`),alert(C)},P4=m=>{let C=` CREDIT NOTE DETAILS

`;C+=`Credit Note No: ${m.creditNoteNo}
`,C+=`Date: ${xr(m.date)}
`,C+=`Party: ${m.partyName}
`,C+=`Against Invoice: ${m.invoiceNo}

`,C+=`
`,C+=`Base Amount: ${ft(m.amount||0)}
`,C+=`${m.gstType||"GST"}: ${ft(m.gst||0)}
`,C+=`
`,C+=`Total Credit: ${ft(m.totalAmount||(m.amount||0)+(m.gst||0))}
`,m.reason&&(C+=`
Reason: ${m.reason}`),alert(C)},O4=m=>{var ee;const C=(ee=m.target.files)==null?void 0:ee[0];if(!C)return;const Q=new FileReader;Q.onload=Y=>{const X=bc(Y.target.result,{type:"binary",cellDates:!0}),H=X.SheetNames[0],ve=X.Sheets[H],Me=Pi.sheet_to_json(ve,{raw:!1}),ce=new Set(Rr.map(de=>`${de.date}|${de.time||""}|${de.campaignName||""}|${de.subject}`.toLowerCase()));let me=0,We=0;const re=Me.map((de,Ve)=>{const Ye=de["CAMPAIGN NAME"]||de["Campaign Name"]||"",Je=OW(Ye);let yt=de.DATE||de.Date||new Date;typeof yt=="string"&&(yt=new Date(yt));const Ge=(de["PARTY NAME"]||de["Party Name"]||"").trim(),it=de["SENDER NAME"]||de["Sender Name"]||"",jt=de.SUBJECT||de.Subject||"",ar=de.TIME||de.Time||"",or=Bs[Ge]||"",Nr=yt instanceof Date&&!isNaN(yt)?yt.toISOString().split("T")[0]:"",_e=`${Nr}|${ar}|${Ye}|${jt}`.toLowerCase();return ce.has(_e)?(me++,null):(ce.add(_e),We++,{id:Date.now()+Ve+Math.random(),sno:de.SNO||de["SNO."]||de.Sno||Ve+1,date:Nr,month:de.Month||de.MONTH||"",statePartyDetails:de["State/Party Details"]||de["STATE/PARTY DETAILS"]||"",partyName:Ge,senderName:it,campaignName:Ye,subject:jt,emailId:Je,additionalEmails:[],toBeBilled:"Not Yet",invoiceAmount:or,cgst:"",sgst:"",igst:"",totalWithGst:"",invoiceType:"Individual",combinationCode:"NA",invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",mailingSent:"No",mailerUploaded:!1,editComments:""})}).filter(de=>de!==null);if(re.length>0){be(Ve=>[...Ve,...re]);const de=[...new Set(re.map(Ve=>Ve.partyName))];Ja(Ve=>{const Ye=new Set(Ve);return de.forEach(Je=>Ye.add(Je)),Ye})}let Ke=` Upload Complete!

`;Ke+=` ${We} new campaigns added
`,me>0&&(Ke+=` ${me} duplicate entries skipped`),We>0&&ws("upload",` ${We} new campaigns uploaded to Master Sheet`,"director"),alert(Ke)},Q.readAsBinaryString(C),m.target.value=""},M4=async()=>{be([]),Ee([]),Ce([]),U([]),_i({}),Ql({}),Ne(1),Te(1),K(1),xt(1),J(null),he(null),Ja(new Set),M([]),pa({}),ms([]);try{await tg("indreesh-media",{masterData:[],ledgerEntries:[],receipts:[],creditNotes:[],openingBalances:{},mailerImages:{},mailerLogo:Xr,companyConfig:S,nextInvoiceNo:1,nextCombineNo:1,nextReceiptNo:1,nextCreditNoteNo:1,invoiceValues:Bs,notifications:[],whatsappSettings:te,partyMaster:{},followups:[],userPasswords:y}),console.log("Data cleared and saved to Firebase")}catch(m){console.error("Error clearing data:",m)}ca(!1),alert(" All master data, invoices, receipts, and ledger entries have been cleared!")},ty=m=>{var ee;const C=parseFloat(m.invoiceAmount)||0;if((ee=m.statePartyDetails)==null?void 0:ee.toUpperCase().includes("MAHARASHTRA")){const Y=C*.09,X=C*.09;return{cgst:Y,sgst:X,igst:0,total:C+Y+X}}else{const Y=C*.18;return{cgst:0,sgst:0,igst:Y,total:C+Y}}},L4=(m,C)=>{const Q=xe.find(ee=>ee.id===m);be(ee=>ee.map(Y=>{if(Y.id===m){if(C==="Yes"&&Y.invoiceAmount){const X=ty(Y);return{...Y,toBeBilled:C,cgst:X.cgst.toFixed(2),sgst:X.sgst.toFixed(2),igst:X.igst.toFixed(2),totalWithGst:X.total.toFixed(2)}}return{...Y,toBeBilled:C}}return Y})),C==="Yes"&&Q&&ws("info",` Campaign marked for billing: ${Q.partyName} - ${Q.senderName}`,"finance")},ed=(m,C,Q)=>{be(ee=>ee.map(Y=>{if(Y.id===m){const X={...Y,[C]:Q};if(C==="invoiceAmount"&&Y.toBeBilled==="Yes"){const H=ty(X);return{...X,cgst:H.cgst.toFixed(2),sgst:H.sgst.toFixed(2),igst:H.igst.toFixed(2),totalWithGst:H.total.toFixed(2)}}return X}return Y}))},B4=m=>{const C=`${S.invoicePrefix}${Se}`,Q=new Date().toISOString().split("T")[0],ee=parseFloat(m.totalWithGst)||parseFloat(m.invoiceAmount)*1.18;be(Y=>Y.map(X=>X.id===m.id?{...X,invoiceNo:C,invoiceDate:Q,invoiceTotalAmount:ee.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created",invoiceType:"Individual",combinationCode:"NA"}:X)),Ne(Y=>Y+1),ws("invoice",` New Invoice ${C} created for ${m.partyName} - ${ft(ee)}`,"director"),alert(` Invoice Generated!

Invoice No: ${C}
Amount: ${ft(ee)}

Please review and Approve or mark as Need Edits.`)},j4=()=>{if(Ft.size<2){alert("Please select at least 2 campaigns to combine");return}const m=`${S.invoicePrefix}${Se}`,C=new Date().toISOString().split("T")[0],Q=String(ke);let ee=0;const Y=xe.filter(X=>Ft.has(X.id));Y.forEach(X=>{ee+=parseFloat(X.totalWithGst)||parseFloat(X.invoiceAmount)*1.18}),be(X=>X.map(H=>Ft.has(H.id)?{...H,invoiceNo:m,invoiceDate:C,invoiceTotalAmount:ee.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created",invoiceType:"Combined",combinationCode:Q,mailingSent:"No"}:H)),Ne(X=>X+1),Te(X=>X+1),br(!1),ii(new Set),ws("invoice",` Combined Invoice ${m} created for ${Mt} (${Y.length} campaigns) - ${ft(ee)}`,"director"),Nt(null),alert(` Combined Invoice Generated!

Invoice No: ${m}
Campaigns: ${Ft.size}
Total: ${ft(ee)}

Please review and Approve or mark as Need Edits.`)},V4=m=>{ii(C=>{const Q=new Set(C);return Q.has(m)?Q.delete(m):Q.add(m),Q})},U4=m=>{Nt(m.partyName),ii(new Set([m.id])),br(!0)},z4=m=>{var ee;const C=(ee=m.target.files)==null?void 0:ee[0];if(!C||!se)return;const Q=new FileReader;Q.onload=Y=>ry(Y.target.result),Q.readAsDataURL(C),m.target.value=""},ry=m=>{if(!se)return;const C=se.id;_i(ql?Q=>({...Q,[C]:[m]}):Q=>({...Q,[C]:[...Q[C]||[],m]})),be(Q=>Q.map(ee=>ee.id===se.id?{...ee,mailerUploaded:!0}:ee)),Ls(null),Qo(!1),pt(!1),alert(" Mailer image saved!")},W4=m=>{var Q;const C=(Q=m.clipboardData)==null?void 0:Q.items;if(C){for(let ee=0;ee<C.length;ee++)if(C[ee].type.indexOf("image")!==-1){const Y=C[ee].getAsFile(),X=new FileReader;X.onload=H=>Ls(H.target.result),X.readAsDataURL(Y),m.preventDefault();break}}},H4=m=>{const C=encodeURIComponent(m||"campaign");window.open(`https://mail.google.com/mail/u/0/#search/${C}`,"_blank")},$4=m=>{var ee;const C=(ee=m.target.files)==null?void 0:ee[0];if(!C)return;const Q=new FileReader;Q.onload=Y=>gs(Y.target.result),Q.readAsDataURL(C),m.target.value=""},ny=m=>{const C=Us(m);if(C.length>1){const Q=C.map(ee=>ee.senderName).join(", ");return`Invoice ${m.invoiceNo||""} - ${Q}`}return`Invoice ${m.invoiceNo||""} - ${m.senderName} - ${m.subject}`},td=m=>{const C=Us(m),Q=parseFloat(m.invoiceTotalAmount)||parseFloat(m.totalWithGst)||parseFloat(m.invoiceAmount)*1.18;let ee="";return C.length>1?(ee=`Campaigns included in this invoice:
`,C.forEach((Y,X)=>{ee+=`${X+1}. ${Y.senderName} - ${Y.subject}
`})):ee=`Campaign: ${m.senderName}
Subject: ${m.subject}`,`Dear Sir/Madam,

Please find attached the invoice for the following:

${ee}

Invoice No: ${m.invoiceNo||"To be generated"}
Invoice Amount: ${ft(Q)}

Kindly process the payment at your earliest convenience.

Bank Details:
Bank: ${S.bank.name}
A/C No: ${S.bank.account}
IFSC: ${S.bank.ifsc}
Branch: ${S.bank.branch}

Thank you for your business.

Best Regards,
${S.name}
${S.email}`},[G4,iy]=ye.useState(!1),[sy,ay]=ye.useState(""),oy=m=>{var Ke;let C=[m],Q=parseFloat(m.invoiceAmount)||0;m.invoiceType==="Combined"&&m.combinationCode!=="NA"&&(C=xe.filter(de=>de.combinationCode===m.combinationCode),Q=C.reduce((de,Ve)=>de+(parseFloat(Ve.invoiceAmount)||0),0));const ee=xa(m.partyName,m.statePartyDetails),Y=(Ke=m.statePartyDetails)==null?void 0:Ke.toUpperCase().includes("MAHARASHTRA"),X=Y?Q*.09:0,H=Y?Q*.09:0,ve=Y?0:Q*.18,Me=X+H+ve,ce=Q+Me,me=C.map((de,Ve)=>`
      <tr>
        <td style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px;">${Ve+1}</td>
        <td style="border: 1px solid #000; padding: 8px; font-size: 12px;">
          <div style="font-weight: 600;">PROMOTIONAL TRADE EMAILER</div>
          <div style="font-style: italic; color: #555; font-size: 11px; margin-top: 2px;">${de.senderName||""} - ${xr(de.date)}</div>
          <div style="font-style: italic; color: #555; font-size: 11px;">Subject: ${de.subject||""}</div>
        </td>
        <td style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px;">${S.hsnCode}</td>
        <td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${Ut(parseFloat(de.invoiceAmount)||0)}</td>
      </tr>
    `).join("");let We=[];m.invoiceType==="Combined"&&m.combinationCode!=="NA"?C.forEach(de=>{(Kr[de.id]||[]).forEach(Ye=>We.push({img:Ye,campaign:de}))}):(Kr[m.id]||[]).forEach(Ve=>We.push({img:Ve,campaign:m}));const re=We.map(({img:de,campaign:Ve})=>`
      <div class="page-break-before" style="page-break-before: always; padding: 40px; text-align: center; background: white;">
        ${Xr?`<div style="margin-bottom: 20px;"><img src="${Xr}" alt="Logo" style="max-height: 70px;" /></div>`:`
          <div style="text-align: center; margin-bottom: 25px;">
            <span style="font-size: 22px; font-weight: bold; color: #2874A6;">${S.name}</span>
          </div>
        `}
        <h2 style="font-size: 20px; text-decoration: underline; margin: 25px 0;">MAILER SUPPORTING</h2>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>MAILER DATE:</strong> ${DW(Ve.date)}</p>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>CAMPAIGN:</strong> ${Ve.senderName}</p>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>SUBJECT:</strong> ${Ve.subject||"Campaign"}</p>
        <div style="margin-top: 25px;"><img src="${de}" alt="Mailer" style="max-width: 100%; max-height: 550px; border: 1px solid #ddd;" /></div>
      </div>
    `).join("");return`
  <div style="max-width: 900px; margin: 0 auto; padding: 15px; background: white; font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4;">
    <style>
      @media print {
        @page { size: A4; margin: 8mm; }
        body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        .page-break-before { page-break-before: always; }
      }
    </style>
    <div style="border: 2px solid #000; background: white;">
      <div style="text-align: center; padding: 12px; font-size: 18px; font-weight: bold; border-bottom: 2px solid #000; background: #f8f8f8;">Tax Invoice</div>
      <div style="text-align: center; font-size: 11px; font-style: italic; padding: 5px; border-bottom: 1px solid #000; background: #fafafa;">(Original for Recipient)</div>
      <div style="display: flex; border-bottom: 2px solid #000;">
        <div style="flex: 1.5; padding: 12px; border-right: 2px solid #000;">
          <div style="font-size: 16px; font-weight: bold; margin-bottom: 8px; color: #1a5276;">${S.name}</div>
          <div style="font-size: 11px; line-height: 1.5; color: #333;">${S.address}<br>${S.addressLine2}<br>${S.city}<br><strong>GSTIN/UIN:</strong> ${S.gstin}<br><strong>State:</strong> ${S.stateName}, Code: ${S.stateCode}<br><strong>Contact:</strong> ${S.phone}<br><strong>E-Mail:</strong> ${S.email}</div>
        </div>
        <div style="flex: 1; font-size: 12px;">
          <div style="display: flex; border-bottom: 1px solid #000;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Invoice No.</div><div style="flex: 1; padding: 8px; font-weight: 600; color: #1a5276;">${m.invoiceNo||""}</div></div>
          <div style="display: flex;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Dated</div><div style="flex: 1; padding: 8px;">${xr(m.invoiceDate||m.date)}</div></div>
        </div>
      </div>
      <div style="padding: 10px 12px; border-bottom: 2px solid #000; background: #fafafa;">
        <div style="font-size: 11px; color: #666; margin-bottom: 3px;">Buyer (Bill to)</div>
        <div style="font-size: 14px; font-weight: bold; margin-bottom: 4px; color: #1a5276;">${m.partyName}</div>
        <div style="font-size: 11px; color: #333;">${m.statePartyDetails||""}${ee?"<br><strong>GSTIN/UIN:</strong> "+ee:""}<br>Place of Supply: ${m.statePartyDetails||S.stateName}</div>
      </div>
      <table style="width: 100%; border-collapse: collapse;">
        <thead><tr style="background: #e8e8e8;"><th style="border: 1px solid #000; padding: 10px; width: 45px; font-size: 12px;">Sl No.</th><th style="border: 1px solid #000; padding: 10px; font-size: 12px;">Particulars</th><th style="border: 1px solid #000; padding: 10px; width: 80px; font-size: 12px;">HSN/SAC</th><th style="border: 1px solid #000; padding: 10px; width: 100px; text-align: right; font-size: 12px;">Amount</th></tr></thead>
        <tbody>
          ${me}
          ${C.length>1?'<tr style="background: #f5f5f5;"><td colspan="3" style="border: 1px solid #000; padding: 10px; text-align: right; font-weight: bold; font-size: 13px;">Sub Total</td><td style="border: 1px solid #000; padding: 10px; text-align: right; font-weight: bold; font-size: 13px;">'+Ut(Q)+"</td></tr>":""}
          ${Y?`<tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">CGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${Ut(X)}</td></tr><tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">SGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${Ut(H)}</td></tr>`:`<tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">IGST @ 18%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${Ut(ve)}</td></tr>`}
          <tr style="background: #2874A6; color: white;"><td colspan="3" style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;">Total</td><td style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;"> ${ce.toLocaleString("en-IN",{minimumFractionDigits:2})}</td></tr>
        </tbody>
      </table>
      <div style="padding: 10px 12px; border: 1px solid #000; border-top: none; background: #fafafa;"><div style="color: #666; font-size: 11px; margin-bottom: 3px;">Amount Chargeable (in words)</div><div style="font-weight: bold; font-size: 13px;">${PW(ce)}</div></div>
      <div style="display: flex; border-top: 2px solid #000;">
        <div style="flex: 1; padding: 10px 12px; border-right: 2px solid #000; font-size: 11px;"><div><strong>Company's PAN:</strong> ${S.pan}</div></div>
        <div style="flex: 1.2; padding: 10px 12px; font-size: 11px;">
          <div style="font-weight: bold; margin-bottom: 6px; color: #1a5276;">Company's Bank Details</div>
          <div style="line-height: 1.5;"><strong>A/c Holder:</strong> ${S.bank.holder}<br><strong>Bank:</strong> ${S.bank.name}<br><strong>A/c No.:</strong> ${S.bank.account}<br><strong>IFSC:</strong> ${S.bank.ifsc}</div>
          <div style="text-align: right; margin-top: 30px;"><div style="font-weight: bold;">for ${S.name}</div><div style="margin-top: 25px; border-top: 1px solid #000; display: inline-block; padding-top: 4px; font-size: 10px;">Authorised Signatory</div></div>
        </div>
      </div>
      <div style="text-align: center; padding: 8px; background: #f0f0f0; border-top: 1px solid #000; font-size: 10px; color: #666; font-style: italic;">This is a Computer Generated Invoice</div>
    </div>
  </div>
  ${re}
`},K4=m=>{const C=oy(m);ay(C),wr(m),iy(!0)},X4=m=>{const C=`<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Invoice ${m.invoiceNo||""}</title>
  <style>
    @page { size: A4; margin: 10mm; }
    @media print { body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } }
    body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }
  </style>
</head>
<body>
${oy(m)}
<script>
  // Auto-open print dialog when file is opened
  window.onload = function() { 
    setTimeout(function() { window.print(); }, 500); 
  };
<\/script>
</body>
</html>`,Q=new Blob([C],{type:"text/html"}),ee=URL.createObjectURL(Q),Y=document.createElement("a");Y.href=ee,Y.download=`Invoice_${(m.invoiceNo||"draft").replace(/\//g,"-")}.html`,document.body.appendChild(Y),Y.click(),document.body.removeChild(Y),URL.revokeObjectURL(ee)},Du=m=>{K4(m)},Y4=()=>{const m=parseFloat(gr.amount)||0,C=parseFloat(gr.tds)||0,Q=parseFloat(gr.discount)||0,ee=m+C+Q;let Y=parseFloat(se.invoiceTotalAmount)||parseFloat(se.totalWithGst)||parseFloat(se.invoiceAmount)*1.18;const X=ee>=Y?"Paid":"Partially Paid";se.invoiceType==="Combined"&&se.combinationCode!=="NA"?be(ve=>ve.map(Me=>Me.combinationCode===se.combinationCode?{...Me,invoiceStatus:X}:Me)):be(ve=>ve.map(Me=>Me.id===se.id?{...Me,invoiceStatus:X}:Me));const H=[];m>0&&H.push({id:Date.now(),partyName:se.partyName,date:gr.date,particulars:gr.narration?`Payment Received - ${gr.mode} (${gr.narration})`:`Payment Received - ${gr.mode}`,debit:0,credit:m,type:"payment"}),C>0&&H.push({id:Date.now()+1,partyName:se.partyName,date:gr.date,particulars:`TDS Deducted - Inv: ${se.invoiceNo}`,debit:0,credit:C,type:"tds"}),Q>0&&H.push({id:Date.now()+2,partyName:se.partyName,date:gr.date,particulars:`Discount Allowed - Inv: ${se.invoiceNo}`,debit:0,credit:Q,type:"discount"}),Ee(ve=>[...ve,...H]),fn(!1),wr(null)},ly=m=>{Ja(C=>{const Q=new Set(C);return Q.has(m)?Q.delete(m):Q.add(m),Q})},q4=()=>{const Q=r==="director"?[{id:"master",icon:U2,label:"Master Sheet"},{id:"invoices",icon:Hu,label:"Invoice Register"},{id:"ledgers",icon:O2,label:"Party Ledgers"},{id:"followups",icon:Od,label:"Followups"},{id:"reports",icon:D2,label:"Reports"}]:[{id:"master",icon:U2,label:"Master Sheet"},{id:"invoices",icon:Hu,label:"Invoice Register"},{id:"ledgers",icon:O2,label:"Party Ledgers"},{id:"followups",icon:Od,label:"Followups"},{id:"reports",icon:D2,label:"Reports"},{id:"settings",icon:GB,label:"Settings"}];return f.jsxs("div",{style:{width:R?"60px":"220px",backgroundColor:"#1E293B",color:"#FFFFFF",display:"flex",flexDirection:"column",transition:"width 0.2s ease",flexShrink:0},children:[f.jsxs("div",{style:{padding:R?"12px":"16px",borderBottom:"1px solid #334155",display:"flex",alignItems:"center",justifyContent:R?"center":"space-between"},children:[!R&&f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[f.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"32px",height:"auto",borderRadius:"4px",backgroundColor:"white",padding:"2px"}}),f.jsxs("div",{children:[f.jsx("div",{style:{fontSize:"16px",fontWeight:"700"},children:"FinMate"}),f.jsx("div",{style:{fontSize:"10px",color:"#94A3B8"},children:r==="director"?"Director View":"Finance Team"})]})]}),f.jsx("button",{onClick:()=>He(!R),style:{background:"none",border:"none",color:"#94A3B8",cursor:"pointer",padding:"4px"},children:R?f.jsx(jm,{size:18}):f.jsx(VB,{size:18})})]}),!R&&f.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #334155",fontSize:"11px"},children:d?f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#FCD34D"},children:[f.jsx(B2,{size:12,style:{animation:"spin 1s linear infinite"}}),f.jsx("span",{children:"Saving..."})]}):p?f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#86EFAC"},children:[f.jsx(M2,{size:12}),f.jsxs("span",{children:["Saved ",p.toLocaleTimeString()]})]}):f.jsx("div",{style:{color:"#94A3B8"},children:"Cloud Sync Active"})}),f.jsx("div",{style:{padding:"8px",borderBottom:"1px solid #334155"},children:f.jsxs("button",{onClick:()=>I(!0),style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",borderRadius:"8px",border:"none",backgroundColor:Yi>0?"#FEF3C7":"#334155",color:Yi>0?"#92400E":"#94A3B8",cursor:"pointer",fontSize:"14px",fontWeight:Yi>0?"700":"500",justifyContent:R?"center":"flex-start",position:"relative"},title:"Notifications",children:[Yi>0?f.jsx(LB,{size:18}):f.jsx(P2,{size:18}),!R&&f.jsx("span",{children:"Notifications"}),Yi>0&&f.jsx("span",{style:{position:R?"absolute":"static",top:R?"4px":"auto",right:R?"4px":"auto",marginLeft:R?"0":"auto",backgroundColor:"#DC2626",color:"#FFFFFF",padding:"2px 6px",borderRadius:"10px",fontSize:"11px",fontWeight:"700",minWidth:"18px",textAlign:"center"},children:Yi})]})}),f.jsx("nav",{style:{flex:1,padding:"8px"},children:Q.map(ee=>f.jsxs("button",{onClick:()=>D(ee.id),style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",marginBottom:"4px",borderRadius:"8px",border:"none",backgroundColor:N===ee.id?"#2874A6":"transparent",color:N===ee.id?"#FFFFFF":"#94A3B8",cursor:"pointer",fontSize:"14px",fontWeight:N===ee.id?"600":"500",justifyContent:R?"center":"flex-start"},title:ee.label,children:[f.jsx(ee.icon,{size:18}),!R&&f.jsx("span",{children:ee.label})]},ee.id))}),f.jsxs("div",{style:{padding:"8px",borderTop:"1px solid #334155"},children:[f.jsxs("button",{onClick:()=>{_(!0),W({currentPassword:"",newPassword:"",confirmPassword:""}),w("")},style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",marginBottom:"8px",borderRadius:"8px",border:"none",backgroundColor:"#475569",color:"#FFFFFF",cursor:"pointer",fontSize:"14px",fontWeight:"500",justifyContent:R?"center":"flex-start"},title:"Change Password",children:[f.jsx(Pd,{size:18}),!R&&f.jsx("span",{children:"Change Password"})]}),f.jsxs("button",{onClick:H0,style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",borderRadius:"8px",border:"none",backgroundColor:"#DC2626",color:"#FFFFFF",cursor:"pointer",fontSize:"14px",fontWeight:"600",justifyContent:R?"center":"flex-start"},title:"Logout",children:[f.jsx(ll,{size:18}),!R&&f.jsx("span",{children:"Logout"})]})]})]})},Q4=()=>f.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(Um,{size:18,color:"#64748B"}),f.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"})]}),f.jsxs("div",{style:{position:"relative"},children:[f.jsx(Md,{size:15,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"text",placeholder:"Search...",value:lt.searchText,onChange:m=>vs(C=>({...C,searchText:m.target.value})),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"160px"}})]}),f.jsxs("select",{value:lt.party,onChange:m=>vs(C=>({...C,party:m.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:lt.party?"#EFF6FF":"#FFFFFF"},children:[f.jsx("option",{value:"",children:"All Parties"}),tl.map(m=>f.jsx("option",{value:m,children:m},m))]}),f.jsxs("select",{value:lt.billStatus,onChange:m=>vs(C=>({...C,billStatus:m.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:lt.billStatus?"#EFF6FF":"#FFFFFF"},children:[f.jsx("option",{value:"",children:"Bill Status"}),f.jsx("option",{value:"Yes",children:"Yes"}),f.jsx("option",{value:"Not Yet",children:"Not Yet"})]}),f.jsxs("select",{value:lt.invoiceStatus,onChange:m=>vs(C=>({...C,invoiceStatus:m.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:lt.invoiceStatus?"#EFF6FF":"#FFFFFF"},children:[f.jsx("option",{value:"",children:"Invoice Status"}),f.jsx("option",{value:"Generated",children:"Generated"}),f.jsx("option",{value:"Not Generated",children:"Not Generated"}),f.jsx("option",{value:"Paid",children:"Paid"})]}),nl&&f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:G0,style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(ll,{size:14})," Clear"]}),f.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",Iu.length," of ",xe.length]})]})]})}),cy=()=>{const m=xe.filter(H=>H.toBeBilled==="Yes"&&H.invoiceGenerated&&H.mailingSent==="Yes"&&(H.receiptStatus==="Received"||H.receiptStatus==="Cancelled"||H.receiptStatus==="Closed")),C=xe.filter(H=>!(H.toBeBilled==="Yes"&&H.invoiceGenerated&&H.mailingSent==="Yes"&&(H.receiptStatus==="Received"||H.receiptStatus==="Cancelled"||H.receiptStatus==="Closed"))),Q=Mn==="open"?C:m,ee=Q.filter(H=>{var ve,Me,ce,me,We;if(lt.party&&H.partyName!==lt.party||lt.billStatus&&H.toBeBilled!==lt.billStatus||lt.invoiceType&&H.invoiceType!==lt.invoiceType||lt.mailingStatus&&(lt.mailingStatus==="Sent"&&H.mailingSent!=="Yes"||lt.mailingStatus==="Not Sent"&&H.mailingSent==="Yes")||lt.invoiceStatus&&(lt.invoiceStatus==="Generated"&&!H.invoiceGenerated||lt.invoiceStatus==="Not Generated"&&H.invoiceGenerated||lt.invoiceStatus==="Approved"&&H.invoiceStatus!=="Approved"||lt.invoiceStatus==="Need Edits"&&H.invoiceStatus!=="Need Edits"||lt.invoiceStatus==="Paid"&&H.invoiceStatus!=="Paid"))return!1;if(lt.searchText){const re=lt.searchText.toLowerCase();if(!((ve=H.partyName)!=null&&ve.toLowerCase().includes(re))&&!((Me=H.senderName)!=null&&Me.toLowerCase().includes(re))&&!((ce=H.campaignName)!=null&&ce.toLowerCase().includes(re))&&!((me=H.subject)!=null&&me.toLowerCase().includes(re))&&!((We=H.invoiceNo)!=null&&We.toLowerCase().includes(re)))return!1}return!0}),Y=ee.reduce((H,ve)=>{const Me=ve.partyName||"Unknown";return H[Me]||(H[Me]=[]),H[Me].push(ve),H},{}),X=Object.keys(Y).sort();return f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[f.jsxs("div",{children:[f.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Master Sheet"}),f.jsxs("p",{style:{margin:"4px 0 0",fontSize:"14px",color:"#64748B"},children:[xe.length," campaigns  ",tl.length," parties  ",xe.filter(H=>H.invoiceGenerated).length," invoiced"]})]}),f.jsxs("div",{style:{display:"flex",gap:"10px"},children:[f.jsx("input",{type:"file",ref:B0,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:O4}),f.jsx(Xe,{icon:Ks,label:"Upload Data",variant:"brand",onClick:()=>{var H;return(H=B0.current)==null?void 0:H.click()}}),Qt&&xe.length>0&&f.jsx(Xe,{icon:Gs,label:"Clear All Data",variant:"danger",onClick:()=>ca(!0)})]})]}),f.jsxs("div",{style:{display:"flex",gap:"4px",marginBottom:"16px",backgroundColor:"#F1F5F9",padding:"4px",borderRadius:"10px",width:"fit-content"},children:[f.jsxs("button",{onClick:()=>Gr("open"),style:{padding:"10px 20px",fontSize:"14px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:Mn==="open"?"#FFFFFF":"transparent",color:Mn==="open"?"#1E293B":"#64748B",boxShadow:Mn==="open"?"0 2px 4px rgba(0,0,0,0.1)":"none"},children:[" Open Invoices (",C.length,")"]}),f.jsxs("button",{onClick:()=>Gr("closed"),style:{padding:"10px 20px",fontSize:"14px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:Mn==="closed"?"#FFFFFF":"transparent",color:Mn==="closed"?"#1E293B":"#64748B",boxShadow:Mn==="closed"?"0 2px 4px rgba(0,0,0,0.1)":"none"},children:[" Closed Invoices (",m.length,")"]})]}),xe.length>0&&Q4(),X.length===0?f.jsx(Tn,{children:f.jsxs("div",{style:{padding:"60px",textAlign:"center",color:"#94A3B8"},children:[f.jsx(Ks,{size:48,style:{marginBottom:"16px",opacity:.5}}),f.jsx("div",{style:{fontSize:"18px",fontWeight:"600"},children:nl?"No matching records":Mn==="closed"?"No closed invoices yet":"No Data Yet"}),f.jsx("div",{style:{fontSize:"14px",marginTop:"4px"},children:nl?"Try adjusting your filters":Mn==="closed"?"Invoices will appear here once billed, mailed, and payment received":"Upload an Excel file to get started"})]})}):f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:X.map(H=>{const ve=Y[H],Me=qt.has(H),ce=ve.filter(re=>re.toBeBilled==="Yes").length,me=ve.filter(re=>re.invoiceGenerated).length,We=ve.filter(re=>re.toBeBilled==="Yes").reduce((re,Ke)=>re+(parseFloat(Ke.totalWithGst)||0),0);return f.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:[f.jsxs("div",{onClick:()=>ly(H),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",backgroundColor:Mn==="closed"?"#F0FDF4":"#F8FAFC",cursor:"pointer",borderBottom:Me?"3px solid #2874A6":"none"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[Me?f.jsx(L2,{size:22,color:"#2874A6"}):f.jsx(jm,{size:22,color:"#64748B"}),f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:"700",fontSize:"16px",color:"#1E293B"},children:H}),f.jsxs("div",{style:{fontSize:"13px",color:"#64748B",marginTop:"3px"},children:[ve.length," campaigns  ",ce," billed  ",me," invoiced"]})]})]}),We>0&&f.jsxs("div",{style:{textAlign:"right"},children:[f.jsx("div",{style:{fontSize:"11px",color:"#64748B",textTransform:"uppercase"},children:"Total"}),f.jsx("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:ft(We)})]})]}),Me&&f.jsx("div",{style:{overflowX:"auto"},children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px",minWidth:"2100px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#F1F5F9"},children:[f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Date"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"100px"},children:"Sender"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",minWidth:"180px"},children:"Campaign / Subject"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"160px"},children:"Email ID"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"70px"},children:"Mailer"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"80px"},children:"Bill?"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"right",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Amount"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Type"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Generate"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"110px"},children:"Invoice No."}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"90px"},children:"Inv Date"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"right",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"100px"},children:"Inv Amount"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#7C3AED",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"50px"},children:"C#"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"120px"},children:"Status/Approve"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"120px"},children:"Actions"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#059669",borderBottom:"2px solid #E2E8F0",backgroundColor:"#F0FDF4",width:"80px"},children:"Mailed?"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#059669",borderBottom:"2px solid #E2E8F0",backgroundColor:"#F0FDF4",width:"90px"},children:"Mail Date"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#7C3AED",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"100px"},children:"Receipt"})]})}),f.jsx("tbody",{children:ve.map(re=>{var Ve,Ye;const Ke=re.invoiceType==="Combined"&&rl(re.combinationCode)&&re.mailingSent!=="Yes";ya(re);const de=Kr[re.id]&&Kr[re.id].length>0;return f.jsxs("tr",{style:{backgroundColor:re.toBeBilled==="Yes"?re.invoiceGenerated?"#F0FDF4":"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #F1F5F9"},children:[f.jsx("td",{style:{padding:"12px 14px",whiteSpace:"nowrap",fontSize:"13px"},children:xr(re.date)}),f.jsx("td",{style:{padding:"12px 14px",fontWeight:"600",fontSize:"13px"},children:re.senderName}),f.jsxs("td",{style:{padding:"12px 14px"},children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"13px",lineHeight:"1.4",color:"#1E293B"},children:((Ye=(Ve=re.campaignName)==null?void 0:Ve.split("--")[0])==null?void 0:Ye.trim())||re.senderName}),re.subject&&f.jsx("div",{style:{fontSize:"12px",color:"#64748B",marginTop:"4px",lineHeight:"1.3"},children:re.subject})]}),f.jsx("td",{style:{padding:"10px 14px"},children:f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[re.emailId&&f.jsx("div",{style:{fontSize:"11px",color:"#1E40AF",backgroundColor:"#EFF6FF",padding:"2px 6px",borderRadius:"4px",display:"inline-block"},children:re.emailId}),(re.additionalEmails||[]).map((Je,yt)=>f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[f.jsx("span",{style:{fontSize:"11px",color:"#059669",backgroundColor:"#F0FDF4",padding:"2px 6px",borderRadius:"4px"},children:Je}),f.jsx("button",{onClick:()=>ic(re.id,Je),style:{background:"none",border:"none",cursor:"pointer",padding:"2px",color:"#DC2626"},title:"Remove",children:f.jsx(ll,{size:12})})]},yt)),f.jsxs("button",{onClick:()=>{wr(re),ua(""),zt(!0)},style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",color:"#2874A6",background:"none",border:"none",cursor:"pointer",padding:"2px 0"},children:[f.jsx(j2,{size:12})," Add"]})]})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:de?f.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[f.jsx("span",{style:{color:"#22C55E",fontWeight:"700",fontSize:"14px"},children:""}),f.jsx("button",{onClick:()=>{wr(re),Ls(null),Qo(!0),pt(!0)},style:{fontSize:"10px",color:"#64748B",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},children:"Replace"})]}):f.jsx(Xe,{icon:jB,small:!0,variant:"default",onClick:()=>{wr(re),Ls(null),Qo(!1),pt(!0)}})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:f.jsxs("select",{value:re.toBeBilled,onChange:Je=>L4(re.id,Je.target.value),disabled:re.invoiceGenerated||!dn,style:{padding:"6px 8px",fontSize:"12px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:re.toBeBilled==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:re.toBeBilled==="Yes"?"#DCFCE7":"#FFFFFF",color:re.toBeBilled==="Yes"?"#166534":"#64748B",cursor:re.invoiceGenerated||!dn?"not-allowed":"pointer",width:"70px",opacity:!dn&&!re.invoiceGenerated?.6:1},children:[f.jsx("option",{value:"Not Yet",children:"Not Yet"}),f.jsx("option",{value:"Yes",children:"Yes"})]})}),f.jsx("td",{style:{padding:"10px 14px"},children:f.jsx("input",{type:"number",value:re.invoiceAmount||"",onChange:Je=>ed(re.id,"invoiceAmount",Je.target.value),disabled:re.invoiceGenerated,placeholder:"0",style:{width:"80px",padding:"6px 8px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #D1D5DB",borderRadius:"6px",textAlign:"right",backgroundColor:re.invoiceGenerated?"#F3F4F6":"#FFFFFF"}})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:re.invoiceGenerated?f.jsx(rg,{status:re.invoiceType,small:!0}):re.toBeBilled==="Yes"?f.jsxs("select",{value:re.invoiceType||"Individual",onChange:Je=>ed(re.id,"invoiceType",Je.target.value),style:{padding:"6px 6px",fontSize:"11px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:re.invoiceType==="Combined"?"#7C3AED":"#A5B4FC",backgroundColor:re.invoiceType==="Combined"?"#F3E8FF":"#E0E7FF",color:re.invoiceType==="Combined"?"#6B21A8":"#3730A3",cursor:"pointer",width:"80px"},children:[f.jsx("option",{value:"Individual",children:"Individual"}),f.jsx("option",{value:"Combined",children:"Combined"})]}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:re.toBeBilled==="Yes"&&!re.invoiceGenerated&&re.invoiceAmount&&Qt?re.invoiceType==="Individual"?f.jsx(Xe,{icon:$u,label:"Create",small:!0,variant:"warning",onClick:()=>B4(re)}):f.jsx(Xe,{icon:WB,label:"Combine",small:!0,variant:"purple",onClick:()=>U4(re)}):re.toBeBilled==="Yes"&&!re.invoiceGenerated&&re.invoiceAmount&&dn?f.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Finance to create"}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF"},children:re.invoiceNo?f.jsx("span",{style:{fontWeight:"700",color:"#1E40AF",fontSize:"12px"},children:re.invoiceNo}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF",fontSize:"12px"},children:re.invoiceDate?xr(re.invoiceDate):"-"}),f.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF",textAlign:"right",fontWeight:"700",color:"#1E40AF",fontSize:"13px"},children:re.invoiceTotalAmount?Ut(re.invoiceTotalAmount):"-"}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:re.combinationCode&&re.combinationCode!=="NA"?f.jsx("span",{style:{fontWeight:"700",color:"#7C3AED",fontSize:"12px"},children:re.combinationCode}):"-"}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:re.invoiceGenerated?dn?f.jsx("button",{onClick:()=>X0(re),style:{padding:"5px 10px",fontSize:"11px",fontWeight:"700",border:"1.5px solid",borderRadius:"6px",cursor:"pointer",backgroundColor:re.invoiceStatus==="Approved"?"#DCFCE7":re.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",borderColor:re.invoiceStatus==="Approved"?"#22C55E":re.invoiceStatus==="Need Edits"?"#DC2626":"#F59E0B",color:re.invoiceStatus==="Approved"?"#166534":re.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:re.invoiceStatus==="Approved"?" Approved":re.invoiceStatus==="Need Edits"?" Need Edits":" Review"}):f.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px"},children:[f.jsx("span",{style:{padding:"4px 10px",fontSize:"11px",fontWeight:"700",borderRadius:"6px",backgroundColor:re.invoiceStatus==="Approved"?"#DCFCE7":re.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",color:re.invoiceStatus==="Approved"?"#166534":re.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:re.invoiceStatus==="Approved"?" Approved":re.invoiceStatus==="Need Edits"?" Need Edits":" Pending"}),(re.editComments||re.approvalRemarks)&&f.jsx("button",{onClick:()=>{wr(re),Zt(!0)},style:{fontSize:"9px",color:re.invoiceStatus==="Need Edits"?"#991B1B":"#166534",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},title:re.editComments||re.approvalRemarks,children:"View Remarks"})]}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:re.invoiceGenerated&&re.invoiceStatus==="Approved"?f.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[f.jsx(Xe,{icon:Dd,small:!0,onClick:()=>Du(re),title:"View Invoice"}),Qt&&f.jsx(Xe,{icon:zm,small:!0,variant:"brand",onClick:()=>{wr(re),Yt(!0)},title:"Send Email"}),Qt&&f.jsx(Xe,{icon:Gs,small:!0,variant:"danger",onClick:()=>wn(re),title:"Delete"})]}):re.invoiceGenerated?f.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[f.jsx(Xe,{icon:Dd,small:!0,onClick:()=>Du(re),title:"View Invoice"}),Qt&&f.jsx(Xe,{icon:Gs,small:!0,variant:"danger",onClick:()=>wn(re),title:"Delete"})]}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#F0FDF4"},children:re.invoiceGenerated&&re.invoiceStatus==="Approved"&&Qt?Ke?f.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Combined sent"}):f.jsxs("select",{value:re.mailingSent||"No",onChange:Je=>ed(re.id,"mailingSent",Je.target.value),style:{padding:"5px 8px",fontSize:"11px",fontWeight:"700",border:"2px solid",borderRadius:"6px",borderColor:re.mailingSent==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:re.mailingSent==="Yes"?"#DCFCE7":"#FFFFFF",color:re.mailingSent==="Yes"?"#166534":"#64748B",cursor:"pointer",width:"60px"},children:[f.jsx("option",{value:"No",children:"No"}),f.jsx("option",{value:"Yes",children:"Yes"})]}):re.invoiceGenerated&&re.invoiceStatus==="Approved"&&dn?f.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"11px",fontWeight:"600",backgroundColor:re.mailingSent==="Yes"?"#DCFCE7":"#FEF3C7",color:re.mailingSent==="Yes"?"#166534":"#92400E"},children:re.mailingSent==="Yes"?" Yes":" No"}):re.invoiceGenerated&&re.invoiceStatus!=="Approved"?f.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Approve first"}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#F0FDF4"},children:re.mailingSent==="Yes"?Qt?f.jsx("input",{type:"date",value:re.mailDate||re.invoiceDate||"",onChange:Je=>ed(re.id,"mailDate",Je.target.value),style:{padding:"4px 6px",fontSize:"11px",border:"1.5px solid #D1D5DB",borderRadius:"6px",width:"100%"}}):f.jsx("span",{style:{fontSize:"11px"},children:xr(re.mailDate||re.invoiceDate)}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:re.receiptStatus==="Received"||re.receiptStatus==="Closed"?f.jsxs("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"700",backgroundColor:"#DCFCE7",color:"#166534"},children:[" ",re.receiptNo||"Received"]}):re.receiptStatus==="Cancelled"?f.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:" Cancelled"}):re.invoiceGenerated&&re.invoiceStatus==="Approved"?f.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"600",backgroundColor:"#FEF3C7",color:"#92400E"},children:" Pending"}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})})]},re.id)})})]})})]},H)})}),Q.length>0&&f.jsxs("div",{style:{marginTop:"16px",padding:"16px 20px",backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsxs("div",{style:{display:"flex",gap:"24px",fontSize:"14px",color:"#475569"},children:[f.jsxs("span",{children:[" Total: ",f.jsx("strong",{children:ee.length})]}),f.jsxs("span",{children:[" To Bill: ",f.jsx("strong",{children:ee.filter(H=>H.toBeBilled==="Yes").length})]}),f.jsxs("span",{children:[" Invoiced: ",f.jsx("strong",{children:ee.filter(H=>H.invoiceGenerated).length})]}),f.jsxs("span",{children:[" Approved: ",f.jsx("strong",{children:ee.filter(H=>H.invoiceStatus==="Approved").length})]}),Mn==="closed"&&f.jsxs("span",{children:[" Closed: ",f.jsx("strong",{children:ee.filter(H=>H.receiptStatus==="Received"||H.receiptStatus==="Cancelled"||H.receiptStatus==="Closed").length})]})]}),f.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:["Total: ",ft(ee.filter(H=>H.toBeBilled==="Yes").reduce((H,ve)=>H+(parseFloat(ve.totalWithGst)||0),0))]})]})]})},J4=()=>{const m=new Map;Rr.filter(ce=>ce.invoiceGenerated).forEach(ce=>{m.has(ce.invoiceNo)?m.get(ce.invoiceNo).campaigns.push(ce):m.set(ce.invoiceNo,{invoiceNo:ce.invoiceNo,partyName:ce.partyName,date:ce.invoiceDate,invoiceType:ce.invoiceType,combinationCode:ce.combinationCode,invoiceStatus:ce.invoiceStatus,mailingSent:ce.mailingSent,receiptStatus:ce.receiptStatus||"Pending",receiptNo:ce.receiptNo,campaigns:[ce],totalAmount:parseFloat(ce.invoiceTotalAmount)||0,isFromMaster:!0})});const C=ce=>{if(!ce)return"";const me=ce.split("/");return me.length>=3?me.slice(1).join("/"):me.length===2?me.join("/"):me[me.length-1]},Q=Ri.filter(ce=>{var me;return ce.isHistorical&&(ce.type==="creditnote"||((me=ce.vchNo)==null?void 0:me.toUpperCase().startsWith("CN")))}),ee=new Map;ec.forEach(ce=>{const me=C(ce.invoiceNo);me&&ee.set(me,ce)}),Q.forEach(ce=>{const me=C(ce.vchNo);me&&!ee.has(me)&&ee.set(me,ce)}),Ri.filter(ce=>{var me;return ce.isHistorical&&ce.type!=="creditnote"&&!((me=ce.vchNo)!=null&&me.toUpperCase().startsWith("CN"))&&ce.debit>0}).forEach(ce=>{if(!m.has(ce.vchNo)){const me=Zl.find(yt=>yt.invoiceNo===ce.vchNo),We=C(ce.vchNo),re=ee.get(We),Ke=re?Math.abs(parseFloat(re.totalAmount)||parseFloat(re.credit)||parseFloat(re.debit)||0):0,de=parseFloat(ce.debit)||0;if(re&&Ke>=de)return;const Ye=!me&&!(ce.amountReceived>0),Je=re&&Ke>0&&Ke<de;if(Ye||Je){const yt=Je?de-Ke:de;m.set(ce.vchNo,{invoiceNo:ce.vchNo,partyName:ce.partyName,date:ce.date,invoiceType:"Historical",combinationCode:"",invoiceStatus:"Approved",mailingSent:"Yes",receiptStatus:Je?"Partial CN":"Pending",receiptNo:"",campaigns:[],totalAmount:de,pendingAmount:yt,hasPartialCN:Je,cnAmount:Ke,isHistorical:!0,historicalEntry:ce})}}});let Y=Array.from(m.values());if(tr.party&&(Y=Y.filter(ce=>er(ce.partyName,tr.party))),tr.invoiceStatus&&(Y=Y.filter(ce=>ce.invoiceStatus===tr.invoiceStatus)),tr.receiptStatus&&(tr.receiptStatus==="Received"?Y=Y.filter(ce=>ce.receiptStatus==="Received"):tr.receiptStatus==="Pending"&&(Y=Y.filter(ce=>ce.receiptStatus!=="Received"))),tr.invoiceType&&(Y=Y.filter(ce=>ce.invoiceType===tr.invoiceType)),tr.searchText){const ce=tr.searchText.toLowerCase();Y=Y.filter(me=>{var We,re;return((We=me.invoiceNo)==null?void 0:We.toLowerCase().includes(ce))||((re=me.partyName)==null?void 0:re.toLowerCase().includes(ce))})}const X={};Y.forEach(ce=>{X[ce.partyName]||(X[ce.partyName]=[]),X[ce.partyName].push(ce)});const H=Object.keys(X).sort(),ve=tr.party||tr.invoiceStatus||tr.receiptStatus||tr.invoiceType||tr.searchText,Me=Array.from(m.values());return f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[f.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Invoice & Receipt Register"}),dn&&f.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"})]}),f.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(Um,{size:18,color:"#64748B"}),f.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"})]}),f.jsxs("div",{style:{position:"relative"},children:[f.jsx(Md,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"text",placeholder:"Search invoice...",value:tr.searchText,onChange:ce=>Ln(me=>({...me,searchText:ce.target.value})),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"160px"}})]}),f.jsxs("select",{value:tr.party,onChange:ce=>Ln(me=>({...me,party:ce.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[f.jsx("option",{value:"",children:"All Parties"}),tl.map(ce=>f.jsx("option",{value:ce,children:ce},ce))]}),f.jsxs("select",{value:tr.invoiceStatus,onChange:ce=>Ln(me=>({...me,invoiceStatus:ce.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[f.jsx("option",{value:"",children:"All Status"}),f.jsx("option",{value:"Created",children:"Created"}),f.jsx("option",{value:"Approved",children:"Approved"}),f.jsx("option",{value:"Need Edits",children:"Need Edits"})]}),f.jsxs("select",{value:tr.receiptStatus,onChange:ce=>Ln(me=>({...me,receiptStatus:ce.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[f.jsx("option",{value:"",children:"All Receipts"}),f.jsx("option",{value:"Received",children:"Received"}),f.jsx("option",{value:"Pending",children:"Pending"})]}),f.jsxs("select",{value:tr.invoiceType,onChange:ce=>Ln(me=>({...me,invoiceType:ce.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[f.jsx("option",{value:"",children:"All Types"}),f.jsx("option",{value:"Individual",children:"Individual"}),f.jsx("option",{value:"Combined",children:"Combined"})]}),ve&&f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:()=>Ln({party:"",invoiceStatus:"",receiptStatus:"",invoiceType:"",searchText:""}),style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(ll,{size:14})," Clear"]}),f.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",Y.length," of ",Me.length]})]})]})}),f.jsx(Tn,{noPadding:!0,children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[f.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Date"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Type"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:"Amount"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#F0FDF4",color:"#166534"},children:"Received"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEF3C7",color:"#92400E"},children:"TDS"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:"CN Amt"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#EFF6FF",color:"#1E40AF"},children:"Balance"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Inv. Status"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Receipt No."}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"CN No."}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),f.jsx("tbody",{children:H.length===0?f.jsx("tr",{children:f.jsx("td",{colSpan:"12",style:{padding:"50px",textAlign:"center",color:"#94A3B8"},children:ve?"No matching invoices":"No invoices generated yet"})}):H.map(ce=>{const me=X[ce],We=qt.has(ce);let re=0;return me.forEach(Ke=>{const de=Z.find(Nr=>Nr.invoiceNo===Ke.invoiceNo),Ve=Le.find(Nr=>Nr.invoiceNo===Ke.invoiceNo),Ye=Ae.find(Nr=>Nr.invoiceNo===Ke.invoiceNo&&Nr.type==="tds"),Je=Ae.find(Nr=>Nr.invoiceNo===Ke.invoiceNo&&Nr.type==="discount"),yt=Ke.totalAmount||0,Ge=de&&parseFloat(de.amount)||0,it=Ye?parseFloat(Ye.credit)||0:de&&parseFloat(de.tds)||0,jt=Ve?Math.abs(parseFloat(Ve.totalAmount)||0):0,ar=Je&&parseFloat(Je.credit)||0,or=Math.max(0,yt-Ge-it-jt-ar);re+=or}),f.jsxs($d.Fragment,{children:[f.jsxs("tr",{onClick:()=>ly(ce),style:{backgroundColor:"#1E3A5F",color:"white",cursor:"pointer",borderBottom:"1px solid #0F2744"},children:[f.jsx("td",{colSpan:"3",style:{padding:"10px 12px",fontWeight:"700",fontSize:"13px"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[We?f.jsx(L2,{size:18}):f.jsx(jm,{size:18}),f.jsx(z2,{size:16}),ce,f.jsxs("span",{style:{backgroundColor:"#2874A6",padding:"2px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600"},children:[me.length," inv"]})]})}),f.jsx("td",{colSpan:"4",style:{padding:"10px 12px"}}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",fontSize:"13px",backgroundColor:re===0?"#22C55E":"#3B82F6"},children:re===0?" Nil":`Bal: ${ft(re)}`}),f.jsx("td",{colSpan:"4",style:{padding:"10px 12px"}})]}),We&&me.map(Ke=>{const de=Z.find(_e=>_e.invoiceNo===Ke.invoiceNo),Ve=Le.find(_e=>_e.invoiceNo===Ke.invoiceNo),Ye=Ae.find(_e=>_e.invoiceNo===Ke.invoiceNo&&_e.type==="tds"),Je=Ae.find(_e=>_e.invoiceNo===Ke.invoiceNo&&_e.type==="discount"),yt=Ke.totalAmount||0,Ge=de&&parseFloat(de.amount)||0,it=Ye?parseFloat(Ye.credit)||0:de&&parseFloat(de.tds)||0,jt=Ve?Math.abs(parseFloat(Ve.totalAmount)||0):0,ar=Je&&parseFloat(Je.credit)||0,or=Math.max(0,yt-Ge-it-jt-ar),Nr=jt>=yt&&!de;return f.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:Ke.invoiceType==="Combined"?"#FAF5FF":or===0?"#F0FDF4":"transparent"},children:[f.jsx("td",{style:{padding:"10px 12px 10px 36px",fontWeight:"700",color:Ke.invoiceType==="Combined"?"#7C3AED":"#2874A6"},children:Ke.invoiceNo}),f.jsx("td",{style:{padding:"10px 12px"},children:xr(Ke.date)}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsx(rg,{status:Ke.invoiceType,small:!0})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:ft(yt)}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#F0FDF4",color:Ge>0?"#166534":"#94A3B8"},children:Ge>0?ft(Ge):"-"}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#FEF3C7",color:it>0?"#92400E":"#94A3B8"},children:it>0?ft(it):"-"}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#FEE2E2",color:jt>0?"#991B1B":"#94A3B8"},children:jt>0?ft(jt):"-"}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#EFF6FF",color:or>0?"#1E40AF":"#166534"},children:or===0?" Nil":ft(or)}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsx(rg,{status:Ke.invoiceStatus,small:!0})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:Nr?f.jsx("span",{style:{padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:" Cancelled"}):de?f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",justifyContent:"center"},children:[f.jsxs("button",{onClick:()=>Nu(de),style:{padding:"4px 8px",borderRadius:"12px",fontSize:"10px",fontWeight:"700",backgroundColor:"#DCFCE7",color:"#166534",border:"none",cursor:"pointer",textDecoration:"underline"},title:"Click to view receipt",children:[" ",de.receiptNo]}),Qt&&f.jsx("button",{onClick:()=>Z0(de),style:{padding:"2px 4px",borderRadius:"4px",fontSize:"10px",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete Receipt",children:""})]}):f.jsx("span",{style:{padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600",backgroundColor:"#FEF3C7",color:"#92400E"},children:" Pending"})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:Ve?f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",justifyContent:"center"},children:[f.jsx("button",{onClick:()=>P4(Ve),style:{padding:"4px 8px",borderRadius:"12px",fontSize:"10px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer",textDecoration:"underline"},title:"Click to view credit note",children:Ve.creditNoteNo}),Qt&&f.jsx("button",{onClick:()=>to(Ve),style:{padding:"2px 4px",borderRadius:"4px",fontSize:"10px",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete Credit Note",children:""})]}):f.jsx("span",{style:{color:"#94A3B8",fontSize:"11px"},children:"-"})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsx("div",{style:{display:"flex",gap:"4px",justifyContent:"center",flexWrap:"wrap"},children:Ke.isHistorical?f.jsxs(f.Fragment,{children:[Qt&&!de&&f.jsx(Xe,{icon:$u,small:!0,variant:"success",onClick:()=>{const _e={invoiceNo:Ke.invoiceNo,partyName:Ke.partyName,invoiceDate:Ke.date,invoiceTotalAmount:Ke.totalAmount,invoiceStatus:"Approved",mailingSent:"Yes",invoiceType:"Historical",isHistorical:!0};bu(_e)},title:"Create Receipt"}),Qt&&!Ve&&f.jsx(Xe,{icon:Hu,small:!0,variant:"primary",onClick:()=>{const _e={invoiceNo:Ke.invoiceNo,partyName:Ke.partyName,invoiceDate:Ke.date,invoiceTotalAmount:Ke.totalAmount,invoiceStatus:"Approved",isHistorical:!0};Ru(_e)},title:"Credit Note"})]}):f.jsxs(f.Fragment,{children:[f.jsx(Xe,{icon:Dd,small:!0,variant:"brand",onClick:()=>Du(Ke.campaigns[0]),title:"View Invoice"}),Qt&&Ke.invoiceStatus==="Approved"&&Ke.mailingSent==="Yes"&&!de&&f.jsx(Xe,{icon:$u,small:!0,variant:"success",onClick:()=>bu(Ke.campaigns[0]),title:"Create Receipt"}),Qt&&Ke.invoiceStatus==="Approved"&&!Ve&&f.jsx(Xe,{icon:Hu,small:!0,variant:"primary",onClick:()=>Ru(Ke.campaigns[0]),title:"Credit Note"}),Qt&&f.jsx(Xe,{icon:Gs,small:!0,variant:"danger",onClick:()=>wn(Ke.campaigns[0]),title:"Delete Invoice"})]})})})]},Ke.invoiceNo)})]},ce)})})]})})]})},Z4=()=>{if(!G){alert("Please select a party first");return}const m=Ei[G]||0,C=xe.filter(oe=>er(oe.partyName,G)&&oe.invoiceGenerated&&oe.invoiceStatus==="Approved"&&(!q||ga(oe.statePartyDetails)===q)),Q=new Map;C.forEach(oe=>{Q.has(oe.invoiceNo)?Q.get(oe.invoiceNo).campaigns.push(oe):Q.set(oe.invoiceNo,{invoiceNo:oe.invoiceNo,invoiceDate:oe.invoiceDate,campaigns:[oe],isFromMaster:!0})});const ee=new Set(Array.from(Q.keys())),Y=q?[]:Ae.filter(oe=>{var tt;return er(oe.partyName,G)&&oe.isHistorical&&oe.type!=="creditnote"&&!((tt=oe.vchNo)!=null&&tt.toUpperCase().startsWith("CN"))}),X=q?[]:Ae.filter(oe=>{var tt;return er(oe.partyName,G)&&oe.isHistorical&&(oe.type==="creditnote"||((tt=oe.vchNo)==null?void 0:tt.toUpperCase().startsWith("CN")))}),H=Z.filter(oe=>er(oe.partyName,G)&&(!q||ee.has(oe.invoiceNo))),ve=Le.filter(oe=>er(oe.partyName,G)&&(!q||ee.has(oe.invoiceNo))),Me=oe=>{if(!oe)return"";const tt=oe.split("/");return tt.length>=3?tt.slice(1).join("/"):tt.length===2?tt.join("/"):tt[tt.length-1]},ce=new Map;ve.forEach(oe=>{const tt=Me(oe.invoiceNo);tt&&!ce.has(tt)&&ce.set(tt,{...oe,isSystemCN:!0})}),X.forEach(oe=>{const tt=Me(oe.vchNo);tt&&!ce.has(tt)&&ce.set(tt,{...oe,isHistoricalCN:!0})});let me=[],We=0,re=0,Ke=0,de=0,Ve=m;const Ye=new Set;m!==0&&(We+=m>0?m:0,re+=m<0?Math.abs(m):0,me.push({date:"",particular:"Opening Balance",vchType:"",vchNo:"",debit:m>0?m:0,credit:m<0?Math.abs(m):0,receiptDate:"",amountReceived:0,tds:0,balance:m,status:"",isMain:!0,isOpening:!0}));const Je=[];Array.from(Q.values()).filter(oe=>{const tt=new Date(oe.invoiceDate);return tt>=new Date(tn.fromDate)&&tt<=new Date(tn.toDate)}).forEach(oe=>{Je.push({...oe,entryType:"invoice",sortDate:oe.invoiceDate})}),Y.filter(oe=>{if(!oe.date)return!1;const tt=new Date(oe.date);return tt>=new Date(tn.fromDate)&&tt<=new Date(tn.toDate)}).forEach(oe=>{Je.push({...oe,entryType:"invoice",sortDate:oe.date})}),Je.sort((oe,tt)=>new Date(oe.sortDate)-new Date(tt.sortDate)),Je.forEach(oe=>{var tt,Vt;if(oe.isFromMaster){const Tr=oe;let Dr=0;Tr.campaigns.forEach(li=>Dr+=parseFloat(li.invoiceAmount)||0);const lr=(Vt=(tt=Tr.campaigns[0])==null?void 0:tt.statePartyDetails)==null?void 0:Vt.toUpperCase().includes("MAHARASHTRA"),Pr=lr?Dr*.09:0,ai=lr?Dr*.09:0,Or=lr?0:Dr*.18,oi=Dr+Pr+ai+Or,cr=Me(Tr.invoiceNo),nn=ce.get(cr),jn=!!nn,Ea=H.find(li=>li.invoiceNo===Tr.invoiceNo);Ve+=oi,We+=oi;let no=0,Qi=0,il="",zs=jn?"":"Pending";if(Ea&&(zs="Received",no=Ea.amount||0,Qi=Ea.tds||0,il=Ea.date,Ke+=no,de+=Qi,Ve-=no+Qi+(Ea.discount||0)),me.push({date:Tr.invoiceDate,particular:G,vchType:"Sales",vchNo:Tr.invoiceNo,debit:oi,credit:0,receiptDate:il,amountReceived:no,tds:Qi,balance:jn?"-":zs==="Received"?0:oi-no-Qi,status:zs,isMain:!0,hasCN:jn}),me.push({particular:"PROMOTIONAL TRADE EMAILER"+(Tr.campaigns.length>1?"S":""),credit:Dr,isMain:!1,hasCN:jn}),lr?(me.push({particular:"CGST",credit:Pr,isMain:!1,hasCN:jn}),me.push({particular:"SGST",credit:ai,isMain:!1,hasCN:jn})):me.push({particular:"IGST",credit:Or,isMain:!1,hasCN:jn}),nn&&!Ye.has(cr)){Ye.add(cr);const li=Math.abs(nn.totalAmount||nn.credit||0);Ve-=li,re+=li,me.push({date:nn.date,particular:G,vchType:"Credit Note",vchNo:nn.creditNoteNo||nn.vchNo,debit:0,credit:li,receiptDate:"",amountReceived:0,tds:0,balance:"-",status:"",isMain:!0,isCreditNote:!0,hasCN:!0});const io=Math.abs(nn.amount)||li/1.18,id=Math.abs(nn.gst)||li-io;me.push({particular:"PROMOTIONAL TRADE EMAILER",credit:io,isMain:!1,isCreditNote:!0,hasCN:!0}),me.push({particular:nn.gstType||(lr?"CGST + SGST":"IGST"),credit:id,isMain:!1,isCreditNote:!0,hasCN:!0})}}else if(oe.isHistorical){const Tr=oe.debit||0,Dr=oe.credit||0,lr=Me(oe.vchNo),Pr=ce.get(lr),ai=!!Pr;if(Ve+=Tr-Dr,We+=Tr,re+=Dr,me.push({date:oe.date,particular:oe.particulars||G,vchType:oe.vchType||"Sales",vchNo:oe.vchNo,debit:Tr,credit:Dr,receiptDate:oe.receiptDate||"",amountReceived:oe.amountReceived||0,tds:oe.tdsReceived||0,balance:ai?"-":Tr-(oe.amountReceived||0)-(oe.tdsReceived||0),status:ai?"":oe.paymentStatus||"",isMain:!0,isHistorical:!0,hasCN:ai}),oe.subRows&&oe.subRows.length>0&&oe.subRows.forEach(Or=>{me.push({particular:Or.particular,debit:Or.debit,credit:Or.credit,isMain:!1,hasCN:ai})}),Pr&&!Ye.has(lr)){Ye.add(lr);const Or=Math.abs(Pr.totalAmount||Pr.credit||0);Ve-=Or,re+=Or,me.push({date:Pr.date,particular:G,vchType:"Credit Note",vchNo:Pr.creditNoteNo||Pr.vchNo,debit:0,credit:Or,receiptDate:"",amountReceived:0,tds:0,balance:"-",status:"",isMain:!0,isCreditNote:!0,hasCN:!0}),Pr.subRows&&Pr.subRows.length>0&&Pr.subRows.forEach(oi=>{me.push({particular:oi.particular,credit:Math.abs(oi.credit||0),isMain:!1,isCreditNote:!0,hasCN:!0})})}}});const yt=me.reduce((oe,tt)=>tt.isMain&&typeof tt.balance=="number"&&tt.balance>0?oe+tt.balance:oe,0),Ge=(G||"").trim().toUpperCase();let it={};q&&(it=qi.find(oe=>oe.partyNameUpper===Ge&&oe.normalizedState===q)||{}),it.state||(it=qi.find(oe=>oe.partyNameUpper===Ge)||{});const jt=xe.find(oe=>{var tt;return((tt=oe.partyName)==null?void 0:tt.trim().toUpperCase())===Ge}),ar=it.state||(jt==null?void 0:jt.statePartyDetails)||"",or=it.gstin||xa(G,ar),Nr=`
<!DOCTYPE html>
<html>
<head>
  <title>Ledger Account - ${G}</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; font-size: 11px; padding: 20px; }
    .header { text-align: center; margin-bottom: 15px; }
    .firm-name { font-size: 18px; font-weight: bold; color: #1E293B; }
    .firm-address { font-size: 10px; color: #666; margin-top: 2px; }
    .party-section { text-align: center; margin: 15px 0; padding: 10px; border: 1px solid #ddd; background: #f9f9f9; }
    .party-name { font-size: 14px; font-weight: bold; }
    .ledger-title { font-size: 11px; color: #666; }
    .party-address { font-size: 10px; color: #666; margin-top: 5px; }
    .party-gstin { font-size: 10px; color: #1a5276; margin-top: 3px; font-weight: 600; }
    .period { text-align: center; font-size: 11px; margin: 10px 0; font-weight: bold; }
    .totals { display: flex; justify-content: space-around; background: #e8f4fd; padding: 8px; margin-bottom: 10px; font-size: 10px; border: 1px solid #ccc; }
    .totals div { text-align: center; }
    .totals .label { color: #666; }
    .totals .value { font-weight: bold; font-size: 11px; }
    .closing-balance { text-align: center; background: #1E293B; color: white; padding: 10px; margin-bottom: 10px; font-size: 14px; font-weight: bold; }
    table { width: 100%; border-collapse: collapse; font-size: 10px; }
    th { background: #f0f0f0; border: 1px solid #ccc; padding: 6px 4px; text-align: left; font-weight: bold; }
    td { border: 1px solid #ddd; padding: 5px 4px; }
    .text-right { text-align: right; }
    .text-center { text-align: center; }
    .main-row { background: #fff; }
    .main-row-cn { background: #fffbeb; }
    .sub-row { background: #fafafa; }
    .sub-row-cn { background: #fffbeb; }
    .sub-row td { padding-left: 20px; color: #666; font-size: 9px; }
    .opening-row { background: #fef3c7; font-weight: bold; }
    .credit-note-row { background: #fffbeb; }
    .status-received { background: #dcfce7; color: #166534; padding: 2px 6px; border-radius: 3px; font-size: 9px; }
    .status-pending { background: #fef3c7; color: #92400e; padding: 2px 6px; border-radius: 3px; font-size: 9px; }
    .debit { color: #dc2626; }
    .credit { color: #059669; }
    @media print { 
      body { padding: 10px; } 
      @page { size: landscape; margin: 10mm; }
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="firm-name">${S.name}</div>
    <div class="firm-address">${S.address}</div>
    <div class="firm-address">${S.addressLine2}, ${S.city}</div>
    <div class="firm-address">E-Mail: ${S.email}</div>
  </div>
  
  <div class="party-section">
    <div class="party-name">${G}</div>
    <div class="ledger-title">Ledger Account</div>
    ${ar?`<div class="party-address">${ar}</div>`:""}
    ${or?`<div class="party-gstin">GSTIN: ${or}</div>`:""}
  </div>
  
  <div class="period">${xr(tn.fromDate)} to ${xr(tn.toDate)}</div>
  
  <div class="closing-balance">
    Closing Balance: ${Ut(Math.abs(yt))} ${yt>0?"(Dr)":yt<0?"(Cr)":""}
  </div>
  
  <div class="totals">
    <div><div class="label">Debit</div><div class="value">${Ut(We)}</div></div>
    <div><div class="label">Credit</div><div class="value">${Ut(re)}</div></div>
    <div><div class="label">Amount Received</div><div class="value credit">${Ut(Ke)}</div></div>
    <div><div class="label">TDS Received</div><div class="value">${Ut(de)}</div></div>
  </div>
  
  <table>
    <thead>
      <tr>
        <th style="width:65px">Date</th>
        <th>Particular</th>
        <th style="width:70px" class="text-center">Vch Type</th>
        <th style="width:100px">Vch No.</th>
        <th style="width:80px" class="text-right">Debit</th>
        <th style="width:80px" class="text-right">Credit</th>
        <th style="width:70px" class="text-center">Date of Receipt</th>
        <th style="width:85px" class="text-right">Amount Received</th>
        <th style="width:70px" class="text-right">TDS Received</th>
        <th style="width:75px" class="text-right">Balance</th>
        <th style="width:70px" class="text-center">Payment Status</th>
      </tr>
    </thead>
    <tbody>
      ${me.map(oe=>oe.isMain?`
        <tr class="${oe.isOpening?"opening-row":oe.hasCN||oe.isCreditNote?"main-row-cn":"main-row"}">
          <td>${oe.date?xr(oe.date):""}</td>
          <td style="font-weight:600">${oe.particular}</td>
          <td class="text-center">${oe.vchType||""}</td>
          <td style="color:#2874A6;font-weight:600">${oe.vchNo||""}</td>
          <td class="text-right">${oe.debit>0?Ut(oe.debit):""}</td>
          <td class="text-right" style="color:#DC2626">${oe.credit>0?Ut(oe.credit):""}</td>
          <td class="text-center">${oe.receiptDate?xr(oe.receiptDate):""}</td>
          <td class="text-right credit">${oe.amountReceived>0?Ut(oe.amountReceived):""}</td>
          <td class="text-right">${oe.tds>0?Ut(oe.tds):""}</td>
          <td class="text-right">${oe.balance==="-"?"-":oe.balance>0?Ut(oe.balance):""}</td>
          <td class="text-center">${oe.status?`<span class="${oe.status==="Received"?"status-received":"status-pending"}">${oe.status}</span>`:""}</td>
        </tr>
      `:`
        <tr class="${oe.hasCN||oe.isCreditNote?"sub-row-cn":"sub-row"}">
          <td></td>
          <td style="padding-left:20px;color:#666">${oe.particular}</td>
          <td></td>
          <td></td>
          <td class="text-right">${oe.debit?Ut(oe.debit):""}</td>
          <td class="text-right">${oe.credit?Ut(oe.credit):""}</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
      `).join("")}
    </tbody>
  </table>
  
  <script>window.onload = function() { window.print(); }<\/script>
</body>
</html>`,_e=window.open("","_blank");_e.document.write(Nr),_e.document.close()},eF=()=>{const m=(H,ve)=>{const Me=Ei[H]||0,ce=xe.filter(Ge=>er(Ge.partyName,H)&&Ge.invoiceGenerated&&Ge.invoiceStatus==="Approved"&&(!ve||ga(Ge.statePartyDetails)===ve)),me=new Map;ce.forEach(Ge=>{me.has(Ge.invoiceNo)?me.get(Ge.invoiceNo).campaigns.push(Ge):me.set(Ge.invoiceNo,{invoiceNo:Ge.invoiceNo,campaigns:[Ge],totalAmount:parseFloat(Ge.invoiceTotalAmount)||0})});const We=new Set(Array.from(me.keys())),re=Z.filter(Ge=>er(Ge.partyName,H)&&(!ve||We.has(Ge.invoiceNo))),Ke=Le.filter(Ge=>er(Ge.partyName,H)&&(!ve||We.has(Ge.invoiceNo))),de=ve?[]:Ae.filter(Ge=>{var it;return er(Ge.partyName,H)&&Ge.isHistorical&&Ge.type!=="creditnote"&&!((it=Ge.vchNo)!=null&&it.toUpperCase().startsWith("CN"))}),Ve=ve?[]:Ae.filter(Ge=>{var it;return er(Ge.partyName,H)&&Ge.isHistorical&&(Ge.type==="creditnote"||((it=Ge.vchNo)==null?void 0:it.toUpperCase().startsWith("CN")))}),Ye=Ge=>{if(!Ge)return"";const it=Ge.split("/");return it.length>=3?it.slice(1).join("/"):it.length===2?it.join("/"):it[it.length-1]},Je=new Map;Ke.forEach(Ge=>{const it=Ye(Ge.invoiceNo);it&&!Je.has(it)&&Je.set(it,Ge)}),Ve.forEach(Ge=>{const it=Ye(Ge.vchNo);it&&!Je.has(it)&&Je.set(it,Ge)});let yt=0;return Me>0&&(yt+=Me),Array.from(me.values()).forEach(Ge=>{const it=Ge.totalAmount,jt=Ye(Ge.invoiceNo),ar=Je.get(jt),or=ar?Math.abs(parseFloat(ar.totalAmount)||parseFloat(ar.credit)||0):0;if(!(ar&&or>=it)){let _e=ar?it-or:it;const oe=re.find(tt=>tt.invoiceNo===Ge.invoiceNo);if(oe){const tt=_e-(parseFloat(oe.amount)||0)-(parseFloat(oe.tds)||0)-(parseFloat(oe.discount)||0);tt>0&&(yt+=tt)}else _e>0&&(yt+=_e)}}),de.forEach(Ge=>{const it=Ye(Ge.vchNo),jt=Je.get(it),ar=jt?Math.abs(parseFloat(jt.totalAmount)||parseFloat(jt.credit)||parseFloat(jt.debit)||0):0,or=parseFloat(Ge.debit)||0;if(!(jt&&ar>=or)){let _e=jt?or-ar:or;const oe=parseFloat(Ge.amountReceived)||0,tt=parseFloat(Ge.tdsReceived)||0,Vt=_e-oe-tt;Vt>0&&(yt+=Vt)}}),yt},C=qi.filter(H=>H.partyName.toLowerCase().includes(da.toLowerCase())||H.state&&H.state.toLowerCase().includes(da.toLowerCase())),Q=H=>{if(q){const me=qi.find(We=>We.partyNameUpper===(H||"").trim().toUpperCase()&&We.normalizedState===q);if(me!=null&&me.state)return me.state}const ve=(H||"").trim().toUpperCase(),Me=xe.find(me=>{var We;return((We=me.partyName)==null?void 0:We.trim().toUpperCase())===ve});if(Me!=null&&Me.statePartyDetails)return Me.statePartyDetails;const ce=qi.find(me=>me.partyNameUpper===ve);return(ce==null?void 0:ce.state)||""},ee=H=>{const ve=(H||"").trim().toUpperCase();if(q){const me=qi.find(We=>We.partyNameUpper===ve&&We.normalizedState===q);if(me!=null&&me.gstin)return me.gstin}const Me=qi.find(me=>me.partyNameUpper===ve);if(Me!=null&&Me.gstin)return Me.gstin;const ce=xe.find(me=>{var We;return((We=me.partyName)==null?void 0:We.trim().toUpperCase())===ve});return ce?xa(H,ce.statePartyDetails):""},X=(()=>{if(!G)return{entries:[],totals:{debit:0,credit:0,received:0,tds:0,balance:0}};const H=Ei[G]||0,ve=_e=>{if(!_e)return"";const oe=_e.split("/");return oe.length>=3?oe.slice(1).join("/"):oe.length===2?oe.join("/"):oe[oe.length-1]},Me=xe.filter(_e=>er(_e.partyName,G)&&_e.invoiceGenerated&&_e.invoiceStatus==="Approved"&&(!q||ga(_e.statePartyDetails)===q)),ce=new Map;Me.forEach(_e=>{ce.has(_e.invoiceNo)?ce.get(_e.invoiceNo).campaigns.push(_e):ce.set(_e.invoiceNo,{invoiceNo:_e.invoiceNo,invoiceDate:_e.invoiceDate,invoiceType:_e.invoiceType,combinationCode:_e.combinationCode,receiptStatus:_e.receiptStatus,receiptNo:_e.receiptNo,receiptDate:_e.receiptDate,creditNoteNo:_e.creditNoteNo,campaigns:[_e],isFromMaster:!0})});const me=new Set(Array.from(ce.keys())),We=q?[]:Ae.filter(_e=>{var oe;return er(_e.partyName,G)&&_e.isHistorical&&_e.type!=="creditnote"&&!((oe=_e.vchNo)!=null&&oe.toUpperCase().startsWith("CN"))}),re=q?[]:Ae.filter(_e=>{var oe;return er(_e.partyName,G)&&_e.isHistorical&&(_e.type==="creditnote"||((oe=_e.vchNo)==null?void 0:oe.toUpperCase().startsWith("CN")))}),Ke=Z.filter(_e=>er(_e.partyName,G)&&(!q||me.has(_e.invoiceNo))),de=Le.filter(_e=>er(_e.partyName,G)&&(!q||me.has(_e.invoiceNo))),Ve=new Map;de.forEach(_e=>{const oe=ve(_e.invoiceNo);oe&&!Ve.has(oe)&&Ve.set(oe,{..._e,isSystemCN:!0})}),re.forEach(_e=>{const oe=ve(_e.vchNo);oe&&!Ve.has(oe)&&Ve.set(oe,{..._e,isHistoricalCN:!0})});const Ye=[];let Je=H,yt=0,Ge=0,it=0,jt=0;const ar=new Set;H!==0&&(Ye.push({id:"opening",date:"",particular:"Opening Balance",vchType:"",vchNo:"",debit:H>0?H:0,credit:H<0?Math.abs(H):0,receiptDate:"",amountReceived:0,tdsReceived:0,balance:H,paymentStatus:"",isOpening:!0,subRows:[]}),yt+=H>0?H:0,Ge+=H<0?Math.abs(H):0);const or=[];Array.from(ce.values()).filter(_e=>{const oe=new Date(_e.invoiceDate),tt=new Date(tn.fromDate),Vt=new Date(tn.toDate);return oe>=tt&&oe<=Vt}).forEach(_e=>{or.push({..._e,entryType:"invoice",sortDate:_e.invoiceDate})}),We.filter(_e=>{if(!_e.date)return!1;const oe=new Date(_e.date),tt=new Date(tn.fromDate),Vt=new Date(tn.toDate);return oe>=tt&&oe<=Vt}).forEach(_e=>{or.push({..._e,entryType:_e.type||"invoice",sortDate:_e.date})}),or.sort((_e,oe)=>new Date(_e.sortDate)-new Date(oe.sortDate)),or.forEach(_e=>{var oe,tt;if(_e.isFromMaster){const Vt=_e;let Tr=0;Vt.campaigns.forEach(Ws=>{Tr+=parseFloat(Ws.invoiceAmount)||0});const Dr=(tt=(oe=Vt.campaigns[0])==null?void 0:oe.statePartyDetails)==null?void 0:tt.toUpperCase().includes("MAHARASHTRA"),lr=Dr?Tr*.09:0,Pr=Dr?Tr*.09:0,ai=Dr?0:Tr*.18,Or=Tr+lr+Pr+ai,oi=ve(Vt.invoiceNo),cr=Ve.get(oi),nn=cr?Math.abs(cr.totalAmount||cr.credit||0):0,jn=!!cr,Ea=jn&&nn>=Or,no=jn&&!Ea?Or-nn:0,Qi=Ke.find(Ws=>Ws.invoiceNo===Vt.invoiceNo);Je+=Or,yt+=Or;const il=[{particular:"PROMOTIONAL TRADE EMAILER"+(Vt.campaigns.length>1?"S":""),credit:Tr}];Dr?(il.push({particular:"CGST",credit:lr}),il.push({particular:"SGST",credit:Pr})):il.push({particular:"IGST",credit:ai});let zs="",li=0,io=0,id="",lc=Or;if(Qi?(zs="Received",li=Qi.amount||0,io=Qi.tds||0,id=Qi.date,it+=li,jt+=io,lc=Or-li-io-(Qi.discount||0),Je-=li+io+(Qi.discount||0)):Vt.receiptStatus==="Received"?(zs="Received",lc=0):Ea?(zs="CN Closed",lc=0):jn&&no>0?(zs="Partial CN",lc=no):zs="Pending",Ye.push({id:Vt.invoiceNo,date:Vt.invoiceDate,particular:G,vchType:"Sales",vchNo:Vt.invoiceNo,debit:Or,credit:0,receiptDate:id,amountReceived:li,tdsReceived:io,balance:Ea?"-":lc>0?lc:0,paymentStatus:zs,isInvoice:!0,hasCN:jn,subRows:il}),cr&&!ar.has(oi)){ar.add(oi);const Ws=Math.abs(cr.totalAmount||cr.credit||0);Je-=Ws,Ge+=Ws;const sl=[];if(cr.amount&&sl.push({particular:"PROMOTIONAL TRADE EMAILER",credit:Math.abs(cr.amount)}),cr.gst&&sl.push({particular:cr.gstType||(Dr?"CGST + SGST":"IGST"),credit:Math.abs(cr.gst)}),sl.length===0&&Ws>0){const hy=Ws/1.18,oF=Ws-hy;sl.push({particular:"PROMOTIONAL TRADE EMAILER",credit:hy}),sl.push({particular:Dr?"CGST + SGST":"IGST",credit:oF})}Ye.push({id:cr.id||cr.creditNoteNo||`cn-${oi}`,date:cr.date,particular:G,vchType:"Credit Note",vchNo:cr.creditNoteNo||cr.vchNo,debit:0,credit:Ws,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:cr.isHistoricalCN&&cr.subRows||sl})}}else if(_e.isHistorical){const Vt=_e.debit||0,Tr=_e.credit||0,Dr=ve(_e.vchNo),lr=Ve.get(Dr),Pr=lr?Math.abs(lr.totalAmount||lr.credit||0):0,ai=!!lr,Or=ai&&Pr>=Vt,oi=ai&&!Or?Vt-Pr:0;Je+=Vt-Tr,yt+=Vt,Ge+=Tr,_e.amountReceived&&(it+=_e.amountReceived),_e.tdsReceived&&(jt+=_e.tdsReceived);const cr=_e.subRows||[];let nn=Vt-(_e.amountReceived||0)-(_e.tdsReceived||0),jn=_e.paymentStatus||"";Or?(nn=0,jn="CN Closed"):ai&&oi>0&&(nn=oi-(_e.amountReceived||0)-(_e.tdsReceived||0),nn>0&&(jn="Partial CN")),Ye.push({id:_e.id,date:_e.date,particular:_e.particulars||G,vchType:_e.vchType||"Sales",vchNo:_e.vchNo,debit:Vt,credit:Tr,receiptDate:_e.receiptDate||"",amountReceived:_e.amountReceived||0,tdsReceived:_e.tdsReceived||0,balance:Or?"-":nn>0?nn:0,paymentStatus:jn,isInvoice:!0,isHistorical:!0,hasCN:ai,subRows:cr}),lr&&!ar.has(Dr)&&(ar.add(Dr),Je-=Pr,Ge+=Pr,Ye.push({id:lr.id||lr.creditNoteNo||lr.vchNo||`cn-${Dr}`,date:lr.date,particular:G,vchType:"Credit Note",vchNo:lr.creditNoteNo||lr.vchNo,debit:0,credit:Pr,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:lr.subRows||[]}))}});const Nr=Ye.reduce((_e,oe)=>typeof oe.balance=="number"&&oe.balance>0?_e+oe.balance:_e,0);return{entries:Ye,totals:{debit:yt,credit:Ge,received:it,tds:jt,balance:Nr}}})();return f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[f.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Party Ledgers"}),f.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[dn&&f.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"}),Qt&&f.jsx(Xe,{icon:Ks,label:"Import Historical",variant:"brand",onClick:()=>Zo(!0)}),Qt&&G&&Ae.some(H=>er(H.partyName,G)&&H.isHistorical)&&f.jsx(Xe,{icon:Gs,label:"Clear Historical",variant:"danger",onClick:v}),Qt&&f.jsx(Xe,{icon:Wm,label:"Opening Balance",variant:"primary",onClick:()=>Ki(!0)})]})]}),f.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(BB,{size:18,color:"#64748B"}),f.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Period:"})]}),f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx("input",{type:"date",value:tn.fromDate,onChange:H=>fa(ve=>({...ve,fromDate:H.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}}),f.jsx("span",{style:{color:"#64748B"},children:"to"}),f.jsx("input",{type:"date",value:tn.toDate,onChange:H=>fa(ve=>({...ve,toDate:H.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}})]}),f.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:"10px"},children:G&&f.jsx(Xe,{icon:Wu,label:"Download PDF",variant:"brand",onClick:Z4})})]})}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr",gap:"16px"},children:[f.jsxs(Tn,{title:"Parties",noPadding:!0,children:[f.jsx("div",{style:{padding:"12px",borderBottom:"1px solid #E2E8F0"},children:f.jsxs("div",{style:{position:"relative"},children:[f.jsx(Md,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"text",placeholder:"Search party...",value:da,onChange:H=>ha(H.target.value),style:{width:"100%",padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",boxSizing:"border-box"}})]})}),f.jsx("div",{style:{maxHeight:"450px",overflowY:"auto"},children:C.length===0?f.jsx("div",{style:{padding:"30px",textAlign:"center",color:"#94A3B8",fontSize:"14px"},children:da?"No matching parties":"No parties yet"}):C.map((H,ve)=>{const Me=m(H.partyName,H.normalizedState),ce=er(G,H.partyName)&&q===H.normalizedState;return f.jsxs("div",{onClick:()=>{J(H.partyName),he(H.normalizedState||null)},style:{padding:"14px 18px",borderBottom:"1px solid #F1F5F9",cursor:"pointer",backgroundColor:ce?"#EFF6FF":"transparent",borderLeft:ce?"4px solid #2874A6":"4px solid transparent"},children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"14px",color:"#1E293B"},children:H.partyName}),H.state&&f.jsxs("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"2px"},children:[" ",H.state]}),H.gstin&&f.jsxs("div",{style:{fontSize:"10px",color:"#2874A6",marginTop:"1px"},children:["GST: ",H.gstin]}),f.jsxs("div",{style:{fontSize:"14px",color:Me>0?"#DC2626":"#059669",fontWeight:"700",marginTop:"4px"},children:[Me>0?"Dr. ":"Cr. ",ft(Math.abs(Me))]})]},`${H.partyName}-${H.state}-${ve}`)})})]}),f.jsx(Tn,{title:G?"Ledger Account":"Select a Party",noPadding:!0,children:G?f.jsxs("div",{style:{fontSize:"12px"},children:[f.jsxs("div",{style:{textAlign:"center",padding:"16px",borderBottom:"2px solid #1E3A5F",backgroundColor:"#F8FAFC"},children:[f.jsx("div",{style:{fontSize:"16px",fontWeight:"700",color:"#1E3A5F"},children:S.name}),f.jsx("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"4px"},children:S.address}),f.jsxs("div",{style:{fontSize:"11px",color:"#64748B"},children:[S.addressLine2,", ",S.city]}),f.jsxs("div",{style:{fontSize:"11px",color:"#64748B"},children:["E-Mail: ",S.email]})]}),f.jsxs("div",{style:{textAlign:"center",padding:"12px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FFFFFF"},children:[f.jsx("div",{style:{fontSize:"14px",fontWeight:"700",color:"#1E293B"},children:G}),f.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#64748B"},children:"Ledger Account"}),Q(G)&&f.jsxs("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"4px"},children:[" ",Q(G)]}),ee(G)&&f.jsxs("div",{style:{fontSize:"11px",color:"#2874A6",marginTop:"3px",fontWeight:"600"},children:["GSTIN: ",ee(G)]})]}),f.jsx("div",{style:{textAlign:"center",padding:"8px",backgroundColor:"#F1F5F9",borderBottom:"1px solid #E2E8F0"},children:f.jsxs("span",{style:{fontSize:"11px",fontWeight:"600",color:"#475569"},children:[xr(tn.fromDate)," to ",xr(tn.toDate)]})}),f.jsxs("div",{style:{backgroundColor:"#1E293B",color:"white",padding:"12px 16px",display:"flex",justifyContent:"center",alignItems:"center",gap:"12px",borderBottom:"3px solid #F59E0B"},children:[f.jsx("span",{style:{fontSize:"14px",fontWeight:"600"},children:"Closing Balance:"}),f.jsxs("span",{style:{fontSize:"18px",fontWeight:"700",color:X.totals.balance>0?"#FCA5A5":"#86EFAC"},children:[Ut(Math.abs(X.totals.balance))," ",X.totals.balance>0?"(Dr)":X.totals.balance<0?"(Cr)":""]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",backgroundColor:"#EFF6FF",borderBottom:"2px solid #2874A6",fontSize:"11px"},children:[f.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[f.jsx("div",{style:{color:"#64748B"},children:"Debit"}),f.jsx("div",{style:{fontWeight:"700",color:"#1E293B"},children:Ut(X.totals.debit)})]}),f.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[f.jsx("div",{style:{color:"#64748B"},children:"Credit"}),f.jsx("div",{style:{fontWeight:"700",color:"#DC2626"},children:Ut(X.totals.credit)})]}),f.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[f.jsx("div",{style:{color:"#64748B"},children:"Amount Received"}),f.jsx("div",{style:{fontWeight:"700",color:"#059669"},children:Ut(X.totals.received)})]}),f.jsxs("div",{style:{padding:"8px",textAlign:"center"},children:[f.jsx("div",{style:{color:"#64748B"},children:"TDS Received"}),f.jsx("div",{style:{fontWeight:"700",color:"#1E293B"},children:Ut(X.totals.tds)})]})]}),f.jsx("div",{style:{overflowX:"auto"},children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px",minWidth:"1000px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[f.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",width:"75px",borderRight:"1px solid #E2E8F0"},children:"Date"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",minWidth:"150px",borderRight:"1px solid #E2E8F0"},children:"Particular"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"80px",borderRight:"1px solid #E2E8F0"},children:"Vch Type"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",width:"110px",borderRight:"1px solid #E2E8F0"},children:"Vch No."}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Debit"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Credit"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"85px",borderRight:"1px solid #E2E8F0"},children:"Date of Receipt"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Amount Received"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"80px",borderRight:"1px solid #E2E8F0"},children:"TDS Received"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"85px",borderRight:"1px solid #E2E8F0"},children:"Balance"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"75px",borderRight:"1px solid #E2E8F0"},children:"Payment Status"}),Qt&&f.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"50px"},children:"Action"})]})}),f.jsx("tbody",{children:X.entries.length===0?f.jsx("tr",{children:f.jsx("td",{colSpan:Qt?"12":"11",style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:"No entries in selected period"})}):X.entries.map(H=>f.jsxs($d.Fragment,{children:[f.jsxs("tr",{style:{backgroundColor:H.isOpening?"#FEF3C7":H.hasCN||H.isCreditNote?"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #E2E8F0",borderLeft:H.hasCN||H.isCreditNote?"4px solid #F59E0B":"none"},children:[f.jsx("td",{style:{padding:"8px",borderRight:"1px solid #E2E8F0"},children:H.date?xr(H.date):""}),f.jsx("td",{style:{padding:"8px",fontWeight:"600",color:H.isCreditNote?"#DC2626":"#1E293B",borderRight:"1px solid #E2E8F0"},children:H.particular}),f.jsx("td",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #E2E8F0"},children:H.vchType&&f.jsx("span",{style:{padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:H.vchType==="Sales"?"#DCFCE7":"#FEE2E2",color:H.vchType==="Sales"?"#166534":"#991B1B"},children:H.vchType})}),f.jsx("td",{style:{padding:"8px",borderRight:"1px solid #E2E8F0"},children:H.vchNo&&H.isInvoice&&!H.isHistorical?f.jsx("button",{onClick:()=>ac(H.vchNo),style:{background:"none",border:"none",padding:0,fontWeight:"600",color:"#2874A6",cursor:"pointer",textDecoration:"underline",fontSize:"11px"},title:"Click to view invoice",children:H.vchNo}):f.jsx("span",{style:{fontWeight:"600",color:H.isCreditNote?"#DC2626":"#2874A6"},children:H.vchNo})}),f.jsx("td",{style:{padding:"8px",textAlign:"right",fontWeight:"600",borderRight:"1px solid #E2E8F0"},children:H.debit>0?Ut(H.debit):""}),f.jsx("td",{style:{padding:"8px",textAlign:"right",color:"#DC2626",borderRight:"1px solid #E2E8F0"},children:H.credit>0?Ut(H.credit):""}),f.jsx("td",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #E2E8F0"},children:H.receiptDate?xr(H.receiptDate):""}),f.jsx("td",{style:{padding:"8px",textAlign:"right",color:"#059669",fontWeight:H.amountReceived>0?"600":"400",borderRight:"1px solid #E2E8F0"},children:H.amountReceived>0?Ut(H.amountReceived):""}),f.jsx("td",{style:{padding:"8px",textAlign:"right",borderRight:"1px solid #E2E8F0"},children:H.tdsReceived>0?Ut(H.tdsReceived):""}),f.jsx("td",{style:{padding:"8px",textAlign:"right",fontWeight:"600",color:typeof H.balance=="number"&&H.balance>0?"#DC2626":"",borderRight:"1px solid #E2E8F0"},children:H.isOpening?H.balance>0?Ut(H.balance):"":H.balance==="-"?"-":typeof H.balance=="number"&&H.balance>0?Ut(H.balance):"-"}),f.jsx("td",{style:{padding:"8px",textAlign:"center"},children:H.paymentStatus&&f.jsx("span",{style:{padding:"2px 8px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:H.paymentStatus==="Received"?"#DCFCE7":"#FEF3C7",color:H.paymentStatus==="Received"?"#166534":"#92400E"},children:H.paymentStatus})}),Qt&&f.jsx("td",{style:{padding:"8px",textAlign:"center"},children:H.isHistorical&&!H.isOpening&&f.jsx("button",{onClick:()=>u(Ae.find(ve=>ve.id===H.id)),style:{padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete historical entry",children:""})})]}),H.subRows&&H.subRows.length>0&&H.subRows.map((ve,Me)=>f.jsxs("tr",{style:{backgroundColor:H.isOpening?"#FEF3C7":H.hasCN||H.isCreditNote?"#FFFBEB":"#FFFFFF",borderBottom:Me===H.subRows.length-1?"2px solid #CBD5E1":"1px solid #E2E8F0",borderLeft:H.hasCN||H.isCreditNote?"4px solid #F59E0B":"none"},children:[f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px 6px 30px",color:"#475569",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:ve.particular}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:ve.debit?Ut(ve.debit):""}),f.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:ve.credit?Ut(ve.credit):""}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),Qt&&f.jsx("td",{style:{padding:"6px 8px"}})]},`${H.id}-sub-${Me}`))]},H.id))})]})})]}):f.jsx("div",{style:{padding:"60px",textAlign:"center",color:"#94A3B8"},children:"Select a party to view ledger"})})]})]})},[oc,uy]=ye.useState(""),rd=ye.useMemo(()=>{const m=new Map,C=Y=>{if(!Y)return"";const X=Y.split("/");return X.length>=3?X.slice(1).join("/"):X.length===2?X.join("/"):X[X.length-1]},Q=Ri.filter(Y=>{var X;return Y.isHistorical&&(Y.type==="creditnote"||((X=Y.vchNo)==null?void 0:X.toUpperCase().startsWith("CN")))}),ee=new Map;return ec.forEach(Y=>{const X=C(Y.invoiceNo);X&&ee.set(X,Y)}),Q.forEach(Y=>{const X=C(Y.vchNo);X&&!ee.has(X)&&ee.set(X,Y)}),Rr.filter(Y=>Y.invoiceGenerated&&Y.invoiceStatus==="Approved").forEach(Y=>{if(m.has(Y.invoiceNo))m.has(Y.invoiceNo)&&m.get(Y.invoiceNo).campaigns.push(Y);else{const X=Zl.find(me=>me.invoiceNo===Y.invoiceNo),H=ec.find(me=>me.invoiceNo===Y.invoiceNo),ve=parseFloat(Y.invoiceTotalAmount)||0,Me=H?Math.abs(parseFloat(H.totalAmount)||parseFloat(H.credit)||0):0,ce=H&&Me>=ve;if(!X&&!ce){const me=H?ve-Me:ve;m.set(Y.invoiceNo,{invoiceNo:Y.invoiceNo,partyName:Y.partyName,invoiceDate:Y.invoiceDate,invoiceTotalAmount:Y.invoiceTotalAmount,pendingAmount:me,hasPartialCN:!!H&&!ce&&Me>0,cnAmount:Me,subject:Y.subject,campaigns:[Y],isHistorical:!1,invoiceType:Y.invoiceType||"Individual"})}}}),Ri.filter(Y=>{var X;return Y.isHistorical&&Y.type!=="creditnote"&&!((X=Y.vchNo)!=null&&X.toUpperCase().startsWith("CN"))&&Y.debit>0}).forEach(Y=>{if(!m.has(Y.vchNo)){const X=Zl.find(Ke=>Ke.invoiceNo===Y.vchNo),H=C(Y.vchNo),ve=ee.get(H),Me=ve?Math.abs(parseFloat(ve.totalAmount)||parseFloat(ve.credit)||parseFloat(ve.debit)||0):0,ce=parseFloat(Y.debit)||0,me=ve&&Me>=ce;if(X||me)return;const We=!(Y.amountReceived>0),re=ve&&Me>0&&Me<ce;if(We||re){const Ke=re?ce-Me:ce;m.set(Y.vchNo,{invoiceNo:Y.vchNo,partyName:Y.partyName,invoiceDate:Y.date,invoiceTotalAmount:ce,pendingAmount:Ke,hasPartialCN:re,cnAmount:Me,subject:Y.particulars||Y.narration,campaigns:[],isHistorical:!0})}}}),Array.from(m.values()).sort((Y,X)=>Y.partyName.localeCompare(X.partyName))},[Rr,Zl,ec,Ri]),tF=ye.useMemo(()=>{const m={};return tc.forEach(C=>{m[C.invoiceNo]||(m[C.invoiceNo]=[]),m[C.invoiceNo].push(C)}),Object.keys(m).forEach(C=>{m[C].sort((Q,ee)=>new Date(ee.followupDate)-new Date(Q.followupDate))}),m},[tc]),fy=ye.useMemo(()=>{const m=new Date().toISOString().split("T")[0];return tc.filter(C=>C.nextFollowupDate&&C.nextFollowupDate>=m).sort((C,Q)=>new Date(C.nextFollowupDate)-new Date(Q.nextFollowupDate))},[tc]),nd=ye.useMemo(()=>{let m=rd;if(oc){const Q=oc.toLowerCase();m=rd.filter(ee=>{var Y,X,H;return((Y=ee.invoiceNo)==null?void 0:Y.toLowerCase().includes(Q))||((X=ee.partyName)==null?void 0:X.toLowerCase().includes(Q))||((H=ee.subject)==null?void 0:H.toLowerCase().includes(Q))})}const C={};return m.forEach(Q=>{C[Q.partyName]||(C[Q.partyName]={partyName:Q.partyName,invoices:[],totalAmount:0}),C[Q.partyName].invoices.push(Q),C[Q.partyName].totalAmount+=parseFloat(Q.pendingAmount||Q.invoiceTotalAmount)||0}),Object.values(C).sort((Q,ee)=>Q.partyName.localeCompare(ee.partyName))},[rd,oc]),rF=()=>{const m=nd.reduce((C,Q)=>C+Q.invoices.length,0);return f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[f.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Followups"}),f.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[f.jsxs("span",{style:{padding:"6px 12px",backgroundColor:"#EFF6FF",borderRadius:"6px",fontSize:"12px",color:"#1E40AF",fontWeight:"600"},children:[nd.length," Parties | ",m," Invoices"]}),dn&&f.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"})]})]}),f.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(Um,{size:18,color:"#64748B"}),f.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Search:"})]}),f.jsxs("div",{style:{position:"relative",flex:1,maxWidth:"300px"},children:[f.jsx(Md,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"text",placeholder:"Search party, invoice, subject...",value:oc,onChange:C=>uy(C.target.value),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"100%"}})]}),oc&&f.jsxs("button",{onClick:()=>uy(""),style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(ll,{size:14})," Clear"]}),oc&&f.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",m," of ",rd.length]})]})}),fy.length>0&&f.jsx(Tn,{title:" Upcoming Followups",style:{marginBottom:"16px"},children:f.jsx("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:fy.slice(0,5).map(C=>f.jsxs("div",{style:{padding:"10px 14px",backgroundColor:new Date(C.nextFollowupDate).toISOString().split("T")[0]===new Date().toISOString().split("T")[0]?"#FEE2E2":"#FEF3C7",borderRadius:"8px",border:"1px solid #FCD34D"},children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#92400E"},children:C.invoiceNo}),f.jsx("div",{style:{fontSize:"11px",color:"#78716C"},children:C.partyName}),f.jsxs("div",{style:{fontSize:"12px",fontWeight:"600",color:"#DC2626",marginTop:"4px"},children:[" ",xr(C.nextFollowupDate)]})]},C.id))})}),nd.length===0?f.jsx(Tn,{children:f.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:" No pending invoices! All payments received."})}):nd.map(C=>f.jsxs(Tn,{style:{marginBottom:"16px"},noPadding:!0,children:[f.jsxs("div",{style:{padding:"12px 16px",backgroundColor:"#1E293B",color:"white",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[f.jsxs("span",{style:{fontSize:"15px",fontWeight:"700"},children:[" ",C.partyName]}),f.jsxs("span",{style:{padding:"3px 10px",backgroundColor:"#3B82F6",borderRadius:"12px",fontSize:"11px",fontWeight:"600"},children:[C.invoices.length," Invoice",C.invoices.length>1?"s":""]})]}),f.jsxs("div",{style:{fontSize:"14px",fontWeight:"700",color:"#FCD34D"},children:["Total: ",ft(C.totalAmount)]})]}),f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[f.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Type"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Invoice Date"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:"Amount"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Days Pending"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Last Followup"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),f.jsx("tbody",{children:C.invoices.map(Q=>{var ve,Me,ce;const ee=tF[Q.invoiceNo]||[],Y=ee[0],X=Math.floor((new Date-new Date(Q.invoiceDate))/(1e3*60*60*24)),H=Q.isHistorical?"Historical":Q.invoiceType||(((ve=Q.campaigns)==null?void 0:ve.length)>1?"Combined":"Individual");return f.jsxs($d.Fragment,{children:[f.jsxs("tr",{style:{borderBottom:"1px solid #E2E8F0",backgroundColor:X>30?"#FEF2F2":X>15?"#FFFBEB":"#FFFFFF"},children:[f.jsxs("td",{style:{padding:"10px 12px",fontWeight:"600",color:"#2874A6"},children:[Q.invoiceNo,Q.hasPartialCN&&f.jsx("span",{style:{marginLeft:"6px",padding:"2px 6px",backgroundColor:"#FEF3C7",color:"#92400E",borderRadius:"4px",fontSize:"9px",fontWeight:"700"},children:"Partial CN"})]}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsx("span",{style:{padding:"3px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"600",backgroundColor:H==="Historical"?"#E0E7FF":H==="Combined"?"#F3E8FF":"#DCFCE7",color:H==="Historical"?"#3730A3":H==="Combined"?"#7C3AED":"#166534"},children:H})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:xr(Q.invoiceDate)}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600"},children:Q.hasPartialCN?f.jsxs("div",{children:[f.jsx("div",{style:{color:"#DC2626"},children:ft(Q.pendingAmount)}),f.jsx("div",{style:{fontSize:"9px",color:"#64748B",textDecoration:"line-through"},children:ft(Q.invoiceTotalAmount)})]}):ft(Q.invoiceTotalAmount)}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsxs("span",{style:{padding:"3px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"700",backgroundColor:X>30?"#FEE2E2":X>15?"#FEF3C7":"#DCFCE7",color:X>30?"#991B1B":X>15?"#92400E":"#166534"},children:[X," days"]})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center",fontSize:"11px"},children:Y?f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:"600"},children:xr(Y.followupDate)}),f.jsxs("div",{style:{color:"#64748B",fontSize:"10px"},children:[(Me=Y.notes)==null?void 0:Me.substring(0,30),((ce=Y.notes)==null?void 0:ce.length)>30?"...":""]})]}):f.jsx("span",{style:{color:"#DC2626",fontWeight:"600"},children:"No followup yet"})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsxs("div",{style:{display:"flex",gap:"4px",justifyContent:"center"},children:[Qt&&f.jsx(Xe,{icon:Wm,small:!0,variant:"primary",onClick:()=>k(Q),title:"Add Followup"}),f.jsx(Xe,{icon:Vm,small:!0,variant:"brand",onClick:()=>je(Q),title:"Copy Email Template"}),f.jsx(Xe,{icon:zm,small:!0,variant:"success",onClick:()=>Wt(Q),title:"Search in Gmail"})]})})]}),ee.length>0&&f.jsx("tr",{children:f.jsxs("td",{colSpan:"7",style:{padding:"8px 12px 12px 40px",backgroundColor:"#F8FAFC"},children:[f.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#64748B",marginBottom:"6px"},children:"Followup History:"}),f.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:ee.map(me=>f.jsxs("div",{style:{padding:"6px 10px",backgroundColor:"#FFFFFF",borderRadius:"6px",border:"1px solid #E2E8F0",fontSize:"11px"},children:[f.jsx("div",{style:{fontWeight:"600",color:"#2874A6"},children:xr(me.followupDate)}),f.jsx("div",{style:{color:"#475569",marginTop:"2px"},children:me.notes}),me.nextFollowupDate&&f.jsxs("div",{style:{color:"#DC2626",marginTop:"2px",fontSize:"10px"},children:["Next: ",xr(me.nextFollowupDate)]}),Qt&&f.jsx("button",{onClick:()=>ne(me.id),style:{background:"none",border:"none",color:"#DC2626",cursor:"pointer",fontSize:"10px",padding:"2px 0",marginTop:"4px"},children:" Delete"})]},me.id))})]})})]},Q.invoiceNo)})})]})]},C.partyName))]})},dy=()=>{const m=xe.filter(Y=>Y.invoiceGenerated).reduce((Y,X)=>Y+(parseFloat(X.invoiceTotalAmount)||0),0),C=xe.filter(Y=>Y.invoiceStatus==="Paid").reduce((Y,X)=>Y+(parseFloat(X.invoiceTotalAmount)||0),0),Q=xe.filter(Y=>Y.invoiceStatus==="Approved").reduce((Y,X)=>Y+(parseFloat(X.invoiceTotalAmount)||0),0),ee=xe.filter(Y=>Y.invoiceStatus==="Need Edits").length;return f.jsxs("div",{children:[f.jsx("h1",{style:{margin:"0 0 16px",fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Reports"}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px"},children:[f.jsxs(Tn,{children:[f.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Total Invoiced"}),f.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:ft(m)})]}),f.jsxs(Tn,{children:[f.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Approved"}),f.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669"},children:ft(Q)})]}),f.jsxs(Tn,{children:[f.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Need Edits"}),f.jsxs("div",{style:{fontSize:"24px",fontWeight:"700",color:"#DC2626"},children:[ee," invoices"]})]}),f.jsxs(Tn,{children:[f.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Paid"}),f.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669"},children:ft(C)})]})]})]})},nF=()=>f.jsxs("div",{children:[f.jsx("h1",{style:{margin:"0 0 16px",fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Settings"}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[f.jsxs(Tn,{title:" Invoice Series",children:[f.jsx(vr,{label:"Invoice Prefix",value:S.invoicePrefix,onChange:m=>b(C=>({...C,invoicePrefix:m.target.value})),small:!0}),f.jsx(vr,{label:"Next Invoice Number",type:"number",value:Se,onChange:m=>Ne(parseInt(m.target.value)||1),small:!0}),f.jsx(vr,{label:"Next Combine Code",type:"number",value:ke,onChange:m=>Te(parseInt(m.target.value)||1),small:!0}),f.jsxs("div",{style:{padding:"10px",backgroundColor:"#EFF6FF",borderRadius:"8px",fontSize:"14px"},children:[f.jsx("strong",{children:"Preview:"})," ",S.invoicePrefix,Se]})]}),f.jsxs(Tn,{title:" Mailer Logo",children:[f.jsx("input",{type:"file",ref:Au,accept:"image/*",style:{display:"none"},onChange:$4}),Xr?f.jsxs("div",{style:{textAlign:"center"},children:[f.jsx("img",{src:Xr,alt:"Logo",style:{maxWidth:"250px",maxHeight:"60px",marginBottom:"12px",border:"1px solid #E2E8F0",padding:"8px",borderRadius:"8px"}}),f.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"center"},children:[f.jsx(Xe,{icon:$B,label:"Change",small:!0,onClick:()=>{var m;return(m=Au.current)==null?void 0:m.click()}}),f.jsx(Xe,{icon:Gs,label:"Remove",variant:"danger",small:!0,onClick:()=>gs(null)})]})]}):f.jsxs("div",{onClick:()=>{var m;return(m=Au.current)==null?void 0:m.click()},style:{border:"2px dashed #CBD5E1",borderRadius:"10px",padding:"30px",textAlign:"center",cursor:"pointer"},children:[f.jsx(Ks,{size:32,color:"#94A3B8",style:{marginBottom:"8px"}}),f.jsx("p",{style:{margin:0,color:"#64748B",fontSize:"14px"},children:"Click to upload"})]})]}),f.jsxs(Tn,{title:" WhatsApp Notifications",children:[f.jsx("div",{style:{marginBottom:"16px"},children:f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"10px",cursor:"pointer"},children:[f.jsx("input",{type:"checkbox",checked:te.enabled,onChange:m=>le(C=>({...C,enabled:m.target.checked})),style:{width:"18px",height:"18px",cursor:"pointer"}}),f.jsx("span",{style:{fontSize:"14px",fontWeight:"600",color:"#1E293B"},children:"Enable WhatsApp Notifications"})]})}),te.enabled&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{style:{padding:"12px",backgroundColor:"#DCFCE7",borderRadius:"8px",marginBottom:"16px",fontSize:"12px",color:"#166534",border:"1px solid #86EFAC"},children:[f.jsx("strong",{children:" FREE Setup using CallMeBot:"}),f.jsx("br",{}),"1. Save this number in contacts: ",f.jsx("strong",{children:"+34 644 71 81 99"}),f.jsx("br",{}),"2. Send this message to the number on WhatsApp: ",f.jsx("strong",{children:'"I allow callmebot to send me messages"'}),f.jsx("br",{}),"3. You'll receive an API key - enter it below",f.jsx("br",{}),"4. Repeat for each phone number you want to receive notifications"]}),f.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",marginBottom:"12px",border:"1px solid #E2E8F0"},children:[f.jsxs("div",{style:{fontSize:"13px",fontWeight:"700",color:"#1E293B",marginBottom:"10px",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(Od,{size:16})," Finance Team"]}),f.jsx(vr,{label:"Phone (with country code)",value:te.financePhone,onChange:m=>le(C=>({...C,financePhone:m.target.value})),placeholder:"919876543210",small:!0}),f.jsx(vr,{label:"API Key (from CallMeBot)",value:te.financeApiKey,onChange:m=>le(C=>({...C,financeApiKey:m.target.value})),placeholder:"123456",small:!0}),te.financePhone&&te.financeApiKey&&f.jsx(Xe,{icon:V2,label:"Test Finance",variant:"success",small:!0,onClick:()=>Fu(te.financePhone,te.financeApiKey)})]}),f.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",border:"1px solid #E2E8F0"},children:[f.jsxs("div",{style:{fontSize:"13px",fontWeight:"700",color:"#1E293B",marginBottom:"10px",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(Od,{size:16})," Director"]}),f.jsx(vr,{label:"Phone (with country code)",value:te.directorPhone,onChange:m=>le(C=>({...C,directorPhone:m.target.value})),placeholder:"919876543210",small:!0}),f.jsx(vr,{label:"API Key (from CallMeBot)",value:te.directorApiKey,onChange:m=>le(C=>({...C,directorApiKey:m.target.value})),placeholder:"123456",small:!0}),te.directorPhone&&te.directorApiKey&&f.jsx(Xe,{icon:V2,label:"Test Director",variant:"success",small:!0,onClick:()=>Fu(te.directorPhone,te.directorApiKey)})]})]}),!te.enabled&&f.jsx("div",{style:{padding:"20px",backgroundColor:"#F8FAFC",borderRadius:"8px",textAlign:"center",color:"#64748B",fontSize:"13px"},children:"WhatsApp notifications are disabled. Enable to receive FREE alerts for invoices, approvals, and payments."})]}),f.jsxs(Tn,{title:" Default Invoice Values",children:[f.jsx("input",{type:"file",ref:V0,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:rn}),f.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[f.jsx(Xe,{icon:Ks,label:"Upload",variant:"brand",small:!0,onClick:()=>{var m;return(m=V0.current)==null?void 0:m.click()}}),f.jsx(Xe,{icon:Wu,label:"Template",small:!0,onClick:It})]}),Object.keys(Bs).length>0&&f.jsx("div",{style:{maxHeight:"180px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"8px"},children:Object.entries(Bs).map(([m,C])=>f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px 14px",borderBottom:"1px solid #F1F5F9",fontSize:"13px"},children:[f.jsx("span",{children:m}),f.jsx("span",{style:{fontWeight:"700"},children:ft(C)})]},m))})]}),f.jsxs(Tn,{title:" Party Master",children:[f.jsx("input",{type:"file",ref:ku,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:hn}),f.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[f.jsx(Xe,{icon:Ks,label:"Upload Parties",variant:"brand",small:!0,onClick:()=>{var m;return(m=ku.current)==null?void 0:m.click()}}),f.jsx(Xe,{icon:Wu,label:"Template",small:!0,onClick:pn})]}),f.jsxs("div",{style:{padding:"10px",backgroundColor:"#EFF6FF",borderRadius:"8px",fontSize:"12px",color:"#1E40AF",marginBottom:"12px"},children:[f.jsx("strong",{children:"Upload Format:"})," Name of Ledger, Ledger Group, State Name, GST Registration Type, GSTIN/UIN"]}),Object.keys(ir).length>0&&f.jsxs("div",{style:{maxHeight:"150px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"8px"},children:[Object.entries(ir).slice(0,20).map(([m,C])=>f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 12px",borderBottom:"1px solid #F1F5F9",fontSize:"11px"},children:[f.jsx("span",{style:{fontWeight:"600"},children:m.length>30?m.substring(0,30)+"...":m}),f.jsxs("span",{style:{color:"#64748B"},children:[C.stateName||"-"," | ",C.gstin?C.gstin.substring(0,10)+"...":"-"]})]},m)),Object.keys(ir).length>20&&f.jsxs("div",{style:{padding:"8px 12px",textAlign:"center",color:"#64748B",fontSize:"11px"},children:["... and ",Object.keys(ir).length-20," more parties"]})]}),Object.keys(ir).length===0&&f.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#94A3B8",fontSize:"13px"},children:"No party master uploaded yet"})]}),f.jsxs(Tn,{title:" Data Management",children:[f.jsxs("div",{style:{padding:"16px",backgroundColor:"#FEF2F2",borderRadius:"10px",border:"1px solid #FCA5A5",marginBottom:"16px"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"14px",marginBottom:"8px"},children:" Danger Zone"}),f.jsxs("div",{style:{fontSize:"13px",color:"#7F1D1D",marginBottom:"16px"},children:["This will permanently delete all data including:",f.jsxs("ul",{style:{margin:"8px 0 0 16px",padding:0},children:[f.jsx("li",{children:"All campaigns and master data"}),f.jsx("li",{children:"All invoices and receipts"}),f.jsx("li",{children:"All ledger entries"}),f.jsx("li",{children:"All mailer images"}),f.jsx("li",{children:"Opening balances and settings"})]})]}),f.jsx(Xe,{icon:Gs,label:"Clear All Data",variant:"danger",onClick:()=>ca(!0)})]}),f.jsxs("div",{style:{fontSize:"12px",color:"#64748B"},children:[f.jsx("strong",{children:"Current Data:"}),f.jsx("br",{})," ",xe.length," campaigns",f.jsx("br",{})," ",Ae.length," ledger entries",f.jsx("br",{})," ",Z.length," receipts",f.jsx("br",{})," ",Object.keys(Kr).length," mailer images"]})]})]})]}),iF=()=>f.jsxs(f.Fragment,{children:[f.jsx(Sn,{isOpen:G4,onClose:()=>{iy(!1),ay("")},title:" Invoice Preview",width:"950px",children:se&&sy&&f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px",padding:"14px 18px",backgroundColor:"#DCFCE7",borderRadius:"10px",border:"2px solid #22C55E"},children:[f.jsxs("div",{children:[f.jsxs("span",{style:{fontWeight:"700",fontSize:"16px",color:"#166534"},children:["Invoice: ",se.invoiceNo]}),se.invoiceType==="Combined"&&f.jsxs("span",{style:{marginLeft:"12px",padding:"4px 10px",backgroundColor:"#7C3AED",color:"white",borderRadius:"6px",fontSize:"12px",fontWeight:"600"},children:["Combined - C",se.combinationCode]})]}),f.jsxs("button",{onClick:()=>X4(se),style:{padding:"14px 28px",fontSize:"16px",fontWeight:"bold",border:"none",borderRadius:"10px",cursor:"pointer",backgroundColor:"#22C55E",color:"white",display:"flex",alignItems:"center",gap:"10px",boxShadow:"0 2px 8px rgba(34, 197, 94, 0.4)"},children:[f.jsx(Wu,{size:20}),"Download Invoice"]})]}),f.jsx("div",{style:{border:"2px solid #E2E8F0",borderRadius:"10px",overflow:"hidden",backgroundColor:"#f5f5f5"},children:f.jsx("iframe",{id:"invoice-viewer-iframe",srcDoc:sy,style:{width:"100%",height:"480px",border:"none",backgroundColor:"white"},title:"Invoice Preview"})}),f.jsxs("div",{style:{marginTop:"12px",padding:"14px 18px",backgroundColor:"#FEF3C7",borderRadius:"10px",border:"1px solid #FCD34D"},children:[f.jsx("div",{style:{fontSize:"14px",color:"#92400E",fontWeight:"600",marginBottom:"6px"},children:" How to Save as PDF:"}),f.jsxs("ol",{style:{fontSize:"13px",color:"#92400E",margin:"0",paddingLeft:"20px",lineHeight:"1.8"},children:[f.jsxs("li",{children:["Click ",f.jsx("strong",{children:'"Download Invoice"'})," button above"]}),f.jsxs("li",{children:["Open the downloaded ",f.jsx("strong",{children:".html file"})," in Chrome/Edge browser"]}),f.jsxs("li",{children:["Print dialog will open automatically - select ",f.jsx("strong",{children:'"Save as PDF"'})]}),f.jsxs("li",{children:["Click ",f.jsx("strong",{children:"Save"})," to get your PDF!"]})]})]})]})}),f.jsx(Sn,{isOpen:_r,onClose:()=>{Zt(!1),On(""),et({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1})},title:dn?" Review & Approve Invoice":" Invoice Details",width:"550px",children:se&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice:"})," ",se.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Party:"})," ",se.partyName]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Amount:"})," ",ft(se.invoiceTotalAmount)]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Email:"})," ",se.emailId||"Not set"]}),f.jsxs("div",{style:{fontSize:"14px"},children:[f.jsx("strong",{children:"Invoice Type:"})," ",f.jsx("span",{style:{color:se.invoiceType==="Combined"?"#7C3AED":"#2874A6",fontWeight:"600"},children:se.invoiceType||"Individual"})]}),se.invoiceType==="Combined"&&f.jsxs("div",{style:{marginTop:"8px",fontSize:"13px",color:"#7C3AED"},children:[f.jsx("strong",{children:"Combined Campaigns:"})," ",Us(se).map(m=>m.senderName).join(", ")]})]}),se.editComments&&f.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[f.jsx("div",{style:{fontWeight:"600",color:"#991B1B",fontSize:"13px",marginBottom:"4px"},children:" Need Edits - Director Remarks:"}),f.jsx("div",{style:{fontSize:"13px",color:"#7F1D1D"},children:se.editComments})]}),se.approvalRemarks&&se.invoiceStatus==="Approved"&&f.jsxs("div",{style:{backgroundColor:"#DCFCE7",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[f.jsx("div",{style:{fontWeight:"600",color:"#166534",fontSize:"13px",marginBottom:"4px"},children:" Approved - Director Remarks:"}),f.jsx("div",{style:{fontSize:"13px",color:"#15803D"},children:se.approvalRemarks})]}),dn?f.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#166534",fontSize:"14px",marginBottom:"12px"},children:" Approval Confirmations"}),f.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",marginBottom:"12px",cursor:"pointer"},children:[f.jsx("input",{type:"checkbox",checked:ze.particularsApproved,onChange:m=>et(C=>({...C,particularsApproved:m.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"1. Particulars & Amount Approved"}),f.jsxs("div",{style:{fontSize:"12px",color:"#15803D"},children:["I confirm that the invoice particulars and amount (",ft(se.invoiceTotalAmount),") are correct."]})]})]}),f.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",marginBottom:"12px",cursor:"pointer"},children:[f.jsx("input",{type:"checkbox",checked:ze.emailApproved,onChange:m=>et(C=>({...C,emailApproved:m.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"2. Email ID Approved for Mailing"}),f.jsxs("div",{style:{fontSize:"12px",color:"#15803D"},children:["I confirm that ",f.jsx("strong",{children:se.emailId||"the specified email"})," should be used for mailing."]})]})]}),f.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",cursor:"pointer"},children:[f.jsx("input",{type:"checkbox",checked:ze.invoiceTypeApproved,onChange:m=>et(C=>({...C,invoiceTypeApproved:m.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"3. Invoice Type Confirmed"}),f.jsx("div",{style:{fontSize:"12px",color:"#15803D"},children:se.invoiceType==="Combined"?`I confirm that a Combined Invoice is required for these ${Us(se).length} campaigns.`:"I confirm that an Individual Invoice is required (not combined with others)."})]})]})]}):f.jsxs("div",{style:{backgroundColor:se.invoiceStatus==="Approved"?"#DCFCE7":se.invoiceStatus==="Need Edits"?"#FEF3C7":"#F8FAFC",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid "+(se.invoiceStatus==="Approved"?"#86EFAC":se.invoiceStatus==="Need Edits"?"#FCD34D":"#E2E8F0")},children:[f.jsx("div",{style:{fontWeight:"600",color:se.invoiceStatus==="Approved"?"#166534":se.invoiceStatus==="Need Edits"?"#92400E":"#64748B",fontSize:"14px"},children:se.invoiceStatus==="Approved"?" Approved by Director":se.invoiceStatus==="Need Edits"?" Edits Required by Director":" Pending Director Approval"}),f.jsx("div",{style:{fontSize:"13px",color:se.invoiceStatus==="Approved"?"#15803D":se.invoiceStatus==="Need Edits"?"#A16207":"#64748B",marginTop:"6px"},children:se.invoiceStatus==="Approved"?"This invoice has been approved and is ready for mailing.":se.invoiceStatus==="Need Edits"?"Please make the required changes and resubmit for approval.":"This invoice is awaiting Director approval."})]}),dn&&f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:" Remarks (optional for Approve, visible to Finance)"}),f.jsx("textarea",{value:yi,onChange:m=>On(m.target.value),placeholder:"Enter remarks or comments...",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[f.jsx(Xe,{label:"Close",onClick:()=>{Zt(!1),On(""),et({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1})}}),dn&&f.jsxs(f.Fragment,{children:[f.jsx(Xe,{label:"Need Edits",variant:"danger",icon:HB,onClick:_a}),f.jsx(Xe,{label:"Approve",variant:"success",icon:KB,onClick:Y0})]})]})]})}),f.jsx(Sn,{isOpen:ri,onClose:()=>ut(!1),title:" Delete Invoice",width:"450px",children:se&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"15px",marginBottom:"8px"},children:" Are you sure?"}),f.jsxs("div",{style:{fontSize:"14px",color:"#7F1D1D",lineHeight:"1.5"},children:["This will delete invoice ",f.jsx("strong",{children:se.invoiceNo})," and reset the campaign(s) to allow re-generation.",se.invoiceType==="Combined"&&f.jsxs("div",{style:{marginTop:"8px"},children:[f.jsxs("strong",{children:["All ",Us(se).length," combined campaigns"]})," will be reset to Individual type for re-selection."]})]})]}),f.jsxs("div",{style:{backgroundColor:"#F8FAFC",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"13px"},children:[f.jsx("strong",{children:"Invoice:"})," ",se.invoiceNo]}),f.jsxs("div",{style:{fontSize:"13px"},children:[f.jsx("strong",{children:"Party:"})," ",se.partyName]}),f.jsxs("div",{style:{fontSize:"13px"},children:[f.jsx("strong",{children:"Amount:"})," ",ft(se.invoiceTotalAmount)]})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[f.jsx(Xe,{label:"Cancel",onClick:()=>ut(!1)}),f.jsx(Xe,{label:"Delete Invoice",variant:"danger",icon:Gs,onClick:J0})]})]})}),f.jsx(Sn,{isOpen:vi,onClose:()=>zt(!1),title:" Add Email Address",width:"400px",children:se&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"13px"},children:[f.jsx("strong",{children:"Campaign:"})," ",se.senderName]}),f.jsxs("div",{style:{fontSize:"13px",marginTop:"4px"},children:[f.jsx("strong",{children:"Current:"})," ",se.emailId||"None"]})]}),f.jsx(vr,{label:"Additional Email Address",type:"email",value:Xi,onChange:m=>ua(m.target.value),placeholder:"email@example.com",small:!0}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:[f.jsx(Xe,{label:"Cancel",onClick:()=>zt(!1)}),f.jsx(Xe,{label:"Add Email",variant:"brand",icon:j2,onClick:()=>{Xi&&Xi.includes("@")?(K0(se.id,Xi),zt(!1),ua("")):alert("Please enter a valid email address")}})]})]})}),f.jsx(Sn,{isOpen:A,onClose:()=>{_(!1),W({currentPassword:"",newPassword:"",confirmPassword:""}),w("")},title:" Change Password",width:"400px",children:f.jsxs("div",{children:[f.jsx("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:f.jsxs("div",{style:{fontSize:"13px"},children:[f.jsx("strong",{children:"User:"})," ",r==="director"?"Director":"Finance Team"]})}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Current Password"}),f.jsx("input",{type:"password",value:P.currentPassword,onChange:m=>W(C=>({...C,currentPassword:m.target.value})),placeholder:"Enter current password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"New Password"}),f.jsx("input",{type:"password",value:P.newPassword,onChange:m=>W(C=>({...C,newPassword:m.target.value})),placeholder:"Enter new password (min 6 characters)",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Confirm New Password"}),f.jsx("input",{type:"password",value:P.confirmPassword,onChange:m=>W(C=>({...C,confirmPassword:m.target.value})),placeholder:"Confirm new password",onKeyPress:m=>m.key==="Enter"&&va(),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),j&&f.jsx("div",{style:{marginBottom:"16px",padding:"10px",backgroundColor:"#FEE2E2",borderRadius:"8px",color:"#991B1B",fontSize:"13px"},children:j}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[f.jsx(Xe,{label:"Cancel",onClick:()=>{_(!1),W({currentPassword:"",newPassword:"",confirmPassword:""}),w("")}}),f.jsx(Xe,{label:"Change Password",variant:"brand",icon:Pd,onClick:va})]})]})}),f.jsx(Sn,{isOpen:A,onClose:()=>{_(!1),w(""),W({currentPassword:"",newPassword:"",confirmPassword:""})},title:" Change Password",width:"400px",children:f.jsxs("div",{children:[f.jsx("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:f.jsxs("div",{style:{fontSize:"13px",color:"#1E40AF"},children:["Changing password for: ",f.jsx("strong",{children:r==="director"?"Director":"Finance Team"})]})}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Current Password"}),f.jsx("input",{type:"password",value:P.currentPassword,onChange:m=>W(C=>({...C,currentPassword:m.target.value})),placeholder:"Enter current password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"New Password"}),f.jsx("input",{type:"password",value:P.newPassword,onChange:m=>W(C=>({...C,newPassword:m.target.value})),placeholder:"Enter new password (min 6 chars)",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Confirm New Password"}),f.jsx("input",{type:"password",value:P.confirmPassword,onChange:m=>W(C=>({...C,confirmPassword:m.target.value})),placeholder:"Re-enter new password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),j&&f.jsx("div",{style:{marginBottom:"16px",padding:"10px",backgroundColor:"#FEE2E2",borderRadius:"8px",color:"#991B1B",fontSize:"13px"},children:j}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[f.jsx(Xe,{label:"Cancel",onClick:()=>{_(!1),w(""),W({currentPassword:"",newPassword:"",confirmPassword:""})}}),f.jsx(Xe,{label:"Change Password",variant:"brand",icon:Pd,onClick:va})]})]})}),f.jsx(Sn,{isOpen:xi,onClose:()=>{br(!1),ii(new Set),Nt(null)},title:" Combine Invoices",width:"700px",children:Mt&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#F3E8FF",padding:"14px 18px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"15px",fontWeight:"700",color:"#6B21A8"},children:["Party: ",Mt]}),f.jsx("div",{style:{fontSize:"13px",color:"#7C3AED",marginTop:"4px"},children:"Select 2+ campaigns to combine into a single invoice"})]}),f.jsx("div",{style:{maxHeight:"350px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"10px"},children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#F8FAFC",position:"sticky",top:0},children:[f.jsx("th",{style:{padding:"12px",textAlign:"center",width:"50px"},children:""}),f.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Sender"}),f.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Subject"}),f.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Date"}),f.jsx("th",{style:{padding:"12px",textAlign:"right"},children:"Amount"})]})}),f.jsx("tbody",{children:$0(Mt).map(m=>{var C;return f.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:Ft.has(m.id)?"#F3E8FF":"transparent",cursor:"pointer"},onClick:()=>V4(m.id),children:[f.jsx("td",{style:{padding:"12px",textAlign:"center"},children:f.jsx("input",{type:"checkbox",checked:Ft.has(m.id),onChange:()=>{},style:{width:"18px",height:"18px",cursor:"pointer"}})}),f.jsx("td",{style:{padding:"12px",fontWeight:"600"},children:m.senderName}),f.jsxs("td",{style:{padding:"12px",color:"#64748B"},children:[(C=m.subject)==null?void 0:C.substring(0,35),"..."]}),f.jsx("td",{style:{padding:"12px"},children:xr(m.date)}),f.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:ft(m.totalWithGst)})]},m.id)})})]})}),f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px 18px",borderRadius:"10px",marginTop:"16px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsxs("div",{style:{fontSize:"14px",color:"#64748B"},children:["Selected: ",f.jsx("strong",{children:Ft.size})," | Combine Code: ",f.jsxs("strong",{children:["C",ke]})]}),f.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#2874A6"},children:["Total: ",ft(xe.filter(m=>Ft.has(m.id)).reduce((m,C)=>m+(parseFloat(C.totalWithGst)||0),0))]})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[f.jsx(Xe,{label:"Cancel",onClick:()=>{br(!1),ii(new Set)}}),f.jsx(Xe,{label:"Create Combined Invoice",variant:"purple",icon:$u,disabled:Ft.size<2,onClick:j4})]})]})}),f.jsxs(Sn,{isOpen:Rt,onClose:()=>{pt(!1),Ls(null),Qo(!1)},title:ql?" Replace Mailer":" Upload Mailer",width:"550px",children:[f.jsx("input",{type:"file",ref:j0,accept:"image/*",style:{display:"none"},onChange:z4}),se&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"14px"},children:[f.jsxs("div",{style:{fontSize:"14px"},children:[f.jsx("strong",{children:"Sender:"})," ",se.senderName]}),f.jsxs("div",{style:{fontSize:"14px",marginTop:"4px"},children:[f.jsx("strong",{children:"Subject:"})," ",se.subject]})]}),ql&&Kr[se.id]&&f.jsx("div",{style:{backgroundColor:"#FEF3C7",padding:"12px",borderRadius:"10px",marginBottom:"14px",border:"1px solid #FCD34D"},children:f.jsxs("div",{style:{fontWeight:"600",color:"#92400E",fontSize:"13px"},children:[" This will replace ",Kr[se.id].length," existing image(s)"]})}),f.jsxs("div",{style:{backgroundColor:"#FEF3C7",padding:"14px",borderRadius:"10px",marginBottom:"14px",border:"1px solid #FCD34D"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#92400E",marginBottom:"8px",fontSize:"14px"},children:"Step 1: Find Mailer in Gmail"}),f.jsxs("button",{onClick:()=>H4(se.subject),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 18px",backgroundColor:"#EA4335",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:[f.jsx(zB,{size:16})," Search in Gmail"]})]}),f.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"14px",borderRadius:"10px",border:"1px solid #86EFAC"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#166534",marginBottom:"8px",fontSize:"14px"},children:"Step 2: Paste Screenshot"}),f.jsx("div",{ref:Za,tabIndex:0,onPaste:W4,onClick:()=>{var m;return(m=Za.current)==null?void 0:m.focus()},style:{border:Yr?"3px solid #22C55E":"3px dashed #22C55E",borderRadius:"10px",padding:Yr?"8px":"30px",textAlign:"center",cursor:"pointer",backgroundColor:Yr?"#FFFFFF":"#ECFDF5",minHeight:"100px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",outline:"none"},children:Yr?f.jsxs(f.Fragment,{children:[f.jsx("img",{src:Yr,alt:"Pasted",style:{maxWidth:"100%",maxHeight:"200px",borderRadius:"8px",marginBottom:"10px"}}),f.jsxs("div",{style:{display:"flex",gap:"8px"},children:[f.jsx(Xe,{icon:M2,label:"Save",variant:"success",onClick:()=>ry(Yr)}),f.jsx(Xe,{icon:Gs,label:"Clear",variant:"danger",onClick:()=>Ls(null)})]})]}):f.jsxs(f.Fragment,{children:[f.jsx(Vm,{size:36,color:"#22C55E",style:{marginBottom:"8px"}}),f.jsx("div",{style:{fontWeight:"700",fontSize:"14px",color:"#166534"},children:"Click here & Press Ctrl+V"})]})}),f.jsxs("div",{style:{textAlign:"center",marginTop:"12px"},children:[f.jsx("span",{style:{color:"#64748B",fontSize:"13px"},children:" OR "}),f.jsx("div",{style:{marginTop:"8px"},children:f.jsx(Xe,{icon:Ks,label:"Browse Files",onClick:()=>{var m;return(m=j0.current)==null?void 0:m.click()}})})]})]})]})]}),f.jsx(Sn,{isOpen:$e,onClose:()=>Yt(!1),title:" Send Invoice Email",width:"600px",children:se&&f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",gap:"0",marginBottom:"16px",border:"2px solid #E2E8F0",borderRadius:"8px",overflow:"hidden"},children:[f.jsx("button",{onClick:()=>Qa("reply"),style:{flex:1,padding:"12px",backgroundColor:ps==="reply"?"#2874A6":"#F8FAFC",color:ps==="reply"?"white":"#64748B",border:"none",cursor:"pointer",fontWeight:"700",fontSize:"14px"},children:" Reply to Thread"}),f.jsx("button",{onClick:()=>Qa("new"),style:{flex:1,padding:"12px",backgroundColor:ps==="new"?"#2874A6":"#F8FAFC",color:ps==="new"?"white":"#64748B",border:"none",cursor:"pointer",fontWeight:"700",fontSize:"14px"},children:" New Email"})]}),f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice:"})," ",se.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Amount:"})," ",ft(se.invoiceTotalAmount||se.totalWithGst)]}),se.invoiceType==="Combined"&&f.jsxs("div",{style:{fontSize:"13px",marginTop:"8px",color:"#7C3AED"},children:[f.jsx("strong",{children:"Campaigns:"})," ",Us(se).map(m=>m.senderName).join(", ")]}),f.jsx("div",{style:{fontSize:"14px",marginTop:"8px"},children:f.jsx("strong",{children:"Recipients:"})}),f.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",marginTop:"6px"},children:[ya(se).map((m,C)=>f.jsx("span",{style:{padding:"4px 10px",backgroundColor:"#DBEAFE",borderRadius:"6px",fontSize:"13px",color:"#1E40AF"},children:m},C)),ya(se).length===0&&f.jsx("span",{style:{color:"#94A3B8"},children:"No email addresses"})]})]}),ps==="reply"?f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[f.jsx("span",{style:{fontWeight:"700",fontSize:"14px"},children:"Email Body:"}),f.jsx("button",{onClick:()=>{navigator.clipboard.writeText(td(se)),alert(" Copied!")},style:{padding:"6px 14px",backgroundColor:"#22C55E",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"600"},children:" Copy"})]}),f.jsx("div",{style:{fontSize:"13px",backgroundColor:"#F8FAFC",padding:"14px",borderRadius:"10px",whiteSpace:"pre-wrap",maxHeight:"200px",overflowY:"auto",fontFamily:"monospace",border:"1px solid #E2E8F0",lineHeight:"1.5"},children:td(se)})]}):f.jsxs("div",{style:{display:"flex",gap:"10px"},children:[f.jsx("button",{onClick:()=>{const m=ya(se),C=encodeURIComponent(m.join(",")),Q=encodeURIComponent(ny(se)),ee=encodeURIComponent(td(se));window.open(`https://mail.google.com/mail/?view=cm&to=${C}&su=${Q}&body=${ee}`,"_blank")},style:{padding:"12px 20px",backgroundColor:"#EA4335",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"700"},children:" Open Gmail"}),f.jsx("button",{onClick:()=>{const m=ya(se),C=encodeURIComponent(m.join(";")),Q=encodeURIComponent(ny(se)),ee=encodeURIComponent(td(se));window.open(`https://outlook.live.com/mail/0/deeplink/compose?to=${C}&subject=${Q}&body=${ee}`,"_blank")},style:{padding:"12px 20px",backgroundColor:"#0078D4",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"700"},children:" Open Outlook"})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[f.jsx(Xe,{label:"View Invoice",icon:Dd,onClick:()=>{Yt(!1),Du(se)}}),f.jsx(Xe,{label:"Close",onClick:()=>Yt(!1)})]})]})}),f.jsx(Sn,{isOpen:En,onClose:()=>fn(!1),title:" Record Payment",width:"500px",children:se&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px"},children:[f.jsx("strong",{children:"Invoice:"})," ",se.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginTop:"4px"},children:[f.jsx("strong",{children:"Party:"})," ",se.partyName]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[f.jsx(vr,{label:"Payment Amount",type:"number",value:gr.amount,onChange:m=>ma({...gr,amount:m.target.value}),small:!0}),f.jsx(vr,{label:"Date",type:"date",value:gr.date,onChange:m=>ma({...gr,date:m.target.value}),small:!0})]}),f.jsx(zd,{label:"Payment Mode",value:gr.mode,onChange:m=>ma({...gr,mode:m.target.value}),options:[{value:"Bank",label:"Bank Transfer"},{value:"UPI",label:"UPI"},{value:"Cheque",label:"Cheque"},{value:"Cash",label:"Cash"}],small:!0}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[f.jsx(vr,{label:"TDS Deducted",type:"number",value:gr.tds,onChange:m=>ma({...gr,tds:m.target.value}),placeholder:"0",small:!0}),f.jsx(vr,{label:"Discount",type:"number",value:gr.discount,onChange:m=>ma({...gr,discount:m.target.value}),placeholder:"0",small:!0})]}),f.jsx(vr,{label:"Narration",value:gr.narration,onChange:m=>ma({...gr,narration:m.target.value}),placeholder:"Reference",small:!0}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[f.jsx(Xe,{label:"Cancel",onClick:()=>fn(!1)}),f.jsx(Xe,{label:"Record Payment",variant:"success",icon:UB,onClick:Y4})]})]})}),f.jsxs(Sn,{isOpen:gi,onClose:()=>Ki(!1),title:" Set Opening Balance",width:"450px",children:[f.jsx(zd,{label:"Select Party",value:si.partyName,onChange:m=>Jo({...si,partyName:m.target.value}),options:[{value:"",label:"Choose a party..."},...tl.map(m=>({value:m,label:m}))],small:!0}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"12px"},children:[f.jsx(vr,{label:"Amount",type:"number",value:si.amount,onChange:m=>Jo({...si,amount:m.target.value}),small:!0}),f.jsx(zd,{label:"Type",value:si.type,onChange:m=>Jo({...si,type:m.target.value}),options:[{value:"Dr",label:"Debit"},{value:"Cr",label:"Credit"}],small:!0})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[f.jsx(Xe,{label:"Cancel",onClick:()=>Ki(!1)}),f.jsx(Xe,{label:"Save",variant:"brand",onClick:()=>{si.partyName&&si.amount&&(Ql(m=>({...m,[si.partyName]:si.type==="Dr"?parseFloat(si.amount):-parseFloat(si.amount)})),Ki(!1),Jo({partyName:"",amount:"",type:"Dr"}))}})]})]}),f.jsxs(Sn,{isOpen:Jl,onClose:()=>Zo(!1),title:" Import Historical Ledger",width:"600px",children:[f.jsx("input",{type:"file",ref:Cu,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:ro}),f.jsxs("div",{style:{padding:"16px",backgroundColor:"#EFF6FF",borderRadius:"10px",marginBottom:"16px",border:"1px solid #BFDBFE"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#1E40AF",marginBottom:"8px",fontSize:"14px"},children:" How to Import Historical Ledger"}),f.jsxs("div",{style:{fontSize:"12px",color:"#1E3A8A",lineHeight:"1.6"},children:[f.jsx("p",{style:{margin:"0 0 8px 0"},children:"Upload your existing ledger data in the format shown in the template. This will import all historical transactions."}),f.jsxs("p",{style:{margin:0},children:[f.jsx("strong",{children:"Supported columns:"})," Date, Particular, Vch Type, Vch No., Debit, Credit, Date of Receipt, Amount Received, TDS Received, Balance, Payment Status"]})]})]}),G&&f.jsxs("div",{style:{padding:"12px",backgroundColor:"#DCFCE7",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[f.jsxs("div",{style:{fontSize:"13px",color:"#166534"},children:[f.jsx("strong",{children:" Selected Party:"})," ",G]}),f.jsx("div",{style:{fontSize:"11px",color:"#15803D",marginTop:"4px"},children:"All entries from the uploaded file will be imported for this party"})]}),!G&&f.jsxs("div",{style:{padding:"12px",backgroundColor:"#FEE2E2",borderRadius:"8px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[f.jsx("div",{style:{fontSize:"13px",color:"#991B1B"},children:f.jsx("strong",{children:" No Party Selected"})}),f.jsx("div",{style:{fontSize:"12px",color:"#B91C1C",marginTop:"4px"},children:'Please close this modal and select a party from the Parties list on the left, then click "Import Historical" again.'})]}),f.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginBottom:"16px"},children:[f.jsx(Xe,{icon:Wu,label:"Download Template",variant:"brand",onClick:Di}),G?f.jsx(Xe,{icon:Ks,label:"Upload Ledger",variant:"success",onClick:()=>{var m;return(m=Cu.current)==null?void 0:m.click()}}):f.jsxs("button",{disabled:!0,style:{padding:"8px 16px",fontSize:"13px",fontWeight:"600",border:"none",borderRadius:"8px",backgroundColor:"#E2E8F0",color:"#94A3B8",cursor:"not-allowed",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(Ks,{size:16})," Upload Ledger"]})]}),f.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",border:"1px solid #E2E8F0"},children:[f.jsx("div",{style:{fontWeight:"600",color:"#475569",marginBottom:"8px",fontSize:"13px"},children:" Expected Format (matches your ledger export):"}),f.jsx("div",{style:{overflowX:"auto"},children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#E2E8F0"},children:[f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Date"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Particular"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Vch Type"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Vch No."}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Debit"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Credit"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Amt Recd"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Status"})]})}),f.jsx("tbody",{children:f.jsxs("tr",{children:[f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"02-Jun-21"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"DB Corp Ltd"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"Sales"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"MB/2020-21/0411"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0",textAlign:"right"},children:"6,000"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0",textAlign:"right"},children:"44,371"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"Received"})]})})]})})]}),f.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:f.jsx(Xe,{label:"Close",onClick:()=>Zo(!1)})})]}),f.jsx(Sn,{isOpen:nr,onClose:()=>{Er(!1),De({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"})},title:" Create Receipt",width:"550px",children:se&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice:"})," ",se.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Party:"})," ",se.partyName]}),f.jsxs("div",{style:{fontSize:"14px"},children:[f.jsx("strong",{children:"Invoice Amount:"})," ",ft(se.invoiceTotalAmount)]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[f.jsx(vr,{label:"Receipt Date",type:"date",value:pe.date,onChange:m=>De({...pe,date:m.target.value}),small:!0}),f.jsx(zd,{label:"Payment Mode",value:pe.mode,onChange:m=>De({...pe,mode:m.target.value}),options:[{value:"Bank",label:"Bank Transfer"},{value:"Cash",label:"Cash"},{value:"Cheque",label:"Cheque"},{value:"UPI",label:"UPI"}],small:!0})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"12px",marginBottom:"12px"},children:[f.jsx(vr,{label:"Amount Received",type:"number",value:pe.amount,onChange:m=>De({...pe,amount:m.target.value}),placeholder:"0.00",small:!0}),f.jsx(vr,{label:"TDS Deducted",type:"number",value:pe.tds,onChange:m=>De({...pe,tds:m.target.value}),placeholder:"0.00",small:!0}),f.jsx(vr,{label:"Discount",type:"number",value:pe.discount,onChange:m=>De({...pe,discount:m.target.value}),placeholder:"0.00",small:!0})]}),f.jsx("div",{style:{backgroundColor:"#F0FDF4",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:f.jsxs("div",{style:{fontSize:"14px",fontWeight:"700",color:"#166534"},children:["Total Credit: ",ft((parseFloat(pe.amount)||0)+(parseFloat(pe.tds)||0)+(parseFloat(pe.discount)||0))]})}),f.jsx(vr,{label:"Narration",value:pe.narration,onChange:m=>De({...pe,narration:m.target.value}),placeholder:"Payment reference, remarks...",small:!0}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Payment Advisory (Optional)"}),f.jsx("input",{type:"file",ref:ys,accept:"image/*,.pdf",onChange:sc,style:{display:"none"}}),pe.paymentAdvisory?f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[f.jsx("div",{style:{flex:1,padding:"10px",backgroundColor:"#F0FDF4",borderRadius:"8px",fontSize:"13px",color:"#166534"},children:" Payment advisory attached"}),f.jsx("button",{onClick:()=>De(m=>({...m,paymentAdvisory:null})),style:{padding:"8px",border:"none",backgroundColor:"#FEE2E2",borderRadius:"6px",cursor:"pointer",color:"#991B1B"},children:f.jsx(ll,{size:16})})]}):f.jsxs("button",{onClick:()=>{var m;return(m=ys.current)==null?void 0:m.click()},style:{padding:"10px 16px",border:"1.5px dashed #D1D5DB",borderRadius:"8px",backgroundColor:"#F9FAFB",cursor:"pointer",fontSize:"13px",color:"#6B7280",display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(Ks,{size:16})," Attach Payment Advisory"]})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[f.jsx(Xe,{label:"Cancel",onClick:()=>Er(!1)}),f.jsx(Xe,{label:"Create Receipt",variant:"success",icon:$u,onClick:q0})]})]})}),f.jsx(Sn,{isOpen:mr,onClose:()=>{ni(!1),Ie({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]})},title:" Create Credit Note",width:"500px",children:se&&(()=>{var X;const m=(X=se.statePartyDetails)==null?void 0:X.toUpperCase().includes("MAHARASHTRA"),C=m?"CGST + SGST (9% + 9%)":"IGST (18%)",Q=parseFloat(Oe.amount)||0,ee=parseFloat(Oe.gst)||0,Y=Q+ee;return f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice:"})," ",se.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Party:"})," ",se.partyName]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice Amount:"})," ",ft(se.invoiceTotalAmount)]}),f.jsxs("div",{style:{fontSize:"12px",color:"#2563EB"},children:[f.jsx("strong",{children:"GST Type:"})," ",m?"CGST + SGST (Intra-state)":"IGST (Inter-state)"]})]}),f.jsx("div",{style:{marginBottom:"12px"},children:f.jsx(vr,{label:"Credit Note Date",type:"date",value:Oe.date,onChange:H=>Ie({...Oe,date:H.target.value}),small:!0})}),f.jsxs("div",{style:{backgroundColor:"#FEF2F2",padding:"14px",borderRadius:"10px",marginBottom:"12px",border:"1px solid #FECACA"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#991B1B",marginBottom:"10px",fontSize:"13px"},children:" Credit Note Breakdown"}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[f.jsx(vr,{label:"Base Amount",type:"number",value:Oe.amount,onChange:H=>Ie({...Oe,amount:H.target.value}),placeholder:"0.00",small:!0}),f.jsx(vr,{label:C,type:"number",value:Oe.gst,onChange:H=>Ie({...Oe,gst:H.target.value}),placeholder:"0.00",small:!0})]}),f.jsxs("div",{style:{marginTop:"10px",padding:"8px",backgroundColor:"#FEE2E2",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsx("span",{style:{fontSize:"13px",fontWeight:"600",color:"#991B1B"},children:"Total Credit:"}),f.jsx("span",{style:{fontSize:"15px",fontWeight:"700",color:"#991B1B"},children:ft(Y)})]})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Reason for Credit Note *"}),f.jsx("textarea",{value:Oe.reason,onChange:H=>Ie({...Oe,reason:H.target.value}),placeholder:"Enter reason for issuing credit note...",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[f.jsx(Xe,{label:"Cancel",onClick:()=>ni(!1)}),f.jsx(Xe,{label:"Create Credit Note",variant:"danger",icon:Hu,onClick:Q0})]})]})})()}),f.jsx(Sn,{isOpen:L,onClose:()=>{z(!1),ae(null)},title:" Add Followup",width:"500px",children:B&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice:"})," ",B.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Party:"})," ",B.partyName]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Amount:"})," ",ft(B.invoiceTotalAmount||B.totalAmount)]}),f.jsxs("div",{style:{fontSize:"14px"},children:[f.jsx("strong",{children:"Invoice Date:"})," ",xr(B.invoiceDate||B.date)]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[f.jsx(vr,{label:"Followup Date",type:"date",value:ue.date,onChange:m=>ie({...ue,date:m.target.value}),small:!0}),f.jsx(vr,{label:"Next Followup Date",type:"date",value:ue.nextFollowupDate,onChange:m=>ie({...ue,nextFollowupDate:m.target.value}),small:!0})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Followup Notes *"}),f.jsx("textarea",{value:ue.notes,onChange:m=>ie({...ue,notes:m.target.value}),placeholder:"Enter followup notes (e.g., Spoke with accounts team, payment promised by next week)",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Status"}),f.jsxs("select",{value:ue.status,onChange:m=>ie({...ue,status:m.target.value}),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px"},children:[f.jsx("option",{value:"Pending",children:"Pending"}),f.jsx("option",{value:"Promised",children:"Promised - Payment Expected"}),f.jsx("option",{value:"Disputed",children:"Disputed"}),f.jsx("option",{value:"No Response",children:"No Response"})]})]}),f.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[f.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#166534",marginBottom:"8px"},children:" Quick Actions"}),f.jsxs("div",{style:{display:"flex",gap:"8px"},children:[f.jsx(Xe,{icon:Vm,label:"Copy Email Template",small:!0,variant:"brand",onClick:()=>je(B)}),f.jsx(Xe,{icon:zm,label:"Search in Gmail",small:!0,variant:"success",onClick:()=>Wt(B)})]})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[f.jsx(Xe,{label:"Cancel",onClick:()=>z(!1)}),f.jsx(Xe,{label:"Save Followup",variant:"primary",icon:Wm,onClick:O})]})]})}),f.jsx(Sn,{isOpen:qa,onClose:()=>ca(!1),title:" Clear All Data",width:"500px",children:f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"20px",borderRadius:"12px",marginBottom:"20px",border:"2px solid #FCA5A5"},children:[f.jsxs("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"18px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(N2,{size:24})," Warning: This action cannot be undone!"]}),f.jsxs("div",{style:{fontSize:"14px",color:"#7F1D1D",lineHeight:"1.6"},children:["This will permanently delete:",f.jsxs("ul",{style:{margin:"12px 0 0 20px",padding:0},children:[f.jsxs("li",{children:[f.jsx("strong",{children:xe.length})," campaigns from Master Sheet"]}),f.jsxs("li",{children:[f.jsx("strong",{children:xe.filter(m=>m.invoiceGenerated).length})," generated invoices"]}),f.jsxs("li",{children:[f.jsx("strong",{children:Z.length})," receipts"]}),f.jsxs("li",{children:[f.jsx("strong",{children:Le.length})," credit notes"]}),f.jsxs("li",{children:[f.jsx("strong",{children:Ae.length})," ledger entries"]}),f.jsxs("li",{children:[f.jsx("strong",{children:Object.keys(Kr).length})," mailer images"]}),f.jsx("li",{children:"All opening balances"})]})]})]}),f.jsx("div",{style:{backgroundColor:"#FEF3C7",padding:"14px",borderRadius:"8px",marginBottom:"20px",border:"1px solid #FCD34D"},children:f.jsxs("div",{style:{fontSize:"13px",color:"#92400E"},children:[f.jsx("strong",{children:"Note:"})," Invoice series numbers will be reset to 1. Your company settings and mailer logo will be preserved."]})}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[f.jsx(Xe,{label:"Cancel",onClick:()=>ca(!1)}),f.jsx(Xe,{label:"Yes, Clear All Data",variant:"danger",icon:Gs,onClick:M4})]})]})}),f.jsx(Sn,{isOpen:Su,onClose:()=>I(!1),title:" Notifications",width:"550px",children:f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[f.jsx("div",{style:{fontSize:"14px",color:"#64748B"},children:Yi>0?`${Yi} unread`:"No unread notifications"}),f.jsxs("div",{style:{display:"flex",gap:"8px"},children:[Yi>0&&f.jsx("button",{onClick:nc,style:{padding:"6px 12px",fontSize:"12px",fontWeight:"600",border:"1px solid #E2E8F0",borderRadius:"6px",backgroundColor:"#F8FAFC",color:"#475569",cursor:"pointer"},children:"Mark all as read"}),Bn.length>0&&Qt&&f.jsx("button",{onClick:z0,style:{padding:"6px 12px",fontSize:"12px",fontWeight:"600",border:"1px solid #FCA5A5",borderRadius:"6px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer"},children:"Clear all"})]})]}),f.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:wi.length===0?f.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:[f.jsx(P2,{size:40,style:{marginBottom:"12px",opacity:.5}}),f.jsx("div",{style:{fontSize:"16px",fontWeight:"600"},children:"No notifications"}),f.jsx("div",{style:{fontSize:"13px",marginTop:"4px"},children:"You're all caught up!"})]}):wi.map(m=>{const C=!(m.read&&m.read[r]),Q=Y=>{switch(Y){case"upload":return"";case"invoice":return"";case"approval":return"";case"edit":return"";case"receipt":return"";default:return""}},ee=Y=>{switch(Y){case"upload":return"#EFF6FF";case"invoice":return"#FEF3C7";case"approval":return"#DCFCE7";case"edit":return"#FEE2E2";case"receipt":return"#F0FDF4";default:return"#F8FAFC"}};return f.jsx("div",{onClick:()=>U0(m.id),style:{padding:"14px",borderRadius:"10px",marginBottom:"8px",backgroundColor:C?ee(m.type):"#F8FAFC",border:C?"2px solid #2874A6":"1px solid #E2E8F0",cursor:"pointer",transition:"all 0.2s ease"},children:f.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[f.jsx("div",{style:{fontSize:"20px"},children:Q(m.type)}),f.jsxs("div",{style:{flex:1},children:[f.jsx("div",{style:{fontSize:"14px",fontWeight:C?"600":"500",color:"#1E293B",lineHeight:"1.4"},children:m.message}),f.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"8px",fontSize:"11px",color:"#64748B"},children:[f.jsxs("span",{children:["By: ",m.createdBy==="finance"?"Finance Team":"Director"]}),f.jsx("span",{children:""}),f.jsx("span",{children:new Date(m.createdAt).toLocaleString()})]})]}),C&&f.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#DC2626",flexShrink:0}})]})},m.id)})})]})})]}),sF=()=>{switch(N){case"master":return cy();case"invoices":return J4();case"ledgers":return eF();case"followups":return rF();case"reports":return dy();case"settings":return r==="finance"?nF():dy();default:return cy()}},aF=()=>f.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 50%, #1E3A5F 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',padding:"20px"},children:f.jsxs("div",{style:{backgroundColor:"#FFFFFF",padding:"0",borderRadius:"24px",boxShadow:"0 25px 50px -12px rgba(0,0,0,0.25)",width:"420px",maxWidth:"95vw",overflow:"hidden"},children:[f.jsxs("div",{style:{background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 100%)",padding:"32px 40px",textAlign:"center"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:"8px"},children:[f.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"60px",height:"auto",borderRadius:"8px",backgroundColor:"white",padding:"4px"}}),f.jsx("span",{style:{fontSize:"36px",fontWeight:"800",color:"#FFFFFF",letterSpacing:"-1px"},children:"FinMate"})]}),f.jsx("p",{style:{margin:0,color:"rgba(255,255,255,0.8)",fontSize:"14px",fontWeight:"500"},children:"Finance Management System"})]}),f.jsxs("div",{style:{padding:"32px 40px"},children:[f.jsxs("div",{style:{marginBottom:"24px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#1E3A5F",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Username"}),f.jsxs("div",{style:{position:"relative"},children:[f.jsx(z2,{size:18,style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"text",value:i.username,onChange:m=>s(C=>({...C,username:m.target.value})),placeholder:"Enter username",style:{width:"100%",padding:"14px 14px 14px 44px",borderRadius:"12px",border:"2px solid #E2E8F0",fontSize:"15px",boxSizing:"border-box",transition:"border-color 0.2s, box-shadow 0.2s",outline:"none"},onFocus:m=>{m.target.style.borderColor="#2874A6",m.target.style.boxShadow="0 0 0 3px rgba(40,116,166,0.1)"},onBlur:m=>{m.target.style.borderColor="#E2E8F0",m.target.style.boxShadow="none"}})]})]}),f.jsxs("div",{style:{marginBottom:"28px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#1E3A5F",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Password"}),f.jsxs("div",{style:{position:"relative"},children:[f.jsx(Pd,{size:18,style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"password",value:i.password,onChange:m=>s(C=>({...C,password:m.target.value})),placeholder:"Enter password",onKeyPress:m=>m.key==="Enter"&&W0(),style:{width:"100%",padding:"14px 14px 14px 44px",borderRadius:"12px",border:"2px solid #E2E8F0",fontSize:"15px",boxSizing:"border-box",transition:"border-color 0.2s, box-shadow 0.2s",outline:"none"},onFocus:m=>{m.target.style.borderColor="#2874A6",m.target.style.boxShadow="0 0 0 3px rgba(40,116,166,0.1)"},onBlur:m=>{m.target.style.borderColor="#E2E8F0",m.target.style.boxShadow="none"}})]})]}),a&&f.jsxs("div",{style:{marginBottom:"20px",padding:"14px",backgroundColor:"#FEF2F2",borderRadius:"12px",color:"#DC2626",fontSize:"14px",textAlign:"center",border:"1px solid #FECACA",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[f.jsx(N2,{size:18}),a]}),f.jsx("button",{onClick:W0,style:{width:"100%",padding:"16px",fontSize:"16px",fontWeight:"700",border:"none",borderRadius:"12px",cursor:E?"pointer":"wait",background:E?"linear-gradient(135deg, #1E3A5F 0%, #2874A6 100%)":"#94A3B8",color:"white",transition:"transform 0.2s, box-shadow 0.2s",boxShadow:E?"0 4px 14px rgba(40,116,166,0.4)":"none",opacity:E?1:.7},disabled:!E,onMouseOver:m=>{E&&(m.target.style.transform="translateY(-2px)",m.target.style.boxShadow="0 6px 20px rgba(40,116,166,0.5)")},onMouseOut:m=>{E&&(m.target.style.transform="translateY(0)",m.target.style.boxShadow="0 4px 14px rgba(40,116,166,0.4)")},children:E?"Sign In":"Loading..."}),f.jsxs("div",{style:{marginTop:"24px",textAlign:"center",color:"#94A3B8",fontSize:"12px"},children:[f.jsx("span",{children:"Powered by "}),f.jsx("span",{style:{fontWeight:"600",color:"#1E3A5F"},children:"JAC"}),f.jsx("span",{children:"  Strategy | Talent | Results"})]})]})]})});return t?l?f.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 50%, #1E3A5F 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[f.jsxs("div",{style:{textAlign:"center"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:"24px"},children:[f.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"50px",height:"auto",borderRadius:"8px",backgroundColor:"white",padding:"4px"}}),f.jsx("span",{style:{fontSize:"32px",fontWeight:"800",color:"#FFFFFF",letterSpacing:"-1px"},children:"FinMate"})]}),f.jsx(B2,{size:48,style:{animation:"spin 1s linear infinite",color:"#FFFFFF",marginBottom:"16px"}}),f.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:"#FFFFFF"},children:"Loading your data..."}),f.jsx("div",{style:{fontSize:"14px",color:"rgba(255,255,255,0.7)",marginTop:"8px"},children:"Please wait while we sync with the cloud"})]}),f.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]}):f.jsxs("div",{style:{display:"flex",height:"100vh",backgroundColor:"#F1F5F9",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[q4(),f.jsx("main",{style:{flex:1,overflow:"auto",padding:"20px"},children:sF()}),iF(),f.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]}):aF()}ng.createRoot(document.getElementById("root")).render(f.jsx($d.StrictMode,{children:f.jsx(LW,{})}));
