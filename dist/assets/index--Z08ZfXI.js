(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function sb(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var vS={exports:{}},Ap={},yS={exports:{}},Vt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jf=Symbol.for("react.element"),ab=Symbol.for("react.portal"),ob=Symbol.for("react.fragment"),lb=Symbol.for("react.strict_mode"),cb=Symbol.for("react.profiler"),ub=Symbol.for("react.provider"),db=Symbol.for("react.context"),fb=Symbol.for("react.forward_ref"),hb=Symbol.for("react.suspense"),pb=Symbol.for("react.memo"),gb=Symbol.for("react.lazy"),Ny=Symbol.iterator;function mb(t){return t===null||typeof t!="object"?null:(t=Ny&&t[Ny]||t["@@iterator"],typeof t=="function"?t:null)}var _S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ES=Object.assign,SS={};function Ru(t,e,r){this.props=t,this.context=e,this.refs=SS,this.updater=r||_S}Ru.prototype.isReactComponent={};Ru.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ru.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function wS(){}wS.prototype=Ru.prototype;function $x(t,e,r){this.props=t,this.context=e,this.refs=SS,this.updater=r||_S}var Gx=$x.prototype=new wS;Gx.constructor=$x;ES(Gx,Ru.prototype);Gx.isPureReactComponent=!0;var Ry=Array.isArray,TS=Object.prototype.hasOwnProperty,Kx={current:null},AS={key:!0,ref:!0,__self:!0,__source:!0};function CS(t,e,r){var n,i={},s=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)TS.call(e,n)&&!AS.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:jf,type:t,key:s,ref:a,props:i,_owner:Kx.current}}function xb(t,e){return{$$typeof:jf,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Yx(t){return typeof t=="object"&&t!==null&&t.$$typeof===jf}function vb(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var Dy=/\/+/g;function mg(t,e){return typeof t=="object"&&t!==null&&t.key!=null?vb(""+t.key):e.toString(36)}function nh(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case jf:case ab:a=!0}}if(a)return a=t,i=i(a),t=n===""?"."+mg(a,0):n,Ry(i)?(r="",t!=null&&(r=t.replace(Dy,"$&/")+"/"),nh(i,e,r,"",function(u){return u})):i!=null&&(Yx(i)&&(i=xb(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(Dy,"$&/")+"/")+t)),e.push(i)),1;if(a=0,n=n===""?".":n+":",Ry(t))for(var o=0;o<t.length;o++){s=t[o];var l=n+mg(s,o);a+=nh(s,e,r,l,i)}else if(l=mb(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=n+mg(s,o++),a+=nh(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function x0(t,e,r){if(t==null)return t;var n=[],i=0;return nh(t,n,"","",function(s){return e.call(r,s,i++)}),n}function yb(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ri={current:null},ih={transition:null},_b={ReactCurrentDispatcher:Ri,ReactCurrentBatchConfig:ih,ReactCurrentOwner:Kx};function kS(){throw Error("act(...) is not supported in production builds of React.")}Vt.Children={map:x0,forEach:function(t,e,r){x0(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return x0(t,function(){e++}),e},toArray:function(t){return x0(t,function(e){return e})||[]},only:function(t){if(!Yx(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Vt.Component=Ru;Vt.Fragment=ob;Vt.Profiler=cb;Vt.PureComponent=$x;Vt.StrictMode=lb;Vt.Suspense=hb;Vt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_b;Vt.act=kS;Vt.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=ES({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=Kx.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)TS.call(e,l)&&!AS.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:jf,type:t.type,key:i,ref:s,props:n,_owner:a}};Vt.createContext=function(t){return t={$$typeof:db,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:ub,_context:t},t.Consumer=t};Vt.createElement=CS;Vt.createFactory=function(t){var e=CS.bind(null,t);return e.type=t,e};Vt.createRef=function(){return{current:null}};Vt.forwardRef=function(t){return{$$typeof:fb,render:t}};Vt.isValidElement=Yx;Vt.lazy=function(t){return{$$typeof:gb,_payload:{_status:-1,_result:t},_init:yb}};Vt.memo=function(t,e){return{$$typeof:pb,type:t,compare:e===void 0?null:e}};Vt.startTransition=function(t){var e=ih.transition;ih.transition={};try{t()}finally{ih.transition=e}};Vt.unstable_act=kS;Vt.useCallback=function(t,e){return Ri.current.useCallback(t,e)};Vt.useContext=function(t){return Ri.current.useContext(t)};Vt.useDebugValue=function(){};Vt.useDeferredValue=function(t){return Ri.current.useDeferredValue(t)};Vt.useEffect=function(t,e){return Ri.current.useEffect(t,e)};Vt.useId=function(){return Ri.current.useId()};Vt.useImperativeHandle=function(t,e,r){return Ri.current.useImperativeHandle(t,e,r)};Vt.useInsertionEffect=function(t,e){return Ri.current.useInsertionEffect(t,e)};Vt.useLayoutEffect=function(t,e){return Ri.current.useLayoutEffect(t,e)};Vt.useMemo=function(t,e){return Ri.current.useMemo(t,e)};Vt.useReducer=function(t,e,r){return Ri.current.useReducer(t,e,r)};Vt.useRef=function(t){return Ri.current.useRef(t)};Vt.useState=function(t){return Ri.current.useState(t)};Vt.useSyncExternalStore=function(t,e,r){return Ri.current.useSyncExternalStore(t,e,r)};Vt.useTransition=function(){return Ri.current.useTransition()};Vt.version="18.3.1";yS.exports=Vt;var ve=yS.exports;const sh=sb(ve);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eb=ve,Sb=Symbol.for("react.element"),wb=Symbol.for("react.fragment"),Tb=Object.prototype.hasOwnProperty,Ab=Eb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Cb={key:!0,ref:!0,__self:!0,__source:!0};function FS(t,e,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)Tb.call(e,n)&&!Cb.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:Sb,type:t,key:s,ref:a,props:i,_owner:Ab.current}}Ap.Fragment=wb;Ap.jsx=FS;Ap.jsxs=FS;vS.exports=Ap;var c=vS.exports,vm={},bS={exports:{}},ps={},IS={exports:{}},NS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Ae,ne){var be=Ae.length;Ae.push(ne);e:for(;0<be;){var je=be-1>>>1,H=Ae[je];if(0<i(H,ne))Ae[je]=ne,Ae[be]=H,be=je;else break e}}function r(Ae){return Ae.length===0?null:Ae[0]}function n(Ae){if(Ae.length===0)return null;var ne=Ae[0],be=Ae.pop();if(be!==ne){Ae[0]=be;e:for(var je=0,H=Ae.length,te=H>>>1;je<te;){var re=2*(je+1)-1,Y=Ae[re],ye=re+1,Te=Ae[ye];if(0>i(Y,be))ye<H&&0>i(Te,Y)?(Ae[je]=Te,Ae[ye]=be,je=ye):(Ae[je]=Y,Ae[re]=be,je=re);else if(ye<H&&0>i(Te,be))Ae[je]=Te,Ae[ye]=be,je=ye;else break e}}return ne}function i(Ae,ne){var be=Ae.sortIndex-ne.sortIndex;return be!==0?be:Ae.id-ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],u=[],f=1,p=null,g=3,m=!1,y=!1,x=!1,S=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(Ae){for(var ne=r(u);ne!==null;){if(ne.callback===null)n(u);else if(ne.startTime<=Ae)n(u),ne.sortIndex=ne.expirationTime,e(l,ne);else break;ne=r(u)}}function M(Ae){if(x=!1,E(Ae),!y)if(r(l)!==null)y=!0,Pe(X);else{var ne=r(u);ne!==null&&Fe(M,ne.startTime-Ae)}}function X(Ae,ne){y=!1,x&&(x=!1,A(F),F=-1),m=!0;var be=g;try{for(E(ne),p=r(l);p!==null&&(!(p.expirationTime>ne)||Ae&&!P());){var je=p.callback;if(typeof je=="function"){p.callback=null,g=p.priorityLevel;var H=je(p.expirationTime<=ne);ne=t.unstable_now(),typeof H=="function"?p.callback=H:p===r(l)&&n(l),E(ne)}else n(l);p=r(l)}if(p!==null)var te=!0;else{var re=r(u);re!==null&&Fe(M,re.startTime-ne),te=!1}return te}finally{p=null,g=be,m=!1}}var z=!1,T=null,F=-1,w=5,R=-1;function P(){return!(t.unstable_now()-R<w)}function O(){if(T!==null){var Ae=t.unstable_now();R=Ae;var ne=!0;try{ne=T(!0,Ae)}finally{ne?D():(z=!1,T=null)}}else z=!1}var D;if(typeof C=="function")D=function(){C(O)};else if(typeof MessageChannel<"u"){var qe=new MessageChannel,Ee=qe.port2;qe.port1.onmessage=O,D=function(){Ee.postMessage(null)}}else D=function(){S(O,0)};function Pe(Ae){T=Ae,z||(z=!0,D())}function Fe(Ae,ne){F=S(function(){Ae(t.unstable_now())},ne)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Ae){Ae.callback=null},t.unstable_continueExecution=function(){y||m||(y=!0,Pe(X))},t.unstable_forceFrameRate=function(Ae){0>Ae||125<Ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):w=0<Ae?Math.floor(1e3/Ae):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(Ae){switch(g){case 1:case 2:case 3:var ne=3;break;default:ne=g}var be=g;g=ne;try{return Ae()}finally{g=be}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Ae,ne){switch(Ae){case 1:case 2:case 3:case 4:case 5:break;default:Ae=3}var be=g;g=Ae;try{return ne()}finally{g=be}},t.unstable_scheduleCallback=function(Ae,ne,be){var je=t.unstable_now();switch(typeof be=="object"&&be!==null?(be=be.delay,be=typeof be=="number"&&0<be?je+be:je):be=je,Ae){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=be+H,Ae={id:f++,callback:ne,priorityLevel:Ae,startTime:be,expirationTime:H,sortIndex:-1},be>je?(Ae.sortIndex=be,e(u,Ae),r(l)===null&&Ae===r(u)&&(x?(A(F),F=-1):x=!0,Fe(M,be-je))):(Ae.sortIndex=H,e(l,Ae),y||m||(y=!0,Pe(X))),Ae},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(Ae){var ne=g;return function(){var be=g;g=ne;try{return Ae.apply(this,arguments)}finally{g=be}}}})(NS);IS.exports=NS;var kb=IS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fb=ve,fs=kb;function Le(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var RS=new Set,qd={};function cc(t,e){hu(t,e),hu(t+"Capture",e)}function hu(t,e){for(qd[t]=e,t=0;t<e.length;t++)RS.add(e[t])}var to=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ym=Object.prototype.hasOwnProperty,bb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Py={},Oy={};function Ib(t){return ym.call(Oy,t)?!0:ym.call(Py,t)?!1:bb.test(t)?Oy[t]=!0:(Py[t]=!0,!1)}function Nb(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Rb(t,e,r,n){if(e===null||typeof e>"u"||Nb(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Di(t,e,r,n,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var ti={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ti[t]=new Di(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ti[e]=new Di(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ti[t]=new Di(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ti[t]=new Di(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ti[t]=new Di(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ti[t]=new Di(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ti[t]=new Di(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ti[t]=new Di(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ti[t]=new Di(t,5,!1,t.toLowerCase(),null,!1,!1)});var Xx=/[\-:]([a-z])/g;function qx(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Xx,qx);ti[e]=new Di(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Xx,qx);ti[e]=new Di(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Xx,qx);ti[e]=new Di(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ti[t]=new Di(t,1,!1,t.toLowerCase(),null,!1,!1)});ti.xlinkHref=new Di("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ti[t]=new Di(t,1,!1,t.toLowerCase(),null,!0,!0)});function Qx(t,e,r,n){var i=ti.hasOwnProperty(e)?ti[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Rb(e,r,i,n)&&(r=null),n||i===null?Ib(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var fo=Fb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,v0=Symbol.for("react.element"),Lc=Symbol.for("react.portal"),Uc=Symbol.for("react.fragment"),Jx=Symbol.for("react.strict_mode"),_m=Symbol.for("react.profiler"),DS=Symbol.for("react.provider"),PS=Symbol.for("react.context"),Zx=Symbol.for("react.forward_ref"),Em=Symbol.for("react.suspense"),Sm=Symbol.for("react.suspense_list"),e1=Symbol.for("react.memo"),Mo=Symbol.for("react.lazy"),OS=Symbol.for("react.offscreen"),My=Symbol.iterator;function nd(t){return t===null||typeof t!="object"?null:(t=My&&t[My]||t["@@iterator"],typeof t=="function"?t:null)}var Kr=Object.assign,xg;function xd(t){if(xg===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);xg=e&&e[1]||""}return`
`+xg+t}var vg=!1;function yg(t,e){if(!t||vg)return"";vg=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{vg=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?xd(t):""}function Db(t){switch(t.tag){case 5:return xd(t.type);case 16:return xd("Lazy");case 13:return xd("Suspense");case 19:return xd("SuspenseList");case 0:case 2:case 15:return t=yg(t.type,!1),t;case 11:return t=yg(t.type.render,!1),t;case 1:return t=yg(t.type,!0),t;default:return""}}function wm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Uc:return"Fragment";case Lc:return"Portal";case _m:return"Profiler";case Jx:return"StrictMode";case Em:return"Suspense";case Sm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case PS:return(t.displayName||"Context")+".Consumer";case DS:return(t._context.displayName||"Context")+".Provider";case Zx:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case e1:return e=t.displayName||null,e!==null?e:wm(t.type)||"Memo";case Mo:e=t._payload,t=t._init;try{return wm(t(e))}catch{}}return null}function Pb(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return wm(e);case 8:return e===Jx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function cl(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function MS(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Ob(t){var e=MS(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function y0(t){t._valueTracker||(t._valueTracker=Ob(t))}function BS(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=MS(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Ah(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Tm(t,e){var r=e.checked;return Kr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function By(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=cl(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function jS(t,e){e=e.checked,e!=null&&Qx(t,"checked",e,!1)}function Am(t,e){jS(t,e);var r=cl(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Cm(t,e.type,r):e.hasOwnProperty("defaultValue")&&Cm(t,e.type,cl(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function jy(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Cm(t,e,r){(e!=="number"||Ah(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var vd=Array.isArray;function Zc(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+cl(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function km(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Le(91));return Kr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ly(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Le(92));if(vd(r)){if(1<r.length)throw Error(Le(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:cl(r)}}function LS(t,e){var r=cl(e.value),n=cl(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function Uy(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function US(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Fm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?US(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var _0,VS=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(_0=_0||document.createElement("div"),_0.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=_0.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Qd(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Fd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Mb=["Webkit","ms","Moz","O"];Object.keys(Fd).forEach(function(t){Mb.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Fd[e]=Fd[t]})});function zS(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Fd.hasOwnProperty(t)&&Fd[t]?(""+e).trim():e+"px"}function WS(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=zS(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var Bb=Kr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function bm(t,e){if(e){if(Bb[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Le(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Le(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Le(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Le(62))}}function Im(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Nm=null;function t1(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Rm=null,eu=null,tu=null;function Vy(t){if(t=Vf(t)){if(typeof Rm!="function")throw Error(Le(280));var e=t.stateNode;e&&(e=Ip(e),Rm(t.stateNode,t.type,e))}}function HS(t){eu?tu?tu.push(t):tu=[t]:eu=t}function $S(){if(eu){var t=eu,e=tu;if(tu=eu=null,Vy(t),e)for(t=0;t<e.length;t++)Vy(e[t])}}function GS(t,e){return t(e)}function KS(){}var _g=!1;function YS(t,e,r){if(_g)return t(e,r);_g=!0;try{return GS(t,e,r)}finally{_g=!1,(eu!==null||tu!==null)&&(KS(),$S())}}function Jd(t,e){var r=t.stateNode;if(r===null)return null;var n=Ip(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Le(231,e,typeof r));return r}var Dm=!1;if(to)try{var id={};Object.defineProperty(id,"passive",{get:function(){Dm=!0}}),window.addEventListener("test",id,id),window.removeEventListener("test",id,id)}catch{Dm=!1}function jb(t,e,r,n,i,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(f){this.onError(f)}}var bd=!1,Ch=null,kh=!1,Pm=null,Lb={onError:function(t){bd=!0,Ch=t}};function Ub(t,e,r,n,i,s,a,o,l){bd=!1,Ch=null,jb.apply(Lb,arguments)}function Vb(t,e,r,n,i,s,a,o,l){if(Ub.apply(this,arguments),bd){if(bd){var u=Ch;bd=!1,Ch=null}else throw Error(Le(198));kh||(kh=!0,Pm=u)}}function uc(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function XS(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function zy(t){if(uc(t)!==t)throw Error(Le(188))}function zb(t){var e=t.alternate;if(!e){if(e=uc(t),e===null)throw Error(Le(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return zy(i),t;if(s===n)return zy(i),e;s=s.sibling}throw Error(Le(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(Le(189))}}if(r.alternate!==n)throw Error(Le(190))}if(r.tag!==3)throw Error(Le(188));return r.stateNode.current===r?t:e}function qS(t){return t=zb(t),t!==null?QS(t):null}function QS(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=QS(t);if(e!==null)return e;t=t.sibling}return null}var JS=fs.unstable_scheduleCallback,Wy=fs.unstable_cancelCallback,Wb=fs.unstable_shouldYield,Hb=fs.unstable_requestPaint,cn=fs.unstable_now,$b=fs.unstable_getCurrentPriorityLevel,r1=fs.unstable_ImmediatePriority,ZS=fs.unstable_UserBlockingPriority,Fh=fs.unstable_NormalPriority,Gb=fs.unstable_LowPriority,ew=fs.unstable_IdlePriority,Cp=null,Ca=null;function Kb(t){if(Ca&&typeof Ca.onCommitFiberRoot=="function")try{Ca.onCommitFiberRoot(Cp,t,void 0,(t.current.flags&128)===128)}catch{}}var ea=Math.clz32?Math.clz32:qb,Yb=Math.log,Xb=Math.LN2;function qb(t){return t>>>=0,t===0?32:31-(Yb(t)/Xb|0)|0}var E0=64,S0=4194304;function yd(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function bh(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=yd(o):(s&=a,s!==0&&(n=yd(s)))}else a=r&~i,a!==0?n=yd(a):s!==0&&(n=yd(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-ea(e),i=1<<r,n|=t[r],e&=~i;return n}function Qb(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Jb(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-ea(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=Qb(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function Om(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function tw(){var t=E0;return E0<<=1,!(E0&4194240)&&(E0=64),t}function Eg(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Lf(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ea(e),t[e]=r}function Zb(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-ea(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function n1(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-ea(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var gr=0;function rw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var nw,i1,iw,sw,aw,Mm=!1,w0=[],qo=null,Qo=null,Jo=null,Zd=new Map,ef=new Map,jo=[],eI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Hy(t,e){switch(t){case"focusin":case"focusout":qo=null;break;case"dragenter":case"dragleave":Qo=null;break;case"mouseover":case"mouseout":Jo=null;break;case"pointerover":case"pointerout":Zd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ef.delete(e.pointerId)}}function sd(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Vf(e),e!==null&&i1(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function tI(t,e,r,n,i){switch(e){case"focusin":return qo=sd(qo,t,e,r,n,i),!0;case"dragenter":return Qo=sd(Qo,t,e,r,n,i),!0;case"mouseover":return Jo=sd(Jo,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return Zd.set(s,sd(Zd.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,ef.set(s,sd(ef.get(s)||null,t,e,r,n,i)),!0}return!1}function ow(t){var e=Pl(t.target);if(e!==null){var r=uc(e);if(r!==null){if(e=r.tag,e===13){if(e=XS(r),e!==null){t.blockedOn=e,aw(t.priority,function(){iw(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ah(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=Bm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);Nm=n,r.target.dispatchEvent(n),Nm=null}else return e=Vf(r),e!==null&&i1(e),t.blockedOn=r,!1;e.shift()}return!0}function $y(t,e,r){ah(t)&&r.delete(e)}function rI(){Mm=!1,qo!==null&&ah(qo)&&(qo=null),Qo!==null&&ah(Qo)&&(Qo=null),Jo!==null&&ah(Jo)&&(Jo=null),Zd.forEach($y),ef.forEach($y)}function ad(t,e){t.blockedOn===e&&(t.blockedOn=null,Mm||(Mm=!0,fs.unstable_scheduleCallback(fs.unstable_NormalPriority,rI)))}function tf(t){function e(i){return ad(i,t)}if(0<w0.length){ad(w0[0],t);for(var r=1;r<w0.length;r++){var n=w0[r];n.blockedOn===t&&(n.blockedOn=null)}}for(qo!==null&&ad(qo,t),Qo!==null&&ad(Qo,t),Jo!==null&&ad(Jo,t),Zd.forEach(e),ef.forEach(e),r=0;r<jo.length;r++)n=jo[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<jo.length&&(r=jo[0],r.blockedOn===null);)ow(r),r.blockedOn===null&&jo.shift()}var ru=fo.ReactCurrentBatchConfig,Ih=!0;function nI(t,e,r,n){var i=gr,s=ru.transition;ru.transition=null;try{gr=1,s1(t,e,r,n)}finally{gr=i,ru.transition=s}}function iI(t,e,r,n){var i=gr,s=ru.transition;ru.transition=null;try{gr=4,s1(t,e,r,n)}finally{gr=i,ru.transition=s}}function s1(t,e,r,n){if(Ih){var i=Bm(t,e,r,n);if(i===null)Ng(t,e,n,Nh,r),Hy(t,n);else if(tI(i,t,e,r,n))n.stopPropagation();else if(Hy(t,n),e&4&&-1<eI.indexOf(t)){for(;i!==null;){var s=Vf(i);if(s!==null&&nw(s),s=Bm(t,e,r,n),s===null&&Ng(t,e,n,Nh,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Ng(t,e,n,null,r)}}var Nh=null;function Bm(t,e,r,n){if(Nh=null,t=t1(n),t=Pl(t),t!==null)if(e=uc(t),e===null)t=null;else if(r=e.tag,r===13){if(t=XS(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Nh=t,null}function lw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($b()){case r1:return 1;case ZS:return 4;case Fh:case Gb:return 16;case ew:return 536870912;default:return 16}default:return 16}}var Ho=null,a1=null,oh=null;function cw(){if(oh)return oh;var t,e=a1,r=e.length,n,i="value"in Ho?Ho.value:Ho.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===i[s-n];n++);return oh=i.slice(t,1<n?1-n:void 0)}function lh(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function T0(){return!0}function Gy(){return!1}function gs(t){function e(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?T0:Gy,this.isPropagationStopped=Gy,this}return Kr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=T0)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=T0)},persist:function(){},isPersistent:T0}),e}var Du={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},o1=gs(Du),Uf=Kr({},Du,{view:0,detail:0}),sI=gs(Uf),Sg,wg,od,kp=Kr({},Uf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:l1,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==od&&(od&&t.type==="mousemove"?(Sg=t.screenX-od.screenX,wg=t.screenY-od.screenY):wg=Sg=0,od=t),Sg)},movementY:function(t){return"movementY"in t?t.movementY:wg}}),Ky=gs(kp),aI=Kr({},kp,{dataTransfer:0}),oI=gs(aI),lI=Kr({},Uf,{relatedTarget:0}),Tg=gs(lI),cI=Kr({},Du,{animationName:0,elapsedTime:0,pseudoElement:0}),uI=gs(cI),dI=Kr({},Du,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),fI=gs(dI),hI=Kr({},Du,{data:0}),Yy=gs(hI),pI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xI(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=mI[t])?!!e[t]:!1}function l1(){return xI}var vI=Kr({},Uf,{key:function(t){if(t.key){var e=pI[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=lh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?gI[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:l1,charCode:function(t){return t.type==="keypress"?lh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?lh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),yI=gs(vI),_I=Kr({},kp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xy=gs(_I),EI=Kr({},Uf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:l1}),SI=gs(EI),wI=Kr({},Du,{propertyName:0,elapsedTime:0,pseudoElement:0}),TI=gs(wI),AI=Kr({},kp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),CI=gs(AI),kI=[9,13,27,32],c1=to&&"CompositionEvent"in window,Id=null;to&&"documentMode"in document&&(Id=document.documentMode);var FI=to&&"TextEvent"in window&&!Id,uw=to&&(!c1||Id&&8<Id&&11>=Id),qy=" ",Qy=!1;function dw(t,e){switch(t){case"keyup":return kI.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Vc=!1;function bI(t,e){switch(t){case"compositionend":return fw(e);case"keypress":return e.which!==32?null:(Qy=!0,qy);case"textInput":return t=e.data,t===qy&&Qy?null:t;default:return null}}function II(t,e){if(Vc)return t==="compositionend"||!c1&&dw(t,e)?(t=cw(),oh=a1=Ho=null,Vc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return uw&&e.locale!=="ko"?null:e.data;default:return null}}var NI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Jy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!NI[t.type]:e==="textarea"}function hw(t,e,r,n){HS(n),e=Rh(e,"onChange"),0<e.length&&(r=new o1("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Nd=null,rf=null;function RI(t){Tw(t,0)}function Fp(t){var e=Hc(t);if(BS(e))return t}function DI(t,e){if(t==="change")return e}var pw=!1;if(to){var Ag;if(to){var Cg="oninput"in document;if(!Cg){var Zy=document.createElement("div");Zy.setAttribute("oninput","return;"),Cg=typeof Zy.oninput=="function"}Ag=Cg}else Ag=!1;pw=Ag&&(!document.documentMode||9<document.documentMode)}function e2(){Nd&&(Nd.detachEvent("onpropertychange",gw),rf=Nd=null)}function gw(t){if(t.propertyName==="value"&&Fp(rf)){var e=[];hw(e,rf,t,t1(t)),YS(RI,e)}}function PI(t,e,r){t==="focusin"?(e2(),Nd=e,rf=r,Nd.attachEvent("onpropertychange",gw)):t==="focusout"&&e2()}function OI(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Fp(rf)}function MI(t,e){if(t==="click")return Fp(e)}function BI(t,e){if(t==="input"||t==="change")return Fp(e)}function jI(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ia=typeof Object.is=="function"?Object.is:jI;function nf(t,e){if(ia(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!ym.call(e,i)||!ia(t[i],e[i]))return!1}return!0}function t2(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function r2(t,e){var r=t2(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=t2(r)}}function mw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?mw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function xw(){for(var t=window,e=Ah();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Ah(t.document)}return e}function u1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function LI(t){var e=xw(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&mw(r.ownerDocument.documentElement,r)){if(n!==null&&u1(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=r2(r,s);var a=r2(r,n);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var UI=to&&"documentMode"in document&&11>=document.documentMode,zc=null,jm=null,Rd=null,Lm=!1;function n2(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Lm||zc==null||zc!==Ah(n)||(n=zc,"selectionStart"in n&&u1(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Rd&&nf(Rd,n)||(Rd=n,n=Rh(jm,"onSelect"),0<n.length&&(e=new o1("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=zc)))}function A0(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Wc={animationend:A0("Animation","AnimationEnd"),animationiteration:A0("Animation","AnimationIteration"),animationstart:A0("Animation","AnimationStart"),transitionend:A0("Transition","TransitionEnd")},kg={},vw={};to&&(vw=document.createElement("div").style,"AnimationEvent"in window||(delete Wc.animationend.animation,delete Wc.animationiteration.animation,delete Wc.animationstart.animation),"TransitionEvent"in window||delete Wc.transitionend.transition);function bp(t){if(kg[t])return kg[t];if(!Wc[t])return t;var e=Wc[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in vw)return kg[t]=e[r];return t}var yw=bp("animationend"),_w=bp("animationiteration"),Ew=bp("animationstart"),Sw=bp("transitionend"),ww=new Map,i2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function vl(t,e){ww.set(t,e),cc(e,[t])}for(var Fg=0;Fg<i2.length;Fg++){var bg=i2[Fg],VI=bg.toLowerCase(),zI=bg[0].toUpperCase()+bg.slice(1);vl(VI,"on"+zI)}vl(yw,"onAnimationEnd");vl(_w,"onAnimationIteration");vl(Ew,"onAnimationStart");vl("dblclick","onDoubleClick");vl("focusin","onFocus");vl("focusout","onBlur");vl(Sw,"onTransitionEnd");hu("onMouseEnter",["mouseout","mouseover"]);hu("onMouseLeave",["mouseout","mouseover"]);hu("onPointerEnter",["pointerout","pointerover"]);hu("onPointerLeave",["pointerout","pointerover"]);cc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));cc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));cc("onBeforeInput",["compositionend","keypress","textInput","paste"]);cc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));cc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));cc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _d="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),WI=new Set("cancel close invalid load scroll toggle".split(" ").concat(_d));function s2(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,Vb(n,e,void 0,t),t.currentTarget=null}function Tw(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;s2(i,o,u),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;s2(i,o,u),s=l}}}if(kh)throw t=Pm,kh=!1,Pm=null,t}function Fr(t,e){var r=e[Hm];r===void 0&&(r=e[Hm]=new Set);var n=t+"__bubble";r.has(n)||(Aw(e,t,2,!1),r.add(n))}function Ig(t,e,r){var n=0;e&&(n|=4),Aw(r,t,n,e)}var C0="_reactListening"+Math.random().toString(36).slice(2);function sf(t){if(!t[C0]){t[C0]=!0,RS.forEach(function(r){r!=="selectionchange"&&(WI.has(r)||Ig(r,!1,t),Ig(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[C0]||(e[C0]=!0,Ig("selectionchange",!1,e))}}function Aw(t,e,r,n){switch(lw(e)){case 1:var i=nI;break;case 4:i=iI;break;default:i=s1}r=i.bind(null,e,r,t),i=void 0,!Dm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function Ng(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=Pl(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}YS(function(){var u=s,f=t1(r),p=[];e:{var g=ww.get(t);if(g!==void 0){var m=o1,y=t;switch(t){case"keypress":if(lh(r)===0)break e;case"keydown":case"keyup":m=yI;break;case"focusin":y="focus",m=Tg;break;case"focusout":y="blur",m=Tg;break;case"beforeblur":case"afterblur":m=Tg;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Ky;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=oI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=SI;break;case yw:case _w:case Ew:m=uI;break;case Sw:m=TI;break;case"scroll":m=sI;break;case"wheel":m=CI;break;case"copy":case"cut":case"paste":m=fI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Xy}var x=(e&4)!==0,S=!x&&t==="scroll",A=x?g!==null?g+"Capture":null:g;x=[];for(var C=u,E;C!==null;){E=C;var M=E.stateNode;if(E.tag===5&&M!==null&&(E=M,A!==null&&(M=Jd(C,A),M!=null&&x.push(af(C,M,E)))),S)break;C=C.return}0<x.length&&(g=new m(g,y,null,r,f),p.push({event:g,listeners:x}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",g&&r!==Nm&&(y=r.relatedTarget||r.fromElement)&&(Pl(y)||y[ro]))break e;if((m||g)&&(g=f.window===f?f:(g=f.ownerDocument)?g.defaultView||g.parentWindow:window,m?(y=r.relatedTarget||r.toElement,m=u,y=y?Pl(y):null,y!==null&&(S=uc(y),y!==S||y.tag!==5&&y.tag!==6)&&(y=null)):(m=null,y=u),m!==y)){if(x=Ky,M="onMouseLeave",A="onMouseEnter",C="mouse",(t==="pointerout"||t==="pointerover")&&(x=Xy,M="onPointerLeave",A="onPointerEnter",C="pointer"),S=m==null?g:Hc(m),E=y==null?g:Hc(y),g=new x(M,C+"leave",m,r,f),g.target=S,g.relatedTarget=E,M=null,Pl(f)===u&&(x=new x(A,C+"enter",y,r,f),x.target=E,x.relatedTarget=S,M=x),S=M,m&&y)t:{for(x=m,A=y,C=0,E=x;E;E=bc(E))C++;for(E=0,M=A;M;M=bc(M))E++;for(;0<C-E;)x=bc(x),C--;for(;0<E-C;)A=bc(A),E--;for(;C--;){if(x===A||A!==null&&x===A.alternate)break t;x=bc(x),A=bc(A)}x=null}else x=null;m!==null&&a2(p,g,m,x,!1),y!==null&&S!==null&&a2(p,S,y,x,!0)}}e:{if(g=u?Hc(u):window,m=g.nodeName&&g.nodeName.toLowerCase(),m==="select"||m==="input"&&g.type==="file")var X=DI;else if(Jy(g))if(pw)X=BI;else{X=OI;var z=PI}else(m=g.nodeName)&&m.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(X=MI);if(X&&(X=X(t,u))){hw(p,X,r,f);break e}z&&z(t,g,u),t==="focusout"&&(z=g._wrapperState)&&z.controlled&&g.type==="number"&&Cm(g,"number",g.value)}switch(z=u?Hc(u):window,t){case"focusin":(Jy(z)||z.contentEditable==="true")&&(zc=z,jm=u,Rd=null);break;case"focusout":Rd=jm=zc=null;break;case"mousedown":Lm=!0;break;case"contextmenu":case"mouseup":case"dragend":Lm=!1,n2(p,r,f);break;case"selectionchange":if(UI)break;case"keydown":case"keyup":n2(p,r,f)}var T;if(c1)e:{switch(t){case"compositionstart":var F="onCompositionStart";break e;case"compositionend":F="onCompositionEnd";break e;case"compositionupdate":F="onCompositionUpdate";break e}F=void 0}else Vc?dw(t,r)&&(F="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(F="onCompositionStart");F&&(uw&&r.locale!=="ko"&&(Vc||F!=="onCompositionStart"?F==="onCompositionEnd"&&Vc&&(T=cw()):(Ho=f,a1="value"in Ho?Ho.value:Ho.textContent,Vc=!0)),z=Rh(u,F),0<z.length&&(F=new Yy(F,t,null,r,f),p.push({event:F,listeners:z}),T?F.data=T:(T=fw(r),T!==null&&(F.data=T)))),(T=FI?bI(t,r):II(t,r))&&(u=Rh(u,"onBeforeInput"),0<u.length&&(f=new Yy("onBeforeInput","beforeinput",null,r,f),p.push({event:f,listeners:u}),f.data=T))}Tw(p,e)})}function af(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Rh(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Jd(t,r),s!=null&&n.unshift(af(t,s,i)),s=Jd(t,e),s!=null&&n.push(af(t,s,i))),t=t.return}return n}function bc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function a2(t,e,r,n,i){for(var s=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,i?(l=Jd(r,s),l!=null&&a.unshift(af(r,l,o))):i||(l=Jd(r,s),l!=null&&a.push(af(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var HI=/\r\n?/g,$I=/\u0000|\uFFFD/g;function o2(t){return(typeof t=="string"?t:""+t).replace(HI,`
`).replace($I,"")}function k0(t,e,r){if(e=o2(e),o2(t)!==e&&r)throw Error(Le(425))}function Dh(){}var Um=null,Vm=null;function zm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Wm=typeof setTimeout=="function"?setTimeout:void 0,GI=typeof clearTimeout=="function"?clearTimeout:void 0,l2=typeof Promise=="function"?Promise:void 0,KI=typeof queueMicrotask=="function"?queueMicrotask:typeof l2<"u"?function(t){return l2.resolve(null).then(t).catch(YI)}:Wm;function YI(t){setTimeout(function(){throw t})}function Rg(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),tf(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);tf(e)}function Zo(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function c2(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Pu=Math.random().toString(36).slice(2),Ta="__reactFiber$"+Pu,of="__reactProps$"+Pu,ro="__reactContainer$"+Pu,Hm="__reactEvents$"+Pu,XI="__reactListeners$"+Pu,qI="__reactHandles$"+Pu;function Pl(t){var e=t[Ta];if(e)return e;for(var r=t.parentNode;r;){if(e=r[ro]||r[Ta]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=c2(t);t!==null;){if(r=t[Ta])return r;t=c2(t)}return e}t=r,r=t.parentNode}return null}function Vf(t){return t=t[Ta]||t[ro],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Hc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Le(33))}function Ip(t){return t[of]||null}var $m=[],$c=-1;function yl(t){return{current:t}}function Ir(t){0>$c||(t.current=$m[$c],$m[$c]=null,$c--)}function wr(t,e){$c++,$m[$c]=t.current,t.current=e}var ul={},xi=yl(ul),Gi=yl(!1),Kl=ul;function pu(t,e){var r=t.type.contextTypes;if(!r)return ul;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Ki(t){return t=t.childContextTypes,t!=null}function Ph(){Ir(Gi),Ir(xi)}function u2(t,e,r){if(xi.current!==ul)throw Error(Le(168));wr(xi,e),wr(Gi,r)}function Cw(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(Le(108,Pb(t)||"Unknown",i));return Kr({},r,n)}function Oh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ul,Kl=xi.current,wr(xi,t),wr(Gi,Gi.current),!0}function d2(t,e,r){var n=t.stateNode;if(!n)throw Error(Le(169));r?(t=Cw(t,e,Kl),n.__reactInternalMemoizedMergedChildContext=t,Ir(Gi),Ir(xi),wr(xi,t)):Ir(Gi),wr(Gi,r)}var Wa=null,Np=!1,Dg=!1;function kw(t){Wa===null?Wa=[t]:Wa.push(t)}function QI(t){Np=!0,kw(t)}function _l(){if(!Dg&&Wa!==null){Dg=!0;var t=0,e=gr;try{var r=Wa;for(gr=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Wa=null,Np=!1}catch(i){throw Wa!==null&&(Wa=Wa.slice(t+1)),JS(r1,_l),i}finally{gr=e,Dg=!1}}return null}var Gc=[],Kc=0,Mh=null,Bh=0,Is=[],Ns=0,Yl=null,Ha=1,$a="";function bl(t,e){Gc[Kc++]=Bh,Gc[Kc++]=Mh,Mh=t,Bh=e}function Fw(t,e,r){Is[Ns++]=Ha,Is[Ns++]=$a,Is[Ns++]=Yl,Yl=t;var n=Ha;t=$a;var i=32-ea(n)-1;n&=~(1<<i),r+=1;var s=32-ea(e)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,Ha=1<<32-ea(e)+i|r<<i|n,$a=s+t}else Ha=1<<s|r<<i|n,$a=t}function d1(t){t.return!==null&&(bl(t,1),Fw(t,1,0))}function f1(t){for(;t===Mh;)Mh=Gc[--Kc],Gc[Kc]=null,Bh=Gc[--Kc],Gc[Kc]=null;for(;t===Yl;)Yl=Is[--Ns],Is[Ns]=null,$a=Is[--Ns],Is[Ns]=null,Ha=Is[--Ns],Is[Ns]=null}var us=null,cs=null,Br=!1,qs=null;function bw(t,e){var r=Ds(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function f2(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,us=t,cs=Zo(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,us=t,cs=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Yl!==null?{id:Ha,overflow:$a}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Ds(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,us=t,cs=null,!0):!1;default:return!1}}function Gm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Km(t){if(Br){var e=cs;if(e){var r=e;if(!f2(t,e)){if(Gm(t))throw Error(Le(418));e=Zo(r.nextSibling);var n=us;e&&f2(t,e)?bw(n,r):(t.flags=t.flags&-4097|2,Br=!1,us=t)}}else{if(Gm(t))throw Error(Le(418));t.flags=t.flags&-4097|2,Br=!1,us=t}}}function h2(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;us=t}function F0(t){if(t!==us)return!1;if(!Br)return h2(t),Br=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!zm(t.type,t.memoizedProps)),e&&(e=cs)){if(Gm(t))throw Iw(),Error(Le(418));for(;e;)bw(t,e),e=Zo(e.nextSibling)}if(h2(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Le(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){cs=Zo(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}cs=null}}else cs=us?Zo(t.stateNode.nextSibling):null;return!0}function Iw(){for(var t=cs;t;)t=Zo(t.nextSibling)}function gu(){cs=us=null,Br=!1}function h1(t){qs===null?qs=[t]:qs.push(t)}var JI=fo.ReactCurrentBatchConfig;function ld(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Le(309));var n=r.stateNode}if(!n)throw Error(Le(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(Le(284));if(!r._owner)throw Error(Le(290,t))}return t}function b0(t,e){throw t=Object.prototype.toString.call(e),Error(Le(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function p2(t){var e=t._init;return e(t._payload)}function Nw(t){function e(A,C){if(t){var E=A.deletions;E===null?(A.deletions=[C],A.flags|=16):E.push(C)}}function r(A,C){if(!t)return null;for(;C!==null;)e(A,C),C=C.sibling;return null}function n(A,C){for(A=new Map;C!==null;)C.key!==null?A.set(C.key,C):A.set(C.index,C),C=C.sibling;return A}function i(A,C){return A=nl(A,C),A.index=0,A.sibling=null,A}function s(A,C,E){return A.index=E,t?(E=A.alternate,E!==null?(E=E.index,E<C?(A.flags|=2,C):E):(A.flags|=2,C)):(A.flags|=1048576,C)}function a(A){return t&&A.alternate===null&&(A.flags|=2),A}function o(A,C,E,M){return C===null||C.tag!==6?(C=Ug(E,A.mode,M),C.return=A,C):(C=i(C,E),C.return=A,C)}function l(A,C,E,M){var X=E.type;return X===Uc?f(A,C,E.props.children,M,E.key):C!==null&&(C.elementType===X||typeof X=="object"&&X!==null&&X.$$typeof===Mo&&p2(X)===C.type)?(M=i(C,E.props),M.ref=ld(A,C,E),M.return=A,M):(M=gh(E.type,E.key,E.props,null,A.mode,M),M.ref=ld(A,C,E),M.return=A,M)}function u(A,C,E,M){return C===null||C.tag!==4||C.stateNode.containerInfo!==E.containerInfo||C.stateNode.implementation!==E.implementation?(C=Vg(E,A.mode,M),C.return=A,C):(C=i(C,E.children||[]),C.return=A,C)}function f(A,C,E,M,X){return C===null||C.tag!==7?(C=Ul(E,A.mode,M,X),C.return=A,C):(C=i(C,E),C.return=A,C)}function p(A,C,E){if(typeof C=="string"&&C!==""||typeof C=="number")return C=Ug(""+C,A.mode,E),C.return=A,C;if(typeof C=="object"&&C!==null){switch(C.$$typeof){case v0:return E=gh(C.type,C.key,C.props,null,A.mode,E),E.ref=ld(A,null,C),E.return=A,E;case Lc:return C=Vg(C,A.mode,E),C.return=A,C;case Mo:var M=C._init;return p(A,M(C._payload),E)}if(vd(C)||nd(C))return C=Ul(C,A.mode,E,null),C.return=A,C;b0(A,C)}return null}function g(A,C,E,M){var X=C!==null?C.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return X!==null?null:o(A,C,""+E,M);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case v0:return E.key===X?l(A,C,E,M):null;case Lc:return E.key===X?u(A,C,E,M):null;case Mo:return X=E._init,g(A,C,X(E._payload),M)}if(vd(E)||nd(E))return X!==null?null:f(A,C,E,M,null);b0(A,E)}return null}function m(A,C,E,M,X){if(typeof M=="string"&&M!==""||typeof M=="number")return A=A.get(E)||null,o(C,A,""+M,X);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case v0:return A=A.get(M.key===null?E:M.key)||null,l(C,A,M,X);case Lc:return A=A.get(M.key===null?E:M.key)||null,u(C,A,M,X);case Mo:var z=M._init;return m(A,C,E,z(M._payload),X)}if(vd(M)||nd(M))return A=A.get(E)||null,f(C,A,M,X,null);b0(C,M)}return null}function y(A,C,E,M){for(var X=null,z=null,T=C,F=C=0,w=null;T!==null&&F<E.length;F++){T.index>F?(w=T,T=null):w=T.sibling;var R=g(A,T,E[F],M);if(R===null){T===null&&(T=w);break}t&&T&&R.alternate===null&&e(A,T),C=s(R,C,F),z===null?X=R:z.sibling=R,z=R,T=w}if(F===E.length)return r(A,T),Br&&bl(A,F),X;if(T===null){for(;F<E.length;F++)T=p(A,E[F],M),T!==null&&(C=s(T,C,F),z===null?X=T:z.sibling=T,z=T);return Br&&bl(A,F),X}for(T=n(A,T);F<E.length;F++)w=m(T,A,F,E[F],M),w!==null&&(t&&w.alternate!==null&&T.delete(w.key===null?F:w.key),C=s(w,C,F),z===null?X=w:z.sibling=w,z=w);return t&&T.forEach(function(P){return e(A,P)}),Br&&bl(A,F),X}function x(A,C,E,M){var X=nd(E);if(typeof X!="function")throw Error(Le(150));if(E=X.call(E),E==null)throw Error(Le(151));for(var z=X=null,T=C,F=C=0,w=null,R=E.next();T!==null&&!R.done;F++,R=E.next()){T.index>F?(w=T,T=null):w=T.sibling;var P=g(A,T,R.value,M);if(P===null){T===null&&(T=w);break}t&&T&&P.alternate===null&&e(A,T),C=s(P,C,F),z===null?X=P:z.sibling=P,z=P,T=w}if(R.done)return r(A,T),Br&&bl(A,F),X;if(T===null){for(;!R.done;F++,R=E.next())R=p(A,R.value,M),R!==null&&(C=s(R,C,F),z===null?X=R:z.sibling=R,z=R);return Br&&bl(A,F),X}for(T=n(A,T);!R.done;F++,R=E.next())R=m(T,A,F,R.value,M),R!==null&&(t&&R.alternate!==null&&T.delete(R.key===null?F:R.key),C=s(R,C,F),z===null?X=R:z.sibling=R,z=R);return t&&T.forEach(function(O){return e(A,O)}),Br&&bl(A,F),X}function S(A,C,E,M){if(typeof E=="object"&&E!==null&&E.type===Uc&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case v0:e:{for(var X=E.key,z=C;z!==null;){if(z.key===X){if(X=E.type,X===Uc){if(z.tag===7){r(A,z.sibling),C=i(z,E.props.children),C.return=A,A=C;break e}}else if(z.elementType===X||typeof X=="object"&&X!==null&&X.$$typeof===Mo&&p2(X)===z.type){r(A,z.sibling),C=i(z,E.props),C.ref=ld(A,z,E),C.return=A,A=C;break e}r(A,z);break}else e(A,z);z=z.sibling}E.type===Uc?(C=Ul(E.props.children,A.mode,M,E.key),C.return=A,A=C):(M=gh(E.type,E.key,E.props,null,A.mode,M),M.ref=ld(A,C,E),M.return=A,A=M)}return a(A);case Lc:e:{for(z=E.key;C!==null;){if(C.key===z)if(C.tag===4&&C.stateNode.containerInfo===E.containerInfo&&C.stateNode.implementation===E.implementation){r(A,C.sibling),C=i(C,E.children||[]),C.return=A,A=C;break e}else{r(A,C);break}else e(A,C);C=C.sibling}C=Vg(E,A.mode,M),C.return=A,A=C}return a(A);case Mo:return z=E._init,S(A,C,z(E._payload),M)}if(vd(E))return y(A,C,E,M);if(nd(E))return x(A,C,E,M);b0(A,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,C!==null&&C.tag===6?(r(A,C.sibling),C=i(C,E),C.return=A,A=C):(r(A,C),C=Ug(E,A.mode,M),C.return=A,A=C),a(A)):r(A,C)}return S}var mu=Nw(!0),Rw=Nw(!1),jh=yl(null),Lh=null,Yc=null,p1=null;function g1(){p1=Yc=Lh=null}function m1(t){var e=jh.current;Ir(jh),t._currentValue=e}function Ym(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function nu(t,e){Lh=t,p1=Yc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&($i=!0),t.firstContext=null)}function Ms(t){var e=t._currentValue;if(p1!==t)if(t={context:t,memoizedValue:e,next:null},Yc===null){if(Lh===null)throw Error(Le(308));Yc=t,Lh.dependencies={lanes:0,firstContext:t}}else Yc=Yc.next=t;return e}var Ol=null;function x1(t){Ol===null?Ol=[t]:Ol.push(t)}function Dw(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,x1(e)):(r.next=i.next,i.next=r),e.interleaved=r,no(t,n)}function no(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Bo=!1;function v1(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Pw(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function qa(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function el(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Zt&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,no(t,r)}return i=n.interleaved,i===null?(e.next=e,x1(n)):(e.next=i.next,i.next=e),n.interleaved=e,no(t,r)}function ch(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,n1(t,r)}}function g2(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Uh(t,e,r,n){var i=t.updateQueue;Bo=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?s=u:a.next=u,a=l;var f=t.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==a&&(o===null?f.firstBaseUpdate=u:o.next=u,f.lastBaseUpdate=l))}if(s!==null){var p=i.baseState;a=0,f=u=l=null,o=s;do{var g=o.lane,m=o.eventTime;if((n&g)===g){f!==null&&(f=f.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=t,x=o;switch(g=e,m=r,x.tag){case 1:if(y=x.payload,typeof y=="function"){p=y.call(m,p,g);break e}p=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=x.payload,g=typeof y=="function"?y.call(m,p,g):y,g==null)break e;p=Kr({},p,g);break e;case 2:Bo=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,g=i.effects,g===null?i.effects=[o]:g.push(o))}else m={eventTime:m,lane:g,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(u=f=m,l=p):f=f.next=m,a|=g;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;g=o,o=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(f===null&&(l=p),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);ql|=a,t.lanes=a,t.memoizedState=p}}function m2(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Le(191,i));i.call(n)}}}var zf={},ka=yl(zf),lf=yl(zf),cf=yl(zf);function Ml(t){if(t===zf)throw Error(Le(174));return t}function y1(t,e){switch(wr(cf,e),wr(lf,t),wr(ka,zf),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Fm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Fm(e,t)}Ir(ka),wr(ka,e)}function xu(){Ir(ka),Ir(lf),Ir(cf)}function Ow(t){Ml(cf.current);var e=Ml(ka.current),r=Fm(e,t.type);e!==r&&(wr(lf,t),wr(ka,r))}function _1(t){lf.current===t&&(Ir(ka),Ir(lf))}var Wr=yl(0);function Vh(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Pg=[];function E1(){for(var t=0;t<Pg.length;t++)Pg[t]._workInProgressVersionPrimary=null;Pg.length=0}var uh=fo.ReactCurrentDispatcher,Og=fo.ReactCurrentBatchConfig,Xl=0,Gr=null,Cn=null,Un=null,zh=!1,Dd=!1,uf=0,ZI=0;function si(){throw Error(Le(321))}function S1(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!ia(t[r],e[r]))return!1;return!0}function w1(t,e,r,n,i,s){if(Xl=s,Gr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,uh.current=t===null||t.memoizedState===null?nN:iN,t=r(n,i),Dd){s=0;do{if(Dd=!1,uf=0,25<=s)throw Error(Le(301));s+=1,Un=Cn=null,e.updateQueue=null,uh.current=sN,t=r(n,i)}while(Dd)}if(uh.current=Wh,e=Cn!==null&&Cn.next!==null,Xl=0,Un=Cn=Gr=null,zh=!1,e)throw Error(Le(300));return t}function T1(){var t=uf!==0;return uf=0,t}function wa(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Un===null?Gr.memoizedState=Un=t:Un=Un.next=t,Un}function Bs(){if(Cn===null){var t=Gr.alternate;t=t!==null?t.memoizedState:null}else t=Cn.next;var e=Un===null?Gr.memoizedState:Un.next;if(e!==null)Un=e,Cn=t;else{if(t===null)throw Error(Le(310));Cn=t,t={memoizedState:Cn.memoizedState,baseState:Cn.baseState,baseQueue:Cn.baseQueue,queue:Cn.queue,next:null},Un===null?Gr.memoizedState=Un=t:Un=Un.next=t}return Un}function df(t,e){return typeof e=="function"?e(t):e}function Mg(t){var e=Bs(),r=e.queue;if(r===null)throw Error(Le(311));r.lastRenderedReducer=t;var n=Cn,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,u=s;do{var f=u.lane;if((Xl&f)===f)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var p={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=p,a=n):l=l.next=p,Gr.lanes|=f,ql|=f}u=u.next}while(u!==null&&u!==s);l===null?a=n:l.next=o,ia(n,e.memoizedState)||($i=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,Gr.lanes|=s,ql|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Bg(t){var e=Bs(),r=e.queue;if(r===null)throw Error(Le(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);ia(s,e.memoizedState)||($i=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function Mw(){}function Bw(t,e){var r=Gr,n=Bs(),i=e(),s=!ia(n.memoizedState,i);if(s&&(n.memoizedState=i,$i=!0),n=n.queue,A1(Uw.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||Un!==null&&Un.memoizedState.tag&1){if(r.flags|=2048,ff(9,Lw.bind(null,r,n,i,e),void 0,null),Wn===null)throw Error(Le(349));Xl&30||jw(r,e,i)}return i}function jw(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Gr.updateQueue,e===null?(e={lastEffect:null,stores:null},Gr.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function Lw(t,e,r,n){e.value=r,e.getSnapshot=n,Vw(e)&&zw(t)}function Uw(t,e,r){return r(function(){Vw(e)&&zw(t)})}function Vw(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!ia(t,r)}catch{return!0}}function zw(t){var e=no(t,1);e!==null&&ta(e,t,1,-1)}function x2(t){var e=wa();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:df,lastRenderedState:t},e.queue=t,t=t.dispatch=rN.bind(null,Gr,t),[e.memoizedState,t]}function ff(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Gr.updateQueue,e===null?(e={lastEffect:null,stores:null},Gr.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function Ww(){return Bs().memoizedState}function dh(t,e,r,n){var i=wa();Gr.flags|=t,i.memoizedState=ff(1|e,r,void 0,n===void 0?null:n)}function Rp(t,e,r,n){var i=Bs();n=n===void 0?null:n;var s=void 0;if(Cn!==null){var a=Cn.memoizedState;if(s=a.destroy,n!==null&&S1(n,a.deps)){i.memoizedState=ff(e,r,s,n);return}}Gr.flags|=t,i.memoizedState=ff(1|e,r,s,n)}function v2(t,e){return dh(8390656,8,t,e)}function A1(t,e){return Rp(2048,8,t,e)}function Hw(t,e){return Rp(4,2,t,e)}function $w(t,e){return Rp(4,4,t,e)}function Gw(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Kw(t,e,r){return r=r!=null?r.concat([t]):null,Rp(4,4,Gw.bind(null,e,t),r)}function C1(){}function Yw(t,e){var r=Bs();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&S1(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function Xw(t,e){var r=Bs();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&S1(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function qw(t,e,r){return Xl&21?(ia(r,e)||(r=tw(),Gr.lanes|=r,ql|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,$i=!0),t.memoizedState=r)}function eN(t,e){var r=gr;gr=r!==0&&4>r?r:4,t(!0);var n=Og.transition;Og.transition={};try{t(!1),e()}finally{gr=r,Og.transition=n}}function Qw(){return Bs().memoizedState}function tN(t,e,r){var n=rl(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Jw(t))Zw(e,r);else if(r=Dw(t,e,r,n),r!==null){var i=Ii();ta(r,t,n,i),eT(r,e,n)}}function rN(t,e,r){var n=rl(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Jw(t))Zw(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,ia(o,a)){var l=e.interleaved;l===null?(i.next=i,x1(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=Dw(t,e,i,n),r!==null&&(i=Ii(),ta(r,t,n,i),eT(r,e,n))}}function Jw(t){var e=t.alternate;return t===Gr||e!==null&&e===Gr}function Zw(t,e){Dd=zh=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function eT(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,n1(t,r)}}var Wh={readContext:Ms,useCallback:si,useContext:si,useEffect:si,useImperativeHandle:si,useInsertionEffect:si,useLayoutEffect:si,useMemo:si,useReducer:si,useRef:si,useState:si,useDebugValue:si,useDeferredValue:si,useTransition:si,useMutableSource:si,useSyncExternalStore:si,useId:si,unstable_isNewReconciler:!1},nN={readContext:Ms,useCallback:function(t,e){return wa().memoizedState=[t,e===void 0?null:e],t},useContext:Ms,useEffect:v2,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,dh(4194308,4,Gw.bind(null,e,t),r)},useLayoutEffect:function(t,e){return dh(4194308,4,t,e)},useInsertionEffect:function(t,e){return dh(4,2,t,e)},useMemo:function(t,e){var r=wa();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=wa();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=tN.bind(null,Gr,t),[n.memoizedState,t]},useRef:function(t){var e=wa();return t={current:t},e.memoizedState=t},useState:x2,useDebugValue:C1,useDeferredValue:function(t){return wa().memoizedState=t},useTransition:function(){var t=x2(!1),e=t[0];return t=eN.bind(null,t[1]),wa().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Gr,i=wa();if(Br){if(r===void 0)throw Error(Le(407));r=r()}else{if(r=e(),Wn===null)throw Error(Le(349));Xl&30||jw(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,v2(Uw.bind(null,n,s,t),[t]),n.flags|=2048,ff(9,Lw.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=wa(),e=Wn.identifierPrefix;if(Br){var r=$a,n=Ha;r=(n&~(1<<32-ea(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=uf++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=ZI++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},iN={readContext:Ms,useCallback:Yw,useContext:Ms,useEffect:A1,useImperativeHandle:Kw,useInsertionEffect:Hw,useLayoutEffect:$w,useMemo:Xw,useReducer:Mg,useRef:Ww,useState:function(){return Mg(df)},useDebugValue:C1,useDeferredValue:function(t){var e=Bs();return qw(e,Cn.memoizedState,t)},useTransition:function(){var t=Mg(df)[0],e=Bs().memoizedState;return[t,e]},useMutableSource:Mw,useSyncExternalStore:Bw,useId:Qw,unstable_isNewReconciler:!1},sN={readContext:Ms,useCallback:Yw,useContext:Ms,useEffect:A1,useImperativeHandle:Kw,useInsertionEffect:Hw,useLayoutEffect:$w,useMemo:Xw,useReducer:Bg,useRef:Ww,useState:function(){return Bg(df)},useDebugValue:C1,useDeferredValue:function(t){var e=Bs();return Cn===null?e.memoizedState=t:qw(e,Cn.memoizedState,t)},useTransition:function(){var t=Bg(df)[0],e=Bs().memoizedState;return[t,e]},useMutableSource:Mw,useSyncExternalStore:Bw,useId:Qw,unstable_isNewReconciler:!1};function Ys(t,e){if(t&&t.defaultProps){e=Kr({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Xm(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Kr({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Dp={isMounted:function(t){return(t=t._reactInternals)?uc(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Ii(),i=rl(t),s=qa(n,i);s.payload=e,r!=null&&(s.callback=r),e=el(t,s,i),e!==null&&(ta(e,t,i,n),ch(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Ii(),i=rl(t),s=qa(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=el(t,s,i),e!==null&&(ta(e,t,i,n),ch(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Ii(),n=rl(t),i=qa(r,n);i.tag=2,e!=null&&(i.callback=e),e=el(t,i,n),e!==null&&(ta(e,t,n,r),ch(e,t,n))}};function y2(t,e,r,n,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,a):e.prototype&&e.prototype.isPureReactComponent?!nf(r,n)||!nf(i,s):!0}function tT(t,e,r){var n=!1,i=ul,s=e.contextType;return typeof s=="object"&&s!==null?s=Ms(s):(i=Ki(e)?Kl:xi.current,n=e.contextTypes,s=(n=n!=null)?pu(t,i):ul),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Dp,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function _2(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Dp.enqueueReplaceState(e,e.state,null)}function qm(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},v1(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Ms(s):(s=Ki(e)?Kl:xi.current,i.context=pu(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Xm(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Dp.enqueueReplaceState(i,i.state,null),Uh(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function vu(t,e){try{var r="",n=e;do r+=Db(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function jg(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Qm(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var aN=typeof WeakMap=="function"?WeakMap:Map;function rT(t,e,r){r=qa(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){$h||($h=!0,ox=n),Qm(t,e)},r}function nT(t,e,r){r=qa(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){Qm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Qm(t,e),typeof n!="function"&&(tl===null?tl=new Set([this]):tl.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function E2(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new aN;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=_N.bind(null,t,e,r),e.then(t,t))}function S2(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function w2(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=qa(-1,1),e.tag=2,el(r,e,1))),r.lanes|=1),t)}var oN=fo.ReactCurrentOwner,$i=!1;function ki(t,e,r,n){e.child=t===null?Rw(e,null,r,n):mu(e,t.child,r,n)}function T2(t,e,r,n,i){r=r.render;var s=e.ref;return nu(e,i),n=w1(t,e,r,n,s,i),r=T1(),t!==null&&!$i?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,io(t,e,i)):(Br&&r&&d1(e),e.flags|=1,ki(t,e,n,i),e.child)}function A2(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!P1(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,iT(t,e,s,n,i)):(t=gh(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:nf,r(a,n)&&t.ref===e.ref)return io(t,e,i)}return e.flags|=1,t=nl(s,n),t.ref=e.ref,t.return=e,e.child=t}function iT(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(nf(s,n)&&t.ref===e.ref)if($i=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&($i=!0);else return e.lanes=t.lanes,io(t,e,i)}return Jm(t,e,r,n,i)}function sT(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},wr(qc,is),is|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,wr(qc,is),is|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,wr(qc,is),is|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,wr(qc,is),is|=n;return ki(t,e,i,r),e.child}function aT(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Jm(t,e,r,n,i){var s=Ki(r)?Kl:xi.current;return s=pu(e,s),nu(e,i),r=w1(t,e,r,n,s,i),n=T1(),t!==null&&!$i?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,io(t,e,i)):(Br&&n&&d1(e),e.flags|=1,ki(t,e,r,i),e.child)}function C2(t,e,r,n,i){if(Ki(r)){var s=!0;Oh(e)}else s=!1;if(nu(e,i),e.stateNode===null)fh(t,e),tT(e,r,n),qm(e,r,n,i),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,u=r.contextType;typeof u=="object"&&u!==null?u=Ms(u):(u=Ki(r)?Kl:xi.current,u=pu(e,u));var f=r.getDerivedStateFromProps,p=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";p||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==u)&&_2(e,a,n,u),Bo=!1;var g=e.memoizedState;a.state=g,Uh(e,n,a,i),l=e.memoizedState,o!==n||g!==l||Gi.current||Bo?(typeof f=="function"&&(Xm(e,r,f,n),l=e.memoizedState),(o=Bo||y2(e,r,o,n,g,l,u))?(p||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=u,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,Pw(t,e),o=e.memoizedProps,u=e.type===e.elementType?o:Ys(e.type,o),a.props=u,p=e.pendingProps,g=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=Ms(l):(l=Ki(r)?Kl:xi.current,l=pu(e,l));var m=r.getDerivedStateFromProps;(f=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==p||g!==l)&&_2(e,a,n,l),Bo=!1,g=e.memoizedState,a.state=g,Uh(e,n,a,i);var y=e.memoizedState;o!==p||g!==y||Gi.current||Bo?(typeof m=="function"&&(Xm(e,r,m,n),y=e.memoizedState),(u=Bo||y2(e,r,u,n,g,y,l)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,y,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,y,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=y),a.props=n,a.state=y,a.context=l,n=u):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),n=!1)}return Zm(t,e,r,n,s,i)}function Zm(t,e,r,n,i,s){aT(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return i&&d2(e,r,!1),io(t,e,s);n=e.stateNode,oN.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=mu(e,t.child,null,s),e.child=mu(e,null,o,s)):ki(t,e,o,s),e.memoizedState=n.state,i&&d2(e,r,!0),e.child}function oT(t){var e=t.stateNode;e.pendingContext?u2(t,e.pendingContext,e.pendingContext!==e.context):e.context&&u2(t,e.context,!1),y1(t,e.containerInfo)}function k2(t,e,r,n,i){return gu(),h1(i),e.flags|=256,ki(t,e,r,n),e.child}var ex={dehydrated:null,treeContext:null,retryLane:0};function tx(t){return{baseLanes:t,cachePool:null,transitions:null}}function lT(t,e,r){var n=e.pendingProps,i=Wr.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),wr(Wr,i&1),t===null)return Km(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,s?(n=e.mode,s=e.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=Mp(a,n,0,null),t=Ul(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=tx(r),e.memoizedState=ex,t):k1(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return lN(t,e,a,n,o,i,r);if(s){s=n.fallback,a=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=nl(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=nl(o,s):(s=Ul(s,a,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,a=t.child.memoizedState,a=a===null?tx(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~r,e.memoizedState=ex,n}return s=t.child,t=s.sibling,n=nl(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function k1(t,e){return e=Mp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function I0(t,e,r,n){return n!==null&&h1(n),mu(e,t.child,null,r),t=k1(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function lN(t,e,r,n,i,s,a){if(r)return e.flags&256?(e.flags&=-257,n=jg(Error(Le(422))),I0(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=Mp({mode:"visible",children:n.children},i,0,null),s=Ul(s,i,a,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&mu(e,t.child,null,a),e.child.memoizedState=tx(a),e.memoizedState=ex,s);if(!(e.mode&1))return I0(t,e,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(Le(419)),n=jg(s,n,void 0),I0(t,e,a,n)}if(o=(a&t.childLanes)!==0,$i||o){if(n=Wn,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,no(t,i),ta(n,t,i,-1))}return D1(),n=jg(Error(Le(421))),I0(t,e,a,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=EN.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,cs=Zo(i.nextSibling),us=e,Br=!0,qs=null,t!==null&&(Is[Ns++]=Ha,Is[Ns++]=$a,Is[Ns++]=Yl,Ha=t.id,$a=t.overflow,Yl=e),e=k1(e,n.children),e.flags|=4096,e)}function F2(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Ym(t.return,e,r)}function Lg(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function cT(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(ki(t,e,n.children,r),n=Wr.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&F2(t,r,e);else if(t.tag===19)F2(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(wr(Wr,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&Vh(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),Lg(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Vh(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}Lg(e,!0,r,null,s);break;case"together":Lg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function fh(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function io(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),ql|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Le(153));if(e.child!==null){for(t=e.child,r=nl(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=nl(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function cN(t,e,r){switch(e.tag){case 3:oT(e),gu();break;case 5:Ow(e);break;case 1:Ki(e.type)&&Oh(e);break;case 4:y1(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;wr(jh,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(wr(Wr,Wr.current&1),e.flags|=128,null):r&e.child.childLanes?lT(t,e,r):(wr(Wr,Wr.current&1),t=io(t,e,r),t!==null?t.sibling:null);wr(Wr,Wr.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return cT(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),wr(Wr,Wr.current),n)break;return null;case 22:case 23:return e.lanes=0,sT(t,e,r)}return io(t,e,r)}var uT,rx,dT,fT;uT=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};rx=function(){};dT=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,Ml(ka.current);var s=null;switch(r){case"input":i=Tm(t,i),n=Tm(t,n),s=[];break;case"select":i=Kr({},i,{value:void 0}),n=Kr({},n,{value:void 0}),s=[];break;case"textarea":i=km(t,i),n=km(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Dh)}bm(r,n);var a;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(qd.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var l=n[u];if(o=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(qd.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Fr("scroll",t),s||o===l||(s=[])):(s=s||[]).push(u,l))}r&&(s=s||[]).push("style",r);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};fT=function(t,e,r,n){r!==n&&(e.flags|=4)};function cd(t,e){if(!Br)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function ai(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function uN(t,e,r){var n=e.pendingProps;switch(f1(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ai(e),null;case 1:return Ki(e.type)&&Ph(),ai(e),null;case 3:return n=e.stateNode,xu(),Ir(Gi),Ir(xi),E1(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(F0(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,qs!==null&&(ux(qs),qs=null))),rx(t,e),ai(e),null;case 5:_1(e);var i=Ml(cf.current);if(r=e.type,t!==null&&e.stateNode!=null)dT(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Le(166));return ai(e),null}if(t=Ml(ka.current),F0(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[Ta]=e,n[of]=s,t=(e.mode&1)!==0,r){case"dialog":Fr("cancel",n),Fr("close",n);break;case"iframe":case"object":case"embed":Fr("load",n);break;case"video":case"audio":for(i=0;i<_d.length;i++)Fr(_d[i],n);break;case"source":Fr("error",n);break;case"img":case"image":case"link":Fr("error",n),Fr("load",n);break;case"details":Fr("toggle",n);break;case"input":By(n,s),Fr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Fr("invalid",n);break;case"textarea":Ly(n,s),Fr("invalid",n)}bm(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&k0(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&k0(n.textContent,o,t),i=["children",""+o]):qd.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Fr("scroll",n)}switch(r){case"input":y0(n),jy(n,s,!0);break;case"textarea":y0(n),Uy(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Dh)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=US(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[Ta]=e,t[of]=n,uT(t,e,!1,!1),e.stateNode=t;e:{switch(a=Im(r,n),r){case"dialog":Fr("cancel",t),Fr("close",t),i=n;break;case"iframe":case"object":case"embed":Fr("load",t),i=n;break;case"video":case"audio":for(i=0;i<_d.length;i++)Fr(_d[i],t);i=n;break;case"source":Fr("error",t),i=n;break;case"img":case"image":case"link":Fr("error",t),Fr("load",t),i=n;break;case"details":Fr("toggle",t),i=n;break;case"input":By(t,n),i=Tm(t,n),Fr("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=Kr({},n,{value:void 0}),Fr("invalid",t);break;case"textarea":Ly(t,n),i=km(t,n),Fr("invalid",t);break;default:i=n}bm(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?WS(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&VS(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Qd(t,l):typeof l=="number"&&Qd(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(qd.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Fr("scroll",t):l!=null&&Qx(t,s,l,a))}switch(r){case"input":y0(t),jy(t,n,!1);break;case"textarea":y0(t),Uy(t);break;case"option":n.value!=null&&t.setAttribute("value",""+cl(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?Zc(t,!!n.multiple,s,!1):n.defaultValue!=null&&Zc(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Dh)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ai(e),null;case 6:if(t&&e.stateNode!=null)fT(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Le(166));if(r=Ml(cf.current),Ml(ka.current),F0(e)){if(n=e.stateNode,r=e.memoizedProps,n[Ta]=e,(s=n.nodeValue!==r)&&(t=us,t!==null))switch(t.tag){case 3:k0(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&k0(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ta]=e,e.stateNode=n}return ai(e),null;case 13:if(Ir(Wr),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Br&&cs!==null&&e.mode&1&&!(e.flags&128))Iw(),gu(),e.flags|=98560,s=!1;else if(s=F0(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(Le(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Le(317));s[Ta]=e}else gu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ai(e),s=!1}else qs!==null&&(ux(qs),qs=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Wr.current&1?bn===0&&(bn=3):D1())),e.updateQueue!==null&&(e.flags|=4),ai(e),null);case 4:return xu(),rx(t,e),t===null&&sf(e.stateNode.containerInfo),ai(e),null;case 10:return m1(e.type._context),ai(e),null;case 17:return Ki(e.type)&&Ph(),ai(e),null;case 19:if(Ir(Wr),s=e.memoizedState,s===null)return ai(e),null;if(n=(e.flags&128)!==0,a=s.rendering,a===null)if(n)cd(s,!1);else{if(bn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Vh(t),a!==null){for(e.flags|=128,cd(s,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return wr(Wr,Wr.current&1|2),e.child}t=t.sibling}s.tail!==null&&cn()>yu&&(e.flags|=128,n=!0,cd(s,!1),e.lanes=4194304)}else{if(!n)if(t=Vh(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),cd(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Br)return ai(e),null}else 2*cn()-s.renderingStartTime>yu&&r!==1073741824&&(e.flags|=128,n=!0,cd(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(r=s.last,r!==null?r.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=cn(),e.sibling=null,r=Wr.current,wr(Wr,n?r&1|2:r&1),e):(ai(e),null);case 22:case 23:return R1(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?is&1073741824&&(ai(e),e.subtreeFlags&6&&(e.flags|=8192)):ai(e),null;case 24:return null;case 25:return null}throw Error(Le(156,e.tag))}function dN(t,e){switch(f1(e),e.tag){case 1:return Ki(e.type)&&Ph(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return xu(),Ir(Gi),Ir(xi),E1(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return _1(e),null;case 13:if(Ir(Wr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Le(340));gu()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ir(Wr),null;case 4:return xu(),null;case 10:return m1(e.type._context),null;case 22:case 23:return R1(),null;case 24:return null;default:return null}}var N0=!1,fi=!1,fN=typeof WeakSet=="function"?WeakSet:Set,Ze=null;function Xc(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){qr(t,e,n)}else r.current=null}function nx(t,e,r){try{r()}catch(n){qr(t,e,n)}}var b2=!1;function hN(t,e){if(Um=Ih,t=xw(),u1(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,u=0,f=0,p=t,g=null;t:for(;;){for(var m;p!==r||i!==0&&p.nodeType!==3||(o=a+i),p!==s||n!==0&&p.nodeType!==3||(l=a+n),p.nodeType===3&&(a+=p.nodeValue.length),(m=p.firstChild)!==null;)g=p,p=m;for(;;){if(p===t)break t;if(g===r&&++u===i&&(o=a),g===s&&++f===n&&(l=a),(m=p.nextSibling)!==null)break;p=g,g=p.parentNode}p=m}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Vm={focusedElem:t,selectionRange:r},Ih=!1,Ze=e;Ze!==null;)if(e=Ze,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ze=t;else for(;Ze!==null;){e=Ze;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var x=y.memoizedProps,S=y.memoizedState,A=e.stateNode,C=A.getSnapshotBeforeUpdate(e.elementType===e.type?x:Ys(e.type,x),S);A.__reactInternalSnapshotBeforeUpdate=C}break;case 3:var E=e.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Le(163))}}catch(M){qr(e,e.return,M)}if(t=e.sibling,t!==null){t.return=e.return,Ze=t;break}Ze=e.return}return y=b2,b2=!1,y}function Pd(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&nx(e,r,s)}i=i.next}while(i!==n)}}function Pp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function ix(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function hT(t){var e=t.alternate;e!==null&&(t.alternate=null,hT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ta],delete e[of],delete e[Hm],delete e[XI],delete e[qI])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function pT(t){return t.tag===5||t.tag===3||t.tag===4}function I2(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||pT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function sx(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Dh));else if(n!==4&&(t=t.child,t!==null))for(sx(t,e,r),t=t.sibling;t!==null;)sx(t,e,r),t=t.sibling}function ax(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(ax(t,e,r),t=t.sibling;t!==null;)ax(t,e,r),t=t.sibling}var Yn=null,Xs=!1;function No(t,e,r){for(r=r.child;r!==null;)gT(t,e,r),r=r.sibling}function gT(t,e,r){if(Ca&&typeof Ca.onCommitFiberUnmount=="function")try{Ca.onCommitFiberUnmount(Cp,r)}catch{}switch(r.tag){case 5:fi||Xc(r,e);case 6:var n=Yn,i=Xs;Yn=null,No(t,e,r),Yn=n,Xs=i,Yn!==null&&(Xs?(t=Yn,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Yn.removeChild(r.stateNode));break;case 18:Yn!==null&&(Xs?(t=Yn,r=r.stateNode,t.nodeType===8?Rg(t.parentNode,r):t.nodeType===1&&Rg(t,r),tf(t)):Rg(Yn,r.stateNode));break;case 4:n=Yn,i=Xs,Yn=r.stateNode.containerInfo,Xs=!0,No(t,e,r),Yn=n,Xs=i;break;case 0:case 11:case 14:case 15:if(!fi&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&nx(r,e,a),i=i.next}while(i!==n)}No(t,e,r);break;case 1:if(!fi&&(Xc(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){qr(r,e,o)}No(t,e,r);break;case 21:No(t,e,r);break;case 22:r.mode&1?(fi=(n=fi)||r.memoizedState!==null,No(t,e,r),fi=n):No(t,e,r);break;default:No(t,e,r)}}function N2(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new fN),e.forEach(function(n){var i=SN.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function $s(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:Yn=o.stateNode,Xs=!1;break e;case 3:Yn=o.stateNode.containerInfo,Xs=!0;break e;case 4:Yn=o.stateNode.containerInfo,Xs=!0;break e}o=o.return}if(Yn===null)throw Error(Le(160));gT(s,a,i),Yn=null,Xs=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){qr(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)mT(e,t),e=e.sibling}function mT(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if($s(e,t),va(t),n&4){try{Pd(3,t,t.return),Pp(3,t)}catch(x){qr(t,t.return,x)}try{Pd(5,t,t.return)}catch(x){qr(t,t.return,x)}}break;case 1:$s(e,t),va(t),n&512&&r!==null&&Xc(r,r.return);break;case 5:if($s(e,t),va(t),n&512&&r!==null&&Xc(r,r.return),t.flags&32){var i=t.stateNode;try{Qd(i,"")}catch(x){qr(t,t.return,x)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=r!==null?r.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&jS(i,s),Im(o,a);var u=Im(o,s);for(a=0;a<l.length;a+=2){var f=l[a],p=l[a+1];f==="style"?WS(i,p):f==="dangerouslySetInnerHTML"?VS(i,p):f==="children"?Qd(i,p):Qx(i,f,p,u)}switch(o){case"input":Am(i,s);break;case"textarea":LS(i,s);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?Zc(i,!!s.multiple,m,!1):g!==!!s.multiple&&(s.defaultValue!=null?Zc(i,!!s.multiple,s.defaultValue,!0):Zc(i,!!s.multiple,s.multiple?[]:"",!1))}i[of]=s}catch(x){qr(t,t.return,x)}}break;case 6:if($s(e,t),va(t),n&4){if(t.stateNode===null)throw Error(Le(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(x){qr(t,t.return,x)}}break;case 3:if($s(e,t),va(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{tf(e.containerInfo)}catch(x){qr(t,t.return,x)}break;case 4:$s(e,t),va(t);break;case 13:$s(e,t),va(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(I1=cn())),n&4&&N2(t);break;case 22:if(f=r!==null&&r.memoizedState!==null,t.mode&1?(fi=(u=fi)||f,$s(e,t),fi=u):$s(e,t),va(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(Ze=t,f=t.child;f!==null;){for(p=Ze=f;Ze!==null;){switch(g=Ze,m=g.child,g.tag){case 0:case 11:case 14:case 15:Pd(4,g,g.return);break;case 1:Xc(g,g.return);var y=g.stateNode;if(typeof y.componentWillUnmount=="function"){n=g,r=g.return;try{e=n,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(x){qr(n,r,x)}}break;case 5:Xc(g,g.return);break;case 22:if(g.memoizedState!==null){D2(p);continue}}m!==null?(m.return=g,Ze=m):D2(p)}f=f.sibling}e:for(f=null,p=t;;){if(p.tag===5){if(f===null){f=p;try{i=p.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=p.stateNode,l=p.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=zS("display",a))}catch(x){qr(t,t.return,x)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(x){qr(t,t.return,x)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:$s(e,t),va(t),n&4&&N2(t);break;case 21:break;default:$s(e,t),va(t)}}function va(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(pT(r)){var n=r;break e}r=r.return}throw Error(Le(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Qd(i,""),n.flags&=-33);var s=I2(t);ax(t,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=I2(t);sx(t,o,a);break;default:throw Error(Le(161))}}catch(l){qr(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function pN(t,e,r){Ze=t,xT(t)}function xT(t,e,r){for(var n=(t.mode&1)!==0;Ze!==null;){var i=Ze,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||N0;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||fi;o=N0;var u=fi;if(N0=a,(fi=l)&&!u)for(Ze=i;Ze!==null;)a=Ze,l=a.child,a.tag===22&&a.memoizedState!==null?P2(i):l!==null?(l.return=a,Ze=l):P2(i);for(;s!==null;)Ze=s,xT(s),s=s.sibling;Ze=i,N0=o,fi=u}R2(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Ze=s):R2(t)}}function R2(t){for(;Ze!==null;){var e=Ze;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:fi||Pp(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!fi)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:Ys(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&m2(e,s,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}m2(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&tf(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Le(163))}fi||e.flags&512&&ix(e)}catch(g){qr(e,e.return,g)}}if(e===t){Ze=null;break}if(r=e.sibling,r!==null){r.return=e.return,Ze=r;break}Ze=e.return}}function D2(t){for(;Ze!==null;){var e=Ze;if(e===t){Ze=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Ze=r;break}Ze=e.return}}function P2(t){for(;Ze!==null;){var e=Ze;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Pp(4,e)}catch(l){qr(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){qr(e,i,l)}}var s=e.return;try{ix(e)}catch(l){qr(e,s,l)}break;case 5:var a=e.return;try{ix(e)}catch(l){qr(e,a,l)}}}catch(l){qr(e,e.return,l)}if(e===t){Ze=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Ze=o;break}Ze=e.return}}var gN=Math.ceil,Hh=fo.ReactCurrentDispatcher,F1=fo.ReactCurrentOwner,Ps=fo.ReactCurrentBatchConfig,Zt=0,Wn=null,yn=null,Zn=0,is=0,qc=yl(0),bn=0,hf=null,ql=0,Op=0,b1=0,Od=null,Hi=null,I1=0,yu=1/0,za=null,$h=!1,ox=null,tl=null,R0=!1,$o=null,Gh=0,Md=0,lx=null,hh=-1,ph=0;function Ii(){return Zt&6?cn():hh!==-1?hh:hh=cn()}function rl(t){return t.mode&1?Zt&2&&Zn!==0?Zn&-Zn:JI.transition!==null?(ph===0&&(ph=tw()),ph):(t=gr,t!==0||(t=window.event,t=t===void 0?16:lw(t.type)),t):1}function ta(t,e,r,n){if(50<Md)throw Md=0,lx=null,Error(Le(185));Lf(t,r,n),(!(Zt&2)||t!==Wn)&&(t===Wn&&(!(Zt&2)&&(Op|=r),bn===4&&Lo(t,Zn)),Yi(t,n),r===1&&Zt===0&&!(e.mode&1)&&(yu=cn()+500,Np&&_l()))}function Yi(t,e){var r=t.callbackNode;Jb(t,e);var n=bh(t,t===Wn?Zn:0);if(n===0)r!==null&&Wy(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&Wy(r),e===1)t.tag===0?QI(O2.bind(null,t)):kw(O2.bind(null,t)),KI(function(){!(Zt&6)&&_l()}),r=null;else{switch(rw(n)){case 1:r=r1;break;case 4:r=ZS;break;case 16:r=Fh;break;case 536870912:r=ew;break;default:r=Fh}r=AT(r,vT.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function vT(t,e){if(hh=-1,ph=0,Zt&6)throw Error(Le(327));var r=t.callbackNode;if(iu()&&t.callbackNode!==r)return null;var n=bh(t,t===Wn?Zn:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Kh(t,n);else{e=n;var i=Zt;Zt|=2;var s=_T();(Wn!==t||Zn!==e)&&(za=null,yu=cn()+500,Ll(t,e));do try{vN();break}catch(o){yT(t,o)}while(!0);g1(),Hh.current=s,Zt=i,yn!==null?e=0:(Wn=null,Zn=0,e=bn)}if(e!==0){if(e===2&&(i=Om(t),i!==0&&(n=i,e=cx(t,i))),e===1)throw r=hf,Ll(t,0),Lo(t,n),Yi(t,cn()),r;if(e===6)Lo(t,n);else{if(i=t.current.alternate,!(n&30)&&!mN(i)&&(e=Kh(t,n),e===2&&(s=Om(t),s!==0&&(n=s,e=cx(t,s))),e===1))throw r=hf,Ll(t,0),Lo(t,n),Yi(t,cn()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(Le(345));case 2:Il(t,Hi,za);break;case 3:if(Lo(t,n),(n&130023424)===n&&(e=I1+500-cn(),10<e)){if(bh(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){Ii(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Wm(Il.bind(null,t,Hi,za),e);break}Il(t,Hi,za);break;case 4:if(Lo(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var a=31-ea(n);s=1<<a,a=e[a],a>i&&(i=a),n&=~s}if(n=i,n=cn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*gN(n/1960))-n,10<n){t.timeoutHandle=Wm(Il.bind(null,t,Hi,za),n);break}Il(t,Hi,za);break;case 5:Il(t,Hi,za);break;default:throw Error(Le(329))}}}return Yi(t,cn()),t.callbackNode===r?vT.bind(null,t):null}function cx(t,e){var r=Od;return t.current.memoizedState.isDehydrated&&(Ll(t,e).flags|=256),t=Kh(t,e),t!==2&&(e=Hi,Hi=r,e!==null&&ux(e)),t}function ux(t){Hi===null?Hi=t:Hi.push.apply(Hi,t)}function mN(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!ia(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Lo(t,e){for(e&=~b1,e&=~Op,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-ea(e),n=1<<r;t[r]=-1,e&=~n}}function O2(t){if(Zt&6)throw Error(Le(327));iu();var e=bh(t,0);if(!(e&1))return Yi(t,cn()),null;var r=Kh(t,e);if(t.tag!==0&&r===2){var n=Om(t);n!==0&&(e=n,r=cx(t,n))}if(r===1)throw r=hf,Ll(t,0),Lo(t,e),Yi(t,cn()),r;if(r===6)throw Error(Le(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Il(t,Hi,za),Yi(t,cn()),null}function N1(t,e){var r=Zt;Zt|=1;try{return t(e)}finally{Zt=r,Zt===0&&(yu=cn()+500,Np&&_l())}}function Ql(t){$o!==null&&$o.tag===0&&!(Zt&6)&&iu();var e=Zt;Zt|=1;var r=Ps.transition,n=gr;try{if(Ps.transition=null,gr=1,t)return t()}finally{gr=n,Ps.transition=r,Zt=e,!(Zt&6)&&_l()}}function R1(){is=qc.current,Ir(qc)}function Ll(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,GI(r)),yn!==null)for(r=yn.return;r!==null;){var n=r;switch(f1(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Ph();break;case 3:xu(),Ir(Gi),Ir(xi),E1();break;case 5:_1(n);break;case 4:xu();break;case 13:Ir(Wr);break;case 19:Ir(Wr);break;case 10:m1(n.type._context);break;case 22:case 23:R1()}r=r.return}if(Wn=t,yn=t=nl(t.current,null),Zn=is=e,bn=0,hf=null,b1=Op=ql=0,Hi=Od=null,Ol!==null){for(e=0;e<Ol.length;e++)if(r=Ol[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}Ol=null}return t}function yT(t,e){do{var r=yn;try{if(g1(),uh.current=Wh,zh){for(var n=Gr.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}zh=!1}if(Xl=0,Un=Cn=Gr=null,Dd=!1,uf=0,F1.current=null,r===null||r.return===null){bn=1,hf=e,yn=null;break}e:{var s=t,a=r.return,o=r,l=e;if(e=Zn,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,f=o,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var g=f.alternate;g?(f.updateQueue=g.updateQueue,f.memoizedState=g.memoizedState,f.lanes=g.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=S2(a);if(m!==null){m.flags&=-257,w2(m,a,o,s,e),m.mode&1&&E2(s,u,e),e=m,l=u;var y=e.updateQueue;if(y===null){var x=new Set;x.add(l),e.updateQueue=x}else y.add(l);break e}else{if(!(e&1)){E2(s,u,e),D1();break e}l=Error(Le(426))}}else if(Br&&o.mode&1){var S=S2(a);if(S!==null){!(S.flags&65536)&&(S.flags|=256),w2(S,a,o,s,e),h1(vu(l,o));break e}}s=l=vu(l,o),bn!==4&&(bn=2),Od===null?Od=[s]:Od.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var A=rT(s,l,e);g2(s,A);break e;case 1:o=l;var C=s.type,E=s.stateNode;if(!(s.flags&128)&&(typeof C.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(tl===null||!tl.has(E)))){s.flags|=65536,e&=-e,s.lanes|=e;var M=nT(s,o,e);g2(s,M);break e}}s=s.return}while(s!==null)}ST(r)}catch(X){e=X,yn===r&&r!==null&&(yn=r=r.return);continue}break}while(!0)}function _T(){var t=Hh.current;return Hh.current=Wh,t===null?Wh:t}function D1(){(bn===0||bn===3||bn===2)&&(bn=4),Wn===null||!(ql&268435455)&&!(Op&268435455)||Lo(Wn,Zn)}function Kh(t,e){var r=Zt;Zt|=2;var n=_T();(Wn!==t||Zn!==e)&&(za=null,Ll(t,e));do try{xN();break}catch(i){yT(t,i)}while(!0);if(g1(),Zt=r,Hh.current=n,yn!==null)throw Error(Le(261));return Wn=null,Zn=0,bn}function xN(){for(;yn!==null;)ET(yn)}function vN(){for(;yn!==null&&!Wb();)ET(yn)}function ET(t){var e=TT(t.alternate,t,is);t.memoizedProps=t.pendingProps,e===null?ST(t):yn=e,F1.current=null}function ST(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=dN(r,e),r!==null){r.flags&=32767,yn=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{bn=6,yn=null;return}}else if(r=uN(r,e,is),r!==null){yn=r;return}if(e=e.sibling,e!==null){yn=e;return}yn=e=t}while(e!==null);bn===0&&(bn=5)}function Il(t,e,r){var n=gr,i=Ps.transition;try{Ps.transition=null,gr=1,yN(t,e,r,n)}finally{Ps.transition=i,gr=n}return null}function yN(t,e,r,n){do iu();while($o!==null);if(Zt&6)throw Error(Le(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Le(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(Zb(t,s),t===Wn&&(yn=Wn=null,Zn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||R0||(R0=!0,AT(Fh,function(){return iu(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Ps.transition,Ps.transition=null;var a=gr;gr=1;var o=Zt;Zt|=4,F1.current=null,hN(t,r),mT(r,t),LI(Vm),Ih=!!Um,Vm=Um=null,t.current=r,pN(r),Hb(),Zt=o,gr=a,Ps.transition=s}else t.current=r;if(R0&&(R0=!1,$o=t,Gh=i),s=t.pendingLanes,s===0&&(tl=null),Kb(r.stateNode),Yi(t,cn()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if($h)throw $h=!1,t=ox,ox=null,t;return Gh&1&&t.tag!==0&&iu(),s=t.pendingLanes,s&1?t===lx?Md++:(Md=0,lx=t):Md=0,_l(),null}function iu(){if($o!==null){var t=rw(Gh),e=Ps.transition,r=gr;try{if(Ps.transition=null,gr=16>t?16:t,$o===null)var n=!1;else{if(t=$o,$o=null,Gh=0,Zt&6)throw Error(Le(331));var i=Zt;for(Zt|=4,Ze=t.current;Ze!==null;){var s=Ze,a=s.child;if(Ze.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(Ze=u;Ze!==null;){var f=Ze;switch(f.tag){case 0:case 11:case 15:Pd(8,f,s)}var p=f.child;if(p!==null)p.return=f,Ze=p;else for(;Ze!==null;){f=Ze;var g=f.sibling,m=f.return;if(hT(f),f===u){Ze=null;break}if(g!==null){g.return=m,Ze=g;break}Ze=m}}}var y=s.alternate;if(y!==null){var x=y.child;if(x!==null){y.child=null;do{var S=x.sibling;x.sibling=null,x=S}while(x!==null)}}Ze=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,Ze=a;else e:for(;Ze!==null;){if(s=Ze,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Pd(9,s,s.return)}var A=s.sibling;if(A!==null){A.return=s.return,Ze=A;break e}Ze=s.return}}var C=t.current;for(Ze=C;Ze!==null;){a=Ze;var E=a.child;if(a.subtreeFlags&2064&&E!==null)E.return=a,Ze=E;else e:for(a=C;Ze!==null;){if(o=Ze,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Pp(9,o)}}catch(X){qr(o,o.return,X)}if(o===a){Ze=null;break e}var M=o.sibling;if(M!==null){M.return=o.return,Ze=M;break e}Ze=o.return}}if(Zt=i,_l(),Ca&&typeof Ca.onPostCommitFiberRoot=="function")try{Ca.onPostCommitFiberRoot(Cp,t)}catch{}n=!0}return n}finally{gr=r,Ps.transition=e}}return!1}function M2(t,e,r){e=vu(r,e),e=rT(t,e,1),t=el(t,e,1),e=Ii(),t!==null&&(Lf(t,1,e),Yi(t,e))}function qr(t,e,r){if(t.tag===3)M2(t,t,r);else for(;e!==null;){if(e.tag===3){M2(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(tl===null||!tl.has(n))){t=vu(r,t),t=nT(e,t,1),e=el(e,t,1),t=Ii(),e!==null&&(Lf(e,1,t),Yi(e,t));break}}e=e.return}}function _N(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Ii(),t.pingedLanes|=t.suspendedLanes&r,Wn===t&&(Zn&r)===r&&(bn===4||bn===3&&(Zn&130023424)===Zn&&500>cn()-I1?Ll(t,0):b1|=r),Yi(t,e)}function wT(t,e){e===0&&(t.mode&1?(e=S0,S0<<=1,!(S0&130023424)&&(S0=4194304)):e=1);var r=Ii();t=no(t,e),t!==null&&(Lf(t,e,r),Yi(t,r))}function EN(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),wT(t,r)}function SN(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Le(314))}n!==null&&n.delete(e),wT(t,r)}var TT;TT=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Gi.current)$i=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return $i=!1,cN(t,e,r);$i=!!(t.flags&131072)}else $i=!1,Br&&e.flags&1048576&&Fw(e,Bh,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;fh(t,e),t=e.pendingProps;var i=pu(e,xi.current);nu(e,r),i=w1(null,e,n,t,i,r);var s=T1();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ki(n)?(s=!0,Oh(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,v1(e),i.updater=Dp,e.stateNode=i,i._reactInternals=e,qm(e,n,t,r),e=Zm(null,e,n,!0,s,r)):(e.tag=0,Br&&s&&d1(e),ki(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(fh(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=TN(n),t=Ys(n,t),i){case 0:e=Jm(null,e,n,t,r);break e;case 1:e=C2(null,e,n,t,r);break e;case 11:e=T2(null,e,n,t,r);break e;case 14:e=A2(null,e,n,Ys(n.type,t),r);break e}throw Error(Le(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Ys(n,i),Jm(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Ys(n,i),C2(t,e,n,i,r);case 3:e:{if(oT(e),t===null)throw Error(Le(387));n=e.pendingProps,s=e.memoizedState,i=s.element,Pw(t,e),Uh(e,n,null,r);var a=e.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=vu(Error(Le(423)),e),e=k2(t,e,n,r,i);break e}else if(n!==i){i=vu(Error(Le(424)),e),e=k2(t,e,n,r,i);break e}else for(cs=Zo(e.stateNode.containerInfo.firstChild),us=e,Br=!0,qs=null,r=Rw(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(gu(),n===i){e=io(t,e,r);break e}ki(t,e,n,r)}e=e.child}return e;case 5:return Ow(e),t===null&&Km(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,zm(n,i)?a=null:s!==null&&zm(n,s)&&(e.flags|=32),aT(t,e),ki(t,e,a,r),e.child;case 6:return t===null&&Km(e),null;case 13:return lT(t,e,r);case 4:return y1(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=mu(e,null,n,r):ki(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Ys(n,i),T2(t,e,n,i,r);case 7:return ki(t,e,e.pendingProps,r),e.child;case 8:return ki(t,e,e.pendingProps.children,r),e.child;case 12:return ki(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,wr(jh,n._currentValue),n._currentValue=a,s!==null)if(ia(s.value,a)){if(s.children===i.children&&!Gi.current){e=io(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=qa(-1,r&-r),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?l.next=l:(l.next=f.next,f.next=l),u.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Ym(s.return,r,e),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(Le(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Ym(a,r,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}ki(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,nu(e,r),i=Ms(i),n=n(i),e.flags|=1,ki(t,e,n,r),e.child;case 14:return n=e.type,i=Ys(n,e.pendingProps),i=Ys(n.type,i),A2(t,e,n,i,r);case 15:return iT(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Ys(n,i),fh(t,e),e.tag=1,Ki(n)?(t=!0,Oh(e)):t=!1,nu(e,r),tT(e,n,i),qm(e,n,i,r),Zm(null,e,n,!0,t,r);case 19:return cT(t,e,r);case 22:return sT(t,e,r)}throw Error(Le(156,e.tag))};function AT(t,e){return JS(t,e)}function wN(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ds(t,e,r,n){return new wN(t,e,r,n)}function P1(t){return t=t.prototype,!(!t||!t.isReactComponent)}function TN(t){if(typeof t=="function")return P1(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Zx)return 11;if(t===e1)return 14}return 2}function nl(t,e){var r=t.alternate;return r===null?(r=Ds(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function gh(t,e,r,n,i,s){var a=2;if(n=t,typeof t=="function")P1(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Uc:return Ul(r.children,i,s,e);case Jx:a=8,i|=8;break;case _m:return t=Ds(12,r,e,i|2),t.elementType=_m,t.lanes=s,t;case Em:return t=Ds(13,r,e,i),t.elementType=Em,t.lanes=s,t;case Sm:return t=Ds(19,r,e,i),t.elementType=Sm,t.lanes=s,t;case OS:return Mp(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case DS:a=10;break e;case PS:a=9;break e;case Zx:a=11;break e;case e1:a=14;break e;case Mo:a=16,n=null;break e}throw Error(Le(130,t==null?t:typeof t,""))}return e=Ds(a,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function Ul(t,e,r,n){return t=Ds(7,t,n,e),t.lanes=r,t}function Mp(t,e,r,n){return t=Ds(22,t,n,e),t.elementType=OS,t.lanes=r,t.stateNode={isHidden:!1},t}function Ug(t,e,r){return t=Ds(6,t,null,e),t.lanes=r,t}function Vg(t,e,r){return e=Ds(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function AN(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Eg(0),this.expirationTimes=Eg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Eg(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function O1(t,e,r,n,i,s,a,o,l){return t=new AN(t,e,r,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Ds(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},v1(s),t}function CN(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Lc,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function CT(t){if(!t)return ul;t=t._reactInternals;e:{if(uc(t)!==t||t.tag!==1)throw Error(Le(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ki(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Le(171))}if(t.tag===1){var r=t.type;if(Ki(r))return Cw(t,r,e)}return e}function kT(t,e,r,n,i,s,a,o,l){return t=O1(r,n,!0,t,i,s,a,o,l),t.context=CT(null),r=t.current,n=Ii(),i=rl(r),s=qa(n,i),s.callback=e??null,el(r,s,i),t.current.lanes=i,Lf(t,i,n),Yi(t,n),t}function Bp(t,e,r,n){var i=e.current,s=Ii(),a=rl(i);return r=CT(r),e.context===null?e.context=r:e.pendingContext=r,e=qa(s,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=el(i,e,a),t!==null&&(ta(t,i,a,s),ch(t,i,a)),a}function Yh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function B2(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function M1(t,e){B2(t,e),(t=t.alternate)&&B2(t,e)}function kN(){return null}var FT=typeof reportError=="function"?reportError:function(t){console.error(t)};function B1(t){this._internalRoot=t}jp.prototype.render=B1.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Le(409));Bp(t,e,null,null)};jp.prototype.unmount=B1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ql(function(){Bp(null,t,null,null)}),e[ro]=null}};function jp(t){this._internalRoot=t}jp.prototype.unstable_scheduleHydration=function(t){if(t){var e=sw();t={blockedOn:null,target:t,priority:e};for(var r=0;r<jo.length&&e!==0&&e<jo[r].priority;r++);jo.splice(r,0,t),r===0&&ow(t)}};function j1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Lp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function j2(){}function FN(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=Yh(a);s.call(u)}}var a=kT(e,n,t,0,null,!1,!1,"",j2);return t._reactRootContainer=a,t[ro]=a.current,sf(t.nodeType===8?t.parentNode:t),Ql(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var u=Yh(l);o.call(u)}}var l=O1(t,0,!1,null,null,!1,!1,"",j2);return t._reactRootContainer=l,t[ro]=l.current,sf(t.nodeType===8?t.parentNode:t),Ql(function(){Bp(e,l,r,n)}),l}function Up(t,e,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=Yh(a);o.call(l)}}Bp(e,a,t,i)}else a=FN(r,e,t,i,n);return Yh(a)}nw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=yd(e.pendingLanes);r!==0&&(n1(e,r|1),Yi(e,cn()),!(Zt&6)&&(yu=cn()+500,_l()))}break;case 13:Ql(function(){var n=no(t,1);if(n!==null){var i=Ii();ta(n,t,1,i)}}),M1(t,1)}};i1=function(t){if(t.tag===13){var e=no(t,134217728);if(e!==null){var r=Ii();ta(e,t,134217728,r)}M1(t,134217728)}};iw=function(t){if(t.tag===13){var e=rl(t),r=no(t,e);if(r!==null){var n=Ii();ta(r,t,e,n)}M1(t,e)}};sw=function(){return gr};aw=function(t,e){var r=gr;try{return gr=t,e()}finally{gr=r}};Rm=function(t,e,r){switch(e){case"input":if(Am(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=Ip(n);if(!i)throw Error(Le(90));BS(n),Am(n,i)}}}break;case"textarea":LS(t,r);break;case"select":e=r.value,e!=null&&Zc(t,!!r.multiple,e,!1)}};GS=N1;KS=Ql;var bN={usingClientEntryPoint:!1,Events:[Vf,Hc,Ip,HS,$S,N1]},ud={findFiberByHostInstance:Pl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},IN={bundleType:ud.bundleType,version:ud.version,rendererPackageName:ud.rendererPackageName,rendererConfig:ud.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fo.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=qS(t),t===null?null:t.stateNode},findFiberByHostInstance:ud.findFiberByHostInstance||kN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var D0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!D0.isDisabled&&D0.supportsFiber)try{Cp=D0.inject(IN),Ca=D0}catch{}}ps.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bN;ps.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!j1(e))throw Error(Le(200));return CN(t,e,null,r)};ps.createRoot=function(t,e){if(!j1(t))throw Error(Le(299));var r=!1,n="",i=FT;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=O1(t,1,!1,null,null,r,!1,n,i),t[ro]=e.current,sf(t.nodeType===8?t.parentNode:t),new B1(e)};ps.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Le(188)):(t=Object.keys(t).join(","),Error(Le(268,t)));return t=qS(e),t=t===null?null:t.stateNode,t};ps.flushSync=function(t){return Ql(t)};ps.hydrate=function(t,e,r){if(!Lp(e))throw Error(Le(200));return Up(null,t,e,!0,r)};ps.hydrateRoot=function(t,e,r){if(!j1(t))throw Error(Le(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=FT;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=kT(e,null,t,1,r??null,i,!1,s,a),t[ro]=e.current,sf(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new jp(e)};ps.render=function(t,e,r){if(!Lp(e))throw Error(Le(200));return Up(null,t,e,!1,r)};ps.unmountComponentAtNode=function(t){if(!Lp(t))throw Error(Le(40));return t._reactRootContainer?(Ql(function(){Up(null,null,t,!1,function(){t._reactRootContainer=null,t[ro]=null})}),!0):!1};ps.unstable_batchedUpdates=N1;ps.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Lp(r))throw Error(Le(200));if(t==null||t._reactInternals===void 0)throw Error(Le(38));return Up(t,e,r,!1,n)};ps.version="18.3.1-next-f1338f8080-20240426";function bT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(bT)}catch(t){console.error(t)}}bT(),bS.exports=ps;var NN=bS.exports,L2=NN;vm.createRoot=L2.createRoot,vm.hydrateRoot=L2.hydrateRoot;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Xh={};Xh.version="0.18.5";var IT=1252,RN=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],L1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},U1=function(t){RN.indexOf(t)!=-1&&(IT=L1[0]=t)};function DN(){U1(1252)}var Qs=function(t){U1(t)};function V1(){Qs(1200),DN()}function U2(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function PN(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function NT(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Ed=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?PN(t.slice(2)):e==254&&r==255?NT(t.slice(2)):e==65279?t.slice(1):t},P0=function(e){return String.fromCharCode(e)},V2=function(e){return String.fromCharCode(e)},pf,Go="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function gf(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,u=0;u<t.length;)r=t.charCodeAt(u++),s=r>>2,n=t.charCodeAt(u++),a=(r&3)<<4|n>>4,i=t.charCodeAt(u++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=Go.charAt(s)+Go.charAt(a)+Go.charAt(o)+Go.charAt(l);return e}function hs(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)s=Go.indexOf(t.charAt(u++)),a=Go.indexOf(t.charAt(u++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=Go.indexOf(t.charAt(u++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Go.indexOf(t.charAt(u++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Mt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ho=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function dl(t){return Mt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function z2(t){return Mt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var os=function(e){return Mt?ho(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Vp(t){if(typeof ArrayBuffer>"u")return os(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function El(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function ON(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function z1(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return z1(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Vn=Mt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:ho(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function MN(t){for(var e=[],r=0,n=t.length+250,i=dl(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=dl(65535),n=65530)}return e.push(i.slice(0,r)),Vn(e)}var Ni=/\u0000/g,Sd=/[\u0001-\u0006]/g;function su(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Js(t,e){var r=""+t;return r.length>=e?r:Qr("0",e-r.length)+r}function W1(t,e){var r=""+t;return r.length>=e?r:Qr(" ",e-r.length)+r}function qh(t,e){var r=""+t;return r.length>=e?r:r+Qr(" ",e-r.length)}function BN(t,e){var r=""+Math.round(t);return r.length>=e?r:Qr("0",e-r.length)+r}function jN(t,e){var r=""+t;return r.length>=e?r:Qr("0",e-r.length)+r}var W2=Math.pow(2,32);function Ic(t,e){if(t>W2||t<-W2)return BN(t,e);var r=Math.round(t);return jN(r,e)}function Qh(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var H2=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],zg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function LN(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var ft={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},$2={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},UN={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Jh(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,l=1,u=0,f=0,p=Math.floor(i);u<e&&(p=Math.floor(i),o=p*a+s,f=p*u+l,!(i-p<5e-8));)i=1/(i-p),s=a,a=o,l=u,u=f;if(f>e&&(u>e?(f=l,o=s):(f=u,o=a)),!r)return[0,n*o,f];var g=Math.floor(n*o/f);return[g,n*o-g*f,f]}function Bl(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=GN(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var RT=new Date(1899,11,31,0,0,0),VN=RT.getTime(),zN=new Date(1900,2,1,0,0,0);function DT(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=zN&&(r+=24*60*60*1e3),(r-(VN+(t.getTimezoneOffset()-RT.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function H1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function WN(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function HN(t){var e=t<0?12:11,r=H1(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function $N(t){var e=H1(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function mf(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=HN(t):e===10?r=t.toFixed(10).substr(0,12):r=$N(t),H1(WN(r.toUpperCase()))}function Jl(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):mf(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return js(14,DT(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function GN(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function KN(t,e,r,n){var i="",s=0,a=0,o=r.y,l,u=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,u=e.length;break;case 3:return zg[r.m-1][1];case 5:return zg[r.m-1][0];default:return zg[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,u=e.length;break;case 3:return H2[r.q][0];default:return H2[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Js(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=Js(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:l=o,u=1;break}var f=u>0?Js(l,u):"";return f}function Ko(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var PT=/%/g;function YN(t,e,r){var n=e.replace(PT,""),i=e.length-n.length;return Qa(t,n,r*Math.pow(10,2*i))+Qr("%",i)}function XN(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Qa(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function OT(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+OT(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var MT=/# (\?+)( ?)\/( ?)(\d+)/;function qN(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?Qr(" ",t[1].length+1+t[4].length):W1(a,t[1].length)+t[2]+"/"+t[3]+Js(o,t[4].length))}function QN(t,e,r){return r+(e===0?"":""+e)+Qr(" ",t[1].length+2+t[4].length)}var BT=/^#*0*\.([0#]+)/,jT=/\).*[0#]/,LT=/\(###\) ###\\?-####/;function Fi(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function G2(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function K2(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function JN(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function ZN(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function As(t,e,r){if(t.charCodeAt(0)===40&&!e.match(jT)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?As("n",n,r):"("+As("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return XN(t,e,r);if(e.indexOf("%")!==-1)return YN(t,e,r);if(e.indexOf("E")!==-1)return OT(e,r);if(e.charCodeAt(0)===36)return"$"+As(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Ic(l,e.length);if(e.match(/^[#?]+$/))return i=Ic(r,0),i==="0"&&(i=""),i.length>e.length?i:Fi(e.substr(0,e.length-i.length))+i;if(s=e.match(MT))return qN(s,l,u);if(e.match(/^#+0+$/))return u+Ic(l,e.length-e.indexOf("0"));if(s=e.match(BT))return i=G2(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Fi(s[1])).replace(/\.$/,"."+Fi(s[1])).replace(/\.(\d*)$/,function(y,x){return"."+x+Qr("0",Fi(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+G2(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Ko(Ic(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+As(t,e,-r):Ko(""+(Math.floor(r)+JN(r,s[1].length)))+"."+Js(K2(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return As(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=su(As(t,e.replace(/[\\-]/g,""),r)),a=0,su(su(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match(LT))return i=As(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Jh(l,Math.pow(10,a)-1,!1),i=""+u,f=Qa("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=qh(o[2],a),f.length<s[4].length&&(f=Fi(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Jh(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?W1(o[1],a)+s[2]+"/"+s[3]+qh(o[2],a):Qr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=Ic(r,0),e.length<=i.length?i:Fi(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var p=e.indexOf(".")-a,g=e.length-i.length-p;return Fi(e.substr(0,p)+i+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=K2(r,s[1].length),r<0?"-"+As(t,e,-r):Ko(ZN(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Js(0,3-y.length):"")+y})+"."+Js(a,s[1].length);switch(e){case"###,##0.00":return As(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Ko(Ic(l,0));return m!=="0"?u+m:"";case"###,###.00":return As(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return As(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function eR(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Qa(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function tR(t,e,r){var n=e.replace(PT,""),i=e.length-n.length;return Qa(t,n,r*Math.pow(10,2*i))+Qr("%",i)}function UT(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+UT(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function _a(t,e,r){if(t.charCodeAt(0)===40&&!e.match(jT)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?_a("n",n,r):"("+_a("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return eR(t,e,r);if(e.indexOf("%")!==-1)return tR(t,e,r);if(e.indexOf("E")!==-1)return UT(e,r);if(e.charCodeAt(0)===36)return"$"+_a(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Js(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:Fi(e.substr(0,e.length-i.length))+i;if(s=e.match(MT))return QN(s,l,u);if(e.match(/^#+0+$/))return u+Js(l,e.length-e.indexOf("0"));if(s=e.match(BT))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Fi(s[1])).replace(/\.$/,"."+Fi(s[1])),i=i.replace(/\.(\d*)$/,function(y,x){return"."+x+Qr("0",Fi(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Ko(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+_a(t,e,-r):Ko(""+r)+"."+Qr("0",s[1].length);if(s=e.match(/^#,#*,#0/))return _a(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=su(_a(t,e.replace(/[\\-]/g,""),r)),a=0,su(su(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match(LT))return i=_a(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Jh(l,Math.pow(10,a)-1,!1),i=""+u,f=Qa("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=qh(o[2],a),f.length<s[4].length&&(f=Fi(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Jh(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?W1(o[1],a)+s[2]+"/"+s[3]+qh(o[2],a):Qr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:Fi(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var p=e.indexOf(".")-a,g=e.length-i.length-p;return Fi(e.substr(0,p)+i+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+_a(t,e,-r):Ko(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Js(0,3-y.length):"")+y})+"."+Js(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var m=Ko(""+l);return m!=="0"?u+m:"";default:if(e.match(/\.[0#?]*$/))return _a(t,e.slice(0,e.lastIndexOf(".")),r)+Fi(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Qa(t,e,r){return(r|0)===r?_a(t,e,r):As(t,e,r)}function rR(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var VT=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ou(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Qh(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(VT))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function nR(t,e,r,n){for(var i=[],s="",a=0,o="",l="t",u,f,p,g="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!Qh(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(p=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(p);i[i.length]={t:"t",v:s},++a;break;case"\\":var m=t.charAt(++a),y=m==="("||m===")"?m:"t";i[i.length]={t:y,v:m},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(u==null&&(u=Bl(e,r,t.charAt(a+1)==="2"),u==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=Bl(e,r),u==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=g),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var x={t:o,v:o};if(u==null&&(u=Bl(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",g="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",a+=5,g="h"):t.substr(a,5).toUpperCase()==="/"?(u!=null&&(x.v=u.H>=12?"":""),x.t="T",a+=5,g="h"):(x.t="t",++a),u==null&&x.t==="T")return"";i[i.length]=x,l=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(VT)){if(u==null&&(u=Bl(e,r),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ou(t)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var S=0,A=0,C;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=g,l="h",S<1&&(S=1);break;case"s":(C=i[a].v.match(/\.0+$/))&&(A=Math.max(A,C[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&i[a].v.match(/[Hh]/)&&(S=1),S<2&&i[a].v.match(/[Mm]/)&&(S=2),S<3&&i[a].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var E="",M;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=KN(i[a].t.charCodeAt(0),i[a].v,u,A),i[a].t="t";break;case"n":case"?":for(M=a+1;i[M]!=null&&((o=i[M].t)==="?"||o==="D"||(o===" "||o==="t")&&i[M+1]!=null&&(i[M+1].t==="?"||i[M+1].t==="t"&&i[M+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[M].v==="/"||i[M].v===" "&&i[M+1]!=null&&i[M+1].t=="?"));)i[a].v+=i[M].v,i[M]={v:"",t:";"},++M;E+=i[a].v,a=M-1;break;case"G":i[a].t="t",i[a].v=Jl(e,r);break}var X="",z,T;if(E.length>0){E.charCodeAt(0)==40?(z=e<0&&E.charCodeAt(0)===45?-e:e,T=Qa("n",E,z)):(z=e<0&&n>1?-e:e,T=Qa("n",E,z),z<0&&i[0]&&i[0].t=="t"&&(T=T.substr(1),i[0].v="-"+i[0].v)),M=T.length-1;var F=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){F=a;break}var w=i.length;if(F===i.length&&T.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(M>=i[a].v.length-1?(M-=i[a].v.length,i[a].v=T.substr(M+1,i[a].v.length)):M<0?i[a].v="":(i[a].v=T.substr(0,M+1),M=-1),i[a].t="t",w=a);M>=0&&w<i.length&&(i[w].v=T.substr(0,M+1)+i[w].v)}else if(F!==i.length&&T.indexOf("E")===-1){for(M=T.indexOf(".")-1,a=F;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(f=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")-1:i[a].v.length-1,X=i[a].v.substr(f+1);f>=0;--f)M>=0&&(i[a].v.charAt(f)==="0"||i[a].v.charAt(f)==="#")&&(X=T.charAt(M--)+X);i[a].v=X,i[a].t="t",w=a}for(M>=0&&w<i.length&&(i[w].v=T.substr(0,M+1)+i[w].v),M=T.indexOf(".")+1,a=F;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==F)){for(f=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")+1:0,X=i[a].v.substr(0,f);f<i[a].v.length;++f)M<T.length&&(X+=T.charAt(M++));i[a].v=X,i[a].t="t",w=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(z=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Qa(i[a].t,i[a].v,z),i[a].t="t");var R="";for(a=0;a!==i.length;++a)i[a]!=null&&(R+=i[a].v);return R}var Y2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function X2(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function iR(t,e){var r=rR(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(Y2),o=r[1].match(Y2);return X2(e,a)?[n,r[0]]:X2(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function js(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ft)[t],n==null&&(n=r.table&&r.table[$2[t]]||ft[$2[t]]),n==null&&(n=UN[t]||"General");break}if(Qh(n,0))return Jl(e,r);e instanceof Date&&(e=DT(e,r.date1904));var i=iR(n,e);if(Qh(i[1]))return Jl(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return nR(i[1],e,r,i[0])}function Ja(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(ft[r]==null){e<0&&(e=r);continue}if(ft[r]==t){e=r;break}}e<0&&(e=391)}return ft[e]=t,e}function zp(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Ja(t[e],e)}function Mu(){ft=LN()}var sR={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},zT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function aR(t){var e=typeof t=="number"?ft[t]:t;return e=e.replace(zT,"(\\d+)"),new RegExp("^"+e+"$")}function oR(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(zT)||[]).forEach(function(p,g){var m=parseInt(r[g+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=m;break;case"d":s=m;break;case"h":a=m;break;case"s":l=m;break;case"m":a>=0?o=m:i=m;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?u:n==-1&&i==-1&&s==-1?f:u+"T"+f}var lR=function(){var t={};t.version="1.2.0";function e(){for(var T=0,F=new Array(256),w=0;w!=256;++w)T=w,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,F[w]=T;return typeof Int32Array<"u"?new Int32Array(F):F}var r=e();function n(T){var F=0,w=0,R=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(R=0;R!=256;++R)P[R]=T[R];for(R=0;R!=256;++R)for(w=T[R],F=256+R;F<4096;F+=256)w=P[F]=w>>>8^T[w&255];var O=[];for(R=1;R!=16;++R)O[R-1]=typeof Int32Array<"u"?P.subarray(R*256,R*256+256):P.slice(R*256,R*256+256);return O}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],u=i[4],f=i[5],p=i[6],g=i[7],m=i[8],y=i[9],x=i[10],S=i[11],A=i[12],C=i[13],E=i[14];function M(T,F){for(var w=F^-1,R=0,P=T.length;R<P;)w=w>>>8^r[(w^T.charCodeAt(R++))&255];return~w}function X(T,F){for(var w=F^-1,R=T.length-15,P=0;P<R;)w=E[T[P++]^w&255]^C[T[P++]^w>>8&255]^A[T[P++]^w>>16&255]^S[T[P++]^w>>>24]^x[T[P++]]^y[T[P++]]^m[T[P++]]^g[T[P++]]^p[T[P++]]^f[T[P++]]^u[T[P++]]^l[T[P++]]^o[T[P++]]^a[T[P++]]^s[T[P++]]^r[T[P++]];for(R+=15;P<R;)w=w>>>8^r[(w^T[P++])&255];return~w}function z(T,F){for(var w=F^-1,R=0,P=T.length,O=0,D=0;R<P;)O=T.charCodeAt(R++),O<128?w=w>>>8^r[(w^O)&255]:O<2048?(w=w>>>8^r[(w^(192|O>>6&31))&255],w=w>>>8^r[(w^(128|O&63))&255]):O>=55296&&O<57344?(O=(O&1023)+64,D=T.charCodeAt(R++)&1023,w=w>>>8^r[(w^(240|O>>8&7))&255],w=w>>>8^r[(w^(128|O>>2&63))&255],w=w>>>8^r[(w^(128|D>>6&15|(O&3)<<4))&255],w=w>>>8^r[(w^(128|D&63))&255]):(w=w>>>8^r[(w^(224|O>>12&15))&255],w=w>>>8^r[(w^(128|O>>6&63))&255],w=w>>>8^r[(w^(128|O&63))&255]);return~w}return t.table=r,t.bstr=M,t.buf=X,t.str=z,t}(),st=function(){var e={};e.version="1.2.1";function r(I,W){for(var j=I.split("/"),V=W.split("/"),G=0,Q=0,he=Math.min(j.length,V.length);G<he;++G){if(Q=j[G].length-V[G].length)return Q;if(j[G]!=V[G])return j[G]<V[G]?-1:1}return j.length-V.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var W=I.lastIndexOf("/");return W===-1?I:I.slice(0,W+1)}function i(I){if(I.charAt(I.length-1)=="/")return i(I.slice(0,-1));var W=I.lastIndexOf("/");return W===-1?I:I.slice(W+1)}function s(I,W){typeof W=="string"&&(W=new Date(W));var j=W.getHours();j=j<<6|W.getMinutes(),j=j<<5|W.getSeconds()>>>1,I.write_shift(2,j);var V=W.getFullYear()-1980;V=V<<4|W.getMonth()+1,V=V<<5|W.getDate(),I.write_shift(2,V)}function a(I){var W=I.read_shift(2)&65535,j=I.read_shift(2)&65535,V=new Date,G=j&31;j>>>=5;var Q=j&15;j>>>=4,V.setMilliseconds(0),V.setFullYear(j+1980),V.setMonth(Q-1),V.setDate(G);var he=W&31;W>>>=5;var xe=W&63;return W>>>=6,V.setHours(W),V.setMinutes(xe),V.setSeconds(he<<1),V}function o(I){qn(I,0);for(var W={},j=0;I.l<=I.length-4;){var V=I.read_shift(2),G=I.read_shift(2),Q=I.l+G,he={};switch(V){case 21589:j=I.read_shift(1),j&1&&(he.mtime=I.read_shift(4)),G>5&&(j&2&&(he.atime=I.read_shift(4)),j&4&&(he.ctime=I.read_shift(4))),he.mtime&&(he.mt=new Date(he.mtime*1e3));break}I.l=Q,W[V]=he}return W}var l;function u(){return l||(l={})}function f(I,W){if(I[0]==80&&I[1]==75)return aa(I,W);if((I[0]|32)==109&&(I[1]|32)==105)return la(I,W);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var j=3,V=512,G=0,Q=0,he=0,xe=0,fe=0,ue=[],pe=I.slice(0,512);qn(pe,0);var we=p(pe);switch(j=we[0],j){case 3:V=512;break;case 4:V=4096;break;case 0:if(we[1]==0)return aa(I,W);default:throw new Error("Major Version: Expected 3 or 4 saw "+j)}V!==512&&(pe=I.slice(0,V),qn(pe,28));var We=I.slice(0,V);g(pe,j);var Ue=pe.read_shift(4,"i");if(j===3&&Ue!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ue);pe.l+=4,he=pe.read_shift(4,"i"),pe.l+=4,pe.chk("00100000","Mini Stream Cutoff Size: "),xe=pe.read_shift(4,"i"),G=pe.read_shift(4,"i"),fe=pe.read_shift(4,"i"),Q=pe.read_shift(4,"i");for(var Oe=-1,He=0;He<109&&(Oe=pe.read_shift(4,"i"),!(Oe<0));++He)ue[He]=Oe;var at=m(I,V);S(fe,Q,at,V,ue);var ur=C(at,he,ue,V);ur[he].name="!Directory",G>0&&xe!==D&&(ur[xe].name="!MiniFAT"),ur[ue[0]].name="!FAT",ur.fat_addrs=ue,ur.ssz=V;var nr={},Yt=[],wi=[],La=[];E(he,ur,at,Yt,G,nr,wi,xe),y(wi,La,Yt),Yt.shift();var Qi={FileIndex:wi,FullPaths:La};return W&&W.raw&&(Qi.raw={header:We,sectors:at}),Qi}function p(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(qe,"Header Signature: "),I.l+=16;var W=I.read_shift(2,"u");return[I.read_shift(2,"u"),W]}function g(I,W){var j=9;switch(I.l+=2,j=I.read_shift(2)){case 9:if(W!=3)throw new Error("Sector Shift: Expected 9 saw "+j);break;case 12:if(W!=4)throw new Error("Sector Shift: Expected 12 saw "+j);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+j)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function m(I,W){for(var j=Math.ceil(I.length/W)-1,V=[],G=1;G<j;++G)V[G-1]=I.slice(G*W,(G+1)*W);return V[j-1]=I.slice(j*W),V}function y(I,W,j){for(var V=0,G=0,Q=0,he=0,xe=0,fe=j.length,ue=[],pe=[];V<fe;++V)ue[V]=pe[V]=V,W[V]=j[V];for(;xe<pe.length;++xe)V=pe[xe],G=I[V].L,Q=I[V].R,he=I[V].C,ue[V]===V&&(G!==-1&&ue[G]!==G&&(ue[V]=ue[G]),Q!==-1&&ue[Q]!==Q&&(ue[V]=ue[Q])),he!==-1&&(ue[he]=V),G!==-1&&V!=ue[V]&&(ue[G]=ue[V],pe.lastIndexOf(G)<xe&&pe.push(G)),Q!==-1&&V!=ue[V]&&(ue[Q]=ue[V],pe.lastIndexOf(Q)<xe&&pe.push(Q));for(V=1;V<fe;++V)ue[V]===V&&(Q!==-1&&ue[Q]!==Q?ue[V]=ue[Q]:G!==-1&&ue[G]!==G&&(ue[V]=ue[G]));for(V=1;V<fe;++V)if(I[V].type!==0){if(xe=V,xe!=ue[xe])do xe=ue[xe],W[V]=W[xe]+"/"+W[V];while(xe!==0&&ue[xe]!==-1&&xe!=ue[xe]);ue[V]=-1}for(W[0]+="/",V=1;V<fe;++V)I[V].type!==2&&(W[V]+="/")}function x(I,W,j){for(var V=I.start,G=I.size,Q=[],he=V;j&&G>0&&he>=0;)Q.push(W.slice(he*O,he*O+O)),G-=O,he=Rl(j,he*4);return Q.length===0?_e(0):Vn(Q).slice(0,I.size)}function S(I,W,j,V,G){var Q=D;if(I===D){if(W!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var he=j[I],xe=(V>>>2)-1;if(!he)return;for(var fe=0;fe<xe&&(Q=Rl(he,fe*4))!==D;++fe)G.push(Q);S(Rl(he,V-4),W-1,j,V,G)}}function A(I,W,j,V,G){var Q=[],he=[];G||(G=[]);var xe=V-1,fe=0,ue=0;for(fe=W;fe>=0;){G[fe]=!0,Q[Q.length]=fe,he.push(I[fe]);var pe=j[Math.floor(fe*4/V)];if(ue=fe*4&xe,V<4+ue)throw new Error("FAT boundary crossed: "+fe+" 4 "+V);if(!I[pe])break;fe=Rl(I[pe],ue)}return{nodes:Q,data:o_([he])}}function C(I,W,j,V){var G=I.length,Q=[],he=[],xe=[],fe=[],ue=V-1,pe=0,we=0,We=0,Ue=0;for(pe=0;pe<G;++pe)if(xe=[],We=pe+W,We>=G&&(We-=G),!he[We]){fe=[];var Oe=[];for(we=We;we>=0;){Oe[we]=!0,he[we]=!0,xe[xe.length]=we,fe.push(I[we]);var He=j[Math.floor(we*4/V)];if(Ue=we*4&ue,V<4+Ue)throw new Error("FAT boundary crossed: "+we+" 4 "+V);if(!I[He]||(we=Rl(I[He],Ue),Oe[we]))break}Q[We]={nodes:xe,data:o_([fe])}}return Q}function E(I,W,j,V,G,Q,he,xe){for(var fe=0,ue=V.length?2:0,pe=W[I].data,we=0,We=0,Ue;we<pe.length;we+=128){var Oe=pe.slice(we,we+128);qn(Oe,64),We=Oe.read_shift(2),Ue=Q1(Oe,0,We-ue),V.push(Ue);var He={name:Ue,type:Oe.read_shift(1),color:Oe.read_shift(1),L:Oe.read_shift(4,"i"),R:Oe.read_shift(4,"i"),C:Oe.read_shift(4,"i"),clsid:Oe.read_shift(16),state:Oe.read_shift(4,"i"),start:0,size:0},at=Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2);at!==0&&(He.ct=M(Oe,Oe.l-8));var ur=Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2);ur!==0&&(He.mt=M(Oe,Oe.l-8)),He.start=Oe.read_shift(4,"i"),He.size=Oe.read_shift(4,"i"),He.size<0&&He.start<0&&(He.size=He.type=0,He.start=D,He.name=""),He.type===5?(fe=He.start,G>0&&fe!==D&&(W[fe].name="!StreamData")):He.size>=4096?(He.storage="fat",W[He.start]===void 0&&(W[He.start]=A(j,He.start,W.fat_addrs,W.ssz)),W[He.start].name=He.name,He.content=W[He.start].data.slice(0,He.size)):(He.storage="minifat",He.size<0?He.size=0:fe!==D&&He.start!==D&&W[fe]&&(He.content=x(He,W[fe].data,(W[xe]||{}).data))),He.content&&qn(He.content,0),Q[Ue]=He,he.push(He)}}function M(I,W){return new Date((as(I,W+4)/1e7*Math.pow(2,32)+as(I,W)/1e7-11644473600)*1e3)}function X(I,W){return u(),f(l.readFileSync(I),W)}function z(I,W){var j=W&&W.type;switch(j||Mt&&Buffer.isBuffer(I)&&(j="buffer"),j||"base64"){case"file":return X(I,W);case"base64":return f(os(hs(I)),W);case"binary":return f(os(I),W)}return f(I,W)}function T(I,W){var j=W||{},V=j.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=V+"/",I.FileIndex[0]={name:V,type:5}),j.CLSID&&(I.FileIndex[0].clsid=j.CLSID),F(I)}function F(I){var W="Sh33tJ5";if(!st.find(I,"/"+W)){var j=_e(4);j[0]=55,j[1]=j[3]=50,j[2]=54,I.FileIndex.push({name:W,type:2,content:j,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+W),w(I)}}function w(I,W){T(I);for(var j=!1,V=!1,G=I.FullPaths.length-1;G>=0;--G){var Q=I.FileIndex[G];switch(Q.type){case 0:V?j=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:V=!0,isNaN(Q.R*Q.L*Q.C)&&(j=!0),Q.R>-1&&Q.L>-1&&Q.R==Q.L&&(j=!0);break;default:j=!0;break}}if(!(!j&&!W)){var he=new Date(1987,1,19),xe=0,fe=Object.create?Object.create(null):{},ue=[];for(G=0;G<I.FullPaths.length;++G)fe[I.FullPaths[G]]=!0,I.FileIndex[G].type!==0&&ue.push([I.FullPaths[G],I.FileIndex[G]]);for(G=0;G<ue.length;++G){var pe=n(ue[G][0]);V=fe[pe],V||(ue.push([pe,{name:i(pe).replace("/",""),type:1,clsid:Pe,ct:he,mt:he,content:null}]),fe[pe]=!0)}for(ue.sort(function(Ue,Oe){return r(Ue[0],Oe[0])}),I.FullPaths=[],I.FileIndex=[],G=0;G<ue.length;++G)I.FullPaths[G]=ue[G][0],I.FileIndex[G]=ue[G][1];for(G=0;G<ue.length;++G){var we=I.FileIndex[G],We=I.FullPaths[G];if(we.name=i(We).replace("/",""),we.L=we.R=we.C=-(we.color=1),we.size=we.content?we.content.length:0,we.start=0,we.clsid=we.clsid||Pe,G===0)we.C=ue.length>1?1:-1,we.size=0,we.type=5;else if(We.slice(-1)=="/"){for(xe=G+1;xe<ue.length&&n(I.FullPaths[xe])!=We;++xe);for(we.C=xe>=ue.length?-1:xe,xe=G+1;xe<ue.length&&n(I.FullPaths[xe])!=n(We);++xe);we.R=xe>=ue.length?-1:xe,we.type=1}else n(I.FullPaths[G+1]||"")==n(We)&&(we.R=G+1),we.type=2}}}function R(I,W){var j=W||{};if(j.fileType=="mad")return Or(I,j);switch(w(I),j.fileType){case"zip":return Us(I,j)}var V=function(Ue){for(var Oe=0,He=0,at=0;at<Ue.FileIndex.length;++at){var ur=Ue.FileIndex[at];if(ur.content){var nr=ur.content.length;nr>0&&(nr<4096?Oe+=nr+63>>6:He+=nr+511>>9)}}for(var Yt=Ue.FullPaths.length+3>>2,wi=Oe+7>>3,La=Oe+127>>7,Qi=wi+He+Yt+La,ar=Qi+127>>7,ca=ar<=109?0:Math.ceil((ar-109)/127);Qi+ar+ca+127>>7>ar;)ca=++ar<=109?0:Math.ceil((ar-109)/127);var Sr=[1,ca,ar,La,Yt,He,Oe,0];return Ue.FileIndex[0].size=Oe<<6,Sr[7]=(Ue.FileIndex[0].start=Sr[0]+Sr[1]+Sr[2]+Sr[3]+Sr[4]+Sr[5])+(Sr[6]+7>>3),Sr}(I),G=_e(V[7]<<9),Q=0,he=0;{for(Q=0;Q<8;++Q)G.write_shift(1,Ee[Q]);for(Q=0;Q<8;++Q)G.write_shift(2,0);for(G.write_shift(2,62),G.write_shift(2,3),G.write_shift(2,65534),G.write_shift(2,9),G.write_shift(2,6),Q=0;Q<3;++Q)G.write_shift(2,0);for(G.write_shift(4,0),G.write_shift(4,V[2]),G.write_shift(4,V[0]+V[1]+V[2]+V[3]-1),G.write_shift(4,0),G.write_shift(4,4096),G.write_shift(4,V[3]?V[0]+V[1]+V[2]-1:D),G.write_shift(4,V[3]),G.write_shift(-4,V[1]?V[0]-1:D),G.write_shift(4,V[1]),Q=0;Q<109;++Q)G.write_shift(-4,Q<V[2]?V[1]+Q:-1)}if(V[1])for(he=0;he<V[1];++he){for(;Q<236+he*127;++Q)G.write_shift(-4,Q<V[2]?V[1]+Q:-1);G.write_shift(-4,he===V[1]-1?D:he+1)}var xe=function(Ue){for(he+=Ue;Q<he-1;++Q)G.write_shift(-4,Q+1);Ue&&(++Q,G.write_shift(-4,D))};for(he=Q=0,he+=V[1];Q<he;++Q)G.write_shift(-4,Fe.DIFSECT);for(he+=V[2];Q<he;++Q)G.write_shift(-4,Fe.FATSECT);xe(V[3]),xe(V[4]);for(var fe=0,ue=0,pe=I.FileIndex[0];fe<I.FileIndex.length;++fe)pe=I.FileIndex[fe],pe.content&&(ue=pe.content.length,!(ue<4096)&&(pe.start=he,xe(ue+511>>9)));for(xe(V[6]+7>>3);G.l&511;)G.write_shift(-4,Fe.ENDOFCHAIN);for(he=Q=0,fe=0;fe<I.FileIndex.length;++fe)pe=I.FileIndex[fe],pe.content&&(ue=pe.content.length,!(!ue||ue>=4096)&&(pe.start=he,xe(ue+63>>6)));for(;G.l&511;)G.write_shift(-4,Fe.ENDOFCHAIN);for(Q=0;Q<V[4]<<2;++Q){var we=I.FullPaths[Q];if(!we||we.length===0){for(fe=0;fe<17;++fe)G.write_shift(4,0);for(fe=0;fe<3;++fe)G.write_shift(4,-1);for(fe=0;fe<12;++fe)G.write_shift(4,0);continue}pe=I.FileIndex[Q],Q===0&&(pe.start=pe.size?pe.start-1:D);var We=Q===0&&j.root||pe.name;if(ue=2*(We.length+1),G.write_shift(64,We,"utf16le"),G.write_shift(2,ue),G.write_shift(1,pe.type),G.write_shift(1,pe.color),G.write_shift(-4,pe.L),G.write_shift(-4,pe.R),G.write_shift(-4,pe.C),pe.clsid)G.write_shift(16,pe.clsid,"hex");else for(fe=0;fe<4;++fe)G.write_shift(4,0);G.write_shift(4,pe.state||0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,pe.start),G.write_shift(4,pe.size),G.write_shift(4,0)}for(Q=1;Q<I.FileIndex.length;++Q)if(pe=I.FileIndex[Q],pe.size>=4096)if(G.l=pe.start+1<<9,Mt&&Buffer.isBuffer(pe.content))pe.content.copy(G,G.l,0,pe.size),G.l+=pe.size+511&-512;else{for(fe=0;fe<pe.size;++fe)G.write_shift(1,pe.content[fe]);for(;fe&511;++fe)G.write_shift(1,0)}for(Q=1;Q<I.FileIndex.length;++Q)if(pe=I.FileIndex[Q],pe.size>0&&pe.size<4096)if(Mt&&Buffer.isBuffer(pe.content))pe.content.copy(G,G.l,0,pe.size),G.l+=pe.size+63&-64;else{for(fe=0;fe<pe.size;++fe)G.write_shift(1,pe.content[fe]);for(;fe&63;++fe)G.write_shift(1,0)}if(Mt)G.l=G.length;else for(;G.l<G.length;)G.write_shift(1,0);return G}function P(I,W){var j=I.FullPaths.map(function(fe){return fe.toUpperCase()}),V=j.map(function(fe){var ue=fe.split("/");return ue[ue.length-(fe.slice(-1)=="/"?2:1)]}),G=!1;W.charCodeAt(0)===47?(G=!0,W=j[0].slice(0,-1)+W):G=W.indexOf("/")!==-1;var Q=W.toUpperCase(),he=G===!0?j.indexOf(Q):V.indexOf(Q);if(he!==-1)return I.FileIndex[he];var xe=!Q.match(Sd);for(Q=Q.replace(Ni,""),xe&&(Q=Q.replace(Sd,"!")),he=0;he<j.length;++he)if((xe?j[he].replace(Sd,"!"):j[he]).replace(Ni,"")==Q||(xe?V[he].replace(Sd,"!"):V[he]).replace(Ni,"")==Q)return I.FileIndex[he];return null}var O=64,D=-2,qe="d0cf11e0a1b11ae1",Ee=[208,207,17,224,161,177,26,225],Pe="00000000000000000000000000000000",Fe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:D,FREESECT:-1,HEADER_SIGNATURE:qe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Pe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ae(I,W,j){u();var V=R(I,j);l.writeFileSync(W,V)}function ne(I){for(var W=new Array(I.length),j=0;j<I.length;++j)W[j]=String.fromCharCode(I[j]);return W.join("")}function be(I,W){var j=R(I,W);switch(W&&W.type||"buffer"){case"file":return u(),l.writeFileSync(W.filename,j),j;case"binary":return typeof j=="string"?j:ne(j);case"base64":return gf(typeof j=="string"?j:ne(j));case"buffer":if(Mt)return Buffer.isBuffer(j)?j:ho(j);case"array":return typeof j=="string"?os(j):j}return j}var je;function H(I){try{var W=I.InflateRaw,j=new W;if(j._processChunk(new Uint8Array([3,0]),j._finishFlushFlag),j.bytesRead)je=I;else throw new Error("zlib does not expose bytesRead")}catch(V){console.error("cannot use native zlib: "+(V.message||V))}}function te(I,W){if(!je)return ms(I,W);var j=je.InflateRaw,V=new j,G=V._processChunk(I.slice(I.l),V._finishFlushFlag);return I.l+=V.bytesRead,G}function re(I){return je?je.deflateRawSync(I):mt(I)}var Y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ye=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Te=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ve(I){var W=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(W>>16|W>>8|W)&255}for(var De=typeof Uint8Array<"u",Ne=De?new Uint8Array(256):[],it=0;it<256;++it)Ne[it]=Ve(it);function Z(I,W){var j=Ne[I&255];return W<=8?j>>>8-W:(j=j<<8|Ne[I>>8&255],W<=16?j>>>16-W:(j=j<<8|Ne[I>>16&255],j>>>24-W))}function Rt(I,W){var j=W&7,V=W>>>3;return(I[V]|(j<=6?0:I[V+1]<<8))>>>j&3}function Et(I,W){var j=W&7,V=W>>>3;return(I[V]|(j<=5?0:I[V+1]<<8))>>>j&7}function Dt(I,W){var j=W&7,V=W>>>3;return(I[V]|(j<=4?0:I[V+1]<<8))>>>j&15}function yt(I,W){var j=W&7,V=W>>>3;return(I[V]|(j<=3?0:I[V+1]<<8))>>>j&31}function Xe(I,W){var j=W&7,V=W>>>3;return(I[V]|(j<=1?0:I[V+1]<<8))>>>j&127}function xr(I,W,j){var V=W&7,G=W>>>3,Q=(1<<j)-1,he=I[G]>>>V;return j<8-V||(he|=I[G+1]<<8-V,j<16-V)||(he|=I[G+2]<<16-V,j<24-V)||(he|=I[G+3]<<24-V),he&Q}function Xr(I,W,j){var V=W&7,G=W>>>3;return V<=5?I[G]|=(j&7)<<V:(I[G]|=j<<V&255,I[G+1]=(j&7)>>8-V),W+3}function _n(I,W,j){var V=W&7,G=W>>>3;return j=(j&1)<<V,I[G]|=j,W+1}function Pi(I,W,j){var V=W&7,G=W>>>3;return j<<=V,I[G]|=j&255,j>>>=8,I[G+1]=j,W+8}function Oi(I,W,j){var V=W&7,G=W>>>3;return j<<=V,I[G]|=j&255,j>>>=8,I[G+1]=j&255,I[G+2]=j>>>8,W+16}function Mi(I,W){var j=I.length,V=2*j>W?2*j:W+5,G=0;if(j>=W)return I;if(Mt){var Q=z2(V);if(I.copy)I.copy(Q);else for(;G<I.length;++G)Q[G]=I[G];return Q}else if(De){var he=new Uint8Array(V);if(he.set)he.set(I);else for(;G<j;++G)he[G]=I[G];return he}return I.length=V,I}function jr(I){for(var W=new Array(I),j=0;j<I;++j)W[j]=0;return W}function Bi(I,W,j){var V=1,G=0,Q=0,he=0,xe=0,fe=I.length,ue=De?new Uint16Array(32):jr(32);for(Q=0;Q<32;++Q)ue[Q]=0;for(Q=fe;Q<j;++Q)I[Q]=0;fe=I.length;var pe=De?new Uint16Array(fe):jr(fe);for(Q=0;Q<fe;++Q)ue[G=I[Q]]++,V<G&&(V=G),pe[Q]=0;for(ue[0]=0,Q=1;Q<=V;++Q)ue[Q+16]=xe=xe+ue[Q-1]<<1;for(Q=0;Q<fe;++Q)xe=I[Q],xe!=0&&(pe[Q]=ue[xe+16]++);var we=0;for(Q=0;Q<fe;++Q)if(we=I[Q],we!=0)for(xe=Z(pe[Q],V)>>V-we,he=(1<<V+4-we)-1;he>=0;--he)W[xe|he<<we]=we&15|Q<<4;return V}var cr=De?new Uint16Array(512):jr(512),Lr=De?new Uint16Array(32):jr(32);if(!De){for(var Tr=0;Tr<512;++Tr)cr[Tr]=0;for(Tr=0;Tr<32;++Tr)Lr[Tr]=0}(function(){for(var I=[],W=0;W<32;W++)I.push(5);Bi(I,Lr,32);var j=[];for(W=0;W<=143;W++)j.push(8);for(;W<=255;W++)j.push(9);for(;W<=279;W++)j.push(7);for(;W<=287;W++)j.push(8);Bi(j,cr,288)})();var Ei=function(){for(var W=De?new Uint8Array(32768):[],j=0,V=0;j<Te.length-1;++j)for(;V<Te[j+1];++V)W[V]=j;for(;V<32768;++V)W[V]=29;var G=De?new Uint8Array(259):[];for(j=0,V=0;j<ye.length-1;++j)for(;V<ye[j+1];++V)G[V]=j;function Q(xe,fe){for(var ue=0;ue<xe.length;){var pe=Math.min(65535,xe.length-ue),we=ue+pe==xe.length;for(fe.write_shift(1,+we),fe.write_shift(2,pe),fe.write_shift(2,~pe&65535);pe-- >0;)fe[fe.l++]=xe[ue++]}return fe.l}function he(xe,fe){for(var ue=0,pe=0,we=De?new Uint16Array(32768):[];pe<xe.length;){var We=Math.min(65535,xe.length-pe);if(We<10){for(ue=Xr(fe,ue,+(pe+We==xe.length)),ue&7&&(ue+=8-(ue&7)),fe.l=ue/8|0,fe.write_shift(2,We),fe.write_shift(2,~We&65535);We-- >0;)fe[fe.l++]=xe[pe++];ue=fe.l*8;continue}ue=Xr(fe,ue,+(pe+We==xe.length)+2);for(var Ue=0;We-- >0;){var Oe=xe[pe];Ue=(Ue<<5^Oe)&32767;var He=-1,at=0;if((He=we[Ue])&&(He|=pe&-32768,He>pe&&(He-=32768),He<pe))for(;xe[He+at]==xe[pe+at]&&at<250;)++at;if(at>2){Oe=G[at],Oe<=22?ue=Pi(fe,ue,Ne[Oe+1]>>1)-1:(Pi(fe,ue,3),ue+=5,Pi(fe,ue,Ne[Oe-23]>>5),ue+=3);var ur=Oe<8?0:Oe-4>>2;ur>0&&(Oi(fe,ue,at-ye[Oe]),ue+=ur),Oe=W[pe-He],ue=Pi(fe,ue,Ne[Oe]>>3),ue-=3;var nr=Oe<4?0:Oe-2>>1;nr>0&&(Oi(fe,ue,pe-He-Te[Oe]),ue+=nr);for(var Yt=0;Yt<at;++Yt)we[Ue]=pe&32767,Ue=(Ue<<5^xe[pe])&32767,++pe;We-=at-1}else Oe<=143?Oe=Oe+48:ue=_n(fe,ue,1),ue=Pi(fe,ue,Ne[Oe]),we[Ue]=pe&32767,++pe}ue=Pi(fe,ue,0)-1}return fe.l=(ue+7)/8|0,fe.l}return function(fe,ue){return fe.length<8?Q(fe,ue):he(fe,ue)}}();function mt(I){var W=_e(50+Math.floor(I.length*1.1)),j=Ei(I,W);return W.slice(0,j)}var Ar=De?new Uint16Array(32768):jr(32768),Dr=De?new Uint16Array(32768):jr(32768),Pr=De?new Uint16Array(128):jr(128),Rn=1,xo=1;function vo(I,W){var j=yt(I,W)+257;W+=5;var V=yt(I,W)+1;W+=5;var G=Dt(I,W)+4;W+=4;for(var Q=0,he=De?new Uint8Array(19):jr(19),xe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],fe=1,ue=De?new Uint8Array(8):jr(8),pe=De?new Uint8Array(8):jr(8),we=he.length,We=0;We<G;++We)he[Y[We]]=Q=Et(I,W),fe<Q&&(fe=Q),ue[Q]++,W+=3;var Ue=0;for(ue[0]=0,We=1;We<=fe;++We)pe[We]=Ue=Ue+ue[We-1]<<1;for(We=0;We<we;++We)(Ue=he[We])!=0&&(xe[We]=pe[Ue]++);var Oe=0;for(We=0;We<we;++We)if(Oe=he[We],Oe!=0){Ue=Ne[xe[We]]>>8-Oe;for(var He=(1<<7-Oe)-1;He>=0;--He)Pr[Ue|He<<Oe]=Oe&7|We<<3}var at=[];for(fe=1;at.length<j+V;)switch(Ue=Pr[Xe(I,W)],W+=Ue&7,Ue>>>=3){case 16:for(Q=3+Rt(I,W),W+=2,Ue=at[at.length-1];Q-- >0;)at.push(Ue);break;case 17:for(Q=3+Et(I,W),W+=3;Q-- >0;)at.push(0);break;case 18:for(Q=11+Xe(I,W),W+=7;Q-- >0;)at.push(0);break;default:at.push(Ue),fe<Ue&&(fe=Ue);break}var ur=at.slice(0,j),nr=at.slice(j);for(We=j;We<286;++We)ur[We]=0;for(We=V;We<30;++We)nr[We]=0;return Rn=Bi(ur,Ar,286),xo=Bi(nr,Dr,30),W}function $u(I,W){if(I[0]==3&&!(I[1]&3))return[dl(W),2];for(var j=0,V=0,G=z2(W||1<<18),Q=0,he=G.length>>>0,xe=0,fe=0;!(V&1);){if(V=Et(I,j),j+=3,V>>>1)V>>1==1?(xe=9,fe=5):(j=vo(I,j),xe=Rn,fe=xo);else{j&7&&(j+=8-(j&7));var ue=I[j>>>3]|I[(j>>>3)+1]<<8;if(j+=32,ue>0)for(!W&&he<Q+ue&&(G=Mi(G,Q+ue),he=G.length);ue-- >0;)G[Q++]=I[j>>>3],j+=8;continue}for(;;){!W&&he<Q+32767&&(G=Mi(G,Q+32767),he=G.length);var pe=xr(I,j,xe),we=V>>>1==1?cr[pe]:Ar[pe];if(j+=we&15,we>>>=4,!(we>>>8&255))G[Q++]=we;else{if(we==256)break;we-=257;var We=we<8?0:we-4>>2;We>5&&(We=0);var Ue=Q+ye[we];We>0&&(Ue+=xr(I,j,We),j+=We),pe=xr(I,j,fe),we=V>>>1==1?Lr[pe]:Dr[pe],j+=we&15,we>>>=4;var Oe=we<4?0:we-2>>1,He=Te[we];for(Oe>0&&(He+=xr(I,j,Oe),j+=Oe),!W&&he<Ue&&(G=Mi(G,Ue+100),he=G.length);Q<Ue;)G[Q]=G[Q-He],++Q}}}return W?[G,j+7>>>3]:[G.slice(0,Q),j+7>>>3]}function ms(I,W){var j=I.slice(I.l||0),V=$u(j,W);return I.l+=V[1],V[0]}function Tl(I,W){if(I)typeof console<"u"&&console.error(W);else throw new Error(W)}function aa(I,W){var j=I;qn(j,0);var V=[],G=[],Q={FileIndex:V,FullPaths:G};T(Q,{root:W.root});for(var he=j.length-4;(j[he]!=80||j[he+1]!=75||j[he+2]!=5||j[he+3]!=6)&&he>=0;)--he;j.l=he+4,j.l+=4;var xe=j.read_shift(2);j.l+=6;var fe=j.read_shift(4);for(j.l=fe,he=0;he<xe;++he){j.l+=20;var ue=j.read_shift(4),pe=j.read_shift(4),we=j.read_shift(2),We=j.read_shift(2),Ue=j.read_shift(2);j.l+=8;var Oe=j.read_shift(4),He=o(j.slice(j.l+we,j.l+we+We));j.l+=we+We+Ue;var at=j.l;j.l=Oe+4,Ma(j,ue,pe,Q,He),j.l=at}return Q}function Ma(I,W,j,V,G){I.l+=2;var Q=I.read_shift(2),he=I.read_shift(2),xe=a(I);if(Q&8257)throw new Error("Unsupported ZIP encryption");for(var fe=I.read_shift(4),ue=I.read_shift(4),pe=I.read_shift(4),we=I.read_shift(2),We=I.read_shift(2),Ue="",Oe=0;Oe<we;++Oe)Ue+=String.fromCharCode(I[I.l++]);if(We){var He=o(I.slice(I.l,I.l+We));(He[21589]||{}).mt&&(xe=He[21589].mt),((G||{})[21589]||{}).mt&&(xe=G[21589].mt)}I.l+=We;var at=I.slice(I.l,I.l+ue);switch(he){case 8:at=te(I,pe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+he)}var ur=!1;Q&8&&(fe=I.read_shift(4),fe==134695760&&(fe=I.read_shift(4),ur=!0),ue=I.read_shift(4),pe=I.read_shift(4)),ue!=W&&Tl(ur,"Bad compressed size: "+W+" != "+ue),pe!=j&&Tl(ur,"Bad uncompressed size: "+j+" != "+pe),vs(V,Ue,at,{unsafe:!0,mt:xe})}function Us(I,W){var j=W||{},V=[],G=[],Q=_e(1),he=j.compression?8:0,xe=0,fe=0,ue=0,pe=0,we=0,We=I.FullPaths[0],Ue=We,Oe=I.FileIndex[0],He=[],at=0;for(fe=1;fe<I.FullPaths.length;++fe)if(Ue=I.FullPaths[fe].slice(We.length),Oe=I.FileIndex[fe],!(!Oe.size||!Oe.content||Ue=="Sh33tJ5")){var ur=pe,nr=_e(Ue.length);for(ue=0;ue<Ue.length;++ue)nr.write_shift(1,Ue.charCodeAt(ue)&127);nr=nr.slice(0,nr.l),He[we]=lR.buf(Oe.content,0);var Yt=Oe.content;he==8&&(Yt=re(Yt)),Q=_e(30),Q.write_shift(4,67324752),Q.write_shift(2,20),Q.write_shift(2,xe),Q.write_shift(2,he),Oe.mt?s(Q,Oe.mt):Q.write_shift(4,0),Q.write_shift(-4,He[we]),Q.write_shift(4,Yt.length),Q.write_shift(4,Oe.content.length),Q.write_shift(2,nr.length),Q.write_shift(2,0),pe+=Q.length,V.push(Q),pe+=nr.length,V.push(nr),pe+=Yt.length,V.push(Yt),Q=_e(46),Q.write_shift(4,33639248),Q.write_shift(2,0),Q.write_shift(2,20),Q.write_shift(2,xe),Q.write_shift(2,he),Q.write_shift(4,0),Q.write_shift(-4,He[we]),Q.write_shift(4,Yt.length),Q.write_shift(4,Oe.content.length),Q.write_shift(2,nr.length),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(4,0),Q.write_shift(4,ur),at+=Q.l,G.push(Q),at+=nr.length,G.push(nr),++we}return Q=_e(22),Q.write_shift(4,101010256),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,we),Q.write_shift(2,we),Q.write_shift(4,at),Q.write_shift(4,pe),Q.write_shift(2,0),Vn([Vn(V),Vn(G),Q])}var le={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function rr(I,W){if(I.ctype)return I.ctype;var j=I.name||"",V=j.match(/\.([^\.]+)$/);return V&&le[V[1]]||W&&(V=(j=W).match(/[\.\\]([^\.\\])+$/),V&&le[V[1]])?le[V[1]]:"application/octet-stream"}function oa(I){for(var W=gf(I),j=[],V=0;V<W.length;V+=76)j.push(W.slice(V,V+76));return j.join(`\r
`)+`\r
`}function Ba(I){var W=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ue){var pe=ue.charCodeAt(0).toString(16).toUpperCase();return"="+(pe.length==1?"0"+pe:pe)});W=W.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),W.charAt(0)==`
`&&(W="=0D"+W.slice(1)),W=W.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var j=[],V=W.split(`\r
`),G=0;G<V.length;++G){var Q=V[G];if(Q.length==0){j.push("");continue}for(var he=0;he<Q.length;){var xe=76,fe=Q.slice(he,he+xe);fe.charAt(xe-1)=="="?xe--:fe.charAt(xe-2)=="="?xe-=2:fe.charAt(xe-3)=="="&&(xe-=3),fe=Q.slice(he,he+xe),he+=xe,he<Q.length&&(fe+="="),j.push(fe)}}return j.join(`\r
`)}function ja(I){for(var W=[],j=0;j<I.length;++j){for(var V=I[j];j<=I.length&&V.charAt(V.length-1)=="=";)V=V.slice(0,V.length-1)+I[++j];W.push(V)}for(var G=0;G<W.length;++G)W[G]=W[G].replace(/[=][0-9A-Fa-f]{2}/g,function(Q){return String.fromCharCode(parseInt(Q.slice(1),16))});return os(W.join(`\r
`))}function xs(I,W,j){for(var V="",G="",Q="",he,xe=0;xe<10;++xe){var fe=W[xe];if(!fe||fe.match(/^\s*$/))break;var ue=fe.match(/^(.*?):\s*([^\s].*)$/);if(ue)switch(ue[1].toLowerCase()){case"content-location":V=ue[2].trim();break;case"content-type":Q=ue[2].trim();break;case"content-transfer-encoding":G=ue[2].trim();break}}switch(++xe,G.toLowerCase()){case"base64":he=os(hs(W.slice(xe).join("")));break;case"quoted-printable":he=ja(W.slice(xe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+G)}var pe=vs(I,V.slice(j.length),he,{unsafe:!0});Q&&(pe.ctype=Q)}function la(I,W){if(ne(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var j=W&&W.root||"",V=(Mt&&Buffer.isBuffer(I)?I.toString("binary"):ne(I)).split(`\r
`),G=0,Q="";for(G=0;G<V.length;++G)if(Q=V[G],!!/^Content-Location:/i.test(Q)&&(Q=Q.slice(Q.indexOf("file")),j||(j=Q.slice(0,Q.lastIndexOf("/")+1)),Q.slice(0,j.length)!=j))for(;j.length>0&&(j=j.slice(0,j.length-1),j=j.slice(0,j.lastIndexOf("/")+1),Q.slice(0,j.length)!=j););var he=(V[1]||"").match(/boundary="(.*?)"/);if(!he)throw new Error("MAD cannot find boundary");var xe="--"+(he[1]||""),fe=[],ue=[],pe={FileIndex:fe,FullPaths:ue};T(pe);var we,We=0;for(G=0;G<V.length;++G){var Ue=V[G];Ue!==xe&&Ue!==xe+"--"||(We++&&xs(pe,V.slice(we,G),j),we=G)}return pe}function Or(I,W){var j=W||{},V=j.boundary||"SheetJS";V="------="+V;for(var G=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+V.slice(2)+'"',"","",""],Q=I.FullPaths[0],he=Q,xe=I.FileIndex[0],fe=1;fe<I.FullPaths.length;++fe)if(he=I.FullPaths[fe].slice(Q.length),xe=I.FileIndex[fe],!(!xe.size||!xe.content||he=="Sh33tJ5")){he=he.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(at){return"_x"+at.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(at){return"_u"+at.charCodeAt(0).toString(16)+"_"});for(var ue=xe.content,pe=Mt&&Buffer.isBuffer(ue)?ue.toString("binary"):ne(ue),we=0,We=Math.min(1024,pe.length),Ue=0,Oe=0;Oe<=We;++Oe)(Ue=pe.charCodeAt(Oe))>=32&&Ue<128&&++we;var He=we>=We*4/5;G.push(V),G.push("Content-Location: "+(j.root||"file:///C:/SheetJS/")+he),G.push("Content-Transfer-Encoding: "+(He?"quoted-printable":"base64")),G.push("Content-Type: "+rr(xe,he)),G.push(""),G.push(He?Ba(pe):oa(pe))}return G.push(V+`--\r
`),G.join(`\r
`)}function En(I){var W={};return T(W,I),W}function vs(I,W,j,V){var G=V&&V.unsafe;G||T(I);var Q=!G&&st.find(I,W);if(!Q){var he=I.FullPaths[0];W.slice(0,he.length)==he?he=W:(he.slice(-1)!="/"&&(he+="/"),he=(he+W).replace("//","/")),Q={name:i(W),type:2},I.FileIndex.push(Q),I.FullPaths.push(he),G||st.utils.cfb_gc(I)}return Q.content=j,Q.size=j?j.length:0,V&&(V.CLSID&&(Q.clsid=V.CLSID),V.mt&&(Q.mt=V.mt),V.ct&&(Q.ct=V.ct)),Q}function ys(I,W){T(I);var j=st.find(I,W);if(j){for(var V=0;V<I.FileIndex.length;++V)if(I.FileIndex[V]==j)return I.FileIndex.splice(V,1),I.FullPaths.splice(V,1),!0}return!1}function Gu(I,W,j){T(I);var V=st.find(I,W);if(V){for(var G=0;G<I.FileIndex.length;++G)if(I.FileIndex[G]==V)return I.FileIndex[G].name=i(j),I.FullPaths[G]=j,!0}return!1}function Si(I){w(I,!0)}return e.find=P,e.read=z,e.parse=f,e.write=be,e.writeFile=Ae,e.utils={cfb_new:En,cfb_add:vs,cfb_del:ys,cfb_mov:Gu,cfb_gc:Si,ReadShift:Bd,CheckField:uA,prep_blob:qn,bconcat:Vn,use_zlib:H,_deflateRaw:mt,_inflateRaw:ms,consts:Fe},e}();function cR(t){return typeof t=="string"?Vp(t):Array.isArray(t)?ON(t):t}function Wf(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Vp(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Aa(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([cR(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=El(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function uR(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function en(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function q2(t,e){for(var r=[],n=en(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function Wp(t){for(var e=[],r=en(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Hp(t){for(var e=[],r=en(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function dR(t){for(var e=[],r=en(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Zh=new Date(1899,11,30,0,0,0);function Nn(t,e){var r=t.getTime(),n=Zh.getTime()+(t.getTimezoneOffset()-Zh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var WT=new Date,fR=Zh.getTime()+(WT.getTimezoneOffset()-Zh.getTimezoneOffset())*6e4,Q2=WT.getTimezoneOffset();function $p(t){var e=new Date;return e.setTime(t*24*60*60*1e3+fR),e.getTimezoneOffset()!==Q2&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Q2)*6e4),e}function hR(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[s],10)}return e}var J2=new Date("2017-02-19T19:06:09.000Z"),HT=isNaN(J2.getFullYear())?new Date("2/19/17"):J2,pR=HT.getFullYear()==2017;function Nr(t,e){var r=new Date(t);if(pR)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(HT.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Zl(t,e){if(Mt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Aa(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Aa(NT(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Aa(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Aa(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function Rr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Rr(t[r]));return e}function Qr(t,e){for(var r="";r.length<e;)r+=t;return r}function ra(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var gR=["january","february","march","april","may","june","july","august","september","october","november","december"];function _u(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&gR.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var mR=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function $T(t){return t?t.content&&t.type?Zl(t.content,!0):t.data?Ed(t.data):t.asNodeBuffer&&Mt?Ed(t.asNodeBuffer().toString("binary")):t.asBinary?Ed(t.asBinary()):t._data&&t._data.getContent?Ed(Zl(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function GT(t){if(!t)return null;if(t.data)return U2(t.data);if(t.asNodeBuffer&&Mt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?U2(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function xR(t){return t&&t.name.slice(-4)===".bin"?GT(t):$T(t)}function Fs(t,e){for(var r=t.FullPaths||en(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function $1(t,e){var r=Fs(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function xn(t,e,r){if(!r)return xR($1(t,e));if(!e)return null;try{return xn(t,e)}catch{return null}}function ls(t,e,r){if(!r)return $T($1(t,e));if(!e)return null;try{return ls(t,e)}catch{return null}}function vR(t,e,r){return GT($1(t,e))}function Z2(t){for(var e=t.FullPaths||en(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function It(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Mt?n=ho(r):n=MN(r),st.utils.cfb_add(t,e,n)}st.utils.cfb_add(t,e,r)}else t.file(e,r)}function G1(){return st.utils.cfb_new()}function KT(t,e){switch(e.type){case"base64":return st.read(t,{type:"base64"});case"binary":return st.read(t,{type:"binary"});case"buffer":case"array":return st.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function wd(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var dn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,yR=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,e_=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,_R=/<[^>]*>/g,_i=dn.match(e_)?e_:_R,ER=/<\w*:/,SR=/<(\/?)\w+:/;function pt(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var a=t.match(yR),o=0,l="",u=0,f="",p="",g=1;if(a)for(u=0;u!=a.length;++u){for(p=a[u],s=0;s!=p.length&&p.charCodeAt(s)!==61;++s);for(f=p.slice(0,s).trim();p.charCodeAt(s+1)==32;)++s;for(g=(i=p.charCodeAt(s+1))==34||i==39?1:0,l=p.slice(s+1+g,p.length-g),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,n[f.toLowerCase()]=l;else{var m=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[m]&&f.slice(o-3,o)=="ext")continue;n[m]=l,n[m.toLowerCase()]=l}}return n}function Pa(t){return t.replace(SR,"<$1")}var YT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},K1=Wp(YT),er=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(o,l){return YT[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),Y1=/[&<>'"]/g,wR=/[\u0000-\u0008\u000b-\u001f]/g;function pr(t){var e=t+"";return e.replace(Y1,function(r){return K1[r]}).replace(wR,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function t_(t){return pr(t).replace(/ /g,"_x0020_")}var XT=/[\u0000-\u001f]/g;function X1(t){var e=t+"";return e.replace(Y1,function(r){return K1[r]}).replace(/\n/g,"<br/>").replace(XT,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function TR(t){var e=t+"";return e.replace(Y1,function(r){return K1[r]}).replace(XT,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var r_=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function AR(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function br(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Wg(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function n_(t){var e=dl(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function i_(t){return ho(t,"binary").toString("utf8")}var O0="foo bar baz",vr=Mt&&(i_(O0)==Wg(O0)&&i_||n_(O0)==Wg(O0)&&n_)||Wg,Aa=Mt?function(t){return ho(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},xf=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),qT=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),CR=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),kR=/<\/?(?:vt:)?variant>/g,FR=/<(?:vt:)([^>]*)>([\s\S]*)</;function s_(t,e){var r=pt(t),n=t.match(CR(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(kR,"").match(FR);a&&i.push({v:vr(a[2]),t:a[1]})}),i}var QT=/(^\s|\s$|\n)/;function Qn(t,e){return"<"+t+(e.match(QT)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function vf(t){return en(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Ge(t,e,r){return"<"+t+(r!=null?vf(r):"")+(e!=null?(e.match(QT)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function dx(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function bR(t,e){switch(typeof t){case"string":var r=Ge("vt:lpwstr",pr(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ge((t|0)==t?"vt:i4":"vt:r8",pr(String(t)));case"boolean":return Ge("vt:bool",t?"true":"false")}if(t instanceof Date)return Ge("vt:filetime",dx(t));throw new Error("Unable to serialize "+t)}function q1(t){if(Mt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return vr(El(z1(t)));throw new Error("Bad input format: expected Buffer or string")}var yf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,kn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},dc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ss={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function IR(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function NR(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var a_=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},o_=Mt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:ho(e)})):a_(t)}:a_,l_=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Ga(t,i)));return n.join("").replace(Ni,"")},Q1=Mt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Ni,""):l_(t,e,r)}:l_,c_=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},JT=Mt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):c_(t,e,r)}:c_,u_=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(Oc(t,i)));return n.join("")},Hf=Mt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):u_(e,r,n)}:u_,ZT=function(t,e){var r=as(t,e);return r>0?Hf(t,e+4,e+4+r-1):""},eA=ZT,tA=function(t,e){var r=as(t,e);return r>0?Hf(t,e+4,e+4+r-1):""},rA=tA,nA=function(t,e){var r=2*as(t,e);return r>0?Hf(t,e+4,e+4+r-1):""},iA=nA,sA=function(e,r){var n=as(e,r);return n>0?Q1(e,r+4,r+4+n):""},aA=sA,oA=function(t,e){var r=as(t,e);return r>0?Hf(t,e+4,e+4+r):""},lA=oA,cA=function(t,e){return IR(t,e)},ep=cA,J1=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Mt&&(eA=function(e,r){if(!Buffer.isBuffer(e))return ZT(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},rA=function(e,r){if(!Buffer.isBuffer(e))return tA(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},iA=function(e,r){if(!Buffer.isBuffer(e))return nA(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},aA=function(e,r){if(!Buffer.isBuffer(e))return sA(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},lA=function(e,r){if(!Buffer.isBuffer(e))return oA(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},ep=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):cA(e,r)},J1=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Oc=function(t,e){return t[e]},Ga=function(t,e){return t[e+1]*256+t[e]},RR=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},as=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Rl=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},DR=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Bd(t,e){var r="",n,i,s=[],a,o,l,u;switch(e){case"dbcs":if(u=this.l,Mt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(Ga(this,u)),u+=2;t*=2;break;case"utf8":r=Hf(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Q1(this,this.l,this.l+t);break;case"wstr":return Bd.call(this,t,"dbcs");case"lpstr-ansi":r=eA(this,this.l),t=4+as(this,this.l);break;case"lpstr-cp":r=rA(this,this.l),t=4+as(this,this.l);break;case"lpwstr":r=iA(this,this.l),t=4+2*as(this,this.l);break;case"lpp4":t=4+as(this,this.l),r=aA(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+as(this,this.l),r=lA(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=Oc(this,this.l+t++))!==0;)s.push(P0(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=Ga(this,this.l+t))!==0;)s.push(P0(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Oc(this,u),this.l=u+1,o=Bd.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(P0(Ga(this,u))),u+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Oc(this,u),this.l=u+1,o=Bd.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(P0(Oc(this,u))),u+=1}r=s.join("");break;default:switch(t){case 1:return n=Oc(this,this.l),this.l++,n;case 2:return n=(e==="i"?RR:Ga)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Rl:DR)(this,this.l),this.l+=4,n):(i=as(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=ep(this,this.l):i=ep([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=JT(this,this.l,t);break}}return this.l+=t,r}var PR=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},OR=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},MR=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function BR(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)MR(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,PR(this,e,this.l);break;case 8:if(n=8,r==="f"){NR(this,e,this.l);break}case 16:break;case-4:n=4,OR(this,e,this.l);break}return this.l+=n,this}function uA(t,e){var r=JT(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function qn(t,e){t.l=e,t.read_shift=Bd,t.chk=uA,t.write_shift=BR}function vi(t,e){t.l+=e}function _e(t){var e=dl(t);return qn(e,0),e}function po(t,e,r){if(t){var n,i,s;qn(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var u=Af[o]||Af[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;l=t.l+s;var f=u.f&&u.f(t,s,r);if(t.l=l,e(f,u,o))return}}}function Xi(){var t=[],e=Mt?256:2048,r=function(u){var f=_e(u);return qn(f,0),f},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,e)))},a=function(){return i(),Vn(t)},o=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function ke(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=Af[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&J1(r)&&t.push(r)}}function jd(t,e,r){var n=Rr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function d_(t,e,r){var n=Rr(t);return n.s=jd(n.s,e.s,r),n.e=jd(n.e,e.s,r),n}function Ld(t,e){if(t.cRel&&t.c<0)for(t=Rr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Rr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=ht(t);return!t.cRel&&t.cRel!=null&&(r=UR(r)),!t.rRel&&t.rRel!=null&&(r=jR(r)),r}function Hg(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Hr(t.s.c)+":"+(t.e.cRel?"":"$")+Hr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+un(t.s.r)+":"+(t.e.rRel?"":"$")+un(t.e.r):Ld(t.s,e.biff)+":"+Ld(t.e,e.biff)}function Z1(t){return parseInt(LR(t),10)-1}function un(t){return""+(t+1)}function jR(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function LR(t){return t.replace(/\$(\d+)$/,"$1")}function ev(t){for(var e=VR(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Hr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function UR(t){return t.replace(/^([A-Z])/,"$$$1")}function VR(t){return t.replace(/^\$([A-Z])/,"$1")}function zR(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function $r(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function ht(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function qi(t){var e=t.indexOf(":");return e==-1?{s:$r(t),e:$r(t)}:{s:$r(t.slice(0,e)),e:$r(t.slice(e+1))}}function bt(t,e){return typeof e>"u"||typeof e=="number"?bt(t.s,t.e):(typeof t!="string"&&(t=ht(t)),typeof e!="string"&&(e=ht(e)),t==e?t:t+":"+e)}function tr(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function f_(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=js(t.z,r?Nn(e):e)}catch{}try{return t.w=js((t.XF||{}).numFmtId||(r?14:0),r?Nn(e):e)}catch{return""+e}}function so(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?go[t.v]||t.v:e==null?f_(t,t.v):f_(t,e))}function Sl(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function dA(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?$r(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=tr(s["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),a==-1&&(u.e.r=a=f.e.r+1)}for(var p=0;p!=e.length;++p)if(e[p]){if(!Array.isArray(e[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=e[p].length;++g)if(!(typeof e[p][g]>"u")){var m={v:e[p][g]},y=a+p,x=o+g;if(u.s.r>y&&(u.s.r=y),u.s.c>x&&(u.s.c=x),u.e.r<y&&(u.e.r=y),u.e.c<x&&(u.e.c=x),e[p][g]&&typeof e[p][g]=="object"&&!Array.isArray(e[p][g])&&!(e[p][g]instanceof Date))m=e[p][g];else if(Array.isArray(m.v)&&(m.f=e[p][g][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||ft[14],n.cellDates?(m.t="d",m.w=js(m.z,Nn(m.v))):(m.t="n",m.v=Nn(m.v),m.w=js(m.z,m.v))):m.t="s";if(i)s[y]||(s[y]=[]),s[y][x]&&s[y][x].z&&(m.z=s[y][x].z),s[y][x]=m;else{var S=ht({c:x,r:y});s[S]&&s[S].z&&(m.z=s[S].z),s[S]=m}}}return u.s.c<1e7&&(s["!ref"]=bt(u)),s}function Bu(t,e){return dA(null,t,e)}function WR(t){return t.read_shift(4,"i")}function na(t,e){return e||(e=_e(4)),e.write_shift(4,t),e}function mi(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function zn(t,e){var r=!1;return e==null&&(r=!0,e=_e(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function HR(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function $R(t,e){return e||(e=_e(4)),e.write_shift(2,0),e.write_shift(2,0),e}function tv(t,e){var r=t.l,n=t.read_shift(1),i=mi(t),s=[],a={t:i,h:i};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)s.push(HR(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function GR(t,e){var r=!1;return e==null&&(r=!0,e=_e(15+4*t.t.length)),e.write_shift(1,0),zn(t.t,e),r?e.slice(0,e.l):e}var KR=tv;function YR(t,e){var r=!1;return e==null&&(r=!0,e=_e(23+4*t.t.length)),e.write_shift(1,1),zn(t.t,e),e.write_shift(4,1),$R({},e),r?e.slice(0,e.l):e}function Ls(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function fc(t,e){return e==null&&(e=_e(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function hc(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function pc(t,e){return e==null&&(e=_e(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var XR=mi,fA=zn;function rv(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function tp(t,e){var r=!1;return e==null&&(r=!0,e=_e(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var qR=mi,fx=rv,nv=tp;function iv(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?ep([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Rl(e,0)>>2;return r?i/100:i}function hA(t,e){e==null&&(e=_e(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function pA(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function QR(t,e){return e||(e=_e(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var gc=pA,ju=QR;function gi(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function ec(t,e){return(e||_e(8)).write_shift(8,t,"f")}function JR(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var u=Vl[i];u&&(e.rgb=Ef(u));break;case 2:e.rgb=Ef([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function rp(t,e){if(e||(e=_e(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function ZR(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function eD(t,e){e||(e=_e(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function gA(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function tD(t){return gA(t,1)}function rD(t){return gA(t,2)}var sv=2,Wi=3,M0=11,h_=12,np=19,B0=64,nD=65,iD=71,sD=4108,aD=4126,jn=80,mA=81,oD=[jn,mA],hx={1:{n:"CodePage",t:sv},2:{n:"Category",t:jn},3:{n:"PresentationFormat",t:jn},4:{n:"ByteCount",t:Wi},5:{n:"LineCount",t:Wi},6:{n:"ParagraphCount",t:Wi},7:{n:"SlideCount",t:Wi},8:{n:"NoteCount",t:Wi},9:{n:"HiddenCount",t:Wi},10:{n:"MultimediaClipCount",t:Wi},11:{n:"ScaleCrop",t:M0},12:{n:"HeadingPairs",t:sD},13:{n:"TitlesOfParts",t:aD},14:{n:"Manager",t:jn},15:{n:"Company",t:jn},16:{n:"LinksUpToDate",t:M0},17:{n:"CharacterCount",t:Wi},19:{n:"SharedDoc",t:M0},22:{n:"HyperlinksChanged",t:M0},23:{n:"AppVersion",t:Wi,p:"version"},24:{n:"DigSig",t:nD},26:{n:"ContentType",t:jn},27:{n:"ContentStatus",t:jn},28:{n:"Language",t:jn},29:{n:"Version",t:jn},255:{},2147483648:{n:"Locale",t:np},2147483651:{n:"Behavior",t:np},1919054434:{}},px={1:{n:"CodePage",t:sv},2:{n:"Title",t:jn},3:{n:"Subject",t:jn},4:{n:"Author",t:jn},5:{n:"Keywords",t:jn},6:{n:"Comments",t:jn},7:{n:"Template",t:jn},8:{n:"LastAuthor",t:jn},9:{n:"RevNumber",t:jn},10:{n:"EditTime",t:B0},11:{n:"LastPrinted",t:B0},12:{n:"CreatedDate",t:B0},13:{n:"ModifiedDate",t:B0},14:{n:"PageCount",t:Wi},15:{n:"WordCount",t:Wi},16:{n:"CharCount",t:Wi},17:{n:"Thumbnail",t:iD},18:{n:"Application",t:jn},19:{n:"DocSecurity",t:Wi},255:{},2147483648:{n:"Locale",t:np},2147483651:{n:"Behavior",t:np},1919054434:{}},p_={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},lD=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function cD(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var uD=cD([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Vl=Rr(uD),go={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},xA={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},gx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},j0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function av(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function dD(t){var e=av();if(!t||!t.match)return e;var r={};if((t.match(_i)||[]).forEach(function(n){var i=pt(n);switch(i[0].replace(ER,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[gx[i.ContentType]]!==void 0&&e[gx[i.ContentType]].push(i.PartName);break}}),e.xmlns!==kn.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function vA(t,e){var r=dR(gx),n=[],i;n[n.length]=dn,n[n.length]=Ge("Types",null,{xmlns:kn.CT,"xmlns:xsd":kn.xsd,"xmlns:xsi":kn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Ge("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],n[n.length]=Ge("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:j0[l][e.bookType]||j0[l].xlsx}))},a=function(l){(t[l]||[]).forEach(function(u){n[n.length]=Ge("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:j0[l][e.bookType]||j0[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(u){n[n.length]=Ge("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var jt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function _f(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Ud(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(_i)||[]).forEach(function(i){var s=pt(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:wd(s.Target,e);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}function au(t){var e=[dn,Ge("Relationships",null,{xmlns:kn.RELS})];return en(t["!id"]).forEach(function(r){e[e.length]=Ge("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function hr(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[jt.HLINK,jt.XPATH,jt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var fD="application/vnd.oasis.opendocument.spreadsheet";function hD(t,e){for(var r=q1(t),n,i;n=yf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=pt(n[0],!1),i.path=="/"&&i.type!==fD)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function pD(t){var e=[dn];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function g_(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function gD(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function mD(t){var e=[dn];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(g_(t[r][0],t[r][1])),e.push(gD("",t[r][0]));return e.push(g_("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function yA(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Xh.version+"</meta:generator></office:meta></office:document-meta>"}var Os=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],xD=function(){for(var t=new Array(Os.length),e=0;e<Os.length;++e){var r=Os[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function _A(t){var e={};t=vr(t);for(var r=0;r<Os.length;++r){var n=Os[r],i=t.match(xD[r]);i!=null&&i.length>0&&(e[n[1]]=er(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Nr(e[n[1]]))}return e}function $g(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=pr(e),n[n.length]=r?Ge(t,e,r):Qn(t,e))}function EA(t,e){var r=e||{},n=[dn,Ge("cp:coreProperties",null,{"xmlns:cp":kn.CORE_PROPS,"xmlns:dc":kn.dc,"xmlns:dcterms":kn.dcterms,"xmlns:dcmitype":kn.dcmitype,"xmlns:xsi":kn.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&$g("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:dx(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&$g("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:dx(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Os.length;++s){var a=Os[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&$g(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var zl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],SA=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function wA(t,e,r,n){var i=[];if(typeof t=="string")i=s_(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(f){return{v:f}}));var a=typeof e=="string"?s_(e,n).map(function(f){return f.v}):e,o=0,l=0;if(a.length>0)for(var u=0;u!==i.length;u+=2){switch(l=+i[u+1].v,i[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function vD(t,e,r){var n={};return e||(e={}),t=vr(t),zl.forEach(function(i){var s=(t.match(xf(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=er(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&wA(n.HeadingPairs,n.TitlesOfParts,e,r),e}function TA(t){var e=[],r=Ge;return t||(t={}),t.Application="SheetJS",e[e.length]=dn,e[e.length]=Ge("Properties",null,{xmlns:kn.EXT_PROPS,"xmlns:vt":kn.vt}),zl.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=pr(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+pr(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var yD=/<[^>]+>[^<]*/g;function _D(t,e){var r={},n="",i=t.match(yD);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=pt(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=er(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),u=l[0].slice(4),f=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=er(f);break;case"bool":r[n]=br(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=Nr(f);break;case"cy":case"error":r[n]=er(f);break;default:if(u.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,u,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}function AA(t){var e=[dn,Ge("Properties",null,{xmlns:kn.CUST_PROPS,"xmlns:vt":kn.vt})];if(!t)return e.join("");var r=1;return en(t).forEach(function(i){++r,e[e.length]=Ge("property",bR(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:pr(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var mx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Gg;function ED(t,e,r){Gg||(Gg=Wp(mx)),e=Gg[e]||e,t[e]=r}function SD(t,e){var r=[];return en(mx).map(function(n){for(var i=0;i<Os.length;++i)if(Os[i][1]==n)return Os[i];for(i=0;i<zl.length;++i)if(zl[i][1]==n)return zl[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Qn(mx[n[1]]||n[1],i))}}),Ge("DocumentProperties",r.join(""),{xmlns:ss.o})}function wD(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&en(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<Os.length;++a)if(s==Os[a][1])return;for(a=0;a<zl.length;++a)if(s==zl[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(Ge(t_(s),o,{"dt:dt":l}))}}),e&&en(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(Ge(t_(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+ss.o+'">'+i.join("")+"</"+n+">"}function ov(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function TD(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=_e(8);return a.write_shift(4,n),a.write_shift(4,i),a}function CA(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function kA(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function FA(t,e,r){return e===31?kA(t):CA(t,e,r)}function xx(t,e,r){return FA(t,e,r===!1?0:4)}function AD(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return FA(t,e,0)}function CD(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Ni,""),t.l-i&2&&(t.l+=2)}return r}function kD(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Ni,"");return r}function FD(t){var e=t.l,r=ip(t,mA);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=ip(t,Wi);return[r,n]}function bD(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(FD(t));return r}function m_(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),a=t.read_shift(4);n[s]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(Ni,"").replace(Sd,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function bA(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function ID(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function ip(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==h_&&n!==e&&oD.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===h_?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return CA(t,n,4).replace(Ni,"");case 31:return kA(t);case 64:return ov(t);case 65:return bA(t);case 71:return ID(t);case 80:return xx(t,n,!s.raw).replace(Ni,"");case 81:return AD(t,n).replace(Ni,"");case 4108:return bD(t);case 4126:case 4127:return n==4127?CD(t):kD(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function x_(t,e){var r=_e(4),n=_e(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=_e(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=TD(e);break;case 31:case 80:for(n=_e(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Vn([r,n])}function v_(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0,o=0,l=-1,u={};for(a=0;a!=i;++a){var f=t.read_shift(4),p=t.read_shift(4);s[a]=[f,p+r]}s.sort(function(C,E){return C[1]-E[1]});var g={};for(a=0;a!=i;++a){if(t.l!==s[a][1]){var m=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:t.l+2===s[a][1]&&(t.l+=2,m=!1);break;case 80:t.l<=s[a][1]&&(t.l=s[a][1],m=!1);break;case 4108:t.l<=s[a][1]&&(t.l=s[a][1],m=!1);break}if((!e||a==0)&&t.l<=s[a][1]&&(m=!1,t.l=s[a][1]),m)throw new Error("Read Error: Expected address "+s[a][1]+" at "+t.l+" :"+a)}if(e){var y=e[s[a][0]];if(g[y.n]=ip(t,y.t,{raw:!0}),y.p==="version"&&(g[y.n]=String(g[y.n]>>16)+"."+("0000"+String(g[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(g[y.n]){case 0:g[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Qs(o=g[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[y.n])}}else if(s[a][0]===1){if(o=g.CodePage=ip(t,sv),Qs(o),l!==-1){var x=t.l;t.l=s[l][1],u=m_(t,o),t.l=x}}else if(s[a][0]===0){if(o===0){l=a,t.l=s[a+1][1];continue}u=m_(t,o)}else{var S=u[s[a][0]],A;switch(t[t.l]){case 65:t.l+=4,A=bA(t);break;case 30:t.l+=4,A=xx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,A=xx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,A=t.read_shift(4,"i");break;case 19:t.l+=4,A=t.read_shift(4);break;case 5:t.l+=4,A=t.read_shift(8,"f");break;case 11:t.l+=4,A=on(t,4);break;case 64:t.l+=4,A=Nr(ov(t));break;default:throw new Error("unparsed value: "+t[t.l])}g[S]=A}}return t.l=r+n,g}var IA=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function ND(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function y_(t,e,r){var n=_e(8),i=[],s=[],a=8,o=0,l=_e(8),u=_e(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),s.push(l),i.push(u),a+=8+l.length,!e){u=_e(8),u.write_shift(4,0),i.unshift(u);var f=[_e(4)];for(f[0].write_shift(4,t.length),o=0;o<t.length;++o){var p=t[o][0];for(l=_e(8+2*(p.length+1)+(p.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,p.length+1),l.write_shift(0,p,"dbcs");l.l!=l.length;)l.write_shift(1,0);f.push(l)}l=Vn(f),s.unshift(l),a+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(IA.indexOf(t[o][0])>-1||SA.indexOf(t[o][0])>-1)&&t[o][1]!=null){var g=t[o][1],m=0;if(e){m=+e[t[o][0]];var y=r[m];if(y.p=="version"&&typeof g=="string"){var x=g.split(".");g=(+x[0]<<16)+(+x[1]||0)}l=x_(y.t,g)}else{var S=ND(g);S==-1&&(S=31,g=String(g)),l=x_(S,g)}s.push(l),u=_e(8),u.write_shift(4,e?m:2+o),i.push(u),a+=8+l.length}var A=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,A),A+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),Vn([n].concat(i).concat(s))}function __(t,e,r){var n=t.content;if(!n)return{};qn(n,0);var i,s,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),f=n.read_shift(16);if(f!==st.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),l=n.read_shift(4));var p=v_(n,e),g={SystemIdentifier:u};for(var m in p)g[m]=p[m];if(g.FMTID=s,i===1)return g;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var y;try{y=v_(n,null)}catch{}for(m in y)g[m]=y[m];return g.FMTID=[s,a],g}function E_(t,e,r,n,i,s){var a=_e(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,st.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=y_(t,r,n);if(o.push(l),i){var u=y_(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(u)}return Vn(o)}function Ro(t,e){return t.read_shift(e),null}function RD(t,e){e||(e=_e(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function DD(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function on(t,e){return t.read_shift(e)===1}function bi(t,e){return e||(e=_e(2)),e.write_shift(2,+!!t),e}function vn(t){return t.read_shift(2,"u")}function bs(t,e){return e||(e=_e(2)),e.write_shift(2,t),e}function NA(t,e){return DD(t,e,vn)}function PD(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function RA(t,e,r){return r||(r=_e(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function $f(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return a}function OD(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,s=1+(r&1),a=0,o,l={};i&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",f=e===0?"":t.read_shift(e,u);return i&&(t.l+=4*a),n&&(t.l+=o),l.t=f,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function MD(t){var e=t.t||"",r=_e(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=_e(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return Vn(i)}function tc(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Gf(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):tc(t,n,r)}function mc(t,e,r){if(r.biff>5)return Gf(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function DA(t,e,r){return r||(r=_e(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function BD(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function jD(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Ni,"");return n&&(t.l+=24),i}function LD(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(s>>1,"utf16le").replace(Ni,"");return r+a}function UD(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return jD(t);case"0303000000000000c000000000000046":return LD(t);default:throw new Error("Unsupported Moniker "+r)}}function L0(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Ni,""):"";return r}function S_(t,e){e||(e=_e(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function VD(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,a,o,l,u="",f,p;i&16&&(s=L0(t,r-t.l)),i&128&&(a=L0(t,r-t.l)),(i&257)===257&&(o=L0(t,r-t.l)),(i&257)===1&&(l=UD(t,r-t.l)),i&8&&(u=L0(t,r-t.l)),i&32&&(f=t.read_shift(16)),i&64&&(p=ov(t)),t.l=r;var g=a||o||l||"";g&&u&&(g+="#"+u),g||(g="#"+u),i&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var m={Target:g};return f&&(m.guid=f),p&&(m.time=p),s&&(m.Tooltip=s),m}function zD(t){var e=_e(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),S_(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&S_(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function PA(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function OA(t,e){var r=PA(t);return r[3]=0,r}function Oa(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function rc(t,e,r,n){return n||(n=_e(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function WD(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function HD(t,e,r){return e===0?"":mc(t,e,r)}function $D(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function MA(t){var e=t.read_shift(2),r=iv(t);return[e,r]}function GD(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=$f(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function Gp(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function BA(t,e){return e||(e=_e(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function jA(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var KD=jA;function LA(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function YD(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function XD(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function oi(t){t.l+=2,t.l+=t.read_shift(2)}var qD={0:oi,4:oi,5:oi,6:oi,7:XD,8:oi,9:oi,10:oi,11:oi,12:oi,13:YD,14:oi,15:oi,16:oi,17:oi,18:oi,19:oi,20:oi,21:LA};function QD(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(qD[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function U0(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function lv(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=_e(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function JD(t,e){return e===0||t.read_shift(2),1200}function ZD(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=mc(t,0,r);return t.read_shift(e+n-t.l),i}function e3(t,e){var r=!e||e.biff==8,n=_e(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function t3(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function r3(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=$f(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function n3(t,e){var r=!e||e.biff>=8?2:1,n=_e(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function i3(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0;a!=i&&t.l<r;++a)s.push(OD(t));return s.Count=n,s.Unique=i,s}function s3(t,e){var r=_e(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=MD(t[i]);var s=Vn([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function a3(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function o3(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function l3(t){var e=WD(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function c3(t){return t.read_shift(2),t.read_shift(4)}function w_(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function u3(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),u=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:u}}function d3(){var t=_e(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function f3(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function h3(t){var e=_e(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function p3(){}function g3(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=$f(t,0,r),n}function m3(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=_e(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function x3(t){var e=Oa(t);return e.isst=t.read_shift(4),e}function v3(t,e,r,n){var i=_e(10);return rc(t,e,n,i),i.write_shift(4,r),i}function y3(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=Oa(t);r.biff==2&&t.l++;var s=Gf(t,n-t.l,r);return i.val=s,i}function _3(t,e,r,n,i){var s=!i||i.biff==8,a=_e(8+ +s+(1+s)*r.length);return rc(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function E3(t,e,r){var n=t.read_shift(2),i=mc(t,0,r);return[n,i]}function S3(t,e,r,n){var i=r&&r.biff==5;n||(n=_e(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var w3=mc;function T_(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),a=t.read_shift(i),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:s,c:o},e:{r:a,c:l}}}function T3(t,e){var r=e.biff==8||!e.biff?4:2,n=_e(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function A3(t){var e=t.read_shift(2),r=t.read_shift(2),n=MA(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function C3(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(MA(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function k3(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function F3(t,e,r,n){var i={},s=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return i.patternType=lD[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function b3(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=F3(t,e,n.fStyle,r),n}function A_(t,e,r,n){var i=r&&r.biff==5;n||(n=_e(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function I3(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function N3(t){var e=_e(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function C_(t,e,r){var n=Oa(t);(r.biff==2||e==9)&&++t.l;var i=PD(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function R3(t,e,r,n,i,s){var a=_e(8);return rc(t,e,n,a),RA(r,s,a),a}function D3(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Oa(t),i=gi(t);return n.val=i,n}function P3(t,e,r,n){var i=_e(14);return rc(t,e,n,i),ec(r,i),i}var k_=HD;function O3(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=tc(t,s),o=[];n>t.l;)o.push(Gf(t));return[s,i,a,o]}function F_(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=GD(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var M3=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function b_(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var u=tc(t,a,r);i&32&&(u=M3[u.charCodeAt(0)]);var f=n-t.l;r&&r.biff==2&&--f;var p=n==t.l||o===0||!(f>0)?[]:Q5(t,f,r,o);return{chKey:s,Name:u,itab:l,rgce:p}}function UA(t,e,r){if(r.biff<8)return B3(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push($D(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function B3(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=$f(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function j3(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=tc(t,n,r),a=tc(t,i,r);return[s,a]}function L3(t,e,r){var n=jA(t);t.l++;var i=t.read_shift(1);return e-=8,[J5(t,e,r),i,n]}function I_(t,e,r){var n=KD(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,X5(t,e,r)]}function U3(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function V3(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=mc(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},o,a,s]}}function z3(t,e,r){return V3(t,e,r)}function W3(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Gp(t));return r}function H3(t){var e=_e(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)BA(t[r],e);return e}function $3(t,e,r){if(r&&r.biff<8)return K3(t,e,r);var n=LA(t),i=QD(t,e-22,n[1]);return{cmo:n,ft:i}}var G3={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function K3(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((G3[n]||vi)(t,e,r)),{cmo:[i,n,s],ft:a}}function Y3(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:a=BD(t,6,r);var o=t.read_shift(2);t.read_shift(2),vn(t,2);var l=t.read_shift(2);t.l+=l;for(var u=1;u<t.lens.length-1;++u){if(t.l-n!=t.lens[u])throw new Error("TxO: bad continue record");var f=t[t.l],p=tc(t,t.lens[u+1]-t.lens[u]-1);if(i+=p,i.length>=(f?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function X3(t,e){var r=Gp(t);t.l+=16;var n=VD(t,e-24);return[r,n]}function q3(t){var e=_e(24),r=$r(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return Vn([e,zD(t[1])])}function Q3(t,e){t.read_shift(2);var r=Gp(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Ni,""),[r,n]}function J3(t){var e=t[1].Tooltip,r=_e(10+2*(e.length+1));r.write_shift(2,2048);var n=$r(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function Z3(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=p_[r]||r,r=t.read_shift(2),e[1]=p_[r]||r,e}function e6(t){return t||(t=_e(4)),t.write_shift(2,1),t.write_shift(2,1),t}function t6(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(OA(t));return r}function r6(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(OA(t));return r}function n6(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function VA(t,e,r){if(!r.cellStyles)return vi(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var u={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function i6(t,e){var r=_e(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function s6(t,e){var r={};return e<32||(t.l+=16,r.header=gi(t),r.footer=gi(t),t.l+=2),r}function a6(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}function o6(t){for(var e=_e(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var l6=Oa,c6=NA,u6=Gf;function d6(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function f6(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Oa(t);++t.l;var i=mc(t,e-7,r);return n.t="str",n.val=i,n}function h6(t){var e=Oa(t);++t.l;var r=gi(t);return e.t="n",e.val=r,e}function p6(t,e,r){var n=_e(15);return qf(n,t,e),n.write_shift(8,r,"f"),n}function g6(t){var e=Oa(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function m6(t,e,r){var n=_e(9);return qf(n,t,e),n.write_shift(2,r),n}function x6(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function v6(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function y6(t,e,r){var n=t.l+e,i=Oa(t),s=t.read_shift(2),a=tc(t,s,r);return t.l=n,i.t="str",i.val=a,i}var _6=[2,3,48,49,131,139,140,245],vx=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Wp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],f=dl(1);switch(l.type){case"base64":f=os(hs(o));break;case"binary":f=os(o);break;case"buffer":case"array":f=o;break}qn(f,0);var p=f.read_shift(1),g=!!(p&136),m=!1,y=!1;switch(p){case 2:break;case 3:break;case 48:m=!0,g=!0;break;case 49:m=!0,g=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var x=0,S=521;p==2&&(x=f.read_shift(2)),f.l+=3,p!=2&&(x=f.read_shift(4)),x>1048576&&(x=1e6),p!=2&&(S=f.read_shift(2));var A=f.read_shift(2),C=l.codepage||1252;p!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(C=t[f[f.l]]),f.l+=1,f.l+=2),y&&(f.l+=36);for(var E=[],M={},X=Math.min(f.length,p==2?521:S-10-(m?264:0)),z=y?32:11;f.l<X&&f[f.l]!=13;)switch(M={},M.name=pf.utils.decode(C,f.slice(f.l,f.l+z)).replace(/[\u0000\r\n].*$/g,""),f.l+=z,M.type=String.fromCharCode(f.read_shift(1)),p!=2&&!y&&(M.offset=f.read_shift(4)),M.len=f.read_shift(1),p==2&&(M.offset=f.read_shift(2)),M.dec=f.read_shift(1),M.name.length&&E.push(M),p!=2&&(f.l+=y?13:14),M.type){case"B":(!m||M.len!=8)&&l.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+M.type)}if(f[f.l]!==13&&(f.l=S-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=S;var T=0,F=0;for(u[0]=[],F=0;F!=E.length;++F)u[0][F]=E[F].name;for(;x-- >0;){if(f[f.l]===42){f.l+=A;continue}for(++f.l,u[++T]=[],F=0,F=0;F!=E.length;++F){var w=f.slice(f.l,f.l+E[F].len);f.l+=E[F].len,qn(w,0);var R=pf.utils.decode(C,w);switch(E[F].type){case"C":R.trim().length&&(u[T][F]=R.replace(/\s+$/,""));break;case"D":R.length===8?u[T][F]=new Date(+R.slice(0,4),+R.slice(4,6)-1,+R.slice(6,8)):u[T][F]=R;break;case"F":u[T][F]=parseFloat(R.trim());break;case"+":case"I":u[T][F]=y?w.read_shift(-4,"i")^2147483648:w.read_shift(4,"i");break;case"L":switch(R.trim().toUpperCase()){case"Y":case"T":u[T][F]=!0;break;case"N":case"F":u[T][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+R+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));u[T][F]="##MEMO##"+(y?parseInt(R.trim(),10):w.read_shift(4));break;case"N":R=R.replace(/\u0000/g,"").trim(),R&&R!="."&&(u[T][F]=+R||0);break;case"@":u[T][F]=new Date(w.read_shift(-8,"f")-621356832e5);break;case"T":u[T][F]=new Date((w.read_shift(4)-2440588)*864e5+w.read_shift(4));break;case"Y":u[T][F]=w.read_shift(4,"i")/1e4+w.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[T][F]=-w.read_shift(-8,"f");break;case"B":if(m&&E[F].len==8){u[T][F]=w.read_shift(8,"f");break}case"G":case"P":w.l+=E[F].len;break;case"0":if(E[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[F].type)}}}if(p!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=E,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var f=Bu(r(o,u),u);return f["!cols"]=u.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete u.DBF,f}function i(o,l){try{return Sl(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var u=l||{};if(+u.codepage>=0&&Qs(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=Xi(),p=op(o,{header:1,raw:!0,cellDates:!0}),g=p[0],m=p.slice(1),y=o["!cols"]||[],x=0,S=0,A=0,C=1;for(x=0;x<g.length;++x){if(((y[x]||{}).DBF||{}).name){g[x]=y[x].DBF.name,++A;continue}if(g[x]!=null){if(++A,typeof g[x]=="number"&&(g[x]=g[x].toString(10)),typeof g[x]!="string")throw new Error("DBF Invalid column name "+g[x]+" |"+typeof g[x]+"|");if(g.indexOf(g[x])!==x){for(S=0;S<1024;++S)if(g.indexOf(g[x]+"_"+S)==-1){g[x]+="_"+S;break}}}}var E=tr(o["!ref"]),M=[],X=[],z=[];for(x=0;x<=E.e.c-E.s.c;++x){var T="",F="",w=0,R=[];for(S=0;S<m.length;++S)m[S][x]!=null&&R.push(m[S][x]);if(R.length==0||g[x]==null){M[x]="?";continue}for(S=0;S<R.length;++S){switch(typeof R[S]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=R[S]instanceof Date?"D":"C";break;default:F="C"}w=Math.max(w,String(R[S]).length),T=T&&T!=F?"C":F}w>250&&(w=250),F=((y[x]||{}).DBF||{}).type,F=="C"&&y[x].DBF.len>w&&(w=y[x].DBF.len),T=="B"&&F=="N"&&(T="N",z[x]=y[x].DBF.dec,w=y[x].DBF.len),X[x]=T=="C"||F=="N"?w:s[T]||0,C+=X[x],M[x]=T}var P=f.next(32);for(P.write_shift(4,318902576),P.write_shift(4,m.length),P.write_shift(2,296+32*A),P.write_shift(2,C),x=0;x<4;++x)P.write_shift(4,0);for(P.write_shift(4,0|(+e[IT]||3)<<8),x=0,S=0;x<g.length;++x)if(g[x]!=null){var O=f.next(32),D=(g[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);O.write_shift(1,D,"sbcs"),O.write_shift(1,M[x]=="?"?"C":M[x],"sbcs"),O.write_shift(4,S),O.write_shift(1,X[x]||s[M[x]]||0),O.write_shift(1,z[x]||0),O.write_shift(1,2),O.write_shift(4,0),O.write_shift(1,0),O.write_shift(4,0),O.write_shift(4,0),S+=X[x]||s[M[x]]||0}var qe=f.next(264);for(qe.write_shift(4,13),x=0;x<65;++x)qe.write_shift(4,0);for(x=0;x<m.length;++x){var Ee=f.next(C);for(Ee.write_shift(1,0),S=0;S<g.length;++S)if(g[S]!=null)switch(M[S]){case"L":Ee.write_shift(1,m[x][S]==null?63:m[x][S]?84:70);break;case"B":Ee.write_shift(8,m[x][S]||0,"f");break;case"N":var Pe="0";for(typeof m[x][S]=="number"&&(Pe=m[x][S].toFixed(z[S]||0)),A=0;A<X[S]-Pe.length;++A)Ee.write_shift(1,32);Ee.write_shift(1,Pe,"sbcs");break;case"D":m[x][S]?(Ee.write_shift(4,("0000"+m[x][S].getFullYear()).slice(-4),"sbcs"),Ee.write_shift(2,("00"+(m[x][S].getMonth()+1)).slice(-2),"sbcs"),Ee.write_shift(2,("00"+m[x][S].getDate()).slice(-2),"sbcs")):Ee.write_shift(8,"00000000","sbcs");break;case"C":var Fe=String(m[x][S]!=null?m[x][S]:"").slice(0,X[S]);for(Ee.write_shift(1,Fe,"sbcs"),A=0;A<X[S]-Fe.length;++A)Ee.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),zA=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+en(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(g,m){var y=t[m];return typeof y=="number"?V2(y):y},n=function(g,m,y){var x=m.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return x==59?g:V2(x)};t["|"]=254;function i(g,m){switch(m.type){case"base64":return s(hs(g),m);case"binary":return s(g,m);case"buffer":return s(Mt&&Buffer.isBuffer(g)?g.toString("binary"):El(g),m);case"array":return s(Zl(g),m)}throw new Error("Unrecognized type "+m.type)}function s(g,m){var y=g.split(/[\n\r]+/),x=-1,S=-1,A=0,C=0,E=[],M=[],X=null,z={},T=[],F=[],w=[],R=0,P;for(+m.codepage>=0&&Qs(+m.codepage);A!==y.length;++A){R=0;var O=y[A].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),D=O.replace(/;;/g,"\0").split(";").map(function(Y){return Y.replace(/\u0000/g,";")}),qe=D[0],Ee;if(O.length>0)switch(qe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":D[1].charAt(0)=="P"&&M.push(O.slice(3).replace(/;;/g,";"));break;case"C":var Pe=!1,Fe=!1,Ae=!1,ne=!1,be=-1,je=-1;for(C=1;C<D.length;++C)switch(D[C].charAt(0)){case"A":break;case"X":S=parseInt(D[C].slice(1))-1,Fe=!0;break;case"Y":for(x=parseInt(D[C].slice(1))-1,Fe||(S=0),P=E.length;P<=x;++P)E[P]=[];break;case"K":Ee=D[C].slice(1),Ee.charAt(0)==='"'?Ee=Ee.slice(1,Ee.length-1):Ee==="TRUE"?Ee=!0:Ee==="FALSE"?Ee=!1:isNaN(ra(Ee))?isNaN(_u(Ee).getDate())||(Ee=Nr(Ee)):(Ee=ra(Ee),X!==null&&Ou(X)&&(Ee=$p(Ee))),Pe=!0;break;case"E":ne=!0;var H=ou(D[C].slice(1),{r:x,c:S});E[x][S]=[E[x][S],H];break;case"S":Ae=!0,E[x][S]=[E[x][S],"S5S"];break;case"G":break;case"R":be=parseInt(D[C].slice(1))-1;break;case"C":je=parseInt(D[C].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+O)}if(Pe&&(E[x][S]&&E[x][S].length==2?E[x][S][0]=Ee:E[x][S]=Ee,X=null),Ae){if(ne)throw new Error("SYLK shared formula cannot have own formula");var te=be>-1&&E[be][je];if(!te||!te[1])throw new Error("SYLK shared formula cannot find base");E[x][S][1]=aC(te[1],{r:x-be,c:S-je})}break;case"F":var re=0;for(C=1;C<D.length;++C)switch(D[C].charAt(0)){case"X":S=parseInt(D[C].slice(1))-1,++re;break;case"Y":for(x=parseInt(D[C].slice(1))-1,P=E.length;P<=x;++P)E[P]=[];break;case"M":R=parseInt(D[C].slice(1))/20;break;case"F":break;case"G":break;case"P":X=M[parseInt(D[C].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(w=D[C].slice(1).split(" "),P=parseInt(w[0],10);P<=parseInt(w[1],10);++P)R=parseInt(w[2],10),F[P-1]=R===0?{hidden:!0}:{wch:R},fl(F[P-1]);break;case"C":S=parseInt(D[C].slice(1))-1,F[S]||(F[S]={});break;case"R":x=parseInt(D[C].slice(1))-1,T[x]||(T[x]={}),R>0?(T[x].hpt=R,T[x].hpx=Su(R)):R===0&&(T[x].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+O)}re<1&&(X=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+O)}}return T.length>0&&(z["!rows"]=T),F.length>0&&(z["!cols"]=F),m&&m.sheetRows&&(E=E.slice(0,m.sheetRows)),[E,z]}function a(g,m){var y=i(g,m),x=y[0],S=y[1],A=Bu(x,m);return en(S).forEach(function(C){A[C]=S[C]}),A}function o(g,m){return Sl(a(g,m),m)}function l(g,m,y,x){var S="C;Y"+(y+1)+";X"+(x+1)+";K";switch(g.t){case"n":S+=g.v||0,g.f&&!g.F&&(S+=";E"+pv(g.f,{r:y,c:x}));break;case"b":S+=g.v?"TRUE":"FALSE";break;case"e":S+=g.w||g.v;break;case"d":S+='"'+(g.w||g.v)+'"';break;case"s":S+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function u(g,m){m.forEach(function(y,x){var S="F;W"+(x+1)+" "+(x+1)+" ";y.hidden?S+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=Sf(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=wf(y.wpx)),typeof y.wch=="number"&&(S+=Math.round(y.wch))),S.charAt(S.length-1)!=" "&&g.push(S)})}function f(g,m){m.forEach(function(y,x){var S="F;";y.hidden?S+="M0;":y.hpt?S+="M"+20*y.hpt+";":y.hpx&&(S+="M"+20*Tf(y.hpx)+";"),S.length>2&&g.push(S+"R"+(x+1))})}function p(g,m){var y=["ID;PWXL;N;E"],x=[],S=tr(g["!ref"]),A,C=Array.isArray(g),E=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),g["!cols"]&&u(y,g["!cols"]),g["!rows"]&&f(y,g["!rows"]),y.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var M=S.s.r;M<=S.e.r;++M)for(var X=S.s.c;X<=S.e.c;++X){var z=ht({r:M,c:X});A=C?(g[M]||[])[X]:g[z],!(!A||A.v==null&&(!A.f||A.F))&&x.push(l(A,g,M,X))}return y.join(E)+E+x.join(E)+E+"E"+E}return{to_workbook:o,to_sheet:a,from_sheet:p}}(),WA=function(){function t(s,a){switch(a.type){case"base64":return e(hs(s),a);case"binary":return e(s,a);case"buffer":return e(Mt&&Buffer.isBuffer(s)?s.toString("binary"):El(s),a);case"array":return e(Zl(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,u=-1,f=0,p=[];f!==o.length;++f){if(o[f].trim()==="BOT"){p[++l]=[],u=0;continue}if(!(l<0)){var g=o[f].trim().split(","),m=g[0],y=g[1];++f;for(var x=o[f]||"";(x.match(/["]/g)||[]).length&1&&f<o.length-1;)x+=`
`+o[++f];switch(x=x.trim(),+m){case-1:if(x==="BOT"){p[++l]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?p[l][u]=!0:x==="FALSE"?p[l][u]=!1:isNaN(ra(y))?isNaN(_u(y).getDate())?p[l][u]=y:p[l][u]=Nr(y):p[l][u]=ra(y),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),p[l][u++]=x!==""?x:null;break}if(x==="EOD")break}}return a&&a.sheetRows&&(p=p.slice(0,a.sheetRows)),p}function r(s,a){return Bu(t(s,a),a)}function n(s,a){return Sl(r(s,a),a)}var i=function(){var s=function(l,u,f,p,g){l.push(u),l.push(f+","+p),l.push('"'+g.replace(/"/g,'""')+'"')},a=function(l,u,f,p){l.push(u+","+f),l.push(u==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(l){var u=[],f=tr(l["!ref"]),p,g=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,f.e.r-f.s.r+1,""),s(u,"TUPLES",0,f.e.c-f.s.c+1,""),s(u,"DATA",0,0,"");for(var m=f.s.r;m<=f.e.r;++m){a(u,-1,0,"BOT");for(var y=f.s.c;y<=f.e.c;++y){var x=ht({r:m,c:y});if(p=g?(l[m]||[])[y]:l[x],!p){a(u,1,0,"");continue}switch(p.t){case"n":var S=p.w;!S&&p.v!=null&&(S=p.v),S==null?p.f&&!p.F?a(u,1,0,"="+p.f):a(u,1,0,""):a(u,0,S,"V");break;case"b":a(u,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":a(u,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=js(p.z||ft[14],Nn(Nr(p.v)))),a(u,0,p.w,"V");break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var A=`\r
`,C=u.join(A);return C}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),HA=function(){function t(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,g){for(var m=p.split(`
`),y=-1,x=-1,S=0,A=[];S!==m.length;++S){var C=m[S].trim().split(":");if(C[0]==="cell"){var E=$r(C[1]);if(A.length<=E.r)for(y=A.length;y<=E.r;++y)A[y]||(A[y]=[]);switch(y=E.r,x=E.c,C[2]){case"t":A[y][x]=t(C[3]);break;case"v":A[y][x]=+C[3];break;case"vtf":var M=C[C.length-1];case"vtc":switch(C[3]){case"nl":A[y][x]=!!+C[4];break;default:A[y][x]=+C[4];break}C[2]=="vtf"&&(A[y][x]=[A[y][x],M])}}}return g&&g.sheetRows&&(A=A.slice(0,g.sheetRows)),A}function n(p,g){return Bu(r(p,g),g)}function i(p,g){return Sl(n(p,g),g)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(p){if(!p||!p["!ref"])return"";for(var g=[],m=[],y,x="",S=qi(p["!ref"]),A=Array.isArray(p),C=S.s.r;C<=S.e.r;++C)for(var E=S.s.c;E<=S.e.c;++E)if(x=ht({r:C,c:E}),y=A?(p[C]||[])[E]:p[x],!(!y||y.v==null||y.t==="z")){switch(m=["cell",x,"t"],y.t){case"s":case"str":m.push(e(y.v));break;case"n":y.f?(m[2]="vtf",m[3]="n",m[4]=y.v,m[5]=e(y.f)):(m[2]="v",m[3]=y.v);break;case"b":m[2]="vt"+(y.f?"f":"c"),m[3]="nl",m[4]=y.v?"1":"0",m[5]=e(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var M=Nn(Nr(y.v));m[2]="vtc",m[3]="nd",m[4]=""+M,m[5]=y.w||js(y.z||ft[14],M);break;case"e":continue}g.push(m.join(":"))}return g.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function f(p){return[s,a,o,a,u(p),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),Eu=function(){function t(f,p,g,m,y){y.raw?p[g][m]=f:f===""||(f==="TRUE"?p[g][m]=!0:f==="FALSE"?p[g][m]=!1:isNaN(ra(f))?isNaN(_u(f).getDate())?p[g][m]=f:p[g][m]=Nr(f):p[g][m]=ra(f))}function e(f,p){var g=p||{},m=[];if(!f||f.length===0)return m;for(var y=f.split(/[\r\n]/),x=y.length-1;x>=0&&y[x].length===0;)--x;for(var S=10,A=0,C=0;C<=x;++C)A=y[C].indexOf(" "),A==-1?A=y[C].length:A++,S=Math.max(S,A);for(C=0;C<=x;++C){m[C]=[];var E=0;for(t(y[C].slice(0,S).trim(),m,C,E,g),E=1;E<=(y[C].length-S)/10+1;++E)t(y[C].slice(S+(E-1)*10,S+E*10).trim(),m,C,E,g)}return g.sheetRows&&(m=m.slice(0,g.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var p={},g=!1,m=0,y=0;m<f.length;++m)(y=f.charCodeAt(m))==34?g=!g:!g&&y in r&&(p[y]=(p[y]||0)+1);y=[];for(m in p)Object.prototype.hasOwnProperty.call(p,m)&&y.push([p[m],m]);if(!y.length){p=n;for(m in p)Object.prototype.hasOwnProperty.call(p,m)&&y.push([p[m],m])}return y.sort(function(x,S){return x[0]-S[0]||n[x[1]]-n[S[1]]}),r[y.pop()[1]]||44}function s(f,p){var g=p||{},m="",y=g.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(m=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(m=f.charAt(4),f=f.slice(6)):m=i(f.slice(0,1024)):g&&g.FS?m=g.FS:m=i(f.slice(0,1024));var S=0,A=0,C=0,E=0,M=0,X=m.charCodeAt(0),z=!1,T=0,F=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var w=g.dateNF!=null?aR(g.dateNF):null;function R(){var P=f.slice(E,M),O={};if(P.charAt(0)=='"'&&P.charAt(P.length-1)=='"'&&(P=P.slice(1,-1).replace(/""/g,'"')),P.length===0)O.t="z";else if(g.raw)O.t="s",O.v=P;else if(P.trim().length===0)O.t="s",O.v=P;else if(P.charCodeAt(0)==61)P.charCodeAt(1)==34&&P.charCodeAt(P.length-1)==34?(O.t="s",O.v=P.slice(2,-1).replace(/""/g,'"')):O8(P)?(O.t="n",O.f=P.slice(1)):(O.t="s",O.v=P);else if(P=="TRUE")O.t="b",O.v=!0;else if(P=="FALSE")O.t="b",O.v=!1;else if(!isNaN(C=ra(P)))O.t="n",g.cellText!==!1&&(O.w=P),O.v=C;else if(!isNaN(_u(P).getDate())||w&&P.match(w)){O.z=g.dateNF||ft[14];var D=0;w&&P.match(w)&&(P=oR(P,g.dateNF,P.match(w)||[]),D=1),g.cellDates?(O.t="d",O.v=Nr(P,D)):(O.t="n",O.v=Nn(Nr(P,D))),g.cellText!==!1&&(O.w=js(O.z,O.v instanceof Date?Nn(O.v):O.v)),g.cellNF||delete O.z}else O.t="s",O.v=P;if(O.t=="z"||(g.dense?(y[S]||(y[S]=[]),y[S][A]=O):y[ht({c:A,r:S})]=O),E=M+1,F=f.charCodeAt(E),x.e.c<A&&(x.e.c=A),x.e.r<S&&(x.e.r=S),T==X)++A;else if(A=0,++S,g.sheetRows&&g.sheetRows<=S)return!0}e:for(;M<f.length;++M)switch(T=f.charCodeAt(M)){case 34:F===34&&(z=!z);break;case X:case 10:case 13:if(!z&&R())break e;break}return M-E>0&&R(),y["!ref"]=bt(x),y}function a(f,p){return!(p&&p.PRN)||p.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,p):Bu(e(f,p),p)}function o(f,p){var g="",m=p.type=="string"?[0,0,0,0]:Sv(f,p);switch(p.type){case"base64":g=hs(f);break;case"binary":g=f;break;case"buffer":p.codepage==65001?g=f.toString("utf8"):p.codepage&&typeof pf<"u"||(g=Mt&&Buffer.isBuffer(f)?f.toString("binary"):El(f));break;case"array":g=Zl(f);break;case"string":g=f;break;default:throw new Error("Unrecognized type "+p.type)}return m[0]==239&&m[1]==187&&m[2]==191?g=vr(g.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?g=vr(g):p.type=="binary"&&typeof pf<"u",g.slice(0,19)=="socialcalc:version:"?HA.to_sheet(p.type=="string"?g:vr(g),p):a(g,p)}function l(f,p){return Sl(o(f,p),p)}function u(f){for(var p=[],g=tr(f["!ref"]),m,y=Array.isArray(f),x=g.s.r;x<=g.e.r;++x){for(var S=[],A=g.s.c;A<=g.e.c;++A){var C=ht({r:x,c:A});if(m=y?(f[x]||[])[A]:f[C],!m||m.v==null){S.push("          ");continue}for(var E=(m.w||(so(m),m.w)||"").slice(0,10);E.length<10;)E+=" ";S.push(E+(A===0?" ":""))}p.push(S.join(""))}return p.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}();function E6(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=zA.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Eu.to_workbook(t,e)}}var Wl=function(){function t(H,te,re){if(H){qn(H,H.l||0);for(var Y=re.Enum||be;H.l<H.length;){var ye=H.read_shift(2),Te=Y[ye]||Y[65535],Ve=H.read_shift(2),De=H.l+Ve,Ne=Te.f&&Te.f(H,Ve,re);if(H.l=De,te(Ne,Te,ye))return}}}function e(H,te){switch(te.type){case"base64":return r(os(hs(H)),te);case"binary":return r(os(H),te);case"buffer":case"array":return r(H,te)}throw"Unsupported type "+te.type}function r(H,te){if(!H)return H;var re=te||{},Y=re.dense?[]:{},ye="Sheet1",Te="",Ve=0,De={},Ne=[],it=[],Z={s:{r:0,c:0},e:{r:0,c:0}},Rt=re.sheetRows||0;if(H[2]==0&&(H[3]==8||H[3]==9)&&H.length>=16&&H[14]==5&&H[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(H[2]==2)re.Enum=be,t(H,function(Xe,xr,Xr){switch(Xr){case 0:re.vers=Xe,Xe>=4096&&(re.qpro=!0);break;case 6:Z=Xe;break;case 204:Xe&&(Te=Xe);break;case 222:Te=Xe;break;case 15:case 51:re.qpro||(Xe[1].v=Xe[1].v.slice(1));case 13:case 14:case 16:Xr==14&&(Xe[2]&112)==112&&(Xe[2]&15)>1&&(Xe[2]&15)<15&&(Xe[1].z=re.dateNF||ft[14],re.cellDates&&(Xe[1].t="d",Xe[1].v=$p(Xe[1].v))),re.qpro&&Xe[3]>Ve&&(Y["!ref"]=bt(Z),De[ye]=Y,Ne.push(ye),Y=re.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},Ve=Xe[3],ye=Te||"Sheet"+(Ve+1),Te="");var _n=re.dense?(Y[Xe[0].r]||[])[Xe[0].c]:Y[ht(Xe[0])];if(_n){_n.t=Xe[1].t,_n.v=Xe[1].v,Xe[1].z!=null&&(_n.z=Xe[1].z),Xe[1].f!=null&&(_n.f=Xe[1].f);break}re.dense?(Y[Xe[0].r]||(Y[Xe[0].r]=[]),Y[Xe[0].r][Xe[0].c]=Xe[1]):Y[ht(Xe[0])]=Xe[1];break}},re);else if(H[2]==26||H[2]==14)re.Enum=je,H[2]==14&&(re.qpro=!0,H.l=0),t(H,function(Xe,xr,Xr){switch(Xr){case 204:ye=Xe;break;case 22:Xe[1].v=Xe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Xe[3]>Ve&&(Y["!ref"]=bt(Z),De[ye]=Y,Ne.push(ye),Y=re.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},Ve=Xe[3],ye="Sheet"+(Ve+1)),Rt>0&&Xe[0].r>=Rt)break;re.dense?(Y[Xe[0].r]||(Y[Xe[0].r]=[]),Y[Xe[0].r][Xe[0].c]=Xe[1]):Y[ht(Xe[0])]=Xe[1],Z.e.c<Xe[0].c&&(Z.e.c=Xe[0].c),Z.e.r<Xe[0].r&&(Z.e.r=Xe[0].r);break;case 27:Xe[14e3]&&(it[Xe[14e3][0]]=Xe[14e3][1]);break;case 1537:it[Xe[0]]=Xe[1],Xe[0]==Ve&&(ye=Xe[1]);break}},re);else throw new Error("Unrecognized LOTUS BOF "+H[2]);if(Y["!ref"]=bt(Z),De[Te||ye]=Y,Ne.push(Te||ye),!it.length)return{SheetNames:Ne,Sheets:De};for(var Et={},Dt=[],yt=0;yt<it.length;++yt)De[Ne[yt]]?(Dt.push(it[yt]||Ne[yt]),Et[it[yt]]=De[it[yt]]||De[Ne[yt]]):(Dt.push(it[yt]),Et[it[yt]]={"!ref":"A1"});return{SheetNames:Dt,Sheets:Et}}function n(H,te){var re=te||{};if(+re.codepage>=0&&Qs(+re.codepage),re.type=="string")throw new Error("Cannot write WK1 to JS string");var Y=Xi(),ye=tr(H["!ref"]),Te=Array.isArray(H),Ve=[];Ye(Y,0,s(1030)),Ye(Y,6,l(ye));for(var De=Math.min(ye.e.r,8191),Ne=ye.s.r;Ne<=De;++Ne)for(var it=un(Ne),Z=ye.s.c;Z<=ye.e.c;++Z){Ne===ye.s.r&&(Ve[Z]=Hr(Z));var Rt=Ve[Z]+it,Et=Te?(H[Ne]||[])[Z]:H[Rt];if(!(!Et||Et.t=="z"))if(Et.t=="n")(Et.v|0)==Et.v&&Et.v>=-32768&&Et.v<=32767?Ye(Y,13,m(Ne,Z,Et.v)):Ye(Y,14,x(Ne,Z,Et.v));else{var Dt=so(Et);Ye(Y,15,p(Ne,Z,Dt.slice(0,239)))}}return Ye(Y,1),Y.end()}function i(H,te){var re=te||{};if(+re.codepage>=0&&Qs(+re.codepage),re.type=="string")throw new Error("Cannot write WK3 to JS string");var Y=Xi();Ye(Y,0,a(H));for(var ye=0,Te=0;ye<H.SheetNames.length;++ye)(H.Sheets[H.SheetNames[ye]]||{})["!ref"]&&Ye(Y,27,ne(H.SheetNames[ye],Te++));var Ve=0;for(ye=0;ye<H.SheetNames.length;++ye){var De=H.Sheets[H.SheetNames[ye]];if(!(!De||!De["!ref"])){for(var Ne=tr(De["!ref"]),it=Array.isArray(De),Z=[],Rt=Math.min(Ne.e.r,8191),Et=Ne.s.r;Et<=Rt;++Et)for(var Dt=un(Et),yt=Ne.s.c;yt<=Ne.e.c;++yt){Et===Ne.s.r&&(Z[yt]=Hr(yt));var Xe=Z[yt]+Dt,xr=it?(De[Et]||[])[yt]:De[Xe];if(!(!xr||xr.t=="z"))if(xr.t=="n")Ye(Y,23,R(Et,yt,Ve,xr.v));else{var Xr=so(xr);Ye(Y,22,T(Et,yt,Ve,Xr.slice(0,239)))}}++Ve}}return Ye(Y,1),Y.end()}function s(H){var te=_e(2);return te.write_shift(2,H),te}function a(H){var te=_e(26);te.write_shift(2,4096),te.write_shift(2,4),te.write_shift(4,0);for(var re=0,Y=0,ye=0,Te=0;Te<H.SheetNames.length;++Te){var Ve=H.SheetNames[Te],De=H.Sheets[Ve];if(!(!De||!De["!ref"])){++ye;var Ne=qi(De["!ref"]);re<Ne.e.r&&(re=Ne.e.r),Y<Ne.e.c&&(Y=Ne.e.c)}}return re>8191&&(re=8191),te.write_shift(2,re),te.write_shift(1,ye),te.write_shift(1,Y),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(1,1),te.write_shift(1,2),te.write_shift(4,0),te.write_shift(4,0),te}function o(H,te,re){var Y={s:{c:0,r:0},e:{c:0,r:0}};return te==8&&re.qpro?(Y.s.c=H.read_shift(1),H.l++,Y.s.r=H.read_shift(2),Y.e.c=H.read_shift(1),H.l++,Y.e.r=H.read_shift(2),Y):(Y.s.c=H.read_shift(2),Y.s.r=H.read_shift(2),te==12&&re.qpro&&(H.l+=2),Y.e.c=H.read_shift(2),Y.e.r=H.read_shift(2),te==12&&re.qpro&&(H.l+=2),Y.s.c==65535&&(Y.s.c=Y.e.c=Y.s.r=Y.e.r=0),Y)}function l(H){var te=_e(8);return te.write_shift(2,H.s.c),te.write_shift(2,H.s.r),te.write_shift(2,H.e.c),te.write_shift(2,H.e.r),te}function u(H,te,re){var Y=[{c:0,r:0},{t:"n",v:0},0,0];return re.qpro&&re.vers!=20768?(Y[0].c=H.read_shift(1),Y[3]=H.read_shift(1),Y[0].r=H.read_shift(2),H.l+=2):(Y[2]=H.read_shift(1),Y[0].c=H.read_shift(2),Y[0].r=H.read_shift(2)),Y}function f(H,te,re){var Y=H.l+te,ye=u(H,te,re);if(ye[1].t="s",re.vers==20768){H.l++;var Te=H.read_shift(1);return ye[1].v=H.read_shift(Te,"utf8"),ye}return re.qpro&&H.l++,ye[1].v=H.read_shift(Y-H.l,"cstr"),ye}function p(H,te,re){var Y=_e(7+re.length);Y.write_shift(1,255),Y.write_shift(2,te),Y.write_shift(2,H),Y.write_shift(1,39);for(var ye=0;ye<Y.length;++ye){var Te=re.charCodeAt(ye);Y.write_shift(1,Te>=128?95:Te)}return Y.write_shift(1,0),Y}function g(H,te,re){var Y=u(H,te,re);return Y[1].v=H.read_shift(2,"i"),Y}function m(H,te,re){var Y=_e(7);return Y.write_shift(1,255),Y.write_shift(2,te),Y.write_shift(2,H),Y.write_shift(2,re,"i"),Y}function y(H,te,re){var Y=u(H,te,re);return Y[1].v=H.read_shift(8,"f"),Y}function x(H,te,re){var Y=_e(13);return Y.write_shift(1,255),Y.write_shift(2,te),Y.write_shift(2,H),Y.write_shift(8,re,"f"),Y}function S(H,te,re){var Y=H.l+te,ye=u(H,te,re);if(ye[1].v=H.read_shift(8,"f"),re.qpro)H.l=Y;else{var Te=H.read_shift(2);M(H.slice(H.l,H.l+Te),ye),H.l+=Te}return ye}function A(H,te,re){var Y=te&32768;return te&=-32769,te=(Y?H:0)+(te>=8192?te-16384:te),(Y?"":"$")+(re?Hr(te):un(te))}var C={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function M(H,te){qn(H,0);for(var re=[],Y=0,ye="",Te="",Ve="",De="";H.l<H.length;){var Ne=H[H.l++];switch(Ne){case 0:re.push(H.read_shift(8,"f"));break;case 1:Te=A(te[0].c,H.read_shift(2),!0),ye=A(te[0].r,H.read_shift(2),!1),re.push(Te+ye);break;case 2:{var it=A(te[0].c,H.read_shift(2),!0),Z=A(te[0].r,H.read_shift(2),!1);Te=A(te[0].c,H.read_shift(2),!0),ye=A(te[0].r,H.read_shift(2),!1),re.push(it+Z+":"+Te+ye)}break;case 3:if(H.l<H.length){console.error("WK1 premature formula end");return}break;case 4:re.push("("+re.pop()+")");break;case 5:re.push(H.read_shift(2));break;case 6:{for(var Rt="";Ne=H[H.l++];)Rt+=String.fromCharCode(Ne);re.push('"'+Rt.replace(/"/g,'""')+'"')}break;case 8:re.push("-"+re.pop());break;case 23:re.push("+"+re.pop());break;case 22:re.push("NOT("+re.pop()+")");break;case 20:case 21:De=re.pop(),Ve=re.pop(),re.push(["AND","OR"][Ne-20]+"("+Ve+","+De+")");break;default:if(Ne<32&&E[Ne])De=re.pop(),Ve=re.pop(),re.push(Ve+E[Ne]+De);else if(C[Ne]){if(Y=C[Ne][1],Y==69&&(Y=H[H.l++]),Y>re.length){console.error("WK1 bad formula parse 0x"+Ne.toString(16)+":|"+re.join("|")+"|");return}var Et=re.slice(-Y);re.length-=Y,re.push(C[Ne][0]+"("+Et.join(",")+")")}else return Ne<=7?console.error("WK1 invalid opcode "+Ne.toString(16)):Ne<=24?console.error("WK1 unsupported op "+Ne.toString(16)):Ne<=30?console.error("WK1 invalid opcode "+Ne.toString(16)):Ne<=115?console.error("WK1 unsupported function opcode "+Ne.toString(16)):console.error("WK1 unrecognized opcode "+Ne.toString(16))}}re.length==1?te[1].f=""+re[0]:console.error("WK1 bad formula parse |"+re.join("|")+"|")}function X(H){var te=[{c:0,r:0},{t:"n",v:0},0];return te[0].r=H.read_shift(2),te[3]=H[H.l++],te[0].c=H[H.l++],te}function z(H,te){var re=X(H);return re[1].t="s",re[1].v=H.read_shift(te-4,"cstr"),re}function T(H,te,re,Y){var ye=_e(6+Y.length);ye.write_shift(2,H),ye.write_shift(1,re),ye.write_shift(1,te),ye.write_shift(1,39);for(var Te=0;Te<Y.length;++Te){var Ve=Y.charCodeAt(Te);ye.write_shift(1,Ve>=128?95:Ve)}return ye.write_shift(1,0),ye}function F(H,te){var re=X(H);re[1].v=H.read_shift(2);var Y=re[1].v>>1;if(re[1].v&1)switch(Y&7){case 0:Y=(Y>>3)*5e3;break;case 1:Y=(Y>>3)*500;break;case 2:Y=(Y>>3)/20;break;case 3:Y=(Y>>3)/200;break;case 4:Y=(Y>>3)/2e3;break;case 5:Y=(Y>>3)/2e4;break;case 6:Y=(Y>>3)/16;break;case 7:Y=(Y>>3)/64;break}return re[1].v=Y,re}function w(H,te){var re=X(H),Y=H.read_shift(4),ye=H.read_shift(4),Te=H.read_shift(2);if(Te==65535)return Y===0&&ye===3221225472?(re[1].t="e",re[1].v=15):Y===0&&ye===3489660928?(re[1].t="e",re[1].v=42):re[1].v=0,re;var Ve=Te&32768;return Te=(Te&32767)-16446,re[1].v=(1-Ve*2)*(ye*Math.pow(2,Te+32)+Y*Math.pow(2,Te)),re}function R(H,te,re,Y){var ye=_e(14);if(ye.write_shift(2,H),ye.write_shift(1,re),ye.write_shift(1,te),Y==0)return ye.write_shift(4,0),ye.write_shift(4,0),ye.write_shift(2,65535),ye;var Te=0,Ve=0,De=0,Ne=0;return Y<0&&(Te=1,Y=-Y),Ve=Math.log2(Y)|0,Y/=Math.pow(2,Ve-31),Ne=Y>>>0,Ne&2147483648||(Y/=2,++Ve,Ne=Y>>>0),Y-=Ne,Ne|=2147483648,Ne>>>=0,Y*=Math.pow(2,32),De=Y>>>0,ye.write_shift(4,De),ye.write_shift(4,Ne),Ve+=16383+(Te?32768:0),ye.write_shift(2,Ve),ye}function P(H,te){var re=w(H);return H.l+=te-14,re}function O(H,te){var re=X(H),Y=H.read_shift(4);return re[1].v=Y>>6,re}function D(H,te){var re=X(H),Y=H.read_shift(8,"f");return re[1].v=Y,re}function qe(H,te){var re=D(H);return H.l+=te-10,re}function Ee(H,te){return H[H.l+te-1]==0?H.read_shift(te,"cstr"):""}function Pe(H,te){var re=H[H.l++];re>te-1&&(re=te-1);for(var Y="";Y.length<re;)Y+=String.fromCharCode(H[H.l++]);return Y}function Fe(H,te,re){if(!(!re.qpro||te<21)){var Y=H.read_shift(1);H.l+=17,H.l+=1,H.l+=2;var ye=H.read_shift(te-21,"cstr");return[Y,ye]}}function Ae(H,te){for(var re={},Y=H.l+te;H.l<Y;){var ye=H.read_shift(2);if(ye==14e3){for(re[ye]=[0,""],re[ye][0]=H.read_shift(2);H[H.l];)re[ye][1]+=String.fromCharCode(H[H.l]),H.l++;H.l++}}return re}function ne(H,te){var re=_e(5+H.length);re.write_shift(2,14e3),re.write_shift(2,te);for(var Y=0;Y<H.length;++Y){var ye=H.charCodeAt(Y);re[re.l++]=ye>127?95:ye}return re[re.l++]=0,re}var be={0:{n:"BOF",f:vn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:y},15:{n:"LABEL",f},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ee},222:{n:"SHEETNAMELP",f:Pe},65535:{n:""}},je={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:z},23:{n:"NUMBER17",f:w},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:P},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ae},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:O},38:{n:"??"},39:{n:"NUMBER27",f:D},40:{n:"FORMULA28",f:qe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ee},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Fe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function S6(t){var e={},r=t.match(_i),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=pt(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=L1[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var w6=function(){var t=xf("t"),e=xf("rPr");function r(s){var a=s.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:er(a[1])},l=s.match(e);return l&&(o.s=S6(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),T6=function(){var e=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),A6=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,C6=/<(?:\w+:)?r>/,k6=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function cv(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=er(vr(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=vr(t),r&&(n.h=X1(n.t))):t.match(C6)&&(n.r=vr(t),n.t=er(vr((t.replace(k6,"").match(A6)||[]).join("").replace(_i,""))),r&&(n.h=T6(w6(n.r)))),n):{t:""}}var F6=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,b6=/<(?:\w+:)?(?:si|sstItem)>/g,I6=/<\/(?:\w+:)?(?:si|sstItem)>/;function N6(t,e){var r=[],n="";if(!t)return r;var i=t.match(F6);if(i){n=i[2].replace(b6,"").split(I6);for(var s=0;s!=n.length;++s){var a=cv(n[s].trim(),e);a!=null&&(r[r.length]=a)}i=pt(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var R6=/^\s|\s$|[\t\n\r]/;function $A(t,e){if(!e.bookSST)return"";var r=[dn];r[r.length]=Ge("sst",null,{xmlns:dc[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(R6)&&(s+=' xml:space="preserve"'),s+=">"+pr(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function D6(t){return[t.read_shift(4),t.read_shift(4)]}function P6(t,e){var r=[],n=!1;return po(t,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function O6(t,e){return e||(e=_e(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var M6=GR;function B6(t){var e=Xi();ke(e,159,O6(t));for(var r=0;r<t.length;++r)ke(e,19,M6(t[r]));return ke(e,160),e.end()}function GA(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Za(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function j6(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Za(t,4),e.U=Za(t,4),e.W=Za(t,4),e}function L6(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function U6(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(L6(t));return e}function V6(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function z6(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Za(t,4),e.U=Za(t,4),e.W=Za(t,4),e}function W6(t){var e=z6(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function KA(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function YA(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function H6(t){var e=Za(t);switch(e.Minor){case 2:return[e.Minor,$6(t)];case 3:return[e.Minor,G6()];case 4:return[e.Minor,K6(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function $6(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=KA(t,r),i=YA(t,t.length-t.l);return{t:"Std",h:n,v:i}}function G6(){throw new Error("File is password-protected: ECMA-376 Extensible")}function K6(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(_i,function(s){var a=pt(s);switch(Pa(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function Y6(t,e){var r={},n=r.EncryptionVersionInfo=Za(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=KA(t,i),e-=i,r.EncryptionVerifier=YA(t,e),r}function X6(t){var e={},r=e.EncryptionVersionInfo=Za(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function uv(t){var e=0,r,n=GA(t),i=n.length+1,s,a,o,l,u;for(r=dl(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=e&16384?1:0,l=e<<1&32767,u=o|l,e=u^a;return e^52811}var XA=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],l=104,u=a.length-1;u>=0;--u)for(var f=a[u],p=0;p!=7;++p)f&64&&(o^=r[l]),f*=2,--l;return o};return function(a){for(var o=GA(a),l=s(o),u=o.length,f=dl(16),p=0;p!=16;++p)f[p]=0;var g,m,y;for((u&1)===1&&(g=l>>8,f[u]=i(t[0],g),--u,g=l&255,m=o[o.length-1],f[u]=i(m,g));u>0;)--u,g=l>>8,f[u]=i(o[u],g),--u,g=l&255,f[u]=i(o[u],g);for(u=15,y=15-o.length;y>0;)g=l>>8,f[u]=i(t[y],g),--u,--y,g=l&255,f[u]=i(o[u],g),--u,--y;return f}}(),q6=function(t,e,r,n,i){i||(i=e),n||(n=XA(t));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},Q6=function(t){var e=0,r=XA(t);return function(n){var i=q6("",n,e,r);return e=i[1],i[0]}};function J6(t,e,r,n){var i={key:vn(t),verificationBytes:vn(t)};return r.password&&(i.verifier=uv(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=Q6(r.password)),i}function Z6(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=X6(t):n.Data=Y6(t,e),n}function eP(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?Z6(t,e-2,n):J6(t,r.biff>=8?e:e-2,r,n),n}var qA=function(){function t(i,s){switch(s.type){case"base64":return e(hs(i),s);case"binary":return e(i,s);case"buffer":return e(Mt&&Buffer.isBuffer(i)?i.toString("binary"):El(i),s);case"array":return e(Zl(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,p){Array.isArray(o)&&(o[p]=[]);for(var g=/\\\w+\b/g,m=0,y,x=-1;y=g.exec(f);){switch(y[0]){case"\\cell":var S=f.slice(m,g.lastIndex-y[0].length);if(S[0]==" "&&(S=S.slice(1)),++x,S.length){var A={v:S,t:"s"};Array.isArray(o)?o[p][x]=A:o[ht({r:p,c:x})]=A}break}m=g.lastIndex}x>u.e.c&&(u.e.c=x)}),o["!ref"]=bt(u),o}function r(i,s){return Sl(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=tr(i["!ref"]),o,l=Array.isArray(i),u=a.s.r;u<=a.e.r;++u){s.push("\\trowd\\trautofit1");for(var f=a.s.c;f<=a.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=a.s.c;f<=a.e.c;++f){var p=ht({r:u,c:f});o=l?(i[u]||[])[f]:i[p],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(so(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function tP(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Ef(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function rP(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),a=i-s;if(a===0)return[0,0,e];var o=0,l=0,u=i+s;switch(l=a/(u>1?2-u:u),i){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,l,u/2]}function nP(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=i*o,a[0]+=i,a[1]+=l;break;case 1:l=i*(2-o),a[0]+=l,a[1]+=i;break;case 2:l=i*(o-2),a[1]+=i,a[2]+=l;break;case 3:l=i*(4-o),a[1]+=l,a[2]+=i;break;case 4:l=i*(o-4),a[2]+=i,a[0]+=l;break;case 5:l=i*(6-o),a[2]+=l,a[0]+=i;break}for(var u=0;u!=3;++u)a[u]=Math.round(a[u]*255);return a}function sp(t,e){if(e===0)return t;var r=rP(tP(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),Ef(nP(r))}var QA=6,iP=15,sP=1,hi=QA;function Sf(t){return Math.floor((t+Math.round(128/hi)/256)*hi)}function wf(t){return Math.floor((t-5)/hi*100+.5)/100}function ap(t){return Math.round((t*hi+5)/hi*256)/256}function Kg(t){return ap(wf(Sf(t)))}function dv(t){var e=Math.abs(t-Kg(t)),r=hi;if(e>.005)for(hi=sP;hi<iP;++hi)Math.abs(t-Kg(t))<=e&&(e=Math.abs(t-Kg(t)),r=hi);hi=r}function fl(t){t.width?(t.wpx=Sf(t.width),t.wch=wf(t.wpx),t.MDW=hi):t.wpx?(t.wch=wf(t.wpx),t.width=ap(t.wch),t.MDW=hi):typeof t.wch=="number"&&(t.width=ap(t.wch),t.wpx=Sf(t.width),t.MDW=hi),t.customWidth&&delete t.customWidth}var aP=96,JA=aP;function Tf(t){return t*96/JA}function Su(t){return t*JA/96}var oP={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function lP(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(_i)||[]).forEach(function(a){var o=pt(a);switch(Pa(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=br(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=br(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function cP(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(_i)||[]).forEach(function(a){var o=pt(a);switch(Pa(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function uP(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(_i)||[]).forEach(function(a){var o=pt(a);switch(Pa(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=vr(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?br(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?br(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?br(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?br(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?br(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?br(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?br(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=L1[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=br(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=Vl[i.color.index];i.color.index==81&&(l=Vl[1]),l||(l=Vl[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=sp(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function dP(t,e,r){e.NumberFmt=[];for(var n=en(ft),i=0;i<n.length;++i)e.NumberFmt[n[i]]=ft[n[i]];var s=t[0].match(_i);if(s)for(i=0;i<s.length;++i){var a=pt(s[i]);switch(Pa(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=er(vr(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}Ja(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function fP(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Ge("numFmt",null,{numFmtId:n,formatCode:pr(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Ge("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var V0=["numFmtId","fillId","fontId","borderId","xfId"],z0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function hP(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(_i)||[]).forEach(function(s){var a=pt(s),o=0;switch(Pa(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<V0.length;++o)n[V0[o]]&&(n[V0[o]]=parseInt(n[V0[o]],10));for(o=0;o<z0.length;++o)n[z0[o]]&&(n[z0[o]]=br(n[z0[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=br(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function pP(t){var e=[];return e[e.length]=Ge("cellXfs",null),t.forEach(function(r){e[e.length]=Ge("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Ge("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var gP=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,u){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=o.match(e))&&dP(p,f,u),(p=o.match(i))&&uP(p,f,l,u),(p=o.match(n))&&cP(p,f,l,u),(p=o.match(s))&&lP(p,f,l,u),(p=o.match(r))&&hP(p,f,u),f}}();function ZA(t,e){var r=[dn,Ge("styleSheet",null,{xmlns:dc[0],"xmlns:vt":kn.vt})],n;return t.SSF&&(n=fP(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=pP(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function mP(t,e){var r=t.read_shift(2),n=mi(t);return[r,n]}function xP(t,e,r){r||(r=_e(6+4*e.length)),r.write_shift(2,t),zn(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function vP(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=ZR(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=JR(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=mi(t),n}function yP(t,e){e||(e=_e(25+4*32)),e.write_shift(2,t.sz*20),eD(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),rp(t.color,e);var n=0;return n=2,e.write_shift(1,n),zn(t.name,e),e.length>e.l?e.slice(0,e.l):e}var _P=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Yg,EP=vi;function N_(t,e){e||(e=_e(4*3+8*7+16*1)),Yg||(Yg=Wp(_P));var r=Yg[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(rp({auto:1},e),rp({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function SP(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function eC(t,e,r){r||(r=_e(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function dd(t,e){return e||(e=_e(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var wP=vi;function TP(t,e){return e||(e=_e(51)),e.write_shift(1,0),dd(null,e),dd(null,e),dd(null,e),dd(null,e),dd(null,e),e.length>e.l?e.slice(0,e.l):e}function AP(t,e){return e||(e=_e(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),tp(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function CP(t,e,r){var n=_e(2052);return n.write_shift(4,t),tp(e,n),tp(r,n),n.length>n.l?n.slice(0,n.l):n}function kP(t,e,r){var n={};n.NumberFmt=[];for(var i in ft)n.NumberFmt[i]=ft[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return po(t,function(l,u,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],Ja(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=sp(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(f),a=!0;break;case 38:s.pop(),a=!1;break;default:if(u.T>0)s.push(f);else if(u.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function FP(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(ke(t,615,na(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&ke(t,44,xP(i,e[i]))}),ke(t,616))}}function bP(t){var e=1;ke(t,611,na(e)),ke(t,43,yP({sz:12,color:{theme:1},name:"Calibri",family:2})),ke(t,612)}function IP(t){var e=2;ke(t,603,na(e)),ke(t,45,N_({patternType:"none"})),ke(t,45,N_({patternType:"gray125"})),ke(t,604)}function NP(t){var e=1;ke(t,613,na(e)),ke(t,46,TP()),ke(t,614)}function RP(t){var e=1;ke(t,626,na(e)),ke(t,47,eC({numFmtId:0},65535)),ke(t,627)}function DP(t,e){ke(t,617,na(e.length)),e.forEach(function(r){ke(t,47,eC(r,0))}),ke(t,618)}function PP(t){var e=1;ke(t,619,na(e)),ke(t,48,AP({xfId:0,name:"Normal"})),ke(t,620)}function OP(t){var e=0;ke(t,505,na(e)),ke(t,506)}function MP(t){var e=0;ke(t,508,CP(e,"TableStyleMedium9","PivotStyleMedium4")),ke(t,509)}function BP(t,e){var r=Xi();return ke(r,278),FP(r,t.SSF),bP(r),IP(r),NP(r),RP(r),DP(r,e.cellXfs),PP(r),OP(r),MP(r),ke(r,279),r.end()}var jP=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function LP(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(_i)||[]).forEach(function(i){var s=pt(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[jP.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function UP(){}function VP(){}var zP=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,WP=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,HP=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function $P(t,e,r){e.themeElements={};var n;[["clrScheme",zP,LP],["fontScheme",WP,UP],["fmtScheme",HP,VP]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var GP=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function tC(t,e){(!t||t.length===0)&&(t=fv());var r,n={};if(!(r=t.match(GP)))throw new Error("themeElements not found in theme");return $P(r[0],n,e),n.raw=t,n}function fv(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[dn];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function KP(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var a;try{a=KT(s,{type:"array"})}catch{return}var o=ls(a,"theme/theme/theme1.xml",!0);if(o)return tC(o,r)}}function YP(t){return t.read_shift(4)}function XP(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=qP(t,4);break;case 2:e.xclrValue=PA(t);break;case 3:e.xclrValue=YP(t);break;case 4:t.l+=4;break}return t.l+=8,e}function qP(t,e){return vi(t,e)}function QP(t,e){return vi(t,e)}function JP(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=XP(t);break;case 6:n[1]=QP(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function ZP(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push(JP(t,r-t.l));return{ixfe:n,ext:s}}function e8(t,e){e.forEach(function(r){switch(r[0]){}})}function t8(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:mi(t)}}function r8(t){var e=_e(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),zn(t.name,e),e.slice(0,e.l)}function n8(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function i8(t){var e=_e(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function s8(t,e){var r=_e(8+2*e.length);return r.write_shift(4,t),zn(e,r),r.slice(0,r.l)}function a8(t){return t.l+=4,t.read_shift(4)!=0}function o8(t,e){var r=_e(8);return r.write_shift(4,t),r.write_shift(4,1),r}function l8(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return po(t,function(l,u,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(p){o==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):o==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(f),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!u.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function c8(){var t=Xi();return ke(t,332),ke(t,334,na(1)),ke(t,335,r8({name:"XLDAPR",version:12e4,flags:3496657072})),ke(t,336),ke(t,339,s8(1,"XLDAPR")),ke(t,52),ke(t,35,na(514)),ke(t,4096,na(0)),ke(t,4097,bs(1)),ke(t,36),ke(t,53),ke(t,340),ke(t,337,o8(1)),ke(t,51,i8([[1,0]])),ke(t,338),ke(t,333),t.end()}function u8(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,a;return t.replace(_i,function(o){var l=pt(o);switch(Pa(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(a=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function rC(){var t=[dn];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function d8(t){var e=[];if(!t)return e;var r=1;return(t.match(_i)||[]).forEach(function(n){var i=pt(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function f8(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=ht(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function h8(t,e,r){var n=[];return po(t,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function p8(t,e,r,n){if(!t)return t;var i=n||{},s=!1;po(t,function(o,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},i)}function g8(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Qc=1024;function nC(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Ge("xml",null,{"xmlns:v":ss.v,"xmlns:o":ss.o,"xmlns:x":ss.x,"xmlns:mv":ss.mv}).replace(/\/>/,">"),Ge("o:shapelayout",Ge("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Ge("v:shapetype",[Ge("v:stroke",null,{joinstyle:"miter"}),Ge("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Qc<t*1e3;)Qc+=1e3;return e.forEach(function(s){var a=$r(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?Ge("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Ge("v:fill",l,o),f={on:"t",obscured:"t"};++Qc,i=i.concat(["<v:shape"+vf({id:"_x0000_s"+Qc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Ge("v:shadow",null,f),Ge("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Qn("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Qn("x:AutoFill","False"),Qn("x:Row",String(a.r)),Qn("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function R_(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(a){var o=$r(a.ref);if(i?(t[o.r]||(t[o.r]=[]),s=t[o.r][o.c]):s=t[a.ref],!s){s={t:"z"},i?t[o.r][o.c]=s:t[a.ref]=s;var l=tr(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var u=bt(l);u!==t["!ref"]&&(t["!ref"]=u)}s.c||(s.c=[]);var f={a:a.author,t:a.t,r:a.r,T:r};a.h&&(f.h=a.h);for(var p=s.c.length-1;p>=0;--p){if(!r&&s.c[p].T)return;r&&!s.c[p].T&&s.c.splice(p,1)}if(r&&n){for(p=0;p<n.length;++p)if(f.a==n[p].id){f.a=n[p].name||f.a;break}}s.c.push(f)})}function m8(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=pt(o[0]),u={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=$r(l.ref);if(!(e.sheetRows&&e.sheetRows<=f.r)){var p=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!p&&!!p[1]&&cv(p[1])||{r:"",t:"",h:""};u.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),u.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(u.h=g.h),n.push(u)}}}}),n}function iC(t){var e=[dn,Ge("comments",null,{xmlns:dc[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=pr(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(pr(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Qn("t",pr(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(Qn("t",pr(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function x8(t,e){var r=[],n=!1,i={},s=0;return t.replace(_i,function(o,l){var u=pt(o);switch(Pa(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":i.t=t.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function v8(t,e,r){var n=[dn,Ge("ThreadedComments",null,{xmlns:kn.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(Ge("threadedComment",Qn("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function y8(t,e){var r=[],n=!1;return t.replace(_i,function(s){var a=pt(s);switch(Pa(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function _8(t){var e=[dn,Ge("personList",null,{xmlns:kn.TCMNT,"xmlns:x":dc[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Ge("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function E8(t){var e={};e.iauthor=t.read_shift(4);var r=gc(t);return e.rfx=r.s,e.ref=ht(r.s),t.l+=16,e}function S8(t,e){return e==null&&(e=_e(36)),e.write_shift(4,t[1].iauthor),ju(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var w8=mi;function T8(t){return zn(t.slice(0,54))}function A8(t,e){var r=[],n=[],i={},s=!1;return po(t,function(o,l,u){switch(u){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function C8(t){var e=Xi(),r=[];return ke(e,628),ke(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),ke(e,632,T8(i.a)))})}),ke(e,631),ke(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:$r(n[0]),e:$r(n[0])};ke(e,635,S8([s,i])),i.t&&i.t.length>0&&ke(e,637,YR(i)),ke(e,636),delete i.iauthor})}),ke(e,634),ke(e,629),e.end()}var k8="application/vnd.ms-office.vbaProject";function F8(t){var e=st.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");st.utils.cfb_add(e,i,t.FileIndex[n].content)}}),st.write(e)}function b8(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&st.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var sC=["xlsb","xlsm","xlam","biff8","xla"];function I8(){return{"!type":"dialog"}}function N8(){return{"!type":"dialog"}}function R8(){return{"!type":"macro"}}function D8(){return{"!type":"macro"}}var ou=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,f=a.length>0?parseInt(a,10)|0:0;return o?f+=e.c:--f,l?u+=e.r:--u,i+(o?"":"$")+Hr(f)+(l?"":"$")+un(u)}return function(i,s){return e=s,i.replace(t,r)}}(),hv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,pv=function(){return function(e,r){return e.replace(hv,function(n,i,s,a,o,l){var u=ev(a)-(s?0:r.c),f=Z1(l)-(o?0:r.r),p=f==0?"":o?f+1:"["+f+"]",g=u==0?"":s?u+1:"["+u+"]";return i+"R"+p+"C"+g})}}();function aC(t,e){return t.replace(hv,function(r,n,i,s,a,o){return n+(i=="$"?i+s:Hr(ev(s)+e.c))+(a=="$"?a+o:un(Z1(o)+e.r))})}function P8(t,e,r){var n=qi(e),i=n.s,s=$r(r),a={r:s.r-i.r,c:s.c-i.c};return aC(t,a)}function O8(t){return t.length!=1}function D_(t){return t.replace(/_xlfn\./g,"")}function pn(t){t.l+=1}function hl(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function oC(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return lC(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=hl(t),o=hl(t);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function lC(t){var e=hl(t),r=hl(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function M8(t,e,r){if(r.biff<8)return lC(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=hl(t),a=hl(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function cC(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return B8(t);var n=t.read_shift(r&&r.biff==12?4:2),i=hl(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function B8(t){var e=hl(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function j8(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function L8(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return U8(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function U8(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function V8(t,e,r){var n=(t[t.l++]&96)>>5,i=oC(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function z8(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=oC(t,s,r);return[n,i,a]}function W8(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function H8(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function $8(t,e,r){var n=(t[t.l++]&96)>>5,i=M8(t,e-1,r);return[n,i]}function G8(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function P_(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function K8(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function Y8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function X8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function q8(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function Q8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function uC(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function J8(t){return t.read_shift(2),uC(t)}function Z8(t){return t.read_shift(2),uC(t)}function e5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=cC(t,0,r);return[n,i]}function t5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=L8(t,0,r);return[n,i]}function r5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=cC(t,0,r);return[n,i,s]}function n5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[aO[i],hC[i],n]}function i5(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:s5(t);return[i,(s[0]===0?hC:sO)[s[1]]]}function s5(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function a5(t,e,r){t.l+=r&&r.biff==2?3:4}function o5(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function l5(t){return t.l++,go[t.read_shift(1)]}function c5(t){return t.l++,t.read_shift(2)}function u5(t){return t.l++,t.read_shift(1)!==0}function d5(t){return t.l++,gi(t)}function f5(t,e,r){return t.l++,$f(t,e-1,r)}function h5(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=on(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=go[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=gi(t);break;case 2:r[1]=mc(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function p5(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?gc:Gp)(t));return i}function g5(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=h5(t,r.biff);return a}function m5(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function x5(t,e,r){if(r.biff==5)return v5(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function v5(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function y5(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function _5(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function E5(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function S5(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var w5=vi,T5=vi,A5=vi;function Kf(t,e,r){return t.l+=2,[j8(t)]}function gv(t){return t.l+=6,[]}var C5=Kf,k5=gv,F5=gv,b5=Kf;function dC(t){return t.l+=2,[vn(t),t.read_shift(2)&1]}var I5=Kf,N5=dC,R5=gv,D5=Kf,P5=Kf,O5=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function M5(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=O5[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function B5(t){return t.l+=2,[t.read_shift(4)]}function j5(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function L5(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function U5(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function V5(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function z5(t){return t.l+=4,[0,0]}var O_={1:{n:"PtgExp",f:o5},2:{n:"PtgTbl",f:A5},3:{n:"PtgAdd",f:pn},4:{n:"PtgSub",f:pn},5:{n:"PtgMul",f:pn},6:{n:"PtgDiv",f:pn},7:{n:"PtgPower",f:pn},8:{n:"PtgConcat",f:pn},9:{n:"PtgLt",f:pn},10:{n:"PtgLe",f:pn},11:{n:"PtgEq",f:pn},12:{n:"PtgGe",f:pn},13:{n:"PtgGt",f:pn},14:{n:"PtgNe",f:pn},15:{n:"PtgIsect",f:pn},16:{n:"PtgUnion",f:pn},17:{n:"PtgRange",f:pn},18:{n:"PtgUplus",f:pn},19:{n:"PtgUminus",f:pn},20:{n:"PtgPercent",f:pn},21:{n:"PtgParen",f:pn},22:{n:"PtgMissArg",f:pn},23:{n:"PtgStr",f:f5},26:{n:"PtgSheet",f:j5},27:{n:"PtgEndSheet",f:L5},28:{n:"PtgErr",f:l5},29:{n:"PtgBool",f:u5},30:{n:"PtgInt",f:c5},31:{n:"PtgNum",f:d5},32:{n:"PtgArray",f:G8},33:{n:"PtgFunc",f:n5},34:{n:"PtgFuncVar",f:i5},35:{n:"PtgName",f:m5},36:{n:"PtgRef",f:e5},37:{n:"PtgArea",f:V8},38:{n:"PtgMemArea",f:y5},39:{n:"PtgMemErr",f:w5},40:{n:"PtgMemNoMem",f:T5},41:{n:"PtgMemFunc",f:_5},42:{n:"PtgRefErr",f:E5},43:{n:"PtgAreaErr",f:W8},44:{n:"PtgRefN",f:t5},45:{n:"PtgAreaN",f:$8},46:{n:"PtgMemAreaN",f:U5},47:{n:"PtgMemNoMemN",f:V5},57:{n:"PtgNameX",f:x5},58:{n:"PtgRef3d",f:r5},59:{n:"PtgArea3d",f:z8},60:{n:"PtgRefErr3d",f:S5},61:{n:"PtgAreaErr3d",f:H8},255:{}},W5={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},H5={1:{n:"PtgElfLel",f:dC},2:{n:"PtgElfRw",f:D5},3:{n:"PtgElfCol",f:C5},6:{n:"PtgElfRwV",f:P5},7:{n:"PtgElfColV",f:b5},10:{n:"PtgElfRadical",f:I5},11:{n:"PtgElfRadicalS",f:R5},13:{n:"PtgElfColS",f:k5},15:{n:"PtgElfColSV",f:F5},16:{n:"PtgElfRadicalLel",f:N5},25:{n:"PtgList",f:M5},29:{n:"PtgSxName",f:B5},255:{}},$5={0:{n:"PtgAttrNoop",f:z5},1:{n:"PtgAttrSemi",f:Q8},2:{n:"PtgAttrIf",f:X8},4:{n:"PtgAttrChoose",f:K8},8:{n:"PtgAttrGoto",f:Y8},16:{n:"PtgAttrSum",f:a5},32:{n:"PtgAttrBaxcel",f:P_},33:{n:"PtgAttrBaxcel",f:P_},64:{n:"PtgAttrSpace",f:J8},65:{n:"PtgAttrSpaceSemi",f:Z8},128:{n:"PtgAttrIfError",f:q8},255:{}};function Yf(t,e,r,n){if(n.biff<8)return vi(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=g5(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=p5(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(vi(t,e)),s}function Xf(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=O_[s]||O_[W5[s]],(s===24||s===25)&&(i=(s===24?H5:$5)[t[t.l+1]]),!i||!i.f?vi(t,e):a.push([i.n,i.f(t,e,r)]);return a}function G5(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var K5={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Y5(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function fC(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function M_(t,e,r){var n=fC(t,e,r);return n=="#REF"?n:Y5(n,r)}function di(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,u,f,p=0,g=0,m,y="";if(!t[0]||!t[0][0])return"";for(var x=-1,S="",A=0,C=t[0].length;A<C;++A){var E=t[0][A];switch(E[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),x>=0){switch(t[0][x][1][0]){case 0:S=Qr(" ",t[0][x][1][1]);break;case 1:S=Qr("\r",t[0][x][1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}u=u+S,x=-1}o.push(u+K5[E[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=jd(E[1][1],a,i),o.push(Ld(f,s));break;case"PtgRefN":f=r?jd(E[1][1],r,i):E[1][1],o.push(Ld(f,s));break;case"PtgRef3d":p=E[1][1],f=jd(E[1][2],a,i),y=M_(n,p,i),o.push(y+"!"+Ld(f,s));break;case"PtgFunc":case"PtgFuncVar":var M=E[1][0],X=E[1][1];M||(M=0),M&=127;var z=M==0?[]:o.slice(-M);o.length-=M,X==="User"&&(X=z.shift()),o.push(X+"("+z.join(",")+")");break;case"PtgBool":o.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(E[1]);break;case"PtgNum":o.push(String(E[1]));break;case"PtgStr":o.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(E[1]);break;case"PtgAreaN":m=d_(E[1][1],r?{s:r}:a,i),o.push(Hg(m,i));break;case"PtgArea":m=d_(E[1][1],a,i),o.push(Hg(m,i));break;case"PtgArea3d":p=E[1][1],m=E[1][2],y=M_(n,p,i),o.push(y+"!"+Hg(m,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=E[1][2];var T=(n.names||[])[g-1]||(n[0]||[])[g],F=T?T.Name:"SH33TJSNAME"+String(g);F&&F.slice(0,6)=="_xlfn."&&!i.xlfn&&(F=F.slice(6)),o.push(F);break;case"PtgNameX":var w=E[1][1];g=E[1][2];var R;if(i.biff<=5)w<0&&(w=-w),n[w]&&(R=n[w][g]);else{var P="";if(((n[w]||[])[0]||[])[0]==14849||(((n[w]||[])[0]||[])[0]==1025?n[w][g]&&n[w][g].itab>0&&(P=n.SheetNames[n[w][g].itab-1]+"!"):P=n.SheetNames[g-1]+"!"),n[w]&&n[w][g])P+=n[w][g].Name;else if(n[0]&&n[0][g])P+=n[0][g].Name;else{var O=(fC(n,w,i)||"").split(";;");O[g-1]?P=O[g-1]:P+="SH33TJSERRX"}o.push(P);break}R||(R={Name:"SH33TJSERRY"}),o.push(R.Name);break;case"PtgParen":var D="(",qe=")";if(x>=0){switch(S="",t[0][x][1][0]){case 2:D=Qr(" ",t[0][x][1][1])+D;break;case 3:D=Qr("\r",t[0][x][1][1])+D;break;case 4:qe=Qr(" ",t[0][x][1][1])+qe;break;case 5:qe=Qr("\r",t[0][x][1][1])+qe;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}x=-1}o.push(D+o.pop()+qe);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:E[1][1],r:E[1][0]};var Ee={c:r.c,r:r.r};if(n.sharedf[ht(f)]){var Pe=n.sharedf[ht(f)];o.push(di(Pe,a,Ee,n,i))}else{var Fe=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){o.push(di(u[1],a,Ee,n,i)),Fe=!0;break}Fe||o.push(E[1])}break;case"PtgArray":o.push("{"+G5(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=A;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var Ae=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&Ae.indexOf(t[0][A][0])==-1){E=t[0][x];var ne=!0;switch(E[1][0]){case 4:ne=!1;case 0:S=Qr(" ",E[1][1]);break;case 5:ne=!1;case 1:S=Qr("\r",E[1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}o.push((ne?S:"")+o.pop()+(ne?"":S)),x=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function X5(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],vi(t,e-2)];var o=Xf(t,a,r);return e!==a+i&&(s=Yf(t,e-a-i,o,r)),t.l=n,[o,s]}function q5(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],vi(t,e-2)];var o=Xf(t,a,r);return e!==a+i&&(s=Yf(t,e-a-i,o,r)),t.l=n,[o,s]}function Q5(t,e,r,n){var i=t.l+e,s=Xf(t,n,r),a;return i!==t.l&&(a=Yf(t,i-t.l,s,r)),[s,a]}function J5(t,e,r){var n=t.l+e,i,s=t.read_shift(2),a=Xf(t,s,r);return s==65535?[[],vi(t,e-2)]:(e!==s+2&&(i=Yf(t,n-s-2,a,r)),[a,i])}function Z5(t){var e;if(Ga(t,t.l+6)!==65535)return[gi(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function eO(t){if(t==null){var e=_e(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return ec(t);return ec(0)}function Xg(t,e,r){var n=t.l+e,i=Oa(t);r.biff==2&&++t.l;var s=Z5(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=q5(t,n-t.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function tO(t,e,r,n,i){var s=rc(e,r,i),a=eO(t.v),o=_e(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=_e(t.bf.length),f=0;f<t.bf.length;++f)u[f]=t.bf[f];var p=Vn([s,a,o,u]);return p}function Kp(t,e,r){var n=t.read_shift(4),i=Xf(t,n,r),s=t.read_shift(4),a=s>0?Yf(t,s,i,r):null;return[i,a]}var rO=Kp,Yp=Kp,nO=Kp,iO=Kp,sO={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},hC={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},aO={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function B_(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function oO(t){var e="of:="+t.replace(hv,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function qg(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function lO(t){return t.replace(/\./,"!")}var Vd={},lu={},zd=typeof Map<"u";function mv(t,e,r){var n=0,i=t.length;if(r){if(zd?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=zd?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(zd?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function Xp(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(hi=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=wf(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=ap(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Hl(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function wl(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Ja(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function pC(t,e,r,n,i,s){try{n.cellNF&&(t.z=ft[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Nr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(ft[e]==null&&Ja(sR[e]||"General",e),t.t==="e")t.w=t.w||go[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=mf(t.v);else if(t.t==="d"){var a=Nn(t.v);(a|0)===a?t.w=a.toString(10):t.w=mf(a)}else{if(t.v===void 0)return"";t.w=Jl(t.v,lu)}else t.t==="d"?t.w=js(e,Nn(t.v),lu):t.w=js(e,t.v,lu)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=sp(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=sp(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function cO(t,e,r){if(t&&t["!ref"]){var n=tr(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function uO(t,e){var r=tr(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=bt(r))}var dO=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,fO=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,hO=/<(?:\w:)?hyperlink [^>]*>/mg,pO=/"(\w*:\w*)"/,gO=/<(?:\w:)?col\b[^>]*[\/]?>/g,mO=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,xO=/<(?:\w:)?pageMargins[^>]*\/>/g,gC=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,vO=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,yO=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function _O(t,e,r,n,i,s,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",f="",p=t.match(fO);p?(u=t.slice(0,p.index),f=t.slice(p.index+p[0].length)):u=f=t;var g=u.match(gC);g?xv(g[0],o,i,r):(g=u.match(vO))&&SO(g[0],g[1]||"",o,i,r);var m=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var y=u.slice(m,m+50).match(pO);y&&uO(o,y[1])}var x=u.match(yO);x&&x[1]&&OO(x[1],i);var S=[];if(e.cellStyles){var A=u.match(gO);A&&IO(S,A)}p&&jO(p[1],o,e,l,s,a);var C=f.match(mO);C&&(o["!autofilter"]=RO(C[0]));var E=[],M=f.match(dO);if(M)for(m=0;m!=M.length;++m)E[m]=tr(M[m].slice(M[m].indexOf('"')+1));var X=f.match(hO);X&&kO(o,X,n);var z=f.match(xO);if(z&&(o["!margins"]=FO(pt(z[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=bt(l)),e.sheetRows>0&&o["!ref"]){var T=tr(o["!ref"]);e.sheetRows<=+T.e.r&&(T.e.r=e.sheetRows-1,T.e.r>l.e.r&&(T.e.r=l.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>l.e.c&&(T.e.c=l.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),o["!fullref"]=o["!ref"],o["!ref"]=bt(T))}return S.length>0&&(o["!cols"]=S),E.length>0&&(o["!merges"]=E),o}function EO(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+bt(t[r])+'"/>';return e+"</mergeCells>"}function xv(t,e,r,n){var i=pt(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=er(vr(i.codeName)))}function SO(t,e,r,n,i){xv(t.slice(0,t.indexOf(">")),r,n,i)}function wO(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=Aa(pr(l))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),o=(o||"")+Ge("outlinePr",null,u)}!s&&!o||(i[i.length]=Ge("sheetPr",o,a))}var TO=["objects","scenarios","selectLockedCells","selectUnlockedCells"],AO=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function CO(t){var e={sheet:1};return TO.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),AO.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=uv(t.password).toString(16).toUpperCase()),Ge("sheetProtection",null,e)}function kO(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=pt(vr(e[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+er(s.location))):(s.Target="#"+er(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=tr(s.ref),l=o.s.r;l<=o.e.r;++l)for(var u=o.s.c;u<=o.e.c;++u){var f=ht({c:u,r:l});n?(t[l]||(t[l]=[]),t[l][u]||(t[l][u]={t:"z",v:void 0}),t[l][u].l=s):(t[f]||(t[f]={t:"z",v:void 0}),t[f].l=s)}}}function FO(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function bO(t){return Hl(t),Ge("pageMargins",null,t)}function IO(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=pt(e[n],!0);i.hidden&&(i.hidden=br(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,dv(i.width)),fl(i);s<=a;)t[s++]=Rr(i)}}function NO(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=Ge("col",null,Xp(i,n)));return r[r.length]="</cols>",r.join("")}function RO(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function DO(t,e,r,n){var i=typeof t.ref=="string"?t.ref:bt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=qi(i);a.s.r==a.e.r&&(a.e.r=qi(e["!ref"]).e.r,i=bt(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Ge("autoFilter",null,{ref:i})}var PO=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function OO(t,e){e.Views||(e.Views=[{}]),(t.match(PO)||[]).forEach(function(r,n){var i=pt(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),br(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function MO(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ge("sheetViews",Ge("sheetView",null,i),{})}function BO(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=go[t.v];break;case"d":n&&n.cellDates?i=Nr(t.v,-1).toISOString():(t=Rr(t),t.t="n",i=""+(t.v=Nn(Nr(t.v)))),typeof t.z>"u"&&(t.z=ft[14]);break;default:i=t.v;break}var o=Qn("v",pr(i)),l={r:e},u=wl(n.cellXfs,t,n);switch(u!==0&&(l.s=u),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Qn("v",""+mv(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=a),typeof t.f=="string"&&t.f){var f=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=Ge("f",pr(t.f),f)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),Ge("c",o,l)}var jO=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=xf("v"),a=xf("f");return function(l,u,f,p,g,m){for(var y=0,x="",S=[],A=[],C=0,E=0,M=0,X="",z,T,F=0,w=0,R,P,O=0,D=0,qe=Array.isArray(m.CellXf),Ee,Pe=[],Fe=[],Ae=Array.isArray(u),ne=[],be={},je=!1,H=!!f.sheetStubs,te=l.split(e),re=0,Y=te.length;re!=Y;++re){x=te[re].trim();var ye=x.length;if(ye!==0){var Te=0;e:for(y=0;y<ye;++y)switch(x[y]){case">":if(x[y-1]!="/"){++y;break e}if(f&&f.cellStyles){if(T=pt(x.slice(Te,y),!0),F=T.r!=null?parseInt(T.r,10):F+1,w=-1,f.sheetRows&&f.sheetRows<F)continue;be={},je=!1,T.ht&&(je=!0,be.hpt=parseFloat(T.ht),be.hpx=Su(be.hpt)),T.hidden=="1"&&(je=!0,be.hidden=!0),T.outlineLevel!=null&&(je=!0,be.level=+T.outlineLevel),je&&(ne[F-1]=be)}break;case"<":Te=y;break}if(Te>=y)break;if(T=pt(x.slice(Te,y),!0),F=T.r!=null?parseInt(T.r,10):F+1,w=-1,!(f.sheetRows&&f.sheetRows<F)){p.s.r>F-1&&(p.s.r=F-1),p.e.r<F-1&&(p.e.r=F-1),f&&f.cellStyles&&(be={},je=!1,T.ht&&(je=!0,be.hpt=parseFloat(T.ht),be.hpx=Su(be.hpt)),T.hidden=="1"&&(je=!0,be.hidden=!0),T.outlineLevel!=null&&(je=!0,be.level=+T.outlineLevel),je&&(ne[F-1]=be)),S=x.slice(y).split(t);for(var Ve=0;Ve!=S.length&&S[Ve].trim().charAt(0)=="<";++Ve);for(S=S.slice(Ve),y=0;y!=S.length;++y)if(x=S[y].trim(),x.length!==0){if(A=x.match(r),C=y,E=0,M=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,A!=null&&A.length===2){for(C=0,X=A[1],E=0;E!=X.length&&!((M=X.charCodeAt(E)-64)<1||M>26);++E)C=26*C+M;--C,w=C}else++w;for(E=0;E!=x.length&&x.charCodeAt(E)!==62;++E);if(++E,T=pt(x.slice(0,E),!0),T.r||(T.r=ht({r:F-1,c:w})),X=x.slice(E),z={t:""},(A=X.match(s))!=null&&A[1]!==""&&(z.v=er(A[1])),f.cellFormula){if((A=X.match(a))!=null&&A[1]!==""){if(z.f=er(vr(A[1])).replace(/\r\n/g,`
`),f.xlfn||(z.f=D_(z.f)),A[0].indexOf('t="array"')>-1)z.F=(X.match(i)||[])[1],z.F.indexOf(":")>-1&&Pe.push([tr(z.F),z.F]);else if(A[0].indexOf('t="shared"')>-1){P=pt(A[0]);var De=er(vr(A[1]));f.xlfn||(De=D_(De)),Fe[parseInt(P.si,10)]=[P,De,T.r]}}else(A=X.match(/<f[^>]*\/>/))&&(P=pt(A[0]),Fe[P.si]&&(z.f=P8(Fe[P.si][1],Fe[P.si][2],T.r)));var Ne=$r(T.r);for(E=0;E<Pe.length;++E)Ne.r>=Pe[E][0].s.r&&Ne.r<=Pe[E][0].e.r&&Ne.c>=Pe[E][0].s.c&&Ne.c<=Pe[E][0].e.c&&(z.F=Pe[E][1])}if(T.t==null&&z.v===void 0)if(z.f||z.F)z.v=0,z.t="n";else if(H)z.t="z";else continue;else z.t=T.t||"n";switch(p.s.c>w&&(p.s.c=w),p.e.c<w&&(p.e.c=w),z.t){case"n":if(z.v==""||z.v==null){if(!H)continue;z.t="z"}else z.v=parseFloat(z.v);break;case"s":if(typeof z.v>"u"){if(!H)continue;z.t="z"}else R=Vd[parseInt(z.v,10)],z.v=R.t,z.r=R.r,f.cellHTML&&(z.h=R.h);break;case"str":z.t="s",z.v=z.v!=null?vr(z.v):"",f.cellHTML&&(z.h=X1(z.v));break;case"inlineStr":A=X.match(n),z.t="s",A!=null&&(R=cv(A[1]))?(z.v=R.t,f.cellHTML&&(z.h=R.h)):z.v="";break;case"b":z.v=br(z.v);break;case"d":f.cellDates?z.v=Nr(z.v,1):(z.v=Nn(Nr(z.v,1)),z.t="n");break;case"e":(!f||f.cellText!==!1)&&(z.w=z.v),z.v=xA[z.v];break}if(O=D=0,Ee=null,qe&&T.s!==void 0&&(Ee=m.CellXf[T.s],Ee!=null&&(Ee.numFmtId!=null&&(O=Ee.numFmtId),f.cellStyles&&Ee.fillId!=null&&(D=Ee.fillId))),pC(z,O,D,f,g,m),f.cellDates&&qe&&z.t=="n"&&Ou(ft[O])&&(z.t="d",z.v=$p(z.v)),T.cm&&f.xlmeta){var it=(f.xlmeta.Cell||[])[+T.cm-1];it&&it.type=="XLDAPR"&&(z.D=!0)}if(Ae){var Z=$r(T.r);u[Z.r]||(u[Z.r]=[]),u[Z.r][Z.c]=z}else u[T.r]=z}}}}ne.length>0&&(u["!rows"]=ne)}}();function LO(t,e,r,n){var i=[],s=[],a=tr(t["!ref"]),o="",l,u="",f=[],p=0,g=0,m=t["!rows"],y=Array.isArray(t),x={r:u},S,A=-1;for(g=a.s.c;g<=a.e.c;++g)f[g]=Hr(g);for(p=a.s.r;p<=a.e.r;++p){for(s=[],u=un(p),g=a.s.c;g<=a.e.c;++g){l=f[g]+u;var C=y?(t[p]||[])[g]:t[l];C!==void 0&&(o=BO(C,l,t,e))!=null&&s.push(o)}(s.length>0||m&&m[p])&&(x={r:u},m&&m[p]&&(S=m[p],S.hidden&&(x.hidden=1),A=-1,S.hpx?A=Tf(S.hpx):S.hpt&&(A=S.hpt),A>-1&&(x.ht=A,x.customHeight=1),S.level&&(x.outlineLevel=S.level)),i[i.length]=Ge("row",s.join(""),x))}if(m)for(;p<m.length;++p)m&&m[p]&&(x={r:p+1},S=m[p],S.hidden&&(x.hidden=1),A=-1,S.hpx?A=Tf(S.hpx):S.hpt&&(A=S.hpt),A>-1&&(x.ht=A,x.customHeight=1),S.level&&(x.outlineLevel=S.level),i[i.length]=Ge("row","",x));return i.join("")}function mC(t,e,r,n){var i=[dn,Ge("worksheet",null,{xmlns:dc[0],"xmlns:r":kn.r})],s=r.SheetNames[t],a=0,o="",l=r.Sheets[s];l==null&&(l={});var u=l["!ref"]||"A1",f=tr(u);if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),u=bt(f)}n||(n={}),l["!comments"]=[];var p=[];wO(l,r,t,e,i),i[i.length]=Ge("dimension",null,{ref:u}),i[i.length]=MO(l,e,t,r),e.sheetFormat&&(i[i.length]=Ge("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=NO(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=LO(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=CO(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=DO(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=EO(l["!merges"]));var g=-1,m,y=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(m={ref:x[0]},x[1].Target.charAt(0)!="#"&&(y=hr(n,-1,pr(x[1].Target).replace(/#.*$/,""),jt.HLINK),m["r:id"]="rId"+y),(g=x[1].Target.indexOf("#"))>-1&&(m.location=pr(x[1].Target.slice(g+1))),x[1].Tooltip&&(m.tooltip=pr(x[1].Tooltip)),i[i.length]=Ge("hyperlink",null,m))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=bO(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Qn("ignoredErrors",Ge("ignoredError",null,{numberStoredAsText:1,sqref:u}))),p.length>0&&(y=hr(n,-1,"../drawings/drawing"+(t+1)+".xml",jt.DRAW),i[i.length]=Ge("drawing",null,{"r:id":"rId"+y}),l["!drawing"]=p),l["!comments"].length>0&&(y=hr(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",jt.VML),i[i.length]=Ge("legacyDrawing",null,{"r:id":"rId"+y}),l["!legacy"]=y),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function UO(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function VO(t,e,r){var n=_e(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=Tf(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var u={r:t,c:0},f=0;f<16;++f)if(!(e.s.c>f+1<<10||e.e.c<f<<10)){for(var p=-1,g=-1,m=f<<10;m<f+1<<10;++m){u.c=m;var y=Array.isArray(r)?(r[u.r]||[])[u.c]:r[ht(u)];y&&(p<0&&(p=m),g=m)}p<0||(++o,n.write_shift(4,p),n.write_shift(4,g))}var x=n.l;return n.l=l,n.write_shift(4,o),n.l=x,n.length>n.l?n.slice(0,n.l):n}function zO(t,e,r,n){var i=VO(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&ke(t,0,i)}var WO=gc,HO=ju;function $O(){}function GO(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=XR(t),r}function KO(t,e,r){r==null&&(r=_e(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return rp({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),fA(t,r),r.slice(0,r.l)}function YO(t){var e=Ls(t);return[e]}function XO(t,e,r){return r==null&&(r=_e(8)),fc(e,r)}function qO(t){var e=hc(t);return[e]}function QO(t,e,r){return r==null&&(r=_e(4)),pc(e,r)}function JO(t){var e=Ls(t),r=t.read_shift(1);return[e,r,"b"]}function ZO(t,e,r){return r==null&&(r=_e(9)),fc(e,r),r.write_shift(1,t.v?1:0),r}function eM(t){var e=hc(t),r=t.read_shift(1);return[e,r,"b"]}function tM(t,e,r){return r==null&&(r=_e(5)),pc(e,r),r.write_shift(1,t.v?1:0),r}function rM(t){var e=Ls(t),r=t.read_shift(1);return[e,r,"e"]}function nM(t,e,r){return r==null&&(r=_e(9)),fc(e,r),r.write_shift(1,t.v),r}function iM(t){var e=hc(t),r=t.read_shift(1);return[e,r,"e"]}function sM(t,e,r){return r==null&&(r=_e(8)),pc(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function aM(t){var e=Ls(t),r=t.read_shift(4);return[e,r,"s"]}function oM(t,e,r){return r==null&&(r=_e(12)),fc(e,r),r.write_shift(4,e.v),r}function lM(t){var e=hc(t),r=t.read_shift(4);return[e,r,"s"]}function cM(t,e,r){return r==null&&(r=_e(8)),pc(e,r),r.write_shift(4,e.v),r}function uM(t){var e=Ls(t),r=gi(t);return[e,r,"n"]}function dM(t,e,r){return r==null&&(r=_e(16)),fc(e,r),ec(t.v,r),r}function xC(t){var e=hc(t),r=gi(t);return[e,r,"n"]}function fM(t,e,r){return r==null&&(r=_e(12)),pc(e,r),ec(t.v,r),r}function hM(t){var e=Ls(t),r=iv(t);return[e,r,"n"]}function pM(t,e,r){return r==null&&(r=_e(12)),fc(e,r),hA(t.v,r),r}function gM(t){var e=hc(t),r=iv(t);return[e,r,"n"]}function mM(t,e,r){return r==null&&(r=_e(8)),pc(e,r),hA(t.v,r),r}function xM(t){var e=Ls(t),r=tv(t);return[e,r,"is"]}function vM(t){var e=Ls(t),r=mi(t);return[e,r,"str"]}function yM(t,e,r){return r==null&&(r=_e(12+4*t.v.length)),fc(e,r),zn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function _M(t){var e=hc(t),r=mi(t);return[e,r,"str"]}function EM(t,e,r){return r==null&&(r=_e(8+4*t.v.length)),pc(e,r),zn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function SM(t,e,r){var n=t.l+e,i=Ls(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=Yp(t,n-t.l,r);a[3]=di(o,null,i,r.supbooks,r)}else t.l=n;return a}function wM(t,e,r){var n=t.l+e,i=Ls(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=Yp(t,n-t.l,r);a[3]=di(o,null,i,r.supbooks,r)}else t.l=n;return a}function TM(t,e,r){var n=t.l+e,i=Ls(t);i.r=r["!row"];var s=gi(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=Yp(t,n-t.l,r);a[3]=di(o,null,i,r.supbooks,r)}else t.l=n;return a}function AM(t,e,r){var n=t.l+e,i=Ls(t);i.r=r["!row"];var s=mi(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=Yp(t,n-t.l,r);a[3]=di(o,null,i,r.supbooks,r)}else t.l=n;return a}var CM=gc,kM=ju;function FM(t,e){return e==null&&(e=_e(4)),e.write_shift(4,t),e}function bM(t,e){var r=t.l+e,n=gc(t),i=rv(t),s=mi(t),a=mi(t),o=mi(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function IM(t,e){var r=_e(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));ju({s:$r(t[0]),e:$r(t[0])},r),nv("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return zn(i||"",r),zn(t[1].Tooltip||"",r),zn("",r),r.slice(0,r.l)}function NM(){}function RM(t,e,r){var n=t.l+e,i=pA(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=rO(t,n-t.l,r);a[1]=o}else t.l=n;return a}function DM(t,e,r){var n=t.l+e,i=gc(t),s=[i];if(r.cellFormula){var a=iO(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function PM(t,e,r){r==null&&(r=_e(18));var n=Xp(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var vC=["left","right","top","bottom","header","footer"];function OM(t){var e={};return vC.forEach(function(r){e[r]=gi(t)}),e}function MM(t,e){return e==null&&(e=_e(6*8)),Hl(t),vC.forEach(function(r){ec(t[r],e)}),e}function BM(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function jM(t,e,r){r==null&&(r=_e(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function LM(t){var e=_e(24);return e.write_shift(4,4),e.write_shift(4,1),ju(t,e),e}function UM(t,e){return e==null&&(e=_e(16*4+2)),e.write_shift(2,t.password?uv(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function VM(){}function zM(){}function WM(t,e,r,n,i,s,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},u,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,g=!1,m,y,x,S,A,C,E,M,X,z=[];o.biff=12,o["!row"]=0;var T=0,F=!1,w=[],R={},P=o.supbooks||i.supbooks||[[]];if(P.sharedf=R,P.arrayf=w,P.SheetNames=i.SheetNames||i.Sheets.map(function(Ae){return Ae.name}),!o.supbooks&&(o.supbooks=P,i.Names))for(var O=0;O<i.Names.length;++O)P[0][O+1]=i.Names[O];var D=[],qe=[],Ee=!1;Af[16]={n:"BrtShortReal",f:xC};var Pe;if(po(t,function(ne,be,je){if(!g)switch(je){case 148:u=ne;break;case 0:m=ne,o.sheetRows&&o.sheetRows<=m.r&&(g=!0),M=un(S=m.r),o["!row"]=m.r,(ne.hidden||ne.hpt||ne.level!=null)&&(ne.hpt&&(ne.hpx=Su(ne.hpt)),qe[ne.r]=ne);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:ne[2]},ne[2]){case"n":y.v=ne[1];break;case"s":E=Vd[ne[1]],y.v=E.t,y.r=E.r;break;case"b":y.v=!!ne[1];break;case"e":y.v=ne[1],o.cellText!==!1&&(y.w=go[y.v]);break;case"str":y.t="s",y.v=ne[1];break;case"is":y.t="s",y.v=ne[1].t;break}if((x=a.CellXf[ne[0].iStyleRef])&&pC(y,x.numFmtId,null,o,s,a),A=ne[0].c==-1?A+1:ne[0].c,o.dense?(l[S]||(l[S]=[]),l[S][A]=y):l[Hr(A)+M]=y,o.cellFormula){for(F=!1,T=0;T<w.length;++T){var H=w[T];m.r>=H[0].s.r&&m.r<=H[0].e.r&&A>=H[0].s.c&&A<=H[0].e.c&&(y.F=bt(H[0]),F=!0)}!F&&ne.length>3&&(y.f=ne[3])}if(f.s.r>m.r&&(f.s.r=m.r),f.s.c>A&&(f.s.c=A),f.e.r<m.r&&(f.e.r=m.r),f.e.c<A&&(f.e.c=A),o.cellDates&&x&&y.t=="n"&&Ou(ft[x.numFmtId])){var te=Bl(y.v);te&&(y.t="d",y.v=new Date(te.y,te.m-1,te.d,te.H,te.M,te.S,te.u))}Pe&&(Pe.type=="XLDAPR"&&(y.D=!0),Pe=void 0);break;case 1:case 12:if(!o.sheetStubs||p)break;y={t:"z",v:void 0},A=ne[0].c==-1?A+1:ne[0].c,o.dense?(l[S]||(l[S]=[]),l[S][A]=y):l[Hr(A)+M]=y,f.s.r>m.r&&(f.s.r=m.r),f.s.c>A&&(f.s.c=A),f.e.r<m.r&&(f.e.r=m.r),f.e.c<A&&(f.e.c=A),Pe&&(Pe.type=="XLDAPR"&&(y.D=!0),Pe=void 0);break;case 176:z.push(ne);break;case 49:Pe=((o.xlmeta||{}).Cell||[])[ne-1];break;case 494:var re=n["!id"][ne.relId];for(re?(ne.Target=re.Target,ne.loc&&(ne.Target+="#"+ne.loc),ne.Rel=re):ne.relId==""&&(ne.Target="#"+ne.loc),S=ne.rfx.s.r;S<=ne.rfx.e.r;++S)for(A=ne.rfx.s.c;A<=ne.rfx.e.c;++A)o.dense?(l[S]||(l[S]=[]),l[S][A]||(l[S][A]={t:"z",v:void 0}),l[S][A].l=ne):(C=ht({c:A,r:S}),l[C]||(l[C]={t:"z",v:void 0}),l[C].l=ne);break;case 426:if(!o.cellFormula)break;w.push(ne),X=o.dense?l[S][A]:l[Hr(A)+M],X.f=di(ne[1],f,{r:m.r,c:A},P,o),X.F=bt(ne[0]);break;case 427:if(!o.cellFormula)break;R[ht(ne[0].s)]=ne[1],X=o.dense?l[S][A]:l[Hr(A)+M],X.f=di(ne[1],f,{r:m.r,c:A},P,o);break;case 60:if(!o.cellStyles)break;for(;ne.e>=ne.s;)D[ne.e--]={width:ne.w/256,hidden:!!(ne.flags&1),level:ne.level},Ee||(Ee=!0,dv(ne.w/256)),fl(D[ne.e+1]);break;case 161:l["!autofilter"]={ref:bt(ne)};break;case 476:l["!margins"]=ne;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),ne.name&&(i.Sheets[r].CodeName=ne.name),(ne.above||ne.left)&&(l["!outline"]={above:ne.above,left:ne.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),ne.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!be.T){if(!p||o.WTF)throw new Error("Unexpected record 0x"+je.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=bt(u||f)),o.sheetRows&&l["!ref"]){var Fe=tr(l["!ref"]);o.sheetRows<=+Fe.e.r&&(Fe.e.r=o.sheetRows-1,Fe.e.r>f.e.r&&(Fe.e.r=f.e.r),Fe.e.r<Fe.s.r&&(Fe.s.r=Fe.e.r),Fe.e.c>f.e.c&&(Fe.e.c=f.e.c),Fe.e.c<Fe.s.c&&(Fe.s.c=Fe.e.c),l["!fullref"]=l["!ref"],l["!ref"]=bt(Fe))}return z.length>0&&(l["!merges"]=z),D.length>0&&(l["!cols"]=D),qe.length>0&&(l["!rows"]=qe),l}function HM(t,e,r,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=Rr(e),e.z=e.z||ft[14],e.v=Nn(Nr(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r,c:n};switch(l.s=wl(i.cellXfs,e,i),e.l&&s["!links"].push([ht(l),e.l]),e.c&&s["!comments"].push([ht(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=mv(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?ke(t,18,cM(e,l)):ke(t,7,oM(e,l))):(l.t="str",a?ke(t,17,EM(e,l)):ke(t,6,yM(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?ke(t,13,mM(e,l)):ke(t,2,pM(e,l)):a?ke(t,16,fM(e,l)):ke(t,5,dM(e,l)),!0;case"b":return l.t="b",a?ke(t,15,tM(e,l)):ke(t,4,ZO(e,l)),!0;case"e":return l.t="e",a?ke(t,14,sM(e,l)):ke(t,3,nM(e,l)),!0}return a?ke(t,12,QO(e,l)):ke(t,1,XO(e,l)),!0}function $M(t,e,r,n){var i=tr(e["!ref"]||"A1"),s,a="",o=[];ke(t,145);var l=Array.isArray(e),u=i.e.r;e["!rows"]&&(u=Math.max(i.e.r,e["!rows"].length-1));for(var f=i.s.r;f<=u;++f){a=un(f),zO(t,e,i,f);var p=!1;if(f<=i.e.r)for(var g=i.s.c;g<=i.e.c;++g){f===i.s.r&&(o[g]=Hr(g)),s=o[g]+a;var m=l?(e[f]||[])[g]:e[s];if(!m){p=!1;continue}p=HM(t,m,f,g,n,e,p)}}ke(t,146)}function GM(t,e){!e||!e["!merges"]||(ke(t,177,FM(e["!merges"].length)),e["!merges"].forEach(function(r){ke(t,176,kM(r))}),ke(t,178))}function KM(t,e){!e||!e["!cols"]||(ke(t,390),e["!cols"].forEach(function(r,n){r&&ke(t,60,PM(n,r))}),ke(t,391))}function YM(t,e){!e||!e["!ref"]||(ke(t,648),ke(t,649,LM(tr(e["!ref"]))),ke(t,650))}function XM(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=hr(r,-1,n[1].Target.replace(/#.*$/,""),jt.HLINK);ke(t,494,IM(n,i))}}),delete e["!links"]}function qM(t,e,r,n){if(e["!comments"].length>0){var i=hr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",jt.VML);ke(t,551,nv("rId"+i)),e["!legacy"]=i}}function QM(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:bt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=qi(s);o.s.r==o.e.r&&(o.e.r=qi(e["!ref"]).e.r,s=bt(o));for(var l=0;l<a.length;++l){var u=a[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),ke(t,161,ju(tr(s))),ke(t,162)}}function JM(t,e,r){ke(t,133),ke(t,137,jM(e,r)),ke(t,138),ke(t,134)}function ZM(t,e){e["!protect"]&&ke(t,535,UM(e["!protect"]))}function eB(t,e,r,n){var i=Xi(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=tr(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],ke(i,129),(r.vbaraw||a["!outline"])&&ke(i,147,KO(o,a["!outline"])),ke(i,148,HO(l)),JM(i,a,r.Workbook),KM(i,a),$M(i,a,t,e),ZM(i,a),QM(i,a,r,t),GM(i,a),XM(i,a,n),a["!margins"]&&ke(i,476,MM(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&YM(i,a),qM(i,a,t,n),ke(i,130),i.end()}function tB(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var i=er((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function rB(t,e,r,n,i,s){var a=s||{"!type":"chart"};if(!t)return s;var o=0,l=0,u="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var g=tB(p);f.s.r=f.s.c=0,f.e.c=o,u=Hr(o),g[0].forEach(function(m,y){a[u+un(y)]={t:"n",v:m,z:g[1]},l=y}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(a["!ref"]=bt(f)),a}function nB(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(gC);return o&&xv(o[0],s,i,r),(a=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function iB(t,e){t.l+=10;var r=mi(t);return{name:r}}function sB(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return po(t,function(l,u,f){switch(f){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var vv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],aB=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],oB=[],lB=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function j_(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=br(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function L_(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=br(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function yC(t){L_(t.WBProps,vv),L_(t.CalcPr,lB),j_(t.WBView,aB),j_(t.Sheets,oB),lu.date1904=br(t.WBProps.date1904)}function cB(t){return!t.Workbook||!t.Workbook.WBProps?"false":br(t.Workbook.WBProps.date1904)?"true":"false"}var uB="][*?/\\".split("");function _C(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return uB.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function dB(t,e,r){t.forEach(function(n,i){_C(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function fB(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];dB(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)cO(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var hB=/<\w+:workbook/;function pB(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(t.replace(_i,function(l,u){var f=pt(l);switch(Pa(f[0])){case"<?xml":break;case"<workbook":l.match(hB)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[i];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":vv.forEach(function(p){if(f[p[0]]!=null)switch(p[2]){case"bool":r.WBProps[p[0]]=br(f[p[0]]);break;case"int":r.WBProps[p[0]]=parseInt(f[p[0]],10);break;default:r.WBProps[p[0]]=f[p[0]]}}),f.codeName&&(r.WBProps.CodeName=vr(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=er(vr(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=vr(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),br(f.hidden||"0")&&(s.Hidden=!0),a=u+l.length;break;case"</definedName>":s.Ref=er(vr(t.slice(a,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),dc.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return yC(r),r}function EC(t){var e=[dn];e[e.length]=Ge("workbook",null,{xmlns:dc[0],"xmlns:r":kn.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(vv.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Ge("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:pr(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=Ge("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=Ge("definedName",pr(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function gB(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=fx(t),r.name=mi(t),r}function mB(t,e){return e||(e=_e(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),nv(t.strRelID,e),zn(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function xB(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?mi(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function vB(t,e){e||(e=_e(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),fA(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function yB(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function _B(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=qR(t),a=nO(t,0,r),o=rv(t);t.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function EB(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],Af[16]={n:"BrtFRTArchID$",f:yB},po(t,function(l,u,f){switch(f){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=di(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([f,l]):a[0]=[f,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(f),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!u.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},e),yC(r),r.Names=s,r.supbooks=a,r}function SB(t,e){ke(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};ke(t,156,mB(i))}ke(t,144)}function wB(t,e){e||(e=_e(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return zn("SheetJS",e),zn(Xh.version,e),zn(Xh.version,e),zn("7262",e),e.length>e.l?e.slice(0,e.l):e}function TB(t,e){e||(e=_e(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function AB(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(ke(t,135),ke(t,158,TB(i)),ke(t,136))}}function CB(t,e){var r=Xi();return ke(r,131),ke(r,128,wB()),ke(r,153,vB(t.Workbook&&t.Workbook.WBProps||null)),AB(r,t),SB(r,t),ke(r,132),r.end()}function kB(t,e,r){return e.slice(-4)===".bin"?EB(t,r):pB(t,r)}function FB(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?WM(t,n,r,i,s,a,o):_O(t,n,r,i,s,a,o)}function bB(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?sB(t,n,r,i,s):nB(t,n,r,i,s)}function IB(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?R8():D8()}function NB(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?I8():N8()}function RB(t,e,r,n){return e.slice(-4)===".bin"?kP(t,r,n):gP(t,r,n)}function DB(t,e,r){return tC(t,r)}function PB(t,e,r){return e.slice(-4)===".bin"?P6(t,r):N6(t,r)}function OB(t,e,r){return e.slice(-4)===".bin"?A8(t,r):m8(t,r)}function MB(t,e,r){return e.slice(-4)===".bin"?h8(t):d8(t)}function BB(t,e,r,n){return r.slice(-4)===".bin"?p8(t,e,r,n):void 0}function jB(t,e,r){return e.slice(-4)===".bin"?l8(t,e,r):u8(t,e,r)}function LB(t,e,r){return(e.slice(-4)===".bin"?CB:EC)(t)}function UB(t,e,r,n,i){return(e.slice(-4)===".bin"?eB:mC)(t,r,n,i)}function VB(t,e,r){return(e.slice(-4)===".bin"?BP:ZA)(t,r)}function zB(t,e,r){return(e.slice(-4)===".bin"?B6:$A)(t,r)}function WB(t,e,r){return(e.slice(-4)===".bin"?C8:iC)(t)}function HB(t){return(t.slice(-4)===".bin"?c8:rC)()}var SC=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,wC=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Gs(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(SC),s,a,o,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(wC),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function $B(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(SC),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(wC),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var Wd;function GB(t,e){var r=Wd[t]||er(t);return r==="General"?Jl(e):js(r,e)}function KB(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=br(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Nr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[er(e)]=i}function YB(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||go[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=mf(t.v):t.w=Jl(t.v):t.w=GB(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=Wd[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Ou(n)){var i=Bl(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function XB(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=oP[n.Pattern]||n.Pattern)}t[e.ID]=e}function qB(t,e,r,n,i,s,a,o,l,u){var f="General",p=n.StyleID,g={};u=u||{};var m=[],y=0;for(p===void 0&&o&&(p=o.StyleID),p===void 0&&a&&(p=a.StyleID);s[p]!==void 0&&(s[p].nf&&(f=s[p].nf),s[p].Interior&&m.push(s[p].Interior),!!s[p].Parent);)p=s[p].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=br(t);break;case"String":n.t="s",n.r=r_(er(t)),n.v=t.indexOf("<")>-1?er(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Nr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=er(t):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=xA[t],u.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=r_(e||t));break}if(YB(n,f,u),u.cellFormula!==!1)if(n.Formula){var x=er(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=ou(x,i),delete n.Formula,n.ArrayRange=="RC"?n.F=ou("RC:RC",i):n.ArrayRange&&(n.F=ou(n.ArrayRange,i),l.push([tr(n.F),n.F]))}else for(y=0;y<l.length;++y)i.r>=l[y][0].s.r&&i.r<=l[y][0].e.r&&i.c>=l[y][0].s.c&&i.c<=l[y][0].e.c&&(n.F=l[y][1]);u.cellStyles&&(m.forEach(function(S){!g.patternType&&S.patternType&&(g.patternType=S.patternType)}),n.s=g),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function QB(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Qg(t,e){var r=e||{};Mu();var n=Ed(q1(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=vr(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=Rr(r);return a.type="string",Eu.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(xr){i.indexOf("<"+xr)>=0&&(s=!0)}),s)return Mj(n,r);Wd={"General Number":"General","General Date":ft[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ft[15],"Short Date":ft[14],"Long Time":ft[19],"Medium Time":ft[18],"Short Time":ft[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ft[2],Standard:ft[4],Percent:ft[10],Scientific:ft[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],u,f={},p=[],g=r.dense?[]:{},m="",y={},x={},S=Gs('<Data ss:Type="String">'),A=0,C=0,E=0,M={s:{r:2e6,c:2e6},e:{r:0,c:0}},X={},z={},T="",F=0,w=[],R={},P={},O=0,D=[],qe=[],Ee={},Pe=[],Fe,Ae=!1,ne=[],be=[],je={},H=0,te=0,re={Sheets:[],WBProps:{date1904:!1}},Y={};yf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ye="";o=yf.exec(n);)switch(o[3]=(ye=o[3]).toLowerCase()){case"data":if(ye=="data"){if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?qB(n.slice(A,o.index),T,S,l[l.length-1][0]=="comment"?Ee:y,{c:C,r:E},X,Pe[C],x,ne,r):(T="",S=Gs(o[0]),A=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(qe.length>0&&(y.c=qe),(!r.sheetRows||r.sheetRows>E)&&y.v!==void 0&&(r.dense?(g[E]||(g[E]=[]),g[E][C]=y):g[Hr(C)+un(E)]=y),y.HRef&&(y.l={Target:er(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(H=C+(parseInt(y.MergeAcross,10)|0),te=E+(parseInt(y.MergeDown,10)|0),w.push({s:{c:C,r:E},e:{c:H,r:te}})),!r.sheetStubs)y.MergeAcross?C=H+1:++C;else if(y.MergeAcross||y.MergeDown){for(var Te=C;Te<=H;++Te)for(var Ve=E;Ve<=te;++Ve)(Te>C||Ve>E)&&(r.dense?(g[Ve]||(g[Ve]=[]),g[Ve][Te]={t:"z"}):g[Hr(Te)+un(Ve)]={t:"z"});C=H+1}else++C;else y=$B(o[0]),y.Index&&(C=+y.Index-1),C<M.s.c&&(M.s.c=C),C>M.e.c&&(M.e.c=C),o[0].slice(-2)==="/>"&&++C,qe=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(E<M.s.r&&(M.s.r=E),E>M.e.r&&(M.e.r=E),o[0].slice(-2)==="/>"&&(x=Gs(o[0]),x.Index&&(E=+x.Index-1)),C=0,++E):(x=Gs(o[0]),x.Index&&(E=+x.Index-1),je={},(x.AutoFitHeight=="0"||x.Height)&&(je.hpx=parseInt(x.Height,10),je.hpt=Tf(je.hpx),be[E]=je),x.Hidden=="1"&&(je.hidden=!0,be[E]=je));break;case"worksheet":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));p.push(m),M.s.r<=M.e.r&&M.s.c<=M.e.c&&(g["!ref"]=bt(M),r.sheetRows&&r.sheetRows<=M.e.r&&(g["!fullref"]=g["!ref"],M.e.r=r.sheetRows-1,g["!ref"]=bt(M))),w.length&&(g["!merges"]=w),Pe.length>0&&(g["!cols"]=Pe),be.length>0&&(g["!rows"]=be),f[m]=g}else M={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=C=0,l.push([o[3],!1]),u=Gs(o[0]),m=er(u.Name),g=r.dense?[]:{},w=[],ne=[],be=[],Y={name:m,Hidden:0},re.Sheets.push(Y);break;case"table":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),Pe=[],Ae=!1}break;case"style":o[1]==="/"?XB(X,z,r):z=Gs(o[0]);break;case"numberformat":z.nf=er(Gs(o[0]).Format||"General"),Wd[z.nf]&&(z.nf=Wd[z.nf]);for(var De=0;De!=392&&ft[De]!=z.nf;++De);if(De==392){for(De=57;De!=392;++De)if(ft[De]==null){Ja(z.nf,De);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(Fe=Gs(o[0]),Fe.Hidden&&(Fe.hidden=!0,delete Fe.Hidden),Fe.Width&&(Fe.wpx=parseInt(Fe.Width,10)),!Ae&&Fe.wpx>10){Ae=!0,hi=QA;for(var Ne=0;Ne<Pe.length;++Ne)Pe[Ne]&&fl(Pe[Ne])}Ae&&fl(Fe),Pe[Fe.Index-1||Pe.length]=Fe;for(var it=0;it<+Fe.Span;++it)Pe[Pe.length]=Rr(Fe);break;case"namedrange":if(o[1]==="/")break;re.Names||(re.Names=[]);var Z=pt(o[0]),Rt={Name:Z.Name,Ref:ou(Z.RefersTo.slice(1),{r:0,c:0})};re.Sheets.length>0&&(Rt.Sheet=re.Sheets.length-1),re.Names.push(Rt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?T+=n.slice(F,o.index):F=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;z.Interior=Gs(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?ED(R,ye,n.slice(O,o.index)):O=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));QB(Ee),qe.push(Ee)}else l.push([o[3],!1]),u=Gs(o[0]),Ee={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Et=Gs(o[0]);g["!autofilter"]={ref:ou(Et.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return H_(n,r);var Dt=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Dt=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Dt=!1}break;case"excelworkbook":switch(o[3]){case"date1904":re.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Dt=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Dt=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(O,o.index)){case"SheetHidden":Y.Hidden=1;break;case"SheetVeryHidden":Y.Hidden=2;break}else O=o.index+o[0].length;break;case"header":g["!margins"]||Hl(g["!margins"]={},"xlml"),isNaN(+pt(o[0]).Margin)||(g["!margins"].header=+pt(o[0]).Margin);break;case"footer":g["!margins"]||Hl(g["!margins"]={},"xlml"),isNaN(+pt(o[0]).Margin)||(g["!margins"].footer=+pt(o[0]).Margin);break;case"pagemargins":var yt=pt(o[0]);g["!margins"]||Hl(g["!margins"]={},"xlml"),isNaN(+yt.Top)||(g["!margins"].top=+yt.Top),isNaN(+yt.Left)||(g["!margins"].left=+yt.Left),isNaN(+yt.Right)||(g["!margins"].right=+yt.Right),isNaN(+yt.Bottom)||(g["!margins"].bottom=+yt.Bottom);break;case"displayrighttoleft":re.Views||(re.Views=[]),re.Views[0]||(re.Views[0]={}),re.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Dt=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Dt=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Dt=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Dt=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Dt=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Dt=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Dt=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Dt=!1}break;case"smarttags":break;default:Dt=!1;break}if(Dt||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?KB(P,ye,D,n.slice(O,o.index)):(D=o,O=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Xe={};return!r.bookSheets&&!r.bookProps&&(Xe.Sheets=f),Xe.SheetNames=p,Xe.Workbook=re,Xe.SSF=Rr(ft),Xe.Props=R,Xe.Custprops=P,Xe}function yx(t,e){switch(_v(e=e||{}),e.type||"base64"){case"base64":return Qg(hs(t),e);case"binary":case"buffer":case"file":return Qg(t,e);case"array":return Qg(El(t),e)}}function JB(t,e){var r=[];return t.Props&&r.push(SD(t.Props,e)),t.Custprops&&r.push(wD(t.Props,t.Custprops)),r.join("")}function ZB(){return""}function ej(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(Ge("NumberFormat",null,{"ss:Format":pr(ft[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(Ge("Style",s.join(""),a))}),Ge("Styles",r.join(""))}function TC(t){return Ge("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+pv(t.Ref,{r:0,c:0})})}function tj(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(TC(i)))}return Ge("Names",r.join(""))}function rj(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(TC(o)))}return s.join("")}function nj(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(Ge("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(Ge("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(Ge("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Ge("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(Qn("ProtectContents","True")),t["!protect"].objects&&i.push(Qn("ProtectObjects","True")),t["!protect"].scenarios&&i.push(Qn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(Qn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(Qn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":Ge("WorksheetOptions",i.join(""),{xmlns:ss.x})}function ij(t){return t.map(function(e){var r=AR(e.t||""),n=Ge("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ge("Comment",n,{"ss:Author":e.a})}).join("")}function sj(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+pr(pv(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var l=$r(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=pr(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=pr(t.l.Tooltip))),r["!merges"])for(var u=r["!merges"],f=0;f!=u.length;++f)u[f].s.c!=a.c||u[f].s.r!=a.r||(u[f].e.c>u[f].s.c&&(o["ss:MergeAcross"]=u[f].e.c-u[f].s.c),u[f].e.r>u[f].s.r&&(o["ss:MergeDown"]=u[f].e.r-u[f].s.r));var p="",g="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":p="Number",g=String(t.v);break;case"b":p="Boolean",g=t.v?"1":"0";break;case"e":p="Error",g=go[t.v];break;case"d":p="DateTime",g=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||ft[14]);break;case"s":p="String",g=TR(t.v||"");break}var m=wl(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+m),o["ss:Index"]=a.c+1;var y=t.v!=null?g:"",x=t.t=="z"?"":'<Data ss:Type="'+p+'">'+y+"</Data>";return(t.c||[]).length>0&&(x+=ij(t.c)),Ge("Cell",x,o)}function aj(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Su(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function oj(t,e,r,n){if(!t["!ref"])return"";var i=tr(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(S,A){fl(S);var C=!!S.width,E=Xp(A,S),M={"ss:Index":A+1};C&&(M["ss:Width"]=Sf(E.width)),S.hidden&&(M["ss:Hidden"]="1"),o.push(Ge("Column",null,M))});for(var l=Array.isArray(t),u=i.s.r;u<=i.e.r;++u){for(var f=[aj(u,(t["!rows"]||[])[u])],p=i.s.c;p<=i.e.c;++p){var g=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>p)&&!(s[a].s.r>u)&&!(s[a].e.c<p)&&!(s[a].e.r<u)){(s[a].s.c!=p||s[a].s.r!=u)&&(g=!0);break}if(!g){var m={r:u,c:p},y=ht(m),x=l?(t[u]||[])[p]:t[y];f.push(sj(x,y,t,e,r,n,m))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function lj(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?rj(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?oj(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(nj(s,e,t,r)),n.join("")}function cj(t,e){e||(e={}),t.SSF||(t.SSF=Rr(ft)),t.SSF&&(Mu(),zp(t.SSF),e.revssf=Hp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],wl(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(JB(t,e)),r.push(ZB()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Ge("Worksheet",lj(n,e,t),{"ss:Name":pr(t.SheetNames[n])}));return r[2]=ej(t,e),r[3]=tj(t),dn+Ge("Workbook",r.join(""),{xmlns:ss.ss,"xmlns:o":ss.o,"xmlns:x":ss.x,"xmlns:ss":ss.ss,"xmlns:dt":ss.dt,"xmlns:html":ss.html})}function uj(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=tD(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=rD(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var dj=[60,1084,2066,2165,2175];function fj(t,e,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var l=Ga(r,r.l),u=_x[l],f=0;u!=null&&dj.indexOf(l)>-1;)s=Ga(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=r.slice(f,r.l+4+s),a.push(o),r.l+=4+s,u=_x[l=Ga(r,r.l)];var p=Vn(a);qn(p,0);var g=0;p.lens=[];for(var m=0;m<a.length;++m)p.lens.push(g),g+=a[m].length;if(p.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+p.length+" < "+n;return e.f(p,p.length,i)}function ya(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=ft[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||go[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=mf(t.v):t.w=Jl(t.v):t.w=js(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&Ou(ft[n]||String(n))){var i=Bl(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function W0(t,e,r){return{v:t,ixfe:e,t:r}}function hj(t,e){var r={opts:{}},n={},i=e.dense?[]:{},s={},a={},o=null,l=[],u="",f={},p,g="",m,y,x,S,A={},C=[],E,M,X=[],z=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},F={},w=function(mt){return mt<8?Vl[mt]:mt<64&&z[mt-8]||Vl[mt]},R=function(mt,Ar,Dr){var Pr=Ar.XF.data;if(!(!Pr||!Pr.patternType||!Dr||!Dr.cellStyles)){Ar.s={},Ar.s.patternType=Pr.patternType;var Rn;(Rn=Ef(w(Pr.icvFore)))&&(Ar.s.fgColor={rgb:Rn}),(Rn=Ef(w(Pr.icvBack)))&&(Ar.s.bgColor={rgb:Rn})}},P=function(mt,Ar,Dr){if(!(je>1)&&!(Dr.sheetRows&&mt.r>=Dr.sheetRows)){if(Dr.cellStyles&&Ar.XF&&Ar.XF.data&&R(mt,Ar,Dr),delete Ar.ixfe,delete Ar.XF,p=mt,g=ht(mt),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),mt.r<a.s.r&&(a.s.r=mt.r),mt.c<a.s.c&&(a.s.c=mt.c),mt.r+1>a.e.r&&(a.e.r=mt.r+1),mt.c+1>a.e.c&&(a.e.c=mt.c+1),Dr.cellFormula&&Ar.f){for(var Pr=0;Pr<C.length;++Pr)if(!(C[Pr][0].s.c>mt.c||C[Pr][0].s.r>mt.r)&&!(C[Pr][0].e.c<mt.c||C[Pr][0].e.r<mt.r)){Ar.F=bt(C[Pr][0]),(C[Pr][0].s.c!=mt.c||C[Pr][0].s.r!=mt.r)&&delete Ar.f,Ar.f&&(Ar.f=""+di(C[Pr][1],a,mt,ne,O));break}}Dr.dense?(i[mt.r]||(i[mt.r]=[]),i[mt.r][mt.c]=Ar):i[g]=Ar}},O={enc:!1,sbcch:0,snames:[],sharedf:A,arrayf:C,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(O.password=e.password);var D,qe=[],Ee=[],Pe=[],Fe=[],Ae=!1,ne=[];ne.SheetNames=O.snames,ne.sharedf=O.sharedf,ne.arrayf=O.arrayf,ne.names=[],ne.XTI=[];var be=0,je=0,H=0,te=[],re=[],Y;O.codepage=1200,Qs(1200);for(var ye=!1;t.l<t.length-1;){var Te=t.l,Ve=t.read_shift(2);if(Ve===0&&be===10)break;var De=t.l===t.length?0:t.read_shift(2),Ne=_x[Ve];if(Ne&&Ne.f){if(e.bookSheets&&be===133&&Ve!==133)break;if(be=Ve,Ne.r===2||Ne.r==12){var it=t.read_shift(2);if(De-=2,!O.enc&&it!==Ve&&((it&255)<<8|it>>8)!==Ve)throw new Error("rt mismatch: "+it+"!="+Ve);Ne.r==12&&(t.l+=10,De-=10)}var Z={};if(Ve===10?Z=Ne.f(t,De,O):Z=fj(Ve,Ne,t,De,O),je==0&&[9,521,1033,2057].indexOf(be)===-1)continue;switch(Ve){case 34:r.opts.Date1904=T.WBProps.date1904=Z;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(O.enc||(t.l=0),O.enc=Z,!e.password)throw new Error("File is password-protected");if(Z.valid==null)throw new Error("Encryption scheme unsupported");if(!Z.valid)throw new Error("Password is incorrect");break;case 92:O.lastuser=Z;break;case 66:var Rt=Number(Z);switch(Rt){case 21010:Rt=1200;break;case 32768:Rt=1e4;break;case 32769:Rt=1252;break}Qs(O.codepage=Rt),ye=!0;break;case 317:O.rrtabid=Z;break;case 25:O.winlocked=Z;break;case 439:r.opts.RefreshAll=Z;break;case 12:r.opts.CalcCount=Z;break;case 16:r.opts.CalcDelta=Z;break;case 17:r.opts.CalcIter=Z;break;case 13:r.opts.CalcMode=Z;break;case 14:r.opts.CalcPrecision=Z;break;case 95:r.opts.CalcSaveRecalc=Z;break;case 15:O.CalcRefMode=Z;break;case 2211:r.opts.FullCalc=Z;break;case 129:Z.fDialog&&(i["!type"]="dialog"),Z.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),Z.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:X.push(Z);break;case 430:ne.push([Z]),ne[ne.length-1].XTI=[];break;case 35:case 547:ne[ne.length-1].push(Z);break;case 24:case 536:Y={Name:Z.Name,Ref:di(Z.rgce,a,null,ne,O)},Z.itab>0&&(Y.Sheet=Z.itab-1),ne.names.push(Y),ne[0]||(ne[0]=[],ne[0].XTI=[]),ne[ne.length-1].push(Z),Z.Name=="_xlnm._FilterDatabase"&&Z.itab>0&&Z.rgce&&Z.rgce[0]&&Z.rgce[0][0]&&Z.rgce[0][0][0]=="PtgArea3d"&&(re[Z.itab-1]={ref:bt(Z.rgce[0][0][1][2])});break;case 22:O.ExternCount=Z;break;case 23:ne.length==0&&(ne[0]=[],ne[0].XTI=[]),ne[ne.length-1].XTI=ne[ne.length-1].XTI.concat(Z),ne.XTI=ne.XTI.concat(Z);break;case 2196:if(O.biff<8)break;Y!=null&&(Y.Comment=Z[1]);break;case 18:i["!protect"]=Z;break;case 19:Z!==0&&O.WTF&&console.error("Password verifier: "+Z);break;case 133:s[Z.pos]=Z,O.snames.push(Z.name);break;case 10:{if(--je)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=bt(a),e.sheetRows&&e.sheetRows<=a.e.r){var Et=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=bt(a),a.e.r=Et}a.e.r++,a.e.c++}qe.length>0&&(i["!merges"]=qe),Ee.length>0&&(i["!objects"]=Ee),Pe.length>0&&(i["!cols"]=Pe),Fe.length>0&&(i["!rows"]=Fe),T.Sheets.push(F)}u===""?f=i:n[u]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(O.biff===8&&(O.biff={9:2,521:3,1033:4}[Ve]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Z.BIFFVer]||8),O.biffguess=Z.BIFFVer==0,Z.BIFFVer==0&&Z.dt==4096&&(O.biff=5,ye=!0,Qs(O.codepage=28591)),O.biff==8&&Z.BIFFVer==0&&Z.dt==16&&(O.biff=2),je++)break;if(i=e.dense?[]:{},O.biff<8&&!ye&&(ye=!0,Qs(O.codepage=e.codepage||1252)),O.biff<5||Z.BIFFVer==0&&Z.dt==4096){u===""&&(u="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var Dt={pos:t.l-De,name:u};s[Dt.pos]=Dt,O.snames.push(u)}else u=(s[Te]||{name:""}).name;Z.dt==32&&(i["!type"]="chart"),Z.dt==64&&(i["!type"]="macro"),qe=[],Ee=[],O.arrayf=C=[],Pe=[],Fe=[],Ae=!1,F={Hidden:(s[Te]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[Z.r]||[])[Z.c]:i[ht({c:Z.c,r:Z.r})])&&++Z.c,E={ixfe:Z.ixfe,XF:X[Z.ixfe]||{},v:Z.val,t:"n"},H>0&&(E.z=te[E.ixfe>>8&63]),ya(E,e,r.opts.Date1904),P({c:Z.c,r:Z.r},E,e);break;case 5:case 517:E={ixfe:Z.ixfe,XF:X[Z.ixfe],v:Z.val,t:Z.t},H>0&&(E.z=te[E.ixfe>>8&63]),ya(E,e,r.opts.Date1904),P({c:Z.c,r:Z.r},E,e);break;case 638:E={ixfe:Z.ixfe,XF:X[Z.ixfe],v:Z.rknum,t:"n"},H>0&&(E.z=te[E.ixfe>>8&63]),ya(E,e,r.opts.Date1904),P({c:Z.c,r:Z.r},E,e);break;case 189:for(var yt=Z.c;yt<=Z.C;++yt){var Xe=Z.rkrec[yt-Z.c][0];E={ixfe:Xe,XF:X[Xe],v:Z.rkrec[yt-Z.c][1],t:"n"},H>0&&(E.z=te[E.ixfe>>8&63]),ya(E,e,r.opts.Date1904),P({c:yt,r:Z.r},E,e)}break;case 6:case 518:case 1030:{if(Z.val=="String"){o=Z;break}if(E=W0(Z.val,Z.cell.ixfe,Z.tt),E.XF=X[E.ixfe],e.cellFormula){var xr=Z.formula;if(xr&&xr[0]&&xr[0][0]&&xr[0][0][0]=="PtgExp"){var Xr=xr[0][0][1][0],_n=xr[0][0][1][1],Pi=ht({r:Xr,c:_n});A[Pi]?E.f=""+di(Z.formula,a,Z.cell,ne,O):E.F=((e.dense?(i[Xr]||[])[_n]:i[Pi])||{}).F}else E.f=""+di(Z.formula,a,Z.cell,ne,O)}H>0&&(E.z=te[E.ixfe>>8&63]),ya(E,e,r.opts.Date1904),P(Z.cell,E,e),o=Z}break;case 7:case 519:if(o)o.val=Z,E=W0(Z,o.cell.ixfe,"s"),E.XF=X[E.ixfe],e.cellFormula&&(E.f=""+di(o.formula,a,o.cell,ne,O)),H>0&&(E.z=te[E.ixfe>>8&63]),ya(E,e,r.opts.Date1904),P(o.cell,E,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{C.push(Z);var Oi=ht(Z[0].s);if(m=e.dense?(i[Z[0].s.r]||[])[Z[0].s.c]:i[Oi],e.cellFormula&&m){if(!o||!Oi||!m)break;m.f=""+di(Z[1],a,Z[0],ne,O),m.F=bt(Z[0])}}break;case 1212:{if(!e.cellFormula)break;if(g){if(!o)break;A[ht(o.cell)]=Z[0],m=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[ht(o.cell)],(m||{}).f=""+di(Z[0],a,p,ne,O)}}break;case 253:E=W0(l[Z.isst].t,Z.ixfe,"s"),l[Z.isst].h&&(E.h=l[Z.isst].h),E.XF=X[E.ixfe],H>0&&(E.z=te[E.ixfe>>8&63]),ya(E,e,r.opts.Date1904),P({c:Z.c,r:Z.r},E,e);break;case 513:e.sheetStubs&&(E={ixfe:Z.ixfe,XF:X[Z.ixfe],t:"z"},H>0&&(E.z=te[E.ixfe>>8&63]),ya(E,e,r.opts.Date1904),P({c:Z.c,r:Z.r},E,e));break;case 190:if(e.sheetStubs)for(var Mi=Z.c;Mi<=Z.C;++Mi){var jr=Z.ixfe[Mi-Z.c];E={ixfe:jr,XF:X[jr],t:"z"},H>0&&(E.z=te[E.ixfe>>8&63]),ya(E,e,r.opts.Date1904),P({c:Mi,r:Z.r},E,e)}break;case 214:case 516:case 4:E=W0(Z.val,Z.ixfe,"s"),E.XF=X[E.ixfe],H>0&&(E.z=te[E.ixfe>>8&63]),ya(E,e,r.opts.Date1904),P({c:Z.c,r:Z.r},E,e);break;case 0:case 512:je===1&&(a=Z);break;case 252:l=Z;break;case 1054:if(O.biff==4){te[H++]=Z[1];for(var Bi=0;Bi<H+163&&ft[Bi]!=Z[1];++Bi);Bi>=163&&Ja(Z[1],H+163)}else Ja(Z[1],Z[0]);break;case 30:{te[H++]=Z;for(var cr=0;cr<H+163&&ft[cr]!=Z;++cr);cr>=163&&Ja(Z,H+163)}break;case 229:qe=qe.concat(Z);break;case 93:Ee[Z.cmo[0]]=O.lastobj=Z;break;case 438:O.lastobj.TxO=Z;break;case 127:O.lastobj.ImData=Z;break;case 440:for(S=Z[0].s.r;S<=Z[0].e.r;++S)for(x=Z[0].s.c;x<=Z[0].e.c;++x)m=e.dense?(i[S]||[])[x]:i[ht({c:x,r:S})],m&&(m.l=Z[1]);break;case 2048:for(S=Z[0].s.r;S<=Z[0].e.r;++S)for(x=Z[0].s.c;x<=Z[0].e.c;++x)m=e.dense?(i[S]||[])[x]:i[ht({c:x,r:S})],m&&m.l&&(m.l.Tooltip=Z[1]);break;case 28:{if(O.biff<=5&&O.biff>=2)break;m=e.dense?(i[Z[0].r]||[])[Z[0].c]:i[ht(Z[0])];var Lr=Ee[Z[2]];m||(e.dense?(i[Z[0].r]||(i[Z[0].r]=[]),m=i[Z[0].r][Z[0].c]={t:"z"}):m=i[ht(Z[0])]={t:"z"},a.e.r=Math.max(a.e.r,Z[0].r),a.s.r=Math.min(a.s.r,Z[0].r),a.e.c=Math.max(a.e.c,Z[0].c),a.s.c=Math.min(a.s.c,Z[0].c)),m.c||(m.c=[]),y={a:Z[1],t:Lr.TxO.t},m.c.push(y)}break;case 2173:e8(X[Z.ixfe],Z.ext);break;case 125:{if(!O.cellStyles)break;for(;Z.e>=Z.s;)Pe[Z.e--]={width:Z.w/256,level:Z.level||0,hidden:!!(Z.flags&1)},Ae||(Ae=!0,dv(Z.w/256)),fl(Pe[Z.e+1])}break;case 520:{var Tr={};Z.level!=null&&(Fe[Z.r]=Tr,Tr.level=Z.level),Z.hidden&&(Fe[Z.r]=Tr,Tr.hidden=!0),Z.hpt&&(Fe[Z.r]=Tr,Tr.hpt=Z.hpt,Tr.hpx=Su(Z.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Hl(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ve]]=Z;break;case 161:i["!margins"]||Hl(i["!margins"]={}),i["!margins"].header=Z.header,i["!margins"].footer=Z.footer;break;case 574:Z.RTL&&(T.Views[0].RTL=!0);break;case 146:z=Z;break;case 2198:D=Z;break;case 140:M=Z;break;case 442:u?F.CodeName=Z||F.name:T.WBProps.CodeName=Z||"ThisWorkbook";break}}else Ne||console.error("Missing Info for XLS Record 0x"+Ve.toString(16)),t.l+=De}return r.SheetNames=en(s).sort(function(Ei,mt){return Number(Ei)-Number(mt)}).map(function(Ei){return s[Ei].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&re.forEach(function(Ei,mt){r.Sheets[r.SheetNames[mt]]["!autofilter"]=Ei}),r.Strings=l,r.SSF=Rr(ft),O.enc&&(r.Encryption=O.enc),D&&(r.Themes=D),r.Metadata={},M!==void 0&&(r.Metadata.Country=M),ne.names.length>0&&(T.Names=ne.names),r.Workbook=T,r}var Hd={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function pj(t,e,r){var n=st.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=__(n,hx,Hd.DSI);for(var s in i)e[s]=i[s]}catch(u){if(r.WTF)throw u}var a=st.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=__(a,px,Hd.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(u){if(r.WTF)throw u}e.HeadingPairs&&e.TitlesOfParts&&(wA(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function gj(t,e){var r=[],n=[],i=[],s=0,a,o=q2(hx,"n"),l=q2(px,"n");if(t.Props)for(a=en(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=en(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var u=[];for(s=0;s<i.length;++s)IA.indexOf(i[s][0])>-1||SA.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);n.length&&st.utils.cfb_add(e,"/SummaryInformation",E_(n,Hd.SI,l,px)),(r.length||u.length)&&st.utils.cfb_add(e,"/DocumentSummaryInformation",E_(r,Hd.DSI,o,hx,u.length?u:null,Hd.UDI))}function AC(t,e){e||(e={}),_v(e),V1(),e.codepage&&U1(e.codepage);var r,n;if(t.FullPaths){if(st.find(t,"/encryption"))throw new Error("File is password-protected");r=st.find(t,"!CompObj"),n=st.find(t,"/Workbook")||st.find(t,"/Book")}else{switch(e.type){case"base64":t=os(hs(t));break;case"binary":t=os(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}qn(t,0),n={content:t}}var i,s;if(r&&uj(r),e.bookProps&&!e.bookSheets)i={};else{var a=Mt?"buffer":"array";if(n&&n.content)i=hj(n.content,e);else if((s=st.find(t,"PerfectOffice_MAIN"))&&s.content)i=Wl.to_workbook(s.content,(e.type=a,e));else if((s=st.find(t,"NativeContent_MAIN"))&&s.content)i=Wl.to_workbook(s.content,(e.type=a,e));else throw(s=st.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&st.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=F8(t))}var o={};return t.FullPaths&&pj(t,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=t),i}function mj(t,e){var r=e||{},n=st.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return st.utils.cfb_add(n,i,CC(t,r)),r.biff==8&&(t.Props||t.Custprops)&&gj(t,n),r.biff==8&&t.vbaraw&&b8(n,st.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var Af={0:{f:UO},1:{f:YO},2:{f:hM},3:{f:rM},4:{f:JO},5:{f:uM},6:{f:vM},7:{f:aM},8:{f:AM},9:{f:TM},10:{f:SM},11:{f:wM},12:{f:qO},13:{f:gM},14:{f:iM},15:{f:eM},16:{f:xC},17:{f:_M},18:{f:lM},19:{f:tv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:_B},40:{},42:{},43:{f:vP},44:{f:mP},45:{f:EP},46:{f:wP},47:{f:SP},48:{},49:{f:WR},50:{},51:{f:n8},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:VA},62:{f:xM},63:{f:f8},64:{f:VM},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:vi,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:BM},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:GO},148:{f:WO,p:16},151:{f:NM},152:{},153:{f:xB},154:{},155:{},156:{f:gB},157:{},158:{},159:{T:1,f:D6},160:{T:-1},161:{T:1,f:gc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:CM},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:t8},336:{T:-1},337:{f:a8,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:fx},357:{},358:{},359:{},360:{T:1},361:{},362:{f:UA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:RM},427:{f:DM},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:OM},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:$O},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:bM},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:fx},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:w8},633:{T:1},634:{T:-1},635:{T:1,f:E8},636:{T:-1},637:{f:KR},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:iB},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:zM},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},_x={6:{f:Xg},10:{f:Ro},12:{f:vn},13:{f:vn},14:{f:on},15:{f:on},16:{f:gi},17:{f:on},18:{f:on},19:{f:vn},20:{f:k_},21:{f:k_},23:{f:UA},24:{f:b_},25:{f:on},26:{},27:{},28:{f:z3},29:{},34:{f:on},35:{f:F_},38:{f:gi},39:{f:gi},40:{f:gi},41:{f:gi},42:{f:on},43:{f:on},47:{f:eP},49:{f:g3},51:{f:vn},60:{},61:{f:u3},64:{f:on},65:{f:p3},66:{f:vn},77:{},80:{},81:{},82:{},85:{f:vn},89:{},90:{},91:{},92:{f:ZD},93:{f:$3},94:{},95:{f:on},96:{},97:{},99:{f:on},125:{f:VA},128:{f:I3},129:{f:t3},130:{f:vn},131:{f:on},132:{f:on},133:{f:r3},134:{},140:{f:Z3},141:{f:vn},144:{},146:{f:r6},151:{},152:{},153:{},154:{},155:{},156:{f:vn},157:{},158:{},160:{f:c6},161:{f:s6},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:C3},190:{f:k3},193:{f:Ro},197:{},198:{},199:{},200:{},201:{},202:{f:on},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:vn},220:{},221:{f:on},222:{},224:{f:b3},225:{f:JD},226:{f:Ro},227:{},229:{f:W3},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:i3},253:{f:x3},255:{f:a3},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:NA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:on},353:{f:Ro},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:O3},431:{f:on},432:{},433:{},434:{},437:{},438:{f:Y3},439:{f:on},440:{f:X3},441:{},442:{f:Gf},443:{},444:{f:vn},445:{},446:{},448:{f:Ro},449:{f:c3,r:2},450:{f:Ro},512:{f:T_},513:{f:l6},515:{f:D3},516:{f:y3},517:{f:C_},519:{f:u6},520:{f:o3},523:{},545:{f:I_},549:{f:w_},566:{},574:{f:f3},638:{f:A3},659:{},1048:{},1054:{f:E3},1084:{},1212:{f:L3},2048:{f:Q3},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:U0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ro},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:n6,r:12},2173:{f:ZP,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:on,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:j3,r:12},2197:{},2198:{f:KP,r:12},2199:{},2200:{},2201:{},2202:{f:U3,r:12},2203:{f:Ro},2204:{},2205:{},2206:{},2207:{},2211:{f:l3},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:vn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:a6},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:t6},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:T_},1:{},2:{f:g6},3:{f:h6},4:{f:f6},5:{f:C_},7:{f:x6},8:{},9:{f:U0},11:{},22:{f:vn},30:{f:w3},31:{},32:{},33:{f:I_},36:{},37:{f:w_},50:{f:v6},62:{},52:{},67:{},68:{f:vn},69:{},86:{},126:{},127:{f:d6},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:y6},223:{},234:{},354:{},421:{},518:{f:Xg},521:{f:U0},536:{f:b_},547:{f:F_},561:{},579:{},1030:{f:Xg},1033:{f:U0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ye(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&J1(r)&&t.push(r)}}function xj(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return Ye(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;var f=t.next(4);for(f.write_shift(2,s),f.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u;l<i;){for(f=t.next(4),f.write_shift(2,60),u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;f.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u}}}function qf(t,e,r){return t||(t=_e(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function vj(t,e,r,n){var i=_e(9);return qf(i,t,e),RA(r,n||"b",i),i}function yj(t,e,r){var n=_e(8+2*r.length);return qf(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function _j(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Nn(Nr(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?Ye(t,2,m6(r,n,i)):Ye(t,3,p6(r,n,i));return;case"b":case"e":Ye(t,5,vj(r,n,e.v,e.t));return;case"s":case"str":Ye(t,4,yj(r,n,(e.v||"").slice(0,255)));return}Ye(t,1,qf(null,r,n))}function Ej(t,e,r,n){var i=Array.isArray(e),s=tr(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=bt(s)}for(var u=s.s.r;u<=s.e.r;++u){o=un(u);for(var f=s.s.c;f<=s.e.c;++f){u===s.s.r&&(l[f]=Hr(f)),a=l[f]+o;var p=i?(e[u]||[])[f]:e[a];p&&_j(t,p,u,f)}}}function Sj(t,e){for(var r=e||{},n=Xi(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ye(n,r.biff==4?1033:r.biff==3?521:9,lv(t,16,r)),Ej(n,t.Sheets[t.SheetNames[i]],i,r),Ye(n,10),n.end()}function wj(t,e,r){Ye(t,49,m3({sz:12,name:"Arial"},r))}function Tj(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Ye(t,1054,S3(i,e[i],r))})}function Aj(t,e){var r=_e(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ye(t,2151,r),r=_e(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),BA(tr(e["!ref"]||"A1"),r),r.write_shift(4,4),Ye(t,2152,r)}function Cj(t,e){for(var r=0;r<16;++r)Ye(t,224,A_({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Ye(t,224,A_(n,0,e))})}function kj(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Ye(t,440,q3(n)),n[1].Tooltip&&Ye(t,2048,J3(n))}delete e["!links"]}function Fj(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&Ye(t,125,i6(Xp(i,n),i))})}}function bj(t,e,r,n,i){var s=16+wl(i.cellXfs,e,i);if(e.v==null&&!e.bf){Ye(t,513,rc(r,n,s));return}if(e.bf)Ye(t,6,tO(e,r,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?Nn(Nr(e.v)):e.v;Ye(t,515,P3(r,n,a,s));break;case"b":case"e":Ye(t,517,R3(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=mv(i.Strings,e.v,i.revStrings);Ye(t,253,v3(r,n,o,s))}else Ye(t,516,_3(r,n,(e.v||"").slice(0,255),s,i));break;default:Ye(t,513,rc(r,n,s))}}function Ij(t,e,r){var n=Xi(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},l=Array.isArray(s),u=e.biff==8,f,p="",g=[],m=tr(s["!ref"]||"A1"),y=u?65536:16384;if(m.e.c>255||m.e.r>=y){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,y-1)}Ye(n,2057,lv(r,16,e)),Ye(n,13,bs(1)),Ye(n,12,bs(100)),Ye(n,15,bi(!0)),Ye(n,17,bi(!1)),Ye(n,16,ec(.001)),Ye(n,95,bi(!0)),Ye(n,42,bi(!1)),Ye(n,43,bi(!1)),Ye(n,130,bs(1)),Ye(n,128,N3()),Ye(n,131,bi(!1)),Ye(n,132,bi(!1)),u&&Fj(n,s["!cols"]),Ye(n,512,T3(m,e)),u&&(s["!links"]=[]);for(var x=m.s.r;x<=m.e.r;++x){p=un(x);for(var S=m.s.c;S<=m.e.c;++S){x===m.s.r&&(g[S]=Hr(S)),f=g[S]+p;var A=l?(s[x]||[])[S]:s[f];A&&(bj(n,A,x,S,e),u&&A.l&&s["!links"].push([f,A.l]))}}var C=o.CodeName||o.name||i;return u&&Ye(n,574,h3((a.Views||[])[0])),u&&(s["!merges"]||[]).length&&Ye(n,229,H3(s["!merges"])),u&&kj(n,s),Ye(n,442,DA(C)),u&&Aj(n,s),Ye(n,10),n.end()}function Nj(t,e,r){var n=Xi(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(Ye(n,2057,lv(t,5,r)),r.bookType=="xla"&&Ye(n,135),Ye(n,225,o?bs(1200):null),Ye(n,193,RD(2)),l&&Ye(n,191),l&&Ye(n,192),Ye(n,226),Ye(n,92,e3("SheetJS",r)),Ye(n,66,bs(o?1200:1252)),o&&Ye(n,353,bs(0)),o&&Ye(n,448),Ye(n,317,o6(t.SheetNames.length)),o&&t.vbaraw&&Ye(n,211),o&&t.vbaraw){var u=a.CodeName||"ThisWorkbook";Ye(n,442,DA(u))}Ye(n,156,bs(17)),Ye(n,25,bi(!1)),Ye(n,18,bi(!1)),Ye(n,19,bs(0)),o&&Ye(n,431,bi(!1)),o&&Ye(n,444,bs(0)),Ye(n,61,d3()),Ye(n,64,bi(!1)),Ye(n,141,bs(0)),Ye(n,34,bi(cB(t)=="true")),Ye(n,14,bi(!0)),o&&Ye(n,439,bi(!1)),Ye(n,218,bs(0)),wj(n,t,r),Tj(n,t.SSF,r),Cj(n,r),o&&Ye(n,352,bi(!1));var f=n.end(),p=Xi();o&&Ye(p,140,e6()),o&&r.Strings&&xj(p,252,s3(r.Strings)),Ye(p,10);var g=p.end(),m=Xi(),y=0,x=0;for(x=0;x<t.SheetNames.length;++x)y+=(o?12:11)+(o?2:1)*t.SheetNames[x].length;var S=f.length+y+g.length;for(x=0;x<t.SheetNames.length;++x){var A=s[x]||{};Ye(m,133,n3({pos:S,hs:A.Hidden||0,dt:0,name:t.SheetNames[x]},r)),S+=e[x].length}var C=m.end();if(y!=C.length)throw new Error("BS8 "+y+" != "+C.length);var E=[];return f.length&&E.push(f),C.length&&E.push(C),g.length&&E.push(g),Vn(E)}function Rj(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=Rr(ft)),t&&t.SSF&&(Mu(),zp(t.SSF),r.revssf=Hp(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Ev(r),r.cellXfs=[],wl(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=Ij(i,r,t);return n.unshift(Nj(t,n,r)),Vn(n)}function CC(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=qi(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return Rj(t,e);case 4:case 3:case 2:return Sj(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function U_(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),a=i.index,o=s&&s.index||t.length,l=mR(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,f=0,p=0,g=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(a=0;a<l.length;++a){var x=l[a].trim(),S=x.slice(0,3).toLowerCase();if(S=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}f=0;continue}if(!(S!="<td"&&S!="<th")){var A=x.split(/<\/t[dh]>/i);for(o=0;o<A.length;++o){var C=A[o].trim();if(C.match(/<t[dh]/i)){for(var E=C,M=0;E.charAt(0)=="<"&&(M=E.indexOf(">"))>-1;)E=E.slice(M+1);for(var X=0;X<y.length;++X){var z=y[X];z.s.c==f&&z.s.r<u&&u<=z.e.r&&(f=z.e.c+1,X=-1)}var T=pt(C.slice(0,C.indexOf(">")));g=T.colspan?+T.colspan:1,((p=+T.rowspan)>1||g>1)&&y.push({s:{r:u,c:f},e:{r:u+(p||1)-1,c:f+g-1}});var F=T.t||T["data-t"]||"";if(!E.length){f+=g;continue}if(E=qT(E),m.s.r>u&&(m.s.r=u),m.e.r<u&&(m.e.r=u),m.s.c>f&&(m.s.c=f),m.e.c<f&&(m.e.c=f),!E.length){f+=g;continue}var w={t:"s",v:E};r.raw||!E.trim().length||F=="s"||(E==="TRUE"?w={t:"b",v:!0}:E==="FALSE"?w={t:"b",v:!1}:isNaN(ra(E))?isNaN(_u(E).getDate())||(w={t:"d",v:Nr(E)},r.cellDates||(w={t:"n",v:Nn(w.v)}),w.z=r.dateNF||ft[14]):w={t:"n",v:ra(E)}),r.dense?(n[u]||(n[u]=[]),n[u][f]=w):n[ht({r:u,c:f})]=w,f+=g}}}}return n["!ref"]=bt(m),y.length&&(n["!merges"]=y),n}function Dj(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>a)&&!(i[u].e.r<r||i[u].e.c<a)){if(i[u].s.r<r||i[u].s.c<a){o=-1;break}o=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(o<0)){var f=ht({r,c:a}),p=n.dense?(t[r]||[])[a]:t[f],g=p&&p.v!=null&&(p.h||X1(p.w||(so(p),p.w)||""))||"",m={};o>1&&(m.rowspan=o),l>1&&(m.colspan=l),n.editable?g='<span contenteditable="true">'+g+"</span>":p&&(m["data-t"]=p&&p.t||"z",p.v!=null&&(m["data-v"]=p.v),p.z!=null&&(m["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+p.l.Target+'">'+g+"</a>")),m.id=(n.id||"sjs")+"-"+f,s.push(Ge("td",g,m))}}var y="<tr>";return y+s.join("")+"</tr>"}var Pj='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Oj="</body></html>";function Mj(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Sl(U_(r[0],e),e);var n=Tv();return r.forEach(function(i,s){Av(n,U_(i,e),"Sheet"+(s+1))}),n}function Bj(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function kC(t,e){var r=e||{},n=r.header!=null?r.header:Pj,i=r.footer!=null?r.footer:Oj,s=[n],a=qi(t["!ref"]);r.dense=Array.isArray(t),s.push(Bj(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(Dj(t,a,o,r));return s.push("</table>"+i),s.join("")}function FC(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?$r(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var f=qi(t["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),i==-1&&(u.e.r=i=f.e.r+1)}var p=[],g=0,m=t["!rows"]||(t["!rows"]=[]),y=0,x=0,S=0,A=0,C=0,E=0;for(t["!cols"]||(t["!cols"]=[]);y<o.length&&x<l;++y){var M=o[y];if(V_(M)){if(n.display)continue;m[x]={hidden:!0}}var X=M.children;for(S=A=0;S<X.length;++S){var z=X[S];if(!(n.display&&V_(z))){var T=z.hasAttribute("data-v")?z.getAttribute("data-v"):z.hasAttribute("v")?z.getAttribute("v"):qT(z.innerHTML),F=z.getAttribute("data-z")||z.getAttribute("z");for(g=0;g<p.length;++g){var w=p[g];w.s.c==A+s&&w.s.r<x+i&&x+i<=w.e.r&&(A=w.e.c+1-s,g=-1)}E=+z.getAttribute("colspan")||1,((C=+z.getAttribute("rowspan")||1)>1||E>1)&&p.push({s:{r:x+i,c:A+s},e:{r:x+i+(C||1)-1,c:A+s+(E||1)-1}});var R={t:"s",v:T},P=z.getAttribute("data-t")||z.getAttribute("t")||"";T!=null&&(T.length==0?R.t=P||"z":n.raw||T.trim().length==0||P=="s"||(T==="TRUE"?R={t:"b",v:!0}:T==="FALSE"?R={t:"b",v:!1}:isNaN(ra(T))?isNaN(_u(T).getDate())||(R={t:"d",v:Nr(T)},n.cellDates||(R={t:"n",v:Nn(R.v)}),R.z=n.dateNF||ft[14]):R={t:"n",v:ra(T)})),R.z===void 0&&F!=null&&(R.z=F);var O="",D=z.getElementsByTagName("A");if(D&&D.length)for(var qe=0;qe<D.length&&!(D[qe].hasAttribute("href")&&(O=D[qe].getAttribute("href"),O.charAt(0)!="#"));++qe);O&&O.charAt(0)!="#"&&(R.l={Target:O}),n.dense?(t[x+i]||(t[x+i]=[]),t[x+i][A+s]=R):t[ht({c:A+s,r:x+i})]=R,u.e.c<A+s&&(u.e.c=A+s),A+=E}}++x}return p.length&&(t["!merges"]=(t["!merges"]||[]).concat(p)),u.e.r=Math.max(u.e.r,x-1+i),t["!ref"]=bt(u),x>=l&&(t["!fullref"]=bt((u.e.r=o.length-y+x-1+i,u))),t}function bC(t,e){var r=e||{},n=r.dense?[]:{};return FC(n,t,e)}function jj(t,e){return Sl(bC(t,e),e)}function V_(t){var e="",r=Lj(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Lj(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Uj(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=er(e.replace(/<[^>]*>/g,""));return[r]}var z_={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function IC(t,e){var r=e||{},n=q1(t),i=[],s,a,o={name:""},l="",u=0,f,p,g={},m=[],y=r.dense?[]:{},x,S,A={value:""},C="",E=0,M=[],X=-1,z=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}},F=0,w={},R=[],P={},O=0,D=0,qe=[],Ee=1,Pe=1,Fe=[],Ae={Names:[]},ne={},be=["",""],je=[],H={},te="",re=0,Y=!1,ye=!1,Te=0;for(yf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=yf.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(T.e.c>=T.s.c&&T.e.r>=T.s.r?y["!ref"]=bt(T):y["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=T.e.r&&(y["!fullref"]=y["!ref"],T.e.r=r.sheetRows-1,y["!ref"]=bt(T)),R.length&&(y["!merges"]=R),qe.length&&(y["!rows"]=qe),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),m.push(f.name),g[f.name]=y,ye=!1):x[0].charAt(x[0].length-2)!=="/"&&(f=pt(x[0],!1),X=z=-1,T.s.r=T.s.c=1e7,T.e.r=T.e.c=0,y=r.dense?[]:{},R=[],qe=[],ye=!0);break;case"table-row-group":x[1]==="/"?--F:++F;break;case"table-row":case"":if(x[1]==="/"){X+=Ee,Ee=1;break}if(p=pt(x[0],!1),p.?X=p.-1:X==-1&&(X=0),Ee=+p["number-rows-repeated"]||1,Ee<10)for(Te=0;Te<Ee;++Te)F>0&&(qe[X+Te]={level:F});z=-1;break;case"covered-table-cell":x[1]!=="/"&&++z,r.sheetStubs&&(r.dense?(y[X]||(y[X]=[]),y[X][z]={t:"z"}):y[ht({r:X,c:z})]={t:"z"}),C="",M=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++z,A=pt(x[0],!1),Pe=parseInt(A["number-columns-repeated"]||"1",10),S={t:"z",v:null},A.formula&&r.cellFormula!=!1&&(S.f=B_(er(A.formula))),(A.||A["value-type"])=="string"&&(S.t="s",S.v=er(A["string-value"]||""),r.dense?(y[X]||(y[X]=[]),y[X][z]=S):y[ht({r:X,c:z})]=S),z+=Pe-1;else if(x[1]!=="/"){++z,C="",E=0,M=[],Pe=1;var Ve=Ee?X+Ee-1:X;if(z>T.e.c&&(T.e.c=z),z<T.s.c&&(T.s.c=z),X<T.s.r&&(T.s.r=X),Ve>T.e.r&&(T.e.r=Ve),A=pt(x[0],!1),je=[],H={},S={t:A.||A["value-type"],v:null},r.cellFormula)if(A.formula&&(A.formula=er(A.formula)),A["number-matrix-columns-spanned"]&&A["number-matrix-rows-spanned"]&&(O=parseInt(A["number-matrix-rows-spanned"],10)||0,D=parseInt(A["number-matrix-columns-spanned"],10)||0,P={s:{r:X,c:z},e:{r:X+O-1,c:z+D-1}},S.F=bt(P),Fe.push([P,S.F])),A.formula)S.f=B_(A.formula);else for(Te=0;Te<Fe.length;++Te)X>=Fe[Te][0].s.r&&X<=Fe[Te][0].e.r&&z>=Fe[Te][0].s.c&&z<=Fe[Te][0].e.c&&(S.F=Fe[Te][1]);switch((A["number-columns-spanned"]||A["number-rows-spanned"])&&(O=parseInt(A["number-rows-spanned"],10)||0,D=parseInt(A["number-columns-spanned"],10)||0,P={s:{r:X,c:z},e:{r:X+O-1,c:z+D-1}},R.push(P)),A["number-columns-repeated"]&&(Pe=parseInt(A["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=br(A["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(A.value);break;case"percentage":S.t="n",S.v=parseFloat(A.value);break;case"currency":S.t="n",S.v=parseFloat(A.value);break;case"date":S.t="d",S.v=Nr(A["date-value"]),r.cellDates||(S.t="n",S.v=Nn(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=hR(A["time-value"])/86400,r.cellDates&&(S.t="d",S.v=$p(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(A.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",A["string-value"]!=null&&(C=er(A["string-value"]),M=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(Y=!1,S.t==="s"&&(S.v=C||"",M.length&&(S.R=M),Y=E==0),ne.Target&&(S.l=ne),je.length>0&&(S.c=je,je=[]),C&&r.cellText!==!1&&(S.w=C),Y&&(S.t="z",delete S.v),(!Y||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=X))for(var De=0;De<Ee;++De){if(Pe=parseInt(A["number-columns-repeated"]||"1",10),r.dense)for(y[X+De]||(y[X+De]=[]),y[X+De][z]=De==0?S:Rr(S);--Pe>0;)y[X+De][z+Pe]=Rr(S);else for(y[ht({r:X+De,c:z})]=S;--Pe>0;)y[ht({r:X+De,c:z+Pe})]=Rr(S);T.e.c<=z&&(T.e.c=z)}Pe=parseInt(A["number-columns-repeated"]||"1",10),z+=Pe-1,Pe=0,S={},C="",M=[]}ne={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s;H.t=C,M.length&&(H.R=M),H.a=te,je.push(H)}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);te="",re=0,C="",E=0,M=[];break;case"creator":x[1]==="/"?te=n.slice(re,x.index):re=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);C="",E=0,M=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(w[o.name]=l,(s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&(l="",o=pt(x[0],!1),i.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=pt(x[0],!1),l+=z_[x[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=pt(x[0],!1),l+=z_[x[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,x.index);break}else u=x.index+x[0].length;break;case"named-range":a=pt(x[0],!1),be=qg(a["cell-range-address"]);var Ne={Name:a.name,Ref:be[0]+"!"+be[1]};ye&&(Ne.Sheet=m.length),Ae.Names.push(Ne);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(x[1]==="/"&&(!A||!A["string-value"])){var it=Uj(n.slice(E,x.index));C=(C.length>0?C+`
`:"")+it[0]}else pt(x[0],!1),E=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{be=qg(pt(x[0])["target-range-address"]),g[be[0]]["!autofilter"]={ref:be[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(ne=pt(x[0],!1),!ne.href)break;ne.Target=er(ne.href),delete ne.href,ne.Target.charAt(0)=="#"&&ne.Target.indexOf(".")>-1?(be=qg(ne.Target.slice(1)),ne.Target="#"+be[0]+"!"+be[1]):ne.Target.match(/^\.\.[\\\/]/)&&(ne.Target=ne.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var Z={Sheets:g,SheetNames:m,Workbook:Ae};return r.bookSheets&&delete Z.Sheets,Z}function W_(t,e){e=e||{},Fs(t,"META-INF/manifest.xml")&&hD(xn(t,"META-INF/manifest.xml"),e);var r=ls(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=IC(vr(r),e);return Fs(t,"meta.xml")&&(n.Props=_A(xn(t,"meta.xml"))),n}function H_(t,e){return IC(t,e)}var Vj=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+vf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return dn+e}}(),$_=function(){var t=function(s){return pr(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+pr(a.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,f=0,p=qi(s["!ref"]||"A1"),g=s["!merges"]||[],m=0,y=Array.isArray(s);if(s["!cols"])for(f=0;f<=p.e.c;++f)l.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var x="",S=s["!rows"]||[];for(u=0;u<p.s.r;++u)x=S[u]?' table:style-name="ro'+S[u].ods+'"':"",l.push("        <table:table-row"+x+`></table:table-row>
`);for(;u<=p.e.r;++u){for(x=S[u]?' table:style-name="ro'+S[u].ods+'"':"",l.push("        <table:table-row"+x+`>
`),f=0;f<p.s.c;++f)l.push(e);for(;f<=p.e.c;++f){var A=!1,C={},E="";for(m=0;m!=g.length;++m)if(!(g[m].s.c>f)&&!(g[m].s.r>u)&&!(g[m].e.c<f)&&!(g[m].e.r<u)){(g[m].s.c!=f||g[m].s.r!=u)&&(A=!0),C["table:number-columns-spanned"]=g[m].e.c-g[m].s.c+1,C["table:number-rows-spanned"]=g[m].e.r-g[m].s.r+1;break}if(A){l.push(r);continue}var M=ht({r:u,c:f}),X=y?(s[u]||[])[f]:s[M];if(X&&X.f&&(C["table:formula"]=pr(oO(X.f)),X.F&&X.F.slice(0,M.length)==M)){var z=qi(X.F);C["table:number-matrix-columns-spanned"]=z.e.c-z.s.c+1,C["table:number-matrix-rows-spanned"]=z.e.r-z.s.r+1}if(!X){l.push(e);continue}switch(X.t){case"b":E=X.v?"TRUE":"FALSE",C["office:value-type"]="boolean",C["office:boolean-value"]=X.v?"true":"false";break;case"n":E=X.w||String(X.v||0),C["office:value-type"]="float",C["office:value"]=X.v||0;break;case"s":case"str":E=X.v==null?"":X.v,C["office:value-type"]="string";break;case"d":E=X.w||Nr(X.v).toISOString(),C["office:value-type"]="date",C["office:date-value"]=Nr(X.v).toISOString(),C["table:style-name"]="ce1";break;default:l.push(e);continue}var T=t(E);if(X.l&&X.l.Target){var F=X.l.Target;F=F.charAt(0)=="#"?"#"+lO(F.slice(1)):F,F.charAt(0)!="#"&&!F.match(/^\w+:/)&&(F="../"+F),T=Ge("text:a",T,{"xlink:href":F.replace(/&/g,"&amp;")})}l.push("          "+Ge("table:table-cell",Ge("text:p",T,{}),C)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var f=0;f<u["!cols"].length;++f)if(u["!cols"][f]){var p=u["!cols"][f];if(p.width==null&&p.wpx==null&&p.wch==null)continue;fl(p),p.ods=o;var g=u["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var f=0;f<u["!rows"].length;++f)if(u["!rows"][f]){u["!rows"][f].ods=l;var p=u["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[dn],u=vf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=vf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+f+`>
`),l.push(yA().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var p=0;p!=a.SheetNames.length;++p)l.push(n(a.Sheets[a.SheetNames[p]],a,p));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function NC(t,e){if(e.bookType=="fods")return $_(t,e);var r=G1(),n="",i=[],s=[];return n="mimetype",It(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",It(r,n,$_(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",It(r,n,Vj(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",It(r,n,dn+yA()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",It(r,n,mD(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",It(r,n,pD(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function nc(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Ex(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):vr(El(t))}function zj(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):os(Aa(t))}function Wj(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function pl(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function G_(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function Hj(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function $j(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function Cf(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function fr(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Zr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function ir(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=Cf(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=Cf(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:o,type:s};e[i]==null?e[i]=[u]:e[i].push(u)}return e}function Kn(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(fr(n*8+i.type)),i.type==2&&e.push(fr(i.data.length)),e.push(i.data))})}),pl(e)}function yv(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function Cs(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=Cf(t,n),s=ir(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:Zr(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=ir(o.data),u=Zr(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=s[3])!=null&&e[0]&&(a.merge=Zr(s[3][0].data)>>>0>0),r.push(a)}return r}function Nc(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:fr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:fr(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:fr(a.data.length)}],n[2].push({data:Kn(a.meta),type:2})});var s=Kn(n);e.push(fr(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),pl(e)}function Gj(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Cf(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,u=0;if(s==1?(u=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[pl(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var f=pl(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function ks(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(Gj(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return pl(e)}function Rc(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=fr(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return pl(e)}function Kj(t,e,r,n){var i=nc(t),s=i.getUint32(4,!0),a=(n>1?12:8)+G_(s&(n>1?3470:398))*4,o=-1,l=-1,u=NaN,f=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=G_(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(a,!0),a+=4),s&32&&(u=i.getFloat64(a,!0),a+=8),s&64&&(f.setTime(f.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var p;switch(t[2]){case 0:break;case 2:p={t:"n",v:u};break;case 3:p={t:"s",v:e[l]};break;case 5:p={t:"d",v:f};break;case 6:p={t:"b",v:u>0};break;case 7:p={t:"n",v:u/86400};break;case 8:p={t:"e",v:0};break;case 9:if(o>-1)p={t:"s",v:r[o]};else if(l>-1)p={t:"s",v:e[l]};else if(!isNaN(u))p={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return p}function Yj(t,e,r){var n=nc(t),i=n.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,u=NaN,f=new Date(2001,0,1);i&1&&(l=Hj(t,s),s+=16),i&2&&(u=n.getFloat64(s,!0),s+=8),i&4&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var p;switch(t[1]){case 0:break;case 2:p={t:"n",v:l};break;case 3:p={t:"s",v:e[o]};break;case 5:p={t:"d",v:f};break;case 6:p={t:"b",v:u>0};break;case 7:p={t:"n",v:u/86400};break;case 8:p={t:"e",v:0};break;case 9:if(a>-1)p={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:p={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return p}function Jg(t,e){var r=new Uint8Array(32),n=nc(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,$j(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function Zg(t,e){var r=new Uint8Array(32),n=nc(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function Xj(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return Kj(t,e,r,t[0]);case 5:return Yj(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function ci(t){var e=ir(t);return Cf(e[1][0].data)}function K_(t,e){var r=ir(e.data),n=Zr(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=ir(a.data),l=Zr(o[1][0].data)>>>0;switch(n){case 1:s[l]=Ex(o[3][0].data);break;case 8:{var u=t[ci(o[9][0].data)][0],f=ir(u.data),p=t[ci(f[1][0].data)][0],g=Zr(p.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var m=ir(p.data);s[l]=m[3].map(function(y){return Ex(y.data)}).join("")}break}}),s}function qj(t,e){var r,n,i,s,a,o,l,u,f,p,g,m,y,x,S=ir(t),A=Zr(S[1][0].data)>>>0,C=Zr(S[2][0].data)>>>0,E=((n=(r=S[8])==null?void 0:r[0])==null?void 0:n.data)&&Zr(S[8][0].data)>0||!1,M,X;if((s=(i=S[7])==null?void 0:i[0])!=null&&s.data&&e!=0)M=(o=(a=S[7])==null?void 0:a[0])==null?void 0:o.data,X=(u=(l=S[6])==null?void 0:l[0])==null?void 0:u.data;else if((p=(f=S[4])==null?void 0:f[0])!=null&&p.data&&e!=1)M=(m=(g=S[4])==null?void 0:g[0])==null?void 0:m.data,X=(x=(y=S[3])==null?void 0:y[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var z=E?4:1,T=nc(M),F=[],w=0;w<M.length/2;++w){var R=T.getUint16(w*2,!0);R<65535&&F.push([w,R])}if(F.length!=C)throw"Expected ".concat(C," cells, found ").concat(F.length);var P=[];for(w=0;w<F.length-1;++w)P[F[w][0]]=X.subarray(F[w][1]*z,F[w+1][1]*z);return F.length>=1&&(P[F[F.length-1][0]]=X.subarray(F[F.length-1][1]*z)),{R:A,cells:P}}function Qj(t,e){var r,n=ir(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Zr(n[7][0].data)>>>0>0?1:0:-1,s=yv(n[5],function(a){return qj(a,i)});return{nrows:Zr(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,u){if(a[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));a[o.R][u]=l}),a},[])}}function Jj(t,e,r){var n,i=ir(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Zr(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Zr(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=bt(s);var a=ir(i[4][0].data),o=K_(t,t[ci(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?K_(t,t[ci(a[17][0].data)][0]):[],u=ir(a[3][0].data),f=0;u[1].forEach(function(p){var g=ir(p.data),m=t[ci(g[2][0].data)][0],y=Zr(m.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var x=Qj(t,m);x.data.forEach(function(S,A){S.forEach(function(C,E){var M=ht({r:f+A,c:E}),X=Xj(C,o,l);X&&(r[M]=X)})}),f+=x.nrows})}function Zj(t,e){var r=ir(e.data),n={"!ref":"A1"},i=t[ci(r[2][0].data)],s=Zr(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return Jj(t,i[0],n),n}function eL(t,e){var r,n=ir(e.data),i={name:(r=n[1])!=null&&r[0]?Ex(n[1][0].data):"",sheets:[]},s=yv(n[2],ci);return s.forEach(function(a){t[a].forEach(function(o){var l=Zr(o.meta[1][0].data);l==6e3&&i.sheets.push(Zj(t,o))})}),i}function tL(t,e){var r=Tv(),n=ir(e.data),i=yv(n[1],ci);if(i.forEach(function(s){t[s].forEach(function(a){var o=Zr(a.meta[1][0].data);if(o==2){var l=eL(t,a);l.sheets.forEach(function(u,f){Av(r,u,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function em(t){var e,r,n,i,s={},a=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=ks(l.content)}catch(p){return console.log("?? "+l.content.length+" "+(p.message||p))}var f;try{f=Cs(u)}catch(p){return console.log("## "+(p.message||p))}f.forEach(function(p){s[p.id]=p.messages,a.push(p.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Zr(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(u){var f=Zr(u.meta[1][0].data)>>>0;if(f==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return tL(s,o)}function rL(t,e,r){var n,i,s,a;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=t[8])==null?void 0:s[0])==null?void 0:a.data)&&Zr(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=nc(t[7][0].data),f=0,p=[],g=nc(t[4][0].data),m=0,y=[],x=0;x<e.length;++x){if(e[x]==null){u.setUint16(x*2,65535,!0),g.setUint16(x*2,65535);continue}u.setUint16(x*2,f,!0),g.setUint16(x*2,m,!0);var S,A;switch(typeof e[x]){case"string":S=Jg({t:"s",v:e[x]},r),A=Zg({t:"s",v:e[x]},r);break;case"number":S=Jg({t:"n",v:e[x]},r),A=Zg({t:"n",v:e[x]},r);break;case"boolean":S=Jg({t:"b",v:e[x]},r),A=Zg({t:"b",v:e[x]},r);break;default:throw new Error("Unsupported value "+e[x])}p.push(S),f+=S.length,y.push(A),m+=A.length,++l}for(t[2][0].data=fr(l);x<t[7][0].data.length/2;++x)u.setUint16(x*2,65535,!0),g.setUint16(x*2,65535,!0);return t[6][0].data=pl(p),t[3][0].data=pl(y),l}function nL(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=qi(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(bt(n)));var s=op(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(te){return te.forEach(function(re){typeof re=="string"&&a.push(re)})});var o={},l=[],u=st.read(e.numbers,{type:"base64"});u.FileIndex.map(function(te,re){return[te,u.FullPaths[re]]}).forEach(function(te){var re=te[0],Y=te[1];if(re.type==2&&re.name.match(/\.iwa/)){var ye=re.content,Te=ks(ye),Ve=Cs(Te);Ve.forEach(function(De){l.push(De.id),o[De.id]={deps:[],location:Y,type:Zr(De.messages[0].meta[1][0].data)}})}}),l.sort(function(te,re){return te-re});var f=l.filter(function(te){return te>1}).map(function(te){return[te,fr(te)]});u.FileIndex.map(function(te,re){return[te,u.FullPaths[re]]}).forEach(function(te){var re=te[0];if(te[1],!!re.name.match(/\.iwa/)){var Y=Cs(ks(re.content));Y.forEach(function(ye){ye.messages.forEach(function(Te){f.forEach(function(Ve){ye.messages.some(function(De){return Zr(De.meta[1][0].data)!=11006&&Wj(De.data,Ve[1])})&&o[Ve[0]].deps.push(ye.id)})})})}});for(var p=st.find(u,o[1].location),g=Cs(ks(p.content)),m,y=0;y<g.length;++y){var x=g[y];x.id==1&&(m=x)}var S=ci(ir(m.messages[0].data)[1][0].data);for(p=st.find(u,o[S].location),g=Cs(ks(p.content)),y=0;y<g.length;++y)x=g[y],x.id==S&&(m=x);for(S=ci(ir(m.messages[0].data)[2][0].data),p=st.find(u,o[S].location),g=Cs(ks(p.content)),y=0;y<g.length;++y)x=g[y],x.id==S&&(m=x);for(S=ci(ir(m.messages[0].data)[2][0].data),p=st.find(u,o[S].location),g=Cs(ks(p.content)),y=0;y<g.length;++y)x=g[y],x.id==S&&(m=x);var A=ir(m.messages[0].data);{A[6][0].data=fr(n.e.r+1),A[7][0].data=fr(n.e.c+1);var C=ci(A[46][0].data),E=st.find(u,o[C].location),M=Cs(ks(E.content));{for(var X=0;X<M.length&&M[X].id!=C;++X);if(M[X].id!=C)throw"Bad ColumnRowUIDMapArchive";var z=ir(M[X].messages[0].data);z[1]=[],z[2]=[],z[3]=[];for(var T=0;T<=n.e.c;++T){var F=[];F[1]=F[2]=[{type:0,data:fr(T+420690)}],z[1].push({type:2,data:Kn(F)}),z[2].push({type:0,data:fr(T)}),z[3].push({type:0,data:fr(T)})}z[4]=[],z[5]=[],z[6]=[];for(var w=0;w<=n.e.r;++w)F=[],F[1]=F[2]=[{type:0,data:fr(w+726270)}],z[4].push({type:2,data:Kn(F)}),z[5].push({type:0,data:fr(w)}),z[6].push({type:0,data:fr(w)});M[X].messages[0].data=Kn(z)}E.content=Rc(Nc(M)),E.size=E.content.length,delete A[46];var R=ir(A[4][0].data);{R[7][0].data=fr(n.e.r+1);var P=ir(R[1][0].data),O=ci(P[2][0].data);E=st.find(u,o[O].location),M=Cs(ks(E.content));{if(M[0].id!=O)throw"Bad HeaderStorageBucket";var D=ir(M[0].messages[0].data);for(w=0;w<s.length;++w){var qe=ir(D[2][0].data);qe[1][0].data=fr(w),qe[4][0].data=fr(s[w].length),D[2][w]={type:D[2][0].type,data:Kn(qe)}}M[0].messages[0].data=Kn(D)}E.content=Rc(Nc(M)),E.size=E.content.length;var Ee=ci(R[2][0].data);E=st.find(u,o[Ee].location),M=Cs(ks(E.content));{if(M[0].id!=Ee)throw"Bad HeaderStorageBucket";for(D=ir(M[0].messages[0].data),T=0;T<=n.e.c;++T)qe=ir(D[2][0].data),qe[1][0].data=fr(T),qe[4][0].data=fr(n.e.r+1),D[2][T]={type:D[2][0].type,data:Kn(qe)};M[0].messages[0].data=Kn(D)}E.content=Rc(Nc(M)),E.size=E.content.length;var Pe=ci(R[4][0].data);(function(){for(var te=st.find(u,o[Pe].location),re=Cs(ks(te.content)),Y,ye=0;ye<re.length;++ye){var Te=re[ye];Te.id==Pe&&(Y=Te)}var Ve=ir(Y.messages[0].data);{Ve[3]=[];var De=[];a.forEach(function(Z,Rt){De[1]=[{type:0,data:fr(Rt)}],De[2]=[{type:0,data:fr(1)}],De[3]=[{type:2,data:zj(Z)}],Ve[3].push({type:2,data:Kn(De)})})}Y.messages[0].data=Kn(Ve);var Ne=Nc(re),it=Rc(Ne);te.content=it,te.size=te.content.length})();var Fe=ir(R[3][0].data);{var Ae=Fe[1][0];delete Fe[2];var ne=ir(Ae.data);{var be=ci(ne[2][0].data);(function(){for(var te=st.find(u,o[be].location),re=Cs(ks(te.content)),Y,ye=0;ye<re.length;++ye){var Te=re[ye];Te.id==be&&(Y=Te)}var Ve=ir(Y.messages[0].data);{delete Ve[6],delete Fe[7];var De=new Uint8Array(Ve[5][0].data);Ve[5]=[];for(var Ne=0,it=0;it<=n.e.r;++it){var Z=ir(De);Ne+=rL(Z,s[it],a),Z[1][0].data=fr(it),Ve[5].push({data:Kn(Z),type:2})}Ve[1]=[{type:0,data:fr(n.e.c+1)}],Ve[2]=[{type:0,data:fr(n.e.r+1)}],Ve[3]=[{type:0,data:fr(Ne)}],Ve[4]=[{type:0,data:fr(n.e.r+1)}]}Y.messages[0].data=Kn(Ve);var Rt=Nc(re),Et=Rc(Rt);te.content=Et,te.size=te.content.length})()}Ae.data=Kn(ne)}R[3][0].data=Kn(Fe)}A[4][0].data=Kn(R)}m.messages[0].data=Kn(A);var je=Nc(g),H=Rc(je);return p.content=H,p.size=p.content.length,u}function RC(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function _v(t){RC([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function Ev(t){RC([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function iL(t){return jt.WS.indexOf(t)>-1?"sheet":t==jt.CS?"chart":t==jt.DS?"dialog":t==jt.MS?"macro":t&&t.length?t:"sheet"}function sL(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,iL(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function aL(t,e,r,n,i,s,a,o,l,u,f,p){try{s[n]=Ud(ls(t,r,!0),e);var g=xn(t,e),m;switch(o){case"sheet":m=FB(g,e,i,l,s[n],u,f,p);break;case"chart":if(m=bB(g,e,i,l,s[n],u,f,p),!m||!m["!drawel"])break;var y=wd(m["!drawel"].Target,e),x=_f(y),S=g8(ls(t,y,!0),Ud(ls(t,x,!0),y)),A=wd(S,y),C=_f(A);m=rB(ls(t,A,!0),A,l,Ud(ls(t,C,!0),A),u,m);break;case"macro":m=IB(g,e,i,l,s[n],u,f,p);break;case"dialog":m=NB(g,e,i,l,s[n],u,f,p);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=m;var E=[];s&&s[n]&&en(s[n]).forEach(function(M){var X="";if(s[n][M].Type==jt.CMNT){X=wd(s[n][M].Target,e);var z=OB(xn(t,X,!0),X,l);if(!z||!z.length)return;R_(m,z,!1)}s[n][M].Type==jt.TCMNT&&(X=wd(s[n][M].Target,e),E=E.concat(x8(xn(t,X,!0),l)))}),E&&E.length&&R_(m,E,!0,l.people||[])}catch(M){if(l.WTF)throw M}}function Ts(t){return t.charAt(0)=="/"?t.slice(1):t}function oL(t,e){if(Mu(),e=e||{},_v(e),Fs(t,"META-INF/manifest.xml")||Fs(t,"objectdata.xml"))return W_(t,e);if(Fs(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof em<"u"){if(t.FileIndex)return em(t);var r=st.utils.cfb_new();return Z2(t).forEach(function(qe){It(r,qe,vR(t,qe))}),em(r)}throw new Error("Unsupported NUMBERS file")}if(!Fs(t,"[Content_Types].xml"))throw Fs(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Fs(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Z2(t),i=dD(ls(t,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",xn(t,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!xn(t,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},u={};if(!e.bookSheets&&!e.bookProps){if(Vd=[],i.sst)try{Vd=PB(xn(t,Ts(i.sst)),i.sst,e)}catch(qe){if(e.WTF)throw qe}e.cellStyles&&i.themes.length&&(l=DB(ls(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(u=RB(xn(t,Ts(i.style)),i.style,l,e))}i.links.map(function(qe){try{var Ee=Ud(ls(t,_f(Ts(qe))),qe);return BB(xn(t,Ts(qe)),Ee,qe,e)}catch{}});var f=kB(xn(t,Ts(i.workbooks[0])),i.workbooks[0],e),p={},g="";i.coreprops.length&&(g=xn(t,Ts(i.coreprops[0]),!0),g&&(p=_A(g)),i.extprops.length!==0&&(g=xn(t,Ts(i.extprops[0]),!0),g&&vD(g,p,e)));var m={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(g=ls(t,Ts(i.custprops[0]),!0),g&&(m=_D(g,e)));var y={};if((e.bookSheets||e.bookProps)&&(f.Sheets?a=f.Sheets.map(function(Ee){return Ee.name}):p.Worksheets&&p.SheetNames.length>0&&(a=p.SheetNames),e.bookProps&&(y.Props=p,y.Custprops=m),e.bookSheets&&typeof a<"u"&&(y.SheetNames=a),e.bookSheets?y.SheetNames:e.bookProps))return y;a={};var x={};e.bookDeps&&i.calcchain&&(x=MB(xn(t,Ts(i.calcchain)),i.calcchain));var S=0,A={},C,E;{var M=f.Sheets;p.Worksheets=M.length,p.SheetNames=[];for(var X=0;X!=M.length;++X)p.SheetNames[X]=M[X].name}var z=s?"bin":"xml",T=i.workbooks[0].lastIndexOf("/"),F=(i.workbooks[0].slice(0,T+1)+"_rels/"+i.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");Fs(t,F)||(F="xl/_rels/workbook."+z+".rels");var w=Ud(ls(t,F,!0),F.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=jB(xn(t,Ts(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=y8(xn(t,Ts(i.people[0])),e)),w&&(w=sL(w,f.Sheets));var R=xn(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=p.Worksheets;++S){var P="sheet";if(w&&w[S]?(C="xl/"+w[S][1].replace(/[\/]?xl\//,""),Fs(t,C)||(C=w[S][1]),Fs(t,C)||(C=F.replace(/_rels\/.*$/,"")+w[S][1]),P=w[S][2]):(C="xl/worksheets/sheet"+(S+1-R)+"."+z,C=C.replace(/sheet0\./,"sheet.")),E=C.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(S!=e.sheets)continue e;break;case"string":if(p.SheetNames[S].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var O=!1,D=0;D!=e.sheets.length;++D)typeof e.sheets[D]=="number"&&e.sheets[D]==S&&(O=1),typeof e.sheets[D]=="string"&&e.sheets[D].toLowerCase()==p.SheetNames[S].toLowerCase()&&(O=1);if(!O)continue e}}aL(t,C,E,p.SheetNames[S],S,A,a,P,e,f,l,u)}return y={Directory:i,Workbook:f,Props:p,Custprops:m,Deps:x,Sheets:a,SheetNames:p.SheetNames,Strings:Vd,Styles:u,Themes:l,SSF:Rr(ft)},e&&e.bookFiles&&(t.files?(y.keys=n,y.files=t.files):(y.keys=[],y.files={},t.FullPaths.forEach(function(qe,Ee){qe=qe.replace(/^Root Entry[\/]/,""),y.keys.push(qe),y.files[qe]=t.FileIndex[Ee]}))),e&&e.bookVBA&&(i.vba.length>0?y.vbaraw=xn(t,Ts(i.vba[0]),!0):i.defaults&&i.defaults.bin===k8&&(y.vbaraw=xn(t,"xl/vbaProject.bin",!0))),y}function lL(t,e){var r=e||{},n="Workbook",i=st.find(t,n);try{if(n="/!DataSpaces/Version",i=st.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(j6(i.content),n="/!DataSpaces/DataSpaceMap",i=st.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=U6(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=st.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=V6(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=st.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);W6(i.content)}catch{}if(n="/EncryptionInfo",i=st.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=H6(i.content);if(n="/EncryptedPackage",i=st.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function cL(t,e){return e.bookType=="ods"?NC(t,e):e.bookType=="numbers"?nL(t,e):e.bookType=="xlsb"?uL(t,e):dL(t,e)}function uL(t,e){Qc=1024,t&&!t.SSF&&(t.SSF=Rr(ft)),t&&t.SSF&&(Mu(),zp(t.SSF),e.revssf=Hp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,zd?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=sC.indexOf(e.bookType)>-1,i=av();Ev(e=e||{});var s=G1(),a="",o=0;if(e.cellXfs=[],wl(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",It(s,a,EA(t.Props,e)),i.coreprops.push(a),hr(e.rels,2,a,jt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,It(s,a,TA(t.Props)),i.extprops.push(a),hr(e.rels,3,a,jt.EXT_PROPS),t.Custprops!==t.Props&&en(t.Custprops||{}).length>0&&(a="docProps/custom.xml",It(s,a,AA(t.Custprops)),i.custprops.push(a),hr(e.rels,4,a,jt.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var f={"!id":{}},p=t.Sheets[t.SheetNames[o-1]],g=(p||{})["!type"]||"sheet";switch(g){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,It(s,a,UB(o-1,a,e,t,f)),i.sheets.push(a),hr(e.wbrels,-1,"worksheets/sheet"+o+"."+r,jt.WS[0])}if(p){var m=p["!comments"],y=!1,x="";m&&m.length>0&&(x="xl/comments"+o+"."+r,It(s,x,WB(m,x)),i.comments.push(x),hr(f,-1,"../comments"+o+"."+r,jt.CMNT),y=!0),p["!legacy"]&&y&&It(s,"xl/drawings/vmlDrawing"+o+".vml",nC(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}f["!id"].rId1&&It(s,_f(a),au(f))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,It(s,a,zB(e.Strings,a,e)),i.strs.push(a),hr(e.wbrels,-1,"sharedStrings."+r,jt.SST)),a="xl/workbook."+r,It(s,a,LB(t,a)),i.workbooks.push(a),hr(e.rels,1,a,jt.WB),a="xl/theme/theme1.xml",It(s,a,fv(t.Themes,e)),i.themes.push(a),hr(e.wbrels,-1,"theme/theme1.xml",jt.THEME),a="xl/styles."+r,It(s,a,VB(t,a,e)),i.styles.push(a),hr(e.wbrels,-1,"styles."+r,jt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",It(s,a,t.vbaraw),i.vba.push(a),hr(e.wbrels,-1,"vbaProject.bin",jt.VBA)),a="xl/metadata."+r,It(s,a,HB(a)),i.metadata.push(a),hr(e.wbrels,-1,"metadata."+r,jt.XLMETA),It(s,"[Content_Types].xml",vA(i,e)),It(s,"_rels/.rels",au(e.rels)),It(s,"xl/_rels/workbook."+r+".rels",au(e.wbrels)),delete e.revssf,delete e.ssf,s}function dL(t,e){Qc=1024,t&&!t.SSF&&(t.SSF=Rr(ft)),t&&t.SSF&&(Mu(),zp(t.SSF),e.revssf=Hp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,zd?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=sC.indexOf(e.bookType)>-1,i=av();Ev(e=e||{});var s=G1(),a="",o=0;if(e.cellXfs=[],wl(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",It(s,a,EA(t.Props,e)),i.coreprops.push(a),hr(e.rels,2,a,jt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,It(s,a,TA(t.Props)),i.extprops.push(a),hr(e.rels,3,a,jt.EXT_PROPS),t.Custprops!==t.Props&&en(t.Custprops||{}).length>0&&(a="docProps/custom.xml",It(s,a,AA(t.Custprops)),i.custprops.push(a),hr(e.rels,4,a,jt.CUST_PROPS));var f=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var p={"!id":{}},g=t.Sheets[t.SheetNames[o-1]],m=(g||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,It(s,a,mC(o-1,e,t,p)),i.sheets.push(a),hr(e.wbrels,-1,"worksheets/sheet"+o+"."+r,jt.WS[0])}if(g){var y=g["!comments"],x=!1,S="";if(y&&y.length>0){var A=!1;y.forEach(function(C){C[1].forEach(function(E){E.T==!0&&(A=!0)})}),A&&(S="xl/threadedComments/threadedComment"+o+"."+r,It(s,S,v8(y,f,e)),i.threadedcomments.push(S),hr(p,-1,"../threadedComments/threadedComment"+o+"."+r,jt.TCMNT)),S="xl/comments"+o+"."+r,It(s,S,iC(y)),i.comments.push(S),hr(p,-1,"../comments"+o+"."+r,jt.CMNT),x=!0}g["!legacy"]&&x&&It(s,"xl/drawings/vmlDrawing"+o+".vml",nC(o,g["!comments"])),delete g["!comments"],delete g["!legacy"]}p["!id"].rId1&&It(s,_f(a),au(p))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,It(s,a,$A(e.Strings,e)),i.strs.push(a),hr(e.wbrels,-1,"sharedStrings."+r,jt.SST)),a="xl/workbook."+r,It(s,a,EC(t)),i.workbooks.push(a),hr(e.rels,1,a,jt.WB),a="xl/theme/theme1.xml",It(s,a,fv(t.Themes,e)),i.themes.push(a),hr(e.wbrels,-1,"theme/theme1.xml",jt.THEME),a="xl/styles."+r,It(s,a,ZA(t,e)),i.styles.push(a),hr(e.wbrels,-1,"styles."+r,jt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",It(s,a,t.vbaraw),i.vba.push(a),hr(e.wbrels,-1,"vbaProject.bin",jt.VBA)),a="xl/metadata."+r,It(s,a,rC()),i.metadata.push(a),hr(e.wbrels,-1,"metadata."+r,jt.XLMETA),f.length>1&&(a="xl/persons/person.xml",It(s,a,_8(f)),i.people.push(a),hr(e.wbrels,-1,"persons/person.xml",jt.PEOPLE)),It(s,"[Content_Types].xml",vA(i,e)),It(s,"_rels/.rels",au(e.rels)),It(s,"xl/_rels/workbook."+r+".rels",au(e.wbrels)),delete e.revssf,delete e.ssf,s}function Sv(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=hs(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function fL(t,e){return st.find(t,"EncryptedPackage")?lL(t,e):AC(t,e)}function hL(t,e){var r,n=t,i=e||{};return i.type||(i.type=Mt&&Buffer.isBuffer(t)?"buffer":"base64"),r=KT(n,i),oL(r,i)}function DC(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return yx(t.slice(r),e);default:break e}return Eu.to_workbook(t,e)}function pL(t,e){var r="",n=Sv(t,e);switch(e.type){case"base64":r=hs(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Zl(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=vr(r)),e.type="binary",DC(r,e)}function gL(t,e){var r=t;return e.type=="base64"&&(r=hs(r)),r=pf.utils.decode(1200,r.slice(2),"str"),e.type="binary",DC(r,e)}function mL(t){return t.match(/[^\x00-\x7F]/)?Aa(t):t}function tm(t,e,r,n){return n?(r.type="string",Eu.to_workbook(t,r)):Eu.to_workbook(e,r)}function Dl(t,e){V1();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Dl(new Uint8Array(t),(r=Rr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),lu={},r.dateNF&&(lu.dateNF=r.dateNF),r.type||(r.type=Mt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Mt?"buffer":"binary",n=uR(t),typeof Uint8Array<"u"&&!Mt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=mL(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=Rr(r),r.type="array",Dl(z1(n),r)}switch((i=Sv(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return fL(st.read(n,r),r);break;case 9:if(i[1]<=8)return AC(n,r);break;case 60:return yx(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return E6(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return WA.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?hL(n,r):tm(t,n,r,s);case 239:return i[3]===60?yx(n,r):tm(t,n,r,s);case 255:if(i[1]===254)return gL(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Wl.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Wl.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return vx.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return qA.to_workbook(n,r);break;case 10:case 13:case 32:return pL(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return _6.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?vx.to_workbook(n,r):tm(t,n,r,s)}function PC(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Wf(e.file,st.write(t,{type:Mt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return st.write(t,e)}function xL(t,e){var r=Rr(e||{}),n=cL(t,r);return vL(n,r)}function vL(t,e){var r={},n=Mt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?st.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Vp(i))}return e.password&&typeof encrypt_agile<"u"?PC(encrypt_agile(i,e.password),e):e.type==="file"?Wf(e.file,i):e.type=="string"?vr(i):i}function yL(t,e){var r=e||{},n=mj(t,r);return PC(n,r)}function Ea(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return gf(Aa(n));case"binary":return Aa(n);case"string":return t;case"file":return Wf(e.file,n,"utf8");case"buffer":return Mt?ho(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ea(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function _L(t,e){switch(e.type){case"base64":return gf(t);case"binary":return t;case"string":return t;case"file":return Wf(e.file,t,"binary");case"buffer":return Mt?ho(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function H0(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?gf(r):e.type=="string"?vr(r):r;case"file":return Wf(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function OC(t,e){V1(),fB(t);var r=Rr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=OC(t,r);return r.type="array",Vp(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ea(cj(t,r),r);case"slk":case"sylk":return Ea(zA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return Ea(kC(t.Sheets[t.SheetNames[i]],r),r);case"txt":return _L(MC(t.Sheets[t.SheetNames[i]],r),r);case"csv":return Ea(wv(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return Ea(WA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return H0(vx.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return Ea(Eu.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return Ea(qA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return Ea(HA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return Ea(NC(t,r),r);case"wk1":return H0(Wl.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return H0(Wl.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),H0(CC(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),yL(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return xL(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function EL(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function Dc(t,e,r){var n={};return n.type="file",n.file=e,EL(n),OC(t,n)}function SL(t,e,r,n,i,s,a,o){var l=un(r),u=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),p=!0,g=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:r,enumerable:!1})}catch{g.__rowNum__=r}else g.__rowNum__=r;if(!a||t[r])for(var m=e.s.c;m<=e.e.c;++m){var y=a?t[r][m]:t[n[m]+l];if(y===void 0||y.t===void 0){if(u===void 0)continue;s[m]!=null&&(g[s[m]]=u);continue}var x=y.v;switch(y.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(s[m]!=null){if(x==null)if(y.t=="e"&&x===null)g[s[m]]=null;else if(u!==void 0)g[s[m]]=u;else if(f&&x===null)g[s[m]]=null;else continue;else g[s[m]]=f&&(y.t!=="n"||y.t==="n"&&o.rawNumbers!==!1)?x:so(y,x,o);x!=null&&(p=!1)}}return{row:g,isempty:p}}function op(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},f=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":l=tr(f);break;case"number":l=tr(t["!ref"]),l.s.r=f;break;default:l=f}n>0&&(i=0);var p=un(l.s.r),g=[],m=[],y=0,x=0,S=Array.isArray(t),A=l.s.r,C=0,E={};S&&!t[A]&&(t[A]=[]);var M=u.skipHidden&&t["!cols"]||[],X=u.skipHidden&&t["!rows"]||[];for(C=l.s.c;C<=l.e.c;++C)if(!(M[C]||{}).hidden)switch(g[C]=Hr(C),r=S?t[A][C]:t[g[C]+p],n){case 1:s[C]=C-l.s.c;break;case 2:s[C]=g[C];break;case 3:s[C]=u.header[C-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=so(r,null,u),x=E[a]||0,!x)E[a]=1;else{do o=a+"_"+x++;while(E[o]);E[a]=x,E[o]=1}s[C]=o}for(A=l.s.r+i;A<=l.e.r;++A)if(!(X[A]||{}).hidden){var z=SL(t,l,A,g,n,s,S,u);(z.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(m[y++]=z.row)}return m.length=y,m}var Y_=/"/g;function wL(t,e,r,n,i,s,a,o){for(var l=!0,u=[],f="",p=un(r),g=e.s.c;g<=e.e.c;++g)if(n[g]){var m=o.dense?(t[r]||[])[g]:t[n[g]+p];if(m==null)f="";else if(m.v!=null){l=!1,f=""+(o.rawNumbers&&m.t=="n"?m.v:so(m,null,o));for(var y=0,x=0;y!==f.length;++y)if((x=f.charCodeAt(y))===i||x===s||x===34||o.forceQuotes){f='"'+f.replace(Y_,'""')+'"';break}f=="ID"&&(f='"ID"')}else m.f!=null&&!m.F?(l=!1,f="="+m.f,f.indexOf(",")>=0&&(f='"'+f.replace(Y_,'""')+'"')):f="";u.push(f)}return o.blankrows===!1&&l?null:u.join(a)}function wv(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=tr(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),f="",p=[];n.dense=Array.isArray(t);for(var g=n.skipHidden&&t["!cols"]||[],m=n.skipHidden&&t["!rows"]||[],y=i.s.c;y<=i.e.c;++y)(g[y]||{}).hidden||(p[y]=Hr(y));for(var x=0,S=i.s.r;S<=i.e.r;++S)(m[S]||{}).hidden||(f=wL(t,i,S,p,a,l,s,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((x++?o:"")+f)));return delete n.dense,r.join("")}function MC(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=wv(t,e);return r}function TL(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=tr(t["!ref"]),s="",a=[],o,l=[],u=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=Hr(o);for(var f=i.s.r;f<=i.e.r;++f)for(s=un(f),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=u?(t[f]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function BC(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?$r(n.origin):n.origin;a=l.r,o=l.c}var u,f={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var p=tr(s["!ref"]);f.e.c=Math.max(f.e.c,p.e.c),f.e.r=Math.max(f.e.r,p.e.r),a==-1&&(a=p.e.r+1,f.e.r=a+e.length-1+i)}else a==-1&&(a=0,f.e.r=e.length-1+i);var g=n.header||[],m=0;e.forEach(function(x,S){en(x).forEach(function(A){(m=g.indexOf(A))==-1&&(g[m=g.length]=A);var C=x[A],E="z",M="",X=ht({c:o+m,r:a+S+i});u=kf(s,X),C&&typeof C=="object"&&!(C instanceof Date)?s[X]=C:(typeof C=="number"?E="n":typeof C=="boolean"?E="b":typeof C=="string"?E="s":C instanceof Date?(E="d",n.cellDates||(E="n",C=Nn(C)),M=n.dateNF||ft[14]):C===null&&n.nullError&&(E="e",C=0),u?(u.t=E,u.v=C,delete u.w,delete u.R,M&&(u.z=M)):s[X]=u={t:E,v:C},M&&(u.z=M))})}),f.e.c=Math.max(f.e.c,o+g.length-1);var y=un(a);if(i)for(m=0;m<g.length;++m)s[Hr(m+o)+y]={t:"s",v:g[m]};return s["!ref"]=bt(f),s}function AL(t,e){return BC(null,t,e)}function kf(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=$r(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?kf(t,ht(e)):kf(t,ht({r:e,c:r||0}))}function CL(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Tv(){return{SheetNames:[],Sheets:{}}}function Av(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(_C(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function kL(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=CL(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function FL(t,e){return t.z=e,t}function jC(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function bL(t,e,r){return jC(t,"#"+e,r)}function IL(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function NL(t,e,r,n){for(var i=typeof e!="string"?e:tr(e),s=typeof e=="string"?e:bt(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=kf(t,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var Er={encode_col:Hr,encode_row:un,encode_cell:ht,encode_range:bt,decode_col:ev,decode_row:Z1,split_cell:zR,decode_cell:$r,decode_range:qi,format_cell:so,sheet_add_aoa:dA,sheet_add_json:BC,sheet_add_dom:FC,aoa_to_sheet:Bu,json_to_sheet:AL,table_to_sheet:bC,table_to_book:jj,sheet_to_csv:wv,sheet_to_txt:MC,sheet_to_json:op,sheet_to_html:kC,sheet_to_formulae:TL,sheet_to_row_object_array:op,sheet_get_cell:kf,book_new:Tv,book_append_sheet:Av,book_set_sheet_visibility:kL,cell_set_number_format:FL,cell_set_hyperlink:jC,cell_set_internal_link:bL,cell_add_comment:IL,sheet_set_array_formula:NL,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var RL={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DL=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Nt=(t,e)=>{const r=ve.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:l,...u},f)=>ve.createElement("svg",{ref:f,...RL,width:i,height:i,stroke:n,strokeWidth:a?Number(s)*24/Number(i):s,className:["lucide",`lucide-${DL(t)}`,o].join(" "),...u},[...e.map(([p,g])=>ve.createElement(p,g)),...Array.isArray(l)?l:[l]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X_=Nt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q_=Nt("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PL=Nt("BellRing",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q_=Nt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J_=Nt("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OL=Nt("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z_=Nt("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eE=Nt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rm=Nt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ML=Nt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $0=Nt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nm=Nt("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tE=Nt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Do=Nt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BL=Nt("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pc=Nt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fd=Nt("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hd=Nt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const im=Nt("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rE=Nt("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G0=Nt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K0=Nt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jL=Nt("Merge",[["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M12 2v10.3a4 4 0 0 1-1.172 2.872L4 22",key:"1hyw0i"}],["path",{d:"m20 22-5-5",key:"1m27yz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LL=Nt("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y0=Nt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sm=Nt("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pd=Nt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nE=Nt("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Po=Nt("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UL=Nt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VL=Nt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X0=Nt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iE=Nt("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zL=Nt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sE=Nt("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WL=Nt("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=Nt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=Nt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aE=Nt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sa=Nt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var oE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LC=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},HL=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[r++],a=t[r++],o=t[r++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},UC={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,o=a?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,f=s>>2,p=(s&3)<<4|o>>4;let g=(o&15)<<2|u>>6,m=u&63;l||(m=64,a||(g=64)),n.push(r[f],r[p],r[g],r[m])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(LC(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):HL(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const u=i<t.length?r[t.charAt(i)]:64;++i;const p=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||u==null||p==null)throw new $L;const g=s<<2|o>>4;if(n.push(g),u!==64){const m=o<<4&240|u>>2;if(n.push(m),p!==64){const y=u<<6&192|p;n.push(y)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class $L extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const GL=function(t){const e=LC(t);return UC.encodeByteArray(e,!0)},lp=function(t){return GL(t).replace(/\./g,"")},VC=function(t){try{return UC.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KL(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YL=()=>KL().__FIREBASE_DEFAULTS__,XL=()=>{if(typeof process>"u"||typeof oE>"u")return;const t=oE.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},qL=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&VC(t[1]);return e&&JSON.parse(e)},qp=()=>{try{return YL()||XL()||qL()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},zC=t=>{var e,r;return(r=(e=qp())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},QL=t=>{const e=zC(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},WC=()=>{var t;return(t=qp())===null||t===void 0?void 0:t.config},HC=t=>{var e;return(e=qp())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JL{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZL(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[lp(JSON.stringify(r)),lp(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function e9(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(yi())}function t9(){var t;const e=(t=qp())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function r9(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function n9(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function i9(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function s9(){const t=yi();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function a9(){return!t9()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function o9(){try{return typeof indexedDB=="object"}catch{return!1}}function l9(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c9="FirebaseError";class mo extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=c9,Object.setPrototypeOf(this,mo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Qf.prototype.create)}}class Qf{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?u9(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new mo(i,o,n)}}function u9(t,e){return t.replace(d9,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const d9=/\{\$([^}]+)}/g;function f9(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function cp(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const s=t[i],a=e[i];if(lE(s)&&lE(a)){if(!cp(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function lE(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jf(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function h9(t,e){const r=new p9(t,e);return r.subscribe.bind(r)}class p9{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");g9(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=am),i.error===void 0&&(i.error=am),i.complete===void 0&&(i.complete=am);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function g9(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function am(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sa(t){return t&&t._delegate?t._delegate:t}class ic{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m9{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new JL;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(v9(e))try{this.getOrInitializeService({instanceIdentifier:Nl})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=Nl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Nl){return this.instances.has(e)}getOptions(e=Nl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:x9(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Nl){return this.component?this.component.multipleInstances?e:Nl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function x9(t){return t===Nl?void 0:t}function v9(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y9{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new m9(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Kt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Kt||(Kt={}));const _9={debug:Kt.DEBUG,verbose:Kt.VERBOSE,info:Kt.INFO,warn:Kt.WARN,error:Kt.ERROR,silent:Kt.SILENT},E9=Kt.INFO,S9={[Kt.DEBUG]:"log",[Kt.VERBOSE]:"log",[Kt.INFO]:"info",[Kt.WARN]:"warn",[Kt.ERROR]:"error"},w9=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=S9[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Cv{constructor(e){this.name=e,this._logLevel=E9,this._logHandler=w9,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Kt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?_9[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Kt.DEBUG,...e),this._logHandler(this,Kt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Kt.VERBOSE,...e),this._logHandler(this,Kt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Kt.INFO,...e),this._logHandler(this,Kt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Kt.WARN,...e),this._logHandler(this,Kt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Kt.ERROR,...e),this._logHandler(this,Kt.ERROR,...e)}}const T9=(t,e)=>e.some(r=>t instanceof r);let cE,uE;function A9(){return cE||(cE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function C9(){return uE||(uE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const $C=new WeakMap,Sx=new WeakMap,GC=new WeakMap,om=new WeakMap,kv=new WeakMap;function k9(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(il(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&$C.set(r,t)}).catch(()=>{}),kv.set(e,t),e}function F9(t){if(Sx.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});Sx.set(t,e)}let wx={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Sx.get(t);if(e==="objectStoreNames")return t.objectStoreNames||GC.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return il(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function b9(t){wx=t(wx)}function I9(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(lm(this),e,...r);return GC.set(n,e.sort?e.sort():[e]),il(n)}:C9().includes(t)?function(...e){return t.apply(lm(this),e),il($C.get(this))}:function(...e){return il(t.apply(lm(this),e))}}function N9(t){return typeof t=="function"?I9(t):(t instanceof IDBTransaction&&F9(t),T9(t,A9())?new Proxy(t,wx):t)}function il(t){if(t instanceof IDBRequest)return k9(t);if(om.has(t))return om.get(t);const e=N9(t);return e!==t&&(om.set(t,e),kv.set(e,t)),e}const lm=t=>kv.get(t);function R9(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),o=il(a);return n&&a.addEventListener("upgradeneeded",l=>{n(il(a.result),l.oldVersion,l.newVersion,il(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const D9=["get","getKey","getAll","getAllKeys","count"],P9=["put","add","delete","clear"],cm=new Map;function dE(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(cm.get(e))return cm.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=P9.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||D9.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let u=l.store;return n&&(u=u.index(o.shift())),(await Promise.all([u[r](...o),i&&l.done]))[0]};return cm.set(e,s),s}b9(t=>({...t,get:(e,r,n)=>dE(e,r)||t.get(e,r,n),has:(e,r)=>!!dE(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O9{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(M9(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function M9(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Tx="@firebase/app",fE="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ao=new Cv("@firebase/app"),B9="@firebase/app-compat",j9="@firebase/analytics-compat",L9="@firebase/analytics",U9="@firebase/app-check-compat",V9="@firebase/app-check",z9="@firebase/auth",W9="@firebase/auth-compat",H9="@firebase/database",$9="@firebase/data-connect",G9="@firebase/database-compat",K9="@firebase/functions",Y9="@firebase/functions-compat",X9="@firebase/installations",q9="@firebase/installations-compat",Q9="@firebase/messaging",J9="@firebase/messaging-compat",Z9="@firebase/performance",e7="@firebase/performance-compat",t7="@firebase/remote-config",r7="@firebase/remote-config-compat",n7="@firebase/storage",i7="@firebase/storage-compat",s7="@firebase/firestore",a7="@firebase/vertexai-preview",o7="@firebase/firestore-compat",l7="firebase",c7="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ax="[DEFAULT]",u7={[Tx]:"fire-core",[B9]:"fire-core-compat",[L9]:"fire-analytics",[j9]:"fire-analytics-compat",[V9]:"fire-app-check",[U9]:"fire-app-check-compat",[z9]:"fire-auth",[W9]:"fire-auth-compat",[H9]:"fire-rtdb",[$9]:"fire-data-connect",[G9]:"fire-rtdb-compat",[K9]:"fire-fn",[Y9]:"fire-fn-compat",[X9]:"fire-iid",[q9]:"fire-iid-compat",[Q9]:"fire-fcm",[J9]:"fire-fcm-compat",[Z9]:"fire-perf",[e7]:"fire-perf-compat",[t7]:"fire-rc",[r7]:"fire-rc-compat",[n7]:"fire-gcs",[i7]:"fire-gcs-compat",[s7]:"fire-fst",[o7]:"fire-fst-compat",[a7]:"fire-vertex","fire-js":"fire-js",[l7]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const up=new Map,d7=new Map,Cx=new Map;function hE(t,e){try{t.container.addComponent(e)}catch(r){ao.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function wu(t){const e=t.name;if(Cx.has(e))return ao.debug(`There were multiple attempts to register component ${e}.`),!1;Cx.set(e,t);for(const r of up.values())hE(r,t);for(const r of d7.values())hE(r,t);return!0}function Fv(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Yo(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f7={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},sl=new Qf("app","Firebase",f7);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h7{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ic("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw sl.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lu=c7;function KC(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:Ax,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw sl.create("bad-app-name",{appName:String(i)});if(r||(r=WC()),!r)throw sl.create("no-options");const s=up.get(i);if(s){if(cp(r,s.options)&&cp(n,s.config))return s;throw sl.create("duplicate-app",{appName:i})}const a=new y9(i);for(const l of Cx.values())a.addComponent(l);const o=new h7(r,n,a);return up.set(i,o),o}function YC(t=Ax){const e=up.get(t);if(!e&&t===Ax&&WC())return KC();if(!e)throw sl.create("no-app",{appName:t});return e}function al(t,e,r){var n;let i=(n=u7[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ao.warn(o.join(" "));return}wu(new ic(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p7="firebase-heartbeat-database",g7=1,Ff="firebase-heartbeat-store";let um=null;function XC(){return um||(um=R9(p7,g7,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ff)}catch(r){console.warn(r)}}}}).catch(t=>{throw sl.create("idb-open",{originalErrorMessage:t.message})})),um}async function m7(t){try{const r=(await XC()).transaction(Ff),n=await r.objectStore(Ff).get(qC(t));return await r.done,n}catch(e){if(e instanceof mo)ao.warn(e.message);else{const r=sl.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ao.warn(r.message)}}}async function pE(t,e){try{const n=(await XC()).transaction(Ff,"readwrite");await n.objectStore(Ff).put(e,qC(t)),await n.done}catch(r){if(r instanceof mo)ao.warn(r.message);else{const n=sl.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});ao.warn(n.message)}}}function qC(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x7=1024,v7=30*24*60*60*1e3;class y7{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new E7(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=gE();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=v7}),this._storage.overwrite(this._heartbeatsCache))}catch(n){ao.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=gE(),{heartbeatsToSend:n,unsentEntries:i}=_7(this._heartbeatsCache.heartbeats),s=lp(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return ao.warn(r),""}}}function gE(){return new Date().toISOString().substring(0,10)}function _7(t,e=x7){const r=[];let n=t.slice();for(const i of t){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),mE(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),mE(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class E7{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return o9()?l9().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await m7(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return pE(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return pE(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function mE(t){return lp(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S7(t){wu(new ic("platform-logger",e=>new O9(e),"PRIVATE")),wu(new ic("heartbeat",e=>new y7(e),"PRIVATE")),al(Tx,fE,t),al(Tx,fE,"esm2017"),al("fire-js","")}S7("");var w7="firebase",T7="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */al(w7,T7,"app");var xE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var $l,QC;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,F){function w(){}w.prototype=F.prototype,T.D=F.prototype,T.prototype=new w,T.prototype.constructor=T,T.C=function(R,P,O){for(var D=Array(arguments.length-2),qe=2;qe<arguments.length;qe++)D[qe-2]=arguments[qe];return F.prototype[P].apply(R,D)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,F,w){w||(w=0);var R=Array(16);if(typeof F=="string")for(var P=0;16>P;++P)R[P]=F.charCodeAt(w++)|F.charCodeAt(w++)<<8|F.charCodeAt(w++)<<16|F.charCodeAt(w++)<<24;else for(P=0;16>P;++P)R[P]=F[w++]|F[w++]<<8|F[w++]<<16|F[w++]<<24;F=T.g[0],w=T.g[1],P=T.g[2];var O=T.g[3],D=F+(O^w&(P^O))+R[0]+3614090360&4294967295;F=w+(D<<7&4294967295|D>>>25),D=O+(P^F&(w^P))+R[1]+3905402710&4294967295,O=F+(D<<12&4294967295|D>>>20),D=P+(w^O&(F^w))+R[2]+606105819&4294967295,P=O+(D<<17&4294967295|D>>>15),D=w+(F^P&(O^F))+R[3]+3250441966&4294967295,w=P+(D<<22&4294967295|D>>>10),D=F+(O^w&(P^O))+R[4]+4118548399&4294967295,F=w+(D<<7&4294967295|D>>>25),D=O+(P^F&(w^P))+R[5]+1200080426&4294967295,O=F+(D<<12&4294967295|D>>>20),D=P+(w^O&(F^w))+R[6]+2821735955&4294967295,P=O+(D<<17&4294967295|D>>>15),D=w+(F^P&(O^F))+R[7]+4249261313&4294967295,w=P+(D<<22&4294967295|D>>>10),D=F+(O^w&(P^O))+R[8]+1770035416&4294967295,F=w+(D<<7&4294967295|D>>>25),D=O+(P^F&(w^P))+R[9]+2336552879&4294967295,O=F+(D<<12&4294967295|D>>>20),D=P+(w^O&(F^w))+R[10]+4294925233&4294967295,P=O+(D<<17&4294967295|D>>>15),D=w+(F^P&(O^F))+R[11]+2304563134&4294967295,w=P+(D<<22&4294967295|D>>>10),D=F+(O^w&(P^O))+R[12]+1804603682&4294967295,F=w+(D<<7&4294967295|D>>>25),D=O+(P^F&(w^P))+R[13]+4254626195&4294967295,O=F+(D<<12&4294967295|D>>>20),D=P+(w^O&(F^w))+R[14]+2792965006&4294967295,P=O+(D<<17&4294967295|D>>>15),D=w+(F^P&(O^F))+R[15]+1236535329&4294967295,w=P+(D<<22&4294967295|D>>>10),D=F+(P^O&(w^P))+R[1]+4129170786&4294967295,F=w+(D<<5&4294967295|D>>>27),D=O+(w^P&(F^w))+R[6]+3225465664&4294967295,O=F+(D<<9&4294967295|D>>>23),D=P+(F^w&(O^F))+R[11]+643717713&4294967295,P=O+(D<<14&4294967295|D>>>18),D=w+(O^F&(P^O))+R[0]+3921069994&4294967295,w=P+(D<<20&4294967295|D>>>12),D=F+(P^O&(w^P))+R[5]+3593408605&4294967295,F=w+(D<<5&4294967295|D>>>27),D=O+(w^P&(F^w))+R[10]+38016083&4294967295,O=F+(D<<9&4294967295|D>>>23),D=P+(F^w&(O^F))+R[15]+3634488961&4294967295,P=O+(D<<14&4294967295|D>>>18),D=w+(O^F&(P^O))+R[4]+3889429448&4294967295,w=P+(D<<20&4294967295|D>>>12),D=F+(P^O&(w^P))+R[9]+568446438&4294967295,F=w+(D<<5&4294967295|D>>>27),D=O+(w^P&(F^w))+R[14]+3275163606&4294967295,O=F+(D<<9&4294967295|D>>>23),D=P+(F^w&(O^F))+R[3]+4107603335&4294967295,P=O+(D<<14&4294967295|D>>>18),D=w+(O^F&(P^O))+R[8]+1163531501&4294967295,w=P+(D<<20&4294967295|D>>>12),D=F+(P^O&(w^P))+R[13]+2850285829&4294967295,F=w+(D<<5&4294967295|D>>>27),D=O+(w^P&(F^w))+R[2]+4243563512&4294967295,O=F+(D<<9&4294967295|D>>>23),D=P+(F^w&(O^F))+R[7]+1735328473&4294967295,P=O+(D<<14&4294967295|D>>>18),D=w+(O^F&(P^O))+R[12]+2368359562&4294967295,w=P+(D<<20&4294967295|D>>>12),D=F+(w^P^O)+R[5]+4294588738&4294967295,F=w+(D<<4&4294967295|D>>>28),D=O+(F^w^P)+R[8]+2272392833&4294967295,O=F+(D<<11&4294967295|D>>>21),D=P+(O^F^w)+R[11]+1839030562&4294967295,P=O+(D<<16&4294967295|D>>>16),D=w+(P^O^F)+R[14]+4259657740&4294967295,w=P+(D<<23&4294967295|D>>>9),D=F+(w^P^O)+R[1]+2763975236&4294967295,F=w+(D<<4&4294967295|D>>>28),D=O+(F^w^P)+R[4]+1272893353&4294967295,O=F+(D<<11&4294967295|D>>>21),D=P+(O^F^w)+R[7]+4139469664&4294967295,P=O+(D<<16&4294967295|D>>>16),D=w+(P^O^F)+R[10]+3200236656&4294967295,w=P+(D<<23&4294967295|D>>>9),D=F+(w^P^O)+R[13]+681279174&4294967295,F=w+(D<<4&4294967295|D>>>28),D=O+(F^w^P)+R[0]+3936430074&4294967295,O=F+(D<<11&4294967295|D>>>21),D=P+(O^F^w)+R[3]+3572445317&4294967295,P=O+(D<<16&4294967295|D>>>16),D=w+(P^O^F)+R[6]+76029189&4294967295,w=P+(D<<23&4294967295|D>>>9),D=F+(w^P^O)+R[9]+3654602809&4294967295,F=w+(D<<4&4294967295|D>>>28),D=O+(F^w^P)+R[12]+3873151461&4294967295,O=F+(D<<11&4294967295|D>>>21),D=P+(O^F^w)+R[15]+530742520&4294967295,P=O+(D<<16&4294967295|D>>>16),D=w+(P^O^F)+R[2]+3299628645&4294967295,w=P+(D<<23&4294967295|D>>>9),D=F+(P^(w|~O))+R[0]+4096336452&4294967295,F=w+(D<<6&4294967295|D>>>26),D=O+(w^(F|~P))+R[7]+1126891415&4294967295,O=F+(D<<10&4294967295|D>>>22),D=P+(F^(O|~w))+R[14]+2878612391&4294967295,P=O+(D<<15&4294967295|D>>>17),D=w+(O^(P|~F))+R[5]+4237533241&4294967295,w=P+(D<<21&4294967295|D>>>11),D=F+(P^(w|~O))+R[12]+1700485571&4294967295,F=w+(D<<6&4294967295|D>>>26),D=O+(w^(F|~P))+R[3]+2399980690&4294967295,O=F+(D<<10&4294967295|D>>>22),D=P+(F^(O|~w))+R[10]+4293915773&4294967295,P=O+(D<<15&4294967295|D>>>17),D=w+(O^(P|~F))+R[1]+2240044497&4294967295,w=P+(D<<21&4294967295|D>>>11),D=F+(P^(w|~O))+R[8]+1873313359&4294967295,F=w+(D<<6&4294967295|D>>>26),D=O+(w^(F|~P))+R[15]+4264355552&4294967295,O=F+(D<<10&4294967295|D>>>22),D=P+(F^(O|~w))+R[6]+2734768916&4294967295,P=O+(D<<15&4294967295|D>>>17),D=w+(O^(P|~F))+R[13]+1309151649&4294967295,w=P+(D<<21&4294967295|D>>>11),D=F+(P^(w|~O))+R[4]+4149444226&4294967295,F=w+(D<<6&4294967295|D>>>26),D=O+(w^(F|~P))+R[11]+3174756917&4294967295,O=F+(D<<10&4294967295|D>>>22),D=P+(F^(O|~w))+R[2]+718787259&4294967295,P=O+(D<<15&4294967295|D>>>17),D=w+(O^(P|~F))+R[9]+3951481745&4294967295,T.g[0]=T.g[0]+F&4294967295,T.g[1]=T.g[1]+(P+(D<<21&4294967295|D>>>11))&4294967295,T.g[2]=T.g[2]+P&4294967295,T.g[3]=T.g[3]+O&4294967295}n.prototype.u=function(T,F){F===void 0&&(F=T.length);for(var w=F-this.blockSize,R=this.B,P=this.h,O=0;O<F;){if(P==0)for(;O<=w;)i(this,T,O),O+=this.blockSize;if(typeof T=="string"){for(;O<F;)if(R[P++]=T.charCodeAt(O++),P==this.blockSize){i(this,R),P=0;break}}else for(;O<F;)if(R[P++]=T[O++],P==this.blockSize){i(this,R),P=0;break}}this.h=P,this.o+=F},n.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var F=1;F<T.length-8;++F)T[F]=0;var w=8*this.o;for(F=T.length-8;F<T.length;++F)T[F]=w&255,w/=256;for(this.u(T),T=Array(16),F=w=0;4>F;++F)for(var R=0;32>R;R+=8)T[w++]=this.g[F]>>>R&255;return T};function s(T,F){var w=o;return Object.prototype.hasOwnProperty.call(w,T)?w[T]:w[T]=F(T)}function a(T,F){this.h=F;for(var w=[],R=!0,P=T.length-1;0<=P;P--){var O=T[P]|0;R&&O==F||(w[P]=O,R=!1)}this.g=w}var o={};function l(T){return-128<=T&&128>T?s(T,function(F){return new a([F|0],0>F?-1:0)}):new a([T|0],0>T?-1:0)}function u(T){if(isNaN(T)||!isFinite(T))return p;if(0>T)return S(u(-T));for(var F=[],w=1,R=0;T>=w;R++)F[R]=T/w|0,w*=4294967296;return new a(F,0)}function f(T,F){if(T.length==0)throw Error("number format error: empty string");if(F=F||10,2>F||36<F)throw Error("radix out of range: "+F);if(T.charAt(0)=="-")return S(f(T.substring(1),F));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var w=u(Math.pow(F,8)),R=p,P=0;P<T.length;P+=8){var O=Math.min(8,T.length-P),D=parseInt(T.substring(P,P+O),F);8>O?(O=u(Math.pow(F,O)),R=R.j(O).add(u(D))):(R=R.j(w),R=R.add(u(D)))}return R}var p=l(0),g=l(1),m=l(16777216);t=a.prototype,t.m=function(){if(x(this))return-S(this).m();for(var T=0,F=1,w=0;w<this.g.length;w++){var R=this.i(w);T+=(0<=R?R:4294967296+R)*F,F*=4294967296}return T},t.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(y(this))return"0";if(x(this))return"-"+S(this).toString(T);for(var F=u(Math.pow(T,6)),w=this,R="";;){var P=M(w,F).g;w=A(w,P.j(F));var O=((0<w.g.length?w.g[0]:w.h)>>>0).toString(T);if(w=P,y(w))return O+R;for(;6>O.length;)O="0"+O;R=O+R}},t.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function y(T){if(T.h!=0)return!1;for(var F=0;F<T.g.length;F++)if(T.g[F]!=0)return!1;return!0}function x(T){return T.h==-1}t.l=function(T){return T=A(this,T),x(T)?-1:y(T)?0:1};function S(T){for(var F=T.g.length,w=[],R=0;R<F;R++)w[R]=~T.g[R];return new a(w,~T.h).add(g)}t.abs=function(){return x(this)?S(this):this},t.add=function(T){for(var F=Math.max(this.g.length,T.g.length),w=[],R=0,P=0;P<=F;P++){var O=R+(this.i(P)&65535)+(T.i(P)&65535),D=(O>>>16)+(this.i(P)>>>16)+(T.i(P)>>>16);R=D>>>16,O&=65535,D&=65535,w[P]=D<<16|O}return new a(w,w[w.length-1]&-2147483648?-1:0)};function A(T,F){return T.add(S(F))}t.j=function(T){if(y(this)||y(T))return p;if(x(this))return x(T)?S(this).j(S(T)):S(S(this).j(T));if(x(T))return S(this.j(S(T)));if(0>this.l(m)&&0>T.l(m))return u(this.m()*T.m());for(var F=this.g.length+T.g.length,w=[],R=0;R<2*F;R++)w[R]=0;for(R=0;R<this.g.length;R++)for(var P=0;P<T.g.length;P++){var O=this.i(R)>>>16,D=this.i(R)&65535,qe=T.i(P)>>>16,Ee=T.i(P)&65535;w[2*R+2*P]+=D*Ee,C(w,2*R+2*P),w[2*R+2*P+1]+=O*Ee,C(w,2*R+2*P+1),w[2*R+2*P+1]+=D*qe,C(w,2*R+2*P+1),w[2*R+2*P+2]+=O*qe,C(w,2*R+2*P+2)}for(R=0;R<F;R++)w[R]=w[2*R+1]<<16|w[2*R];for(R=F;R<2*F;R++)w[R]=0;return new a(w,0)};function C(T,F){for(;(T[F]&65535)!=T[F];)T[F+1]+=T[F]>>>16,T[F]&=65535,F++}function E(T,F){this.g=T,this.h=F}function M(T,F){if(y(F))throw Error("division by zero");if(y(T))return new E(p,p);if(x(T))return F=M(S(T),F),new E(S(F.g),S(F.h));if(x(F))return F=M(T,S(F)),new E(S(F.g),F.h);if(30<T.g.length){if(x(T)||x(F))throw Error("slowDivide_ only works with positive integers.");for(var w=g,R=F;0>=R.l(T);)w=X(w),R=X(R);var P=z(w,1),O=z(R,1);for(R=z(R,2),w=z(w,2);!y(R);){var D=O.add(R);0>=D.l(T)&&(P=P.add(w),O=D),R=z(R,1),w=z(w,1)}return F=A(T,P.j(F)),new E(P,F)}for(P=p;0<=T.l(F);){for(w=Math.max(1,Math.floor(T.m()/F.m())),R=Math.ceil(Math.log(w)/Math.LN2),R=48>=R?1:Math.pow(2,R-48),O=u(w),D=O.j(F);x(D)||0<D.l(T);)w-=R,O=u(w),D=O.j(F);y(O)&&(O=g),P=P.add(O),T=A(T,D)}return new E(P,T)}t.A=function(T){return M(this,T).h},t.and=function(T){for(var F=Math.max(this.g.length,T.g.length),w=[],R=0;R<F;R++)w[R]=this.i(R)&T.i(R);return new a(w,this.h&T.h)},t.or=function(T){for(var F=Math.max(this.g.length,T.g.length),w=[],R=0;R<F;R++)w[R]=this.i(R)|T.i(R);return new a(w,this.h|T.h)},t.xor=function(T){for(var F=Math.max(this.g.length,T.g.length),w=[],R=0;R<F;R++)w[R]=this.i(R)^T.i(R);return new a(w,this.h^T.h)};function X(T){for(var F=T.g.length+1,w=[],R=0;R<F;R++)w[R]=T.i(R)<<1|T.i(R-1)>>>31;return new a(w,T.h)}function z(T,F){var w=F>>5;F%=32;for(var R=T.g.length-w,P=[],O=0;O<R;O++)P[O]=0<F?T.i(O+w)>>>F|T.i(O+w+1)<<32-F:T.i(O+w);return new a(P,T.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,QC=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=f,$l=a}).apply(typeof xE<"u"?xE:typeof self<"u"?self:typeof window<"u"?window:{});var q0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var JC,Td,ZC,mh,kx,ek,tk,rk;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,v,k){return d==Array.prototype||d==Object.prototype||(d[v]=k.value),d};function r(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof q0=="object"&&q0];for(var v=0;v<d.length;++v){var k=d[v];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var n=r(this);function i(d,v){if(v)e:{var k=n;d=d.split(".");for(var B=0;B<d.length-1;B++){var ce=d[B];if(!(ce in k))break e;k=k[ce]}d=d[d.length-1],B=k[d],v=v(B),v!=B&&v!=null&&e(k,d,{configurable:!0,writable:!0,value:v})}}function s(d,v){d instanceof String&&(d+="");var k=0,B=!1,ce={next:function(){if(!B&&k<d.length){var me=k++;return{value:v(me,d[me]),done:!1}}return B=!0,{done:!0,value:void 0}}};return ce[Symbol.iterator]=function(){return ce},ce}i("Array.prototype.values",function(d){return d||function(){return s(this,function(v,k){return k})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(d){var v=typeof d;return v=v!="object"?v:d?Array.isArray(d)?"array":v:"null",v=="array"||v=="object"&&typeof d.length=="number"}function u(d){var v=typeof d;return v=="object"&&d!=null||v=="function"}function f(d,v,k){return d.call.apply(d.bind,arguments)}function p(d,v,k){if(!d)throw Error();if(2<arguments.length){var B=Array.prototype.slice.call(arguments,2);return function(){var ce=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ce,B),d.apply(v,ce)}}return function(){return d.apply(v,arguments)}}function g(d,v,k){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,g.apply(null,arguments)}function m(d,v){var k=Array.prototype.slice.call(arguments,1);return function(){var B=k.slice();return B.push.apply(B,arguments),d.apply(this,B)}}function y(d,v){function k(){}k.prototype=v.prototype,d.aa=v.prototype,d.prototype=new k,d.prototype.constructor=d,d.Qb=function(B,ce,me){for(var $e=Array(arguments.length-2),Jt=2;Jt<arguments.length;Jt++)$e[Jt-2]=arguments[Jt];return v.prototype[ce].apply(B,$e)}}function x(d){const v=d.length;if(0<v){const k=Array(v);for(let B=0;B<v;B++)k[B]=d[B];return k}return[]}function S(d,v){for(let k=1;k<arguments.length;k++){const B=arguments[k];if(l(B)){const ce=d.length||0,me=B.length||0;d.length=ce+me;for(let $e=0;$e<me;$e++)d[ce+$e]=B[$e]}else d.push(B)}}class A{constructor(v,k){this.i=v,this.j=k,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function C(d){return/^[\s\xa0]*$/.test(d)}function E(){var d=o.navigator;return d&&(d=d.userAgent)?d:""}function M(d){return M[" "](d),d}M[" "]=function(){};var X=E().indexOf("Gecko")!=-1&&!(E().toLowerCase().indexOf("webkit")!=-1&&E().indexOf("Edge")==-1)&&!(E().indexOf("Trident")!=-1||E().indexOf("MSIE")!=-1)&&E().indexOf("Edge")==-1;function z(d,v,k){for(const B in d)v.call(k,d[B],B,d)}function T(d,v){for(const k in d)v.call(void 0,d[k],k,d)}function F(d){const v={};for(const k in d)v[k]=d[k];return v}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(d,v){let k,B;for(let ce=1;ce<arguments.length;ce++){B=arguments[ce];for(k in B)d[k]=B[k];for(let me=0;me<w.length;me++)k=w[me],Object.prototype.hasOwnProperty.call(B,k)&&(d[k]=B[k])}}function P(d){var v=1;d=d.split(":");const k=[];for(;0<v&&d.length;)k.push(d.shift()),v--;return d.length&&k.push(d.join(":")),k}function O(d){o.setTimeout(()=>{throw d},0)}function D(){var d=ne;let v=null;return d.g&&(v=d.g,d.g=d.g.next,d.g||(d.h=null),v.next=null),v}class qe{constructor(){this.h=this.g=null}add(v,k){const B=Ee.get();B.set(v,k),this.h?this.h.next=B:this.g=B,this.h=B}}var Ee=new A(()=>new Pe,d=>d.reset());class Pe{constructor(){this.next=this.g=this.h=null}set(v,k){this.h=v,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let Fe,Ae=!1,ne=new qe,be=()=>{const d=o.Promise.resolve(void 0);Fe=()=>{d.then(je)}};var je=()=>{for(var d;d=D();){try{d.h.call(d.g)}catch(k){O(k)}var v=Ee;v.j(d),100>v.h&&(v.h++,d.next=v.g,v.g=d)}Ae=!1};function H(){this.s=this.s,this.C=this.C}H.prototype.s=!1,H.prototype.ma=function(){this.s||(this.s=!0,this.N())},H.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function te(d,v){this.type=d,this.g=this.target=v,this.defaultPrevented=!1}te.prototype.h=function(){this.defaultPrevented=!0};var re=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var d=!1,v=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const k=()=>{};o.addEventListener("test",k,v),o.removeEventListener("test",k,v)}catch{}return d}();function Y(d,v){if(te.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var k=this.type=d.type,B=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=v,v=d.relatedTarget){if(X){e:{try{M(v.nodeName);var ce=!0;break e}catch{}ce=!1}ce||(v=null)}}else k=="mouseover"?v=d.fromElement:k=="mouseout"&&(v=d.toElement);this.relatedTarget=v,B?(this.clientX=B.clientX!==void 0?B.clientX:B.pageX,this.clientY=B.clientY!==void 0?B.clientY:B.pageY,this.screenX=B.screenX||0,this.screenY=B.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:ye[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&Y.aa.h.call(this)}}y(Y,te);var ye={2:"touch",3:"pen",4:"mouse"};Y.prototype.h=function(){Y.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var Te="closure_listenable_"+(1e6*Math.random()|0),Ve=0;function De(d,v,k,B,ce){this.listener=d,this.proxy=null,this.src=v,this.type=k,this.capture=!!B,this.ha=ce,this.key=++Ve,this.da=this.fa=!1}function Ne(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function it(d){this.src=d,this.g={},this.h=0}it.prototype.add=function(d,v,k,B,ce){var me=d.toString();d=this.g[me],d||(d=this.g[me]=[],this.h++);var $e=Rt(d,v,B,ce);return-1<$e?(v=d[$e],k||(v.fa=!1)):(v=new De(v,this.src,me,!!B,ce),v.fa=k,d.push(v)),v};function Z(d,v){var k=v.type;if(k in d.g){var B=d.g[k],ce=Array.prototype.indexOf.call(B,v,void 0),me;(me=0<=ce)&&Array.prototype.splice.call(B,ce,1),me&&(Ne(v),d.g[k].length==0&&(delete d.g[k],d.h--))}}function Rt(d,v,k,B){for(var ce=0;ce<d.length;++ce){var me=d[ce];if(!me.da&&me.listener==v&&me.capture==!!k&&me.ha==B)return ce}return-1}var Et="closure_lm_"+(1e6*Math.random()|0),Dt={};function yt(d,v,k,B,ce){if(Array.isArray(v)){for(var me=0;me<v.length;me++)yt(d,v[me],k,B,ce);return null}return k=Bi(k),d&&d[Te]?d.K(v,k,u(B)?!!B.capture:!1,ce):Xe(d,v,k,!1,B,ce)}function Xe(d,v,k,B,ce,me){if(!v)throw Error("Invalid event type");var $e=u(ce)?!!ce.capture:!!ce,Jt=Mi(d);if(Jt||(d[Et]=Jt=new it(d)),k=Jt.add(v,k,B,$e,me),k.proxy)return k;if(B=xr(),k.proxy=B,B.src=d,B.listener=k,d.addEventListener)re||(ce=$e),ce===void 0&&(ce=!1),d.addEventListener(v.toString(),B,ce);else if(d.attachEvent)d.attachEvent(Pi(v.toString()),B);else if(d.addListener&&d.removeListener)d.addListener(B);else throw Error("addEventListener and attachEvent are unavailable.");return k}function xr(){function d(k){return v.call(d.src,d.listener,k)}const v=Oi;return d}function Xr(d,v,k,B,ce){if(Array.isArray(v))for(var me=0;me<v.length;me++)Xr(d,v[me],k,B,ce);else B=u(B)?!!B.capture:!!B,k=Bi(k),d&&d[Te]?(d=d.i,v=String(v).toString(),v in d.g&&(me=d.g[v],k=Rt(me,k,B,ce),-1<k&&(Ne(me[k]),Array.prototype.splice.call(me,k,1),me.length==0&&(delete d.g[v],d.h--)))):d&&(d=Mi(d))&&(v=d.g[v.toString()],d=-1,v&&(d=Rt(v,k,B,ce)),(k=-1<d?v[d]:null)&&_n(k))}function _n(d){if(typeof d!="number"&&d&&!d.da){var v=d.src;if(v&&v[Te])Z(v.i,d);else{var k=d.type,B=d.proxy;v.removeEventListener?v.removeEventListener(k,B,d.capture):v.detachEvent?v.detachEvent(Pi(k),B):v.addListener&&v.removeListener&&v.removeListener(B),(k=Mi(v))?(Z(k,d),k.h==0&&(k.src=null,v[Et]=null)):Ne(d)}}}function Pi(d){return d in Dt?Dt[d]:Dt[d]="on"+d}function Oi(d,v){if(d.da)d=!0;else{v=new Y(v,this);var k=d.listener,B=d.ha||d.src;d.fa&&_n(d),d=k.call(B,v)}return d}function Mi(d){return d=d[Et],d instanceof it?d:null}var jr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Bi(d){return typeof d=="function"?d:(d[jr]||(d[jr]=function(v){return d.handleEvent(v)}),d[jr])}function cr(){H.call(this),this.i=new it(this),this.M=this,this.F=null}y(cr,H),cr.prototype[Te]=!0,cr.prototype.removeEventListener=function(d,v,k,B){Xr(this,d,v,k,B)};function Lr(d,v){var k,B=d.F;if(B)for(k=[];B;B=B.F)k.push(B);if(d=d.M,B=v.type||v,typeof v=="string")v=new te(v,d);else if(v instanceof te)v.target=v.target||d;else{var ce=v;v=new te(B,d),R(v,ce)}if(ce=!0,k)for(var me=k.length-1;0<=me;me--){var $e=v.g=k[me];ce=Tr($e,B,!0,v)&&ce}if($e=v.g=d,ce=Tr($e,B,!0,v)&&ce,ce=Tr($e,B,!1,v)&&ce,k)for(me=0;me<k.length;me++)$e=v.g=k[me],ce=Tr($e,B,!1,v)&&ce}cr.prototype.N=function(){if(cr.aa.N.call(this),this.i){var d=this.i,v;for(v in d.g){for(var k=d.g[v],B=0;B<k.length;B++)Ne(k[B]);delete d.g[v],d.h--}}this.F=null},cr.prototype.K=function(d,v,k,B){return this.i.add(String(d),v,!1,k,B)},cr.prototype.L=function(d,v,k,B){return this.i.add(String(d),v,!0,k,B)};function Tr(d,v,k,B){if(v=d.i.g[String(v)],!v)return!0;v=v.concat();for(var ce=!0,me=0;me<v.length;++me){var $e=v[me];if($e&&!$e.da&&$e.capture==k){var Jt=$e.listener,wn=$e.ha||$e.src;$e.fa&&Z(d.i,$e),ce=Jt.call(wn,B)!==!1&&ce}}return ce&&!B.defaultPrevented}function Ei(d,v,k){if(typeof d=="function")k&&(d=g(d,k));else if(d&&typeof d.handleEvent=="function")d=g(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:o.setTimeout(d,v||0)}function mt(d){d.g=Ei(()=>{d.g=null,d.i&&(d.i=!1,mt(d))},d.l);const v=d.h;d.h=null,d.m.apply(null,v)}class Ar extends H{constructor(v,k){super(),this.m=v,this.l=k,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:mt(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Dr(d){H.call(this),this.h=d,this.g={}}y(Dr,H);var Pr=[];function Rn(d){z(d.g,function(v,k){this.g.hasOwnProperty(k)&&_n(v)},d),d.g={}}Dr.prototype.N=function(){Dr.aa.N.call(this),Rn(this)},Dr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var xo=o.JSON.stringify,vo=o.JSON.parse,$u=class{stringify(d){return o.JSON.stringify(d,void 0)}parse(d){return o.JSON.parse(d,void 0)}};function ms(){}ms.prototype.h=null;function Tl(d){return d.h||(d.h=d.i())}function aa(){}var Ma={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Us(){te.call(this,"d")}y(Us,te);function le(){te.call(this,"c")}y(le,te);var rr={},oa=null;function Ba(){return oa=oa||new cr}rr.La="serverreachability";function ja(d){te.call(this,rr.La,d)}y(ja,te);function xs(d){const v=Ba();Lr(v,new ja(v))}rr.STAT_EVENT="statevent";function la(d,v){te.call(this,rr.STAT_EVENT,d),this.stat=v}y(la,te);function Or(d){const v=Ba();Lr(v,new la(v,d))}rr.Ma="timingevent";function En(d,v){te.call(this,rr.Ma,d),this.size=v}y(En,te);function vs(d,v){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){d()},v)}function ys(){this.g=!0}ys.prototype.xa=function(){this.g=!1};function Gu(d,v,k,B,ce,me){d.info(function(){if(d.g)if(me)for(var $e="",Jt=me.split("&"),wn=0;wn<Jt.length;wn++){var qt=Jt[wn].split("=");if(1<qt.length){var Tn=qt[0];qt=qt[1];var Pn=Tn.split("_");$e=2<=Pn.length&&Pn[1]=="type"?$e+(Tn+"="+qt+"&"):$e+(Tn+"=redacted&")}}else $e=null;else $e=me;return"XMLHTTP REQ ("+B+") [attempt "+ce+"]: "+v+`
`+k+`
`+$e})}function Si(d,v,k,B,ce,me,$e){d.info(function(){return"XMLHTTP RESP ("+B+") [ attempt "+ce+"]: "+v+`
`+k+`
`+me+" "+$e})}function I(d,v,k,B){d.info(function(){return"XMLHTTP TEXT ("+v+"): "+j(d,k)+(B?" "+B:"")})}function W(d,v){d.info(function(){return"TIMEOUT: "+v})}ys.prototype.info=function(){};function j(d,v){if(!d.g)return v;if(!v)return null;try{var k=JSON.parse(v);if(k){for(d=0;d<k.length;d++)if(Array.isArray(k[d])){var B=k[d];if(!(2>B.length)){var ce=B[1];if(Array.isArray(ce)&&!(1>ce.length)){var me=ce[0];if(me!="noop"&&me!="stop"&&me!="close")for(var $e=1;$e<ce.length;$e++)ce[$e]=""}}}}return xo(k)}catch{return v}}var V={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},G={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Q;function he(){}y(he,ms),he.prototype.g=function(){return new XMLHttpRequest},he.prototype.i=function(){return{}},Q=new he;function xe(d,v,k,B){this.j=d,this.i=v,this.l=k,this.R=B||1,this.U=new Dr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new fe}function fe(){this.i=null,this.g="",this.h=!1}var ue={},pe={};function we(d,v,k){d.L=1,d.v=fa(ji(v)),d.m=k,d.P=!0,We(d,null)}function We(d,v){d.F=Date.now(),He(d),d.A=ji(d.v);var k=d.A,B=d.R;Array.isArray(B)||(B=[String(B)]),tn(k.i,"t",B),d.C=0,k=d.j.J,d.h=new fe,d.g=Ss(d.j,k?v:null,!d.m),0<d.O&&(d.M=new Ar(g(d.Y,d,d.g),d.O)),v=d.U,k=d.g,B=d.ca;var ce="readystatechange";Array.isArray(ce)||(ce&&(Pr[0]=ce.toString()),ce=Pr);for(var me=0;me<ce.length;me++){var $e=yt(k,ce[me],B||v.handleEvent,!1,v.h||v);if(!$e)break;v.g[$e.key]=$e}v=d.H?F(d.H):{},d.m?(d.u||(d.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,v)):(d.u="GET",d.g.ea(d.A,d.u,null,v)),xs(),Gu(d.i,d.u,d.A,d.l,d.R,d.m)}xe.prototype.ca=function(d){d=d.target;const v=this.M;v&&Vr(d)==3?v.j():this.Y(d)},xe.prototype.Y=function(d){try{if(d==this.g)e:{const Pn=Vr(this.g);var v=this.g.Ba();const bo=this.g.Z();if(!(3>Pn)&&(Pn!=3||this.g&&(this.h.h||this.g.oa()||Ai(this.g)))){this.J||Pn!=4||v==7||(v==8||0>=bo?xs(3):xs(2)),ur(this);var k=this.g.Z();this.X=k;t:if(Ue(this)){var B=Ai(this.g);d="";var ce=B.length,me=Vr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Yt(this),nr(this);var $e="";break t}this.h.i=new o.TextDecoder}for(v=0;v<ce;v++)this.h.h=!0,d+=this.h.i.decode(B[v],{stream:!(me&&v==ce-1)});B.length=0,this.h.g+=d,this.C=0,$e=this.h.g}else $e=this.g.oa();if(this.o=k==200,Si(this.i,this.u,this.A,this.l,this.R,Pn,k),this.o){if(this.T&&!this.K){t:{if(this.g){var Jt,wn=this.g;if((Jt=wn.g?wn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(Jt)){var qt=Jt;break t}}qt=null}if(k=qt)I(this.i,this.l,k,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,wi(this,k);else{this.o=!1,this.s=3,Or(12),Yt(this),nr(this);break e}}if(this.P){k=!0;let Vi;for(;!this.J&&this.C<$e.length;)if(Vi=Oe(this,$e),Vi==pe){Pn==4&&(this.s=4,Or(14),k=!1),I(this.i,this.l,null,"[Incomplete Response]");break}else if(Vi==ue){this.s=4,Or(15),I(this.i,this.l,$e,"[Invalid Chunk]"),k=!1;break}else I(this.i,this.l,Vi,null),wi(this,Vi);if(Ue(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Pn!=4||$e.length!=0||this.h.h||(this.s=1,Or(16),k=!1),this.o=this.o&&k,!k)I(this.i,this.l,$e,"[Invalid Chunked Response]"),Yt(this),nr(this);else if(0<$e.length&&!this.W){this.W=!0;var Tn=this.j;Tn.g==this&&Tn.ba&&!Tn.M&&(Tn.j.info("Great, no buffering proxy detected. Bytes received: "+$e.length),Ju(Tn),Tn.M=!0,Or(11))}}else I(this.i,this.l,$e,null),wi(this,$e);Pn==4&&Yt(this),this.o&&!this.J&&(Pn==4?es(this.j,this):(this.o=!1,He(this)))}else u0(this.g),k==400&&0<$e.indexOf("Unknown SID")?(this.s=3,Or(12)):(this.s=0,Or(13)),Yt(this),nr(this)}}}catch{}finally{}};function Ue(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function Oe(d,v){var k=d.C,B=v.indexOf(`
`,k);return B==-1?pe:(k=Number(v.substring(k,B)),isNaN(k)?ue:(B+=1,B+k>v.length?pe:(v=v.slice(B,B+k),d.C=B+k,v)))}xe.prototype.cancel=function(){this.J=!0,Yt(this)};function He(d){d.S=Date.now()+d.I,at(d,d.I)}function at(d,v){if(d.B!=null)throw Error("WatchDog timer not null");d.B=vs(g(d.ba,d),v)}function ur(d){d.B&&(o.clearTimeout(d.B),d.B=null)}xe.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(W(this.i,this.A),this.L!=2&&(xs(),Or(17)),Yt(this),this.s=2,nr(this)):at(this,this.S-d)};function nr(d){d.j.G==0||d.J||es(d.j,d)}function Yt(d){ur(d);var v=d.M;v&&typeof v.ma=="function"&&v.ma(),d.M=null,Rn(d.U),d.g&&(v=d.g,d.g=null,v.abort(),v.ma())}function wi(d,v){try{var k=d.j;if(k.G!=0&&(k.g==d||Sr(k.h,d))){if(!d.K&&Sr(k.h,d)&&k.G==3){try{var B=k.Da.g.parse(v)}catch{B=null}if(Array.isArray(B)&&B.length==3){var ce=B;if(ce[0]==0){e:if(!k.u){if(k.g)if(k.g.F+3e3<d.F)kl(k),Ht(k);else break e;Ac(k),Or(18)}}else k.za=ce[1],0<k.za-k.T&&37500>ce[2]&&k.F&&k.v==0&&!k.C&&(k.C=vs(g(k.Za,k),6e3));if(1>=ca(k.h)&&k.ca){try{k.ca()}catch{}k.ca=void 0}}else Va(k,11)}else if((d.K||k.g==d)&&kl(k),!C(v))for(ce=k.Da.g.parse(v),v=0;v<ce.length;v++){let qt=ce[v];if(k.T=qt[0],qt=qt[1],k.G==2)if(qt[0]=="c"){k.K=qt[1],k.ia=qt[2];const Tn=qt[3];Tn!=null&&(k.la=Tn,k.j.info("VER="+k.la));const Pn=qt[4];Pn!=null&&(k.Aa=Pn,k.j.info("SVER="+k.Aa));const bo=qt[5];bo!=null&&typeof bo=="number"&&0<bo&&(B=1.5*bo,k.L=B,k.j.info("backChannelRequestTimeoutMs_="+B)),B=k;const Vi=d.g;if(Vi){const Cc=Vi.g?Vi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Cc){var me=B.h;me.g||Cc.indexOf("spdy")==-1&&Cc.indexOf("quic")==-1&&Cc.indexOf("h2")==-1||(me.j=me.l,me.g=new Set,me.h&&(Ua(me,me.h),me.h=null))}if(B.D){const kc=Vi.g?Vi.g.getResponseHeader("X-HTTP-Session-Id"):null;kc&&(B.ya=kc,Ct(B.I,B.D,kc))}}k.G=3,k.l&&k.l.ua(),k.ba&&(k.R=Date.now()-d.F,k.j.info("Handshake RTT: "+k.R+"ms")),B=k;var $e=d;if(B.qa=Fl(B,B.J?B.ia:null,B.W),$e.K){At(B.h,$e);var Jt=$e,wn=B.L;wn&&(Jt.I=wn),Jt.B&&(ur(Jt),He(Jt)),B.g=$e}else Qu(B);0<k.i.length&&Co(k)}else qt[0]!="stop"&&qt[0]!="close"||Va(k,7);else k.G==3&&(qt[0]=="stop"||qt[0]=="close"?qt[0]=="stop"?Va(k,7):ga(k):qt[0]!="noop"&&k.l&&k.l.ta(qt),k.v=0)}}xs(4)}catch{}}var La=class{constructor(d,v){this.g=d,this.map=v}};function Qi(d){this.l=d||10,o.PerformanceNavigationTiming?(d=o.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ar(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function ca(d){return d.h?1:d.g?d.g.size:0}function Sr(d,v){return d.h?d.h==v:d.g?d.g.has(v):!1}function Ua(d,v){d.g?d.g.add(v):d.h=v}function At(d,v){d.h&&d.h==v?d.h=null:d.g&&d.g.has(v)&&d.g.delete(v)}Qi.prototype.cancel=function(){if(this.i=ua(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function ua(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let v=d.i;for(const k of d.g.values())v=v.concat(k.D);return v}return x(d.i)}function Xt(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(l(d)){for(var v=[],k=d.length,B=0;B<k;B++)v.push(d[B]);return v}v=[],k=0;for(B in d)v[k++]=d[B];return v}function Ji(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(l(d)||typeof d=="string"){var v=[];d=d.length;for(var k=0;k<d;k++)v.push(k);return v}v=[],k=0;for(const B in d)v[k++]=B;return v}}}function fn(d,v){if(d.forEach&&typeof d.forEach=="function")d.forEach(v,void 0);else if(l(d)||typeof d=="string")Array.prototype.forEach.call(d,v,void 0);else for(var k=Ji(d),B=Xt(d),ce=B.length,me=0;me<ce;me++)v.call(void 0,B[me],k&&k[me],d)}var da=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function yo(d,v){if(d){d=d.split("&");for(var k=0;k<d.length;k++){var B=d[k].indexOf("="),ce=null;if(0<=B){var me=d[k].substring(0,B);ce=d[k].substring(B+1)}else me=d[k];v(me,ce?decodeURIComponent(ce.replace(/\+/g," ")):"")}}}function Ti(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof Ti){this.h=d.h,_o(this,d.j),this.o=d.o,this.g=d.g,Li(this,d.s),this.l=d.l;var v=d.i,k=new Dn;k.i=v.i,v.g&&(k.g=new Map(v.g),k.h=v.h),Eo(this,k),this.m=d.m}else d&&(v=String(d).match(da))?(this.h=!1,_o(this,v[1]||"",!0),this.o=Hn(v[2]||""),this.g=Hn(v[3]||"",!0),Li(this,v[4]),this.l=Hn(v[5]||"",!0),Eo(this,v[6]||"",!0),this.m=Hn(v[7]||"")):(this.h=!1,this.i=new Dn(null,this.h))}Ti.prototype.toString=function(){var d=[],v=this.j;v&&d.push(ha(v,Vs,!0),":");var k=this.g;return(k||v=="file")&&(d.push("//"),(v=this.o)&&d.push(ha(v,Vs,!0),"@"),d.push(encodeURIComponent(String(k)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.s,k!=null&&d.push(":",String(k))),(k=this.l)&&(this.g&&k.charAt(0)!="/"&&d.push("/"),d.push(ha(k,k.charAt(0)=="/"?wo:Ku,!0))),(k=this.i.toString())&&d.push("?",k),(k=this.m)&&d.push("#",ha(k,yc)),d.join("")};function ji(d){return new Ti(d)}function _o(d,v,k){d.j=k?Hn(v,!0):v,d.j&&(d.j=d.j.replace(/:$/,""))}function Li(d,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);d.s=v}else d.s=null}function Eo(d,v,k){v instanceof Dn?(d.i=v,dg(d.i,d.h)):(k||(v=ha(v,$n)),d.i=new Dn(v,d.h))}function Ct(d,v,k){d.i.set(v,k)}function fa(d){return Ct(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function Hn(d,v){return d?v?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function ha(d,v,k){return typeof d=="string"?(d=encodeURI(d).replace(v,So),k&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function So(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var Vs=/[#\/\?@]/g,Ku=/[#\?:]/g,wo=/[#\?]/g,$n=/[#\?@]/g,yc=/#/g;function Dn(d,v){this.h=this.g=null,this.i=d||null,this.j=!!v}function Zi(d){d.g||(d.g=new Map,d.h=0,d.i&&yo(d.i,function(v,k){d.add(decodeURIComponent(v.replace(/\+/g," ")),k)}))}t=Dn.prototype,t.add=function(d,v){Zi(this),this.i=null,d=zs(this,d);var k=this.g.get(d);return k||this.g.set(d,k=[]),k.push(v),this.h+=1,this};function Ui(d,v){Zi(d),v=zs(d,v),d.g.has(v)&&(d.i=null,d.h-=d.g.get(v).length,d.g.delete(v))}function _c(d,v){return Zi(d),v=zs(d,v),d.g.has(v)}t.forEach=function(d,v){Zi(this),this.g.forEach(function(k,B){k.forEach(function(ce){d.call(v,ce,B,this)},this)},this)},t.na=function(){Zi(this);const d=Array.from(this.g.values()),v=Array.from(this.g.keys()),k=[];for(let B=0;B<v.length;B++){const ce=d[B];for(let me=0;me<ce.length;me++)k.push(v[B])}return k},t.V=function(d){Zi(this);let v=[];if(typeof d=="string")_c(this,d)&&(v=v.concat(this.g.get(zs(this,d))));else{d=Array.from(this.g.values());for(let k=0;k<d.length;k++)v=v.concat(d[k])}return v},t.set=function(d,v){return Zi(this),this.i=null,d=zs(this,d),_c(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[v]),this.h+=1,this},t.get=function(d,v){return d?(d=this.V(d),0<d.length?String(d[0]):v):v};function tn(d,v,k){Ui(d,v),0<k.length&&(d.i=null,d.g.set(zs(d,v),x(k)),d.h+=k.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],v=Array.from(this.g.keys());for(var k=0;k<v.length;k++){var B=v[k];const me=encodeURIComponent(String(B)),$e=this.V(B);for(B=0;B<$e.length;B++){var ce=me;$e[B]!==""&&(ce+="="+encodeURIComponent(String($e[B]))),d.push(ce)}}return this.i=d.join("&")};function zs(d,v){return v=String(v),d.j&&(v=v.toLowerCase()),v}function dg(d,v){v&&!d.j&&(Zi(d),d.i=null,d.g.forEach(function(k,B){var ce=B.toLowerCase();B!=ce&&(Ui(this,B),tn(this,ce,k))},d)),d.j=v}function Ec(d,v){const k=new ys;if(o.Image){const B=new Image;B.onload=m(_s,k,"TestLoadImage: loaded",!0,v,B),B.onerror=m(_s,k,"TestLoadImage: error",!1,v,B),B.onabort=m(_s,k,"TestLoadImage: abort",!1,v,B),B.ontimeout=m(_s,k,"TestLoadImage: timeout",!1,v,B),o.setTimeout(function(){B.ontimeout&&B.ontimeout()},1e4),B.src=d}else v(!1)}function l0(d,v){const k=new ys,B=new AbortController,ce=setTimeout(()=>{B.abort(),_s(k,"TestPingServer: timeout",!1,v)},1e4);fetch(d,{signal:B.signal}).then(me=>{clearTimeout(ce),me.ok?_s(k,"TestPingServer: ok",!0,v):_s(k,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(ce),_s(k,"TestPingServer: error",!1,v)})}function _s(d,v,k,B,ce){try{ce&&(ce.onload=null,ce.onerror=null,ce.onabort=null,ce.ontimeout=null),B(k)}catch{}}function St(){this.g=new $u}function Al(d,v,k){const B=k||"";try{fn(d,function(ce,me){let $e=ce;u(ce)&&($e=xo(ce)),v.push(B+me+"="+encodeURIComponent($e))})}catch(ce){throw v.push(B+"type="+encodeURIComponent("_badmap")),ce}}function yr(d){this.l=d.Ub||null,this.j=d.eb||!1}y(yr,ms),yr.prototype.g=function(){return new Ws(this.l,this.j)},yr.prototype.i=function(d){return function(){return d}}({});function Ws(d,v){cr.call(this),this.D=d,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(Ws,cr),t=Ws.prototype,t.open=function(d,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=v,this.readyState=1,Ao(this)},t.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(v.body=d),(this.D||o).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,To(this)),this.readyState=0},t.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Ao(this)),this.g&&(this.readyState=3,Ao(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Yu(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function Yu(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}t.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var v=d.value?d.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!d.done}))&&(this.response=this.responseText+=v)}d.done?To(this):Ao(this),this.readyState==3&&Yu(this)}},t.Ra=function(d){this.g&&(this.response=this.responseText=d,To(this))},t.Qa=function(d){this.g&&(this.response=d,To(this))},t.ga=function(){this.g&&To(this)};function To(d){d.readyState=4,d.l=null,d.j=null,d.v=null,Ao(d)}t.setRequestHeader=function(d,v){this.u.append(d,v)},t.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],v=this.h.entries();for(var k=v.next();!k.done;)k=k.value,d.push(k[0]+": "+k[1]),k=v.next();return d.join(`\r
`)};function Ao(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(Ws.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function Sc(d){let v="";return z(d,function(k,B){v+=B,v+=":",v+=k,v+=`\r
`}),v}function wc(d,v,k){e:{for(B in k){var B=!1;break e}B=!0}B||(k=Sc(k),typeof d=="string"?k!=null&&encodeURIComponent(String(k)):Ct(d,v,k))}function Cr(d){cr.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(Cr,cr);var c0=/^https?$/i,Cl=["POST","PUT"];t=Cr.prototype,t.Ha=function(d){this.J=d},t.ea=function(d,v,k,B){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);v=v?v.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Q.g(),this.v=this.o?Tl(this.o):Tl(Q),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(v,String(d),!0),this.B=!1}catch(me){Xu(this,me);return}if(d=k||"",k=new Map(this.headers),B)if(Object.getPrototypeOf(B)===Object.prototype)for(var ce in B)k.set(ce,B[ce]);else if(typeof B.keys=="function"&&typeof B.get=="function")for(const me of B.keys())k.set(me,B.get(me));else throw Error("Unknown input type for opt_headers: "+String(B));B=Array.from(k.keys()).find(me=>me.toLowerCase()=="content-type"),ce=o.FormData&&d instanceof o.FormData,!(0<=Array.prototype.indexOf.call(Cl,v,void 0))||B||ce||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[me,$e]of k)this.g.setRequestHeader(me,$e);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Gn(this),this.u=!0,this.g.send(d),this.u=!1}catch(me){Xu(this,me)}};function Xu(d,v){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=v,d.m=5,qu(d),Ur(d)}function qu(d){d.A||(d.A=!0,Lr(d,"complete"),Lr(d,"error"))}t.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,Lr(this,"complete"),Lr(this,"abort"),Ur(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ur(this,!0)),Cr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Sn(this):this.bb())},t.bb=function(){Sn(this)};function Sn(d){if(d.h&&typeof a<"u"&&(!d.v[1]||Vr(d)!=4||d.Z()!=2)){if(d.u&&Vr(d)==4)Ei(d.Ea,0,d);else if(Lr(d,"readystatechange"),Vr(d)==4){d.h=!1;try{const $e=d.Z();e:switch($e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var k;if(!(k=v)){var B;if(B=$e===0){var ce=String(d.D).match(da)[1]||null;!ce&&o.self&&o.self.location&&(ce=o.self.location.protocol.slice(0,-1)),B=!c0.test(ce?ce.toLowerCase():"")}k=B}if(k)Lr(d,"complete"),Lr(d,"success");else{d.m=6;try{var me=2<Vr(d)?d.g.statusText:""}catch{me=""}d.l=me+" ["+d.Z()+"]",qu(d)}}finally{Ur(d)}}}}function Ur(d,v){if(d.g){Gn(d);const k=d.g,B=d.v[0]?()=>{}:null;d.g=null,d.v=null,v||Lr(d,"ready");try{k.onreadystatechange=B}catch{}}}function Gn(d){d.I&&(o.clearTimeout(d.I),d.I=null)}t.isActive=function(){return!!this.g};function Vr(d){return d.g?d.g.readyState:0}t.Z=function(){try{return 2<Vr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(d){if(this.g){var v=this.g.responseText;return d&&v.indexOf(d)==0&&(v=v.substring(d.length)),vo(v)}};function Ai(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function u0(d){const v={};d=(d.g&&2<=Vr(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let B=0;B<d.length;B++){if(C(d[B]))continue;var k=P(d[B]);const ce=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const me=v[ce]||[];v[ce]=me,me.push(k)}T(v,function(B){return B.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function pa(d,v,k){return k&&k.internalChannelParams&&k.internalChannelParams[d]||v}function Lt(d){this.Aa=0,this.i=[],this.j=new ys,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=pa("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=pa("baseRetryDelayMs",5e3,d),this.cb=pa("retryDelaySeedMs",1e4,d),this.Wa=pa("forwardChannelMaxRetries",2,d),this.wa=pa("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new Qi(d&&d.concurrentRequestLimit),this.Da=new St,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Lt.prototype,t.la=8,t.G=1,t.connect=function(d,v,k,B){Or(0),this.W=d,this.H=v||{},k&&B!==void 0&&(this.H.OSID=k,this.H.OAID=B),this.F=this.X,this.I=Fl(this,null,this.W),Co(this)};function ga(d){if(ni(d),d.G==3){var v=d.U++,k=ji(d.I);if(Ct(k,"SID",d.K),Ct(k,"RID",v),Ct(k,"TYPE","terminate"),Es(d,k),v=new xe(d,d.j,v),v.L=2,v.v=fa(ji(k)),k=!1,o.navigator&&o.navigator.sendBeacon)try{k=o.navigator.sendBeacon(v.v.toString(),"")}catch{}!k&&o.Image&&(new Image().src=v.v,k=!0),k||(v.g=Ss(v.j,null),v.g.ea(v.v)),v.F=Date.now(),He(v)}f0(d)}function Ht(d){d.g&&(Ju(d),d.g.cancel(),d.g=null)}function ni(d){Ht(d),d.u&&(o.clearTimeout(d.u),d.u=null),kl(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&o.clearTimeout(d.s),d.s=null)}function Co(d){if(!ar(d.h)&&!d.s){d.s=!0;var v=d.Ga;Fe||be(),Ae||(Fe(),Ae=!0),ne.add(v,d),d.B=0}}function Tc(d,v){return ca(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=v.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=vs(g(d.Ga,d,v),d0(d,d.B)),d.B++,!0)}t.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const ce=new xe(this,this.j,d);let me=this.o;if(this.S&&(me?(me=F(me),R(me,this.S)):me=this.S),this.m!==null||this.O||(ce.H=me,me=null),this.P)e:{for(var v=0,k=0;k<this.i.length;k++){t:{var B=this.i[k];if("__data__"in B.map&&(B=B.map.__data__,typeof B=="string")){B=B.length;break t}B=void 0}if(B===void 0)break;if(v+=B,4096<v){v=k;break e}if(v===4096||k===this.i.length-1){v=k+1;break e}}v=1e3}else v=1e3;v=ma(this,ce,v),k=ji(this.I),Ct(k,"RID",d),Ct(k,"CVER",22),this.D&&Ct(k,"X-HTTP-Session-Id",this.D),Es(this,k),me&&(this.O?v="headers="+encodeURIComponent(String(Sc(me)))+"&"+v:this.m&&wc(k,this.m,me)),Ua(this.h,ce),this.Ua&&Ct(k,"TYPE","init"),this.P?(Ct(k,"$req",v),Ct(k,"SID","null"),ce.T=!0,we(ce,k,null)):we(ce,k,v),this.G=2}}else this.G==3&&(d?rn(this,d):this.i.length==0||ar(this.h)||rn(this))};function rn(d,v){var k;v?k=v.l:k=d.U++;const B=ji(d.I);Ct(B,"SID",d.K),Ct(B,"RID",k),Ct(B,"AID",d.T),Es(d,B),d.m&&d.o&&wc(B,d.m,d.o),k=new xe(d,d.j,k,d.B+1),d.m===null&&(k.H=d.o),v&&(d.i=v.D.concat(d.i)),v=ma(d,k,1e3),k.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),Ua(d.h,k),we(k,B,v)}function Es(d,v){d.H&&z(d.H,function(k,B){Ct(v,B,k)}),d.l&&fn({},function(k,B){Ct(v,B,k)})}function ma(d,v,k){k=Math.min(d.i.length,k);var B=d.l?g(d.l.Na,d.l,d):null;e:{var ce=d.i;let me=-1;for(;;){const $e=["count="+k];me==-1?0<k?(me=ce[0].g,$e.push("ofs="+me)):me=0:$e.push("ofs="+me);let Jt=!0;for(let wn=0;wn<k;wn++){let qt=ce[wn].g;const Tn=ce[wn].map;if(qt-=me,0>qt)me=Math.max(0,ce[wn].g-100),Jt=!1;else try{Al(Tn,$e,"req"+qt+"_")}catch{B&&B(Tn)}}if(Jt){B=$e.join("&");break e}}}return d=d.i.splice(0,k),v.D=d,B}function Qu(d){if(!d.g&&!d.u){d.Y=1;var v=d.Fa;Fe||be(),Ae||(Fe(),Ae=!0),ne.add(v,d),d.v=0}}function Ac(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=vs(g(d.Fa,d),d0(d,d.v)),d.v++,!0)}t.Fa=function(){if(this.u=null,ko(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=vs(g(this.ab,this),d)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Or(10),Ht(this),ko(this))};function Ju(d){d.A!=null&&(o.clearTimeout(d.A),d.A=null)}function ko(d){d.g=new xe(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var v=ji(d.qa);Ct(v,"RID","rpc"),Ct(v,"SID",d.K),Ct(v,"AID",d.T),Ct(v,"CI",d.F?"0":"1"),!d.F&&d.ja&&Ct(v,"TO",d.ja),Ct(v,"TYPE","xmlhttp"),Es(d,v),d.m&&d.o&&wc(v,d.m,d.o),d.L&&(d.g.I=d.L);var k=d.g;d=d.ia,k.L=1,k.v=fa(ji(v)),k.m=null,k.P=!0,We(k,d)}t.Za=function(){this.C!=null&&(this.C=null,Ht(this),Ac(this),Or(19))};function kl(d){d.C!=null&&(o.clearTimeout(d.C),d.C=null)}function es(d,v){var k=null;if(d.g==v){kl(d),Ju(d),d.g=null;var B=2}else if(Sr(d.h,v))k=v.D,At(d.h,v),B=1;else return;if(d.G!=0){if(v.o)if(B==1){k=v.m?v.m.length:0,v=Date.now()-v.F;var ce=d.B;B=Ba(),Lr(B,new En(B,k)),Co(d)}else Qu(d);else if(ce=v.s,ce==3||ce==0&&0<v.X||!(B==1&&Tc(d,v)||B==2&&Ac(d)))switch(k&&0<k.length&&(v=d.h,v.i=v.i.concat(k)),ce){case 1:Va(d,5);break;case 4:Va(d,10);break;case 3:Va(d,6);break;default:Va(d,2)}}}function d0(d,v){let k=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(k*=2),k*v}function Va(d,v){if(d.j.info("Error code "+v),v==2){var k=g(d.fb,d),B=d.Xa;const ce=!B;B=new Ti(B||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||_o(B,"https"),fa(B),ce?Ec(B.toString(),k):l0(B.toString(),k)}else Or(2);d.G=0,d.l&&d.l.sa(v),f0(d),ni(d)}t.fb=function(d){d?(this.j.info("Successfully pinged google.com"),Or(2)):(this.j.info("Failed to ping google.com"),Or(1))};function f0(d){if(d.G=0,d.ka=[],d.l){const v=ua(d.h);(v.length!=0||d.i.length!=0)&&(S(d.ka,v),S(d.ka,d.i),d.h.i.length=0,x(d.i),d.i.length=0),d.l.ra()}}function Fl(d,v,k){var B=k instanceof Ti?ji(k):new Ti(k);if(B.g!="")v&&(B.g=v+"."+B.g),Li(B,B.s);else{var ce=o.location;B=ce.protocol,v=v?v+"."+ce.hostname:ce.hostname,ce=+ce.port;var me=new Ti(null);B&&_o(me,B),v&&(me.g=v),ce&&Li(me,ce),k&&(me.l=k),B=me}return k=d.D,v=d.ya,k&&v&&Ct(B,k,v),Ct(B,"VER",d.la),Es(d,B),B}function Ss(d,v,k){if(v&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=d.Ca&&!d.pa?new Cr(new yr({eb:k})):new Cr(d.pa),v.Ha(d.J),v}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Zu(){}t=Zu.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Fo(){}Fo.prototype.g=function(d,v){return new Ci(d,v)};function Ci(d,v){cr.call(this),this.g=new Lt(v),this.l=d,this.h=v&&v.messageUrlParams||null,d=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(d?d["X-WebChannel-Content-Type"]=v.messageContentType:d={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(d?d["X-WebChannel-Client-Profile"]=v.va:d={"X-WebChannel-Client-Profile":v.va}),this.g.S=d,(d=v&&v.Sb)&&!C(d)&&(this.g.m=d),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!C(v)&&(this.g.D=v,d=this.h,d!==null&&v in d&&(d=this.h,v in d&&delete d[v])),this.j=new Hs(this)}y(Ci,cr),Ci.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ci.prototype.close=function(){ga(this.g)},Ci.prototype.o=function(d){var v=this.g;if(typeof d=="string"){var k={};k.__data__=d,d=k}else this.u&&(k={},k.__data__=xo(d),d=k);v.i.push(new La(v.Ya++,d)),v.G==3&&Co(v)},Ci.prototype.N=function(){this.g.l=null,delete this.j,ga(this.g),delete this.g,Ci.aa.N.call(this)};function _r(d){Us.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var v=d.__sm__;if(v){e:{for(const k in v){d=k;break e}d=void 0}(this.i=d)&&(d=this.i,v=v!==null&&d in v?v[d]:void 0),this.data=v}else this.data=d}y(_r,Us);function ii(){le.call(this),this.status=1}y(ii,le);function Hs(d){this.g=d}y(Hs,Zu),Hs.prototype.ua=function(){Lr(this.g,"a")},Hs.prototype.ta=function(d){Lr(this.g,new _r(d))},Hs.prototype.sa=function(d){Lr(this.g,new ii)},Hs.prototype.ra=function(){Lr(this.g,"b")},Fo.prototype.createWebChannel=Fo.prototype.g,Ci.prototype.send=Ci.prototype.o,Ci.prototype.open=Ci.prototype.m,Ci.prototype.close=Ci.prototype.close,rk=function(){return new Fo},tk=function(){return Ba()},ek=rr,kx={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},V.NO_ERROR=0,V.TIMEOUT=8,V.HTTP_ERROR=6,mh=V,G.COMPLETE="complete",ZC=G,aa.EventType=Ma,Ma.OPEN="a",Ma.CLOSE="b",Ma.ERROR="c",Ma.MESSAGE="d",cr.prototype.listen=cr.prototype.K,Td=aa,Cr.prototype.listenOnce=Cr.prototype.L,Cr.prototype.getLastError=Cr.prototype.Ka,Cr.prototype.getLastErrorCode=Cr.prototype.Ba,Cr.prototype.getStatus=Cr.prototype.Z,Cr.prototype.getResponseJson=Cr.prototype.Oa,Cr.prototype.getResponseText=Cr.prototype.oa,Cr.prototype.send=Cr.prototype.ea,Cr.prototype.setWithCredentials=Cr.prototype.Ha,JC=Cr}).apply(typeof q0<"u"?q0:typeof self<"u"?self:typeof window<"u"?window:{});const vE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ui.UNAUTHENTICATED=new ui(null),ui.GOOGLE_CREDENTIALS=new ui("google-credentials-uid"),ui.FIRST_PARTY=new ui("first-party-uid"),ui.MOCK_USER=new ui("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Uu="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sc=new Cv("@firebase/firestore");function gd(){return sc.logLevel}function et(t,...e){if(sc.logLevel<=Kt.DEBUG){const r=e.map(bv);sc.debug(`Firestore (${Uu}): ${t}`,...r)}}function oo(t,...e){if(sc.logLevel<=Kt.ERROR){const r=e.map(bv);sc.error(`Firestore (${Uu}): ${t}`,...r)}}function Tu(t,...e){if(sc.logLevel<=Kt.WARN){const r=e.map(bv);sc.warn(`Firestore (${Uu}): ${t}`,...r)}}function bv(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vt(t="Unexpected state"){const e=`FIRESTORE (${Uu}) INTERNAL ASSERTION FAILED: `+t;throw oo(e),new Error(e)}function mr(t,e){t||vt()}function Tt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Me={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ot extends mo{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ol{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class A7{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(ui.UNAUTHENTICATED))}shutdown(){}}class C7{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class k7{constructor(e){this.t=e,this.currentUser=ui.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){mr(this.o===void 0);let n=this.i;const i=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let s=new ol;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ol,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{et("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(et("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ol)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(et("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(mr(typeof n.accessToken=="string"),new nk(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return mr(e===null||typeof e=="string"),new ui(e)}}class F7{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=ui.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class b7{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new F7(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(ui.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class I7{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class N7{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){mr(this.o===void 0);const n=s=>{s.error!=null&&et("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,et("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{et("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):et("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(mr(typeof r.token=="string"),this.R=r.token,new I7(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R7(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ik{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=R7(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=e.charAt(i[s]%e.length))}return n}}function sr(t,e){return t<e?-1:t>e?1:0}function Au(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new ot(Me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new ot(Me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new ot(Me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ot(Me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return In.fromMillis(Date.now())}static fromDate(e){return In.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new In(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?sr(this.nanoseconds,e.nanoseconds):sr(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new wt(e)}static min(){return new wt(new In(0,0))}static max(){return new wt(new In(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{constructor(e,r,n){r===void 0?r=0:r>e.length&&vt(),n===void 0?n=e.length-r:n>e.length-r&&vt(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return bf.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof bf?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const s=e.get(i),a=r.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class Jr extends bf{construct(e,r,n){return new Jr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new ot(Me.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Jr(r)}static emptyPath(){return new Jr([])}}const D7=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Jn extends bf{construct(e,r,n){return new Jn(e,r,n)}static isValidIdentifier(e){return D7.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Jn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Jn(["__name__"])}static fromServerFormat(e){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new ot(Me.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new ot(Me.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ot(Me.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new ot(Me.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Jn(r)}static emptyPath(){return new Jn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{constructor(e){this.path=e}static fromPath(e){return new lt(Jr.fromString(e))}static fromName(e){return new lt(Jr.fromString(e).popFirst(5))}static empty(){return new lt(Jr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Jr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Jr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new lt(new Jr(e.slice()))}}function P7(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=wt.fromTimestamp(n===1e9?new In(r+1,0):new In(r,n));return new gl(i,lt.empty(),e)}function O7(t){return new gl(t.readTime,t.key,-1)}class gl{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new gl(wt.min(),lt.empty(),-1)}static max(){return new gl(wt.max(),lt.empty(),-1)}}function M7(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=lt.comparator(t.documentKey,e.documentKey),r!==0?r:sr(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B7="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class j7{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zf(t){if(t.code!==Me.FAILED_PRECONDITION||t.message!==B7)throw t;et("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&vt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Re((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Re?r:Re.resolve(r)}catch(r){return Re.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Re.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Re.reject(r)}static resolve(e){return new Re((r,n)=>{r(e)})}static reject(e){return new Re((r,n)=>{n(e)})}static waitFor(e){return new Re((r,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},l=>n(l))}),a=!0,s===i&&r()})}static or(e){let r=Re.resolve(!1);for(const n of e)r=r.next(i=>i?Re.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(e,r){return new Re((n,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const u=l;r(e[u]).next(f=>{a[u]=f,++o,o===s&&n(a)},f=>i(f))}})}static doWhile(e,r){return new Re((n,i)=>{const s=()=>{e()===!0?r().next(()=>{s()},i):n()};s()})}}function L7(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function e0(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iv{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Iv.oe=-1;function Qp(t){return t==null}function dp(t){return t===0&&1/t==-1/0}function U7(t){return typeof t=="number"&&Number.isInteger(t)&&!dp(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yE(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Vu(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function sk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(e,r){this.comparator=e,this.root=r||Xn.EMPTY}insert(e,r){return new Yr(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Xn.BLACK,null,null))}remove(e){return new Yr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Xn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Q0(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Q0(this.root,e,this.comparator,!1)}getReverseIterator(){return new Q0(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Q0(this.root,e,this.comparator,!0)}}class Q0{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Xn{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n??Xn.RED,this.left=i??Xn.EMPTY,this.right=s??Xn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,s){return new Xn(e??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Xn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return Xn.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Xn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Xn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw vt();const e=this.left.check();if(e!==this.right.check())throw vt();return e+(this.isRed()?0:1)}}Xn.EMPTY=null,Xn.RED=!0,Xn.BLACK=!1;Xn.EMPTY=new class{constructor(){this.size=0}get key(){throw vt()}get value(){throw vt()}get color(){throw vt()}get left(){throw vt()}get right(){throw vt()}copy(e,r,n,i,s){return this}insert(e,r,n){return new Xn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(e){this.comparator=e,this.data=new Yr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new _E(this.data.getIterator())}getIteratorFrom(e){return new _E(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof ei)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new ei(this.comparator);return r.data=e,r}}class _E{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs{constructor(e){this.fields=e,e.sort(Jn.comparator)}static empty(){return new Zs([])}unionWith(e){let r=new ei(Jn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Zs(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Au(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new ak("Invalid base64 string: "+s):s}}(e);return new ri(r)}static fromUint8Array(e){const r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new ri(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return sr(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ri.EMPTY_BYTE_STRING=new ri("");const V7=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ml(t){if(mr(!!t),typeof t=="string"){let e=0;const r=V7.exec(t);if(mr(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:ln(t.seconds),nanos:ln(t.nanos)}}function ln(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ac(t){return typeof t=="string"?ri.fromBase64String(t):ri.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nv(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function Rv(t){const e=t.mapValue.fields.__previous_value__;return Nv(e)?Rv(e):e}function If(t){const e=ml(t.mapValue.fields.__local_write_time__.timestampValue);return new In(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z7{constructor(e,r,n,i,s,a,o,l,u){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=u}}class Nf{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new Nf("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Nf&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J0={mapValue:{}};function oc(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Nv(t)?4:H7(t)?9007199254740991:W7(t)?10:11:vt()}function Ra(t,e){if(t===e)return!0;const r=oc(t);if(r!==oc(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return If(t).isEqual(If(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=ml(i.timestampValue),o=ml(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return ac(i.bytesValue).isEqual(ac(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return ln(i.geoPointValue.latitude)===ln(s.geoPointValue.latitude)&&ln(i.geoPointValue.longitude)===ln(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return ln(i.integerValue)===ln(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=ln(i.doubleValue),o=ln(s.doubleValue);return a===o?dp(a)===dp(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return Au(t.arrayValue.values||[],e.arrayValue.values||[],Ra);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(yE(a)!==yE(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!Ra(a[l],o[l])))return!1;return!0}(t,e);default:return vt()}}function Rf(t,e){return(t.values||[]).find(r=>Ra(r,e))!==void 0}function Cu(t,e){if(t===e)return 0;const r=oc(t),n=oc(e);if(r!==n)return sr(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return sr(t.booleanValue,e.booleanValue);case 2:return function(s,a){const o=ln(s.integerValue||s.doubleValue),l=ln(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return EE(t.timestampValue,e.timestampValue);case 4:return EE(If(t),If(e));case 5:return sr(t.stringValue,e.stringValue);case 6:return function(s,a){const o=ac(s),l=ac(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let u=0;u<o.length&&u<l.length;u++){const f=sr(o[u],l[u]);if(f!==0)return f}return sr(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const o=sr(ln(s.latitude),ln(a.latitude));return o!==0?o:sr(ln(s.longitude),ln(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return SE(t.arrayValue,e.arrayValue);case 10:return function(s,a){var o,l,u,f;const p=s.fields||{},g=a.fields||{},m=(o=p.value)===null||o===void 0?void 0:o.arrayValue,y=(l=g.value)===null||l===void 0?void 0:l.arrayValue,x=sr(((u=m==null?void 0:m.values)===null||u===void 0?void 0:u.length)||0,((f=y==null?void 0:y.values)===null||f===void 0?void 0:f.length)||0);return x!==0?x:SE(m,y)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===J0.mapValue&&a===J0.mapValue)return 0;if(s===J0.mapValue)return 1;if(a===J0.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),u=a.fields||{},f=Object.keys(u);l.sort(),f.sort();for(let p=0;p<l.length&&p<f.length;++p){const g=sr(l[p],f[p]);if(g!==0)return g;const m=Cu(o[l[p]],u[f[p]]);if(m!==0)return m}return sr(l.length,f.length)}(t.mapValue,e.mapValue);default:throw vt()}}function EE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return sr(t,e);const r=ml(t),n=ml(e),i=sr(r.seconds,n.seconds);return i!==0?i:sr(r.nanos,n.nanos)}function SE(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const s=Cu(r[i],n[i]);if(s)return s}return sr(r.length,n.length)}function ku(t){return Fx(t)}function Fx(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=ml(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return ac(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return lt.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=Fx(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${Fx(r.fields[a])}`;return i+"}"}(t.mapValue):vt()}function bx(t){return!!t&&"integerValue"in t}function Dv(t){return!!t&&"arrayValue"in t}function wE(t){return!!t&&"nullValue"in t}function TE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function xh(t){return!!t&&"mapValue"in t}function W7(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function $d(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Vu(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=$d(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=$d(t.arrayValue.values[r]);return e}return Object.assign({},t)}function H7(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rs{constructor(e){this.value=e}static empty(){return new Rs({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!xh(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=$d(r)}setAll(e){let r=Jn.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=$d(a):i.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(e){const r=this.field(e.popLast());xh(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Ra(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];xh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Vu(r,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new Rs($d(this.value))}}function ok(t){const e=[];return Vu(t.fields,(r,n)=>{const i=new Jn([r]);if(xh(n)){const s=ok(n.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new Zs(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e,r,n,i,s,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new pi(e,0,wt.min(),wt.min(),wt.min(),Rs.empty(),0)}static newFoundDocument(e,r,n,i){return new pi(e,1,r,wt.min(),n,i,0)}static newNoDocument(e,r){return new pi(e,2,r,wt.min(),wt.min(),Rs.empty(),0)}static newUnknownDocument(e,r){return new pi(e,3,r,wt.min(),wt.min(),Rs.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(wt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Rs.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Rs.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=wt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof pi&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new pi(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fp{constructor(e,r){this.position=e,this.inclusive=r}}function AE(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?n=lt.comparator(lt.fromName(a.referenceValue),r.key):n=Cu(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function CE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Ra(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(e,r="asc"){this.field=e,this.dir=r}}function $7(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{}class Fn extends lk{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new K7(e,r,n):r==="array-contains"?new q7(e,n):r==="in"?new Q7(e,n):r==="not-in"?new J7(e,n):r==="array-contains-any"?new Z7(e,n):new Fn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new Y7(e,n):new X7(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(Cu(r,this.value)):r!==null&&oc(this.value)===oc(r)&&this.matchesComparison(Cu(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return vt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Da extends lk{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new Da(e,r)}matches(e){return ck(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function ck(t){return t.op==="and"}function uk(t){return G7(t)&&ck(t)}function G7(t){for(const e of t.filters)if(e instanceof Da)return!1;return!0}function Ix(t){if(t instanceof Fn)return t.field.canonicalString()+t.op.toString()+ku(t.value);if(uk(t))return t.filters.map(e=>Ix(e)).join(",");{const e=t.filters.map(r=>Ix(r)).join(",");return`${t.op}(${e})`}}function dk(t,e){return t instanceof Fn?function(n,i){return i instanceof Fn&&n.op===i.op&&n.field.isEqual(i.field)&&Ra(n.value,i.value)}(t,e):t instanceof Da?function(n,i){return i instanceof Da&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&dk(a,i.filters[o]),!0):!1}(t,e):void vt()}function fk(t){return t instanceof Fn?function(r){return`${r.field.canonicalString()} ${r.op} ${ku(r.value)}`}(t):t instanceof Da?function(r){return r.op.toString()+" {"+r.getFilters().map(fk).join(" ,")+"}"}(t):"Filter"}class K7 extends Fn{constructor(e,r,n){super(e,r,n),this.key=lt.fromName(n.referenceValue)}matches(e){const r=lt.comparator(e.key,this.key);return this.matchesComparison(r)}}class Y7 extends Fn{constructor(e,r){super(e,"in",r),this.keys=hk("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class X7 extends Fn{constructor(e,r){super(e,"not-in",r),this.keys=hk("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function hk(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>lt.fromName(n.referenceValue))}class q7 extends Fn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Dv(r)&&Rf(r.arrayValue,this.value)}}class Q7 extends Fn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Rf(this.value.arrayValue,r)}}class J7 extends Fn{constructor(e,r){super(e,"not-in",r)}matches(e){if(Rf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!Rf(this.value.arrayValue,r)}}class Z7 extends Fn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Dv(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Rf(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eU{constructor(e,r=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ue=null}}function kE(t,e=null,r=[],n=[],i=null,s=null,a=null){return new eU(t,e,r,n,i,s,a)}function Pv(t){const e=Tt(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Ix(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),Qp(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>ku(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>ku(n)).join(",")),e.ue=r}return e.ue}function Ov(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!$7(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!dk(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!CE(t.startAt,e.startAt)&&CE(t.endAt,e.endAt)}function Nx(t){return lt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jp{constructor(e,r=null,n=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function tU(t,e,r,n,i,s,a,o){return new Jp(t,e,r,n,i,s,a,o)}function Zp(t){return new Jp(t)}function FE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function rU(t){return t.collectionGroup!==null}function Gd(t){const e=Tt(t);if(e.ce===null){e.ce=[];const r=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new ei(Jn.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(o=o.add(u.field))})}),o})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new hp(s,n))}),r.has(Jn.keyField().canonicalString())||e.ce.push(new hp(Jn.keyField(),n))}return e.ce}function Fa(t){const e=Tt(t);return e.le||(e.le=nU(e,Gd(t))),e.le}function nU(t,e){if(t.limitType==="F")return kE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new hp(i.field,s)});const r=t.endAt?new fp(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new fp(t.startAt.position,t.startAt.inclusive):null;return kE(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Rx(t,e,r){return new Jp(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function eg(t,e){return Ov(Fa(t),Fa(e))&&t.limitType===e.limitType}function pk(t){return`${Pv(Fa(t))}|lt:${t.limitType}`}function Mc(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>fk(i)).join(", ")}]`),Qp(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>ku(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>ku(i)).join(",")),`Target(${n})`}(Fa(t))}; limitType=${t.limitType})`}function tg(t,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):lt.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,i){for(const s of Gd(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,o,l){const u=AE(a,o,l);return a.inclusive?u<=0:u<0}(n.startAt,Gd(n),i)||n.endAt&&!function(a,o,l){const u=AE(a,o,l);return a.inclusive?u>=0:u>0}(n.endAt,Gd(n),i))}(t,e)}function iU(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function gk(t){return(e,r)=>{let n=!1;for(const i of Gd(t)){const s=sU(i,e,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function sU(t,e,r){const n=t.field.isKeyField()?lt.comparator(e.key,r.key):function(s,a,o){const l=a.data.field(s),u=o.data.field(s);return l!==null&&u!==null?Cu(l,u):vt()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return vt()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Vu(this.inner,(r,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return sk(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aU=new Yr(lt.comparator);function lo(){return aU}const mk=new Yr(lt.comparator);function Ad(...t){let e=mk;for(const r of t)e=e.insert(r.key,r);return e}function xk(t){let e=mk;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function jl(){return Kd()}function vk(){return Kd()}function Kd(){return new zu(t=>t.toString(),(t,e)=>t.isEqual(e))}const oU=new Yr(lt.comparator),lU=new ei(lt.comparator);function Wt(...t){let e=lU;for(const r of t)e=e.add(r);return e}const cU=new ei(sr);function uU(){return cU}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:dp(e)?"-0":e}}function yk(t){return{integerValue:""+t}}function dU(t,e){return U7(e)?yk(e):Mv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg{constructor(){this._=void 0}}function fU(t,e,r){return t instanceof pp?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Nv(s)&&(s=Rv(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(r,e):t instanceof Df?Ek(t,e):t instanceof Pf?Sk(t,e):function(i,s){const a=_k(i,s),o=bE(a)+bE(i.Pe);return bx(a)&&bx(i.Pe)?yk(o):Mv(i.serializer,o)}(t,e)}function hU(t,e,r){return t instanceof Df?Ek(t,e):t instanceof Pf?Sk(t,e):r}function _k(t,e){return t instanceof gp?function(n){return bx(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class pp extends rg{}class Df extends rg{constructor(e){super(),this.elements=e}}function Ek(t,e){const r=wk(e);for(const n of t.elements)r.some(i=>Ra(i,n))||r.push(n);return{arrayValue:{values:r}}}class Pf extends rg{constructor(e){super(),this.elements=e}}function Sk(t,e){let r=wk(e);for(const n of t.elements)r=r.filter(i=>!Ra(i,n));return{arrayValue:{values:r}}}class gp extends rg{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function bE(t){return ln(t.integerValue||t.doubleValue)}function wk(t){return Dv(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function pU(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof Df&&i instanceof Df||n instanceof Pf&&i instanceof Pf?Au(n.elements,i.elements,Ra):n instanceof gp&&i instanceof gp?Ra(n.Pe,i.Pe):n instanceof pp&&i instanceof pp}(t.transform,e.transform)}class gU{constructor(e,r){this.version=e,this.transformResults=r}}class eo{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new eo}static exists(e){return new eo(void 0,e)}static updateTime(e){return new eo(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function vh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ng{}function Tk(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ck(t.key,eo.none()):new t0(t.key,t.data,eo.none());{const r=t.data,n=Rs.empty();let i=new ei(Jn.comparator);for(let s of e.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new xc(t.key,n,new Zs(i.toArray()),eo.none())}}function mU(t,e,r){t instanceof t0?function(i,s,a){const o=i.value.clone(),l=NE(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof xc?function(i,s,a){if(!vh(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=NE(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(Ak(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function Yd(t,e,r,n){return t instanceof t0?function(s,a,o,l){if(!vh(s.precondition,a))return o;const u=s.value.clone(),f=RE(s.fieldTransforms,l,a);return u.setAll(f),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null}(t,e,r,n):t instanceof xc?function(s,a,o,l){if(!vh(s.precondition,a))return o;const u=RE(s.fieldTransforms,l,a),f=a.data;return f.setAll(Ak(s)),f.setAll(u),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(t,e,r,n):function(s,a,o){return vh(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function xU(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),s=_k(n.transform,i||null);s!=null&&(r===null&&(r=Rs.empty()),r.set(n.field,s))}return r||null}function IE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Au(n,i,(s,a)=>pU(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class t0 extends ng{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class xc extends ng{constructor(e,r,n,i,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Ak(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function NE(t,e,r){const n=new Map;mr(t.length===r.length);for(let i=0;i<r.length;i++){const s=t[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,hU(a,o,r[i]))}return n}function RE(t,e,r){const n=new Map;for(const i of t){const s=i.transform,a=r.data.field(i.field);n.set(i.field,fU(s,a,e))}return n}class Ck extends ng{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class vU extends ng{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yU{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&mU(s,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Yd(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Yd(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=vk();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;const l=Tk(a,o);l!==null&&n.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(wt.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Wt())}isEqual(e){return this.batchId===e.batchId&&Au(this.mutations,e.mutations,(r,n)=>IE(r,n))&&Au(this.baseMutations,e.baseMutations,(r,n)=>IE(r,n))}}class Bv{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){mr(e.mutations.length===n.length);let i=function(){return oU}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new Bv(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _U{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EU{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mn,Qt;function SU(t){switch(t){default:return vt();case Me.CANCELLED:case Me.UNKNOWN:case Me.DEADLINE_EXCEEDED:case Me.RESOURCE_EXHAUSTED:case Me.INTERNAL:case Me.UNAVAILABLE:case Me.UNAUTHENTICATED:return!1;case Me.INVALID_ARGUMENT:case Me.NOT_FOUND:case Me.ALREADY_EXISTS:case Me.PERMISSION_DENIED:case Me.FAILED_PRECONDITION:case Me.ABORTED:case Me.OUT_OF_RANGE:case Me.UNIMPLEMENTED:case Me.DATA_LOSS:return!0}}function kk(t){if(t===void 0)return oo("GRPC error has no .code"),Me.UNKNOWN;switch(t){case mn.OK:return Me.OK;case mn.CANCELLED:return Me.CANCELLED;case mn.UNKNOWN:return Me.UNKNOWN;case mn.DEADLINE_EXCEEDED:return Me.DEADLINE_EXCEEDED;case mn.RESOURCE_EXHAUSTED:return Me.RESOURCE_EXHAUSTED;case mn.INTERNAL:return Me.INTERNAL;case mn.UNAVAILABLE:return Me.UNAVAILABLE;case mn.UNAUTHENTICATED:return Me.UNAUTHENTICATED;case mn.INVALID_ARGUMENT:return Me.INVALID_ARGUMENT;case mn.NOT_FOUND:return Me.NOT_FOUND;case mn.ALREADY_EXISTS:return Me.ALREADY_EXISTS;case mn.PERMISSION_DENIED:return Me.PERMISSION_DENIED;case mn.FAILED_PRECONDITION:return Me.FAILED_PRECONDITION;case mn.ABORTED:return Me.ABORTED;case mn.OUT_OF_RANGE:return Me.OUT_OF_RANGE;case mn.UNIMPLEMENTED:return Me.UNIMPLEMENTED;case mn.DATA_LOSS:return Me.DATA_LOSS;default:return vt()}}(Qt=mn||(mn={}))[Qt.OK=0]="OK",Qt[Qt.CANCELLED=1]="CANCELLED",Qt[Qt.UNKNOWN=2]="UNKNOWN",Qt[Qt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Qt[Qt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Qt[Qt.NOT_FOUND=5]="NOT_FOUND",Qt[Qt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Qt[Qt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Qt[Qt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Qt[Qt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Qt[Qt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Qt[Qt.ABORTED=10]="ABORTED",Qt[Qt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Qt[Qt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Qt[Qt.INTERNAL=13]="INTERNAL",Qt[Qt.UNAVAILABLE=14]="UNAVAILABLE",Qt[Qt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wU(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TU=new $l([4294967295,4294967295],0);function DE(t){const e=wU().encode(t),r=new QC;return r.update(e),new Uint8Array(r.digest())}function PE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new $l([r,n],0),new $l([i,s],0)]}class jv{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Cd(`Invalid padding: ${r}`);if(n<0)throw new Cd(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Cd(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Cd(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=$l.fromNumber(this.Ie)}Ee(e,r,n){let i=e.add(r.multiply($l.fromNumber(n)));return i.compare(TU)===1&&(i=new $l([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=DE(e),[n,i]=PE(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);if(!this.de(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new jv(s,i,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const r=DE(e),[n,i]=PE(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);this.Ae(a)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Cd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ig{constructor(e,r,n,i,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,r0.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new ig(wt.min(),i,new Yr(sr),lo(),Wt())}}class r0{constructor(e,r,n,i,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new r0(n,r,Wt(),Wt(),Wt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yh{constructor(e,r,n,i){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=i}}class Fk{constructor(e,r){this.targetId=e,this.me=r}}class bk{constructor(e,r,n=ri.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class OE{constructor(){this.fe=0,this.ge=BE(),this.pe=ri.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Wt(),r=Wt(),n=Wt();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:vt()}}),new r0(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=BE()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,mr(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class AU{constructor(e){this.Le=e,this.Be=new Map,this.ke=lo(),this.qe=ME(),this.Qe=new Yr(sr)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:vt()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,i)=>{this.ze(i)&&r(i)})}He(e){const r=e.targetId,n=e.me.count,i=this.Je(r);if(i){const s=i.target;if(Nx(s))if(n===0){const a=new lt(s.path);this.Ue(r,a,pi.newNoDocument(a,wt.min()))}else mr(n===1);else{const a=this.Ye(r);if(a!==n){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(r);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,u)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let a,o;try{a=ac(n).toUint8Array()}catch(l){if(l instanceof ak)return Tu("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new jv(a,i,s)}catch(l){return Tu(l instanceof Cd?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,s,null),i++)}),i}rt(e){const r=new Map;this.Be.forEach((s,a)=>{const o=this.Je(a);if(o){if(s.current&&Nx(o.target)){const l=new lt(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,pi.newNoDocument(l,e))}s.be&&(r.set(a,s.ve()),s.Ce())}});let n=Wt();this.qe.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const u=this.Je(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));const i=new ig(e,r,this.Qe,this.ke,n);return this.ke=lo(),this.qe=ME(),this.Qe=new Yr(sr),i}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,r)?i.Fe(r,1):i.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new OE,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new ei(sr),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||et("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new OE),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function ME(){return new Yr(lt.comparator)}function BE(){return new Yr(lt.comparator)}const CU={asc:"ASCENDING",desc:"DESCENDING"},kU={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},FU={and:"AND",or:"OR"};class bU{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Dx(t,e){return t.useProto3Json||Qp(e)?e:{value:e}}function mp(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ik(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function IU(t,e){return mp(t,e.toTimestamp())}function ba(t){return mr(!!t),wt.fromTimestamp(function(r){const n=ml(r);return new In(n.seconds,n.nanos)}(t))}function Lv(t,e){return Px(t,e).canonicalString()}function Px(t,e){const r=function(i){return new Jr(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function Nk(t){const e=Jr.fromString(t);return mr(Mk(e)),e}function Ox(t,e){return Lv(t.databaseId,e.path)}function dm(t,e){const r=Nk(e);if(r.get(1)!==t.databaseId.projectId)throw new ot(Me.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new ot(Me.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new lt(Dk(r))}function Rk(t,e){return Lv(t.databaseId,e)}function NU(t){const e=Nk(t);return e.length===4?Jr.emptyPath():Dk(e)}function Mx(t){return new Jr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Dk(t){return mr(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function jE(t,e,r){return{name:Ox(t,e),fields:r.value.mapValue.fields}}function RU(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:vt()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,f){return u.useProto3Json?(mr(f===void 0||typeof f=="string"),ri.fromBase64String(f||"")):(mr(f===void 0||f instanceof Buffer||f instanceof Uint8Array),ri.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(u){const f=u.code===void 0?Me.UNKNOWN:kk(u.code);return new ot(f,u.message||"")}(a);r=new bk(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=dm(t,n.document.name),s=ba(n.document.updateTime),a=n.document.createTime?ba(n.document.createTime):wt.min(),o=new Rs({mapValue:{fields:n.document.fields}}),l=pi.newFoundDocument(i,s,a,o),u=n.targetIds||[],f=n.removedTargetIds||[];r=new yh(u,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=dm(t,n.document),s=n.readTime?ba(n.readTime):wt.min(),a=pi.newNoDocument(i,s),o=n.removedTargetIds||[];r=new yh([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=dm(t,n.document),s=n.removedTargetIds||[];r=new yh([],s,i,null)}else{if(!("filter"in e))return vt();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new EU(i,s),o=n.targetId;r=new Fk(o,a)}}return r}function DU(t,e){let r;if(e instanceof t0)r={update:jE(t,e.key,e.value)};else if(e instanceof Ck)r={delete:Ox(t,e.key)};else if(e instanceof xc)r={update:jE(t,e.key,e.data),updateMask:zU(e.fieldMask)};else{if(!(e instanceof vU))return vt();r={verify:Ox(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof pp)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Df)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Pf)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof gp)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw vt()}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:IU(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:vt()}(t,e.precondition)),r}function PU(t,e){return t&&t.length>0?(mr(e!==void 0),t.map(r=>function(i,s){let a=i.updateTime?ba(i.updateTime):ba(s);return a.isEqual(wt.min())&&(a=ba(s)),new gU(a,i.transformResults||[])}(r,e))):[]}function OU(t,e){return{documents:[Rk(t,e.path)]}}function MU(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=Rk(t,i);const s=function(u){if(u.length!==0)return Ok(Da.create(u,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const a=function(u){if(u.length!==0)return u.map(f=>function(g){return{field:Bc(g.field),direction:LU(g.dir)}}(f))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=Dx(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:r,parent:i}}function BU(t){let e=NU(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){mr(n===1);const f=r.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];r.where&&(s=function(p){const g=Pk(p);return g instanceof Da&&uk(g)?g.getFilters():[g]}(r.where));let a=[];r.orderBy&&(a=function(p){return p.map(g=>function(y){return new hp(jc(y.field),function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(g))}(r.orderBy));let o=null;r.limit&&(o=function(p){let g;return g=typeof p=="object"?p.value:p,Qp(g)?null:g}(r.limit));let l=null;r.startAt&&(l=function(p){const g=!!p.before,m=p.values||[];return new fp(m,g)}(r.startAt));let u=null;return r.endAt&&(u=function(p){const g=!p.before,m=p.values||[];return new fp(m,g)}(r.endAt)),tU(e,i,a,s,o,"F",l,u)}function jU(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return vt()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function Pk(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=jc(r.unaryFilter.field);return Fn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=jc(r.unaryFilter.field);return Fn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=jc(r.unaryFilter.field);return Fn.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=jc(r.unaryFilter.field);return Fn.create(a,"!=",{nullValue:"NULL_VALUE"});default:return vt()}}(t):t.fieldFilter!==void 0?function(r){return Fn.create(jc(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return vt()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Da.create(r.compositeFilter.filters.map(n=>Pk(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return vt()}}(r.compositeFilter.op))}(t):vt()}function LU(t){return CU[t]}function UU(t){return kU[t]}function VU(t){return FU[t]}function Bc(t){return{fieldPath:t.canonicalString()}}function jc(t){return Jn.fromServerFormat(t.fieldPath)}function Ok(t){return t instanceof Fn?function(r){if(r.op==="=="){if(TE(r.value))return{unaryFilter:{field:Bc(r.field),op:"IS_NAN"}};if(wE(r.value))return{unaryFilter:{field:Bc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(TE(r.value))return{unaryFilter:{field:Bc(r.field),op:"IS_NOT_NAN"}};if(wE(r.value))return{unaryFilter:{field:Bc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Bc(r.field),op:UU(r.op),value:r.value}}}(t):t instanceof Da?function(r){const n=r.getFilters().map(i=>Ok(i));return n.length===1?n[0]:{compositeFilter:{op:VU(r.op),filters:n}}}(t):vt()}function zU(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function Mk(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{constructor(e,r,n,i,s=wt.min(),a=wt.min(),o=ri.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Xo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Xo(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Xo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Xo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WU{constructor(e){this.ct=e}}function HU(t){const e=BU({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Rx(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $U{constructor(){this.un=new GU}addToCollectionParentIndex(e,r){return this.un.add(r),Re.resolve()}getCollectionParents(e,r){return Re.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return Re.resolve()}deleteFieldIndex(e,r){return Re.resolve()}deleteAllFieldIndexes(e){return Re.resolve()}createTargetIndexes(e,r){return Re.resolve()}getDocumentsMatchingTarget(e,r){return Re.resolve(null)}getIndexType(e,r){return Re.resolve(0)}getFieldIndexes(e,r){return Re.resolve([])}getNextCollectionGroupToUpdate(e){return Re.resolve(null)}getMinOffset(e,r){return Re.resolve(gl.min())}getMinOffsetFromCollectionGroup(e,r){return Re.resolve(gl.min())}updateCollectionGroup(e,r,n){return Re.resolve()}updateIndexEntries(e,r){return Re.resolve()}}class GU{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new ei(Jr.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new ei(Jr.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Fu(0)}static kn(){return new Fu(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KU{constructor(){this.changes=new zu(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,pi.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Re.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YU{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XU{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Yd(n.mutation,i,Zs.empty(),In.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Wt()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Wt()){const i=jl();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(s=>{let a=Ad();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=jl();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Wt()))}populateOverlays(e,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,i){let s=lo();const a=Kd(),o=function(){return Kd()}();return r.forEach((l,u)=>{const f=n.get(u.key);i.has(u.key)&&(f===void 0||f.mutation instanceof xc)?s=s.insert(u.key,u):f!==void 0?(a.set(u.key,f.mutation.getFieldMask()),Yd(f.mutation,u,f.mutation.getFieldMask(),In.now())):a.set(u.key,Zs.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,f)=>a.set(u,f)),r.forEach((u,f)=>{var p;return o.set(u,new YU(f,(p=a.get(u))!==null&&p!==void 0?p:null))}),o))}recalculateAndSaveOverlays(e,r){const n=Kd();let i=new Yr((a,o)=>a-o),s=Wt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const u=r.get(l);if(u===null)return;let f=n.get(l)||Zs.empty();f=o.applyToLocalView(u,f),n.set(l,f);const p=(i.get(o.batchId)||Wt()).add(l);i=i.insert(o.batchId,p)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),u=l.key,f=l.value,p=vk();f.forEach(g=>{if(!s.has(g)){const m=Tk(r.get(g),n.get(g));m!==null&&p.set(g,m),s=s.add(g)}}),a.push(this.documentOverlayCache.saveOverlays(e,u,p))}return Re.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return lt.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):rU(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-s.size):Re.resolve(jl());let o=-1,l=s;return a.next(u=>Re.forEach(u,(f,p)=>(o<p.largestBatchId&&(o=p.largestBatchId),s.get(f)?Re.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{l=l.insert(f,g)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,Wt())).next(f=>({batchId:o,changes:xk(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new lt(r)).next(n=>{let i=Ad();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const s=r.collectionGroup;let a=Ad();return this.indexManager.getCollectionParents(e,s).next(o=>Re.forEach(o,l=>{const u=function(p,g){return new Jp(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(r,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,n,i).next(f=>{f.forEach((p,g)=>{a=a.insert(p,g)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,i))).next(a=>{s.forEach((l,u)=>{const f=u.getKey();a.get(f)===null&&(a=a.insert(f,pi.newInvalidDocument(f)))});let o=Ad();return a.forEach((l,u)=>{const f=s.get(l);f!==void 0&&Yd(f.mutation,u,Zs.empty(),In.now()),tg(r,u)&&(o=o.insert(l,u))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qU{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return Re.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:ba(i.createTime)}}(r)),Re.resolve()}getNamedQuery(e,r){return Re.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(i){return{name:i.name,query:HU(i.bundledQuery),readTime:ba(i.readTime)}}(r)),Re.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QU{constructor(){this.overlays=new Yr(lt.comparator),this.Ir=new Map}getOverlay(e,r){return Re.resolve(this.overlays.get(r))}getOverlays(e,r){const n=jl();return Re.forEach(r,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,s)=>{this.ht(e,r,s)}),Re.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.Ir.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),Re.resolve()}getOverlaysForCollection(e,r,n){const i=jl(),s=r.length+1,a=new lt(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,u=l.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>n&&i.set(l.getKey(),l)}return Re.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let s=new Yr((u,f)=>u-f);const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let f=s.get(u.largestBatchId);f===null&&(f=jl(),s=s.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const o=jl(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,f)=>o.set(u,f)),!(o.size()>=i)););return Re.resolve(o)}ht(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new _U(r,n));let s=this.Ir.get(r);s===void 0&&(s=Wt(),this.Ir.set(r,s)),this.Ir.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JU{constructor(){this.sessionToken=ri.EMPTY_BYTE_STRING}getSessionToken(e){return Re.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Re.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uv{constructor(){this.Tr=new ei(Ln.Er),this.dr=new ei(Ln.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new Ln(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new Ln(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new lt(new Jr([])),n=new Ln(r,e),i=new Ln(r,e+1),s=[];return this.dr.forEachInRange([n,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new lt(new Jr([])),n=new Ln(r,e),i=new Ln(r,e+1);let s=Wt();return this.dr.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const r=new Ln(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Ln{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return lt.comparator(e.key,r.key)||sr(e.wr,r.wr)}static Ar(e,r){return sr(e.wr,r.wr)||lt.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZU{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new ei(Ln.Er)}checkEmpty(e){return Re.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new yU(s,r,n,i);this.mutationQueue.push(a);for(const o of i)this.br=this.br.add(new Ln(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Re.resolve(a)}lookupMutationBatch(e,r){return Re.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.vr(n),s=i<0?0:i;return Re.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Re.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Re.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Ln(r,0),i=new Ln(r,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,i],a=>{const o=this.Dr(a.wr);s.push(o)}),Re.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new ei(sr);return r.forEach(i=>{const s=new Ln(i,0),a=new Ln(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],o=>{n=n.add(o.wr)})}),Re.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let s=n;lt.isDocumentKey(s)||(s=s.child(""));const a=new Ln(new lt(s),0);let o=new ei(sr);return this.br.forEachWhile(l=>{const u=l.key.path;return!!n.isPrefixOf(u)&&(u.length===i&&(o=o.add(l.wr)),!0)},a),Re.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const i=this.Dr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){mr(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return Re.forEach(r.mutations,i=>{const s=new Ln(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new Ln(r,0),i=this.br.firstAfterOrEqual(n);return Re.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Re.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eV{constructor(e){this.Mr=e,this.docs=function(){return new Yr(lt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Re.resolve(n?n.document.mutableCopy():pi.newInvalidDocument(r))}getEntries(e,r){let n=lo();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():pi.newInvalidDocument(i))}),Re.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let s=lo();const a=r.path,o=new lt(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:u,value:{document:f}}=l.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||M7(O7(f),n)<=0||(i.has(f.key)||tg(r,f))&&(s=s.insert(f.key,f.mutableCopy()))}return Re.resolve(s)}getAllFromCollectionGroup(e,r,n,i){vt()}Or(e,r){return Re.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new tV(this)}getSize(e){return Re.resolve(this.size)}}class tV extends KU{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)}),Re.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rV{constructor(e){this.persistence=e,this.Nr=new zu(r=>Pv(r),Ov),this.lastRemoteSnapshotVersion=wt.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Uv,this.targetCount=0,this.kr=Fu.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,i)=>r(i)),Re.resolve()}getLastRemoteSnapshotVersion(e){return Re.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Re.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Re.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),Re.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new Fu(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,Re.resolve()}updateTargetData(e,r){return this.Kn(r),Re.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,Re.resolve()}removeTargets(e,r,n){let i=0;const s=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),Re.waitFor(s).next(()=>i)}getTargetCount(e){return Re.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return Re.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),Re.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),Re.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),Re.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return Re.resolve(n)}containsKey(e,r){return Re.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nV{constructor(e,r){this.qr={},this.overlays={},this.Qr=new Iv(0),this.Kr=!1,this.Kr=!0,this.$r=new JU,this.referenceDelegate=e(this),this.Ur=new rV(this),this.indexManager=new $U,this.remoteDocumentCache=function(i){return new eV(i)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new WU(r),this.Gr=new qU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new QU,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new ZU(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){et("MemoryPersistence","Starting transaction:",e);const i=new iV(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,r){return Re.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class iV extends j7{constructor(e){super(),this.currentSequenceNumber=e}}class Vv{constructor(e){this.persistence=e,this.Jr=new Uv,this.Yr=null}static Zr(e){return new Vv(e)}get Xr(){if(this.Yr)return this.Yr;throw vt()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),Re.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),Re.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),Re.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(i=>this.Xr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Re.forEach(this.Xr,n=>{const i=lt.fromPath(n);return this.ei(e,i).next(s=>{s||r.removeEntry(i,wt.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return Re.or([()=>Re.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zv{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=i}static Wi(e,r){let n=Wt(),i=Wt();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new zv(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sV{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aV{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return a9()?8:L7(yi())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,i){const s={result:null};return this.Yi(e,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new sV;return this.Xi(e,r,a).next(o=>{if(s.result=o,this.zi)return this.es(e,r,a,o.size)})}).next(()=>s.result)}es(e,r,n,i){return n.documentReadCount<this.ji?(gd()<=Kt.DEBUG&&et("QueryEngine","SDK will not create cache indexes for query:",Mc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Re.resolve()):(gd()<=Kt.DEBUG&&et("QueryEngine","Query:",Mc(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(gd()<=Kt.DEBUG&&et("QueryEngine","The SDK decides to create cache indexes for query:",Mc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Fa(r))):Re.resolve())}Yi(e,r){if(FE(r))return Re.resolve(null);let n=Fa(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=Rx(r,null,"F"),n=Fa(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=Wt(...s);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const u=this.ts(r,o);return this.ns(r,u,a,l.readTime)?this.Yi(e,Rx(r,null,"F")):this.rs(e,u,r,l)}))})))}Zi(e,r,n,i){return FE(r)||i.isEqual(wt.min())?Re.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const a=this.ts(r,s);return this.ns(r,a,n,i)?Re.resolve(null):(gd()<=Kt.DEBUG&&et("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Mc(r)),this.rs(e,a,r,P7(i,-1)).next(o=>o))})}ts(e,r){let n=new ei(gk(e));return r.forEach((i,s)=>{tg(e,s)&&(n=n.add(s))}),n}ns(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,r,n){return gd()<=Kt.DEBUG&&et("QueryEngine","Using full collection scan to execute query:",Mc(r)),this.Ji.getDocumentsMatchingQuery(e,r,gl.min(),n)}rs(e,r,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oV{constructor(e,r,n,i){this.persistence=e,this.ss=r,this.serializer=i,this.os=new Yr(sr),this._s=new zu(s=>Pv(s),Ov),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new XU(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function lV(t,e,r,n){return new oV(t,e,r,n)}async function Bk(t,e){const r=Tt(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let l=Wt();for(const u of i){a.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}for(const u of s){o.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}return r.localDocuments.getDocuments(n,l).next(u=>({hs:u,removedBatchIds:a,addedBatchIds:o}))})})}function cV(t,e){const r=Tt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,u,f){const p=u.batch,g=p.keys();let m=Re.resolve();return g.forEach(y=>{m=m.next(()=>f.getEntry(l,y)).next(x=>{const S=u.docVersions.get(y);mr(S!==null),x.version.compareTo(S)<0&&(p.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),f.addEntry(x)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(l,p))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=Wt();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(l=l.add(o.batch.mutations[u].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function jk(t){const e=Tt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function uV(t,e){const r=Tt(t),n=e.snapshotVersion;let i=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.cs.newChangeBuffer({trackRemovals:!0});i=r.os;const o=[];e.targetChanges.forEach((f,p)=>{const g=i.get(p);if(!g)return;o.push(r.Ur.removeMatchingKeys(s,f.removedDocuments,p).next(()=>r.Ur.addMatchingKeys(s,f.addedDocuments,p)));let m=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?m=m.withResumeToken(ri.EMPTY_BYTE_STRING,wt.min()).withLastLimboFreeSnapshotVersion(wt.min()):f.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(f.resumeToken,n)),i=i.insert(p,m),function(x,S,A){return x.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0}(g,m,f)&&o.push(r.Ur.updateTargetData(s,m))});let l=lo(),u=Wt();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,f))}),o.push(dV(s,a,e.documentUpdates).next(f=>{l=f.Ps,u=f.Is})),!n.isEqual(wt.min())){const f=r.Ur.getLastRemoteSnapshotVersion(s).next(p=>r.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(f)}return Re.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(r.os=i,s))}function dV(t,e,r){let n=Wt(),i=Wt();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let a=lo();return r.forEach((o,l)=>{const u=s.get(o);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(wt.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):et("LocalStore","Ignoring outdated watch update for ",o,". Current version:",u.version," Watch version:",l.version)}),{Ps:a,Is:i}})}function fV(t,e){const r=Tt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function hV(t,e){const r=Tt(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Ur.getTargetData(n,e).next(s=>s?(i=s,Re.resolve(i)):r.Ur.allocateTargetId(n).next(a=>(i=new Xo(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.os.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function Bx(t,e,r){const n=Tt(t),i=n.os.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!e0(a))throw a;et("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(i.target)}function LE(t,e,r){const n=Tt(t);let i=wt.min(),s=Wt();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,u,f){const p=Tt(l),g=p._s.get(f);return g!==void 0?Re.resolve(p.os.get(g)):p.Ur.getTargetData(u,f)}(n,a,Fa(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,r?i:wt.min(),r?s:Wt())).next(o=>(pV(n,iU(e),o),{documents:o,Ts:s})))}function pV(t,e,r){let n=t.us.get(e)||wt.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.us.set(e,n)}class UE{constructor(){this.activeTargetIds=uU()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class gV{constructor(){this.so=new UE,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new UE,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mV{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){et("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){et("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Z0=null;function fm(){return Z0===null?Z0=function(){return 268435456+Math.round(2147483648*Math.random())}():Z0++,"0x"+Z0.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xV={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vV{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const li="WebChannelConnection";class yV extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(r,n,i,s,a){const o=fm(),l=this.xo(r,n.toUriEncodedString());et("RestConnection",`Sending RPC '${r}' ${o}:`,l,i);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,s,a),this.No(r,l,u,i).then(f=>(et("RestConnection",`Received RPC '${r}' ${o}: `,f),f),f=>{throw Tu("RestConnection",`RPC '${r}' ${o} failed with error: `,f,"url: ",l,"request:",i),f})}Lo(r,n,i,s,a,o){return this.Mo(r,n,i,s,a)}Oo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Uu}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>r[a]=s),i&&i.headers.forEach((s,a)=>r[a]=s)}xo(r,n){const i=xV[r];return`${this.Do}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,i){const s=fm();return new Promise((a,o)=>{const l=new JC;l.setWithCredentials(!0),l.listenOnce(ZC.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case mh.NO_ERROR:const f=l.getResponseJson();et(li,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),a(f);break;case mh.TIMEOUT:et(li,`RPC '${e}' ${s} timed out`),o(new ot(Me.DEADLINE_EXCEEDED,"Request time out"));break;case mh.HTTP_ERROR:const p=l.getStatus();if(et(li,`RPC '${e}' ${s} failed with status:`,p,"response text:",l.getResponseText()),p>0){let g=l.getResponseJson();Array.isArray(g)&&(g=g[0]);const m=g==null?void 0:g.error;if(m&&m.status&&m.message){const y=function(S){const A=S.toLowerCase().replace(/_/g,"-");return Object.values(Me).indexOf(A)>=0?A:Me.UNKNOWN}(m.status);o(new ot(y,m.message))}else o(new ot(Me.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new ot(Me.UNAVAILABLE,"Connection failed."));break;default:vt()}}finally{et(li,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);et(li,`RPC '${e}' ${s} sending request:`,i),l.send(r,"POST",u,n,15)})}Bo(e,r,n){const i=fm(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=rk(),o=tk(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const f=s.join("");et(li,`Creating RPC '${e}' stream ${i}: ${f}`,l);const p=a.createWebChannel(f,l);let g=!1,m=!1;const y=new vV({Io:S=>{m?et(li,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(g||(et(li,`Opening RPC '${e}' stream ${i} transport.`),p.open(),g=!0),et(li,`RPC '${e}' stream ${i} sending:`,S),p.send(S))},To:()=>p.close()}),x=(S,A,C)=>{S.listen(A,E=>{try{C(E)}catch(M){setTimeout(()=>{throw M},0)}})};return x(p,Td.EventType.OPEN,()=>{m||(et(li,`RPC '${e}' stream ${i} transport opened.`),y.yo())}),x(p,Td.EventType.CLOSE,()=>{m||(m=!0,et(li,`RPC '${e}' stream ${i} transport closed`),y.So())}),x(p,Td.EventType.ERROR,S=>{m||(m=!0,Tu(li,`RPC '${e}' stream ${i} transport errored:`,S),y.So(new ot(Me.UNAVAILABLE,"The operation could not be completed")))}),x(p,Td.EventType.MESSAGE,S=>{var A;if(!m){const C=S.data[0];mr(!!C);const E=C,M=E.error||((A=E[0])===null||A===void 0?void 0:A.error);if(M){et(li,`RPC '${e}' stream ${i} received error:`,M);const X=M.status;let z=function(w){const R=mn[w];if(R!==void 0)return kk(R)}(X),T=M.message;z===void 0&&(z=Me.INTERNAL,T="Unknown error status: "+X+" with message "+M.message),m=!0,y.So(new ot(z,T)),p.close()}else et(li,`RPC '${e}' stream ${i} received:`,C),y.bo(C)}}),x(o,ek.STAT_EVENT,S=>{S.stat===kx.PROXY?et(li,`RPC '${e}' stream ${i} detected buffering proxy`):S.stat===kx.NOPROXY&&et(li,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{y.wo()},0),y}}function hm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sg(t){return new bU(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{constructor(e,r,n=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,r-n);i>0&&et("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uk{constructor(e,r,n,i,s,a,o,l){this.ui=e,this.Ho=n,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Lk(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===Me.RESOURCE_EXHAUSTED?(oo(r.toString()),oo("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===Me.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Yo===r&&this.P_(n,i)},n=>{e(()=>{const i=new ot(Me.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(i)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{n(()=>this.I_(i))}),this.stream.onMessage(i=>{n(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return et("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(et("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class _V extends Uk{constructor(e,r,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=RU(this.serializer,e),n=function(s){if(!("targetChange"in s))return wt.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?wt.min():a.readTime?ba(a.readTime):wt.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=Mx(this.serializer),r.addTarget=function(s,a){let o;const l=a.target;if(o=Nx(l)?{documents:OU(s,l)}:{query:MU(s,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=Ik(s,a.resumeToken);const u=Dx(s,a.expectedCount);u!==null&&(o.expectedCount=u)}else if(a.snapshotVersion.compareTo(wt.min())>0){o.readTime=mp(s,a.snapshotVersion.toTimestamp());const u=Dx(s,a.expectedCount);u!==null&&(o.expectedCount=u)}return o}(this.serializer,e);const n=jU(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=Mx(this.serializer),r.removeTarget=e,this.a_(r)}}class EV extends Uk{constructor(e,r,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return mr(!!e.streamToken),this.lastStreamToken=e.streamToken,mr(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){mr(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=PU(e.writeResults,e.commitTime),n=ba(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=Mx(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>DU(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SV extends class{}{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new ot(Me.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,Px(r,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ot(Me.UNKNOWN,s.toString())})}Lo(e,r,n,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,Px(r,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ot(Me.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class wV{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(oo(r),this.D_=!1):et("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TV{constructor(e,r,n,i,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{n.enqueueAndForget(async()=>{vc(this)&&(et("RemoteStore","Restarting streams for network reachability change."),await async function(l){const u=Tt(l);u.L_.add(4),await n0(u),u.q_.set("Unknown"),u.L_.delete(4),await ag(u)}(this))})}),this.q_=new wV(n,i)}}async function ag(t){if(vc(t))for(const e of t.B_)await e(!0)}async function n0(t){for(const e of t.B_)await e(!1)}function Vk(t,e){const r=Tt(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),Gv(r)?$v(r):Wu(r).r_()&&Hv(r,e))}function Wv(t,e){const r=Tt(t),n=Wu(r);r.N_.delete(e),n.r_()&&zk(r,e),r.N_.size===0&&(n.r_()?n.o_():vc(r)&&r.q_.set("Unknown"))}function Hv(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(wt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Wu(t).A_(e)}function zk(t,e){t.Q_.xe(e),Wu(t).R_(e)}function $v(t){t.Q_=new AU({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Wu(t).start(),t.q_.v_()}function Gv(t){return vc(t)&&!Wu(t).n_()&&t.N_.size>0}function vc(t){return Tt(t).L_.size===0}function Wk(t){t.Q_=void 0}async function AV(t){t.q_.set("Online")}async function CV(t){t.N_.forEach((e,r)=>{Hv(t,e)})}async function kV(t,e){Wk(t),Gv(t)?(t.q_.M_(e),$v(t)):t.q_.set("Unknown")}async function FV(t,e,r){if(t.q_.set("Online"),e instanceof bk&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.N_.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.N_.delete(o),i.Q_.removeTarget(o))}(t,e)}catch(n){et("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await xp(t,n)}else if(e instanceof yh?t.Q_.Ke(e):e instanceof Fk?t.Q_.He(e):t.Q_.We(e),!r.isEqual(wt.min()))try{const n=await jk(t.localStore);r.compareTo(n)>=0&&await function(s,a){const o=s.Q_.rt(a);return o.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const f=s.N_.get(u);f&&s.N_.set(u,f.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,u)=>{const f=s.N_.get(l);if(!f)return;s.N_.set(l,f.withResumeToken(ri.EMPTY_BYTE_STRING,f.snapshotVersion)),zk(s,l);const p=new Xo(f.target,l,u,f.sequenceNumber);Hv(s,p)}),s.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){et("RemoteStore","Failed to raise snapshot:",n),await xp(t,n)}}async function xp(t,e,r){if(!e0(e))throw e;t.L_.add(1),await n0(t),t.q_.set("Offline"),r||(r=()=>jk(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{et("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await ag(t)})}function Hk(t,e){return e().catch(r=>xp(t,r,e))}async function og(t){const e=Tt(t),r=xl(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;bV(e);)try{const i=await fV(e.localStore,n);if(i===null){e.O_.length===0&&r.o_();break}n=i.batchId,IV(e,i)}catch(i){await xp(e,i)}$k(e)&&Gk(e)}function bV(t){return vc(t)&&t.O_.length<10}function IV(t,e){t.O_.push(e);const r=xl(t);r.r_()&&r.V_&&r.m_(e.mutations)}function $k(t){return vc(t)&&!xl(t).n_()&&t.O_.length>0}function Gk(t){xl(t).start()}async function NV(t){xl(t).p_()}async function RV(t){const e=xl(t);for(const r of t.O_)e.m_(r.mutations)}async function DV(t,e,r){const n=t.O_.shift(),i=Bv.from(n,e,r);await Hk(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await og(t)}async function PV(t,e){e&&xl(t).V_&&await async function(n,i){if(function(a){return SU(a)&&a!==Me.ABORTED}(i.code)){const s=n.O_.shift();xl(n).s_(),await Hk(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await og(n)}}(t,e),$k(t)&&Gk(t)}async function zE(t,e){const r=Tt(t);r.asyncQueue.verifyOperationInProgress(),et("RemoteStore","RemoteStore received new credentials");const n=vc(r);r.L_.add(3),await n0(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await ag(r)}async function OV(t,e){const r=Tt(t);e?(r.L_.delete(2),await ag(r)):e||(r.L_.add(2),await n0(r),r.q_.set("Unknown"))}function Wu(t){return t.K_||(t.K_=function(r,n,i){const s=Tt(r);return s.w_(),new _V(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:AV.bind(null,t),Ro:CV.bind(null,t),mo:kV.bind(null,t),d_:FV.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Gv(t)?$v(t):t.q_.set("Unknown")):(await t.K_.stop(),Wk(t))})),t.K_}function xl(t){return t.U_||(t.U_=function(r,n,i){const s=Tt(r);return s.w_(),new EV(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:NV.bind(null,t),mo:PV.bind(null,t),f_:RV.bind(null,t),g_:DV.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await og(t)):(await t.U_.stop(),t.O_.length>0&&(et("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kv{constructor(e,r,n,i,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new ol,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,s){const a=Date.now()+n,o=new Kv(e,r,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ot(Me.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Yv(t,e){if(oo("AsyncQueue",`${e}: ${t}`),e0(t))return new ot(Me.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(e){this.comparator=e?(r,n)=>e(r,n)||lt.comparator(r.key,n.key):(r,n)=>lt.comparator(r.key,n.key),this.keyedMap=Ad(),this.sortedSet=new Yr(this.comparator)}static emptySet(e){return new cu(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof cu)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new cu;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WE{constructor(){this.W_=new Yr(lt.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):vt():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class bu{constructor(e,r,n,i,s,a,o,l,u){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,r,n,i,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new bu(e,r,cu.emptySet(r),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&eg(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MV{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class BV{constructor(){this.queries=HE(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const i=Tt(r),s=i.queries;i.queries=HE(),s.forEach((a,o)=>{for(const l of o.j_)l.onError(n)})})(this,new ot(Me.ABORTED,"Firestore shutting down"))}}function HE(){return new zu(t=>pk(t),eg)}async function Kk(t,e){const r=Tt(t);let n=3;const i=e.query;let s=r.queries.get(i);s?!s.H_()&&e.J_()&&(n=2):(s=new MV,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(i,!0);break;case 1:s.z_=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const o=Yv(a,`Initialization of query '${Mc(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,s),s.j_.push(e),e.Z_(r.onlineState),s.z_&&e.X_(s.z_)&&Xv(r)}async function Yk(t,e){const r=Tt(t),n=e.query;let i=3;const s=r.queries.get(n);if(s){const a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function jV(t,e){const r=Tt(t);let n=!1;for(const i of e){const s=i.query,a=r.queries.get(s);if(a){for(const o of a.j_)o.X_(i)&&(n=!0);a.z_=i}}n&&Xv(r)}function LV(t,e,r){const n=Tt(t),i=n.queries.get(e);if(i)for(const s of i.j_)s.onError(r);n.queries.delete(e)}function Xv(t){t.Y_.forEach(e=>{e.next()})}var jx,$E;($E=jx||(jx={})).ea="default",$E.Cache="cache";class Xk{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new bu(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=bu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==jx.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qk{constructor(e){this.key=e}}class Qk{constructor(e){this.key=e}}class UV{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Wt(),this.mutatedKeys=Wt(),this.Aa=gk(e),this.Ra=new cu(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new WE,i=r?r.Ra:this.Ra;let s=r?r.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,p)=>{const g=i.get(f),m=tg(this.query,p)?p:null,y=!!g&&this.mutatedKeys.has(g.key),x=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let S=!1;g&&m?g.data.isEqual(m.data)?y!==x&&(n.track({type:3,doc:m}),S=!0):this.ga(g,m)||(n.track({type:2,doc:m}),S=!0,(l&&this.Aa(m,l)>0||u&&this.Aa(m,u)<0)&&(o=!0)):!g&&m?(n.track({type:0,doc:m}),S=!0):g&&!m&&(n.track({type:1,doc:g}),S=!0,(l||u)&&(o=!0)),S&&(m?(a=a.add(m),s=x?s.add(f):s.delete(f)):(a=a.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),s=s.delete(f.key),n.track({type:1,doc:f})}return{Ra:a,fa:n,ns:o,mutatedKeys:s}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((f,p)=>function(m,y){const x=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return vt()}};return x(m)-x(y)}(f.type,p.type)||this.Aa(f.doc,p.doc)),this.pa(n),i=i!=null&&i;const o=r&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,u=l!==this.Ea;return this.Ea=l,a.length!==0||u?{snapshot:new bu(this.query,e.Ra,s,a,e.mutatedKeys,l===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new WE,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Wt(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new Qk(n))}),this.da.forEach(n=>{e.has(n)||r.push(new qk(n))}),r}ba(e){this.Ta=e.Ts,this.da=Wt();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return bu.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class VV{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class zV{constructor(e){this.key=e,this.va=!1}}class WV{constructor(e,r,n,i,s,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new zu(o=>pk(o),eg),this.Ma=new Map,this.xa=new Set,this.Oa=new Yr(lt.comparator),this.Na=new Map,this.La=new Uv,this.Ba={},this.ka=new Map,this.qa=Fu.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function HV(t,e,r=!0){const n=nF(t);let i;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await Jk(n,e,r,!0),i}async function $V(t,e){const r=nF(t);await Jk(r,e,!0,!1)}async function Jk(t,e,r,n){const i=await hV(t.localStore,Fa(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,r);let o;return n&&(o=await GV(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&Vk(t.remoteStore,i),o}async function GV(t,e,r,n,i){t.Ka=(p,g,m)=>async function(x,S,A,C){let E=S.view.ma(A);E.ns&&(E=await LE(x.localStore,S.query,!1).then(({documents:T})=>S.view.ma(T,E)));const M=C&&C.targetChanges.get(S.targetId),X=C&&C.targetMismatches.get(S.targetId)!=null,z=S.view.applyChanges(E,x.isPrimaryClient,M,X);return KE(x,S.targetId,z.wa),z.snapshot}(t,p,g,m);const s=await LE(t.localStore,e,!0),a=new UV(e,s.Ts),o=a.ma(s.documents),l=r0.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),u=a.applyChanges(o,t.isPrimaryClient,l);KE(t,r,u.wa);const f=new VV(e,r,a);return t.Fa.set(e,f),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),u.snapshot}async function KV(t,e,r){const n=Tt(t),i=n.Fa.get(e),s=n.Ma.get(i.targetId);if(s.length>1)return n.Ma.set(i.targetId,s.filter(a=>!eg(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Bx(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Wv(n.remoteStore,i.targetId),Lx(n,i.targetId)}).catch(Zf)):(Lx(n,i.targetId),await Bx(n.localStore,i.targetId,!0))}async function YV(t,e){const r=Tt(t),n=r.Fa.get(e),i=r.Ma.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Wv(r.remoteStore,n.targetId))}async function XV(t,e,r){const n=rz(t);try{const i=await function(a,o){const l=Tt(a),u=In.now(),f=o.reduce((m,y)=>m.add(y.key),Wt());let p,g;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let y=lo(),x=Wt();return l.cs.getEntries(m,f).next(S=>{y=S,y.forEach((A,C)=>{C.isValidDocument()||(x=x.add(A))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,y)).next(S=>{p=S;const A=[];for(const C of o){const E=xU(C,p.get(C.key).overlayedDocument);E!=null&&A.push(new xc(C.key,E,ok(E.value.mapValue),eo.exists(!0)))}return l.mutationQueue.addMutationBatch(m,u,A,o)}).next(S=>{g=S;const A=S.applyToLocalDocumentSet(p,x);return l.documentOverlayCache.saveOverlays(m,S.batchId,A)})}).then(()=>({batchId:g.batchId,changes:xk(p)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,l){let u=a.Ba[a.currentUser.toKey()];u||(u=new Yr(sr)),u=u.insert(o,l),a.Ba[a.currentUser.toKey()]=u}(n,i.batchId,r),await i0(n,i.changes),await og(n.remoteStore)}catch(i){const s=Yv(i,"Failed to persist write");r.reject(s)}}async function Zk(t,e){const r=Tt(t);try{const n=await uV(r.localStore,e);e.targetChanges.forEach((i,s)=>{const a=r.Na.get(s);a&&(mr(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?mr(a.va):i.removedDocuments.size>0&&(mr(a.va),a.va=!1))}),await i0(r,n,e)}catch(n){await Zf(n)}}function GE(t,e,r){const n=Tt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Fa.forEach((s,a)=>{const o=a.view.Z_(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const l=Tt(a);l.onlineState=o;let u=!1;l.queries.forEach((f,p)=>{for(const g of p.j_)g.Z_(o)&&(u=!0)}),u&&Xv(l)}(n.eventManager,e),i.length&&n.Ca.d_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function qV(t,e,r){const n=Tt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Na.get(e),s=i&&i.key;if(s){let a=new Yr(lt.comparator);a=a.insert(s,pi.newNoDocument(s,wt.min()));const o=Wt().add(s),l=new ig(wt.min(),new Map,new Yr(sr),a,o);await Zk(n,l),n.Oa=n.Oa.remove(s),n.Na.delete(e),qv(n)}else await Bx(n.localStore,e,!1).then(()=>Lx(n,e,r)).catch(Zf)}async function QV(t,e){const r=Tt(t),n=e.batch.batchId;try{const i=await cV(r.localStore,e);tF(r,n,null),eF(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await i0(r,i)}catch(i){await Zf(i)}}async function JV(t,e,r){const n=Tt(t);try{const i=await function(a,o){const l=Tt(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return l.mutationQueue.lookupMutationBatch(u,o).next(p=>(mr(p!==null),f=p.keys(),l.mutationQueue.removeMutationBatch(u,p))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,f,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>l.localDocuments.getDocuments(u,f))})}(n.localStore,e);tF(n,e,r),eF(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await i0(n,i)}catch(i){await Zf(i)}}function eF(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function tF(t,e,r){const n=Tt(t);let i=n.Ba[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(r?s.reject(r):s.resolve(),i=i.remove(e)),n.Ba[n.currentUser.toKey()]=i}}function Lx(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||rF(t,n)})}function rF(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(Wv(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),qv(t))}function KE(t,e,r){for(const n of r)n instanceof qk?(t.La.addReference(n.key,e),ZV(t,n)):n instanceof Qk?(et("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||rF(t,n.key)):vt()}function ZV(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(et("SyncEngine","New document in limbo: "+r),t.xa.add(n),qv(t))}function qv(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new lt(Jr.fromString(e)),n=t.qa.next();t.Na.set(n,new zV(r)),t.Oa=t.Oa.insert(r,n),Vk(t.remoteStore,new Xo(Fa(Zp(r.path)),n,"TargetPurposeLimboResolution",Iv.oe))}}async function i0(t,e,r){const n=Tt(t),i=[],s=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{a.push(n.Ka(l,e,r).then(u=>{var f;if((u||r)&&n.isPrimaryClient){const p=u?!u.fromCache:(f=r==null?void 0:r.targetChanges.get(l.targetId))===null||f===void 0?void 0:f.current;n.sharedClientState.updateQueryState(l.targetId,p?"current":"not-current")}if(u){i.push(u);const p=zv.Wi(l.targetId,u);s.push(p)}}))}),await Promise.all(a),n.Ca.d_(i),await async function(l,u){const f=Tt(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>Re.forEach(u,g=>Re.forEach(g.$i,m=>f.persistence.referenceDelegate.addReference(p,g.targetId,m)).next(()=>Re.forEach(g.Ui,m=>f.persistence.referenceDelegate.removeReference(p,g.targetId,m)))))}catch(p){if(!e0(p))throw p;et("LocalStore","Failed to update sequence numbers: "+p)}for(const p of u){const g=p.targetId;if(!p.fromCache){const m=f.os.get(g),y=m.snapshotVersion,x=m.withLastLimboFreeSnapshotVersion(y);f.os=f.os.insert(g,x)}}}(n.localStore,s))}async function ez(t,e){const r=Tt(t);if(!r.currentUser.isEqual(e)){et("SyncEngine","User change. New user:",e.toKey());const n=await Bk(r.localStore,e);r.currentUser=e,function(s,a){s.ka.forEach(o=>{o.forEach(l=>{l.reject(new ot(Me.CANCELLED,a))})}),s.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await i0(r,n.hs)}}function tz(t,e){const r=Tt(t),n=r.Na.get(e);if(n&&n.va)return Wt().add(n.key);{let i=Wt();const s=r.Ma.get(e);if(!s)return i;for(const a of s){const o=r.Fa.get(a);i=i.unionWith(o.view.Va)}return i}}function nF(t){const e=Tt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Zk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=tz.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=qV.bind(null,e),e.Ca.d_=jV.bind(null,e.eventManager),e.Ca.$a=LV.bind(null,e.eventManager),e}function rz(t){const e=Tt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=QV.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=JV.bind(null,e),e}class vp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=sg(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return lV(this.persistence,new aV,e.initialUser,this.serializer)}Ga(e){return new nV(Vv.Zr,this.serializer)}Wa(e){return new gV}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}vp.provider={build:()=>new vp};class Ux{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>GE(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=ez.bind(null,this.syncEngine),await OV(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new BV}()}createDatastore(e){const r=sg(e.databaseInfo.databaseId),n=function(s){return new yV(s)}(e.databaseInfo);return function(s,a,o,l){return new SV(s,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,s,a,o){return new TV(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>GE(this.syncEngine,r,0),function(){return VE.D()?new VE:new mV}())}createSyncEngine(e,r){return function(i,s,a,o,l,u,f){const p=new WV(i,s,a,o,l,u);return f&&(p.Qa=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const s=Tt(i);et("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await n0(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Ux.provider={build:()=>new Ux};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iF{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):oo("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nz{constructor(e,r,n,i,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=ui.UNAUTHENTICATED,this.clientId=ik.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{et("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(et("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ol;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Yv(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function pm(t,e){t.asyncQueue.verifyOperationInProgress(),et("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await Bk(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function YE(t,e){t.asyncQueue.verifyOperationInProgress();const r=await iz(t);et("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>zE(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>zE(e.remoteStore,i)),t._onlineComponents=e}async function iz(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){et("FirestoreClient","Using user provided OfflineComponentProvider");try{await pm(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===Me.FAILED_PRECONDITION||i.code===Me.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Tu("Error using user provided cache. Falling back to memory cache: "+r),await pm(t,new vp)}}else et("FirestoreClient","Using default OfflineComponentProvider"),await pm(t,new vp);return t._offlineComponents}async function sF(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(et("FirestoreClient","Using user provided OnlineComponentProvider"),await YE(t,t._uninitializedComponentsProvider._online)):(et("FirestoreClient","Using default OnlineComponentProvider"),await YE(t,new Ux))),t._onlineComponents}function sz(t){return sF(t).then(e=>e.syncEngine)}async function Vx(t){const e=await sF(t),r=e.eventManager;return r.onListen=HV.bind(null,e.syncEngine),r.onUnlisten=KV.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=$V.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=YV.bind(null,e.syncEngine),r}function az(t,e,r={}){const n=new ol;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,u){const f=new iF({next:g=>{f.Za(),a.enqueueAndForget(()=>Yk(s,p));const m=g.docs.has(o);!m&&g.fromCache?u.reject(new ot(Me.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&g.fromCache&&l&&l.source==="server"?u.reject(new ot(Me.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),p=new Xk(Zp(o.path),f,{includeMetadataChanges:!0,_a:!0});return Kk(s,p)}(await Vx(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aF(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XE=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oz(t,e,r){if(!r)throw new ot(Me.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function lz(t,e,r,n){if(e===!0&&n===!0)throw new ot(Me.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function qE(t){if(!lt.isDocumentKey(t))throw new ot(Me.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Qv(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":vt()}function ll(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ot(Me.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Qv(t);throw new ot(Me.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QE{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new ot(Me.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ot(Me.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}lz("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=aF((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ot(Me.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ot(Me.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ot(Me.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Jv{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new QE({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ot(Me.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ot(Me.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new QE(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new A7;switch(n.type){case"firstParty":return new b7(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new ot(Me.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=XE.get(r);n&&(et("ComponentProvider","Removing Datastore"),XE.delete(r),n.terminate())}(this),Promise.resolve()}}function cz(t,e,r,n={}){var i;const s=(t=ll(t,Jv))._getSettings(),a=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&Tu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=ui.MOCK_USER;else{o=ZL(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const u=n.mockUserToken.sub||n.mockUserToken.user_id;if(!u)throw new ot(Me.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new ui(u)}t._authCredentials=new C7(new nk(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lg{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new lg(this.firestore,e,this._query)}}class ds{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Of(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ds(this.firestore,e,this._key)}}class Of extends lg{constructor(e,r,n){super(e,r,Zp(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ds(this.firestore,null,new lt(e))}withConverter(e){return new Of(this.firestore,e,this._path)}}function Zv(t,e,...r){if(t=sa(t),arguments.length===1&&(e=ik.newId()),oz("doc","path",e),t instanceof Jv){const n=Jr.fromString(e,...r);return qE(n),new ds(t,null,new lt(n))}{if(!(t instanceof ds||t instanceof Of))throw new ot(Me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Jr.fromString(e,...r));return qE(n),new ds(t.firestore,t instanceof Of?t.converter:null,new lt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Lk(this,"async_queue_retry"),this.Vu=()=>{const n=hm();n&&et("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=hm();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=hm();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new ol;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!e0(e))throw e;et("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw oo("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const i=Kv.createAndSchedule(this,e,r,n,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&vt()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function ZE(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const i=r;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class Mf extends Jv{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new JE,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new JE(e),this._firestoreClient=void 0,await e}}}function uz(t,e){const r=typeof t=="object"?t:YC(),n=typeof t=="string"?t:"(default)",i=Fv(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=QL("firestore");s&&cz(i,...s)}return i}function ey(t){if(t._terminated)throw new ot(Me.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||dz(t),t._firestoreClient}function dz(t){var e,r,n;const i=t._freezeSettings(),s=function(o,l,u,f){return new z7(o,l,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,aF(f.experimentalLongPollingOptions),f.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new nz(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Iu(ri.fromBase64String(e))}catch(r){throw new ot(Me.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Iu(ri.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ty{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new ot(Me.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Jn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oF{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ry{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new ot(Me.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new ot(Me.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return sr(this._lat,e._lat)||sr(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ny{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fz=/^__.*__$/;class hz{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new xc(e,this.data,this.fieldMask,r,this.fieldTransforms):new t0(e,this.data,r,this.fieldTransforms)}}function lF(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw vt()}}class iy{constructor(e,r,n,i,s,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new iy(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return yp(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(lF(this.Cu)&&fz.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class pz{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||sg(e)}Qu(e,r,n,i=!1){return new iy({Cu:e,methodName:r,qu:n,path:Jn.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function gz(t){const e=t._freezeSettings(),r=sg(t._databaseId);return new pz(t._databaseId,!!e.ignoreUndefinedProperties,r)}function mz(t,e,r,n,i,s={}){const a=t.Qu(s.merge||s.mergeFields?2:0,e,r,i);fF("Data must be an object, but it was:",a,n);const o=uF(n,a);let l,u;if(s.merge)l=new Zs(a.fieldMask),u=a.fieldTransforms;else if(s.mergeFields){const f=[];for(const p of s.mergeFields){const g=xz(e,p,r);if(!a.contains(g))throw new ot(Me.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);yz(f,g)||f.push(g)}l=new Zs(f),u=a.fieldTransforms.filter(p=>l.covers(p.field))}else l=null,u=a.fieldTransforms;return new hz(new Rs(o),l,u)}function cF(t,e){if(dF(t=sa(t)))return fF("Unsupported field value:",e,t),uF(t,e);if(t instanceof oF)return function(n,i){if(!lF(i.Cu))throw i.Bu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let l=cF(o,i.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(t,e)}return function(n,i){if((n=sa(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return dU(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=In.fromDate(n);return{timestampValue:mp(i.serializer,s)}}if(n instanceof In){const s=new In(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:mp(i.serializer,s)}}if(n instanceof ry)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Iu)return{bytesValue:Ik(i.serializer,n._byteString)};if(n instanceof ds){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Lv(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof ny)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return Mv(o.serializer,l)})}}}}}}(n,i);throw i.Bu(`Unsupported field value: ${Qv(n)}`)}(t,e)}function uF(t,e){const r={};return sk(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Vu(t,(n,i)=>{const s=cF(i,e.Mu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function dF(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof In||t instanceof ry||t instanceof Iu||t instanceof ds||t instanceof oF||t instanceof ny)}function fF(t,e,r){if(!dF(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=Qv(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function xz(t,e,r){if((e=sa(e))instanceof ty)return e._internalPath;if(typeof e=="string")return hF(t,e);throw yp("Field path arguments must be of type string or ",t,!1,void 0,r)}const vz=new RegExp("[~\\*/\\[\\]]");function hF(t,e,r){if(e.search(vz)>=0)throw yp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new ty(...e.split("."))._internalPath}catch{throw yp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function yp(t,e,r,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${i}`),l+=")"),new ot(Me.INVALID_ARGUMENT,o+t+l)}function yz(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pF{constructor(e,r,n,i,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ds(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new _z(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(gF("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class _z extends pF{data(){return super.data()}}function gF(t,e){return typeof e=="string"?hF(t,e):e instanceof ty?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ez(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ot(Me.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Sz{convertValue(e,r="none"){switch(oc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ln(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(ac(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw vt()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Vu(e,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,i;const s=(i=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(a=>ln(a.doubleValue));return new ny(s)}convertGeoPoint(e){return new ry(ln(e.latitude),ln(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Rv(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(If(e));default:return null}}convertTimestamp(e){const r=ml(e);return new In(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Jr.fromString(e);mr(Mk(n));const i=new Nf(n.get(1),n.get(3)),s=new lt(n.popFirst(5));return i.isEqual(r)||oo(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wz(t,e,r){let n;return n=t?t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kd{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class mF extends pF{constructor(e,r,n,i,s,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new _h(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(gF("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class _h extends mF{data(e={}){return super.data(e)}}class Tz{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new kd(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new _h(this._firestore,this._userDataWriter,n.key,n,new kd(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new ot(Me.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const l=new _h(i._firestore,i._userDataWriter,o.doc.key,o.doc,new kd(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new _h(i._firestore,i._userDataWriter,o.doc.key,o.doc,new kd(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,f=-1;return o.type!==0&&(u=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),f=a.indexOf(o.doc.key)),{type:Az(o.type),doc:l,oldIndex:u,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function Az(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return vt()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cz(t){t=ll(t,ds);const e=ll(t.firestore,Mf);return az(ey(e),t._key).then(r=>vF(e,t,r))}class xF extends Sz{constructor(e){super(),this.firestore=e}convertBytes(e){return new Iu(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new ds(this.firestore,null,r)}}function kz(t,e,r){t=ll(t,ds);const n=ll(t.firestore,Mf),i=wz(t.converter,e);return bz(n,[mz(gz(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,eo.none())])}function Fz(t,...e){var r,n,i;t=sa(t);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||ZE(e[a])||(s=e[a],a++);const o={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(ZE(e[a])){const p=e[a];e[a]=(r=p.next)===null||r===void 0?void 0:r.bind(p),e[a+1]=(n=p.error)===null||n===void 0?void 0:n.bind(p),e[a+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let l,u,f;if(t instanceof ds)u=ll(t.firestore,Mf),f=Zp(t._key.path),l={next:p=>{e[a]&&e[a](vF(u,t,p))},error:e[a+1],complete:e[a+2]};else{const p=ll(t,lg);u=ll(p.firestore,Mf),f=p._query;const g=new xF(u);l={next:m=>{e[a]&&e[a](new Tz(u,g,p,m))},error:e[a+1],complete:e[a+2]},Ez(t._query)}return function(g,m,y,x){const S=new iF(x),A=new Xk(m,S,y);return g.asyncQueue.enqueueAndForget(async()=>Kk(await Vx(g),A)),()=>{S.Za(),g.asyncQueue.enqueueAndForget(async()=>Yk(await Vx(g),A))}}(ey(u),f,o,l)}function bz(t,e){return function(n,i){const s=new ol;return n.asyncQueue.enqueueAndForget(async()=>XV(await sz(n),i,s)),s.promise}(ey(t),e)}function vF(t,e,r){const n=r.docs.get(e._key),i=new xF(t);return new mF(t,i,e._key,n,new kd(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){Uu=i})(Lu),wu(new ic("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new Mf(new k7(n.getProvider("auth-internal")),new N7(n.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new ot(Me.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Nf(u.options.projectId,f)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),al(vE,"4.7.3",e),al(vE,"4.7.3","esm2017")})();function sy(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function yF(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Iz=yF,_F=new Qf("auth","Firebase",yF());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _p=new Cv("@firebase/auth");function Nz(t,...e){_p.logLevel<=Kt.WARN&&_p.warn(`Auth (${Lu}): ${t}`,...e)}function Eh(t,...e){_p.logLevel<=Kt.ERROR&&_p.error(`Auth (${Lu}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function co(t,...e){throw ay(t,...e)}function Ia(t,...e){return ay(t,...e)}function EF(t,e,r){const n=Object.assign(Object.assign({},Iz()),{[e]:r});return new Qf("auth","Firebase",n).create(e,{appName:t.name})}function Gl(t){return EF(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ay(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return _F.create(t,...e)}function xt(t,e,...r){if(!t)throw ay(e,...r)}function Ka(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Eh(e),new Error(e)}function uo(t,e){t||Ka(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zx(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Rz(){return eS()==="http:"||eS()==="https:"}function eS(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dz(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Rz()||n9()||"connection"in navigator)?navigator.onLine:!0}function Pz(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0{constructor(e,r){this.shortDelay=e,this.longDelay=r,uo(r>e,"Short delay should be less than long delay!"),this.isMobile=e9()||i9()}get(){return Dz()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oy(t,e){uo(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SF{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ka("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ka("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ka("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oz={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mz=new s0(3e4,6e4);function ly(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Hu(t,e,r,n,i={}){return wF(t,i,async()=>{let s={},a={};n&&(e==="GET"?a=n:s={body:JSON.stringify(n)});const o=Jf(Object.assign({key:t.config.apiKey},a)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:l},s);return r9()||(u.referrerPolicy="no-referrer"),SF.fetch()(TF(t,t.config.apiHost,r,o),u)})}async function wF(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},Oz),e);try{const i=new jz(t),s=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw eh(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,u]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw eh(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw eh(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw eh(t,"user-disabled",a);const f=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw EF(t,f,u);co(t,f)}}catch(i){if(i instanceof mo)throw i;co(t,"network-request-failed",{message:String(i)})}}async function Bz(t,e,r,n,i={}){const s=await Hu(t,e,r,n,i);return"mfaPendingCredential"in s&&co(t,"multi-factor-auth-required",{_serverResponse:s}),s}function TF(t,e,r,n){const i=`${e}${r}?${n}`;return t.config.emulator?oy(t.config,i):`${t.config.apiScheme}://${i}`}class jz{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Ia(this.auth,"network-request-failed")),Mz.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function eh(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Ia(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lz(t,e){return Hu(t,"POST","/v1/accounts:delete",e)}async function AF(t,e){return Hu(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xd(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Uz(t,e=!1){const r=sa(t),n=await r.getIdToken(e),i=cy(n);xt(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:Xd(gm(i.auth_time)),issuedAtTime:Xd(gm(i.iat)),expirationTime:Xd(gm(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function gm(t){return Number(t)*1e3}function cy(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Eh("JWT malformed, contained fewer than 3 sections"),null;try{const i=VC(r);return i?JSON.parse(i):(Eh("Failed to decode base64 JWT payload"),null)}catch(i){return Eh("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function tS(t){const e=cy(t);return xt(e,"internal-error"),xt(typeof e.exp<"u","internal-error"),xt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bf(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof mo&&Vz(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function Vz({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zz{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wx{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Xd(this.lastLoginAt),this.creationTime=Xd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ep(t){var e;const r=t.auth,n=await t.getIdToken(),i=await Bf(t,AF(r,{idToken:n}));xt(i==null?void 0:i.users.length,r,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?CF(s.providerUserInfo):[],o=Hz(t.providerData,a),l=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),f=l?u:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Wx(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(t,p)}async function Wz(t){const e=sa(t);await Ep(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Hz(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function CF(t){return t.map(e=>{var{providerId:r}=e,n=sy(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $z(t,e){const r=await wF(t,{},async()=>{const n=Jf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=TF(t,i,"/v1/token",`key=${s}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",SF.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function Gz(t,e){return Hu(t,"POST","/v2/accounts:revokeToken",ly(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){xt(e.idToken,"internal-error"),xt(typeof e.idToken<"u","internal-error"),xt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):tS(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){xt(e.length!==0,"internal-error");const r=tS(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(xt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:s}=await $z(e,r);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new uu;return n&&(xt(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(xt(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(xt(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new uu,this.toJSON())}_performRefresh(){return Ka("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oo(t,e){xt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ya{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,s=sy(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new zz(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Wx(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await Bf(this,this.stsTokenManager.getToken(this.auth,e));return xt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return Uz(this,e)}reload(){return Wz(this)}_assign(e){this!==e&&(xt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Ya(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){xt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Ep(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Yo(this.auth.app))return Promise.reject(Gl(this.auth));const e=await this.getIdToken();return await Bf(this,Lz(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,s,a,o,l,u,f;const p=(n=r.displayName)!==null&&n!==void 0?n:void 0,g=(i=r.email)!==null&&i!==void 0?i:void 0,m=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,y=(a=r.photoURL)!==null&&a!==void 0?a:void 0,x=(o=r.tenantId)!==null&&o!==void 0?o:void 0,S=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,A=(u=r.createdAt)!==null&&u!==void 0?u:void 0,C=(f=r.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:E,emailVerified:M,isAnonymous:X,providerData:z,stsTokenManager:T}=r;xt(E&&T,e,"internal-error");const F=uu.fromJSON(this.name,T);xt(typeof E=="string",e,"internal-error"),Oo(p,e.name),Oo(g,e.name),xt(typeof M=="boolean",e,"internal-error"),xt(typeof X=="boolean",e,"internal-error"),Oo(m,e.name),Oo(y,e.name),Oo(x,e.name),Oo(S,e.name),Oo(A,e.name),Oo(C,e.name);const w=new Ya({uid:E,auth:e,email:g,emailVerified:M,displayName:p,isAnonymous:X,photoURL:y,phoneNumber:m,tenantId:x,stsTokenManager:F,createdAt:A,lastLoginAt:C});return z&&Array.isArray(z)&&(w.providerData=z.map(R=>Object.assign({},R))),S&&(w._redirectEventId=S),w}static async _fromIdTokenResponse(e,r,n=!1){const i=new uu;i.updateFromServerResponse(r);const s=new Ya({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await Ep(s),s}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];xt(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?CF(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),o=new uu;o.updateFromIdToken(n);const l=new Ya({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Wx(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rS=new Map;function Xa(t){uo(t instanceof Function,"Expected a class definition");let e=rS.get(t);return e?(uo(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,rS.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kF{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}kF.type="NONE";const nS=kF;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sh(t,e,r){return`firebase:${t}:${e}:${r}`}class du{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=Sh(this.userKey,i.apiKey,s),this.fullPersistenceKey=Sh("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Ya._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new du(Xa(nS),e,n);const i=(await Promise.all(r.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||Xa(nS);const a=Sh(n,e.config.apiKey,e.name);let o=null;for(const u of r)try{const f=await u._get(a);if(f){const p=Ya._fromJSON(e,f);u!==s&&(o=p),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new du(s,e,n):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async u=>{if(u!==s)try{await u._remove(a)}catch{}})),new du(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iS(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(NF(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(FF(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(DF(e))return"Blackberry";if(PF(e))return"Webos";if(bF(e))return"Safari";if((e.includes("chrome/")||IF(e))&&!e.includes("edge/"))return"Chrome";if(RF(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function FF(t=yi()){return/firefox\//i.test(t)}function bF(t=yi()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function IF(t=yi()){return/crios\//i.test(t)}function NF(t=yi()){return/iemobile/i.test(t)}function RF(t=yi()){return/android/i.test(t)}function DF(t=yi()){return/blackberry/i.test(t)}function PF(t=yi()){return/webos/i.test(t)}function uy(t=yi()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Kz(t=yi()){var e;return uy(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Yz(){return s9()&&document.documentMode===10}function OF(t=yi()){return uy(t)||RF(t)||PF(t)||DF(t)||/windows phone/i.test(t)||NF(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MF(t,e=[]){let r;switch(t){case"Browser":r=iS(yi());break;case"Worker":r=`${iS(yi())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Lu}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xz{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qz(t,e={}){return Hu(t,"GET","/v2/passwordPolicy",ly(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qz=6;class Jz{constructor(e){var r,n,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:Qz,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zz{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new sS(this),this.idTokenSubscription=new sS(this),this.beforeStateQueue=new Xz(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=_F,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Xa(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await du.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await AF(this,{idToken:e}),n=await Ya._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Yo(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return xt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Ep(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Pz()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Yo(this.app))return Promise.reject(Gl(this));const r=e?sa(e):null;return r&&xt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&xt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Yo(this.app)?Promise.reject(Gl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Yo(this.app)?Promise.reject(Gl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Xa(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await qz(this),r=new Jz(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Qf("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await Gz(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Xa(e)||this._popupRedirectResolver;xt(r,this,"argument-error"),this.redirectPersistenceManager=await du.create(this,[Xa(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(xt(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,i);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return xt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=MF(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&Nz(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function dy(t){return sa(t)}class sS{constructor(e){this.auth=e,this.observer=null,this.addObserver=h9(r=>this.observer=r)}get next(){return xt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fy={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function eW(t){fy=t}function tW(t){return fy.loadJS(t)}function rW(){return fy.gapiScript}function nW(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iW(t,e){const r=Fv(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),s=r.getOptions();if(cp(s,e??{}))return i;co(i,"already-initialized")}return r.initialize({options:e})}function sW(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Xa);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function aW(t,e,r){const n=dy(t);xt(n._canInitEmulator,n,"emulator-config-failed"),xt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,s=BF(e),{host:a,port:o}=oW(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${s}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),lW()}function BF(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function oW(t){const e=BF(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:aS(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:aS(a)}}}function aS(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function lW(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jF{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Ka("not implemented")}_getIdTokenResponse(e){return Ka("not implemented")}_linkToIdToken(e,r){return Ka("not implemented")}_getReauthenticationResolver(e){return Ka("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fu(t,e){return Bz(t,"POST","/v1/accounts:signInWithIdp",ly(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cW="http://localhost";class lc extends jF{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new lc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):co("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,s=sy(r,["providerId","signInMethod"]);if(!n||!i)return null;const a=new lc(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return fu(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,fu(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,fu(e,r)}buildRequest(){const e={requestUri:cW,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Jf(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LF{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a0 extends LF{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo extends a0{constructor(){super("facebook.com")}static credential(e){return lc._fromParams({providerId:Uo.PROVIDER_ID,signInMethod:Uo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Uo.credentialFromTaggedObject(e)}static credentialFromError(e){return Uo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Uo.credential(e.oauthAccessToken)}catch{return null}}}Uo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Uo.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vo extends a0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return lc._fromParams({providerId:Vo.PROVIDER_ID,signInMethod:Vo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Vo.credentialFromTaggedObject(e)}static credentialFromError(e){return Vo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Vo.credential(r,n)}catch{return null}}}Vo.GOOGLE_SIGN_IN_METHOD="google.com";Vo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo extends a0{constructor(){super("github.com")}static credential(e){return lc._fromParams({providerId:zo.PROVIDER_ID,signInMethod:zo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return zo.credentialFromTaggedObject(e)}static credentialFromError(e){return zo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return zo.credential(e.oauthAccessToken)}catch{return null}}}zo.GITHUB_SIGN_IN_METHOD="github.com";zo.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo extends a0{constructor(){super("twitter.com")}static credential(e,r){return lc._fromParams({providerId:Wo.PROVIDER_ID,signInMethod:Wo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Wo.credentialFromTaggedObject(e)}static credentialFromError(e){return Wo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Wo.credential(r,n)}catch{return null}}}Wo.TWITTER_SIGN_IN_METHOD="twitter.com";Wo.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const s=await Ya._fromIdTokenResponse(e,n,i),a=oS(n);return new Nu({user:s,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=oS(n);return new Nu({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function oS(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp extends mo{constructor(e,r,n,i){var s;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Sp.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new Sp(e,r,n,i)}}function UF(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Sp._fromErrorAndOperation(t,s,e,n):s})}async function uW(t,e,r=!1){const n=await Bf(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Nu._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dW(t,e,r=!1){const{auth:n}=t;if(Yo(n.app))return Promise.reject(Gl(n));const i="reauthenticate";try{const s=await Bf(t,UF(n,i,e,t),r);xt(s.idToken,n,"internal-error");const a=cy(s.idToken);xt(a,n,"internal-error");const{sub:o}=a;return xt(t.uid===o,n,"user-mismatch"),Nu._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&co(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fW(t,e,r=!1){if(Yo(t.app))return Promise.reject(Gl(t));const n="signIn",i=await UF(t,n,e),s=await Nu._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(s.user),s}function hW(t,e,r,n){return sa(t).onIdTokenChanged(e,r,n)}function pW(t,e,r){return sa(t).beforeAuthStateChanged(e,r)}const wp="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VF{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(wp,"1"),this.storage.removeItem(wp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gW=1e3,mW=10;class zF extends VF{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=OF(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);Yz()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,mW):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},gW)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}zF.type="LOCAL";const xW=zF;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WF extends VF{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}WF.type="SESSION";const HF=WF;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vW(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cg{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new cg(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:s}=r.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async u=>u(r.origin,s)),l=await vW(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}cg.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hy(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yW{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const u=hy("",20);i.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(p){const g=p;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(g.data.response);break;default:clearTimeout(f),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Na(){return window}function _W(t){Na().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $F(){return typeof Na().WorkerGlobalScope<"u"&&typeof Na().importScripts=="function"}async function EW(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function SW(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function wW(){return $F()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GF="firebaseLocalStorageDb",TW=1,Tp="firebaseLocalStorage",KF="fbase_key";class o0{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function ug(t,e){return t.transaction([Tp],e?"readwrite":"readonly").objectStore(Tp)}function AW(){const t=indexedDB.deleteDatabase(GF);return new o0(t).toPromise()}function Hx(){const t=indexedDB.open(GF,TW);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Tp,{keyPath:KF})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Tp)?e(n):(n.close(),await AW(),e(await Hx()))})})}async function lS(t,e,r){const n=ug(t,!0).put({[KF]:e,value:r});return new o0(n).toPromise()}async function CW(t,e){const r=ug(t,!1).get(e),n=await new o0(r).toPromise();return n===void 0?null:n.value}function cS(t,e){const r=ug(t,!0).delete(e);return new o0(r).toPromise()}const kW=800,FW=3;class YF{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Hx(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>FW)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return $F()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=cg._getInstance(wW()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await EW(),!this.activeServiceWorker)return;this.sender=new yW(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||SW()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Hx();return await lS(e,wp,"1"),await cS(e,wp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>lS(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>CW(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>cS(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=ug(i,!1).getAll();return new o0(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),kW)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}YF.type="LOCAL";const bW=YF;new s0(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IW(t,e){return e?Xa(e):(xt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class py extends jF{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return fu(e,this._buildIdpRequest())}_linkToIdToken(e,r){return fu(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return fu(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function NW(t){return fW(t.auth,new py(t),t.bypassAuthState)}function RW(t){const{auth:e,user:r}=t;return xt(r,e,"internal-error"),dW(r,new py(t),t.bypassAuthState)}async function DW(t){const{auth:e,user:r}=t;return xt(r,e,"internal-error"),uW(r,new py(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XF{constructor(e,r,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return NW;case"linkViaPopup":case"linkViaRedirect":return DW;case"reauthViaPopup":case"reauthViaRedirect":return RW;default:co(this.auth,"internal-error")}}resolve(e){uo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){uo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PW=new s0(2e3,1e4);class Jc extends XF{constructor(e,r,n,i,s){super(e,r,i,s),this.provider=n,this.authWindow=null,this.pollId=null,Jc.currentPopupAction&&Jc.currentPopupAction.cancel(),Jc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return xt(e,this.auth,"internal-error"),e}async onExecution(){uo(this.filter.length===1,"Popup operations only handle one event");const e=hy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Ia(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Ia(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Jc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ia(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,PW.get())};e()}}Jc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OW="pendingRedirect",wh=new Map;class MW extends XF{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=wh.get(this.auth._key());if(!e){try{const n=await BW(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}wh.set(this.auth._key(),e)}return this.bypassAuthState||wh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function BW(t,e){const r=UW(e),n=LW(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function jW(t,e){wh.set(t._key(),e)}function LW(t){return Xa(t._redirectPersistence)}function UW(t){return Sh(OW,t.config.apiKey,t.name)}async function VW(t,e,r=!1){if(Yo(t.app))return Promise.reject(Gl(t));const n=dy(t),i=IW(n,e),a=await new MW(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zW=10*60*1e3;class WW{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!HW(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!qF(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(Ia(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=zW&&this.cachedEventUids.clear(),this.cachedEventUids.has(uS(e))}saveEventToCache(e){this.cachedEventUids.add(uS(e)),this.lastProcessedEventTime=Date.now()}}function uS(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function qF({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function HW(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return qF(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $W(t,e={}){return Hu(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GW=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,KW=/^https?/;async function YW(t){if(t.config.emulator)return;const{authorizedDomains:e}=await $W(t);for(const r of e)try{if(XW(r))return}catch{}co(t,"unauthorized-domain")}function XW(t){const e=zx(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!KW.test(r))return!1;if(GW.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qW=new s0(3e4,6e4);function dS(){const t=Na().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function QW(t){return new Promise((e,r)=>{var n,i,s;function a(){dS(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{dS(),r(Ia(t,"network-request-failed"))},timeout:qW.get()})}if(!((i=(n=Na().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Na().gapi)===null||s===void 0)&&s.load)a();else{const o=nW("iframefcb");return Na()[o]=()=>{gapi.load?a():r(Ia(t,"network-request-failed"))},tW(`${rW()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw Th=null,e})}let Th=null;function JW(t){return Th=Th||QW(t),Th}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZW=new s0(5e3,15e3),eH="__/auth/iframe",tH="emulator/auth/iframe",rH={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},nH=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function iH(t){const e=t.config;xt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?oy(e,tH):`https://${t.config.authDomain}/${eH}`,n={apiKey:e.apiKey,appName:t.name,v:Lu},i=nH.get(t.config.apiHost);i&&(n.eid=i);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${Jf(n).slice(1)}`}async function sH(t){const e=await JW(t),r=Na().gapi;return xt(r,t,"internal-error"),e.open({where:document.body,url:iH(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:rH,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const a=Ia(t,"network-request-failed"),o=Na().setTimeout(()=>{s(a)},ZW.get());function l(){Na().clearTimeout(o),i(n)}n.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aH={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},oH=500,lH=600,cH="_blank",uH="http://localhost";class fS{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function dH(t,e,r,n=oH,i=lH){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},aH),{width:n.toString(),height:i.toString(),top:s,left:a}),u=yi().toLowerCase();r&&(o=IF(u)?cH:r),FF(u)&&(e=e||uH,l.scrollbars="yes");const f=Object.entries(l).reduce((g,[m,y])=>`${g}${m}=${y},`,"");if(Kz(u)&&o!=="_self")return fH(e||"",o),new fS(null);const p=window.open(e||"",o,f);xt(p,t,"popup-blocked");try{p.focus()}catch{}return new fS(p)}function fH(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hH="__/auth/handler",pH="emulator/auth/handler",gH=encodeURIComponent("fac");async function hS(t,e,r,n,i,s){xt(t.config.authDomain,t,"auth-domain-config-required"),xt(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Lu,eventId:i};if(e instanceof LF){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",f9(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))a[f]=p}if(e instanceof a0){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const f of Object.keys(o))o[f]===void 0&&delete o[f];const l=await t._getAppCheckToken(),u=l?`#${gH}=${encodeURIComponent(l)}`:"";return`${mH(t)}?${Jf(o).slice(1)}${u}`}function mH({config:t}){return t.emulator?oy(t,pH):`https://${t.authDomain}/${hH}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mm="webStorageSupport";class xH{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=HF,this._completeRedirectFn=VW,this._overrideRedirectResult=jW}async _openPopup(e,r,n,i){var s;uo((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await hS(e,r,n,zx(),i);return dH(e,a,hy())}async _openRedirect(e,r,n,i){await this._originValidation(e);const s=await hS(e,r,n,zx(),i);return _W(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:s}=this.eventManagers[r];return i?Promise.resolve(i):(uo(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await sH(e),n=new WW(e);return r.register("authEvent",i=>(xt(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(mm,{type:mm},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[mm];a!==void 0&&r(!!a),co(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=YW(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return OF()||bF()||uy()}}const vH=xH;var pS="@firebase/auth",gS="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yH{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){xt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _H(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function EH(t){wu(new ic("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;xt(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:MF(t)},u=new Zz(n,i,s,l);return sW(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),wu(new ic("auth-internal",e=>{const r=dy(e.getProvider("auth").getImmediate());return(n=>new yH(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),al(pS,gS,_H(t)),al(pS,gS,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SH=5*60,wH=HC("authIdTokenMaxAge")||SH;let mS=null;const TH=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>wH)return;const i=r==null?void 0:r.token;mS!==i&&(mS=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function AH(t=YC()){const e=Fv(t,"auth");if(e.isInitialized())return e.getImmediate();const r=iW(t,{popupRedirectResolver:vH,persistence:[bW,xW,HF]}),n=HC("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const a=TH(s.toString());pW(r,a,()=>a(r.currentUser)),hW(r,o=>a(o))}}const i=zC("auth");return i&&aW(r,`http://${i}`),r}function CH(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}eW({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const s=Ia("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",CH().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});EH("Browser");const kH={apiKey:"AIzaSyAZZ0804o11q-hS6p7XJZNK_FPGJgXpmPc",authDomain:"finance-automation-b28e8.firebaseapp.com",projectId:"finance-automation-b28e8",storageBucket:"finance-automation-b28e8.firebasestorage.app",messagingSenderId:"832501526859",appId:"1:832501526859:web:3a64f40f9db732af1b78ce"},QF=KC(kH),gy=uz(QF);AH(QF);const md=async(t,e)=>{try{return await kz(Zv(gy,"appState",t),{masterData:e.masterData||[],servicesData:e.servicesData||[],ledgerEntries:e.ledgerEntries||[],receipts:e.receipts||[],creditNotes:e.creditNotes||[],openingBalances:e.openingBalances||{},mailerImages:e.mailerImages||{},mailerLogo:e.mailerLogo||null,companyConfig:e.companyConfig||{},nextInvoiceNo:e.nextInvoiceNo||1,nextCombineNo:e.nextCombineNo||1,nextReceiptNo:e.nextReceiptNo||1,nextCreditNoteNo:e.nextCreditNoteNo||1,nextServiceInvoiceNo:e.nextServiceInvoiceNo||1,invoiceValues:e.invoiceValues||{},notifications:e.notifications||[],whatsappSettings:e.whatsappSettings||{},partyMaster:e.partyMaster||[],followups:e.followups||[],userPasswords:e.userPasswords||{},updatedAt:new Date().toISOString()}),!0}catch(r){return console.error("Error saving app state:",r),!1}},xS=async t=>{try{const e=await Cz(Zv(gy,"appState",t));return e.exists()?e.data():null}catch(e){return console.error("Error loading app state:",e),null}},FH=(t,e)=>{const r=Zv(gy,"appState",t);return Fz(r,n=>{n.exists()&&e(n.data())},n=>{console.error("Error in real-time listener:",n)})},nt=t=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2,maximumFractionDigits:2}).format(t||0),Ot=t=>""+new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t||0),_t=t=>{if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return t;const r=e.getDate().toString().padStart(2,"0"),n=e.toLocaleString("en-US",{month:"short"}),i=e.getFullYear();return`${r}-${n}-${i}`},bH=t=>{if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return t;const r=e.getDate(),n=e.toLocaleString("en-US",{month:"short"}),i=e.getFullYear();return`${r}${(a=>{if(a>3&&a<21)return"th";switch(a%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}})(r)} ${n}, ${i}`},th=t=>{const e=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],r=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];if(t===0)return"Zero";const n=l=>l<20?e[l]:l<100?r[Math.floor(l/10)]+(l%10?" "+e[l%10]:""):e[Math.floor(l/100)]+" Hundred"+(l%100?" "+n(l%100):""),i=l=>l<1e3?n(l):l<1e5?n(Math.floor(l/1e3))+" Thousand"+(l%1e3?" "+n(l%1e3):""):l<1e7?n(Math.floor(l/1e5))+" Lakh"+(l%1e5?" "+i(l%1e5):""):n(Math.floor(l/1e7))+" Crore"+(l%1e7?" "+i(l%1e7):""),s=Math.floor(t),a=Math.round((t-s)*100);let o="INR "+i(s);return a>0&&(o+=" and "+i(a)+" Paise"),o+" Only"},IH=t=>{if(!t)return"";const e=/[\w.-]+@[\w.-]+\.\w+/g,r=t.match(e);return r?r[0]:""},NH=t=>({Approved:{bg:"#DCFCE7",text:"#166534",border:"#86EFAC"},Created:{bg:"#DBEAFE",text:"#1E40AF",border:"#93C5FD"},"Need Edits":{bg:"#FEE2E2",text:"#991B1B",border:"#FCA5A5"},Paid:{bg:"#D1FAE5",text:"#065F46",border:"#6EE7B7"},Individual:{bg:"#E0E7FF",text:"#3730A3",border:"#A5B4FC"},Combined:{bg:"#F3E8FF",text:"#6B21A8",border:"#DDD6FE"},Yes:{bg:"#DCFCE7",text:"#166534",border:"#86EFAC"},No:{bg:"#FEF3C7",text:"#92400E",border:"#FCD34D"},"Not Yet":{bg:"#F1F5F9",text:"#475569",border:"#CBD5E1"},Pending:{bg:"#FEF3C7",text:"#92400E",border:"#FCD34D"},Sent:{bg:"#D1FAE5",text:"#065F46",border:"#6EE7B7"}})[t]||{bg:"#F1F5F9",text:"#475569",border:"#CBD5E1"},xm=({status:t,small:e=!1})=>{const r=NH(t);return c.jsx("span",{style:{display:"inline-flex",alignItems:"center",padding:e?"2px 8px":"4px 12px",borderRadius:"6px",fontSize:e?"11px":"12px",fontWeight:"600",backgroundColor:r.bg,color:r.text,border:`1px solid ${r.border}`},children:t})},Ke=({icon:t,label:e,onClick:r,variant:n="default",disabled:i=!1,small:s=!1})=>{const a={default:{bg:"#F8FAFC",hoverBg:"#E2E8F0",text:"#475569",border:"#CBD5E1"},primary:{bg:"#2874A6",hoverBg:"#1a5276",text:"#FFFFFF",border:"#2874A6"},success:{bg:"#059669",hoverBg:"#047857",text:"#FFFFFF",border:"#059669"},warning:{bg:"#D97706",hoverBg:"#B45309",text:"#FFFFFF",border:"#D97706"},danger:{bg:"#DC2626",hoverBg:"#B91C1C",text:"#FFFFFF",border:"#DC2626"},brand:{bg:"#2874A6",hoverBg:"#1a5276",text:"#FFFFFF",border:"#2874A6"},purple:{bg:"#7C3AED",hoverBg:"#6D28D9",text:"#FFFFFF",border:"#7C3AED"},secondary:{bg:"#F1F5F9",hoverBg:"#E2E8F0",text:"#475569",border:"#CBD5E1"}},o=a[n]||a.default;return c.jsxs("button",{onClick:r,disabled:i,title:e,style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:s?"5px 10px":"8px 14px",borderRadius:"6px",fontSize:s?"11px":"13px",fontWeight:"600",backgroundColor:i?"#F1F5F9":o.bg,color:i?"#94A3B8":o.text,border:`1px solid ${i?"#E2E8F0":o.border}`,cursor:i?"not-allowed":"pointer",transition:"all 0.15s ease",whiteSpace:"nowrap",opacity:i?.6:1},onMouseEnter:l=>!i&&(l.target.style.backgroundColor=o.hoverBg),onMouseLeave:l=>!i&&(l.target.style.backgroundColor=o.bg),children:[t&&c.jsx(t,{size:s?14:16}),e&&c.jsx("span",{children:e})]})},Mr=({label:t,type:e="text",value:r,onChange:n,placeholder:i,disabled:s,small:a})=>c.jsxs("div",{style:{marginBottom:a?"12px":"16px"},children:[t&&c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:t}),c.jsx("input",{type:e,value:r,onChange:n,placeholder:i,disabled:s,style:{width:"100%",padding:a?"8px 12px":"10px 14px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:a?"13px":"14px",backgroundColor:s?"#F9FAFB":"#FFFFFF",boxSizing:"border-box"}})]}),rh=({label:t,value:e,onChange:r,options:n,small:i})=>c.jsxs("div",{style:{marginBottom:i?"12px":"16px"},children:[t&&c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:t}),c.jsx("select",{value:e,onChange:r,style:{width:"100%",padding:i?"8px 12px":"10px 14px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:i?"13px":"14px",backgroundColor:"#FFFFFF",boxSizing:"border-box"},children:n.map(s=>c.jsx("option",{value:s.value,children:s.label},s.value))})]}),gn=({title:t,children:e,actions:r,noPadding:n=!1})=>c.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",boxShadow:"0 2px 8px rgba(0,0,0,0.06)",overflow:"hidden"},children:[t&&c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"14px 20px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FAFBFC"},children:[c.jsx("h3",{style:{margin:0,fontSize:"15px",fontWeight:"700",color:"#1E293B"},children:t}),r&&c.jsx("div",{style:{display:"flex",gap:"10px"},children:r})]}),c.jsx("div",{style:{padding:n?0:"20px"},children:e})]}),Bn=({isOpen:t,onClose:e,title:r,children:n,width:i="500px"})=>t?c.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(15, 23, 42, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(4px)"},onClick:e,children:c.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"16px",width:i,maxWidth:"95vw",maxHeight:"90vh",overflow:"hidden",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},onClick:s=>s.stopPropagation(),children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FAFBFC"},children:[c.jsx("h2",{style:{margin:0,fontSize:"16px",fontWeight:"700",color:"#1E293B"},children:r}),c.jsx("button",{onClick:e,style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748B"},children:c.jsx(Sa,{size:20})})]}),c.jsx("div",{style:{padding:"20px",maxHeight:"calc(90vh - 100px)",overflowY:"auto"},children:n})]})}):null;function RH(){const[t,e]=ve.useState(()=>{const h=localStorage.getItem("financeAppLogin");return h?JSON.parse(h).isLoggedIn:!1}),[r,n]=ve.useState(()=>{const h=localStorage.getItem("financeAppLogin");return h?JSON.parse(h).userRole:null}),[i,s]=ve.useState({username:"",password:""}),[a,o]=ve.useState(""),[l,u]=ve.useState(!1),[f,p]=ve.useState(!1),[g,m]=ve.useState(null),[y,x]=ve.useState({finance:"finance123",director:"director123"}),[S,A]=ve.useState(!1),[C,E]=ve.useState(!1),[M,X]=ve.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[z,T]=ve.useState(""),F={finance:{role:"finance",name:"Finance Team"},director:{role:"director",name:"Director"}};ve.useEffect(()=>{(async()=>{try{const _=await xS("indreesh-media");_&&_.userPasswords&&(x(_.userPasswords),console.log("Passwords loaded from Firebase"))}catch(_){console.error("Error loading passwords:",_)}A(!0)})()},[]);const[w,R]=ve.useState({name:"Indreesh Media LLP",brand:"JAC",address:"A-1701 Sweet Home CHS LTD, SVP, Plot No: 24",addressLine2:"Andheri West, Nr Last Bus St",city:"Mumbai-400053",gstin:"27AAIFI6351A1ZM",stateCode:"27",stateName:"Maharashtra",email:"alliances@mediabrief.com",phone:"+91 7021911036",website:"www.mediabrief.com",pan:"AAIFI6351A",bank:{name:"Axis Bank",account:"921020009075531",branch:"Andheri",ifsc:"UTIB0000020",holder:"Indreesh Media LLP"},invoicePrefix:"MB/2025-26/",hsnCode:"998365",gstRate:18}),[P,O]=ve.useState("master"),[D,qe]=ve.useState(!1),[Ee,Pe]=ve.useState([]),[Fe,Ae]=ve.useState([]),[ne,be]=ve.useState([]),[je,H]=ve.useState([]),[te,re]=ve.useState([]),[Y,ye]=ve.useState(null),[Te,Ve]=ve.useState(null),[De,Ne]=ve.useState(null),[it,Z]=ve.useState(1),[Rt,Et]=ve.useState(1),[Dt,yt]=ve.useState(1),[Xe,xr]=ve.useState(1),[Xr,_n]=ve.useState(1),[Pi,Oi]=ve.useState(!1),[Mi,jr]=ve.useState(!1),[Bi,cr]=ve.useState(!1),[Lr,Tr]=ve.useState(!1),[Ei,mt]=ve.useState(!1),[Ar,Dr]=ve.useState(!1),[Pr,Rn]=ve.useState(!1),[xo,vo]=ve.useState(!1),[$u,ms]=ve.useState(!1),[Tl,aa]=ve.useState(!1),[Ma,Us]=ve.useState(!1),[le,rr]=ve.useState(null),[oa,Ba]=ve.useState("reply"),[ja,xs]=ve.useState(""),[la,Or]=ve.useState(""),[En,vs]=ve.useState({fromDate:"2020-01-01",toDate:new Date().toISOString().split("T")[0]}),[ys,Gu]=ve.useState(""),[Si,I]=ve.useState("open"),[W,j]=ve.useState("open"),[V,G]=ve.useState(!1),[Q,he]=ve.useState(null),[xe,fe]=ve.useState(new Set),[ue,pe]=ve.useState({party:"",billStatus:"",invoiceStatus:""}),[we,We]=ve.useState({party:"",invoiceNo:"",dateFrom:"",dateTo:""}),[Ue,Oe]=ve.useState({party:"",invoiceStatus:"",receiptStatus:"",invoiceType:"",searchText:""}),[He,at]=ve.useState([]),[ur,nr]=ve.useState(!1),[Yt,wi]=ve.useState([]),[La,Qi]=ve.useState(!1),[ar,ca]=ve.useState(null),[Sr,Ua]=ve.useState({date:new Date().toISOString().split("T")[0],notes:"",nextFollowupDate:"",status:"Pending"}),[At,ua]=ve.useState({enabled:!1,financePhone:"",financeApiKey:"",directorPhone:"",directorApiKey:""}),[Xt,Ji]=ve.useState({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),[fn,da]=ve.useState({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]}),[yo,Ti]=ve.useState({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1}),[ji,_o]=ve.useState(null),[Li,Eo]=ve.useState(new Set),[Ct,fa]=ve.useState({}),[Hn,ha]=ve.useState(null),[So,Vs]=ve.useState(null),[Ku,wo]=ve.useState(!1),[$n,yc]=ve.useState({}),[Dn,Zi]=ve.useState({partyName:"",amount:"",type:"Dr"}),[Ui,_c]=ve.useState({}),[tn,zs]=ve.useState({}),[dg,Ec]=ve.useState(!1),[l0,_s]=ve.useState(new Set),[St,Al]=ve.useState({party:"",billStatus:"",invoiceStatus:"",mailingStatus:"",invoiceType:"",combinationCode:"",searchText:""}),[yr,Ws]=ve.useState({amount:"",date:new Date().toISOString().split("T")[0],mode:"Bank",tds:"",discount:"",narration:""}),Yu=ve.useRef(null),To=ve.useRef(null),Ao=ve.useRef(null),Sc=ve.useRef(null),wc=ve.useRef(null),Cr=ve.useRef(null),c0=ve.useRef(null),Cl=ve.useRef(null),Xu=ve.useRef(null),qu=ve.useRef(null),Sn=ve.useMemo(()=>Array.isArray(Ee)?Ee:[],[Ee]),Ur=ve.useMemo(()=>Array.isArray(Fe)?Fe:[],[Fe]),Gn=ve.useMemo(()=>Array.isArray(ne)?ne:[],[ne]),Vr=ve.useMemo(()=>Array.isArray(je)?je:[],[je]),Ai=ve.useMemo(()=>Array.isArray(te)?te:[],[te]),u0=ve.useMemo(()=>Array.isArray(He)?He:[],[He]),pa=ve.useMemo(()=>Array.isArray(Yt)?Yt:[],[Yt]),Lt=ve.useMemo(()=>tn&&typeof tn=="object"&&!Array.isArray(tn)?tn:{},[tn]),ga=ve.useMemo(()=>$n&&typeof $n=="object"&&!Array.isArray($n)?$n:{},[$n]),Ht=(h,_)=>!h||!_?!1:h.trim().toUpperCase()===_.trim().toUpperCase(),ni=ve.useCallback(h=>{if(!h)return"";const _=h.toUpperCase().trim();return _.includes("MAHARASHTRA")||_==="MH"?"MAHARASHTRA":_.includes("DELHI")||_==="DL"||_.includes("NEW DELHI")?"DELHI":_.includes("KARNATAKA")||_==="KA"||_.includes("BANGALORE")||_.includes("BENGALURU")?"KARNATAKA":_.includes("TAMIL")||_==="TN"||_.includes("CHENNAI")?"TAMIL NADU":_.includes("TELANGANA")||_==="TG"||_==="TS"||_.includes("HYDERABAD")?"TELANGANA":_.includes("UTTAR PRADESH")||_==="UP"||_.includes("NOIDA")||_.includes("LUCKNOW")?"UTTAR PRADESH":_.includes("WEST BENGAL")||_==="WB"||_.includes("KOLKATA")?"WEST BENGAL":_.includes("GUJARAT")||_==="GJ"||_.includes("AHMEDABAD")?"GUJARAT":_.includes("RAJASTHAN")||_==="RJ"||_.includes("JAIPUR")?"RAJASTHAN":_.includes("PUNJAB")||_==="PB"?"PUNJAB":_.includes("HARYANA")||_==="HR"||_.includes("GURGAON")||_.includes("GURUGRAM")?"HARYANA":_.includes("MADHYA PRADESH")||_==="MP"||_.includes("BHOPAL")?"MADHYA PRADESH":_.includes("ANDHRA")||_==="AP"?"ANDHRA PRADESH":_.includes("KERALA")||_==="KL"?"KERALA":_.includes("ODISHA")||_.includes("ORISSA")||_==="OR"||_==="OD"?"ODISHA":_.includes("BIHAR")||_==="BR"?"BIHAR":_.includes("JHARKHAND")||_==="JH"?"JHARKHAND":_.includes("ASSAM")||_==="AS"?"ASSAM":_.includes("CHHATTISGARH")||_==="CG"?"CHHATTISGARH":_.includes("GOA")||_==="GA"?"GOA":_.includes("HIMACHAL")||_==="HP"?"HIMACHAL PRADESH":_.includes("JAMMU")||_==="JK"?"JAMMU AND KASHMIR":_.includes("UTTARAKHAND")||_.includes("UTTARANCHAL")||_==="UK"?"UTTARAKHAND":_.includes("MUMBAI")?"MAHARASHTRA":_.includes("CHANDIGARH")?"CHANDIGARH":_},[]),Co=ve.useCallback((h,_)=>{var se;if(!h)return"";const U=ni(_),q=h.trim().toUpperCase(),L=`${q}|${U}`;if((se=Lt[L])!=null&&se.gstin)return Lt[L].gstin;for(const N in Lt){const b=Lt[N];if((b.partyName||"").trim().toUpperCase()===q&&b.normalizedState===U)return b.gstin||""}for(const N in Lt){const b=Lt[N];if((b.partyName||"").trim().toUpperCase()===q&&b.gstin)return b.gstin}return""},[Lt,ni]),Tc=ve.useCallback((h,_)=>{var se;if(!h)return"";const U=ni(_),q=h.trim().toUpperCase(),L=`${q}|${U}`;if((se=Lt[L])!=null&&se.address)return Lt[L].address;for(const N in Lt){const b=Lt[N];if((b.partyName||"").trim().toUpperCase()===q&&b.normalizedState===U)return b.address||""}for(const N in Lt){const b=Lt[N];if((b.partyName||"").trim().toUpperCase()===q&&b.address)return b.address}return""},[Lt,ni]),rn=ve.useCallback((h,_,U="")=>{var N,b;if(U&&((N=Lt[U])!=null&&N.clientCode))return Lt[U].clientCode;if(!h)return"";const q=ni(_),L=h.trim().toUpperCase(),se=`${L}|${q}`;if((b=Lt[se])!=null&&b.clientCode)return Lt[se].clientCode;for(const ie in Lt){const J=Lt[ie];if((J.partyName||"").trim().toUpperCase()===L&&J.normalizedState===q)return J.clientCode||""}for(const ie in Lt){const J=Lt[ie];if((J.partyName||"").trim().toUpperCase()===L&&J.clientCode)return J.clientCode}return""},[Lt,ni]);ve.useCallback(h=>{if(!h)return null;if(Lt[h])return Lt[h];for(const _ in Lt){const U=Lt[_];if(U.clientCode===h)return U}return null},[Lt]);const Es=ve.useRef(!1),ma=ve.useRef(null),Qu=async()=>{u(!0);try{const h=await xS("indreesh-media");h&&(Array.isArray(h.masterData)&&Pe(h.masterData),Array.isArray(h.servicesData)&&Ae(h.servicesData),Array.isArray(h.ledgerEntries)&&be(h.ledgerEntries),Array.isArray(h.receipts)&&H(h.receipts),Array.isArray(h.creditNotes)&&re(h.creditNotes),Array.isArray(h.notifications)&&at(h.notifications),Array.isArray(h.followups)&&wi(h.followups),h.openingBalances&&typeof h.openingBalances=="object"&&!Array.isArray(h.openingBalances)&&yc(h.openingBalances),h.mailerImages&&typeof h.mailerImages=="object"&&!Array.isArray(h.mailerImages)&&fa(h.mailerImages),h.partyMaster&&typeof h.partyMaster=="object"&&!Array.isArray(h.partyMaster)&&zs(h.partyMaster),h.userPasswords&&typeof h.userPasswords=="object"&&!Array.isArray(h.userPasswords)&&x(h.userPasswords),h.mailerLogo&&ha(h.mailerLogo),h.companyConfig&&R(_=>({..._,...h.companyConfig,name:"Indreesh Media LLP",bank:{...h.companyConfig.bank||_.bank,holder:"Indreesh Media LLP"}})),h.nextInvoiceNo&&Z(h.nextInvoiceNo),h.nextCombineNo&&Et(h.nextCombineNo),h.nextReceiptNo&&yt(h.nextReceiptNo),h.nextCreditNoteNo&&xr(h.nextCreditNoteNo),h.nextServiceInvoiceNo&&_n(h.nextServiceInvoiceNo),h.invoiceValues&&_c(h.invoiceValues),h.whatsappSettings&&ua(_=>({..._,...h.whatsappSettings})),console.log("Data loaded from Firebase"))}catch(h){console.error("Error loading data:",h)}u(!1)},Ac=ve.useCallback(async()=>{p(!0);try{console.log("Saving to Firebase:",{masterDataCount:Ee==null?void 0:Ee.length,servicesDataCount:Fe==null?void 0:Fe.length,servicesDataSample:Fe==null?void 0:Fe.slice(0,1),receiptsCount:je==null?void 0:je.length,creditNotesCount:te==null?void 0:te.length}),await md("indreesh-media",{masterData:Ee,servicesData:Fe,ledgerEntries:ne,receipts:je,creditNotes:te,openingBalances:$n,mailerImages:Ct,mailerLogo:Hn,companyConfig:w,nextInvoiceNo:it,nextCombineNo:Rt,nextReceiptNo:Dt,nextCreditNoteNo:Xe,nextServiceInvoiceNo:Xr,invoiceValues:Ui,notifications:He,whatsappSettings:At,partyMaster:tn,followups:Yt,userPasswords:y}),m(new Date),console.log("Data saved to Firebase successfully")}catch(h){console.error("Error saving data:",h)}p(!1)},[Ee,Fe,ne,je,te,$n,Ct,Hn,w,it,Rt,Dt,Xe,Xr,Ui,He,At,tn,Yt,y]);ve.useEffect(()=>{if(t&&!Es.current)return Cl.current&&clearTimeout(Cl.current),Cl.current=setTimeout(()=>{Es.current||Ac()},1e3),()=>{Cl.current&&clearTimeout(Cl.current)}},[Ee,Fe,ne,je,te,$n,Ct,Hn,w,it,Rt,Dt,Xe,Xr,Ui,He,At,tn,Yt,y,t]);const Ju=async(h,_,U)=>{if(!At.enabled){console.log("WhatsApp notifications not enabled");return}U==="finance"&&At.financePhone&&At.financeApiKey?ko(At.financePhone,At.financeApiKey,h,_):U==="director"&&At.directorPhone&&At.directorApiKey?ko(At.directorPhone,At.directorApiKey,h,_):U==="all"&&(At.financePhone&&At.financeApiKey&&ko(At.financePhone,At.financeApiKey,h,_),At.directorPhone&&At.directorApiKey&&ko(At.directorPhone,At.directorApiKey,h,_))},ko=async(h,_,U,q)=>{try{const se=`*${{upload:" DATA UPLOAD",invoice:" INVOICE",approval:" APPROVED",edit:" EDIT REQUIRED",receipt:" PAYMENT",info:" UPDATE"}[U]||" NOTIFICATION"}*

${q}

_${w.name}_
_${new Date().toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})}_`,N=`https://api.callmebot.com/whatsapp.php?phone=${h}&text=${encodeURIComponent(se)}&apikey=${_}`;fetch(N,{mode:"no-cors"}).then(()=>console.log("WhatsApp notification sent to:",h)).catch(b=>console.log("WhatsApp send attempted:",h))}catch(L){console.error("Failed to send WhatsApp notification:",L)}},kl=(h,_)=>{if(!h||!_){alert("Please enter phone number and API key first");return}ko(h,_,"info","Test notification from Indreesh Media LLP. WhatsApp notifications are working!"),alert("Test message sent! Check your WhatsApp.")},es=(h,_,U="all")=>{const q={id:Date.now()+Math.random(),type:h,message:_,forRole:U,createdAt:new Date().toISOString(),createdBy:r,read:{finance:!1,director:!1}};at(L=>[q,...L].slice(0,50)),Ju(h,_,U)},d0=h=>{at(_=>(Array.isArray(_)?_:[]).map(q=>q.id===h?{...q,read:{...q.read,[r]:!0}}:q))},Va=()=>{at(h=>(Array.isArray(h)?h:[]).map(U=>({...U,read:{...U.read,[r]:!0}})))},f0=()=>{at([])},Fl=ve.useMemo(()=>u0.filter(h=>h.forRole==="all"||h.forRole===r||h.createdBy!==r).map(h=>({...h,read:h.read||{finance:!1,director:!1}})),[u0,r]),Ss=ve.useMemo(()=>r?Fl.filter(h=>!(h.read&&h.read[r])).length:0,[Fl,r]),Zu=async()=>{const h=F[i.username.toLowerCase()],_=y[i.username.toLowerCase()];h&&_===i.password?(e(!0),n(h.role),localStorage.setItem("financeAppLogin",JSON.stringify({isLoggedIn:!0,userRole:h.role})),o(""),s({username:"",password:""}),await Qu()):o("Invalid username or password")},Fo=async()=>{if(!M.currentPassword||!M.newPassword||!M.confirmPassword){T("Please fill all fields");return}const h=r==="director"?"director":"finance";if(y[h]!==M.currentPassword){T("Current password is incorrect");return}if(M.newPassword!==M.confirmPassword){T("New passwords do not match");return}if(M.newPassword.length<6){T("Password must be at least 6 characters");return}const _={...y,[h]:M.newPassword};x(_);try{await md("indreesh-media",{masterData:Ee,ledgerEntries:ne,receipts:je,creditNotes:te,openingBalances:$n,mailerImages:Ct,mailerLogo:Hn,companyConfig:w,nextInvoiceNo:it,nextCombineNo:Rt,nextReceiptNo:Dt,nextCreditNoteNo:Xe,invoiceValues:Ui,notifications:He,whatsappSettings:At,partyMaster:tn,followups:Yt,userPasswords:_}),console.log("Password saved to Firebase")}catch(U){console.error("Error saving password:",U),T("Failed to save password. Please try again.");return}E(!1),X({currentPassword:"",newPassword:"",confirmPassword:""}),T(""),alert(" Password changed successfully!")},Ci=()=>{Ac(),e(!1),n(null),O("master"),localStorage.removeItem("financeAppLogin")};ve.useEffect(()=>{const h=localStorage.getItem("financeAppLogin");if(h){const{isLoggedIn:_}=JSON.parse(h);_&&Qu()}},[]),ve.useEffect(()=>{if(!t){ma.current&&(ma.current(),ma.current=null);return}return ma.current=FH("indreesh-media",h=>{h&&(console.log("Firebase data received:",{hasMasterData:Array.isArray(h.masterData)?h.masterData.length:"not array",hasServicesData:Array.isArray(h.servicesData)?h.servicesData.length:"not array",servicesDataRaw:h.servicesData,hasReceipts:Array.isArray(h.receipts)?h.receipts.length:"not array",hasCreditNotes:Array.isArray(h.creditNotes)?h.creditNotes.length:"not array"}),Es.current=!0,Array.isArray(h.masterData)&&Pe(h.masterData),Array.isArray(h.servicesData)&&Ae(h.servicesData),Array.isArray(h.ledgerEntries)&&be(h.ledgerEntries),Array.isArray(h.receipts)&&H(h.receipts),Array.isArray(h.creditNotes)&&re(h.creditNotes),Array.isArray(h.notifications)&&at(h.notifications),Array.isArray(h.followups)&&wi(h.followups),h.openingBalances&&typeof h.openingBalances=="object"&&!Array.isArray(h.openingBalances)&&yc(h.openingBalances),h.mailerImages&&typeof h.mailerImages=="object"&&!Array.isArray(h.mailerImages)&&fa(h.mailerImages),h.partyMaster&&typeof h.partyMaster=="object"&&!Array.isArray(h.partyMaster)&&zs(h.partyMaster),h.userPasswords&&typeof h.userPasswords=="object"&&!Array.isArray(h.userPasswords)&&x(h.userPasswords),h.mailerLogo&&ha(h.mailerLogo),h.companyConfig&&R(_=>({..._,...h.companyConfig,name:"Indreesh Media LLP",bank:{...h.companyConfig.bank||_.bank,holder:"Indreesh Media LLP"}})),h.nextInvoiceNo&&Z(h.nextInvoiceNo),h.nextCombineNo&&Et(h.nextCombineNo),h.nextReceiptNo&&yt(h.nextReceiptNo),h.nextCreditNoteNo&&xr(h.nextCreditNoteNo),h.nextServiceInvoiceNo&&_n(h.nextServiceInvoiceNo),h.invoiceValues&&_c(h.invoiceValues),h.whatsappSettings&&ua(_=>({..._,...h.whatsappSettings})),setTimeout(()=>{Es.current=!1},500),console.log("Real-time sync: Data updated from Firebase"))}),()=>{ma.current&&(ma.current(),ma.current=null)}},[t]),ve.useEffect(()=>{if(Ur.length>0){const h=new Set(Ur.map(_=>_.partyName).filter(Boolean));fe(_=>_.size===0||_.size!==h.size?h:_)}},[Ur]);const _r=r==="finance",ii=r==="director",Hs=ve.useMemo(()=>{const h=new Set;return Sn.forEach(_=>{_.partyName&&h.add(_.partyName)}),Object.values(Lt).forEach(_=>{_.partyName&&h.add(_.partyName)}),Gn.forEach(_=>{_.partyName&&h.add(_.partyName)}),Object.keys(ga).forEach(_=>{_&&h.add(_)}),Array.from(h).filter(Boolean).sort()},[Sn,Lt,Gn,ga]),d=ve.useMemo(()=>{const h=[],_=new Set,U=new Set,q=new Set,L=N=>{if(!N)return"";const b=N.toUpperCase().trim();return b.includes("MAHARASHTRA")||b==="MH"||b.includes("MUMBAI")?"MAHARASHTRA":b.includes("DELHI")||b==="DL"||b.includes("NEW DELHI")?"DELHI":b.includes("KARNATAKA")||b==="KA"||b.includes("BANGALORE")||b.includes("BENGALURU")?"KARNATAKA":b.includes("TAMIL")||b==="TN"||b.includes("CHENNAI")?"TAMIL NADU":b.includes("TELANGANA")||b==="TG"||b==="TS"||b.includes("HYDERABAD")?"TELANGANA":b.includes("UTTAR PRADESH")||b==="UP"||b.includes("NOIDA")||b.includes("LUCKNOW")?"UTTAR PRADESH":b.includes("WEST BENGAL")||b==="WB"||b.includes("KOLKATA")?"WEST BENGAL":b.includes("GUJARAT")||b==="GJ"||b.includes("AHMEDABAD")?"GUJARAT":b.includes("RAJASTHAN")||b==="RJ"||b.includes("JAIPUR")?"RAJASTHAN":b.includes("PUNJAB")||b==="PB"?"PUNJAB":b.includes("HARYANA")||b==="HR"||b.includes("GURGAON")||b.includes("GURUGRAM")?"HARYANA":b.includes("MADHYA PRADESH")||b==="MP"||b.includes("BHOPAL")?"MADHYA PRADESH":b.includes("ANDHRA")||b==="AP"?"ANDHRA PRADESH":b.includes("KERALA")||b==="KL"?"KERALA":b.includes("ODISHA")||b.includes("ORISSA")||b==="OR"||b==="OD"?"ODISHA":b.includes("BIHAR")||b==="BR"?"BIHAR":b.includes("JHARKHAND")||b==="JH"?"JHARKHAND":b.includes("ASSAM")||b==="AS"?"ASSAM":b.includes("CHHATTISGARH")||b==="CG"?"CHHATTISGARH":b.includes("GOA")||b==="GA"?"GOA":b.includes("HIMACHAL")||b==="HP"?"HIMACHAL PRADESH":b.includes("JAMMU")||b==="JK"?"JAMMU AND KASHMIR":b.includes("UTTARAKHAND")||b.includes("UTTARANCHAL")||b==="UK"?"UTTARAKHAND":b.includes("CHANDIGARH")?"CHANDIGARH":b},se=(N,b)=>{if(!N)return"";const ie=N.trim().toUpperCase(),J=L(b);for(const[oe,K]of Object.entries(Lt))if(K.clientCode){const ee=(K.partyName||"").trim().toUpperCase(),tt=K.normalizedState||L(K.stateName);if(ee===ie&&tt===J)return K.clientCode}for(const[oe,K]of Object.entries(Lt))if(K.clientCode&&(K.partyName||"").trim().toUpperCase()===ie)return K.clientCode;return""};return Object.entries(Lt).forEach(([N,b])=>{if(b.partyName){const ie=b.normalizedState||L(b.stateName),J=b.partyName.trim().toUpperCase(),oe=`${J}|${ie}`,K=b.clientCode||"";K&&_.has(K)||U.has(oe)||(K&&_.add(K),U.add(oe),q.add(J),h.push({partyName:b.partyName,partyNameUpper:J,state:b.stateName||"",normalizedState:ie,gstin:b.gstin||"",address:b.address||"",clientCode:K,fromPartyMaster:!0}))}}),Sn.forEach(N=>{if(N.partyName){const b=N.partyName.trim().toUpperCase(),ie=L(N.statePartyDetails),J=`${b}|${ie}`,oe=N.clientCode||se(N.partyName,N.statePartyDetails);if(oe&&_.has(oe)||U.has(J))return;oe&&_.add(oe),U.add(J),q.add(b),h.push({partyName:N.partyName,partyNameUpper:b,state:N.statePartyDetails||"",normalizedState:ie,gstin:"",address:"",clientCode:oe,fromPartyMaster:!1})}}),Gn.forEach(N=>{if(N.partyName){const b=N.partyName.trim().toUpperCase(),ie=L(N.state||N.statePartyDetails||""),J=`${b}|${ie}`,oe=se(N.partyName,N.state||N.statePartyDetails);if(oe&&_.has(oe)||U.has(J))return;oe&&_.add(oe),U.add(J),q.add(b),h.push({partyName:N.partyName,partyNameUpper:b,state:N.state||N.statePartyDetails||"",normalizedState:ie,gstin:"",address:"",clientCode:oe,fromPartyMaster:!1})}}),Object.keys(ga).forEach(N=>{const b=N.trim().toUpperCase();if(N&&!q.has(b)){const ie=se(N,"");if(ie&&_.has(ie))return;ie&&_.add(ie),q.add(b),h.push({partyName:N,partyNameUpper:b,state:"",normalizedState:"",gstin:"",address:"",clientCode:ie,fromPartyMaster:!1})}}),Ur.forEach(N=>{if(N.partyName){const b=N.partyName.trim().toUpperCase(),ie=L(N.statePartyDetails),J=`${b}|${ie}`,oe=N.clientCode||se(N.partyName,N.statePartyDetails);if(oe&&_.has(oe)||U.has(J))return;oe&&_.add(oe),U.add(J),q.add(b),h.push({partyName:N.partyName,partyNameUpper:b,state:N.statePartyDetails||"",normalizedState:ie,gstin:N.gstin||"",address:N.address||"",clientCode:oe,fromPartyMaster:!1})}}),h.sort((N,b)=>N.partyName.localeCompare(b.partyName))},[Sn,Ur,Lt,Gn,ga]);ve.useMemo(()=>[...new Set(Sn.filter(_=>_.combinationCode&&_.combinationCode!=="NA").map(_=>_.combinationCode))].sort((_,U)=>parseInt(_)-parseInt(U)),[Sn]);const v=ve.useMemo(()=>Sn.filter(h=>{var _,U,q,L,se,N;if(St.party&&h.partyName!==St.party||St.billStatus&&h.toBeBilled!==St.billStatus||St.invoiceStatus&&(St.invoiceStatus==="Generated"&&!h.invoiceGenerated||St.invoiceStatus==="Not Generated"&&h.invoiceGenerated||St.invoiceStatus==="Paid"&&h.invoiceStatus!=="Paid")||St.mailingStatus&&h.mailingSent!==St.mailingStatus||St.invoiceType&&h.invoiceType!==St.invoiceType||St.combinationCode&&h.combinationCode!==St.combinationCode)return!1;if(St.searchText){const b=St.searchText.toLowerCase();if(!(((_=h.senderName)==null?void 0:_.toLowerCase().includes(b))||((U=h.subject)==null?void 0:U.toLowerCase().includes(b))||((q=h.campaignName)==null?void 0:q.toLowerCase().includes(b))||((L=h.invoiceNo)==null?void 0:L.toLowerCase().includes(b))||((se=h.partyName)==null?void 0:se.toLowerCase().includes(b))||((N=h.emailId)==null?void 0:N.toLowerCase().includes(b))))return!1}return!0}),[Sn,St]);ve.useMemo(()=>{const h={};return v.forEach(_=>{h[_.partyName]||(h[_.partyName]=[]),h[_.partyName].push(_)}),Object.keys(h).forEach(_=>{h[_].sort((U,q)=>U.toBeBilled==="Yes"&&q.toBeBilled!=="Yes"?-1:U.toBeBilled!=="Yes"&&q.toBeBilled==="Yes"?1:0)}),h},[v]),ve.useMemo(()=>{if(!Y)return[];const h=ga[Y]||0;let _=h;const U=Gn.filter(q=>Ht(q.partyName,Y)).sort((q,L)=>new Date(q.date)-new Date(L.date)).map(q=>(_=_+q.debit-q.credit,{...q,balance:_}));return h!==0?[{id:"opening",date:"",particulars:"Opening Balance",debit:h>0?h:0,credit:h<0?Math.abs(h):0,balance:h,isOpening:!0},...U]:U},[Y,Gn,ga]);const k=h=>Sn.filter(_=>Ht(_.partyName,h)&&_.toBeBilled==="Yes"&&!_.invoiceGenerated&&_.invoiceAmount),B=h=>!h||h==="NA"?!1:Sn.some(_=>_.combinationCode===h&&_.mailingSent==="Yes"),ce=h=>h.invoiceType==="Combined"&&h.combinationCode!=="NA"?Sn.filter(_=>_.combinationCode===h.combinationCode):[h],me=()=>{Al({party:"",billStatus:"",invoiceStatus:"",mailingStatus:"",invoiceType:"",combinationCode:"",searchText:""})},$e=Object.values(St).some(h=>h!==""),Jt=h=>{const _=[];return h.emailId&&_.push(h.emailId),h.additionalEmails&&h.additionalEmails.length>0&&_.push(...h.additionalEmails),_},wn=(h,_)=>{!_||!_.includes("@")||Pe(U=>U.map(q=>{if(q.id===h){const L=q.additionalEmails||[];if(!L.includes(_)&&_!==q.emailId)return{...q,additionalEmails:[...L,_]}}return q}))},qt=(h,_)=>{Pe(U=>U.map(q=>q.id===h?{...q,additionalEmails:(q.additionalEmails||[]).filter(L=>L!==_)}:q))},Tn=h=>{rr(h),Or(h.editComments||h.approvalRemarks||""),Ti({particularsApproved:h.particularsApproved||!1,emailApproved:h.emailApproved||!1,invoiceTypeApproved:h.invoiceTypeApproved||!1}),Rn(!0)},Pn=()=>{if(!le)return;if(!yo.particularsApproved||!yo.emailApproved||!yo.invoiceTypeApproved){alert("Please confirm all approval checkboxes before approving.");return}const h={invoiceStatus:"Approved",approvalRemarks:la.trim()||"",editComments:"",particularsApproved:!0,emailApproved:!0,invoiceTypeApproved:!0,approvedBy:r,approvedDate:new Date().toISOString()};if(le.isService){Ae(L=>L.map(se=>se.id===le.id?{...se,...h}:se));const U=parseFloat(le.invoiceTotalAmount)||0,q=`${le.invoiceNo} - ${le.serviceType||"Service"}`;be(L=>[...L,{id:Date.now(),partyName:le.partyName,date:le.invoiceDate,particulars:le.serviceType||"Service",narration:q,debit:U,credit:0,type:"invoice",invoiceNo:le.invoiceNo}])}else{let U=[];le.invoiceType==="Combined"&&le.combinationCode!=="NA"?(U=Ee.filter(N=>N.combinationCode===le.combinationCode),Pe(N=>N.map(b=>b.combinationCode===le.combinationCode?{...b,...h}:b))):(U=[le],Pe(N=>N.map(b=>b.id===le.id?{...b,...h}:b)));const q=parseFloat(le.invoiceTotalAmount)||0,L=U.map(N=>{var b,ie;return N.senderName||((ie=(b=N.campaignName)==null?void 0:b.split("--")[0])==null?void 0:ie.trim())}).join(", "),se=`${le.invoiceNo} - ${L}`;be(N=>[...N,{id:Date.now(),partyName:le.partyName,date:le.invoiceDate,particulars:"Promotional Trade Mailer",narration:se,debit:q,credit:0,type:"invoice",invoiceNo:le.invoiceNo,combinationCode:le.combinationCode}])}const _=la.trim()?` | Remarks: "${la.trim()}"`:"";es("approval",` Invoice ${le.invoiceNo} has been APPROVED by Director${_} - ready for mailing`,"finance"),Rn(!1),rr(null),Ti({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1}),Or(""),alert(` Invoice Approved!

The invoice is now ready for mailing.`)},bo=()=>{if(!le)return;const h=la.trim();le.isService?Ae(U=>U.map(q=>q.id===le.id?{...q,invoiceStatus:"Need Edits",editComments:h,approvalRemarks:""}:q)):le.invoiceType==="Combined"&&le.combinationCode!=="NA"?Pe(U=>U.map(q=>q.combinationCode===le.combinationCode?{...q,invoiceStatus:"Need Edits",editComments:h,approvalRemarks:""}:q)):Pe(U=>U.map(q=>q.id===le.id?{...q,invoiceStatus:"Need Edits",editComments:h,approvalRemarks:""}:q));const _=h?`: "${h}"`:"";es("edit",` Invoice ${le.invoiceNo} marked as NEED EDITS by Director${_}`,"finance"),Rn(!1),rr(null),Or("")},Vi=h=>{rr(h);const _=parseFloat(h.invoiceTotalAmount)||0;Ji({amount:_.toFixed(2),tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),ms(!0)},Cc=()=>{if(!le||!Xt.amount){alert("Please enter receipt amount");return}if(le.invoiceStatus!=="Approved"){alert("Receipt cannot be posted. Invoice must be approved first.");return}if(!le.isHistorical&&le.mailingSent!=="Yes"){alert("Receipt cannot be posted. Invoice must be mailed first.");return}const h=`RCP/${new Date().getFullYear()}-${String(new Date().getFullYear()+1).slice(-2)}/${Dt}`,_=parseFloat(Xt.amount)||0,U=parseFloat(Xt.tds)||0,q=parseFloat(Xt.discount)||0,L=_+U+q,se=ce(le),N=se.map(Se=>Se.subject||Se.senderName).join(", "),b=N.length>50?N.substring(0,47)+"...":N,ie={id:Date.now(),receiptNo:h,invoiceNo:le.invoiceNo,partyName:le.partyName,date:Xt.date,amount:_,tds:U,discount:q,totalCredit:L,narration:Xt.narration,paymentAdvisory:Xt.paymentAdvisory,mode:Xt.mode,campaigns:se.map(Se=>({senderName:Se.senderName,subject:Se.subject}))};H(Se=>[...Se,ie]);const J=Xt.narration||b;_>0&&be(Se=>[...Se,{id:Date.now(),partyName:le.partyName,date:Xt.date,particulars:`Payment Received - ${J}`,narration:`${le.invoiceNo} | ${Xt.mode}`,debit:0,credit:_,type:"receipt",receiptNo:h,invoiceNo:le.invoiceNo,paymentAdvisory:Xt.paymentAdvisory}]),U>0&&be(Se=>[...Se,{id:Date.now()+1,partyName:le.partyName,date:Xt.date,particulars:"TDS Deducted",narration:`Against ${le.invoiceNo}`,debit:0,credit:U,type:"tds",receiptNo:h,invoiceNo:le.invoiceNo}]),q>0&&be(Se=>[...Se,{id:Date.now()+2,partyName:le.partyName,date:Xt.date,particulars:"Discount Given",narration:`Against ${le.invoiceNo}`,debit:0,credit:q,type:"discount",receiptNo:h,invoiceNo:le.invoiceNo}]);const oe=parseFloat(le.invoiceTotalAmount)||0,K=te.find(Se=>Se.invoiceNo===le.invoiceNo),ee=K?Math.abs(parseFloat(K.totalAmount)||0):0,ae=oe-L-ee<=0;le.invoiceType==="Combined"&&le.combinationCode!=="NA"?Pe(Se=>Se.map(Ce=>Ce.combinationCode===le.combinationCode?{...Ce,receiptStatus:ae?"Closed":"Received",receiptNo:h,receiptDate:Xt.date}:Ce)):le.isHistorical||Pe(Se=>Se.map(Ce=>Ce.id===le.id?{...Ce,receiptStatus:ae?"Closed":"Received",receiptNo:h,receiptDate:Xt.date}:Ce)),yt(Se=>Se+1),es("receipt",` Payment received for ${le.partyName} - Receipt ${h} - ${nt(L)}`,"director"),ms(!1),rr(null),Ji({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),alert(` Receipt Created!

Receipt No: ${h}
Amount: ${nt(L)}`)},kc=h=>{rr(h),da({amount:"",tds:"",discount:"",reason:"",date:new Date().toISOString().split("T")[0]}),aa(!0)},JF=()=>{var Se;if(!le||!fn.amount&&!fn.gst||!fn.reason){alert("Please enter Amount and/or GST and reason");return}const h=le.invoiceNo.match(/(\d{4}-\d{2})/),_=h?h[1]:`${new Date().getFullYear()}-${String(new Date().getFullYear()+1).slice(-2)}`,U=le.invoiceNo.split("/").pop(),q=`CN/${_}/${U}`,L=parseFloat(fn.amount)||0,se=parseFloat(fn.gst)||0,N=L+se,ie=((Se=le.statePartyDetails)==null?void 0:Se.toUpperCase().includes("MAHARASHTRA"))?"CGST/SGST":"IGST",J={id:Date.now(),creditNoteNo:q,invoiceNo:le.invoiceNo,partyName:le.partyName,date:fn.date,amount:L,gst:se,gstType:ie,totalAmount:N,reason:fn.reason};re(Ce=>[...Ce,J]);const oe=parseFloat(le.invoiceTotalAmount)||0,K=je.find(Ce=>Ce.invoiceNo===le.invoiceNo),ee=K?parseFloat(K.amount)+parseFloat(K.tds||0)+parseFloat(K.discount||0):0,tt=N>=oe-ee;le.isHistorical||Pe(Ce=>Ce.map(Be=>Be.invoiceNo===le.invoiceNo?{...Be,creditNoteNo:q,receiptStatus:tt?"Cancelled":Be.receiptStatus}:Be)),xr(Ce=>Ce+1),aa(!1),rr(null),da({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]});let ae=` Credit Note Created!

Credit Note No: ${q}`;L>0&&(ae+=`
Base Amount: ${nt(L)}`),se>0&&(ae+=`
${ie}: ${nt(se)}`),ae+=`
Total: ${nt(N)}`,tt&&(ae+=`

 Invoice fully covered by CN - marked as Cancelled`),alert(ae)},ZF=h=>{var q;const _=(q=h.target.files)==null?void 0:q[0];if(!_)return;const U=new FileReader;U.onload=L=>{Ji(se=>({...se,paymentAdvisory:L.target.result}))},U.readAsDataURL(_),h.target.value=""},fg=h=>{rr(h),vo(!0)},e4=()=>{if(!le)return;const h=le.invoiceNo;le.invoiceType==="Combined"&&le.combinationCode!=="NA"?Pe(q=>q.map(L=>L.combinationCode===le.combinationCode?{...L,invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",invoiceType:"Individual",combinationCode:"NA",mailingSent:"No",mailDate:"",editComments:"",receiptStatus:"",receiptNo:"",receiptDate:""}:L)):Pe(q=>q.map(L=>L.id===le.id?{...L,invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",invoiceType:"Individual",combinationCode:"NA",mailingSent:"No",mailDate:"",editComments:"",receiptStatus:"",receiptNo:"",receiptDate:""}:L)),be(q=>q.filter(L=>L.invoiceNo!==h));const _=je.filter(q=>q.invoiceNo===h);_.length>0&&H(q=>q.filter(L=>L.invoiceNo!==h)),vo(!1),rr(null);const U=_.length>0?`
${_.length} receipt(s) also deleted.`:"";alert(` Invoice ${h} deleted.${U}

You can now regenerate the invoice.`)},t4=h=>{confirm(`Delete Receipt ${h.receiptNo}?

This will also update the invoice status back to Pending.`)&&(H(_=>_.filter(U=>U.id!==h.id)),Pe(_=>_.map(U=>U.invoiceNo===h.invoiceNo?{...U,receiptStatus:"",receiptNo:"",receiptDate:""}:U)),alert(` Receipt ${h.receiptNo} deleted.`))},r4=h=>{confirm(`Delete Credit Note ${h.creditNoteNo}?

This will remove the CN association from the invoice.`)&&(re(_=>_.filter(U=>U.id!==h.id)),Pe(_=>_.map(U=>U.invoiceNo===h.invoiceNo?{...U,creditNoteNo:""}:U)),alert(` Credit Note ${h.creditNoteNo} deleted.`))},n4=h=>{confirm(`Delete historical entry?

Vch No: ${h.vchNo||"N/A"}
Amount: ${h.debit||h.credit}

This action cannot be undone.`)&&(be(_=>_.filter(U=>U.id!==h.id)),alert(" Historical entry deleted."))},i4=()=>{if(!Y||!confirm(`Delete ALL historical entries for "${Y}"?

This will remove all imported historical data for this party.`))return;const h=ne.filter(_=>Ht(_.partyName,Y)&&_.isHistorical).length;be(_=>_.filter(U=>!(Ht(U.partyName,Y)&&U.isHistorical))),alert(` ${h} historical entries deleted for ${Y}.`)},s4=h=>{ca(h),Ua({date:new Date().toISOString().split("T")[0],notes:"",nextFollowupDate:"",status:"Pending"}),Qi(!0)},a4=()=>{var _,U;if(!ar)return;const h={id:Date.now(),invoiceNo:ar.invoiceNo,partyName:ar.partyName,invoiceDate:ar.invoiceDate||ar.date,invoiceAmount:ar.invoiceTotalAmount||ar.totalAmount,subject:((U=(_=ar.campaigns)==null?void 0:_[0])==null?void 0:U.subject)||ar.subject||"",followupDate:Sr.date,notes:Sr.notes,nextFollowupDate:Sr.nextFollowupDate,status:Sr.status};wi(q=>[...q,h]),Qi(!1),ca(null),es("followup",`Followup added for ${ar.invoiceNo}`,"all"),alert(` Followup recorded for ${ar.invoiceNo}`)},o4=h=>{confirm("Delete this followup entry?")&&wi(_=>_.filter(U=>U.id!==h))},l4=h=>{var b,ie;const _=h.subject||((ie=(b=h.campaigns)==null?void 0:b[0])==null?void 0:ie.subject)||"",U=h.partyName,q=h.invoiceNo,L=nt(h.invoiceTotalAmount||h.totalAmount||0),se=_t(h.invoiceDate||h.date);return`Subject: RE: ${_} - Payment Followup for Invoice ${q}

Dear Sir/Madam,

Greetings from ${w.name}!

This is a gentle reminder regarding the outstanding payment for:

Invoice No: ${q}
Invoice Date: ${se}
Amount: ${L}
Party: ${U}

We kindly request you to process the payment at the earliest. If the payment has already been made, please share the payment details for our records.

For any queries, please feel free to reach out.

Thanks & Regards,
Finance Team
${w.name}
Email: ${w.email}
Phone: ${w.phone}`},my=h=>{const _=l4(h);navigator.clipboard.writeText(_),alert(" Followup email template copied to clipboard!")},xy=h=>{var q,L;const _=h.subject||((L=(q=h.campaigns)==null?void 0:q[0])==null?void 0:L.subject)||"",U=encodeURIComponent(_);window.open(`https://mail.google.com/mail/u/0/#search/${U}`,"_blank")},c4=h=>{var q;const _=(q=h.target.files)==null?void 0:q[0];if(!_)return;const U=new FileReader;U.onload=L=>{const se=Dl(L.target.result,{type:"binary"}),N=se.SheetNames[0],b=se.Sheets[N],ie=Er.sheet_to_json(b),J={};ie.forEach(oe=>{const K=oe["Party Name"]||oe["PARTY NAME"]||oe.PartyName||"",ee=parseFloat(oe.Amount||oe.AMOUNT||oe["Invoice Amount"]||0);K&&ee>0&&(J[K.trim()]=ee)}),_c(oe=>({...oe,...J})),alert(` Loaded ${Object.keys(J).length} party invoice values!`)},U.readAsBinaryString(_),h.target.value=""},u4=()=>{const h=Er.json_to_sheet([{"Party Name":"ABC Group Private Limited",Amount:5500},{"Party Name":"XYZ Media Pvt Ltd",Amount:7500}]),_=Er.book_new();Er.book_append_sheet(_,h,"Invoice Values"),Dc(_,"Invoice_Values_Template.xlsx")},d4=h=>{var q;const _=(q=h.target.files)==null?void 0:q[0];if(!_)return;const U=new FileReader;U.onload=L=>{const se=Dl(L.target.result,{type:"binary"}),N=se.SheetNames[0],b=se.Sheets[N],ie=Er.sheet_to_json(b),J={...tn};let oe=0;ie.forEach(K=>{const ee=(K["Name of Ledger"]||K["Party Name"]||K["NAME OF LEDGER"]||K["PARTY NAME"]||"").trim(),tt=(K["State Name"]||K["STATE NAME"]||K.State||K.STATE||"").trim(),ae=(K.Address||K.ADDRESS||K["Party Address"]||K["PARTY ADDRESS"]||"").trim(),Se=(K["Client Code"]||K["CLIENT CODE"]||K.Code||K.CODE||"").toString().trim();if(ee){const Ce=ni(tt),Be=Se||`${ee.toUpperCase()}|${Ce}`;J[Be]={clientCode:Se,partyName:ee,partyNameUpper:ee.toUpperCase(),ledgerGroup:K["Ledger Group"]||K["LEDGER GROUP"]||"Sundry Debtors",stateName:tt,normalizedState:Ce,gstRegType:K["GST Registration Type"]||K["GST REGISTRATION TYPE"]||"Regular",gstin:(K["GSTIN/UIN"]||K.GSTIN||K.GST||"").trim(),address:ae},oe++}}),zs(J),alert(` Party Master Updated!

${oe} party-state combinations loaded.`)},U.readAsBinaryString(_),h.target.value=""},f4=()=>{const h=Er.json_to_sheet([{"Sl. No.":1,"Client Code":"1.01","Name of Ledger":"ABC PRIVATE LIMITED",Address:"123 Business Park, Andheri East","Ledger Group":"Sundry Debtors","State Name":"Maharashtra","GST Registration Type":"Regular","GSTIN/UIN":"27AAACA1234A1ZQ"},{"Sl. No.":2,"Client Code":"1.02","Name of Ledger":"ABC PRIVATE LIMITED",Address:"456 Tech Hub, Noida","Ledger Group":"Sundry Debtors","State Name":"Uttar Pradesh","GST Registration Type":"Regular","GSTIN/UIN":"09AAACA1234A1ZS"},{"Sl. No.":3,"Client Code":"2.01","Name of Ledger":"XYZ MEDIA PVT LTD",Address:"789 Media Tower, Connaught Place","Ledger Group":"Sundry Debtors","State Name":"Delhi","GST Registration Type":"Regular","GSTIN/UIN":"07AAACX5678B1ZR"}]),_=Er.book_new();Er.book_append_sheet(_,h,"Party Master"),Dc(_,"Party_Master_Template.xlsx")},h4=h=>{var q;const _=(q=h.target.files)==null?void 0:q[0];if(!_)return;if(!Y){alert(" Please select a party first from the list, then import their historical ledger."),h.target.value="";return}const U=new FileReader;U.onload=L=>{const se=Dl(L.target.result,{type:"binary",cellDates:!0}),N=se.SheetNames[0],b=se.Sheets[N],ie=Er.sheet_to_json(b,{raw:!1}),J=[];let oe=0,K=null;const ee=ae=>{if(!ae)return 0;const Se=String(ae).replace(/,/g,"").replace(/[^\d.-]/g,"");return parseFloat(Se)||0},tt=ae=>{if(!ae||typeof ae!="string")return"";const Se=ae.trim(),Ce=Se.split(/[-\/]/);if(Ce.length===3){const Be={jan:"01",feb:"02",mar:"03",apr:"04",may:"05",jun:"06",jul:"07",aug:"08",sep:"09",oct:"10",nov:"11",dec:"12"},Qe=Ce[1].toLowerCase().substring(0,3);if(Be[Qe]){const Je=Ce[0].padStart(2,"0");return`${Ce[2].length===2?parseInt(Ce[2])>50?"19"+Ce[2]:"20"+Ce[2]:Ce[2]}-${Be[Qe]}-${Je}`}}return Se};ie.forEach((ae,Se)=>{const Ce=tt(ae.Date||ae.DATE||ae.date||""),Be=(ae.Particular||ae.PARTICULAR||ae.Particulars||ae.PARTICULARS||"").trim(),Qe=(ae["Vch Type"]||ae["VCH TYPE"]||ae["Voucher Type"]||ae["vch type"]||"").trim(),Je=(ae["Vch No."]||ae["VCH NO."]||ae["Voucher No"]||ae["Invoice No"]||ae["Vch No"]||ae["vch no."]||"").trim(),rt=ee(ae.Debit||ae.DEBIT||ae.debit),kt=ee(ae.Credit||ae.CREDIT||ae.credit),$t=ae["Date of Receipt"]||ae["DATE OF RECEIPT"]||ae["Receipt Date"]||"",ze=ee(ae["Amount Received"]||ae["AMOUNT RECEIVED"]||ae["amount received"]),ct=ee(ae["TDS amount Received"]||ae["TDS Received"]||ae.TDS||ae.tds),zt=ee(ae.Balance||ae.BALANCE||ae.balance),Pt=(ae["Payment Status"]||ae["PAYMENT STATUS"]||ae.Status||ae.status||"").trim();if(!Ce&&(Be.toUpperCase().includes("PROMOTIONAL")||Be.toUpperCase().includes("IGST")||Be.toUpperCase().includes("CGST")||Be.toUpperCase().includes("SGST")||Be.toUpperCase().includes("TRADE EMAILER"))&&K)K.subRows||(K.subRows=[]),K.subRows.push({particular:Be,debit:rt,credit:kt});else if(Ce&&(Je||rt>0||kt>0)){K&&(J.push(K),oe++);let de="invoice";Qe.toLowerCase().includes("credit note")||Je.toUpperCase().startsWith("CN")?de="creditnote":Qe.toLowerCase().includes("receipt")?de="receipt":(Qe.toLowerCase().includes("sale")||rt>0)&&(de="invoice"),K={id:Date.now()+Se,partyName:Y,date:Ce,particulars:Be||Y,narration:Je,vchType:Qe||"Sales",vchNo:Je,debit:rt,credit:kt,receiptDate:$t,amountReceived:ze,tdsReceived:ct,balance:zt,paymentStatus:Pt,type:de,isHistorical:!0,subRows:[]}}}),K&&(J.push(K),oe++),console.log("Parsed entries with sub-rows:",J),oe>0?(be(ae=>[...ae,...J]),alert(` Historical Ledger Uploaded!

${oe} entries added for "${Y}".`)):alert(` No valid ledger entries found in the file.

Make sure your file has these columns:
 Date (e.g., 02-Jun-21)
 Vch Type (e.g., Sales, Credit Note)
 Vch No. (e.g., MB/2022-23/128)
 Debit or Credit amount`)},U.readAsBinaryString(_),h.target.value="",Ec(!1)},p4=()=>{const h=Er.json_to_sheet([{Date:"02-Jun-21",Particular:"ABC Corp Ltd.","Vch Type":"Sales","Vch No.":"MB/2020-21/0411",Debit:6e3,Credit:"","Date of Receipt":"","Amount Received":44371,"TDS amount Received":5880,Balance:"","Payment Status":"Received"},{Date:"",Particular:"PROMOTIONAL TRADE EMAILERS","Vch Type":"","Vch No.":"",Debit:"",Credit:22500,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""},{Date:"",Particular:"IGST","Vch Type":"","Vch No.":"",Debit:"",Credit:4050,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""},{Date:"26-Mar-25",Particular:"ABC Corp Ltd.","Vch Type":"Credit Note","Vch No.":"CN/2022-23/128",Debit:"",Credit:26550,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""}]),_=Er.book_new();Er.book_append_sheet(_,h,"Historical Ledger"),Dc(_,"Historical_Ledger_Template.xlsx")},g4=h=>{const _=Ee.find(q=>q.invoiceNo===h);if(_){ed(_);return}const U=Fe.find(q=>q.invoiceNo===h);if(U){pg(U);return}alert("Invoice not found in system. This may be a historical entry.")},m4=h=>{Ee.find(U=>U.invoiceNo===h.invoiceNo);let _=` RECEIPT DETAILS

`;_+=`Receipt No: ${h.receiptNo}
`,_+=`Date: ${_t(h.date)}
`,_+=`Party: ${h.partyName}
`,_+=`Invoice: ${h.invoiceNo}

`,_+=`
`,_+=`Amount Received: ${nt(h.amount||0)}
`,_+=`TDS: ${nt(h.tds||0)}
`,_+=`Discount: ${nt(h.discount||0)}
`,_+=`
`,_+=`Total: ${nt((h.amount||0)+(h.tds||0)+(h.discount||0))}
`,h.remarks&&(_+=`
Remarks: ${h.remarks}`),alert(_)},x4=h=>{let _=` CREDIT NOTE DETAILS

`;_+=`Credit Note No: ${h.creditNoteNo}
`,_+=`Date: ${_t(h.date)}
`,_+=`Party: ${h.partyName}
`,_+=`Against Invoice: ${h.invoiceNo}

`,_+=`
`,_+=`Base Amount: ${nt(h.amount||0)}
`,_+=`${h.gstType||"GST"}: ${nt(h.gst||0)}
`,_+=`
`,_+=`Total Credit: ${nt(h.totalAmount||(h.amount||0)+(h.gst||0))}
`,h.reason&&(_+=`
Reason: ${h.reason}`),alert(_)},v4=h=>{var q;const _=(q=h.target.files)==null?void 0:q[0];if(!_)return;const U=new FileReader;U.onload=L=>{const se=Dl(L.target.result,{type:"binary",cellDates:!0}),N=se.SheetNames[0],b=se.Sheets[N],ie=Er.sheet_to_json(b,{raw:!1}),J=new Set(Sn.map(ae=>`${ae.date}|${ae.time||""}|${ae.campaignName||""}|${ae.subject}`.toLowerCase()));let oe=0,K=0;const ee=ie.map((ae,Se)=>{const Ce=ae["CAMPAIGN NAME"]||ae["Campaign Name"]||"",Be=IH(Ce);let Qe=ae.DATE||ae.Date||new Date;typeof Qe=="string"&&(Qe=new Date(Qe));const Je=(ae["PARTY NAME"]||ae["Party Name"]||"").trim(),rt=ae["SENDER NAME"]||ae["Sender Name"]||"",kt=ae.SUBJECT||ae.Subject||"",$t=ae.TIME||ae.Time||"",ze=ae["State/Party Details"]||ae["STATE/PARTY DETAILS"]||ae.STATE||ae.State||"",ct=Ui[Je]||"",zt=Qe instanceof Date&&!isNaN(Qe)?Qe.toISOString().split("T")[0]:"",ge=(ae["Client Code"]||ae["CLIENT CODE"]||ae.Code||"").toString().trim()||rn(Je,ze),de=ae["PO?"]||ae.PO||ae["WITH PO"]||"",Ie=de.toLowerCase().includes("with po")||de.toLowerCase()==="yes",gt=ae["PO Number"]||ae["PO NUMBER"]||ae["PO No"]||ae["PO NO"]||"";let ut=ae["PO Date"]||ae["PO DATE"]||"";typeof ut=="object"&&ut instanceof Date&&(ut=ut.toISOString().split("T")[0]);const dt=`${zt}|${$t}|${Ce}|${kt}`.toLowerCase();return J.has(dt)?(oe++,null):(J.add(dt),K++,{id:Date.now()+Se+Math.random(),sno:ae.SNO||ae["SNO."]||ae.Sno||Se+1,date:zt,month:ae.Month||ae.MONTH||"",time:$t,statePartyDetails:ze,partyName:Je,clientCode:ge,senderName:rt,campaignName:Ce,subject:kt,emailId:Be,additionalEmails:[],toBeBilled:"Not Yet",invoiceAmount:ct,cgst:"",sgst:"",igst:"",totalWithGst:"",invoiceType:"Individual",combinationCode:"NA",invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",mailingSent:"No",mailerUploaded:!1,editComments:"",poStatus:Ie?"With PO":"Without PO",poNumber:Ie?gt:"",poDate:Ie?ut:""})}).filter(ae=>ae!==null);if(ee.length>0){Pe(Se=>[...Se,...ee]);const ae=[...new Set(ee.map(Se=>Se.partyName))];_s(Se=>{const Ce=new Set(Se);return ae.forEach(Be=>Ce.add(Be)),Ce})}let tt=` Upload Complete!

`;tt+=` ${K} new campaigns added
`,oe>0&&(tt+=` ${oe} duplicate entries skipped`),K>0&&es("upload",` ${K} new campaigns uploaded to Master Sheet`,"director"),alert(tt)},U.readAsBinaryString(_),h.target.value=""},y4=async()=>{Pe([]),Ae([]),be([]),H([]),re([]),fa({}),yc({}),Z(1),Et(1),yt(1),xr(1),_n(1),ye(null),Ve(null),Ne(null),_s(new Set),wi([]),zs({}),at([]);try{await md("indreesh-media",{masterData:[],servicesData:[],ledgerEntries:[],receipts:[],creditNotes:[],openingBalances:{},mailerImages:{},mailerLogo:Hn,companyConfig:w,nextInvoiceNo:1,nextCombineNo:1,nextReceiptNo:1,nextCreditNoteNo:1,nextServiceInvoiceNo:1,invoiceValues:Ui,notifications:[],whatsappSettings:At,partyMaster:{},followups:[],userPasswords:y}),console.log("Data cleared and saved to Firebase")}catch(h){console.error("Error clearing data:",h)}Us(!1),alert(" All master data, invoices, receipts, and ledger entries have been cleared!")},vy=h=>{var q;const _=parseFloat(h.invoiceAmount)||0;if((q=h.statePartyDetails)==null?void 0:q.toUpperCase().includes("MAHARASHTRA")){const L=_*.09,se=_*.09;return{cgst:L,sgst:se,igst:0,total:_+L+se}}else{const L=_*.18;return{cgst:0,sgst:0,igst:L,total:_+L}}},_4=(h,_)=>{const U=Ee.find(q=>q.id===h);Pe(q=>q.map(L=>{if(L.id===h){if(_==="Yes"&&L.invoiceAmount){const se=vy(L);return{...L,toBeBilled:_,cgst:se.cgst.toFixed(2),sgst:se.sgst.toFixed(2),igst:se.igst.toFixed(2),totalWithGst:se.total.toFixed(2)}}return{...L,toBeBilled:_}}return L})),_==="Yes"&&U&&es("info",` Campaign marked for billing: ${U.partyName} - ${U.senderName}`,"finance")},h0=(h,_,U)=>{Pe(q=>q.map(L=>{if(L.id===h){const se={...L,[_]:U};if(_==="invoiceAmount"&&L.toBeBilled==="Yes"){const N=vy(se);return{...se,cgst:N.cgst.toFixed(2),sgst:N.sgst.toFixed(2),igst:N.igst.toFixed(2),totalWithGst:N.total.toFixed(2)}}return se}return L}))},E4=h=>{const _=`${w.invoicePrefix}${it}`,U=new Date().toISOString().split("T")[0],q=parseFloat(h.totalWithGst)||parseFloat(h.invoiceAmount)*1.18;Pe(L=>L.map(se=>se.id===h.id?{...se,invoiceNo:_,invoiceDate:U,invoiceTotalAmount:q.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created",invoiceType:"Individual",combinationCode:"NA"}:se)),Z(L=>L+1),es("invoice",` New Invoice ${_} created for ${h.partyName} - ${nt(q)}`,"director"),alert(` Invoice Generated!

Invoice No: ${_}
Amount: ${nt(q)}

Please review and Approve or mark as Need Edits.`)},S4=()=>{if(Li.size<2){alert("Please select at least 2 campaigns to combine");return}const h=`${w.invoicePrefix}${it}`,_=new Date().toISOString().split("T")[0],U=String(Rt);let q=0;const L=Ee.filter(se=>Li.has(se.id));L.forEach(se=>{q+=parseFloat(se.totalWithGst)||parseFloat(se.invoiceAmount)*1.18}),Pe(se=>se.map(N=>Li.has(N.id)?{...N,invoiceNo:h,invoiceDate:_,invoiceTotalAmount:q.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created",invoiceType:"Combined",combinationCode:U,mailingSent:"No"}:N)),Z(se=>se+1),Et(se=>se+1),mt(!1),Eo(new Set),es("invoice",` Combined Invoice ${h} created for ${ji} (${L.length} campaigns) - ${nt(q)}`,"director"),_o(null),alert(` Combined Invoice Generated!

Invoice No: ${h}
Campaigns: ${Li.size}
Total: ${nt(q)}

Please review and Approve or mark as Need Edits.`)},w4=h=>{Eo(_=>{const U=new Set(_);return U.has(h)?U.delete(h):U.add(h),U})},T4=h=>{_o(h.partyName),Eo(new Set([h.id])),mt(!0)},A4=h=>{var q;const _=(q=h.target.files)==null?void 0:q[0];if(!_||!le)return;const U=new FileReader;U.onload=L=>yy(L.target.result),U.readAsDataURL(_),h.target.value=""},yy=h=>{if(!le)return;const _=le.id;fa(Ku?U=>({...U,[_]:[h]}):U=>({...U,[_]:[...U[_]||[],h]})),Pe(U=>U.map(q=>q.id===le.id?{...q,mailerUploaded:!0}:q)),Vs(null),wo(!1),Oi(!1),alert(" Mailer image saved!")},C4=h=>{var U;const _=(U=h.clipboardData)==null?void 0:U.items;if(_){for(let q=0;q<_.length;q++)if(_[q].type.indexOf("image")!==-1){const L=_[q].getAsFile(),se=new FileReader;se.onload=N=>Vs(N.target.result),se.readAsDataURL(L),h.preventDefault();break}}},k4=h=>{const _=encodeURIComponent(h||"campaign");window.open(`https://mail.google.com/mail/u/0/#search/${_}`,"_blank")},F4=h=>{var q;const _=(q=h.target.files)==null?void 0:q[0];if(!_)return;const U=new FileReader;U.onload=L=>ha(L.target.result),U.readAsDataURL(_),h.target.value=""},_y=h=>{const _=ce(h);if(_.length>1){const U=_.map(q=>q.senderName).join(", ");return`Invoice ${h.invoiceNo||""} - ${U}`}return`Invoice ${h.invoiceNo||""} - ${h.senderName} - ${h.subject}`},p0=h=>{const _=ce(h),U=parseFloat(h.invoiceTotalAmount)||parseFloat(h.totalWithGst)||parseFloat(h.invoiceAmount)*1.18;let q="";return _.length>1?(q=`Campaigns included in this invoice:
`,_.forEach((L,se)=>{q+=`${se+1}. ${L.senderName} - ${L.subject}
`})):q=`Campaign: ${h.senderName}
Subject: ${h.subject}`,`Dear Sir/Madam,

Please find attached the invoice for the following:

${q}

Invoice No: ${h.invoiceNo||"To be generated"}
Invoice Amount: ${nt(U)}

Kindly process the payment at your earliest convenience.

Bank Details:
Bank: ${w.bank.name}
A/C No: ${w.bank.account}
IFSC: ${w.bank.ifsc}
Branch: ${w.bank.branch}

Thank you for your business.

Best Regards,
${w.name}
${w.email}`},[b4,Ey]=ve.useState(!1),[Sy,wy]=ve.useState(""),Ty=h=>{var ae;let _=[h],U=parseFloat(h.invoiceAmount)||0;h.invoiceType==="Combined"&&h.combinationCode!=="NA"&&(_=Ee.filter(Se=>Se.combinationCode===h.combinationCode),U=_.reduce((Se,Ce)=>Se+(parseFloat(Ce.invoiceAmount)||0),0));const q=Co(h.partyName,h.statePartyDetails),L=Tc(h.partyName,h.statePartyDetails),se=(ae=h.statePartyDetails)==null?void 0:ae.toUpperCase().includes("MAHARASHTRA"),N=se?U*.09:0,b=se?U*.09:0,ie=se?0:U*.18,J=N+b+ie,oe=U+J,K=_.map((Se,Ce)=>`
      <tr>
        <td style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px;">${Ce+1}</td>
        <td style="border: 1px solid #000; padding: 8px; font-size: 12px;">
          <div style="font-weight: 600;">PROMOTIONAL TRADE EMAILER</div>
          <div style="font-style: italic; color: #555; font-size: 11px; margin-top: 2px;">${Se.senderName||""} - ${_t(Se.date)}</div>
          <div style="font-style: italic; color: #555; font-size: 11px;">Subject: ${Se.subject||""}</div>
        </td>
        <td style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px;">${w.hsnCode}</td>
        <td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${Ot(parseFloat(Se.invoiceAmount)||0)}</td>
      </tr>
    `).join("");let ee=[];h.invoiceType==="Combined"&&h.combinationCode!=="NA"?_.forEach(Se=>{(Ct[Se.id]||[]).forEach(Be=>ee.push({img:Be,campaign:Se}))}):(Ct[h.id]||[]).forEach(Ce=>ee.push({img:Ce,campaign:h}));const tt=ee.map(({img:Se,campaign:Ce})=>`
      <div class="page-break-before" style="page-break-before: always; padding: 40px; text-align: center; background: white;">
        ${Hn?`<div style="margin-bottom: 20px;"><img src="${Hn}" alt="Logo" style="max-height: 70px;" /></div>`:`
          <div style="text-align: center; margin-bottom: 25px;">
            <span style="font-size: 22px; font-weight: bold; color: #2874A6;">${w.name}</span>
          </div>
        `}
        <h2 style="font-size: 20px; text-decoration: underline; margin: 25px 0;">MAILER SUPPORTING</h2>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>MAILER DATE:</strong> ${bH(Ce.date)}</p>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>CAMPAIGN:</strong> ${Ce.senderName}</p>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>SUBJECT:</strong> ${Ce.subject||"Campaign"}</p>
        <div style="margin-top: 25px;"><img src="${Se}" alt="Mailer" style="max-width: 100%; max-height: 550px; border: 1px solid #ddd;" /></div>
      </div>
    `).join("");return`
  <div style="max-width: 900px; margin: 0 auto; padding: 15px; background: white; font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4;">
    <style>
      @media print {
        @page { size: A4; margin: 8mm; }
        body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        .page-break-before { page-break-before: always; }
      }
    </style>
    <div style="border: 2px solid #000; background: white;">
      <div style="text-align: center; padding: 12px; font-size: 18px; font-weight: bold; border-bottom: 2px solid #000; background: #f8f8f8;">Tax Invoice</div>
      <div style="text-align: center; font-size: 11px; font-style: italic; padding: 5px; border-bottom: 1px solid #000; background: #fafafa;">(Original for Recipient)</div>
      <div style="display: flex; border-bottom: 2px solid #000;">
        <div style="flex: 1.5; padding: 12px; border-right: 2px solid #000;">
          <div style="font-size: 16px; font-weight: bold; margin-bottom: 8px; color: #1a5276;">${w.name}</div>
          <div style="font-size: 11px; line-height: 1.5; color: #333;">${w.address}<br>${w.addressLine2}<br>${w.city}<br><strong>GSTIN/UIN:</strong> ${w.gstin}<br><strong>State:</strong> ${w.stateName}, Code: ${w.stateCode}<br><strong>Contact:</strong> ${w.phone}<br><strong>E-Mail:</strong> ${w.email}</div>
        </div>
        <div style="flex: 1; font-size: 12px;">
          <div style="display: flex; border-bottom: 1px solid #000;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Invoice No.</div><div style="flex: 1; padding: 8px; font-weight: 600; color: #1a5276;">${h.invoiceNo||""}</div></div>
          <div style="display: flex;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Dated</div><div style="flex: 1; padding: 8px;">${_t(h.invoiceDate||h.date)}</div></div>
        </div>
      </div>
      <div style="padding: 10px 12px; border-bottom: 2px solid #000; background: #fafafa;">
        <div style="font-size: 11px; color: #666; margin-bottom: 3px;">Buyer (Bill to)</div>
        <div style="font-size: 14px; font-weight: bold; margin-bottom: 4px; color: #1a5276;">${h.partyName}</div>
        <div style="font-size: 11px; color: #333;">${L?L+"<br>":""}${h.statePartyDetails||""}${q?"<br><strong>GSTIN/UIN:</strong> "+q:""}<br>Place of Supply: ${h.statePartyDetails||w.stateName}</div>
      </div>
      <table style="width: 100%; border-collapse: collapse;">
        <thead><tr style="background: #e8e8e8;"><th style="border: 1px solid #000; padding: 10px; width: 45px; font-size: 12px;">Sl No.</th><th style="border: 1px solid #000; padding: 10px; font-size: 12px;">Particulars</th><th style="border: 1px solid #000; padding: 10px; width: 80px; font-size: 12px;">HSN/SAC</th><th style="border: 1px solid #000; padding: 10px; width: 100px; text-align: right; font-size: 12px;">Amount</th></tr></thead>
        <tbody>
          ${K}
          ${_.length>1?'<tr style="background: #f5f5f5;"><td colspan="3" style="border: 1px solid #000; padding: 10px; text-align: right; font-weight: bold; font-size: 13px;">Sub Total</td><td style="border: 1px solid #000; padding: 10px; text-align: right; font-weight: bold; font-size: 13px;">'+Ot(U)+"</td></tr>":""}
          ${se?`<tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">CGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${Ot(N)}</td></tr><tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">SGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${Ot(b)}</td></tr>`:`<tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">IGST @ 18%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${Ot(ie)}</td></tr>`}
          <tr style="background: #2874A6; color: white;"><td colspan="3" style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;">Total</td><td style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;"> ${oe.toLocaleString("en-IN",{minimumFractionDigits:2})}</td></tr>
        </tbody>
      </table>
      <div style="padding: 10px 12px; border: 1px solid #000; border-top: none; background: #fafafa;"><div style="color: #666; font-size: 11px; margin-bottom: 3px;">Amount Chargeable (in words)</div><div style="font-weight: bold; font-size: 13px;">${th(oe)}</div></div>
      <div style="display: flex; border-top: 2px solid #000;">
        <div style="flex: 1; padding: 10px 12px; border-right: 2px solid #000; font-size: 11px;"><div><strong>Company's PAN:</strong> ${w.pan}</div><div style="margin-top: 4px;"><strong>MSME Reg. No.:</strong> UDYAM-MH-19-0057219</div></div>
        <div style="flex: 1.2; padding: 10px 12px; font-size: 11px;">
          <div style="font-weight: bold; margin-bottom: 6px; color: #1a5276;">Company's Bank Details</div>
          <div style="line-height: 1.5;"><strong>A/c Holder:</strong> ${w.bank.holder}<br><strong>Bank:</strong> ${w.bank.name}<br><strong>A/c No.:</strong> ${w.bank.account}<br><strong>IFSC:</strong> ${w.bank.ifsc}</div>
          <div style="text-align: right; margin-top: 30px;"><div style="font-weight: bold;">for ${w.name}</div><div style="margin-top: 25px; border-top: 1px solid #000; display: inline-block; padding-top: 4px; font-size: 10px;">Authorised Signatory</div></div>
        </div>
      </div>
      <div style="text-align: center; padding: 8px; background: #f0f0f0; border-top: 1px solid #000; font-size: 10px; color: #666; font-style: italic;">This is a Computer Generated Invoice</div>
    </div>
  </div>
  ${tt}
`},I4=h=>{const _=Ty(h);wy(_),rr(h),Ey(!0)},N4=h=>{const _=`<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Invoice ${h.invoiceNo||""}</title>
  <style>
    @page { size: A4; margin: 10mm; }
    @media print { body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } }
    body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }
  </style>
</head>
<body>
${Ty(h)}
<script>
  // Auto-open print dialog when file is opened
  window.onload = function() { 
    setTimeout(function() { window.print(); }, 500); 
  };
<\/script>
</body>
</html>`,U=new Blob([_],{type:"text/html"}),q=URL.createObjectURL(U),L=document.createElement("a");L.href=q,L.download=`Invoice_${(h.invoiceNo||"draft").replace(/\//g,"-")}.html`,document.body.appendChild(L),L.click(),document.body.removeChild(L),URL.revokeObjectURL(q)},ed=h=>{I4(h)},R4=()=>{const h=parseFloat(yr.amount)||0,_=parseFloat(yr.tds)||0,U=parseFloat(yr.discount)||0,q=h+_+U;let L=parseFloat(le.invoiceTotalAmount)||parseFloat(le.totalWithGst)||parseFloat(le.invoiceAmount)*1.18;const se=q>=L?"Paid":"Partially Paid";le.invoiceType==="Combined"&&le.combinationCode!=="NA"?Pe(b=>b.map(ie=>ie.combinationCode===le.combinationCode?{...ie,invoiceStatus:se}:ie)):Pe(b=>b.map(ie=>ie.id===le.id?{...ie,invoiceStatus:se}:ie));const N=[];h>0&&N.push({id:Date.now(),partyName:le.partyName,date:yr.date,particulars:yr.narration?`Payment Received - ${yr.mode} (${yr.narration})`:`Payment Received - ${yr.mode}`,debit:0,credit:h,type:"payment"}),_>0&&N.push({id:Date.now()+1,partyName:le.partyName,date:yr.date,particulars:`TDS Deducted - Inv: ${le.invoiceNo}`,debit:0,credit:_,type:"tds"}),U>0&&N.push({id:Date.now()+2,partyName:le.partyName,date:yr.date,particulars:`Discount Allowed - Inv: ${le.invoiceNo}`,debit:0,credit:U,type:"discount"}),be(b=>[...b,...N]),cr(!1),rr(null)},Ay=h=>{_s(_=>{const U=new Set(_);return U.has(h)?U.delete(h):U.add(h),U})},D4=()=>{const U=r==="director"?[{id:"master",icon:sE,label:"Master Sheet"},{id:"services",icon:im,label:"Services Sheet"},{id:"invoices",icon:fd,label:"Invoice Register"},{id:"receipts",icon:Po,label:"Receipt Register"},{id:"ledgers",icon:J_,label:"Party Ledgers"},{id:"followups",icon:Y0,label:"Followups"},{id:"reports",icon:q_,label:"Reports"}]:[{id:"master",icon:sE,label:"Master Sheet"},{id:"services",icon:im,label:"Services Sheet"},{id:"invoices",icon:fd,label:"Invoice Register"},{id:"receipts",icon:Po,label:"Receipt Register"},{id:"ledgers",icon:J_,label:"Party Ledgers"},{id:"followups",icon:Y0,label:"Followups"},{id:"reports",icon:q_,label:"Reports"},{id:"settings",icon:zL,label:"Settings"}];return c.jsxs("div",{style:{width:D?"60px":"220px",backgroundColor:"#1E293B",color:"#FFFFFF",display:"flex",flexDirection:"column",transition:"width 0.2s ease",flexShrink:0},children:[c.jsxs("div",{style:{padding:D?"12px":"16px",borderBottom:"1px solid #334155",display:"flex",alignItems:"center",justifyContent:D?"center":"space-between"},children:[!D&&c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[c.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"32px",height:"auto",borderRadius:"4px",backgroundColor:"white",padding:"2px"}}),c.jsxs("div",{children:[c.jsx("div",{style:{fontSize:"16px",fontWeight:"700"},children:"FinMate"}),c.jsx("div",{style:{fontSize:"10px",color:"#94A3B8"},children:r==="director"?"Director View":"Finance Team"})]})]}),c.jsx("button",{onClick:()=>qe(!D),style:{background:"none",border:"none",color:"#94A3B8",cursor:"pointer",padding:"4px"},children:D?c.jsx($0,{size:18}):c.jsx(ML,{size:18})})]}),!D&&c.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #334155",fontSize:"11px"},children:f?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#FCD34D"},children:[c.jsx(rE,{size:12,style:{animation:"spin 1s linear infinite"}}),c.jsx("span",{children:"Saving..."})]}):g?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#86EFAC"},children:[c.jsx(eE,{size:12}),c.jsxs("span",{children:["Saved ",g.toLocaleTimeString()]})]}):c.jsx("div",{style:{color:"#94A3B8"},children:"Cloud Sync Active"})}),c.jsx("div",{style:{padding:"8px",borderBottom:"1px solid #334155"},children:c.jsxs("button",{onClick:()=>nr(!0),style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:D?"12px":"11px 14px",borderRadius:"8px",border:"none",backgroundColor:Ss>0?"#FEF3C7":"#334155",color:Ss>0?"#92400E":"#94A3B8",cursor:"pointer",fontSize:"14px",fontWeight:Ss>0?"700":"500",justifyContent:D?"center":"flex-start",position:"relative"},title:"Notifications",children:[Ss>0?c.jsx(PL,{size:18}):c.jsx(Q_,{size:18}),!D&&c.jsx("span",{children:"Notifications"}),Ss>0&&c.jsx("span",{style:{position:D?"absolute":"static",top:D?"4px":"auto",right:D?"4px":"auto",marginLeft:D?"0":"auto",backgroundColor:"#DC2626",color:"#FFFFFF",padding:"2px 6px",borderRadius:"10px",fontSize:"11px",fontWeight:"700",minWidth:"18px",textAlign:"center"},children:Ss})]})}),c.jsx("nav",{style:{flex:1,padding:"8px"},children:U.map(q=>c.jsxs("button",{onClick:()=>O(q.id),style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:D?"12px":"11px 14px",marginBottom:"4px",borderRadius:"8px",border:"none",backgroundColor:P===q.id?"#2874A6":"transparent",color:P===q.id?"#FFFFFF":"#94A3B8",cursor:"pointer",fontSize:"14px",fontWeight:P===q.id?"600":"500",justifyContent:D?"center":"flex-start"},title:q.label,children:[c.jsx(q.icon,{size:18}),!D&&c.jsx("span",{children:q.label})]},q.id))}),c.jsxs("div",{style:{padding:"8px",borderTop:"1px solid #334155"},children:[c.jsxs("button",{onClick:()=>{E(!0),X({currentPassword:"",newPassword:"",confirmPassword:""}),T("")},style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:D?"12px":"11px 14px",marginBottom:"8px",borderRadius:"8px",border:"none",backgroundColor:"#475569",color:"#FFFFFF",cursor:"pointer",fontSize:"14px",fontWeight:"500",justifyContent:D?"center":"flex-start"},title:"Change Password",children:[c.jsx(G0,{size:18}),!D&&c.jsx("span",{children:"Change Password"})]}),c.jsxs("button",{onClick:Ci,style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:D?"12px":"11px 14px",borderRadius:"8px",border:"none",backgroundColor:"#DC2626",color:"#FFFFFF",cursor:"pointer",fontSize:"14px",fontWeight:"600",justifyContent:D?"center":"flex-start"},title:"Logout",children:[c.jsx(Sa,{size:18}),!D&&c.jsx("span",{children:"Logout"})]})]})]})},P4=()=>c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(hd,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"})]}),c.jsxs("div",{style:{position:"relative"},children:[c.jsx(X0,{size:15,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",placeholder:"Search...",value:St.searchText,onChange:h=>Al(_=>({..._,searchText:h.target.value})),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"160px"}})]}),c.jsxs("select",{value:St.party,onChange:h=>Al(_=>({..._,party:h.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:St.party?"#EFF6FF":"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Parties"}),Hs.map(h=>c.jsx("option",{value:h,children:h},h))]}),c.jsxs("select",{value:St.billStatus,onChange:h=>Al(_=>({..._,billStatus:h.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:St.billStatus?"#EFF6FF":"#FFFFFF"},children:[c.jsx("option",{value:"",children:"Bill Status"}),c.jsx("option",{value:"Yes",children:"Yes"}),c.jsx("option",{value:"Not Yet",children:"Not Yet"})]}),c.jsxs("select",{value:St.invoiceStatus,onChange:h=>Al(_=>({..._,invoiceStatus:h.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:St.invoiceStatus?"#EFF6FF":"#FFFFFF"},children:[c.jsx("option",{value:"",children:"Invoice Status"}),c.jsx("option",{value:"Generated",children:"Generated"}),c.jsx("option",{value:"Not Generated",children:"Not Generated"}),c.jsx("option",{value:"Paid",children:"Paid"})]}),$e&&c.jsxs(c.Fragment,{children:[c.jsxs("button",{onClick:me,style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(Sa,{size:14})," Clear"]}),c.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",v.length," of ",Ee.length]})]})]})}),Cy=()=>{const h=Ee.filter(N=>N.toBeBilled==="Yes"&&N.invoiceGenerated&&N.mailingSent==="Yes"&&(N.receiptStatus==="Received"||N.receiptStatus==="Cancelled"||N.receiptStatus==="Closed")),_=Ee.filter(N=>!(N.toBeBilled==="Yes"&&N.invoiceGenerated&&N.mailingSent==="Yes"&&(N.receiptStatus==="Received"||N.receiptStatus==="Cancelled"||N.receiptStatus==="Closed"))),U=Si==="open"?_:h,q=U.filter(N=>{var b,ie,J,oe,K;if(St.party&&N.partyName!==St.party||St.billStatus&&N.toBeBilled!==St.billStatus||St.invoiceType&&N.invoiceType!==St.invoiceType||St.mailingStatus&&(St.mailingStatus==="Sent"&&N.mailingSent!=="Yes"||St.mailingStatus==="Not Sent"&&N.mailingSent==="Yes")||St.invoiceStatus&&(St.invoiceStatus==="Generated"&&!N.invoiceGenerated||St.invoiceStatus==="Not Generated"&&N.invoiceGenerated||St.invoiceStatus==="Approved"&&N.invoiceStatus!=="Approved"||St.invoiceStatus==="Need Edits"&&N.invoiceStatus!=="Need Edits"||St.invoiceStatus==="Paid"&&N.invoiceStatus!=="Paid"))return!1;if(St.searchText){const ee=St.searchText.toLowerCase();if(!((b=N.partyName)!=null&&b.toLowerCase().includes(ee))&&!((ie=N.senderName)!=null&&ie.toLowerCase().includes(ee))&&!((J=N.campaignName)!=null&&J.toLowerCase().includes(ee))&&!((oe=N.subject)!=null&&oe.toLowerCase().includes(ee))&&!((K=N.invoiceNo)!=null&&K.toLowerCase().includes(ee)))return!1}return!0}),L=q.reduce((N,b)=>{const ie=b.partyName||"Unknown";return N[ie]||(N[ie]=[]),N[ie].push(b),N},{}),se=Object.keys(L).sort();return c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsxs("div",{children:[c.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Master Sheet"}),c.jsxs("p",{style:{margin:"4px 0 0",fontSize:"14px",color:"#64748B"},children:[Ee.length," campaigns  ",Hs.length," parties  ",Ee.filter(N=>N.invoiceGenerated).length," invoiced"]})]}),c.jsxs("div",{style:{display:"flex",gap:"10px"},children:[c.jsx("input",{type:"file",ref:Yu,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:v4}),c.jsx(Ke,{icon:Ks,label:"Upload Data",variant:"brand",onClick:()=>{var N;return(N=Yu.current)==null?void 0:N.click()}}),_r&&Ee.length>0&&c.jsx(Ke,{icon:ns,label:"Clear All Data",variant:"danger",onClick:()=>Us(!0)})]})]}),c.jsxs("div",{style:{display:"flex",gap:"4px",marginBottom:"16px",backgroundColor:"#F1F5F9",padding:"4px",borderRadius:"10px",width:"fit-content"},children:[c.jsxs("button",{onClick:()=>I("open"),style:{padding:"10px 20px",fontSize:"14px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:Si==="open"?"#FFFFFF":"transparent",color:Si==="open"?"#1E293B":"#64748B",boxShadow:Si==="open"?"0 2px 4px rgba(0,0,0,0.1)":"none"},children:[" Open Invoices (",_.length,")"]}),c.jsxs("button",{onClick:()=>I("closed"),style:{padding:"10px 20px",fontSize:"14px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:Si==="closed"?"#FFFFFF":"transparent",color:Si==="closed"?"#1E293B":"#64748B",boxShadow:Si==="closed"?"0 2px 4px rgba(0,0,0,0.1)":"none"},children:[" Closed Invoices (",h.length,")"]})]}),Ee.length>0&&P4(),se.length===0?c.jsx(gn,{children:c.jsxs("div",{style:{padding:"60px",textAlign:"center",color:"#94A3B8"},children:[c.jsx(Ks,{size:48,style:{marginBottom:"16px",opacity:.5}}),c.jsx("div",{style:{fontSize:"18px",fontWeight:"600"},children:$e?"No matching records":Si==="closed"?"No closed invoices yet":"No Data Yet"}),c.jsx("div",{style:{fontSize:"14px",marginTop:"4px"},children:$e?"Try adjusting your filters":Si==="closed"?"Invoices will appear here once billed, mailed, and payment received":"Upload an Excel file to get started"})]})}):c.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:se.map(N=>{const b=L[N],ie=l0.has(N),J=b.filter(ee=>ee.toBeBilled==="Yes").length,oe=b.filter(ee=>ee.invoiceGenerated).length,K=b.filter(ee=>ee.toBeBilled==="Yes").reduce((ee,tt)=>ee+(parseFloat(tt.totalWithGst)||0),0);return c.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:[c.jsxs("div",{onClick:()=>Ay(N),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",backgroundColor:Si==="closed"?"#F0FDF4":"#F8FAFC",cursor:"pointer",borderBottom:ie?"3px solid #2874A6":"none"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[ie?c.jsx(rm,{size:22,color:"#2874A6"}):c.jsx($0,{size:22,color:"#64748B"}),c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"700",fontSize:"16px",color:"#1E293B"},children:N}),c.jsxs("div",{style:{fontSize:"13px",color:"#64748B",marginTop:"3px"},children:[b.length," campaigns  ",J," billed  ",oe," invoiced"]})]})]}),K>0&&c.jsxs("div",{style:{textAlign:"right"},children:[c.jsx("div",{style:{fontSize:"11px",color:"#64748B",textTransform:"uppercase"},children:"Total"}),c.jsx("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:nt(K)})]})]}),ie&&c.jsx("div",{style:{overflowX:"auto"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px",minWidth:"2200px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F1F5F9"},children:[c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Date"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#6B21A8",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"60px"},children:"Code"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"100px"},children:"Sender"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",minWidth:"180px"},children:"Campaign / Subject"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"160px"},children:"Email ID"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"70px"},children:"Mailer"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"70px"},children:"PO?"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"80px"},children:"Bill?"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"right",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Amount"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Type"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Generate"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"110px"},children:"Invoice No."}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"90px"},children:"Inv Date"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"right",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"100px"},children:"Inv Amount"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#7C3AED",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"50px"},children:"C#"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"120px"},children:"Status/Approve"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"120px"},children:"Actions"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#059669",borderBottom:"2px solid #E2E8F0",backgroundColor:"#F0FDF4",width:"80px"},children:"Mailed?"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#059669",borderBottom:"2px solid #E2E8F0",backgroundColor:"#F0FDF4",width:"90px"},children:"Mail Date"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#7C3AED",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"100px"},children:"Receipt"})]})}),c.jsx("tbody",{children:b.map(ee=>{var Ce,Be;const tt=ee.invoiceType==="Combined"&&B(ee.combinationCode)&&ee.mailingSent!=="Yes";Jt(ee);const ae=Ct[ee.id]&&Ct[ee.id].length>0,Se=ee.clientCode||rn(ee.partyName,ee.statePartyDetails);return c.jsxs("tr",{style:{backgroundColor:ee.toBeBilled==="Yes"?ee.invoiceGenerated?"#F0FDF4":"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #F1F5F9"},children:[c.jsx("td",{style:{padding:"12px 14px",whiteSpace:"nowrap",fontSize:"13px"},children:_t(ee.date)}),c.jsx("td",{style:{padding:"12px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:c.jsx("span",{style:{fontWeight:"700",color:"#6B21A8",fontSize:"12px"},children:Se||"-"})}),c.jsx("td",{style:{padding:"12px 14px",fontWeight:"600",fontSize:"13px"},children:ee.senderName}),c.jsxs("td",{style:{padding:"12px 14px"},children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",lineHeight:"1.4",color:"#1E293B"},children:((Be=(Ce=ee.campaignName)==null?void 0:Ce.split("--")[0])==null?void 0:Be.trim())||ee.senderName}),ee.subject&&c.jsx("div",{style:{fontSize:"12px",color:"#64748B",marginTop:"4px",lineHeight:"1.3"},children:ee.subject})]}),c.jsx("td",{style:{padding:"10px 14px"},children:c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[ee.emailId&&c.jsx("div",{style:{fontSize:"11px",color:"#1E40AF",backgroundColor:"#EFF6FF",padding:"2px 6px",borderRadius:"4px",display:"inline-block"},children:ee.emailId}),(ee.additionalEmails||[]).map((Qe,Je)=>c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[c.jsx("span",{style:{fontSize:"11px",color:"#059669",backgroundColor:"#F0FDF4",padding:"2px 6px",borderRadius:"4px"},children:Qe}),c.jsx("button",{onClick:()=>qt(ee.id,Qe),style:{background:"none",border:"none",cursor:"pointer",padding:"2px",color:"#DC2626"},title:"Remove",children:c.jsx(Sa,{size:12})})]},Je)),c.jsxs("button",{onClick:()=>{rr(ee),xs(""),Dr(!0)},style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",color:"#2874A6",background:"none",border:"none",cursor:"pointer",padding:"2px 0"},children:[c.jsx(sm,{size:12})," Add"]})]})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:ae?c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[c.jsx("span",{style:{color:"#22C55E",fontWeight:"700",fontSize:"14px"},children:""}),c.jsx("button",{onClick:()=>{rr(ee),Vs(null),wo(!0),Oi(!0)},style:{fontSize:"10px",color:"#64748B",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},children:"Replace"})]}):c.jsx(Ke,{icon:Z_,small:!0,variant:"default",onClick:()=>{rr(ee),Vs(null),wo(!1),Oi(!0)}})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:ee.poStatus==="With PO"?c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[c.jsx("span",{style:{color:"#22C55E",fontWeight:"600",fontSize:"10px"},children:" PO"}),c.jsx("span",{style:{fontSize:"9px",color:"#1E40AF",fontWeight:"600"},children:ee.poNumber}),ee.poDate&&c.jsx("span",{style:{fontSize:"9px",color:"#64748B"},children:_t(ee.poDate)})]}):c.jsx("span",{style:{color:"#CBD5E1",fontSize:"10px"},children:"No PO"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:c.jsxs("select",{value:ee.toBeBilled,onChange:Qe=>_4(ee.id,Qe.target.value),disabled:ee.invoiceGenerated||!ii,style:{padding:"6px 8px",fontSize:"12px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:ee.toBeBilled==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:ee.toBeBilled==="Yes"?"#DCFCE7":"#FFFFFF",color:ee.toBeBilled==="Yes"?"#166534":"#64748B",cursor:ee.invoiceGenerated||!ii?"not-allowed":"pointer",width:"70px",opacity:!ii&&!ee.invoiceGenerated?.6:1},children:[c.jsx("option",{value:"Not Yet",children:"Not Yet"}),c.jsx("option",{value:"Yes",children:"Yes"})]})}),c.jsx("td",{style:{padding:"10px 14px"},children:c.jsx("input",{type:"number",value:ee.invoiceAmount||"",onChange:Qe=>h0(ee.id,"invoiceAmount",Qe.target.value),disabled:ee.invoiceGenerated,placeholder:"0",style:{width:"80px",padding:"6px 8px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #D1D5DB",borderRadius:"6px",textAlign:"right",backgroundColor:ee.invoiceGenerated?"#F3F4F6":"#FFFFFF"}})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:ee.invoiceGenerated?c.jsx(xm,{status:ee.invoiceType,small:!0}):ee.toBeBilled==="Yes"?c.jsxs("select",{value:ee.invoiceType||"Individual",onChange:Qe=>h0(ee.id,"invoiceType",Qe.target.value),style:{padding:"6px 6px",fontSize:"11px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:ee.invoiceType==="Combined"?"#7C3AED":"#A5B4FC",backgroundColor:ee.invoiceType==="Combined"?"#F3E8FF":"#E0E7FF",color:ee.invoiceType==="Combined"?"#6B21A8":"#3730A3",cursor:"pointer",width:"80px"},children:[c.jsx("option",{value:"Individual",children:"Individual"}),c.jsx("option",{value:"Combined",children:"Combined"})]}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:ee.toBeBilled==="Yes"&&!ee.invoiceGenerated&&ee.invoiceAmount&&_r?ee.invoiceType==="Individual"?c.jsx(Ke,{icon:Po,label:"Create",small:!0,variant:"warning",onClick:()=>E4(ee)}):c.jsx(Ke,{icon:jL,label:"Combine",small:!0,variant:"purple",onClick:()=>T4(ee)}):ee.toBeBilled==="Yes"&&!ee.invoiceGenerated&&ee.invoiceAmount&&ii?c.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Finance to create"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF"},children:ee.invoiceNo?c.jsx("span",{style:{fontWeight:"700",color:"#1E40AF",fontSize:"12px"},children:ee.invoiceNo}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF",fontSize:"12px"},children:ee.invoiceDate?_t(ee.invoiceDate):"-"}),c.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF",textAlign:"right",fontWeight:"700",color:"#1E40AF",fontSize:"13px"},children:ee.invoiceTotalAmount?Ot(ee.invoiceTotalAmount):"-"}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:ee.combinationCode&&ee.combinationCode!=="NA"?c.jsx("span",{style:{fontWeight:"700",color:"#7C3AED",fontSize:"12px"},children:ee.combinationCode}):"-"}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:ee.invoiceGenerated?ii?c.jsx("button",{onClick:()=>Tn(ee),style:{padding:"5px 10px",fontSize:"11px",fontWeight:"700",border:"1.5px solid",borderRadius:"6px",cursor:"pointer",backgroundColor:ee.invoiceStatus==="Approved"?"#DCFCE7":ee.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",borderColor:ee.invoiceStatus==="Approved"?"#22C55E":ee.invoiceStatus==="Need Edits"?"#DC2626":"#F59E0B",color:ee.invoiceStatus==="Approved"?"#166534":ee.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:ee.invoiceStatus==="Approved"?" Approved":ee.invoiceStatus==="Need Edits"?" Need Edits":" Review"}):c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px"},children:[c.jsx("span",{style:{padding:"4px 10px",fontSize:"11px",fontWeight:"700",borderRadius:"6px",backgroundColor:ee.invoiceStatus==="Approved"?"#DCFCE7":ee.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",color:ee.invoiceStatus==="Approved"?"#166534":ee.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:ee.invoiceStatus==="Approved"?" Approved":ee.invoiceStatus==="Need Edits"?" Need Edits":" Pending"}),(ee.editComments||ee.approvalRemarks)&&c.jsx("button",{onClick:()=>{rr(ee),Rn(!0)},style:{fontSize:"9px",color:ee.invoiceStatus==="Need Edits"?"#991B1B":"#166534",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},title:ee.editComments||ee.approvalRemarks,children:"View Remarks"})]}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:ee.invoiceGenerated&&ee.invoiceStatus==="Approved"?c.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[c.jsx(Ke,{icon:Pc,small:!0,onClick:()=>ed(ee),title:"View Invoice"}),_r&&c.jsx(Ke,{icon:K0,small:!0,variant:"brand",onClick:()=>{rr(ee),jr(!0)},title:"Send Email"}),_r&&c.jsx(Ke,{icon:ns,small:!0,variant:"danger",onClick:()=>fg(ee),title:"Delete"})]}):ee.invoiceGenerated?c.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[c.jsx(Ke,{icon:Pc,small:!0,onClick:()=>ed(ee),title:"View Invoice"}),_r&&c.jsx(Ke,{icon:ns,small:!0,variant:"danger",onClick:()=>fg(ee),title:"Delete"})]}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#F0FDF4"},children:ee.invoiceGenerated&&ee.invoiceStatus==="Approved"&&_r?tt?c.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Combined sent"}):c.jsxs("select",{value:ee.mailingSent||"No",onChange:Qe=>h0(ee.id,"mailingSent",Qe.target.value),style:{padding:"5px 8px",fontSize:"11px",fontWeight:"700",border:"2px solid",borderRadius:"6px",borderColor:ee.mailingSent==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:ee.mailingSent==="Yes"?"#DCFCE7":"#FFFFFF",color:ee.mailingSent==="Yes"?"#166534":"#64748B",cursor:"pointer",width:"60px"},children:[c.jsx("option",{value:"No",children:"No"}),c.jsx("option",{value:"Yes",children:"Yes"})]}):ee.invoiceGenerated&&ee.invoiceStatus==="Approved"&&ii?c.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"11px",fontWeight:"600",backgroundColor:ee.mailingSent==="Yes"?"#DCFCE7":"#FEF3C7",color:ee.mailingSent==="Yes"?"#166534":"#92400E"},children:ee.mailingSent==="Yes"?" Yes":" No"}):ee.invoiceGenerated&&ee.invoiceStatus!=="Approved"?c.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Approve first"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#F0FDF4"},children:ee.mailingSent==="Yes"?_r?c.jsx("input",{type:"date",value:ee.mailDate||ee.invoiceDate||"",onChange:Qe=>h0(ee.id,"mailDate",Qe.target.value),style:{padding:"4px 6px",fontSize:"11px",border:"1.5px solid #D1D5DB",borderRadius:"6px",width:"100%"}}):c.jsx("span",{style:{fontSize:"11px"},children:_t(ee.mailDate||ee.invoiceDate)}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:ee.receiptStatus==="Received"||ee.receiptStatus==="Closed"?c.jsxs("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"700",backgroundColor:"#DCFCE7",color:"#166534"},children:[" ",ee.receiptNo||"Received"]}):ee.receiptStatus==="Cancelled"?c.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:" Cancelled"}):ee.invoiceGenerated&&ee.invoiceStatus==="Approved"?c.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"600",backgroundColor:"#FEF3C7",color:"#92400E"},children:" Pending"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})})]},ee.id)})})]})})]},N)})}),U.length>0&&c.jsxs("div",{style:{marginTop:"16px",padding:"16px 20px",backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsxs("div",{style:{display:"flex",gap:"24px",fontSize:"14px",color:"#475569"},children:[c.jsxs("span",{children:[" Total: ",c.jsx("strong",{children:q.length})]}),c.jsxs("span",{children:[" To Bill: ",c.jsx("strong",{children:q.filter(N=>N.toBeBilled==="Yes").length})]}),c.jsxs("span",{children:[" Invoiced: ",c.jsx("strong",{children:q.filter(N=>N.invoiceGenerated).length})]}),c.jsxs("span",{children:[" Approved: ",c.jsx("strong",{children:q.filter(N=>N.invoiceStatus==="Approved").length})]}),Si==="closed"&&c.jsxs("span",{children:[" Closed: ",c.jsx("strong",{children:q.filter(N=>N.receiptStatus==="Received"||N.receiptStatus==="Cancelled"||N.receiptStatus==="Closed").length})]})]}),c.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:["Total: ",nt(q.filter(N=>N.toBeBilled==="Yes").reduce((N,b)=>N+(parseFloat(b.totalWithGst)||0),0))]})]})]})},O4=h=>{var q;const _=(q=h.target.files)==null?void 0:q[0];if(!_)return;const U=new FileReader;U.onload=L=>{const se=Dl(L.target.result,{type:"binary",cellDates:!0}),N=se.SheetNames[0],b=se.Sheets[N],ie=Er.sheet_to_json(b,{raw:!1}),J=new Set(Ur.map(ae=>`${ae.date}|${ae.partyName}|${ae.serviceType||ae.campaignName}`.toLowerCase()));let oe=0,K=0;const ee=ie.map((ae,Se)=>{const Ce=(ae["TYPE OF SERVICE"]||ae["Type of Service"]||ae["SERVICE TYPE"]||ae["Service Type"]||ae["CAMPAIGN NAME"]||ae["Campaign Name"]||"").trim().toUpperCase();let Be=ae.DATE||ae.Date||new Date;typeof Be=="string"&&(Be=new Date(Be));const Qe=(ae["PARTY NAME"]||ae["Party Name"]||"").trim(),Je=ae.EMAIL||ae.Email||"",rt=ae.STATE||ae.State||ae["State/Party Details"]||ae["STATE/PARTY DETAILS"]||"",kt=ae.AMOUNT||ae.Amount||Ui[Qe]||"",$t=Be instanceof Date&&!isNaN(Be)?Be.toISOString().split("T")[0]:"",ct=(ae["Client Code"]||ae["CLIENT CODE"]||ae.Code||"").toString().trim()||rn(Qe,rt),zt=ae["PO?"]||ae.PO||ae["WITH PO"]||"",Pt=zt.toLowerCase().includes("with po")||zt.toLowerCase()==="yes",ge=ae["PO Number"]||ae["PO NUMBER"]||ae["PO No"]||ae["PO NO"]||"";let de=ae["PO Date"]||ae["PO DATE"]||"";typeof de=="object"&&de instanceof Date&&(de=de.toISOString().split("T")[0]);const Ie=`${$t}|${Qe}|${Ce}`.toLowerCase();return J.has(Ie)?(oe++,null):(J.add(Ie),K++,{id:Date.now()+Se+Math.random(),sno:ae.SNO||ae["SNO."]||ae.Sno||Se+1,date:$t,statePartyDetails:rt,partyName:Qe,clientCode:ct,serviceType:Ce,emailId:Je,additionalEmails:[],toBeBilled:"Not Yet",invoiceAmount:kt,cgst:"",sgst:"",igst:"",totalWithGst:"",invoiceType:"Individual",invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",mailingSent:"No",mailDate:"",mailerUploaded:!1,editComments:"",approvalRemarks:"",isService:!0,poStatus:Pt?"With PO":"Without PO",poNumber:Pt?ge:"",poDate:Pt?de:""})}).filter(ae=>ae!==null);if(ee.length>0){const ae=[...Ur,...ee];console.log("Setting services data:",ae.length,"entries"),Ae(ae);const Se=[...new Set(ee.map(Ce=>Ce.partyName))];fe(Ce=>{const Be=new Set(Ce);return Se.forEach(Qe=>Be.add(Qe)),Be}),setTimeout(async()=>{console.log("Triggering immediate save for services data..."),Es.current=!1;try{await md("indreesh-media",{masterData:Ee,servicesData:ae,ledgerEntries:ne,receipts:je,creditNotes:te,openingBalances:$n,mailerImages:Ct,mailerLogo:Hn,companyConfig:w,nextInvoiceNo:it,nextCombineNo:Rt,nextReceiptNo:Dt,nextCreditNoteNo:Xe,nextServiceInvoiceNo:Xr,invoiceValues:Ui,notifications:He,whatsappSettings:At,partyMaster:tn,followups:Yt,userPasswords:y}),console.log("Services data saved successfully!"),m(new Date)}catch(Ce){console.error("Error saving services data:",Ce)}},100)}let tt=` Services Upload Complete!

`;tt+=` ${K} new entries added
`,oe>0&&(tt+=` ${oe} duplicate entries skipped`),K>0&&es("upload",` ${K} new services uploaded`,"director"),alert(tt)},U.readAsBinaryString(_),h.target.value=""},td=(h,_,U)=>{Ae(q=>q.map(L=>L.id===h?{...L,[_]:U}:L))},M4=h=>{fe(_=>{const U=new Set(_);return U.has(h)?U.delete(h):U.add(h),U})},hg=h=>{const _=Fe.find(U=>U.id===h);if(_!=null&&_.invoiceGenerated&&(_==null?void 0:_.invoiceStatus)==="Approved"){alert("Cannot delete approved invoices");return}confirm("Delete this service entry?")&&Ae(U=>U.filter(q=>q.id!==h))},B4=h=>{var oe;const _=Fe.find(K=>K.id===h);if(!_)return;if(!_.invoiceAmount||parseFloat(_.invoiceAmount)<=0){alert("Please enter a valid invoice amount");return}const U=`${w.invoicePrefix}${Xr}`,q=new Date().toISOString().split("T")[0],L=(oe=_.statePartyDetails)==null?void 0:oe.toUpperCase().includes("MAHARASHTRA"),se=parseFloat(_.invoiceAmount),N=L?se*.09:0,b=L?se*.09:0,ie=L?0:se*.18,J=se+N+b+ie;Ae(K=>K.map(ee=>ee.id===h?{...ee,invoiceNo:U,invoiceDate:q,invoiceTotalAmount:J.toFixed(2),cgst:N.toFixed(2),sgst:b.toFixed(2),igst:ie.toFixed(2),totalWithGst:J.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created"}:ee)),_n(K=>K+1),es("invoice_created",`Service Invoice ${U} created for ${_.partyName}`,"director")},pg=h=>{const _=getPartyGstinFromMaster(h.partyName,h.statePartyDetails),U=Tc(h.partyName,h.statePartyDetails),q=h.statePartyDetails,L=parseFloat(h.invoiceAmount)||0,se=parseFloat(h.cgst)||0,N=parseFloat(h.sgst)||0,b=parseFloat(h.igst)||0,ie=parseFloat(h.invoiceTotalAmount)||L+se+N+b,J=se>0,oe=`
<!DOCTYPE html>
<html>
<head>
  <title>Tax Invoice - ${h.invoiceNo}</title>
  <style>
    @media print { body { -webkit-print-color-adjust: exact !important; } @page { size: A4; margin: 10mm; } }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; font-size: 12px; }
    .invoice-container { max-width: 800px; margin: 0 auto; border: 2px solid #000; }
  </style>
</head>
<body>
  <div class="invoice-container">
    <div style="text-align: center; padding: 15px; border-bottom: 2px solid #000; font-size: 20px; font-weight: bold;">Tax Invoice</div>
    <div style="text-align: center; padding: 5px; border-bottom: 1px solid #000; font-style: italic; font-size: 11px; background: #f5f5f5;">(Original for Recipient)</div>
    <div style="display: flex; border-bottom: 2px solid #000;">
      <div style="flex: 1.5; padding: 12px; border-right: 2px solid #000;">
        <div style="font-size: 16px; font-weight: bold; color: #1a5276; margin-bottom: 8px;">${w.name}</div>
        <div style="font-size: 11px; line-height: 1.5;">${w.address}<br>${w.addressLine2}, ${w.city}<br><strong>GSTIN/UIN:</strong> ${w.gstin}<br><strong>State:</strong> ${w.stateName}, Code: ${w.stateCode}<br><strong>Contact:</strong> ${w.phone}<br><strong>E-Mail:</strong> ${w.email}</div>
      </div>
      <div style="flex: 1; padding: 0;">
        <div style="display: flex; border-bottom: 1px solid #000;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Invoice No.</div><div style="flex: 1; padding: 8px; color: #1a5276; font-weight: bold;">${h.invoiceNo}</div></div>
        <div style="display: flex;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Dated</div><div style="flex: 1; padding: 8px;">${_t(h.invoiceDate)}</div></div>
      </div>
    </div>
    <div style="padding: 10px 12px; border-bottom: 2px solid #000; background: #fafafa;">
      <div style="font-size: 11px; color: #666; margin-bottom: 3px;">Buyer (Bill to)</div>
      <div style="font-size: 14px; font-weight: bold; margin-bottom: 4px; color: #1a5276;">${h.partyName}</div>
      <div style="font-size: 11px; color: #333;">${U?U+"<br>":""}${q||""}${_?"<br><strong>GSTIN/UIN:</strong> "+_:""}<br>Place of Supply: ${q||w.stateName}</div>
    </div>
    <table style="width: 100%; border-collapse: collapse;">
      <thead><tr style="background: #e8e8e8;"><th style="border: 1px solid #000; padding: 10px; width: 45px;">Sl No.</th><th style="border: 1px solid #000; padding: 10px;">Particulars</th><th style="border: 1px solid #000; padding: 10px; width: 80px;">HSN/SAC</th><th style="border: 1px solid #000; padding: 10px; width: 100px; text-align: right;">Amount</th></tr></thead>
      <tbody>
        <tr>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">1</td>
          <td style="border: 1px solid #000; padding: 8px;">
            <div style="font-weight: 600;">${(h.serviceType||h.campaignName||"SERVICE").toUpperCase()}</div>
            <div style="font-style: italic; color: #555; font-size: 11px;">Date: ${_t(h.date)}</div>
          </td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${w.hsnCode}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: right;">${Ot(L)}</td>
        </tr>
        ${J?`
          <tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600;">CGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right;">${Ot(se)}</td></tr>
          <tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600;">SGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right;">${Ot(N)}</td></tr>
        `:`
          <tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600;">IGST @ 18%</td><td style="border: 1px solid #000; padding: 8px; text-align: right;">${Ot(b)}</td></tr>
        `}
        <tr style="background: #2874A6; color: white;"><td colspan="3" style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;">Total</td><td style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;"> ${ie.toLocaleString("en-IN",{minimumFractionDigits:2})}</td></tr>
      </tbody>
    </table>
    <div style="padding: 10px 12px; border: 1px solid #000; border-top: none; background: #fafafa;"><div style="color: #666; font-size: 11px; margin-bottom: 3px;">Amount Chargeable (in words)</div><div style="font-weight: bold; font-size: 13px;">${th(ie)}</div></div>
    <div style="display: flex; border-top: 2px solid #000;">
      <div style="flex: 1; padding: 10px 12px; border-right: 2px solid #000; font-size: 11px;"><div><strong>Company's PAN:</strong> ${w.pan}</div><div style="margin-top: 4px;"><strong>MSME Reg. No.:</strong> UDYAM-MH-19-0057219</div></div>
      <div style="flex: 1.2; padding: 10px 12px; font-size: 11px;">
        <div style="font-weight: bold; margin-bottom: 6px; color: #1a5276;">Company's Bank Details</div>
        <div style="line-height: 1.5;"><strong>A/c Holder:</strong> ${w.bank.holder}<br><strong>Bank:</strong> ${w.bank.name}<br><strong>A/c No.:</strong> ${w.bank.account}<br><strong>IFSC:</strong> ${w.bank.ifsc}</div>
        <div style="text-align: right; margin-top: 30px;"><div style="font-weight: bold;">for ${w.name}</div><div style="margin-top: 25px; border-top: 1px solid #000; display: inline-block; padding-top: 4px; font-size: 10px;">Authorised Signatory</div></div>
      </div>
    </div>
    <div style="text-align: center; padding: 8px; background: #f0f0f0; border-top: 1px solid #000; font-size: 10px; color: #666; font-style: italic;">This is a Computer Generated Invoice</div>
  </div>
</body>
</html>`,K=window.open("","_blank");K.document.write(oe),K.document.close(),K.print()},j4=ve.useMemo(()=>[...new Set(Ur.map(h=>h.partyName).filter(Boolean))].sort(),[Ur]),gg=ve.useMemo(()=>Ur.filter(h=>!(ue.party&&h.partyName!==ue.party||ue.billStatus&&h.toBeBilled!==ue.billStatus||ue.invoiceStatus&&(ue.invoiceStatus==="Pending"&&h.invoiceGenerated||ue.invoiceStatus==="Created"&&h.invoiceStatus!=="Created"||ue.invoiceStatus==="Approved"&&h.invoiceStatus!=="Approved"||ue.invoiceStatus==="Need Edits"&&h.invoiceStatus!=="Need Edits"))),[Ur,ue]),L4=()=>{const h=r==="director",_=r==="finance";console.log("Services Render Debug:",{servicesDataType:typeof Fe,servicesDataIsArray:Array.isArray(Fe),servicesDataLength:Fe==null?void 0:Fe.length,safeServicesDataLength:Ur.length,filteredServicesDataLength:gg.length,role:r,serviceFilters:ue,servicesSheetTab:W,rawServicesData:Fe});const U=gg.filter(b=>!(b.toBeBilled==="Yes"&&b.invoiceGenerated&&b.mailingSent==="Yes"&&(b.receiptStatus==="Received"||b.receiptStatus==="Cancelled"||b.receiptStatus==="Closed"))),q=gg.filter(b=>b.toBeBilled==="Yes"&&b.invoiceGenerated&&b.mailingSent==="Yes"&&(b.receiptStatus==="Received"||b.receiptStatus==="Cancelled"||b.receiptStatus==="Closed")),L=W==="open"?U:q;console.log("Services Tab Data:",{openCount:U.length,closedCount:q.length,currentTab:W});const se={};L.forEach(b=>{const ie=b.partyName||"Unknown";se[ie]||(se[ie]=[]),se[ie].push(b)});const N=Object.keys(se).sort();if(h&&N.length>0&&xe.size===0){const b=new Set(N);fe(b)}return c.jsxs("div",{style:{padding:"20px"},children:[c.jsx("input",{type:"file",ref:To,onChange:O4,accept:".xlsx,.xls,.csv",style:{display:"none"}}),c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[c.jsxs("div",{children:[c.jsx("h1",{style:{fontSize:"22px",fontWeight:"700",color:"#1E293B",marginBottom:"4px"},children:" Services Sheet"}),c.jsxs("p",{style:{fontSize:"13px",color:"#64748B"},children:["Non-campaign invoices  Total: ",Ur.length," entries"]})]}),c.jsx("div",{style:{display:"flex",gap:"10px"},children:_&&c.jsxs(c.Fragment,{children:[c.jsx(Ke,{icon:Ks,label:"Upload Excel",onClick:()=>{var b;return(b=To.current)==null?void 0:b.click()}}),c.jsx(Ke,{icon:VL,label:"Force Save",variant:"secondary",onClick:async()=>{try{Es.current=!1,await md("indreesh-media",{masterData:Ee,servicesData:Fe,ledgerEntries:ne,receipts:je,creditNotes:te,openingBalances:$n,mailerImages:Ct,mailerLogo:Hn,companyConfig:w,nextInvoiceNo:it,nextCombineNo:Rt,nextReceiptNo:Dt,nextCreditNoteNo:Xe,nextServiceInvoiceNo:Xr,invoiceValues:Ui,notifications:He,whatsappSettings:At,partyMaster:tn,followups:Yt,userPasswords:y}),m(new Date),alert("Data saved successfully!")}catch(b){console.error("Save error:",b),alert("Error saving: "+b.message)}}}),c.jsx(Ke,{icon:pd,label:"Add Entry",variant:"primary",onClick:()=>G(!0)})]})})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsx(hd,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"}),c.jsxs("select",{value:ue.party,onChange:b=>pe(ie=>({...ie,party:b.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"},children:[c.jsx("option",{value:"",children:"All Parties"}),j4.map(b=>c.jsx("option",{value:b,children:b},b))]}),c.jsxs("select",{value:ue.billStatus,onChange:b=>pe(ie=>({...ie,billStatus:b.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"},children:[c.jsx("option",{value:"",children:"All Bill Status"}),c.jsx("option",{value:"Yes",children:"To Be Billed"}),c.jsx("option",{value:"No",children:"Not Billing"}),c.jsx("option",{value:"Not Yet",children:"Not Yet"})]}),c.jsxs("select",{value:ue.invoiceStatus,onChange:b=>pe(ie=>({...ie,invoiceStatus:b.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"},children:[c.jsx("option",{value:"",children:"All Invoice Status"}),c.jsx("option",{value:"Pending",children:"Pending"}),c.jsx("option",{value:"Created",children:"Created"}),c.jsx("option",{value:"Approved",children:"Approved"}),c.jsx("option",{value:"Need Edits",children:"Need Edits"})]}),(ue.party||ue.billStatus||ue.invoiceStatus)&&c.jsxs("button",{onClick:()=>pe({party:"",billStatus:"",invoiceStatus:""}),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer"},children:[c.jsx(Sa,{size:14})," Clear"]})]})}),c.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"20px",justifyContent:"space-between",alignItems:"center"},children:[c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsxs("button",{onClick:()=>j("open"),style:{padding:"10px 20px",fontSize:"13px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:W==="open"?"#2874A6":"#E2E8F0",color:W==="open"?"#FFFFFF":"#64748B"},children:["Open (",U.length,")"]}),c.jsxs("button",{onClick:()=>j("closed"),style:{padding:"10px 20px",fontSize:"13px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:W==="closed"?"#22C55E":"#E2E8F0",color:W==="closed"?"#FFFFFF":"#64748B"},children:["Closed (",q.length,")"]})]}),c.jsx("button",{onClick:()=>{xe.size===N.length?fe(new Set):fe(new Set(N))},style:{padding:"8px 16px",fontSize:"12px",fontWeight:"600",border:"1px solid #CBD5E1",borderRadius:"6px",cursor:"pointer",backgroundColor:"#F8FAFC",color:"#475569"},children:xe.size===N.length?"Collapse All":"Expand All"})]}),c.jsx(gn,{title:`Services - ${W==="open"?"Open":"Closed"}`,noPadding:!0,children:N.length===0?c.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:[c.jsx(im,{size:40,style:{marginBottom:"10px",opacity:.5}}),c.jsx("p",{children:"No services in this tab"}),_&&c.jsx("p",{style:{marginTop:"10px",fontSize:"13px"},children:"Upload Excel or Add Entry to get started"})]}):N.map(b=>{const ie=se[b],J=xe.has(b),oe=ie.filter(K=>K.toBeBilled==="Yes").reduce((K,ee)=>K+(parseFloat(ee.totalWithGst)||parseFloat(ee.invoiceAmount)||0),0);return c.jsxs("div",{style:{borderBottom:"2px solid #E2E8F0"},children:[c.jsxs("div",{onClick:()=>M4(b),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",backgroundColor:W==="closed"?"#F0FDF4":"#F8FAFC",cursor:"pointer",borderBottom:J?"3px solid #2874A6":"none"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[J?c.jsx(rm,{size:20,color:"#2874A6"}):c.jsx($0,{size:20,color:"#64748B"}),c.jsx("span",{style:{fontWeight:"700",fontSize:"15px",color:"#1E293B"},children:b}),c.jsxs("span",{style:{padding:"4px 10px",backgroundColor:"#E0E7FF",color:"#3730A3",borderRadius:"9999px",fontSize:"12px",fontWeight:"600"},children:[ie.length," items"]})]}),c.jsx("div",{style:{fontWeight:"700",color:"#059669"},children:nt(oe)})]}),J&&c.jsx("div",{style:{overflowX:"auto"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F1F5F9"},children:[c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569"},children:"Date"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#6B21A8",backgroundColor:"#FAF5FF"},children:"Code"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569"},children:"State"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569"},children:"Type of Service"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569"},children:"Emails"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"Mailer"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"PO?"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"To Bill"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"600",color:"#475569"},children:"Amount"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"Create"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569",backgroundColor:"#EFF6FF"},children:"Invoice No"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569",backgroundColor:"#EFF6FF"},children:"Inv Date"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"600",color:"#475569",backgroundColor:"#EFF6FF"},children:"Inv Amt"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"Approval"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"Actions"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569",backgroundColor:"#F0FDF4"},children:"Mailed"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569",backgroundColor:"#F0FDF4"},children:"Mail Date"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569",backgroundColor:"#FEF3C7"},children:"Receipt"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"600",color:"#475569",backgroundColor:"#FEF3C7"},children:"Received"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"600",color:"#475569",backgroundColor:"#FEF3C7"},children:"TDS"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"600",color:"#475569",backgroundColor:"#FEF3C7"},children:"Balance"})]})}),c.jsx("tbody",{children:ie.map(K=>{const ee=Ct[K.id]&&Ct[K.id].length>0;[K.emailId,...K.additionalEmails||[]].filter(Boolean);const tt=K.clientCode||rn(K.partyName,K.statePartyDetails),ae=Vr.filter(Je=>Je.invoiceNo===K.invoiceNo),Se=ae.reduce((Je,rt)=>Je+(parseFloat(rt.amount)||0),0),Ce=ae.reduce((Je,rt)=>Je+(parseFloat(rt.tds)||parseFloat(rt.tdsAmount)||0),0),Qe=(parseFloat(K.invoiceTotalAmount)||0)-Se-Ce;return c.jsxs("tr",{style:{backgroundColor:K.toBeBilled==="Yes"?K.invoiceGenerated?"#F0FDF4":"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #F1F5F9"},children:[c.jsx("td",{style:{padding:"10px 8px",whiteSpace:"nowrap"},children:_t(K.date)}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center",backgroundColor:"#FAF5FF"},children:c.jsx("span",{style:{fontWeight:"700",color:"#6B21A8",fontSize:"11px"},children:tt||"-"})}),c.jsx("td",{style:{padding:"10px 8px",fontSize:"11px",color:"#64748B"},children:K.statePartyDetails||"-"}),c.jsx("td",{style:{padding:"10px 8px",fontWeight:"600",maxWidth:"180px"},children:c.jsx("div",{style:{color:"#1E293B"},children:K.serviceType||K.campaignName||"-"})}),c.jsx("td",{style:{padding:"10px 8px"},children:c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[K.emailId&&c.jsx("div",{style:{fontSize:"11px",color:"#1E40AF",backgroundColor:"#EFF6FF",padding:"2px 6px",borderRadius:"4px",display:"inline-block"},children:K.emailId}),(K.additionalEmails||[]).map((Je,rt)=>c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[c.jsx("span",{style:{fontSize:"11px",color:"#059669",backgroundColor:"#F0FDF4",padding:"2px 6px",borderRadius:"4px"},children:Je}),_&&c.jsx("button",{onClick:()=>td(K.id,"additionalEmails",(K.additionalEmails||[]).filter(kt=>kt!==Je)),style:{background:"none",border:"none",cursor:"pointer",padding:"2px",color:"#DC2626"},title:"Remove",children:c.jsx(Sa,{size:12})})]},rt)),_&&c.jsxs("button",{onClick:()=>{rr(K),xs(""),Dr(!0)},style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",color:"#2874A6",background:"none",border:"none",cursor:"pointer",padding:"2px 0"},children:[c.jsx(sm,{size:12})," Add"]})]})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:ee?c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[c.jsx("span",{style:{color:"#22C55E",fontWeight:"700",fontSize:"14px"},children:""}),_&&c.jsx("button",{onClick:()=>{rr(K),Vs(null),wo(!0),Oi(!0)},style:{fontSize:"10px",color:"#64748B",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},children:"Replace"})]}):_&&c.jsx(Ke,{icon:Z_,small:!0,variant:"default",onClick:()=>{rr(K),Vs(null),wo(!1),Oi(!0)}})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:K.poStatus==="With PO"?c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[c.jsx("span",{style:{color:"#22C55E",fontWeight:"600",fontSize:"10px"},children:" PO"}),c.jsx("span",{style:{fontSize:"9px",color:"#1E40AF",fontWeight:"600"},children:K.poNumber}),K.poDate&&c.jsx("span",{style:{fontSize:"9px",color:"#64748B"},children:_t(K.poDate)})]}):c.jsx("span",{style:{color:"#CBD5E1",fontSize:"10px"},children:"No PO"})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:c.jsxs("select",{value:K.toBeBilled,onChange:Je=>td(K.id,"toBeBilled",Je.target.value),disabled:K.invoiceGenerated||!h,style:{padding:"6px 8px",fontSize:"12px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:K.toBeBilled==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:K.toBeBilled==="Yes"?"#DCFCE7":"#FFFFFF",color:K.toBeBilled==="Yes"?"#166534":"#64748B",cursor:K.invoiceGenerated||!h?"not-allowed":"pointer",width:"70px",opacity:!h&&!K.invoiceGenerated?.6:1},children:[c.jsx("option",{value:"Not Yet",children:"Not Yet"}),c.jsx("option",{value:"Yes",children:"Yes"})]})}),c.jsx("td",{style:{padding:"10px 8px"},children:c.jsx("input",{type:"number",value:K.invoiceAmount||"",onChange:Je=>td(K.id,"invoiceAmount",Je.target.value),disabled:K.invoiceGenerated,placeholder:"0",style:{width:"80px",padding:"6px 8px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #D1D5DB",borderRadius:"6px",textAlign:"right",backgroundColor:K.invoiceGenerated?"#F3F4F6":"#FFFFFF"}})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:K.toBeBilled==="Yes"&&!K.invoiceGenerated&&K.invoiceAmount&&_?c.jsx(Ke,{icon:Po,label:"Create",small:!0,variant:"warning",onClick:()=>B4(K.id)}):K.toBeBilled==="Yes"&&!K.invoiceGenerated&&K.invoiceAmount&&h?c.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Finance to create"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 8px",backgroundColor:"#EFF6FF"},children:K.invoiceNo?c.jsx("span",{style:{fontWeight:"700",color:"#1E40AF",fontSize:"12px"},children:K.invoiceNo}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 8px",backgroundColor:"#EFF6FF",fontSize:"12px"},children:K.invoiceDate?_t(K.invoiceDate):"-"}),c.jsx("td",{style:{padding:"10px 8px",backgroundColor:"#EFF6FF",textAlign:"right",fontWeight:"700",color:"#1E40AF",fontSize:"13px"},children:K.invoiceTotalAmount?Ot(K.invoiceTotalAmount):"-"}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:K.invoiceGenerated?h?c.jsx("button",{onClick:()=>Tn(K),style:{padding:"5px 10px",fontSize:"11px",fontWeight:"700",border:"1.5px solid",borderRadius:"6px",cursor:"pointer",backgroundColor:K.invoiceStatus==="Approved"?"#DCFCE7":K.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",borderColor:K.invoiceStatus==="Approved"?"#22C55E":K.invoiceStatus==="Need Edits"?"#DC2626":"#F59E0B",color:K.invoiceStatus==="Approved"?"#166534":K.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:K.invoiceStatus==="Approved"?" Approved":K.invoiceStatus==="Need Edits"?" Need Edits":" Review"}):c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px"},children:[c.jsx("span",{style:{padding:"4px 10px",fontSize:"11px",fontWeight:"700",borderRadius:"6px",backgroundColor:K.invoiceStatus==="Approved"?"#DCFCE7":K.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",color:K.invoiceStatus==="Approved"?"#166534":K.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:K.invoiceStatus==="Approved"?" Approved":K.invoiceStatus==="Need Edits"?" Need Edits":" Pending"}),(K.editComments||K.approvalRemarks)&&c.jsx("button",{onClick:()=>{rr(K),Rn(!0)},style:{fontSize:"9px",color:K.invoiceStatus==="Need Edits"?"#991B1B":"#166534",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},title:K.editComments||K.approvalRemarks,children:"View Remarks"})]}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:K.invoiceGenerated&&K.invoiceStatus==="Approved"?c.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[c.jsx(Ke,{icon:Pc,small:!0,onClick:()=>pg(K),title:"View Invoice"}),_&&c.jsx(Ke,{icon:K0,small:!0,variant:"brand",onClick:()=>{rr(K),jr(!0)},title:"Send Email"}),_&&c.jsx(Ke,{icon:ns,small:!0,variant:"danger",onClick:()=>hg(K.id),title:"Delete"})]}):K.invoiceGenerated?c.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[c.jsx(Ke,{icon:Pc,small:!0,onClick:()=>pg(K),title:"View Invoice"}),_&&c.jsx(Ke,{icon:ns,small:!0,variant:"danger",onClick:()=>hg(K.id),title:"Delete"})]}):_?c.jsx(Ke,{icon:ns,small:!0,variant:"danger",onClick:()=>hg(K.id),title:"Delete"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center",backgroundColor:"#F0FDF4"},children:K.invoiceGenerated&&K.invoiceStatus==="Approved"&&_?c.jsxs("select",{value:K.mailingSent||"No",onChange:Je=>td(K.id,"mailingSent",Je.target.value),style:{padding:"5px 8px",fontSize:"11px",fontWeight:"700",border:"2px solid",borderRadius:"6px",borderColor:K.mailingSent==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:K.mailingSent==="Yes"?"#DCFCE7":"#FFFFFF",color:K.mailingSent==="Yes"?"#166534":"#64748B",cursor:"pointer",width:"60px"},children:[c.jsx("option",{value:"No",children:"No"}),c.jsx("option",{value:"Yes",children:"Yes"})]}):K.invoiceGenerated&&K.invoiceStatus==="Approved"&&h?c.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"11px",fontWeight:"600",backgroundColor:K.mailingSent==="Yes"?"#DCFCE7":"#FEF3C7",color:K.mailingSent==="Yes"?"#166534":"#92400E"},children:K.mailingSent==="Yes"?" Yes":" No"}):K.invoiceGenerated&&K.invoiceStatus!=="Approved"?c.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Approve first"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center",backgroundColor:"#F0FDF4"},children:K.mailingSent==="Yes"?_?c.jsx("input",{type:"date",value:K.mailDate||"",onChange:Je=>td(K.id,"mailDate",Je.target.value),style:{padding:"4px 6px",fontSize:"11px",border:"1px solid #D1D5DB",borderRadius:"4px",width:"110px"}}):c.jsx("span",{style:{fontSize:"11px"},children:K.mailDate?_t(K.mailDate):"-"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center",backgroundColor:"#FEF3C7"},children:K.invoiceGenerated&&K.invoiceStatus==="Approved"?ae.length>0?c.jsx("span",{style:{fontSize:"11px",color:"#166534",fontWeight:"600"},children:ae.map(Je=>Je.receiptNo).join(", ")}):_?c.jsx(Ke,{icon:tE,small:!0,variant:"warning",onClick:()=>{rr(K),setReceiptData({date:new Date().toISOString().split("T")[0],amount:"",tds:"",paymentMode:"Bank Transfer",narration:""}),ms(!0)},title:"Post Receipt"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"right",backgroundColor:"#FEF3C7",fontWeight:"600",color:Se>0?"#166534":"#CBD5E1"},children:Se>0?Ot(Se):"-"}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"right",backgroundColor:"#FEF3C7",fontWeight:"600",color:Ce>0?"#1E40AF":"#CBD5E1"},children:Ce>0?Ot(Ce):"-"}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"right",backgroundColor:"#FEF3C7",fontWeight:"700",color:Qe>0?"#DC2626":"#166534"},children:K.invoiceGenerated?Qe>0?Ot(Qe):" Paid":"-"})]},K.id)})})]})})]},b)})}),L.length>0&&c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"16px"},children:c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"16px 24px",borderRadius:"10px",border:"2px solid #86EFAC"},children:[c.jsx("div",{style:{fontSize:"12px",color:"#166534",fontWeight:"600",marginBottom:"4px"},children:"To Be Billed Total"}),c.jsx("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:nt(L.filter(b=>b.toBeBilled==="Yes").reduce((b,ie)=>b+(parseFloat(ie.totalWithGst)||parseFloat(ie.invoiceAmount)||0),0))})]})}),c.jsx(Bn,{isOpen:V,onClose:()=>G(!1),title:" Add Service Entry",width:"600px",children:c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Date *"}),c.jsx("input",{type:"date",id:"svcDate",defaultValue:new Date().toISOString().split("T")[0],style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"State *"}),c.jsx("input",{type:"text",id:"svcState",placeholder:"Maharashtra",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Party Name *"}),c.jsx("input",{list:"svcPartyList",id:"svcParty",placeholder:"Party name",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}}),c.jsx("datalist",{id:"svcPartyList",children:Object.values(tn).map((b,ie)=>c.jsx("option",{value:b.partyName},ie))})]}),c.jsxs("div",{children:[c.jsxs("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:["Type of Service * ",c.jsx("span",{style:{color:"#64748B",fontWeight:"400"},children:"(This will appear as narration in invoice)"})]}),c.jsx("input",{type:"text",id:"svcType",placeholder:"e.g. PODCAST PRODUCTION, VIDEO EDITING, SOCIAL MEDIA MANAGEMENT",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px",textTransform:"uppercase"}})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Email"}),c.jsx("input",{type:"email",id:"svcEmail",placeholder:"email@example.com",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Amount (without GST)"}),c.jsx("input",{type:"number",id:"svcAmount",placeholder:"0",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]})]}),c.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"8px"},children:[c.jsx(Ke,{label:"Cancel",variant:"secondary",onClick:()=>G(!1)}),c.jsx(Ke,{label:"Add Entry",icon:pd,onClick:()=>{var oe,K,ee,tt,ae,Se,Ce,Be,Qe;const b=(K=(oe=document.getElementById("svcParty"))==null?void 0:oe.value)==null?void 0:K.trim(),ie=(ae=(tt=(ee=document.getElementById("svcType"))==null?void 0:ee.value)==null?void 0:tt.trim())==null?void 0:ae.toUpperCase();if(!b||!ie){alert("Fill required fields (Party Name and Type of Service)");return}const J={id:Date.now().toString(),sno:Ur.length+1,date:((Se=document.getElementById("svcDate"))==null?void 0:Se.value)||new Date().toISOString().split("T")[0],statePartyDetails:((Ce=document.getElementById("svcState"))==null?void 0:Ce.value)||"",partyName:b,serviceType:ie,emailId:((Be=document.getElementById("svcEmail"))==null?void 0:Be.value)||"",additionalEmails:[],toBeBilled:"Not Yet",invoiceAmount:((Qe=document.getElementById("svcAmount"))==null?void 0:Qe.value)||"",cgst:"",sgst:"",igst:"",totalWithGst:"",invoiceType:"Individual",invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",mailingSent:"No",mailDate:"",mailerUploaded:!1,editComments:"",approvalRemarks:"",isService:!0};Ae(Je=>[...Je,J]),fe(Je=>new Set([...Je,b])),G(!1)}})]})]})})]})},U4=h=>{const _=[],U=ie=>{if(!ie)return"";const J=ie.split("/");return J.length>=3?J.slice(1).join("/"):J.length===2?J.join("/"):J[J.length-1]},q=Gn.filter(ie=>{var J;return ie.isHistorical&&(ie.type==="creditnote"||((J=ie.vchNo)==null?void 0:J.toUpperCase().startsWith("CN")))}),L=new Map;Ai.forEach(ie=>{const J=U(ie.invoiceNo);J&&L.set(J,{...ie,isSystemCN:!0})}),q.forEach(ie=>{const J=U(ie.vchNo);J&&!L.has(J)&&L.set(J,{...ie,isHistoricalCN:!0})});const se={};h.forEach(ie=>{const J=ie.partyName||"Unknown";se[J]||(se[J]=[]),se[J].push(ie)}),Object.keys(se).sort().forEach(ie=>{se[ie].forEach(oe=>{const K=U(oe.invoiceNo),ee=L.get(K),tt=ee?Math.abs(parseFloat(ee.totalAmount||ee.credit||ee.debit)||0):0,ae=Vr.filter(rt=>rt.invoiceNo===oe.invoiceNo),Se=ae.reduce((rt,kt)=>rt+(parseFloat(kt.amount)||0),0),Ce=ae.reduce((rt,kt)=>rt+(parseFloat(kt.tds||kt.tdsAmount)||0),0),Be=oe.totalAmount-Se-Ce-tt;let Qe="Pending";tt>=oe.totalAmount?Qe="Cancelled":Be<=0?Qe="Paid":(Se>0||Ce>0||tt>0)&&(Qe="Partial");let Je=oe.poStatus==="With PO"?`${oe.poNumber||""}${oe.poDate?`
`+_t(oe.poDate):""}`:"Without PO";_.push({"Client Code":oe.clientCode||"","Party Name":ie,"Invoice No":oe.invoiceNo,Date:_t(oe.date),Type:oe.isService?"Service":oe.invoiceType||"Individual","PO?":Je,Amount:oe.totalAmount,Received:Se||"",TDS:Ce||"","CN Amount":tt||"",Balance:Be>0?Be:0,"Invoice Status":oe.invoiceStatus,"Receipt Status":Qe,"Receipt No":ae.map(rt=>rt.receiptNo).join(", "),"CN No":ee?ee.isSystemCN?ee.creditNoteNo:ee.vchNo:""})})});const N=Er.json_to_sheet(_),b=Er.book_new();Er.book_append_sheet(b,N,"Invoice Register"),Dc(b,`Invoice_Register_${new Date().toISOString().split("T")[0]}.xlsx`)},V4=()=>{const h=Er.book_new();let _=0;const U=q=>{if(!q)return"";const L=q.split("/");return L.length>=3?L.slice(1).join("/"):L.length===2?L.join("/"):L[L.length-1]};if(d.forEach(q=>{const L=q.partyName,se=q.normalizedState,N=q.clientCode||"",b=$n[L]||0,ie=Ie=>N?(Ie.clientCode||rn(Ie.partyName,Ie.statePartyDetails))===N:!0,J=[...Sn,...Ur].filter(Ie=>Ht(Ie.partyName,L)&&Ie.invoiceGenerated&&Ie.invoiceStatus==="Approved"&&ie(Ie)&&(!se||ni(Ie.statePartyDetails)===se)),oe=new Map;J.forEach(Ie=>{oe.has(Ie.invoiceNo)?oe.get(Ie.invoiceNo).campaigns.push(Ie):oe.set(Ie.invoiceNo,{invoiceNo:Ie.invoiceNo,invoiceDate:Ie.invoiceDate,campaigns:[Ie],statePartyDetails:Ie.statePartyDetails})});const K=new Set(Array.from(oe.keys())),ee=Vr.filter(Ie=>Ht(Ie.partyName,L)&&(!se||K.has(Ie.invoiceNo))),tt=Ai.filter(Ie=>Ht(Ie.partyName,L)&&(!se||K.has(Ie.invoiceNo))),ae=se?[]:Gn.filter(Ie=>{var gt;return Ht(Ie.partyName,L)&&Ie.isHistorical&&!((gt=Ie.vchNo)!=null&&gt.toUpperCase().startsWith("CN"))}),Se=se?[]:Gn.filter(Ie=>{var gt;return Ht(Ie.partyName,L)&&Ie.isHistorical&&((gt=Ie.vchNo)==null?void 0:gt.toUpperCase().startsWith("CN"))}),Ce=new Map;tt.forEach(Ie=>{const gt=U(Ie.invoiceNo);gt&&Ce.set(gt,{...Ie,isSystemCN:!0})}),Se.forEach(Ie=>{const gt=U(Ie.vchNo);gt&&!Ce.has(gt)&&Ce.set(gt,Ie)});const Be=[];let Qe=b,Je=0,rt=0,kt=0,$t=0;const ze=new Set;Be.push([N?`[${N}] ${L}`:L]),Be.push(["Ledger Account"]),q.address&&Be.push([q.address]),q.state&&Be.push([q.state]),q.gstin&&Be.push(["GSTIN: "+q.gstin]),Be.push([]),Be.push(["Date","Particular","Vch Type","Vch No.","Debit","Credit","Date of Receipt","Amount Received","TDS Received","Balance","Payment Status"]),b!==0&&(Be.push(["","Opening Balance","","",b>0?b:"",b<0?Math.abs(b):"","","","",b,""]),b>0?Je+=b:rt+=Math.abs(b));const ct=[];if(Array.from(oe.values()).forEach(Ie=>{ct.push({...Ie,entryType:"invoice",sortDate:Ie.invoiceDate})}),ae.forEach(Ie=>{ct.push({...Ie,entryType:"historical",sortDate:Ie.date})}),ct.sort((Ie,gt)=>new Date(Ie.sortDate)-new Date(gt.sortDate)),ct.forEach(Ie=>{var gt;if(Ie.entryType==="invoice"){const ut=Ie,dt=ut.campaigns.reduce((sn,an)=>sn+(parseFloat(an.invoiceAmount)||0),0),Bt=(gt=ut.statePartyDetails)==null?void 0:gt.toUpperCase().includes("MAHARASHTRA"),Ut=Bt?dt*.09:0,Gt=Bt?dt*.09:0,dr=Bt?0:dt*.18,hn=dt+Ut+Gt+dr,lr=ee.filter(sn=>sn.invoiceNo===ut.invoiceNo),kr=lr.reduce((sn,an)=>sn+(parseFloat(an.amount)||0),0),Ft=lr.reduce((sn,an)=>sn+(parseFloat(an.tds||an.tdsAmount)||0),0),nn=lr.length>0?_t(lr[0].date):"",or=U(ut.invoiceNo),On=Ce.get(or),Mn=On?Math.abs(parseFloat(On.totalAmount||On.credit)||0):0,zr=!!On;let zi="Pending",An=hn-kr-Ft;if(zr&&Mn>=hn?(zi="CN Closed",An=0):(kr>0||Ft>0)&&(zi="Received"),Qe+=hn,Je+=hn,Be.push([_t(ut.invoiceDate),L,"Sales",ut.invoiceNo,hn,"",nn,kr||"",Ft||"",zr?"-":An,zi]),Be.push(["","    PROMOTIONAL TRADE EMAILER"+(ut.campaigns.length>1?"S":""),"","","",dt,"","","","",""]),Bt?(Be.push(["","    CGST","","","",Ut,"","","","",""]),Be.push(["","    SGST","","","",Gt,"","","","",""])):Be.push(["","    IGST","","","",dr,"","","","",""]),(kr>0||Ft>0)&&(Qe-=kr+Ft,kt+=kr,$t+=Ft),On&&!ze.has(or)){ze.add(or),Qe-=Mn,rt+=Mn,Be.push([_t(On.date),L,"Credit Note",On.creditNoteNo||On.vchNo,"",Mn,"","","","-",""]);const sn=Mn/1.18,an=Mn-sn;Be.push(["","    PROMOTIONAL TRADE EMAILER","","","",sn,"","","","",""]),Bt?Be.push(["","    CGST/SGST","","","",an,"","","","",""]):Be.push(["","    IGST","","","",an,"","","","",""])}}else if(Ie.entryType==="historical"){const ut=Ie,dt=parseFloat(ut.debit)||0,Bt=U(ut.vchNo),Ut=Ce.get(Bt),Gt=!!Ut;if(Qe+=dt,Je+=dt,Be.push([_t(ut.date),ut.particular||L,ut.vchType||"Sales",ut.vchNo||"",dt,"",ut.receiptDate?_t(ut.receiptDate):"",ut.amountReceived||"",ut.tdsReceived||"",Gt?"-":Qe,Gt?"CN Closed":ut.paymentStatus||""]),Ut&&!ze.has(Bt)){ze.add(Bt);const dr=Math.abs(parseFloat(Ut.totalAmount||Ut.credit||Ut.debit)||0);Qe-=dr,rt+=dr,Be.push([_t(Ut.date),L,"Credit Note",Ut.creditNoteNo||Ut.vchNo,"",dr,"","","","-",""])}}}),Be.length<=7)return;Be.push([]),Be.push(["","TOTAL","","",Je,rt,"",kt,$t,"",""]),Be.push(["","Closing Balance","","",Qe>0?Qe:"",Qe<0?Math.abs(Qe):"","","","",Qe,""]);let zt=L.substring(0,25).replace(/[\\\/\*\?\[\]:]/g,"");se&&(zt+="-"+se.substring(0,4));let Pt=zt,ge=1;for(;h.SheetNames.includes(Pt);)Pt=zt.substring(0,27)+ge++;const de=Er.aoa_to_sheet(Be);Er.book_append_sheet(h,de,Pt),_++}),_===0){alert("No ledger data to export");return}Dc(h,`All_Ledgers_${new Date().toISOString().split("T")[0]}.xlsx`)},z4=()=>{const h=N=>{const b=parseFloat(N.totalAmount)||0;let ie=parseFloat(N.baseAmount)||parseFloat(N.amount)||0,J=parseFloat(N.gst)||(parseFloat(N.cgstAmount)||0)+(parseFloat(N.sgstAmount)||0)+(parseFloat(N.igstAmount)||0);return ie===0&&b>0&&(ie=b/1.18,J=b-ie),{base:ie,gst:J,total:b}},_=Vr.map(N=>{const b=parseFloat(N.amount)||0,ie=parseFloat(N.tds)||parseFloat(N.tdsAmount)||0;return{Type:"Receipt","Client Code":N.clientCode||rn(N.partyName,N.statePartyDetails||""),"Voucher No":N.receiptNo,Date:_t(N.date),"Party Name":N.partyName,"Against Invoice":N.invoiceNo,Amount:b,TDS:ie,Total:b+ie,"Payment Mode":N.paymentMode||N.mode||"Bank Transfer",Narration:N.narration||""}}),U=Ai.map(N=>{const b=h(N);return{Type:"Credit Note","Client Code":N.clientCode||rn(N.partyName,N.statePartyDetails||""),"Voucher No":N.creditNoteNo,Date:_t(N.date),"Party Name":N.partyName,"Against Invoice":N.invoiceNo,"Base Amount":b.base,GST:b.gst,Total:b.total,Reason:N.reason||""}}),q=Er.book_new();if(_.length>0){const N=Er.json_to_sheet(_);Er.book_append_sheet(q,N,"Receipts")}if(U.length>0){const N=Er.json_to_sheet(U);Er.book_append_sheet(q,N,"Credit Notes")}const L=[..._.map(N=>({...N,"Base Amount":"",GST:"",Reason:""})),...U.map(N=>({Type:N.Type,"Client Code":N["Client Code"],"Voucher No":N["Voucher No"],Date:N.Date,"Party Name":N["Party Name"],"Against Invoice":N["Against Invoice"],Amount:N["Base Amount"],TDS:N.GST,Total:N.Total,"Payment Mode":"",Narration:N.Reason}))],se=Er.json_to_sheet(L);Er.book_append_sheet(q,se,"Combined"),Dc(q,`Receipt_CN_Register_${new Date().toISOString().split("T")[0]}.xlsx`)},W4=h=>{const _=parseFloat(h.amount)||0,U=parseFloat(h.tds)||parseFloat(h.tdsAmount)||0,q=_+U,L=h.clientCode||rn(h.partyName,h.statePartyDetails||""),se=`<!DOCTYPE html><html><head><title>Receipt - ${h.receiptNo}</title><style>@media print{@page{size:A5;margin:10mm}}*{margin:0;padding:0;box-sizing:border-box}body{font-family:Arial,sans-serif;font-size:12px;padding:20px}.voucher{max-width:600px;margin:0 auto;border:2px solid #000}.header{text-align:center;padding:15px;border-bottom:2px solid #000;background:#f5f5f5}.title{font-size:18px;font-weight:bold;color:#1a5276}.company{font-size:14px;font-weight:bold;margin-top:5px}.details{padding:15px}.row{display:flex;margin-bottom:10px}.label{width:140px;font-weight:bold}.value{flex:1}.amount-box{background:#e8f4fd;padding:15px;margin:15px 0;border-radius:8px;text-align:center}.amount{font-size:24px;font-weight:bold;color:#1a5276}.footer{padding:15px;border-top:1px solid #ddd;display:flex;justify-content:space-between}.signature{text-align:center;margin-top:40px}.signature-line{border-top:1px solid #000;width:150px;margin:0 auto;padding-top:5px}.client-code{background:#f3e8ff;color:#6b21a8;padding:3px 8px;border-radius:4px;font-weight:bold;font-size:11px}</style></head><body><div class="voucher"><div class="header"><div class="title">RECEIPT VOUCHER</div><div class="company">${w.name}</div><div style="font-size:10px;color:#666;margin-top:3px">${w.address}, ${w.city}</div></div><div class="details"><div class="row"><div class="label">Receipt No:</div><div class="value" style="font-weight:bold;color:#1a5276">${h.receiptNo}</div></div><div class="row"><div class="label">Date:</div><div class="value">${_t(h.date)}</div></div>${L?`<div class="row"><div class="label">Client Code:</div><div class="value"><span class="client-code">${L}</span></div></div>`:""}<div class="row"><div class="label">Received From:</div><div class="value" style="font-weight:bold">${h.partyName}</div></div><div class="row"><div class="label">Against Invoice:</div><div class="value">${h.invoiceNo}</div></div><div class="row"><div class="label">Payment Mode:</div><div class="value">${h.paymentMode||h.mode||"Bank Transfer"}</div></div>${h.narration?`<div class="row"><div class="label">Narration:</div><div class="value">${h.narration}</div></div>`:""}<div class="amount-box"><div style="font-size:12px;color:#666">Amount Received</div><div class="amount">${_.toLocaleString("en-IN",{minimumFractionDigits:2})}</div>${U>0?`<div style="font-size:11px;color:#666;margin-top:5px">TDS: ${U.toLocaleString("en-IN",{minimumFractionDigits:2})}</div>`:""}<div style="font-size:11px;margin-top:8px"><strong>Total:</strong> ${q.toLocaleString("en-IN",{minimumFractionDigits:2})}</div></div><div style="font-size:11px;color:#666;margin-top:10px"><strong>Amount in words:</strong> ${th(q)}</div></div><div class="footer"><div class="signature"><div class="signature-line">Receiver's Signature</div></div><div class="signature"><div class="signature-line">Authorised Signatory</div></div></div></div></body></html>`,N=window.open("","_blank");N.document.write(se),N.document.close(),N.print()},H4=h=>{const _=parseFloat(h.totalAmount)||0;let U=parseFloat(h.baseAmount)||parseFloat(h.amount)||0,q=parseFloat(h.gst)||(parseFloat(h.cgstAmount)||0)+(parseFloat(h.sgstAmount)||0)+(parseFloat(h.igstAmount)||0);U===0&&_>0&&(U=_/1.18,q=_-U);const L=h.clientCode||rn(h.partyName,h.statePartyDetails||""),se=`<!DOCTYPE html><html><head><title>CN - ${h.creditNoteNo}</title><style>@media print{@page{size:A5;margin:10mm}}*{margin:0;padding:0;box-sizing:border-box}body{font-family:Arial,sans-serif;font-size:12px;padding:20px}.voucher{max-width:600px;margin:0 auto;border:2px solid #000}.header{text-align:center;padding:15px;border-bottom:2px solid #000;background:#fef3c7}.title{font-size:18px;font-weight:bold;color:#92400e}.company{font-size:14px;font-weight:bold;margin-top:5px}.details{padding:15px}.row{display:flex;margin-bottom:10px}.label{width:140px;font-weight:bold}.value{flex:1}.amount-box{background:#fef3c7;padding:15px;margin:15px 0;border-radius:8px;text-align:center}.amount{font-size:24px;font-weight:bold;color:#92400e}.footer{padding:15px;border-top:1px solid #ddd;display:flex;justify-content:space-between}.signature{text-align:center;margin-top:40px}.signature-line{border-top:1px solid #000;width:150px;margin:0 auto;padding-top:5px}.client-code{background:#f3e8ff;color:#6b21a8;padding:3px 8px;border-radius:4px;font-weight:bold;font-size:11px}</style></head><body><div class="voucher"><div class="header"><div class="title">CREDIT NOTE</div><div class="company">${w.name}</div><div style="font-size:10px;color:#666;margin-top:3px">${w.address}, ${w.city}</div></div><div class="details"><div class="row"><div class="label">Credit Note No:</div><div class="value" style="font-weight:bold;color:#92400e">${h.creditNoteNo}</div></div><div class="row"><div class="label">Date:</div><div class="value">${_t(h.date)}</div></div>${L?`<div class="row"><div class="label">Client Code:</div><div class="value"><span class="client-code">${L}</span></div></div>`:""}<div class="row"><div class="label">Party Name:</div><div class="value" style="font-weight:bold">${h.partyName}</div></div><div class="row"><div class="label">Against Invoice:</div><div class="value">${h.invoiceNo}</div></div><div class="row"><div class="label">Reason:</div><div class="value">${h.reason||"Adjustment"}</div></div><div class="amount-box"><div style="font-size:12px;color:#666">Credit Amount</div><div class="amount">${_.toLocaleString("en-IN",{minimumFractionDigits:2})}</div><div style="font-size:10px;color:#666;margin-top:5px">Base: ${U.toLocaleString("en-IN",{minimumFractionDigits:2})} | GST: ${q.toLocaleString("en-IN",{minimumFractionDigits:2})}</div></div><div style="font-size:11px;color:#666;margin-top:10px"><strong>Amount in words:</strong> ${th(_)}</div></div><div class="footer"><div class="signature"><div class="signature-line">Party Signature</div></div><div class="signature"><div class="signature-line">Authorised Signatory</div></div></div></div></body></html>`,N=window.open("","_blank");N.document.write(se),N.document.close(),N.print()},$4=()=>{const h=new Map;Sn.filter(J=>J.invoiceGenerated).forEach(J=>{if(h.has(J.invoiceNo))h.get(J.invoiceNo).campaigns.push(J);else{const oe=J.clientCode||rn(J.partyName,J.statePartyDetails);h.set(J.invoiceNo,{invoiceNo:J.invoiceNo,partyName:J.partyName,clientCode:oe,statePartyDetails:J.statePartyDetails,date:J.invoiceDate,invoiceType:J.invoiceType,combinationCode:J.combinationCode,invoiceStatus:J.invoiceStatus,mailingSent:J.mailingSent,receiptStatus:J.receiptStatus||"Pending",receiptNo:J.receiptNo,campaigns:[J],totalAmount:parseFloat(J.invoiceTotalAmount)||0,isFromMaster:!0,source:"Campaign",poStatus:J.poStatus,poNumber:J.poNumber,poDate:J.poDate})}}),Ur.filter(J=>J.invoiceGenerated).forEach(J=>{if(!h.has(J.invoiceNo)){const oe=J.clientCode||rn(J.partyName,J.statePartyDetails);h.set(J.invoiceNo,{invoiceNo:J.invoiceNo,partyName:J.partyName,clientCode:oe,statePartyDetails:J.statePartyDetails,date:J.invoiceDate,invoiceType:"Service",combinationCode:"NA",invoiceStatus:J.invoiceStatus,mailingSent:J.mailingSent,receiptStatus:J.receiptStatus||"Pending",receiptNo:J.receiptNo,campaigns:[J],totalAmount:parseFloat(J.invoiceTotalAmount)||0,isFromMaster:!1,isService:!0,source:"Service",serviceType:J.serviceType,poStatus:J.poStatus,poNumber:J.poNumber,poDate:J.poDate})}});const _=J=>{if(!J)return"";const oe=J.split("/");return oe.length>=3?oe.slice(1).join("/"):oe.length===2?oe.join("/"):oe[oe.length-1]},U=Gn.filter(J=>{var oe;return J.isHistorical&&(J.type==="creditnote"||((oe=J.vchNo)==null?void 0:oe.toUpperCase().startsWith("CN")))}),q=new Map;Ai.forEach(J=>{const oe=_(J.invoiceNo);oe&&q.set(oe,J)}),U.forEach(J=>{const oe=_(J.vchNo);oe&&!q.has(oe)&&q.set(oe,J)}),Gn.filter(J=>{var oe;return J.isHistorical&&J.type!=="creditnote"&&!((oe=J.vchNo)!=null&&oe.toUpperCase().startsWith("CN"))&&J.debit>0}).forEach(J=>{if(!h.has(J.vchNo)){const oe=Vr.find(Qe=>Qe.invoiceNo===J.vchNo),K=_(J.vchNo),ee=q.get(K),tt=ee?Math.abs(parseFloat(ee.totalAmount)||parseFloat(ee.credit)||parseFloat(ee.debit)||0):0,ae=parseFloat(J.debit)||0;if(ee&&tt>=ae)return;const Ce=!oe&&!(J.amountReceived>0),Be=ee&&tt>0&&tt<ae;if(Ce||Be){const Qe=Be?ae-tt:ae;h.set(J.vchNo,{invoiceNo:J.vchNo,partyName:J.partyName,date:J.date,invoiceType:"Historical",combinationCode:"",invoiceStatus:"Approved",mailingSent:"Yes",receiptStatus:Be?"Partial CN":"Pending",receiptNo:"",campaigns:[],totalAmount:ae,pendingAmount:Qe,hasPartialCN:Be,cnAmount:tt,isHistorical:!0,historicalEntry:J})}}});let L=Array.from(h.values());if(Ue.party&&(L=L.filter(J=>Ht(J.partyName,Ue.party))),Ue.invoiceStatus&&(L=L.filter(J=>J.invoiceStatus===Ue.invoiceStatus)),Ue.receiptStatus&&(Ue.receiptStatus==="Received"?L=L.filter(J=>J.receiptStatus==="Received"):Ue.receiptStatus==="Pending"&&(L=L.filter(J=>J.receiptStatus!=="Received"))),Ue.invoiceType&&(L=L.filter(J=>J.invoiceType===Ue.invoiceType)),Ue.searchText){const J=Ue.searchText.toLowerCase();L=L.filter(oe=>{var K,ee;return((K=oe.invoiceNo)==null?void 0:K.toLowerCase().includes(J))||((ee=oe.partyName)==null?void 0:ee.toLowerCase().includes(J))})}const se={};L.forEach(J=>{se[J.partyName]||(se[J.partyName]=[]),se[J.partyName].push(J)});const N=Object.keys(se).sort(),b=Ue.party||Ue.invoiceStatus||Ue.receiptStatus||Ue.invoiceType||Ue.searchText,ie=Array.from(h.values());return c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Invoice & Receipt Register"}),c.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[c.jsx(Ke,{icon:Do,label:"Export Excel",variant:"secondary",onClick:()=>U4(L)}),ii&&c.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"})]})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(hd,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"})]}),c.jsxs("div",{style:{position:"relative"},children:[c.jsx(X0,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",placeholder:"Search invoice...",value:Ue.searchText,onChange:J=>Oe(oe=>({...oe,searchText:J.target.value})),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"160px"}})]}),c.jsxs("select",{value:Ue.party,onChange:J=>Oe(oe=>({...oe,party:J.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Parties"}),Hs.map(J=>c.jsx("option",{value:J,children:J},J))]}),c.jsxs("select",{value:Ue.invoiceStatus,onChange:J=>Oe(oe=>({...oe,invoiceStatus:J.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Status"}),c.jsx("option",{value:"Created",children:"Created"}),c.jsx("option",{value:"Approved",children:"Approved"}),c.jsx("option",{value:"Need Edits",children:"Need Edits"})]}),c.jsxs("select",{value:Ue.receiptStatus,onChange:J=>Oe(oe=>({...oe,receiptStatus:J.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Receipts"}),c.jsx("option",{value:"Received",children:"Received"}),c.jsx("option",{value:"Pending",children:"Pending"})]}),c.jsxs("select",{value:Ue.invoiceType,onChange:J=>Oe(oe=>({...oe,invoiceType:J.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Types"}),c.jsx("option",{value:"Individual",children:"Individual"}),c.jsx("option",{value:"Combined",children:"Combined"})]}),b&&c.jsxs(c.Fragment,{children:[c.jsxs("button",{onClick:()=>Oe({party:"",invoiceStatus:"",receiptStatus:"",invoiceType:"",searchText:""}),style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(Sa,{size:14})," Clear"]}),c.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",L.length," of ",ie.length]})]})]})}),c.jsx(gn,{noPadding:!0,children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[c.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700",color:"#6B21A8",backgroundColor:"#FAF5FF"},children:"Code"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Date"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Type"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:"Amount"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#F0FDF4",color:"#166534"},children:"Received"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEF3C7",color:"#92400E"},children:"TDS"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:"CN Amt"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#EFF6FF",color:"#1E40AF"},children:"Balance"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Inv. Status"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Receipt No."}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"CN No."}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),c.jsx("tbody",{children:N.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:"13",style:{padding:"50px",textAlign:"center",color:"#94A3B8"},children:b?"No matching invoices":"No invoices generated yet"})}):N.map(J=>{var ae;const oe=se[J],K=l0.has(J);let ee=0;oe.forEach(Se=>{const Ce=je.find(Pt=>Pt.invoiceNo===Se.invoiceNo),Be=te.find(Pt=>Pt.invoiceNo===Se.invoiceNo),Qe=ne.find(Pt=>Pt.invoiceNo===Se.invoiceNo&&Pt.type==="tds"),Je=ne.find(Pt=>Pt.invoiceNo===Se.invoiceNo&&Pt.type==="discount"),rt=Se.totalAmount||0,kt=Ce&&parseFloat(Ce.amount)||0,$t=Qe?parseFloat(Qe.credit)||0:Ce&&parseFloat(Ce.tds)||0,ze=Be?Math.abs(parseFloat(Be.totalAmount)||0):0,ct=Je&&parseFloat(Je.credit)||0,zt=Math.max(0,rt-kt-$t-ze-ct);ee+=zt});const tt=((ae=oe[0])==null?void 0:ae.clientCode)||"";return c.jsxs(sh.Fragment,{children:[c.jsxs("tr",{onClick:()=>Ay(J),style:{backgroundColor:"#1E3A5F",color:"white",cursor:"pointer",borderBottom:"1px solid #0F2744"},children:[c.jsx("td",{colSpan:"4",style:{padding:"10px 12px",fontWeight:"700",fontSize:"13px"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[K?c.jsx(rm,{size:18}):c.jsx($0,{size:18}),c.jsx(aE,{size:16}),tt&&c.jsx("span",{style:{backgroundColor:"#9333EA",padding:"2px 8px",borderRadius:"6px",fontSize:"11px"},children:tt}),J,c.jsxs("span",{style:{backgroundColor:"#2874A6",padding:"2px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600"},children:[oe.length," inv"]})]})}),c.jsx("td",{colSpan:"4",style:{padding:"10px 12px"}}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",fontSize:"13px",backgroundColor:ee===0?"#22C55E":"#3B82F6"},children:ee===0?" Nil":`Bal: ${nt(ee)}`}),c.jsx("td",{colSpan:"4",style:{padding:"10px 12px"}})]}),K&&oe.map(Se=>{const Ce=je.find(ge=>ge.invoiceNo===Se.invoiceNo),Be=te.find(ge=>ge.invoiceNo===Se.invoiceNo),Qe=ne.find(ge=>ge.invoiceNo===Se.invoiceNo&&ge.type==="tds"),Je=ne.find(ge=>ge.invoiceNo===Se.invoiceNo&&ge.type==="discount"),rt=Se.totalAmount||0,kt=Ce&&parseFloat(Ce.amount)||0,$t=Qe?parseFloat(Qe.credit)||0:Ce&&parseFloat(Ce.tds)||0,ze=Be?Math.abs(parseFloat(Be.totalAmount)||0):0,ct=Je&&parseFloat(Je.credit)||0,zt=Math.max(0,rt-kt-$t-ze-ct),Pt=ze>=rt&&!Ce;return c.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:Se.invoiceType==="Combined"?"#FAF5FF":zt===0?"#F0FDF4":"transparent"},children:[c.jsx("td",{style:{padding:"10px 12px 10px 36px",fontWeight:"700",color:Se.invoiceType==="Combined"?"#7C3AED":"#2874A6"},children:Se.invoiceNo}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center",backgroundColor:"#FAF5FF"},children:c.jsx("span",{style:{fontWeight:"700",color:"#6B21A8",fontSize:"11px"},children:Se.clientCode||"-"})}),c.jsx("td",{style:{padding:"10px 12px"},children:_t(Se.date)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsx(xm,{status:Se.invoiceType,small:!0})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:nt(rt)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#F0FDF4",color:kt>0?"#166534":"#94A3B8"},children:kt>0?nt(kt):"-"}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#FEF3C7",color:$t>0?"#92400E":"#94A3B8"},children:$t>0?nt($t):"-"}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#FEE2E2",color:ze>0?"#991B1B":"#94A3B8"},children:ze>0?nt(ze):"-"}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#EFF6FF",color:zt>0?"#1E40AF":"#166534"},children:zt===0?" Nil":nt(zt)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsx(xm,{status:Se.invoiceStatus,small:!0})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:Pt?c.jsx("span",{style:{padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:" Cancelled"}):Ce?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",justifyContent:"center"},children:[c.jsxs("button",{onClick:()=>m4(Ce),style:{padding:"4px 8px",borderRadius:"12px",fontSize:"10px",fontWeight:"700",backgroundColor:"#DCFCE7",color:"#166534",border:"none",cursor:"pointer",textDecoration:"underline"},title:"Click to view receipt",children:[" ",Ce.receiptNo]}),_r&&c.jsx("button",{onClick:()=>t4(Ce),style:{padding:"2px 4px",borderRadius:"4px",fontSize:"10px",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete Receipt",children:""})]}):c.jsx("span",{style:{padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600",backgroundColor:"#FEF3C7",color:"#92400E"},children:" Pending"})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:Be?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",justifyContent:"center"},children:[c.jsx("button",{onClick:()=>x4(Be),style:{padding:"4px 8px",borderRadius:"12px",fontSize:"10px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer",textDecoration:"underline"},title:"Click to view credit note",children:Be.creditNoteNo}),_r&&c.jsx("button",{onClick:()=>r4(Be),style:{padding:"2px 4px",borderRadius:"4px",fontSize:"10px",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete Credit Note",children:""})]}):c.jsx("span",{style:{color:"#94A3B8",fontSize:"11px"},children:"-"})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsx("div",{style:{display:"flex",gap:"4px",justifyContent:"center",flexWrap:"wrap"},children:Se.isHistorical?c.jsxs(c.Fragment,{children:[_r&&!Ce&&c.jsx(Ke,{icon:Po,small:!0,variant:"success",onClick:()=>{const ge={invoiceNo:Se.invoiceNo,partyName:Se.partyName,invoiceDate:Se.date,invoiceTotalAmount:Se.totalAmount,invoiceStatus:"Approved",mailingSent:"Yes",invoiceType:"Historical",isHistorical:!0};Vi(ge)},title:"Create Receipt"}),_r&&!Be&&c.jsx(Ke,{icon:fd,small:!0,variant:"primary",onClick:()=>{const ge={invoiceNo:Se.invoiceNo,partyName:Se.partyName,invoiceDate:Se.date,invoiceTotalAmount:Se.totalAmount,invoiceStatus:"Approved",isHistorical:!0};kc(ge)},title:"Credit Note"})]}):c.jsxs(c.Fragment,{children:[c.jsx(Ke,{icon:Pc,small:!0,variant:"brand",onClick:()=>ed(Se.campaigns[0]),title:"View Invoice"}),_r&&Se.invoiceStatus==="Approved"&&Se.mailingSent==="Yes"&&!Ce&&c.jsx(Ke,{icon:Po,small:!0,variant:"success",onClick:()=>Vi(Se.campaigns[0]),title:"Create Receipt"}),_r&&Se.invoiceStatus==="Approved"&&!Be&&c.jsx(Ke,{icon:fd,small:!0,variant:"primary",onClick:()=>kc(Se.campaigns[0]),title:"Credit Note"}),_r&&c.jsx(Ke,{icon:ns,small:!0,variant:"danger",onClick:()=>fg(Se.campaigns[0]),title:"Delete Invoice"})]})})})]},Se.invoiceNo)})]},J)})})]})})]})},G4=()=>{if(!Y){alert("Please select a party first");return}const h=$n[Y]||0,_=Ee.filter(ge=>Ht(ge.partyName,Y)&&ge.invoiceGenerated&&ge.invoiceStatus==="Approved"&&(!Te||ni(ge.statePartyDetails)===Te)),U=new Map;_.forEach(ge=>{U.has(ge.invoiceNo)?U.get(ge.invoiceNo).campaigns.push(ge):U.set(ge.invoiceNo,{invoiceNo:ge.invoiceNo,invoiceDate:ge.invoiceDate,campaigns:[ge],isFromMaster:!0})});const q=new Set(Array.from(U.keys())),L=Te?[]:ne.filter(ge=>{var de;return Ht(ge.partyName,Y)&&ge.isHistorical&&ge.type!=="creditnote"&&!((de=ge.vchNo)!=null&&de.toUpperCase().startsWith("CN"))}),se=Te?[]:ne.filter(ge=>{var de;return Ht(ge.partyName,Y)&&ge.isHistorical&&(ge.type==="creditnote"||((de=ge.vchNo)==null?void 0:de.toUpperCase().startsWith("CN")))}),N=je.filter(ge=>Ht(ge.partyName,Y)&&(!Te||q.has(ge.invoiceNo))),b=te.filter(ge=>Ht(ge.partyName,Y)&&(!Te||q.has(ge.invoiceNo))),ie=ge=>{if(!ge)return"";const de=ge.split("/");return de.length>=3?de.slice(1).join("/"):de.length===2?de.join("/"):de[de.length-1]},J=new Map;b.forEach(ge=>{const de=ie(ge.invoiceNo);de&&!J.has(de)&&J.set(de,{...ge,isSystemCN:!0})}),se.forEach(ge=>{const de=ie(ge.vchNo);de&&!J.has(de)&&J.set(de,{...ge,isHistoricalCN:!0})});let oe=[],K=0,ee=0,tt=0,ae=0,Se=h;const Ce=new Set;h!==0&&(K+=h>0?h:0,ee+=h<0?Math.abs(h):0,oe.push({date:"",particular:"Opening Balance",vchType:"",vchNo:"",debit:h>0?h:0,credit:h<0?Math.abs(h):0,receiptDate:"",amountReceived:0,tds:0,balance:h,status:"",isMain:!0,isOpening:!0}));const Be=[];Array.from(U.values()).filter(ge=>{const de=new Date(ge.invoiceDate);return de>=new Date(En.fromDate)&&de<=new Date(En.toDate)}).forEach(ge=>{Be.push({...ge,entryType:"invoice",sortDate:ge.invoiceDate})}),L.filter(ge=>{if(!ge.date)return!1;const de=new Date(ge.date);return de>=new Date(En.fromDate)&&de<=new Date(En.toDate)}).forEach(ge=>{Be.push({...ge,entryType:"invoice",sortDate:ge.date})}),Be.sort((ge,de)=>new Date(ge.sortDate)-new Date(de.sortDate)),Be.forEach(ge=>{var de,Ie;if(ge.isFromMaster){const gt=ge;let ut=0;gt.campaigns.forEach(zr=>ut+=parseFloat(zr.invoiceAmount)||0);const dt=(Ie=(de=gt.campaigns[0])==null?void 0:de.statePartyDetails)==null?void 0:Ie.toUpperCase().includes("MAHARASHTRA"),Bt=dt?ut*.09:0,Ut=dt?ut*.09:0,Gt=dt?0:ut*.18,dr=ut+Bt+Ut+Gt,hn=ie(gt.invoiceNo),lr=J.get(hn),kr=!!lr,Ft=N.find(zr=>zr.invoiceNo===gt.invoiceNo);Se+=dr,K+=dr;let nn=0,or=0,On="",Mn=kr?"":"Pending";if(Ft&&(Mn="Received",nn=Ft.amount||0,or=Ft.tds||0,On=Ft.date,tt+=nn,ae+=or,Se-=nn+or+(Ft.discount||0)),oe.push({date:gt.invoiceDate,particular:Y,vchType:"Sales",vchNo:gt.invoiceNo,debit:dr,credit:0,receiptDate:On,amountReceived:nn,tds:or,balance:kr?"-":Mn==="Received"?0:dr-nn-or,status:Mn,isMain:!0,hasCN:kr}),oe.push({particular:"PROMOTIONAL TRADE EMAILER"+(gt.campaigns.length>1?"S":""),credit:ut,isMain:!1,hasCN:kr}),dt?(oe.push({particular:"CGST",credit:Bt,isMain:!1,hasCN:kr}),oe.push({particular:"SGST",credit:Ut,isMain:!1,hasCN:kr})):oe.push({particular:"IGST",credit:Gt,isMain:!1,hasCN:kr}),lr&&!Ce.has(hn)){Ce.add(hn);const zr=Math.abs(lr.totalAmount||lr.credit||0);Se-=zr,ee+=zr,oe.push({date:lr.date,particular:Y,vchType:"Credit Note",vchNo:lr.creditNoteNo||lr.vchNo,debit:0,credit:zr,receiptDate:"",amountReceived:0,tds:0,balance:"-",status:"",isMain:!0,isCreditNote:!0,hasCN:!0});const zi=Math.abs(lr.amount)||zr/1.18,An=Math.abs(lr.gst)||zr-zi;oe.push({particular:"PROMOTIONAL TRADE EMAILER",credit:zi,isMain:!1,isCreditNote:!0,hasCN:!0}),oe.push({particular:lr.gstType||(dt?"CGST + SGST":"IGST"),credit:An,isMain:!1,isCreditNote:!0,hasCN:!0})}}else if(ge.isHistorical){const gt=ge.debit||0,ut=ge.credit||0,dt=ie(ge.vchNo),Bt=J.get(dt),Ut=!!Bt;if(Se+=gt-ut,K+=gt,ee+=ut,oe.push({date:ge.date,particular:ge.particulars||Y,vchType:ge.vchType||"Sales",vchNo:ge.vchNo,debit:gt,credit:ut,receiptDate:ge.receiptDate||"",amountReceived:ge.amountReceived||0,tds:ge.tdsReceived||0,balance:Ut?"-":gt-(ge.amountReceived||0)-(ge.tdsReceived||0),status:Ut?"":ge.paymentStatus||"",isMain:!0,isHistorical:!0,hasCN:Ut}),ge.subRows&&ge.subRows.length>0&&ge.subRows.forEach(Gt=>{oe.push({particular:Gt.particular,debit:Gt.debit,credit:Gt.credit,isMain:!1,hasCN:Ut})}),Bt&&!Ce.has(dt)){Ce.add(dt);const Gt=Math.abs(Bt.totalAmount||Bt.credit||0);Se-=Gt,ee+=Gt,oe.push({date:Bt.date,particular:Y,vchType:"Credit Note",vchNo:Bt.creditNoteNo||Bt.vchNo,debit:0,credit:Gt,receiptDate:"",amountReceived:0,tds:0,balance:"-",status:"",isMain:!0,isCreditNote:!0,hasCN:!0}),Bt.subRows&&Bt.subRows.length>0&&Bt.subRows.forEach(dr=>{oe.push({particular:dr.particular,credit:Math.abs(dr.credit||0),isMain:!1,isCreditNote:!0,hasCN:!0})})}}});const Qe=oe.reduce((ge,de)=>de.isMain&&typeof de.balance=="number"&&de.balance>0?ge+de.balance:ge,0),Je=(Y||"").trim().toUpperCase();let rt={};Te&&(rt=d.find(ge=>ge.partyNameUpper===Je&&ge.normalizedState===Te)||{}),rt.state||(rt=d.find(ge=>ge.partyNameUpper===Je)||{});const kt=Ee.find(ge=>{var de;return((de=ge.partyName)==null?void 0:de.trim().toUpperCase())===Je}),$t=rt.state||(kt==null?void 0:kt.statePartyDetails)||"",ze=rt.address||Tc(Y,$t)||"",ct=rt.gstin||Co(Y,$t),zt=`
<!DOCTYPE html>
<html>
<head>
  <title>Ledger Account - ${Y}</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; font-size: 11px; padding: 20px; }
    .header { text-align: center; margin-bottom: 15px; }
    .firm-name { font-size: 18px; font-weight: bold; color: #1E293B; }
    .firm-address { font-size: 10px; color: #666; margin-top: 2px; }
    .party-section { text-align: center; margin: 15px 0; padding: 10px; border: 1px solid #ddd; background: #f9f9f9; }
    .party-name { font-size: 14px; font-weight: bold; }
    .ledger-title { font-size: 11px; color: #666; }
    .party-address { font-size: 10px; color: #666; margin-top: 5px; }
    .party-gstin { font-size: 10px; color: #1a5276; margin-top: 3px; font-weight: 600; }
    .period { text-align: center; font-size: 11px; margin: 10px 0; font-weight: bold; }
    .totals { display: flex; justify-content: space-around; background: #e8f4fd; padding: 8px; margin-bottom: 10px; font-size: 10px; border: 1px solid #ccc; }
    .totals div { text-align: center; }
    .totals .label { color: #666; }
    .totals .value { font-weight: bold; font-size: 11px; }
    .closing-balance { text-align: center; background: #1E293B; color: white; padding: 10px; margin-bottom: 10px; font-size: 14px; font-weight: bold; }
    table { width: 100%; border-collapse: collapse; font-size: 10px; }
    th { background: #f0f0f0; border: 1px solid #ccc; padding: 6px 4px; text-align: left; font-weight: bold; }
    td { border: 1px solid #ddd; padding: 5px 4px; }
    .text-right { text-align: right; }
    .text-center { text-align: center; }
    .main-row { background: #fff; }
    .main-row-cn { background: #fffbeb; }
    .sub-row { background: #fafafa; }
    .sub-row-cn { background: #fffbeb; }
    .sub-row td { padding-left: 20px; color: #666; font-size: 9px; }
    .opening-row { background: #fef3c7; font-weight: bold; }
    .credit-note-row { background: #fffbeb; }
    .status-received { background: #dcfce7; color: #166534; padding: 2px 6px; border-radius: 3px; font-size: 9px; }
    .status-pending { background: #fef3c7; color: #92400e; padding: 2px 6px; border-radius: 3px; font-size: 9px; }
    .debit { color: #dc2626; }
    .credit { color: #059669; }
    @media print { 
      body { padding: 10px; } 
      @page { size: landscape; margin: 10mm; }
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="firm-name">${w.name}</div>
    <div class="firm-address">${w.address}</div>
    <div class="firm-address">${w.addressLine2}, ${w.city}</div>
    <div class="firm-address">E-Mail: ${w.email}</div>
  </div>
  
  <div class="party-section">
    <div class="party-name">${Y}</div>
    <div class="ledger-title">Ledger Account</div>
    ${ze?`<div class="party-address">${ze}</div>`:""}
    ${$t?`<div class="party-address"> ${$t}</div>`:""}
    ${ct?`<div class="party-gstin">GSTIN: ${ct}</div>`:""}
  </div>
  
  <div class="period">${_t(En.fromDate)} to ${_t(En.toDate)}</div>
  
  <div class="closing-balance">
    Closing Balance: ${Ot(Math.abs(Qe))} ${Qe>0?"(Dr)":Qe<0?"(Cr)":""}
  </div>
  
  <div class="totals">
    <div><div class="label">Debit</div><div class="value">${Ot(K)}</div></div>
    <div><div class="label">Credit</div><div class="value">${Ot(ee)}</div></div>
    <div><div class="label">Amount Received</div><div class="value credit">${Ot(tt)}</div></div>
    <div><div class="label">TDS Received</div><div class="value">${Ot(ae)}</div></div>
  </div>
  
  <table>
    <thead>
      <tr>
        <th style="width:65px">Date</th>
        <th>Particular</th>
        <th style="width:70px" class="text-center">Vch Type</th>
        <th style="width:100px">Vch No.</th>
        <th style="width:80px" class="text-right">Debit</th>
        <th style="width:80px" class="text-right">Credit</th>
        <th style="width:70px" class="text-center">Date of Receipt</th>
        <th style="width:85px" class="text-right">Amount Received</th>
        <th style="width:70px" class="text-right">TDS Received</th>
        <th style="width:75px" class="text-right">Balance</th>
        <th style="width:70px" class="text-center">Payment Status</th>
      </tr>
    </thead>
    <tbody>
      ${oe.map(ge=>ge.isMain?`
        <tr class="${ge.isOpening?"opening-row":ge.hasCN||ge.isCreditNote?"main-row-cn":"main-row"}">
          <td>${ge.date?_t(ge.date):""}</td>
          <td style="font-weight:600">${ge.particular}</td>
          <td class="text-center">${ge.vchType||""}</td>
          <td style="color:#2874A6;font-weight:600">${ge.vchNo||""}</td>
          <td class="text-right">${ge.debit>0?Ot(ge.debit):""}</td>
          <td class="text-right" style="color:#DC2626">${ge.credit>0?Ot(ge.credit):""}</td>
          <td class="text-center">${ge.receiptDate?_t(ge.receiptDate):""}</td>
          <td class="text-right credit">${ge.amountReceived>0?Ot(ge.amountReceived):""}</td>
          <td class="text-right">${ge.tds>0?Ot(ge.tds):""}</td>
          <td class="text-right">${ge.balance==="-"?"-":ge.balance>0?Ot(ge.balance):""}</td>
          <td class="text-center">${ge.status?`<span class="${ge.status==="Received"?"status-received":"status-pending"}">${ge.status}</span>`:""}</td>
        </tr>
      `:`
        <tr class="${ge.hasCN||ge.isCreditNote?"sub-row-cn":"sub-row"}">
          <td></td>
          <td style="padding-left:20px;color:#666">${ge.particular}</td>
          <td></td>
          <td></td>
          <td class="text-right">${ge.debit?Ot(ge.debit):""}</td>
          <td class="text-right">${ge.credit?Ot(ge.credit):""}</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
      `).join("")}
    </tbody>
  </table>
  
  <script>window.onload = function() { window.print(); }<\/script>
</body>
</html>`,Pt=window.open("","_blank");Pt.document.write(zt),Pt.document.close()},K4=ve.useMemo(()=>{const h=new Set;return Vr.forEach(_=>h.add(_.partyName)),Ai.forEach(_=>h.add(_.partyName)),[...h].filter(Boolean).sort()},[Vr,Ai]),Y4=ve.useMemo(()=>Vr.filter(h=>{var _;return!(we.party&&h.partyName!==we.party||we.invoiceNo&&!((_=h.invoiceNo)!=null&&_.toLowerCase().includes(we.invoiceNo.toLowerCase()))||we.dateFrom&&h.date<we.dateFrom||we.dateTo&&h.date>we.dateTo)}),[Vr,we]),X4=ve.useMemo(()=>Ai.filter(h=>{var _;return!(we.party&&h.partyName!==we.party||we.invoiceNo&&!((_=h.invoiceNo)!=null&&_.toLowerCase().includes(we.invoiceNo.toLowerCase()))||we.dateFrom&&h.date<we.dateFrom||we.dateTo&&h.date>we.dateTo)}),[Ai,we]),q4=()=>{const h=[...Y4].sort((N,b)=>new Date(b.date)-new Date(N.date)),_=[...X4].sort((N,b)=>new Date(b.date)-new Date(N.date)),U=h.reduce((N,b)=>N+(parseFloat(b.amount)||0),0),q=h.reduce((N,b)=>N+(parseFloat(b.tds)||parseFloat(b.tds||b.tdsAmount)||0),0),L=_.reduce((N,b)=>N+(parseFloat(b.totalAmount)||0),0),se=N=>{const b=parseFloat(N.totalAmount)||0;let ie=parseFloat(N.baseAmount)||parseFloat(N.amount)||0,J=parseFloat(N.gst)||(parseFloat(N.cgstAmount)||0)+(parseFloat(N.sgstAmount)||0)+(parseFloat(N.igstAmount)||0);return ie===0&&b>0&&(ie=b/1.18,J=b-ie),{base:ie,gst:J,total:b}};return c.jsxs("div",{style:{padding:"20px"},children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[c.jsxs("div",{children:[c.jsx("h1",{style:{fontSize:"22px",fontWeight:"700",color:"#1E293B",marginBottom:"4px"},children:" Receipt Register"}),c.jsx("p",{style:{fontSize:"13px",color:"#64748B"},children:"All receipts, TDS, and credit notes"})]}),c.jsx(Ke,{icon:Do,label:"Export Excel",variant:"secondary",onClick:z4})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsx(hd,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"}),c.jsxs("select",{value:we.party,onChange:N=>We(b=>({...b,party:N.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"},children:[c.jsx("option",{value:"",children:"All Parties"}),K4.map(N=>c.jsx("option",{value:N,children:N},N))]}),c.jsx("input",{type:"text",placeholder:"Invoice No",value:we.invoiceNo,onChange:N=>We(b=>({...b,invoiceNo:N.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"140px"}}),c.jsx("input",{type:"date",value:we.dateFrom,onChange:N=>We(b=>({...b,dateFrom:N.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}}),c.jsx("span",{style:{color:"#64748B"},children:"to"}),c.jsx("input",{type:"date",value:we.dateTo,onChange:N=>We(b=>({...b,dateTo:N.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}}),(we.party||we.invoiceNo||we.dateFrom||we.dateTo)&&c.jsxs("button",{onClick:()=>We({party:"",invoiceNo:"",dateFrom:"",dateTo:""}),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer"},children:[c.jsx(Sa,{size:14})," Clear"]})]})}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px",marginBottom:"20px"},children:[c.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",padding:"20px",border:"1px solid #E2E8F0"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#64748B",marginBottom:"8px"},children:"Receipts"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:h.length})]}),c.jsxs("div",{style:{backgroundColor:"#F0FDF4",borderRadius:"12px",padding:"20px",border:"1px solid #BBF7D0"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#166534",marginBottom:"8px"},children:"Amount Received"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#166534"},children:nt(U)})]}),c.jsxs("div",{style:{backgroundColor:"#FEF3C7",borderRadius:"12px",padding:"20px",border:"1px solid #FDE68A"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#92400E",marginBottom:"8px"},children:"TDS Received"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#92400E"},children:nt(q)})]}),c.jsxs("div",{style:{backgroundColor:"#FEE2E2",borderRadius:"12px",padding:"20px",border:"1px solid #FCA5A5"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#991B1B",marginBottom:"8px"},children:"Credit Notes"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#991B1B"},children:nt(L)})]})]}),c.jsx(gn,{title:`Receipts (${h.length})`,noPadding:!0,children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Receipt No"}),c.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700",color:"#6B21A8",backgroundColor:"#FAF5FF"},children:"Code"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Date"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Party Name"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700",backgroundColor:"#F0FDF4",color:"#166534"},children:"Amount"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEF3C7",color:"#92400E"},children:"TDS"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"Total"}),c.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700"},children:"Payment Mode"}),c.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),c.jsx("tbody",{children:h.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:"10",style:{padding:"50px",textAlign:"center",color:"#94A3B8"},children:"No receipts found"})}):h.map(N=>{const b=parseFloat(N.amount)||0,ie=parseFloat(N.tds)||parseFloat(N.tdsAmount)||0,J=N.clientCode||rn(N.partyName,N.statePartyDetails||"");return c.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9"},children:[c.jsx("td",{style:{padding:"12px",fontWeight:"600",color:"#2874A6"},children:N.receiptNo}),c.jsx("td",{style:{padding:"12px",textAlign:"center",backgroundColor:"#FAF5FF"},children:c.jsx("span",{style:{fontWeight:"700",color:"#6B21A8",fontSize:"11px"},children:J||"-"})}),c.jsx("td",{style:{padding:"12px"},children:_t(N.date)}),c.jsx("td",{style:{padding:"12px",fontWeight:"500"},children:N.partyName}),c.jsx("td",{style:{padding:"12px",color:"#64748B"},children:N.invoiceNo}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"600",color:"#166534",backgroundColor:"#F0FDF4"},children:nt(b)}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"600",color:"#92400E",backgroundColor:"#FEF3C7"},children:nt(ie)}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:nt(b+ie)}),c.jsx("td",{style:{padding:"12px",textAlign:"center"},children:c.jsx("span",{style:{padding:"4px 8px",fontSize:"10px",fontWeight:"600",borderRadius:"9999px",backgroundColor:"#E0E7FF",color:"#3730A3"},children:N.paymentMode||N.mode||"Bank Transfer"})}),c.jsx("td",{style:{padding:"12px",textAlign:"center"},children:c.jsxs("button",{onClick:()=>W4(N),style:{padding:"6px 10px",fontSize:"11px",backgroundColor:"#2874A6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:[c.jsx(nE,{size:12})," Print"]})})]},N.id||N.receiptNo)})})]})}),c.jsx("div",{style:{marginTop:"30px"},children:c.jsx(gn,{title:`Credit Notes (${_.length})`,noPadding:!0,children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#FEF3C7",borderBottom:"2px solid #FDE68A"},children:[c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"CN No"}),c.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700",color:"#6B21A8",backgroundColor:"#FAF5FF"},children:"Code"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Date"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Party Name"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Against Invoice"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"Base Amount"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"GST"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"Total"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Reason"}),c.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),c.jsx("tbody",{children:_.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:"10",style:{padding:"50px",textAlign:"center",color:"#94A3B8"},children:"No credit notes found"})}):_.map(N=>{const b=se(N),ie=N.clientCode||rn(N.partyName,N.statePartyDetails||"");return c.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:"#FFFBEB"},children:[c.jsx("td",{style:{padding:"12px",fontWeight:"600",color:"#92400E"},children:N.creditNoteNo}),c.jsx("td",{style:{padding:"12px",textAlign:"center",backgroundColor:"#FAF5FF"},children:c.jsx("span",{style:{fontWeight:"700",color:"#6B21A8",fontSize:"11px"},children:ie||"-"})}),c.jsx("td",{style:{padding:"12px"},children:_t(N.date)}),c.jsx("td",{style:{padding:"12px",fontWeight:"500"},children:N.partyName}),c.jsx("td",{style:{padding:"12px",color:"#64748B"},children:N.invoiceNo}),c.jsx("td",{style:{padding:"12px",textAlign:"right"},children:nt(b.base)}),c.jsx("td",{style:{padding:"12px",textAlign:"right"},children:nt(b.gst)}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"700",color:"#92400E"},children:nt(b.total)}),c.jsx("td",{style:{padding:"12px",fontSize:"11px",color:"#64748B"},children:N.reason||"-"}),c.jsx("td",{style:{padding:"12px",textAlign:"center"},children:c.jsxs("button",{onClick:()=>H4(N),style:{padding:"6px 10px",fontSize:"11px",backgroundColor:"#92400E",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:[c.jsx(nE,{size:12})," Print"]})})]},N.id||N.creditNoteNo)})})]})})})]})},Q4=()=>{const h=(b,ie,J)=>{const oe=$n[b]||0,K=ze=>J?(ze.clientCode||rn(ze.partyName,ze.statePartyDetails))===J:!0,ee=Ee.filter(ze=>Ht(ze.partyName,b)&&ze.invoiceGenerated&&ze.invoiceStatus==="Approved"&&K(ze)&&(!ie||ni(ze.statePartyDetails)===ie)),tt=Fe.filter(ze=>Ht(ze.partyName,b)&&ze.invoiceGenerated&&ze.invoiceStatus==="Approved"&&K(ze)&&(!ie||ni(ze.statePartyDetails)===ie)),ae=new Map;ee.forEach(ze=>{ae.has(ze.invoiceNo)?ae.get(ze.invoiceNo).campaigns.push(ze):ae.set(ze.invoiceNo,{invoiceNo:ze.invoiceNo,campaigns:[ze],totalAmount:parseFloat(ze.invoiceTotalAmount)||0})}),tt.forEach(ze=>{ae.has(ze.invoiceNo)||ae.set(ze.invoiceNo,{invoiceNo:ze.invoiceNo,totalAmount:parseFloat(ze.invoiceTotalAmount)||0,isService:!0})});const Se=new Set(Array.from(ae.keys())),Ce=je.filter(ze=>Ht(ze.partyName,b)&&(!ie||Se.has(ze.invoiceNo))),Be=te.filter(ze=>Ht(ze.partyName,b)&&(!ie||Se.has(ze.invoiceNo))),Qe=ie?[]:ne.filter(ze=>{var ct;return Ht(ze.partyName,b)&&ze.isHistorical&&ze.type!=="creditnote"&&!((ct=ze.vchNo)!=null&&ct.toUpperCase().startsWith("CN"))}),Je=ie?[]:ne.filter(ze=>{var ct;return Ht(ze.partyName,b)&&ze.isHistorical&&(ze.type==="creditnote"||((ct=ze.vchNo)==null?void 0:ct.toUpperCase().startsWith("CN")))}),rt=ze=>{if(!ze)return"";const ct=ze.split("/");return ct.length>=3?ct.slice(1).join("/"):ct.length===2?ct.join("/"):ct[ct.length-1]},kt=new Map;Be.forEach(ze=>{const ct=rt(ze.invoiceNo);ct&&!kt.has(ct)&&kt.set(ct,ze)}),Je.forEach(ze=>{const ct=rt(ze.vchNo);ct&&!kt.has(ct)&&kt.set(ct,ze)});let $t=0;return oe>0&&($t+=oe),Array.from(ae.values()).forEach(ze=>{const ct=ze.totalAmount,zt=rt(ze.invoiceNo),Pt=kt.get(zt),ge=Pt?Math.abs(parseFloat(Pt.totalAmount)||parseFloat(Pt.credit)||0):0;if(!(Pt&&ge>=ct)){let Ie=Pt?ct-ge:ct;const gt=Ce.find(ut=>ut.invoiceNo===ze.invoiceNo);if(gt){const ut=Ie-(parseFloat(gt.amount)||0)-(parseFloat(gt.tds)||0)-(parseFloat(gt.discount)||0);ut>0&&($t+=ut)}else Ie>0&&($t+=Ie)}}),Qe.forEach(ze=>{const ct=rt(ze.vchNo),zt=kt.get(ct),Pt=zt?Math.abs(parseFloat(zt.totalAmount)||parseFloat(zt.credit)||parseFloat(zt.debit)||0):0,ge=parseFloat(ze.debit)||0;if(!(zt&&Pt>=ge)){let Ie=zt?ge-Pt:ge;const gt=parseFloat(ze.amountReceived)||0,ut=parseFloat(ze.tdsReceived)||0,dt=Ie-gt-ut;dt>0&&($t+=dt)}}),$t},_=d.filter(b=>b.partyName.toLowerCase().includes(ys.toLowerCase())||b.state&&b.state.toLowerCase().includes(ys.toLowerCase())),U=b=>{if(Te){const K=d.find(ee=>ee.partyNameUpper===(b||"").trim().toUpperCase()&&ee.normalizedState===Te);if(K!=null&&K.state)return K.state}const ie=(b||"").trim().toUpperCase(),J=Ee.find(K=>{var ee;return((ee=K.partyName)==null?void 0:ee.trim().toUpperCase())===ie});if(J!=null&&J.statePartyDetails)return J.statePartyDetails;const oe=d.find(K=>K.partyNameUpper===ie);return(oe==null?void 0:oe.state)||""},q=b=>{const ie=(b||"").trim().toUpperCase();if(Te){const oe=d.find(K=>K.partyNameUpper===ie&&K.normalizedState===Te);if(oe!=null&&oe.address)return oe.address}const J=d.find(oe=>oe.partyNameUpper===ie);return J!=null&&J.address?J.address:Tc(b,U(b))},L=b=>{const ie=(b||"").trim().toUpperCase();if(Te){const K=d.find(ee=>ee.partyNameUpper===ie&&ee.normalizedState===Te);if(K!=null&&K.gstin)return K.gstin}const J=d.find(K=>K.partyNameUpper===ie);if(J!=null&&J.gstin)return J.gstin;const oe=Ee.find(K=>{var ee;return((ee=K.partyName)==null?void 0:ee.trim().toUpperCase())===ie});return oe?Co(b,oe.statePartyDetails):""},N=(()=>{if(!Y)return{entries:[],totals:{debit:0,credit:0,received:0,tds:0,balance:0}};const b=$n[Y]||0,ie=de=>{if(!de)return"";const Ie=de.split("/");return Ie.length>=3?Ie.slice(1).join("/"):Ie.length===2?Ie.join("/"):Ie[Ie.length-1]},J=de=>De?(de.clientCode||rn(de.partyName,de.statePartyDetails))===De:!0,oe=Ee.filter(de=>Ht(de.partyName,Y)&&de.invoiceGenerated&&de.invoiceStatus==="Approved"&&J(de)&&(!Te||ni(de.statePartyDetails)===Te)),K=Fe.filter(de=>Ht(de.partyName,Y)&&de.invoiceGenerated&&de.invoiceStatus==="Approved"&&J(de)&&(!Te||ni(de.statePartyDetails)===Te)),ee=new Map;oe.forEach(de=>{ee.has(de.invoiceNo)?ee.get(de.invoiceNo).campaigns.push(de):ee.set(de.invoiceNo,{invoiceNo:de.invoiceNo,invoiceDate:de.invoiceDate,invoiceType:de.invoiceType,combinationCode:de.combinationCode,receiptStatus:de.receiptStatus,receiptNo:de.receiptNo,receiptDate:de.receiptDate,creditNoteNo:de.creditNoteNo,campaigns:[de],isFromMaster:!0})}),K.forEach(de=>{ee.has(de.invoiceNo)||ee.set(de.invoiceNo,{invoiceNo:de.invoiceNo,invoiceDate:de.invoiceDate,invoiceType:"Service",combinationCode:"NA",receiptStatus:de.receiptStatus,receiptNo:de.receiptNo,receiptDate:de.receiptDate,creditNoteNo:de.creditNoteNo,campaigns:[de],isFromMaster:!1,isService:!0,serviceType:de.serviceType})});const tt=new Set(Array.from(ee.keys())),ae=Te?[]:ne.filter(de=>{var Ie;return Ht(de.partyName,Y)&&de.isHistorical&&de.type!=="creditnote"&&!((Ie=de.vchNo)!=null&&Ie.toUpperCase().startsWith("CN"))}),Se=Te?[]:ne.filter(de=>{var Ie;return Ht(de.partyName,Y)&&de.isHistorical&&(de.type==="creditnote"||((Ie=de.vchNo)==null?void 0:Ie.toUpperCase().startsWith("CN")))}),Ce=je.filter(de=>Ht(de.partyName,Y)&&(!Te||tt.has(de.invoiceNo))),Be=te.filter(de=>Ht(de.partyName,Y)&&(!Te||tt.has(de.invoiceNo))),Qe=new Map;Be.forEach(de=>{const Ie=ie(de.invoiceNo);Ie&&!Qe.has(Ie)&&Qe.set(Ie,{...de,isSystemCN:!0})}),Se.forEach(de=>{const Ie=ie(de.vchNo);Ie&&!Qe.has(Ie)&&Qe.set(Ie,{...de,isHistoricalCN:!0})});const Je=[];let rt=b,kt=0,$t=0,ze=0,ct=0;const zt=new Set;b!==0&&(Je.push({id:"opening",date:"",particular:"Opening Balance",vchType:"",vchNo:"",debit:b>0?b:0,credit:b<0?Math.abs(b):0,receiptDate:"",amountReceived:0,tdsReceived:0,balance:b,paymentStatus:"",isOpening:!0,subRows:[]}),kt+=b>0?b:0,$t+=b<0?Math.abs(b):0);const Pt=[];Array.from(ee.values()).filter(de=>{const Ie=new Date(de.invoiceDate),gt=new Date(En.fromDate),ut=new Date(En.toDate);return Ie>=gt&&Ie<=ut}).forEach(de=>{Pt.push({...de,entryType:"invoice",sortDate:de.invoiceDate})}),ae.filter(de=>{if(!de.date)return!1;const Ie=new Date(de.date),gt=new Date(En.fromDate),ut=new Date(En.toDate);return Ie>=gt&&Ie<=ut}).forEach(de=>{Pt.push({...de,entryType:de.type||"invoice",sortDate:de.date})}),Pt.sort((de,Ie)=>new Date(de.sortDate)-new Date(Ie.sortDate)),Pt.forEach(de=>{var Ie,gt,ut;if(de.isFromMaster){const dt=de;let Bt=0;dt.campaigns.forEach(ts=>{Bt+=parseFloat(ts.invoiceAmount)||0});const Ut=(gt=(Ie=dt.campaigns[0])==null?void 0:Ie.statePartyDetails)==null?void 0:gt.toUpperCase().includes("MAHARASHTRA"),Gt=Ut?Bt*.09:0,dr=Ut?Bt*.09:0,hn=Ut?0:Bt*.18,lr=Bt+Gt+dr+hn,kr=ie(dt.invoiceNo),Ft=Qe.get(kr),nn=Ft?Math.abs(Ft.totalAmount||Ft.credit||0):0,or=!!Ft,On=or&&nn>=lr,Mn=or&&!On?lr-nn:0,zr=Ce.find(ts=>ts.invoiceNo===dt.invoiceNo);rt+=lr,kt+=lr;const zi=[{particular:"PROMOTIONAL TRADE EMAILER"+(dt.campaigns.length>1?"S":""),credit:Bt}];Ut?(zi.push({particular:"CGST",credit:Gt}),zi.push({particular:"SGST",credit:dr})):zi.push({particular:"IGST",credit:hn});let An="",sn=0,an=0,Io="",ws=lr;if(zr?(An="Received",sn=zr.amount||0,an=zr.tds||0,Io=zr.date,ze+=sn,ct+=an,ws=lr-sn-an-(zr.discount||0),rt-=sn+an+(zr.discount||0)):dt.receiptStatus==="Received"?(An="Received",ws=0):On?(An="CN Closed",ws=0):or&&Mn>0?(An="Partial CN",ws=Mn):An="Pending",Je.push({id:dt.invoiceNo,date:dt.invoiceDate,particular:Y,vchType:"Sales",vchNo:dt.invoiceNo,debit:lr,credit:0,receiptDate:Io,amountReceived:sn,tdsReceived:an,balance:On?"-":ws>0?ws:0,paymentStatus:An,isInvoice:!0,hasCN:or,subRows:zi}),Ft&&!zt.has(kr)){zt.add(kr);const ts=Math.abs(Ft.totalAmount||Ft.credit||0);rt-=ts,$t+=ts;const rs=[];if(Ft.amount&&rs.push({particular:"PROMOTIONAL TRADE EMAILER",credit:Math.abs(Ft.amount)}),Ft.gst&&rs.push({particular:Ft.gstType||(Ut?"CGST + SGST":"IGST"),credit:Math.abs(Ft.gst)}),rs.length===0&&ts>0){const xa=ts/1.18,rd=ts-xa;rs.push({particular:"PROMOTIONAL TRADE EMAILER",credit:xa}),rs.push({particular:Ut?"CGST + SGST":"IGST",credit:rd})}Je.push({id:Ft.id||Ft.creditNoteNo||`cn-${kr}`,date:Ft.date,particular:Y,vchType:"Credit Note",vchNo:Ft.creditNoteNo||Ft.vchNo,debit:0,credit:ts,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:Ft.isHistoricalCN&&Ft.subRows||rs})}}else if(de.isService){const dt=de,Bt=dt.campaigns[0]||{},Ut=parseFloat(Bt.invoiceAmount)||0,Gt=dt.serviceType||Bt.serviceType||"SERVICE",dr=(ut=Bt.statePartyDetails)==null?void 0:ut.toUpperCase().includes("MAHARASHTRA"),hn=dr?Ut*.09:0,lr=dr?Ut*.09:0,kr=dr?0:Ut*.18,Ft=Ut+hn+lr+kr,nn=ie(dt.invoiceNo),or=Qe.get(nn),On=or?Math.abs(or.totalAmount||or.credit||0):0,Mn=!!or,zr=Mn&&On>=Ft,zi=Mn&&!zr?Ft-On:0,An=Ce.find(xa=>xa.invoiceNo===dt.invoiceNo);rt+=Ft,kt+=Ft;const sn=[{particular:Gt.toUpperCase(),credit:Ut}];dr?(sn.push({particular:"CGST",credit:hn}),sn.push({particular:"SGST",credit:lr})):sn.push({particular:"IGST",credit:kr});let an="",Io=0,ws=0,ts="",rs=Ft;if(An?(an="Received",Io=An.amount||0,ws=An.tds||An.tdsAmount||0,ts=An.date,ze+=Io,ct+=ws,rs=Ft-Io-ws-(An.discount||0),rt-=Io+ws+(An.discount||0)):zr?(an="CN Closed",rs=0):Mn&&zi>0?(an="Partial CN",rs=zi):an="Pending",Je.push({id:dt.invoiceNo,date:dt.invoiceDate,particular:Y,vchType:"Sales",vchNo:dt.invoiceNo,debit:Ft,credit:0,receiptDate:ts,amountReceived:Io,tdsReceived:ws,balance:zr?"-":rs>0?rs:0,paymentStatus:an,isInvoice:!0,isService:!0,hasCN:Mn,subRows:sn}),or&&!zt.has(nn)){zt.add(nn);const xa=Math.abs(or.totalAmount||or.credit||0);rt-=xa,$t+=xa;const rd=[],Iy=xa/1.18,ib=xa-Iy;rd.push({particular:Gt.toUpperCase(),credit:Iy}),rd.push({particular:dr?"CGST + SGST":"IGST",credit:ib}),Je.push({id:or.id||or.creditNoteNo||`cn-${nn}`,date:or.date,particular:Y,vchType:"Credit Note",vchNo:or.creditNoteNo||or.vchNo,debit:0,credit:xa,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:rd})}}else if(de.isHistorical){const dt=de.debit||0,Bt=de.credit||0,Ut=ie(de.vchNo),Gt=Qe.get(Ut),dr=Gt?Math.abs(Gt.totalAmount||Gt.credit||0):0,hn=!!Gt,lr=hn&&dr>=dt,kr=hn&&!lr?dt-dr:0;rt+=dt-Bt,kt+=dt,$t+=Bt,de.amountReceived&&(ze+=de.amountReceived),de.tdsReceived&&(ct+=de.tdsReceived);const Ft=de.subRows||[];let nn=dt-(de.amountReceived||0)-(de.tdsReceived||0),or=de.paymentStatus||"";lr?(nn=0,or="CN Closed"):hn&&kr>0&&(nn=kr-(de.amountReceived||0)-(de.tdsReceived||0),nn>0&&(or="Partial CN")),Je.push({id:de.id,date:de.date,particular:de.particulars||Y,vchType:de.vchType||"Sales",vchNo:de.vchNo,debit:dt,credit:Bt,receiptDate:de.receiptDate||"",amountReceived:de.amountReceived||0,tdsReceived:de.tdsReceived||0,balance:lr?"-":nn>0?nn:0,paymentStatus:or,isInvoice:!0,isHistorical:!0,hasCN:hn,subRows:Ft}),Gt&&!zt.has(Ut)&&(zt.add(Ut),rt-=dr,$t+=dr,Je.push({id:Gt.id||Gt.creditNoteNo||Gt.vchNo||`cn-${Ut}`,date:Gt.date,particular:Y,vchType:"Credit Note",vchNo:Gt.creditNoteNo||Gt.vchNo,debit:0,credit:dr,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:Gt.subRows||[]}))}});const ge=Je.reduce((de,Ie)=>typeof Ie.balance=="number"&&Ie.balance>0?de+Ie.balance:de,0);return{entries:Je,totals:{debit:kt,credit:$t,received:ze,tds:ct,balance:ge}}})();return c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Party Ledgers"}),c.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[c.jsx(Ke,{icon:Do,label:"Export All",variant:"secondary",onClick:V4}),ii&&c.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"}),_r&&c.jsx(Ke,{icon:Ks,label:"Import Historical",variant:"brand",onClick:()=>Ec(!0)}),_r&&Y&&ne.some(b=>Ht(b.partyName,Y)&&b.isHistorical)&&c.jsx(Ke,{icon:ns,label:"Clear Historical",variant:"danger",onClick:i4}),_r&&c.jsx(Ke,{icon:pd,label:"Opening Balance",variant:"primary",onClick:()=>Tr(!0)})]})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(OL,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Period:"})]}),c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx("input",{type:"date",value:En.fromDate,onChange:b=>vs(ie=>({...ie,fromDate:b.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}}),c.jsx("span",{style:{color:"#64748B"},children:"to"}),c.jsx("input",{type:"date",value:En.toDate,onChange:b=>vs(ie=>({...ie,toDate:b.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}})]}),c.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:"10px"},children:Y&&c.jsx(Ke,{icon:Do,label:"Download PDF",variant:"brand",onClick:G4})})]})}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr",gap:"16px"},children:[c.jsxs(gn,{title:"Parties",noPadding:!0,children:[c.jsx("div",{style:{padding:"12px",borderBottom:"1px solid #E2E8F0"},children:c.jsxs("div",{style:{position:"relative"},children:[c.jsx(X0,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",placeholder:"Search party...",value:ys,onChange:b=>Gu(b.target.value),style:{width:"100%",padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",boxSizing:"border-box"}})]})}),c.jsx("div",{style:{maxHeight:"450px",overflowY:"auto"},children:_.length===0?c.jsx("div",{style:{padding:"30px",textAlign:"center",color:"#94A3B8",fontSize:"14px"},children:ys?"No matching parties":"No parties yet"}):_.map((b,ie)=>{const J=h(b.partyName,b.normalizedState,b.clientCode),oe=Ht(Y,b.partyName)&&Te===b.normalizedState&&De===b.clientCode;return c.jsxs("div",{onClick:()=>{ye(b.partyName),Ve(b.normalizedState||null),Ne(b.clientCode||null)},style:{padding:"14px 18px",borderBottom:"1px solid #F1F5F9",cursor:"pointer",backgroundColor:oe?"#EFF6FF":"transparent",borderLeft:oe?"4px solid #2874A6":"4px solid transparent"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[b.clientCode&&c.jsx("span",{style:{padding:"2px 6px",backgroundColor:"#F3E8FF",color:"#6B21A8",borderRadius:"4px",fontSize:"10px",fontWeight:"700"},children:b.clientCode}),c.jsx("span",{style:{fontWeight:"600",fontSize:"14px",color:"#1E293B"},children:b.partyName})]}),b.state&&c.jsxs("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"2px"},children:[" ",b.state]}),b.gstin&&c.jsxs("div",{style:{fontSize:"10px",color:"#2874A6",marginTop:"1px"},children:["GST: ",b.gstin]}),c.jsxs("div",{style:{fontSize:"14px",color:J>0?"#DC2626":"#059669",fontWeight:"700",marginTop:"4px"},children:[J>0?"Dr. ":"Cr. ",nt(Math.abs(J))]})]},`${b.partyName}-${b.state}-${b.clientCode}-${ie}`)})})]}),c.jsx(gn,{title:Y?"Ledger Account":"Select a Party",noPadding:!0,children:Y?c.jsxs("div",{style:{fontSize:"12px"},children:[c.jsxs("div",{style:{textAlign:"center",padding:"16px",borderBottom:"2px solid #1E3A5F",backgroundColor:"#F8FAFC"},children:[c.jsx("div",{style:{fontSize:"16px",fontWeight:"700",color:"#1E3A5F"},children:w.name}),c.jsx("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"4px"},children:w.address}),c.jsxs("div",{style:{fontSize:"11px",color:"#64748B"},children:[w.addressLine2,", ",w.city]}),c.jsxs("div",{style:{fontSize:"11px",color:"#64748B"},children:["E-Mail: ",w.email]})]}),c.jsxs("div",{style:{textAlign:"center",padding:"12px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FFFFFF"},children:[c.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"8px"},children:[(()=>{const b=_.find(ie=>Ht(ie.partyName,Y)&&ie.normalizedState===Te);return b!=null&&b.clientCode?c.jsx("span",{style:{padding:"3px 8px",backgroundColor:"#F3E8FF",color:"#6B21A8",borderRadius:"6px",fontSize:"12px",fontWeight:"700"},children:b.clientCode}):null})(),c.jsx("span",{style:{fontSize:"14px",fontWeight:"700",color:"#1E293B"},children:Y})]}),c.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#64748B"},children:"Ledger Account"}),q(Y)&&c.jsx("div",{style:{fontSize:"11px",color:"#475569",marginTop:"4px"},children:q(Y)}),U(Y)&&c.jsxs("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"2px"},children:[" ",U(Y)]}),L(Y)&&c.jsxs("div",{style:{fontSize:"11px",color:"#2874A6",marginTop:"3px",fontWeight:"600"},children:["GSTIN: ",L(Y)]})]}),c.jsx("div",{style:{textAlign:"center",padding:"8px",backgroundColor:"#F1F5F9",borderBottom:"1px solid #E2E8F0"},children:c.jsxs("span",{style:{fontSize:"11px",fontWeight:"600",color:"#475569"},children:[_t(En.fromDate)," to ",_t(En.toDate)]})}),c.jsxs("div",{style:{backgroundColor:"#1E293B",color:"white",padding:"12px 16px",display:"flex",justifyContent:"center",alignItems:"center",gap:"12px",borderBottom:"3px solid #F59E0B"},children:[c.jsx("span",{style:{fontSize:"14px",fontWeight:"600"},children:"Closing Balance:"}),c.jsxs("span",{style:{fontSize:"18px",fontWeight:"700",color:N.totals.balance>0?"#FCA5A5":"#86EFAC"},children:[Ot(Math.abs(N.totals.balance))," ",N.totals.balance>0?"(Dr)":N.totals.balance<0?"(Cr)":""]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",backgroundColor:"#EFF6FF",borderBottom:"2px solid #2874A6",fontSize:"11px"},children:[c.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[c.jsx("div",{style:{color:"#64748B"},children:"Debit"}),c.jsx("div",{style:{fontWeight:"700",color:"#1E293B"},children:Ot(N.totals.debit)})]}),c.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[c.jsx("div",{style:{color:"#64748B"},children:"Credit"}),c.jsx("div",{style:{fontWeight:"700",color:"#DC2626"},children:Ot(N.totals.credit)})]}),c.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[c.jsx("div",{style:{color:"#64748B"},children:"Amount Received"}),c.jsx("div",{style:{fontWeight:"700",color:"#059669"},children:Ot(N.totals.received)})]}),c.jsxs("div",{style:{padding:"8px",textAlign:"center"},children:[c.jsx("div",{style:{color:"#64748B"},children:"TDS Received"}),c.jsx("div",{style:{fontWeight:"700",color:"#1E293B"},children:Ot(N.totals.tds)})]})]}),c.jsx("div",{style:{overflowX:"auto"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px",minWidth:"1000px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",width:"75px",borderRight:"1px solid #E2E8F0"},children:"Date"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",minWidth:"150px",borderRight:"1px solid #E2E8F0"},children:"Particular"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"80px",borderRight:"1px solid #E2E8F0"},children:"Vch Type"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",width:"110px",borderRight:"1px solid #E2E8F0"},children:"Vch No."}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Debit"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Credit"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"85px",borderRight:"1px solid #E2E8F0"},children:"Date of Receipt"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Amount Received"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"80px",borderRight:"1px solid #E2E8F0"},children:"TDS Received"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"85px",borderRight:"1px solid #E2E8F0"},children:"Balance"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"75px",borderRight:"1px solid #E2E8F0"},children:"Payment Status"}),_r&&c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"50px"},children:"Action"})]})}),c.jsx("tbody",{children:N.entries.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:_r?"12":"11",style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:"No entries in selected period"})}):N.entries.map(b=>c.jsxs(sh.Fragment,{children:[c.jsxs("tr",{style:{backgroundColor:b.isOpening?"#FEF3C7":b.hasCN||b.isCreditNote?"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #E2E8F0",borderLeft:b.hasCN||b.isCreditNote?"4px solid #F59E0B":"none"},children:[c.jsx("td",{style:{padding:"8px",borderRight:"1px solid #E2E8F0"},children:b.date?_t(b.date):""}),c.jsx("td",{style:{padding:"8px",fontWeight:"600",color:b.isCreditNote?"#DC2626":"#1E293B",borderRight:"1px solid #E2E8F0"},children:b.particular}),c.jsx("td",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #E2E8F0"},children:b.vchType&&c.jsx("span",{style:{padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:b.vchType==="Sales"?"#DCFCE7":"#FEE2E2",color:b.vchType==="Sales"?"#166534":"#991B1B"},children:b.vchType})}),c.jsx("td",{style:{padding:"8px",borderRight:"1px solid #E2E8F0"},children:b.vchNo&&b.isInvoice&&!b.isHistorical?c.jsx("button",{onClick:()=>g4(b.vchNo),style:{background:"none",border:"none",padding:0,fontWeight:"600",color:"#2874A6",cursor:"pointer",textDecoration:"underline",fontSize:"11px"},title:"Click to view invoice",children:b.vchNo}):c.jsx("span",{style:{fontWeight:"600",color:b.isCreditNote?"#DC2626":"#2874A6"},children:b.vchNo})}),c.jsx("td",{style:{padding:"8px",textAlign:"right",fontWeight:"600",borderRight:"1px solid #E2E8F0"},children:b.debit>0?Ot(b.debit):""}),c.jsx("td",{style:{padding:"8px",textAlign:"right",color:"#DC2626",borderRight:"1px solid #E2E8F0"},children:b.credit>0?Ot(b.credit):""}),c.jsx("td",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #E2E8F0"},children:b.receiptDate?_t(b.receiptDate):""}),c.jsx("td",{style:{padding:"8px",textAlign:"right",color:"#059669",fontWeight:b.amountReceived>0?"600":"400",borderRight:"1px solid #E2E8F0"},children:b.amountReceived>0?Ot(b.amountReceived):""}),c.jsx("td",{style:{padding:"8px",textAlign:"right",borderRight:"1px solid #E2E8F0"},children:b.tdsReceived>0?Ot(b.tdsReceived):""}),c.jsx("td",{style:{padding:"8px",textAlign:"right",fontWeight:"600",color:typeof b.balance=="number"&&b.balance>0?"#DC2626":"",borderRight:"1px solid #E2E8F0"},children:b.isOpening?b.balance>0?Ot(b.balance):"":b.balance==="-"?"-":typeof b.balance=="number"&&b.balance>0?Ot(b.balance):"-"}),c.jsx("td",{style:{padding:"8px",textAlign:"center"},children:b.paymentStatus&&c.jsx("span",{style:{padding:"2px 8px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:b.paymentStatus==="Received"?"#DCFCE7":"#FEF3C7",color:b.paymentStatus==="Received"?"#166534":"#92400E"},children:b.paymentStatus})}),_r&&c.jsx("td",{style:{padding:"8px",textAlign:"center"},children:b.isHistorical&&!b.isOpening&&c.jsx("button",{onClick:()=>n4(ne.find(ie=>ie.id===b.id)),style:{padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete historical entry",children:""})})]}),b.subRows&&b.subRows.length>0&&b.subRows.map((ie,J)=>c.jsxs("tr",{style:{backgroundColor:b.isOpening?"#FEF3C7":b.hasCN||b.isCreditNote?"#FFFBEB":"#FFFFFF",borderBottom:J===b.subRows.length-1?"2px solid #CBD5E1":"1px solid #E2E8F0",borderLeft:b.hasCN||b.isCreditNote?"4px solid #F59E0B":"none"},children:[c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px 6px 30px",color:"#475569",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:ie.particular}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:ie.debit?Ot(ie.debit):""}),c.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:ie.credit?Ot(ie.credit):""}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),_r&&c.jsx("td",{style:{padding:"6px 8px"}})]},`${b.id}-sub-${J}`))]},b.id))})]})})]}):c.jsx("div",{style:{padding:"60px",textAlign:"center",color:"#94A3B8"},children:"Select a party to view ledger"})})]})]})},[Fc,ky]=ve.useState(""),g0=ve.useMemo(()=>{const h=new Map,_=L=>{if(!L)return"";const se=L.split("/");return se.length>=3?se.slice(1).join("/"):se.length===2?se.join("/"):se[se.length-1]},U=Gn.filter(L=>{var se;return L.isHistorical&&(L.type==="creditnote"||((se=L.vchNo)==null?void 0:se.toUpperCase().startsWith("CN")))}),q=new Map;return Ai.forEach(L=>{const se=_(L.invoiceNo);se&&q.set(se,L)}),U.forEach(L=>{const se=_(L.vchNo);se&&!q.has(se)&&q.set(se,L)}),Sn.filter(L=>L.invoiceGenerated&&L.invoiceStatus==="Approved").forEach(L=>{if(h.has(L.invoiceNo))h.has(L.invoiceNo)&&h.get(L.invoiceNo).campaigns.push(L);else{const se=Vr.find(K=>K.invoiceNo===L.invoiceNo),N=Ai.find(K=>K.invoiceNo===L.invoiceNo),b=parseFloat(L.invoiceTotalAmount)||0,ie=N?Math.abs(parseFloat(N.totalAmount)||parseFloat(N.credit)||0):0,J=N&&ie>=b,oe=L.clientCode||rn(L.partyName,L.statePartyDetails);if(!se&&!J){const K=N?b-ie:b;h.set(L.invoiceNo,{invoiceNo:L.invoiceNo,partyName:L.partyName,clientCode:oe,invoiceDate:L.invoiceDate,invoiceTotalAmount:L.invoiceTotalAmount,pendingAmount:K,hasPartialCN:!!N&&!J&&ie>0,cnAmount:ie,subject:L.subject,campaigns:[L],isHistorical:!1,invoiceType:L.invoiceType||"Individual",source:"Campaign"})}}}),Ur.filter(L=>L.invoiceGenerated&&L.invoiceStatus==="Approved").forEach(L=>{if(!h.has(L.invoiceNo)){const se=Vr.find(K=>K.invoiceNo===L.invoiceNo),N=Ai.find(K=>K.invoiceNo===L.invoiceNo),b=parseFloat(L.invoiceTotalAmount)||0,ie=N?Math.abs(parseFloat(N.totalAmount)||parseFloat(N.credit)||0):0,J=N&&ie>=b,oe=L.clientCode||rn(L.partyName,L.statePartyDetails);if(!se&&!J){const K=N?b-ie:b;h.set(L.invoiceNo,{invoiceNo:L.invoiceNo,partyName:L.partyName,clientCode:oe,invoiceDate:L.invoiceDate,invoiceTotalAmount:L.invoiceTotalAmount,pendingAmount:K,hasPartialCN:!!N&&!J&&ie>0,cnAmount:ie,subject:L.serviceType||"",campaigns:[],isHistorical:!1,invoiceType:"Service",isService:!0,source:"Service"})}}}),Gn.filter(L=>{var se;return L.isHistorical&&L.type!=="creditnote"&&!((se=L.vchNo)!=null&&se.toUpperCase().startsWith("CN"))&&L.debit>0}).forEach(L=>{if(!h.has(L.vchNo)){const se=Vr.find(tt=>tt.invoiceNo===L.vchNo),N=_(L.vchNo),b=q.get(N),ie=b?Math.abs(parseFloat(b.totalAmount)||parseFloat(b.credit)||parseFloat(b.debit)||0):0,J=parseFloat(L.debit)||0,oe=b&&ie>=J;if(se||oe)return;const K=!(L.amountReceived>0),ee=b&&ie>0&&ie<J;if(K||ee){const tt=ee?J-ie:J;h.set(L.vchNo,{invoiceNo:L.vchNo,partyName:L.partyName,invoiceDate:L.date,invoiceTotalAmount:J,pendingAmount:tt,hasPartialCN:ee,cnAmount:ie,subject:L.particulars||L.narration,campaigns:[],isHistorical:!0,invoiceType:"Historical",source:"Historical"})}}}),Array.from(h.values()).sort((L,se)=>L.partyName.localeCompare(se.partyName))},[Sn,Ur,Vr,Ai,Gn]),J4=ve.useMemo(()=>{const h={};return pa.forEach(_=>{h[_.invoiceNo]||(h[_.invoiceNo]=[]),h[_.invoiceNo].push(_)}),Object.keys(h).forEach(_=>{h[_].sort((U,q)=>new Date(q.followupDate)-new Date(U.followupDate))}),h},[pa]),Fy=ve.useMemo(()=>{const h=new Date().toISOString().split("T")[0];return pa.filter(_=>_.nextFollowupDate&&_.nextFollowupDate>=h).sort((_,U)=>new Date(_.nextFollowupDate)-new Date(U.nextFollowupDate))},[pa]),m0=ve.useMemo(()=>{let h=g0;if(Fc){const U=Fc.toLowerCase();h=g0.filter(q=>{var L,se,N;return((L=q.invoiceNo)==null?void 0:L.toLowerCase().includes(U))||((se=q.partyName)==null?void 0:se.toLowerCase().includes(U))||((N=q.subject)==null?void 0:N.toLowerCase().includes(U))})}const _={};return h.forEach(U=>{_[U.partyName]||(_[U.partyName]={partyName:U.partyName,invoices:[],totalAmount:0}),_[U.partyName].invoices.push(U),_[U.partyName].totalAmount+=parseFloat(U.pendingAmount||U.invoiceTotalAmount)||0}),Object.values(_).sort((U,q)=>U.partyName.localeCompare(q.partyName))},[g0,Fc]),Z4=()=>{const h=m0.reduce((_,U)=>_+U.invoices.length,0);return c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Followups"}),c.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[c.jsxs("span",{style:{padding:"6px 12px",backgroundColor:"#EFF6FF",borderRadius:"6px",fontSize:"12px",color:"#1E40AF",fontWeight:"600"},children:[m0.length," Parties | ",h," Invoices"]}),ii&&c.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"})]})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(hd,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Search:"})]}),c.jsxs("div",{style:{position:"relative",flex:1,maxWidth:"300px"},children:[c.jsx(X0,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",placeholder:"Search party, invoice, subject...",value:Fc,onChange:_=>ky(_.target.value),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"100%"}})]}),Fc&&c.jsxs("button",{onClick:()=>ky(""),style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(Sa,{size:14})," Clear"]}),Fc&&c.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",h," of ",g0.length]})]})}),Fy.length>0&&c.jsx(gn,{title:" Upcoming Followups",style:{marginBottom:"16px"},children:c.jsx("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:Fy.slice(0,5).map(_=>c.jsxs("div",{style:{padding:"10px 14px",backgroundColor:new Date(_.nextFollowupDate).toISOString().split("T")[0]===new Date().toISOString().split("T")[0]?"#FEE2E2":"#FEF3C7",borderRadius:"8px",border:"1px solid #FCD34D"},children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#92400E"},children:_.invoiceNo}),c.jsx("div",{style:{fontSize:"11px",color:"#78716C"},children:_.partyName}),c.jsxs("div",{style:{fontSize:"12px",fontWeight:"600",color:"#DC2626",marginTop:"4px"},children:[" ",_t(_.nextFollowupDate)]})]},_.id))})}),m0.length===0?c.jsx(gn,{children:c.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:" No pending invoices! All payments received."})}):m0.map(_=>c.jsxs(gn,{style:{marginBottom:"16px"},noPadding:!0,children:[c.jsxs("div",{style:{padding:"12px 16px",backgroundColor:"#1E293B",color:"white",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[c.jsxs("span",{style:{fontSize:"15px",fontWeight:"700"},children:[" ",_.partyName]}),c.jsxs("span",{style:{padding:"3px 10px",backgroundColor:"#3B82F6",borderRadius:"12px",fontSize:"11px",fontWeight:"600"},children:[_.invoices.length," Invoice",_.invoices.length>1?"s":""]})]}),c.jsxs("div",{style:{fontSize:"14px",fontWeight:"700",color:"#FCD34D"},children:["Total: ",nt(_.totalAmount)]})]}),c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[c.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700",color:"#6B21A8",backgroundColor:"#FAF5FF"},children:"Code"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Type"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Invoice Date"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:"Amount"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Days Pending"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Last Followup"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),c.jsx("tbody",{children:_.invoices.map(U=>{var ie,J,oe;const q=J4[U.invoiceNo]||[],L=q[0],se=Math.floor((new Date-new Date(U.invoiceDate))/(1e3*60*60*24)),N=U.isHistorical?"Historical":U.isService?"Service":U.invoiceType||(((ie=U.campaigns)==null?void 0:ie.length)>1?"Combined":"Individual"),b=U.clientCode||(U.campaigns&&U.campaigns[0]?rn(U.campaigns[0].partyName,U.campaigns[0].statePartyDetails):"");return c.jsxs(sh.Fragment,{children:[c.jsxs("tr",{style:{borderBottom:"1px solid #E2E8F0",backgroundColor:se>30?"#FEF2F2":se>15?"#FFFBEB":"#FFFFFF"},children:[c.jsxs("td",{style:{padding:"10px 12px",fontWeight:"600",color:"#2874A6"},children:[U.invoiceNo,U.hasPartialCN&&c.jsx("span",{style:{marginLeft:"6px",padding:"2px 6px",backgroundColor:"#FEF3C7",color:"#92400E",borderRadius:"4px",fontSize:"9px",fontWeight:"700"},children:"Partial CN"})]}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center",backgroundColor:"#FAF5FF"},children:c.jsx("span",{style:{fontWeight:"700",color:"#6B21A8",fontSize:"11px"},children:b||"-"})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsx("span",{style:{padding:"3px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"600",backgroundColor:N==="Historical"?"#E0E7FF":N==="Service"?"#FEF3C7":N==="Combined"?"#F3E8FF":"#DCFCE7",color:N==="Historical"?"#3730A3":N==="Service"?"#92400E":N==="Combined"?"#7C3AED":"#166534"},children:N})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:_t(U.invoiceDate)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600"},children:U.hasPartialCN?c.jsxs("div",{children:[c.jsx("div",{style:{color:"#DC2626"},children:nt(U.pendingAmount)}),c.jsx("div",{style:{fontSize:"9px",color:"#64748B",textDecoration:"line-through"},children:nt(U.invoiceTotalAmount)})]}):nt(U.invoiceTotalAmount)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsxs("span",{style:{padding:"3px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"700",backgroundColor:se>30?"#FEE2E2":se>15?"#FEF3C7":"#DCFCE7",color:se>30?"#991B1B":se>15?"#92400E":"#166534"},children:[se," days"]})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center",fontSize:"11px"},children:L?c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"600"},children:_t(L.followupDate)}),c.jsxs("div",{style:{color:"#64748B",fontSize:"10px"},children:[(J=L.notes)==null?void 0:J.substring(0,30),((oe=L.notes)==null?void 0:oe.length)>30?"...":""]})]}):c.jsx("span",{style:{color:"#DC2626",fontWeight:"600"},children:"No followup yet"})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsxs("div",{style:{display:"flex",gap:"4px",justifyContent:"center"},children:[_r&&c.jsx(Ke,{icon:pd,small:!0,variant:"primary",onClick:()=>s4(U),title:"Add Followup"}),c.jsx(Ke,{icon:nm,small:!0,variant:"brand",onClick:()=>my(U),title:"Copy Email Template"}),c.jsx(Ke,{icon:K0,small:!0,variant:"success",onClick:()=>xy(U),title:"Search in Gmail"})]})})]}),q.length>0&&c.jsx("tr",{children:c.jsxs("td",{colSpan:"8",style:{padding:"8px 12px 12px 40px",backgroundColor:"#F8FAFC"},children:[c.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#64748B",marginBottom:"6px"},children:"Followup History:"}),c.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:q.map(K=>c.jsxs("div",{style:{padding:"6px 10px",backgroundColor:"#FFFFFF",borderRadius:"6px",border:"1px solid #E2E8F0",fontSize:"11px"},children:[c.jsx("div",{style:{fontWeight:"600",color:"#2874A6"},children:_t(K.followupDate)}),c.jsx("div",{style:{color:"#475569",marginTop:"2px"},children:K.notes}),K.nextFollowupDate&&c.jsxs("div",{style:{color:"#DC2626",marginTop:"2px",fontSize:"10px"},children:["Next: ",_t(K.nextFollowupDate)]}),_r&&c.jsx("button",{onClick:()=>o4(K.id),style:{background:"none",border:"none",color:"#DC2626",cursor:"pointer",fontSize:"10px",padding:"2px 0",marginTop:"4px"},children:" Delete"})]},K.id))})]})})]},U.invoiceNo)})})]})]},_.partyName))]})},by=()=>{const h=Ee.filter(L=>L.invoiceGenerated).reduce((L,se)=>L+(parseFloat(se.invoiceTotalAmount)||0),0),_=Ee.filter(L=>L.invoiceStatus==="Paid").reduce((L,se)=>L+(parseFloat(se.invoiceTotalAmount)||0),0),U=Ee.filter(L=>L.invoiceStatus==="Approved").reduce((L,se)=>L+(parseFloat(se.invoiceTotalAmount)||0),0),q=Ee.filter(L=>L.invoiceStatus==="Need Edits").length;return c.jsxs("div",{children:[c.jsx("h1",{style:{margin:"0 0 16px",fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Reports"}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px"},children:[c.jsxs(gn,{children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Total Invoiced"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:nt(h)})]}),c.jsxs(gn,{children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Approved"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669"},children:nt(U)})]}),c.jsxs(gn,{children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Need Edits"}),c.jsxs("div",{style:{fontSize:"24px",fontWeight:"700",color:"#DC2626"},children:[q," invoices"]})]}),c.jsxs(gn,{children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Paid"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669"},children:nt(_)})]})]})]})},eb=()=>c.jsxs("div",{children:[c.jsx("h1",{style:{margin:"0 0 16px",fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Settings"}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[c.jsxs(gn,{title:" Invoice Series",children:[c.jsx(Mr,{label:"Invoice Prefix",value:w.invoicePrefix,onChange:h=>R(_=>({..._,invoicePrefix:h.target.value})),small:!0}),c.jsx(Mr,{label:"Next Invoice Number",type:"number",value:it,onChange:h=>Z(parseInt(h.target.value)||1),small:!0}),c.jsx(Mr,{label:"Next Combine Code",type:"number",value:Rt,onChange:h=>Et(parseInt(h.target.value)||1),small:!0}),c.jsxs("div",{style:{padding:"10px",backgroundColor:"#EFF6FF",borderRadius:"8px",fontSize:"14px"},children:[c.jsx("strong",{children:"Preview:"})," ",w.invoicePrefix,it]})]}),c.jsxs(gn,{title:" Mailer Logo",children:[c.jsx("input",{type:"file",ref:Sc,accept:"image/*",style:{display:"none"},onChange:F4}),Hn?c.jsxs("div",{style:{textAlign:"center"},children:[c.jsx("img",{src:Hn,alt:"Logo",style:{maxWidth:"250px",maxHeight:"60px",marginBottom:"12px",border:"1px solid #E2E8F0",padding:"8px",borderRadius:"8px"}}),c.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"center"},children:[c.jsx(Ke,{icon:UL,label:"Change",small:!0,onClick:()=>{var h;return(h=Sc.current)==null?void 0:h.click()}}),c.jsx(Ke,{icon:ns,label:"Remove",variant:"danger",small:!0,onClick:()=>ha(null)})]})]}):c.jsxs("div",{onClick:()=>{var h;return(h=Sc.current)==null?void 0:h.click()},style:{border:"2px dashed #CBD5E1",borderRadius:"10px",padding:"30px",textAlign:"center",cursor:"pointer"},children:[c.jsx(Ks,{size:32,color:"#94A3B8",style:{marginBottom:"8px"}}),c.jsx("p",{style:{margin:0,color:"#64748B",fontSize:"14px"},children:"Click to upload"})]})]}),c.jsxs(gn,{title:" WhatsApp Notifications",children:[c.jsx("div",{style:{marginBottom:"16px"},children:c.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"10px",cursor:"pointer"},children:[c.jsx("input",{type:"checkbox",checked:At.enabled,onChange:h=>ua(_=>({..._,enabled:h.target.checked})),style:{width:"18px",height:"18px",cursor:"pointer"}}),c.jsx("span",{style:{fontSize:"14px",fontWeight:"600",color:"#1E293B"},children:"Enable WhatsApp Notifications"})]})}),At.enabled&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{style:{padding:"12px",backgroundColor:"#DCFCE7",borderRadius:"8px",marginBottom:"16px",fontSize:"12px",color:"#166534",border:"1px solid #86EFAC"},children:[c.jsx("strong",{children:" FREE Setup using CallMeBot:"}),c.jsx("br",{}),"1. Save this number in contacts: ",c.jsx("strong",{children:"+34 644 71 81 99"}),c.jsx("br",{}),"2. Send this message to the number on WhatsApp: ",c.jsx("strong",{children:'"I allow callmebot to send me messages"'}),c.jsx("br",{}),"3. You'll receive an API key - enter it below",c.jsx("br",{}),"4. Repeat for each phone number you want to receive notifications"]}),c.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",marginBottom:"12px",border:"1px solid #E2E8F0"},children:[c.jsxs("div",{style:{fontSize:"13px",fontWeight:"700",color:"#1E293B",marginBottom:"10px",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(Y0,{size:16})," Finance Team"]}),c.jsx(Mr,{label:"Phone (with country code)",value:At.financePhone,onChange:h=>ua(_=>({..._,financePhone:h.target.value})),placeholder:"919876543210",small:!0}),c.jsx(Mr,{label:"API Key (from CallMeBot)",value:At.financeApiKey,onChange:h=>ua(_=>({..._,financeApiKey:h.target.value})),placeholder:"123456",small:!0}),At.financePhone&&At.financeApiKey&&c.jsx(Ke,{icon:iE,label:"Test Finance",variant:"success",small:!0,onClick:()=>kl(At.financePhone,At.financeApiKey)})]}),c.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",border:"1px solid #E2E8F0"},children:[c.jsxs("div",{style:{fontSize:"13px",fontWeight:"700",color:"#1E293B",marginBottom:"10px",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(Y0,{size:16})," Director"]}),c.jsx(Mr,{label:"Phone (with country code)",value:At.directorPhone,onChange:h=>ua(_=>({..._,directorPhone:h.target.value})),placeholder:"919876543210",small:!0}),c.jsx(Mr,{label:"API Key (from CallMeBot)",value:At.directorApiKey,onChange:h=>ua(_=>({..._,directorApiKey:h.target.value})),placeholder:"123456",small:!0}),At.directorPhone&&At.directorApiKey&&c.jsx(Ke,{icon:iE,label:"Test Director",variant:"success",small:!0,onClick:()=>kl(At.directorPhone,At.directorApiKey)})]})]}),!At.enabled&&c.jsx("div",{style:{padding:"20px",backgroundColor:"#F8FAFC",borderRadius:"8px",textAlign:"center",color:"#64748B",fontSize:"13px"},children:"WhatsApp notifications are disabled. Enable to receive FREE alerts for invoices, approvals, and payments."})]}),c.jsxs(gn,{title:" Default Invoice Values",children:[c.jsx("input",{type:"file",ref:wc,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:c4}),c.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[c.jsx(Ke,{icon:Ks,label:"Upload",variant:"brand",small:!0,onClick:()=>{var h;return(h=wc.current)==null?void 0:h.click()}}),c.jsx(Ke,{icon:Do,label:"Template",small:!0,onClick:u4})]}),Object.keys(Ui).length>0&&c.jsx("div",{style:{maxHeight:"180px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"8px"},children:Object.entries(Ui).map(([h,_])=>c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px 14px",borderBottom:"1px solid #F1F5F9",fontSize:"13px"},children:[c.jsx("span",{children:h}),c.jsx("span",{style:{fontWeight:"700"},children:nt(_)})]},h))})]}),c.jsxs(gn,{title:" Party Master",children:[c.jsx("input",{type:"file",ref:Xu,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:d4}),c.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[c.jsx(Ke,{icon:Ks,label:"Upload Parties",variant:"brand",small:!0,onClick:()=>{var h;return(h=Xu.current)==null?void 0:h.click()}}),c.jsx(Ke,{icon:Do,label:"Template",small:!0,onClick:f4})]}),c.jsxs("div",{style:{padding:"10px",backgroundColor:"#EFF6FF",borderRadius:"8px",fontSize:"12px",color:"#1E40AF",marginBottom:"12px"},children:[c.jsx("strong",{children:"Upload Format:"})," Name of Ledger, Ledger Group, State Name, GST Registration Type, GSTIN/UIN"]}),Object.keys(tn).length>0&&c.jsxs("div",{style:{maxHeight:"150px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"8px"},children:[Object.entries(tn).slice(0,20).map(([h,_])=>c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 12px",borderBottom:"1px solid #F1F5F9",fontSize:"11px"},children:[c.jsx("span",{style:{fontWeight:"600"},children:h.length>30?h.substring(0,30)+"...":h}),c.jsxs("span",{style:{color:"#64748B"},children:[_.stateName||"-"," | ",_.gstin?_.gstin.substring(0,10)+"...":"-"]})]},h)),Object.keys(tn).length>20&&c.jsxs("div",{style:{padding:"8px 12px",textAlign:"center",color:"#64748B",fontSize:"11px"},children:["... and ",Object.keys(tn).length-20," more parties"]})]}),Object.keys(tn).length===0&&c.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#94A3B8",fontSize:"13px"},children:"No party master uploaded yet"})]}),c.jsxs(gn,{title:" Data Management",children:[c.jsxs("div",{style:{padding:"16px",backgroundColor:"#FEF2F2",borderRadius:"10px",border:"1px solid #FCA5A5",marginBottom:"16px"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"14px",marginBottom:"8px"},children:" Danger Zone"}),c.jsxs("div",{style:{fontSize:"13px",color:"#7F1D1D",marginBottom:"16px"},children:["This will permanently delete all data including:",c.jsxs("ul",{style:{margin:"8px 0 0 16px",padding:0},children:[c.jsx("li",{children:"All campaigns and master data"}),c.jsx("li",{children:"All invoices and receipts"}),c.jsx("li",{children:"All ledger entries"}),c.jsx("li",{children:"All mailer images"}),c.jsx("li",{children:"Opening balances and settings"})]})]}),c.jsx(Ke,{icon:ns,label:"Clear All Data",variant:"danger",onClick:()=>Us(!0)})]}),c.jsxs("div",{style:{fontSize:"12px",color:"#64748B"},children:[c.jsx("strong",{children:"Current Data:"}),c.jsx("br",{})," ",Ee.length," campaigns",c.jsx("br",{})," ",ne.length," ledger entries",c.jsx("br",{})," ",je.length," receipts",c.jsx("br",{})," ",Object.keys(Ct).length," mailer images"]})]})]})]}),tb=()=>c.jsxs(c.Fragment,{children:[c.jsx(Bn,{isOpen:b4,onClose:()=>{Ey(!1),wy("")},title:" Invoice Preview",width:"950px",children:le&&Sy&&c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px",padding:"14px 18px",backgroundColor:"#DCFCE7",borderRadius:"10px",border:"2px solid #22C55E"},children:[c.jsxs("div",{children:[c.jsxs("span",{style:{fontWeight:"700",fontSize:"16px",color:"#166534"},children:["Invoice: ",le.invoiceNo]}),le.invoiceType==="Combined"&&c.jsxs("span",{style:{marginLeft:"12px",padding:"4px 10px",backgroundColor:"#7C3AED",color:"white",borderRadius:"6px",fontSize:"12px",fontWeight:"600"},children:["Combined - C",le.combinationCode]})]}),c.jsxs("button",{onClick:()=>N4(le),style:{padding:"14px 28px",fontSize:"16px",fontWeight:"bold",border:"none",borderRadius:"10px",cursor:"pointer",backgroundColor:"#22C55E",color:"white",display:"flex",alignItems:"center",gap:"10px",boxShadow:"0 2px 8px rgba(34, 197, 94, 0.4)"},children:[c.jsx(Do,{size:20}),"Download Invoice"]})]}),c.jsx("div",{style:{border:"2px solid #E2E8F0",borderRadius:"10px",overflow:"hidden",backgroundColor:"#f5f5f5"},children:c.jsx("iframe",{id:"invoice-viewer-iframe",srcDoc:Sy,style:{width:"100%",height:"480px",border:"none",backgroundColor:"white"},title:"Invoice Preview"})}),c.jsxs("div",{style:{marginTop:"12px",padding:"14px 18px",backgroundColor:"#FEF3C7",borderRadius:"10px",border:"1px solid #FCD34D"},children:[c.jsx("div",{style:{fontSize:"14px",color:"#92400E",fontWeight:"600",marginBottom:"6px"},children:" How to Save as PDF:"}),c.jsxs("ol",{style:{fontSize:"13px",color:"#92400E",margin:"0",paddingLeft:"20px",lineHeight:"1.8"},children:[c.jsxs("li",{children:["Click ",c.jsx("strong",{children:'"Download Invoice"'})," button above"]}),c.jsxs("li",{children:["Open the downloaded ",c.jsx("strong",{children:".html file"})," in Chrome/Edge browser"]}),c.jsxs("li",{children:["Print dialog will open automatically - select ",c.jsx("strong",{children:'"Save as PDF"'})]}),c.jsxs("li",{children:["Click ",c.jsx("strong",{children:"Save"})," to get your PDF!"]})]})]})]})}),c.jsx(Bn,{isOpen:Pr,onClose:()=>{Rn(!1),Or(""),Ti({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1})},title:ii?" Review & Approve Invoice":" Invoice Details",width:"550px",children:le&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",le.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",le.partyName]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Amount:"})," ",nt(le.invoiceTotalAmount)]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Email:"})," ",le.emailId||"Not set"]}),c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Invoice Type:"})," ",c.jsx("span",{style:{color:le.invoiceType==="Combined"?"#7C3AED":"#2874A6",fontWeight:"600"},children:le.invoiceType||"Individual"})]}),le.invoiceType==="Combined"&&c.jsxs("div",{style:{marginTop:"8px",fontSize:"13px",color:"#7C3AED"},children:[c.jsx("strong",{children:"Combined Campaigns:"})," ",ce(le).map(h=>h.senderName).join(", ")]})]}),le.editComments&&c.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[c.jsx("div",{style:{fontWeight:"600",color:"#991B1B",fontSize:"13px",marginBottom:"4px"},children:" Need Edits - Director Remarks:"}),c.jsx("div",{style:{fontSize:"13px",color:"#7F1D1D"},children:le.editComments})]}),le.approvalRemarks&&le.invoiceStatus==="Approved"&&c.jsxs("div",{style:{backgroundColor:"#DCFCE7",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[c.jsx("div",{style:{fontWeight:"600",color:"#166534",fontSize:"13px",marginBottom:"4px"},children:" Approved - Director Remarks:"}),c.jsx("div",{style:{fontSize:"13px",color:"#15803D"},children:le.approvalRemarks})]}),ii?c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#166534",fontSize:"14px",marginBottom:"12px"},children:" Approval Confirmations"}),c.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",marginBottom:"12px",cursor:"pointer"},children:[c.jsx("input",{type:"checkbox",checked:yo.particularsApproved,onChange:h=>Ti(_=>({..._,particularsApproved:h.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"1. Particulars & Amount Approved"}),c.jsxs("div",{style:{fontSize:"12px",color:"#15803D"},children:["I confirm that the invoice particulars and amount (",nt(le.invoiceTotalAmount),") are correct."]})]})]}),c.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",marginBottom:"12px",cursor:"pointer"},children:[c.jsx("input",{type:"checkbox",checked:yo.emailApproved,onChange:h=>Ti(_=>({..._,emailApproved:h.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"2. Email ID Approved for Mailing"}),c.jsxs("div",{style:{fontSize:"12px",color:"#15803D"},children:["I confirm that ",c.jsx("strong",{children:le.emailId||"the specified email"})," should be used for mailing."]})]})]}),c.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",cursor:"pointer"},children:[c.jsx("input",{type:"checkbox",checked:yo.invoiceTypeApproved,onChange:h=>Ti(_=>({..._,invoiceTypeApproved:h.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"3. Invoice Type Confirmed"}),c.jsx("div",{style:{fontSize:"12px",color:"#15803D"},children:le.invoiceType==="Combined"?`I confirm that a Combined Invoice is required for these ${ce(le).length} campaigns.`:"I confirm that an Individual Invoice is required (not combined with others)."})]})]})]}):c.jsxs("div",{style:{backgroundColor:le.invoiceStatus==="Approved"?"#DCFCE7":le.invoiceStatus==="Need Edits"?"#FEF3C7":"#F8FAFC",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid "+(le.invoiceStatus==="Approved"?"#86EFAC":le.invoiceStatus==="Need Edits"?"#FCD34D":"#E2E8F0")},children:[c.jsx("div",{style:{fontWeight:"600",color:le.invoiceStatus==="Approved"?"#166534":le.invoiceStatus==="Need Edits"?"#92400E":"#64748B",fontSize:"14px"},children:le.invoiceStatus==="Approved"?" Approved by Director":le.invoiceStatus==="Need Edits"?" Edits Required by Director":" Pending Director Approval"}),c.jsx("div",{style:{fontSize:"13px",color:le.invoiceStatus==="Approved"?"#15803D":le.invoiceStatus==="Need Edits"?"#A16207":"#64748B",marginTop:"6px"},children:le.invoiceStatus==="Approved"?"This invoice has been approved and is ready for mailing.":le.invoiceStatus==="Need Edits"?"Please make the required changes and resubmit for approval.":"This invoice is awaiting Director approval."})]}),ii&&c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:" Remarks (optional for Approve, visible to Finance)"}),c.jsx("textarea",{value:la,onChange:h=>Or(h.target.value),placeholder:"Enter remarks or comments...",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(Ke,{label:"Close",onClick:()=>{Rn(!1),Or(""),Ti({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1})}}),ii&&c.jsxs(c.Fragment,{children:[c.jsx(Ke,{label:"Need Edits",variant:"danger",icon:LL,onClick:bo}),c.jsx(Ke,{label:"Approve",variant:"success",icon:WL,onClick:Pn})]})]})]})}),c.jsx(Bn,{isOpen:xo,onClose:()=>vo(!1),title:" Delete Invoice",width:"450px",children:le&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"15px",marginBottom:"8px"},children:" Are you sure?"}),c.jsxs("div",{style:{fontSize:"14px",color:"#7F1D1D",lineHeight:"1.5"},children:["This will delete invoice ",c.jsx("strong",{children:le.invoiceNo})," and reset the campaign(s) to allow re-generation.",le.invoiceType==="Combined"&&c.jsxs("div",{style:{marginTop:"8px"},children:[c.jsxs("strong",{children:["All ",ce(le).length," combined campaigns"]})," will be reset to Individual type for re-selection."]})]})]}),c.jsxs("div",{style:{backgroundColor:"#F8FAFC",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"Invoice:"})," ",le.invoiceNo]}),c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"Party:"})," ",le.partyName]}),c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"Amount:"})," ",nt(le.invoiceTotalAmount)]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(Ke,{label:"Cancel",onClick:()=>vo(!1)}),c.jsx(Ke,{label:"Delete Invoice",variant:"danger",icon:ns,onClick:e4})]})]})}),c.jsx(Bn,{isOpen:Ar,onClose:()=>Dr(!1),title:" Add Email Address",width:"400px",children:le&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"Campaign:"})," ",le.senderName]}),c.jsxs("div",{style:{fontSize:"13px",marginTop:"4px"},children:[c.jsx("strong",{children:"Current:"})," ",le.emailId||"None"]})]}),c.jsx(Mr,{label:"Additional Email Address",type:"email",value:ja,onChange:h=>xs(h.target.value),placeholder:"email@example.com",small:!0}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:[c.jsx(Ke,{label:"Cancel",onClick:()=>Dr(!1)}),c.jsx(Ke,{label:"Add Email",variant:"brand",icon:sm,onClick:()=>{ja&&ja.includes("@")?(wn(le.id,ja),Dr(!1),xs("")):alert("Please enter a valid email address")}})]})]})}),c.jsx(Bn,{isOpen:C,onClose:()=>{E(!1),X({currentPassword:"",newPassword:"",confirmPassword:""}),T("")},title:" Change Password",width:"400px",children:c.jsxs("div",{children:[c.jsx("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"User:"})," ",r==="director"?"Director":"Finance Team"]})}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Current Password"}),c.jsx("input",{type:"password",value:M.currentPassword,onChange:h=>X(_=>({..._,currentPassword:h.target.value})),placeholder:"Enter current password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"New Password"}),c.jsx("input",{type:"password",value:M.newPassword,onChange:h=>X(_=>({..._,newPassword:h.target.value})),placeholder:"Enter new password (min 6 characters)",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Confirm New Password"}),c.jsx("input",{type:"password",value:M.confirmPassword,onChange:h=>X(_=>({..._,confirmPassword:h.target.value})),placeholder:"Confirm new password",onKeyPress:h=>h.key==="Enter"&&Fo(),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),z&&c.jsx("div",{style:{marginBottom:"16px",padding:"10px",backgroundColor:"#FEE2E2",borderRadius:"8px",color:"#991B1B",fontSize:"13px"},children:z}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[c.jsx(Ke,{label:"Cancel",onClick:()=>{E(!1),X({currentPassword:"",newPassword:"",confirmPassword:""}),T("")}}),c.jsx(Ke,{label:"Change Password",variant:"brand",icon:G0,onClick:Fo})]})]})}),c.jsx(Bn,{isOpen:C,onClose:()=>{E(!1),T(""),X({currentPassword:"",newPassword:"",confirmPassword:""})},title:" Change Password",width:"400px",children:c.jsxs("div",{children:[c.jsx("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:c.jsxs("div",{style:{fontSize:"13px",color:"#1E40AF"},children:["Changing password for: ",c.jsx("strong",{children:r==="director"?"Director":"Finance Team"})]})}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Current Password"}),c.jsx("input",{type:"password",value:M.currentPassword,onChange:h=>X(_=>({..._,currentPassword:h.target.value})),placeholder:"Enter current password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"New Password"}),c.jsx("input",{type:"password",value:M.newPassword,onChange:h=>X(_=>({..._,newPassword:h.target.value})),placeholder:"Enter new password (min 6 chars)",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Confirm New Password"}),c.jsx("input",{type:"password",value:M.confirmPassword,onChange:h=>X(_=>({..._,confirmPassword:h.target.value})),placeholder:"Re-enter new password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),z&&c.jsx("div",{style:{marginBottom:"16px",padding:"10px",backgroundColor:"#FEE2E2",borderRadius:"8px",color:"#991B1B",fontSize:"13px"},children:z}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[c.jsx(Ke,{label:"Cancel",onClick:()=>{E(!1),T(""),X({currentPassword:"",newPassword:"",confirmPassword:""})}}),c.jsx(Ke,{label:"Change Password",variant:"brand",icon:G0,onClick:Fo})]})]})}),c.jsx(Bn,{isOpen:Ei,onClose:()=>{mt(!1),Eo(new Set),_o(null)},title:" Combine Invoices",width:"700px",children:ji&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#F3E8FF",padding:"14px 18px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"15px",fontWeight:"700",color:"#6B21A8"},children:["Party: ",ji]}),c.jsx("div",{style:{fontSize:"13px",color:"#7C3AED",marginTop:"4px"},children:"Select 2+ campaigns to combine into a single invoice"})]}),c.jsx("div",{style:{maxHeight:"350px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"10px"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",position:"sticky",top:0},children:[c.jsx("th",{style:{padding:"12px",textAlign:"center",width:"50px"},children:""}),c.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Sender"}),c.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Subject"}),c.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Date"}),c.jsx("th",{style:{padding:"12px",textAlign:"right"},children:"Amount"})]})}),c.jsx("tbody",{children:k(ji).map(h=>{var _;return c.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:Li.has(h.id)?"#F3E8FF":"transparent",cursor:"pointer"},onClick:()=>w4(h.id),children:[c.jsx("td",{style:{padding:"12px",textAlign:"center"},children:c.jsx("input",{type:"checkbox",checked:Li.has(h.id),onChange:()=>{},style:{width:"18px",height:"18px",cursor:"pointer"}})}),c.jsx("td",{style:{padding:"12px",fontWeight:"600"},children:h.senderName}),c.jsxs("td",{style:{padding:"12px",color:"#64748B"},children:[(_=h.subject)==null?void 0:_.substring(0,35),"..."]}),c.jsx("td",{style:{padding:"12px"},children:_t(h.date)}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:nt(h.totalWithGst)})]},h.id)})})]})}),c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px 18px",borderRadius:"10px",marginTop:"16px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsxs("div",{style:{fontSize:"14px",color:"#64748B"},children:["Selected: ",c.jsx("strong",{children:Li.size})," | Combine Code: ",c.jsxs("strong",{children:["C",Rt]})]}),c.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#2874A6"},children:["Total: ",nt(Ee.filter(h=>Li.has(h.id)).reduce((h,_)=>h+(parseFloat(_.totalWithGst)||0),0))]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[c.jsx(Ke,{label:"Cancel",onClick:()=>{mt(!1),Eo(new Set)}}),c.jsx(Ke,{label:"Create Combined Invoice",variant:"purple",icon:Po,disabled:Li.size<2,onClick:S4})]})]})}),c.jsxs(Bn,{isOpen:Pi,onClose:()=>{Oi(!1),Vs(null),wo(!1)},title:Ku?" Replace Mailer":" Upload Mailer",width:"550px",children:[c.jsx("input",{type:"file",ref:Ao,accept:"image/*",style:{display:"none"},onChange:A4}),le&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"14px"},children:[c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Sender:"})," ",le.senderName]}),c.jsxs("div",{style:{fontSize:"14px",marginTop:"4px"},children:[c.jsx("strong",{children:"Subject:"})," ",le.subject]})]}),Ku&&Ct[le.id]&&c.jsx("div",{style:{backgroundColor:"#FEF3C7",padding:"12px",borderRadius:"10px",marginBottom:"14px",border:"1px solid #FCD34D"},children:c.jsxs("div",{style:{fontWeight:"600",color:"#92400E",fontSize:"13px"},children:[" This will replace ",Ct[le.id].length," existing image(s)"]})}),c.jsxs("div",{style:{backgroundColor:"#FEF3C7",padding:"14px",borderRadius:"10px",marginBottom:"14px",border:"1px solid #FCD34D"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#92400E",marginBottom:"8px",fontSize:"14px"},children:"Step 1: Find Mailer in Gmail"}),c.jsxs("button",{onClick:()=>k4(le.subject),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 18px",backgroundColor:"#EA4335",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:[c.jsx(BL,{size:16})," Search in Gmail"]})]}),c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"14px",borderRadius:"10px",border:"1px solid #86EFAC"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#166534",marginBottom:"8px",fontSize:"14px"},children:"Step 2: Paste Screenshot"}),c.jsx("div",{ref:Cr,tabIndex:0,onPaste:C4,onClick:()=>{var h;return(h=Cr.current)==null?void 0:h.focus()},style:{border:So?"3px solid #22C55E":"3px dashed #22C55E",borderRadius:"10px",padding:So?"8px":"30px",textAlign:"center",cursor:"pointer",backgroundColor:So?"#FFFFFF":"#ECFDF5",minHeight:"100px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",outline:"none"},children:So?c.jsxs(c.Fragment,{children:[c.jsx("img",{src:So,alt:"Pasted",style:{maxWidth:"100%",maxHeight:"200px",borderRadius:"8px",marginBottom:"10px"}}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsx(Ke,{icon:eE,label:"Save",variant:"success",onClick:()=>yy(So)}),c.jsx(Ke,{icon:ns,label:"Clear",variant:"danger",onClick:()=>Vs(null)})]})]}):c.jsxs(c.Fragment,{children:[c.jsx(nm,{size:36,color:"#22C55E",style:{marginBottom:"8px"}}),c.jsx("div",{style:{fontWeight:"700",fontSize:"14px",color:"#166534"},children:"Click here & Press Ctrl+V"})]})}),c.jsxs("div",{style:{textAlign:"center",marginTop:"12px"},children:[c.jsx("span",{style:{color:"#64748B",fontSize:"13px"},children:" OR "}),c.jsx("div",{style:{marginTop:"8px"},children:c.jsx(Ke,{icon:Ks,label:"Browse Files",onClick:()=>{var h;return(h=Ao.current)==null?void 0:h.click()}})})]})]})]})]}),c.jsx(Bn,{isOpen:Mi,onClose:()=>jr(!1),title:" Send Invoice Email",width:"600px",children:le&&c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",gap:"0",marginBottom:"16px",border:"2px solid #E2E8F0",borderRadius:"8px",overflow:"hidden"},children:[c.jsx("button",{onClick:()=>Ba("reply"),style:{flex:1,padding:"12px",backgroundColor:oa==="reply"?"#2874A6":"#F8FAFC",color:oa==="reply"?"white":"#64748B",border:"none",cursor:"pointer",fontWeight:"700",fontSize:"14px"},children:" Reply to Thread"}),c.jsx("button",{onClick:()=>Ba("new"),style:{flex:1,padding:"12px",backgroundColor:oa==="new"?"#2874A6":"#F8FAFC",color:oa==="new"?"white":"#64748B",border:"none",cursor:"pointer",fontWeight:"700",fontSize:"14px"},children:" New Email"})]}),c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",le.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Amount:"})," ",nt(le.invoiceTotalAmount||le.totalWithGst)]}),le.invoiceType==="Combined"&&c.jsxs("div",{style:{fontSize:"13px",marginTop:"8px",color:"#7C3AED"},children:[c.jsx("strong",{children:"Campaigns:"})," ",ce(le).map(h=>h.senderName).join(", ")]}),c.jsx("div",{style:{fontSize:"14px",marginTop:"8px"},children:c.jsx("strong",{children:"Recipients:"})}),c.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",marginTop:"6px"},children:[Jt(le).map((h,_)=>c.jsx("span",{style:{padding:"4px 10px",backgroundColor:"#DBEAFE",borderRadius:"6px",fontSize:"13px",color:"#1E40AF"},children:h},_)),Jt(le).length===0&&c.jsx("span",{style:{color:"#94A3B8"},children:"No email addresses"})]})]}),oa==="reply"?c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[c.jsx("span",{style:{fontWeight:"700",fontSize:"14px"},children:"Email Body:"}),c.jsx("button",{onClick:()=>{navigator.clipboard.writeText(p0(le)),alert(" Copied!")},style:{padding:"6px 14px",backgroundColor:"#22C55E",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"600"},children:" Copy"})]}),c.jsx("div",{style:{fontSize:"13px",backgroundColor:"#F8FAFC",padding:"14px",borderRadius:"10px",whiteSpace:"pre-wrap",maxHeight:"200px",overflowY:"auto",fontFamily:"monospace",border:"1px solid #E2E8F0",lineHeight:"1.5"},children:p0(le)})]}):c.jsxs("div",{style:{display:"flex",gap:"10px"},children:[c.jsx("button",{onClick:()=>{const h=Jt(le),_=encodeURIComponent(h.join(",")),U=encodeURIComponent(_y(le)),q=encodeURIComponent(p0(le));window.open(`https://mail.google.com/mail/?view=cm&to=${_}&su=${U}&body=${q}`,"_blank")},style:{padding:"12px 20px",backgroundColor:"#EA4335",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"700"},children:" Open Gmail"}),c.jsx("button",{onClick:()=>{const h=Jt(le),_=encodeURIComponent(h.join(";")),U=encodeURIComponent(_y(le)),q=encodeURIComponent(p0(le));window.open(`https://outlook.live.com/mail/0/deeplink/compose?to=${_}&subject=${U}&body=${q}`,"_blank")},style:{padding:"12px 20px",backgroundColor:"#0078D4",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"700"},children:" Open Outlook"})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[c.jsx(Ke,{label:"View Invoice",icon:Pc,onClick:()=>{jr(!1),ed(le)}}),c.jsx(Ke,{label:"Close",onClick:()=>jr(!1)})]})]})}),c.jsx(Bn,{isOpen:Bi,onClose:()=>cr(!1),title:" Record Payment",width:"500px",children:le&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Invoice:"})," ",le.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginTop:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",le.partyName]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsx(Mr,{label:"Payment Amount",type:"number",value:yr.amount,onChange:h=>Ws({...yr,amount:h.target.value}),small:!0}),c.jsx(Mr,{label:"Date",type:"date",value:yr.date,onChange:h=>Ws({...yr,date:h.target.value}),small:!0})]}),c.jsx(rh,{label:"Payment Mode",value:yr.mode,onChange:h=>Ws({...yr,mode:h.target.value}),options:[{value:"Bank",label:"Bank Transfer"},{value:"UPI",label:"UPI"},{value:"Cheque",label:"Cheque"},{value:"Cash",label:"Cash"}],small:!0}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsx(Mr,{label:"TDS Deducted",type:"number",value:yr.tds,onChange:h=>Ws({...yr,tds:h.target.value}),placeholder:"0",small:!0}),c.jsx(Mr,{label:"Discount",type:"number",value:yr.discount,onChange:h=>Ws({...yr,discount:h.target.value}),placeholder:"0",small:!0})]}),c.jsx(Mr,{label:"Narration",value:yr.narration,onChange:h=>Ws({...yr,narration:h.target.value}),placeholder:"Reference",small:!0}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[c.jsx(Ke,{label:"Cancel",onClick:()=>cr(!1)}),c.jsx(Ke,{label:"Record Payment",variant:"success",icon:tE,onClick:R4})]})]})}),c.jsxs(Bn,{isOpen:Lr,onClose:()=>Tr(!1),title:" Set Opening Balance",width:"450px",children:[c.jsx(rh,{label:"Select Party",value:Dn.partyName,onChange:h=>Zi({...Dn,partyName:h.target.value}),options:[{value:"",label:"Choose a party..."},...Hs.map(h=>({value:h,label:h}))],small:!0}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"12px"},children:[c.jsx(Mr,{label:"Amount",type:"number",value:Dn.amount,onChange:h=>Zi({...Dn,amount:h.target.value}),small:!0}),c.jsx(rh,{label:"Type",value:Dn.type,onChange:h=>Zi({...Dn,type:h.target.value}),options:[{value:"Dr",label:"Debit"},{value:"Cr",label:"Credit"}],small:!0})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[c.jsx(Ke,{label:"Cancel",onClick:()=>Tr(!1)}),c.jsx(Ke,{label:"Save",variant:"brand",onClick:()=>{Dn.partyName&&Dn.amount&&(yc(h=>({...h,[Dn.partyName]:Dn.type==="Dr"?parseFloat(Dn.amount):-parseFloat(Dn.amount)})),Tr(!1),Zi({partyName:"",amount:"",type:"Dr"}))}})]})]}),c.jsxs(Bn,{isOpen:dg,onClose:()=>Ec(!1),title:" Import Historical Ledger",width:"600px",children:[c.jsx("input",{type:"file",ref:qu,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:h4}),c.jsxs("div",{style:{padding:"16px",backgroundColor:"#EFF6FF",borderRadius:"10px",marginBottom:"16px",border:"1px solid #BFDBFE"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#1E40AF",marginBottom:"8px",fontSize:"14px"},children:" How to Import Historical Ledger"}),c.jsxs("div",{style:{fontSize:"12px",color:"#1E3A8A",lineHeight:"1.6"},children:[c.jsx("p",{style:{margin:"0 0 8px 0"},children:"Upload your existing ledger data in the format shown in the template. This will import all historical transactions."}),c.jsxs("p",{style:{margin:0},children:[c.jsx("strong",{children:"Supported columns:"})," Date, Particular, Vch Type, Vch No., Debit, Credit, Date of Receipt, Amount Received, TDS Received, Balance, Payment Status"]})]})]}),Y&&c.jsxs("div",{style:{padding:"12px",backgroundColor:"#DCFCE7",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[c.jsxs("div",{style:{fontSize:"13px",color:"#166534"},children:[c.jsx("strong",{children:" Selected Party:"})," ",Y]}),c.jsx("div",{style:{fontSize:"11px",color:"#15803D",marginTop:"4px"},children:"All entries from the uploaded file will be imported for this party"})]}),!Y&&c.jsxs("div",{style:{padding:"12px",backgroundColor:"#FEE2E2",borderRadius:"8px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[c.jsx("div",{style:{fontSize:"13px",color:"#991B1B"},children:c.jsx("strong",{children:" No Party Selected"})}),c.jsx("div",{style:{fontSize:"12px",color:"#B91C1C",marginTop:"4px"},children:'Please close this modal and select a party from the Parties list on the left, then click "Import Historical" again.'})]}),c.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginBottom:"16px"},children:[c.jsx(Ke,{icon:Do,label:"Download Template",variant:"brand",onClick:p4}),Y?c.jsx(Ke,{icon:Ks,label:"Upload Ledger",variant:"success",onClick:()=>{var h;return(h=qu.current)==null?void 0:h.click()}}):c.jsxs("button",{disabled:!0,style:{padding:"8px 16px",fontSize:"13px",fontWeight:"600",border:"none",borderRadius:"8px",backgroundColor:"#E2E8F0",color:"#94A3B8",cursor:"not-allowed",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(Ks,{size:16})," Upload Ledger"]})]}),c.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",border:"1px solid #E2E8F0"},children:[c.jsx("div",{style:{fontWeight:"600",color:"#475569",marginBottom:"8px",fontSize:"13px"},children:" Expected Format (matches your ledger export):"}),c.jsx("div",{style:{overflowX:"auto"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#E2E8F0"},children:[c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Date"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Particular"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Vch Type"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Vch No."}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Debit"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Credit"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Amt Recd"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Status"})]})}),c.jsx("tbody",{children:c.jsxs("tr",{children:[c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"02-Jun-21"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"DB Corp Ltd"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"Sales"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"MB/2020-21/0411"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0",textAlign:"right"},children:"6,000"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0",textAlign:"right"},children:"44,371"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"Received"})]})})]})})]}),c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:c.jsx(Ke,{label:"Close",onClick:()=>Ec(!1)})})]}),c.jsx(Bn,{isOpen:$u,onClose:()=>{ms(!1),Ji({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"})},title:" Create Receipt",width:"550px",children:le&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",le.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",le.partyName]}),c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Invoice Amount:"})," ",nt(le.invoiceTotalAmount)]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[c.jsx(Mr,{label:"Receipt Date",type:"date",value:Xt.date,onChange:h=>Ji({...Xt,date:h.target.value}),small:!0}),c.jsx(rh,{label:"Payment Mode",value:Xt.mode,onChange:h=>Ji({...Xt,mode:h.target.value}),options:[{value:"Bank",label:"Bank Transfer"},{value:"Cash",label:"Cash"},{value:"Cheque",label:"Cheque"},{value:"UPI",label:"UPI"}],small:!0})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"12px",marginBottom:"12px"},children:[c.jsx(Mr,{label:"Amount Received",type:"number",value:Xt.amount,onChange:h=>Ji({...Xt,amount:h.target.value}),placeholder:"0.00",small:!0}),c.jsx(Mr,{label:"TDS Deducted",type:"number",value:Xt.tds,onChange:h=>Ji({...Xt,tds:h.target.value}),placeholder:"0.00",small:!0}),c.jsx(Mr,{label:"Discount",type:"number",value:Xt.discount,onChange:h=>Ji({...Xt,discount:h.target.value}),placeholder:"0.00",small:!0})]}),c.jsx("div",{style:{backgroundColor:"#F0FDF4",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:c.jsxs("div",{style:{fontSize:"14px",fontWeight:"700",color:"#166534"},children:["Total Credit: ",nt((parseFloat(Xt.amount)||0)+(parseFloat(Xt.tds)||0)+(parseFloat(Xt.discount)||0))]})}),c.jsx(Mr,{label:"Narration",value:Xt.narration,onChange:h=>Ji({...Xt,narration:h.target.value}),placeholder:"Payment reference, remarks...",small:!0}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Payment Advisory (Optional)"}),c.jsx("input",{type:"file",ref:c0,accept:"image/*,.pdf",onChange:ZF,style:{display:"none"}}),Xt.paymentAdvisory?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[c.jsx("div",{style:{flex:1,padding:"10px",backgroundColor:"#F0FDF4",borderRadius:"8px",fontSize:"13px",color:"#166534"},children:" Payment advisory attached"}),c.jsx("button",{onClick:()=>Ji(h=>({...h,paymentAdvisory:null})),style:{padding:"8px",border:"none",backgroundColor:"#FEE2E2",borderRadius:"6px",cursor:"pointer",color:"#991B1B"},children:c.jsx(Sa,{size:16})})]}):c.jsxs("button",{onClick:()=>{var h;return(h=c0.current)==null?void 0:h.click()},style:{padding:"10px 16px",border:"1.5px dashed #D1D5DB",borderRadius:"8px",backgroundColor:"#F9FAFB",cursor:"pointer",fontSize:"13px",color:"#6B7280",display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(Ks,{size:16})," Attach Payment Advisory"]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(Ke,{label:"Cancel",onClick:()=>ms(!1)}),c.jsx(Ke,{label:"Create Receipt",variant:"success",icon:Po,onClick:Cc})]})]})}),c.jsx(Bn,{isOpen:Tl,onClose:()=>{aa(!1),da({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]})},title:" Create Credit Note",width:"500px",children:le&&(()=>{var se;const h=(se=le.statePartyDetails)==null?void 0:se.toUpperCase().includes("MAHARASHTRA"),_=h?"CGST + SGST (9% + 9%)":"IGST (18%)",U=parseFloat(fn.amount)||0,q=parseFloat(fn.gst)||0,L=U+q;return c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",le.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",le.partyName]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice Amount:"})," ",nt(le.invoiceTotalAmount)]}),c.jsxs("div",{style:{fontSize:"12px",color:"#2563EB"},children:[c.jsx("strong",{children:"GST Type:"})," ",h?"CGST + SGST (Intra-state)":"IGST (Inter-state)"]})]}),c.jsx("div",{style:{marginBottom:"12px"},children:c.jsx(Mr,{label:"Credit Note Date",type:"date",value:fn.date,onChange:N=>da({...fn,date:N.target.value}),small:!0})}),c.jsxs("div",{style:{backgroundColor:"#FEF2F2",padding:"14px",borderRadius:"10px",marginBottom:"12px",border:"1px solid #FECACA"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#991B1B",marginBottom:"10px",fontSize:"13px"},children:" Credit Note Breakdown"}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsx(Mr,{label:"Base Amount",type:"number",value:fn.amount,onChange:N=>da({...fn,amount:N.target.value}),placeholder:"0.00",small:!0}),c.jsx(Mr,{label:_,type:"number",value:fn.gst,onChange:N=>da({...fn,gst:N.target.value}),placeholder:"0.00",small:!0})]}),c.jsxs("div",{style:{marginTop:"10px",padding:"8px",backgroundColor:"#FEE2E2",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsx("span",{style:{fontSize:"13px",fontWeight:"600",color:"#991B1B"},children:"Total Credit:"}),c.jsx("span",{style:{fontSize:"15px",fontWeight:"700",color:"#991B1B"},children:nt(L)})]})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Reason for Credit Note *"}),c.jsx("textarea",{value:fn.reason,onChange:N=>da({...fn,reason:N.target.value}),placeholder:"Enter reason for issuing credit note...",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(Ke,{label:"Cancel",onClick:()=>aa(!1)}),c.jsx(Ke,{label:"Create Credit Note",variant:"danger",icon:fd,onClick:JF})]})]})})()}),c.jsx(Bn,{isOpen:La,onClose:()=>{Qi(!1),ca(null)},title:" Add Followup",width:"500px",children:ar&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",ar.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",ar.partyName]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Amount:"})," ",nt(ar.invoiceTotalAmount||ar.totalAmount)]}),c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Invoice Date:"})," ",_t(ar.invoiceDate||ar.date)]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[c.jsx(Mr,{label:"Followup Date",type:"date",value:Sr.date,onChange:h=>Ua({...Sr,date:h.target.value}),small:!0}),c.jsx(Mr,{label:"Next Followup Date",type:"date",value:Sr.nextFollowupDate,onChange:h=>Ua({...Sr,nextFollowupDate:h.target.value}),small:!0})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Followup Notes *"}),c.jsx("textarea",{value:Sr.notes,onChange:h=>Ua({...Sr,notes:h.target.value}),placeholder:"Enter followup notes (e.g., Spoke with accounts team, payment promised by next week)",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Status"}),c.jsxs("select",{value:Sr.status,onChange:h=>Ua({...Sr,status:h.target.value}),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px"},children:[c.jsx("option",{value:"Pending",children:"Pending"}),c.jsx("option",{value:"Promised",children:"Promised - Payment Expected"}),c.jsx("option",{value:"Disputed",children:"Disputed"}),c.jsx("option",{value:"No Response",children:"No Response"})]})]}),c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#166534",marginBottom:"8px"},children:" Quick Actions"}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsx(Ke,{icon:nm,label:"Copy Email Template",small:!0,variant:"brand",onClick:()=>my(ar)}),c.jsx(Ke,{icon:K0,label:"Search in Gmail",small:!0,variant:"success",onClick:()=>xy(ar)})]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(Ke,{label:"Cancel",onClick:()=>Qi(!1)}),c.jsx(Ke,{label:"Save Followup",variant:"primary",icon:pd,onClick:a4})]})]})}),c.jsx(Bn,{isOpen:Ma,onClose:()=>Us(!1),title:" Clear All Data",width:"500px",children:c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"20px",borderRadius:"12px",marginBottom:"20px",border:"2px solid #FCA5A5"},children:[c.jsxs("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"18px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(X_,{size:24})," Warning: This action cannot be undone!"]}),c.jsxs("div",{style:{fontSize:"14px",color:"#7F1D1D",lineHeight:"1.6"},children:["This will permanently delete:",c.jsxs("ul",{style:{margin:"12px 0 0 20px",padding:0},children:[c.jsxs("li",{children:[c.jsx("strong",{children:Ee.length})," campaigns from Master Sheet"]}),c.jsxs("li",{children:[c.jsx("strong",{children:Ee.filter(h=>h.invoiceGenerated).length})," generated invoices"]}),c.jsxs("li",{children:[c.jsx("strong",{children:je.length})," receipts"]}),c.jsxs("li",{children:[c.jsx("strong",{children:te.length})," credit notes"]}),c.jsxs("li",{children:[c.jsx("strong",{children:ne.length})," ledger entries"]}),c.jsxs("li",{children:[c.jsx("strong",{children:Object.keys(Ct).length})," mailer images"]}),c.jsx("li",{children:"All opening balances"})]})]})]}),c.jsx("div",{style:{backgroundColor:"#FEF3C7",padding:"14px",borderRadius:"8px",marginBottom:"20px",border:"1px solid #FCD34D"},children:c.jsxs("div",{style:{fontSize:"13px",color:"#92400E"},children:[c.jsx("strong",{children:"Note:"})," Invoice series numbers will be reset to 1. Your company settings and mailer logo will be preserved."]})}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[c.jsx(Ke,{label:"Cancel",onClick:()=>Us(!1)}),c.jsx(Ke,{label:"Yes, Clear All Data",variant:"danger",icon:ns,onClick:y4})]})]})}),c.jsx(Bn,{isOpen:ur,onClose:()=>nr(!1),title:" Notifications",width:"550px",children:c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B"},children:Ss>0?`${Ss} unread`:"No unread notifications"}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[Ss>0&&c.jsx("button",{onClick:Va,style:{padding:"6px 12px",fontSize:"12px",fontWeight:"600",border:"1px solid #E2E8F0",borderRadius:"6px",backgroundColor:"#F8FAFC",color:"#475569",cursor:"pointer"},children:"Mark all as read"}),He.length>0&&_r&&c.jsx("button",{onClick:f0,style:{padding:"6px 12px",fontSize:"12px",fontWeight:"600",border:"1px solid #FCA5A5",borderRadius:"6px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer"},children:"Clear all"})]})]}),c.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:Fl.length===0?c.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:[c.jsx(Q_,{size:40,style:{marginBottom:"12px",opacity:.5}}),c.jsx("div",{style:{fontSize:"16px",fontWeight:"600"},children:"No notifications"}),c.jsx("div",{style:{fontSize:"13px",marginTop:"4px"},children:"You're all caught up!"})]}):Fl.map(h=>{const _=!(h.read&&h.read[r]),U=L=>{switch(L){case"upload":return"";case"invoice":return"";case"approval":return"";case"edit":return"";case"receipt":return"";default:return""}},q=L=>{switch(L){case"upload":return"#EFF6FF";case"invoice":return"#FEF3C7";case"approval":return"#DCFCE7";case"edit":return"#FEE2E2";case"receipt":return"#F0FDF4";default:return"#F8FAFC"}};return c.jsx("div",{onClick:()=>d0(h.id),style:{padding:"14px",borderRadius:"10px",marginBottom:"8px",backgroundColor:_?q(h.type):"#F8FAFC",border:_?"2px solid #2874A6":"1px solid #E2E8F0",cursor:"pointer",transition:"all 0.2s ease"},children:c.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[c.jsx("div",{style:{fontSize:"20px"},children:U(h.type)}),c.jsxs("div",{style:{flex:1},children:[c.jsx("div",{style:{fontSize:"14px",fontWeight:_?"600":"500",color:"#1E293B",lineHeight:"1.4"},children:h.message}),c.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"8px",fontSize:"11px",color:"#64748B"},children:[c.jsxs("span",{children:["By: ",h.createdBy==="finance"?"Finance Team":"Director"]}),c.jsx("span",{children:""}),c.jsx("span",{children:new Date(h.createdAt).toLocaleString()})]})]}),_&&c.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#DC2626",flexShrink:0}})]})},h.id)})})]})})]}),rb=()=>{switch(P){case"master":return Cy();case"services":return L4();case"invoices":return $4();case"receipts":return q4();case"ledgers":return Q4();case"followups":return Z4();case"reports":return by();case"settings":return r==="finance"?eb():by();default:return Cy()}},nb=()=>c.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 50%, #1E3A5F 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',padding:"20px"},children:c.jsxs("div",{style:{backgroundColor:"#FFFFFF",padding:"0",borderRadius:"24px",boxShadow:"0 25px 50px -12px rgba(0,0,0,0.25)",width:"420px",maxWidth:"95vw",overflow:"hidden"},children:[c.jsxs("div",{style:{background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 100%)",padding:"32px 40px",textAlign:"center"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:"8px"},children:[c.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"60px",height:"auto",borderRadius:"8px",backgroundColor:"white",padding:"4px"}}),c.jsx("span",{style:{fontSize:"36px",fontWeight:"800",color:"#FFFFFF",letterSpacing:"-1px"},children:"FinMate"})]}),c.jsx("p",{style:{margin:0,color:"rgba(255,255,255,0.8)",fontSize:"14px",fontWeight:"500"},children:"Finance Management System"})]}),c.jsxs("div",{style:{padding:"32px 40px"},children:[c.jsxs("div",{style:{marginBottom:"24px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#1E3A5F",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Username"}),c.jsxs("div",{style:{position:"relative"},children:[c.jsx(aE,{size:18,style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",value:i.username,onChange:h=>s(_=>({..._,username:h.target.value})),placeholder:"Enter username",style:{width:"100%",padding:"14px 14px 14px 44px",borderRadius:"12px",border:"2px solid #E2E8F0",fontSize:"15px",boxSizing:"border-box",transition:"border-color 0.2s, box-shadow 0.2s",outline:"none"},onFocus:h=>{h.target.style.borderColor="#2874A6",h.target.style.boxShadow="0 0 0 3px rgba(40,116,166,0.1)"},onBlur:h=>{h.target.style.borderColor="#E2E8F0",h.target.style.boxShadow="none"}})]})]}),c.jsxs("div",{style:{marginBottom:"28px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#1E3A5F",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Password"}),c.jsxs("div",{style:{position:"relative"},children:[c.jsx(G0,{size:18,style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"password",value:i.password,onChange:h=>s(_=>({..._,password:h.target.value})),placeholder:"Enter password",onKeyPress:h=>h.key==="Enter"&&Zu(),style:{width:"100%",padding:"14px 14px 14px 44px",borderRadius:"12px",border:"2px solid #E2E8F0",fontSize:"15px",boxSizing:"border-box",transition:"border-color 0.2s, box-shadow 0.2s",outline:"none"},onFocus:h=>{h.target.style.borderColor="#2874A6",h.target.style.boxShadow="0 0 0 3px rgba(40,116,166,0.1)"},onBlur:h=>{h.target.style.borderColor="#E2E8F0",h.target.style.boxShadow="none"}})]})]}),a&&c.jsxs("div",{style:{marginBottom:"20px",padding:"14px",backgroundColor:"#FEF2F2",borderRadius:"12px",color:"#DC2626",fontSize:"14px",textAlign:"center",border:"1px solid #FECACA",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[c.jsx(X_,{size:18}),a]}),c.jsx("button",{onClick:Zu,style:{width:"100%",padding:"16px",fontSize:"16px",fontWeight:"700",border:"none",borderRadius:"12px",cursor:S?"pointer":"wait",background:S?"linear-gradient(135deg, #1E3A5F 0%, #2874A6 100%)":"#94A3B8",color:"white",transition:"transform 0.2s, box-shadow 0.2s",boxShadow:S?"0 4px 14px rgba(40,116,166,0.4)":"none",opacity:S?1:.7},disabled:!S,onMouseOver:h=>{S&&(h.target.style.transform="translateY(-2px)",h.target.style.boxShadow="0 6px 20px rgba(40,116,166,0.5)")},onMouseOut:h=>{S&&(h.target.style.transform="translateY(0)",h.target.style.boxShadow="0 4px 14px rgba(40,116,166,0.4)")},children:S?"Sign In":"Loading..."}),c.jsxs("div",{style:{marginTop:"24px",textAlign:"center",color:"#94A3B8",fontSize:"12px"},children:[c.jsx("span",{children:"Powered by "}),c.jsx("span",{style:{fontWeight:"600",color:"#1E3A5F"},children:"JAC"}),c.jsx("span",{children:"  Strategy | Talent | Results"})]})]})]})});return t?l?c.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 50%, #1E3A5F 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[c.jsxs("div",{style:{textAlign:"center"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:"24px"},children:[c.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"50px",height:"auto",borderRadius:"8px",backgroundColor:"white",padding:"4px"}}),c.jsx("span",{style:{fontSize:"32px",fontWeight:"800",color:"#FFFFFF",letterSpacing:"-1px"},children:"FinMate"})]}),c.jsx(rE,{size:48,style:{animation:"spin 1s linear infinite",color:"#FFFFFF",marginBottom:"16px"}}),c.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:"#FFFFFF"},children:"Loading your data..."}),c.jsx("div",{style:{fontSize:"14px",color:"rgba(255,255,255,0.7)",marginTop:"8px"},children:"Please wait while we sync with the cloud"})]}),c.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]}):c.jsxs("div",{style:{display:"flex",height:"100vh",backgroundColor:"#F1F5F9",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[D4(),c.jsx("main",{style:{flex:1,overflow:"auto",padding:"20px"},children:rb()}),tb(),c.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]}):nb()}vm.createRoot(document.getElementById("root")).render(c.jsx(sh.StrictMode,{children:c.jsx(RH,{})}));
