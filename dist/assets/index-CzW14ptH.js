(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function sF(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ZE={exports:{}},cp={},ew={exports:{}},Tt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h0=Symbol.for("react.element"),aF=Symbol.for("react.portal"),oF=Symbol.for("react.fragment"),lF=Symbol.for("react.strict_mode"),cF=Symbol.for("react.profiler"),uF=Symbol.for("react.provider"),fF=Symbol.for("react.context"),dF=Symbol.for("react.forward_ref"),hF=Symbol.for("react.suspense"),pF=Symbol.for("react.memo"),mF=Symbol.for("react.lazy"),hy=Symbol.iterator;function gF(t){return t===null||typeof t!="object"?null:(t=hy&&t[hy]||t["@@iterator"],typeof t=="function"?t:null)}var tw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},rw=Object.assign,nw={};function cu(t,e,r){this.props=t,this.context=e,this.refs=nw,this.updater=r||tw}cu.prototype.isReactComponent={};cu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};cu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function iw(){}iw.prototype=cu.prototype;function Ix(t,e,r){this.props=t,this.context=e,this.refs=nw,this.updater=r||tw}var bx=Ix.prototype=new iw;bx.constructor=Ix;rw(bx,cu.prototype);bx.isPureReactComponent=!0;var py=Array.isArray,sw=Object.prototype.hasOwnProperty,Rx={current:null},aw={key:!0,ref:!0,__self:!0,__source:!0};function ow(t,e,r){var n,i={},s=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)sw.call(e,n)&&!aw.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:h0,type:t,key:s,ref:a,props:i,_owner:Rx.current}}function xF(t,e){return{$$typeof:h0,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Nx(t){return typeof t=="object"&&t!==null&&t.$$typeof===h0}function vF(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var my=/\/+/g;function Qp(t,e){return typeof t=="object"&&t!==null&&t.key!=null?vF(""+t.key):e.toString(36)}function Ud(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case h0:case aF:a=!0}}if(a)return a=t,i=i(a),t=n===""?"."+Qp(a,0):n,py(i)?(r="",t!=null&&(r=t.replace(my,"$&/")+"/"),Ud(i,e,r,"",function(c){return c})):i!=null&&(Nx(i)&&(i=xF(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(my,"$&/")+"/")+t)),e.push(i)),1;if(a=0,n=n===""?".":n+":",py(t))for(var o=0;o<t.length;o++){s=t[o];var l=n+Qp(s,o);a+=Ud(s,e,r,l,i)}else if(l=gF(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=n+Qp(s,o++),a+=Ud(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function nd(t,e,r){if(t==null)return t;var n=[],i=0;return Ud(t,n,"","",function(s){return e.call(r,s,i++)}),n}function yF(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var fi={current:null},zd={transition:null},_F={ReactCurrentDispatcher:fi,ReactCurrentBatchConfig:zd,ReactCurrentOwner:Rx};function lw(){throw Error("act(...) is not supported in production builds of React.")}Tt.Children={map:nd,forEach:function(t,e,r){nd(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return nd(t,function(){e++}),e},toArray:function(t){return nd(t,function(e){return e})||[]},only:function(t){if(!Nx(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Tt.Component=cu;Tt.Fragment=oF;Tt.Profiler=cF;Tt.PureComponent=Ix;Tt.StrictMode=lF;Tt.Suspense=hF;Tt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_F;Tt.act=lw;Tt.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=rw({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=Rx.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)sw.call(e,l)&&!aw.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:h0,type:t.type,key:i,ref:s,props:n,_owner:a}};Tt.createContext=function(t){return t={$$typeof:fF,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:uF,_context:t},t.Consumer=t};Tt.createElement=ow;Tt.createFactory=function(t){var e=ow.bind(null,t);return e.type=t,e};Tt.createRef=function(){return{current:null}};Tt.forwardRef=function(t){return{$$typeof:dF,render:t}};Tt.isValidElement=Nx;Tt.lazy=function(t){return{$$typeof:mF,_payload:{_status:-1,_result:t},_init:yF}};Tt.memo=function(t,e){return{$$typeof:pF,type:t,compare:e===void 0?null:e}};Tt.startTransition=function(t){var e=zd.transition;zd.transition={};try{t()}finally{zd.transition=e}};Tt.unstable_act=lw;Tt.useCallback=function(t,e){return fi.current.useCallback(t,e)};Tt.useContext=function(t){return fi.current.useContext(t)};Tt.useDebugValue=function(){};Tt.useDeferredValue=function(t){return fi.current.useDeferredValue(t)};Tt.useEffect=function(t,e){return fi.current.useEffect(t,e)};Tt.useId=function(){return fi.current.useId()};Tt.useImperativeHandle=function(t,e,r){return fi.current.useImperativeHandle(t,e,r)};Tt.useInsertionEffect=function(t,e){return fi.current.useInsertionEffect(t,e)};Tt.useLayoutEffect=function(t,e){return fi.current.useLayoutEffect(t,e)};Tt.useMemo=function(t,e){return fi.current.useMemo(t,e)};Tt.useReducer=function(t,e,r){return fi.current.useReducer(t,e,r)};Tt.useRef=function(t){return fi.current.useRef(t)};Tt.useState=function(t){return fi.current.useState(t)};Tt.useSyncExternalStore=function(t,e,r){return fi.current.useSyncExternalStore(t,e,r)};Tt.useTransition=function(){return fi.current.useTransition()};Tt.version="18.3.1";ew.exports=Tt;var ve=ew.exports;const Wd=sF(ve);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var EF=ve,wF=Symbol.for("react.element"),TF=Symbol.for("react.fragment"),SF=Object.prototype.hasOwnProperty,AF=EF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,kF={key:!0,ref:!0,__self:!0,__source:!0};function cw(t,e,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)SF.call(e,n)&&!kF.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:wF,type:t,key:s,ref:a,props:i,_owner:AF.current}}cp.Fragment=TF;cp.jsx=cw;cp.jsxs=cw;ZE.exports=cp;var f=ZE.exports,rg={},uw={exports:{}},Wi={},fw={exports:{}},dw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ye,Q){var Ce=ye.length;ye.push(Q);e:for(;0<Ce;){var Be=Ce-1>>>1,V=ye[Be];if(0<i(V,Q))ye[Be]=Q,ye[Ce]=V,Ce=Be;else break e}}function r(ye){return ye.length===0?null:ye[0]}function n(ye){if(ye.length===0)return null;var Q=ye[0],Ce=ye.pop();if(Ce!==Q){ye[0]=Ce;e:for(var Be=0,V=ye.length,G=V>>>1;Be<G;){var q=2*(Be+1)-1,Y=ye[q],de=q+1,Ae=ye[de];if(0>i(Y,Ce))de<V&&0>i(Ae,Y)?(ye[Be]=Ae,ye[de]=Ce,Be=de):(ye[Be]=Y,ye[q]=Ce,Be=q);else if(de<V&&0>i(Ae,Ce))ye[Be]=Ae,ye[de]=Ce,Be=de;else break e}}return Q}function i(ye,Q){var Ce=ye.sortIndex-Q.sortIndex;return Ce!==0?Ce:ye.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],c=[],d=1,h=null,p=3,g=!1,y=!1,x=!1,E=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(ye){for(var Q=r(c);Q!==null;){if(Q.callback===null)n(c);else if(Q.startTime<=ye)n(c),Q.sortIndex=Q.expirationTime,e(l,Q);else break;Q=r(c)}}function O(ye){if(x=!1,_(ye),!y)if(r(l)!==null)y=!0,be(H);else{var Q=r(c);Q!==null&&Se(O,Q.startTime-ye)}}function H(ye,Q){y=!1,x&&(x=!1,T(F),F=-1),g=!0;var Ce=p;try{for(_(Q),h=r(l);h!==null&&(!(h.expirationTime>Q)||ye&&!D());){var Be=h.callback;if(typeof Be=="function"){h.callback=null,p=h.priorityLevel;var V=Be(h.expirationTime<=Q);Q=t.unstable_now(),typeof V=="function"?h.callback=V:h===r(l)&&n(l),_(Q)}else n(l);h=r(l)}if(h!==null)var G=!0;else{var q=r(c);q!==null&&Se(O,q.startTime-Q),G=!1}return G}finally{h=null,p=Ce,g=!1}}var j=!1,w=null,F=-1,S=5,b=-1;function D(){return!(t.unstable_now()-b<S)}function P(){if(w!==null){var ye=t.unstable_now();b=ye;var Q=!0;try{Q=w(!0,ye)}finally{Q?N():(j=!1,w=null)}}else j=!1}var N;if(typeof A=="function")N=function(){A(P)};else if(typeof MessageChannel<"u"){var ze=new MessageChannel,ge=ze.port2;ze.port1.onmessage=P,N=function(){ge.postMessage(null)}}else N=function(){E(P,0)};function be(ye){w=ye,j||(j=!0,N())}function Se(ye,Q){F=E(function(){ye(t.unstable_now())},Q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ye){ye.callback=null},t.unstable_continueExecution=function(){y||g||(y=!0,be(H))},t.unstable_forceFrameRate=function(ye){0>ye||125<ye?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<ye?Math.floor(1e3/ye):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(ye){switch(p){case 1:case 2:case 3:var Q=3;break;default:Q=p}var Ce=p;p=Q;try{return ye()}finally{p=Ce}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ye,Q){switch(ye){case 1:case 2:case 3:case 4:case 5:break;default:ye=3}var Ce=p;p=ye;try{return Q()}finally{p=Ce}},t.unstable_scheduleCallback=function(ye,Q,Ce){var Be=t.unstable_now();switch(typeof Ce=="object"&&Ce!==null?(Ce=Ce.delay,Ce=typeof Ce=="number"&&0<Ce?Be+Ce:Be):Ce=Be,ye){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=Ce+V,ye={id:d++,callback:Q,priorityLevel:ye,startTime:Ce,expirationTime:V,sortIndex:-1},Ce>Be?(ye.sortIndex=Ce,e(c,ye),r(l)===null&&ye===r(c)&&(x?(T(F),F=-1):x=!0,Se(O,Ce-Be))):(ye.sortIndex=V,e(l,ye),y||g||(y=!0,be(H))),ye},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(ye){var Q=p;return function(){var Ce=p;p=Q;try{return ye.apply(this,arguments)}finally{p=Ce}}}})(dw);fw.exports=dw;var CF=fw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FF=ve,Ui=CF;function Oe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var hw=new Set,kf={};function Ol(t,e){Hc(t,e),Hc(t+"Capture",e)}function Hc(t,e){for(kf[t]=e,t=0;t<e.length;t++)hw.add(e[t])}var ba=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ng=Object.prototype.hasOwnProperty,IF=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,gy={},xy={};function bF(t){return ng.call(xy,t)?!0:ng.call(gy,t)?!1:IF.test(t)?xy[t]=!0:(gy[t]=!0,!1)}function RF(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function NF(t,e,r,n){if(e===null||typeof e>"u"||RF(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function di(t,e,r,n,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var Rn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Rn[t]=new di(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Rn[e]=new di(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Rn[t]=new di(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Rn[t]=new di(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Rn[t]=new di(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Rn[t]=new di(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Rn[t]=new di(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Rn[t]=new di(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Rn[t]=new di(t,5,!1,t.toLowerCase(),null,!1,!1)});var Dx=/[\-:]([a-z])/g;function Px(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Dx,Px);Rn[e]=new di(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Dx,Px);Rn[e]=new di(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Dx,Px);Rn[e]=new di(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Rn[t]=new di(t,1,!1,t.toLowerCase(),null,!1,!1)});Rn.xlinkHref=new di("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Rn[t]=new di(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ox(t,e,r,n){var i=Rn.hasOwnProperty(e)?Rn[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(NF(e,r,i,n)&&(r=null),n||i===null?bF(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var Va=FF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,id=Symbol.for("react.element"),mc=Symbol.for("react.portal"),gc=Symbol.for("react.fragment"),Mx=Symbol.for("react.strict_mode"),ig=Symbol.for("react.profiler"),pw=Symbol.for("react.provider"),mw=Symbol.for("react.context"),Lx=Symbol.for("react.forward_ref"),sg=Symbol.for("react.suspense"),ag=Symbol.for("react.suspense_list"),Bx=Symbol.for("react.memo"),ao=Symbol.for("react.lazy"),gw=Symbol.for("react.offscreen"),vy=Symbol.iterator;function Du(t){return t===null||typeof t!="object"?null:(t=vy&&t[vy]||t["@@iterator"],typeof t=="function"?t:null)}var kr=Object.assign,Jp;function Gu(t){if(Jp===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Jp=e&&e[1]||""}return`
`+Jp+t}var Zp=!1;function em(t,e){if(!t||Zp)return"";Zp=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{Zp=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Gu(t):""}function DF(t){switch(t.tag){case 5:return Gu(t.type);case 16:return Gu("Lazy");case 13:return Gu("Suspense");case 19:return Gu("SuspenseList");case 0:case 2:case 15:return t=em(t.type,!1),t;case 11:return t=em(t.type.render,!1),t;case 1:return t=em(t.type,!0),t;default:return""}}function og(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case gc:return"Fragment";case mc:return"Portal";case ig:return"Profiler";case Mx:return"StrictMode";case sg:return"Suspense";case ag:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case mw:return(t.displayName||"Context")+".Consumer";case pw:return(t._context.displayName||"Context")+".Provider";case Lx:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Bx:return e=t.displayName||null,e!==null?e:og(t.type)||"Memo";case ao:e=t._payload,t=t._init;try{return og(t(e))}catch{}}return null}function PF(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return og(e);case 8:return e===Mx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Po(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function xw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function OF(t){var e=xw(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function sd(t){t._valueTracker||(t._valueTracker=OF(t))}function vw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=xw(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function ch(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function lg(t,e){var r=e.checked;return kr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function yy(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Po(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function yw(t,e){e=e.checked,e!=null&&Ox(t,"checked",e,!1)}function cg(t,e){yw(t,e);var r=Po(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?ug(t,e.type,r):e.hasOwnProperty("defaultValue")&&ug(t,e.type,Po(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function _y(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function ug(t,e,r){(e!=="number"||ch(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Ku=Array.isArray;function bc(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Po(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function fg(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Oe(91));return kr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ey(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Oe(92));if(Ku(r)){if(1<r.length)throw Error(Oe(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Po(r)}}function _w(t,e){var r=Po(e.value),n=Po(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function wy(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Ew(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function dg(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Ew(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ad,ww=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ad=ad||document.createElement("div"),ad.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ad.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Cf(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var nf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},MF=["Webkit","ms","Moz","O"];Object.keys(nf).forEach(function(t){MF.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),nf[e]=nf[t]})});function Tw(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||nf.hasOwnProperty(t)&&nf[t]?(""+e).trim():e+"px"}function Sw(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Tw(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var LF=kr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function hg(t,e){if(e){if(LF[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Oe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Oe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Oe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Oe(62))}}function pg(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mg=null;function jx(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var gg=null,Rc=null,Nc=null;function Ty(t){if(t=g0(t)){if(typeof gg!="function")throw Error(Oe(280));var e=t.stateNode;e&&(e=pp(e),gg(t.stateNode,t.type,e))}}function Aw(t){Rc?Nc?Nc.push(t):Nc=[t]:Rc=t}function kw(){if(Rc){var t=Rc,e=Nc;if(Nc=Rc=null,Ty(t),e)for(t=0;t<e.length;t++)Ty(e[t])}}function Cw(t,e){return t(e)}function Fw(){}var tm=!1;function Iw(t,e,r){if(tm)return t(e,r);tm=!0;try{return Cw(t,e,r)}finally{tm=!1,(Rc!==null||Nc!==null)&&(Fw(),kw())}}function Ff(t,e){var r=t.stateNode;if(r===null)return null;var n=pp(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Oe(231,e,typeof r));return r}var xg=!1;if(ba)try{var Pu={};Object.defineProperty(Pu,"passive",{get:function(){xg=!0}}),window.addEventListener("test",Pu,Pu),window.removeEventListener("test",Pu,Pu)}catch{xg=!1}function BF(t,e,r,n,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(d){this.onError(d)}}var sf=!1,uh=null,fh=!1,vg=null,jF={onError:function(t){sf=!0,uh=t}};function VF(t,e,r,n,i,s,a,o,l){sf=!1,uh=null,BF.apply(jF,arguments)}function UF(t,e,r,n,i,s,a,o,l){if(VF.apply(this,arguments),sf){if(sf){var c=uh;sf=!1,uh=null}else throw Error(Oe(198));fh||(fh=!0,vg=c)}}function Ml(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function bw(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Sy(t){if(Ml(t)!==t)throw Error(Oe(188))}function zF(t){var e=t.alternate;if(!e){if(e=Ml(t),e===null)throw Error(Oe(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Sy(i),t;if(s===n)return Sy(i),e;s=s.sibling}throw Error(Oe(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(Oe(189))}}if(r.alternate!==n)throw Error(Oe(190))}if(r.tag!==3)throw Error(Oe(188));return r.stateNode.current===r?t:e}function Rw(t){return t=zF(t),t!==null?Nw(t):null}function Nw(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Nw(t);if(e!==null)return e;t=t.sibling}return null}var Dw=Ui.unstable_scheduleCallback,Ay=Ui.unstable_cancelCallback,WF=Ui.unstable_shouldYield,HF=Ui.unstable_requestPaint,jr=Ui.unstable_now,$F=Ui.unstable_getCurrentPriorityLevel,Vx=Ui.unstable_ImmediatePriority,Pw=Ui.unstable_UserBlockingPriority,dh=Ui.unstable_NormalPriority,GF=Ui.unstable_LowPriority,Ow=Ui.unstable_IdlePriority,up=null,Qs=null;function KF(t){if(Qs&&typeof Qs.onCommitFiberRoot=="function")try{Qs.onCommitFiberRoot(up,t,void 0,(t.current.flags&128)===128)}catch{}}var Is=Math.clz32?Math.clz32:qF,XF=Math.log,YF=Math.LN2;function qF(t){return t>>>=0,t===0?32:31-(XF(t)/YF|0)|0}var od=64,ld=4194304;function Xu(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function hh(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=Xu(o):(s&=a,s!==0&&(n=Xu(s)))}else a=r&~i,a!==0?n=Xu(a):s!==0&&(n=Xu(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Is(e),i=1<<r,n|=t[r],e&=~i;return n}function QF(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function JF(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-Is(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=QF(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function yg(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Mw(){var t=od;return od<<=1,!(od&4194240)&&(od=64),t}function rm(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function p0(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Is(e),t[e]=r}function ZF(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-Is(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function Ux(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Is(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var Kt=0;function Lw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Bw,zx,jw,Vw,Uw,_g=!1,cd=[],Eo=null,wo=null,To=null,If=new Map,bf=new Map,lo=[],eI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ky(t,e){switch(t){case"focusin":case"focusout":Eo=null;break;case"dragenter":case"dragleave":wo=null;break;case"mouseover":case"mouseout":To=null;break;case"pointerover":case"pointerout":If.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":bf.delete(e.pointerId)}}function Ou(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=g0(e),e!==null&&zx(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function tI(t,e,r,n,i){switch(e){case"focusin":return Eo=Ou(Eo,t,e,r,n,i),!0;case"dragenter":return wo=Ou(wo,t,e,r,n,i),!0;case"mouseover":return To=Ou(To,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return If.set(s,Ou(If.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,bf.set(s,Ou(bf.get(s)||null,t,e,r,n,i)),!0}return!1}function zw(t){var e=al(t.target);if(e!==null){var r=Ml(e);if(r!==null){if(e=r.tag,e===13){if(e=bw(r),e!==null){t.blockedOn=e,Uw(t.priority,function(){jw(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Hd(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=Eg(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);mg=n,r.target.dispatchEvent(n),mg=null}else return e=g0(r),e!==null&&zx(e),t.blockedOn=r,!1;e.shift()}return!0}function Cy(t,e,r){Hd(t)&&r.delete(e)}function rI(){_g=!1,Eo!==null&&Hd(Eo)&&(Eo=null),wo!==null&&Hd(wo)&&(wo=null),To!==null&&Hd(To)&&(To=null),If.forEach(Cy),bf.forEach(Cy)}function Mu(t,e){t.blockedOn===e&&(t.blockedOn=null,_g||(_g=!0,Ui.unstable_scheduleCallback(Ui.unstable_NormalPriority,rI)))}function Rf(t){function e(i){return Mu(i,t)}if(0<cd.length){Mu(cd[0],t);for(var r=1;r<cd.length;r++){var n=cd[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Eo!==null&&Mu(Eo,t),wo!==null&&Mu(wo,t),To!==null&&Mu(To,t),If.forEach(e),bf.forEach(e),r=0;r<lo.length;r++)n=lo[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<lo.length&&(r=lo[0],r.blockedOn===null);)zw(r),r.blockedOn===null&&lo.shift()}var Dc=Va.ReactCurrentBatchConfig,ph=!0;function nI(t,e,r,n){var i=Kt,s=Dc.transition;Dc.transition=null;try{Kt=1,Wx(t,e,r,n)}finally{Kt=i,Dc.transition=s}}function iI(t,e,r,n){var i=Kt,s=Dc.transition;Dc.transition=null;try{Kt=4,Wx(t,e,r,n)}finally{Kt=i,Dc.transition=s}}function Wx(t,e,r,n){if(ph){var i=Eg(t,e,r,n);if(i===null)dm(t,e,n,mh,r),ky(t,n);else if(tI(i,t,e,r,n))n.stopPropagation();else if(ky(t,n),e&4&&-1<eI.indexOf(t)){for(;i!==null;){var s=g0(i);if(s!==null&&Bw(s),s=Eg(t,e,r,n),s===null&&dm(t,e,n,mh,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else dm(t,e,n,null,r)}}var mh=null;function Eg(t,e,r,n){if(mh=null,t=jx(n),t=al(t),t!==null)if(e=Ml(t),e===null)t=null;else if(r=e.tag,r===13){if(t=bw(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return mh=t,null}function Ww(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($F()){case Vx:return 1;case Pw:return 4;case dh:case GF:return 16;case Ow:return 536870912;default:return 16}default:return 16}}var mo=null,Hx=null,$d=null;function Hw(){if($d)return $d;var t,e=Hx,r=e.length,n,i="value"in mo?mo.value:mo.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===i[s-n];n++);return $d=i.slice(t,1<n?1-n:void 0)}function Gd(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ud(){return!0}function Fy(){return!1}function Hi(t){function e(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?ud:Fy,this.isPropagationStopped=Fy,this}return kr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=ud)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=ud)},persist:function(){},isPersistent:ud}),e}var uu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$x=Hi(uu),m0=kr({},uu,{view:0,detail:0}),sI=Hi(m0),nm,im,Lu,fp=kr({},m0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gx,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Lu&&(Lu&&t.type==="mousemove"?(nm=t.screenX-Lu.screenX,im=t.screenY-Lu.screenY):im=nm=0,Lu=t),nm)},movementY:function(t){return"movementY"in t?t.movementY:im}}),Iy=Hi(fp),aI=kr({},fp,{dataTransfer:0}),oI=Hi(aI),lI=kr({},m0,{relatedTarget:0}),sm=Hi(lI),cI=kr({},uu,{animationName:0,elapsedTime:0,pseudoElement:0}),uI=Hi(cI),fI=kr({},uu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),dI=Hi(fI),hI=kr({},uu,{data:0}),by=Hi(hI),pI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},mI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},gI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xI(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=gI[t])?!!e[t]:!1}function Gx(){return xI}var vI=kr({},m0,{key:function(t){if(t.key){var e=pI[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Gd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?mI[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gx,charCode:function(t){return t.type==="keypress"?Gd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Gd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),yI=Hi(vI),_I=kr({},fp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ry=Hi(_I),EI=kr({},m0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gx}),wI=Hi(EI),TI=kr({},uu,{propertyName:0,elapsedTime:0,pseudoElement:0}),SI=Hi(TI),AI=kr({},fp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),kI=Hi(AI),CI=[9,13,27,32],Kx=ba&&"CompositionEvent"in window,af=null;ba&&"documentMode"in document&&(af=document.documentMode);var FI=ba&&"TextEvent"in window&&!af,$w=ba&&(!Kx||af&&8<af&&11>=af),Ny=" ",Dy=!1;function Gw(t,e){switch(t){case"keyup":return CI.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Kw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var xc=!1;function II(t,e){switch(t){case"compositionend":return Kw(e);case"keypress":return e.which!==32?null:(Dy=!0,Ny);case"textInput":return t=e.data,t===Ny&&Dy?null:t;default:return null}}function bI(t,e){if(xc)return t==="compositionend"||!Kx&&Gw(t,e)?(t=Hw(),$d=Hx=mo=null,xc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return $w&&e.locale!=="ko"?null:e.data;default:return null}}var RI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Py(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!RI[t.type]:e==="textarea"}function Xw(t,e,r,n){Aw(n),e=gh(e,"onChange"),0<e.length&&(r=new $x("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var of=null,Nf=null;function NI(t){sT(t,0)}function dp(t){var e=_c(t);if(vw(e))return t}function DI(t,e){if(t==="change")return e}var Yw=!1;if(ba){var am;if(ba){var om="oninput"in document;if(!om){var Oy=document.createElement("div");Oy.setAttribute("oninput","return;"),om=typeof Oy.oninput=="function"}am=om}else am=!1;Yw=am&&(!document.documentMode||9<document.documentMode)}function My(){of&&(of.detachEvent("onpropertychange",qw),Nf=of=null)}function qw(t){if(t.propertyName==="value"&&dp(Nf)){var e=[];Xw(e,Nf,t,jx(t)),Iw(NI,e)}}function PI(t,e,r){t==="focusin"?(My(),of=e,Nf=r,of.attachEvent("onpropertychange",qw)):t==="focusout"&&My()}function OI(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return dp(Nf)}function MI(t,e){if(t==="click")return dp(e)}function LI(t,e){if(t==="input"||t==="change")return dp(e)}function BI(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ds=typeof Object.is=="function"?Object.is:BI;function Df(t,e){if(Ds(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!ng.call(e,i)||!Ds(t[i],e[i]))return!1}return!0}function Ly(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function By(t,e){var r=Ly(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Ly(r)}}function Qw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Qw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Jw(){for(var t=window,e=ch();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=ch(t.document)}return e}function Xx(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function jI(t){var e=Jw(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&Qw(r.ownerDocument.documentElement,r)){if(n!==null&&Xx(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=By(r,s);var a=By(r,n);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var VI=ba&&"documentMode"in document&&11>=document.documentMode,vc=null,wg=null,lf=null,Tg=!1;function jy(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Tg||vc==null||vc!==ch(n)||(n=vc,"selectionStart"in n&&Xx(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),lf&&Df(lf,n)||(lf=n,n=gh(wg,"onSelect"),0<n.length&&(e=new $x("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=vc)))}function fd(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var yc={animationend:fd("Animation","AnimationEnd"),animationiteration:fd("Animation","AnimationIteration"),animationstart:fd("Animation","AnimationStart"),transitionend:fd("Transition","TransitionEnd")},lm={},Zw={};ba&&(Zw=document.createElement("div").style,"AnimationEvent"in window||(delete yc.animationend.animation,delete yc.animationiteration.animation,delete yc.animationstart.animation),"TransitionEvent"in window||delete yc.transitionend.transition);function hp(t){if(lm[t])return lm[t];if(!yc[t])return t;var e=yc[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in Zw)return lm[t]=e[r];return t}var eT=hp("animationend"),tT=hp("animationiteration"),rT=hp("animationstart"),nT=hp("transitionend"),iT=new Map,Vy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Wo(t,e){iT.set(t,e),Ol(e,[t])}for(var cm=0;cm<Vy.length;cm++){var um=Vy[cm],UI=um.toLowerCase(),zI=um[0].toUpperCase()+um.slice(1);Wo(UI,"on"+zI)}Wo(eT,"onAnimationEnd");Wo(tT,"onAnimationIteration");Wo(rT,"onAnimationStart");Wo("dblclick","onDoubleClick");Wo("focusin","onFocus");Wo("focusout","onBlur");Wo(nT,"onTransitionEnd");Hc("onMouseEnter",["mouseout","mouseover"]);Hc("onMouseLeave",["mouseout","mouseover"]);Hc("onPointerEnter",["pointerout","pointerover"]);Hc("onPointerLeave",["pointerout","pointerover"]);Ol("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ol("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ol("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ol("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ol("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ol("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),WI=new Set("cancel close invalid load scroll toggle".split(" ").concat(Yu));function Uy(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,UF(n,e,void 0,t),t.currentTarget=null}function sT(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;Uy(i,o,c),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;Uy(i,o,c),s=l}}}if(fh)throw t=vg,fh=!1,vg=null,t}function or(t,e){var r=e[Fg];r===void 0&&(r=e[Fg]=new Set);var n=t+"__bubble";r.has(n)||(aT(e,t,2,!1),r.add(n))}function fm(t,e,r){var n=0;e&&(n|=4),aT(r,t,n,e)}var dd="_reactListening"+Math.random().toString(36).slice(2);function Pf(t){if(!t[dd]){t[dd]=!0,hw.forEach(function(r){r!=="selectionchange"&&(WI.has(r)||fm(r,!1,t),fm(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[dd]||(e[dd]=!0,fm("selectionchange",!1,e))}}function aT(t,e,r,n){switch(Ww(e)){case 1:var i=nI;break;case 4:i=iI;break;default:i=Wx}r=i.bind(null,e,r,t),i=void 0,!xg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function dm(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=al(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}Iw(function(){var c=s,d=jx(r),h=[];e:{var p=iT.get(t);if(p!==void 0){var g=$x,y=t;switch(t){case"keypress":if(Gd(r)===0)break e;case"keydown":case"keyup":g=yI;break;case"focusin":y="focus",g=sm;break;case"focusout":y="blur",g=sm;break;case"beforeblur":case"afterblur":g=sm;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=Iy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=oI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=wI;break;case eT:case tT:case rT:g=uI;break;case nT:g=SI;break;case"scroll":g=sI;break;case"wheel":g=kI;break;case"copy":case"cut":case"paste":g=dI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=Ry}var x=(e&4)!==0,E=!x&&t==="scroll",T=x?p!==null?p+"Capture":null:p;x=[];for(var A=c,_;A!==null;){_=A;var O=_.stateNode;if(_.tag===5&&O!==null&&(_=O,T!==null&&(O=Ff(A,T),O!=null&&x.push(Of(A,O,_)))),E)break;A=A.return}0<x.length&&(p=new g(p,y,null,r,d),h.push({event:p,listeners:x}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",p&&r!==mg&&(y=r.relatedTarget||r.fromElement)&&(al(y)||y[Ra]))break e;if((g||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,g?(y=r.relatedTarget||r.toElement,g=c,y=y?al(y):null,y!==null&&(E=Ml(y),y!==E||y.tag!==5&&y.tag!==6)&&(y=null)):(g=null,y=c),g!==y)){if(x=Iy,O="onMouseLeave",T="onMouseEnter",A="mouse",(t==="pointerout"||t==="pointerover")&&(x=Ry,O="onPointerLeave",T="onPointerEnter",A="pointer"),E=g==null?p:_c(g),_=y==null?p:_c(y),p=new x(O,A+"leave",g,r,d),p.target=E,p.relatedTarget=_,O=null,al(d)===c&&(x=new x(T,A+"enter",y,r,d),x.target=_,x.relatedTarget=E,O=x),E=O,g&&y)t:{for(x=g,T=y,A=0,_=x;_;_=oc(_))A++;for(_=0,O=T;O;O=oc(O))_++;for(;0<A-_;)x=oc(x),A--;for(;0<_-A;)T=oc(T),_--;for(;A--;){if(x===T||T!==null&&x===T.alternate)break t;x=oc(x),T=oc(T)}x=null}else x=null;g!==null&&zy(h,p,g,x,!1),y!==null&&E!==null&&zy(h,E,y,x,!0)}}e:{if(p=c?_c(c):window,g=p.nodeName&&p.nodeName.toLowerCase(),g==="select"||g==="input"&&p.type==="file")var H=DI;else if(Py(p))if(Yw)H=LI;else{H=OI;var j=PI}else(g=p.nodeName)&&g.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(H=MI);if(H&&(H=H(t,c))){Xw(h,H,r,d);break e}j&&j(t,p,c),t==="focusout"&&(j=p._wrapperState)&&j.controlled&&p.type==="number"&&ug(p,"number",p.value)}switch(j=c?_c(c):window,t){case"focusin":(Py(j)||j.contentEditable==="true")&&(vc=j,wg=c,lf=null);break;case"focusout":lf=wg=vc=null;break;case"mousedown":Tg=!0;break;case"contextmenu":case"mouseup":case"dragend":Tg=!1,jy(h,r,d);break;case"selectionchange":if(VI)break;case"keydown":case"keyup":jy(h,r,d)}var w;if(Kx)e:{switch(t){case"compositionstart":var F="onCompositionStart";break e;case"compositionend":F="onCompositionEnd";break e;case"compositionupdate":F="onCompositionUpdate";break e}F=void 0}else xc?Gw(t,r)&&(F="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(F="onCompositionStart");F&&($w&&r.locale!=="ko"&&(xc||F!=="onCompositionStart"?F==="onCompositionEnd"&&xc&&(w=Hw()):(mo=d,Hx="value"in mo?mo.value:mo.textContent,xc=!0)),j=gh(c,F),0<j.length&&(F=new by(F,t,null,r,d),h.push({event:F,listeners:j}),w?F.data=w:(w=Kw(r),w!==null&&(F.data=w)))),(w=FI?II(t,r):bI(t,r))&&(c=gh(c,"onBeforeInput"),0<c.length&&(d=new by("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:c}),d.data=w))}sT(h,e)})}function Of(t,e,r){return{instance:t,listener:e,currentTarget:r}}function gh(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Ff(t,r),s!=null&&n.unshift(Of(t,s,i)),s=Ff(t,e),s!=null&&n.push(Of(t,s,i))),t=t.return}return n}function oc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function zy(t,e,r,n,i){for(var s=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,i?(l=Ff(r,s),l!=null&&a.unshift(Of(r,l,o))):i||(l=Ff(r,s),l!=null&&a.push(Of(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var HI=/\r\n?/g,$I=/\u0000|\uFFFD/g;function Wy(t){return(typeof t=="string"?t:""+t).replace(HI,`
`).replace($I,"")}function hd(t,e,r){if(e=Wy(e),Wy(t)!==e&&r)throw Error(Oe(425))}function xh(){}var Sg=null,Ag=null;function kg(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Cg=typeof setTimeout=="function"?setTimeout:void 0,GI=typeof clearTimeout=="function"?clearTimeout:void 0,Hy=typeof Promise=="function"?Promise:void 0,KI=typeof queueMicrotask=="function"?queueMicrotask:typeof Hy<"u"?function(t){return Hy.resolve(null).then(t).catch(XI)}:Cg;function XI(t){setTimeout(function(){throw t})}function hm(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),Rf(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Rf(e)}function So(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function $y(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var fu=Math.random().toString(36).slice(2),Ys="__reactFiber$"+fu,Mf="__reactProps$"+fu,Ra="__reactContainer$"+fu,Fg="__reactEvents$"+fu,YI="__reactListeners$"+fu,qI="__reactHandles$"+fu;function al(t){var e=t[Ys];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Ra]||r[Ys]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=$y(t);t!==null;){if(r=t[Ys])return r;t=$y(t)}return e}t=r,r=t.parentNode}return null}function g0(t){return t=t[Ys]||t[Ra],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function _c(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Oe(33))}function pp(t){return t[Mf]||null}var Ig=[],Ec=-1;function Ho(t){return{current:t}}function cr(t){0>Ec||(t.current=Ig[Ec],Ig[Ec]=null,Ec--)}function rr(t,e){Ec++,Ig[Ec]=t.current,t.current=e}var Oo={},Yn=Ho(Oo),Ei=Ho(!1),yl=Oo;function $c(t,e){var r=t.type.contextTypes;if(!r)return Oo;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function wi(t){return t=t.childContextTypes,t!=null}function vh(){cr(Ei),cr(Yn)}function Gy(t,e,r){if(Yn.current!==Oo)throw Error(Oe(168));rr(Yn,e),rr(Ei,r)}function oT(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(Oe(108,PF(t)||"Unknown",i));return kr({},r,n)}function yh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Oo,yl=Yn.current,rr(Yn,t),rr(Ei,Ei.current),!0}function Ky(t,e,r){var n=t.stateNode;if(!n)throw Error(Oe(169));r?(t=oT(t,e,yl),n.__reactInternalMemoizedMergedChildContext=t,cr(Ei),cr(Yn),rr(Yn,t)):cr(Ei),rr(Ei,r)}var va=null,mp=!1,pm=!1;function lT(t){va===null?va=[t]:va.push(t)}function QI(t){mp=!0,lT(t)}function $o(){if(!pm&&va!==null){pm=!0;var t=0,e=Kt;try{var r=va;for(Kt=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}va=null,mp=!1}catch(i){throw va!==null&&(va=va.slice(t+1)),Dw(Vx,$o),i}finally{Kt=e,pm=!1}}return null}var wc=[],Tc=0,_h=null,Eh=0,ss=[],as=0,_l=null,ya=1,_a="";function tl(t,e){wc[Tc++]=Eh,wc[Tc++]=_h,_h=t,Eh=e}function cT(t,e,r){ss[as++]=ya,ss[as++]=_a,ss[as++]=_l,_l=t;var n=ya;t=_a;var i=32-Is(n)-1;n&=~(1<<i),r+=1;var s=32-Is(e)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,ya=1<<32-Is(e)+i|r<<i|n,_a=s+t}else ya=1<<s|r<<i|n,_a=t}function Yx(t){t.return!==null&&(tl(t,1),cT(t,1,0))}function qx(t){for(;t===_h;)_h=wc[--Tc],wc[Tc]=null,Eh=wc[--Tc],wc[Tc]=null;for(;t===_l;)_l=ss[--as],ss[as]=null,_a=ss[--as],ss[as]=null,ya=ss[--as],ss[as]=null}var ji=null,Bi=null,xr=!1,As=null;function uT(t,e){var r=ls(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Xy(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ji=t,Bi=So(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ji=t,Bi=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=_l!==null?{id:ya,overflow:_a}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=ls(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,ji=t,Bi=null,!0):!1;default:return!1}}function bg(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Rg(t){if(xr){var e=Bi;if(e){var r=e;if(!Xy(t,e)){if(bg(t))throw Error(Oe(418));e=So(r.nextSibling);var n=ji;e&&Xy(t,e)?uT(n,r):(t.flags=t.flags&-4097|2,xr=!1,ji=t)}}else{if(bg(t))throw Error(Oe(418));t.flags=t.flags&-4097|2,xr=!1,ji=t}}}function Yy(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ji=t}function pd(t){if(t!==ji)return!1;if(!xr)return Yy(t),xr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!kg(t.type,t.memoizedProps)),e&&(e=Bi)){if(bg(t))throw fT(),Error(Oe(418));for(;e;)uT(t,e),e=So(e.nextSibling)}if(Yy(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Oe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Bi=So(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Bi=null}}else Bi=ji?So(t.stateNode.nextSibling):null;return!0}function fT(){for(var t=Bi;t;)t=So(t.nextSibling)}function Gc(){Bi=ji=null,xr=!1}function Qx(t){As===null?As=[t]:As.push(t)}var JI=Va.ReactCurrentBatchConfig;function Bu(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Oe(309));var n=r.stateNode}if(!n)throw Error(Oe(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(Oe(284));if(!r._owner)throw Error(Oe(290,t))}return t}function md(t,e){throw t=Object.prototype.toString.call(e),Error(Oe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function qy(t){var e=t._init;return e(t._payload)}function dT(t){function e(T,A){if(t){var _=T.deletions;_===null?(T.deletions=[A],T.flags|=16):_.push(A)}}function r(T,A){if(!t)return null;for(;A!==null;)e(T,A),A=A.sibling;return null}function n(T,A){for(T=new Map;A!==null;)A.key!==null?T.set(A.key,A):T.set(A.index,A),A=A.sibling;return T}function i(T,A){return T=Fo(T,A),T.index=0,T.sibling=null,T}function s(T,A,_){return T.index=_,t?(_=T.alternate,_!==null?(_=_.index,_<A?(T.flags|=2,A):_):(T.flags|=2,A)):(T.flags|=1048576,A)}function a(T){return t&&T.alternate===null&&(T.flags|=2),T}function o(T,A,_,O){return A===null||A.tag!==6?(A=Em(_,T.mode,O),A.return=T,A):(A=i(A,_),A.return=T,A)}function l(T,A,_,O){var H=_.type;return H===gc?d(T,A,_.props.children,O,_.key):A!==null&&(A.elementType===H||typeof H=="object"&&H!==null&&H.$$typeof===ao&&qy(H)===A.type)?(O=i(A,_.props),O.ref=Bu(T,A,_),O.return=T,O):(O=Zd(_.type,_.key,_.props,null,T.mode,O),O.ref=Bu(T,A,_),O.return=T,O)}function c(T,A,_,O){return A===null||A.tag!==4||A.stateNode.containerInfo!==_.containerInfo||A.stateNode.implementation!==_.implementation?(A=wm(_,T.mode,O),A.return=T,A):(A=i(A,_.children||[]),A.return=T,A)}function d(T,A,_,O,H){return A===null||A.tag!==7?(A=dl(_,T.mode,O,H),A.return=T,A):(A=i(A,_),A.return=T,A)}function h(T,A,_){if(typeof A=="string"&&A!==""||typeof A=="number")return A=Em(""+A,T.mode,_),A.return=T,A;if(typeof A=="object"&&A!==null){switch(A.$$typeof){case id:return _=Zd(A.type,A.key,A.props,null,T.mode,_),_.ref=Bu(T,null,A),_.return=T,_;case mc:return A=wm(A,T.mode,_),A.return=T,A;case ao:var O=A._init;return h(T,O(A._payload),_)}if(Ku(A)||Du(A))return A=dl(A,T.mode,_,null),A.return=T,A;md(T,A)}return null}function p(T,A,_,O){var H=A!==null?A.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return H!==null?null:o(T,A,""+_,O);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case id:return _.key===H?l(T,A,_,O):null;case mc:return _.key===H?c(T,A,_,O):null;case ao:return H=_._init,p(T,A,H(_._payload),O)}if(Ku(_)||Du(_))return H!==null?null:d(T,A,_,O,null);md(T,_)}return null}function g(T,A,_,O,H){if(typeof O=="string"&&O!==""||typeof O=="number")return T=T.get(_)||null,o(A,T,""+O,H);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case id:return T=T.get(O.key===null?_:O.key)||null,l(A,T,O,H);case mc:return T=T.get(O.key===null?_:O.key)||null,c(A,T,O,H);case ao:var j=O._init;return g(T,A,_,j(O._payload),H)}if(Ku(O)||Du(O))return T=T.get(_)||null,d(A,T,O,H,null);md(A,O)}return null}function y(T,A,_,O){for(var H=null,j=null,w=A,F=A=0,S=null;w!==null&&F<_.length;F++){w.index>F?(S=w,w=null):S=w.sibling;var b=p(T,w,_[F],O);if(b===null){w===null&&(w=S);break}t&&w&&b.alternate===null&&e(T,w),A=s(b,A,F),j===null?H=b:j.sibling=b,j=b,w=S}if(F===_.length)return r(T,w),xr&&tl(T,F),H;if(w===null){for(;F<_.length;F++)w=h(T,_[F],O),w!==null&&(A=s(w,A,F),j===null?H=w:j.sibling=w,j=w);return xr&&tl(T,F),H}for(w=n(T,w);F<_.length;F++)S=g(w,T,F,_[F],O),S!==null&&(t&&S.alternate!==null&&w.delete(S.key===null?F:S.key),A=s(S,A,F),j===null?H=S:j.sibling=S,j=S);return t&&w.forEach(function(D){return e(T,D)}),xr&&tl(T,F),H}function x(T,A,_,O){var H=Du(_);if(typeof H!="function")throw Error(Oe(150));if(_=H.call(_),_==null)throw Error(Oe(151));for(var j=H=null,w=A,F=A=0,S=null,b=_.next();w!==null&&!b.done;F++,b=_.next()){w.index>F?(S=w,w=null):S=w.sibling;var D=p(T,w,b.value,O);if(D===null){w===null&&(w=S);break}t&&w&&D.alternate===null&&e(T,w),A=s(D,A,F),j===null?H=D:j.sibling=D,j=D,w=S}if(b.done)return r(T,w),xr&&tl(T,F),H;if(w===null){for(;!b.done;F++,b=_.next())b=h(T,b.value,O),b!==null&&(A=s(b,A,F),j===null?H=b:j.sibling=b,j=b);return xr&&tl(T,F),H}for(w=n(T,w);!b.done;F++,b=_.next())b=g(w,T,F,b.value,O),b!==null&&(t&&b.alternate!==null&&w.delete(b.key===null?F:b.key),A=s(b,A,F),j===null?H=b:j.sibling=b,j=b);return t&&w.forEach(function(P){return e(T,P)}),xr&&tl(T,F),H}function E(T,A,_,O){if(typeof _=="object"&&_!==null&&_.type===gc&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case id:e:{for(var H=_.key,j=A;j!==null;){if(j.key===H){if(H=_.type,H===gc){if(j.tag===7){r(T,j.sibling),A=i(j,_.props.children),A.return=T,T=A;break e}}else if(j.elementType===H||typeof H=="object"&&H!==null&&H.$$typeof===ao&&qy(H)===j.type){r(T,j.sibling),A=i(j,_.props),A.ref=Bu(T,j,_),A.return=T,T=A;break e}r(T,j);break}else e(T,j);j=j.sibling}_.type===gc?(A=dl(_.props.children,T.mode,O,_.key),A.return=T,T=A):(O=Zd(_.type,_.key,_.props,null,T.mode,O),O.ref=Bu(T,A,_),O.return=T,T=O)}return a(T);case mc:e:{for(j=_.key;A!==null;){if(A.key===j)if(A.tag===4&&A.stateNode.containerInfo===_.containerInfo&&A.stateNode.implementation===_.implementation){r(T,A.sibling),A=i(A,_.children||[]),A.return=T,T=A;break e}else{r(T,A);break}else e(T,A);A=A.sibling}A=wm(_,T.mode,O),A.return=T,T=A}return a(T);case ao:return j=_._init,E(T,A,j(_._payload),O)}if(Ku(_))return y(T,A,_,O);if(Du(_))return x(T,A,_,O);md(T,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,A!==null&&A.tag===6?(r(T,A.sibling),A=i(A,_),A.return=T,T=A):(r(T,A),A=Em(_,T.mode,O),A.return=T,T=A),a(T)):r(T,A)}return E}var Kc=dT(!0),hT=dT(!1),wh=Ho(null),Th=null,Sc=null,Jx=null;function Zx(){Jx=Sc=Th=null}function e1(t){var e=wh.current;cr(wh),t._currentValue=e}function Ng(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Pc(t,e){Th=t,Jx=Sc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(_i=!0),t.firstContext=null)}function fs(t){var e=t._currentValue;if(Jx!==t)if(t={context:t,memoizedValue:e,next:null},Sc===null){if(Th===null)throw Error(Oe(308));Sc=t,Th.dependencies={lanes:0,firstContext:t}}else Sc=Sc.next=t;return e}var ol=null;function t1(t){ol===null?ol=[t]:ol.push(t)}function pT(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,t1(e)):(r.next=i.next,i.next=r),e.interleaved=r,Na(t,n)}function Na(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var oo=!1;function r1(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function mT(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Aa(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ao(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Rt&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,Na(t,r)}return i=n.interleaved,i===null?(e.next=e,t1(n)):(e.next=i.next,i.next=e),n.interleaved=e,Na(t,r)}function Kd(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Ux(t,r)}}function Qy(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Sh(t,e,r,n){var i=t.updateQueue;oo=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var d=t.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==a&&(o===null?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;a=0,d=c=l=null,o=s;do{var p=o.lane,g=o.eventTime;if((n&p)===p){d!==null&&(d=d.next={eventTime:g,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=t,x=o;switch(p=e,g=r,x.tag){case 1:if(y=x.payload,typeof y=="function"){h=y.call(g,h,p);break e}h=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=x.payload,p=typeof y=="function"?y.call(g,h,p):y,p==null)break e;h=kr({},h,p);break e;case 2:oo=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,p=i.effects,p===null?i.effects=[o]:p.push(o))}else g={eventTime:g,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(c=d=g,l=h):d=d.next=g,a|=p;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;p=o,o=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(d===null&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);wl|=a,t.lanes=a,t.memoizedState=h}}function Jy(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Oe(191,i));i.call(n)}}}var x0={},Js=Ho(x0),Lf=Ho(x0),Bf=Ho(x0);function ll(t){if(t===x0)throw Error(Oe(174));return t}function n1(t,e){switch(rr(Bf,e),rr(Lf,t),rr(Js,x0),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:dg(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=dg(e,t)}cr(Js),rr(Js,e)}function Xc(){cr(Js),cr(Lf),cr(Bf)}function gT(t){ll(Bf.current);var e=ll(Js.current),r=dg(e,t.type);e!==r&&(rr(Lf,t),rr(Js,r))}function i1(t){Lf.current===t&&(cr(Js),cr(Lf))}var wr=Ho(0);function Ah(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var mm=[];function s1(){for(var t=0;t<mm.length;t++)mm[t]._workInProgressVersionPrimary=null;mm.length=0}var Xd=Va.ReactCurrentDispatcher,gm=Va.ReactCurrentBatchConfig,El=0,Ar=null,Jr=null,un=null,kh=!1,cf=!1,jf=0,ZI=0;function Ln(){throw Error(Oe(321))}function a1(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Ds(t[r],e[r]))return!1;return!0}function o1(t,e,r,n,i,s){if(El=s,Ar=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Xd.current=t===null||t.memoizedState===null?nb:ib,t=r(n,i),cf){s=0;do{if(cf=!1,jf=0,25<=s)throw Error(Oe(301));s+=1,un=Jr=null,e.updateQueue=null,Xd.current=sb,t=r(n,i)}while(cf)}if(Xd.current=Ch,e=Jr!==null&&Jr.next!==null,El=0,un=Jr=Ar=null,kh=!1,e)throw Error(Oe(300));return t}function l1(){var t=jf!==0;return jf=0,t}function Xs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return un===null?Ar.memoizedState=un=t:un=un.next=t,un}function ds(){if(Jr===null){var t=Ar.alternate;t=t!==null?t.memoizedState:null}else t=Jr.next;var e=un===null?Ar.memoizedState:un.next;if(e!==null)un=e,Jr=t;else{if(t===null)throw Error(Oe(310));Jr=t,t={memoizedState:Jr.memoizedState,baseState:Jr.baseState,baseQueue:Jr.baseQueue,queue:Jr.queue,next:null},un===null?Ar.memoizedState=un=t:un=un.next=t}return un}function Vf(t,e){return typeof e=="function"?e(t):e}function xm(t){var e=ds(),r=e.queue;if(r===null)throw Error(Oe(311));r.lastRenderedReducer=t;var n=Jr,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,c=s;do{var d=c.lane;if((El&d)===d)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,a=n):l=l.next=h,Ar.lanes|=d,wl|=d}c=c.next}while(c!==null&&c!==s);l===null?a=n:l.next=o,Ds(n,e.memoizedState)||(_i=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,Ar.lanes|=s,wl|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function vm(t){var e=ds(),r=e.queue;if(r===null)throw Error(Oe(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);Ds(s,e.memoizedState)||(_i=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function xT(){}function vT(t,e){var r=Ar,n=ds(),i=e(),s=!Ds(n.memoizedState,i);if(s&&(n.memoizedState=i,_i=!0),n=n.queue,c1(ET.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||un!==null&&un.memoizedState.tag&1){if(r.flags|=2048,Uf(9,_T.bind(null,r,n,i,e),void 0,null),hn===null)throw Error(Oe(349));El&30||yT(r,e,i)}return i}function yT(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Ar.updateQueue,e===null?(e={lastEffect:null,stores:null},Ar.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function _T(t,e,r,n){e.value=r,e.getSnapshot=n,wT(e)&&TT(t)}function ET(t,e,r){return r(function(){wT(e)&&TT(t)})}function wT(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Ds(t,r)}catch{return!0}}function TT(t){var e=Na(t,1);e!==null&&bs(e,t,1,-1)}function Zy(t){var e=Xs();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vf,lastRenderedState:t},e.queue=t,t=t.dispatch=rb.bind(null,Ar,t),[e.memoizedState,t]}function Uf(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Ar.updateQueue,e===null?(e={lastEffect:null,stores:null},Ar.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function ST(){return ds().memoizedState}function Yd(t,e,r,n){var i=Xs();Ar.flags|=t,i.memoizedState=Uf(1|e,r,void 0,n===void 0?null:n)}function gp(t,e,r,n){var i=ds();n=n===void 0?null:n;var s=void 0;if(Jr!==null){var a=Jr.memoizedState;if(s=a.destroy,n!==null&&a1(n,a.deps)){i.memoizedState=Uf(e,r,s,n);return}}Ar.flags|=t,i.memoizedState=Uf(1|e,r,s,n)}function e_(t,e){return Yd(8390656,8,t,e)}function c1(t,e){return gp(2048,8,t,e)}function AT(t,e){return gp(4,2,t,e)}function kT(t,e){return gp(4,4,t,e)}function CT(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function FT(t,e,r){return r=r!=null?r.concat([t]):null,gp(4,4,CT.bind(null,e,t),r)}function u1(){}function IT(t,e){var r=ds();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&a1(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function bT(t,e){var r=ds();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&a1(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function RT(t,e,r){return El&21?(Ds(r,e)||(r=Mw(),Ar.lanes|=r,wl|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,_i=!0),t.memoizedState=r)}function eb(t,e){var r=Kt;Kt=r!==0&&4>r?r:4,t(!0);var n=gm.transition;gm.transition={};try{t(!1),e()}finally{Kt=r,gm.transition=n}}function NT(){return ds().memoizedState}function tb(t,e,r){var n=Co(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},DT(t))PT(e,r);else if(r=pT(t,e,r,n),r!==null){var i=ci();bs(r,t,n,i),OT(r,e,n)}}function rb(t,e,r){var n=Co(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(DT(t))PT(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,Ds(o,a)){var l=e.interleaved;l===null?(i.next=i,t1(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=pT(t,e,i,n),r!==null&&(i=ci(),bs(r,t,n,i),OT(r,e,n))}}function DT(t){var e=t.alternate;return t===Ar||e!==null&&e===Ar}function PT(t,e){cf=kh=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function OT(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Ux(t,r)}}var Ch={readContext:fs,useCallback:Ln,useContext:Ln,useEffect:Ln,useImperativeHandle:Ln,useInsertionEffect:Ln,useLayoutEffect:Ln,useMemo:Ln,useReducer:Ln,useRef:Ln,useState:Ln,useDebugValue:Ln,useDeferredValue:Ln,useTransition:Ln,useMutableSource:Ln,useSyncExternalStore:Ln,useId:Ln,unstable_isNewReconciler:!1},nb={readContext:fs,useCallback:function(t,e){return Xs().memoizedState=[t,e===void 0?null:e],t},useContext:fs,useEffect:e_,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Yd(4194308,4,CT.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Yd(4194308,4,t,e)},useInsertionEffect:function(t,e){return Yd(4,2,t,e)},useMemo:function(t,e){var r=Xs();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Xs();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=tb.bind(null,Ar,t),[n.memoizedState,t]},useRef:function(t){var e=Xs();return t={current:t},e.memoizedState=t},useState:Zy,useDebugValue:u1,useDeferredValue:function(t){return Xs().memoizedState=t},useTransition:function(){var t=Zy(!1),e=t[0];return t=eb.bind(null,t[1]),Xs().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Ar,i=Xs();if(xr){if(r===void 0)throw Error(Oe(407));r=r()}else{if(r=e(),hn===null)throw Error(Oe(349));El&30||yT(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,e_(ET.bind(null,n,s,t),[t]),n.flags|=2048,Uf(9,_T.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=Xs(),e=hn.identifierPrefix;if(xr){var r=_a,n=ya;r=(n&~(1<<32-Is(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=jf++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=ZI++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},ib={readContext:fs,useCallback:IT,useContext:fs,useEffect:c1,useImperativeHandle:FT,useInsertionEffect:AT,useLayoutEffect:kT,useMemo:bT,useReducer:xm,useRef:ST,useState:function(){return xm(Vf)},useDebugValue:u1,useDeferredValue:function(t){var e=ds();return RT(e,Jr.memoizedState,t)},useTransition:function(){var t=xm(Vf)[0],e=ds().memoizedState;return[t,e]},useMutableSource:xT,useSyncExternalStore:vT,useId:NT,unstable_isNewReconciler:!1},sb={readContext:fs,useCallback:IT,useContext:fs,useEffect:c1,useImperativeHandle:FT,useInsertionEffect:AT,useLayoutEffect:kT,useMemo:bT,useReducer:vm,useRef:ST,useState:function(){return vm(Vf)},useDebugValue:u1,useDeferredValue:function(t){var e=ds();return Jr===null?e.memoizedState=t:RT(e,Jr.memoizedState,t)},useTransition:function(){var t=vm(Vf)[0],e=ds().memoizedState;return[t,e]},useMutableSource:xT,useSyncExternalStore:vT,useId:NT,unstable_isNewReconciler:!1};function Ts(t,e){if(t&&t.defaultProps){e=kr({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Dg(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:kr({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var xp={isMounted:function(t){return(t=t._reactInternals)?Ml(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=ci(),i=Co(t),s=Aa(n,i);s.payload=e,r!=null&&(s.callback=r),e=Ao(t,s,i),e!==null&&(bs(e,t,i,n),Kd(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=ci(),i=Co(t),s=Aa(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=Ao(t,s,i),e!==null&&(bs(e,t,i,n),Kd(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=ci(),n=Co(t),i=Aa(r,n);i.tag=2,e!=null&&(i.callback=e),e=Ao(t,i,n),e!==null&&(bs(e,t,n,r),Kd(e,t,n))}};function t_(t,e,r,n,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,a):e.prototype&&e.prototype.isPureReactComponent?!Df(r,n)||!Df(i,s):!0}function MT(t,e,r){var n=!1,i=Oo,s=e.contextType;return typeof s=="object"&&s!==null?s=fs(s):(i=wi(e)?yl:Yn.current,n=e.contextTypes,s=(n=n!=null)?$c(t,i):Oo),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=xp,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function r_(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&xp.enqueueReplaceState(e,e.state,null)}function Pg(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},r1(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=fs(s):(s=wi(e)?yl:Yn.current,i.context=$c(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Dg(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&xp.enqueueReplaceState(i,i.state,null),Sh(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Yc(t,e){try{var r="",n=e;do r+=DF(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function ym(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Og(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var ab=typeof WeakMap=="function"?WeakMap:Map;function LT(t,e,r){r=Aa(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Ih||(Ih=!0,$g=n),Og(t,e)},r}function BT(t,e,r){r=Aa(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){Og(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Og(t,e),typeof n!="function"&&(ko===null?ko=new Set([this]):ko.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function n_(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new ab;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=_b.bind(null,t,e,r),e.then(t,t))}function i_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function s_(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Aa(-1,1),e.tag=2,Ao(r,e,1))),r.lanes|=1),t)}var ob=Va.ReactCurrentOwner,_i=!1;function ai(t,e,r,n){e.child=t===null?hT(e,null,r,n):Kc(e,t.child,r,n)}function a_(t,e,r,n,i){r=r.render;var s=e.ref;return Pc(e,i),n=o1(t,e,r,n,s,i),r=l1(),t!==null&&!_i?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Da(t,e,i)):(xr&&r&&Yx(e),e.flags|=1,ai(t,e,n,i),e.child)}function o_(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!v1(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,jT(t,e,s,n,i)):(t=Zd(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:Df,r(a,n)&&t.ref===e.ref)return Da(t,e,i)}return e.flags|=1,t=Fo(s,n),t.ref=e.ref,t.return=e,e.child=t}function jT(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(Df(s,n)&&t.ref===e.ref)if(_i=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(_i=!0);else return e.lanes=t.lanes,Da(t,e,i)}return Mg(t,e,r,n,i)}function VT(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},rr(kc,Di),Di|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,rr(kc,Di),Di|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,rr(kc,Di),Di|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,rr(kc,Di),Di|=n;return ai(t,e,i,r),e.child}function UT(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Mg(t,e,r,n,i){var s=wi(r)?yl:Yn.current;return s=$c(e,s),Pc(e,i),r=o1(t,e,r,n,s,i),n=l1(),t!==null&&!_i?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Da(t,e,i)):(xr&&n&&Yx(e),e.flags|=1,ai(t,e,r,i),e.child)}function l_(t,e,r,n,i){if(wi(r)){var s=!0;yh(e)}else s=!1;if(Pc(e,i),e.stateNode===null)qd(t,e),MT(e,r,n),Pg(e,r,n,i),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=fs(c):(c=wi(r)?yl:Yn.current,c=$c(e,c));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&r_(e,a,n,c),oo=!1;var p=e.memoizedState;a.state=p,Sh(e,n,a,i),l=e.memoizedState,o!==n||p!==l||Ei.current||oo?(typeof d=="function"&&(Dg(e,r,d,n),l=e.memoizedState),(o=oo||t_(e,r,o,n,p,l,c))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,mT(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:Ts(e.type,o),a.props=c,h=e.pendingProps,p=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=fs(l):(l=wi(r)?yl:Yn.current,l=$c(e,l));var g=r.getDerivedStateFromProps;(d=typeof g=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||p!==l)&&r_(e,a,n,l),oo=!1,p=e.memoizedState,a.state=p,Sh(e,n,a,i);var y=e.memoizedState;o!==h||p!==y||Ei.current||oo?(typeof g=="function"&&(Dg(e,r,g,n),y=e.memoizedState),(c=oo||t_(e,r,c,n,p,y,l)||!1)?(d||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,y,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,y,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=y),a.props=n,a.state=y,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),n=!1)}return Lg(t,e,r,n,s,i)}function Lg(t,e,r,n,i,s){UT(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return i&&Ky(e,r,!1),Da(t,e,s);n=e.stateNode,ob.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=Kc(e,t.child,null,s),e.child=Kc(e,null,o,s)):ai(t,e,o,s),e.memoizedState=n.state,i&&Ky(e,r,!0),e.child}function zT(t){var e=t.stateNode;e.pendingContext?Gy(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Gy(t,e.context,!1),n1(t,e.containerInfo)}function c_(t,e,r,n,i){return Gc(),Qx(i),e.flags|=256,ai(t,e,r,n),e.child}var Bg={dehydrated:null,treeContext:null,retryLane:0};function jg(t){return{baseLanes:t,cachePool:null,transitions:null}}function WT(t,e,r){var n=e.pendingProps,i=wr.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),rr(wr,i&1),t===null)return Rg(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,s?(n=e.mode,s=e.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=_p(a,n,0,null),t=dl(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=jg(r),e.memoizedState=Bg,t):f1(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return lb(t,e,a,n,o,i,r);if(s){s=n.fallback,a=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=Fo(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=Fo(o,s):(s=dl(s,a,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,a=t.child.memoizedState,a=a===null?jg(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~r,e.memoizedState=Bg,n}return s=t.child,t=s.sibling,n=Fo(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function f1(t,e){return e=_p({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function gd(t,e,r,n){return n!==null&&Qx(n),Kc(e,t.child,null,r),t=f1(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function lb(t,e,r,n,i,s,a){if(r)return e.flags&256?(e.flags&=-257,n=ym(Error(Oe(422))),gd(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=_p({mode:"visible",children:n.children},i,0,null),s=dl(s,i,a,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&Kc(e,t.child,null,a),e.child.memoizedState=jg(a),e.memoizedState=Bg,s);if(!(e.mode&1))return gd(t,e,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(Oe(419)),n=ym(s,n,void 0),gd(t,e,a,n)}if(o=(a&t.childLanes)!==0,_i||o){if(n=hn,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Na(t,i),bs(n,t,i,-1))}return x1(),n=ym(Error(Oe(421))),gd(t,e,a,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=Eb.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Bi=So(i.nextSibling),ji=e,xr=!0,As=null,t!==null&&(ss[as++]=ya,ss[as++]=_a,ss[as++]=_l,ya=t.id,_a=t.overflow,_l=e),e=f1(e,n.children),e.flags|=4096,e)}function u_(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Ng(t.return,e,r)}function _m(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function HT(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(ai(t,e,n.children,r),n=wr.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&u_(t,r,e);else if(t.tag===19)u_(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(rr(wr,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&Ah(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),_m(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Ah(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}_m(e,!0,r,null,s);break;case"together":_m(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function qd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Da(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),wl|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Oe(153));if(e.child!==null){for(t=e.child,r=Fo(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Fo(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function cb(t,e,r){switch(e.tag){case 3:zT(e),Gc();break;case 5:gT(e);break;case 1:wi(e.type)&&yh(e);break;case 4:n1(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;rr(wh,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(rr(wr,wr.current&1),e.flags|=128,null):r&e.child.childLanes?WT(t,e,r):(rr(wr,wr.current&1),t=Da(t,e,r),t!==null?t.sibling:null);rr(wr,wr.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return HT(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),rr(wr,wr.current),n)break;return null;case 22:case 23:return e.lanes=0,VT(t,e,r)}return Da(t,e,r)}var $T,Vg,GT,KT;$T=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Vg=function(){};GT=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,ll(Js.current);var s=null;switch(r){case"input":i=lg(t,i),n=lg(t,n),s=[];break;case"select":i=kr({},i,{value:void 0}),n=kr({},n,{value:void 0}),s=[];break;case"textarea":i=fg(t,i),n=fg(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=xh)}hg(r,n);var a;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(kf.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(kf.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&or("scroll",t),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};KT=function(t,e,r,n){r!==n&&(e.flags|=4)};function ju(t,e){if(!xr)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Bn(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function ub(t,e,r){var n=e.pendingProps;switch(qx(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bn(e),null;case 1:return wi(e.type)&&vh(),Bn(e),null;case 3:return n=e.stateNode,Xc(),cr(Ei),cr(Yn),s1(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(pd(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,As!==null&&(Xg(As),As=null))),Vg(t,e),Bn(e),null;case 5:i1(e);var i=ll(Bf.current);if(r=e.type,t!==null&&e.stateNode!=null)GT(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Oe(166));return Bn(e),null}if(t=ll(Js.current),pd(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[Ys]=e,n[Mf]=s,t=(e.mode&1)!==0,r){case"dialog":or("cancel",n),or("close",n);break;case"iframe":case"object":case"embed":or("load",n);break;case"video":case"audio":for(i=0;i<Yu.length;i++)or(Yu[i],n);break;case"source":or("error",n);break;case"img":case"image":case"link":or("error",n),or("load",n);break;case"details":or("toggle",n);break;case"input":yy(n,s),or("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},or("invalid",n);break;case"textarea":Ey(n,s),or("invalid",n)}hg(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&hd(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&hd(n.textContent,o,t),i=["children",""+o]):kf.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&or("scroll",n)}switch(r){case"input":sd(n),_y(n,s,!0);break;case"textarea":sd(n),wy(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=xh)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Ew(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[Ys]=e,t[Mf]=n,$T(t,e,!1,!1),e.stateNode=t;e:{switch(a=pg(r,n),r){case"dialog":or("cancel",t),or("close",t),i=n;break;case"iframe":case"object":case"embed":or("load",t),i=n;break;case"video":case"audio":for(i=0;i<Yu.length;i++)or(Yu[i],t);i=n;break;case"source":or("error",t),i=n;break;case"img":case"image":case"link":or("error",t),or("load",t),i=n;break;case"details":or("toggle",t),i=n;break;case"input":yy(t,n),i=lg(t,n),or("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=kr({},n,{value:void 0}),or("invalid",t);break;case"textarea":Ey(t,n),i=fg(t,n),or("invalid",t);break;default:i=n}hg(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?Sw(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&ww(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Cf(t,l):typeof l=="number"&&Cf(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(kf.hasOwnProperty(s)?l!=null&&s==="onScroll"&&or("scroll",t):l!=null&&Ox(t,s,l,a))}switch(r){case"input":sd(t),_y(t,n,!1);break;case"textarea":sd(t),wy(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Po(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?bc(t,!!n.multiple,s,!1):n.defaultValue!=null&&bc(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=xh)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Bn(e),null;case 6:if(t&&e.stateNode!=null)KT(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Oe(166));if(r=ll(Bf.current),ll(Js.current),pd(e)){if(n=e.stateNode,r=e.memoizedProps,n[Ys]=e,(s=n.nodeValue!==r)&&(t=ji,t!==null))switch(t.tag){case 3:hd(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&hd(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ys]=e,e.stateNode=n}return Bn(e),null;case 13:if(cr(wr),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(xr&&Bi!==null&&e.mode&1&&!(e.flags&128))fT(),Gc(),e.flags|=98560,s=!1;else if(s=pd(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(Oe(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Oe(317));s[Ys]=e}else Gc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Bn(e),s=!1}else As!==null&&(Xg(As),As=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||wr.current&1?tn===0&&(tn=3):x1())),e.updateQueue!==null&&(e.flags|=4),Bn(e),null);case 4:return Xc(),Vg(t,e),t===null&&Pf(e.stateNode.containerInfo),Bn(e),null;case 10:return e1(e.type._context),Bn(e),null;case 17:return wi(e.type)&&vh(),Bn(e),null;case 19:if(cr(wr),s=e.memoizedState,s===null)return Bn(e),null;if(n=(e.flags&128)!==0,a=s.rendering,a===null)if(n)ju(s,!1);else{if(tn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Ah(t),a!==null){for(e.flags|=128,ju(s,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return rr(wr,wr.current&1|2),e.child}t=t.sibling}s.tail!==null&&jr()>qc&&(e.flags|=128,n=!0,ju(s,!1),e.lanes=4194304)}else{if(!n)if(t=Ah(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),ju(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!xr)return Bn(e),null}else 2*jr()-s.renderingStartTime>qc&&r!==1073741824&&(e.flags|=128,n=!0,ju(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(r=s.last,r!==null?r.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=jr(),e.sibling=null,r=wr.current,rr(wr,n?r&1|2:r&1),e):(Bn(e),null);case 22:case 23:return g1(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Di&1073741824&&(Bn(e),e.subtreeFlags&6&&(e.flags|=8192)):Bn(e),null;case 24:return null;case 25:return null}throw Error(Oe(156,e.tag))}function fb(t,e){switch(qx(e),e.tag){case 1:return wi(e.type)&&vh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Xc(),cr(Ei),cr(Yn),s1(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return i1(e),null;case 13:if(cr(wr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Oe(340));Gc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return cr(wr),null;case 4:return Xc(),null;case 10:return e1(e.type._context),null;case 22:case 23:return g1(),null;case 24:return null;default:return null}}var xd=!1,Hn=!1,db=typeof WeakSet=="function"?WeakSet:Set,qe=null;function Ac(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Nr(t,e,n)}else r.current=null}function Ug(t,e,r){try{r()}catch(n){Nr(t,e,n)}}var f_=!1;function hb(t,e){if(Sg=ph,t=Jw(),Xx(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,d=0,h=t,p=null;t:for(;;){for(var g;h!==r||i!==0&&h.nodeType!==3||(o=a+i),h!==s||n!==0&&h.nodeType!==3||(l=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(g=h.firstChild)!==null;)p=h,h=g;for(;;){if(h===t)break t;if(p===r&&++c===i&&(o=a),p===s&&++d===n&&(l=a),(g=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=g}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Ag={focusedElem:t,selectionRange:r},ph=!1,qe=e;qe!==null;)if(e=qe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,qe=t;else for(;qe!==null;){e=qe;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var x=y.memoizedProps,E=y.memoizedState,T=e.stateNode,A=T.getSnapshotBeforeUpdate(e.elementType===e.type?x:Ts(e.type,x),E);T.__reactInternalSnapshotBeforeUpdate=A}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Oe(163))}}catch(O){Nr(e,e.return,O)}if(t=e.sibling,t!==null){t.return=e.return,qe=t;break}qe=e.return}return y=f_,f_=!1,y}function uf(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Ug(e,r,s)}i=i.next}while(i!==n)}}function vp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function zg(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function XT(t){var e=t.alternate;e!==null&&(t.alternate=null,XT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ys],delete e[Mf],delete e[Fg],delete e[YI],delete e[qI])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function YT(t){return t.tag===5||t.tag===3||t.tag===4}function d_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||YT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Wg(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=xh));else if(n!==4&&(t=t.child,t!==null))for(Wg(t,e,r),t=t.sibling;t!==null;)Wg(t,e,r),t=t.sibling}function Hg(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Hg(t,e,r),t=t.sibling;t!==null;)Hg(t,e,r),t=t.sibling}var Sn=null,Ss=!1;function no(t,e,r){for(r=r.child;r!==null;)qT(t,e,r),r=r.sibling}function qT(t,e,r){if(Qs&&typeof Qs.onCommitFiberUnmount=="function")try{Qs.onCommitFiberUnmount(up,r)}catch{}switch(r.tag){case 5:Hn||Ac(r,e);case 6:var n=Sn,i=Ss;Sn=null,no(t,e,r),Sn=n,Ss=i,Sn!==null&&(Ss?(t=Sn,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Sn.removeChild(r.stateNode));break;case 18:Sn!==null&&(Ss?(t=Sn,r=r.stateNode,t.nodeType===8?hm(t.parentNode,r):t.nodeType===1&&hm(t,r),Rf(t)):hm(Sn,r.stateNode));break;case 4:n=Sn,i=Ss,Sn=r.stateNode.containerInfo,Ss=!0,no(t,e,r),Sn=n,Ss=i;break;case 0:case 11:case 14:case 15:if(!Hn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&Ug(r,e,a),i=i.next}while(i!==n)}no(t,e,r);break;case 1:if(!Hn&&(Ac(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Nr(r,e,o)}no(t,e,r);break;case 21:no(t,e,r);break;case 22:r.mode&1?(Hn=(n=Hn)||r.memoizedState!==null,no(t,e,r),Hn=n):no(t,e,r);break;default:no(t,e,r)}}function h_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new db),e.forEach(function(n){var i=wb.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Es(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:Sn=o.stateNode,Ss=!1;break e;case 3:Sn=o.stateNode.containerInfo,Ss=!0;break e;case 4:Sn=o.stateNode.containerInfo,Ss=!0;break e}o=o.return}if(Sn===null)throw Error(Oe(160));qT(s,a,i),Sn=null,Ss=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Nr(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)QT(e,t),e=e.sibling}function QT(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Es(e,t),zs(t),n&4){try{uf(3,t,t.return),vp(3,t)}catch(x){Nr(t,t.return,x)}try{uf(5,t,t.return)}catch(x){Nr(t,t.return,x)}}break;case 1:Es(e,t),zs(t),n&512&&r!==null&&Ac(r,r.return);break;case 5:if(Es(e,t),zs(t),n&512&&r!==null&&Ac(r,r.return),t.flags&32){var i=t.stateNode;try{Cf(i,"")}catch(x){Nr(t,t.return,x)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=r!==null?r.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&yw(i,s),pg(o,a);var c=pg(o,s);for(a=0;a<l.length;a+=2){var d=l[a],h=l[a+1];d==="style"?Sw(i,h):d==="dangerouslySetInnerHTML"?ww(i,h):d==="children"?Cf(i,h):Ox(i,d,h,c)}switch(o){case"input":cg(i,s);break;case"textarea":_w(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var g=s.value;g!=null?bc(i,!!s.multiple,g,!1):p!==!!s.multiple&&(s.defaultValue!=null?bc(i,!!s.multiple,s.defaultValue,!0):bc(i,!!s.multiple,s.multiple?[]:"",!1))}i[Mf]=s}catch(x){Nr(t,t.return,x)}}break;case 6:if(Es(e,t),zs(t),n&4){if(t.stateNode===null)throw Error(Oe(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(x){Nr(t,t.return,x)}}break;case 3:if(Es(e,t),zs(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Rf(e.containerInfo)}catch(x){Nr(t,t.return,x)}break;case 4:Es(e,t),zs(t);break;case 13:Es(e,t),zs(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(p1=jr())),n&4&&h_(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(Hn=(c=Hn)||d,Es(e,t),Hn=c):Es(e,t),zs(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(qe=t,d=t.child;d!==null;){for(h=qe=d;qe!==null;){switch(p=qe,g=p.child,p.tag){case 0:case 11:case 14:case 15:uf(4,p,p.return);break;case 1:Ac(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){n=p,r=p.return;try{e=n,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(x){Nr(n,r,x)}}break;case 5:Ac(p,p.return);break;case 22:if(p.memoizedState!==null){m_(h);continue}}g!==null?(g.return=p,qe=g):m_(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{i=h.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Tw("display",a))}catch(x){Nr(t,t.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(x){Nr(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Es(e,t),zs(t),n&4&&h_(t);break;case 21:break;default:Es(e,t),zs(t)}}function zs(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(YT(r)){var n=r;break e}r=r.return}throw Error(Oe(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Cf(i,""),n.flags&=-33);var s=d_(t);Hg(t,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=d_(t);Wg(t,o,a);break;default:throw Error(Oe(161))}}catch(l){Nr(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function pb(t,e,r){qe=t,JT(t)}function JT(t,e,r){for(var n=(t.mode&1)!==0;qe!==null;){var i=qe,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||xd;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||Hn;o=xd;var c=Hn;if(xd=a,(Hn=l)&&!c)for(qe=i;qe!==null;)a=qe,l=a.child,a.tag===22&&a.memoizedState!==null?g_(i):l!==null?(l.return=a,qe=l):g_(i);for(;s!==null;)qe=s,JT(s),s=s.sibling;qe=i,xd=o,Hn=c}p_(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,qe=s):p_(t)}}function p_(t){for(;qe!==null;){var e=qe;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Hn||vp(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Hn)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:Ts(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Jy(e,s,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Jy(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Rf(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Oe(163))}Hn||e.flags&512&&zg(e)}catch(p){Nr(e,e.return,p)}}if(e===t){qe=null;break}if(r=e.sibling,r!==null){r.return=e.return,qe=r;break}qe=e.return}}function m_(t){for(;qe!==null;){var e=qe;if(e===t){qe=null;break}var r=e.sibling;if(r!==null){r.return=e.return,qe=r;break}qe=e.return}}function g_(t){for(;qe!==null;){var e=qe;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{vp(4,e)}catch(l){Nr(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){Nr(e,i,l)}}var s=e.return;try{zg(e)}catch(l){Nr(e,s,l)}break;case 5:var a=e.return;try{zg(e)}catch(l){Nr(e,a,l)}}}catch(l){Nr(e,e.return,l)}if(e===t){qe=null;break}var o=e.sibling;if(o!==null){o.return=e.return,qe=o;break}qe=e.return}}var mb=Math.ceil,Fh=Va.ReactCurrentDispatcher,d1=Va.ReactCurrentOwner,cs=Va.ReactCurrentBatchConfig,Rt=0,hn=null,Xr=null,In=0,Di=0,kc=Ho(0),tn=0,zf=null,wl=0,yp=0,h1=0,ff=null,yi=null,p1=0,qc=1/0,xa=null,Ih=!1,$g=null,ko=null,vd=!1,go=null,bh=0,df=0,Gg=null,Qd=-1,Jd=0;function ci(){return Rt&6?jr():Qd!==-1?Qd:Qd=jr()}function Co(t){return t.mode&1?Rt&2&&In!==0?In&-In:JI.transition!==null?(Jd===0&&(Jd=Mw()),Jd):(t=Kt,t!==0||(t=window.event,t=t===void 0?16:Ww(t.type)),t):1}function bs(t,e,r,n){if(50<df)throw df=0,Gg=null,Error(Oe(185));p0(t,r,n),(!(Rt&2)||t!==hn)&&(t===hn&&(!(Rt&2)&&(yp|=r),tn===4&&co(t,In)),Ti(t,n),r===1&&Rt===0&&!(e.mode&1)&&(qc=jr()+500,mp&&$o()))}function Ti(t,e){var r=t.callbackNode;JF(t,e);var n=hh(t,t===hn?In:0);if(n===0)r!==null&&Ay(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&Ay(r),e===1)t.tag===0?QI(x_.bind(null,t)):lT(x_.bind(null,t)),KI(function(){!(Rt&6)&&$o()}),r=null;else{switch(Lw(n)){case 1:r=Vx;break;case 4:r=Pw;break;case 16:r=dh;break;case 536870912:r=Ow;break;default:r=dh}r=aS(r,ZT.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function ZT(t,e){if(Qd=-1,Jd=0,Rt&6)throw Error(Oe(327));var r=t.callbackNode;if(Oc()&&t.callbackNode!==r)return null;var n=hh(t,t===hn?In:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Rh(t,n);else{e=n;var i=Rt;Rt|=2;var s=tS();(hn!==t||In!==e)&&(xa=null,qc=jr()+500,fl(t,e));do try{vb();break}catch(o){eS(t,o)}while(!0);Zx(),Fh.current=s,Rt=i,Xr!==null?e=0:(hn=null,In=0,e=tn)}if(e!==0){if(e===2&&(i=yg(t),i!==0&&(n=i,e=Kg(t,i))),e===1)throw r=zf,fl(t,0),co(t,n),Ti(t,jr()),r;if(e===6)co(t,n);else{if(i=t.current.alternate,!(n&30)&&!gb(i)&&(e=Rh(t,n),e===2&&(s=yg(t),s!==0&&(n=s,e=Kg(t,s))),e===1))throw r=zf,fl(t,0),co(t,n),Ti(t,jr()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(Oe(345));case 2:rl(t,yi,xa);break;case 3:if(co(t,n),(n&130023424)===n&&(e=p1+500-jr(),10<e)){if(hh(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){ci(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Cg(rl.bind(null,t,yi,xa),e);break}rl(t,yi,xa);break;case 4:if(co(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var a=31-Is(n);s=1<<a,a=e[a],a>i&&(i=a),n&=~s}if(n=i,n=jr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*mb(n/1960))-n,10<n){t.timeoutHandle=Cg(rl.bind(null,t,yi,xa),n);break}rl(t,yi,xa);break;case 5:rl(t,yi,xa);break;default:throw Error(Oe(329))}}}return Ti(t,jr()),t.callbackNode===r?ZT.bind(null,t):null}function Kg(t,e){var r=ff;return t.current.memoizedState.isDehydrated&&(fl(t,e).flags|=256),t=Rh(t,e),t!==2&&(e=yi,yi=r,e!==null&&Xg(e)),t}function Xg(t){yi===null?yi=t:yi.push.apply(yi,t)}function gb(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Ds(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function co(t,e){for(e&=~h1,e&=~yp,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Is(e),n=1<<r;t[r]=-1,e&=~n}}function x_(t){if(Rt&6)throw Error(Oe(327));Oc();var e=hh(t,0);if(!(e&1))return Ti(t,jr()),null;var r=Rh(t,e);if(t.tag!==0&&r===2){var n=yg(t);n!==0&&(e=n,r=Kg(t,n))}if(r===1)throw r=zf,fl(t,0),co(t,e),Ti(t,jr()),r;if(r===6)throw Error(Oe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,rl(t,yi,xa),Ti(t,jr()),null}function m1(t,e){var r=Rt;Rt|=1;try{return t(e)}finally{Rt=r,Rt===0&&(qc=jr()+500,mp&&$o())}}function Tl(t){go!==null&&go.tag===0&&!(Rt&6)&&Oc();var e=Rt;Rt|=1;var r=cs.transition,n=Kt;try{if(cs.transition=null,Kt=1,t)return t()}finally{Kt=n,cs.transition=r,Rt=e,!(Rt&6)&&$o()}}function g1(){Di=kc.current,cr(kc)}function fl(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,GI(r)),Xr!==null)for(r=Xr.return;r!==null;){var n=r;switch(qx(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&vh();break;case 3:Xc(),cr(Ei),cr(Yn),s1();break;case 5:i1(n);break;case 4:Xc();break;case 13:cr(wr);break;case 19:cr(wr);break;case 10:e1(n.type._context);break;case 22:case 23:g1()}r=r.return}if(hn=t,Xr=t=Fo(t.current,null),In=Di=e,tn=0,zf=null,h1=yp=wl=0,yi=ff=null,ol!==null){for(e=0;e<ol.length;e++)if(r=ol[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}ol=null}return t}function eS(t,e){do{var r=Xr;try{if(Zx(),Xd.current=Ch,kh){for(var n=Ar.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}kh=!1}if(El=0,un=Jr=Ar=null,cf=!1,jf=0,d1.current=null,r===null||r.return===null){tn=1,zf=e,Xr=null;break}e:{var s=t,a=r.return,o=r,l=e;if(e=In,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,d=o,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var g=i_(a);if(g!==null){g.flags&=-257,s_(g,a,o,s,e),g.mode&1&&n_(s,c,e),e=g,l=c;var y=e.updateQueue;if(y===null){var x=new Set;x.add(l),e.updateQueue=x}else y.add(l);break e}else{if(!(e&1)){n_(s,c,e),x1();break e}l=Error(Oe(426))}}else if(xr&&o.mode&1){var E=i_(a);if(E!==null){!(E.flags&65536)&&(E.flags|=256),s_(E,a,o,s,e),Qx(Yc(l,o));break e}}s=l=Yc(l,o),tn!==4&&(tn=2),ff===null?ff=[s]:ff.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var T=LT(s,l,e);Qy(s,T);break e;case 1:o=l;var A=s.type,_=s.stateNode;if(!(s.flags&128)&&(typeof A.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(ko===null||!ko.has(_)))){s.flags|=65536,e&=-e,s.lanes|=e;var O=BT(s,o,e);Qy(s,O);break e}}s=s.return}while(s!==null)}nS(r)}catch(H){e=H,Xr===r&&r!==null&&(Xr=r=r.return);continue}break}while(!0)}function tS(){var t=Fh.current;return Fh.current=Ch,t===null?Ch:t}function x1(){(tn===0||tn===3||tn===2)&&(tn=4),hn===null||!(wl&268435455)&&!(yp&268435455)||co(hn,In)}function Rh(t,e){var r=Rt;Rt|=2;var n=tS();(hn!==t||In!==e)&&(xa=null,fl(t,e));do try{xb();break}catch(i){eS(t,i)}while(!0);if(Zx(),Rt=r,Fh.current=n,Xr!==null)throw Error(Oe(261));return hn=null,In=0,tn}function xb(){for(;Xr!==null;)rS(Xr)}function vb(){for(;Xr!==null&&!WF();)rS(Xr)}function rS(t){var e=sS(t.alternate,t,Di);t.memoizedProps=t.pendingProps,e===null?nS(t):Xr=e,d1.current=null}function nS(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=fb(r,e),r!==null){r.flags&=32767,Xr=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{tn=6,Xr=null;return}}else if(r=ub(r,e,Di),r!==null){Xr=r;return}if(e=e.sibling,e!==null){Xr=e;return}Xr=e=t}while(e!==null);tn===0&&(tn=5)}function rl(t,e,r){var n=Kt,i=cs.transition;try{cs.transition=null,Kt=1,yb(t,e,r,n)}finally{cs.transition=i,Kt=n}return null}function yb(t,e,r,n){do Oc();while(go!==null);if(Rt&6)throw Error(Oe(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Oe(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(ZF(t,s),t===hn&&(Xr=hn=null,In=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||vd||(vd=!0,aS(dh,function(){return Oc(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=cs.transition,cs.transition=null;var a=Kt;Kt=1;var o=Rt;Rt|=4,d1.current=null,hb(t,r),QT(r,t),jI(Ag),ph=!!Sg,Ag=Sg=null,t.current=r,pb(r),HF(),Rt=o,Kt=a,cs.transition=s}else t.current=r;if(vd&&(vd=!1,go=t,bh=i),s=t.pendingLanes,s===0&&(ko=null),KF(r.stateNode),Ti(t,jr()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Ih)throw Ih=!1,t=$g,$g=null,t;return bh&1&&t.tag!==0&&Oc(),s=t.pendingLanes,s&1?t===Gg?df++:(df=0,Gg=t):df=0,$o(),null}function Oc(){if(go!==null){var t=Lw(bh),e=cs.transition,r=Kt;try{if(cs.transition=null,Kt=16>t?16:t,go===null)var n=!1;else{if(t=go,go=null,bh=0,Rt&6)throw Error(Oe(331));var i=Rt;for(Rt|=4,qe=t.current;qe!==null;){var s=qe,a=s.child;if(qe.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(qe=c;qe!==null;){var d=qe;switch(d.tag){case 0:case 11:case 15:uf(8,d,s)}var h=d.child;if(h!==null)h.return=d,qe=h;else for(;qe!==null;){d=qe;var p=d.sibling,g=d.return;if(XT(d),d===c){qe=null;break}if(p!==null){p.return=g,qe=p;break}qe=g}}}var y=s.alternate;if(y!==null){var x=y.child;if(x!==null){y.child=null;do{var E=x.sibling;x.sibling=null,x=E}while(x!==null)}}qe=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,qe=a;else e:for(;qe!==null;){if(s=qe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:uf(9,s,s.return)}var T=s.sibling;if(T!==null){T.return=s.return,qe=T;break e}qe=s.return}}var A=t.current;for(qe=A;qe!==null;){a=qe;var _=a.child;if(a.subtreeFlags&2064&&_!==null)_.return=a,qe=_;else e:for(a=A;qe!==null;){if(o=qe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:vp(9,o)}}catch(H){Nr(o,o.return,H)}if(o===a){qe=null;break e}var O=o.sibling;if(O!==null){O.return=o.return,qe=O;break e}qe=o.return}}if(Rt=i,$o(),Qs&&typeof Qs.onPostCommitFiberRoot=="function")try{Qs.onPostCommitFiberRoot(up,t)}catch{}n=!0}return n}finally{Kt=r,cs.transition=e}}return!1}function v_(t,e,r){e=Yc(r,e),e=LT(t,e,1),t=Ao(t,e,1),e=ci(),t!==null&&(p0(t,1,e),Ti(t,e))}function Nr(t,e,r){if(t.tag===3)v_(t,t,r);else for(;e!==null;){if(e.tag===3){v_(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(ko===null||!ko.has(n))){t=Yc(r,t),t=BT(e,t,1),e=Ao(e,t,1),t=ci(),e!==null&&(p0(e,1,t),Ti(e,t));break}}e=e.return}}function _b(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=ci(),t.pingedLanes|=t.suspendedLanes&r,hn===t&&(In&r)===r&&(tn===4||tn===3&&(In&130023424)===In&&500>jr()-p1?fl(t,0):h1|=r),Ti(t,e)}function iS(t,e){e===0&&(t.mode&1?(e=ld,ld<<=1,!(ld&130023424)&&(ld=4194304)):e=1);var r=ci();t=Na(t,e),t!==null&&(p0(t,e,r),Ti(t,r))}function Eb(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),iS(t,r)}function wb(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Oe(314))}n!==null&&n.delete(e),iS(t,r)}var sS;sS=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ei.current)_i=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return _i=!1,cb(t,e,r);_i=!!(t.flags&131072)}else _i=!1,xr&&e.flags&1048576&&cT(e,Eh,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;qd(t,e),t=e.pendingProps;var i=$c(e,Yn.current);Pc(e,r),i=o1(null,e,n,t,i,r);var s=l1();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,wi(n)?(s=!0,yh(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,r1(e),i.updater=xp,e.stateNode=i,i._reactInternals=e,Pg(e,n,t,r),e=Lg(null,e,n,!0,s,r)):(e.tag=0,xr&&s&&Yx(e),ai(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(qd(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=Sb(n),t=Ts(n,t),i){case 0:e=Mg(null,e,n,t,r);break e;case 1:e=l_(null,e,n,t,r);break e;case 11:e=a_(null,e,n,t,r);break e;case 14:e=o_(null,e,n,Ts(n.type,t),r);break e}throw Error(Oe(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Ts(n,i),Mg(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Ts(n,i),l_(t,e,n,i,r);case 3:e:{if(zT(e),t===null)throw Error(Oe(387));n=e.pendingProps,s=e.memoizedState,i=s.element,mT(t,e),Sh(e,n,null,r);var a=e.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Yc(Error(Oe(423)),e),e=c_(t,e,n,r,i);break e}else if(n!==i){i=Yc(Error(Oe(424)),e),e=c_(t,e,n,r,i);break e}else for(Bi=So(e.stateNode.containerInfo.firstChild),ji=e,xr=!0,As=null,r=hT(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Gc(),n===i){e=Da(t,e,r);break e}ai(t,e,n,r)}e=e.child}return e;case 5:return gT(e),t===null&&Rg(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,kg(n,i)?a=null:s!==null&&kg(n,s)&&(e.flags|=32),UT(t,e),ai(t,e,a,r),e.child;case 6:return t===null&&Rg(e),null;case 13:return WT(t,e,r);case 4:return n1(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Kc(e,null,n,r):ai(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Ts(n,i),a_(t,e,n,i,r);case 7:return ai(t,e,e.pendingProps,r),e.child;case 8:return ai(t,e,e.pendingProps.children,r),e.child;case 12:return ai(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,rr(wh,n._currentValue),n._currentValue=a,s!==null)if(Ds(s.value,a)){if(s.children===i.children&&!Ei.current){e=Da(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Aa(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Ng(s.return,r,e),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(Oe(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Ng(a,r,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}ai(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,Pc(e,r),i=fs(i),n=n(i),e.flags|=1,ai(t,e,n,r),e.child;case 14:return n=e.type,i=Ts(n,e.pendingProps),i=Ts(n.type,i),o_(t,e,n,i,r);case 15:return jT(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Ts(n,i),qd(t,e),e.tag=1,wi(n)?(t=!0,yh(e)):t=!1,Pc(e,r),MT(e,n,i),Pg(e,n,i,r),Lg(null,e,n,!0,t,r);case 19:return HT(t,e,r);case 22:return VT(t,e,r)}throw Error(Oe(156,e.tag))};function aS(t,e){return Dw(t,e)}function Tb(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ls(t,e,r,n){return new Tb(t,e,r,n)}function v1(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Sb(t){if(typeof t=="function")return v1(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Lx)return 11;if(t===Bx)return 14}return 2}function Fo(t,e){var r=t.alternate;return r===null?(r=ls(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Zd(t,e,r,n,i,s){var a=2;if(n=t,typeof t=="function")v1(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case gc:return dl(r.children,i,s,e);case Mx:a=8,i|=8;break;case ig:return t=ls(12,r,e,i|2),t.elementType=ig,t.lanes=s,t;case sg:return t=ls(13,r,e,i),t.elementType=sg,t.lanes=s,t;case ag:return t=ls(19,r,e,i),t.elementType=ag,t.lanes=s,t;case gw:return _p(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case pw:a=10;break e;case mw:a=9;break e;case Lx:a=11;break e;case Bx:a=14;break e;case ao:a=16,n=null;break e}throw Error(Oe(130,t==null?t:typeof t,""))}return e=ls(a,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function dl(t,e,r,n){return t=ls(7,t,n,e),t.lanes=r,t}function _p(t,e,r,n){return t=ls(22,t,n,e),t.elementType=gw,t.lanes=r,t.stateNode={isHidden:!1},t}function Em(t,e,r){return t=ls(6,t,null,e),t.lanes=r,t}function wm(t,e,r){return e=ls(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Ab(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=rm(0),this.expirationTimes=rm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rm(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function y1(t,e,r,n,i,s,a,o,l){return t=new Ab(t,e,r,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=ls(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},r1(s),t}function kb(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:mc,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function oS(t){if(!t)return Oo;t=t._reactInternals;e:{if(Ml(t)!==t||t.tag!==1)throw Error(Oe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(wi(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Oe(171))}if(t.tag===1){var r=t.type;if(wi(r))return oT(t,r,e)}return e}function lS(t,e,r,n,i,s,a,o,l){return t=y1(r,n,!0,t,i,s,a,o,l),t.context=oS(null),r=t.current,n=ci(),i=Co(r),s=Aa(n,i),s.callback=e??null,Ao(r,s,i),t.current.lanes=i,p0(t,i,n),Ti(t,n),t}function Ep(t,e,r,n){var i=e.current,s=ci(),a=Co(i);return r=oS(r),e.context===null?e.context=r:e.pendingContext=r,e=Aa(s,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Ao(i,e,a),t!==null&&(bs(t,i,a,s),Kd(t,i,a)),a}function Nh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function y_(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function _1(t,e){y_(t,e),(t=t.alternate)&&y_(t,e)}function Cb(){return null}var cS=typeof reportError=="function"?reportError:function(t){console.error(t)};function E1(t){this._internalRoot=t}wp.prototype.render=E1.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Oe(409));Ep(t,e,null,null)};wp.prototype.unmount=E1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Tl(function(){Ep(null,t,null,null)}),e[Ra]=null}};function wp(t){this._internalRoot=t}wp.prototype.unstable_scheduleHydration=function(t){if(t){var e=Vw();t={blockedOn:null,target:t,priority:e};for(var r=0;r<lo.length&&e!==0&&e<lo[r].priority;r++);lo.splice(r,0,t),r===0&&zw(t)}};function w1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Tp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function __(){}function Fb(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=Nh(a);s.call(c)}}var a=lS(e,n,t,0,null,!1,!1,"",__);return t._reactRootContainer=a,t[Ra]=a.current,Pf(t.nodeType===8?t.parentNode:t),Tl(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=Nh(l);o.call(c)}}var l=y1(t,0,!1,null,null,!1,!1,"",__);return t._reactRootContainer=l,t[Ra]=l.current,Pf(t.nodeType===8?t.parentNode:t),Tl(function(){Ep(e,l,r,n)}),l}function Sp(t,e,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=Nh(a);o.call(l)}}Ep(e,a,t,i)}else a=Fb(r,e,t,i,n);return Nh(a)}Bw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Xu(e.pendingLanes);r!==0&&(Ux(e,r|1),Ti(e,jr()),!(Rt&6)&&(qc=jr()+500,$o()))}break;case 13:Tl(function(){var n=Na(t,1);if(n!==null){var i=ci();bs(n,t,1,i)}}),_1(t,1)}};zx=function(t){if(t.tag===13){var e=Na(t,134217728);if(e!==null){var r=ci();bs(e,t,134217728,r)}_1(t,134217728)}};jw=function(t){if(t.tag===13){var e=Co(t),r=Na(t,e);if(r!==null){var n=ci();bs(r,t,e,n)}_1(t,e)}};Vw=function(){return Kt};Uw=function(t,e){var r=Kt;try{return Kt=t,e()}finally{Kt=r}};gg=function(t,e,r){switch(e){case"input":if(cg(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=pp(n);if(!i)throw Error(Oe(90));vw(n),cg(n,i)}}}break;case"textarea":_w(t,r);break;case"select":e=r.value,e!=null&&bc(t,!!r.multiple,e,!1)}};Cw=m1;Fw=Tl;var Ib={usingClientEntryPoint:!1,Events:[g0,_c,pp,Aw,kw,m1]},Vu={findFiberByHostInstance:al,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},bb={bundleType:Vu.bundleType,version:Vu.version,rendererPackageName:Vu.rendererPackageName,rendererConfig:Vu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Va.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Rw(t),t===null?null:t.stateNode},findFiberByHostInstance:Vu.findFiberByHostInstance||Cb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yd.isDisabled&&yd.supportsFiber)try{up=yd.inject(bb),Qs=yd}catch{}}Wi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ib;Wi.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!w1(e))throw Error(Oe(200));return kb(t,e,null,r)};Wi.createRoot=function(t,e){if(!w1(t))throw Error(Oe(299));var r=!1,n="",i=cS;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=y1(t,1,!1,null,null,r,!1,n,i),t[Ra]=e.current,Pf(t.nodeType===8?t.parentNode:t),new E1(e)};Wi.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Oe(188)):(t=Object.keys(t).join(","),Error(Oe(268,t)));return t=Rw(e),t=t===null?null:t.stateNode,t};Wi.flushSync=function(t){return Tl(t)};Wi.hydrate=function(t,e,r){if(!Tp(e))throw Error(Oe(200));return Sp(null,t,e,!0,r)};Wi.hydrateRoot=function(t,e,r){if(!w1(t))throw Error(Oe(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=cS;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=lS(e,null,t,1,r??null,i,!1,s,a),t[Ra]=e.current,Pf(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new wp(e)};Wi.render=function(t,e,r){if(!Tp(e))throw Error(Oe(200));return Sp(null,t,e,!1,r)};Wi.unmountComponentAtNode=function(t){if(!Tp(t))throw Error(Oe(40));return t._reactRootContainer?(Tl(function(){Sp(null,null,t,!1,function(){t._reactRootContainer=null,t[Ra]=null})}),!0):!1};Wi.unstable_batchedUpdates=m1;Wi.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Tp(r))throw Error(Oe(200));if(t==null||t._reactInternals===void 0)throw Error(Oe(38));return Sp(t,e,r,!1,n)};Wi.version="18.3.1-next-f1338f8080-20240426";function uS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(uS)}catch(t){console.error(t)}}uS(),uw.exports=Wi;var Rb=uw.exports,E_=Rb;rg.createRoot=E_.createRoot,rg.hydrateRoot=E_.hydrateRoot;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Dh={};Dh.version="0.18.5";var fS=1252,Nb=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],T1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},S1=function(t){Nb.indexOf(t)!=-1&&(fS=T1[0]=t)};function Db(){S1(1252)}var ks=function(t){S1(t)};function A1(){ks(1200),Db()}function w_(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function Pb(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function dS(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var qu=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?Pb(t.slice(2)):e==254&&r==255?dS(t.slice(2)):e==65279?t.slice(1):t},_d=function(e){return String.fromCharCode(e)},T_=function(e){return String.fromCharCode(e)},Wf,xo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Hf(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),s=r>>2,n=t.charCodeAt(c++),a=(r&3)<<4|n>>4,i=t.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=xo.charAt(s)+xo.charAt(a)+xo.charAt(o)+xo.charAt(l);return e}function zi(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)s=xo.indexOf(t.charAt(c++)),a=xo.indexOf(t.charAt(c++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=xo.indexOf(t.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=xo.indexOf(t.charAt(c++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var yt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ua=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Mo(t){return yt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function S_(t){return yt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Mi=function(e){return yt?Ua(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Ap(t){if(typeof ArrayBuffer>"u")return Mi(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Go(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function Ob(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function k1(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return k1(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var fn=yt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Ua(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Mb(t){for(var e=[],r=0,n=t.length+250,i=Mo(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Mo(65535),n=65530)}return e.push(i.slice(0,r)),fn(e)}var ui=/\u0000/g,Qu=/[\u0001-\u0006]/g;function Mc(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Cs(t,e){var r=""+t;return r.length>=e?r:Dr("0",e-r.length)+r}function C1(t,e){var r=""+t;return r.length>=e?r:Dr(" ",e-r.length)+r}function Ph(t,e){var r=""+t;return r.length>=e?r:r+Dr(" ",e-r.length)}function Lb(t,e){var r=""+Math.round(t);return r.length>=e?r:Dr("0",e-r.length)+r}function Bb(t,e){var r=""+t;return r.length>=e?r:Dr("0",e-r.length)+r}var A_=Math.pow(2,32);function lc(t,e){if(t>A_||t<-A_)return Lb(t,e);var r=Math.round(t);return Bb(r,e)}function Oh(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var k_=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Tm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function jb(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var at={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},C_={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Vb={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Mh(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,l=1,c=0,d=0,h=Math.floor(i);c<e&&(h=Math.floor(i),o=h*a+s,d=h*c+l,!(i-h<5e-8));)i=1/(i-h),s=a,a=o,l=c,c=d;if(d>e&&(c>e?(d=l,o=s):(d=c,o=a)),!r)return[0,n*o,d];var p=Math.floor(n*o/d);return[p,n*o-p*d,d]}function cl(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=Gb(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var hS=new Date(1899,11,31,0,0,0),Ub=hS.getTime(),zb=new Date(1900,2,1,0,0,0);function pS(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=zb&&(r+=24*60*60*1e3),(r-(Ub+(t.getTimezoneOffset()-hS.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function F1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Wb(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Hb(t){var e=t<0?12:11,r=F1(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function $b(t){var e=F1(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function $f(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=Hb(t):e===10?r=t.toFixed(10).substr(0,12):r=$b(t),F1(Wb(r.toUpperCase()))}function Sl(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):$f(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return hs(14,pS(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function Gb(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function Kb(t,e,r,n){var i="",s=0,a=0,o=r.y,l,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return Tm[r.m-1][1];case 5:return Tm[r.m-1][0];default:return Tm[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return k_[r.q][0];default:return k_[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Cs(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=Cs(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var d=c>0?Cs(l,c):"";return d}function vo(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var mS=/%/g;function Xb(t,e,r){var n=e.replace(mS,""),i=e.length-n.length;return ka(t,n,r*Math.pow(10,2*i))+Dr("%",i)}function Yb(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ka(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function gS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+gS(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,d){return l+c+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var xS=/# (\?+)( ?)\/( ?)(\d+)/;function qb(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?Dr(" ",t[1].length+1+t[4].length):C1(a,t[1].length)+t[2]+"/"+t[3]+Cs(o,t[4].length))}function Qb(t,e,r){return r+(e===0?"":""+e)+Dr(" ",t[1].length+2+t[4].length)}var vS=/^#*0*\.([0#]+)/,yS=/\).*[0#]/,_S=/\(###\) ###\\?-####/;function oi(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function F_(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function I_(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Jb(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function Zb(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function es(t,e,r){if(t.charCodeAt(0)===40&&!e.match(yS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?es("n",n,r):"("+es("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Yb(t,e,r);if(e.indexOf("%")!==-1)return Xb(t,e,r);if(e.indexOf("E")!==-1)return gS(e,r);if(e.charCodeAt(0)===36)return"$"+es(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+lc(l,e.length);if(e.match(/^[#?]+$/))return i=lc(r,0),i==="0"&&(i=""),i.length>e.length?i:oi(e.substr(0,e.length-i.length))+i;if(s=e.match(xS))return qb(s,l,c);if(e.match(/^#+0+$/))return c+lc(l,e.length-e.indexOf("0"));if(s=e.match(vS))return i=F_(r,s[1].length).replace(/^([^\.]+)$/,"$1."+oi(s[1])).replace(/\.$/,"."+oi(s[1])).replace(/\.(\d*)$/,function(y,x){return"."+x+Dr("0",oi(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+F_(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+vo(lc(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+es(t,e,-r):vo(""+(Math.floor(r)+Jb(r,s[1].length)))+"."+Cs(I_(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return es(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Mc(es(t,e.replace(/[\\-]/g,""),r)),a=0,Mc(Mc(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match(_S))return i=es(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Mh(l,Math.pow(10,a)-1,!1),i=""+c,d=ka("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=Ph(o[2],a),d.length<s[4].length&&(d=oi(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Mh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?C1(o[1],a)+s[2]+"/"+s[3]+Ph(o[2],a):Dr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=lc(r,0),e.length<=i.length?i:oi(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,p=e.length-i.length-h;return oi(e.substr(0,h)+i+e.substr(e.length-p))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=I_(r,s[1].length),r<0?"-"+es(t,e,-r):vo(Zb(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Cs(0,3-y.length):"")+y})+"."+Cs(a,s[1].length);switch(e){case"###,##0.00":return es(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=vo(lc(l,0));return g!=="0"?c+g:"";case"###,###.00":return es(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return es(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function eR(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ka(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function tR(t,e,r){var n=e.replace(mS,""),i=e.length-n.length;return ka(t,n,r*Math.pow(10,2*i))+Dr("%",i)}function ES(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+ES(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,d){return l+c+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Gs(t,e,r){if(t.charCodeAt(0)===40&&!e.match(yS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Gs("n",n,r):"("+Gs("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return eR(t,e,r);if(e.indexOf("%")!==-1)return tR(t,e,r);if(e.indexOf("E")!==-1)return ES(e,r);if(e.charCodeAt(0)===36)return"$"+Gs(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+Cs(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:oi(e.substr(0,e.length-i.length))+i;if(s=e.match(xS))return Qb(s,l,c);if(e.match(/^#+0+$/))return c+Cs(l,e.length-e.indexOf("0"));if(s=e.match(vS))return i=(""+r).replace(/^([^\.]+)$/,"$1."+oi(s[1])).replace(/\.$/,"."+oi(s[1])),i=i.replace(/\.(\d*)$/,function(y,x){return"."+x+Dr("0",oi(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+vo(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Gs(t,e,-r):vo(""+r)+"."+Dr("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Gs(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Mc(Gs(t,e.replace(/[\\-]/g,""),r)),a=0,Mc(Mc(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match(_S))return i=Gs(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Mh(l,Math.pow(10,a)-1,!1),i=""+c,d=ka("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=Ph(o[2],a),d.length<s[4].length&&(d=oi(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Mh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?C1(o[1],a)+s[2]+"/"+s[3]+Ph(o[2],a):Dr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:oi(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,p=e.length-i.length-h;return oi(e.substr(0,h)+i+e.substr(e.length-p))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Gs(t,e,-r):vo(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Cs(0,3-y.length):"")+y})+"."+Cs(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var g=vo(""+l);return g!=="0"?c+g:"";default:if(e.match(/\.[0#?]*$/))return Gs(t,e.slice(0,e.lastIndexOf(".")),r)+oi(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function ka(t,e,r){return(r|0)===r?Gs(t,e,r):es(t,e,r)}function rR(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var wS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function du(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Oh(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(wS))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function nR(t,e,r,n){for(var i=[],s="",a=0,o="",l="t",c,d,h,p="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!Oh(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(h=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++a;break;case"\\":var g=t.charAt(++a),y=g==="("||g===")"?g:"t";i[i.length]={t:y,v:g},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(c==null&&(c=cl(e,r,t.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=cl(e,r),c==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var x={t:o,v:o};if(c==null&&(c=cl(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(x.v=c.H>=12?"P":"A"),x.t="T",p="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(x.v=c.H>=12?"PM":"AM"),x.t="T",a+=5,p="h"):t.substr(a,5).toUpperCase()==="/"?(c!=null&&(x.v=c.H>=12?"":""),x.t="T",a+=5,p="h"):(x.t="t",++a),c==null&&x.t==="T")return"";i[i.length]=x,l=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(wS)){if(c==null&&(c=cl(e,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",du(t)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var E=0,T=0,A;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=p,l="h",E<1&&(E=1);break;case"s":(A=i[a].v.match(/\.0+$/))&&(T=Math.max(T,A[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&i[a].v.match(/[Hh]/)&&(E=1),E<2&&i[a].v.match(/[Mm]/)&&(E=2),E<3&&i[a].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var _="",O;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=Kb(i[a].t.charCodeAt(0),i[a].v,c,T),i[a].t="t";break;case"n":case"?":for(O=a+1;i[O]!=null&&((o=i[O].t)==="?"||o==="D"||(o===" "||o==="t")&&i[O+1]!=null&&(i[O+1].t==="?"||i[O+1].t==="t"&&i[O+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[O].v==="/"||i[O].v===" "&&i[O+1]!=null&&i[O+1].t=="?"));)i[a].v+=i[O].v,i[O]={v:"",t:";"},++O;_+=i[a].v,a=O-1;break;case"G":i[a].t="t",i[a].v=Sl(e,r);break}var H="",j,w;if(_.length>0){_.charCodeAt(0)==40?(j=e<0&&_.charCodeAt(0)===45?-e:e,w=ka("n",_,j)):(j=e<0&&n>1?-e:e,w=ka("n",_,j),j<0&&i[0]&&i[0].t=="t"&&(w=w.substr(1),i[0].v="-"+i[0].v)),O=w.length-1;var F=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){F=a;break}var S=i.length;if(F===i.length&&w.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(O>=i[a].v.length-1?(O-=i[a].v.length,i[a].v=w.substr(O+1,i[a].v.length)):O<0?i[a].v="":(i[a].v=w.substr(0,O+1),O=-1),i[a].t="t",S=a);O>=0&&S<i.length&&(i[S].v=w.substr(0,O+1)+i[S].v)}else if(F!==i.length&&w.indexOf("E")===-1){for(O=w.indexOf(".")-1,a=F;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(d=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")-1:i[a].v.length-1,H=i[a].v.substr(d+1);d>=0;--d)O>=0&&(i[a].v.charAt(d)==="0"||i[a].v.charAt(d)==="#")&&(H=w.charAt(O--)+H);i[a].v=H,i[a].t="t",S=a}for(O>=0&&S<i.length&&(i[S].v=w.substr(0,O+1)+i[S].v),O=w.indexOf(".")+1,a=F;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==F)){for(d=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")+1:0,H=i[a].v.substr(0,d);d<i[a].v.length;++d)O<w.length&&(H+=w.charAt(O++));i[a].v=H,i[a].t="t",S=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(j=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=ka(i[a].t,i[a].v,j),i[a].t="t");var b="";for(a=0;a!==i.length;++a)i[a]!=null&&(b+=i[a].v);return b}var b_=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function R_(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function iR(t,e){var r=rR(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(b_),o=r[1].match(b_);return R_(e,a)?[n,r[0]]:R_(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function hs(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:at)[t],n==null&&(n=r.table&&r.table[C_[t]]||at[C_[t]]),n==null&&(n=Vb[t]||"General");break}if(Oh(n,0))return Sl(e,r);e instanceof Date&&(e=pS(e,r.date1904));var i=iR(n,e);if(Oh(i[1]))return Sl(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return nR(i[1],e,r,i[0])}function Ca(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(at[r]==null){e<0&&(e=r);continue}if(at[r]==t){e=r;break}}e<0&&(e=391)}return at[e]=t,e}function kp(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Ca(t[e],e)}function hu(){at=jb()}var sR={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},TS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function aR(t){var e=typeof t=="number"?at[t]:t;return e=e.replace(TS,"(\\d+)"),new RegExp("^"+e+"$")}function oR(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(TS)||[]).forEach(function(h,p){var g=parseInt(r[p+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=g;break;case"d":s=g;break;case"h":a=g;break;case"s":l=g;break;case"m":a>=0?o=g:i=g;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var d=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&s==-1?d:c+"T"+d}var lR=function(){var t={};t.version="1.2.0";function e(){for(var w=0,F=new Array(256),S=0;S!=256;++S)w=S,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,F[S]=w;return typeof Int32Array<"u"?new Int32Array(F):F}var r=e();function n(w){var F=0,S=0,b=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(b=0;b!=256;++b)D[b]=w[b];for(b=0;b!=256;++b)for(S=w[b],F=256+b;F<4096;F+=256)S=D[F]=S>>>8^w[S&255];var P=[];for(b=1;b!=16;++b)P[b-1]=typeof Int32Array<"u"?D.subarray(b*256,b*256+256):D.slice(b*256,b*256+256);return P}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],d=i[5],h=i[6],p=i[7],g=i[8],y=i[9],x=i[10],E=i[11],T=i[12],A=i[13],_=i[14];function O(w,F){for(var S=F^-1,b=0,D=w.length;b<D;)S=S>>>8^r[(S^w.charCodeAt(b++))&255];return~S}function H(w,F){for(var S=F^-1,b=w.length-15,D=0;D<b;)S=_[w[D++]^S&255]^A[w[D++]^S>>8&255]^T[w[D++]^S>>16&255]^E[w[D++]^S>>>24]^x[w[D++]]^y[w[D++]]^g[w[D++]]^p[w[D++]]^h[w[D++]]^d[w[D++]]^c[w[D++]]^l[w[D++]]^o[w[D++]]^a[w[D++]]^s[w[D++]]^r[w[D++]];for(b+=15;D<b;)S=S>>>8^r[(S^w[D++])&255];return~S}function j(w,F){for(var S=F^-1,b=0,D=w.length,P=0,N=0;b<D;)P=w.charCodeAt(b++),P<128?S=S>>>8^r[(S^P)&255]:P<2048?(S=S>>>8^r[(S^(192|P>>6&31))&255],S=S>>>8^r[(S^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,N=w.charCodeAt(b++)&1023,S=S>>>8^r[(S^(240|P>>8&7))&255],S=S>>>8^r[(S^(128|P>>2&63))&255],S=S>>>8^r[(S^(128|N>>6&15|(P&3)<<4))&255],S=S>>>8^r[(S^(128|N&63))&255]):(S=S>>>8^r[(S^(224|P>>12&15))&255],S=S>>>8^r[(S^(128|P>>6&63))&255],S=S>>>8^r[(S^(128|P&63))&255]);return~S}return t.table=r,t.bstr=O,t.buf=H,t.str=j,t}(),et=function(){var e={};e.version="1.2.1";function r(I,z){for(var B=I.split("/"),L=z.split("/"),W=0,U=0,le=Math.min(B.length,L.length);W<le;++W){if(U=B[W].length-L[W].length)return U;if(B[W]!=L[W])return B[W]<L[W]?-1:1}return B.length-L.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var z=I.lastIndexOf("/");return z===-1?I:I.slice(0,z+1)}function i(I){if(I.charAt(I.length-1)=="/")return i(I.slice(0,-1));var z=I.lastIndexOf("/");return z===-1?I:I.slice(z+1)}function s(I,z){typeof z=="string"&&(z=new Date(z));var B=z.getHours();B=B<<6|z.getMinutes(),B=B<<5|z.getSeconds()>>>1,I.write_shift(2,B);var L=z.getFullYear()-1980;L=L<<4|z.getMonth()+1,L=L<<5|z.getDate(),I.write_shift(2,L)}function a(I){var z=I.read_shift(2)&65535,B=I.read_shift(2)&65535,L=new Date,W=B&31;B>>>=5;var U=B&15;B>>>=4,L.setMilliseconds(0),L.setFullYear(B+1980),L.setMonth(U-1),L.setDate(W);var le=z&31;z>>>=5;var ne=z&63;return z>>>=6,L.setHours(z),L.setMinutes(ne),L.setSeconds(le<<1),L}function o(I){kn(I,0);for(var z={},B=0;I.l<=I.length-4;){var L=I.read_shift(2),W=I.read_shift(2),U=I.l+W,le={};switch(L){case 21589:B=I.read_shift(1),B&1&&(le.mtime=I.read_shift(4)),W>5&&(B&2&&(le.atime=I.read_shift(4)),B&4&&(le.ctime=I.read_shift(4))),le.mtime&&(le.mt=new Date(le.mtime*1e3));break}I.l=U,z[L]=le}return z}var l;function c(){return l||(l={})}function d(I,z){if(I[0]==80&&I[1]==75)return ca(I,z);if((I[0]|32)==109&&(I[1]|32)==105)return er(I,z);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var B=3,L=512,W=0,U=0,le=0,ne=0,oe=0,te=[],ce=I.slice(0,512);kn(ce,0);var xe=h(ce);switch(B=xe[0],B){case 3:L=512;break;case 4:L=4096;break;case 0:if(xe[1]==0)return ca(I,z);default:throw new Error("Major Version: Expected 3 or 4 saw "+B)}L!==512&&(ce=I.slice(0,L),kn(ce,28));var Me=I.slice(0,L);p(ce,B);var Ge=ce.read_shift(4,"i");if(B===3&&Ge!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ge);ce.l+=4,le=ce.read_shift(4,"i"),ce.l+=4,ce.chk("00100000","Mini Stream Cutoff Size: "),ne=ce.read_shift(4,"i"),W=ce.read_shift(4,"i"),oe=ce.read_shift(4,"i"),U=ce.read_shift(4,"i");for(var Ie=-1,We=0;We<109&&(Ie=ce.read_shift(4,"i"),!(Ie<0));++We)te[We]=Ie;var st=g(I,L);E(oe,U,st,L,te);var Et=A(st,le,te,L);Et[le].name="!Directory",W>0&&ne!==N&&(Et[ne].name="!MiniFAT"),Et[te[0]].name="!FAT",Et.fat_addrs=te,Et.ssz=L;var kt={},wt=[],ei=[],gn=[];_(le,Et,st,wt,W,kt,ei,ne),y(ei,gn,wt),wt.shift();var Fi={FileIndex:ei,FullPaths:gn};return z&&z.raw&&(Fi.raw={header:Me,sectors:st}),Fi}function h(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(ze,"Header Signature: "),I.l+=16;var z=I.read_shift(2,"u");return[I.read_shift(2,"u"),z]}function p(I,z){var B=9;switch(I.l+=2,B=I.read_shift(2)){case 9:if(z!=3)throw new Error("Sector Shift: Expected 9 saw "+B);break;case 12:if(z!=4)throw new Error("Sector Shift: Expected 12 saw "+B);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+B)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function g(I,z){for(var B=Math.ceil(I.length/z)-1,L=[],W=1;W<B;++W)L[W-1]=I.slice(W*z,(W+1)*z);return L[B-1]=I.slice(B*z),L}function y(I,z,B){for(var L=0,W=0,U=0,le=0,ne=0,oe=B.length,te=[],ce=[];L<oe;++L)te[L]=ce[L]=L,z[L]=B[L];for(;ne<ce.length;++ne)L=ce[ne],W=I[L].L,U=I[L].R,le=I[L].C,te[L]===L&&(W!==-1&&te[W]!==W&&(te[L]=te[W]),U!==-1&&te[U]!==U&&(te[L]=te[U])),le!==-1&&(te[le]=L),W!==-1&&L!=te[L]&&(te[W]=te[L],ce.lastIndexOf(W)<ne&&ce.push(W)),U!==-1&&L!=te[L]&&(te[U]=te[L],ce.lastIndexOf(U)<ne&&ce.push(U));for(L=1;L<oe;++L)te[L]===L&&(U!==-1&&te[U]!==U?te[L]=te[U]:W!==-1&&te[W]!==W&&(te[L]=te[W]));for(L=1;L<oe;++L)if(I[L].type!==0){if(ne=L,ne!=te[ne])do ne=te[ne],z[L]=z[ne]+"/"+z[L];while(ne!==0&&te[ne]!==-1&&ne!=te[ne]);te[L]=-1}for(z[0]+="/",L=1;L<oe;++L)I[L].type!==2&&(z[L]+="/")}function x(I,z,B){for(var L=I.start,W=I.size,U=[],le=L;B&&W>0&&le>=0;)U.push(z.slice(le*P,le*P+P)),W-=P,le=sl(B,le*4);return U.length===0?me(0):fn(U).slice(0,I.size)}function E(I,z,B,L,W){var U=N;if(I===N){if(z!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var le=B[I],ne=(L>>>2)-1;if(!le)return;for(var oe=0;oe<ne&&(U=sl(le,oe*4))!==N;++oe)W.push(U);E(sl(le,L-4),z-1,B,L,W)}}function T(I,z,B,L,W){var U=[],le=[];W||(W=[]);var ne=L-1,oe=0,te=0;for(oe=z;oe>=0;){W[oe]=!0,U[U.length]=oe,le.push(I[oe]);var ce=B[Math.floor(oe*4/L)];if(te=oe*4&ne,L<4+te)throw new Error("FAT boundary crossed: "+oe+" 4 "+L);if(!I[ce])break;oe=sl(I[ce],te)}return{nodes:U,data:W_([le])}}function A(I,z,B,L){var W=I.length,U=[],le=[],ne=[],oe=[],te=L-1,ce=0,xe=0,Me=0,Ge=0;for(ce=0;ce<W;++ce)if(ne=[],Me=ce+z,Me>=W&&(Me-=W),!le[Me]){oe=[];var Ie=[];for(xe=Me;xe>=0;){Ie[xe]=!0,le[xe]=!0,ne[ne.length]=xe,oe.push(I[xe]);var We=B[Math.floor(xe*4/L)];if(Ge=xe*4&te,L<4+Ge)throw new Error("FAT boundary crossed: "+xe+" 4 "+L);if(!I[We]||(xe=sl(I[We],Ge),Ie[xe]))break}U[Me]={nodes:ne,data:W_([oe])}}return U}function _(I,z,B,L,W,U,le,ne){for(var oe=0,te=L.length?2:0,ce=z[I].data,xe=0,Me=0,Ge;xe<ce.length;xe+=128){var Ie=ce.slice(xe,xe+128);kn(Ie,64),Me=Ie.read_shift(2),Ge=O1(Ie,0,Me-te),L.push(Ge);var We={name:Ge,type:Ie.read_shift(1),color:Ie.read_shift(1),L:Ie.read_shift(4,"i"),R:Ie.read_shift(4,"i"),C:Ie.read_shift(4,"i"),clsid:Ie.read_shift(16),state:Ie.read_shift(4,"i"),start:0,size:0},st=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);st!==0&&(We.ct=O(Ie,Ie.l-8));var Et=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);Et!==0&&(We.mt=O(Ie,Ie.l-8)),We.start=Ie.read_shift(4,"i"),We.size=Ie.read_shift(4,"i"),We.size<0&&We.start<0&&(We.size=We.type=0,We.start=N,We.name=""),We.type===5?(oe=We.start,W>0&&oe!==N&&(z[oe].name="!StreamData")):We.size>=4096?(We.storage="fat",z[We.start]===void 0&&(z[We.start]=T(B,We.start,z.fat_addrs,z.ssz)),z[We.start].name=We.name,We.content=z[We.start].data.slice(0,We.size)):(We.storage="minifat",We.size<0?We.size=0:oe!==N&&We.start!==N&&z[oe]&&(We.content=x(We,z[oe].data,(z[ne]||{}).data))),We.content&&kn(We.content,0),U[Ge]=We,le.push(We)}}function O(I,z){return new Date((Oi(I,z+4)/1e7*Math.pow(2,32)+Oi(I,z)/1e7-11644473600)*1e3)}function H(I,z){return c(),d(l.readFileSync(I),z)}function j(I,z){var B=z&&z.type;switch(B||yt&&Buffer.isBuffer(I)&&(B="buffer"),B||"base64"){case"file":return H(I,z);case"base64":return d(Mi(zi(I)),z);case"binary":return d(Mi(I),z)}return d(I,z)}function w(I,z){var B=z||{},L=B.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=L+"/",I.FileIndex[0]={name:L,type:5}),B.CLSID&&(I.FileIndex[0].clsid=B.CLSID),F(I)}function F(I){var z="Sh33tJ5";if(!et.find(I,"/"+z)){var B=me(4);B[0]=55,B[1]=B[3]=50,B[2]=54,I.FileIndex.push({name:z,type:2,content:B,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+z),S(I)}}function S(I,z){w(I);for(var B=!1,L=!1,W=I.FullPaths.length-1;W>=0;--W){var U=I.FileIndex[W];switch(U.type){case 0:L?B=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:L=!0,isNaN(U.R*U.L*U.C)&&(B=!0),U.R>-1&&U.L>-1&&U.R==U.L&&(B=!0);break;default:B=!0;break}}if(!(!B&&!z)){var le=new Date(1987,1,19),ne=0,oe=Object.create?Object.create(null):{},te=[];for(W=0;W<I.FullPaths.length;++W)oe[I.FullPaths[W]]=!0,I.FileIndex[W].type!==0&&te.push([I.FullPaths[W],I.FileIndex[W]]);for(W=0;W<te.length;++W){var ce=n(te[W][0]);L=oe[ce],L||(te.push([ce,{name:i(ce).replace("/",""),type:1,clsid:be,ct:le,mt:le,content:null}]),oe[ce]=!0)}for(te.sort(function(Ge,Ie){return r(Ge[0],Ie[0])}),I.FullPaths=[],I.FileIndex=[],W=0;W<te.length;++W)I.FullPaths[W]=te[W][0],I.FileIndex[W]=te[W][1];for(W=0;W<te.length;++W){var xe=I.FileIndex[W],Me=I.FullPaths[W];if(xe.name=i(Me).replace("/",""),xe.L=xe.R=xe.C=-(xe.color=1),xe.size=xe.content?xe.content.length:0,xe.start=0,xe.clsid=xe.clsid||be,W===0)xe.C=te.length>1?1:-1,xe.size=0,xe.type=5;else if(Me.slice(-1)=="/"){for(ne=W+1;ne<te.length&&n(I.FullPaths[ne])!=Me;++ne);for(xe.C=ne>=te.length?-1:ne,ne=W+1;ne<te.length&&n(I.FullPaths[ne])!=n(Me);++ne);xe.R=ne>=te.length?-1:ne,xe.type=1}else n(I.FullPaths[W+1]||"")==n(Me)&&(xe.R=W+1),xe.type=2}}}function b(I,z){var B=z||{};if(B.fileType=="mad")return hr(I,B);switch(S(I),B.fileType){case"zip":return Gi(I,B)}var L=function(Ge){for(var Ie=0,We=0,st=0;st<Ge.FileIndex.length;++st){var Et=Ge.FileIndex[st];if(Et.content){var kt=Et.content.length;kt>0&&(kt<4096?Ie+=kt+63>>6:We+=kt+511>>9)}}for(var wt=Ge.FullPaths.length+3>>2,ei=Ie+7>>3,gn=Ie+127>>7,Fi=ei+We+wt+gn,xn=Fi+127>>7,Ii=xn<=109?0:Math.ceil((xn-109)/127);Fi+xn+Ii+127>>7>xn;)Ii=++xn<=109?0:Math.ceil((xn-109)/127);var vn=[1,Ii,xn,gn,wt,We,Ie,0];return Ge.FileIndex[0].size=Ie<<6,vn[7]=(Ge.FileIndex[0].start=vn[0]+vn[1]+vn[2]+vn[3]+vn[4]+vn[5])+(vn[6]+7>>3),vn}(I),W=me(L[7]<<9),U=0,le=0;{for(U=0;U<8;++U)W.write_shift(1,ge[U]);for(U=0;U<8;++U)W.write_shift(2,0);for(W.write_shift(2,62),W.write_shift(2,3),W.write_shift(2,65534),W.write_shift(2,9),W.write_shift(2,6),U=0;U<3;++U)W.write_shift(2,0);for(W.write_shift(4,0),W.write_shift(4,L[2]),W.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),W.write_shift(4,0),W.write_shift(4,4096),W.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:N),W.write_shift(4,L[3]),W.write_shift(-4,L[1]?L[0]-1:N),W.write_shift(4,L[1]),U=0;U<109;++U)W.write_shift(-4,U<L[2]?L[1]+U:-1)}if(L[1])for(le=0;le<L[1];++le){for(;U<236+le*127;++U)W.write_shift(-4,U<L[2]?L[1]+U:-1);W.write_shift(-4,le===L[1]-1?N:le+1)}var ne=function(Ge){for(le+=Ge;U<le-1;++U)W.write_shift(-4,U+1);Ge&&(++U,W.write_shift(-4,N))};for(le=U=0,le+=L[1];U<le;++U)W.write_shift(-4,Se.DIFSECT);for(le+=L[2];U<le;++U)W.write_shift(-4,Se.FATSECT);ne(L[3]),ne(L[4]);for(var oe=0,te=0,ce=I.FileIndex[0];oe<I.FileIndex.length;++oe)ce=I.FileIndex[oe],ce.content&&(te=ce.content.length,!(te<4096)&&(ce.start=le,ne(te+511>>9)));for(ne(L[6]+7>>3);W.l&511;)W.write_shift(-4,Se.ENDOFCHAIN);for(le=U=0,oe=0;oe<I.FileIndex.length;++oe)ce=I.FileIndex[oe],ce.content&&(te=ce.content.length,!(!te||te>=4096)&&(ce.start=le,ne(te+63>>6)));for(;W.l&511;)W.write_shift(-4,Se.ENDOFCHAIN);for(U=0;U<L[4]<<2;++U){var xe=I.FullPaths[U];if(!xe||xe.length===0){for(oe=0;oe<17;++oe)W.write_shift(4,0);for(oe=0;oe<3;++oe)W.write_shift(4,-1);for(oe=0;oe<12;++oe)W.write_shift(4,0);continue}ce=I.FileIndex[U],U===0&&(ce.start=ce.size?ce.start-1:N);var Me=U===0&&B.root||ce.name;if(te=2*(Me.length+1),W.write_shift(64,Me,"utf16le"),W.write_shift(2,te),W.write_shift(1,ce.type),W.write_shift(1,ce.color),W.write_shift(-4,ce.L),W.write_shift(-4,ce.R),W.write_shift(-4,ce.C),ce.clsid)W.write_shift(16,ce.clsid,"hex");else for(oe=0;oe<4;++oe)W.write_shift(4,0);W.write_shift(4,ce.state||0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,ce.start),W.write_shift(4,ce.size),W.write_shift(4,0)}for(U=1;U<I.FileIndex.length;++U)if(ce=I.FileIndex[U],ce.size>=4096)if(W.l=ce.start+1<<9,yt&&Buffer.isBuffer(ce.content))ce.content.copy(W,W.l,0,ce.size),W.l+=ce.size+511&-512;else{for(oe=0;oe<ce.size;++oe)W.write_shift(1,ce.content[oe]);for(;oe&511;++oe)W.write_shift(1,0)}for(U=1;U<I.FileIndex.length;++U)if(ce=I.FileIndex[U],ce.size>0&&ce.size<4096)if(yt&&Buffer.isBuffer(ce.content))ce.content.copy(W,W.l,0,ce.size),W.l+=ce.size+63&-64;else{for(oe=0;oe<ce.size;++oe)W.write_shift(1,ce.content[oe]);for(;oe&63;++oe)W.write_shift(1,0)}if(yt)W.l=W.length;else for(;W.l<W.length;)W.write_shift(1,0);return W}function D(I,z){var B=I.FullPaths.map(function(oe){return oe.toUpperCase()}),L=B.map(function(oe){var te=oe.split("/");return te[te.length-(oe.slice(-1)=="/"?2:1)]}),W=!1;z.charCodeAt(0)===47?(W=!0,z=B[0].slice(0,-1)+z):W=z.indexOf("/")!==-1;var U=z.toUpperCase(),le=W===!0?B.indexOf(U):L.indexOf(U);if(le!==-1)return I.FileIndex[le];var ne=!U.match(Qu);for(U=U.replace(ui,""),ne&&(U=U.replace(Qu,"!")),le=0;le<B.length;++le)if((ne?B[le].replace(Qu,"!"):B[le]).replace(ui,"")==U||(ne?L[le].replace(Qu,"!"):L[le]).replace(ui,"")==U)return I.FileIndex[le];return null}var P=64,N=-2,ze="d0cf11e0a1b11ae1",ge=[208,207,17,224,161,177,26,225],be="00000000000000000000000000000000",Se={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:N,FREESECT:-1,HEADER_SIGNATURE:ze,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:be,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ye(I,z,B){c();var L=b(I,B);l.writeFileSync(z,L)}function Q(I){for(var z=new Array(I.length),B=0;B<I.length;++B)z[B]=String.fromCharCode(I[B]);return z.join("")}function Ce(I,z){var B=b(I,z);switch(z&&z.type||"buffer"){case"file":return c(),l.writeFileSync(z.filename,B),B;case"binary":return typeof B=="string"?B:Q(B);case"base64":return Hf(typeof B=="string"?B:Q(B));case"buffer":if(yt)return Buffer.isBuffer(B)?B:Ua(B);case"array":return typeof B=="string"?Mi(B):B}return B}var Be;function V(I){try{var z=I.InflateRaw,B=new z;if(B._processChunk(new Uint8Array([3,0]),B._finishFlushFlag),B.bytesRead)Be=I;else throw new Error("zlib does not expose bytesRead")}catch(L){console.error("cannot use native zlib: "+(L.message||L))}}function G(I,z){if(!Be)return la(I,z);var B=Be.InflateRaw,L=new B,W=L._processChunk(I.slice(I.l),L._finishFlushFlag);return I.l+=L.bytesRead,W}function q(I){return Be?Be.deflateRawSync(I):ct(I)}var Y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],de=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ae=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Pe(I){var z=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(z>>16|z>>8|z)&255}for(var ke=typeof Uint8Array<"u",we=ke?new Uint8Array(256):[],it=0;it<256;++it)we[it]=Pe(it);function K(I,z){var B=we[I&255];return z<=8?B>>>8-z:(B=B<<8|we[I>>8&255],z<=16?B>>>16-z:(B=B<<8|we[I>>16&255],B>>>24-z))}function Bt(I,z){var B=z&7,L=z>>>3;return(I[L]|(B<=6?0:I[L+1]<<8))>>>B&3}function gt(I,z){var B=z&7,L=z>>>3;return(I[L]|(B<=5?0:I[L+1]<<8))>>>B&7}function bt(I,z){var B=z&7,L=z>>>3;return(I[L]|(B<=4?0:I[L+1]<<8))>>>B&15}function ht(I,z){var B=z&7,L=z>>>3;return(I[L]|(B<=3?0:I[L+1]<<8))>>>B&31}function $e(I,z){var B=z&7,L=z>>>3;return(I[L]|(B<=1?0:I[L+1]<<8))>>>B&127}function Zt(I,z,B){var L=z&7,W=z>>>3,U=(1<<B)-1,le=I[W]>>>L;return B<8-L||(le|=I[W+1]<<8-L,B<16-L)||(le|=I[W+2]<<16-L,B<24-L)||(le|=I[W+3]<<24-L),le&U}function pn(I,z,B){var L=z&7,W=z>>>3;return L<=5?I[W]|=(B&7)<<L:(I[W]|=B<<L&255,I[W+1]=(B&7)>>8-L),z+3}function Yr(I,z,B){var L=z&7,W=z>>>3;return B=(B&1)<<L,I[W]|=B,z+1}function hi(I,z,B){var L=z&7,W=z>>>3;return B<<=L,I[W]|=B&255,B>>>=8,I[W+1]=B,z+8}function $i(I,z,B){var L=z&7,W=z>>>3;return B<<=L,I[W]|=B&255,B>>>=8,I[W+1]=B&255,I[W+2]=B>>>8,z+16}function pi(I,z){var B=I.length,L=2*B>z?2*B:z+5,W=0;if(B>=z)return I;if(yt){var U=S_(L);if(I.copy)I.copy(U);else for(;W<I.length;++W)U[W]=I[W];return U}else if(ke){var le=new Uint8Array(L);if(le.set)le.set(I);else for(;W<B;++W)le[W]=I[W];return le}return I.length=L,I}function Fr(I){for(var z=new Array(I),B=0;B<I;++B)z[B]=0;return z}function mi(I,z,B){var L=1,W=0,U=0,le=0,ne=0,oe=I.length,te=ke?new Uint16Array(32):Fr(32);for(U=0;U<32;++U)te[U]=0;for(U=oe;U<B;++U)I[U]=0;oe=I.length;var ce=ke?new Uint16Array(oe):Fr(oe);for(U=0;U<oe;++U)te[W=I[U]]++,L<W&&(L=W),ce[U]=0;for(te[0]=0,U=1;U<=L;++U)te[U+16]=ne=ne+te[U-1]<<1;for(U=0;U<oe;++U)ne=I[U],ne!=0&&(ce[U]=te[ne+16]++);var xe=0;for(U=0;U<oe;++U)if(xe=I[U],xe!=0)for(ne=K(ce[U],L)>>L-xe,le=(1<<L+4-xe)-1;le>=0;--le)z[ne|le<<xe]=xe&15|U<<4;return L}var Pt=ke?new Uint16Array(512):Fr(512),vr=ke?new Uint16Array(32):Fr(32);if(!ke){for(var nr=0;nr<512;++nr)Pt[nr]=0;for(nr=0;nr<32;++nr)vr[nr]=0}(function(){for(var I=[],z=0;z<32;z++)I.push(5);mi(I,vr,32);var B=[];for(z=0;z<=143;z++)B.push(8);for(;z<=255;z++)B.push(9);for(;z<=279;z++)B.push(7);for(;z<=287;z++)B.push(8);mi(B,Pt,288)})();var Zn=function(){for(var z=ke?new Uint8Array(32768):[],B=0,L=0;B<Ae.length-1;++B)for(;L<Ae[B+1];++L)z[L]=B;for(;L<32768;++L)z[L]=29;var W=ke?new Uint8Array(259):[];for(B=0,L=0;B<de.length-1;++B)for(;L<de[B+1];++L)W[L]=B;function U(ne,oe){for(var te=0;te<ne.length;){var ce=Math.min(65535,ne.length-te),xe=te+ce==ne.length;for(oe.write_shift(1,+xe),oe.write_shift(2,ce),oe.write_shift(2,~ce&65535);ce-- >0;)oe[oe.l++]=ne[te++]}return oe.l}function le(ne,oe){for(var te=0,ce=0,xe=ke?new Uint16Array(32768):[];ce<ne.length;){var Me=Math.min(65535,ne.length-ce);if(Me<10){for(te=pn(oe,te,+(ce+Me==ne.length)),te&7&&(te+=8-(te&7)),oe.l=te/8|0,oe.write_shift(2,Me),oe.write_shift(2,~Me&65535);Me-- >0;)oe[oe.l++]=ne[ce++];te=oe.l*8;continue}te=pn(oe,te,+(ce+Me==ne.length)+2);for(var Ge=0;Me-- >0;){var Ie=ne[ce];Ge=(Ge<<5^Ie)&32767;var We=-1,st=0;if((We=xe[Ge])&&(We|=ce&-32768,We>ce&&(We-=32768),We<ce))for(;ne[We+st]==ne[ce+st]&&st<250;)++st;if(st>2){Ie=W[st],Ie<=22?te=hi(oe,te,we[Ie+1]>>1)-1:(hi(oe,te,3),te+=5,hi(oe,te,we[Ie-23]>>5),te+=3);var Et=Ie<8?0:Ie-4>>2;Et>0&&($i(oe,te,st-de[Ie]),te+=Et),Ie=z[ce-We],te=hi(oe,te,we[Ie]>>3),te-=3;var kt=Ie<4?0:Ie-2>>1;kt>0&&($i(oe,te,ce-We-Ae[Ie]),te+=kt);for(var wt=0;wt<st;++wt)xe[Ge]=ce&32767,Ge=(Ge<<5^ne[ce])&32767,++ce;Me-=st-1}else Ie<=143?Ie=Ie+48:te=Yr(oe,te,1),te=hi(oe,te,we[Ie]),xe[Ge]=ce&32767,++ce}te=hi(oe,te,0)-1}return oe.l=(te+7)/8|0,oe.l}return function(oe,te){return oe.length<8?U(oe,te):le(oe,te)}}();function ct(I){var z=me(50+Math.floor(I.length*1.1)),B=Zn(I,z);return z.slice(0,B)}var ir=ke?new Uint16Array(32768):Fr(32768),yr=ke?new Uint16Array(32768):Fr(32768),dr=ke?new Uint16Array(128):Fr(128),Dn=1,ae=1;function zr(I,z){var B=ht(I,z)+257;z+=5;var L=ht(I,z)+1;z+=5;var W=bt(I,z)+4;z+=4;for(var U=0,le=ke?new Uint8Array(19):Fr(19),ne=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],oe=1,te=ke?new Uint8Array(8):Fr(8),ce=ke?new Uint8Array(8):Fr(8),xe=le.length,Me=0;Me<W;++Me)le[Y[Me]]=U=gt(I,z),oe<U&&(oe=U),te[U]++,z+=3;var Ge=0;for(te[0]=0,Me=1;Me<=oe;++Me)ce[Me]=Ge=Ge+te[Me-1]<<1;for(Me=0;Me<xe;++Me)(Ge=le[Me])!=0&&(ne[Me]=ce[Ge]++);var Ie=0;for(Me=0;Me<xe;++Me)if(Ie=le[Me],Ie!=0){Ge=we[ne[Me]]>>8-Ie;for(var We=(1<<7-Ie)-1;We>=0;--We)dr[Ge|We<<Ie]=Ie&7|Me<<3}var st=[];for(oe=1;st.length<B+L;)switch(Ge=dr[$e(I,z)],z+=Ge&7,Ge>>>=3){case 16:for(U=3+Bt(I,z),z+=2,Ge=st[st.length-1];U-- >0;)st.push(Ge);break;case 17:for(U=3+gt(I,z),z+=3;U-- >0;)st.push(0);break;case 18:for(U=11+$e(I,z),z+=7;U-- >0;)st.push(0);break;default:st.push(Ge),oe<Ge&&(oe=Ge);break}var Et=st.slice(0,B),kt=st.slice(B);for(Me=B;Me<286;++Me)Et[Me]=0;for(Me=L;Me<30;++Me)kt[Me]=0;return Dn=mi(Et,ir,286),ae=mi(kt,yr,30),z}function oa(I,z){if(I[0]==3&&!(I[1]&3))return[Mo(z),2];for(var B=0,L=0,W=S_(z||1<<18),U=0,le=W.length>>>0,ne=0,oe=0;!(L&1);){if(L=gt(I,B),B+=3,L>>>1)L>>1==1?(ne=9,oe=5):(B=zr(I,B),ne=Dn,oe=ae);else{B&7&&(B+=8-(B&7));var te=I[B>>>3]|I[(B>>>3)+1]<<8;if(B+=32,te>0)for(!z&&le<U+te&&(W=pi(W,U+te),le=W.length);te-- >0;)W[U++]=I[B>>>3],B+=8;continue}for(;;){!z&&le<U+32767&&(W=pi(W,U+32767),le=W.length);var ce=Zt(I,B,ne),xe=L>>>1==1?Pt[ce]:ir[ce];if(B+=xe&15,xe>>>=4,!(xe>>>8&255))W[U++]=xe;else{if(xe==256)break;xe-=257;var Me=xe<8?0:xe-4>>2;Me>5&&(Me=0);var Ge=U+de[xe];Me>0&&(Ge+=Zt(I,B,Me),B+=Me),ce=Zt(I,B,oe),xe=L>>>1==1?vr[ce]:yr[ce],B+=xe&15,xe>>>=4;var Ie=xe<4?0:xe-2>>1,We=Ae[xe];for(Ie>0&&(We+=Zt(I,B,Ie),B+=Ie),!z&&le<Ge&&(W=pi(W,Ge+100),le=W.length);U<Ge;)W[U]=W[U-We],++U}}}return z?[W,B+7>>>3]:[W.slice(0,U),B+7>>>3]}function la(I,z){var B=I.slice(I.l||0),L=oa(B,z);return I.l+=L[1],L[0]}function Os(I,z){if(I)typeof console<"u"&&console.error(z);else throw new Error(z)}function ca(I,z){var B=I;kn(B,0);var L=[],W=[],U={FileIndex:L,FullPaths:W};w(U,{root:z.root});for(var le=B.length-4;(B[le]!=80||B[le+1]!=75||B[le+2]!=5||B[le+3]!=6)&&le>=0;)--le;B.l=le+4,B.l+=4;var ne=B.read_shift(2);B.l+=6;var oe=B.read_shift(4);for(B.l=oe,le=0;le<ne;++le){B.l+=20;var te=B.read_shift(4),ce=B.read_shift(4),xe=B.read_shift(2),Me=B.read_shift(2),Ge=B.read_shift(2);B.l+=8;var Ie=B.read_shift(4),We=o(B.slice(B.l+xe,B.l+xe+Me));B.l+=xe+Me+Ge;var st=B.l;B.l=Ie+4,ki(B,te,ce,U,We),B.l=st}return U}function ki(I,z,B,L,W){I.l+=2;var U=I.read_shift(2),le=I.read_shift(2),ne=a(I);if(U&8257)throw new Error("Unsupported ZIP encryption");for(var oe=I.read_shift(4),te=I.read_shift(4),ce=I.read_shift(4),xe=I.read_shift(2),Me=I.read_shift(2),Ge="",Ie=0;Ie<xe;++Ie)Ge+=String.fromCharCode(I[I.l++]);if(Me){var We=o(I.slice(I.l,I.l+Me));(We[21589]||{}).mt&&(ne=We[21589].mt),((W||{})[21589]||{}).mt&&(ne=W[21589].mt)}I.l+=Me;var st=I.slice(I.l,I.l+te);switch(le){case 8:st=G(I,ce);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+le)}var Et=!1;U&8&&(oe=I.read_shift(4),oe==134695760&&(oe=I.read_shift(4),Et=!0),te=I.read_shift(4),ce=I.read_shift(4)),te!=z&&Os(Et,"Bad compressed size: "+z+" != "+te),ce!=B&&Os(Et,"Bad uncompressed size: "+B+" != "+ce),mn(L,Ge,st,{unsafe:!0,mt:ne})}function Gi(I,z){var B=z||{},L=[],W=[],U=me(1),le=B.compression?8:0,ne=0,oe=0,te=0,ce=0,xe=0,Me=I.FullPaths[0],Ge=Me,Ie=I.FileIndex[0],We=[],st=0;for(oe=1;oe<I.FullPaths.length;++oe)if(Ge=I.FullPaths[oe].slice(Me.length),Ie=I.FileIndex[oe],!(!Ie.size||!Ie.content||Ge=="Sh33tJ5")){var Et=ce,kt=me(Ge.length);for(te=0;te<Ge.length;++te)kt.write_shift(1,Ge.charCodeAt(te)&127);kt=kt.slice(0,kt.l),We[xe]=lR.buf(Ie.content,0);var wt=Ie.content;le==8&&(wt=q(wt)),U=me(30),U.write_shift(4,67324752),U.write_shift(2,20),U.write_shift(2,ne),U.write_shift(2,le),Ie.mt?s(U,Ie.mt):U.write_shift(4,0),U.write_shift(-4,We[xe]),U.write_shift(4,wt.length),U.write_shift(4,Ie.content.length),U.write_shift(2,kt.length),U.write_shift(2,0),ce+=U.length,L.push(U),ce+=kt.length,L.push(kt),ce+=wt.length,L.push(wt),U=me(46),U.write_shift(4,33639248),U.write_shift(2,0),U.write_shift(2,20),U.write_shift(2,ne),U.write_shift(2,le),U.write_shift(4,0),U.write_shift(-4,We[xe]),U.write_shift(4,wt.length),U.write_shift(4,Ie.content.length),U.write_shift(2,kt.length),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(4,0),U.write_shift(4,Et),st+=U.l,W.push(U),st+=kt.length,W.push(kt),++xe}return U=me(22),U.write_shift(4,101010256),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,xe),U.write_shift(2,xe),U.write_shift(4,st),U.write_shift(4,ce),U.write_shift(2,0),fn([fn(L),fn(W),U])}var _r={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ki(I,z){if(I.ctype)return I.ctype;var B=I.name||"",L=B.match(/\.([^\.]+)$/);return L&&_r[L[1]]||z&&(L=(B=z).match(/[\.\\]([^\.\\])+$/),L&&_r[L[1]])?_r[L[1]]:"application/octet-stream"}function ua(I){for(var z=Hf(I),B=[],L=0;L<z.length;L+=76)B.push(z.slice(L,L+76));return B.join(`\r
`)+`\r
`}function $a(I){var z=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(te){var ce=te.charCodeAt(0).toString(16).toUpperCase();return"="+(ce.length==1?"0"+ce:ce)});z=z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),z.charAt(0)==`
`&&(z="=0D"+z.slice(1)),z=z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var B=[],L=z.split(`\r
`),W=0;W<L.length;++W){var U=L[W];if(U.length==0){B.push("");continue}for(var le=0;le<U.length;){var ne=76,oe=U.slice(le,le+ne);oe.charAt(ne-1)=="="?ne--:oe.charAt(ne-2)=="="?ne-=2:oe.charAt(ne-3)=="="&&(ne-=3),oe=U.slice(le,le+ne),le+=ne,le<U.length&&(oe+="="),B.push(oe)}}return B.join(`\r
`)}function Pn(I){for(var z=[],B=0;B<I.length;++B){for(var L=I[B];B<=I.length&&L.charAt(L.length-1)=="=";)L=L.slice(0,L.length-1)+I[++B];z.push(L)}for(var W=0;W<z.length;++W)z[W]=z[W].replace(/[=][0-9A-Fa-f]{2}/g,function(U){return String.fromCharCode(parseInt(U.slice(1),16))});return Mi(z.join(`\r
`))}function Ms(I,z,B){for(var L="",W="",U="",le,ne=0;ne<10;++ne){var oe=z[ne];if(!oe||oe.match(/^\s*$/))break;var te=oe.match(/^(.*?):\s*([^\s].*)$/);if(te)switch(te[1].toLowerCase()){case"content-location":L=te[2].trim();break;case"content-type":U=te[2].trim();break;case"content-transfer-encoding":W=te[2].trim();break}}switch(++ne,W.toLowerCase()){case"base64":le=Mi(zi(z.slice(ne).join("")));break;case"quoted-printable":le=Pn(z.slice(ne));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+W)}var ce=mn(I,L.slice(B.length),le,{unsafe:!0});U&&(ce.ctype=U)}function er(I,z){if(Q(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var B=z&&z.root||"",L=(yt&&Buffer.isBuffer(I)?I.toString("binary"):Q(I)).split(`\r
`),W=0,U="";for(W=0;W<L.length;++W)if(U=L[W],!!/^Content-Location:/i.test(U)&&(U=U.slice(U.indexOf("file")),B||(B=U.slice(0,U.lastIndexOf("/")+1)),U.slice(0,B.length)!=B))for(;B.length>0&&(B=B.slice(0,B.length-1),B=B.slice(0,B.lastIndexOf("/")+1),U.slice(0,B.length)!=B););var le=(L[1]||"").match(/boundary="(.*?)"/);if(!le)throw new Error("MAD cannot find boundary");var ne="--"+(le[1]||""),oe=[],te=[],ce={FileIndex:oe,FullPaths:te};w(ce);var xe,Me=0;for(W=0;W<L.length;++W){var Ge=L[W];Ge!==ne&&Ge!==ne+"--"||(Me++&&Ms(ce,L.slice(xe,W),B),xe=W)}return ce}function hr(I,z){var B=z||{},L=B.boundary||"SheetJS";L="------="+L;for(var W=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+L.slice(2)+'"',"","",""],U=I.FullPaths[0],le=U,ne=I.FileIndex[0],oe=1;oe<I.FullPaths.length;++oe)if(le=I.FullPaths[oe].slice(U.length),ne=I.FileIndex[oe],!(!ne.size||!ne.content||le=="Sh33tJ5")){le=le.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(st){return"_x"+st.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(st){return"_u"+st.charCodeAt(0).toString(16)+"_"});for(var te=ne.content,ce=yt&&Buffer.isBuffer(te)?te.toString("binary"):Q(te),xe=0,Me=Math.min(1024,ce.length),Ge=0,Ie=0;Ie<=Me;++Ie)(Ge=ce.charCodeAt(Ie))>=32&&Ge<128&&++xe;var We=xe>=Me*4/5;W.push(L),W.push("Content-Location: "+(B.root||"file:///C:/SheetJS/")+le),W.push("Content-Transfer-Encoding: "+(We?"quoted-printable":"base64")),W.push("Content-Type: "+Ki(ne,le)),W.push(""),W.push(We?$a(ce):ua(ce))}return W.push(L+`--\r
`),W.join(`\r
`)}function Ci(I){var z={};return w(z,I),z}function mn(I,z,B,L){var W=L&&L.unsafe;W||w(I);var U=!W&&et.find(I,z);if(!U){var le=I.FullPaths[0];z.slice(0,le.length)==le?le=z:(le.slice(-1)!="/"&&(le+="/"),le=(le+z).replace("//","/")),U={name:i(z),type:2},I.FileIndex.push(U),I.FullPaths.push(le),W||et.utils.cfb_gc(I)}return U.content=B,U.size=B?B.length:0,L&&(L.CLSID&&(U.clsid=L.CLSID),L.mt&&(U.mt=L.mt),L.ct&&(U.ct=L.ct)),U}function fa(I,z){w(I);var B=et.find(I,z);if(B){for(var L=0;L<I.FileIndex.length;++L)if(I.FileIndex[L]==B)return I.FileIndex.splice(L,1),I.FullPaths.splice(L,1),!0}return!1}function $l(I,z,B){w(I);var L=et.find(I,z);if(L){for(var W=0;W<I.FileIndex.length;++W)if(I.FileIndex[W]==L)return I.FileIndex[W].name=i(B),I.FullPaths[W]=B,!0}return!1}function ms(I){S(I,!0)}return e.find=D,e.read=j,e.parse=d,e.write=Ce,e.writeFile=ye,e.utils={cfb_new:Ci,cfb_add:mn,cfb_del:fa,cfb_mov:$l,cfb_gc:ms,ReadShift:hf,CheckField:$S,prep_blob:kn,bconcat:fn,use_zlib:V,_deflateRaw:ct,_inflateRaw:la,consts:Se},e}();function cR(t){return typeof t=="string"?Ap(t):Array.isArray(t)?Ob(t):t}function v0(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Ap(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?qs(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([cR(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=Go(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function uR(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Mr(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function N_(t,e){for(var r=[],n=Mr(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function Cp(t){for(var e=[],r=Mr(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Fp(t){for(var e=[],r=Mr(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function fR(t){for(var e=[],r=Mr(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Lh=new Date(1899,11,30,0,0,0);function nn(t,e){var r=t.getTime(),n=Lh.getTime()+(t.getTimezoneOffset()-Lh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var SS=new Date,dR=Lh.getTime()+(SS.getTimezoneOffset()-Lh.getTimezoneOffset())*6e4,D_=SS.getTimezoneOffset();function Ip(t){var e=new Date;return e.setTime(t*24*60*60*1e3+dR),e.getTimezoneOffset()!==D_&&e.setTime(e.getTime()+(e.getTimezoneOffset()-D_)*6e4),e}function hR(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[s],10)}return e}var P_=new Date("2017-02-19T19:06:09.000Z"),AS=isNaN(P_.getFullYear())?new Date("2/19/17"):P_,pR=AS.getFullYear()==2017;function ur(t,e){var r=new Date(t);if(pR)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(AS.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Al(t,e){if(yt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return qs(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return qs(dS(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return qs(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return qs(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function fr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=fr(t[r]));return e}function Dr(t,e){for(var r="";r.length<e;)r+=t;return r}function Rs(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var mR=["january","february","march","april","may","june","july","august","september","october","november","december"];function Qc(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&mR.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var gR=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function kS(t){return t?t.content&&t.type?Al(t.content,!0):t.data?qu(t.data):t.asNodeBuffer&&yt?qu(t.asNodeBuffer().toString("binary")):t.asBinary?qu(t.asBinary()):t._data&&t._data.getContent?qu(Al(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function CS(t){if(!t)return null;if(t.data)return w_(t.data);if(t.asNodeBuffer&&yt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?w_(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function xR(t){return t&&t.name.slice(-4)===".bin"?CS(t):kS(t)}function ns(t,e){for(var r=t.FullPaths||Mr(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function I1(t,e){var r=ns(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Gr(t,e,r){if(!r)return xR(I1(t,e));if(!e)return null;try{return Gr(t,e)}catch{return null}}function Li(t,e,r){if(!r)return kS(I1(t,e));if(!e)return null;try{return Li(t,e)}catch{return null}}function vR(t,e,r){return CS(I1(t,e))}function O_(t){for(var e=t.FullPaths||Mr(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function vt(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return yt?n=Ua(r):n=Mb(r),et.utils.cfb_add(t,e,n)}et.utils.cfb_add(t,e,r)}else t.file(e,r)}function b1(){return et.utils.cfb_new()}function FS(t,e){switch(e.type){case"base64":return et.read(t,{type:"base64"});case"binary":return et.read(t,{type:"binary"});case"buffer":case"array":return et.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Ju(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var Ur=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,yR=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,M_=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,_R=/<[^>]*>/g,Jn=Ur.match(M_)?M_:_R,ER=/<\w*:/,wR=/<(\/?)\w+:/;function lt(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var a=t.match(yR),o=0,l="",c=0,d="",h="",p=1;if(a)for(c=0;c!=a.length;++c){for(h=a[c],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(d=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(p=(i=h.charCodeAt(s+1))==34||i==39?1:0,l=h.slice(s+1+p,h.length-p),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=l,n[d.toLowerCase()]=l;else{var g=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[g]&&d.slice(o-3,o)=="ext")continue;n[g]=l,n[g.toLowerCase()]=l}}return n}function sa(t){return t.replace(wR,"<$1")}var IS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},R1=Cp(IS),Nt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(o,l){return IS[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),N1=/[&<>'"]/g,TR=/[\u0000-\u0008\u000b-\u001f]/g;function Gt(t){var e=t+"";return e.replace(N1,function(r){return R1[r]}).replace(TR,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function L_(t){return Gt(t).replace(/ /g,"_x0020_")}var bS=/[\u0000-\u001f]/g;function D1(t){var e=t+"";return e.replace(N1,function(r){return R1[r]}).replace(/\n/g,"<br/>").replace(bS,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function SR(t){var e=t+"";return e.replace(N1,function(r){return R1[r]}).replace(bS,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var B_=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function AR(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function lr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Sm(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function j_(t){var e=Mo(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function V_(t){return Ua(t,"binary").toString("utf8")}var Ed="foo bar baz",Jt=yt&&(V_(Ed)==Sm(Ed)&&V_||j_(Ed)==Sm(Ed)&&j_)||Sm,qs=yt?function(t){return Ua(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Gf=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),RS=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),kR=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),CR=/<\/?(?:vt:)?variant>/g,FR=/<(?:vt:)([^>]*)>([\s\S]*)</;function U_(t,e){var r=lt(t),n=t.match(kR(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(CR,"").match(FR);a&&i.push({v:Jt(a[2]),t:a[1]})}),i}var NS=/(^\s|\s$|\n)/;function Cn(t,e){return"<"+t+(e.match(NS)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function Kf(t){return Mr(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function je(t,e,r){return"<"+t+(r!=null?Kf(r):"")+(e!=null?(e.match(NS)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Yg(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function IR(t,e){switch(typeof t){case"string":var r=je("vt:lpwstr",Gt(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return je((t|0)==t?"vt:i4":"vt:r8",Gt(String(t)));case"boolean":return je("vt:bool",t?"true":"false")}if(t instanceof Date)return je("vt:filetime",Yg(t));throw new Error("Unable to serialize "+t)}function P1(t){if(yt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Jt(Go(k1(t)));throw new Error("Bad input format: expected Buffer or string")}var Xf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Zr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ll=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Pi={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function bR(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function RR(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var z_=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},W_=yt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Ua(e)})):z_(t)}:z_,H_=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Ea(t,i)));return n.join("").replace(ui,"")},O1=yt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(ui,""):H_(t,e,r)}:H_,$_=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},DS=yt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):$_(t,e,r)}:$_,G_=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(fc(t,i)));return n.join("")},y0=yt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):G_(e,r,n)}:G_,PS=function(t,e){var r=Oi(t,e);return r>0?y0(t,e+4,e+4+r-1):""},OS=PS,MS=function(t,e){var r=Oi(t,e);return r>0?y0(t,e+4,e+4+r-1):""},LS=MS,BS=function(t,e){var r=2*Oi(t,e);return r>0?y0(t,e+4,e+4+r-1):""},jS=BS,VS=function(e,r){var n=Oi(e,r);return n>0?O1(e,r+4,r+4+n):""},US=VS,zS=function(t,e){var r=Oi(t,e);return r>0?y0(t,e+4,e+4+r):""},WS=zS,HS=function(t,e){return bR(t,e)},Bh=HS,M1=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};yt&&(OS=function(e,r){if(!Buffer.isBuffer(e))return PS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},LS=function(e,r){if(!Buffer.isBuffer(e))return MS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},jS=function(e,r){if(!Buffer.isBuffer(e))return BS(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},US=function(e,r){if(!Buffer.isBuffer(e))return VS(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},WS=function(e,r){if(!Buffer.isBuffer(e))return zS(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Bh=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):HS(e,r)},M1=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var fc=function(t,e){return t[e]},Ea=function(t,e){return t[e+1]*256+t[e]},NR=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Oi=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},sl=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},DR=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function hf(t,e){var r="",n,i,s=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,yt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(Ea(this,c)),c+=2;t*=2;break;case"utf8":r=y0(this,this.l,this.l+t);break;case"utf16le":t*=2,r=O1(this,this.l,this.l+t);break;case"wstr":return hf.call(this,t,"dbcs");case"lpstr-ansi":r=OS(this,this.l),t=4+Oi(this,this.l);break;case"lpstr-cp":r=LS(this,this.l),t=4+Oi(this,this.l);break;case"lpwstr":r=jS(this,this.l),t=4+2*Oi(this,this.l);break;case"lpp4":t=4+Oi(this,this.l),r=US(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Oi(this,this.l),r=WS(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=fc(this,this.l+t++))!==0;)s.push(_d(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=Ea(this,this.l+t))!==0;)s.push(_d(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=fc(this,c),this.l=c+1,o=hf.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(_d(Ea(this,c))),c+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=fc(this,c),this.l=c+1,o=hf.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(_d(fc(this,c))),c+=1}r=s.join("");break;default:switch(t){case 1:return n=fc(this,this.l),this.l++,n;case 2:return n=(e==="i"?NR:Ea)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?sl:DR)(this,this.l),this.l+=4,n):(i=Oi(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=Bh(this,this.l):i=Bh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=DS(this,this.l,t);break}}return this.l+=t,r}var PR=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},OR=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},MR=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function LR(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)MR(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,PR(this,e,this.l);break;case 8:if(n=8,r==="f"){RR(this,e,this.l);break}case 16:break;case-4:n=4,OR(this,e,this.l);break}return this.l+=n,this}function $S(t,e){var r=DS(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function kn(t,e){t.l=e,t.read_shift=hf,t.chk=$S,t.write_shift=LR}function qn(t,e){t.l+=e}function me(t){var e=Mo(t);return kn(e,0),e}function za(t,e,r){if(t){var n,i,s;kn(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=e0[o]||e0[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;l=t.l+s;var d=c.f&&c.f(t,s,r);if(t.l=l,e(d,c,o))return}}}function Si(){var t=[],e=yt?256:2048,r=function(c){var d=me(c);return kn(d,0),d},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,e)))},a=function(){return i(),fn(t)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function Ee(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=e0[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&M1(r)&&t.push(r)}}function pf(t,e,r){var n=fr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function K_(t,e,r){var n=fr(t);return n.s=pf(n.s,e.s,r),n.e=pf(n.e,e.s,r),n}function mf(t,e){if(t.cRel&&t.c<0)for(t=fr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=fr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=ot(t);return!t.cRel&&t.cRel!=null&&(r=VR(r)),!t.rRel&&t.rRel!=null&&(r=BR(r)),r}function Am(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Tr(t.s.c)+":"+(t.e.cRel?"":"$")+Tr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Vr(t.s.r)+":"+(t.e.rRel?"":"$")+Vr(t.e.r):mf(t.s,e.biff)+":"+mf(t.e,e.biff)}function L1(t){return parseInt(jR(t),10)-1}function Vr(t){return""+(t+1)}function BR(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function jR(t){return t.replace(/\$(\d+)$/,"$1")}function B1(t){for(var e=UR(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Tr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function VR(t){return t.replace(/^([A-Z])/,"$$$1")}function UR(t){return t.replace(/^\$([A-Z])/,"$1")}function zR(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Sr(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function ot(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Ai(t){var e=t.indexOf(":");return e==-1?{s:Sr(t),e:Sr(t)}:{s:Sr(t.slice(0,e)),e:Sr(t.slice(e+1))}}function xt(t,e){return typeof e>"u"||typeof e=="number"?xt(t.s,t.e):(typeof t!="string"&&(t=ot(t)),typeof e!="string"&&(e=ot(e)),t==e?t:t+":"+e)}function Dt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function X_(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=hs(t.z,r?nn(e):e)}catch{}try{return t.w=hs((t.XF||{}).numFmtId||(r?14:0),r?nn(e):e)}catch{return""+e}}function Pa(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Wa[t.v]||t.v:e==null?X_(t,t.v):X_(t,e))}function Ko(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function GS(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Sr(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=Dt(s["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),a==-1&&(c.e.r=a=d.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=e[h].length;++p)if(!(typeof e[h][p]>"u")){var g={v:e[h][p]},y=a+h,x=o+p;if(c.s.r>y&&(c.s.r=y),c.s.c>x&&(c.s.c=x),c.e.r<y&&(c.e.r=y),c.e.c<x&&(c.e.c=x),e[h][p]&&typeof e[h][p]=="object"&&!Array.isArray(e[h][p])&&!(e[h][p]instanceof Date))g=e[h][p];else if(Array.isArray(g.v)&&(g.f=e[h][p][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(n.nullError)g.t="e",g.v=0;else if(n.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=n.dateNF||at[14],n.cellDates?(g.t="d",g.w=hs(g.z,nn(g.v))):(g.t="n",g.v=nn(g.v),g.w=hs(g.z,g.v))):g.t="s";if(i)s[y]||(s[y]=[]),s[y][x]&&s[y][x].z&&(g.z=s[y][x].z),s[y][x]=g;else{var E=ot({c:x,r:y});s[E]&&s[E].z&&(g.z=s[E].z),s[E]=g}}}return c.s.c<1e7&&(s["!ref"]=xt(c)),s}function pu(t,e){return GS(null,t,e)}function WR(t){return t.read_shift(4,"i")}function Ns(t,e){return e||(e=me(4)),e.write_shift(4,t),e}function Xn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function dn(t,e){var r=!1;return e==null&&(r=!0,e=me(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function HR(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function $R(t,e){return e||(e=me(4)),e.write_shift(2,0),e.write_shift(2,0),e}function j1(t,e){var r=t.l,n=t.read_shift(1),i=Xn(t),s=[],a={t:i,h:i};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)s.push(HR(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function GR(t,e){var r=!1;return e==null&&(r=!0,e=me(15+4*t.t.length)),e.write_shift(1,0),dn(t.t,e),r?e.slice(0,e.l):e}var KR=j1;function XR(t,e){var r=!1;return e==null&&(r=!0,e=me(23+4*t.t.length)),e.write_shift(1,1),dn(t.t,e),e.write_shift(4,1),$R({},e),r?e.slice(0,e.l):e}function ps(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Bl(t,e){return e==null&&(e=me(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function jl(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Vl(t,e){return e==null&&(e=me(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var YR=Xn,KS=dn;function V1(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function jh(t,e){var r=!1;return e==null&&(r=!0,e=me(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var qR=Xn,qg=V1,U1=jh;function z1(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?Bh([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):sl(e,0)>>2;return r?i/100:i}function XS(t,e){e==null&&(e=me(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function YS(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function QR(t,e){return e||(e=me(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Ul=YS,mu=QR;function Kn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function kl(t,e){return(e||me(8)).write_shift(8,t,"f")}function JR(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var c=hl[i];c&&(e.rgb=qf(c));break;case 2:e.rgb=qf([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function Vh(t,e){if(e||(e=me(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function ZR(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function eN(t,e){e||(e=me(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function qS(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function tN(t){return qS(t,1)}function rN(t){return qS(t,2)}var W1=2,vi=3,wd=11,Y_=12,Uh=19,Td=64,nN=65,iN=71,sN=4108,aN=4126,ln=80,QS=81,oN=[ln,QS],Qg={1:{n:"CodePage",t:W1},2:{n:"Category",t:ln},3:{n:"PresentationFormat",t:ln},4:{n:"ByteCount",t:vi},5:{n:"LineCount",t:vi},6:{n:"ParagraphCount",t:vi},7:{n:"SlideCount",t:vi},8:{n:"NoteCount",t:vi},9:{n:"HiddenCount",t:vi},10:{n:"MultimediaClipCount",t:vi},11:{n:"ScaleCrop",t:wd},12:{n:"HeadingPairs",t:sN},13:{n:"TitlesOfParts",t:aN},14:{n:"Manager",t:ln},15:{n:"Company",t:ln},16:{n:"LinksUpToDate",t:wd},17:{n:"CharacterCount",t:vi},19:{n:"SharedDoc",t:wd},22:{n:"HyperlinksChanged",t:wd},23:{n:"AppVersion",t:vi,p:"version"},24:{n:"DigSig",t:nN},26:{n:"ContentType",t:ln},27:{n:"ContentStatus",t:ln},28:{n:"Language",t:ln},29:{n:"Version",t:ln},255:{},2147483648:{n:"Locale",t:Uh},2147483651:{n:"Behavior",t:Uh},1919054434:{}},Jg={1:{n:"CodePage",t:W1},2:{n:"Title",t:ln},3:{n:"Subject",t:ln},4:{n:"Author",t:ln},5:{n:"Keywords",t:ln},6:{n:"Comments",t:ln},7:{n:"Template",t:ln},8:{n:"LastAuthor",t:ln},9:{n:"RevNumber",t:ln},10:{n:"EditTime",t:Td},11:{n:"LastPrinted",t:Td},12:{n:"CreatedDate",t:Td},13:{n:"ModifiedDate",t:Td},14:{n:"PageCount",t:vi},15:{n:"WordCount",t:vi},16:{n:"CharCount",t:vi},17:{n:"Thumbnail",t:iN},18:{n:"Application",t:ln},19:{n:"DocSecurity",t:vi},255:{},2147483648:{n:"Locale",t:Uh},2147483651:{n:"Behavior",t:Uh},1919054434:{}},q_={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},lN=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function cN(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var uN=cN([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),hl=fr(uN),Wa={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},JS={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Zg={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Sd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function H1(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function fN(t){var e=H1();if(!t||!t.match)return e;var r={};if((t.match(Jn)||[]).forEach(function(n){var i=lt(n);switch(i[0].replace(ER,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[Zg[i.ContentType]]!==void 0&&e[Zg[i.ContentType]].push(i.PartName);break}}),e.xmlns!==Zr.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function ZS(t,e){var r=fR(Zg),n=[],i;n[n.length]=Ur,n[n.length]=je("Types",null,{xmlns:Zr.CT,"xmlns:xsd":Zr.xsd,"xmlns:xsi":Zr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return je("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],n[n.length]=je("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Sd[l][e.bookType]||Sd[l].xlsx}))},a=function(l){(t[l]||[]).forEach(function(c){n[n.length]=je("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Sd[l][e.bookType]||Sd[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(c){n[n.length]=je("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var _t={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Yf(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function gf(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Jn)||[]).forEach(function(i){var s=lt(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Ju(s.Target,e);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}function Lc(t){var e=[Ur,je("Relationships",null,{xmlns:Zr.RELS})];return Mr(t["!id"]).forEach(function(r){e[e.length]=je("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function $t(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[_t.HLINK,_t.XPATH,_t.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var dN="application/vnd.oasis.opendocument.spreadsheet";function hN(t,e){for(var r=P1(t),n,i;n=Xf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=lt(n[0],!1),i.path=="/"&&i.type!==dN)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function pN(t){var e=[Ur];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function Q_(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function mN(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function gN(t){var e=[Ur];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(Q_(t[r][0],t[r][1])),e.push(mN("",t[r][0]));return e.push(Q_("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function eA(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Dh.version+"</meta:generator></office:meta></office:document-meta>"}var us=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],xN=function(){for(var t=new Array(us.length),e=0;e<us.length;++e){var r=us[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function tA(t){var e={};t=Jt(t);for(var r=0;r<us.length;++r){var n=us[r],i=t.match(xN[r]);i!=null&&i.length>0&&(e[n[1]]=Nt(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=ur(e[n[1]]))}return e}function km(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=Gt(e),n[n.length]=r?je(t,e,r):Cn(t,e))}function rA(t,e){var r=e||{},n=[Ur,je("cp:coreProperties",null,{"xmlns:cp":Zr.CORE_PROPS,"xmlns:dc":Zr.dc,"xmlns:dcterms":Zr.dcterms,"xmlns:dcmitype":Zr.dcmitype,"xmlns:xsi":Zr.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&km("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Yg(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&km("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Yg(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=us.length;++s){var a=us[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&km(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var pl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],nA=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function iA(t,e,r,n){var i=[];if(typeof t=="string")i=U_(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(d){return{v:d}}));var a=typeof e=="string"?U_(e,n).map(function(d){return d.v}):e,o=0,l=0;if(a.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function vN(t,e,r){var n={};return e||(e={}),t=Jt(t),pl.forEach(function(i){var s=(t.match(Gf(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=Nt(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&iA(n.HeadingPairs,n.TitlesOfParts,e,r),e}function sA(t){var e=[],r=je;return t||(t={}),t.Application="SheetJS",e[e.length]=Ur,e[e.length]=je("Properties",null,{xmlns:Zr.EXT_PROPS,"xmlns:vt":Zr.vt}),pl.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Gt(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Gt(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var yN=/<[^>]+>[^<]*/g;function _N(t,e){var r={},n="",i=t.match(yN);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=lt(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Nt(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),c=l[0].slice(4),d=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=Nt(d);break;case"bool":r[n]=lr(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=ur(d);break;case"cy":case"error":r[n]=Nt(d);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}function aA(t){var e=[Ur,je("Properties",null,{xmlns:Zr.CUST_PROPS,"xmlns:vt":Zr.vt})];if(!t)return e.join("");var r=1;return Mr(t).forEach(function(i){++r,e[e.length]=je("property",IR(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Gt(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var ex={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Cm;function EN(t,e,r){Cm||(Cm=Cp(ex)),e=Cm[e]||e,t[e]=r}function wN(t,e){var r=[];return Mr(ex).map(function(n){for(var i=0;i<us.length;++i)if(us[i][1]==n)return us[i];for(i=0;i<pl.length;++i)if(pl[i][1]==n)return pl[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Cn(ex[n[1]]||n[1],i))}}),je("DocumentProperties",r.join(""),{xmlns:Pi.o})}function TN(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&Mr(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<us.length;++a)if(s==us[a][1])return;for(a=0;a<pl.length;++a)if(s==pl[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(je(L_(s),o,{"dt:dt":l}))}}),e&&Mr(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(je(L_(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Pi.o+'">'+i.join("")+"</"+n+">"}function $1(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function SN(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=me(8);return a.write_shift(4,n),a.write_shift(4,i),a}function oA(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function lA(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function cA(t,e,r){return e===31?lA(t):oA(t,e,r)}function tx(t,e,r){return cA(t,e,r===!1?0:4)}function AN(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return cA(t,e,0)}function kN(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(ui,""),t.l-i&2&&(t.l+=2)}return r}function CN(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(ui,"");return r}function FN(t){var e=t.l,r=zh(t,QS);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=zh(t,vi);return[r,n]}function IN(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(FN(t));return r}function J_(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),a=t.read_shift(4);n[s]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(ui,"").replace(Qu,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function uA(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function bN(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function zh(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==Y_&&n!==e&&oN.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===Y_?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return oA(t,n,4).replace(ui,"");case 31:return lA(t);case 64:return $1(t);case 65:return uA(t);case 71:return bN(t);case 80:return tx(t,n,!s.raw).replace(ui,"");case 81:return AN(t,n).replace(ui,"");case 4108:return IN(t);case 4126:case 4127:return n==4127?kN(t):CN(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function Z_(t,e){var r=me(4),n=me(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=me(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=SN(e);break;case 31:case 80:for(n=me(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return fn([r,n])}function e2(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0,o=0,l=-1,c={};for(a=0;a!=i;++a){var d=t.read_shift(4),h=t.read_shift(4);s[a]=[d,h+r]}s.sort(function(A,_){return A[1]-_[1]});var p={};for(a=0;a!=i;++a){if(t.l!==s[a][1]){var g=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:t.l+2===s[a][1]&&(t.l+=2,g=!1);break;case 80:t.l<=s[a][1]&&(t.l=s[a][1],g=!1);break;case 4108:t.l<=s[a][1]&&(t.l=s[a][1],g=!1);break}if((!e||a==0)&&t.l<=s[a][1]&&(g=!1,t.l=s[a][1]),g)throw new Error("Read Error: Expected address "+s[a][1]+" at "+t.l+" :"+a)}if(e){var y=e[s[a][0]];if(p[y.n]=zh(t,y.t,{raw:!0}),y.p==="version"&&(p[y.n]=String(p[y.n]>>16)+"."+("0000"+String(p[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(p[y.n]){case 0:p[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ks(o=p[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[y.n])}}else if(s[a][0]===1){if(o=p.CodePage=zh(t,W1),ks(o),l!==-1){var x=t.l;t.l=s[l][1],c=J_(t,o),t.l=x}}else if(s[a][0]===0){if(o===0){l=a,t.l=s[a+1][1];continue}c=J_(t,o)}else{var E=c[s[a][0]],T;switch(t[t.l]){case 65:t.l+=4,T=uA(t);break;case 30:t.l+=4,T=tx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,T=tx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,T=t.read_shift(4,"i");break;case 19:t.l+=4,T=t.read_shift(4);break;case 5:t.l+=4,T=t.read_shift(8,"f");break;case 11:t.l+=4,T=Lr(t,4);break;case 64:t.l+=4,T=ur($1(t));break;default:throw new Error("unparsed value: "+t[t.l])}p[E]=T}}return t.l=r+n,p}var fA=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function RN(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function t2(t,e,r){var n=me(8),i=[],s=[],a=8,o=0,l=me(8),c=me(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),a+=8+l.length,!e){c=me(8),c.write_shift(4,0),i.unshift(c);var d=[me(4)];for(d[0].write_shift(4,t.length),o=0;o<t.length;++o){var h=t[o][0];for(l=me(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);d.push(l)}l=fn(d),s.unshift(l),a+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(fA.indexOf(t[o][0])>-1||nA.indexOf(t[o][0])>-1)&&t[o][1]!=null){var p=t[o][1],g=0;if(e){g=+e[t[o][0]];var y=r[g];if(y.p=="version"&&typeof p=="string"){var x=p.split(".");p=(+x[0]<<16)+(+x[1]||0)}l=Z_(y.t,p)}else{var E=RN(p);E==-1&&(E=31,p=String(p)),l=Z_(E,p)}s.push(l),c=me(8),c.write_shift(4,e?g:2+o),i.push(c),a+=8+l.length}var T=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,T),T+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),fn([n].concat(i).concat(s))}function r2(t,e,r){var n=t.content;if(!n)return{};kn(n,0);var i,s,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),d=n.read_shift(16);if(d!==et.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),l=n.read_shift(4));var h=e2(n,e),p={SystemIdentifier:c};for(var g in h)p[g]=h[g];if(p.FMTID=s,i===1)return p;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var y;try{y=e2(n,null)}catch{}for(g in y)p[g]=y[g];return p.FMTID=[s,a],p}function n2(t,e,r,n,i,s){var a=me(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,et.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=t2(t,r,n);if(o.push(l),i){var c=t2(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(c)}return fn(o)}function io(t,e){return t.read_shift(e),null}function NN(t,e){e||(e=me(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function DN(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function Lr(t,e){return t.read_shift(e)===1}function li(t,e){return e||(e=me(2)),e.write_shift(2,+!!t),e}function Kr(t){return t.read_shift(2,"u")}function is(t,e){return e||(e=me(2)),e.write_shift(2,t),e}function dA(t,e){return DN(t,e,Kr)}function PN(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function hA(t,e,r){return r||(r=me(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function _0(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return a}function ON(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,s=1+(r&1),a=0,o,l={};i&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",d=e===0?"":t.read_shift(e,c);return i&&(t.l+=4*a),n&&(t.l+=o),l.t=d,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function MN(t){var e=t.t||"",r=me(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=me(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return fn(i)}function Cl(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function E0(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Cl(t,n,r)}function zl(t,e,r){if(r.biff>5)return E0(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function pA(t,e,r){return r||(r=me(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function LN(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function BN(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(ui,"");return n&&(t.l+=24),i}function jN(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(s>>1,"utf16le").replace(ui,"");return r+a}function VN(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return BN(t);case"0303000000000000c000000000000046":return jN(t);default:throw new Error("Unsupported Moniker "+r)}}function Ad(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(ui,""):"";return r}function i2(t,e){e||(e=me(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function UN(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,a,o,l,c="",d,h;i&16&&(s=Ad(t,r-t.l)),i&128&&(a=Ad(t,r-t.l)),(i&257)===257&&(o=Ad(t,r-t.l)),(i&257)===1&&(l=VN(t,r-t.l)),i&8&&(c=Ad(t,r-t.l)),i&32&&(d=t.read_shift(16)),i&64&&(h=$1(t)),t.l=r;var p=a||o||l||"";p&&c&&(p+="#"+c),p||(p="#"+c),i&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var g={Target:p};return d&&(g.guid=d),h&&(g.time=h),s&&(g.Tooltip=s),g}function zN(t){var e=me(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),i2(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&i2(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function mA(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function gA(t,e){var r=mA(t);return r[3]=0,r}function aa(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Fl(t,e,r,n){return n||(n=me(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function WN(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function HN(t,e,r){return e===0?"":zl(t,e,r)}function $N(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function xA(t){var e=t.read_shift(2),r=z1(t);return[e,r]}function GN(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=_0(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function bp(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function vA(t,e){return e||(e=me(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function yA(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var KN=yA;function _A(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function XN(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function YN(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function jn(t){t.l+=2,t.l+=t.read_shift(2)}var qN={0:jn,4:jn,5:jn,6:jn,7:YN,8:jn,9:jn,10:jn,11:jn,12:jn,13:XN,14:jn,15:jn,16:jn,17:jn,18:jn,19:jn,20:jn,21:_A};function QN(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(qN[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function kd(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function G1(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=me(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function JN(t,e){return e===0||t.read_shift(2),1200}function ZN(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=zl(t,0,r);return t.read_shift(e+n-t.l),i}function e3(t,e){var r=!e||e.biff==8,n=me(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function t3(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function r3(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=_0(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function n3(t,e){var r=!e||e.biff>=8?2:1,n=me(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function i3(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0;a!=i&&t.l<r;++a)s.push(ON(t));return s.Count=n,s.Unique=i,s}function s3(t,e){var r=me(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=MN(t[i]);var s=fn([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function a3(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function o3(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function l3(t){var e=WN(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function c3(t){return t.read_shift(2),t.read_shift(4)}function s2(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function u3(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:c}}function f3(){var t=me(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function d3(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function h3(t){var e=me(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function p3(){}function m3(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=_0(t,0,r),n}function g3(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=me(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function x3(t){var e=aa(t);return e.isst=t.read_shift(4),e}function v3(t,e,r,n){var i=me(10);return Fl(t,e,n,i),i.write_shift(4,r),i}function y3(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=aa(t);r.biff==2&&t.l++;var s=E0(t,n-t.l,r);return i.val=s,i}function _3(t,e,r,n,i){var s=!i||i.biff==8,a=me(8+ +s+(1+s)*r.length);return Fl(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function E3(t,e,r){var n=t.read_shift(2),i=zl(t,0,r);return[n,i]}function w3(t,e,r,n){var i=r&&r.biff==5;n||(n=me(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var T3=zl;function a2(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),a=t.read_shift(i),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:s,c:o},e:{r:a,c:l}}}function S3(t,e){var r=e.biff==8||!e.biff?4:2,n=me(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function A3(t){var e=t.read_shift(2),r=t.read_shift(2),n=xA(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function k3(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(xA(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function C3(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function F3(t,e,r,n){var i={},s=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return i.patternType=lN[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function I3(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=F3(t,e,n.fStyle,r),n}function o2(t,e,r,n){var i=r&&r.biff==5;n||(n=me(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function b3(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function R3(t){var e=me(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function l2(t,e,r){var n=aa(t);(r.biff==2||e==9)&&++t.l;var i=PN(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function N3(t,e,r,n,i,s){var a=me(8);return Fl(t,e,n,a),hA(r,s,a),a}function D3(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=aa(t),i=Kn(t);return n.val=i,n}function P3(t,e,r,n){var i=me(14);return Fl(t,e,n,i),kl(r,i),i}var c2=HN;function O3(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=Cl(t,s),o=[];n>t.l;)o.push(E0(t));return[s,i,a,o]}function u2(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=GN(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var M3=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function f2(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=Cl(t,a,r);i&32&&(c=M3[c.charCodeAt(0)]);var d=n-t.l;r&&r.biff==2&&--d;var h=n==t.l||o===0||!(d>0)?[]:Q8(t,d,r,o);return{chKey:s,Name:c,itab:l,rgce:h}}function EA(t,e,r){if(r.biff<8)return L3(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push($N(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function L3(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=_0(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function B3(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=Cl(t,n,r),a=Cl(t,i,r);return[s,a]}function j3(t,e,r){var n=yA(t);t.l++;var i=t.read_shift(1);return e-=8,[J8(t,e,r),i,n]}function d2(t,e,r){var n=KN(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,Y8(t,e,r)]}function V3(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function U3(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=zl(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},o,a,s]}}function z3(t,e,r){return U3(t,e,r)}function W3(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(bp(t));return r}function H3(t){var e=me(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)vA(t[r],e);return e}function $3(t,e,r){if(r&&r.biff<8)return K3(t,e,r);var n=_A(t),i=QN(t,e-22,n[1]);return{cmo:n,ft:i}}var G3={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function K3(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((G3[n]||qn)(t,e,r)),{cmo:[i,n,s],ft:a}}function X3(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:a=LN(t,6,r);var o=t.read_shift(2);t.read_shift(2),Kr(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var d=t[t.l],h=Cl(t,t.lens[c+1]-t.lens[c]-1);if(i+=h,i.length>=(d?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function Y3(t,e){var r=bp(t);t.l+=16;var n=UN(t,e-24);return[r,n]}function q3(t){var e=me(24),r=Sr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return fn([e,zN(t[1])])}function Q3(t,e){t.read_shift(2);var r=bp(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(ui,""),[r,n]}function J3(t){var e=t[1].Tooltip,r=me(10+2*(e.length+1));r.write_shift(2,2048);var n=Sr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function Z3(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=q_[r]||r,r=t.read_shift(2),e[1]=q_[r]||r,e}function eD(t){return t||(t=me(4)),t.write_shift(2,1),t.write_shift(2,1),t}function tD(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(gA(t));return r}function rD(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(gA(t));return r}function nD(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function wA(t,e,r){if(!r.cellStyles)return qn(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function iD(t,e){var r=me(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function sD(t,e){var r={};return e<32||(t.l+=16,r.header=Kn(t),r.footer=Kn(t),t.l+=2),r}function aD(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}function oD(t){for(var e=me(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var lD=aa,cD=dA,uD=E0;function fD(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function dD(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=aa(t);++t.l;var i=zl(t,e-7,r);return n.t="str",n.val=i,n}function hD(t){var e=aa(t);++t.l;var r=Kn(t);return e.t="n",e.val=r,e}function pD(t,e,r){var n=me(15);return A0(n,t,e),n.write_shift(8,r,"f"),n}function mD(t){var e=aa(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function gD(t,e,r){var n=me(9);return A0(n,t,e),n.write_shift(2,r),n}function xD(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function vD(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function yD(t,e,r){var n=t.l+e,i=aa(t),s=t.read_shift(2),a=Cl(t,s,r);return t.l=n,i.t="str",i.val=a,i}var _D=[2,3,48,49,131,139,140,245],rx=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Cp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],d=Mo(1);switch(l.type){case"base64":d=Mi(zi(o));break;case"binary":d=Mi(o);break;case"buffer":case"array":d=o;break}kn(d,0);var h=d.read_shift(1),p=!!(h&136),g=!1,y=!1;switch(h){case 2:break;case 3:break;case 48:g=!0,p=!0;break;case 49:g=!0,p=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var x=0,E=521;h==2&&(x=d.read_shift(2)),d.l+=3,h!=2&&(x=d.read_shift(4)),x>1048576&&(x=1e6),h!=2&&(E=d.read_shift(2));var T=d.read_shift(2),A=l.codepage||1252;h!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(A=t[d[d.l]]),d.l+=1,d.l+=2),y&&(d.l+=36);for(var _=[],O={},H=Math.min(d.length,h==2?521:E-10-(g?264:0)),j=y?32:11;d.l<H&&d[d.l]!=13;)switch(O={},O.name=Wf.utils.decode(A,d.slice(d.l,d.l+j)).replace(/[\u0000\r\n].*$/g,""),d.l+=j,O.type=String.fromCharCode(d.read_shift(1)),h!=2&&!y&&(O.offset=d.read_shift(4)),O.len=d.read_shift(1),h==2&&(O.offset=d.read_shift(2)),O.dec=d.read_shift(1),O.name.length&&_.push(O),h!=2&&(d.l+=y?13:14),O.type){case"B":(!g||O.len!=8)&&l.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+O.type)}if(d[d.l]!==13&&(d.l=E-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=E;var w=0,F=0;for(c[0]=[],F=0;F!=_.length;++F)c[0][F]=_[F].name;for(;x-- >0;){if(d[d.l]===42){d.l+=T;continue}for(++d.l,c[++w]=[],F=0,F=0;F!=_.length;++F){var S=d.slice(d.l,d.l+_[F].len);d.l+=_[F].len,kn(S,0);var b=Wf.utils.decode(A,S);switch(_[F].type){case"C":b.trim().length&&(c[w][F]=b.replace(/\s+$/,""));break;case"D":b.length===8?c[w][F]=new Date(+b.slice(0,4),+b.slice(4,6)-1,+b.slice(6,8)):c[w][F]=b;break;case"F":c[w][F]=parseFloat(b.trim());break;case"+":case"I":c[w][F]=y?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(b.trim().toUpperCase()){case"Y":case"T":c[w][F]=!0;break;case"N":case"F":c[w][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+b+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[w][F]="##MEMO##"+(y?parseInt(b.trim(),10):S.read_shift(4));break;case"N":b=b.replace(/\u0000/g,"").trim(),b&&b!="."&&(c[w][F]=+b||0);break;case"@":c[w][F]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":c[w][F]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":c[w][F]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[w][F]=-S.read_shift(-8,"f");break;case"B":if(g&&_[F].len==8){c[w][F]=S.read_shift(8,"f");break}case"G":case"P":S.l+=_[F].len;break;case"0":if(_[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[F].type)}}}if(h!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=_,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var d=pu(r(o,c),c);return d["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,d}function i(o,l){try{return Ko(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&ks(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var d=Si(),h=$h(o,{header:1,raw:!0,cellDates:!0}),p=h[0],g=h.slice(1),y=o["!cols"]||[],x=0,E=0,T=0,A=1;for(x=0;x<p.length;++x){if(((y[x]||{}).DBF||{}).name){p[x]=y[x].DBF.name,++T;continue}if(p[x]!=null){if(++T,typeof p[x]=="number"&&(p[x]=p[x].toString(10)),typeof p[x]!="string")throw new Error("DBF Invalid column name "+p[x]+" |"+typeof p[x]+"|");if(p.indexOf(p[x])!==x){for(E=0;E<1024;++E)if(p.indexOf(p[x]+"_"+E)==-1){p[x]+="_"+E;break}}}}var _=Dt(o["!ref"]),O=[],H=[],j=[];for(x=0;x<=_.e.c-_.s.c;++x){var w="",F="",S=0,b=[];for(E=0;E<g.length;++E)g[E][x]!=null&&b.push(g[E][x]);if(b.length==0||p[x]==null){O[x]="?";continue}for(E=0;E<b.length;++E){switch(typeof b[E]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=b[E]instanceof Date?"D":"C";break;default:F="C"}S=Math.max(S,String(b[E]).length),w=w&&w!=F?"C":F}S>250&&(S=250),F=((y[x]||{}).DBF||{}).type,F=="C"&&y[x].DBF.len>S&&(S=y[x].DBF.len),w=="B"&&F=="N"&&(w="N",j[x]=y[x].DBF.dec,S=y[x].DBF.len),H[x]=w=="C"||F=="N"?S:s[w]||0,A+=H[x],O[x]=w}var D=d.next(32);for(D.write_shift(4,318902576),D.write_shift(4,g.length),D.write_shift(2,296+32*T),D.write_shift(2,A),x=0;x<4;++x)D.write_shift(4,0);for(D.write_shift(4,0|(+e[fS]||3)<<8),x=0,E=0;x<p.length;++x)if(p[x]!=null){var P=d.next(32),N=(p[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,N,"sbcs"),P.write_shift(1,O[x]=="?"?"C":O[x],"sbcs"),P.write_shift(4,E),P.write_shift(1,H[x]||s[O[x]]||0),P.write_shift(1,j[x]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),E+=H[x]||s[O[x]]||0}var ze=d.next(264);for(ze.write_shift(4,13),x=0;x<65;++x)ze.write_shift(4,0);for(x=0;x<g.length;++x){var ge=d.next(A);for(ge.write_shift(1,0),E=0;E<p.length;++E)if(p[E]!=null)switch(O[E]){case"L":ge.write_shift(1,g[x][E]==null?63:g[x][E]?84:70);break;case"B":ge.write_shift(8,g[x][E]||0,"f");break;case"N":var be="0";for(typeof g[x][E]=="number"&&(be=g[x][E].toFixed(j[E]||0)),T=0;T<H[E]-be.length;++T)ge.write_shift(1,32);ge.write_shift(1,be,"sbcs");break;case"D":g[x][E]?(ge.write_shift(4,("0000"+g[x][E].getFullYear()).slice(-4),"sbcs"),ge.write_shift(2,("00"+(g[x][E].getMonth()+1)).slice(-2),"sbcs"),ge.write_shift(2,("00"+g[x][E].getDate()).slice(-2),"sbcs")):ge.write_shift(8,"00000000","sbcs");break;case"C":var Se=String(g[x][E]!=null?g[x][E]:"").slice(0,H[E]);for(ge.write_shift(1,Se,"sbcs"),T=0;T<H[E]-Se.length;++T)ge.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),TA=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Mr(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,g){var y=t[g];return typeof y=="number"?T_(y):y},n=function(p,g,y){var x=g.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return x==59?p:T_(x)};t["|"]=254;function i(p,g){switch(g.type){case"base64":return s(zi(p),g);case"binary":return s(p,g);case"buffer":return s(yt&&Buffer.isBuffer(p)?p.toString("binary"):Go(p),g);case"array":return s(Al(p),g)}throw new Error("Unrecognized type "+g.type)}function s(p,g){var y=p.split(/[\n\r]+/),x=-1,E=-1,T=0,A=0,_=[],O=[],H=null,j={},w=[],F=[],S=[],b=0,D;for(+g.codepage>=0&&ks(+g.codepage);T!==y.length;++T){b=0;var P=y[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),N=P.replace(/;;/g,"\0").split(";").map(function(Y){return Y.replace(/\u0000/g,";")}),ze=N[0],ge;if(P.length>0)switch(ze){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":N[1].charAt(0)=="P"&&O.push(P.slice(3).replace(/;;/g,";"));break;case"C":var be=!1,Se=!1,ye=!1,Q=!1,Ce=-1,Be=-1;for(A=1;A<N.length;++A)switch(N[A].charAt(0)){case"A":break;case"X":E=parseInt(N[A].slice(1))-1,Se=!0;break;case"Y":for(x=parseInt(N[A].slice(1))-1,Se||(E=0),D=_.length;D<=x;++D)_[D]=[];break;case"K":ge=N[A].slice(1),ge.charAt(0)==='"'?ge=ge.slice(1,ge.length-1):ge==="TRUE"?ge=!0:ge==="FALSE"?ge=!1:isNaN(Rs(ge))?isNaN(Qc(ge).getDate())||(ge=ur(ge)):(ge=Rs(ge),H!==null&&du(H)&&(ge=Ip(ge))),be=!0;break;case"E":Q=!0;var V=Bc(N[A].slice(1),{r:x,c:E});_[x][E]=[_[x][E],V];break;case"S":ye=!0,_[x][E]=[_[x][E],"S5S"];break;case"G":break;case"R":Ce=parseInt(N[A].slice(1))-1;break;case"C":Be=parseInt(N[A].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+P)}if(be&&(_[x][E]&&_[x][E].length==2?_[x][E][0]=ge:_[x][E]=ge,H=null),ye){if(Q)throw new Error("SYLK shared formula cannot have own formula");var G=Ce>-1&&_[Ce][Be];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");_[x][E][1]=UA(G[1],{r:x-Ce,c:E-Be})}break;case"F":var q=0;for(A=1;A<N.length;++A)switch(N[A].charAt(0)){case"X":E=parseInt(N[A].slice(1))-1,++q;break;case"Y":for(x=parseInt(N[A].slice(1))-1,D=_.length;D<=x;++D)_[D]=[];break;case"M":b=parseInt(N[A].slice(1))/20;break;case"F":break;case"G":break;case"P":H=O[parseInt(N[A].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=N[A].slice(1).split(" "),D=parseInt(S[0],10);D<=parseInt(S[1],10);++D)b=parseInt(S[2],10),F[D-1]=b===0?{hidden:!0}:{wch:b},Lo(F[D-1]);break;case"C":E=parseInt(N[A].slice(1))-1,F[E]||(F[E]={});break;case"R":x=parseInt(N[A].slice(1))-1,w[x]||(w[x]={}),b>0?(w[x].hpt=b,w[x].hpx=Zc(b)):b===0&&(w[x].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+P)}q<1&&(H=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+P)}}return w.length>0&&(j["!rows"]=w),F.length>0&&(j["!cols"]=F),g&&g.sheetRows&&(_=_.slice(0,g.sheetRows)),[_,j]}function a(p,g){var y=i(p,g),x=y[0],E=y[1],T=pu(x,g);return Mr(E).forEach(function(A){T[A]=E[A]}),T}function o(p,g){return Ko(a(p,g),g)}function l(p,g,y,x){var E="C;Y"+(y+1)+";X"+(x+1)+";K";switch(p.t){case"n":E+=p.v||0,p.f&&!p.F&&(E+=";E"+J1(p.f,{r:y,c:x}));break;case"b":E+=p.v?"TRUE":"FALSE";break;case"e":E+=p.w||p.v;break;case"d":E+='"'+(p.w||p.v)+'"';break;case"s":E+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function c(p,g){g.forEach(function(y,x){var E="F;W"+(x+1)+" "+(x+1)+" ";y.hidden?E+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=Qf(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=Jf(y.wpx)),typeof y.wch=="number"&&(E+=Math.round(y.wch))),E.charAt(E.length-1)!=" "&&p.push(E)})}function d(p,g){g.forEach(function(y,x){var E="F;";y.hidden?E+="M0;":y.hpt?E+="M"+20*y.hpt+";":y.hpx&&(E+="M"+20*Zf(y.hpx)+";"),E.length>2&&p.push(E+"R"+(x+1))})}function h(p,g){var y=["ID;PWXL;N;E"],x=[],E=Dt(p["!ref"]),T,A=Array.isArray(p),_=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),p["!cols"]&&c(y,p["!cols"]),p["!rows"]&&d(y,p["!rows"]),y.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var O=E.s.r;O<=E.e.r;++O)for(var H=E.s.c;H<=E.e.c;++H){var j=ot({r:O,c:H});T=A?(p[O]||[])[H]:p[j],!(!T||T.v==null&&(!T.f||T.F))&&x.push(l(T,p,O,H))}return y.join(_)+_+x.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),SA=function(){function t(s,a){switch(a.type){case"base64":return e(zi(s),a);case"binary":return e(s,a);case"buffer":return e(yt&&Buffer.isBuffer(s)?s.toString("binary"):Go(s),a);case"array":return e(Al(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,c=-1,d=0,h=[];d!==o.length;++d){if(o[d].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var p=o[d].trim().split(","),g=p[0],y=p[1];++d;for(var x=o[d]||"";(x.match(/["]/g)||[]).length&1&&d<o.length-1;)x+=`
`+o[++d];switch(x=x.trim(),+g){case-1:if(x==="BOT"){h[++l]=[],c=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?h[l][c]=!0:x==="FALSE"?h[l][c]=!1:isNaN(Rs(y))?isNaN(Qc(y).getDate())?h[l][c]=y:h[l][c]=ur(y):h[l][c]=Rs(y),++c;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),h[l][c++]=x!==""?x:null;break}if(x==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(s,a){return pu(t(s,a),a)}function n(s,a){return Ko(r(s,a),a)}var i=function(){var s=function(l,c,d,h,p){l.push(c),l.push(d+","+h),l.push('"'+p.replace(/"/g,'""')+'"')},a=function(l,c,d,h){l.push(c+","+d),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],d=Dt(l["!ref"]),h,p=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,d.e.r-d.s.r+1,""),s(c,"TUPLES",0,d.e.c-d.s.c+1,""),s(c,"DATA",0,0,"");for(var g=d.s.r;g<=d.e.r;++g){a(c,-1,0,"BOT");for(var y=d.s.c;y<=d.e.c;++y){var x=ot({r:g,c:y});if(h=p?(l[g]||[])[y]:l[x],!h){a(c,1,0,"");continue}switch(h.t){case"n":var E=h.w;!E&&h.v!=null&&(E=h.v),E==null?h.f&&!h.F?a(c,1,0,"="+h.f):a(c,1,0,""):a(c,0,E,"V");break;case"b":a(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=hs(h.z||at[14],nn(ur(h.v)))),a(c,0,h.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var T=`\r
`,A=c.join(T);return A}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),AA=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,p){for(var g=h.split(`
`),y=-1,x=-1,E=0,T=[];E!==g.length;++E){var A=g[E].trim().split(":");if(A[0]==="cell"){var _=Sr(A[1]);if(T.length<=_.r)for(y=T.length;y<=_.r;++y)T[y]||(T[y]=[]);switch(y=_.r,x=_.c,A[2]){case"t":T[y][x]=t(A[3]);break;case"v":T[y][x]=+A[3];break;case"vtf":var O=A[A.length-1];case"vtc":switch(A[3]){case"nl":T[y][x]=!!+A[4];break;default:T[y][x]=+A[4];break}A[2]=="vtf"&&(T[y][x]=[T[y][x],O])}}}return p&&p.sheetRows&&(T=T.slice(0,p.sheetRows)),T}function n(h,p){return pu(r(h,p),p)}function i(h,p){return Ko(n(h,p),p)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var p=[],g=[],y,x="",E=Ai(h["!ref"]),T=Array.isArray(h),A=E.s.r;A<=E.e.r;++A)for(var _=E.s.c;_<=E.e.c;++_)if(x=ot({r:A,c:_}),y=T?(h[A]||[])[_]:h[x],!(!y||y.v==null||y.t==="z")){switch(g=["cell",x,"t"],y.t){case"s":case"str":g.push(e(y.v));break;case"n":y.f?(g[2]="vtf",g[3]="n",g[4]=y.v,g[5]=e(y.f)):(g[2]="v",g[3]=y.v);break;case"b":g[2]="vt"+(y.f?"f":"c"),g[3]="nl",g[4]=y.v?"1":"0",g[5]=e(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var O=nn(ur(y.v));g[2]="vtc",g[3]="nd",g[4]=""+O,g[5]=y.w||hs(y.z||at[14],O);break;case"e":continue}p.push(g.join(":"))}return p.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function d(h){return[s,a,o,a,c(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),Jc=function(){function t(d,h,p,g,y){y.raw?h[p][g]=d:d===""||(d==="TRUE"?h[p][g]=!0:d==="FALSE"?h[p][g]=!1:isNaN(Rs(d))?isNaN(Qc(d).getDate())?h[p][g]=d:h[p][g]=ur(d):h[p][g]=Rs(d))}function e(d,h){var p=h||{},g=[];if(!d||d.length===0)return g;for(var y=d.split(/[\r\n]/),x=y.length-1;x>=0&&y[x].length===0;)--x;for(var E=10,T=0,A=0;A<=x;++A)T=y[A].indexOf(" "),T==-1?T=y[A].length:T++,E=Math.max(E,T);for(A=0;A<=x;++A){g[A]=[];var _=0;for(t(y[A].slice(0,E).trim(),g,A,_,p),_=1;_<=(y[A].length-E)/10+1;++_)t(y[A].slice(E+(_-1)*10,E+_*10).trim(),g,A,_,p)}return p.sheetRows&&(g=g.slice(0,p.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var h={},p=!1,g=0,y=0;g<d.length;++g)(y=d.charCodeAt(g))==34?p=!p:!p&&y in r&&(h[y]=(h[y]||0)+1);y=[];for(g in h)Object.prototype.hasOwnProperty.call(h,g)&&y.push([h[g],g]);if(!y.length){h=n;for(g in h)Object.prototype.hasOwnProperty.call(h,g)&&y.push([h[g],g])}return y.sort(function(x,E){return x[0]-E[0]||n[x[1]]-n[E[1]]}),r[y.pop()[1]]||44}function s(d,h){var p=h||{},g="",y=p.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(g=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(g=d.charAt(4),d=d.slice(6)):g=i(d.slice(0,1024)):p&&p.FS?g=p.FS:g=i(d.slice(0,1024));var E=0,T=0,A=0,_=0,O=0,H=g.charCodeAt(0),j=!1,w=0,F=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var S=p.dateNF!=null?aR(p.dateNF):null;function b(){var D=d.slice(_,O),P={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),D.length===0)P.t="z";else if(p.raw)P.t="s",P.v=D;else if(D.trim().length===0)P.t="s",P.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(P.t="s",P.v=D.slice(2,-1).replace(/""/g,'"')):O6(D)?(P.t="n",P.f=D.slice(1)):(P.t="s",P.v=D);else if(D=="TRUE")P.t="b",P.v=!0;else if(D=="FALSE")P.t="b",P.v=!1;else if(!isNaN(A=Rs(D)))P.t="n",p.cellText!==!1&&(P.w=D),P.v=A;else if(!isNaN(Qc(D).getDate())||S&&D.match(S)){P.z=p.dateNF||at[14];var N=0;S&&D.match(S)&&(D=oR(D,p.dateNF,D.match(S)||[]),N=1),p.cellDates?(P.t="d",P.v=ur(D,N)):(P.t="n",P.v=nn(ur(D,N))),p.cellText!==!1&&(P.w=hs(P.z,P.v instanceof Date?nn(P.v):P.v)),p.cellNF||delete P.z}else P.t="s",P.v=D;if(P.t=="z"||(p.dense?(y[E]||(y[E]=[]),y[E][T]=P):y[ot({c:T,r:E})]=P),_=O+1,F=d.charCodeAt(_),x.e.c<T&&(x.e.c=T),x.e.r<E&&(x.e.r=E),w==H)++T;else if(T=0,++E,p.sheetRows&&p.sheetRows<=E)return!0}e:for(;O<d.length;++O)switch(w=d.charCodeAt(O)){case 34:F===34&&(j=!j);break;case H:case 10:case 13:if(!j&&b())break e;break}return O-_>0&&b(),y["!ref"]=xt(x),y}function a(d,h){return!(h&&h.PRN)||h.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,h):pu(e(d,h),h)}function o(d,h){var p="",g=h.type=="string"?[0,0,0,0]:av(d,h);switch(h.type){case"base64":p=zi(d);break;case"binary":p=d;break;case"buffer":h.codepage==65001?p=d.toString("utf8"):h.codepage&&typeof Wf<"u"||(p=yt&&Buffer.isBuffer(d)?d.toString("binary"):Go(d));break;case"array":p=Al(d);break;case"string":p=d;break;default:throw new Error("Unrecognized type "+h.type)}return g[0]==239&&g[1]==187&&g[2]==191?p=Jt(p.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?p=Jt(p):h.type=="binary"&&typeof Wf<"u",p.slice(0,19)=="socialcalc:version:"?AA.to_sheet(h.type=="string"?p:Jt(p),h):a(p,h)}function l(d,h){return Ko(o(d,h),h)}function c(d){for(var h=[],p=Dt(d["!ref"]),g,y=Array.isArray(d),x=p.s.r;x<=p.e.r;++x){for(var E=[],T=p.s.c;T<=p.e.c;++T){var A=ot({r:x,c:T});if(g=y?(d[x]||[])[T]:d[A],!g||g.v==null){E.push("          ");continue}for(var _=(g.w||(Pa(g),g.w)||"").slice(0,10);_.length<10;)_+=" ";E.push(_+(T===0?" ":""))}h.push(E.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function ED(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=TA.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Jc.to_workbook(t,e)}}var ml=function(){function t(V,G,q){if(V){kn(V,V.l||0);for(var Y=q.Enum||Ce;V.l<V.length;){var de=V.read_shift(2),Ae=Y[de]||Y[65535],Pe=V.read_shift(2),ke=V.l+Pe,we=Ae.f&&Ae.f(V,Pe,q);if(V.l=ke,G(we,Ae,de))return}}}function e(V,G){switch(G.type){case"base64":return r(Mi(zi(V)),G);case"binary":return r(Mi(V),G);case"buffer":case"array":return r(V,G)}throw"Unsupported type "+G.type}function r(V,G){if(!V)return V;var q=G||{},Y=q.dense?[]:{},de="Sheet1",Ae="",Pe=0,ke={},we=[],it=[],K={s:{r:0,c:0},e:{r:0,c:0}},Bt=q.sheetRows||0;if(V[2]==0&&(V[3]==8||V[3]==9)&&V.length>=16&&V[14]==5&&V[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(V[2]==2)q.Enum=Ce,t(V,function($e,Zt,pn){switch(pn){case 0:q.vers=$e,$e>=4096&&(q.qpro=!0);break;case 6:K=$e;break;case 204:$e&&(Ae=$e);break;case 222:Ae=$e;break;case 15:case 51:q.qpro||($e[1].v=$e[1].v.slice(1));case 13:case 14:case 16:pn==14&&($e[2]&112)==112&&($e[2]&15)>1&&($e[2]&15)<15&&($e[1].z=q.dateNF||at[14],q.cellDates&&($e[1].t="d",$e[1].v=Ip($e[1].v))),q.qpro&&$e[3]>Pe&&(Y["!ref"]=xt(K),ke[de]=Y,we.push(de),Y=q.dense?[]:{},K={s:{r:0,c:0},e:{r:0,c:0}},Pe=$e[3],de=Ae||"Sheet"+(Pe+1),Ae="");var Yr=q.dense?(Y[$e[0].r]||[])[$e[0].c]:Y[ot($e[0])];if(Yr){Yr.t=$e[1].t,Yr.v=$e[1].v,$e[1].z!=null&&(Yr.z=$e[1].z),$e[1].f!=null&&(Yr.f=$e[1].f);break}q.dense?(Y[$e[0].r]||(Y[$e[0].r]=[]),Y[$e[0].r][$e[0].c]=$e[1]):Y[ot($e[0])]=$e[1];break}},q);else if(V[2]==26||V[2]==14)q.Enum=Be,V[2]==14&&(q.qpro=!0,V.l=0),t(V,function($e,Zt,pn){switch(pn){case 204:de=$e;break;case 22:$e[1].v=$e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if($e[3]>Pe&&(Y["!ref"]=xt(K),ke[de]=Y,we.push(de),Y=q.dense?[]:{},K={s:{r:0,c:0},e:{r:0,c:0}},Pe=$e[3],de="Sheet"+(Pe+1)),Bt>0&&$e[0].r>=Bt)break;q.dense?(Y[$e[0].r]||(Y[$e[0].r]=[]),Y[$e[0].r][$e[0].c]=$e[1]):Y[ot($e[0])]=$e[1],K.e.c<$e[0].c&&(K.e.c=$e[0].c),K.e.r<$e[0].r&&(K.e.r=$e[0].r);break;case 27:$e[14e3]&&(it[$e[14e3][0]]=$e[14e3][1]);break;case 1537:it[$e[0]]=$e[1],$e[0]==Pe&&(de=$e[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+V[2]);if(Y["!ref"]=xt(K),ke[Ae||de]=Y,we.push(Ae||de),!it.length)return{SheetNames:we,Sheets:ke};for(var gt={},bt=[],ht=0;ht<it.length;++ht)ke[we[ht]]?(bt.push(it[ht]||we[ht]),gt[it[ht]]=ke[it[ht]]||ke[we[ht]]):(bt.push(it[ht]),gt[it[ht]]={"!ref":"A1"});return{SheetNames:bt,Sheets:gt}}function n(V,G){var q=G||{};if(+q.codepage>=0&&ks(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var Y=Si(),de=Dt(V["!ref"]),Ae=Array.isArray(V),Pe=[];Ve(Y,0,s(1030)),Ve(Y,6,l(de));for(var ke=Math.min(de.e.r,8191),we=de.s.r;we<=ke;++we)for(var it=Vr(we),K=de.s.c;K<=de.e.c;++K){we===de.s.r&&(Pe[K]=Tr(K));var Bt=Pe[K]+it,gt=Ae?(V[we]||[])[K]:V[Bt];if(!(!gt||gt.t=="z"))if(gt.t=="n")(gt.v|0)==gt.v&&gt.v>=-32768&&gt.v<=32767?Ve(Y,13,g(we,K,gt.v)):Ve(Y,14,x(we,K,gt.v));else{var bt=Pa(gt);Ve(Y,15,h(we,K,bt.slice(0,239)))}}return Ve(Y,1),Y.end()}function i(V,G){var q=G||{};if(+q.codepage>=0&&ks(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var Y=Si();Ve(Y,0,a(V));for(var de=0,Ae=0;de<V.SheetNames.length;++de)(V.Sheets[V.SheetNames[de]]||{})["!ref"]&&Ve(Y,27,Q(V.SheetNames[de],Ae++));var Pe=0;for(de=0;de<V.SheetNames.length;++de){var ke=V.Sheets[V.SheetNames[de]];if(!(!ke||!ke["!ref"])){for(var we=Dt(ke["!ref"]),it=Array.isArray(ke),K=[],Bt=Math.min(we.e.r,8191),gt=we.s.r;gt<=Bt;++gt)for(var bt=Vr(gt),ht=we.s.c;ht<=we.e.c;++ht){gt===we.s.r&&(K[ht]=Tr(ht));var $e=K[ht]+bt,Zt=it?(ke[gt]||[])[ht]:ke[$e];if(!(!Zt||Zt.t=="z"))if(Zt.t=="n")Ve(Y,23,b(gt,ht,Pe,Zt.v));else{var pn=Pa(Zt);Ve(Y,22,w(gt,ht,Pe,pn.slice(0,239)))}}++Pe}}return Ve(Y,1),Y.end()}function s(V){var G=me(2);return G.write_shift(2,V),G}function a(V){var G=me(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var q=0,Y=0,de=0,Ae=0;Ae<V.SheetNames.length;++Ae){var Pe=V.SheetNames[Ae],ke=V.Sheets[Pe];if(!(!ke||!ke["!ref"])){++de;var we=Ai(ke["!ref"]);q<we.e.r&&(q=we.e.r),Y<we.e.c&&(Y=we.e.c)}}return q>8191&&(q=8191),G.write_shift(2,q),G.write_shift(1,de),G.write_shift(1,Y),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function o(V,G,q){var Y={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&q.qpro?(Y.s.c=V.read_shift(1),V.l++,Y.s.r=V.read_shift(2),Y.e.c=V.read_shift(1),V.l++,Y.e.r=V.read_shift(2),Y):(Y.s.c=V.read_shift(2),Y.s.r=V.read_shift(2),G==12&&q.qpro&&(V.l+=2),Y.e.c=V.read_shift(2),Y.e.r=V.read_shift(2),G==12&&q.qpro&&(V.l+=2),Y.s.c==65535&&(Y.s.c=Y.e.c=Y.s.r=Y.e.r=0),Y)}function l(V){var G=me(8);return G.write_shift(2,V.s.c),G.write_shift(2,V.s.r),G.write_shift(2,V.e.c),G.write_shift(2,V.e.r),G}function c(V,G,q){var Y=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(Y[0].c=V.read_shift(1),Y[3]=V.read_shift(1),Y[0].r=V.read_shift(2),V.l+=2):(Y[2]=V.read_shift(1),Y[0].c=V.read_shift(2),Y[0].r=V.read_shift(2)),Y}function d(V,G,q){var Y=V.l+G,de=c(V,G,q);if(de[1].t="s",q.vers==20768){V.l++;var Ae=V.read_shift(1);return de[1].v=V.read_shift(Ae,"utf8"),de}return q.qpro&&V.l++,de[1].v=V.read_shift(Y-V.l,"cstr"),de}function h(V,G,q){var Y=me(7+q.length);Y.write_shift(1,255),Y.write_shift(2,G),Y.write_shift(2,V),Y.write_shift(1,39);for(var de=0;de<Y.length;++de){var Ae=q.charCodeAt(de);Y.write_shift(1,Ae>=128?95:Ae)}return Y.write_shift(1,0),Y}function p(V,G,q){var Y=c(V,G,q);return Y[1].v=V.read_shift(2,"i"),Y}function g(V,G,q){var Y=me(7);return Y.write_shift(1,255),Y.write_shift(2,G),Y.write_shift(2,V),Y.write_shift(2,q,"i"),Y}function y(V,G,q){var Y=c(V,G,q);return Y[1].v=V.read_shift(8,"f"),Y}function x(V,G,q){var Y=me(13);return Y.write_shift(1,255),Y.write_shift(2,G),Y.write_shift(2,V),Y.write_shift(8,q,"f"),Y}function E(V,G,q){var Y=V.l+G,de=c(V,G,q);if(de[1].v=V.read_shift(8,"f"),q.qpro)V.l=Y;else{var Ae=V.read_shift(2);O(V.slice(V.l,V.l+Ae),de),V.l+=Ae}return de}function T(V,G,q){var Y=G&32768;return G&=-32769,G=(Y?V:0)+(G>=8192?G-16384:G),(Y?"":"$")+(q?Tr(G):Vr(G))}var A={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function O(V,G){kn(V,0);for(var q=[],Y=0,de="",Ae="",Pe="",ke="";V.l<V.length;){var we=V[V.l++];switch(we){case 0:q.push(V.read_shift(8,"f"));break;case 1:Ae=T(G[0].c,V.read_shift(2),!0),de=T(G[0].r,V.read_shift(2),!1),q.push(Ae+de);break;case 2:{var it=T(G[0].c,V.read_shift(2),!0),K=T(G[0].r,V.read_shift(2),!1);Ae=T(G[0].c,V.read_shift(2),!0),de=T(G[0].r,V.read_shift(2),!1),q.push(it+K+":"+Ae+de)}break;case 3:if(V.l<V.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(V.read_shift(2));break;case 6:{for(var Bt="";we=V[V.l++];)Bt+=String.fromCharCode(we);q.push('"'+Bt.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:ke=q.pop(),Pe=q.pop(),q.push(["AND","OR"][we-20]+"("+Pe+","+ke+")");break;default:if(we<32&&_[we])ke=q.pop(),Pe=q.pop(),q.push(Pe+_[we]+ke);else if(A[we]){if(Y=A[we][1],Y==69&&(Y=V[V.l++]),Y>q.length){console.error("WK1 bad formula parse 0x"+we.toString(16)+":|"+q.join("|")+"|");return}var gt=q.slice(-Y);q.length-=Y,q.push(A[we][0]+"("+gt.join(",")+")")}else return we<=7?console.error("WK1 invalid opcode "+we.toString(16)):we<=24?console.error("WK1 unsupported op "+we.toString(16)):we<=30?console.error("WK1 invalid opcode "+we.toString(16)):we<=115?console.error("WK1 unsupported function opcode "+we.toString(16)):console.error("WK1 unrecognized opcode "+we.toString(16))}}q.length==1?G[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function H(V){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=V.read_shift(2),G[3]=V[V.l++],G[0].c=V[V.l++],G}function j(V,G){var q=H(V);return q[1].t="s",q[1].v=V.read_shift(G-4,"cstr"),q}function w(V,G,q,Y){var de=me(6+Y.length);de.write_shift(2,V),de.write_shift(1,q),de.write_shift(1,G),de.write_shift(1,39);for(var Ae=0;Ae<Y.length;++Ae){var Pe=Y.charCodeAt(Ae);de.write_shift(1,Pe>=128?95:Pe)}return de.write_shift(1,0),de}function F(V,G){var q=H(V);q[1].v=V.read_shift(2);var Y=q[1].v>>1;if(q[1].v&1)switch(Y&7){case 0:Y=(Y>>3)*5e3;break;case 1:Y=(Y>>3)*500;break;case 2:Y=(Y>>3)/20;break;case 3:Y=(Y>>3)/200;break;case 4:Y=(Y>>3)/2e3;break;case 5:Y=(Y>>3)/2e4;break;case 6:Y=(Y>>3)/16;break;case 7:Y=(Y>>3)/64;break}return q[1].v=Y,q}function S(V,G){var q=H(V),Y=V.read_shift(4),de=V.read_shift(4),Ae=V.read_shift(2);if(Ae==65535)return Y===0&&de===3221225472?(q[1].t="e",q[1].v=15):Y===0&&de===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var Pe=Ae&32768;return Ae=(Ae&32767)-16446,q[1].v=(1-Pe*2)*(de*Math.pow(2,Ae+32)+Y*Math.pow(2,Ae)),q}function b(V,G,q,Y){var de=me(14);if(de.write_shift(2,V),de.write_shift(1,q),de.write_shift(1,G),Y==0)return de.write_shift(4,0),de.write_shift(4,0),de.write_shift(2,65535),de;var Ae=0,Pe=0,ke=0,we=0;return Y<0&&(Ae=1,Y=-Y),Pe=Math.log2(Y)|0,Y/=Math.pow(2,Pe-31),we=Y>>>0,we&2147483648||(Y/=2,++Pe,we=Y>>>0),Y-=we,we|=2147483648,we>>>=0,Y*=Math.pow(2,32),ke=Y>>>0,de.write_shift(4,ke),de.write_shift(4,we),Pe+=16383+(Ae?32768:0),de.write_shift(2,Pe),de}function D(V,G){var q=S(V);return V.l+=G-14,q}function P(V,G){var q=H(V),Y=V.read_shift(4);return q[1].v=Y>>6,q}function N(V,G){var q=H(V),Y=V.read_shift(8,"f");return q[1].v=Y,q}function ze(V,G){var q=N(V);return V.l+=G-10,q}function ge(V,G){return V[V.l+G-1]==0?V.read_shift(G,"cstr"):""}function be(V,G){var q=V[V.l++];q>G-1&&(q=G-1);for(var Y="";Y.length<q;)Y+=String.fromCharCode(V[V.l++]);return Y}function Se(V,G,q){if(!(!q.qpro||G<21)){var Y=V.read_shift(1);V.l+=17,V.l+=1,V.l+=2;var de=V.read_shift(G-21,"cstr");return[Y,de]}}function ye(V,G){for(var q={},Y=V.l+G;V.l<Y;){var de=V.read_shift(2);if(de==14e3){for(q[de]=[0,""],q[de][0]=V.read_shift(2);V[V.l];)q[de][1]+=String.fromCharCode(V[V.l]),V.l++;V.l++}}return q}function Q(V,G){var q=me(5+V.length);q.write_shift(2,14e3),q.write_shift(2,G);for(var Y=0;Y<V.length;++Y){var de=V.charCodeAt(Y);q[q.l++]=de>127?95:de}return q[q.l++]=0,q}var Ce={0:{n:"BOF",f:Kr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ge},222:{n:"SHEETNAMELP",f:be},65535:{n:""}},Be={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:j},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:D},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ye},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:N},40:{n:"FORMULA28",f:ze},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ge},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Se},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function wD(t){var e={},r=t.match(Jn),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=lt(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=T1[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var TD=function(){var t=Gf("t"),e=Gf("rPr");function r(s){var a=s.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:Nt(a[1])},l=s.match(e);return l&&(o.s=wD(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),SD=function(){var e=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),AD=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,kD=/<(?:\w+:)?r>/,CD=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function K1(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Nt(Jt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Jt(t),r&&(n.h=D1(n.t))):t.match(kD)&&(n.r=Jt(t),n.t=Nt(Jt((t.replace(CD,"").match(AD)||[]).join("").replace(Jn,""))),r&&(n.h=SD(TD(n.r)))),n):{t:""}}var FD=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,ID=/<(?:\w+:)?(?:si|sstItem)>/g,bD=/<\/(?:\w+:)?(?:si|sstItem)>/;function RD(t,e){var r=[],n="";if(!t)return r;var i=t.match(FD);if(i){n=i[2].replace(ID,"").split(bD);for(var s=0;s!=n.length;++s){var a=K1(n[s].trim(),e);a!=null&&(r[r.length]=a)}i=lt(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var ND=/^\s|\s$|[\t\n\r]/;function kA(t,e){if(!e.bookSST)return"";var r=[Ur];r[r.length]=je("sst",null,{xmlns:Ll[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(ND)&&(s+=' xml:space="preserve"'),s+=">"+Gt(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function DD(t){return[t.read_shift(4),t.read_shift(4)]}function PD(t,e){var r=[],n=!1;return za(t,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function OD(t,e){return e||(e=me(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var MD=GR;function LD(t){var e=Si();Ee(e,159,OD(t));for(var r=0;r<t.length;++r)Ee(e,19,MD(t[r]));return Ee(e,160),e.end()}function CA(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Fa(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function BD(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Fa(t,4),e.U=Fa(t,4),e.W=Fa(t,4),e}function jD(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function VD(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(jD(t));return e}function UD(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function zD(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Fa(t,4),e.U=Fa(t,4),e.W=Fa(t,4),e}function WD(t){var e=zD(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function FA(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function IA(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function HD(t){var e=Fa(t);switch(e.Minor){case 2:return[e.Minor,$D(t)];case 3:return[e.Minor,GD()];case 4:return[e.Minor,KD(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function $D(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=FA(t,r),i=IA(t,t.length-t.l);return{t:"Std",h:n,v:i}}function GD(){throw new Error("File is password-protected: ECMA-376 Extensible")}function KD(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Jn,function(s){var a=lt(s);switch(sa(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function XD(t,e){var r={},n=r.EncryptionVersionInfo=Fa(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=FA(t,i),e-=i,r.EncryptionVerifier=IA(t,e),r}function YD(t){var e={},r=e.EncryptionVersionInfo=Fa(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function X1(t){var e=0,r,n=CA(t),i=n.length+1,s,a,o,l,c;for(r=Mo(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var bA=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],l=104,c=a.length-1;c>=0;--c)for(var d=a[c],h=0;h!=7;++h)d&64&&(o^=r[l]),d*=2,--l;return o};return function(a){for(var o=CA(a),l=s(o),c=o.length,d=Mo(16),h=0;h!=16;++h)d[h]=0;var p,g,y;for((c&1)===1&&(p=l>>8,d[c]=i(t[0],p),--c,p=l&255,g=o[o.length-1],d[c]=i(g,p));c>0;)--c,p=l>>8,d[c]=i(o[c],p),--c,p=l&255,d[c]=i(o[c],p);for(c=15,y=15-o.length;y>0;)p=l>>8,d[c]=i(t[y],p),--c,--y,p=l&255,d[c]=i(o[c],p),--c,--y;return d}}(),qD=function(t,e,r,n,i){i||(i=e),n||(n=bA(t));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},QD=function(t){var e=0,r=bA(t);return function(n){var i=qD("",n,e,r);return e=i[1],i[0]}};function JD(t,e,r,n){var i={key:Kr(t),verificationBytes:Kr(t)};return r.password&&(i.verifier=X1(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=QD(r.password)),i}function ZD(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=YD(t):n.Data=XD(t,e),n}function eP(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?ZD(t,e-2,n):JD(t,r.biff>=8?e:e-2,r,n),n}var RA=function(){function t(i,s){switch(s.type){case"base64":return e(zi(i),s);case"binary":return e(i,s);case"buffer":return e(yt&&Buffer.isBuffer(i)?i.toString("binary"):Go(i),s);case"array":return e(Al(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(d,h){Array.isArray(o)&&(o[h]=[]);for(var p=/\\\w+\b/g,g=0,y,x=-1;y=p.exec(d);){switch(y[0]){case"\\cell":var E=d.slice(g,p.lastIndex-y[0].length);if(E[0]==" "&&(E=E.slice(1)),++x,E.length){var T={v:E,t:"s"};Array.isArray(o)?o[h][x]=T:o[ot({r:h,c:x})]=T}break}g=p.lastIndex}x>c.e.c&&(c.e.c=x)}),o["!ref"]=xt(c),o}function r(i,s){return Ko(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=Dt(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var d=a.s.c;d<=a.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=a.s.c;d<=a.e.c;++d){var h=ot({r:c,c:d});o=l?(i[c]||[])[d]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Pa(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function tP(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function qf(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function rP(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),a=i-s;if(a===0)return[0,0,e];var o=0,l=0,c=i+s;switch(l=a/(c>1?2-c:c),i){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,l,c/2]}function nP(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=i*o,a[0]+=i,a[1]+=l;break;case 1:l=i*(2-o),a[0]+=l,a[1]+=i;break;case 2:l=i*(o-2),a[1]+=i,a[2]+=l;break;case 3:l=i*(4-o),a[1]+=l,a[2]+=i;break;case 4:l=i*(o-4),a[2]+=i,a[0]+=l;break;case 5:l=i*(6-o),a[2]+=l,a[0]+=i;break}for(var c=0;c!=3;++c)a[c]=Math.round(a[c]*255);return a}function Wh(t,e){if(e===0)return t;var r=rP(tP(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),qf(nP(r))}var NA=6,iP=15,sP=1,$n=NA;function Qf(t){return Math.floor((t+Math.round(128/$n)/256)*$n)}function Jf(t){return Math.floor((t-5)/$n*100+.5)/100}function Hh(t){return Math.round((t*$n+5)/$n*256)/256}function Fm(t){return Hh(Jf(Qf(t)))}function Y1(t){var e=Math.abs(t-Fm(t)),r=$n;if(e>.005)for($n=sP;$n<iP;++$n)Math.abs(t-Fm(t))<=e&&(e=Math.abs(t-Fm(t)),r=$n);$n=r}function Lo(t){t.width?(t.wpx=Qf(t.width),t.wch=Jf(t.wpx),t.MDW=$n):t.wpx?(t.wch=Jf(t.wpx),t.width=Hh(t.wch),t.MDW=$n):typeof t.wch=="number"&&(t.width=Hh(t.wch),t.wpx=Qf(t.width),t.MDW=$n),t.customWidth&&delete t.customWidth}var aP=96,DA=aP;function Zf(t){return t*96/DA}function Zc(t){return t*DA/96}var oP={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function lP(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(Jn)||[]).forEach(function(a){var o=lt(a);switch(sa(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=lr(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=lr(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function cP(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(Jn)||[]).forEach(function(a){var o=lt(a);switch(sa(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function uP(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(Jn)||[]).forEach(function(a){var o=lt(a);switch(sa(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=Jt(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?lr(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?lr(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?lr(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?lr(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?lr(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?lr(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?lr(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=T1[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=lr(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=hl[i.color.index];i.color.index==81&&(l=hl[1]),l||(l=hl[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=Wh(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function fP(t,e,r){e.NumberFmt=[];for(var n=Mr(at),i=0;i<n.length;++i)e.NumberFmt[n[i]]=at[n[i]];var s=t[0].match(Jn);if(s)for(i=0;i<s.length;++i){var a=lt(s[i]);switch(sa(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Nt(Jt(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}Ca(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function dP(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=je("numFmt",null,{numFmtId:n,formatCode:Gt(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=je("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Cd=["numFmtId","fillId","fontId","borderId","xfId"],Fd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function hP(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(Jn)||[]).forEach(function(s){var a=lt(s),o=0;switch(sa(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<Cd.length;++o)n[Cd[o]]&&(n[Cd[o]]=parseInt(n[Cd[o]],10));for(o=0;o<Fd.length;++o)n[Fd[o]]&&(n[Fd[o]]=lr(n[Fd[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=lr(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function pP(t){var e=[];return e[e.length]=je("cellXfs",null),t.forEach(function(r){e[e.length]=je("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=je("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var mP=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&fP(h,d,c),(h=o.match(i))&&uP(h,d,l,c),(h=o.match(n))&&cP(h,d,l,c),(h=o.match(s))&&lP(h,d,l,c),(h=o.match(r))&&hP(h,d,c),d}}();function PA(t,e){var r=[Ur,je("styleSheet",null,{xmlns:Ll[0],"xmlns:vt":Zr.vt})],n;return t.SSF&&(n=dP(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=pP(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function gP(t,e){var r=t.read_shift(2),n=Xn(t);return[r,n]}function xP(t,e,r){r||(r=me(6+4*e.length)),r.write_shift(2,t),dn(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function vP(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=ZR(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=JR(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Xn(t),n}function yP(t,e){e||(e=me(25+4*32)),e.write_shift(2,t.sz*20),eN(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Vh(t.color,e);var n=0;return n=2,e.write_shift(1,n),dn(t.name,e),e.length>e.l?e.slice(0,e.l):e}var _P=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Im,EP=qn;function h2(t,e){e||(e=me(4*3+8*7+16*1)),Im||(Im=Cp(_P));var r=Im[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(Vh({auto:1},e),Vh({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function wP(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function OA(t,e,r){r||(r=me(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Uu(t,e){return e||(e=me(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var TP=qn;function SP(t,e){return e||(e=me(51)),e.write_shift(1,0),Uu(null,e),Uu(null,e),Uu(null,e),Uu(null,e),Uu(null,e),e.length>e.l?e.slice(0,e.l):e}function AP(t,e){return e||(e=me(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),jh(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function kP(t,e,r){var n=me(2052);return n.write_shift(4,t),jh(e,n),jh(r,n),n.length>n.l?n.slice(0,n.l):n}function CP(t,e,r){var n={};n.NumberFmt=[];for(var i in at)n.NumberFmt[i]=at[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return za(t,function(l,c,d){switch(d){case 44:n.NumberFmt[l[0]]=l[1],Ca(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=Wh(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(d),a=!0;break;case 38:s.pop(),a=!1;break;default:if(c.T>0)s.push(d);else if(c.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function FP(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(Ee(t,615,Ns(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Ee(t,44,xP(i,e[i]))}),Ee(t,616))}}function IP(t){var e=1;Ee(t,611,Ns(e)),Ee(t,43,yP({sz:12,color:{theme:1},name:"Calibri",family:2})),Ee(t,612)}function bP(t){var e=2;Ee(t,603,Ns(e)),Ee(t,45,h2({patternType:"none"})),Ee(t,45,h2({patternType:"gray125"})),Ee(t,604)}function RP(t){var e=1;Ee(t,613,Ns(e)),Ee(t,46,SP()),Ee(t,614)}function NP(t){var e=1;Ee(t,626,Ns(e)),Ee(t,47,OA({numFmtId:0},65535)),Ee(t,627)}function DP(t,e){Ee(t,617,Ns(e.length)),e.forEach(function(r){Ee(t,47,OA(r,0))}),Ee(t,618)}function PP(t){var e=1;Ee(t,619,Ns(e)),Ee(t,48,AP({xfId:0,name:"Normal"})),Ee(t,620)}function OP(t){var e=0;Ee(t,505,Ns(e)),Ee(t,506)}function MP(t){var e=0;Ee(t,508,kP(e,"TableStyleMedium9","PivotStyleMedium4")),Ee(t,509)}function LP(t,e){var r=Si();return Ee(r,278),FP(r,t.SSF),IP(r),bP(r),RP(r),NP(r),DP(r,e.cellXfs),PP(r),OP(r),MP(r),Ee(r,279),r.end()}var BP=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function jP(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Jn)||[]).forEach(function(i){var s=lt(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[BP.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function VP(){}function UP(){}var zP=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,WP=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,HP=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function $P(t,e,r){e.themeElements={};var n;[["clrScheme",zP,jP],["fontScheme",WP,VP],["fmtScheme",HP,UP]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var GP=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function MA(t,e){(!t||t.length===0)&&(t=q1());var r,n={};if(!(r=t.match(GP)))throw new Error("themeElements not found in theme");return $P(r[0],n,e),n.raw=t,n}function q1(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Ur];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function KP(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var a;try{a=FS(s,{type:"array"})}catch{return}var o=Li(a,"theme/theme/theme1.xml",!0);if(o)return MA(o,r)}}function XP(t){return t.read_shift(4)}function YP(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=qP(t,4);break;case 2:e.xclrValue=mA(t);break;case 3:e.xclrValue=XP(t);break;case 4:t.l+=4;break}return t.l+=8,e}function qP(t,e){return qn(t,e)}function QP(t,e){return qn(t,e)}function JP(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=YP(t);break;case 6:n[1]=QP(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function ZP(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push(JP(t,r-t.l));return{ixfe:n,ext:s}}function e6(t,e){e.forEach(function(r){switch(r[0]){}})}function t6(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Xn(t)}}function r6(t){var e=me(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),dn(t.name,e),e.slice(0,e.l)}function n6(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function i6(t){var e=me(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function s6(t,e){var r=me(8+2*e.length);return r.write_shift(4,t),dn(e,r),r.slice(0,r.l)}function a6(t){return t.l+=4,t.read_shift(4)!=0}function o6(t,e){var r=me(8);return r.write_shift(4,t),r.write_shift(4,1),r}function l6(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return za(t,function(l,c,d){switch(d){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(d),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!c.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function c6(){var t=Si();return Ee(t,332),Ee(t,334,Ns(1)),Ee(t,335,r6({name:"XLDAPR",version:12e4,flags:3496657072})),Ee(t,336),Ee(t,339,s6(1,"XLDAPR")),Ee(t,52),Ee(t,35,Ns(514)),Ee(t,4096,Ns(0)),Ee(t,4097,is(1)),Ee(t,36),Ee(t,53),Ee(t,340),Ee(t,337,o6(1)),Ee(t,51,i6([[1,0]])),Ee(t,338),Ee(t,333),t.end()}function u6(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,a;return t.replace(Jn,function(o){var l=lt(o);switch(sa(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(a=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function LA(){var t=[Ur];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function f6(t){var e=[];if(!t)return e;var r=1;return(t.match(Jn)||[]).forEach(function(n){var i=lt(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function d6(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=ot(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function h6(t,e,r){var n=[];return za(t,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function p6(t,e,r,n){if(!t)return t;var i=n||{},s=!1;za(t,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function m6(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Cc=1024;function BA(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[je("xml",null,{"xmlns:v":Pi.v,"xmlns:o":Pi.o,"xmlns:x":Pi.x,"xmlns:mv":Pi.mv}).replace(/\/>/,">"),je("o:shapelayout",je("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),je("v:shapetype",[je("v:stroke",null,{joinstyle:"miter"}),je("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Cc<t*1e3;)Cc+=1e3;return e.forEach(function(s){var a=Sr(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?je("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=je("v:fill",l,o),d={on:"t",obscured:"t"};++Cc,i=i.concat(["<v:shape"+Kf({id:"_x0000_s"+Cc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,je("v:shadow",null,d),je("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Cn("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Cn("x:AutoFill","False"),Cn("x:Row",String(a.r)),Cn("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function p2(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(a){var o=Sr(a.ref);if(i?(t[o.r]||(t[o.r]=[]),s=t[o.r][o.c]):s=t[a.ref],!s){s={t:"z"},i?t[o.r][o.c]=s:t[a.ref]=s;var l=Dt(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=xt(l);c!==t["!ref"]&&(t["!ref"]=c)}s.c||(s.c=[]);var d={a:a.author,t:a.t,r:a.r,T:r};a.h&&(d.h=a.h);for(var h=s.c.length-1;h>=0;--h){if(!r&&s.c[h].T)return;r&&!s.c[h].T&&s.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(d.a==n[h].id){d.a=n[h].name||d.a;break}}s.c.push(d)})}function g6(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=lt(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},d=Sr(l.ref);if(!(e.sheetRows&&e.sheetRows<=d.r)){var h=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!h&&!!h[1]&&K1(h[1])||{r:"",t:"",h:""};c.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),c.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=p.h),n.push(c)}}}}),n}function jA(t){var e=[Ur,je("comments",null,{xmlns:Ll[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=Gt(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(Gt(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Cn("t",Gt(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(Cn("t",Gt(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function x6(t,e){var r=[],n=!1,i={},s=0;return t.replace(Jn,function(o,l){var c=lt(o);switch(sa(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":i.t=t.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function v6(t,e,r){var n=[Ur,je("ThreadedComments",null,{xmlns:Zr.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(je("threadedComment",Cn("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function y6(t,e){var r=[],n=!1;return t.replace(Jn,function(s){var a=lt(s);switch(sa(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function _6(t){var e=[Ur,je("personList",null,{xmlns:Zr.TCMNT,"xmlns:x":Ll[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(je("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function E6(t){var e={};e.iauthor=t.read_shift(4);var r=Ul(t);return e.rfx=r.s,e.ref=ot(r.s),t.l+=16,e}function w6(t,e){return e==null&&(e=me(36)),e.write_shift(4,t[1].iauthor),mu(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var T6=Xn;function S6(t){return dn(t.slice(0,54))}function A6(t,e){var r=[],n=[],i={},s=!1;return za(t,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function k6(t){var e=Si(),r=[];return Ee(e,628),Ee(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),Ee(e,632,S6(i.a)))})}),Ee(e,631),Ee(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Sr(n[0]),e:Sr(n[0])};Ee(e,635,w6([s,i])),i.t&&i.t.length>0&&Ee(e,637,XR(i)),Ee(e,636),delete i.iauthor})}),Ee(e,634),Ee(e,629),e.end()}var C6="application/vnd.ms-office.vbaProject";function F6(t){var e=et.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");et.utils.cfb_add(e,i,t.FileIndex[n].content)}}),et.write(e)}function I6(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&et.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var VA=["xlsb","xlsm","xlam","biff8","xla"];function b6(){return{"!type":"dialog"}}function R6(){return{"!type":"dialog"}}function N6(){return{"!type":"macro"}}function D6(){return{"!type":"macro"}}var Bc=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,d=a.length>0?parseInt(a,10)|0:0;return o?d+=e.c:--d,l?c+=e.r:--c,i+(o?"":"$")+Tr(d)+(l?"":"$")+Vr(c)}return function(i,s){return e=s,i.replace(t,r)}}(),Q1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,J1=function(){return function(e,r){return e.replace(Q1,function(n,i,s,a,o,l){var c=B1(a)-(s?0:r.c),d=L1(l)-(o?0:r.r),h=d==0?"":o?d+1:"["+d+"]",p=c==0?"":s?c+1:"["+c+"]";return i+"R"+h+"C"+p})}}();function UA(t,e){return t.replace(Q1,function(r,n,i,s,a,o){return n+(i=="$"?i+s:Tr(B1(s)+e.c))+(a=="$"?a+o:Vr(L1(o)+e.r))})}function P6(t,e,r){var n=Ai(e),i=n.s,s=Sr(r),a={r:s.r-i.r,c:s.c-i.c};return UA(t,a)}function O6(t){return t.length!=1}function m2(t){return t.replace(/_xlfn\./g,"")}function Hr(t){t.l+=1}function Bo(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function zA(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return WA(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=Bo(t),o=Bo(t);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function WA(t){var e=Bo(t),r=Bo(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function M6(t,e,r){if(r.biff<8)return WA(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=Bo(t),a=Bo(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function HA(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return L6(t);var n=t.read_shift(r&&r.biff==12?4:2),i=Bo(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function L6(t){var e=Bo(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function B6(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function j6(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return V6(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function V6(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function U6(t,e,r){var n=(t[t.l++]&96)>>5,i=zA(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function z6(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=zA(t,s,r);return[n,i,a]}function W6(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function H6(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function $6(t,e,r){var n=(t[t.l++]&96)>>5,i=M6(t,e-1,r);return[n,i]}function G6(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function g2(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function K6(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function X6(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function Y6(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function q6(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function Q6(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function $A(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function J6(t){return t.read_shift(2),$A(t)}function Z6(t){return t.read_shift(2),$A(t)}function e8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=HA(t,0,r);return[n,i]}function t8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=j6(t,0,r);return[n,i]}function r8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=HA(t,0,r);return[n,i,s]}function n8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[a5[i],XA[i],n]}function i8(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:s8(t);return[i,(s[0]===0?XA:s5)[s[1]]]}function s8(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function a8(t,e,r){t.l+=r&&r.biff==2?3:4}function o8(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function l8(t){return t.l++,Wa[t.read_shift(1)]}function c8(t){return t.l++,t.read_shift(2)}function u8(t){return t.l++,t.read_shift(1)!==0}function f8(t){return t.l++,Kn(t)}function d8(t,e,r){return t.l++,_0(t,e-1,r)}function h8(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Lr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Wa[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Kn(t);break;case 2:r[1]=zl(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function p8(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Ul:bp)(t));return i}function m8(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=h8(t,r.biff);return a}function g8(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function x8(t,e,r){if(r.biff==5)return v8(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function v8(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function y8(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function _8(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function E8(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function w8(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var T8=qn,S8=qn,A8=qn;function w0(t,e,r){return t.l+=2,[B6(t)]}function Z1(t){return t.l+=6,[]}var k8=w0,C8=Z1,F8=Z1,I8=w0;function GA(t){return t.l+=2,[Kr(t),t.read_shift(2)&1]}var b8=w0,R8=GA,N8=Z1,D8=w0,P8=w0,O8=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function M8(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=O8[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function L8(t){return t.l+=2,[t.read_shift(4)]}function B8(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function j8(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function V8(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function U8(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function z8(t){return t.l+=4,[0,0]}var x2={1:{n:"PtgExp",f:o8},2:{n:"PtgTbl",f:A8},3:{n:"PtgAdd",f:Hr},4:{n:"PtgSub",f:Hr},5:{n:"PtgMul",f:Hr},6:{n:"PtgDiv",f:Hr},7:{n:"PtgPower",f:Hr},8:{n:"PtgConcat",f:Hr},9:{n:"PtgLt",f:Hr},10:{n:"PtgLe",f:Hr},11:{n:"PtgEq",f:Hr},12:{n:"PtgGe",f:Hr},13:{n:"PtgGt",f:Hr},14:{n:"PtgNe",f:Hr},15:{n:"PtgIsect",f:Hr},16:{n:"PtgUnion",f:Hr},17:{n:"PtgRange",f:Hr},18:{n:"PtgUplus",f:Hr},19:{n:"PtgUminus",f:Hr},20:{n:"PtgPercent",f:Hr},21:{n:"PtgParen",f:Hr},22:{n:"PtgMissArg",f:Hr},23:{n:"PtgStr",f:d8},26:{n:"PtgSheet",f:B8},27:{n:"PtgEndSheet",f:j8},28:{n:"PtgErr",f:l8},29:{n:"PtgBool",f:u8},30:{n:"PtgInt",f:c8},31:{n:"PtgNum",f:f8},32:{n:"PtgArray",f:G6},33:{n:"PtgFunc",f:n8},34:{n:"PtgFuncVar",f:i8},35:{n:"PtgName",f:g8},36:{n:"PtgRef",f:e8},37:{n:"PtgArea",f:U6},38:{n:"PtgMemArea",f:y8},39:{n:"PtgMemErr",f:T8},40:{n:"PtgMemNoMem",f:S8},41:{n:"PtgMemFunc",f:_8},42:{n:"PtgRefErr",f:E8},43:{n:"PtgAreaErr",f:W6},44:{n:"PtgRefN",f:t8},45:{n:"PtgAreaN",f:$6},46:{n:"PtgMemAreaN",f:V8},47:{n:"PtgMemNoMemN",f:U8},57:{n:"PtgNameX",f:x8},58:{n:"PtgRef3d",f:r8},59:{n:"PtgArea3d",f:z6},60:{n:"PtgRefErr3d",f:w8},61:{n:"PtgAreaErr3d",f:H6},255:{}},W8={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},H8={1:{n:"PtgElfLel",f:GA},2:{n:"PtgElfRw",f:D8},3:{n:"PtgElfCol",f:k8},6:{n:"PtgElfRwV",f:P8},7:{n:"PtgElfColV",f:I8},10:{n:"PtgElfRadical",f:b8},11:{n:"PtgElfRadicalS",f:N8},13:{n:"PtgElfColS",f:C8},15:{n:"PtgElfColSV",f:F8},16:{n:"PtgElfRadicalLel",f:R8},25:{n:"PtgList",f:M8},29:{n:"PtgSxName",f:L8},255:{}},$8={0:{n:"PtgAttrNoop",f:z8},1:{n:"PtgAttrSemi",f:Q6},2:{n:"PtgAttrIf",f:Y6},4:{n:"PtgAttrChoose",f:K6},8:{n:"PtgAttrGoto",f:X6},16:{n:"PtgAttrSum",f:a8},32:{n:"PtgAttrBaxcel",f:g2},33:{n:"PtgAttrBaxcel",f:g2},64:{n:"PtgAttrSpace",f:J6},65:{n:"PtgAttrSpaceSemi",f:Z6},128:{n:"PtgAttrIfError",f:q6},255:{}};function T0(t,e,r,n){if(n.biff<8)return qn(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=m8(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=p8(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(qn(t,e)),s}function S0(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=x2[s]||x2[W8[s]],(s===24||s===25)&&(i=(s===24?H8:$8)[t[t.l+1]]),!i||!i.f?qn(t,e):a.push([i.n,i.f(t,e,r)]);return a}function G8(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var K8={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function X8(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function KA(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function v2(t,e,r){var n=KA(t,e,r);return n=="#REF"?n:X8(n,r)}function Wn(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,c,d,h=0,p=0,g,y="";if(!t[0]||!t[0][0])return"";for(var x=-1,E="",T=0,A=t[0].length;T<A;++T){var _=t[0][T];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),x>=0){switch(t[0][x][1][0]){case 0:E=Dr(" ",t[0][x][1][1]);break;case 1:E=Dr("\r",t[0][x][1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}c=c+E,x=-1}o.push(c+K8[_[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=pf(_[1][1],a,i),o.push(mf(d,s));break;case"PtgRefN":d=r?pf(_[1][1],r,i):_[1][1],o.push(mf(d,s));break;case"PtgRef3d":h=_[1][1],d=pf(_[1][2],a,i),y=v2(n,h,i),o.push(y+"!"+mf(d,s));break;case"PtgFunc":case"PtgFuncVar":var O=_[1][0],H=_[1][1];O||(O=0),O&=127;var j=O==0?[]:o.slice(-O);o.length-=O,H==="User"&&(H=j.shift()),o.push(H+"("+j.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":g=K_(_[1][1],r?{s:r}:a,i),o.push(Am(g,i));break;case"PtgArea":g=K_(_[1][1],a,i),o.push(Am(g,i));break;case"PtgArea3d":h=_[1][1],g=_[1][2],y=v2(n,h,i),o.push(y+"!"+Am(g,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=_[1][2];var w=(n.names||[])[p-1]||(n[0]||[])[p],F=w?w.Name:"SH33TJSNAME"+String(p);F&&F.slice(0,6)=="_xlfn."&&!i.xlfn&&(F=F.slice(6)),o.push(F);break;case"PtgNameX":var S=_[1][1];p=_[1][2];var b;if(i.biff<=5)S<0&&(S=-S),n[S]&&(b=n[S][p]);else{var D="";if(((n[S]||[])[0]||[])[0]==14849||(((n[S]||[])[0]||[])[0]==1025?n[S][p]&&n[S][p].itab>0&&(D=n.SheetNames[n[S][p].itab-1]+"!"):D=n.SheetNames[p-1]+"!"),n[S]&&n[S][p])D+=n[S][p].Name;else if(n[0]&&n[0][p])D+=n[0][p].Name;else{var P=(KA(n,S,i)||"").split(";;");P[p-1]?D=P[p-1]:D+="SH33TJSERRX"}o.push(D);break}b||(b={Name:"SH33TJSERRY"}),o.push(b.Name);break;case"PtgParen":var N="(",ze=")";if(x>=0){switch(E="",t[0][x][1][0]){case 2:N=Dr(" ",t[0][x][1][1])+N;break;case 3:N=Dr("\r",t[0][x][1][1])+N;break;case 4:ze=Dr(" ",t[0][x][1][1])+ze;break;case 5:ze=Dr("\r",t[0][x][1][1])+ze;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}x=-1}o.push(N+o.pop()+ze);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:_[1][1],r:_[1][0]};var ge={c:r.c,r:r.r};if(n.sharedf[ot(d)]){var be=n.sharedf[ot(d)];o.push(Wn(be,a,ge,n,i))}else{var Se=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(d.c<c[0].s.c||d.c>c[0].e.c)&&!(d.r<c[0].s.r||d.r>c[0].e.r)){o.push(Wn(c[1],a,ge,n,i)),Se=!0;break}Se||o.push(_[1])}break;case"PtgArray":o.push("{"+G8(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var ye=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&ye.indexOf(t[0][T][0])==-1){_=t[0][x];var Q=!0;switch(_[1][0]){case 4:Q=!1;case 0:E=Dr(" ",_[1][1]);break;case 5:Q=!1;case 1:E=Dr("\r",_[1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((Q?E:"")+o.pop()+(Q?"":E)),x=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function Y8(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],qn(t,e-2)];var o=S0(t,a,r);return e!==a+i&&(s=T0(t,e-a-i,o,r)),t.l=n,[o,s]}function q8(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],qn(t,e-2)];var o=S0(t,a,r);return e!==a+i&&(s=T0(t,e-a-i,o,r)),t.l=n,[o,s]}function Q8(t,e,r,n){var i=t.l+e,s=S0(t,n,r),a;return i!==t.l&&(a=T0(t,i-t.l,s,r)),[s,a]}function J8(t,e,r){var n=t.l+e,i,s=t.read_shift(2),a=S0(t,s,r);return s==65535?[[],qn(t,e-2)]:(e!==s+2&&(i=T0(t,n-s-2,a,r)),[a,i])}function Z8(t){var e;if(Ea(t,t.l+6)!==65535)return[Kn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function e5(t){if(t==null){var e=me(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return kl(t);return kl(0)}function bm(t,e,r){var n=t.l+e,i=aa(t);r.biff==2&&++t.l;var s=Z8(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=q8(t,n-t.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function t5(t,e,r,n,i){var s=Fl(e,r,i),a=e5(t.v),o=me(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=me(t.bf.length),d=0;d<t.bf.length;++d)c[d]=t.bf[d];var h=fn([s,a,o,c]);return h}function Rp(t,e,r){var n=t.read_shift(4),i=S0(t,n,r),s=t.read_shift(4),a=s>0?T0(t,s,i,r):null;return[i,a]}var r5=Rp,Np=Rp,n5=Rp,i5=Rp,s5={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},XA={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},a5={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function y2(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function o5(t){var e="of:="+t.replace(Q1,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Rm(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function l5(t){return t.replace(/\./,"!")}var xf={},jc={},vf=typeof Map<"u";function ev(t,e,r){var n=0,i=t.length;if(r){if(vf?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=vf?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(vf?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function Dp(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&($n=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=Jf(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=Hh(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function gl(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Xo(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Ca(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function YA(t,e,r,n,i,s){try{n.cellNF&&(t.z=at[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=ur(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(at[e]==null&&Ca(sR[e]||"General",e),t.t==="e")t.w=t.w||Wa[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=$f(t.v);else if(t.t==="d"){var a=nn(t.v);(a|0)===a?t.w=a.toString(10):t.w=$f(a)}else{if(t.v===void 0)return"";t.w=Sl(t.v,jc)}else t.t==="d"?t.w=hs(e,nn(t.v),jc):t.w=hs(e,t.v,jc)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Wh(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Wh(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function c5(t,e,r){if(t&&t["!ref"]){var n=Dt(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function u5(t,e){var r=Dt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=xt(r))}var f5=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,d5=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,h5=/<(?:\w:)?hyperlink [^>]*>/mg,p5=/"(\w*:\w*)"/,m5=/<(?:\w:)?col\b[^>]*[\/]?>/g,g5=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,x5=/<(?:\w:)?pageMargins[^>]*\/>/g,qA=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,v5=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,y5=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function _5(t,e,r,n,i,s,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",d="",h=t.match(d5);h?(c=t.slice(0,h.index),d=t.slice(h.index+h[0].length)):c=d=t;var p=c.match(qA);p?tv(p[0],o,i,r):(p=c.match(v5))&&w5(p[0],p[1]||"",o,i,r);var g=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(g>0){var y=c.slice(g,g+50).match(p5);y&&u5(o,y[1])}var x=c.match(y5);x&&x[1]&&O5(x[1],i);var E=[];if(e.cellStyles){var T=c.match(m5);T&&b5(E,T)}h&&B5(h[1],o,e,l,s,a);var A=d.match(g5);A&&(o["!autofilter"]=N5(A[0]));var _=[],O=d.match(f5);if(O)for(g=0;g!=O.length;++g)_[g]=Dt(O[g].slice(O[g].indexOf('"')+1));var H=d.match(h5);H&&C5(o,H,n);var j=d.match(x5);if(j&&(o["!margins"]=F5(lt(j[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=xt(l)),e.sheetRows>0&&o["!ref"]){var w=Dt(o["!ref"]);e.sheetRows<=+w.e.r&&(w.e.r=e.sheetRows-1,w.e.r>l.e.r&&(w.e.r=l.e.r),w.e.r<w.s.r&&(w.s.r=w.e.r),w.e.c>l.e.c&&(w.e.c=l.e.c),w.e.c<w.s.c&&(w.s.c=w.e.c),o["!fullref"]=o["!ref"],o["!ref"]=xt(w))}return E.length>0&&(o["!cols"]=E),_.length>0&&(o["!merges"]=_),o}function E5(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+xt(t[r])+'"/>';return e+"</mergeCells>"}function tv(t,e,r,n){var i=lt(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Nt(Jt(i.codeName)))}function w5(t,e,r,n,i){tv(t.slice(0,t.indexOf(">")),r,n,i)}function T5(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=qs(Gt(l))}if(t&&t["!outline"]){var c={summaryBelow:1,summaryRight:1};t["!outline"].above&&(c.summaryBelow=0),t["!outline"].left&&(c.summaryRight=0),o=(o||"")+je("outlinePr",null,c)}!s&&!o||(i[i.length]=je("sheetPr",o,a))}var S5=["objects","scenarios","selectLockedCells","selectUnlockedCells"],A5=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function k5(t){var e={sheet:1};return S5.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),A5.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=X1(t.password).toString(16).toUpperCase()),je("sheetProtection",null,e)}function C5(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=lt(Jt(e[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+Nt(s.location))):(s.Target="#"+Nt(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Dt(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var d=ot({c,r:l});n?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=s):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=s)}}}function F5(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function I5(t){return gl(t),je("pageMargins",null,t)}function b5(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=lt(e[n],!0);i.hidden&&(i.hidden=lr(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,Y1(i.width)),Lo(i);s<=a;)t[s++]=fr(i)}}function R5(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=je("col",null,Dp(i,n)));return r[r.length]="</cols>",r.join("")}function N5(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function D5(t,e,r,n){var i=typeof t.ref=="string"?t.ref:xt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=Ai(i);a.s.r==a.e.r&&(a.e.r=Ai(e["!ref"]).e.r,i=xt(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),je("autoFilter",null,{ref:i})}var P5=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function O5(t,e){e.Views||(e.Views=[{}]),(t.match(P5)||[]).forEach(function(r,n){var i=lt(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),lr(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function M5(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),je("sheetViews",je("sheetView",null,i),{})}function L5(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=Wa[t.v];break;case"d":n&&n.cellDates?i=ur(t.v,-1).toISOString():(t=fr(t),t.t="n",i=""+(t.v=nn(ur(t.v)))),typeof t.z>"u"&&(t.z=at[14]);break;default:i=t.v;break}var o=Cn("v",Gt(i)),l={r:e},c=Xo(n.cellXfs,t,n);switch(c!==0&&(l.s=c),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Cn("v",""+ev(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=a),typeof t.f=="string"&&t.f){var d=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=je("f",Gt(t.f),d)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),je("c",o,l)}var B5=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=Gf("v"),a=Gf("f");return function(l,c,d,h,p,g){for(var y=0,x="",E=[],T=[],A=0,_=0,O=0,H="",j,w,F=0,S=0,b,D,P=0,N=0,ze=Array.isArray(g.CellXf),ge,be=[],Se=[],ye=Array.isArray(c),Q=[],Ce={},Be=!1,V=!!d.sheetStubs,G=l.split(e),q=0,Y=G.length;q!=Y;++q){x=G[q].trim();var de=x.length;if(de!==0){var Ae=0;e:for(y=0;y<de;++y)switch(x[y]){case">":if(x[y-1]!="/"){++y;break e}if(d&&d.cellStyles){if(w=lt(x.slice(Ae,y),!0),F=w.r!=null?parseInt(w.r,10):F+1,S=-1,d.sheetRows&&d.sheetRows<F)continue;Ce={},Be=!1,w.ht&&(Be=!0,Ce.hpt=parseFloat(w.ht),Ce.hpx=Zc(Ce.hpt)),w.hidden=="1"&&(Be=!0,Ce.hidden=!0),w.outlineLevel!=null&&(Be=!0,Ce.level=+w.outlineLevel),Be&&(Q[F-1]=Ce)}break;case"<":Ae=y;break}if(Ae>=y)break;if(w=lt(x.slice(Ae,y),!0),F=w.r!=null?parseInt(w.r,10):F+1,S=-1,!(d.sheetRows&&d.sheetRows<F)){h.s.r>F-1&&(h.s.r=F-1),h.e.r<F-1&&(h.e.r=F-1),d&&d.cellStyles&&(Ce={},Be=!1,w.ht&&(Be=!0,Ce.hpt=parseFloat(w.ht),Ce.hpx=Zc(Ce.hpt)),w.hidden=="1"&&(Be=!0,Ce.hidden=!0),w.outlineLevel!=null&&(Be=!0,Ce.level=+w.outlineLevel),Be&&(Q[F-1]=Ce)),E=x.slice(y).split(t);for(var Pe=0;Pe!=E.length&&E[Pe].trim().charAt(0)=="<";++Pe);for(E=E.slice(Pe),y=0;y!=E.length;++y)if(x=E[y].trim(),x.length!==0){if(T=x.match(r),A=y,_=0,O=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,T!=null&&T.length===2){for(A=0,H=T[1],_=0;_!=H.length&&!((O=H.charCodeAt(_)-64)<1||O>26);++_)A=26*A+O;--A,S=A}else++S;for(_=0;_!=x.length&&x.charCodeAt(_)!==62;++_);if(++_,w=lt(x.slice(0,_),!0),w.r||(w.r=ot({r:F-1,c:S})),H=x.slice(_),j={t:""},(T=H.match(s))!=null&&T[1]!==""&&(j.v=Nt(T[1])),d.cellFormula){if((T=H.match(a))!=null&&T[1]!==""){if(j.f=Nt(Jt(T[1])).replace(/\r\n/g,`
`),d.xlfn||(j.f=m2(j.f)),T[0].indexOf('t="array"')>-1)j.F=(H.match(i)||[])[1],j.F.indexOf(":")>-1&&be.push([Dt(j.F),j.F]);else if(T[0].indexOf('t="shared"')>-1){D=lt(T[0]);var ke=Nt(Jt(T[1]));d.xlfn||(ke=m2(ke)),Se[parseInt(D.si,10)]=[D,ke,w.r]}}else(T=H.match(/<f[^>]*\/>/))&&(D=lt(T[0]),Se[D.si]&&(j.f=P6(Se[D.si][1],Se[D.si][2],w.r)));var we=Sr(w.r);for(_=0;_<be.length;++_)we.r>=be[_][0].s.r&&we.r<=be[_][0].e.r&&we.c>=be[_][0].s.c&&we.c<=be[_][0].e.c&&(j.F=be[_][1])}if(w.t==null&&j.v===void 0)if(j.f||j.F)j.v=0,j.t="n";else if(V)j.t="z";else continue;else j.t=w.t||"n";switch(h.s.c>S&&(h.s.c=S),h.e.c<S&&(h.e.c=S),j.t){case"n":if(j.v==""||j.v==null){if(!V)continue;j.t="z"}else j.v=parseFloat(j.v);break;case"s":if(typeof j.v>"u"){if(!V)continue;j.t="z"}else b=xf[parseInt(j.v,10)],j.v=b.t,j.r=b.r,d.cellHTML&&(j.h=b.h);break;case"str":j.t="s",j.v=j.v!=null?Jt(j.v):"",d.cellHTML&&(j.h=D1(j.v));break;case"inlineStr":T=H.match(n),j.t="s",T!=null&&(b=K1(T[1]))?(j.v=b.t,d.cellHTML&&(j.h=b.h)):j.v="";break;case"b":j.v=lr(j.v);break;case"d":d.cellDates?j.v=ur(j.v,1):(j.v=nn(ur(j.v,1)),j.t="n");break;case"e":(!d||d.cellText!==!1)&&(j.w=j.v),j.v=JS[j.v];break}if(P=N=0,ge=null,ze&&w.s!==void 0&&(ge=g.CellXf[w.s],ge!=null&&(ge.numFmtId!=null&&(P=ge.numFmtId),d.cellStyles&&ge.fillId!=null&&(N=ge.fillId))),YA(j,P,N,d,p,g),d.cellDates&&ze&&j.t=="n"&&du(at[P])&&(j.t="d",j.v=Ip(j.v)),w.cm&&d.xlmeta){var it=(d.xlmeta.Cell||[])[+w.cm-1];it&&it.type=="XLDAPR"&&(j.D=!0)}if(ye){var K=Sr(w.r);c[K.r]||(c[K.r]=[]),c[K.r][K.c]=j}else c[w.r]=j}}}}Q.length>0&&(c["!rows"]=Q)}}();function j5(t,e,r,n){var i=[],s=[],a=Dt(t["!ref"]),o="",l,c="",d=[],h=0,p=0,g=t["!rows"],y=Array.isArray(t),x={r:c},E,T=-1;for(p=a.s.c;p<=a.e.c;++p)d[p]=Tr(p);for(h=a.s.r;h<=a.e.r;++h){for(s=[],c=Vr(h),p=a.s.c;p<=a.e.c;++p){l=d[p]+c;var A=y?(t[h]||[])[p]:t[l];A!==void 0&&(o=L5(A,l,t,e))!=null&&s.push(o)}(s.length>0||g&&g[h])&&(x={r:c},g&&g[h]&&(E=g[h],E.hidden&&(x.hidden=1),T=-1,E.hpx?T=Zf(E.hpx):E.hpt&&(T=E.hpt),T>-1&&(x.ht=T,x.customHeight=1),E.level&&(x.outlineLevel=E.level)),i[i.length]=je("row",s.join(""),x))}if(g)for(;h<g.length;++h)g&&g[h]&&(x={r:h+1},E=g[h],E.hidden&&(x.hidden=1),T=-1,E.hpx?T=Zf(E.hpx):E.hpt&&(T=E.hpt),T>-1&&(x.ht=T,x.customHeight=1),E.level&&(x.outlineLevel=E.level),i[i.length]=je("row","",x));return i.join("")}function QA(t,e,r,n){var i=[Ur,je("worksheet",null,{xmlns:Ll[0],"xmlns:r":Zr.r})],s=r.SheetNames[t],a=0,o="",l=r.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",d=Dt(c);if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),c=xt(d)}n||(n={}),l["!comments"]=[];var h=[];T5(l,r,t,e,i),i[i.length]=je("dimension",null,{ref:c}),i[i.length]=M5(l,e,t,r),e.sheetFormat&&(i[i.length]=je("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=R5(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=j5(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=k5(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=D5(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=E5(l["!merges"]));var p=-1,g,y=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(g={ref:x[0]},x[1].Target.charAt(0)!="#"&&(y=$t(n,-1,Gt(x[1].Target).replace(/#.*$/,""),_t.HLINK),g["r:id"]="rId"+y),(p=x[1].Target.indexOf("#"))>-1&&(g.location=Gt(x[1].Target.slice(p+1))),x[1].Tooltip&&(g.tooltip=Gt(x[1].Tooltip)),i[i.length]=je("hyperlink",null,g))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=I5(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Cn("ignoredErrors",je("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(y=$t(n,-1,"../drawings/drawing"+(t+1)+".xml",_t.DRAW),i[i.length]=je("drawing",null,{"r:id":"rId"+y}),l["!drawing"]=h),l["!comments"].length>0&&(y=$t(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",_t.VML),i[i.length]=je("legacyDrawing",null,{"r:id":"rId"+y}),l["!legacy"]=y),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function V5(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function U5(t,e,r){var n=me(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=Zf(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:t,c:0},d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var h=-1,p=-1,g=d<<10;g<d+1<<10;++g){c.c=g;var y=Array.isArray(r)?(r[c.r]||[])[c.c]:r[ot(c)];y&&(h<0&&(h=g),p=g)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,p))}var x=n.l;return n.l=l,n.write_shift(4,o),n.l=x,n.length>n.l?n.slice(0,n.l):n}function z5(t,e,r,n){var i=U5(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&Ee(t,0,i)}var W5=Ul,H5=mu;function $5(){}function G5(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=YR(t),r}function K5(t,e,r){r==null&&(r=me(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Vh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),KS(t,r),r.slice(0,r.l)}function X5(t){var e=ps(t);return[e]}function Y5(t,e,r){return r==null&&(r=me(8)),Bl(e,r)}function q5(t){var e=jl(t);return[e]}function Q5(t,e,r){return r==null&&(r=me(4)),Vl(e,r)}function J5(t){var e=ps(t),r=t.read_shift(1);return[e,r,"b"]}function Z5(t,e,r){return r==null&&(r=me(9)),Bl(e,r),r.write_shift(1,t.v?1:0),r}function eO(t){var e=jl(t),r=t.read_shift(1);return[e,r,"b"]}function tO(t,e,r){return r==null&&(r=me(5)),Vl(e,r),r.write_shift(1,t.v?1:0),r}function rO(t){var e=ps(t),r=t.read_shift(1);return[e,r,"e"]}function nO(t,e,r){return r==null&&(r=me(9)),Bl(e,r),r.write_shift(1,t.v),r}function iO(t){var e=jl(t),r=t.read_shift(1);return[e,r,"e"]}function sO(t,e,r){return r==null&&(r=me(8)),Vl(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function aO(t){var e=ps(t),r=t.read_shift(4);return[e,r,"s"]}function oO(t,e,r){return r==null&&(r=me(12)),Bl(e,r),r.write_shift(4,e.v),r}function lO(t){var e=jl(t),r=t.read_shift(4);return[e,r,"s"]}function cO(t,e,r){return r==null&&(r=me(8)),Vl(e,r),r.write_shift(4,e.v),r}function uO(t){var e=ps(t),r=Kn(t);return[e,r,"n"]}function fO(t,e,r){return r==null&&(r=me(16)),Bl(e,r),kl(t.v,r),r}function JA(t){var e=jl(t),r=Kn(t);return[e,r,"n"]}function dO(t,e,r){return r==null&&(r=me(12)),Vl(e,r),kl(t.v,r),r}function hO(t){var e=ps(t),r=z1(t);return[e,r,"n"]}function pO(t,e,r){return r==null&&(r=me(12)),Bl(e,r),XS(t.v,r),r}function mO(t){var e=jl(t),r=z1(t);return[e,r,"n"]}function gO(t,e,r){return r==null&&(r=me(8)),Vl(e,r),XS(t.v,r),r}function xO(t){var e=ps(t),r=j1(t);return[e,r,"is"]}function vO(t){var e=ps(t),r=Xn(t);return[e,r,"str"]}function yO(t,e,r){return r==null&&(r=me(12+4*t.v.length)),Bl(e,r),dn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function _O(t){var e=jl(t),r=Xn(t);return[e,r,"str"]}function EO(t,e,r){return r==null&&(r=me(8+4*t.v.length)),Vl(e,r),dn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function wO(t,e,r){var n=t.l+e,i=ps(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=Np(t,n-t.l,r);a[3]=Wn(o,null,i,r.supbooks,r)}else t.l=n;return a}function TO(t,e,r){var n=t.l+e,i=ps(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=Np(t,n-t.l,r);a[3]=Wn(o,null,i,r.supbooks,r)}else t.l=n;return a}function SO(t,e,r){var n=t.l+e,i=ps(t);i.r=r["!row"];var s=Kn(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=Np(t,n-t.l,r);a[3]=Wn(o,null,i,r.supbooks,r)}else t.l=n;return a}function AO(t,e,r){var n=t.l+e,i=ps(t);i.r=r["!row"];var s=Xn(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=Np(t,n-t.l,r);a[3]=Wn(o,null,i,r.supbooks,r)}else t.l=n;return a}var kO=Ul,CO=mu;function FO(t,e){return e==null&&(e=me(4)),e.write_shift(4,t),e}function IO(t,e){var r=t.l+e,n=Ul(t),i=V1(t),s=Xn(t),a=Xn(t),o=Xn(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function bO(t,e){var r=me(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));mu({s:Sr(t[0]),e:Sr(t[0])},r),U1("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return dn(i||"",r),dn(t[1].Tooltip||"",r),dn("",r),r.slice(0,r.l)}function RO(){}function NO(t,e,r){var n=t.l+e,i=YS(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=r5(t,n-t.l,r);a[1]=o}else t.l=n;return a}function DO(t,e,r){var n=t.l+e,i=Ul(t),s=[i];if(r.cellFormula){var a=i5(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function PO(t,e,r){r==null&&(r=me(18));var n=Dp(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var ZA=["left","right","top","bottom","header","footer"];function OO(t){var e={};return ZA.forEach(function(r){e[r]=Kn(t)}),e}function MO(t,e){return e==null&&(e=me(6*8)),gl(t),ZA.forEach(function(r){kl(t[r],e)}),e}function LO(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function BO(t,e,r){r==null&&(r=me(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function jO(t){var e=me(24);return e.write_shift(4,4),e.write_shift(4,1),mu(t,e),e}function VO(t,e){return e==null&&(e=me(16*4+2)),e.write_shift(2,t.password?X1(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function UO(){}function zO(){}function WO(t,e,r,n,i,s,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,p=!1,g,y,x,E,T,A,_,O,H,j=[];o.biff=12,o["!row"]=0;var w=0,F=!1,S=[],b={},D=o.supbooks||i.supbooks||[[]];if(D.sharedf=b,D.arrayf=S,D.SheetNames=i.SheetNames||i.Sheets.map(function(ye){return ye.name}),!o.supbooks&&(o.supbooks=D,i.Names))for(var P=0;P<i.Names.length;++P)D[0][P+1]=i.Names[P];var N=[],ze=[],ge=!1;e0[16]={n:"BrtShortReal",f:JA};var be;if(za(t,function(Q,Ce,Be){if(!p)switch(Be){case 148:c=Q;break;case 0:g=Q,o.sheetRows&&o.sheetRows<=g.r&&(p=!0),O=Vr(E=g.r),o["!row"]=g.r,(Q.hidden||Q.hpt||Q.level!=null)&&(Q.hpt&&(Q.hpx=Zc(Q.hpt)),ze[Q.r]=Q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:Q[2]},Q[2]){case"n":y.v=Q[1];break;case"s":_=xf[Q[1]],y.v=_.t,y.r=_.r;break;case"b":y.v=!!Q[1];break;case"e":y.v=Q[1],o.cellText!==!1&&(y.w=Wa[y.v]);break;case"str":y.t="s",y.v=Q[1];break;case"is":y.t="s",y.v=Q[1].t;break}if((x=a.CellXf[Q[0].iStyleRef])&&YA(y,x.numFmtId,null,o,s,a),T=Q[0].c==-1?T+1:Q[0].c,o.dense?(l[E]||(l[E]=[]),l[E][T]=y):l[Tr(T)+O]=y,o.cellFormula){for(F=!1,w=0;w<S.length;++w){var V=S[w];g.r>=V[0].s.r&&g.r<=V[0].e.r&&T>=V[0].s.c&&T<=V[0].e.c&&(y.F=xt(V[0]),F=!0)}!F&&Q.length>3&&(y.f=Q[3])}if(d.s.r>g.r&&(d.s.r=g.r),d.s.c>T&&(d.s.c=T),d.e.r<g.r&&(d.e.r=g.r),d.e.c<T&&(d.e.c=T),o.cellDates&&x&&y.t=="n"&&du(at[x.numFmtId])){var G=cl(y.v);G&&(y.t="d",y.v=new Date(G.y,G.m-1,G.d,G.H,G.M,G.S,G.u))}be&&(be.type=="XLDAPR"&&(y.D=!0),be=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;y={t:"z",v:void 0},T=Q[0].c==-1?T+1:Q[0].c,o.dense?(l[E]||(l[E]=[]),l[E][T]=y):l[Tr(T)+O]=y,d.s.r>g.r&&(d.s.r=g.r),d.s.c>T&&(d.s.c=T),d.e.r<g.r&&(d.e.r=g.r),d.e.c<T&&(d.e.c=T),be&&(be.type=="XLDAPR"&&(y.D=!0),be=void 0);break;case 176:j.push(Q);break;case 49:be=((o.xlmeta||{}).Cell||[])[Q-1];break;case 494:var q=n["!id"][Q.relId];for(q?(Q.Target=q.Target,Q.loc&&(Q.Target+="#"+Q.loc),Q.Rel=q):Q.relId==""&&(Q.Target="#"+Q.loc),E=Q.rfx.s.r;E<=Q.rfx.e.r;++E)for(T=Q.rfx.s.c;T<=Q.rfx.e.c;++T)o.dense?(l[E]||(l[E]=[]),l[E][T]||(l[E][T]={t:"z",v:void 0}),l[E][T].l=Q):(A=ot({c:T,r:E}),l[A]||(l[A]={t:"z",v:void 0}),l[A].l=Q);break;case 426:if(!o.cellFormula)break;S.push(Q),H=o.dense?l[E][T]:l[Tr(T)+O],H.f=Wn(Q[1],d,{r:g.r,c:T},D,o),H.F=xt(Q[0]);break;case 427:if(!o.cellFormula)break;b[ot(Q[0].s)]=Q[1],H=o.dense?l[E][T]:l[Tr(T)+O],H.f=Wn(Q[1],d,{r:g.r,c:T},D,o);break;case 60:if(!o.cellStyles)break;for(;Q.e>=Q.s;)N[Q.e--]={width:Q.w/256,hidden:!!(Q.flags&1),level:Q.level},ge||(ge=!0,Y1(Q.w/256)),Lo(N[Q.e+1]);break;case 161:l["!autofilter"]={ref:xt(Q)};break;case 476:l["!margins"]=Q;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),Q.name&&(i.Sheets[r].CodeName=Q.name),(Q.above||Q.left)&&(l["!outline"]={above:Q.above,left:Q.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),Q.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!Ce.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+Be.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(d.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=xt(c||d)),o.sheetRows&&l["!ref"]){var Se=Dt(l["!ref"]);o.sheetRows<=+Se.e.r&&(Se.e.r=o.sheetRows-1,Se.e.r>d.e.r&&(Se.e.r=d.e.r),Se.e.r<Se.s.r&&(Se.s.r=Se.e.r),Se.e.c>d.e.c&&(Se.e.c=d.e.c),Se.e.c<Se.s.c&&(Se.s.c=Se.e.c),l["!fullref"]=l["!ref"],l["!ref"]=xt(Se))}return j.length>0&&(l["!merges"]=j),N.length>0&&(l["!cols"]=N),ze.length>0&&(l["!rows"]=ze),l}function HO(t,e,r,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=fr(e),e.z=e.z||at[14],e.v=nn(ur(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r,c:n};switch(l.s=Xo(i.cellXfs,e,i),e.l&&s["!links"].push([ot(l),e.l]),e.c&&s["!comments"].push([ot(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=ev(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?Ee(t,18,cO(e,l)):Ee(t,7,oO(e,l))):(l.t="str",a?Ee(t,17,EO(e,l)):Ee(t,6,yO(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?Ee(t,13,gO(e,l)):Ee(t,2,pO(e,l)):a?Ee(t,16,dO(e,l)):Ee(t,5,fO(e,l)),!0;case"b":return l.t="b",a?Ee(t,15,tO(e,l)):Ee(t,4,Z5(e,l)),!0;case"e":return l.t="e",a?Ee(t,14,sO(e,l)):Ee(t,3,nO(e,l)),!0}return a?Ee(t,12,Q5(e,l)):Ee(t,1,Y5(e,l)),!0}function $O(t,e,r,n){var i=Dt(e["!ref"]||"A1"),s,a="",o=[];Ee(t,145);var l=Array.isArray(e),c=i.e.r;e["!rows"]&&(c=Math.max(i.e.r,e["!rows"].length-1));for(var d=i.s.r;d<=c;++d){a=Vr(d),z5(t,e,i,d);var h=!1;if(d<=i.e.r)for(var p=i.s.c;p<=i.e.c;++p){d===i.s.r&&(o[p]=Tr(p)),s=o[p]+a;var g=l?(e[d]||[])[p]:e[s];if(!g){h=!1;continue}h=HO(t,g,d,p,n,e,h)}}Ee(t,146)}function GO(t,e){!e||!e["!merges"]||(Ee(t,177,FO(e["!merges"].length)),e["!merges"].forEach(function(r){Ee(t,176,CO(r))}),Ee(t,178))}function KO(t,e){!e||!e["!cols"]||(Ee(t,390),e["!cols"].forEach(function(r,n){r&&Ee(t,60,PO(n,r))}),Ee(t,391))}function XO(t,e){!e||!e["!ref"]||(Ee(t,648),Ee(t,649,jO(Dt(e["!ref"]))),Ee(t,650))}function YO(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=$t(r,-1,n[1].Target.replace(/#.*$/,""),_t.HLINK);Ee(t,494,bO(n,i))}}),delete e["!links"]}function qO(t,e,r,n){if(e["!comments"].length>0){var i=$t(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",_t.VML);Ee(t,551,U1("rId"+i)),e["!legacy"]=i}}function QO(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:xt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Ai(s);o.s.r==o.e.r&&(o.e.r=Ai(e["!ref"]).e.r,s=xt(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Ee(t,161,mu(Dt(s))),Ee(t,162)}}function JO(t,e,r){Ee(t,133),Ee(t,137,BO(e,r)),Ee(t,138),Ee(t,134)}function ZO(t,e){e["!protect"]&&Ee(t,535,VO(e["!protect"]))}function eM(t,e,r,n){var i=Si(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=Dt(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Ee(i,129),(r.vbaraw||a["!outline"])&&Ee(i,147,K5(o,a["!outline"])),Ee(i,148,H5(l)),JO(i,a,r.Workbook),KO(i,a),$O(i,a,t,e),ZO(i,a),QO(i,a,r,t),GO(i,a),YO(i,a,n),a["!margins"]&&Ee(i,476,MO(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&XO(i,a),qO(i,a,t,n),Ee(i,130),i.end()}function tM(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var i=Nt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function rM(t,e,r,n,i,s){var a=s||{"!type":"chart"};if(!t)return s;var o=0,l=0,c="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var p=tM(h);d.s.r=d.s.c=0,d.e.c=o,c=Tr(o),p[0].forEach(function(g,y){a[c+Vr(y)]={t:"n",v:g,z:p[1]},l=y}),d.e.r<l&&(d.e.r=l),++o}),o>0&&(a["!ref"]=xt(d)),a}function nM(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(qA);return o&&tv(o[0],s,i,r),(a=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function iM(t,e){t.l+=10;var r=Xn(t);return{name:r}}function sM(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return za(t,function(l,c,d){switch(d){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var rv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],aM=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],oM=[],lM=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function _2(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=lr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function E2(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=lr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function ek(t){E2(t.WBProps,rv),E2(t.CalcPr,lM),_2(t.WBView,aM),_2(t.Sheets,oM),jc.date1904=lr(t.WBProps.date1904)}function cM(t){return!t.Workbook||!t.Workbook.WBProps?"false":lr(t.Workbook.WBProps.date1904)?"true":"false"}var uM="][*?/\\".split("");function tk(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return uM.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function fM(t,e,r){t.forEach(function(n,i){tk(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function dM(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];fM(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)c5(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var hM=/<\w+:workbook/;function pM(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(t.replace(Jn,function(l,c){var d=lt(l);switch(sa(d[0])){case"<?xml":break;case"<workbook":l.match(hM)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=d[i];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":rv.forEach(function(h){if(d[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=lr(d[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(d[h[0]],10);break;default:r.WBProps[h[0]]=d[h[0]]}}),d.codeName&&(r.WBProps.CodeName=Jt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Nt(Jt(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Jt(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),lr(d.hidden||"0")&&(s.Hidden=!0),a=c+l.length;break;case"</definedName>":s.Ref=Nt(Jt(t.slice(a,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return l}),Ll.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return ek(r),r}function rk(t){var e=[Ur];e[e.length]=je("workbook",null,{xmlns:Ll[0],"xmlns:r":Zr.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(rv.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=je("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:Gt(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=je("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=je("definedName",Gt(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function mM(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=qg(t),r.name=Xn(t),r}function gM(t,e){return e||(e=me(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),U1(t.strRelID,e),dn(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function xM(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?Xn(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function vM(t,e){e||(e=me(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),KS(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function yM(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function _M(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=qR(t),a=n5(t,0,r),o=V1(t);t.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function EM(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],e0[16]={n:"BrtFRTArchID$",f:yM},za(t,function(l,c,d){switch(d){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=Wn(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([d,l]):a[0]=[d,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(d),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},e),ek(r),r.Names=s,r.supbooks=a,r}function wM(t,e){Ee(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Ee(t,156,gM(i))}Ee(t,144)}function TM(t,e){e||(e=me(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return dn("SheetJS",e),dn(Dh.version,e),dn(Dh.version,e),dn("7262",e),e.length>e.l?e.slice(0,e.l):e}function SM(t,e){e||(e=me(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function AM(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(Ee(t,135),Ee(t,158,SM(i)),Ee(t,136))}}function kM(t,e){var r=Si();return Ee(r,131),Ee(r,128,TM()),Ee(r,153,vM(t.Workbook&&t.Workbook.WBProps||null)),AM(r,t),wM(r,t),Ee(r,132),r.end()}function CM(t,e,r){return e.slice(-4)===".bin"?EM(t,r):pM(t,r)}function FM(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?WO(t,n,r,i,s,a,o):_5(t,n,r,i,s,a,o)}function IM(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?sM(t,n,r,i,s):nM(t,n,r,i,s)}function bM(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?N6():D6()}function RM(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?b6():R6()}function NM(t,e,r,n){return e.slice(-4)===".bin"?CP(t,r,n):mP(t,r,n)}function DM(t,e,r){return MA(t,r)}function PM(t,e,r){return e.slice(-4)===".bin"?PD(t,r):RD(t,r)}function OM(t,e,r){return e.slice(-4)===".bin"?A6(t,r):g6(t,r)}function MM(t,e,r){return e.slice(-4)===".bin"?h6(t):f6(t)}function LM(t,e,r,n){return r.slice(-4)===".bin"?p6(t,e,r,n):void 0}function BM(t,e,r){return e.slice(-4)===".bin"?l6(t,e,r):u6(t,e,r)}function jM(t,e,r){return(e.slice(-4)===".bin"?kM:rk)(t)}function VM(t,e,r,n,i){return(e.slice(-4)===".bin"?eM:QA)(t,r,n,i)}function UM(t,e,r){return(e.slice(-4)===".bin"?LP:PA)(t,r)}function zM(t,e,r){return(e.slice(-4)===".bin"?LD:kA)(t,r)}function WM(t,e,r){return(e.slice(-4)===".bin"?k6:jA)(t)}function HM(t){return(t.slice(-4)===".bin"?c6:LA)()}var nk=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,ik=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ws(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(nk),s,a,o,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(ik),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function $M(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(nk),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(ik),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var yf;function GM(t,e){var r=yf[t]||Nt(t);return r==="General"?Sl(e):hs(r,e)}function KM(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=lr(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=ur(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Nt(e)]=i}function XM(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Wa[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=$f(t.v):t.w=Sl(t.v):t.w=GM(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=yf[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&du(n)){var i=cl(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function YM(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=oP[n.Pattern]||n.Pattern)}t[e.ID]=e}function qM(t,e,r,n,i,s,a,o,l,c){var d="General",h=n.StyleID,p={};c=c||{};var g=[],y=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&a&&(h=a.StyleID);s[h]!==void 0&&(s[h].nf&&(d=s[h].nf),s[h].Interior&&g.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=lr(t);break;case"String":n.t="s",n.r=B_(Nt(t)),n.v=t.indexOf("<")>-1?Nt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(ur(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Nt(t):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=JS[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=B_(e||t));break}if(XM(n,d,c),c.cellFormula!==!1)if(n.Formula){var x=Nt(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=Bc(x,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Bc("RC:RC",i):n.ArrayRange&&(n.F=Bc(n.ArrayRange,i),l.push([Dt(n.F),n.F]))}else for(y=0;y<l.length;++y)i.r>=l[y][0].s.r&&i.r<=l[y][0].e.r&&i.c>=l[y][0].s.c&&i.c<=l[y][0].e.c&&(n.F=l[y][1]);c.cellStyles&&(g.forEach(function(E){!p.patternType&&E.patternType&&(p.patternType=E.patternType)}),n.s=p),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function QM(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Nm(t,e){var r=e||{};hu();var n=qu(P1(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Jt(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=fr(r);return a.type="string",Jc.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Zt){i.indexOf("<"+Zt)>=0&&(s=!0)}),s)return ML(n,r);yf={"General Number":"General","General Date":at[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":at[15],"Short Date":at[14],"Long Time":at[19],"Medium Time":at[18],"Short Time":at[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:at[2],Standard:at[4],Percent:at[10],Scientific:at[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,d={},h=[],p=r.dense?[]:{},g="",y={},x={},E=ws('<Data ss:Type="String">'),T=0,A=0,_=0,O={s:{r:2e6,c:2e6},e:{r:0,c:0}},H={},j={},w="",F=0,S=[],b={},D={},P=0,N=[],ze=[],ge={},be=[],Se,ye=!1,Q=[],Ce=[],Be={},V=0,G=0,q={Sheets:[],WBProps:{date1904:!1}},Y={};Xf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var de="";o=Xf.exec(n);)switch(o[3]=(de=o[3]).toLowerCase()){case"data":if(de=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?qM(n.slice(T,o.index),w,E,l[l.length-1][0]=="comment"?ge:y,{c:A,r:_},H,be[A],x,Q,r):(w="",E=ws(o[0]),T=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ze.length>0&&(y.c=ze),(!r.sheetRows||r.sheetRows>_)&&y.v!==void 0&&(r.dense?(p[_]||(p[_]=[]),p[_][A]=y):p[Tr(A)+Vr(_)]=y),y.HRef&&(y.l={Target:Nt(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(V=A+(parseInt(y.MergeAcross,10)|0),G=_+(parseInt(y.MergeDown,10)|0),S.push({s:{c:A,r:_},e:{c:V,r:G}})),!r.sheetStubs)y.MergeAcross?A=V+1:++A;else if(y.MergeAcross||y.MergeDown){for(var Ae=A;Ae<=V;++Ae)for(var Pe=_;Pe<=G;++Pe)(Ae>A||Pe>_)&&(r.dense?(p[Pe]||(p[Pe]=[]),p[Pe][Ae]={t:"z"}):p[Tr(Ae)+Vr(Pe)]={t:"z"});A=V+1}else++A;else y=$M(o[0]),y.Index&&(A=+y.Index-1),A<O.s.c&&(O.s.c=A),A>O.e.c&&(O.e.c=A),o[0].slice(-2)==="/>"&&++A,ze=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(_<O.s.r&&(O.s.r=_),_>O.e.r&&(O.e.r=_),o[0].slice(-2)==="/>"&&(x=ws(o[0]),x.Index&&(_=+x.Index-1)),A=0,++_):(x=ws(o[0]),x.Index&&(_=+x.Index-1),Be={},(x.AutoFitHeight=="0"||x.Height)&&(Be.hpx=parseInt(x.Height,10),Be.hpt=Zf(Be.hpx),Ce[_]=Be),x.Hidden=="1"&&(Be.hidden=!0,Ce[_]=Be));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(g),O.s.r<=O.e.r&&O.s.c<=O.e.c&&(p["!ref"]=xt(O),r.sheetRows&&r.sheetRows<=O.e.r&&(p["!fullref"]=p["!ref"],O.e.r=r.sheetRows-1,p["!ref"]=xt(O))),S.length&&(p["!merges"]=S),be.length>0&&(p["!cols"]=be),Ce.length>0&&(p["!rows"]=Ce),d[g]=p}else O={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=A=0,l.push([o[3],!1]),c=ws(o[0]),g=Nt(c.Name),p=r.dense?[]:{},S=[],Q=[],Ce=[],Y={name:g,Hidden:0},q.Sheets.push(Y);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),be=[],ye=!1}break;case"style":o[1]==="/"?YM(H,j,r):j=ws(o[0]);break;case"numberformat":j.nf=Nt(ws(o[0]).Format||"General"),yf[j.nf]&&(j.nf=yf[j.nf]);for(var ke=0;ke!=392&&at[ke]!=j.nf;++ke);if(ke==392){for(ke=57;ke!=392;++ke)if(at[ke]==null){Ca(j.nf,ke);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(Se=ws(o[0]),Se.Hidden&&(Se.hidden=!0,delete Se.Hidden),Se.Width&&(Se.wpx=parseInt(Se.Width,10)),!ye&&Se.wpx>10){ye=!0,$n=NA;for(var we=0;we<be.length;++we)be[we]&&Lo(be[we])}ye&&Lo(Se),be[Se.Index-1||be.length]=Se;for(var it=0;it<+Se.Span;++it)be[be.length]=fr(Se);break;case"namedrange":if(o[1]==="/")break;q.Names||(q.Names=[]);var K=lt(o[0]),Bt={Name:K.Name,Ref:Bc(K.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(Bt.Sheet=q.Sheets.length-1),q.Names.push(Bt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?w+=n.slice(F,o.index):F=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;j.Interior=ws(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?EN(b,de,n.slice(P,o.index)):P=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));QM(ge),ze.push(ge)}else l.push([o[3],!1]),c=ws(o[0]),ge={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var gt=ws(o[0]);p["!autofilter"]={ref:Bc(gt.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return k2(n,r);var bt=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:bt=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:bt=!1}break;case"excelworkbook":switch(o[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:bt=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:bt=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(P,o.index)){case"SheetHidden":Y.Hidden=1;break;case"SheetVeryHidden":Y.Hidden=2;break}else P=o.index+o[0].length;break;case"header":p["!margins"]||gl(p["!margins"]={},"xlml"),isNaN(+lt(o[0]).Margin)||(p["!margins"].header=+lt(o[0]).Margin);break;case"footer":p["!margins"]||gl(p["!margins"]={},"xlml"),isNaN(+lt(o[0]).Margin)||(p["!margins"].footer=+lt(o[0]).Margin);break;case"pagemargins":var ht=lt(o[0]);p["!margins"]||gl(p["!margins"]={},"xlml"),isNaN(+ht.Top)||(p["!margins"].top=+ht.Top),isNaN(+ht.Left)||(p["!margins"].left=+ht.Left),isNaN(+ht.Right)||(p["!margins"].right=+ht.Right),isNaN(+ht.Bottom)||(p["!margins"].bottom=+ht.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:bt=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:bt=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:bt=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:bt=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:bt=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:bt=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:bt=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:bt=!1}break;case"smarttags":break;default:bt=!1;break}if(bt||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?KM(D,de,N,n.slice(P,o.index)):(N=o,P=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var $e={};return!r.bookSheets&&!r.bookProps&&($e.Sheets=d),$e.SheetNames=h,$e.Workbook=q,$e.SSF=fr(at),$e.Props=b,$e.Custprops=D,$e}function nx(t,e){switch(iv(e=e||{}),e.type||"base64"){case"base64":return Nm(zi(t),e);case"binary":case"buffer":case"file":return Nm(t,e);case"array":return Nm(Go(t),e)}}function JM(t,e){var r=[];return t.Props&&r.push(wN(t.Props,e)),t.Custprops&&r.push(TN(t.Props,t.Custprops)),r.join("")}function ZM(){return""}function eL(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(je("NumberFormat",null,{"ss:Format":Gt(at[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(je("Style",s.join(""),a))}),je("Styles",r.join(""))}function sk(t){return je("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+J1(t.Ref,{r:0,c:0})})}function tL(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(sk(i)))}return je("Names",r.join(""))}function rL(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(sk(o)))}return s.join("")}function nL(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(je("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(je("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(je("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(je("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(Cn("ProtectContents","True")),t["!protect"].objects&&i.push(Cn("ProtectObjects","True")),t["!protect"].scenarios&&i.push(Cn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(Cn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(Cn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":je("WorksheetOptions",i.join(""),{xmlns:Pi.x})}function iL(t){return t.map(function(e){var r=AR(e.t||""),n=je("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return je("Comment",n,{"ss:Author":e.a})}).join("")}function sL(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+Gt(J1(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var l=Sr(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=Gt(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=Gt(t.l.Tooltip))),r["!merges"])for(var c=r["!merges"],d=0;d!=c.length;++d)c[d].s.c!=a.c||c[d].s.r!=a.r||(c[d].e.c>c[d].s.c&&(o["ss:MergeAcross"]=c[d].e.c-c[d].s.c),c[d].e.r>c[d].s.r&&(o["ss:MergeDown"]=c[d].e.r-c[d].s.r));var h="",p="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",p=String(t.v);break;case"b":h="Boolean",p=t.v?"1":"0";break;case"e":h="Error",p=Wa[t.v];break;case"d":h="DateTime",p=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||at[14]);break;case"s":h="String",p=SR(t.v||"");break}var g=Xo(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+g),o["ss:Index"]=a.c+1;var y=t.v!=null?p:"",x=t.t=="z"?"":'<Data ss:Type="'+h+'">'+y+"</Data>";return(t.c||[]).length>0&&(x+=iL(t.c)),je("Cell",x,o)}function aL(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Zc(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function oL(t,e,r,n){if(!t["!ref"])return"";var i=Dt(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(E,T){Lo(E);var A=!!E.width,_=Dp(T,E),O={"ss:Index":T+1};A&&(O["ss:Width"]=Qf(_.width)),E.hidden&&(O["ss:Hidden"]="1"),o.push(je("Column",null,O))});for(var l=Array.isArray(t),c=i.s.r;c<=i.e.r;++c){for(var d=[aL(c,(t["!rows"]||[])[c])],h=i.s.c;h<=i.e.c;++h){var p=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>h)&&!(s[a].s.r>c)&&!(s[a].e.c<h)&&!(s[a].e.r<c)){(s[a].s.c!=h||s[a].s.r!=c)&&(p=!0);break}if(!p){var g={r:c,c:h},y=ot(g),x=l?(t[c]||[])[h]:t[y];d.push(sL(x,y,t,e,r,n,g))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function lL(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?rL(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?oL(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(nL(s,e,t,r)),n.join("")}function cL(t,e){e||(e={}),t.SSF||(t.SSF=fr(at)),t.SSF&&(hu(),kp(t.SSF),e.revssf=Fp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Xo(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(JM(t,e)),r.push(ZM()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(je("Worksheet",lL(n,e,t),{"ss:Name":Gt(t.SheetNames[n])}));return r[2]=eL(t,e),r[3]=tL(t),Ur+je("Workbook",r.join(""),{xmlns:Pi.ss,"xmlns:o":Pi.o,"xmlns:x":Pi.x,"xmlns:ss":Pi.ss,"xmlns:dt":Pi.dt,"xmlns:html":Pi.html})}function uL(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=tN(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=rN(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var fL=[60,1084,2066,2165,2175];function dL(t,e,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var l=Ea(r,r.l),c=ix[l],d=0;c!=null&&fL.indexOf(l)>-1;)s=Ea(r,r.l+2),d=r.l+4,l==2066?d+=4:(l==2165||l==2175)&&(d+=12),o=r.slice(d,r.l+4+s),a.push(o),r.l+=4+s,c=ix[l=Ea(r,r.l)];var h=fn(a);kn(h,0);var p=0;h.lens=[];for(var g=0;g<a.length;++g)h.lens.push(p),p+=a[g].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,i)}function Ws(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=at[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Wa[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=$f(t.v):t.w=Sl(t.v):t.w=hs(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&du(at[n]||String(n))){var i=cl(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Id(t,e,r){return{v:t,ixfe:e,t:r}}function hL(t,e){var r={opts:{}},n={},i=e.dense?[]:{},s={},a={},o=null,l=[],c="",d={},h,p="",g,y,x,E,T={},A=[],_,O,H=[],j=[],w={Sheets:[],WBProps:{date1904:!1},Views:[{}]},F={},S=function(ct){return ct<8?hl[ct]:ct<64&&j[ct-8]||hl[ct]},b=function(ct,ir,yr){var dr=ir.XF.data;if(!(!dr||!dr.patternType||!yr||!yr.cellStyles)){ir.s={},ir.s.patternType=dr.patternType;var Dn;(Dn=qf(S(dr.icvFore)))&&(ir.s.fgColor={rgb:Dn}),(Dn=qf(S(dr.icvBack)))&&(ir.s.bgColor={rgb:Dn})}},D=function(ct,ir,yr){if(!(Be>1)&&!(yr.sheetRows&&ct.r>=yr.sheetRows)){if(yr.cellStyles&&ir.XF&&ir.XF.data&&b(ct,ir,yr),delete ir.ixfe,delete ir.XF,h=ct,p=ot(ct),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),ct.r<a.s.r&&(a.s.r=ct.r),ct.c<a.s.c&&(a.s.c=ct.c),ct.r+1>a.e.r&&(a.e.r=ct.r+1),ct.c+1>a.e.c&&(a.e.c=ct.c+1),yr.cellFormula&&ir.f){for(var dr=0;dr<A.length;++dr)if(!(A[dr][0].s.c>ct.c||A[dr][0].s.r>ct.r)&&!(A[dr][0].e.c<ct.c||A[dr][0].e.r<ct.r)){ir.F=xt(A[dr][0]),(A[dr][0].s.c!=ct.c||A[dr][0].s.r!=ct.r)&&delete ir.f,ir.f&&(ir.f=""+Wn(A[dr][1],a,ct,Q,P));break}}yr.dense?(i[ct.r]||(i[ct.r]=[]),i[ct.r][ct.c]=ir):i[p]=ir}},P={enc:!1,sbcch:0,snames:[],sharedf:T,arrayf:A,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(P.password=e.password);var N,ze=[],ge=[],be=[],Se=[],ye=!1,Q=[];Q.SheetNames=P.snames,Q.sharedf=P.sharedf,Q.arrayf=P.arrayf,Q.names=[],Q.XTI=[];var Ce=0,Be=0,V=0,G=[],q=[],Y;P.codepage=1200,ks(1200);for(var de=!1;t.l<t.length-1;){var Ae=t.l,Pe=t.read_shift(2);if(Pe===0&&Ce===10)break;var ke=t.l===t.length?0:t.read_shift(2),we=ix[Pe];if(we&&we.f){if(e.bookSheets&&Ce===133&&Pe!==133)break;if(Ce=Pe,we.r===2||we.r==12){var it=t.read_shift(2);if(ke-=2,!P.enc&&it!==Pe&&((it&255)<<8|it>>8)!==Pe)throw new Error("rt mismatch: "+it+"!="+Pe);we.r==12&&(t.l+=10,ke-=10)}var K={};if(Pe===10?K=we.f(t,ke,P):K=dL(Pe,we,t,ke,P),Be==0&&[9,521,1033,2057].indexOf(Ce)===-1)continue;switch(Pe){case 34:r.opts.Date1904=w.WBProps.date1904=K;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(P.enc||(t.l=0),P.enc=K,!e.password)throw new Error("File is password-protected");if(K.valid==null)throw new Error("Encryption scheme unsupported");if(!K.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=K;break;case 66:var Bt=Number(K);switch(Bt){case 21010:Bt=1200;break;case 32768:Bt=1e4;break;case 32769:Bt=1252;break}ks(P.codepage=Bt),de=!0;break;case 317:P.rrtabid=K;break;case 25:P.winlocked=K;break;case 439:r.opts.RefreshAll=K;break;case 12:r.opts.CalcCount=K;break;case 16:r.opts.CalcDelta=K;break;case 17:r.opts.CalcIter=K;break;case 13:r.opts.CalcMode=K;break;case 14:r.opts.CalcPrecision=K;break;case 95:r.opts.CalcSaveRecalc=K;break;case 15:P.CalcRefMode=K;break;case 2211:r.opts.FullCalc=K;break;case 129:K.fDialog&&(i["!type"]="dialog"),K.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),K.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:H.push(K);break;case 430:Q.push([K]),Q[Q.length-1].XTI=[];break;case 35:case 547:Q[Q.length-1].push(K);break;case 24:case 536:Y={Name:K.Name,Ref:Wn(K.rgce,a,null,Q,P)},K.itab>0&&(Y.Sheet=K.itab-1),Q.names.push(Y),Q[0]||(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].push(K),K.Name=="_xlnm._FilterDatabase"&&K.itab>0&&K.rgce&&K.rgce[0]&&K.rgce[0][0]&&K.rgce[0][0][0]=="PtgArea3d"&&(q[K.itab-1]={ref:xt(K.rgce[0][0][1][2])});break;case 22:P.ExternCount=K;break;case 23:Q.length==0&&(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].XTI=Q[Q.length-1].XTI.concat(K),Q.XTI=Q.XTI.concat(K);break;case 2196:if(P.biff<8)break;Y!=null&&(Y.Comment=K[1]);break;case 18:i["!protect"]=K;break;case 19:K!==0&&P.WTF&&console.error("Password verifier: "+K);break;case 133:s[K.pos]=K,P.snames.push(K.name);break;case 10:{if(--Be)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=xt(a),e.sheetRows&&e.sheetRows<=a.e.r){var gt=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=xt(a),a.e.r=gt}a.e.r++,a.e.c++}ze.length>0&&(i["!merges"]=ze),ge.length>0&&(i["!objects"]=ge),be.length>0&&(i["!cols"]=be),Se.length>0&&(i["!rows"]=Se),w.Sheets.push(F)}c===""?d=i:n[c]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(P.biff===8&&(P.biff={9:2,521:3,1033:4}[Pe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[K.BIFFVer]||8),P.biffguess=K.BIFFVer==0,K.BIFFVer==0&&K.dt==4096&&(P.biff=5,de=!0,ks(P.codepage=28591)),P.biff==8&&K.BIFFVer==0&&K.dt==16&&(P.biff=2),Be++)break;if(i=e.dense?[]:{},P.biff<8&&!de&&(de=!0,ks(P.codepage=e.codepage||1252)),P.biff<5||K.BIFFVer==0&&K.dt==4096){c===""&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var bt={pos:t.l-ke,name:c};s[bt.pos]=bt,P.snames.push(c)}else c=(s[Ae]||{name:""}).name;K.dt==32&&(i["!type"]="chart"),K.dt==64&&(i["!type"]="macro"),ze=[],ge=[],P.arrayf=A=[],be=[],Se=[],ye=!1,F={Hidden:(s[Ae]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[K.r]||[])[K.c]:i[ot({c:K.c,r:K.r})])&&++K.c,_={ixfe:K.ixfe,XF:H[K.ixfe]||{},v:K.val,t:"n"},V>0&&(_.z=G[_.ixfe>>8&63]),Ws(_,e,r.opts.Date1904),D({c:K.c,r:K.r},_,e);break;case 5:case 517:_={ixfe:K.ixfe,XF:H[K.ixfe],v:K.val,t:K.t},V>0&&(_.z=G[_.ixfe>>8&63]),Ws(_,e,r.opts.Date1904),D({c:K.c,r:K.r},_,e);break;case 638:_={ixfe:K.ixfe,XF:H[K.ixfe],v:K.rknum,t:"n"},V>0&&(_.z=G[_.ixfe>>8&63]),Ws(_,e,r.opts.Date1904),D({c:K.c,r:K.r},_,e);break;case 189:for(var ht=K.c;ht<=K.C;++ht){var $e=K.rkrec[ht-K.c][0];_={ixfe:$e,XF:H[$e],v:K.rkrec[ht-K.c][1],t:"n"},V>0&&(_.z=G[_.ixfe>>8&63]),Ws(_,e,r.opts.Date1904),D({c:ht,r:K.r},_,e)}break;case 6:case 518:case 1030:{if(K.val=="String"){o=K;break}if(_=Id(K.val,K.cell.ixfe,K.tt),_.XF=H[_.ixfe],e.cellFormula){var Zt=K.formula;if(Zt&&Zt[0]&&Zt[0][0]&&Zt[0][0][0]=="PtgExp"){var pn=Zt[0][0][1][0],Yr=Zt[0][0][1][1],hi=ot({r:pn,c:Yr});T[hi]?_.f=""+Wn(K.formula,a,K.cell,Q,P):_.F=((e.dense?(i[pn]||[])[Yr]:i[hi])||{}).F}else _.f=""+Wn(K.formula,a,K.cell,Q,P)}V>0&&(_.z=G[_.ixfe>>8&63]),Ws(_,e,r.opts.Date1904),D(K.cell,_,e),o=K}break;case 7:case 519:if(o)o.val=K,_=Id(K,o.cell.ixfe,"s"),_.XF=H[_.ixfe],e.cellFormula&&(_.f=""+Wn(o.formula,a,o.cell,Q,P)),V>0&&(_.z=G[_.ixfe>>8&63]),Ws(_,e,r.opts.Date1904),D(o.cell,_,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{A.push(K);var $i=ot(K[0].s);if(g=e.dense?(i[K[0].s.r]||[])[K[0].s.c]:i[$i],e.cellFormula&&g){if(!o||!$i||!g)break;g.f=""+Wn(K[1],a,K[0],Q,P),g.F=xt(K[0])}}break;case 1212:{if(!e.cellFormula)break;if(p){if(!o)break;T[ot(o.cell)]=K[0],g=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[ot(o.cell)],(g||{}).f=""+Wn(K[0],a,h,Q,P)}}break;case 253:_=Id(l[K.isst].t,K.ixfe,"s"),l[K.isst].h&&(_.h=l[K.isst].h),_.XF=H[_.ixfe],V>0&&(_.z=G[_.ixfe>>8&63]),Ws(_,e,r.opts.Date1904),D({c:K.c,r:K.r},_,e);break;case 513:e.sheetStubs&&(_={ixfe:K.ixfe,XF:H[K.ixfe],t:"z"},V>0&&(_.z=G[_.ixfe>>8&63]),Ws(_,e,r.opts.Date1904),D({c:K.c,r:K.r},_,e));break;case 190:if(e.sheetStubs)for(var pi=K.c;pi<=K.C;++pi){var Fr=K.ixfe[pi-K.c];_={ixfe:Fr,XF:H[Fr],t:"z"},V>0&&(_.z=G[_.ixfe>>8&63]),Ws(_,e,r.opts.Date1904),D({c:pi,r:K.r},_,e)}break;case 214:case 516:case 4:_=Id(K.val,K.ixfe,"s"),_.XF=H[_.ixfe],V>0&&(_.z=G[_.ixfe>>8&63]),Ws(_,e,r.opts.Date1904),D({c:K.c,r:K.r},_,e);break;case 0:case 512:Be===1&&(a=K);break;case 252:l=K;break;case 1054:if(P.biff==4){G[V++]=K[1];for(var mi=0;mi<V+163&&at[mi]!=K[1];++mi);mi>=163&&Ca(K[1],V+163)}else Ca(K[1],K[0]);break;case 30:{G[V++]=K;for(var Pt=0;Pt<V+163&&at[Pt]!=K;++Pt);Pt>=163&&Ca(K,V+163)}break;case 229:ze=ze.concat(K);break;case 93:ge[K.cmo[0]]=P.lastobj=K;break;case 438:P.lastobj.TxO=K;break;case 127:P.lastobj.ImData=K;break;case 440:for(E=K[0].s.r;E<=K[0].e.r;++E)for(x=K[0].s.c;x<=K[0].e.c;++x)g=e.dense?(i[E]||[])[x]:i[ot({c:x,r:E})],g&&(g.l=K[1]);break;case 2048:for(E=K[0].s.r;E<=K[0].e.r;++E)for(x=K[0].s.c;x<=K[0].e.c;++x)g=e.dense?(i[E]||[])[x]:i[ot({c:x,r:E})],g&&g.l&&(g.l.Tooltip=K[1]);break;case 28:{if(P.biff<=5&&P.biff>=2)break;g=e.dense?(i[K[0].r]||[])[K[0].c]:i[ot(K[0])];var vr=ge[K[2]];g||(e.dense?(i[K[0].r]||(i[K[0].r]=[]),g=i[K[0].r][K[0].c]={t:"z"}):g=i[ot(K[0])]={t:"z"},a.e.r=Math.max(a.e.r,K[0].r),a.s.r=Math.min(a.s.r,K[0].r),a.e.c=Math.max(a.e.c,K[0].c),a.s.c=Math.min(a.s.c,K[0].c)),g.c||(g.c=[]),y={a:K[1],t:vr.TxO.t},g.c.push(y)}break;case 2173:e6(H[K.ixfe],K.ext);break;case 125:{if(!P.cellStyles)break;for(;K.e>=K.s;)be[K.e--]={width:K.w/256,level:K.level||0,hidden:!!(K.flags&1)},ye||(ye=!0,Y1(K.w/256)),Lo(be[K.e+1])}break;case 520:{var nr={};K.level!=null&&(Se[K.r]=nr,nr.level=K.level),K.hidden&&(Se[K.r]=nr,nr.hidden=!0),K.hpt&&(Se[K.r]=nr,nr.hpt=K.hpt,nr.hpx=Zc(K.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||gl(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Pe]]=K;break;case 161:i["!margins"]||gl(i["!margins"]={}),i["!margins"].header=K.header,i["!margins"].footer=K.footer;break;case 574:K.RTL&&(w.Views[0].RTL=!0);break;case 146:j=K;break;case 2198:N=K;break;case 140:O=K;break;case 442:c?F.CodeName=K||F.name:w.WBProps.CodeName=K||"ThisWorkbook";break}}else we||console.error("Missing Info for XLS Record 0x"+Pe.toString(16)),t.l+=ke}return r.SheetNames=Mr(s).sort(function(Zn,ct){return Number(Zn)-Number(ct)}).map(function(Zn){return s[Zn].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&q.forEach(function(Zn,ct){r.Sheets[r.SheetNames[ct]]["!autofilter"]=Zn}),r.Strings=l,r.SSF=fr(at),P.enc&&(r.Encryption=P.enc),N&&(r.Themes=N),r.Metadata={},O!==void 0&&(r.Metadata.Country=O),Q.names.length>0&&(w.Names=Q.names),r.Workbook=w,r}var _f={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function pL(t,e,r){var n=et.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=r2(n,Qg,_f.DSI);for(var s in i)e[s]=i[s]}catch(c){if(r.WTF)throw c}var a=et.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=r2(a,Jg,_f.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(iA(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function mL(t,e){var r=[],n=[],i=[],s=0,a,o=N_(Qg,"n"),l=N_(Jg,"n");if(t.Props)for(a=Mr(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=Mr(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var c=[];for(s=0;s<i.length;++s)fA.indexOf(i[s][0])>-1||nA.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&et.utils.cfb_add(e,"/SummaryInformation",n2(n,_f.SI,l,Jg)),(r.length||c.length)&&et.utils.cfb_add(e,"/DocumentSummaryInformation",n2(r,_f.DSI,o,Qg,c.length?c:null,_f.UDI))}function ak(t,e){e||(e={}),iv(e),A1(),e.codepage&&S1(e.codepage);var r,n;if(t.FullPaths){if(et.find(t,"/encryption"))throw new Error("File is password-protected");r=et.find(t,"!CompObj"),n=et.find(t,"/Workbook")||et.find(t,"/Book")}else{switch(e.type){case"base64":t=Mi(zi(t));break;case"binary":t=Mi(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}kn(t,0),n={content:t}}var i,s;if(r&&uL(r),e.bookProps&&!e.bookSheets)i={};else{var a=yt?"buffer":"array";if(n&&n.content)i=hL(n.content,e);else if((s=et.find(t,"PerfectOffice_MAIN"))&&s.content)i=ml.to_workbook(s.content,(e.type=a,e));else if((s=et.find(t,"NativeContent_MAIN"))&&s.content)i=ml.to_workbook(s.content,(e.type=a,e));else throw(s=et.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&et.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=F6(t))}var o={};return t.FullPaths&&pL(t,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=t),i}function gL(t,e){var r=e||{},n=et.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return et.utils.cfb_add(n,i,ok(t,r)),r.biff==8&&(t.Props||t.Custprops)&&mL(t,n),r.biff==8&&t.vbaraw&&I6(n,et.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var e0={0:{f:V5},1:{f:X5},2:{f:hO},3:{f:rO},4:{f:J5},5:{f:uO},6:{f:vO},7:{f:aO},8:{f:AO},9:{f:SO},10:{f:wO},11:{f:TO},12:{f:q5},13:{f:mO},14:{f:iO},15:{f:eO},16:{f:JA},17:{f:_O},18:{f:lO},19:{f:j1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:_M},40:{},42:{},43:{f:vP},44:{f:gP},45:{f:EP},46:{f:TP},47:{f:wP},48:{},49:{f:WR},50:{},51:{f:n6},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:wA},62:{f:xO},63:{f:d6},64:{f:UO},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:qn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:LO},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:G5},148:{f:W5,p:16},151:{f:RO},152:{},153:{f:xM},154:{},155:{},156:{f:mM},157:{},158:{},159:{T:1,f:DD},160:{T:-1},161:{T:1,f:Ul},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:kO},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:t6},336:{T:-1},337:{f:a6,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:qg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:EA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:NO},427:{f:DO},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:OO},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:$5},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:IO},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:qg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:T6},633:{T:1},634:{T:-1},635:{T:1,f:E6},636:{T:-1},637:{f:KR},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:iM},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:zO},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},ix={6:{f:bm},10:{f:io},12:{f:Kr},13:{f:Kr},14:{f:Lr},15:{f:Lr},16:{f:Kn},17:{f:Lr},18:{f:Lr},19:{f:Kr},20:{f:c2},21:{f:c2},23:{f:EA},24:{f:f2},25:{f:Lr},26:{},27:{},28:{f:z3},29:{},34:{f:Lr},35:{f:u2},38:{f:Kn},39:{f:Kn},40:{f:Kn},41:{f:Kn},42:{f:Lr},43:{f:Lr},47:{f:eP},49:{f:m3},51:{f:Kr},60:{},61:{f:u3},64:{f:Lr},65:{f:p3},66:{f:Kr},77:{},80:{},81:{},82:{},85:{f:Kr},89:{},90:{},91:{},92:{f:ZN},93:{f:$3},94:{},95:{f:Lr},96:{},97:{},99:{f:Lr},125:{f:wA},128:{f:b3},129:{f:t3},130:{f:Kr},131:{f:Lr},132:{f:Lr},133:{f:r3},134:{},140:{f:Z3},141:{f:Kr},144:{},146:{f:rD},151:{},152:{},153:{},154:{},155:{},156:{f:Kr},157:{},158:{},160:{f:cD},161:{f:sD},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:k3},190:{f:C3},193:{f:io},197:{},198:{},199:{},200:{},201:{},202:{f:Lr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Kr},220:{},221:{f:Lr},222:{},224:{f:I3},225:{f:JN},226:{f:io},227:{},229:{f:W3},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:i3},253:{f:x3},255:{f:a3},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:dA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Lr},353:{f:io},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:O3},431:{f:Lr},432:{},433:{},434:{},437:{},438:{f:X3},439:{f:Lr},440:{f:Y3},441:{},442:{f:E0},443:{},444:{f:Kr},445:{},446:{},448:{f:io},449:{f:c3,r:2},450:{f:io},512:{f:a2},513:{f:lD},515:{f:D3},516:{f:y3},517:{f:l2},519:{f:uD},520:{f:o3},523:{},545:{f:d2},549:{f:s2},566:{},574:{f:d3},638:{f:A3},659:{},1048:{},1054:{f:E3},1084:{},1212:{f:j3},2048:{f:Q3},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:kd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:io},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:nD,r:12},2173:{f:ZP,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Lr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:B3,r:12},2197:{},2198:{f:KP,r:12},2199:{},2200:{},2201:{},2202:{f:V3,r:12},2203:{f:io},2204:{},2205:{},2206:{},2207:{},2211:{f:l3},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Kr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:aD},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:tD},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:a2},1:{},2:{f:mD},3:{f:hD},4:{f:dD},5:{f:l2},7:{f:xD},8:{},9:{f:kd},11:{},22:{f:Kr},30:{f:T3},31:{},32:{},33:{f:d2},36:{},37:{f:s2},50:{f:vD},62:{},52:{},67:{},68:{f:Kr},69:{},86:{},126:{},127:{f:fD},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:yD},223:{},234:{},354:{},421:{},518:{f:bm},521:{f:kd},536:{f:f2},547:{f:u2},561:{},579:{},1030:{f:bm},1033:{f:kd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ve(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&M1(r)&&t.push(r)}}function xL(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return Ve(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var d=t.next(4);for(d.write_shift(2,s),d.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c;l<i;){for(d=t.next(4),d.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;d.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c}}}function A0(t,e,r){return t||(t=me(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function vL(t,e,r,n){var i=me(9);return A0(i,t,e),hA(r,n||"b",i),i}function yL(t,e,r){var n=me(8+2*r.length);return A0(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function _L(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?nn(ur(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?Ve(t,2,gD(r,n,i)):Ve(t,3,pD(r,n,i));return;case"b":case"e":Ve(t,5,vL(r,n,e.v,e.t));return;case"s":case"str":Ve(t,4,yL(r,n,(e.v||"").slice(0,255)));return}Ve(t,1,A0(null,r,n))}function EL(t,e,r,n){var i=Array.isArray(e),s=Dt(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=xt(s)}for(var c=s.s.r;c<=s.e.r;++c){o=Vr(c);for(var d=s.s.c;d<=s.e.c;++d){c===s.s.r&&(l[d]=Tr(d)),a=l[d]+o;var h=i?(e[c]||[])[d]:e[a];h&&_L(t,h,c,d)}}}function wL(t,e){for(var r=e||{},n=Si(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ve(n,r.biff==4?1033:r.biff==3?521:9,G1(t,16,r)),EL(n,t.Sheets[t.SheetNames[i]],i,r),Ve(n,10),n.end()}function TL(t,e,r){Ve(t,49,g3({sz:12,name:"Arial"},r))}function SL(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Ve(t,1054,w3(i,e[i],r))})}function AL(t,e){var r=me(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ve(t,2151,r),r=me(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),vA(Dt(e["!ref"]||"A1"),r),r.write_shift(4,4),Ve(t,2152,r)}function kL(t,e){for(var r=0;r<16;++r)Ve(t,224,o2({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Ve(t,224,o2(n,0,e))})}function CL(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Ve(t,440,q3(n)),n[1].Tooltip&&Ve(t,2048,J3(n))}delete e["!links"]}function FL(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&Ve(t,125,iD(Dp(i,n),i))})}}function IL(t,e,r,n,i){var s=16+Xo(i.cellXfs,e,i);if(e.v==null&&!e.bf){Ve(t,513,Fl(r,n,s));return}if(e.bf)Ve(t,6,t5(e,r,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?nn(ur(e.v)):e.v;Ve(t,515,P3(r,n,a,s));break;case"b":case"e":Ve(t,517,N3(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=ev(i.Strings,e.v,i.revStrings);Ve(t,253,v3(r,n,o,s))}else Ve(t,516,_3(r,n,(e.v||"").slice(0,255),s,i));break;default:Ve(t,513,Fl(r,n,s))}}function bL(t,e,r){var n=Si(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},l=Array.isArray(s),c=e.biff==8,d,h="",p=[],g=Dt(s["!ref"]||"A1"),y=c?65536:16384;if(g.e.c>255||g.e.r>=y){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,y-1)}Ve(n,2057,G1(r,16,e)),Ve(n,13,is(1)),Ve(n,12,is(100)),Ve(n,15,li(!0)),Ve(n,17,li(!1)),Ve(n,16,kl(.001)),Ve(n,95,li(!0)),Ve(n,42,li(!1)),Ve(n,43,li(!1)),Ve(n,130,is(1)),Ve(n,128,R3()),Ve(n,131,li(!1)),Ve(n,132,li(!1)),c&&FL(n,s["!cols"]),Ve(n,512,S3(g,e)),c&&(s["!links"]=[]);for(var x=g.s.r;x<=g.e.r;++x){h=Vr(x);for(var E=g.s.c;E<=g.e.c;++E){x===g.s.r&&(p[E]=Tr(E)),d=p[E]+h;var T=l?(s[x]||[])[E]:s[d];T&&(IL(n,T,x,E,e),c&&T.l&&s["!links"].push([d,T.l]))}}var A=o.CodeName||o.name||i;return c&&Ve(n,574,h3((a.Views||[])[0])),c&&(s["!merges"]||[]).length&&Ve(n,229,H3(s["!merges"])),c&&CL(n,s),Ve(n,442,pA(A)),c&&AL(n,s),Ve(n,10),n.end()}function RL(t,e,r){var n=Si(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(Ve(n,2057,G1(t,5,r)),r.bookType=="xla"&&Ve(n,135),Ve(n,225,o?is(1200):null),Ve(n,193,NN(2)),l&&Ve(n,191),l&&Ve(n,192),Ve(n,226),Ve(n,92,e3("SheetJS",r)),Ve(n,66,is(o?1200:1252)),o&&Ve(n,353,is(0)),o&&Ve(n,448),Ve(n,317,oD(t.SheetNames.length)),o&&t.vbaraw&&Ve(n,211),o&&t.vbaraw){var c=a.CodeName||"ThisWorkbook";Ve(n,442,pA(c))}Ve(n,156,is(17)),Ve(n,25,li(!1)),Ve(n,18,li(!1)),Ve(n,19,is(0)),o&&Ve(n,431,li(!1)),o&&Ve(n,444,is(0)),Ve(n,61,f3()),Ve(n,64,li(!1)),Ve(n,141,is(0)),Ve(n,34,li(cM(t)=="true")),Ve(n,14,li(!0)),o&&Ve(n,439,li(!1)),Ve(n,218,is(0)),TL(n,t,r),SL(n,t.SSF,r),kL(n,r),o&&Ve(n,352,li(!1));var d=n.end(),h=Si();o&&Ve(h,140,eD()),o&&r.Strings&&xL(h,252,s3(r.Strings)),Ve(h,10);var p=h.end(),g=Si(),y=0,x=0;for(x=0;x<t.SheetNames.length;++x)y+=(o?12:11)+(o?2:1)*t.SheetNames[x].length;var E=d.length+y+p.length;for(x=0;x<t.SheetNames.length;++x){var T=s[x]||{};Ve(g,133,n3({pos:E,hs:T.Hidden||0,dt:0,name:t.SheetNames[x]},r)),E+=e[x].length}var A=g.end();if(y!=A.length)throw new Error("BS8 "+y+" != "+A.length);var _=[];return d.length&&_.push(d),A.length&&_.push(A),p.length&&_.push(p),fn(_)}function NL(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=fr(at)),t&&t.SSF&&(hu(),kp(t.SSF),r.revssf=Fp(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,sv(r),r.cellXfs=[],Xo(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=bL(i,r,t);return n.unshift(RL(t,n,r)),fn(n)}function ok(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Ai(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return NL(t,e);case 4:case 3:case 2:return wL(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function w2(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),a=i.index,o=s&&s.index||t.length,l=gR(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,d=0,h=0,p=0,g={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(a=0;a<l.length;++a){var x=l[a].trim(),E=x.slice(0,3).toLowerCase();if(E=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}d=0;continue}if(!(E!="<td"&&E!="<th")){var T=x.split(/<\/t[dh]>/i);for(o=0;o<T.length;++o){var A=T[o].trim();if(A.match(/<t[dh]/i)){for(var _=A,O=0;_.charAt(0)=="<"&&(O=_.indexOf(">"))>-1;)_=_.slice(O+1);for(var H=0;H<y.length;++H){var j=y[H];j.s.c==d&&j.s.r<c&&c<=j.e.r&&(d=j.e.c+1,H=-1)}var w=lt(A.slice(0,A.indexOf(">")));p=w.colspan?+w.colspan:1,((h=+w.rowspan)>1||p>1)&&y.push({s:{r:c,c:d},e:{r:c+(h||1)-1,c:d+p-1}});var F=w.t||w["data-t"]||"";if(!_.length){d+=p;continue}if(_=RS(_),g.s.r>c&&(g.s.r=c),g.e.r<c&&(g.e.r=c),g.s.c>d&&(g.s.c=d),g.e.c<d&&(g.e.c=d),!_.length){d+=p;continue}var S={t:"s",v:_};r.raw||!_.trim().length||F=="s"||(_==="TRUE"?S={t:"b",v:!0}:_==="FALSE"?S={t:"b",v:!1}:isNaN(Rs(_))?isNaN(Qc(_).getDate())||(S={t:"d",v:ur(_)},r.cellDates||(S={t:"n",v:nn(S.v)}),S.z=r.dateNF||at[14]):S={t:"n",v:Rs(_)}),r.dense?(n[c]||(n[c]=[]),n[c][d]=S):n[ot({r:c,c:d})]=S,d+=p}}}}return n["!ref"]=xt(g),y.length&&(n["!merges"]=y),n}function DL(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>a)&&!(i[c].e.r<r||i[c].e.c<a)){if(i[c].s.r<r||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var d=ot({r,c:a}),h=n.dense?(t[r]||[])[a]:t[d],p=h&&h.v!=null&&(h.h||D1(h.w||(Pa(h),h.w)||""))||"",g={};o>1&&(g.rowspan=o),l>1&&(g.colspan=l),n.editable?p='<span contenteditable="true">'+p+"</span>":h&&(g["data-t"]=h&&h.t||"z",h.v!=null&&(g["data-v"]=h.v),h.z!=null&&(g["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+h.l.Target+'">'+p+"</a>")),g.id=(n.id||"sjs")+"-"+d,s.push(je("td",p,g))}}var y="<tr>";return y+s.join("")+"</tr>"}var PL='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',OL="</body></html>";function ML(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ko(w2(r[0],e),e);var n=lv();return r.forEach(function(i,s){cv(n,w2(i,e),"Sheet"+(s+1))}),n}function LL(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function lk(t,e){var r=e||{},n=r.header!=null?r.header:PL,i=r.footer!=null?r.footer:OL,s=[n],a=Ai(t["!ref"]);r.dense=Array.isArray(t),s.push(LL(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(DL(t,a,o,r));return s.push("</table>"+i),s.join("")}function ck(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Sr(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var d=Ai(t["!ref"]);c.s.r=Math.min(c.s.r,d.s.r),c.s.c=Math.min(c.s.c,d.s.c),c.e.r=Math.max(c.e.r,d.e.r),c.e.c=Math.max(c.e.c,d.e.c),i==-1&&(c.e.r=i=d.e.r+1)}var h=[],p=0,g=t["!rows"]||(t["!rows"]=[]),y=0,x=0,E=0,T=0,A=0,_=0;for(t["!cols"]||(t["!cols"]=[]);y<o.length&&x<l;++y){var O=o[y];if(T2(O)){if(n.display)continue;g[x]={hidden:!0}}var H=O.children;for(E=T=0;E<H.length;++E){var j=H[E];if(!(n.display&&T2(j))){var w=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):RS(j.innerHTML),F=j.getAttribute("data-z")||j.getAttribute("z");for(p=0;p<h.length;++p){var S=h[p];S.s.c==T+s&&S.s.r<x+i&&x+i<=S.e.r&&(T=S.e.c+1-s,p=-1)}_=+j.getAttribute("colspan")||1,((A=+j.getAttribute("rowspan")||1)>1||_>1)&&h.push({s:{r:x+i,c:T+s},e:{r:x+i+(A||1)-1,c:T+s+(_||1)-1}});var b={t:"s",v:w},D=j.getAttribute("data-t")||j.getAttribute("t")||"";w!=null&&(w.length==0?b.t=D||"z":n.raw||w.trim().length==0||D=="s"||(w==="TRUE"?b={t:"b",v:!0}:w==="FALSE"?b={t:"b",v:!1}:isNaN(Rs(w))?isNaN(Qc(w).getDate())||(b={t:"d",v:ur(w)},n.cellDates||(b={t:"n",v:nn(b.v)}),b.z=n.dateNF||at[14]):b={t:"n",v:Rs(w)})),b.z===void 0&&F!=null&&(b.z=F);var P="",N=j.getElementsByTagName("A");if(N&&N.length)for(var ze=0;ze<N.length&&!(N[ze].hasAttribute("href")&&(P=N[ze].getAttribute("href"),P.charAt(0)!="#"));++ze);P&&P.charAt(0)!="#"&&(b.l={Target:P}),n.dense?(t[x+i]||(t[x+i]=[]),t[x+i][T+s]=b):t[ot({c:T+s,r:x+i})]=b,c.e.c<T+s&&(c.e.c=T+s),T+=_}}++x}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,x-1+i),t["!ref"]=xt(c),x>=l&&(t["!fullref"]=xt((c.e.r=o.length-y+x-1+i,c))),t}function uk(t,e){var r=e||{},n=r.dense?[]:{};return ck(n,t,e)}function BL(t,e){return Ko(uk(t,e),e)}function T2(t){var e="",r=jL(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function jL(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function VL(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Nt(e.replace(/<[^>]*>/g,""));return[r]}var S2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function fk(t,e){var r=e||{},n=P1(t),i=[],s,a,o={name:""},l="",c=0,d,h,p={},g=[],y=r.dense?[]:{},x,E,T={value:""},A="",_=0,O=[],H=-1,j=-1,w={s:{r:1e6,c:1e7},e:{r:0,c:0}},F=0,S={},b=[],D={},P=0,N=0,ze=[],ge=1,be=1,Se=[],ye={Names:[]},Q={},Ce=["",""],Be=[],V={},G="",q=0,Y=!1,de=!1,Ae=0;for(Xf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=Xf.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(w.e.c>=w.s.c&&w.e.r>=w.s.r?y["!ref"]=xt(w):y["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=w.e.r&&(y["!fullref"]=y["!ref"],w.e.r=r.sheetRows-1,y["!ref"]=xt(w)),b.length&&(y["!merges"]=b),ze.length&&(y["!rows"]=ze),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),g.push(d.name),p[d.name]=y,de=!1):x[0].charAt(x[0].length-2)!=="/"&&(d=lt(x[0],!1),H=j=-1,w.s.r=w.s.c=1e7,w.e.r=w.e.c=0,y=r.dense?[]:{},b=[],ze=[],de=!0);break;case"table-row-group":x[1]==="/"?--F:++F;break;case"table-row":case"":if(x[1]==="/"){H+=ge,ge=1;break}if(h=lt(x[0],!1),h.?H=h.-1:H==-1&&(H=0),ge=+h["number-rows-repeated"]||1,ge<10)for(Ae=0;Ae<ge;++Ae)F>0&&(ze[H+Ae]={level:F});j=-1;break;case"covered-table-cell":x[1]!=="/"&&++j,r.sheetStubs&&(r.dense?(y[H]||(y[H]=[]),y[H][j]={t:"z"}):y[ot({r:H,c:j})]={t:"z"}),A="",O=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++j,T=lt(x[0],!1),be=parseInt(T["number-columns-repeated"]||"1",10),E={t:"z",v:null},T.formula&&r.cellFormula!=!1&&(E.f=y2(Nt(T.formula))),(T.||T["value-type"])=="string"&&(E.t="s",E.v=Nt(T["string-value"]||""),r.dense?(y[H]||(y[H]=[]),y[H][j]=E):y[ot({r:H,c:j})]=E),j+=be-1;else if(x[1]!=="/"){++j,A="",_=0,O=[],be=1;var Pe=ge?H+ge-1:H;if(j>w.e.c&&(w.e.c=j),j<w.s.c&&(w.s.c=j),H<w.s.r&&(w.s.r=H),Pe>w.e.r&&(w.e.r=Pe),T=lt(x[0],!1),Be=[],V={},E={t:T.||T["value-type"],v:null},r.cellFormula)if(T.formula&&(T.formula=Nt(T.formula)),T["number-matrix-columns-spanned"]&&T["number-matrix-rows-spanned"]&&(P=parseInt(T["number-matrix-rows-spanned"],10)||0,N=parseInt(T["number-matrix-columns-spanned"],10)||0,D={s:{r:H,c:j},e:{r:H+P-1,c:j+N-1}},E.F=xt(D),Se.push([D,E.F])),T.formula)E.f=y2(T.formula);else for(Ae=0;Ae<Se.length;++Ae)H>=Se[Ae][0].s.r&&H<=Se[Ae][0].e.r&&j>=Se[Ae][0].s.c&&j<=Se[Ae][0].e.c&&(E.F=Se[Ae][1]);switch((T["number-columns-spanned"]||T["number-rows-spanned"])&&(P=parseInt(T["number-rows-spanned"],10)||0,N=parseInt(T["number-columns-spanned"],10)||0,D={s:{r:H,c:j},e:{r:H+P-1,c:j+N-1}},b.push(D)),T["number-columns-repeated"]&&(be=parseInt(T["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=lr(T["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(T.value);break;case"percentage":E.t="n",E.v=parseFloat(T.value);break;case"currency":E.t="n",E.v=parseFloat(T.value);break;case"date":E.t="d",E.v=ur(T["date-value"]),r.cellDates||(E.t="n",E.v=nn(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=hR(T["time-value"])/86400,r.cellDates&&(E.t="d",E.v=Ip(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(T.);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",T["string-value"]!=null&&(A=Nt(T["string-value"]),O=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(Y=!1,E.t==="s"&&(E.v=A||"",O.length&&(E.R=O),Y=_==0),Q.Target&&(E.l=Q),Be.length>0&&(E.c=Be,Be=[]),A&&r.cellText!==!1&&(E.w=A),Y&&(E.t="z",delete E.v),(!Y||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=H))for(var ke=0;ke<ge;++ke){if(be=parseInt(T["number-columns-repeated"]||"1",10),r.dense)for(y[H+ke]||(y[H+ke]=[]),y[H+ke][j]=ke==0?E:fr(E);--be>0;)y[H+ke][j+be]=fr(E);else for(y[ot({r:H+ke,c:j})]=E;--be>0;)y[ot({r:H+ke,c:j+be})]=fr(E);w.e.c<=j&&(w.e.c=j)}be=parseInt(T["number-columns-repeated"]||"1",10),j+=be-1,be=0,E={},A="",O=[]}Q={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s;V.t=A,O.length&&(V.R=O),V.a=G,Be.push(V)}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);G="",q=0,A="",_=0,O=[];break;case"creator":x[1]==="/"?G=n.slice(q,x.index):q=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);A="",_=0,O=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(S[o.name]=l,(s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&(l="",o=lt(x[0],!1),i.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=lt(x[0],!1),l+=S2[x[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=lt(x[0],!1),l+=S2[x[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,x.index);break}else c=x.index+x[0].length;break;case"named-range":a=lt(x[0],!1),Ce=Rm(a["cell-range-address"]);var we={Name:a.name,Ref:Ce[0]+"!"+Ce[1]};de&&(we.Sheet=g.length),ye.Names.push(we);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(x[1]==="/"&&(!T||!T["string-value"])){var it=VL(n.slice(_,x.index));A=(A.length>0?A+`
`:"")+it[0]}else lt(x[0],!1),_=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{Ce=Rm(lt(x[0])["target-range-address"]),p[Ce[0]]["!autofilter"]={ref:Ce[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(Q=lt(x[0],!1),!Q.href)break;Q.Target=Nt(Q.href),delete Q.href,Q.Target.charAt(0)=="#"&&Q.Target.indexOf(".")>-1?(Ce=Rm(Q.Target.slice(1)),Q.Target="#"+Ce[0]+"!"+Ce[1]):Q.Target.match(/^\.\.[\\\/]/)&&(Q.Target=Q.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var K={Sheets:p,SheetNames:g,Workbook:ye};return r.bookSheets&&delete K.Sheets,K}function A2(t,e){e=e||{},ns(t,"META-INF/manifest.xml")&&hN(Gr(t,"META-INF/manifest.xml"),e);var r=Li(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=fk(Jt(r),e);return ns(t,"meta.xml")&&(n.Props=tA(Gr(t,"meta.xml"))),n}function k2(t,e){return fk(t,e)}var UL=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Kf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Ur+e}}(),C2=function(){var t=function(s){return Gt(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+Gt(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,d=0,h=Ai(s["!ref"]||"A1"),p=s["!merges"]||[],g=0,y=Array.isArray(s);if(s["!cols"])for(d=0;d<=h.e.c;++d)l.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var x="",E=s["!rows"]||[];for(c=0;c<h.s.r;++c)x=E[c]?' table:style-name="ro'+E[c].ods+'"':"",l.push("        <table:table-row"+x+`></table:table-row>
`);for(;c<=h.e.r;++c){for(x=E[c]?' table:style-name="ro'+E[c].ods+'"':"",l.push("        <table:table-row"+x+`>
`),d=0;d<h.s.c;++d)l.push(e);for(;d<=h.e.c;++d){var T=!1,A={},_="";for(g=0;g!=p.length;++g)if(!(p[g].s.c>d)&&!(p[g].s.r>c)&&!(p[g].e.c<d)&&!(p[g].e.r<c)){(p[g].s.c!=d||p[g].s.r!=c)&&(T=!0),A["table:number-columns-spanned"]=p[g].e.c-p[g].s.c+1,A["table:number-rows-spanned"]=p[g].e.r-p[g].s.r+1;break}if(T){l.push(r);continue}var O=ot({r:c,c:d}),H=y?(s[c]||[])[d]:s[O];if(H&&H.f&&(A["table:formula"]=Gt(o5(H.f)),H.F&&H.F.slice(0,O.length)==O)){var j=Ai(H.F);A["table:number-matrix-columns-spanned"]=j.e.c-j.s.c+1,A["table:number-matrix-rows-spanned"]=j.e.r-j.s.r+1}if(!H){l.push(e);continue}switch(H.t){case"b":_=H.v?"TRUE":"FALSE",A["office:value-type"]="boolean",A["office:boolean-value"]=H.v?"true":"false";break;case"n":_=H.w||String(H.v||0),A["office:value-type"]="float",A["office:value"]=H.v||0;break;case"s":case"str":_=H.v==null?"":H.v,A["office:value-type"]="string";break;case"d":_=H.w||ur(H.v).toISOString(),A["office:value-type"]="date",A["office:date-value"]=ur(H.v).toISOString(),A["table:style-name"]="ce1";break;default:l.push(e);continue}var w=t(_);if(H.l&&H.l.Target){var F=H.l.Target;F=F.charAt(0)=="#"?"#"+l5(F.slice(1)):F,F.charAt(0)!="#"&&!F.match(/^\w+:/)&&(F="../"+F),w=je("text:a",w,{"xlink:href":F.replace(/&/g,"&amp;")})}l.push("          "+je("table:table-cell",je("text:p",w,{}),A)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var d=0;d<c["!cols"].length;++d)if(c["!cols"][d]){var h=c["!cols"][d];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Lo(h),h.ods=o;var p=c["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var d=0;d<c["!rows"].length;++d)if(c["!rows"][d]){c["!rows"][d].ods=l;var h=c["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[Ur],c=Kf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Kf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+d+`>
`),l.push(eA().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=a.SheetNames.length;++h)l.push(n(a.Sheets[a.SheetNames[h]],a,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function dk(t,e){if(e.bookType=="fods")return C2(t,e);var r=b1(),n="",i=[],s=[];return n="mimetype",vt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",vt(r,n,C2(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",vt(r,n,UL(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",vt(r,n,Ur+eA()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",vt(r,n,gN(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",vt(r,n,pN(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Il(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function sx(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Jt(Go(t))}function zL(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Mi(qs(t))}function WL(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function jo(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function F2(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function HL(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function $L(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function t0(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Ht(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Or(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Mt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=t0(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=t0(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function Tn(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(Ht(n*8+i.type)),i.type==2&&e.push(Ht(i.data.length)),e.push(i.data))})}),jo(e)}function nv(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function ts(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=t0(t,n),s=Mt(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:Or(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=Mt(o.data),c=Or(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=s[3])!=null&&e[0]&&(a.merge=Or(s[3][0].data)>>>0>0),r.push(a)}return r}function cc(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:Ht(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Ht(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Ht(a.data.length)}],n[2].push({data:Tn(a.meta),type:2})});var s=Tn(n);e.push(Ht(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),jo(e)}function GL(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=t0(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[jo(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var d=jo(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function rs(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(GL(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return jo(e)}function uc(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=Ht(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return jo(e)}function KL(t,e,r,n){var i=Il(t),s=i.getUint32(4,!0),a=(n>1?12:8)+F2(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,d=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=F2(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(a,!0),a+=4),s&32&&(c=i.getFloat64(a,!0),a+=8),s&64&&(d.setTime(d.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function XL(t,e,r){var n=Il(t),i=n.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,c=NaN,d=new Date(2001,0,1);i&1&&(l=HL(t,s),s+=16),i&2&&(c=n.getFloat64(s,!0),s+=8),i&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return h}function Dm(t,e){var r=new Uint8Array(32),n=Il(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,$L(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function Pm(t,e){var r=new Uint8Array(32),n=Il(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function YL(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return KL(t,e,r,t[0]);case 5:return XL(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Un(t){var e=Mt(t);return t0(e[1][0].data)}function I2(t,e){var r=Mt(e.data),n=Or(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=Mt(a.data),l=Or(o[1][0].data)>>>0;switch(n){case 1:s[l]=sx(o[3][0].data);break;case 8:{var c=t[Un(o[9][0].data)][0],d=Mt(c.data),h=t[Un(d[1][0].data)][0],p=Or(h.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var g=Mt(h.data);s[l]=g[3].map(function(y){return sx(y.data)}).join("")}break}}),s}function qL(t,e){var r,n,i,s,a,o,l,c,d,h,p,g,y,x,E=Mt(t),T=Or(E[1][0].data)>>>0,A=Or(E[2][0].data)>>>0,_=((n=(r=E[8])==null?void 0:r[0])==null?void 0:n.data)&&Or(E[8][0].data)>0||!1,O,H;if((s=(i=E[7])==null?void 0:i[0])!=null&&s.data&&e!=0)O=(o=(a=E[7])==null?void 0:a[0])==null?void 0:o.data,H=(c=(l=E[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(d=E[4])==null?void 0:d[0])!=null&&h.data&&e!=1)O=(g=(p=E[4])==null?void 0:p[0])==null?void 0:g.data,H=(x=(y=E[3])==null?void 0:y[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var j=_?4:1,w=Il(O),F=[],S=0;S<O.length/2;++S){var b=w.getUint16(S*2,!0);b<65535&&F.push([S,b])}if(F.length!=A)throw"Expected ".concat(A," cells, found ").concat(F.length);var D=[];for(S=0;S<F.length-1;++S)D[F[S][0]]=H.subarray(F[S][1]*j,F[S+1][1]*j);return F.length>=1&&(D[F[F.length-1][0]]=H.subarray(F[F.length-1][1]*j)),{R:T,cells:D}}function QL(t,e){var r,n=Mt(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Or(n[7][0].data)>>>0>0?1:0:-1,s=nv(n[5],function(a){return qL(a,i)});return{nrows:Or(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,c){if(a[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));a[o.R][c]=l}),a},[])}}function JL(t,e,r){var n,i=Mt(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Or(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Or(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=xt(s);var a=Mt(i[4][0].data),o=I2(t,t[Un(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?I2(t,t[Un(a[17][0].data)][0]):[],c=Mt(a[3][0].data),d=0;c[1].forEach(function(h){var p=Mt(h.data),g=t[Un(p[2][0].data)][0],y=Or(g.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var x=QL(t,g);x.data.forEach(function(E,T){E.forEach(function(A,_){var O=ot({r:d+T,c:_}),H=YL(A,o,l);H&&(r[O]=H)})}),d+=x.nrows})}function ZL(t,e){var r=Mt(e.data),n={"!ref":"A1"},i=t[Un(r[2][0].data)],s=Or(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return JL(t,i[0],n),n}function eB(t,e){var r,n=Mt(e.data),i={name:(r=n[1])!=null&&r[0]?sx(n[1][0].data):"",sheets:[]},s=nv(n[2],Un);return s.forEach(function(a){t[a].forEach(function(o){var l=Or(o.meta[1][0].data);l==6e3&&i.sheets.push(ZL(t,o))})}),i}function tB(t,e){var r=lv(),n=Mt(e.data),i=nv(n[1],Un);if(i.forEach(function(s){t[s].forEach(function(a){var o=Or(a.meta[1][0].data);if(o==2){var l=eB(t,a);l.sheets.forEach(function(c,d){cv(r,c,d==0?l.name:l.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Om(t){var e,r,n,i,s={},a=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=rs(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var d;try{d=ts(c)}catch(h){return console.log("## "+(h.message||h))}d.forEach(function(h){s[h.id]=h.messages,a.push(h.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Or(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(c){var d=Or(c.meta[1][0].data)>>>0;if(d==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return tB(s,o)}function rB(t,e,r){var n,i,s,a;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=t[8])==null?void 0:s[0])==null?void 0:a.data)&&Or(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=Il(t[7][0].data),d=0,h=[],p=Il(t[4][0].data),g=0,y=[],x=0;x<e.length;++x){if(e[x]==null){c.setUint16(x*2,65535,!0),p.setUint16(x*2,65535);continue}c.setUint16(x*2,d,!0),p.setUint16(x*2,g,!0);var E,T;switch(typeof e[x]){case"string":E=Dm({t:"s",v:e[x]},r),T=Pm({t:"s",v:e[x]},r);break;case"number":E=Dm({t:"n",v:e[x]},r),T=Pm({t:"n",v:e[x]},r);break;case"boolean":E=Dm({t:"b",v:e[x]},r),T=Pm({t:"b",v:e[x]},r);break;default:throw new Error("Unsupported value "+e[x])}h.push(E),d+=E.length,y.push(T),g+=T.length,++l}for(t[2][0].data=Ht(l);x<t[7][0].data.length/2;++x)c.setUint16(x*2,65535,!0),p.setUint16(x*2,65535,!0);return t[6][0].data=jo(h),t[3][0].data=jo(y),l}function nB(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ai(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(xt(n)));var s=$h(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(G){return G.forEach(function(q){typeof q=="string"&&a.push(q)})});var o={},l=[],c=et.read(e.numbers,{type:"base64"});c.FileIndex.map(function(G,q){return[G,c.FullPaths[q]]}).forEach(function(G){var q=G[0],Y=G[1];if(q.type==2&&q.name.match(/\.iwa/)){var de=q.content,Ae=rs(de),Pe=ts(Ae);Pe.forEach(function(ke){l.push(ke.id),o[ke.id]={deps:[],location:Y,type:Or(ke.messages[0].meta[1][0].data)}})}}),l.sort(function(G,q){return G-q});var d=l.filter(function(G){return G>1}).map(function(G){return[G,Ht(G)]});c.FileIndex.map(function(G,q){return[G,c.FullPaths[q]]}).forEach(function(G){var q=G[0];if(G[1],!!q.name.match(/\.iwa/)){var Y=ts(rs(q.content));Y.forEach(function(de){de.messages.forEach(function(Ae){d.forEach(function(Pe){de.messages.some(function(ke){return Or(ke.meta[1][0].data)!=11006&&WL(ke.data,Pe[1])})&&o[Pe[0]].deps.push(de.id)})})})}});for(var h=et.find(c,o[1].location),p=ts(rs(h.content)),g,y=0;y<p.length;++y){var x=p[y];x.id==1&&(g=x)}var E=Un(Mt(g.messages[0].data)[1][0].data);for(h=et.find(c,o[E].location),p=ts(rs(h.content)),y=0;y<p.length;++y)x=p[y],x.id==E&&(g=x);for(E=Un(Mt(g.messages[0].data)[2][0].data),h=et.find(c,o[E].location),p=ts(rs(h.content)),y=0;y<p.length;++y)x=p[y],x.id==E&&(g=x);for(E=Un(Mt(g.messages[0].data)[2][0].data),h=et.find(c,o[E].location),p=ts(rs(h.content)),y=0;y<p.length;++y)x=p[y],x.id==E&&(g=x);var T=Mt(g.messages[0].data);{T[6][0].data=Ht(n.e.r+1),T[7][0].data=Ht(n.e.c+1);var A=Un(T[46][0].data),_=et.find(c,o[A].location),O=ts(rs(_.content));{for(var H=0;H<O.length&&O[H].id!=A;++H);if(O[H].id!=A)throw"Bad ColumnRowUIDMapArchive";var j=Mt(O[H].messages[0].data);j[1]=[],j[2]=[],j[3]=[];for(var w=0;w<=n.e.c;++w){var F=[];F[1]=F[2]=[{type:0,data:Ht(w+420690)}],j[1].push({type:2,data:Tn(F)}),j[2].push({type:0,data:Ht(w)}),j[3].push({type:0,data:Ht(w)})}j[4]=[],j[5]=[],j[6]=[];for(var S=0;S<=n.e.r;++S)F=[],F[1]=F[2]=[{type:0,data:Ht(S+726270)}],j[4].push({type:2,data:Tn(F)}),j[5].push({type:0,data:Ht(S)}),j[6].push({type:0,data:Ht(S)});O[H].messages[0].data=Tn(j)}_.content=uc(cc(O)),_.size=_.content.length,delete T[46];var b=Mt(T[4][0].data);{b[7][0].data=Ht(n.e.r+1);var D=Mt(b[1][0].data),P=Un(D[2][0].data);_=et.find(c,o[P].location),O=ts(rs(_.content));{if(O[0].id!=P)throw"Bad HeaderStorageBucket";var N=Mt(O[0].messages[0].data);for(S=0;S<s.length;++S){var ze=Mt(N[2][0].data);ze[1][0].data=Ht(S),ze[4][0].data=Ht(s[S].length),N[2][S]={type:N[2][0].type,data:Tn(ze)}}O[0].messages[0].data=Tn(N)}_.content=uc(cc(O)),_.size=_.content.length;var ge=Un(b[2][0].data);_=et.find(c,o[ge].location),O=ts(rs(_.content));{if(O[0].id!=ge)throw"Bad HeaderStorageBucket";for(N=Mt(O[0].messages[0].data),w=0;w<=n.e.c;++w)ze=Mt(N[2][0].data),ze[1][0].data=Ht(w),ze[4][0].data=Ht(n.e.r+1),N[2][w]={type:N[2][0].type,data:Tn(ze)};O[0].messages[0].data=Tn(N)}_.content=uc(cc(O)),_.size=_.content.length;var be=Un(b[4][0].data);(function(){for(var G=et.find(c,o[be].location),q=ts(rs(G.content)),Y,de=0;de<q.length;++de){var Ae=q[de];Ae.id==be&&(Y=Ae)}var Pe=Mt(Y.messages[0].data);{Pe[3]=[];var ke=[];a.forEach(function(K,Bt){ke[1]=[{type:0,data:Ht(Bt)}],ke[2]=[{type:0,data:Ht(1)}],ke[3]=[{type:2,data:zL(K)}],Pe[3].push({type:2,data:Tn(ke)})})}Y.messages[0].data=Tn(Pe);var we=cc(q),it=uc(we);G.content=it,G.size=G.content.length})();var Se=Mt(b[3][0].data);{var ye=Se[1][0];delete Se[2];var Q=Mt(ye.data);{var Ce=Un(Q[2][0].data);(function(){for(var G=et.find(c,o[Ce].location),q=ts(rs(G.content)),Y,de=0;de<q.length;++de){var Ae=q[de];Ae.id==Ce&&(Y=Ae)}var Pe=Mt(Y.messages[0].data);{delete Pe[6],delete Se[7];var ke=new Uint8Array(Pe[5][0].data);Pe[5]=[];for(var we=0,it=0;it<=n.e.r;++it){var K=Mt(ke);we+=rB(K,s[it],a),K[1][0].data=Ht(it),Pe[5].push({data:Tn(K),type:2})}Pe[1]=[{type:0,data:Ht(n.e.c+1)}],Pe[2]=[{type:0,data:Ht(n.e.r+1)}],Pe[3]=[{type:0,data:Ht(we)}],Pe[4]=[{type:0,data:Ht(n.e.r+1)}]}Y.messages[0].data=Tn(Pe);var Bt=cc(q),gt=uc(Bt);G.content=gt,G.size=G.content.length})()}ye.data=Tn(Q)}b[3][0].data=Tn(Se)}T[4][0].data=Tn(b)}g.messages[0].data=Tn(T);var Be=cc(p),V=uc(Be);return h.content=V,h.size=h.content.length,c}function hk(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function iv(t){hk([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function sv(t){hk([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function iB(t){return _t.WS.indexOf(t)>-1?"sheet":t==_t.CS?"chart":t==_t.DS?"dialog":t==_t.MS?"macro":t&&t.length?t:"sheet"}function sB(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,iB(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function aB(t,e,r,n,i,s,a,o,l,c,d,h){try{s[n]=gf(Li(t,r,!0),e);var p=Gr(t,e),g;switch(o){case"sheet":g=FM(p,e,i,l,s[n],c,d,h);break;case"chart":if(g=IM(p,e,i,l,s[n],c,d,h),!g||!g["!drawel"])break;var y=Ju(g["!drawel"].Target,e),x=Yf(y),E=m6(Li(t,y,!0),gf(Li(t,x,!0),y)),T=Ju(E,y),A=Yf(T);g=rM(Li(t,T,!0),T,l,gf(Li(t,A,!0),T),c,g);break;case"macro":g=bM(p,e,i,l,s[n],c,d,h);break;case"dialog":g=RM(p,e,i,l,s[n],c,d,h);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=g;var _=[];s&&s[n]&&Mr(s[n]).forEach(function(O){var H="";if(s[n][O].Type==_t.CMNT){H=Ju(s[n][O].Target,e);var j=OM(Gr(t,H,!0),H,l);if(!j||!j.length)return;p2(g,j,!1)}s[n][O].Type==_t.TCMNT&&(H=Ju(s[n][O].Target,e),_=_.concat(x6(Gr(t,H,!0),l)))}),_&&_.length&&p2(g,_,!0,l.people||[])}catch(O){if(l.WTF)throw O}}function Zi(t){return t.charAt(0)=="/"?t.slice(1):t}function oB(t,e){if(hu(),e=e||{},iv(e),ns(t,"META-INF/manifest.xml")||ns(t,"objectdata.xml"))return A2(t,e);if(ns(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Om<"u"){if(t.FileIndex)return Om(t);var r=et.utils.cfb_new();return O_(t).forEach(function(ze){vt(r,ze,vR(t,ze))}),Om(r)}throw new Error("Unsupported NUMBERS file")}if(!ns(t,"[Content_Types].xml"))throw ns(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ns(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=O_(t),i=fN(Li(t,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",Gr(t,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!Gr(t,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(xf=[],i.sst)try{xf=PM(Gr(t,Zi(i.sst)),i.sst,e)}catch(ze){if(e.WTF)throw ze}e.cellStyles&&i.themes.length&&(l=DM(Li(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(c=NM(Gr(t,Zi(i.style)),i.style,l,e))}i.links.map(function(ze){try{var ge=gf(Li(t,Yf(Zi(ze))),ze);return LM(Gr(t,Zi(ze)),ge,ze,e)}catch{}});var d=CM(Gr(t,Zi(i.workbooks[0])),i.workbooks[0],e),h={},p="";i.coreprops.length&&(p=Gr(t,Zi(i.coreprops[0]),!0),p&&(h=tA(p)),i.extprops.length!==0&&(p=Gr(t,Zi(i.extprops[0]),!0),p&&vN(p,h,e)));var g={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(p=Li(t,Zi(i.custprops[0]),!0),p&&(g=_N(p,e)));var y={};if((e.bookSheets||e.bookProps)&&(d.Sheets?a=d.Sheets.map(function(ge){return ge.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),e.bookProps&&(y.Props=h,y.Custprops=g),e.bookSheets&&typeof a<"u"&&(y.SheetNames=a),e.bookSheets?y.SheetNames:e.bookProps))return y;a={};var x={};e.bookDeps&&i.calcchain&&(x=MM(Gr(t,Zi(i.calcchain)),i.calcchain));var E=0,T={},A,_;{var O=d.Sheets;h.Worksheets=O.length,h.SheetNames=[];for(var H=0;H!=O.length;++H)h.SheetNames[H]=O[H].name}var j=s?"bin":"xml",w=i.workbooks[0].lastIndexOf("/"),F=(i.workbooks[0].slice(0,w+1)+"_rels/"+i.workbooks[0].slice(w+1)+".rels").replace(/^\//,"");ns(t,F)||(F="xl/_rels/workbook."+j+".rels");var S=gf(Li(t,F,!0),F.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=BM(Gr(t,Zi(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=y6(Gr(t,Zi(i.people[0])),e)),S&&(S=sB(S,d.Sheets));var b=Gr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=h.Worksheets;++E){var D="sheet";if(S&&S[E]?(A="xl/"+S[E][1].replace(/[\/]?xl\//,""),ns(t,A)||(A=S[E][1]),ns(t,A)||(A=F.replace(/_rels\/.*$/,"")+S[E][1]),D=S[E][2]):(A="xl/worksheets/sheet"+(E+1-b)+"."+j,A=A.replace(/sheet0\./,"sheet.")),_=A.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(E!=e.sheets)continue e;break;case"string":if(h.SheetNames[E].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var P=!1,N=0;N!=e.sheets.length;++N)typeof e.sheets[N]=="number"&&e.sheets[N]==E&&(P=1),typeof e.sheets[N]=="string"&&e.sheets[N].toLowerCase()==h.SheetNames[E].toLowerCase()&&(P=1);if(!P)continue e}}aB(t,A,_,h.SheetNames[E],E,T,a,D,e,d,l,c)}return y={Directory:i,Workbook:d,Props:h,Custprops:g,Deps:x,Sheets:a,SheetNames:h.SheetNames,Strings:xf,Styles:c,Themes:l,SSF:fr(at)},e&&e.bookFiles&&(t.files?(y.keys=n,y.files=t.files):(y.keys=[],y.files={},t.FullPaths.forEach(function(ze,ge){ze=ze.replace(/^Root Entry[\/]/,""),y.keys.push(ze),y.files[ze]=t.FileIndex[ge]}))),e&&e.bookVBA&&(i.vba.length>0?y.vbaraw=Gr(t,Zi(i.vba[0]),!0):i.defaults&&i.defaults.bin===C6&&(y.vbaraw=Gr(t,"xl/vbaProject.bin",!0))),y}function lB(t,e){var r=e||{},n="Workbook",i=et.find(t,n);try{if(n="/!DataSpaces/Version",i=et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(BD(i.content),n="/!DataSpaces/DataSpaceMap",i=et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=VD(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=UD(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);WD(i.content)}catch{}if(n="/EncryptionInfo",i=et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=HD(i.content);if(n="/EncryptedPackage",i=et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function cB(t,e){return e.bookType=="ods"?dk(t,e):e.bookType=="numbers"?nB(t,e):e.bookType=="xlsb"?uB(t,e):fB(t,e)}function uB(t,e){Cc=1024,t&&!t.SSF&&(t.SSF=fr(at)),t&&t.SSF&&(hu(),kp(t.SSF),e.revssf=Fp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,vf?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=VA.indexOf(e.bookType)>-1,i=H1();sv(e=e||{});var s=b1(),a="",o=0;if(e.cellXfs=[],Xo(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",vt(s,a,rA(t.Props,e)),i.coreprops.push(a),$t(e.rels,2,a,_t.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,vt(s,a,sA(t.Props)),i.extprops.push(a),$t(e.rels,3,a,_t.EXT_PROPS),t.Custprops!==t.Props&&Mr(t.Custprops||{}).length>0&&(a="docProps/custom.xml",vt(s,a,aA(t.Custprops)),i.custprops.push(a),$t(e.rels,4,a,_t.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var d={"!id":{}},h=t.Sheets[t.SheetNames[o-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,vt(s,a,VM(o-1,a,e,t,d)),i.sheets.push(a),$t(e.wbrels,-1,"worksheets/sheet"+o+"."+r,_t.WS[0])}if(h){var g=h["!comments"],y=!1,x="";g&&g.length>0&&(x="xl/comments"+o+"."+r,vt(s,x,WM(g,x)),i.comments.push(x),$t(d,-1,"../comments"+o+"."+r,_t.CMNT),y=!0),h["!legacy"]&&y&&vt(s,"xl/drawings/vmlDrawing"+o+".vml",BA(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&vt(s,Yf(a),Lc(d))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,vt(s,a,zM(e.Strings,a,e)),i.strs.push(a),$t(e.wbrels,-1,"sharedStrings."+r,_t.SST)),a="xl/workbook."+r,vt(s,a,jM(t,a)),i.workbooks.push(a),$t(e.rels,1,a,_t.WB),a="xl/theme/theme1.xml",vt(s,a,q1(t.Themes,e)),i.themes.push(a),$t(e.wbrels,-1,"theme/theme1.xml",_t.THEME),a="xl/styles."+r,vt(s,a,UM(t,a,e)),i.styles.push(a),$t(e.wbrels,-1,"styles."+r,_t.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",vt(s,a,t.vbaraw),i.vba.push(a),$t(e.wbrels,-1,"vbaProject.bin",_t.VBA)),a="xl/metadata."+r,vt(s,a,HM(a)),i.metadata.push(a),$t(e.wbrels,-1,"metadata."+r,_t.XLMETA),vt(s,"[Content_Types].xml",ZS(i,e)),vt(s,"_rels/.rels",Lc(e.rels)),vt(s,"xl/_rels/workbook."+r+".rels",Lc(e.wbrels)),delete e.revssf,delete e.ssf,s}function fB(t,e){Cc=1024,t&&!t.SSF&&(t.SSF=fr(at)),t&&t.SSF&&(hu(),kp(t.SSF),e.revssf=Fp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,vf?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=VA.indexOf(e.bookType)>-1,i=H1();sv(e=e||{});var s=b1(),a="",o=0;if(e.cellXfs=[],Xo(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",vt(s,a,rA(t.Props,e)),i.coreprops.push(a),$t(e.rels,2,a,_t.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,vt(s,a,sA(t.Props)),i.extprops.push(a),$t(e.rels,3,a,_t.EXT_PROPS),t.Custprops!==t.Props&&Mr(t.Custprops||{}).length>0&&(a="docProps/custom.xml",vt(s,a,aA(t.Custprops)),i.custprops.push(a),$t(e.rels,4,a,_t.CUST_PROPS));var d=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var h={"!id":{}},p=t.Sheets[t.SheetNames[o-1]],g=(p||{})["!type"]||"sheet";switch(g){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,vt(s,a,QA(o-1,e,t,h)),i.sheets.push(a),$t(e.wbrels,-1,"worksheets/sheet"+o+"."+r,_t.WS[0])}if(p){var y=p["!comments"],x=!1,E="";if(y&&y.length>0){var T=!1;y.forEach(function(A){A[1].forEach(function(_){_.T==!0&&(T=!0)})}),T&&(E="xl/threadedComments/threadedComment"+o+"."+r,vt(s,E,v6(y,d,e)),i.threadedcomments.push(E),$t(h,-1,"../threadedComments/threadedComment"+o+"."+r,_t.TCMNT)),E="xl/comments"+o+"."+r,vt(s,E,jA(y)),i.comments.push(E),$t(h,-1,"../comments"+o+"."+r,_t.CMNT),x=!0}p["!legacy"]&&x&&vt(s,"xl/drawings/vmlDrawing"+o+".vml",BA(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}h["!id"].rId1&&vt(s,Yf(a),Lc(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,vt(s,a,kA(e.Strings,e)),i.strs.push(a),$t(e.wbrels,-1,"sharedStrings."+r,_t.SST)),a="xl/workbook."+r,vt(s,a,rk(t)),i.workbooks.push(a),$t(e.rels,1,a,_t.WB),a="xl/theme/theme1.xml",vt(s,a,q1(t.Themes,e)),i.themes.push(a),$t(e.wbrels,-1,"theme/theme1.xml",_t.THEME),a="xl/styles."+r,vt(s,a,PA(t,e)),i.styles.push(a),$t(e.wbrels,-1,"styles."+r,_t.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",vt(s,a,t.vbaraw),i.vba.push(a),$t(e.wbrels,-1,"vbaProject.bin",_t.VBA)),a="xl/metadata."+r,vt(s,a,LA()),i.metadata.push(a),$t(e.wbrels,-1,"metadata."+r,_t.XLMETA),d.length>1&&(a="xl/persons/person.xml",vt(s,a,_6(d)),i.people.push(a),$t(e.wbrels,-1,"persons/person.xml",_t.PEOPLE)),vt(s,"[Content_Types].xml",ZS(i,e)),vt(s,"_rels/.rels",Lc(e.rels)),vt(s,"xl/_rels/workbook."+r+".rels",Lc(e.wbrels)),delete e.revssf,delete e.ssf,s}function av(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=zi(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function dB(t,e){return et.find(t,"EncryptedPackage")?lB(t,e):ak(t,e)}function hB(t,e){var r,n=t,i=e||{};return i.type||(i.type=yt&&Buffer.isBuffer(t)?"buffer":"base64"),r=FS(n,i),oB(r,i)}function pk(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return nx(t.slice(r),e);default:break e}return Jc.to_workbook(t,e)}function pB(t,e){var r="",n=av(t,e);switch(e.type){case"base64":r=zi(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Al(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Jt(r)),e.type="binary",pk(r,e)}function mB(t,e){var r=t;return e.type=="base64"&&(r=zi(r)),r=Wf.utils.decode(1200,r.slice(2),"str"),e.type="binary",pk(r,e)}function gB(t){return t.match(/[^\x00-\x7F]/)?qs(t):t}function Mm(t,e,r,n){return n?(r.type="string",Jc.to_workbook(t,r)):Jc.to_workbook(e,r)}function Fc(t,e){A1();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Fc(new Uint8Array(t),(r=fr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),jc={},r.dateNF&&(jc.dateNF=r.dateNF),r.type||(r.type=yt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=yt?"buffer":"binary",n=uR(t),typeof Uint8Array<"u"&&!yt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=gB(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=fr(r),r.type="array",Fc(k1(n),r)}switch((i=av(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return dB(et.read(n,r),r);break;case 9:if(i[1]<=8)return ak(n,r);break;case 60:return nx(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return ED(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return SA.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?hB(n,r):Mm(t,n,r,s);case 239:return i[3]===60?nx(n,r):Mm(t,n,r,s);case 255:if(i[1]===254)return mB(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return ml.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return ml.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return rx.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return RA.to_workbook(n,r);break;case 10:case 13:case 32:return pB(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return _D.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?rx.to_workbook(n,r):Mm(t,n,r,s)}function mk(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return v0(e.file,et.write(t,{type:yt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return et.write(t,e)}function xB(t,e){var r=fr(e||{}),n=cB(t,r);return vB(n,r)}function vB(t,e){var r={},n=yt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?et.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Ap(i))}return e.password&&typeof encrypt_agile<"u"?mk(encrypt_agile(i,e.password),e):e.type==="file"?v0(e.file,i):e.type=="string"?Jt(i):i}function yB(t,e){var r=e||{},n=gL(t,r);return mk(n,r)}function Ks(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Hf(qs(n));case"binary":return qs(n);case"string":return t;case"file":return v0(e.file,n,"utf8");case"buffer":return yt?Ua(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ks(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function _B(t,e){switch(e.type){case"base64":return Hf(t);case"binary":return t;case"string":return t;case"file":return v0(e.file,t,"binary");case"buffer":return yt?Ua(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function bd(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Hf(r):e.type=="string"?Jt(r):r;case"file":return v0(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function gk(t,e){A1(),dM(t);var r=fr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=gk(t,r);return r.type="array",Ap(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ks(cL(t,r),r);case"slk":case"sylk":return Ks(TA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return Ks(lk(t.Sheets[t.SheetNames[i]],r),r);case"txt":return _B(xk(t.Sheets[t.SheetNames[i]],r),r);case"csv":return Ks(ov(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return Ks(SA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return bd(rx.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return Ks(Jc.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return Ks(RA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return Ks(AA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return Ks(dk(t,r),r);case"wk1":return bd(ml.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return bd(ml.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),bd(ok(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),yB(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return xB(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function EB(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function Lm(t,e,r){var n={};return n.type="file",n.file=e,EB(n),gk(t,n)}function wB(t,e,r,n,i,s,a,o){var l=Vr(r),c=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,p=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!a||t[r])for(var g=e.s.c;g<=e.e.c;++g){var y=a?t[r][g]:t[n[g]+l];if(y===void 0||y.t===void 0){if(c===void 0)continue;s[g]!=null&&(p[s[g]]=c);continue}var x=y.v;switch(y.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(s[g]!=null){if(x==null)if(y.t=="e"&&x===null)p[s[g]]=null;else if(c!==void 0)p[s[g]]=c;else if(d&&x===null)p[s[g]]=null;else continue;else p[s[g]]=d&&(y.t!=="n"||y.t==="n"&&o.rawNumbers!==!1)?x:Pa(y,x,o);x!=null&&(h=!1)}}return{row:p,isempty:h}}function $h(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},d=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof d){case"string":l=Dt(d);break;case"number":l=Dt(t["!ref"]),l.s.r=d;break;default:l=d}n>0&&(i=0);var h=Vr(l.s.r),p=[],g=[],y=0,x=0,E=Array.isArray(t),T=l.s.r,A=0,_={};E&&!t[T]&&(t[T]=[]);var O=c.skipHidden&&t["!cols"]||[],H=c.skipHidden&&t["!rows"]||[];for(A=l.s.c;A<=l.e.c;++A)if(!(O[A]||{}).hidden)switch(p[A]=Tr(A),r=E?t[T][A]:t[p[A]+h],n){case 1:s[A]=A-l.s.c;break;case 2:s[A]=p[A];break;case 3:s[A]=c.header[A-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Pa(r,null,c),x=_[a]||0,!x)_[a]=1;else{do o=a+"_"+x++;while(_[o]);_[a]=x,_[o]=1}s[A]=o}for(T=l.s.r+i;T<=l.e.r;++T)if(!(H[T]||{}).hidden){var j=wB(t,l,T,p,n,s,E,c);(j.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(g[y++]=j.row)}return g.length=y,g}var b2=/"/g;function TB(t,e,r,n,i,s,a,o){for(var l=!0,c=[],d="",h=Vr(r),p=e.s.c;p<=e.e.c;++p)if(n[p]){var g=o.dense?(t[r]||[])[p]:t[n[p]+h];if(g==null)d="";else if(g.v!=null){l=!1,d=""+(o.rawNumbers&&g.t=="n"?g.v:Pa(g,null,o));for(var y=0,x=0;y!==d.length;++y)if((x=d.charCodeAt(y))===i||x===s||x===34||o.forceQuotes){d='"'+d.replace(b2,'""')+'"';break}d=="ID"&&(d='"ID"')}else g.f!=null&&!g.F?(l=!1,d="="+g.f,d.indexOf(",")>=0&&(d='"'+d.replace(b2,'""')+'"')):d="";c.push(d)}return o.blankrows===!1&&l?null:c.join(a)}function ov(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=Dt(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),d="",h=[];n.dense=Array.isArray(t);for(var p=n.skipHidden&&t["!cols"]||[],g=n.skipHidden&&t["!rows"]||[],y=i.s.c;y<=i.e.c;++y)(p[y]||{}).hidden||(h[y]=Tr(y));for(var x=0,E=i.s.r;E<=i.e.r;++E)(g[E]||{}).hidden||(d=TB(t,i,E,h,a,l,s,n),d!=null&&(n.strip&&(d=d.replace(c,"")),(d||n.blankrows!==!1)&&r.push((x++?o:"")+d)));return delete n.dense,r.join("")}function xk(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=ov(t,e);return r}function SB(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=Dt(t["!ref"]),s="",a=[],o,l=[],c=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=Tr(o);for(var d=i.s.r;d<=i.e.r;++d)for(s=Vr(d),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=c?(t[d]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function vk(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Sr(n.origin):n.origin;a=l.r,o=l.c}var c,d={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var h=Dt(s["!ref"]);d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),a==-1&&(a=h.e.r+1,d.e.r=a+e.length-1+i)}else a==-1&&(a=0,d.e.r=e.length-1+i);var p=n.header||[],g=0;e.forEach(function(x,E){Mr(x).forEach(function(T){(g=p.indexOf(T))==-1&&(p[g=p.length]=T);var A=x[T],_="z",O="",H=ot({c:o+g,r:a+E+i});c=r0(s,H),A&&typeof A=="object"&&!(A instanceof Date)?s[H]=A:(typeof A=="number"?_="n":typeof A=="boolean"?_="b":typeof A=="string"?_="s":A instanceof Date?(_="d",n.cellDates||(_="n",A=nn(A)),O=n.dateNF||at[14]):A===null&&n.nullError&&(_="e",A=0),c?(c.t=_,c.v=A,delete c.w,delete c.R,O&&(c.z=O)):s[H]=c={t:_,v:A},O&&(c.z=O))})}),d.e.c=Math.max(d.e.c,o+p.length-1);var y=Vr(a);if(i)for(g=0;g<p.length;++g)s[Tr(g+o)+y]={t:"s",v:p[g]};return s["!ref"]=xt(d),s}function AB(t,e){return vk(null,t,e)}function r0(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Sr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?r0(t,ot(e)):r0(t,ot({r:e,c:r||0}))}function kB(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function lv(){return{SheetNames:[],Sheets:{}}}function cv(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(tk(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function CB(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=kB(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function FB(t,e){return t.z=e,t}function yk(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function IB(t,e,r){return yk(t,"#"+e,r)}function bB(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function RB(t,e,r,n){for(var i=typeof e!="string"?e:Dt(e),s=typeof e=="string"?e:xt(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=r0(t,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var Ni={encode_col:Tr,encode_row:Vr,encode_cell:ot,encode_range:xt,decode_col:B1,decode_row:L1,split_cell:zR,decode_cell:Sr,decode_range:Ai,format_cell:Pa,sheet_add_aoa:GS,sheet_add_json:vk,sheet_add_dom:ck,aoa_to_sheet:pu,json_to_sheet:AB,table_to_sheet:uk,table_to_book:BL,sheet_to_csv:ov,sheet_to_txt:xk,sheet_to_json:$h,sheet_to_html:lk,sheet_to_formulae:SB,sheet_to_row_object_array:$h,sheet_get_cell:r0,book_new:lv,book_append_sheet:cv,book_set_sheet_visibility:CB,cell_set_number_format:FB,cell_set_hyperlink:yk,cell_set_internal_link:IB,cell_add_comment:bB,sheet_set_array_formula:RB,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var NB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DB=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),St=(t,e)=>{const r=ve.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:l,...c},d)=>ve.createElement("svg",{ref:d,...NB,width:i,height:i,stroke:n,strokeWidth:a?Number(s)*24/Number(i):s,className:["lucide",`lucide-${DB(t)}`,o].join(" "),...c},[...e.map(([h,p])=>ve.createElement(h,p)),...Array.isArray(l)?l:[l]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R2=St("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N2=St("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PB=St("BellRing",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D2=St("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P2=St("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OB=St("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MB=St("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O2=St("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M2=St("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LB=St("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bm=St("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jm=St("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BB=St("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zu=St("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jB=St("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rd=St("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wu=St("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vm=St("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L2=St("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nd=St("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Um=St("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VB=St("Merge",[["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M12 2v10.3a4 4 0 0 1-1.172 2.872L4 22",key:"1hyw0i"}],["path",{d:"m20 22-5-5",key:"1m27yz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UB=St("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dd=St("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B2=St("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zm=St("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hu=St("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zB=St("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pd=St("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j2=St("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WB=St("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V2=St("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HB=St("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=St("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=St("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U2=St("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nl=St("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var z2={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _k=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},$B=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[r++],a=t[r++],o=t[r++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},Ek={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,o=a?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,d=s>>2,h=(s&3)<<4|o>>4;let p=(o&15)<<2|c>>6,g=c&63;l||(g=64,a||(p=64)),n.push(r[d],r[h],r[p],r[g])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(_k(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):$B(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const c=i<t.length?r[t.charAt(i)]:64;++i;const h=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||c==null||h==null)throw new GB;const p=s<<2|o>>4;if(n.push(p),c!==64){const g=o<<4&240|c>>2;if(n.push(g),h!==64){const y=c<<6&192|h;n.push(y)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class GB extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const KB=function(t){const e=_k(t);return Ek.encodeByteArray(e,!0)},Gh=function(t){return KB(t).replace(/\./g,"")},wk=function(t){try{return Ek.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XB(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YB=()=>XB().__FIREBASE_DEFAULTS__,qB=()=>{if(typeof process>"u"||typeof z2>"u")return;const t=z2.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},QB=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&wk(t[1]);return e&&JSON.parse(e)},Pp=()=>{try{return YB()||qB()||QB()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Tk=t=>{var e,r;return(r=(e=Pp())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},JB=t=>{const e=Tk(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},Sk=()=>{var t;return(t=Pp())===null||t===void 0?void 0:t.config},Ak=t=>{var e;return(e=Pp())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZB{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e9(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Gh(JSON.stringify(r)),Gh(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function t9(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Qn())}function r9(){var t;const e=(t=Pp())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function n9(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function i9(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function s9(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function a9(){const t=Qn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function o9(){return!r9()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function l9(){try{return typeof indexedDB=="object"}catch{return!1}}function c9(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u9="FirebaseError";class Ha extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=u9,Object.setPrototypeOf(this,Ha.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,k0.prototype.create)}}class k0{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?f9(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new Ha(i,o,n)}}function f9(t,e){return t.replace(d9,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const d9=/\{\$([^}]+)}/g;function h9(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Kh(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const s=t[i],a=e[i];if(W2(s)&&W2(a)){if(!Kh(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function W2(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C0(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function p9(t,e){const r=new m9(t,e);return r.subscribe.bind(r)}class m9{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");g9(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=Wm),i.error===void 0&&(i.error=Wm),i.complete===void 0&&(i.complete=Wm);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function g9(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Wm(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ps(t){return t&&t._delegate?t._delegate:t}class bl{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const il="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x9{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new ZB;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(y9(e))try{this.getOrInitializeService({instanceIdentifier:il})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=il){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=il){return this.instances.has(e)}getOptions(e=il){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:v9(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=il){return this.component?this.component.multipleInstances?e:il:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function v9(t){return t===il?void 0:t}function y9(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _9{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new x9(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ct;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ct||(Ct={}));const E9={debug:Ct.DEBUG,verbose:Ct.VERBOSE,info:Ct.INFO,warn:Ct.WARN,error:Ct.ERROR,silent:Ct.SILENT},w9=Ct.INFO,T9={[Ct.DEBUG]:"log",[Ct.VERBOSE]:"log",[Ct.INFO]:"info",[Ct.WARN]:"warn",[Ct.ERROR]:"error"},S9=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=T9[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class uv{constructor(e){this.name=e,this._logLevel=w9,this._logHandler=S9,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ct))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?E9[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ct.DEBUG,...e),this._logHandler(this,Ct.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ct.VERBOSE,...e),this._logHandler(this,Ct.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ct.INFO,...e),this._logHandler(this,Ct.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ct.WARN,...e),this._logHandler(this,Ct.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ct.ERROR,...e),this._logHandler(this,Ct.ERROR,...e)}}const A9=(t,e)=>e.some(r=>t instanceof r);let H2,$2;function k9(){return H2||(H2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function C9(){return $2||($2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const kk=new WeakMap,ax=new WeakMap,Ck=new WeakMap,Hm=new WeakMap,fv=new WeakMap;function F9(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(Io(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&kk.set(r,t)}).catch(()=>{}),fv.set(e,t),e}function I9(t){if(ax.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});ax.set(t,e)}let ox={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return ax.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Ck.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Io(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function b9(t){ox=t(ox)}function R9(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call($m(this),e,...r);return Ck.set(n,e.sort?e.sort():[e]),Io(n)}:C9().includes(t)?function(...e){return t.apply($m(this),e),Io(kk.get(this))}:function(...e){return Io(t.apply($m(this),e))}}function N9(t){return typeof t=="function"?R9(t):(t instanceof IDBTransaction&&I9(t),A9(t,k9())?new Proxy(t,ox):t)}function Io(t){if(t instanceof IDBRequest)return F9(t);if(Hm.has(t))return Hm.get(t);const e=N9(t);return e!==t&&(Hm.set(t,e),fv.set(e,t)),e}const $m=t=>fv.get(t);function D9(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),o=Io(a);return n&&a.addEventListener("upgradeneeded",l=>{n(Io(a.result),l.oldVersion,l.newVersion,Io(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const P9=["get","getKey","getAll","getAllKeys","count"],O9=["put","add","delete","clear"],Gm=new Map;function G2(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Gm.get(e))return Gm.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=O9.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||P9.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),i&&l.done]))[0]};return Gm.set(e,s),s}b9(t=>({...t,get:(e,r,n)=>G2(e,r)||t.get(e,r,n),has:(e,r)=>!!G2(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M9{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(L9(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function L9(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const lx="@firebase/app",K2="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oa=new uv("@firebase/app"),B9="@firebase/app-compat",j9="@firebase/analytics-compat",V9="@firebase/analytics",U9="@firebase/app-check-compat",z9="@firebase/app-check",W9="@firebase/auth",H9="@firebase/auth-compat",$9="@firebase/database",G9="@firebase/data-connect",K9="@firebase/database-compat",X9="@firebase/functions",Y9="@firebase/functions-compat",q9="@firebase/installations",Q9="@firebase/installations-compat",J9="@firebase/messaging",Z9="@firebase/messaging-compat",ej="@firebase/performance",tj="@firebase/performance-compat",rj="@firebase/remote-config",nj="@firebase/remote-config-compat",ij="@firebase/storage",sj="@firebase/storage-compat",aj="@firebase/firestore",oj="@firebase/vertexai-preview",lj="@firebase/firestore-compat",cj="firebase",uj="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cx="[DEFAULT]",fj={[lx]:"fire-core",[B9]:"fire-core-compat",[V9]:"fire-analytics",[j9]:"fire-analytics-compat",[z9]:"fire-app-check",[U9]:"fire-app-check-compat",[W9]:"fire-auth",[H9]:"fire-auth-compat",[$9]:"fire-rtdb",[G9]:"fire-data-connect",[K9]:"fire-rtdb-compat",[X9]:"fire-fn",[Y9]:"fire-fn-compat",[q9]:"fire-iid",[Q9]:"fire-iid-compat",[J9]:"fire-fcm",[Z9]:"fire-fcm-compat",[ej]:"fire-perf",[tj]:"fire-perf-compat",[rj]:"fire-rc",[nj]:"fire-rc-compat",[ij]:"fire-gcs",[sj]:"fire-gcs-compat",[aj]:"fire-fst",[lj]:"fire-fst-compat",[oj]:"fire-vertex","fire-js":"fire-js",[cj]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xh=new Map,dj=new Map,ux=new Map;function X2(t,e){try{t.container.addComponent(e)}catch(r){Oa.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function eu(t){const e=t.name;if(ux.has(e))return Oa.debug(`There were multiple attempts to register component ${e}.`),!1;ux.set(e,t);for(const r of Xh.values())X2(r,t);for(const r of dj.values())X2(r,t);return!0}function dv(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function yo(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},bo=new k0("app","Firebase",hj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pj{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new bl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw bo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gu=uj;function Fk(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:cx,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw bo.create("bad-app-name",{appName:String(i)});if(r||(r=Sk()),!r)throw bo.create("no-options");const s=Xh.get(i);if(s){if(Kh(r,s.options)&&Kh(n,s.config))return s;throw bo.create("duplicate-app",{appName:i})}const a=new _9(i);for(const l of ux.values())a.addComponent(l);const o=new pj(r,n,a);return Xh.set(i,o),o}function Ik(t=cx){const e=Xh.get(t);if(!e&&t===cx&&Sk())return Fk();if(!e)throw bo.create("no-app",{appName:t});return e}function Ro(t,e,r){var n;let i=(n=fj[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Oa.warn(o.join(" "));return}eu(new bl(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mj="firebase-heartbeat-database",gj=1,n0="firebase-heartbeat-store";let Km=null;function bk(){return Km||(Km=D9(mj,gj,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(n0)}catch(r){console.warn(r)}}}}).catch(t=>{throw bo.create("idb-open",{originalErrorMessage:t.message})})),Km}async function xj(t){try{const r=(await bk()).transaction(n0),n=await r.objectStore(n0).get(Rk(t));return await r.done,n}catch(e){if(e instanceof Ha)Oa.warn(e.message);else{const r=bo.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Oa.warn(r.message)}}}async function Y2(t,e){try{const n=(await bk()).transaction(n0,"readwrite");await n.objectStore(n0).put(e,Rk(t)),await n.done}catch(r){if(r instanceof Ha)Oa.warn(r.message);else{const n=bo.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Oa.warn(n.message)}}}function Rk(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vj=1024,yj=30*24*60*60*1e3;class _j{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new wj(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=q2();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=yj}),this._storage.overwrite(this._heartbeatsCache))}catch(n){Oa.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=q2(),{heartbeatsToSend:n,unsentEntries:i}=Ej(this._heartbeatsCache.heartbeats),s=Gh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return Oa.warn(r),""}}}function q2(){return new Date().toISOString().substring(0,10)}function Ej(t,e=vj){const r=[];let n=t.slice();for(const i of t){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),Q2(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),Q2(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class wj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return l9()?c9().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await xj(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return Y2(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return Y2(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Q2(t){return Gh(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tj(t){eu(new bl("platform-logger",e=>new M9(e),"PRIVATE")),eu(new bl("heartbeat",e=>new _j(e),"PRIVATE")),Ro(lx,K2,t),Ro(lx,K2,"esm2017"),Ro("fire-js","")}Tj("");var Sj="firebase",Aj="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ro(Sj,Aj,"app");var J2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var xl,Nk;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,F){function S(){}S.prototype=F.prototype,w.D=F.prototype,w.prototype=new S,w.prototype.constructor=w,w.C=function(b,D,P){for(var N=Array(arguments.length-2),ze=2;ze<arguments.length;ze++)N[ze-2]=arguments[ze];return F.prototype[D].apply(b,N)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,F,S){S||(S=0);var b=Array(16);if(typeof F=="string")for(var D=0;16>D;++D)b[D]=F.charCodeAt(S++)|F.charCodeAt(S++)<<8|F.charCodeAt(S++)<<16|F.charCodeAt(S++)<<24;else for(D=0;16>D;++D)b[D]=F[S++]|F[S++]<<8|F[S++]<<16|F[S++]<<24;F=w.g[0],S=w.g[1],D=w.g[2];var P=w.g[3],N=F+(P^S&(D^P))+b[0]+3614090360&4294967295;F=S+(N<<7&4294967295|N>>>25),N=P+(D^F&(S^D))+b[1]+3905402710&4294967295,P=F+(N<<12&4294967295|N>>>20),N=D+(S^P&(F^S))+b[2]+606105819&4294967295,D=P+(N<<17&4294967295|N>>>15),N=S+(F^D&(P^F))+b[3]+3250441966&4294967295,S=D+(N<<22&4294967295|N>>>10),N=F+(P^S&(D^P))+b[4]+4118548399&4294967295,F=S+(N<<7&4294967295|N>>>25),N=P+(D^F&(S^D))+b[5]+1200080426&4294967295,P=F+(N<<12&4294967295|N>>>20),N=D+(S^P&(F^S))+b[6]+2821735955&4294967295,D=P+(N<<17&4294967295|N>>>15),N=S+(F^D&(P^F))+b[7]+4249261313&4294967295,S=D+(N<<22&4294967295|N>>>10),N=F+(P^S&(D^P))+b[8]+1770035416&4294967295,F=S+(N<<7&4294967295|N>>>25),N=P+(D^F&(S^D))+b[9]+2336552879&4294967295,P=F+(N<<12&4294967295|N>>>20),N=D+(S^P&(F^S))+b[10]+4294925233&4294967295,D=P+(N<<17&4294967295|N>>>15),N=S+(F^D&(P^F))+b[11]+2304563134&4294967295,S=D+(N<<22&4294967295|N>>>10),N=F+(P^S&(D^P))+b[12]+1804603682&4294967295,F=S+(N<<7&4294967295|N>>>25),N=P+(D^F&(S^D))+b[13]+4254626195&4294967295,P=F+(N<<12&4294967295|N>>>20),N=D+(S^P&(F^S))+b[14]+2792965006&4294967295,D=P+(N<<17&4294967295|N>>>15),N=S+(F^D&(P^F))+b[15]+1236535329&4294967295,S=D+(N<<22&4294967295|N>>>10),N=F+(D^P&(S^D))+b[1]+4129170786&4294967295,F=S+(N<<5&4294967295|N>>>27),N=P+(S^D&(F^S))+b[6]+3225465664&4294967295,P=F+(N<<9&4294967295|N>>>23),N=D+(F^S&(P^F))+b[11]+643717713&4294967295,D=P+(N<<14&4294967295|N>>>18),N=S+(P^F&(D^P))+b[0]+3921069994&4294967295,S=D+(N<<20&4294967295|N>>>12),N=F+(D^P&(S^D))+b[5]+3593408605&4294967295,F=S+(N<<5&4294967295|N>>>27),N=P+(S^D&(F^S))+b[10]+38016083&4294967295,P=F+(N<<9&4294967295|N>>>23),N=D+(F^S&(P^F))+b[15]+3634488961&4294967295,D=P+(N<<14&4294967295|N>>>18),N=S+(P^F&(D^P))+b[4]+3889429448&4294967295,S=D+(N<<20&4294967295|N>>>12),N=F+(D^P&(S^D))+b[9]+568446438&4294967295,F=S+(N<<5&4294967295|N>>>27),N=P+(S^D&(F^S))+b[14]+3275163606&4294967295,P=F+(N<<9&4294967295|N>>>23),N=D+(F^S&(P^F))+b[3]+4107603335&4294967295,D=P+(N<<14&4294967295|N>>>18),N=S+(P^F&(D^P))+b[8]+1163531501&4294967295,S=D+(N<<20&4294967295|N>>>12),N=F+(D^P&(S^D))+b[13]+2850285829&4294967295,F=S+(N<<5&4294967295|N>>>27),N=P+(S^D&(F^S))+b[2]+4243563512&4294967295,P=F+(N<<9&4294967295|N>>>23),N=D+(F^S&(P^F))+b[7]+1735328473&4294967295,D=P+(N<<14&4294967295|N>>>18),N=S+(P^F&(D^P))+b[12]+2368359562&4294967295,S=D+(N<<20&4294967295|N>>>12),N=F+(S^D^P)+b[5]+4294588738&4294967295,F=S+(N<<4&4294967295|N>>>28),N=P+(F^S^D)+b[8]+2272392833&4294967295,P=F+(N<<11&4294967295|N>>>21),N=D+(P^F^S)+b[11]+1839030562&4294967295,D=P+(N<<16&4294967295|N>>>16),N=S+(D^P^F)+b[14]+4259657740&4294967295,S=D+(N<<23&4294967295|N>>>9),N=F+(S^D^P)+b[1]+2763975236&4294967295,F=S+(N<<4&4294967295|N>>>28),N=P+(F^S^D)+b[4]+1272893353&4294967295,P=F+(N<<11&4294967295|N>>>21),N=D+(P^F^S)+b[7]+4139469664&4294967295,D=P+(N<<16&4294967295|N>>>16),N=S+(D^P^F)+b[10]+3200236656&4294967295,S=D+(N<<23&4294967295|N>>>9),N=F+(S^D^P)+b[13]+681279174&4294967295,F=S+(N<<4&4294967295|N>>>28),N=P+(F^S^D)+b[0]+3936430074&4294967295,P=F+(N<<11&4294967295|N>>>21),N=D+(P^F^S)+b[3]+3572445317&4294967295,D=P+(N<<16&4294967295|N>>>16),N=S+(D^P^F)+b[6]+76029189&4294967295,S=D+(N<<23&4294967295|N>>>9),N=F+(S^D^P)+b[9]+3654602809&4294967295,F=S+(N<<4&4294967295|N>>>28),N=P+(F^S^D)+b[12]+3873151461&4294967295,P=F+(N<<11&4294967295|N>>>21),N=D+(P^F^S)+b[15]+530742520&4294967295,D=P+(N<<16&4294967295|N>>>16),N=S+(D^P^F)+b[2]+3299628645&4294967295,S=D+(N<<23&4294967295|N>>>9),N=F+(D^(S|~P))+b[0]+4096336452&4294967295,F=S+(N<<6&4294967295|N>>>26),N=P+(S^(F|~D))+b[7]+1126891415&4294967295,P=F+(N<<10&4294967295|N>>>22),N=D+(F^(P|~S))+b[14]+2878612391&4294967295,D=P+(N<<15&4294967295|N>>>17),N=S+(P^(D|~F))+b[5]+4237533241&4294967295,S=D+(N<<21&4294967295|N>>>11),N=F+(D^(S|~P))+b[12]+1700485571&4294967295,F=S+(N<<6&4294967295|N>>>26),N=P+(S^(F|~D))+b[3]+2399980690&4294967295,P=F+(N<<10&4294967295|N>>>22),N=D+(F^(P|~S))+b[10]+4293915773&4294967295,D=P+(N<<15&4294967295|N>>>17),N=S+(P^(D|~F))+b[1]+2240044497&4294967295,S=D+(N<<21&4294967295|N>>>11),N=F+(D^(S|~P))+b[8]+1873313359&4294967295,F=S+(N<<6&4294967295|N>>>26),N=P+(S^(F|~D))+b[15]+4264355552&4294967295,P=F+(N<<10&4294967295|N>>>22),N=D+(F^(P|~S))+b[6]+2734768916&4294967295,D=P+(N<<15&4294967295|N>>>17),N=S+(P^(D|~F))+b[13]+1309151649&4294967295,S=D+(N<<21&4294967295|N>>>11),N=F+(D^(S|~P))+b[4]+4149444226&4294967295,F=S+(N<<6&4294967295|N>>>26),N=P+(S^(F|~D))+b[11]+3174756917&4294967295,P=F+(N<<10&4294967295|N>>>22),N=D+(F^(P|~S))+b[2]+718787259&4294967295,D=P+(N<<15&4294967295|N>>>17),N=S+(P^(D|~F))+b[9]+3951481745&4294967295,w.g[0]=w.g[0]+F&4294967295,w.g[1]=w.g[1]+(D+(N<<21&4294967295|N>>>11))&4294967295,w.g[2]=w.g[2]+D&4294967295,w.g[3]=w.g[3]+P&4294967295}n.prototype.u=function(w,F){F===void 0&&(F=w.length);for(var S=F-this.blockSize,b=this.B,D=this.h,P=0;P<F;){if(D==0)for(;P<=S;)i(this,w,P),P+=this.blockSize;if(typeof w=="string"){for(;P<F;)if(b[D++]=w.charCodeAt(P++),D==this.blockSize){i(this,b),D=0;break}}else for(;P<F;)if(b[D++]=w[P++],D==this.blockSize){i(this,b),D=0;break}}this.h=D,this.o+=F},n.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var F=1;F<w.length-8;++F)w[F]=0;var S=8*this.o;for(F=w.length-8;F<w.length;++F)w[F]=S&255,S/=256;for(this.u(w),w=Array(16),F=S=0;4>F;++F)for(var b=0;32>b;b+=8)w[S++]=this.g[F]>>>b&255;return w};function s(w,F){var S=o;return Object.prototype.hasOwnProperty.call(S,w)?S[w]:S[w]=F(w)}function a(w,F){this.h=F;for(var S=[],b=!0,D=w.length-1;0<=D;D--){var P=w[D]|0;b&&P==F||(S[D]=P,b=!1)}this.g=S}var o={};function l(w){return-128<=w&&128>w?s(w,function(F){return new a([F|0],0>F?-1:0)}):new a([w|0],0>w?-1:0)}function c(w){if(isNaN(w)||!isFinite(w))return h;if(0>w)return E(c(-w));for(var F=[],S=1,b=0;w>=S;b++)F[b]=w/S|0,S*=4294967296;return new a(F,0)}function d(w,F){if(w.length==0)throw Error("number format error: empty string");if(F=F||10,2>F||36<F)throw Error("radix out of range: "+F);if(w.charAt(0)=="-")return E(d(w.substring(1),F));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=c(Math.pow(F,8)),b=h,D=0;D<w.length;D+=8){var P=Math.min(8,w.length-D),N=parseInt(w.substring(D,D+P),F);8>P?(P=c(Math.pow(F,P)),b=b.j(P).add(c(N))):(b=b.j(S),b=b.add(c(N)))}return b}var h=l(0),p=l(1),g=l(16777216);t=a.prototype,t.m=function(){if(x(this))return-E(this).m();for(var w=0,F=1,S=0;S<this.g.length;S++){var b=this.i(S);w+=(0<=b?b:4294967296+b)*F,F*=4294967296}return w},t.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(y(this))return"0";if(x(this))return"-"+E(this).toString(w);for(var F=c(Math.pow(w,6)),S=this,b="";;){var D=O(S,F).g;S=T(S,D.j(F));var P=((0<S.g.length?S.g[0]:S.h)>>>0).toString(w);if(S=D,y(S))return P+b;for(;6>P.length;)P="0"+P;b=P+b}},t.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function y(w){if(w.h!=0)return!1;for(var F=0;F<w.g.length;F++)if(w.g[F]!=0)return!1;return!0}function x(w){return w.h==-1}t.l=function(w){return w=T(this,w),x(w)?-1:y(w)?0:1};function E(w){for(var F=w.g.length,S=[],b=0;b<F;b++)S[b]=~w.g[b];return new a(S,~w.h).add(p)}t.abs=function(){return x(this)?E(this):this},t.add=function(w){for(var F=Math.max(this.g.length,w.g.length),S=[],b=0,D=0;D<=F;D++){var P=b+(this.i(D)&65535)+(w.i(D)&65535),N=(P>>>16)+(this.i(D)>>>16)+(w.i(D)>>>16);b=N>>>16,P&=65535,N&=65535,S[D]=N<<16|P}return new a(S,S[S.length-1]&-2147483648?-1:0)};function T(w,F){return w.add(E(F))}t.j=function(w){if(y(this)||y(w))return h;if(x(this))return x(w)?E(this).j(E(w)):E(E(this).j(w));if(x(w))return E(this.j(E(w)));if(0>this.l(g)&&0>w.l(g))return c(this.m()*w.m());for(var F=this.g.length+w.g.length,S=[],b=0;b<2*F;b++)S[b]=0;for(b=0;b<this.g.length;b++)for(var D=0;D<w.g.length;D++){var P=this.i(b)>>>16,N=this.i(b)&65535,ze=w.i(D)>>>16,ge=w.i(D)&65535;S[2*b+2*D]+=N*ge,A(S,2*b+2*D),S[2*b+2*D+1]+=P*ge,A(S,2*b+2*D+1),S[2*b+2*D+1]+=N*ze,A(S,2*b+2*D+1),S[2*b+2*D+2]+=P*ze,A(S,2*b+2*D+2)}for(b=0;b<F;b++)S[b]=S[2*b+1]<<16|S[2*b];for(b=F;b<2*F;b++)S[b]=0;return new a(S,0)};function A(w,F){for(;(w[F]&65535)!=w[F];)w[F+1]+=w[F]>>>16,w[F]&=65535,F++}function _(w,F){this.g=w,this.h=F}function O(w,F){if(y(F))throw Error("division by zero");if(y(w))return new _(h,h);if(x(w))return F=O(E(w),F),new _(E(F.g),E(F.h));if(x(F))return F=O(w,E(F)),new _(E(F.g),F.h);if(30<w.g.length){if(x(w)||x(F))throw Error("slowDivide_ only works with positive integers.");for(var S=p,b=F;0>=b.l(w);)S=H(S),b=H(b);var D=j(S,1),P=j(b,1);for(b=j(b,2),S=j(S,2);!y(b);){var N=P.add(b);0>=N.l(w)&&(D=D.add(S),P=N),b=j(b,1),S=j(S,1)}return F=T(w,D.j(F)),new _(D,F)}for(D=h;0<=w.l(F);){for(S=Math.max(1,Math.floor(w.m()/F.m())),b=Math.ceil(Math.log(S)/Math.LN2),b=48>=b?1:Math.pow(2,b-48),P=c(S),N=P.j(F);x(N)||0<N.l(w);)S-=b,P=c(S),N=P.j(F);y(P)&&(P=p),D=D.add(P),w=T(w,N)}return new _(D,w)}t.A=function(w){return O(this,w).h},t.and=function(w){for(var F=Math.max(this.g.length,w.g.length),S=[],b=0;b<F;b++)S[b]=this.i(b)&w.i(b);return new a(S,this.h&w.h)},t.or=function(w){for(var F=Math.max(this.g.length,w.g.length),S=[],b=0;b<F;b++)S[b]=this.i(b)|w.i(b);return new a(S,this.h|w.h)},t.xor=function(w){for(var F=Math.max(this.g.length,w.g.length),S=[],b=0;b<F;b++)S[b]=this.i(b)^w.i(b);return new a(S,this.h^w.h)};function H(w){for(var F=w.g.length+1,S=[],b=0;b<F;b++)S[b]=w.i(b)<<1|w.i(b-1)>>>31;return new a(S,w.h)}function j(w,F){var S=F>>5;F%=32;for(var b=w.g.length-S,D=[],P=0;P<b;P++)D[P]=0<F?w.i(P+S)>>>F|w.i(P+S+1)<<32-F:w.i(P+S);return new a(D,w.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Nk=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=d,xl=a}).apply(typeof J2<"u"?J2:typeof self<"u"?self:typeof window<"u"?window:{});var Od=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Dk,Zu,Pk,eh,fx,Ok,Mk,Lk;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,v,k){return u==Array.prototype||u==Object.prototype||(u[v]=k.value),u};function r(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Od=="object"&&Od];for(var v=0;v<u.length;++v){var k=u[v];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var n=r(this);function i(u,v){if(v)e:{var k=n;u=u.split(".");for(var M=0;M<u.length-1;M++){var se=u[M];if(!(se in k))break e;k=k[se]}u=u[u.length-1],M=k[u],v=v(M),v!=M&&v!=null&&e(k,u,{configurable:!0,writable:!0,value:v})}}function s(u,v){u instanceof String&&(u+="");var k=0,M=!1,se={next:function(){if(!M&&k<u.length){var he=k++;return{value:v(he,u[he]),done:!1}}return M=!0,{done:!0,value:void 0}}};return se[Symbol.iterator]=function(){return se},se}i("Array.prototype.values",function(u){return u||function(){return s(this,function(v,k){return k})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(u){var v=typeof u;return v=v!="object"?v:u?Array.isArray(u)?"array":v:"null",v=="array"||v=="object"&&typeof u.length=="number"}function c(u){var v=typeof u;return v=="object"&&u!=null||v=="function"}function d(u,v,k){return u.call.apply(u.bind,arguments)}function h(u,v,k){if(!u)throw Error();if(2<arguments.length){var M=Array.prototype.slice.call(arguments,2);return function(){var se=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(se,M),u.apply(v,se)}}return function(){return u.apply(v,arguments)}}function p(u,v,k){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,p.apply(null,arguments)}function g(u,v){var k=Array.prototype.slice.call(arguments,1);return function(){var M=k.slice();return M.push.apply(M,arguments),u.apply(this,M)}}function y(u,v){function k(){}k.prototype=v.prototype,u.aa=v.prototype,u.prototype=new k,u.prototype.constructor=u,u.Qb=function(M,se,he){for(var Ue=Array(arguments.length-2),Wt=2;Wt<arguments.length;Wt++)Ue[Wt-2]=arguments[Wt];return v.prototype[se].apply(M,Ue)}}function x(u){const v=u.length;if(0<v){const k=Array(v);for(let M=0;M<v;M++)k[M]=u[M];return k}return[]}function E(u,v){for(let k=1;k<arguments.length;k++){const M=arguments[k];if(l(M)){const se=u.length||0,he=M.length||0;u.length=se+he;for(let Ue=0;Ue<he;Ue++)u[se+Ue]=M[Ue]}else u.push(M)}}class T{constructor(v,k){this.i=v,this.j=k,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function A(u){return/^[\s\xa0]*$/.test(u)}function _(){var u=o.navigator;return u&&(u=u.userAgent)?u:""}function O(u){return O[" "](u),u}O[" "]=function(){};var H=_().indexOf("Gecko")!=-1&&!(_().toLowerCase().indexOf("webkit")!=-1&&_().indexOf("Edge")==-1)&&!(_().indexOf("Trident")!=-1||_().indexOf("MSIE")!=-1)&&_().indexOf("Edge")==-1;function j(u,v,k){for(const M in u)v.call(k,u[M],M,u)}function w(u,v){for(const k in u)v.call(void 0,u[k],k,u)}function F(u){const v={};for(const k in u)v[k]=u[k];return v}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(u,v){let k,M;for(let se=1;se<arguments.length;se++){M=arguments[se];for(k in M)u[k]=M[k];for(let he=0;he<S.length;he++)k=S[he],Object.prototype.hasOwnProperty.call(M,k)&&(u[k]=M[k])}}function D(u){var v=1;u=u.split(":");const k=[];for(;0<v&&u.length;)k.push(u.shift()),v--;return u.length&&k.push(u.join(":")),k}function P(u){o.setTimeout(()=>{throw u},0)}function N(){var u=Q;let v=null;return u.g&&(v=u.g,u.g=u.g.next,u.g||(u.h=null),v.next=null),v}class ze{constructor(){this.h=this.g=null}add(v,k){const M=ge.get();M.set(v,k),this.h?this.h.next=M:this.g=M,this.h=M}}var ge=new T(()=>new be,u=>u.reset());class be{constructor(){this.next=this.g=this.h=null}set(v,k){this.h=v,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let Se,ye=!1,Q=new ze,Ce=()=>{const u=o.Promise.resolve(void 0);Se=()=>{u.then(Be)}};var Be=()=>{for(var u;u=N();){try{u.h.call(u.g)}catch(k){P(k)}var v=ge;v.j(u),100>v.h&&(v.h++,u.next=v.g,v.g=u)}ye=!1};function V(){this.s=this.s,this.C=this.C}V.prototype.s=!1,V.prototype.ma=function(){this.s||(this.s=!0,this.N())},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function G(u,v){this.type=u,this.g=this.target=v,this.defaultPrevented=!1}G.prototype.h=function(){this.defaultPrevented=!0};var q=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var u=!1,v=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const k=()=>{};o.addEventListener("test",k,v),o.removeEventListener("test",k,v)}catch{}return u}();function Y(u,v){if(G.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var k=this.type=u.type,M=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=v,v=u.relatedTarget){if(H){e:{try{O(v.nodeName);var se=!0;break e}catch{}se=!1}se||(v=null)}}else k=="mouseover"?v=u.fromElement:k=="mouseout"&&(v=u.toElement);this.relatedTarget=v,M?(this.clientX=M.clientX!==void 0?M.clientX:M.pageX,this.clientY=M.clientY!==void 0?M.clientY:M.pageY,this.screenX=M.screenX||0,this.screenY=M.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:de[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&Y.aa.h.call(this)}}y(Y,G);var de={2:"touch",3:"pen",4:"mouse"};Y.prototype.h=function(){Y.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Ae="closure_listenable_"+(1e6*Math.random()|0),Pe=0;function ke(u,v,k,M,se){this.listener=u,this.proxy=null,this.src=v,this.type=k,this.capture=!!M,this.ha=se,this.key=++Pe,this.da=this.fa=!1}function we(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function it(u){this.src=u,this.g={},this.h=0}it.prototype.add=function(u,v,k,M,se){var he=u.toString();u=this.g[he],u||(u=this.g[he]=[],this.h++);var Ue=Bt(u,v,M,se);return-1<Ue?(v=u[Ue],k||(v.fa=!1)):(v=new ke(v,this.src,he,!!M,se),v.fa=k,u.push(v)),v};function K(u,v){var k=v.type;if(k in u.g){var M=u.g[k],se=Array.prototype.indexOf.call(M,v,void 0),he;(he=0<=se)&&Array.prototype.splice.call(M,se,1),he&&(we(v),u.g[k].length==0&&(delete u.g[k],u.h--))}}function Bt(u,v,k,M){for(var se=0;se<u.length;++se){var he=u[se];if(!he.da&&he.listener==v&&he.capture==!!k&&he.ha==M)return se}return-1}var gt="closure_lm_"+(1e6*Math.random()|0),bt={};function ht(u,v,k,M,se){if(Array.isArray(v)){for(var he=0;he<v.length;he++)ht(u,v[he],k,M,se);return null}return k=mi(k),u&&u[Ae]?u.K(v,k,c(M)?!!M.capture:!1,se):$e(u,v,k,!1,M,se)}function $e(u,v,k,M,se,he){if(!v)throw Error("Invalid event type");var Ue=c(se)?!!se.capture:!!se,Wt=pi(u);if(Wt||(u[gt]=Wt=new it(u)),k=Wt.add(v,k,M,Ue,he),k.proxy)return k;if(M=Zt(),k.proxy=M,M.src=u,M.listener=k,u.addEventListener)q||(se=Ue),se===void 0&&(se=!1),u.addEventListener(v.toString(),M,se);else if(u.attachEvent)u.attachEvent(hi(v.toString()),M);else if(u.addListener&&u.removeListener)u.addListener(M);else throw Error("addEventListener and attachEvent are unavailable.");return k}function Zt(){function u(k){return v.call(u.src,u.listener,k)}const v=$i;return u}function pn(u,v,k,M,se){if(Array.isArray(v))for(var he=0;he<v.length;he++)pn(u,v[he],k,M,se);else M=c(M)?!!M.capture:!!M,k=mi(k),u&&u[Ae]?(u=u.i,v=String(v).toString(),v in u.g&&(he=u.g[v],k=Bt(he,k,M,se),-1<k&&(we(he[k]),Array.prototype.splice.call(he,k,1),he.length==0&&(delete u.g[v],u.h--)))):u&&(u=pi(u))&&(v=u.g[v.toString()],u=-1,v&&(u=Bt(v,k,M,se)),(k=-1<u?v[u]:null)&&Yr(k))}function Yr(u){if(typeof u!="number"&&u&&!u.da){var v=u.src;if(v&&v[Ae])K(v.i,u);else{var k=u.type,M=u.proxy;v.removeEventListener?v.removeEventListener(k,M,u.capture):v.detachEvent?v.detachEvent(hi(k),M):v.addListener&&v.removeListener&&v.removeListener(M),(k=pi(v))?(K(k,u),k.h==0&&(k.src=null,v[gt]=null)):we(u)}}}function hi(u){return u in bt?bt[u]:bt[u]="on"+u}function $i(u,v){if(u.da)u=!0;else{v=new Y(v,this);var k=u.listener,M=u.ha||u.src;u.fa&&Yr(u),u=k.call(M,v)}return u}function pi(u){return u=u[gt],u instanceof it?u:null}var Fr="__closure_events_fn_"+(1e9*Math.random()>>>0);function mi(u){return typeof u=="function"?u:(u[Fr]||(u[Fr]=function(v){return u.handleEvent(v)}),u[Fr])}function Pt(){V.call(this),this.i=new it(this),this.M=this,this.F=null}y(Pt,V),Pt.prototype[Ae]=!0,Pt.prototype.removeEventListener=function(u,v,k,M){pn(this,u,v,k,M)};function vr(u,v){var k,M=u.F;if(M)for(k=[];M;M=M.F)k.push(M);if(u=u.M,M=v.type||v,typeof v=="string")v=new G(v,u);else if(v instanceof G)v.target=v.target||u;else{var se=v;v=new G(M,u),b(v,se)}if(se=!0,k)for(var he=k.length-1;0<=he;he--){var Ue=v.g=k[he];se=nr(Ue,M,!0,v)&&se}if(Ue=v.g=u,se=nr(Ue,M,!0,v)&&se,se=nr(Ue,M,!1,v)&&se,k)for(he=0;he<k.length;he++)Ue=v.g=k[he],se=nr(Ue,M,!1,v)&&se}Pt.prototype.N=function(){if(Pt.aa.N.call(this),this.i){var u=this.i,v;for(v in u.g){for(var k=u.g[v],M=0;M<k.length;M++)we(k[M]);delete u.g[v],u.h--}}this.F=null},Pt.prototype.K=function(u,v,k,M){return this.i.add(String(u),v,!1,k,M)},Pt.prototype.L=function(u,v,k,M){return this.i.add(String(u),v,!0,k,M)};function nr(u,v,k,M){if(v=u.i.g[String(v)],!v)return!0;v=v.concat();for(var se=!0,he=0;he<v.length;++he){var Ue=v[he];if(Ue&&!Ue.da&&Ue.capture==k){var Wt=Ue.listener,qr=Ue.ha||Ue.src;Ue.fa&&K(u.i,Ue),se=Wt.call(qr,M)!==!1&&se}}return se&&!M.defaultPrevented}function Zn(u,v,k){if(typeof u=="function")k&&(u=p(u,k));else if(u&&typeof u.handleEvent=="function")u=p(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:o.setTimeout(u,v||0)}function ct(u){u.g=Zn(()=>{u.g=null,u.i&&(u.i=!1,ct(u))},u.l);const v=u.h;u.h=null,u.m.apply(null,v)}class ir extends V{constructor(v,k){super(),this.m=v,this.l=k,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:ct(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function yr(u){V.call(this),this.h=u,this.g={}}y(yr,V);var dr=[];function Dn(u){j(u.g,function(v,k){this.g.hasOwnProperty(k)&&Yr(v)},u),u.g={}}yr.prototype.N=function(){yr.aa.N.call(this),Dn(this)},yr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ae=o.JSON.stringify,zr=o.JSON.parse,oa=class{stringify(u){return o.JSON.stringify(u,void 0)}parse(u){return o.JSON.parse(u,void 0)}};function la(){}la.prototype.h=null;function Os(u){return u.h||(u.h=u.i())}function ca(){}var ki={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Gi(){G.call(this,"d")}y(Gi,G);function _r(){G.call(this,"c")}y(_r,G);var Ki={},ua=null;function $a(){return ua=ua||new Pt}Ki.La="serverreachability";function Pn(u){G.call(this,Ki.La,u)}y(Pn,G);function Ms(u){const v=$a();vr(v,new Pn(v))}Ki.STAT_EVENT="statevent";function er(u,v){G.call(this,Ki.STAT_EVENT,u),this.stat=v}y(er,G);function hr(u){const v=$a();vr(v,new er(v,u))}Ki.Ma="timingevent";function Ci(u,v){G.call(this,Ki.Ma,u),this.size=v}y(Ci,G);function mn(u,v){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){u()},v)}function fa(){this.g=!0}fa.prototype.xa=function(){this.g=!1};function $l(u,v,k,M,se,he){u.info(function(){if(u.g)if(he)for(var Ue="",Wt=he.split("&"),qr=0;qr<Wt.length;qr++){var Ft=Wt[qr].split("=");if(1<Ft.length){var an=Ft[0];Ft=Ft[1];var on=an.split("_");Ue=2<=on.length&&on[1]=="type"?Ue+(an+"="+Ft+"&"):Ue+(an+"=redacted&")}}else Ue=null;else Ue=he;return"XMLHTTP REQ ("+M+") [attempt "+se+"]: "+v+`
`+k+`
`+Ue})}function ms(u,v,k,M,se,he,Ue){u.info(function(){return"XMLHTTP RESP ("+M+") [ attempt "+se+"]: "+v+`
`+k+`
`+he+" "+Ue})}function I(u,v,k,M){u.info(function(){return"XMLHTTP TEXT ("+v+"): "+B(u,k)+(M?" "+M:"")})}function z(u,v){u.info(function(){return"TIMEOUT: "+v})}fa.prototype.info=function(){};function B(u,v){if(!u.g)return v;if(!v)return null;try{var k=JSON.parse(v);if(k){for(u=0;u<k.length;u++)if(Array.isArray(k[u])){var M=k[u];if(!(2>M.length)){var se=M[1];if(Array.isArray(se)&&!(1>se.length)){var he=se[0];if(he!="noop"&&he!="stop"&&he!="close")for(var Ue=1;Ue<se.length;Ue++)se[Ue]=""}}}}return ae(k)}catch{return v}}var L={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},W={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},U;function le(){}y(le,la),le.prototype.g=function(){return new XMLHttpRequest},le.prototype.i=function(){return{}},U=new le;function ne(u,v,k,M){this.j=u,this.i=v,this.l=k,this.R=M||1,this.U=new yr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new oe}function oe(){this.i=null,this.g="",this.h=!1}var te={},ce={};function xe(u,v,k){u.L=1,u.v=Ls(xs(v)),u.m=k,u.P=!0,Me(u,null)}function Me(u,v){u.F=Date.now(),We(u),u.A=xs(u.v);var k=u.A,M=u.R;Array.isArray(M)||(M=[String(M)]),xi(k.i,"t",M),u.C=0,k=u.j.J,u.h=new oe,u.g=Y0(u.j,k?v:null,!u.m),0<u.O&&(u.M=new ir(p(u.Y,u,u.g),u.O)),v=u.U,k=u.g,M=u.ca;var se="readystatechange";Array.isArray(se)||(se&&(dr[0]=se.toString()),se=dr);for(var he=0;he<se.length;he++){var Ue=ht(k,se[he],M||v.handleEvent,!1,v.h||v);if(!Ue)break;v.g[Ue.key]=Ue}v=u.H?F(u.H):{},u.m?(u.u||(u.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,v)):(u.u="GET",u.g.ea(u.A,u.u,null,v)),Ms(),$l(u.i,u.u,u.A,u.l,u.R,u.m)}ne.prototype.ca=function(u){u=u.target;const v=this.M;v&&Qi(u)==3?v.j():this.Y(u)},ne.prototype.Y=function(u){try{if(u==this.g)e:{const on=Qi(this.g);var v=this.g.Ba();const eo=this.g.Z();if(!(3>on)&&(on!=3||this.g&&(this.h.h||this.g.oa()||Ql(this.g)))){this.J||on!=4||v==7||(v==8||0>=eo?Ms(3):Ms(2)),Et(this);var k=this.g.Z();this.X=k;t:if(Ge(this)){var M=Ql(this.g);u="";var se=M.length,he=Qi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){wt(this),kt(this);var Ue="";break t}this.h.i=new o.TextDecoder}for(v=0;v<se;v++)this.h.h=!0,u+=this.h.i.decode(M[v],{stream:!(he&&v==se-1)});M.length=0,this.h.g+=u,this.C=0,Ue=this.h.g}else Ue=this.g.oa();if(this.o=k==200,ms(this.i,this.u,this.A,this.l,this.R,on,k),this.o){if(this.T&&!this.K){t:{if(this.g){var Wt,qr=this.g;if((Wt=qr.g?qr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(Wt)){var Ft=Wt;break t}}Ft=null}if(k=Ft)I(this.i,this.l,k,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ei(this,k);else{this.o=!1,this.s=3,hr(12),wt(this),kt(this);break e}}if(this.P){k=!0;let Ri;for(;!this.J&&this.C<Ue.length;)if(Ri=Ie(this,Ue),Ri==ce){on==4&&(this.s=4,hr(14),k=!1),I(this.i,this.l,null,"[Incomplete Response]");break}else if(Ri==te){this.s=4,hr(15),I(this.i,this.l,Ue,"[Invalid Chunk]"),k=!1;break}else I(this.i,this.l,Ri,null),ei(this,Ri);if(Ge(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),on!=4||Ue.length!=0||this.h.h||(this.s=1,hr(16),k=!1),this.o=this.o&&k,!k)I(this.i,this.l,Ue,"[Invalid Chunked Response]"),wt(this),kt(this);else if(0<Ue.length&&!this.W){this.W=!0;var an=this.j;an.g==this&&an.ba&&!an.M&&(an.j.info("Great, no buffering proxy detected. Bytes received: "+Ue.length),Fu(an),an.M=!0,hr(11))}}else I(this.i,this.l,Ue,null),ei(this,Ue);on==4&&wt(this),this.o&&!this.J&&(on==4?K0(this.j,this):(this.o=!1,We(this)))}else Yp(this.g),k==400&&0<Ue.indexOf("Unknown SID")?(this.s=3,hr(12)):(this.s=0,hr(13)),wt(this),kt(this)}}}catch{}finally{}};function Ge(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function Ie(u,v){var k=u.C,M=v.indexOf(`
`,k);return M==-1?ce:(k=Number(v.substring(k,M)),isNaN(k)?te:(M+=1,M+k>v.length?ce:(v=v.slice(M,M+k),u.C=M+k,v)))}ne.prototype.cancel=function(){this.J=!0,wt(this)};function We(u){u.S=Date.now()+u.I,st(u,u.I)}function st(u,v){if(u.B!=null)throw Error("WatchDog timer not null");u.B=mn(p(u.ba,u),v)}function Et(u){u.B&&(o.clearTimeout(u.B),u.B=null)}ne.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(z(this.i,this.A),this.L!=2&&(Ms(),hr(17)),wt(this),this.s=2,kt(this)):st(this,this.S-u)};function kt(u){u.j.G==0||u.J||K0(u.j,u)}function wt(u){Et(u);var v=u.M;v&&typeof v.ma=="function"&&v.ma(),u.M=null,Dn(u.U),u.g&&(v=u.g,u.g=null,v.abort(),v.ma())}function ei(u,v){try{var k=u.j;if(k.G!=0&&(k.g==u||vn(k.h,u))){if(!u.K&&vn(k.h,u)&&k.G==3){try{var M=k.Da.g.parse(v)}catch{M=null}if(Array.isArray(M)&&M.length==3){var se=M;if(se[0]==0){e:if(!k.u){if(k.g)if(k.g.F+3e3<u.F)tc(k),pa(k);else break e;Cu(k),hr(18)}}else k.za=se[1],0<k.za-k.T&&37500>se[2]&&k.F&&k.v==0&&!k.C&&(k.C=mn(p(k.Za,k),6e3));if(1>=Ii(k.h)&&k.ca){try{k.ca()}catch{}k.ca=void 0}}else ma(k,11)}else if((u.K||k.g==u)&&tc(k),!A(v))for(se=k.Da.g.parse(v),v=0;v<se.length;v++){let Ft=se[v];if(k.T=Ft[0],Ft=Ft[1],k.G==2)if(Ft[0]=="c"){k.K=Ft[1],k.ia=Ft[2];const an=Ft[3];an!=null&&(k.la=an,k.j.info("VER="+k.la));const on=Ft[4];on!=null&&(k.Aa=on,k.j.info("SVER="+k.Aa));const eo=Ft[5];eo!=null&&typeof eo=="number"&&0<eo&&(M=1.5*eo,k.L=M,k.j.info("backChannelRequestTimeoutMs_="+M)),M=k;const Ri=u.g;if(Ri){const ic=Ri.g?Ri.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ic){var he=M.h;he.g||ic.indexOf("spdy")==-1&&ic.indexOf("quic")==-1&&ic.indexOf("h2")==-1||(he.j=he.l,he.g=new Set,he.h&&(Ga(he,he.h),he.h=null))}if(M.D){const Ru=Ri.g?Ri.g.getResponseHeader("X-HTTP-Session-Id"):null;Ru&&(M.ya=Ru,Xe(M.I,M.D,Ru))}}k.G=3,k.l&&k.l.ua(),k.ba&&(k.R=Date.now()-u.F,k.j.info("Handshake RTT: "+k.R+"ms")),M=k;var Ue=u;if(M.qa=X0(M,M.J?M.ia:null,M.W),Ue.K){ti(M.h,Ue);var Wt=Ue,qr=M.L;qr&&(Wt.I=qr),Wt.B&&(Et(Wt),We(Wt)),M.g=Ue}else Ja(M);0<k.i.length&&Zl(k)}else Ft[0]!="stop"&&Ft[0]!="close"||ma(k,7);else k.G==3&&(Ft[0]=="stop"||Ft[0]=="close"?Ft[0]=="stop"?ma(k,7):Qa(k):Ft[0]!="noop"&&k.l&&k.l.ta(Ft),k.v=0)}}Ms(4)}catch{}}var gn=class{constructor(u,v){this.g=u,this.map=v}};function Fi(u){this.l=u||10,o.PerformanceNavigationTiming?(u=o.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function xn(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Ii(u){return u.h?1:u.g?u.g.size:0}function vn(u,v){return u.h?u.h==v:u.g?u.g.has(v):!1}function Ga(u,v){u.g?u.g.add(v):u.h=v}function ti(u,v){u.h&&u.h==v?u.h=null:u.g&&u.g.has(v)&&u.g.delete(v)}Fi.prototype.cancel=function(){if(this.i=Yo(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function Yo(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let v=u.i;for(const k of u.g.values())v=v.concat(k.D);return v}return x(u.i)}function gi(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var v=[],k=u.length,M=0;M<k;M++)v.push(u[M]);return v}v=[],k=0;for(M in u)v[k++]=u[M];return v}function Gl(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var v=[];u=u.length;for(var k=0;k<u;k++)v.push(k);return v}v=[],k=0;for(const M in u)v[k++]=M;return v}}}function gs(u,v){if(u.forEach&&typeof u.forEach=="function")u.forEach(v,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,v,void 0);else for(var k=Gl(u),M=gi(u),se=M.length,he=0;he<se;he++)v.call(void 0,M[he],k&&k[he],u)}var Kl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function yn(u,v){if(u){u=u.split("&");for(var k=0;k<u.length;k++){var M=u[k].indexOf("="),se=null;if(0<=M){var he=u[k].substring(0,M);se=u[k].substring(M+1)}else he=u[k];v(he,se?decodeURIComponent(se.replace(/\+/g," ")):"")}}}function Xi(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Xi){this.h=u.h,da(this,u.j),this.o=u.o,this.g=u.g,qo(this,u.s),this.l=u.l;var v=u.i,k=new vs;k.i=v.i,v.g&&(k.g=new Map(v.g),k.h=v.h),Xl(this,k),this.m=u.m}else u&&(v=String(u).match(Kl))?(this.h=!1,da(this,v[1]||"",!0),this.o=Yt(v[2]||""),this.g=Yt(v[3]||"",!0),qo(this,v[4]),this.l=Yt(v[5]||"",!0),Xl(this,v[6]||"",!0),this.m=Yt(v[7]||"")):(this.h=!1,this.i=new vs(null,this.h))}Xi.prototype.toString=function(){var u=[],v=this.j;v&&u.push(Yi(v,wu,!0),":");var k=this.g;return(k||v=="file")&&(u.push("//"),(v=this.o)&&u.push(Yi(v,wu,!0),"@"),u.push(encodeURIComponent(String(k)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.s,k!=null&&u.push(":",String(k))),(k=this.l)&&(this.g&&k.charAt(0)!="/"&&u.push("/"),u.push(Yi(k,k.charAt(0)=="/"?B0:Tu,!0))),(k=this.i.toString())&&u.push("?",k),(k=this.m)&&u.push("#",Yi(k,V0)),u.join("")};function xs(u){return new Xi(u)}function da(u,v,k){u.j=k?Yt(v,!0):v,u.j&&(u.j=u.j.replace(/:$/,""))}function qo(u,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);u.s=v}else u.s=null}function Xl(u,v,k){v instanceof vs?(u.i=v,Yl(u.i,u.h)):(k||(v=Yi(v,j0)),u.i=new vs(v,u.h))}function Xe(u,v,k){u.i.set(v,k)}function Ls(u){return Xe(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Yt(u,v){return u?v?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Yi(u,v,k){return typeof u=="string"?(u=encodeURI(u).replace(v,L0),k&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function L0(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var wu=/[#\/\?@]/g,Tu=/[#\?:]/g,B0=/[#\?]/g,j0=/[#\?@]/g,V0=/#/g;function vs(u,v){this.h=this.g=null,this.i=u||null,this.j=!!v}function ys(u){u.g||(u.g=new Map,u.h=0,u.i&&yn(u.i,function(v,k){u.add(decodeURIComponent(v.replace(/\+/g," ")),k)}))}t=vs.prototype,t.add=function(u,v){ys(this),this.i=null,u=_s(this,u);var k=this.g.get(u);return k||this.g.set(u,k=[]),k.push(v),this.h+=1,this};function Su(u,v){ys(u),v=_s(u,v),u.g.has(v)&&(u.i=null,u.h-=u.g.get(v).length,u.g.delete(v))}function sn(u,v){return ys(u),v=_s(u,v),u.g.has(v)}t.forEach=function(u,v){ys(this),this.g.forEach(function(k,M){k.forEach(function(se){u.call(v,se,M,this)},this)},this)},t.na=function(){ys(this);const u=Array.from(this.g.values()),v=Array.from(this.g.keys()),k=[];for(let M=0;M<v.length;M++){const se=u[M];for(let he=0;he<se.length;he++)k.push(v[M])}return k},t.V=function(u){ys(this);let v=[];if(typeof u=="string")sn(this,u)&&(v=v.concat(this.g.get(_s(this,u))));else{u=Array.from(this.g.values());for(let k=0;k<u.length;k++)v=v.concat(u[k])}return v},t.set=function(u,v){return ys(this),this.i=null,u=_s(this,u),sn(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[v]),this.h+=1,this},t.get=function(u,v){return u?(u=this.V(u),0<u.length?String(u[0]):v):v};function xi(u,v,k){Su(u,v),0<k.length&&(u.i=null,u.g.set(_s(u,v),x(k)),u.h+=k.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],v=Array.from(this.g.keys());for(var k=0;k<v.length;k++){var M=v[k];const he=encodeURIComponent(String(M)),Ue=this.V(M);for(M=0;M<Ue.length;M++){var se=he;Ue[M]!==""&&(se+="="+encodeURIComponent(String(Ue[M]))),u.push(se)}}return this.i=u.join("&")};function _s(u,v){return v=String(v),u.j&&(v=v.toLowerCase()),v}function Yl(u,v){v&&!u.j&&(ys(u),u.i=null,u.g.forEach(function(k,M){var se=M.toLowerCase();M!=se&&(Su(this,M),xi(this,se,k))},u)),u.j=v}function U0(u,v){const k=new fa;if(o.Image){const M=new Image;M.onload=g(tr,k,"TestLoadImage: loaded",!0,v,M),M.onerror=g(tr,k,"TestLoadImage: error",!1,v,M),M.onabort=g(tr,k,"TestLoadImage: abort",!1,v,M),M.ontimeout=g(tr,k,"TestLoadImage: timeout",!1,v,M),o.setTimeout(function(){M.ontimeout&&M.ontimeout()},1e4),M.src=u}else v(!1)}function ql(u,v){const k=new fa,M=new AbortController,se=setTimeout(()=>{M.abort(),tr(k,"TestPingServer: timeout",!1,v)},1e4);fetch(u,{signal:M.signal}).then(he=>{clearTimeout(se),he.ok?tr(k,"TestPingServer: ok",!0,v):tr(k,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(se),tr(k,"TestPingServer: error",!1,v)})}function tr(u,v,k,M,se){try{se&&(se.onload=null,se.onerror=null,se.onabort=null,se.ontimeout=null),M(k)}catch{}}function Ka(){this.g=new oa}function Er(u,v,k){const M=k||"";try{gs(u,function(se,he){let Ue=se;c(se)&&(Ue=ae(se)),v.push(M+he+"="+encodeURIComponent(Ue))})}catch(se){throw v.push(M+"type="+encodeURIComponent("_badmap")),se}}function Xa(u){this.l=u.Ub||null,this.j=u.eb||!1}y(Xa,la),Xa.prototype.g=function(){return new Ya(this.l,this.j)},Xa.prototype.i=function(u){return function(){return u}}({});function Ya(u,v){Pt.call(this),this.D=u,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(Ya,Pt),t=Ya.prototype,t.open=function(u,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=v,this.readyState=1,qa(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(v.body=u),(this.D||o).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,bi(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,qa(this)),this.g&&(this.readyState=3,qa(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Qo(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Qo(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var v=u.value?u.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!u.done}))&&(this.response=this.responseText+=v)}u.done?bi(this):qa(this),this.readyState==3&&Qo(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,bi(this))},t.Qa=function(u){this.g&&(this.response=u,bi(this))},t.ga=function(){this.g&&bi(this)};function bi(u){u.readyState=4,u.l=null,u.j=null,u.v=null,qa(u)}t.setRequestHeader=function(u,v){this.u.append(u,v)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],v=this.h.entries();for(var k=v.next();!k.done;)k=k.value,u.push(k[0]+": "+k[1]),k=v.next();return u.join(`\r
`)};function qa(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Ya.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Au(u){let v="";return j(u,function(k,M){v+=M,v+=":",v+=k,v+=`\r
`}),v}function ku(u,v,k){e:{for(M in k){var M=!1;break e}M=!0}M||(k=Au(k),typeof u=="string"?k!=null&&encodeURIComponent(String(k)):Xe(u,v,k))}function qt(u){Pt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(qt,Pt);var z0=/^https?$/i,Bs=["POST","PUT"];t=qt.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,v,k,M){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);v=v?v.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():U.g(),this.v=this.o?Os(this.o):Os(U),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(v,String(u),!0),this.B=!1}catch(he){W0(this,he);return}if(u=k||"",k=new Map(this.headers),M)if(Object.getPrototypeOf(M)===Object.prototype)for(var se in M)k.set(se,M[se]);else if(typeof M.keys=="function"&&typeof M.get=="function")for(const he of M.keys())k.set(he,M.get(he));else throw Error("Unknown input type for opt_headers: "+String(M));M=Array.from(k.keys()).find(he=>he.toLowerCase()=="content-type"),se=o.FormData&&u instanceof o.FormData,!(0<=Array.prototype.indexOf.call(Bs,v,void 0))||M||se||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[he,Ue]of k)this.g.setRequestHeader(he,Ue);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{qi(this),this.u=!0,this.g.send(u),this.u=!1}catch(he){W0(this,he)}};function W0(u,v){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=v,u.m=5,H0(u),ha(u)}function H0(u){u.A||(u.A=!0,vr(u,"complete"),vr(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,vr(this,"complete"),vr(this,"abort"),ha(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ha(this,!0)),qt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?$0(this):this.bb())},t.bb=function(){$0(this)};function $0(u){if(u.h&&typeof a<"u"&&(!u.v[1]||Qi(u)!=4||u.Z()!=2)){if(u.u&&Qi(u)==4)Zn(u.Ea,0,u);else if(vr(u,"readystatechange"),Qi(u)==4){u.h=!1;try{const Ue=u.Z();e:switch(Ue){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var k;if(!(k=v)){var M;if(M=Ue===0){var se=String(u.D).match(Kl)[1]||null;!se&&o.self&&o.self.location&&(se=o.self.location.protocol.slice(0,-1)),M=!z0.test(se?se.toLowerCase():"")}k=M}if(k)vr(u,"complete"),vr(u,"success");else{u.m=6;try{var he=2<Qi(u)?u.g.statusText:""}catch{he=""}u.l=he+" ["+u.Z()+"]",H0(u)}}finally{ha(u)}}}}function ha(u,v){if(u.g){qi(u);const k=u.g,M=u.v[0]?()=>{}:null;u.g=null,u.v=null,v||vr(u,"ready");try{k.onreadystatechange=M}catch{}}}function qi(u){u.I&&(o.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function Qi(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<Qi(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var v=this.g.responseText;return u&&v.indexOf(u)==0&&(v=v.substring(u.length)),zr(v)}};function Ql(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Yp(u){const v={};u=(u.g&&2<=Qi(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let M=0;M<u.length;M++){if(A(u[M]))continue;var k=D(u[M]);const se=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const he=v[se]||[];v[se]=he,he.push(k)}w(v,function(M){return M.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ut(u,v,k){return k&&k.internalChannelParams&&k.internalChannelParams[u]||v}function On(u){this.Aa=0,this.i=[],this.j=new fa,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ut("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ut("baseRetryDelayMs",5e3,u),this.cb=Ut("retryDelaySeedMs",1e4,u),this.Wa=Ut("forwardChannelMaxRetries",2,u),this.wa=Ut("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Fi(u&&u.concurrentRequestLimit),this.Da=new Ka,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=On.prototype,t.la=8,t.G=1,t.connect=function(u,v,k,M){hr(0),this.W=u,this.H=v||{},k&&M!==void 0&&(this.H.OSID=k,this.H.OAID=M),this.F=this.X,this.I=X0(this,null,this.W),Zl(this)};function Qa(u){if(Jl(u),u.G==3){var v=u.U++,k=xs(u.I);if(Xe(k,"SID",u.K),Xe(k,"RID",v),Xe(k,"TYPE","terminate"),Jo(u,k),v=new ne(u,u.j,v),v.L=2,v.v=Ls(xs(k)),k=!1,o.navigator&&o.navigator.sendBeacon)try{k=o.navigator.sendBeacon(v.v.toString(),"")}catch{}!k&&o.Image&&(new Image().src=v.v,k=!0),k||(v.g=Y0(v.j,null),v.g.ea(v.v)),v.F=Date.now(),We(v)}bu(u)}function pa(u){u.g&&(Fu(u),u.g.cancel(),u.g=null)}function Jl(u){pa(u),u.u&&(o.clearTimeout(u.u),u.u=null),tc(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&o.clearTimeout(u.s),u.s=null)}function Zl(u){if(!xn(u.h)&&!u.s){u.s=!0;var v=u.Ga;Se||Ce(),ye||(Se(),ye=!0),Q.add(v,u),u.B=0}}function qp(u,v){return Ii(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=v.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=mn(p(u.Ga,u,v),Iu(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const se=new ne(this,this.j,u);let he=this.o;if(this.S&&(he?(he=F(he),b(he,this.S)):he=this.S),this.m!==null||this.O||(se.H=he,he=null),this.P)e:{for(var v=0,k=0;k<this.i.length;k++){t:{var M=this.i[k];if("__data__"in M.map&&(M=M.map.__data__,typeof M=="string")){M=M.length;break t}M=void 0}if(M===void 0)break;if(v+=M,4096<v){v=k;break e}if(v===4096||k===this.i.length-1){v=k+1;break e}}v=1e3}else v=1e3;v=ec(this,se,v),k=xs(this.I),Xe(k,"RID",u),Xe(k,"CVER",22),this.D&&Xe(k,"X-HTTP-Session-Id",this.D),Jo(this,k),he&&(this.O?v="headers="+encodeURIComponent(String(Au(he)))+"&"+v:this.m&&ku(k,this.m,he)),Ga(this.h,se),this.Ua&&Xe(k,"TYPE","init"),this.P?(Xe(k,"$req",v),Xe(k,"SID","null"),se.T=!0,xe(se,k,null)):xe(se,k,v),this.G=2}}else this.G==3&&(u?js(this,u):this.i.length==0||xn(this.h)||js(this))};function js(u,v){var k;v?k=v.l:k=u.U++;const M=xs(u.I);Xe(M,"SID",u.K),Xe(M,"RID",k),Xe(M,"AID",u.T),Jo(u,M),u.m&&u.o&&ku(M,u.m,u.o),k=new ne(u,u.j,k,u.B+1),u.m===null&&(k.H=u.o),v&&(u.i=v.D.concat(u.i)),v=ec(u,k,1e3),k.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Ga(u.h,k),xe(k,M,v)}function Jo(u,v){u.H&&j(u.H,function(k,M){Xe(v,M,k)}),u.l&&gs({},function(k,M){Xe(v,M,k)})}function ec(u,v,k){k=Math.min(u.i.length,k);var M=u.l?p(u.l.Na,u.l,u):null;e:{var se=u.i;let he=-1;for(;;){const Ue=["count="+k];he==-1?0<k?(he=se[0].g,Ue.push("ofs="+he)):he=0:Ue.push("ofs="+he);let Wt=!0;for(let qr=0;qr<k;qr++){let Ft=se[qr].g;const an=se[qr].map;if(Ft-=he,0>Ft)he=Math.max(0,se[qr].g-100),Wt=!1;else try{Er(an,Ue,"req"+Ft+"_")}catch{M&&M(an)}}if(Wt){M=Ue.join("&");break e}}}return u=u.i.splice(0,k),v.D=u,M}function Ja(u){if(!u.g&&!u.u){u.Y=1;var v=u.Fa;Se||Ce(),ye||(Se(),ye=!0),Q.add(v,u),u.v=0}}function Cu(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=mn(p(u.Fa,u),Iu(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,G0(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=mn(p(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,hr(10),pa(this),G0(this))};function Fu(u){u.A!=null&&(o.clearTimeout(u.A),u.A=null)}function G0(u){u.g=new ne(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var v=xs(u.qa);Xe(v,"RID","rpc"),Xe(v,"SID",u.K),Xe(v,"AID",u.T),Xe(v,"CI",u.F?"0":"1"),!u.F&&u.ja&&Xe(v,"TO",u.ja),Xe(v,"TYPE","xmlhttp"),Jo(u,v),u.m&&u.o&&ku(v,u.m,u.o),u.L&&(u.g.I=u.L);var k=u.g;u=u.ia,k.L=1,k.v=Ls(xs(v)),k.m=null,k.P=!0,Me(k,u)}t.Za=function(){this.C!=null&&(this.C=null,pa(this),Cu(this),hr(19))};function tc(u){u.C!=null&&(o.clearTimeout(u.C),u.C=null)}function K0(u,v){var k=null;if(u.g==v){tc(u),Fu(u),u.g=null;var M=2}else if(vn(u.h,v))k=v.D,ti(u.h,v),M=1;else return;if(u.G!=0){if(v.o)if(M==1){k=v.m?v.m.length:0,v=Date.now()-v.F;var se=u.B;M=$a(),vr(M,new Ci(M,k)),Zl(u)}else Ja(u);else if(se=v.s,se==3||se==0&&0<v.X||!(M==1&&qp(u,v)||M==2&&Cu(u)))switch(k&&0<k.length&&(v=u.h,v.i=v.i.concat(k)),se){case 1:ma(u,5);break;case 4:ma(u,10);break;case 3:ma(u,6);break;default:ma(u,2)}}}function Iu(u,v){let k=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(k*=2),k*v}function ma(u,v){if(u.j.info("Error code "+v),v==2){var k=p(u.fb,u),M=u.Xa;const se=!M;M=new Xi(M||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||da(M,"https"),Ls(M),se?U0(M.toString(),k):ql(M.toString(),k)}else hr(2);u.G=0,u.l&&u.l.sa(v),bu(u),Jl(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),hr(2)):(this.j.info("Failed to ping google.com"),hr(1))};function bu(u){if(u.G=0,u.ka=[],u.l){const v=Yo(u.h);(v.length!=0||u.i.length!=0)&&(E(u.ka,v),E(u.ka,u.i),u.h.i.length=0,x(u.i),u.i.length=0),u.l.ra()}}function X0(u,v,k){var M=k instanceof Xi?xs(k):new Xi(k);if(M.g!="")v&&(M.g=v+"."+M.g),qo(M,M.s);else{var se=o.location;M=se.protocol,v=v?v+"."+se.hostname:se.hostname,se=+se.port;var he=new Xi(null);M&&da(he,M),v&&(he.g=v),se&&qo(he,se),k&&(he.l=k),M=he}return k=u.D,v=u.ya,k&&v&&Xe(M,k,v),Xe(M,"VER",u.la),Jo(u,M),M}function Y0(u,v,k){if(v&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=u.Ca&&!u.pa?new qt(new Xa({eb:k})):new qt(u.pa),v.Ha(u.J),v}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function rc(){}t=rc.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function nc(){}nc.prototype.g=function(u,v){return new ri(u,v)};function ri(u,v){Pt.call(this),this.g=new On(v),this.l=u,this.h=v&&v.messageUrlParams||null,u=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(u?u["X-WebChannel-Content-Type"]=v.messageContentType:u={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(u?u["X-WebChannel-Client-Profile"]=v.va:u={"X-WebChannel-Client-Profile":v.va}),this.g.S=u,(u=v&&v.Sb)&&!A(u)&&(this.g.m=u),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!A(v)&&(this.g.D=v,u=this.h,u!==null&&v in u&&(u=this.h,v in u&&delete u[v])),this.j=new Za(this)}y(ri,Pt),ri.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ri.prototype.close=function(){Qa(this.g)},ri.prototype.o=function(u){var v=this.g;if(typeof u=="string"){var k={};k.__data__=u,u=k}else this.u&&(k={},k.__data__=ae(u),u=k);v.i.push(new gn(v.Ya++,u)),v.G==3&&Zl(v)},ri.prototype.N=function(){this.g.l=null,delete this.j,Qa(this.g),delete this.g,ri.aa.N.call(this)};function q0(u){Gi.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var v=u.__sm__;if(v){e:{for(const k in v){u=k;break e}u=void 0}(this.i=u)&&(u=this.i,v=v!==null&&u in v?v[u]:void 0),this.data=v}else this.data=u}y(q0,Gi);function Q0(){_r.call(this),this.status=1}y(Q0,_r);function Za(u){this.g=u}y(Za,rc),Za.prototype.ua=function(){vr(this.g,"a")},Za.prototype.ta=function(u){vr(this.g,new q0(u))},Za.prototype.sa=function(u){vr(this.g,new Q0)},Za.prototype.ra=function(){vr(this.g,"b")},nc.prototype.createWebChannel=nc.prototype.g,ri.prototype.send=ri.prototype.o,ri.prototype.open=ri.prototype.m,ri.prototype.close=ri.prototype.close,Lk=function(){return new nc},Mk=function(){return $a()},Ok=Ki,fx={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},L.NO_ERROR=0,L.TIMEOUT=8,L.HTTP_ERROR=6,eh=L,W.COMPLETE="complete",Pk=W,ca.EventType=ki,ki.OPEN="a",ki.CLOSE="b",ki.ERROR="c",ki.MESSAGE="d",Pt.prototype.listen=Pt.prototype.K,Zu=ca,qt.prototype.listenOnce=qt.prototype.L,qt.prototype.getLastError=qt.prototype.Ka,qt.prototype.getLastErrorCode=qt.prototype.Ba,qt.prototype.getStatus=qt.prototype.Z,qt.prototype.getResponseJson=qt.prototype.Oa,qt.prototype.getResponseText=qt.prototype.oa,qt.prototype.send=qt.prototype.ea,qt.prototype.setWithCredentials=qt.prototype.Ha,Dk=qt}).apply(typeof Od<"u"?Od:typeof self<"u"?self:typeof window<"u"?window:{});const Z2="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}zn.UNAUTHENTICATED=new zn(null),zn.GOOGLE_CREDENTIALS=new zn("google-credentials-uid"),zn.FIRST_PARTY=new zn("first-party-uid"),zn.MOCK_USER=new zn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xu="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rl=new uv("@firebase/firestore");function $u(){return Rl.logLevel}function Ze(t,...e){if(Rl.logLevel<=Ct.DEBUG){const r=e.map(hv);Rl.debug(`Firestore (${xu}): ${t}`,...r)}}function Ma(t,...e){if(Rl.logLevel<=Ct.ERROR){const r=e.map(hv);Rl.error(`Firestore (${xu}): ${t}`,...r)}}function tu(t,...e){if(Rl.logLevel<=Ct.WARN){const r=e.map(hv);Rl.warn(`Firestore (${xu}): ${t}`,...r)}}function hv(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dt(t="Unexpected state"){const e=`FIRESTORE (${xu}) INTERNAL ASSERTION FAILED: `+t;throw Ma(e),new Error(e)}function Xt(t,e){t||dt()}function mt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const De={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class tt extends Ha{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bk{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class kj{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(zn.UNAUTHENTICATED))}shutdown(){}}class Cj{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class Fj{constructor(e){this.t=e,this.currentUser=zn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Xt(this.o===void 0);let n=this.i;const i=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let s=new No;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new No,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{Ze("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Ze("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new No)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Ze("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Xt(typeof n.accessToken=="string"),new Bk(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Xt(e===null||typeof e=="string"),new zn(e)}}class Ij{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=zn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class bj{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new Ij(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(zn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Rj{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Nj{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){Xt(this.o===void 0);const n=s=>{s.error!=null&&Ze("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,Ze("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{Ze("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Ze("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Xt(typeof r.token=="string"),this.R=r.token,new Rj(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dj(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=Dj(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=e.charAt(i[s]%e.length))}return n}}function Lt(t,e){return t<e?-1:t>e?1:0}function ru(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new tt(De.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new tt(De.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new tt(De.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new tt(De.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return rn.fromMillis(Date.now())}static fromDate(e){return rn.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new rn(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Lt(this.nanoseconds,e.nanoseconds):Lt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new pt(e)}static min(){return new pt(new rn(0,0))}static max(){return new pt(new rn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i0{constructor(e,r,n){r===void 0?r=0:r>e.length&&dt(),n===void 0?n=e.length-r:n>e.length-r&&dt(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return i0.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof i0?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const s=e.get(i),a=r.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class Pr extends i0{construct(e,r,n){return new Pr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new tt(De.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Pr(r)}static emptyPath(){return new Pr([])}}const Pj=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Fn extends i0{construct(e,r,n){return new Fn(e,r,n)}static isValidIdentifier(e){return Pj.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Fn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Fn(["__name__"])}static fromServerFormat(e){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new tt(De.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new tt(De.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new tt(De.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new tt(De.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Fn(r)}static emptyPath(){return new Fn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nt{constructor(e){this.path=e}static fromPath(e){return new nt(Pr.fromString(e))}static fromName(e){return new nt(Pr.fromString(e).popFirst(5))}static empty(){return new nt(Pr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Pr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Pr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new nt(new Pr(e.slice()))}}function Oj(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=pt.fromTimestamp(n===1e9?new rn(r+1,0):new rn(r,n));return new Vo(i,nt.empty(),e)}function Mj(t){return new Vo(t.readTime,t.key,-1)}class Vo{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Vo(pt.min(),nt.empty(),-1)}static max(){return new Vo(pt.max(),nt.empty(),-1)}}function Lj(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=nt.comparator(t.documentKey,e.documentKey),r!==0?r:Lt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bj="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class jj{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F0(t){if(t.code!==De.FAILED_PRECONDITION||t.message!==Bj)throw t;Ze("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&dt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Fe((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Fe?r:Fe.resolve(r)}catch(r){return Fe.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Fe.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Fe.reject(r)}static resolve(e){return new Fe((r,n)=>{r(e)})}static reject(e){return new Fe((r,n)=>{n(e)})}static waitFor(e){return new Fe((r,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},l=>n(l))}),a=!0,s===i&&r()})}static or(e){let r=Fe.resolve(!1);for(const n of e)r=r.next(i=>i?Fe.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(e,r){return new Fe((n,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const c=l;r(e[c]).next(d=>{a[c]=d,++o,o===s&&n(a)},d=>i(d))}})}static doWhile(e,r){return new Fe((n,i)=>{const s=()=>{e()===!0?r().next(()=>{s()},i):n()};s()})}}function Vj(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function I0(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pv{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}pv.oe=-1;function Op(t){return t==null}function Yh(t){return t===0&&1/t==-1/0}function Uj(t){return typeof t=="number"&&Number.isInteger(t)&&!Yh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eE(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function vu(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function Vk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(e,r){this.comparator=e,this.root=r||An.EMPTY}insert(e,r){return new Cr(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,An.BLACK,null,null))}remove(e){return new Cr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,An.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Md(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Md(this.root,e,this.comparator,!1)}getReverseIterator(){return new Md(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Md(this.root,e,this.comparator,!0)}}class Md{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class An{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n??An.RED,this.left=i??An.EMPTY,this.right=s??An.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,s){return new An(e??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return An.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return An.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,An.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,An.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw dt();const e=this.left.check();if(e!==this.right.check())throw dt();return e+(this.isRed()?0:1)}}An.EMPTY=null,An.RED=!0,An.BLACK=!1;An.EMPTY=new class{constructor(){this.size=0}get key(){throw dt()}get value(){throw dt()}get color(){throw dt()}get left(){throw dt()}get right(){throw dt()}copy(e,r,n,i,s){return this}insert(e,r,n){return new An(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e){this.comparator=e,this.data=new Cr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new tE(this.data.getIterator())}getIteratorFrom(e){return new tE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof bn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new bn(this.comparator);return r.data=e,r}}class tE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e){this.fields=e,e.sort(Fn.comparator)}static empty(){return new Fs([])}unionWith(e){let r=new bn(Fn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Fs(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return ru(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uk extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Uk("Invalid base64 string: "+s):s}}(e);return new Nn(r)}static fromUint8Array(e){const r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new Nn(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Lt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Nn.EMPTY_BYTE_STRING=new Nn("");const zj=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Uo(t){if(Xt(!!t),typeof t=="string"){let e=0;const r=zj.exec(t);if(Xt(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Br(t.seconds),nanos:Br(t.nanos)}}function Br(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Nl(t){return typeof t=="string"?Nn.fromBase64String(t):Nn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mv(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function gv(t){const e=t.mapValue.fields.__previous_value__;return mv(e)?gv(e):e}function s0(t){const e=Uo(t.mapValue.fields.__local_write_time__.timestampValue);return new rn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wj{constructor(e,r,n,i,s,a,o,l,c){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class a0{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new a0("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof a0&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ld={mapValue:{}};function Dl(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?mv(t)?4:$j(t)?9007199254740991:Hj(t)?10:11:dt()}function na(t,e){if(t===e)return!0;const r=Dl(t);if(r!==Dl(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return s0(t).isEqual(s0(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=Uo(i.timestampValue),o=Uo(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Nl(i.bytesValue).isEqual(Nl(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Br(i.geoPointValue.latitude)===Br(s.geoPointValue.latitude)&&Br(i.geoPointValue.longitude)===Br(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Br(i.integerValue)===Br(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=Br(i.doubleValue),o=Br(s.doubleValue);return a===o?Yh(a)===Yh(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return ru(t.arrayValue.values||[],e.arrayValue.values||[],na);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(eE(a)!==eE(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!na(a[l],o[l])))return!1;return!0}(t,e);default:return dt()}}function o0(t,e){return(t.values||[]).find(r=>na(r,e))!==void 0}function nu(t,e){if(t===e)return 0;const r=Dl(t),n=Dl(e);if(r!==n)return Lt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Lt(t.booleanValue,e.booleanValue);case 2:return function(s,a){const o=Br(s.integerValue||s.doubleValue),l=Br(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return rE(t.timestampValue,e.timestampValue);case 4:return rE(s0(t),s0(e));case 5:return Lt(t.stringValue,e.stringValue);case 6:return function(s,a){const o=Nl(s),l=Nl(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const d=Lt(o[c],l[c]);if(d!==0)return d}return Lt(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const o=Lt(Br(s.latitude),Br(a.latitude));return o!==0?o:Lt(Br(s.longitude),Br(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return nE(t.arrayValue,e.arrayValue);case 10:return function(s,a){var o,l,c,d;const h=s.fields||{},p=a.fields||{},g=(o=h.value)===null||o===void 0?void 0:o.arrayValue,y=(l=p.value)===null||l===void 0?void 0:l.arrayValue,x=Lt(((c=g==null?void 0:g.values)===null||c===void 0?void 0:c.length)||0,((d=y==null?void 0:y.values)===null||d===void 0?void 0:d.length)||0);return x!==0?x:nE(g,y)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===Ld.mapValue&&a===Ld.mapValue)return 0;if(s===Ld.mapValue)return 1;if(a===Ld.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),c=a.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let h=0;h<l.length&&h<d.length;++h){const p=Lt(l[h],d[h]);if(p!==0)return p;const g=nu(o[l[h]],c[d[h]]);if(g!==0)return g}return Lt(l.length,d.length)}(t.mapValue,e.mapValue);default:throw dt()}}function rE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Lt(t,e);const r=Uo(t),n=Uo(e),i=Lt(r.seconds,n.seconds);return i!==0?i:Lt(r.nanos,n.nanos)}function nE(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const s=nu(r[i],n[i]);if(s)return s}return Lt(r.length,n.length)}function iu(t){return dx(t)}function dx(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Uo(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Nl(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return nt.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=dx(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${dx(r.fields[a])}`;return i+"}"}(t.mapValue):dt()}function hx(t){return!!t&&"integerValue"in t}function xv(t){return!!t&&"arrayValue"in t}function iE(t){return!!t&&"nullValue"in t}function sE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function th(t){return!!t&&"mapValue"in t}function Hj(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function Ef(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return vu(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Ef(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Ef(t.arrayValue.values[r]);return e}return Object.assign({},t)}function $j(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(e){this.value=e}static empty(){return new os({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!th(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ef(r)}setAll(e){let r=Fn.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=Ef(a):i.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(e){const r=this.field(e.popLast());th(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return na(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];th(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){vu(r,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new os(Ef(this.value))}}function zk(t){const e=[];return vu(t.fields,(r,n)=>{const i=new Fn([r]);if(th(n)){const s=zk(n.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new Fs(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e,r,n,i,s,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Gn(e,0,pt.min(),pt.min(),pt.min(),os.empty(),0)}static newFoundDocument(e,r,n,i){return new Gn(e,1,r,pt.min(),n,i,0)}static newNoDocument(e,r){return new Gn(e,2,r,pt.min(),pt.min(),os.empty(),0)}static newUnknownDocument(e,r){return new Gn(e,3,r,pt.min(),pt.min(),os.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(pt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=os.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=os.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=pt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Gn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Gn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh{constructor(e,r){this.position=e,this.inclusive=r}}function aE(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?n=nt.comparator(nt.fromName(a.referenceValue),r.key):n=nu(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function oE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!na(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(e,r="asc"){this.field=e,this.dir=r}}function Gj(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wk{}class en extends Wk{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new Xj(e,r,n):r==="array-contains"?new Qj(e,n):r==="in"?new Jj(e,n):r==="not-in"?new Zj(e,n):r==="array-contains-any"?new e7(e,n):new en(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new Yj(e,n):new qj(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(nu(r,this.value)):r!==null&&Dl(this.value)===Dl(r)&&this.matchesComparison(nu(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return dt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ia extends Wk{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new ia(e,r)}matches(e){return Hk(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Hk(t){return t.op==="and"}function $k(t){return Kj(t)&&Hk(t)}function Kj(t){for(const e of t.filters)if(e instanceof ia)return!1;return!0}function px(t){if(t instanceof en)return t.field.canonicalString()+t.op.toString()+iu(t.value);if($k(t))return t.filters.map(e=>px(e)).join(",");{const e=t.filters.map(r=>px(r)).join(",");return`${t.op}(${e})`}}function Gk(t,e){return t instanceof en?function(n,i){return i instanceof en&&n.op===i.op&&n.field.isEqual(i.field)&&na(n.value,i.value)}(t,e):t instanceof ia?function(n,i){return i instanceof ia&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&Gk(a,i.filters[o]),!0):!1}(t,e):void dt()}function Kk(t){return t instanceof en?function(r){return`${r.field.canonicalString()} ${r.op} ${iu(r.value)}`}(t):t instanceof ia?function(r){return r.op.toString()+" {"+r.getFilters().map(Kk).join(" ,")+"}"}(t):"Filter"}class Xj extends en{constructor(e,r,n){super(e,r,n),this.key=nt.fromName(n.referenceValue)}matches(e){const r=nt.comparator(e.key,this.key);return this.matchesComparison(r)}}class Yj extends en{constructor(e,r){super(e,"in",r),this.keys=Xk("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class qj extends en{constructor(e,r){super(e,"not-in",r),this.keys=Xk("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function Xk(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>nt.fromName(n.referenceValue))}class Qj extends en{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return xv(r)&&o0(r.arrayValue,this.value)}}class Jj extends en{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&o0(this.value.arrayValue,r)}}class Zj extends en{constructor(e,r){super(e,"not-in",r)}matches(e){if(o0(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!o0(this.value.arrayValue,r)}}class e7 extends en{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!xv(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>o0(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t7{constructor(e,r=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ue=null}}function lE(t,e=null,r=[],n=[],i=null,s=null,a=null){return new t7(t,e,r,n,i,s,a)}function vv(t){const e=mt(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>px(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),Op(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>iu(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>iu(n)).join(",")),e.ue=r}return e.ue}function yv(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!Gj(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!Gk(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!oE(t.startAt,e.startAt)&&oE(t.endAt,e.endAt)}function mx(t){return nt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(e,r=null,n=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function r7(t,e,r,n,i,s,a,o){return new Mp(t,e,r,n,i,s,a,o)}function Lp(t){return new Mp(t)}function cE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function n7(t){return t.collectionGroup!==null}function wf(t){const e=mt(t);if(e.ce===null){e.ce=[];const r=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new bn(Fn.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Qh(s,n))}),r.has(Fn.keyField().canonicalString())||e.ce.push(new Qh(Fn.keyField(),n))}return e.ce}function Zs(t){const e=mt(t);return e.le||(e.le=i7(e,wf(t))),e.le}function i7(t,e){if(t.limitType==="F")return lE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Qh(i.field,s)});const r=t.endAt?new qh(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new qh(t.startAt.position,t.startAt.inclusive):null;return lE(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function gx(t,e,r){return new Mp(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Bp(t,e){return yv(Zs(t),Zs(e))&&t.limitType===e.limitType}function Yk(t){return`${vv(Zs(t))}|lt:${t.limitType}`}function dc(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>Kk(i)).join(", ")}]`),Op(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>iu(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>iu(i)).join(",")),`Target(${n})`}(Zs(t))}; limitType=${t.limitType})`}function jp(t,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):nt.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,i){for(const s of wf(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,o,l){const c=aE(a,o,l);return a.inclusive?c<=0:c<0}(n.startAt,wf(n),i)||n.endAt&&!function(a,o,l){const c=aE(a,o,l);return a.inclusive?c>=0:c>0}(n.endAt,wf(n),i))}(t,e)}function s7(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function qk(t){return(e,r)=>{let n=!1;for(const i of wf(t)){const s=a7(i,e,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function a7(t,e,r){const n=t.field.isKeyField()?nt.comparator(e.key,r.key):function(s,a,o){const l=a.data.field(s),c=o.data.field(s);return l!==null&&c!==null?nu(l,c):dt()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return dt()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yu{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){vu(this.inner,(r,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return Vk(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o7=new Cr(nt.comparator);function La(){return o7}const Qk=new Cr(nt.comparator);function ef(...t){let e=Qk;for(const r of t)e=e.insert(r.key,r);return e}function Jk(t){let e=Qk;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function ul(){return Tf()}function Zk(){return Tf()}function Tf(){return new yu(t=>t.toString(),(t,e)=>t.isEqual(e))}const l7=new Cr(nt.comparator),c7=new bn(nt.comparator);function At(...t){let e=c7;for(const r of t)e=e.add(r);return e}const u7=new bn(Lt);function f7(){return u7}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _v(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Yh(e)?"-0":e}}function eC(t){return{integerValue:""+t}}function d7(t,e){return Uj(e)?eC(e):_v(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vp{constructor(){this._=void 0}}function h7(t,e,r){return t instanceof Jh?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&mv(s)&&(s=gv(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(r,e):t instanceof l0?rC(t,e):t instanceof c0?nC(t,e):function(i,s){const a=tC(i,s),o=uE(a)+uE(i.Pe);return hx(a)&&hx(i.Pe)?eC(o):_v(i.serializer,o)}(t,e)}function p7(t,e,r){return t instanceof l0?rC(t,e):t instanceof c0?nC(t,e):r}function tC(t,e){return t instanceof Zh?function(n){return hx(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class Jh extends Vp{}class l0 extends Vp{constructor(e){super(),this.elements=e}}function rC(t,e){const r=iC(e);for(const n of t.elements)r.some(i=>na(i,n))||r.push(n);return{arrayValue:{values:r}}}class c0 extends Vp{constructor(e){super(),this.elements=e}}function nC(t,e){let r=iC(e);for(const n of t.elements)r=r.filter(i=>!na(i,n));return{arrayValue:{values:r}}}class Zh extends Vp{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function uE(t){return Br(t.integerValue||t.doubleValue)}function iC(t){return xv(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function m7(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof l0&&i instanceof l0||n instanceof c0&&i instanceof c0?ru(n.elements,i.elements,na):n instanceof Zh&&i instanceof Zh?na(n.Pe,i.Pe):n instanceof Jh&&i instanceof Jh}(t.transform,e.transform)}class g7{constructor(e,r){this.version=e,this.transformResults=r}}class Ia{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Ia}static exists(e){return new Ia(void 0,e)}static updateTime(e){return new Ia(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function rh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Up{}function sC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new oC(t.key,Ia.none()):new b0(t.key,t.data,Ia.none());{const r=t.data,n=os.empty();let i=new bn(Fn.comparator);for(let s of e.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new Wl(t.key,n,new Fs(i.toArray()),Ia.none())}}function x7(t,e,r){t instanceof b0?function(i,s,a){const o=i.value.clone(),l=dE(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof Wl?function(i,s,a){if(!rh(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=dE(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(aC(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function Sf(t,e,r,n){return t instanceof b0?function(s,a,o,l){if(!rh(s.precondition,a))return o;const c=s.value.clone(),d=hE(s.fieldTransforms,l,a);return c.setAll(d),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof Wl?function(s,a,o,l){if(!rh(s.precondition,a))return o;const c=hE(s.fieldTransforms,l,a),d=a.data;return d.setAll(aC(s)),d.setAll(c),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(s,a,o){return rh(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function v7(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),s=tC(n.transform,i||null);s!=null&&(r===null&&(r=os.empty()),r.set(n.field,s))}return r||null}function fE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&ru(n,i,(s,a)=>m7(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class b0 extends Up{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Wl extends Up{constructor(e,r,n,i,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function aC(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function dE(t,e,r){const n=new Map;Xt(t.length===r.length);for(let i=0;i<r.length;i++){const s=t[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,p7(a,o,r[i]))}return n}function hE(t,e,r){const n=new Map;for(const i of t){const s=i.transform,a=r.data.field(i.field);n.set(i.field,h7(s,a,e))}return n}class oC extends Up{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class y7 extends Up{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _7{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&x7(s,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Sf(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Sf(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=Zk();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;const l=sC(a,o);l!==null&&n.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(pt.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),At())}isEqual(e){return this.batchId===e.batchId&&ru(this.mutations,e.mutations,(r,n)=>fE(r,n))&&ru(this.baseMutations,e.baseMutations,(r,n)=>fE(r,n))}}class Ev{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){Xt(e.mutations.length===n.length);let i=function(){return l7}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new Ev(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E7{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w7{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $r,It;function T7(t){switch(t){default:return dt();case De.CANCELLED:case De.UNKNOWN:case De.DEADLINE_EXCEEDED:case De.RESOURCE_EXHAUSTED:case De.INTERNAL:case De.UNAVAILABLE:case De.UNAUTHENTICATED:return!1;case De.INVALID_ARGUMENT:case De.NOT_FOUND:case De.ALREADY_EXISTS:case De.PERMISSION_DENIED:case De.FAILED_PRECONDITION:case De.ABORTED:case De.OUT_OF_RANGE:case De.UNIMPLEMENTED:case De.DATA_LOSS:return!0}}function lC(t){if(t===void 0)return Ma("GRPC error has no .code"),De.UNKNOWN;switch(t){case $r.OK:return De.OK;case $r.CANCELLED:return De.CANCELLED;case $r.UNKNOWN:return De.UNKNOWN;case $r.DEADLINE_EXCEEDED:return De.DEADLINE_EXCEEDED;case $r.RESOURCE_EXHAUSTED:return De.RESOURCE_EXHAUSTED;case $r.INTERNAL:return De.INTERNAL;case $r.UNAVAILABLE:return De.UNAVAILABLE;case $r.UNAUTHENTICATED:return De.UNAUTHENTICATED;case $r.INVALID_ARGUMENT:return De.INVALID_ARGUMENT;case $r.NOT_FOUND:return De.NOT_FOUND;case $r.ALREADY_EXISTS:return De.ALREADY_EXISTS;case $r.PERMISSION_DENIED:return De.PERMISSION_DENIED;case $r.FAILED_PRECONDITION:return De.FAILED_PRECONDITION;case $r.ABORTED:return De.ABORTED;case $r.OUT_OF_RANGE:return De.OUT_OF_RANGE;case $r.UNIMPLEMENTED:return De.UNIMPLEMENTED;case $r.DATA_LOSS:return De.DATA_LOSS;default:return dt()}}(It=$r||($r={}))[It.OK=0]="OK",It[It.CANCELLED=1]="CANCELLED",It[It.UNKNOWN=2]="UNKNOWN",It[It.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",It[It.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",It[It.NOT_FOUND=5]="NOT_FOUND",It[It.ALREADY_EXISTS=6]="ALREADY_EXISTS",It[It.PERMISSION_DENIED=7]="PERMISSION_DENIED",It[It.UNAUTHENTICATED=16]="UNAUTHENTICATED",It[It.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",It[It.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",It[It.ABORTED=10]="ABORTED",It[It.OUT_OF_RANGE=11]="OUT_OF_RANGE",It[It.UNIMPLEMENTED=12]="UNIMPLEMENTED",It[It.INTERNAL=13]="INTERNAL",It[It.UNAVAILABLE=14]="UNAVAILABLE",It[It.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S7(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A7=new xl([4294967295,4294967295],0);function pE(t){const e=S7().encode(t),r=new Nk;return r.update(e),new Uint8Array(r.digest())}function mE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new xl([r,n],0),new xl([i,s],0)]}class wv{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new tf(`Invalid padding: ${r}`);if(n<0)throw new tf(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new tf(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new tf(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=xl.fromNumber(this.Ie)}Ee(e,r,n){let i=e.add(r.multiply(xl.fromNumber(n)));return i.compare(A7)===1&&(i=new xl([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=pE(e),[n,i]=mE(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);if(!this.de(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new wv(s,i,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const r=pE(e),[n,i]=mE(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);this.Ae(a)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class tf extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zp{constructor(e,r,n,i,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,R0.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new zp(pt.min(),i,new Cr(Lt),La(),At())}}class R0{constructor(e,r,n,i,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new R0(n,r,At(),At(),At())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nh{constructor(e,r,n,i){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=i}}class cC{constructor(e,r){this.targetId=e,this.me=r}}class uC{constructor(e,r,n=Nn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class gE{constructor(){this.fe=0,this.ge=vE(),this.pe=Nn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=At(),r=At(),n=At();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:dt()}}),new R0(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=vE()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Xt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class k7{constructor(e){this.Le=e,this.Be=new Map,this.ke=La(),this.qe=xE(),this.Qe=new Cr(Lt)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:dt()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,i)=>{this.ze(i)&&r(i)})}He(e){const r=e.targetId,n=e.me.count,i=this.Je(r);if(i){const s=i.target;if(mx(s))if(n===0){const a=new nt(s.path);this.Ue(r,a,Gn.newNoDocument(a,pt.min()))}else Xt(n===1);else{const a=this.Ye(r);if(a!==n){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,c)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let a,o;try{a=Nl(n).toUint8Array()}catch(l){if(l instanceof Uk)return tu("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new wv(a,i,s)}catch(l){return tu(l instanceof tf?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,s,null),i++)}),i}rt(e){const r=new Map;this.Be.forEach((s,a)=>{const o=this.Je(a);if(o){if(s.current&&mx(o.target)){const l=new nt(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,Gn.newNoDocument(l,e))}s.be&&(r.set(a,s.ve()),s.Ce())}});let n=At();this.qe.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));const i=new zp(e,r,this.Qe,this.ke,n);return this.ke=La(),this.qe=xE(),this.Qe=new Cr(Lt),i}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,r)?i.Fe(r,1):i.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new gE,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new bn(Lt),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||Ze("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new gE),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function xE(){return new Cr(nt.comparator)}function vE(){return new Cr(nt.comparator)}const C7={asc:"ASCENDING",desc:"DESCENDING"},F7={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},I7={and:"AND",or:"OR"};class b7{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function xx(t,e){return t.useProto3Json||Op(e)?e:{value:e}}function ep(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function fC(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function R7(t,e){return ep(t,e.toTimestamp())}function ea(t){return Xt(!!t),pt.fromTimestamp(function(r){const n=Uo(r);return new rn(n.seconds,n.nanos)}(t))}function Tv(t,e){return vx(t,e).canonicalString()}function vx(t,e){const r=function(i){return new Pr(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function dC(t){const e=Pr.fromString(t);return Xt(xC(e)),e}function yx(t,e){return Tv(t.databaseId,e.path)}function Xm(t,e){const r=dC(e);if(r.get(1)!==t.databaseId.projectId)throw new tt(De.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new tt(De.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new nt(pC(r))}function hC(t,e){return Tv(t.databaseId,e)}function N7(t){const e=dC(t);return e.length===4?Pr.emptyPath():pC(e)}function _x(t){return new Pr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function pC(t){return Xt(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function yE(t,e,r){return{name:yx(t,e),fields:r.value.mapValue.fields}}function D7(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:dt()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,d){return c.useProto3Json?(Xt(d===void 0||typeof d=="string"),Nn.fromBase64String(d||"")):(Xt(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Nn.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(c){const d=c.code===void 0?De.UNKNOWN:lC(c.code);return new tt(d,c.message||"")}(a);r=new uC(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Xm(t,n.document.name),s=ea(n.document.updateTime),a=n.document.createTime?ea(n.document.createTime):pt.min(),o=new os({mapValue:{fields:n.document.fields}}),l=Gn.newFoundDocument(i,s,a,o),c=n.targetIds||[],d=n.removedTargetIds||[];r=new nh(c,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Xm(t,n.document),s=n.readTime?ea(n.readTime):pt.min(),a=Gn.newNoDocument(i,s),o=n.removedTargetIds||[];r=new nh([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Xm(t,n.document),s=n.removedTargetIds||[];r=new nh([],s,i,null)}else{if(!("filter"in e))return dt();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new w7(i,s),o=n.targetId;r=new cC(o,a)}}return r}function P7(t,e){let r;if(e instanceof b0)r={update:yE(t,e.key,e.value)};else if(e instanceof oC)r={delete:yx(t,e.key)};else if(e instanceof Wl)r={update:yE(t,e.key,e.data),updateMask:W7(e.fieldMask)};else{if(!(e instanceof y7))return dt();r={verify:yx(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof Jh)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof l0)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof c0)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Zh)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw dt()}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:R7(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:dt()}(t,e.precondition)),r}function O7(t,e){return t&&t.length>0?(Xt(e!==void 0),t.map(r=>function(i,s){let a=i.updateTime?ea(i.updateTime):ea(s);return a.isEqual(pt.min())&&(a=ea(s)),new g7(a,i.transformResults||[])}(r,e))):[]}function M7(t,e){return{documents:[hC(t,e.path)]}}function L7(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=hC(t,i);const s=function(c){if(c.length!==0)return gC(ia.create(c,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const a=function(c){if(c.length!==0)return c.map(d=>function(p){return{field:hc(p.field),direction:V7(p.dir)}}(d))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=xx(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:r,parent:i}}function B7(t){let e=N7(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Xt(n===1);const d=r.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];r.where&&(s=function(h){const p=mC(h);return p instanceof ia&&$k(p)?p.getFilters():[p]}(r.where));let a=[];r.orderBy&&(a=function(h){return h.map(p=>function(y){return new Qh(pc(y.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(p))}(r.orderBy));let o=null;r.limit&&(o=function(h){let p;return p=typeof h=="object"?h.value:h,Op(p)?null:p}(r.limit));let l=null;r.startAt&&(l=function(h){const p=!!h.before,g=h.values||[];return new qh(g,p)}(r.startAt));let c=null;return r.endAt&&(c=function(h){const p=!h.before,g=h.values||[];return new qh(g,p)}(r.endAt)),r7(e,i,a,s,o,"F",l,c)}function j7(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return dt()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function mC(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=pc(r.unaryFilter.field);return en.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=pc(r.unaryFilter.field);return en.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=pc(r.unaryFilter.field);return en.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=pc(r.unaryFilter.field);return en.create(a,"!=",{nullValue:"NULL_VALUE"});default:return dt()}}(t):t.fieldFilter!==void 0?function(r){return en.create(pc(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return dt()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return ia.create(r.compositeFilter.filters.map(n=>mC(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return dt()}}(r.compositeFilter.op))}(t):dt()}function V7(t){return C7[t]}function U7(t){return F7[t]}function z7(t){return I7[t]}function hc(t){return{fieldPath:t.canonicalString()}}function pc(t){return Fn.fromServerFormat(t.fieldPath)}function gC(t){return t instanceof en?function(r){if(r.op==="=="){if(sE(r.value))return{unaryFilter:{field:hc(r.field),op:"IS_NAN"}};if(iE(r.value))return{unaryFilter:{field:hc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(sE(r.value))return{unaryFilter:{field:hc(r.field),op:"IS_NOT_NAN"}};if(iE(r.value))return{unaryFilter:{field:hc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:hc(r.field),op:U7(r.op),value:r.value}}}(t):t instanceof ia?function(r){const n=r.getFilters().map(i=>gC(i));return n.length===1?n[0]:{compositeFilter:{op:z7(r.op),filters:n}}}(t):dt()}function W7(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function xC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(e,r,n,i,s=pt.min(),a=pt.min(),o=Nn.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new _o(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new _o(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new _o(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new _o(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H7{constructor(e){this.ct=e}}function $7(t){const e=B7({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?gx(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G7{constructor(){this.un=new K7}addToCollectionParentIndex(e,r){return this.un.add(r),Fe.resolve()}getCollectionParents(e,r){return Fe.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return Fe.resolve()}deleteFieldIndex(e,r){return Fe.resolve()}deleteAllFieldIndexes(e){return Fe.resolve()}createTargetIndexes(e,r){return Fe.resolve()}getDocumentsMatchingTarget(e,r){return Fe.resolve(null)}getIndexType(e,r){return Fe.resolve(0)}getFieldIndexes(e,r){return Fe.resolve([])}getNextCollectionGroupToUpdate(e){return Fe.resolve(null)}getMinOffset(e,r){return Fe.resolve(Vo.min())}getMinOffsetFromCollectionGroup(e,r){return Fe.resolve(Vo.min())}updateCollectionGroup(e,r,n){return Fe.resolve()}updateIndexEntries(e,r){return Fe.resolve()}}class K7{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new bn(Pr.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new bn(Pr.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new su(0)}static kn(){return new su(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X7{constructor(){this.changes=new yu(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Gn.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Fe.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y7{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q7{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Sf(n.mutation,i,Fs.empty(),rn.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,At()).next(()=>n))}getLocalViewOfDocuments(e,r,n=At()){const i=ul();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(s=>{let a=ef();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=ul();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,At()))}populateOverlays(e,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,i){let s=La();const a=Tf(),o=function(){return Tf()}();return r.forEach((l,c)=>{const d=n.get(c.key);i.has(c.key)&&(d===void 0||d.mutation instanceof Wl)?s=s.insert(c.key,c):d!==void 0?(a.set(c.key,d.mutation.getFieldMask()),Sf(d.mutation,c,d.mutation.getFieldMask(),rn.now())):a.set(c.key,Fs.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,d)=>a.set(c,d)),r.forEach((c,d)=>{var h;return o.set(c,new Y7(d,(h=a.get(c))!==null&&h!==void 0?h:null))}),o))}recalculateAndSaveOverlays(e,r){const n=Tf();let i=new Cr((a,o)=>a-o),s=At();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let d=n.get(l)||Fs.empty();d=o.applyToLocalView(c,d),n.set(l,d);const h=(i.get(o.batchId)||At()).add(l);i=i.insert(o.batchId,h)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,d=l.value,h=Zk();d.forEach(p=>{if(!s.has(p)){const g=sC(r.get(p),n.get(p));g!==null&&h.set(p,g),s=s.add(p)}}),a.push(this.documentOverlayCache.saveOverlays(e,c,h))}return Fe.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return nt.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):n7(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-s.size):Fe.resolve(ul());let o=-1,l=s;return a.next(c=>Fe.forEach(c,(d,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),s.get(d)?Fe.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{l=l.insert(d,p)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,At())).next(d=>({batchId:o,changes:Jk(d)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new nt(r)).next(n=>{let i=ef();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const s=r.collectionGroup;let a=ef();return this.indexManager.getCollectionParents(e,s).next(o=>Fe.forEach(o,l=>{const c=function(h,p){return new Mp(p,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,n,i).next(d=>{d.forEach((h,p)=>{a=a.insert(h,p)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,i))).next(a=>{s.forEach((l,c)=>{const d=c.getKey();a.get(d)===null&&(a=a.insert(d,Gn.newInvalidDocument(d)))});let o=ef();return a.forEach((l,c)=>{const d=s.get(l);d!==void 0&&Sf(d.mutation,c,Fs.empty(),rn.now()),jp(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q7{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return Fe.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:ea(i.createTime)}}(r)),Fe.resolve()}getNamedQuery(e,r){return Fe.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(i){return{name:i.name,query:$7(i.bundledQuery),readTime:ea(i.readTime)}}(r)),Fe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J7{constructor(){this.overlays=new Cr(nt.comparator),this.Ir=new Map}getOverlay(e,r){return Fe.resolve(this.overlays.get(r))}getOverlays(e,r){const n=ul();return Fe.forEach(r,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,s)=>{this.ht(e,r,s)}),Fe.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.Ir.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),Fe.resolve()}getOverlaysForCollection(e,r,n){const i=ul(),s=r.length+1,a=new nt(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>n&&i.set(l.getKey(),l)}return Fe.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let s=new Cr((c,d)=>c-d);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let d=s.get(c.largestBatchId);d===null&&(d=ul(),s=s.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const o=ul(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>o.set(c,d)),!(o.size()>=i)););return Fe.resolve(o)}ht(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new E7(r,n));let s=this.Ir.get(r);s===void 0&&(s=At(),this.Ir.set(r,s)),this.Ir.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z7{constructor(){this.sessionToken=Nn.EMPTY_BYTE_STRING}getSessionToken(e){return Fe.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Fe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sv{constructor(){this.Tr=new bn(cn.Er),this.dr=new bn(cn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new cn(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new cn(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new nt(new Pr([])),n=new cn(r,e),i=new cn(r,e+1),s=[];return this.dr.forEachInRange([n,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new nt(new Pr([])),n=new cn(r,e),i=new cn(r,e+1);let s=At();return this.dr.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const r=new cn(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class cn{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return nt.comparator(e.key,r.key)||Lt(e.wr,r.wr)}static Ar(e,r){return Lt(e.wr,r.wr)||nt.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eV{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new bn(cn.Er)}checkEmpty(e){return Fe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new _7(s,r,n,i);this.mutationQueue.push(a);for(const o of i)this.br=this.br.add(new cn(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Fe.resolve(a)}lookupMutationBatch(e,r){return Fe.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.vr(n),s=i<0?0:i;return Fe.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Fe.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Fe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new cn(r,0),i=new cn(r,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,i],a=>{const o=this.Dr(a.wr);s.push(o)}),Fe.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new bn(Lt);return r.forEach(i=>{const s=new cn(i,0),a=new cn(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],o=>{n=n.add(o.wr)})}),Fe.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let s=n;nt.isDocumentKey(s)||(s=s.child(""));const a=new cn(new nt(s),0);let o=new bn(Lt);return this.br.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===i&&(o=o.add(l.wr)),!0)},a),Fe.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const i=this.Dr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){Xt(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return Fe.forEach(r.mutations,i=>{const s=new cn(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new cn(r,0),i=this.br.firstAfterOrEqual(n);return Fe.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Fe.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tV{constructor(e){this.Mr=e,this.docs=function(){return new Cr(nt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Fe.resolve(n?n.document.mutableCopy():Gn.newInvalidDocument(r))}getEntries(e,r){let n=La();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():Gn.newInvalidDocument(i))}),Fe.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let s=La();const a=r.path,o=new nt(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:d}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||Lj(Mj(d),n)<=0||(i.has(d.key)||jp(r,d))&&(s=s.insert(d.key,d.mutableCopy()))}return Fe.resolve(s)}getAllFromCollectionGroup(e,r,n,i){dt()}Or(e,r){return Fe.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new rV(this)}getSize(e){return Fe.resolve(this.size)}}class rV extends X7{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)}),Fe.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nV{constructor(e){this.persistence=e,this.Nr=new yu(r=>vv(r),yv),this.lastRemoteSnapshotVersion=pt.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Sv,this.targetCount=0,this.kr=su.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,i)=>r(i)),Fe.resolve()}getLastRemoteSnapshotVersion(e){return Fe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Fe.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Fe.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),Fe.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new su(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,Fe.resolve()}updateTargetData(e,r){return this.Kn(r),Fe.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,Fe.resolve()}removeTargets(e,r,n){let i=0;const s=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),Fe.waitFor(s).next(()=>i)}getTargetCount(e){return Fe.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return Fe.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),Fe.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),Fe.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),Fe.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return Fe.resolve(n)}containsKey(e,r){return Fe.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iV{constructor(e,r){this.qr={},this.overlays={},this.Qr=new pv(0),this.Kr=!1,this.Kr=!0,this.$r=new Z7,this.referenceDelegate=e(this),this.Ur=new nV(this),this.indexManager=new G7,this.remoteDocumentCache=function(i){return new tV(i)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new H7(r),this.Gr=new Q7(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new J7,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new eV(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){Ze("MemoryPersistence","Starting transaction:",e);const i=new sV(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,r){return Fe.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class sV extends jj{constructor(e){super(),this.currentSequenceNumber=e}}class Av{constructor(e){this.persistence=e,this.Jr=new Sv,this.Yr=null}static Zr(e){return new Av(e)}get Xr(){if(this.Yr)return this.Yr;throw dt()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),Fe.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),Fe.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),Fe.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(i=>this.Xr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Fe.forEach(this.Xr,n=>{const i=nt.fromPath(n);return this.ei(e,i).next(s=>{s||r.removeEntry(i,pt.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return Fe.or([()=>Fe.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kv{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=i}static Wi(e,r){let n=At(),i=At();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new kv(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aV{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oV{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return o9()?8:Vj(Qn())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,i){const s={result:null};return this.Yi(e,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new aV;return this.Xi(e,r,a).next(o=>{if(s.result=o,this.zi)return this.es(e,r,a,o.size)})}).next(()=>s.result)}es(e,r,n,i){return n.documentReadCount<this.ji?($u()<=Ct.DEBUG&&Ze("QueryEngine","SDK will not create cache indexes for query:",dc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Fe.resolve()):($u()<=Ct.DEBUG&&Ze("QueryEngine","Query:",dc(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?($u()<=Ct.DEBUG&&Ze("QueryEngine","The SDK decides to create cache indexes for query:",dc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Zs(r))):Fe.resolve())}Yi(e,r){if(cE(r))return Fe.resolve(null);let n=Zs(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=gx(r,null,"F"),n=Zs(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=At(...s);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.ts(r,o);return this.ns(r,c,a,l.readTime)?this.Yi(e,gx(r,null,"F")):this.rs(e,c,r,l)}))})))}Zi(e,r,n,i){return cE(r)||i.isEqual(pt.min())?Fe.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const a=this.ts(r,s);return this.ns(r,a,n,i)?Fe.resolve(null):($u()<=Ct.DEBUG&&Ze("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),dc(r)),this.rs(e,a,r,Oj(i,-1)).next(o=>o))})}ts(e,r){let n=new bn(qk(e));return r.forEach((i,s)=>{jp(e,s)&&(n=n.add(s))}),n}ns(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,r,n){return $u()<=Ct.DEBUG&&Ze("QueryEngine","Using full collection scan to execute query:",dc(r)),this.Ji.getDocumentsMatchingQuery(e,r,Vo.min(),n)}rs(e,r,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lV{constructor(e,r,n,i){this.persistence=e,this.ss=r,this.serializer=i,this.os=new Cr(Lt),this._s=new yu(s=>vv(s),yv),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new q7(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function cV(t,e,r,n){return new lV(t,e,r,n)}async function vC(t,e){const r=mt(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let l=At();for(const c of i){a.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}for(const c of s){o.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}return r.localDocuments.getDocuments(n,l).next(c=>({hs:c,removedBatchIds:a,addedBatchIds:o}))})})}function uV(t,e){const r=mt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,c,d){const h=c.batch,p=h.keys();let g=Fe.resolve();return p.forEach(y=>{g=g.next(()=>d.getEntry(l,y)).next(x=>{const E=c.docVersions.get(y);Xt(E!==null),x.version.compareTo(E)<0&&(h.applyToRemoteDocument(x,c),x.isValidDocument()&&(x.setReadTime(c.commitVersion),d.addEntry(x)))})}),g.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=At();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function yC(t){const e=mt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function fV(t,e){const r=mt(t),n=e.snapshotVersion;let i=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.cs.newChangeBuffer({trackRemovals:!0});i=r.os;const o=[];e.targetChanges.forEach((d,h)=>{const p=i.get(h);if(!p)return;o.push(r.Ur.removeMatchingKeys(s,d.removedDocuments,h).next(()=>r.Ur.addMatchingKeys(s,d.addedDocuments,h)));let g=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?g=g.withResumeToken(Nn.EMPTY_BYTE_STRING,pt.min()).withLastLimboFreeSnapshotVersion(pt.min()):d.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(d.resumeToken,n)),i=i.insert(h,g),function(x,E,T){return x.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(p,g,d)&&o.push(r.Ur.updateTargetData(s,g))});let l=La(),c=At();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,d))}),o.push(dV(s,a,e.documentUpdates).next(d=>{l=d.Ps,c=d.Is})),!n.isEqual(pt.min())){const d=r.Ur.getLastRemoteSnapshotVersion(s).next(h=>r.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(d)}return Fe.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(r.os=i,s))}function dV(t,e,r){let n=At(),i=At();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let a=La();return r.forEach((o,l)=>{const c=s.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(pt.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):Ze("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{Ps:a,Is:i}})}function hV(t,e){const r=mt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function pV(t,e){const r=mt(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Ur.getTargetData(n,e).next(s=>s?(i=s,Fe.resolve(i)):r.Ur.allocateTargetId(n).next(a=>(i=new _o(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.os.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function Ex(t,e,r){const n=mt(t),i=n.os.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!I0(a))throw a;Ze("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(i.target)}function _E(t,e,r){const n=mt(t);let i=pt.min(),s=At();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,c,d){const h=mt(l),p=h._s.get(d);return p!==void 0?Fe.resolve(h.os.get(p)):h.Ur.getTargetData(c,d)}(n,a,Zs(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,r?i:pt.min(),r?s:At())).next(o=>(mV(n,s7(e),o),{documents:o,Ts:s})))}function mV(t,e,r){let n=t.us.get(e)||pt.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.us.set(e,n)}class EE{constructor(){this.activeTargetIds=f7()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class gV{constructor(){this.so=new EE,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new EE,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xV{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wE{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Ze("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Ze("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bd=null;function Ym(){return Bd===null?Bd=function(){return 268435456+Math.round(2147483648*Math.random())}():Bd++,"0x"+Bd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vV={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yV{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vn="WebChannelConnection";class _V extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(r,n,i,s,a){const o=Ym(),l=this.xo(r,n.toUriEncodedString());Ze("RestConnection",`Sending RPC '${r}' ${o}:`,l,i);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,s,a),this.No(r,l,c,i).then(d=>(Ze("RestConnection",`Received RPC '${r}' ${o}: `,d),d),d=>{throw tu("RestConnection",`RPC '${r}' ${o} failed with error: `,d,"url: ",l,"request:",i),d})}Lo(r,n,i,s,a,o){return this.Mo(r,n,i,s,a)}Oo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+xu}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>r[a]=s),i&&i.headers.forEach((s,a)=>r[a]=s)}xo(r,n){const i=vV[r];return`${this.Do}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,i){const s=Ym();return new Promise((a,o)=>{const l=new Dk;l.setWithCredentials(!0),l.listenOnce(Pk.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case eh.NO_ERROR:const d=l.getResponseJson();Ze(Vn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),a(d);break;case eh.TIMEOUT:Ze(Vn,`RPC '${e}' ${s} timed out`),o(new tt(De.DEADLINE_EXCEEDED,"Request time out"));break;case eh.HTTP_ERROR:const h=l.getStatus();if(Ze(Vn,`RPC '${e}' ${s} failed with status:`,h,"response text:",l.getResponseText()),h>0){let p=l.getResponseJson();Array.isArray(p)&&(p=p[0]);const g=p==null?void 0:p.error;if(g&&g.status&&g.message){const y=function(E){const T=E.toLowerCase().replace(/_/g,"-");return Object.values(De).indexOf(T)>=0?T:De.UNKNOWN}(g.status);o(new tt(y,g.message))}else o(new tt(De.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new tt(De.UNAVAILABLE,"Connection failed."));break;default:dt()}}finally{Ze(Vn,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);Ze(Vn,`RPC '${e}' ${s} sending request:`,i),l.send(r,"POST",c,n,15)})}Bo(e,r,n){const i=Ym(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Lk(),o=Mk(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const d=s.join("");Ze(Vn,`Creating RPC '${e}' stream ${i}: ${d}`,l);const h=a.createWebChannel(d,l);let p=!1,g=!1;const y=new yV({Io:E=>{g?Ze(Vn,`Not sending because RPC '${e}' stream ${i} is closed:`,E):(p||(Ze(Vn,`Opening RPC '${e}' stream ${i} transport.`),h.open(),p=!0),Ze(Vn,`RPC '${e}' stream ${i} sending:`,E),h.send(E))},To:()=>h.close()}),x=(E,T,A)=>{E.listen(T,_=>{try{A(_)}catch(O){setTimeout(()=>{throw O},0)}})};return x(h,Zu.EventType.OPEN,()=>{g||(Ze(Vn,`RPC '${e}' stream ${i} transport opened.`),y.yo())}),x(h,Zu.EventType.CLOSE,()=>{g||(g=!0,Ze(Vn,`RPC '${e}' stream ${i} transport closed`),y.So())}),x(h,Zu.EventType.ERROR,E=>{g||(g=!0,tu(Vn,`RPC '${e}' stream ${i} transport errored:`,E),y.So(new tt(De.UNAVAILABLE,"The operation could not be completed")))}),x(h,Zu.EventType.MESSAGE,E=>{var T;if(!g){const A=E.data[0];Xt(!!A);const _=A,O=_.error||((T=_[0])===null||T===void 0?void 0:T.error);if(O){Ze(Vn,`RPC '${e}' stream ${i} received error:`,O);const H=O.status;let j=function(S){const b=$r[S];if(b!==void 0)return lC(b)}(H),w=O.message;j===void 0&&(j=De.INTERNAL,w="Unknown error status: "+H+" with message "+O.message),g=!0,y.So(new tt(j,w)),h.close()}else Ze(Vn,`RPC '${e}' stream ${i} received:`,A),y.bo(A)}}),x(o,Ok.STAT_EVENT,E=>{E.stat===fx.PROXY?Ze(Vn,`RPC '${e}' stream ${i} detected buffering proxy`):E.stat===fx.NOPROXY&&Ze(Vn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{y.wo()},0),y}}function qm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wp(t){return new b7(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{constructor(e,r,n=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,r-n);i>0&&Ze("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EC{constructor(e,r,n,i,s,a,o,l){this.ui=e,this.Ho=n,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new _C(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===De.RESOURCE_EXHAUSTED?(Ma(r.toString()),Ma("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===De.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Yo===r&&this.P_(n,i)},n=>{e(()=>{const i=new tt(De.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(i)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{n(()=>this.I_(i))}),this.stream.onMessage(i=>{n(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Ze("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(Ze("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class EV extends EC{constructor(e,r,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=D7(this.serializer,e),n=function(s){if(!("targetChange"in s))return pt.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?pt.min():a.readTime?ea(a.readTime):pt.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=_x(this.serializer),r.addTarget=function(s,a){let o;const l=a.target;if(o=mx(l)?{documents:M7(s,l)}:{query:L7(s,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=fC(s,a.resumeToken);const c=xx(s,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(pt.min())>0){o.readTime=ep(s,a.snapshotVersion.toTimestamp());const c=xx(s,a.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const n=j7(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=_x(this.serializer),r.removeTarget=e,this.a_(r)}}class wV extends EC{constructor(e,r,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return Xt(!!e.streamToken),this.lastStreamToken=e.streamToken,Xt(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Xt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=O7(e.writeResults,e.commitTime),n=ea(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=_x(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>P7(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TV extends class{}{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new tt(De.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,vx(r,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===De.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new tt(De.UNKNOWN,s.toString())})}Lo(e,r,n,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,vx(r,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===De.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new tt(De.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class SV{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ma(r),this.D_=!1):Ze("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AV{constructor(e,r,n,i,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{n.enqueueAndForget(async()=>{Hl(this)&&(Ze("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=mt(l);c.L_.add(4),await N0(c),c.q_.set("Unknown"),c.L_.delete(4),await Hp(c)}(this))})}),this.q_=new SV(n,i)}}async function Hp(t){if(Hl(t))for(const e of t.B_)await e(!0)}async function N0(t){for(const e of t.B_)await e(!1)}function wC(t,e){const r=mt(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),bv(r)?Iv(r):_u(r).r_()&&Fv(r,e))}function Cv(t,e){const r=mt(t),n=_u(r);r.N_.delete(e),n.r_()&&TC(r,e),r.N_.size===0&&(n.r_()?n.o_():Hl(r)&&r.q_.set("Unknown"))}function Fv(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(pt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}_u(t).A_(e)}function TC(t,e){t.Q_.xe(e),_u(t).R_(e)}function Iv(t){t.Q_=new k7({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),_u(t).start(),t.q_.v_()}function bv(t){return Hl(t)&&!_u(t).n_()&&t.N_.size>0}function Hl(t){return mt(t).L_.size===0}function SC(t){t.Q_=void 0}async function kV(t){t.q_.set("Online")}async function CV(t){t.N_.forEach((e,r)=>{Fv(t,e)})}async function FV(t,e){SC(t),bv(t)?(t.q_.M_(e),Iv(t)):t.q_.set("Unknown")}async function IV(t,e,r){if(t.q_.set("Online"),e instanceof uC&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.N_.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.N_.delete(o),i.Q_.removeTarget(o))}(t,e)}catch(n){Ze("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await tp(t,n)}else if(e instanceof nh?t.Q_.Ke(e):e instanceof cC?t.Q_.He(e):t.Q_.We(e),!r.isEqual(pt.min()))try{const n=await yC(t.localStore);r.compareTo(n)>=0&&await function(s,a){const o=s.Q_.rt(a);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const d=s.N_.get(c);d&&s.N_.set(c,d.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,c)=>{const d=s.N_.get(l);if(!d)return;s.N_.set(l,d.withResumeToken(Nn.EMPTY_BYTE_STRING,d.snapshotVersion)),TC(s,l);const h=new _o(d.target,l,c,d.sequenceNumber);Fv(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Ze("RemoteStore","Failed to raise snapshot:",n),await tp(t,n)}}async function tp(t,e,r){if(!I0(e))throw e;t.L_.add(1),await N0(t),t.q_.set("Offline"),r||(r=()=>yC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ze("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await Hp(t)})}function AC(t,e){return e().catch(r=>tp(t,r,e))}async function $p(t){const e=mt(t),r=zo(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;bV(e);)try{const i=await hV(e.localStore,n);if(i===null){e.O_.length===0&&r.o_();break}n=i.batchId,RV(e,i)}catch(i){await tp(e,i)}kC(e)&&CC(e)}function bV(t){return Hl(t)&&t.O_.length<10}function RV(t,e){t.O_.push(e);const r=zo(t);r.r_()&&r.V_&&r.m_(e.mutations)}function kC(t){return Hl(t)&&!zo(t).n_()&&t.O_.length>0}function CC(t){zo(t).start()}async function NV(t){zo(t).p_()}async function DV(t){const e=zo(t);for(const r of t.O_)e.m_(r.mutations)}async function PV(t,e,r){const n=t.O_.shift(),i=Ev.from(n,e,r);await AC(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await $p(t)}async function OV(t,e){e&&zo(t).V_&&await async function(n,i){if(function(a){return T7(a)&&a!==De.ABORTED}(i.code)){const s=n.O_.shift();zo(n).s_(),await AC(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await $p(n)}}(t,e),kC(t)&&CC(t)}async function TE(t,e){const r=mt(t);r.asyncQueue.verifyOperationInProgress(),Ze("RemoteStore","RemoteStore received new credentials");const n=Hl(r);r.L_.add(3),await N0(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await Hp(r)}async function MV(t,e){const r=mt(t);e?(r.L_.delete(2),await Hp(r)):e||(r.L_.add(2),await N0(r),r.q_.set("Unknown"))}function _u(t){return t.K_||(t.K_=function(r,n,i){const s=mt(r);return s.w_(),new EV(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:kV.bind(null,t),Ro:CV.bind(null,t),mo:FV.bind(null,t),d_:IV.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),bv(t)?Iv(t):t.q_.set("Unknown")):(await t.K_.stop(),SC(t))})),t.K_}function zo(t){return t.U_||(t.U_=function(r,n,i){const s=mt(r);return s.w_(),new wV(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:NV.bind(null,t),mo:OV.bind(null,t),f_:DV.bind(null,t),g_:PV.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await $p(t)):(await t.U_.stop(),t.O_.length>0&&(Ze("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv{constructor(e,r,n,i,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new No,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,s){const a=Date.now()+n,o=new Rv(e,r,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new tt(De.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Nv(t,e){if(Ma("AsyncQueue",`${e}: ${t}`),I0(t))return new tt(De.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vc{constructor(e){this.comparator=e?(r,n)=>e(r,n)||nt.comparator(r.key,n.key):(r,n)=>nt.comparator(r.key,n.key),this.keyedMap=ef(),this.sortedSet=new Cr(this.comparator)}static emptySet(e){return new Vc(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Vc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Vc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SE{constructor(){this.W_=new Cr(nt.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):dt():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class au{constructor(e,r,n,i,s,a,o,l,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,i,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new au(e,r,Vc.emptySet(r),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Bp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LV{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class BV{constructor(){this.queries=AE(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const i=mt(r),s=i.queries;i.queries=AE(),s.forEach((a,o)=>{for(const l of o.j_)l.onError(n)})})(this,new tt(De.ABORTED,"Firestore shutting down"))}}function AE(){return new yu(t=>Yk(t),Bp)}async function FC(t,e){const r=mt(t);let n=3;const i=e.query;let s=r.queries.get(i);s?!s.H_()&&e.J_()&&(n=2):(s=new LV,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(i,!0);break;case 1:s.z_=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const o=Nv(a,`Initialization of query '${dc(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,s),s.j_.push(e),e.Z_(r.onlineState),s.z_&&e.X_(s.z_)&&Dv(r)}async function IC(t,e){const r=mt(t),n=e.query;let i=3;const s=r.queries.get(n);if(s){const a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function jV(t,e){const r=mt(t);let n=!1;for(const i of e){const s=i.query,a=r.queries.get(s);if(a){for(const o of a.j_)o.X_(i)&&(n=!0);a.z_=i}}n&&Dv(r)}function VV(t,e,r){const n=mt(t),i=n.queries.get(e);if(i)for(const s of i.j_)s.onError(r);n.queries.delete(e)}function Dv(t){t.Y_.forEach(e=>{e.next()})}var wx,kE;(kE=wx||(wx={})).ea="default",kE.Cache="cache";class bC{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new au(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=au.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==wx.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RC{constructor(e){this.key=e}}class NC{constructor(e){this.key=e}}class UV{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=At(),this.mutatedKeys=At(),this.Aa=qk(e),this.Ra=new Vc(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new SE,i=r?r.Ra:this.Ra;let s=r?r.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{const p=i.get(d),g=jp(this.query,h)?h:null,y=!!p&&this.mutatedKeys.has(p.key),x=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let E=!1;p&&g?p.data.isEqual(g.data)?y!==x&&(n.track({type:3,doc:g}),E=!0):this.ga(p,g)||(n.track({type:2,doc:g}),E=!0,(l&&this.Aa(g,l)>0||c&&this.Aa(g,c)<0)&&(o=!0)):!p&&g?(n.track({type:0,doc:g}),E=!0):p&&!g&&(n.track({type:1,doc:p}),E=!0,(l||c)&&(o=!0)),E&&(g?(a=a.add(g),s=x?s.add(d):s.delete(d)):(a=a.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const d=this.query.limitType==="F"?a.last():a.first();a=a.delete(d.key),s=s.delete(d.key),n.track({type:1,doc:d})}return{Ra:a,fa:n,ns:o,mutatedKeys:s}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((d,h)=>function(g,y){const x=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return dt()}};return x(g)-x(y)}(d.type,h.type)||this.Aa(d.doc,h.doc)),this.pa(n),i=i!=null&&i;const o=r&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,c=l!==this.Ea;return this.Ea=l,a.length!==0||c?{snapshot:new au(this.query,e.Ra,s,a,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new SE,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=At(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new NC(n))}),this.da.forEach(n=>{e.has(n)||r.push(new RC(n))}),r}ba(e){this.Ta=e.Ts,this.da=At();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return au.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class zV{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class WV{constructor(e){this.key=e,this.va=!1}}class HV{constructor(e,r,n,i,s,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new yu(o=>Yk(o),Bp),this.Ma=new Map,this.xa=new Set,this.Oa=new Cr(nt.comparator),this.Na=new Map,this.La=new Sv,this.Ba={},this.ka=new Map,this.qa=su.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function $V(t,e,r=!0){const n=BC(t);let i;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await DC(n,e,r,!0),i}async function GV(t,e){const r=BC(t);await DC(r,e,!0,!1)}async function DC(t,e,r,n){const i=await pV(t.localStore,Zs(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,r);let o;return n&&(o=await KV(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&wC(t.remoteStore,i),o}async function KV(t,e,r,n,i){t.Ka=(h,p,g)=>async function(x,E,T,A){let _=E.view.ma(T);_.ns&&(_=await _E(x.localStore,E.query,!1).then(({documents:w})=>E.view.ma(w,_)));const O=A&&A.targetChanges.get(E.targetId),H=A&&A.targetMismatches.get(E.targetId)!=null,j=E.view.applyChanges(_,x.isPrimaryClient,O,H);return FE(x,E.targetId,j.wa),j.snapshot}(t,h,p,g);const s=await _E(t.localStore,e,!0),a=new UV(e,s.Ts),o=a.ma(s.documents),l=R0.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),c=a.applyChanges(o,t.isPrimaryClient,l);FE(t,r,c.wa);const d=new zV(e,r,a);return t.Fa.set(e,d),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),c.snapshot}async function XV(t,e,r){const n=mt(t),i=n.Fa.get(e),s=n.Ma.get(i.targetId);if(s.length>1)return n.Ma.set(i.targetId,s.filter(a=>!Bp(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Ex(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Cv(n.remoteStore,i.targetId),Tx(n,i.targetId)}).catch(F0)):(Tx(n,i.targetId),await Ex(n.localStore,i.targetId,!0))}async function YV(t,e){const r=mt(t),n=r.Fa.get(e),i=r.Ma.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Cv(r.remoteStore,n.targetId))}async function qV(t,e,r){const n=nU(t);try{const i=await function(a,o){const l=mt(a),c=rn.now(),d=o.reduce((g,y)=>g.add(y.key),At());let h,p;return l.persistence.runTransaction("Locally write mutations","readwrite",g=>{let y=La(),x=At();return l.cs.getEntries(g,d).next(E=>{y=E,y.forEach((T,A)=>{A.isValidDocument()||(x=x.add(T))})}).next(()=>l.localDocuments.getOverlayedDocuments(g,y)).next(E=>{h=E;const T=[];for(const A of o){const _=v7(A,h.get(A.key).overlayedDocument);_!=null&&T.push(new Wl(A.key,_,zk(_.value.mapValue),Ia.exists(!0)))}return l.mutationQueue.addMutationBatch(g,c,T,o)}).next(E=>{p=E;const T=E.applyToLocalDocumentSet(h,x);return l.documentOverlayCache.saveOverlays(g,E.batchId,T)})}).then(()=>({batchId:p.batchId,changes:Jk(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,l){let c=a.Ba[a.currentUser.toKey()];c||(c=new Cr(Lt)),c=c.insert(o,l),a.Ba[a.currentUser.toKey()]=c}(n,i.batchId,r),await D0(n,i.changes),await $p(n.remoteStore)}catch(i){const s=Nv(i,"Failed to persist write");r.reject(s)}}async function PC(t,e){const r=mt(t);try{const n=await fV(r.localStore,e);e.targetChanges.forEach((i,s)=>{const a=r.Na.get(s);a&&(Xt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?Xt(a.va):i.removedDocuments.size>0&&(Xt(a.va),a.va=!1))}),await D0(r,n,e)}catch(n){await F0(n)}}function CE(t,e,r){const n=mt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Fa.forEach((s,a)=>{const o=a.view.Z_(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const l=mt(a);l.onlineState=o;let c=!1;l.queries.forEach((d,h)=>{for(const p of h.j_)p.Z_(o)&&(c=!0)}),c&&Dv(l)}(n.eventManager,e),i.length&&n.Ca.d_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function QV(t,e,r){const n=mt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Na.get(e),s=i&&i.key;if(s){let a=new Cr(nt.comparator);a=a.insert(s,Gn.newNoDocument(s,pt.min()));const o=At().add(s),l=new zp(pt.min(),new Map,new Cr(Lt),a,o);await PC(n,l),n.Oa=n.Oa.remove(s),n.Na.delete(e),Pv(n)}else await Ex(n.localStore,e,!1).then(()=>Tx(n,e,r)).catch(F0)}async function JV(t,e){const r=mt(t),n=e.batch.batchId;try{const i=await uV(r.localStore,e);MC(r,n,null),OC(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await D0(r,i)}catch(i){await F0(i)}}async function ZV(t,e,r){const n=mt(t);try{const i=await function(a,o){const l=mt(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return l.mutationQueue.lookupMutationBatch(c,o).next(h=>(Xt(h!==null),d=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,d,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>l.localDocuments.getDocuments(c,d))})}(n.localStore,e);MC(n,e,r),OC(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await D0(n,i)}catch(i){await F0(i)}}function OC(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function MC(t,e,r){const n=mt(t);let i=n.Ba[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(r?s.reject(r):s.resolve(),i=i.remove(e)),n.Ba[n.currentUser.toKey()]=i}}function Tx(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||LC(t,n)})}function LC(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(Cv(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),Pv(t))}function FE(t,e,r){for(const n of r)n instanceof RC?(t.La.addReference(n.key,e),eU(t,n)):n instanceof NC?(Ze("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||LC(t,n.key)):dt()}function eU(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(Ze("SyncEngine","New document in limbo: "+r),t.xa.add(n),Pv(t))}function Pv(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new nt(Pr.fromString(e)),n=t.qa.next();t.Na.set(n,new WV(r)),t.Oa=t.Oa.insert(r,n),wC(t.remoteStore,new _o(Zs(Lp(r.path)),n,"TargetPurposeLimboResolution",pv.oe))}}async function D0(t,e,r){const n=mt(t),i=[],s=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{a.push(n.Ka(l,e,r).then(c=>{var d;if((c||r)&&n.isPrimaryClient){const h=c?!c.fromCache:(d=r==null?void 0:r.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;n.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){i.push(c);const h=kv.Wi(l.targetId,c);s.push(h)}}))}),await Promise.all(a),n.Ca.d_(i),await async function(l,c){const d=mt(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>Fe.forEach(c,p=>Fe.forEach(p.$i,g=>d.persistence.referenceDelegate.addReference(h,p.targetId,g)).next(()=>Fe.forEach(p.Ui,g=>d.persistence.referenceDelegate.removeReference(h,p.targetId,g)))))}catch(h){if(!I0(h))throw h;Ze("LocalStore","Failed to update sequence numbers: "+h)}for(const h of c){const p=h.targetId;if(!h.fromCache){const g=d.os.get(p),y=g.snapshotVersion,x=g.withLastLimboFreeSnapshotVersion(y);d.os=d.os.insert(p,x)}}}(n.localStore,s))}async function tU(t,e){const r=mt(t);if(!r.currentUser.isEqual(e)){Ze("SyncEngine","User change. New user:",e.toKey());const n=await vC(r.localStore,e);r.currentUser=e,function(s,a){s.ka.forEach(o=>{o.forEach(l=>{l.reject(new tt(De.CANCELLED,a))})}),s.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await D0(r,n.hs)}}function rU(t,e){const r=mt(t),n=r.Na.get(e);if(n&&n.va)return At().add(n.key);{let i=At();const s=r.Ma.get(e);if(!s)return i;for(const a of s){const o=r.Fa.get(a);i=i.unionWith(o.view.Va)}return i}}function BC(t){const e=mt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=PC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=rU.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=QV.bind(null,e),e.Ca.d_=jV.bind(null,e.eventManager),e.Ca.$a=VV.bind(null,e.eventManager),e}function nU(t){const e=mt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=JV.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ZV.bind(null,e),e}class rp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Wp(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return cV(this.persistence,new oV,e.initialUser,this.serializer)}Ga(e){return new iV(Av.Zr,this.serializer)}Wa(e){return new gV}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}rp.provider={build:()=>new rp};class Sx{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>CE(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=tU.bind(null,this.syncEngine),await MV(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new BV}()}createDatastore(e){const r=Wp(e.databaseInfo.databaseId),n=function(s){return new _V(s)}(e.databaseInfo);return function(s,a,o,l){return new TV(s,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,s,a,o){return new AV(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>CE(this.syncEngine,r,0),function(){return wE.D()?new wE:new xV}())}createSyncEngine(e,r){return function(i,s,a,o,l,c,d){const h=new HV(i,s,a,o,l,c);return d&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const s=mt(i);Ze("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await N0(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Sx.provider={build:()=>new Sx};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jC{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Ma("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iU{constructor(e,r,n,i,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=zn.UNAUTHENTICATED,this.clientId=jk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{Ze("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(Ze("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new No;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Nv(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Qm(t,e){t.asyncQueue.verifyOperationInProgress(),Ze("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await vC(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function IE(t,e){t.asyncQueue.verifyOperationInProgress();const r=await sU(t);Ze("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>TE(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>TE(e.remoteStore,i)),t._onlineComponents=e}async function sU(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ze("FirestoreClient","Using user provided OfflineComponentProvider");try{await Qm(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===De.FAILED_PRECONDITION||i.code===De.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;tu("Error using user provided cache. Falling back to memory cache: "+r),await Qm(t,new rp)}}else Ze("FirestoreClient","Using default OfflineComponentProvider"),await Qm(t,new rp);return t._offlineComponents}async function VC(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ze("FirestoreClient","Using user provided OnlineComponentProvider"),await IE(t,t._uninitializedComponentsProvider._online)):(Ze("FirestoreClient","Using default OnlineComponentProvider"),await IE(t,new Sx))),t._onlineComponents}function aU(t){return VC(t).then(e=>e.syncEngine)}async function Ax(t){const e=await VC(t),r=e.eventManager;return r.onListen=$V.bind(null,e.syncEngine),r.onUnlisten=XV.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=GV.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=YV.bind(null,e.syncEngine),r}function oU(t,e,r={}){const n=new No;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,c){const d=new jC({next:p=>{d.Za(),a.enqueueAndForget(()=>IC(s,h));const g=p.docs.has(o);!g&&p.fromCache?c.reject(new tt(De.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&p.fromCache&&l&&l.source==="server"?c.reject(new tt(De.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(p)},error:p=>c.reject(p)}),h=new bC(Lp(o.path),d,{includeMetadataChanges:!0,_a:!0});return FC(s,h)}(await Ax(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UC(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bE=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lU(t,e,r){if(!r)throw new tt(De.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function cU(t,e,r,n){if(e===!0&&n===!0)throw new tt(De.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function RE(t){if(!nt.isDocumentKey(t))throw new tt(De.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Ov(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":dt()}function Do(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new tt(De.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Ov(t);throw new tt(De.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NE{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new tt(De.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new tt(De.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}cU("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=UC((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new tt(De.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new tt(De.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new tt(De.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Mv{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new NE({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new tt(De.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new tt(De.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new NE(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new kj;switch(n.type){case"firstParty":return new bj(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new tt(De.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=bE.get(r);n&&(Ze("ComponentProvider","Removing Datastore"),bE.delete(r),n.terminate())}(this),Promise.resolve()}}function uU(t,e,r,n={}){var i;const s=(t=Do(t,Mv))._getSettings(),a=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&tu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=zn.MOCK_USER;else{o=e9(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new tt(De.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new zn(c)}t._authCredentials=new Cj(new Bk(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gp{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Gp(this.firestore,e,this._query)}}class Vi{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new u0(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Vi(this.firestore,e,this._key)}}class u0 extends Gp{constructor(e,r,n){super(e,r,Lp(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Vi(this.firestore,null,new nt(e))}withConverter(e){return new u0(this.firestore,e,this._path)}}function Lv(t,e,...r){if(t=Ps(t),arguments.length===1&&(e=jk.newId()),lU("doc","path",e),t instanceof Mv){const n=Pr.fromString(e,...r);return RE(n),new Vi(t,null,new nt(n))}{if(!(t instanceof Vi||t instanceof u0))throw new tt(De.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Pr.fromString(e,...r));return RE(n),new Vi(t.firestore,t instanceof u0?t.converter:null,new nt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DE{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new _C(this,"async_queue_retry"),this.Vu=()=>{const n=qm();n&&Ze("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=qm();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=qm();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new No;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!I0(e))throw e;Ze("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw Ma("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const i=Rv.createAndSchedule(this,e,r,n,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&dt()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function PE(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const i=r;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class f0 extends Mv{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new DE,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new DE(e),this._firestoreClient=void 0,await e}}}function fU(t,e){const r=typeof t=="object"?t:Ik(),n=typeof t=="string"?t:"(default)",i=dv(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=JB("firestore");s&&uU(i,...s)}return i}function Bv(t){if(t._terminated)throw new tt(De.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||dU(t),t._firestoreClient}function dU(t){var e,r,n;const i=t._freezeSettings(),s=function(o,l,c,d){return new Wj(o,l,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,UC(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new iU(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ou(Nn.fromBase64String(e))}catch(r){throw new tt(De.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new ou(Nn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jv{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new tt(De.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Fn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zC{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vv{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new tt(De.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new tt(De.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Lt(this._lat,e._lat)||Lt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uv{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hU=/^__.*__$/;class pU{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Wl(e,this.data,this.fieldMask,r,this.fieldTransforms):new b0(e,this.data,r,this.fieldTransforms)}}function WC(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw dt()}}class zv{constructor(e,r,n,i,s,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new zv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return np(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(WC(this.Cu)&&hU.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class mU{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Wp(e)}Qu(e,r,n,i=!1){return new zv({Cu:e,methodName:r,qu:n,path:Fn.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function gU(t){const e=t._freezeSettings(),r=Wp(t._databaseId);return new mU(t._databaseId,!!e.ignoreUndefinedProperties,r)}function xU(t,e,r,n,i,s={}){const a=t.Qu(s.merge||s.mergeFields?2:0,e,r,i);KC("Data must be an object, but it was:",a,n);const o=$C(n,a);let l,c;if(s.merge)l=new Fs(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const d=[];for(const h of s.mergeFields){const p=vU(e,h,r);if(!a.contains(p))throw new tt(De.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);_U(d,p)||d.push(p)}l=new Fs(d),c=a.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=a.fieldTransforms;return new pU(new os(o),l,c)}function HC(t,e){if(GC(t=Ps(t)))return KC("Unsupported field value:",e,t),$C(t,e);if(t instanceof zC)return function(n,i){if(!WC(i.Cu))throw i.Bu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let l=HC(o,i.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(t,e)}return function(n,i){if((n=Ps(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return d7(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=rn.fromDate(n);return{timestampValue:ep(i.serializer,s)}}if(n instanceof rn){const s=new rn(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:ep(i.serializer,s)}}if(n instanceof Vv)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof ou)return{bytesValue:fC(i.serializer,n._byteString)};if(n instanceof Vi){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Tv(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof Uv)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return _v(o.serializer,l)})}}}}}}(n,i);throw i.Bu(`Unsupported field value: ${Ov(n)}`)}(t,e)}function $C(t,e){const r={};return Vk(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):vu(t,(n,i)=>{const s=HC(i,e.Mu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function GC(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof rn||t instanceof Vv||t instanceof ou||t instanceof Vi||t instanceof zC||t instanceof Uv)}function KC(t,e,r){if(!GC(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=Ov(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function vU(t,e,r){if((e=Ps(e))instanceof jv)return e._internalPath;if(typeof e=="string")return XC(t,e);throw np("Field path arguments must be of type string or ",t,!1,void 0,r)}const yU=new RegExp("[~\\*/\\[\\]]");function XC(t,e,r){if(e.search(yU)>=0)throw np(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new jv(...e.split("."))._internalPath}catch{throw np(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function np(t,e,r,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${i}`),l+=")"),new tt(De.INVALID_ARGUMENT,o+t+l)}function _U(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YC{constructor(e,r,n,i,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Vi(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new EU(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(qC("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class EU extends YC{data(){return super.data()}}function qC(t,e){return typeof e=="string"?XC(t,e):e instanceof jv?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wU(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new tt(De.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class TU{convertValue(e,r="none"){switch(Dl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Br(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Nl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw dt()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return vu(e,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,i;const s=(i=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(a=>Br(a.doubleValue));return new Uv(s)}convertGeoPoint(e){return new Vv(Br(e.latitude),Br(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=gv(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(s0(e));default:return null}}convertTimestamp(e){const r=Uo(e);return new rn(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Pr.fromString(e);Xt(xC(n));const i=new a0(n.get(1),n.get(3)),s=new nt(n.popFirst(5));return i.isEqual(r)||Ma(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SU(t,e,r){let n;return n=t?t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rf{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class QC extends YC{constructor(e,r,n,i,s,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new ih(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(qC("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class ih extends QC{data(e={}){return super.data(e)}}class AU{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new rf(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new ih(this._firestore,this._userDataWriter,n.key,n,new rf(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new tt(De.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const l=new ih(i._firestore,i._userDataWriter,o.doc.key,o.doc,new rf(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new ih(i._firestore,i._userDataWriter,o.doc.key,o.doc,new rf(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,d=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),d=a.indexOf(o.doc.key)),{type:kU(o.type),doc:l,oldIndex:c,newIndex:d}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function kU(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return dt()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CU(t){t=Do(t,Vi);const e=Do(t.firestore,f0);return oU(Bv(e),t._key).then(r=>ZC(e,t,r))}class JC extends TU{constructor(e){super(),this.firestore=e}convertBytes(e){return new ou(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Vi(this.firestore,null,r)}}function FU(t,e,r){t=Do(t,Vi);const n=Do(t.firestore,f0),i=SU(t.converter,e);return bU(n,[xU(gU(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,Ia.none())])}function IU(t,...e){var r,n,i;t=Ps(t);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||PE(e[a])||(s=e[a],a++);const o={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(PE(e[a])){const h=e[a];e[a]=(r=h.next)===null||r===void 0?void 0:r.bind(h),e[a+1]=(n=h.error)===null||n===void 0?void 0:n.bind(h),e[a+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let l,c,d;if(t instanceof Vi)c=Do(t.firestore,f0),d=Lp(t._key.path),l={next:h=>{e[a]&&e[a](ZC(c,t,h))},error:e[a+1],complete:e[a+2]};else{const h=Do(t,Gp);c=Do(h.firestore,f0),d=h._query;const p=new JC(c);l={next:g=>{e[a]&&e[a](new AU(c,p,h,g))},error:e[a+1],complete:e[a+2]},wU(t._query)}return function(p,g,y,x){const E=new jC(x),T=new bC(g,E,y);return p.asyncQueue.enqueueAndForget(async()=>FC(await Ax(p),T)),()=>{E.Za(),p.asyncQueue.enqueueAndForget(async()=>IC(await Ax(p),T))}}(Bv(c),d,o,l)}function bU(t,e){return function(n,i){const s=new No;return n.asyncQueue.enqueueAndForget(async()=>qV(await aU(n),i,s)),s.promise}(Bv(t),e)}function ZC(t,e,r){const n=r.docs.get(e._key),i=new JC(t);return new QC(t,i,e._key,n,new rf(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){xu=i})(gu),eu(new bl("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new f0(new Fj(n.getProvider("auth-internal")),new Nj(n.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new tt(De.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new a0(c.options.projectId,d)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),Ro(Z2,"4.7.3",e),Ro(Z2,"4.7.3","esm2017")})();function Wv(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function e4(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const RU=e4,t4=new k0("auth","Firebase",e4());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ip=new uv("@firebase/auth");function NU(t,...e){ip.logLevel<=Ct.WARN&&ip.warn(`Auth (${gu}): ${t}`,...e)}function sh(t,...e){ip.logLevel<=Ct.ERROR&&ip.error(`Auth (${gu}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ba(t,...e){throw Hv(t,...e)}function ta(t,...e){return Hv(t,...e)}function r4(t,e,r){const n=Object.assign(Object.assign({},RU()),{[e]:r});return new k0("auth","Firebase",n).create(e,{appName:t.name})}function vl(t){return r4(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Hv(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return t4.create(t,...e)}function ft(t,e,...r){if(!t)throw Hv(e,...r)}function wa(t){const e="INTERNAL ASSERTION FAILED: "+t;throw sh(e),new Error(e)}function ja(t,e){t||wa(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kx(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function DU(){return OE()==="http:"||OE()==="https:"}function OE(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PU(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(DU()||i9()||"connection"in navigator)?navigator.onLine:!0}function OU(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P0{constructor(e,r){this.shortDelay=e,this.longDelay=r,ja(r>e,"Short delay should be less than long delay!"),this.isMobile=t9()||s9()}get(){return PU()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $v(t,e){ja(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n4{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;wa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;wa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;wa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MU={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LU=new P0(3e4,6e4);function Gv(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Eu(t,e,r,n,i={}){return i4(t,i,async()=>{let s={},a={};n&&(e==="GET"?a=n:s={body:JSON.stringify(n)});const o=C0(Object.assign({key:t.config.apiKey},a)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},s);return n9()||(c.referrerPolicy="no-referrer"),n4.fetch()(s4(t,t.config.apiHost,r,o),c)})}async function i4(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},MU),e);try{const i=new jU(t),s=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw jd(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw jd(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw jd(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw jd(t,"user-disabled",a);const d=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw r4(t,d,c);Ba(t,d)}}catch(i){if(i instanceof Ha)throw i;Ba(t,"network-request-failed",{message:String(i)})}}async function BU(t,e,r,n,i={}){const s=await Eu(t,e,r,n,i);return"mfaPendingCredential"in s&&Ba(t,"multi-factor-auth-required",{_serverResponse:s}),s}function s4(t,e,r,n){const i=`${e}${r}?${n}`;return t.config.emulator?$v(t.config,i):`${t.config.apiScheme}://${i}`}class jU{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(ta(this.auth,"network-request-failed")),LU.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function jd(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=ta(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VU(t,e){return Eu(t,"POST","/v1/accounts:delete",e)}async function a4(t,e){return Eu(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Af(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function UU(t,e=!1){const r=Ps(t),n=await r.getIdToken(e),i=Kv(n);ft(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:Af(Jm(i.auth_time)),issuedAtTime:Af(Jm(i.iat)),expirationTime:Af(Jm(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Jm(t){return Number(t)*1e3}function Kv(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return sh("JWT malformed, contained fewer than 3 sections"),null;try{const i=wk(r);return i?JSON.parse(i):(sh("Failed to decode base64 JWT payload"),null)}catch(i){return sh("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function ME(t){const e=Kv(t);return ft(e,"internal-error"),ft(typeof e.exp<"u","internal-error"),ft(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d0(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Ha&&zU(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function zU({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WU{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cx{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Af(this.lastLoginAt),this.creationTime=Af(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sp(t){var e;const r=t.auth,n=await t.getIdToken(),i=await d0(t,a4(r,{idToken:n}));ft(i==null?void 0:i.users.length,r,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?o4(s.providerUserInfo):[],o=$U(t.providerData,a),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=l?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Cx(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function HU(t){const e=Ps(t);await sp(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function $U(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function o4(t){return t.map(e=>{var{providerId:r}=e,n=Wv(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GU(t,e){const r=await i4(t,{},async()=>{const n=C0({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=s4(t,i,"/v1/token",`key=${s}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",n4.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function KU(t,e){return Eu(t,"POST","/v2/accounts:revokeToken",Gv(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ft(e.idToken,"internal-error"),ft(typeof e.idToken<"u","internal-error"),ft(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ME(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){ft(e.length!==0,"internal-error");const r=ME(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(ft(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:s}=await GU(e,r);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new Uc;return n&&(ft(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(ft(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(ft(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Uc,this.toJSON())}_performRefresh(){return wa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function so(t,e){ft(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ta{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,s=Wv(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new WU(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Cx(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await d0(this,this.stsTokenManager.getToken(this.auth,e));return ft(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return UU(this,e)}reload(){return HU(this)}_assign(e){this!==e&&(ft(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Ta(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){ft(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await sp(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(yo(this.auth.app))return Promise.reject(vl(this.auth));const e=await this.getIdToken();return await d0(this,VU(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,s,a,o,l,c,d;const h=(n=r.displayName)!==null&&n!==void 0?n:void 0,p=(i=r.email)!==null&&i!==void 0?i:void 0,g=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,y=(a=r.photoURL)!==null&&a!==void 0?a:void 0,x=(o=r.tenantId)!==null&&o!==void 0?o:void 0,E=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,T=(c=r.createdAt)!==null&&c!==void 0?c:void 0,A=(d=r.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:_,emailVerified:O,isAnonymous:H,providerData:j,stsTokenManager:w}=r;ft(_&&w,e,"internal-error");const F=Uc.fromJSON(this.name,w);ft(typeof _=="string",e,"internal-error"),so(h,e.name),so(p,e.name),ft(typeof O=="boolean",e,"internal-error"),ft(typeof H=="boolean",e,"internal-error"),so(g,e.name),so(y,e.name),so(x,e.name),so(E,e.name),so(T,e.name),so(A,e.name);const S=new Ta({uid:_,auth:e,email:p,emailVerified:O,displayName:h,isAnonymous:H,photoURL:y,phoneNumber:g,tenantId:x,stsTokenManager:F,createdAt:T,lastLoginAt:A});return j&&Array.isArray(j)&&(S.providerData=j.map(b=>Object.assign({},b))),E&&(S._redirectEventId=E),S}static async _fromIdTokenResponse(e,r,n=!1){const i=new Uc;i.updateFromServerResponse(r);const s=new Ta({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await sp(s),s}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];ft(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?o4(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),o=new Uc;o.updateFromIdToken(n);const l=new Ta({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Cx(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LE=new Map;function Sa(t){ja(t instanceof Function,"Expected a class definition");let e=LE.get(t);return e?(ja(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,LE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l4{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}l4.type="NONE";const BE=l4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ah(t,e,r){return`firebase:${t}:${e}:${r}`}class zc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=ah(this.userKey,i.apiKey,s),this.fullPersistenceKey=ah("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Ta._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new zc(Sa(BE),e,n);const i=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||Sa(BE);const a=ah(n,e.config.apiKey,e.name);let o=null;for(const c of r)try{const d=await c._get(a);if(d){const h=Ta._fromJSON(e,d);c!==s&&(o=h),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new zc(s,e,n):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==s)try{await c._remove(a)}catch{}})),new zc(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(d4(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(c4(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(p4(e))return"Blackberry";if(m4(e))return"Webos";if(u4(e))return"Safari";if((e.includes("chrome/")||f4(e))&&!e.includes("edge/"))return"Chrome";if(h4(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function c4(t=Qn()){return/firefox\//i.test(t)}function u4(t=Qn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function f4(t=Qn()){return/crios\//i.test(t)}function d4(t=Qn()){return/iemobile/i.test(t)}function h4(t=Qn()){return/android/i.test(t)}function p4(t=Qn()){return/blackberry/i.test(t)}function m4(t=Qn()){return/webos/i.test(t)}function Xv(t=Qn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function XU(t=Qn()){var e;return Xv(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function YU(){return a9()&&document.documentMode===10}function g4(t=Qn()){return Xv(t)||h4(t)||m4(t)||p4(t)||/windows phone/i.test(t)||d4(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x4(t,e=[]){let r;switch(t){case"Browser":r=jE(Qn());break;case"Worker":r=`${jE(Qn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${gu}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qU{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QU(t,e={}){return Eu(t,"GET","/v2/passwordPolicy",Gv(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JU=6;class ZU{constructor(e){var r,n,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:JU,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ez{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new VE(this),this.idTokenSubscription=new VE(this),this.beforeStateQueue=new qU(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=t4,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Sa(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await zc.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await a4(this,{idToken:e}),n=await Ta._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(yo(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ft(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await sp(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=OU()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(yo(this.app))return Promise.reject(vl(this));const r=e?Ps(e):null;return r&&ft(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&ft(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return yo(this.app)?Promise.reject(vl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return yo(this.app)?Promise.reject(vl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Sa(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await QU(this),r=new ZU(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new k0("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await KU(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Sa(e)||this._popupRedirectResolver;ft(r,this,"argument-error"),this.redirectPersistenceManager=await zc.create(this,[Sa(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(ft(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,i);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ft(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=x4(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&NU(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Yv(t){return Ps(t)}class VE{constructor(e){this.auth=e,this.observer=null,this.addObserver=p9(r=>this.observer=r)}get next(){return ft(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function tz(t){qv=t}function rz(t){return qv.loadJS(t)}function nz(){return qv.gapiScript}function iz(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sz(t,e){const r=dv(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),s=r.getOptions();if(Kh(s,e??{}))return i;Ba(i,"already-initialized")}return r.initialize({options:e})}function az(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Sa);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function oz(t,e,r){const n=Yv(t);ft(n._canInitEmulator,n,"emulator-config-failed"),ft(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,s=v4(e),{host:a,port:o}=lz(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${s}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),cz()}function v4(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function lz(t){const e=v4(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:UE(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:UE(a)}}}function UE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function cz(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y4{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return wa("not implemented")}_getIdTokenResponse(e){return wa("not implemented")}_linkToIdToken(e,r){return wa("not implemented")}_getReauthenticationResolver(e){return wa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wc(t,e){return BU(t,"POST","/v1/accounts:signInWithIdp",Gv(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uz="http://localhost";class Pl extends y4{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Pl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Ba("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,s=Wv(r,["providerId","signInMethod"]);if(!n||!i)return null;const a=new Pl(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return Wc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Wc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Wc(e,r)}buildRequest(){const e={requestUri:uz,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=C0(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _4{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O0 extends _4{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo extends O0{constructor(){super("facebook.com")}static credential(e){return Pl._fromParams({providerId:uo.PROVIDER_ID,signInMethod:uo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return uo.credentialFromTaggedObject(e)}static credentialFromError(e){return uo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return uo.credential(e.oauthAccessToken)}catch{return null}}}uo.FACEBOOK_SIGN_IN_METHOD="facebook.com";uo.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fo extends O0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Pl._fromParams({providerId:fo.PROVIDER_ID,signInMethod:fo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return fo.credentialFromTaggedObject(e)}static credentialFromError(e){return fo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return fo.credential(r,n)}catch{return null}}}fo.GOOGLE_SIGN_IN_METHOD="google.com";fo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ho extends O0{constructor(){super("github.com")}static credential(e){return Pl._fromParams({providerId:ho.PROVIDER_ID,signInMethod:ho.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ho.credentialFromTaggedObject(e)}static credentialFromError(e){return ho.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ho.credential(e.oauthAccessToken)}catch{return null}}}ho.GITHUB_SIGN_IN_METHOD="github.com";ho.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po extends O0{constructor(){super("twitter.com")}static credential(e,r){return Pl._fromParams({providerId:po.PROVIDER_ID,signInMethod:po.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return po.credentialFromTaggedObject(e)}static credentialFromError(e){return po.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return po.credential(r,n)}catch{return null}}}po.TWITTER_SIGN_IN_METHOD="twitter.com";po.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const s=await Ta._fromIdTokenResponse(e,n,i),a=zE(n);return new lu({user:s,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=zE(n);return new lu({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function zE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap extends Ha{constructor(e,r,n,i){var s;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,ap.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new ap(e,r,n,i)}}function E4(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?ap._fromErrorAndOperation(t,s,e,n):s})}async function fz(t,e,r=!1){const n=await d0(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return lu._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dz(t,e,r=!1){const{auth:n}=t;if(yo(n.app))return Promise.reject(vl(n));const i="reauthenticate";try{const s=await d0(t,E4(n,i,e,t),r);ft(s.idToken,n,"internal-error");const a=Kv(s.idToken);ft(a,n,"internal-error");const{sub:o}=a;return ft(t.uid===o,n,"user-mismatch"),lu._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Ba(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hz(t,e,r=!1){if(yo(t.app))return Promise.reject(vl(t));const n="signIn",i=await E4(t,n,e),s=await lu._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(s.user),s}function pz(t,e,r,n){return Ps(t).onIdTokenChanged(e,r,n)}function mz(t,e,r){return Ps(t).beforeAuthStateChanged(e,r)}const op="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w4{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(op,"1"),this.storage.removeItem(op),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gz=1e3,xz=10;class T4 extends w4{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=g4(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);YU()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,xz):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},gz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}T4.type="LOCAL";const vz=T4;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S4 extends w4{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}S4.type="SESSION";const A4=S4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yz(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new Kp(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:s}=r.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async c=>c(r.origin,s)),l=await yz(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Kp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qv(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _z{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const c=Qv("",20);i.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(h){const p=h;if(p.data.eventId===c)switch(p.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(p.data.response);break;default:clearTimeout(d),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ra(){return window}function Ez(t){ra().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k4(){return typeof ra().WorkerGlobalScope<"u"&&typeof ra().importScripts=="function"}async function wz(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Tz(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function Sz(){return k4()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C4="firebaseLocalStorageDb",Az=1,lp="firebaseLocalStorage",F4="fbase_key";class M0{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Xp(t,e){return t.transaction([lp],e?"readwrite":"readonly").objectStore(lp)}function kz(){const t=indexedDB.deleteDatabase(C4);return new M0(t).toPromise()}function Fx(){const t=indexedDB.open(C4,Az);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(lp,{keyPath:F4})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(lp)?e(n):(n.close(),await kz(),e(await Fx()))})})}async function WE(t,e,r){const n=Xp(t,!0).put({[F4]:e,value:r});return new M0(n).toPromise()}async function Cz(t,e){const r=Xp(t,!1).get(e),n=await new M0(r).toPromise();return n===void 0?null:n.value}function HE(t,e){const r=Xp(t,!0).delete(e);return new M0(r).toPromise()}const Fz=800,Iz=3;class I4{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Fx(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>Iz)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return k4()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Kp._getInstance(Sz()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await wz(),!this.activeServiceWorker)return;this.sender=new _z(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Tz()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Fx();return await WE(e,op,"1"),await HE(e,op),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>WE(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>Cz(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>HE(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Xp(i,!1).getAll();return new M0(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Fz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}I4.type="LOCAL";const bz=I4;new P0(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rz(t,e){return e?Sa(e):(ft(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jv extends y4{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Wc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Wc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Wc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function Nz(t){return hz(t.auth,new Jv(t),t.bypassAuthState)}function Dz(t){const{auth:e,user:r}=t;return ft(r,e,"internal-error"),dz(r,new Jv(t),t.bypassAuthState)}async function Pz(t){const{auth:e,user:r}=t;return ft(r,e,"internal-error"),fz(r,new Jv(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b4{constructor(e,r,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Nz;case"linkViaPopup":case"linkViaRedirect":return Pz;case"reauthViaPopup":case"reauthViaRedirect":return Dz;default:Ba(this.auth,"internal-error")}}resolve(e){ja(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ja(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oz=new P0(2e3,1e4);class Ic extends b4{constructor(e,r,n,i,s){super(e,r,i,s),this.provider=n,this.authWindow=null,this.pollId=null,Ic.currentPopupAction&&Ic.currentPopupAction.cancel(),Ic.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ft(e,this.auth,"internal-error"),e}async onExecution(){ja(this.filter.length===1,"Popup operations only handle one event");const e=Qv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(ta(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ta(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ic.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ta(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Oz.get())};e()}}Ic.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mz="pendingRedirect",oh=new Map;class Lz extends b4{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=oh.get(this.auth._key());if(!e){try{const n=await Bz(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}oh.set(this.auth._key(),e)}return this.bypassAuthState||oh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Bz(t,e){const r=Uz(e),n=Vz(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function jz(t,e){oh.set(t._key(),e)}function Vz(t){return Sa(t._redirectPersistence)}function Uz(t){return ah(Mz,t.config.apiKey,t.name)}async function zz(t,e,r=!1){if(yo(t.app))return Promise.reject(vl(t));const n=Yv(t),i=Rz(n,e),a=await new Lz(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wz=10*60*1e3;class Hz{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!$z(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!R4(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(ta(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Wz&&this.cachedEventUids.clear(),this.cachedEventUids.has($E(e))}saveEventToCache(e){this.cachedEventUids.add($E(e)),this.lastProcessedEventTime=Date.now()}}function $E(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function R4({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function $z(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return R4(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gz(t,e={}){return Eu(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kz=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Xz=/^https?/;async function Yz(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Gz(t);for(const r of e)try{if(qz(r))return}catch{}Ba(t,"unauthorized-domain")}function qz(t){const e=kx(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!Xz.test(r))return!1;if(Kz.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qz=new P0(3e4,6e4);function GE(){const t=ra().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function Jz(t){return new Promise((e,r)=>{var n,i,s;function a(){GE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{GE(),r(ta(t,"network-request-failed"))},timeout:Qz.get()})}if(!((i=(n=ra().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=ra().gapi)===null||s===void 0)&&s.load)a();else{const o=iz("iframefcb");return ra()[o]=()=>{gapi.load?a():r(ta(t,"network-request-failed"))},rz(`${nz()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw lh=null,e})}let lh=null;function Zz(t){return lh=lh||Jz(t),lh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eW=new P0(5e3,15e3),tW="__/auth/iframe",rW="emulator/auth/iframe",nW={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},iW=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function sW(t){const e=t.config;ft(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?$v(e,rW):`https://${t.config.authDomain}/${tW}`,n={apiKey:e.apiKey,appName:t.name,v:gu},i=iW.get(t.config.apiHost);i&&(n.eid=i);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${C0(n).slice(1)}`}async function aW(t){const e=await Zz(t),r=ra().gapi;return ft(r,t,"internal-error"),e.open({where:document.body,url:sW(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:nW,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const a=ta(t,"network-request-failed"),o=ra().setTimeout(()=>{s(a)},eW.get());function l(){ra().clearTimeout(o),i(n)}n.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oW={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},lW=500,cW=600,uW="_blank",fW="http://localhost";class KE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function dW(t,e,r,n=lW,i=cW){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},oW),{width:n.toString(),height:i.toString(),top:s,left:a}),c=Qn().toLowerCase();r&&(o=f4(c)?uW:r),c4(c)&&(e=e||fW,l.scrollbars="yes");const d=Object.entries(l).reduce((p,[g,y])=>`${p}${g}=${y},`,"");if(XU(c)&&o!=="_self")return hW(e||"",o),new KE(null);const h=window.open(e||"",o,d);ft(h,t,"popup-blocked");try{h.focus()}catch{}return new KE(h)}function hW(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pW="__/auth/handler",mW="emulator/auth/handler",gW=encodeURIComponent("fac");async function XE(t,e,r,n,i,s){ft(t.config.authDomain,t,"auth-domain-config-required"),ft(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:gu,eventId:i};if(e instanceof _4){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",h9(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries({}))a[d]=h}if(e instanceof O0){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(a.scopes=d.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const d of Object.keys(o))o[d]===void 0&&delete o[d];const l=await t._getAppCheckToken(),c=l?`#${gW}=${encodeURIComponent(l)}`:"";return`${xW(t)}?${C0(o).slice(1)}${c}`}function xW({config:t}){return t.emulator?$v(t,mW):`https://${t.authDomain}/${pW}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zm="webStorageSupport";class vW{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=A4,this._completeRedirectFn=zz,this._overrideRedirectResult=jz}async _openPopup(e,r,n,i){var s;ja((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await XE(e,r,n,kx(),i);return dW(e,a,Qv())}async _openRedirect(e,r,n,i){await this._originValidation(e);const s=await XE(e,r,n,kx(),i);return Ez(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:s}=this.eventManagers[r];return i?Promise.resolve(i):(ja(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await aW(e),n=new Hz(e);return r.register("authEvent",i=>(ft(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Zm,{type:Zm},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Zm];a!==void 0&&r(!!a),Ba(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=Yz(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return g4()||u4()||Xv()}}const yW=vW;var YE="@firebase/auth",qE="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _W{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){ft(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EW(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function wW(t){eu(new bl("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;ft(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:x4(t)},c=new ez(n,i,s,l);return az(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),eu(new bl("auth-internal",e=>{const r=Yv(e.getProvider("auth").getImmediate());return(n=>new _W(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ro(YE,qE,EW(t)),Ro(YE,qE,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TW=5*60,SW=Ak("authIdTokenMaxAge")||TW;let QE=null;const AW=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>SW)return;const i=r==null?void 0:r.token;QE!==i&&(QE=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function kW(t=Ik()){const e=dv(t,"auth");if(e.isInitialized())return e.getImmediate();const r=sz(t,{popupRedirectResolver:yW,persistence:[bz,vz,A4]}),n=Ak("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const a=AW(s.toString());mz(r,a,()=>a(r.currentUser)),pz(r,o=>a(o))}}const i=Tk("auth");return i&&oz(r,`http://${i}`),r}function CW(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}tz({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const s=ta("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",CW().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});wW("Browser");const FW={apiKey:"AIzaSyAZZ0804o11q-hS6p7XJZNK_FPGJgXpmPc",authDomain:"finance-automation-b28e8.firebaseapp.com",projectId:"finance-automation-b28e8",storageBucket:"finance-automation-b28e8.firebasestorage.app",messagingSenderId:"832501526859",appId:"1:832501526859:web:3a64f40f9db732af1b78ce"},N4=Fk(FW),Zv=fU(N4);kW(N4);const eg=async(t,e)=>{try{return await FU(Lv(Zv,"appState",t),{masterData:e.masterData||[],ledgerEntries:e.ledgerEntries||[],receipts:e.receipts||[],creditNotes:e.creditNotes||[],openingBalances:e.openingBalances||{},mailerImages:e.mailerImages||{},mailerLogo:e.mailerLogo||null,companyConfig:e.companyConfig||{},nextInvoiceNo:e.nextInvoiceNo||1,nextCombineNo:e.nextCombineNo||1,nextReceiptNo:e.nextReceiptNo||1,nextCreditNoteNo:e.nextCreditNoteNo||1,invoiceValues:e.invoiceValues||{},notifications:e.notifications||[],whatsappSettings:e.whatsappSettings||{},partyMaster:e.partyMaster||[],followups:e.followups||[],updatedAt:new Date().toISOString()}),!0}catch(r){return console.error("Error saving app state:",r),!1}},JE=async t=>{try{const e=await CU(Lv(Zv,"appState",t));return e.exists()?e.data():null}catch(e){return console.error("Error loading app state:",e),null}},IW=(t,e)=>{const r=Lv(Zv,"appState",t);return IU(r,n=>{n.exists()&&e(n.data())},n=>{console.error("Error in real-time listener:",n)})},ut=t=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2,maximumFractionDigits:2}).format(t||0),Vt=t=>""+new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t||0),mr=t=>{if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return t;const r=e.getDate().toString().padStart(2,"0"),n=e.toLocaleString("en-US",{month:"short"}),i=e.getFullYear();return`${r}-${n}-${i}`},bW=t=>{if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return t;const r=e.getDate(),n=e.toLocaleString("en-US",{month:"short"}),i=e.getFullYear();return`${r}${(a=>{if(a>3&&a<21)return"th";switch(a%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}})(r)} ${n}, ${i}`},RW=t=>{const e=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],r=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];if(t===0)return"Zero";const n=l=>l<20?e[l]:l<100?r[Math.floor(l/10)]+(l%10?" "+e[l%10]:""):e[Math.floor(l/100)]+" Hundred"+(l%100?" "+n(l%100):""),i=l=>l<1e3?n(l):l<1e5?n(Math.floor(l/1e3))+" Thousand"+(l%1e3?" "+n(l%1e3):""):l<1e7?n(Math.floor(l/1e5))+" Lakh"+(l%1e5?" "+i(l%1e5):""):n(Math.floor(l/1e7))+" Crore"+(l%1e7?" "+i(l%1e7):""),s=Math.floor(t),a=Math.round((t-s)*100);let o="INR "+i(s);return a>0&&(o+=" and "+i(a)+" Paise"),o+" Only"},NW=t=>{if(!t)return"";const e=/[\w.-]+@[\w.-]+\.\w+/g,r=t.match(e);return r?r[0]:""},DW=t=>({Approved:{bg:"#DCFCE7",text:"#166534",border:"#86EFAC"},Created:{bg:"#DBEAFE",text:"#1E40AF",border:"#93C5FD"},"Need Edits":{bg:"#FEE2E2",text:"#991B1B",border:"#FCA5A5"},Paid:{bg:"#D1FAE5",text:"#065F46",border:"#6EE7B7"},Individual:{bg:"#E0E7FF",text:"#3730A3",border:"#A5B4FC"},Combined:{bg:"#F3E8FF",text:"#6B21A8",border:"#DDD6FE"},Yes:{bg:"#DCFCE7",text:"#166534",border:"#86EFAC"},No:{bg:"#FEF3C7",text:"#92400E",border:"#FCD34D"},"Not Yet":{bg:"#F1F5F9",text:"#475569",border:"#CBD5E1"},Pending:{bg:"#FEF3C7",text:"#92400E",border:"#FCD34D"},Sent:{bg:"#D1FAE5",text:"#065F46",border:"#6EE7B7"}})[t]||{bg:"#F1F5F9",text:"#475569",border:"#CBD5E1"},tg=({status:t,small:e=!1})=>{const r=DW(t);return f.jsx("span",{style:{display:"inline-flex",alignItems:"center",padding:e?"2px 8px":"4px 12px",borderRadius:"6px",fontSize:e?"11px":"12px",fontWeight:"600",backgroundColor:r.bg,color:r.text,border:`1px solid ${r.border}`},children:t})},Ye=({icon:t,label:e,onClick:r,variant:n="default",disabled:i=!1,small:s=!1})=>{const o={default:{bg:"#F8FAFC",hoverBg:"#E2E8F0",text:"#475569",border:"#CBD5E1"},primary:{bg:"#2874A6",hoverBg:"#1a5276",text:"#FFFFFF",border:"#2874A6"},success:{bg:"#059669",hoverBg:"#047857",text:"#FFFFFF",border:"#059669"},warning:{bg:"#D97706",hoverBg:"#B45309",text:"#FFFFFF",border:"#D97706"},danger:{bg:"#DC2626",hoverBg:"#B91C1C",text:"#FFFFFF",border:"#DC2626"},brand:{bg:"#2874A6",hoverBg:"#1a5276",text:"#FFFFFF",border:"#2874A6"},purple:{bg:"#7C3AED",hoverBg:"#6D28D9",text:"#FFFFFF",border:"#7C3AED"}}[n];return f.jsxs("button",{onClick:r,disabled:i,title:e,style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:s?"5px 10px":"8px 14px",borderRadius:"6px",fontSize:s?"11px":"13px",fontWeight:"600",backgroundColor:i?"#F1F5F9":o.bg,color:i?"#94A3B8":o.text,border:`1px solid ${i?"#E2E8F0":o.border}`,cursor:i?"not-allowed":"pointer",transition:"all 0.15s ease",whiteSpace:"nowrap",opacity:i?.6:1},onMouseEnter:l=>!i&&(l.target.style.backgroundColor=o.hoverBg),onMouseLeave:l=>!i&&(l.target.style.backgroundColor=o.bg),children:[t&&f.jsx(t,{size:s?14:16}),e&&f.jsx("span",{children:e})]})},gr=({label:t,type:e="text",value:r,onChange:n,placeholder:i,disabled:s,small:a})=>f.jsxs("div",{style:{marginBottom:a?"12px":"16px"},children:[t&&f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:t}),f.jsx("input",{type:e,value:r,onChange:n,placeholder:i,disabled:s,style:{width:"100%",padding:a?"8px 12px":"10px 14px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:a?"13px":"14px",backgroundColor:s?"#F9FAFB":"#FFFFFF",boxSizing:"border-box"}})]}),Vd=({label:t,value:e,onChange:r,options:n,small:i})=>f.jsxs("div",{style:{marginBottom:i?"12px":"16px"},children:[t&&f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:t}),f.jsx("select",{value:e,onChange:r,style:{width:"100%",padding:i?"8px 12px":"10px 14px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:i?"13px":"14px",backgroundColor:"#FFFFFF",boxSizing:"border-box"},children:n.map(s=>f.jsx("option",{value:s.value,children:s.label},s.value))})]}),En=({title:t,children:e,actions:r,noPadding:n=!1})=>f.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",boxShadow:"0 2px 8px rgba(0,0,0,0.06)",overflow:"hidden"},children:[t&&f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"14px 20px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FAFBFC"},children:[f.jsx("h3",{style:{margin:0,fontSize:"15px",fontWeight:"700",color:"#1E293B"},children:t}),r&&f.jsx("div",{style:{display:"flex",gap:"10px"},children:r})]}),f.jsx("div",{style:{padding:n?0:"20px"},children:e})]}),wn=({isOpen:t,onClose:e,title:r,children:n,width:i="500px"})=>t?f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(15, 23, 42, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(4px)"},onClick:e,children:f.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"16px",width:i,maxWidth:"95vw",maxHeight:"90vh",overflow:"hidden",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},onClick:s=>s.stopPropagation(),children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FAFBFC"},children:[f.jsx("h2",{style:{margin:0,fontSize:"16px",fontWeight:"700",color:"#1E293B"},children:r}),f.jsx("button",{onClick:e,style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748B"},children:f.jsx(nl,{size:20})})]}),f.jsx("div",{style:{padding:"20px",maxHeight:"calc(90vh - 100px)",overflowY:"auto"},children:n})]})}):null;function PW(){const[t,e]=ve.useState(()=>{const m=localStorage.getItem("financeAppLogin");return m?JSON.parse(m).isLoggedIn:!1}),[r,n]=ve.useState(()=>{const m=localStorage.getItem("financeAppLogin");return m?JSON.parse(m).userRole:null}),[i,s]=ve.useState({username:"",password:""}),[a,o]=ve.useState(""),[l,c]=ve.useState(!1),[d,h]=ve.useState(!1),[p,g]=ve.useState(null),[y,x]=ve.useState({finance:"finance123",director:"director123"}),[E,T]=ve.useState(!1),[A,_]=ve.useState(!1),[O,H]=ve.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[j,w]=ve.useState(""),F={finance:{role:"finance",name:"Finance Team"},director:{role:"director",name:"Director"}};ve.useEffect(()=>{(async()=>{try{const C=await JE("indreesh-media");C&&C.userPasswords&&(x(C.userPasswords),console.log("Passwords loaded from Firebase"))}catch(C){console.error("Error loading passwords:",C)}T(!0)})()},[]);const[S,b]=ve.useState({name:"Indreesh Media LLP",brand:"JAC",address:"A-1701 Sweet Home CHS LTD, SVP, Plot No: 24",addressLine2:"Andheri West, Nr Last Bus St",city:"Mumbai-400053",gstin:"27AAIFI6351A1ZM",stateCode:"27",stateName:"Maharashtra",email:"alliances@mediabrief.com",phone:"+91 7021911036",website:"www.mediabrief.com",pan:"AAIFI6351A",bank:{name:"Axis Bank",account:"921020009075531",branch:"Andheri",ifsc:"UTIB0000020",holder:"Indreesh Media LLP"},invoicePrefix:"MB/2025-26/",hsnCode:"998365",gstRate:18}),[D,P]=ve.useState("master"),[N,ze]=ve.useState(!1),[ge,be]=ve.useState([]),[Se,ye]=ve.useState([]),[Q,Ce]=ve.useState([]),[Be,V]=ve.useState([]),[G,q]=ve.useState(null),[Y,de]=ve.useState(1),[Ae,Pe]=ve.useState(1),[ke,we]=ve.useState(1),[it,K]=ve.useState(1),[Bt,gt]=ve.useState(!1),[bt,ht]=ve.useState(!1),[$e,Zt]=ve.useState(!1),[pn,Yr]=ve.useState(!1),[hi,$i]=ve.useState(!1),[pi,Fr]=ve.useState(!1),[mi,Pt]=ve.useState(!1),[vr,nr]=ve.useState(!1),[Zn,ct]=ve.useState(!1),[ir,yr]=ve.useState(!1),[dr,Dn]=ve.useState(!1),[ae,zr]=ve.useState(null),[oa,la]=ve.useState("reply"),[Os,ca]=ve.useState(""),[ki,Gi]=ve.useState(""),[_r,Ki]=ve.useState({fromDate:"2020-01-01",toDate:new Date().toISOString().split("T")[0]}),[ua,$a]=ve.useState(""),[Pn,Ms]=ve.useState("open"),[er,hr]=ve.useState({party:"",invoiceStatus:"",receiptStatus:"",invoiceType:"",searchText:""}),[Ci,mn]=ve.useState([]),[fa,$l]=ve.useState(!1),[ms,I]=ve.useState([]),[z,B]=ve.useState(!1),[L,W]=ve.useState(null),[U,le]=ve.useState({date:new Date().toISOString().split("T")[0],notes:"",nextFollowupDate:"",status:"Pending"}),[ne,oe]=ve.useState({enabled:!1,financePhone:"",financeApiKey:"",directorPhone:"",directorApiKey:""}),[te,ce]=ve.useState({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),[xe,Me]=ve.useState({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]}),[Ge,Ie]=ve.useState({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1}),[We,st]=ve.useState(null),[Et,kt]=ve.useState(new Set),[wt,ei]=ve.useState({}),[gn,Fi]=ve.useState(null),[xn,Ii]=ve.useState(null),[vn,Ga]=ve.useState(!1),[ti,Yo]=ve.useState({}),[gi,Gl]=ve.useState({partyName:"",amount:"",type:"Dr"}),[gs,Kl]=ve.useState({}),[yn,Xi]=ve.useState({}),[xs,da]=ve.useState(!1),[qo,Xl]=ve.useState(new Set),[Xe,Ls]=ve.useState({party:"",billStatus:"",invoiceStatus:"",mailingStatus:"",invoiceType:"",combinationCode:"",searchText:""}),[Yt,Yi]=ve.useState({amount:"",date:new Date().toISOString().split("T")[0],mode:"Bank",tds:"",discount:"",narration:""}),L0=ve.useRef(null),wu=ve.useRef(null),Tu=ve.useRef(null),B0=ve.useRef(null),j0=ve.useRef(null),V0=ve.useRef(null),vs=ve.useRef(null),ys=ve.useRef(null),Su=ve.useRef(null),sn=ve.useMemo(()=>Array.isArray(ge)?ge:[],[ge]),xi=ve.useMemo(()=>Array.isArray(Se)?Se:[],[Se]),_s=ve.useMemo(()=>Array.isArray(Q)?Q:[],[Q]),Yl=ve.useMemo(()=>Array.isArray(Be)?Be:[],[Be]),U0=ve.useMemo(()=>Array.isArray(Ci)?Ci:[],[Ci]),ql=ve.useMemo(()=>Array.isArray(ms)?ms:[],[ms]),tr=ve.useMemo(()=>yn&&typeof yn=="object"&&!Array.isArray(yn)?yn:{},[yn]),Ka=ve.useMemo(()=>ti&&typeof ti=="object"&&!Array.isArray(ti)?ti:{},[ti]),Er=(m,C)=>!m||!C?!1:m.trim().toUpperCase()===C.trim().toUpperCase(),Xa=ve.useCallback(m=>{if(!m)return"";const C=m.toUpperCase().trim();return C.includes("MAHARASHTRA")||C==="MH"?"MAHARASHTRA":C.includes("DELHI")||C==="DL"||C.includes("NEW DELHI")?"DELHI":C.includes("KARNATAKA")||C==="KA"||C.includes("BANGALORE")||C.includes("BENGALURU")?"KARNATAKA":C.includes("TAMIL")||C==="TN"||C.includes("CHENNAI")?"TAMIL NADU":C.includes("TELANGANA")||C==="TG"||C==="TS"||C.includes("HYDERABAD")?"TELANGANA":C.includes("UTTAR PRADESH")||C==="UP"||C.includes("NOIDA")||C.includes("LUCKNOW")?"UTTAR PRADESH":C.includes("WEST BENGAL")||C==="WB"||C.includes("KOLKATA")?"WEST BENGAL":C.includes("GUJARAT")||C==="GJ"||C.includes("AHMEDABAD")?"GUJARAT":C.includes("RAJASTHAN")||C==="RJ"||C.includes("JAIPUR")?"RAJASTHAN":C.includes("PUNJAB")||C==="PB"?"PUNJAB":C.includes("HARYANA")||C==="HR"||C.includes("GURGAON")||C.includes("GURUGRAM")?"HARYANA":C.includes("MADHYA PRADESH")||C==="MP"||C.includes("BHOPAL")?"MADHYA PRADESH":C.includes("ANDHRA")||C==="AP"?"ANDHRA PRADESH":C.includes("KERALA")||C==="KL"?"KERALA":C.includes("ODISHA")||C.includes("ORISSA")||C==="OR"||C==="OD"?"ODISHA":C.includes("BIHAR")||C==="BR"?"BIHAR":C.includes("JHARKHAND")||C==="JH"?"JHARKHAND":C.includes("ASSAM")||C==="AS"?"ASSAM":C.includes("CHHATTISGARH")||C==="CG"?"CHHATTISGARH":C.includes("GOA")||C==="GA"?"GOA":C.includes("HIMACHAL")||C==="HP"?"HIMACHAL PRADESH":C.includes("JAMMU")||C==="JK"?"JAMMU AND KASHMIR":C.includes("UTTARAKHAND")||C.includes("UTTARANCHAL")||C==="UK"?"UTTARAKHAND":C.includes("MUMBAI")?"MAHARASHTRA":C.includes("CHANDIGARH")?"CHANDIGARH":C},[]),Ya=ve.useCallback((m,C)=>{var re;if(!m)return"";const X=Xa(C),Z=m.trim().toUpperCase(),J=`${Z}|${X}`;if((re=tr[J])!=null&&re.gstin)return tr[J].gstin;for(const R in tr){const pe=tr[R];if((pe.partyName||"").trim().toUpperCase()===Z&&pe.normalizedState===X)return pe.gstin||""}for(const R in tr){const pe=tr[R];if((pe.partyName||"").trim().toUpperCase()===Z&&pe.gstin)return pe.gstin}return""},[tr,Xa]),Qo=ve.useRef(!1),bi=ve.useRef(null),qa=async()=>{c(!0);try{const m=await JE("indreesh-media");m&&(Array.isArray(m.masterData)&&be(m.masterData),Array.isArray(m.ledgerEntries)&&ye(m.ledgerEntries),Array.isArray(m.receipts)&&Ce(m.receipts),Array.isArray(m.creditNotes)&&V(m.creditNotes),Array.isArray(m.notifications)&&mn(m.notifications),Array.isArray(m.followups)&&I(m.followups),m.openingBalances&&typeof m.openingBalances=="object"&&!Array.isArray(m.openingBalances)&&Yo(m.openingBalances),m.mailerImages&&typeof m.mailerImages=="object"&&!Array.isArray(m.mailerImages)&&ei(m.mailerImages),m.partyMaster&&typeof m.partyMaster=="object"&&!Array.isArray(m.partyMaster)&&Xi(m.partyMaster),m.userPasswords&&typeof m.userPasswords=="object"&&!Array.isArray(m.userPasswords)&&x(m.userPasswords),m.mailerLogo&&Fi(m.mailerLogo),m.companyConfig&&b(C=>({...C,...m.companyConfig,name:"Indreesh Media LLP",bank:{...m.companyConfig.bank||C.bank,holder:"Indreesh Media LLP"}})),m.nextInvoiceNo&&de(m.nextInvoiceNo),m.nextCombineNo&&Pe(m.nextCombineNo),m.nextReceiptNo&&we(m.nextReceiptNo),m.nextCreditNoteNo&&K(m.nextCreditNoteNo),m.invoiceValues&&Kl(m.invoiceValues),m.whatsappSettings&&oe(C=>({...C,...m.whatsappSettings})),console.log("Data loaded from Firebase"))}catch(m){console.error("Error loading data:",m)}c(!1)},Au=ve.useCallback(async()=>{h(!0);try{await eg("indreesh-media",{masterData:ge,ledgerEntries:Se,receipts:Q,creditNotes:Be,openingBalances:ti,mailerImages:wt,mailerLogo:gn,companyConfig:S,nextInvoiceNo:Y,nextCombineNo:Ae,nextReceiptNo:ke,nextCreditNoteNo:it,invoiceValues:gs,notifications:Ci,whatsappSettings:ne,partyMaster:yn,followups:ms,userPasswords:y}),g(new Date),console.log("Data saved to Firebase")}catch(m){console.error("Error saving data:",m)}h(!1)},[ge,Se,Q,Be,ti,wt,gn,S,Y,Ae,ke,it,gs,Ci,ne,yn,ms,y]);ve.useEffect(()=>{if(t&&!Qo.current)return vs.current&&clearTimeout(vs.current),vs.current=setTimeout(()=>{Qo.current||Au()},1e3),()=>{vs.current&&clearTimeout(vs.current)}},[ge,Se,Q,Be,ti,wt,gn,S,Y,Ae,ke,it,gs,Ci,ne,yn,ms,y,t]);const ku=async(m,C,X)=>{if(!ne.enabled){console.log("WhatsApp notifications not enabled");return}X==="finance"&&ne.financePhone&&ne.financeApiKey?qt(ne.financePhone,ne.financeApiKey,m,C):X==="director"&&ne.directorPhone&&ne.directorApiKey?qt(ne.directorPhone,ne.directorApiKey,m,C):X==="all"&&(ne.financePhone&&ne.financeApiKey&&qt(ne.financePhone,ne.financeApiKey,m,C),ne.directorPhone&&ne.directorApiKey&&qt(ne.directorPhone,ne.directorApiKey,m,C))},qt=async(m,C,X,Z)=>{try{const re=`*${{upload:" DATA UPLOAD",invoice:" INVOICE",approval:" APPROVED",edit:" EDIT REQUIRED",receipt:" PAYMENT",info:" UPDATE"}[X]||" NOTIFICATION"}*

${Z}

_${S.name}_
_${new Date().toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})}_`,R=`https://api.callmebot.com/whatsapp.php?phone=${m}&text=${encodeURIComponent(re)}&apikey=${C}`;fetch(R,{mode:"no-cors"}).then(()=>console.log("WhatsApp notification sent to:",m)).catch(pe=>console.log("WhatsApp send attempted:",m))}catch(J){console.error("Failed to send WhatsApp notification:",J)}},z0=(m,C)=>{if(!m||!C){alert("Please enter phone number and API key first");return}qt(m,C,"info","Test notification from Indreesh Media LLP. WhatsApp notifications are working!"),alert("Test message sent! Check your WhatsApp.")},Bs=(m,C,X="all")=>{const Z={id:Date.now()+Math.random(),type:m,message:C,forRole:X,createdAt:new Date().toISOString(),createdBy:r,read:{finance:!1,director:!1}};mn(J=>[Z,...J].slice(0,50)),ku(m,C,X)},W0=m=>{mn(C=>(Array.isArray(C)?C:[]).map(Z=>Z.id===m?{...Z,read:{...Z.read,[r]:!0}}:Z))},H0=()=>{mn(m=>(Array.isArray(m)?m:[]).map(X=>({...X,read:{...X.read,[r]:!0}})))},$0=()=>{mn([])},ha=ve.useMemo(()=>U0.filter(m=>m.forRole==="all"||m.forRole===r||m.createdBy!==r).map(m=>({...m,read:m.read||{finance:!1,director:!1}})),[U0,r]),qi=ve.useMemo(()=>r?ha.filter(m=>!(m.read&&m.read[r])).length:0,[ha,r]),Qi=async()=>{const m=F[i.username.toLowerCase()],C=y[i.username.toLowerCase()];m&&C===i.password?(e(!0),n(m.role),localStorage.setItem("financeAppLogin",JSON.stringify({isLoggedIn:!0,userRole:m.role})),o(""),s({username:"",password:""}),await qa()):o("Invalid username or password")},Ql=async()=>{if(!O.currentPassword||!O.newPassword||!O.confirmPassword){w("Please fill all fields");return}const m=r==="director"?"director":"finance";if(y[m]!==O.currentPassword){w("Current password is incorrect");return}if(O.newPassword!==O.confirmPassword){w("New passwords do not match");return}if(O.newPassword.length<6){w("Password must be at least 6 characters");return}const C={...y,[m]:O.newPassword};x(C);try{await eg("indreesh-media",{masterData:ge,ledgerEntries:Se,receipts:Q,creditNotes:Be,openingBalances:ti,mailerImages:wt,mailerLogo:gn,companyConfig:S,nextInvoiceNo:Y,nextCombineNo:Ae,nextReceiptNo:ke,nextCreditNoteNo:it,invoiceValues:gs,notifications:Ci,whatsappSettings:ne,partyMaster:yn,followups:ms,userPasswords:C}),console.log("Password saved to Firebase")}catch(X){console.error("Error saving password:",X),w("Failed to save password. Please try again.");return}_(!1),H({currentPassword:"",newPassword:"",confirmPassword:""}),w(""),alert(" Password changed successfully!")},Yp=()=>{Au(),e(!1),n(null),P("master"),localStorage.removeItem("financeAppLogin")};ve.useEffect(()=>{const m=localStorage.getItem("financeAppLogin");if(m){const{isLoggedIn:C}=JSON.parse(m);C&&qa()}},[]),ve.useEffect(()=>{if(!t){bi.current&&(bi.current(),bi.current=null);return}return bi.current=IW("indreesh-media",m=>{m&&(Qo.current=!0,Array.isArray(m.masterData)&&be(m.masterData),Array.isArray(m.ledgerEntries)&&ye(m.ledgerEntries),Array.isArray(m.receipts)&&Ce(m.receipts),Array.isArray(m.creditNotes)&&V(m.creditNotes),Array.isArray(m.notifications)&&mn(m.notifications),Array.isArray(m.followups)&&I(m.followups),m.openingBalances&&typeof m.openingBalances=="object"&&!Array.isArray(m.openingBalances)&&Yo(m.openingBalances),m.mailerImages&&typeof m.mailerImages=="object"&&!Array.isArray(m.mailerImages)&&ei(m.mailerImages),m.partyMaster&&typeof m.partyMaster=="object"&&!Array.isArray(m.partyMaster)&&Xi(m.partyMaster),m.userPasswords&&typeof m.userPasswords=="object"&&!Array.isArray(m.userPasswords)&&x(m.userPasswords),m.mailerLogo&&Fi(m.mailerLogo),m.companyConfig&&b(C=>({...C,...m.companyConfig,name:"Indreesh Media LLP",bank:{...m.companyConfig.bank||C.bank,holder:"Indreesh Media LLP"}})),m.nextInvoiceNo&&de(m.nextInvoiceNo),m.nextCombineNo&&Pe(m.nextCombineNo),m.nextReceiptNo&&we(m.nextReceiptNo),m.nextCreditNoteNo&&K(m.nextCreditNoteNo),m.invoiceValues&&Kl(m.invoiceValues),m.whatsappSettings&&oe(C=>({...C,...m.whatsappSettings})),setTimeout(()=>{Qo.current=!1},500),console.log("Real-time sync: Data updated from Firebase"))}),()=>{bi.current&&(bi.current(),bi.current=null)}},[t]);const Ut=r==="finance",On=r==="director",Qa=ve.useMemo(()=>{const m=new Set;return sn.forEach(C=>{C.partyName&&m.add(C.partyName)}),Object.values(tr).forEach(C=>{C.partyName&&m.add(C.partyName)}),xi.forEach(C=>{C.partyName&&m.add(C.partyName)}),Object.keys(Ka).forEach(C=>{C&&m.add(C)}),Array.from(m).filter(Boolean).sort()},[sn,tr,xi,Ka]),pa=ve.useMemo(()=>{const m=[],C=new Set,X=re=>{if(!re)return"";const R=re.toUpperCase().trim();return R.includes("MAHARASHTRA")||R==="MH"||R.includes("MUMBAI")?"MAHARASHTRA":R.includes("DELHI")||R==="DL"||R.includes("NEW DELHI")?"DELHI":R.includes("KARNATAKA")||R==="KA"||R.includes("BANGALORE")||R.includes("BENGALURU")?"KARNATAKA":R.includes("TAMIL")||R==="TN"||R.includes("CHENNAI")?"TAMIL NADU":R.includes("TELANGANA")||R==="TG"||R==="TS"||R.includes("HYDERABAD")?"TELANGANA":R.includes("UTTAR PRADESH")||R==="UP"||R.includes("NOIDA")||R.includes("LUCKNOW")?"UTTAR PRADESH":R.includes("WEST BENGAL")||R==="WB"||R.includes("KOLKATA")?"WEST BENGAL":R.includes("GUJARAT")||R==="GJ"||R.includes("AHMEDABAD")?"GUJARAT":R.includes("RAJASTHAN")||R==="RJ"||R.includes("JAIPUR")?"RAJASTHAN":R.includes("PUNJAB")||R==="PB"?"PUNJAB":R.includes("HARYANA")||R==="HR"||R.includes("GURGAON")||R.includes("GURUGRAM")?"HARYANA":R.includes("MADHYA PRADESH")||R==="MP"||R.includes("BHOPAL")?"MADHYA PRADESH":R.includes("ANDHRA")||R==="AP"?"ANDHRA PRADESH":R.includes("KERALA")||R==="KL"?"KERALA":R.includes("ODISHA")||R.includes("ORISSA")||R==="OR"||R==="OD"?"ODISHA":R.includes("BIHAR")||R==="BR"?"BIHAR":R.includes("JHARKHAND")||R==="JH"?"JHARKHAND":R.includes("ASSAM")||R==="AS"?"ASSAM":R.includes("CHHATTISGARH")||R==="CG"?"CHHATTISGARH":R.includes("GOA")||R==="GA"?"GOA":R.includes("HIMACHAL")||R==="HP"?"HIMACHAL PRADESH":R.includes("JAMMU")||R==="JK"?"JAMMU AND KASHMIR":R.includes("UTTARAKHAND")||R.includes("UTTARANCHAL")||R==="UK"?"UTTARAKHAND":R.includes("CHANDIGARH")?"CHANDIGARH":R},Z=(re,R)=>`${(re||"").trim().toUpperCase()}|${R}`,J=(re,R)=>{var Te;if(!re)return"";const pe=re.trim().toUpperCase(),Re=X(R),ue=`${pe}|${Re}`;if((Te=tr[ue])!=null&&Te.gstin)return tr[ue].gstin;for(const He in tr){const ee=tr[He];if((ee.partyName||"").trim().toUpperCase()===pe&&ee.normalizedState===Re)return ee.gstin||""}for(const He in tr){const ee=tr[He];if((ee.partyName||"").trim().toUpperCase()===pe&&ee.gstin)return ee.gstin}return""};return Object.entries(tr).forEach(([re,R])=>{if(R.partyName){const pe=R.normalizedState||X(R.stateName),Re=Z(R.partyName,pe);C.has(Re)||(C.add(Re),m.push({partyName:R.partyName,partyNameUpper:R.partyName.trim().toUpperCase(),state:R.stateName||"",normalizedState:pe,gstin:R.gstin||"",fromPartyMaster:!0}))}}),sn.forEach(re=>{if(re.partyName){const R=X(re.statePartyDetails),pe=Z(re.partyName,R);if(!C.has(pe)){C.add(pe);const Re=J(re.partyName,re.statePartyDetails);m.push({partyName:re.partyName,partyNameUpper:re.partyName.trim().toUpperCase(),state:re.statePartyDetails||"",normalizedState:R,gstin:Re,fromPartyMaster:!1})}}}),xi.forEach(re=>{if(re.partyName){const R=X(re.state||re.statePartyDetails||""),pe=Z(re.partyName,R);if(!C.has(pe)){C.add(pe);const Re=J(re.partyName,re.state||re.statePartyDetails);m.push({partyName:re.partyName,partyNameUpper:re.partyName.trim().toUpperCase(),state:re.state||re.statePartyDetails||"",normalizedState:R,gstin:Re,fromPartyMaster:!1})}}}),Object.keys(Ka).forEach(re=>{const R=re.trim().toUpperCase()+"|";re&&!Array.from(C).some(pe=>pe.startsWith(R))&&m.push({partyName:re,partyNameUpper:re.trim().toUpperCase(),state:"",normalizedState:"",gstin:"",fromPartyMaster:!1})}),m.sort((re,R)=>re.partyName.localeCompare(R.partyName))},[sn,tr,xi,Ka]);ve.useMemo(()=>[...new Set(sn.filter(C=>C.combinationCode&&C.combinationCode!=="NA").map(C=>C.combinationCode))].sort((C,X)=>parseInt(C)-parseInt(X)),[sn]);const Jl=ve.useMemo(()=>sn.filter(m=>{var C,X,Z,J,re,R;if(Xe.party&&m.partyName!==Xe.party||Xe.billStatus&&m.toBeBilled!==Xe.billStatus||Xe.invoiceStatus&&(Xe.invoiceStatus==="Generated"&&!m.invoiceGenerated||Xe.invoiceStatus==="Not Generated"&&m.invoiceGenerated||Xe.invoiceStatus==="Paid"&&m.invoiceStatus!=="Paid")||Xe.mailingStatus&&m.mailingSent!==Xe.mailingStatus||Xe.invoiceType&&m.invoiceType!==Xe.invoiceType||Xe.combinationCode&&m.combinationCode!==Xe.combinationCode)return!1;if(Xe.searchText){const pe=Xe.searchText.toLowerCase();if(!(((C=m.senderName)==null?void 0:C.toLowerCase().includes(pe))||((X=m.subject)==null?void 0:X.toLowerCase().includes(pe))||((Z=m.campaignName)==null?void 0:Z.toLowerCase().includes(pe))||((J=m.invoiceNo)==null?void 0:J.toLowerCase().includes(pe))||((re=m.partyName)==null?void 0:re.toLowerCase().includes(pe))||((R=m.emailId)==null?void 0:R.toLowerCase().includes(pe))))return!1}return!0}),[sn,Xe]);ve.useMemo(()=>{const m={};return Jl.forEach(C=>{m[C.partyName]||(m[C.partyName]=[]),m[C.partyName].push(C)}),Object.keys(m).forEach(C=>{m[C].sort((X,Z)=>X.toBeBilled==="Yes"&&Z.toBeBilled!=="Yes"?-1:X.toBeBilled!=="Yes"&&Z.toBeBilled==="Yes"?1:0)}),m},[Jl]),ve.useMemo(()=>{if(!G)return[];const m=Ka[G]||0;let C=m;const X=xi.filter(Z=>Er(Z.partyName,G)).sort((Z,J)=>new Date(Z.date)-new Date(J.date)).map(Z=>(C=C+Z.debit-Z.credit,{...Z,balance:C}));return m!==0?[{id:"opening",date:"",particulars:"Opening Balance",debit:m>0?m:0,credit:m<0?Math.abs(m):0,balance:m,isOpening:!0},...X]:X},[G,xi,Ka]);const Zl=m=>sn.filter(C=>Er(C.partyName,m)&&C.toBeBilled==="Yes"&&!C.invoiceGenerated&&C.invoiceAmount),qp=m=>!m||m==="NA"?!1:sn.some(C=>C.combinationCode===m&&C.mailingSent==="Yes"),js=m=>m.invoiceType==="Combined"&&m.combinationCode!=="NA"?sn.filter(C=>C.combinationCode===m.combinationCode):[m],Jo=()=>{Ls({party:"",billStatus:"",invoiceStatus:"",mailingStatus:"",invoiceType:"",combinationCode:"",searchText:""})},ec=Object.values(Xe).some(m=>m!==""),Ja=m=>{const C=[];return m.emailId&&C.push(m.emailId),m.additionalEmails&&m.additionalEmails.length>0&&C.push(...m.additionalEmails),C},Cu=(m,C)=>{!C||!C.includes("@")||be(X=>X.map(Z=>{if(Z.id===m){const J=Z.additionalEmails||[];if(!J.includes(C)&&C!==Z.emailId)return{...Z,additionalEmails:[...J,C]}}return Z}))},Fu=(m,C)=>{be(X=>X.map(Z=>Z.id===m?{...Z,additionalEmails:(Z.additionalEmails||[]).filter(J=>J!==C)}:Z))},G0=m=>{zr(m),Gi(m.editComments||m.approvalRemarks||""),Ie({particularsApproved:m.particularsApproved||!1,emailApproved:m.emailApproved||!1,invoiceTypeApproved:m.invoiceTypeApproved||!1}),Pt(!0)},tc=()=>{if(!ae)return;if(!Ge.particularsApproved||!Ge.emailApproved||!Ge.invoiceTypeApproved){alert("Please confirm all approval checkboxes before approving.");return}const m={invoiceStatus:"Approved",approvalRemarks:ki.trim()||"",editComments:"",particularsApproved:!0,emailApproved:!0,invoiceTypeApproved:!0,approvedBy:r,approvedDate:new Date().toISOString()};let C=[];ae.invoiceType==="Combined"&&ae.combinationCode!=="NA"?(C=ge.filter(R=>R.combinationCode===ae.combinationCode),be(R=>R.map(pe=>pe.combinationCode===ae.combinationCode?{...pe,...m}:pe))):(C=[ae],be(R=>R.map(pe=>pe.id===ae.id?{...pe,...m}:pe)));const X=parseFloat(ae.invoiceTotalAmount)||0,Z=C.map(R=>{var pe,Re;return R.senderName||((Re=(pe=R.campaignName)==null?void 0:pe.split("--")[0])==null?void 0:Re.trim())}).join(", "),J=`${ae.invoiceNo} - ${Z}`;ye(R=>[...R,{id:Date.now(),partyName:ae.partyName,date:ae.invoiceDate,particulars:"Promotional Trade Mailer",narration:J,debit:X,credit:0,type:"invoice",invoiceNo:ae.invoiceNo,combinationCode:ae.combinationCode}]);const re=ki.trim()?` | Remarks: "${ki.trim()}"`:"";Bs("approval",` Invoice ${ae.invoiceNo} has been APPROVED by Director${re} - ready for mailing`,"finance"),Pt(!1),zr(null),Ie({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1}),Gi(""),alert(` Invoice Approved!

The invoice is now ready for mailing.`)},K0=()=>{if(!ae)return;const m=ki.trim();ae.invoiceType==="Combined"&&ae.combinationCode!=="NA"?be(X=>X.map(Z=>Z.combinationCode===ae.combinationCode?{...Z,invoiceStatus:"Need Edits",editComments:m,approvalRemarks:""}:Z)):be(X=>X.map(Z=>Z.id===ae.id?{...Z,invoiceStatus:"Need Edits",editComments:m,approvalRemarks:""}:Z));const C=m?`: "${m}"`:"";Bs("edit",` Invoice ${ae.invoiceNo} marked as NEED EDITS by Director${C}`,"finance"),Pt(!1),zr(null),Gi("")},Iu=m=>{zr(m);const C=parseFloat(m.invoiceTotalAmount)||0;ce({amount:C.toFixed(2),tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),ct(!0)},ma=()=>{if(!ae||!te.amount){alert("Please enter receipt amount");return}if(ae.invoiceStatus!=="Approved"){alert("Receipt cannot be posted. Invoice must be approved first.");return}if(!ae.isHistorical&&ae.mailingSent!=="Yes"){alert("Receipt cannot be posted. Invoice must be mailed first.");return}const m=`RCP/${new Date().getFullYear()}-${String(new Date().getFullYear()+1).slice(-2)}/${ke}`,C=parseFloat(te.amount)||0,X=parseFloat(te.tds)||0,Z=parseFloat(te.discount)||0,J=C+X+Z,re=js(ae),R=re.map(Le=>Le.subject||Le.senderName).join(", "),pe=R.length>50?R.substring(0,47)+"...":R,Re={id:Date.now(),receiptNo:m,invoiceNo:ae.invoiceNo,partyName:ae.partyName,date:te.date,amount:C,tds:X,discount:Z,totalCredit:J,narration:te.narration,paymentAdvisory:te.paymentAdvisory,mode:te.mode,campaigns:re.map(Le=>({senderName:Le.senderName,subject:Le.subject}))};Ce(Le=>[...Le,Re]);const ue=te.narration||pe;C>0&&ye(Le=>[...Le,{id:Date.now(),partyName:ae.partyName,date:te.date,particulars:`Payment Received - ${ue}`,narration:`${ae.invoiceNo} | ${te.mode}`,debit:0,credit:C,type:"receipt",receiptNo:m,invoiceNo:ae.invoiceNo,paymentAdvisory:te.paymentAdvisory}]),X>0&&ye(Le=>[...Le,{id:Date.now()+1,partyName:ae.partyName,date:te.date,particulars:"TDS Deducted",narration:`Against ${ae.invoiceNo}`,debit:0,credit:X,type:"tds",receiptNo:m,invoiceNo:ae.invoiceNo}]),Z>0&&ye(Le=>[...Le,{id:Date.now()+2,partyName:ae.partyName,date:te.date,particulars:"Discount Given",narration:`Against ${ae.invoiceNo}`,debit:0,credit:Z,type:"discount",receiptNo:m,invoiceNo:ae.invoiceNo}]);const Te=parseFloat(ae.invoiceTotalAmount)||0,He=Be.find(Le=>Le.invoiceNo===ae.invoiceNo),ee=He?Math.abs(parseFloat(He.totalAmount)||0):0,fe=Te-J-ee<=0;ae.invoiceType==="Combined"&&ae.combinationCode!=="NA"?be(Le=>Le.map(Qe=>Qe.combinationCode===ae.combinationCode?{...Qe,receiptStatus:fe?"Closed":"Received",receiptNo:m,receiptDate:te.date}:Qe)):ae.isHistorical||be(Le=>Le.map(Qe=>Qe.id===ae.id?{...Qe,receiptStatus:fe?"Closed":"Received",receiptNo:m,receiptDate:te.date}:Qe)),we(Le=>Le+1),Bs("receipt",` Payment received for ${ae.partyName} - Receipt ${m} - ${ut(J)}`,"director"),ct(!1),zr(null),ce({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),alert(` Receipt Created!

Receipt No: ${m}
Amount: ${ut(J)}`)},bu=m=>{zr(m),Me({amount:"",tds:"",discount:"",reason:"",date:new Date().toISOString().split("T")[0]}),yr(!0)},X0=()=>{var Le;if(!ae||!xe.amount&&!xe.gst||!xe.reason){alert("Please enter Amount and/or GST and reason");return}const m=ae.invoiceNo.match(/(\d{4}-\d{2})/),C=m?m[1]:`${new Date().getFullYear()}-${String(new Date().getFullYear()+1).slice(-2)}`,X=ae.invoiceNo.split("/").pop(),Z=`CN/${C}/${X}`,J=parseFloat(xe.amount)||0,re=parseFloat(xe.gst)||0,R=J+re,Re=((Le=ae.statePartyDetails)==null?void 0:Le.toUpperCase().includes("MAHARASHTRA"))?"CGST/SGST":"IGST",ue={id:Date.now(),creditNoteNo:Z,invoiceNo:ae.invoiceNo,partyName:ae.partyName,date:xe.date,amount:J,gst:re,gstType:Re,totalAmount:R,reason:xe.reason};V(Qe=>[...Qe,ue]);const Te=parseFloat(ae.invoiceTotalAmount)||0,He=Q.find(Qe=>Qe.invoiceNo===ae.invoiceNo),ee=He?parseFloat(He.amount)+parseFloat(He.tds||0)+parseFloat(He.discount||0):0,Ke=R>=Te-ee;ae.isHistorical||be(Qe=>Qe.map(Ne=>Ne.invoiceNo===ae.invoiceNo?{...Ne,creditNoteNo:Z,receiptStatus:Ke?"Cancelled":Ne.receiptStatus}:Ne)),K(Qe=>Qe+1),yr(!1),zr(null),Me({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]});let fe=` Credit Note Created!

Credit Note No: ${Z}`;J>0&&(fe+=`
Base Amount: ${ut(J)}`),re>0&&(fe+=`
${Re}: ${ut(re)}`),fe+=`
Total: ${ut(R)}`,Ke&&(fe+=`

 Invoice fully covered by CN - marked as Cancelled`),alert(fe)},Y0=m=>{var Z;const C=(Z=m.target.files)==null?void 0:Z[0];if(!C)return;const X=new FileReader;X.onload=J=>{ce(re=>({...re,paymentAdvisory:J.target.result}))},X.readAsDataURL(C),m.target.value=""},rc=m=>{zr(m),nr(!0)},nc=()=>{if(!ae)return;const m=ae.invoiceNo;ae.invoiceType==="Combined"&&ae.combinationCode!=="NA"?be(Z=>Z.map(J=>J.combinationCode===ae.combinationCode?{...J,invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",invoiceType:"Individual",combinationCode:"NA",mailingSent:"No",mailDate:"",editComments:"",receiptStatus:"",receiptNo:"",receiptDate:""}:J)):be(Z=>Z.map(J=>J.id===ae.id?{...J,invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",invoiceType:"Individual",combinationCode:"NA",mailingSent:"No",mailDate:"",editComments:"",receiptStatus:"",receiptNo:"",receiptDate:""}:J)),ye(Z=>Z.filter(J=>J.invoiceNo!==m));const C=Q.filter(Z=>Z.invoiceNo===m);C.length>0&&Ce(Z=>Z.filter(J=>J.invoiceNo!==m)),nr(!1),zr(null);const X=C.length>0?`
${C.length} receipt(s) also deleted.`:"";alert(` Invoice ${m} deleted.${X}

You can now regenerate the invoice.`)},ri=m=>{confirm(`Delete Receipt ${m.receiptNo}?

This will also update the invoice status back to Pending.`)&&(Ce(C=>C.filter(X=>X.id!==m.id)),be(C=>C.map(X=>X.invoiceNo===m.invoiceNo?{...X,receiptStatus:"",receiptNo:"",receiptDate:""}:X)),alert(` Receipt ${m.receiptNo} deleted.`))},q0=m=>{confirm(`Delete Credit Note ${m.creditNoteNo}?

This will remove the CN association from the invoice.`)&&(V(C=>C.filter(X=>X.id!==m.id)),be(C=>C.map(X=>X.invoiceNo===m.invoiceNo?{...X,creditNoteNo:""}:X)),alert(` Credit Note ${m.creditNoteNo} deleted.`))},Q0=m=>{confirm(`Delete historical entry?

Vch No: ${m.vchNo||"N/A"}
Amount: ${m.debit||m.credit}

This action cannot be undone.`)&&(ye(C=>C.filter(X=>X.id!==m.id)),alert(" Historical entry deleted."))},Za=()=>{if(!G||!confirm(`Delete ALL historical entries for "${G}"?

This will remove all imported historical data for this party.`))return;const m=Se.filter(C=>Er(C.partyName,G)&&C.isHistorical).length;ye(C=>C.filter(X=>!(Er(X.partyName,G)&&X.isHistorical))),alert(` ${m} historical entries deleted for ${G}.`)},u=m=>{W(m),le({date:new Date().toISOString().split("T")[0],notes:"",nextFollowupDate:"",status:"Pending"}),B(!0)},v=()=>{var C,X;if(!L)return;const m={id:Date.now(),invoiceNo:L.invoiceNo,partyName:L.partyName,invoiceDate:L.invoiceDate||L.date,invoiceAmount:L.invoiceTotalAmount||L.totalAmount,subject:((X=(C=L.campaigns)==null?void 0:C[0])==null?void 0:X.subject)||L.subject||"",followupDate:U.date,notes:U.notes,nextFollowupDate:U.nextFollowupDate,status:U.status};I(Z=>[...Z,m]),B(!1),W(null),Bs("followup",`Followup added for ${L.invoiceNo}`,"all"),alert(` Followup recorded for ${L.invoiceNo}`)},k=m=>{confirm("Delete this followup entry?")&&I(C=>C.filter(X=>X.id!==m))},M=m=>{var pe,Re;const C=m.subject||((Re=(pe=m.campaigns)==null?void 0:pe[0])==null?void 0:Re.subject)||"",X=m.partyName,Z=m.invoiceNo,J=ut(m.invoiceTotalAmount||m.totalAmount||0),re=mr(m.invoiceDate||m.date);return`Subject: RE: ${C} - Payment Followup for Invoice ${Z}

Dear Sir/Madam,

Greetings from ${S.name}!

This is a gentle reminder regarding the outstanding payment for:

Invoice No: ${Z}
Invoice Date: ${re}
Amount: ${J}
Party: ${X}

We kindly request you to process the payment at the earliest. If the payment has already been made, please share the payment details for our records.

For any queries, please feel free to reach out.

Thanks & Regards,
Finance Team
${S.name}
Email: ${S.email}
Phone: ${S.phone}`},se=m=>{const C=M(m);navigator.clipboard.writeText(C),alert(" Followup email template copied to clipboard!")},he=m=>{var Z,J;const C=m.subject||((J=(Z=m.campaigns)==null?void 0:Z[0])==null?void 0:J.subject)||"",X=encodeURIComponent(C);window.open(`https://mail.google.com/mail/u/0/#search/${X}`,"_blank")},Ue=m=>{var Z;const C=(Z=m.target.files)==null?void 0:Z[0];if(!C)return;const X=new FileReader;X.onload=J=>{const re=Fc(J.target.result,{type:"binary"}),R=re.SheetNames[0],pe=re.Sheets[R],Re=Ni.sheet_to_json(pe),ue={};Re.forEach(Te=>{const He=Te["Party Name"]||Te["PARTY NAME"]||Te.PartyName||"",ee=parseFloat(Te.Amount||Te.AMOUNT||Te["Invoice Amount"]||0);He&&ee>0&&(ue[He.trim()]=ee)}),Kl(Te=>({...Te,...ue})),alert(` Loaded ${Object.keys(ue).length} party invoice values!`)},X.readAsBinaryString(C),m.target.value=""},Wt=()=>{const m=Ni.json_to_sheet([{"Party Name":"ABC Group Private Limited",Amount:5500},{"Party Name":"XYZ Media Pvt Ltd",Amount:7500}]),C=Ni.book_new();Ni.book_append_sheet(C,m,"Invoice Values"),Lm(C,"Invoice_Values_Template.xlsx")},qr=m=>{var Z;const C=(Z=m.target.files)==null?void 0:Z[0];if(!C)return;const X=new FileReader;X.onload=J=>{const re=Fc(J.target.result,{type:"binary"}),R=re.SheetNames[0],pe=re.Sheets[R],Re=Ni.sheet_to_json(pe),ue={...yn};let Te=0;Re.forEach(He=>{const ee=(He["Name of Ledger"]||He["Party Name"]||He["NAME OF LEDGER"]||He["PARTY NAME"]||"").trim(),Ke=(He["State Name"]||He["STATE NAME"]||He.State||He.STATE||"").trim();if(ee){const fe=Xa(Ke),Le=`${ee.toUpperCase()}|${fe}`;ue[Le]={partyName:ee,partyNameUpper:ee.toUpperCase(),ledgerGroup:He["Ledger Group"]||He["LEDGER GROUP"]||"Sundry Debtors",stateName:Ke,normalizedState:fe,gstRegType:He["GST Registration Type"]||He["GST REGISTRATION TYPE"]||"Regular",gstin:(He["GSTIN/UIN"]||He.GSTIN||He.GST||"").trim()},Te++}}),Xi(ue),alert(` Party Master Updated!

${Te} party-state combinations loaded.`)},X.readAsBinaryString(C),m.target.value=""},Ft=()=>{const m=Ni.json_to_sheet([{"Sl. No.":1,"Name of Ledger":"ABC PRIVATE LIMITED","Ledger Group":"Sundry Debtors","State Name":"Maharashtra","GST Registration Type":"Regular","GSTIN/UIN":"27AAACA1234A1ZQ"},{"Sl. No.":2,"Name of Ledger":"XYZ MEDIA PVT LTD","Ledger Group":"Sundry Debtors","State Name":"Delhi","GST Registration Type":"Regular","GSTIN/UIN":"07AAACX5678B1ZR"}]),C=Ni.book_new();Ni.book_append_sheet(C,m,"Party Master"),Lm(C,"Party_Master_Template.xlsx")},an=m=>{var Z;const C=(Z=m.target.files)==null?void 0:Z[0];if(!C)return;if(!G){alert(" Please select a party first from the list, then import their historical ledger."),m.target.value="";return}const X=new FileReader;X.onload=J=>{const re=Fc(J.target.result,{type:"binary",cellDates:!0}),R=re.SheetNames[0],pe=re.Sheets[R],Re=Ni.sheet_to_json(pe,{raw:!1}),ue=[];let Te=0,He=null;const ee=fe=>{if(!fe)return 0;const Le=String(fe).replace(/,/g,"").replace(/[^\d.-]/g,"");return parseFloat(Le)||0},Ke=fe=>{if(!fe||typeof fe!="string")return"";const Le=fe.trim(),Qe=Le.split(/[-\/]/);if(Qe.length===3){const Ne={jan:"01",feb:"02",mar:"03",apr:"04",may:"05",jun:"06",jul:"07",aug:"08",sep:"09",oct:"10",nov:"11",dec:"12"},Je=Qe[1].toLowerCase().substring(0,3);if(Ne[Je]){const Ot=Qe[0].padStart(2,"0");return`${Qe[2].length===2?parseInt(Qe[2])>50?"19"+Qe[2]:"20"+Qe[2]:Qe[2]}-${Ne[Je]}-${Ot}`}}return Le};Re.forEach((fe,Le)=>{const Qe=Ke(fe.Date||fe.DATE||fe.date||""),Ne=(fe.Particular||fe.PARTICULAR||fe.Particulars||fe.PARTICULARS||"").trim(),Je=(fe["Vch Type"]||fe["VCH TYPE"]||fe["Voucher Type"]||fe["vch type"]||"").trim(),Ot=(fe["Vch No."]||fe["VCH NO."]||fe["Voucher No"]||fe["Invoice No"]||fe["Vch No"]||fe["vch no."]||"").trim(),jt=ee(fe.Debit||fe.DEBIT||fe.debit),zt=ee(fe.Credit||fe.CREDIT||fe.credit),_n=fe["Date of Receipt"]||fe["DATE OF RECEIPT"]||fe["Receipt Date"]||"",Wr=ee(fe["Amount Received"]||fe["AMOUNT RECEIVED"]||fe["amount received"]),_e=ee(fe["TDS amount Received"]||fe["TDS Received"]||fe.TDS||fe.tds),ie=ee(fe.Balance||fe.BALANCE||fe.balance),rt=(fe["Payment Status"]||fe["PAYMENT STATUS"]||fe.Status||fe.status||"").trim();if(!Qe&&(Ne.toUpperCase().includes("PROMOTIONAL")||Ne.toUpperCase().includes("IGST")||Ne.toUpperCase().includes("CGST")||Ne.toUpperCase().includes("SGST")||Ne.toUpperCase().includes("TRADE EMAILER"))&&He)He.subRows||(He.subRows=[]),He.subRows.push({particular:Ne,debit:jt,credit:zt});else if(Qe&&(Ot||jt>0||zt>0)){He&&(ue.push(He),Te++);let Qt="invoice";Je.toLowerCase().includes("credit note")||Ot.toUpperCase().startsWith("CN")?Qt="creditnote":Je.toLowerCase().includes("receipt")?Qt="receipt":(Je.toLowerCase().includes("sale")||jt>0)&&(Qt="invoice"),He={id:Date.now()+Le,partyName:G,date:Qe,particulars:Ne||G,narration:Ot,vchType:Je||"Sales",vchNo:Ot,debit:jt,credit:zt,receiptDate:_n,amountReceived:Wr,tdsReceived:_e,balance:ie,paymentStatus:rt,type:Qt,isHistorical:!0,subRows:[]}}}),He&&(ue.push(He),Te++),console.log("Parsed entries with sub-rows:",ue),Te>0?(ye(fe=>[...fe,...ue]),alert(` Historical Ledger Uploaded!

${Te} entries added for "${G}".`)):alert(` No valid ledger entries found in the file.

Make sure your file has these columns:
 Date (e.g., 02-Jun-21)
 Vch Type (e.g., Sales, Credit Note)
 Vch No. (e.g., MB/2022-23/128)
 Debit or Credit amount`)},X.readAsBinaryString(C),m.target.value="",da(!1)},on=()=>{const m=Ni.json_to_sheet([{Date:"02-Jun-21",Particular:"ABC Corp Ltd.","Vch Type":"Sales","Vch No.":"MB/2020-21/0411",Debit:6e3,Credit:"","Date of Receipt":"","Amount Received":44371,"TDS amount Received":5880,Balance:"","Payment Status":"Received"},{Date:"",Particular:"PROMOTIONAL TRADE EMAILERS","Vch Type":"","Vch No.":"",Debit:"",Credit:22500,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""},{Date:"",Particular:"IGST","Vch Type":"","Vch No.":"",Debit:"",Credit:4050,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""},{Date:"26-Mar-25",Particular:"ABC Corp Ltd.","Vch Type":"Credit Note","Vch No.":"CN/2022-23/128",Debit:"",Credit:26550,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""}]),C=Ni.book_new();Ni.book_append_sheet(C,m,"Historical Ledger"),Lm(C,"Historical_Ledger_Template.xlsx")},eo=m=>{const C=ge.find(X=>X.invoiceNo===m);C?Nu(C):alert("Invoice not found in system. This may be a historical entry.")},Ri=m=>{ge.find(X=>X.invoiceNo===m.invoiceNo);let C=` RECEIPT DETAILS

`;C+=`Receipt No: ${m.receiptNo}
`,C+=`Date: ${mr(m.date)}
`,C+=`Party: ${m.partyName}
`,C+=`Invoice: ${m.invoiceNo}

`,C+=`
`,C+=`Amount Received: ${ut(m.amount||0)}
`,C+=`TDS: ${ut(m.tds||0)}
`,C+=`Discount: ${ut(m.discount||0)}
`,C+=`
`,C+=`Total: ${ut((m.amount||0)+(m.tds||0)+(m.discount||0))}
`,m.remarks&&(C+=`
Remarks: ${m.remarks}`),alert(C)},ic=m=>{let C=` CREDIT NOTE DETAILS

`;C+=`Credit Note No: ${m.creditNoteNo}
`,C+=`Date: ${mr(m.date)}
`,C+=`Party: ${m.partyName}
`,C+=`Against Invoice: ${m.invoiceNo}

`,C+=`
`,C+=`Base Amount: ${ut(m.amount||0)}
`,C+=`${m.gstType||"GST"}: ${ut(m.gst||0)}
`,C+=`
`,C+=`Total Credit: ${ut(m.totalAmount||(m.amount||0)+(m.gst||0))}
`,m.reason&&(C+=`
Reason: ${m.reason}`),alert(C)},Ru=m=>{var Z;const C=(Z=m.target.files)==null?void 0:Z[0];if(!C)return;const X=new FileReader;X.onload=J=>{const re=Fc(J.target.result,{type:"binary",cellDates:!0}),R=re.SheetNames[0],pe=re.Sheets[R],Re=Ni.sheet_to_json(pe,{raw:!1}),ue=new Set(sn.map(fe=>`${fe.date}|${fe.time||""}|${fe.campaignName||""}|${fe.subject}`.toLowerCase()));let Te=0,He=0;const ee=Re.map((fe,Le)=>{const Qe=fe["CAMPAIGN NAME"]||fe["Campaign Name"]||"",Ne=NW(Qe);let Je=fe.DATE||fe.Date||new Date;typeof Je=="string"&&(Je=new Date(Je));const Ot=(fe["PARTY NAME"]||fe["Party Name"]||"").trim(),jt=fe["SENDER NAME"]||fe["Sender Name"]||"",zt=fe.SUBJECT||fe.Subject||"",_n=fe.TIME||fe.Time||"",Wr=gs[Ot]||"",_e=Je instanceof Date&&!isNaN(Je)?Je.toISOString().split("T")[0]:"",ie=`${_e}|${_n}|${Qe}|${zt}`.toLowerCase();return ue.has(ie)?(Te++,null):(ue.add(ie),He++,{id:Date.now()+Le+Math.random(),sno:fe.SNO||fe["SNO."]||fe.Sno||Le+1,date:_e,month:fe.Month||fe.MONTH||"",statePartyDetails:fe["State/Party Details"]||fe["STATE/PARTY DETAILS"]||"",partyName:Ot,senderName:jt,campaignName:Qe,subject:zt,emailId:Ne,additionalEmails:[],toBeBilled:"Not Yet",invoiceAmount:Wr,cgst:"",sgst:"",igst:"",totalWithGst:"",invoiceType:"Individual",combinationCode:"NA",invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",mailingSent:"No",mailerUploaded:!1,editComments:""})}).filter(fe=>fe!==null);if(ee.length>0){be(Le=>[...Le,...ee]);const fe=[...new Set(ee.map(Le=>Le.partyName))];Xl(Le=>{const Qe=new Set(Le);return fe.forEach(Ne=>Qe.add(Ne)),Qe})}let Ke=` Upload Complete!

`;Ke+=` ${He} new campaigns added
`,Te>0&&(Ke+=` ${Te} duplicate entries skipped`),He>0&&Bs("upload",` ${He} new campaigns uploaded to Master Sheet`,"director"),alert(Ke)},X.readAsBinaryString(C),m.target.value=""},D4=async()=>{be([]),ye([]),Ce([]),V([]),ei({}),Yo({}),de(1),Pe(1),we(1),K(1),q(null),Xl(new Set),I([]),Xi({}),mn([]);try{await eg("indreesh-media",{masterData:[],ledgerEntries:[],receipts:[],creditNotes:[],openingBalances:{},mailerImages:{},mailerLogo:gn,companyConfig:S,nextInvoiceNo:1,nextCombineNo:1,nextReceiptNo:1,nextCreditNoteNo:1,invoiceValues:gs,notifications:[],whatsappSettings:ne,partyMaster:{},followups:[],userPasswords:y}),console.log("Data cleared and saved to Firebase")}catch(m){console.error("Error clearing data:",m)}Dn(!1),alert(" All master data, invoices, receipts, and ledger entries have been cleared!")},ey=m=>{var Z;const C=parseFloat(m.invoiceAmount)||0;if((Z=m.statePartyDetails)==null?void 0:Z.toUpperCase().includes("MAHARASHTRA")){const J=C*.09,re=C*.09;return{cgst:J,sgst:re,igst:0,total:C+J+re}}else{const J=C*.18;return{cgst:0,sgst:0,igst:J,total:C+J}}},P4=(m,C)=>{const X=ge.find(Z=>Z.id===m);be(Z=>Z.map(J=>{if(J.id===m){if(C==="Yes"&&J.invoiceAmount){const re=ey(J);return{...J,toBeBilled:C,cgst:re.cgst.toFixed(2),sgst:re.sgst.toFixed(2),igst:re.igst.toFixed(2),totalWithGst:re.total.toFixed(2)}}return{...J,toBeBilled:C}}return J})),C==="Yes"&&X&&Bs("info",` Campaign marked for billing: ${X.partyName} - ${X.senderName}`,"finance")},J0=(m,C,X)=>{be(Z=>Z.map(J=>{if(J.id===m){const re={...J,[C]:X};if(C==="invoiceAmount"&&J.toBeBilled==="Yes"){const R=ey(re);return{...re,cgst:R.cgst.toFixed(2),sgst:R.sgst.toFixed(2),igst:R.igst.toFixed(2),totalWithGst:R.total.toFixed(2)}}return re}return J}))},O4=m=>{const C=`${S.invoicePrefix}${Y}`,X=new Date().toISOString().split("T")[0],Z=parseFloat(m.totalWithGst)||parseFloat(m.invoiceAmount)*1.18;be(J=>J.map(re=>re.id===m.id?{...re,invoiceNo:C,invoiceDate:X,invoiceTotalAmount:Z.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created",invoiceType:"Individual",combinationCode:"NA"}:re)),de(J=>J+1),Bs("invoice",` New Invoice ${C} created for ${m.partyName} - ${ut(Z)}`,"director"),alert(` Invoice Generated!

Invoice No: ${C}
Amount: ${ut(Z)}

Please review and Approve or mark as Need Edits.`)},M4=()=>{if(Et.size<2){alert("Please select at least 2 campaigns to combine");return}const m=`${S.invoicePrefix}${Y}`,C=new Date().toISOString().split("T")[0],X=String(Ae);let Z=0;const J=ge.filter(re=>Et.has(re.id));J.forEach(re=>{Z+=parseFloat(re.totalWithGst)||parseFloat(re.invoiceAmount)*1.18}),be(re=>re.map(R=>Et.has(R.id)?{...R,invoiceNo:m,invoiceDate:C,invoiceTotalAmount:Z.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created",invoiceType:"Combined",combinationCode:X,mailingSent:"No"}:R)),de(re=>re+1),Pe(re=>re+1),$i(!1),kt(new Set),Bs("invoice",` Combined Invoice ${m} created for ${We} (${J.length} campaigns) - ${ut(Z)}`,"director"),st(null),alert(` Combined Invoice Generated!

Invoice No: ${m}
Campaigns: ${Et.size}
Total: ${ut(Z)}

Please review and Approve or mark as Need Edits.`)},L4=m=>{kt(C=>{const X=new Set(C);return X.has(m)?X.delete(m):X.add(m),X})},B4=m=>{st(m.partyName),kt(new Set([m.id])),$i(!0)},j4=m=>{var Z;const C=(Z=m.target.files)==null?void 0:Z[0];if(!C||!ae)return;const X=new FileReader;X.onload=J=>ty(J.target.result),X.readAsDataURL(C),m.target.value=""},ty=m=>{if(!ae)return;const C=ae.id;ei(vn?X=>({...X,[C]:[m]}):X=>({...X,[C]:[...X[C]||[],m]})),be(X=>X.map(Z=>Z.id===ae.id?{...Z,mailerUploaded:!0}:Z)),Ii(null),Ga(!1),gt(!1),alert(" Mailer image saved!")},V4=m=>{var X;const C=(X=m.clipboardData)==null?void 0:X.items;if(C){for(let Z=0;Z<C.length;Z++)if(C[Z].type.indexOf("image")!==-1){const J=C[Z].getAsFile(),re=new FileReader;re.onload=R=>Ii(R.target.result),re.readAsDataURL(J),m.preventDefault();break}}},U4=m=>{const C=encodeURIComponent(m||"campaign");window.open(`https://mail.google.com/mail/u/0/#search/${C}`,"_blank")},z4=m=>{var Z;const C=(Z=m.target.files)==null?void 0:Z[0];if(!C)return;const X=new FileReader;X.onload=J=>Fi(J.target.result),X.readAsDataURL(C),m.target.value=""},ry=m=>{const C=js(m);if(C.length>1){const X=C.map(Z=>Z.senderName).join(", ");return`Invoice ${m.invoiceNo||""} - ${X}`}return`Invoice ${m.invoiceNo||""} - ${m.senderName} - ${m.subject}`},Z0=m=>{const C=js(m),X=parseFloat(m.invoiceTotalAmount)||parseFloat(m.totalWithGst)||parseFloat(m.invoiceAmount)*1.18;let Z="";return C.length>1?(Z=`Campaigns included in this invoice:
`,C.forEach((J,re)=>{Z+=`${re+1}. ${J.senderName} - ${J.subject}
`})):Z=`Campaign: ${m.senderName}
Subject: ${m.subject}`,`Dear Sir/Madam,

Please find attached the invoice for the following:

${Z}

Invoice No: ${m.invoiceNo||"To be generated"}
Invoice Amount: ${ut(X)}

Kindly process the payment at your earliest convenience.

Bank Details:
Bank: ${S.bank.name}
A/C No: ${S.bank.account}
IFSC: ${S.bank.ifsc}
Branch: ${S.bank.branch}

Thank you for your business.

Best Regards,
${S.name}
${S.email}`},[W4,ny]=ve.useState(!1),[iy,sy]=ve.useState(""),ay=m=>{var Ke;let C=[m],X=parseFloat(m.invoiceAmount)||0;m.invoiceType==="Combined"&&m.combinationCode!=="NA"&&(C=ge.filter(fe=>fe.combinationCode===m.combinationCode),X=C.reduce((fe,Le)=>fe+(parseFloat(Le.invoiceAmount)||0),0));const Z=Ya(m.partyName,m.statePartyDetails),J=(Ke=m.statePartyDetails)==null?void 0:Ke.toUpperCase().includes("MAHARASHTRA"),re=J?X*.09:0,R=J?X*.09:0,pe=J?0:X*.18,Re=re+R+pe,ue=X+Re,Te=C.map((fe,Le)=>`
      <tr>
        <td style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px;">${Le+1}</td>
        <td style="border: 1px solid #000; padding: 8px; font-size: 12px;">
          <div style="font-weight: 600;">PROMOTIONAL TRADE EMAILER</div>
          <div style="font-style: italic; color: #555; font-size: 11px; margin-top: 2px;">${fe.senderName||""} - ${mr(fe.date)}</div>
          <div style="font-style: italic; color: #555; font-size: 11px;">Subject: ${fe.subject||""}</div>
        </td>
        <td style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px;">${S.hsnCode}</td>
        <td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${Vt(parseFloat(fe.invoiceAmount)||0)}</td>
      </tr>
    `).join("");let He=[];m.invoiceType==="Combined"&&m.combinationCode!=="NA"?C.forEach(fe=>{(wt[fe.id]||[]).forEach(Qe=>He.push({img:Qe,campaign:fe}))}):(wt[m.id]||[]).forEach(Le=>He.push({img:Le,campaign:m}));const ee=He.map(({img:fe,campaign:Le})=>`
      <div class="page-break-before" style="page-break-before: always; padding: 40px; text-align: center; background: white;">
        ${gn?`<div style="margin-bottom: 20px;"><img src="${gn}" alt="Logo" style="max-height: 70px;" /></div>`:`
          <div style="text-align: center; margin-bottom: 25px;">
            <span style="font-size: 22px; font-weight: bold; color: #2874A6;">${S.name}</span>
          </div>
        `}
        <h2 style="font-size: 20px; text-decoration: underline; margin: 25px 0;">MAILER SUPPORTING</h2>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>MAILER DATE:</strong> ${bW(Le.date)}</p>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>CAMPAIGN:</strong> ${Le.senderName}</p>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>SUBJECT:</strong> ${Le.subject||"Campaign"}</p>
        <div style="margin-top: 25px;"><img src="${fe}" alt="Mailer" style="max-width: 100%; max-height: 550px; border: 1px solid #ddd;" /></div>
      </div>
    `).join("");return`
  <div style="max-width: 900px; margin: 0 auto; padding: 15px; background: white; font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4;">
    <style>
      @media print {
        @page { size: A4; margin: 8mm; }
        body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        .page-break-before { page-break-before: always; }
      }
    </style>
    <div style="border: 2px solid #000; background: white;">
      <div style="text-align: center; padding: 12px; font-size: 18px; font-weight: bold; border-bottom: 2px solid #000; background: #f8f8f8;">Tax Invoice</div>
      <div style="text-align: center; font-size: 11px; font-style: italic; padding: 5px; border-bottom: 1px solid #000; background: #fafafa;">(Original for Recipient)</div>
      <div style="display: flex; border-bottom: 2px solid #000;">
        <div style="flex: 1.5; padding: 12px; border-right: 2px solid #000;">
          <div style="font-size: 16px; font-weight: bold; margin-bottom: 8px; color: #1a5276;">${S.name}</div>
          <div style="font-size: 11px; line-height: 1.5; color: #333;">${S.address}<br>${S.addressLine2}<br>${S.city}<br><strong>GSTIN/UIN:</strong> ${S.gstin}<br><strong>State:</strong> ${S.stateName}, Code: ${S.stateCode}<br><strong>Contact:</strong> ${S.phone}<br><strong>E-Mail:</strong> ${S.email}</div>
        </div>
        <div style="flex: 1; font-size: 12px;">
          <div style="display: flex; border-bottom: 1px solid #000;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Invoice No.</div><div style="flex: 1; padding: 8px; font-weight: 600; color: #1a5276;">${m.invoiceNo||""}</div></div>
          <div style="display: flex;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Dated</div><div style="flex: 1; padding: 8px;">${mr(m.invoiceDate||m.date)}</div></div>
        </div>
      </div>
      <div style="padding: 10px 12px; border-bottom: 2px solid #000; background: #fafafa;">
        <div style="font-size: 11px; color: #666; margin-bottom: 3px;">Buyer (Bill to)</div>
        <div style="font-size: 14px; font-weight: bold; margin-bottom: 4px; color: #1a5276;">${m.partyName}</div>
        <div style="font-size: 11px; color: #333;">${m.statePartyDetails||""}${Z?"<br><strong>GSTIN/UIN:</strong> "+Z:""}<br>Place of Supply: ${m.statePartyDetails||S.stateName}</div>
      </div>
      <table style="width: 100%; border-collapse: collapse;">
        <thead><tr style="background: #e8e8e8;"><th style="border: 1px solid #000; padding: 10px; width: 45px; font-size: 12px;">Sl No.</th><th style="border: 1px solid #000; padding: 10px; font-size: 12px;">Particulars</th><th style="border: 1px solid #000; padding: 10px; width: 80px; font-size: 12px;">HSN/SAC</th><th style="border: 1px solid #000; padding: 10px; width: 100px; text-align: right; font-size: 12px;">Amount</th></tr></thead>
        <tbody>
          ${Te}
          ${C.length>1?'<tr style="background: #f5f5f5;"><td colspan="3" style="border: 1px solid #000; padding: 10px; text-align: right; font-weight: bold; font-size: 13px;">Sub Total</td><td style="border: 1px solid #000; padding: 10px; text-align: right; font-weight: bold; font-size: 13px;">'+Vt(X)+"</td></tr>":""}
          ${J?`<tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">CGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${Vt(re)}</td></tr><tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">SGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${Vt(R)}</td></tr>`:`<tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">IGST @ 18%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${Vt(pe)}</td></tr>`}
          <tr style="background: #2874A6; color: white;"><td colspan="3" style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;">Total</td><td style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;"> ${ue.toLocaleString("en-IN",{minimumFractionDigits:2})}</td></tr>
        </tbody>
      </table>
      <div style="padding: 10px 12px; border: 1px solid #000; border-top: none; background: #fafafa;"><div style="color: #666; font-size: 11px; margin-bottom: 3px;">Amount Chargeable (in words)</div><div style="font-weight: bold; font-size: 13px;">${RW(ue)}</div></div>
      <div style="display: flex; border-top: 2px solid #000;">
        <div style="flex: 1; padding: 10px 12px; border-right: 2px solid #000; font-size: 11px;"><div><strong>Company's PAN:</strong> ${S.pan}</div></div>
        <div style="flex: 1.2; padding: 10px 12px; font-size: 11px;">
          <div style="font-weight: bold; margin-bottom: 6px; color: #1a5276;">Company's Bank Details</div>
          <div style="line-height: 1.5;"><strong>A/c Holder:</strong> ${S.bank.holder}<br><strong>Bank:</strong> ${S.bank.name}<br><strong>A/c No.:</strong> ${S.bank.account}<br><strong>IFSC:</strong> ${S.bank.ifsc}</div>
          <div style="text-align: right; margin-top: 30px;"><div style="font-weight: bold;">for ${S.name}</div><div style="margin-top: 25px; border-top: 1px solid #000; display: inline-block; padding-top: 4px; font-size: 10px;">Authorised Signatory</div></div>
        </div>
      </div>
      <div style="text-align: center; padding: 8px; background: #f0f0f0; border-top: 1px solid #000; font-size: 10px; color: #666; font-style: italic;">This is a Computer Generated Invoice</div>
    </div>
  </div>
  ${ee}
`},H4=m=>{const C=ay(m);sy(C),zr(m),ny(!0)},$4=m=>{const C=`<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Invoice ${m.invoiceNo||""}</title>
  <style>
    @page { size: A4; margin: 10mm; }
    @media print { body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } }
    body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }
  </style>
</head>
<body>
${ay(m)}
<script>
  // Auto-open print dialog when file is opened
  window.onload = function() { 
    setTimeout(function() { window.print(); }, 500); 
  };
<\/script>
</body>
</html>`,X=new Blob([C],{type:"text/html"}),Z=URL.createObjectURL(X),J=document.createElement("a");J.href=Z,J.download=`Invoice_${(m.invoiceNo||"draft").replace(/\//g,"-")}.html`,document.body.appendChild(J),J.click(),document.body.removeChild(J),URL.revokeObjectURL(Z)},Nu=m=>{H4(m)},G4=()=>{const m=parseFloat(Yt.amount)||0,C=parseFloat(Yt.tds)||0,X=parseFloat(Yt.discount)||0,Z=m+C+X;let J=parseFloat(ae.invoiceTotalAmount)||parseFloat(ae.totalWithGst)||parseFloat(ae.invoiceAmount)*1.18;const re=Z>=J?"Paid":"Partially Paid";ae.invoiceType==="Combined"&&ae.combinationCode!=="NA"?be(pe=>pe.map(Re=>Re.combinationCode===ae.combinationCode?{...Re,invoiceStatus:re}:Re)):be(pe=>pe.map(Re=>Re.id===ae.id?{...Re,invoiceStatus:re}:Re));const R=[];m>0&&R.push({id:Date.now(),partyName:ae.partyName,date:Yt.date,particulars:Yt.narration?`Payment Received - ${Yt.mode} (${Yt.narration})`:`Payment Received - ${Yt.mode}`,debit:0,credit:m,type:"payment"}),C>0&&R.push({id:Date.now()+1,partyName:ae.partyName,date:Yt.date,particulars:`TDS Deducted - Inv: ${ae.invoiceNo}`,debit:0,credit:C,type:"tds"}),X>0&&R.push({id:Date.now()+2,partyName:ae.partyName,date:Yt.date,particulars:`Discount Allowed - Inv: ${ae.invoiceNo}`,debit:0,credit:X,type:"discount"}),ye(pe=>[...pe,...R]),Zt(!1),zr(null)},oy=m=>{Xl(C=>{const X=new Set(C);return X.has(m)?X.delete(m):X.add(m),X})},K4=()=>{const X=r==="director"?[{id:"master",icon:V2,label:"Master Sheet"},{id:"invoices",icon:Wu,label:"Invoice Register"},{id:"ledgers",icon:P2,label:"Party Ledgers"},{id:"followups",icon:Dd,label:"Followups"},{id:"reports",icon:N2,label:"Reports"}]:[{id:"master",icon:V2,label:"Master Sheet"},{id:"invoices",icon:Wu,label:"Invoice Register"},{id:"ledgers",icon:P2,label:"Party Ledgers"},{id:"followups",icon:Dd,label:"Followups"},{id:"reports",icon:N2,label:"Reports"},{id:"settings",icon:WB,label:"Settings"}];return f.jsxs("div",{style:{width:N?"60px":"220px",backgroundColor:"#1E293B",color:"#FFFFFF",display:"flex",flexDirection:"column",transition:"width 0.2s ease",flexShrink:0},children:[f.jsxs("div",{style:{padding:N?"12px":"16px",borderBottom:"1px solid #334155",display:"flex",alignItems:"center",justifyContent:N?"center":"space-between"},children:[!N&&f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[f.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"32px",height:"auto",borderRadius:"4px",backgroundColor:"white",padding:"2px"}}),f.jsxs("div",{children:[f.jsx("div",{style:{fontSize:"16px",fontWeight:"700"},children:"FinMate"}),f.jsx("div",{style:{fontSize:"10px",color:"#94A3B8"},children:r==="director"?"Director View":"Finance Team"})]})]}),f.jsx("button",{onClick:()=>ze(!N),style:{background:"none",border:"none",color:"#94A3B8",cursor:"pointer",padding:"4px"},children:N?f.jsx(Bm,{size:18}):f.jsx(LB,{size:18})})]}),!N&&f.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #334155",fontSize:"11px"},children:d?f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#FCD34D"},children:[f.jsx(L2,{size:12,style:{animation:"spin 1s linear infinite"}}),f.jsx("span",{children:"Saving..."})]}):p?f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#86EFAC"},children:[f.jsx(O2,{size:12}),f.jsxs("span",{children:["Saved ",p.toLocaleTimeString()]})]}):f.jsx("div",{style:{color:"#94A3B8"},children:"Cloud Sync Active"})}),f.jsx("div",{style:{padding:"8px",borderBottom:"1px solid #334155"},children:f.jsxs("button",{onClick:()=>$l(!0),style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:N?"12px":"11px 14px",borderRadius:"8px",border:"none",backgroundColor:qi>0?"#FEF3C7":"#334155",color:qi>0?"#92400E":"#94A3B8",cursor:"pointer",fontSize:"14px",fontWeight:qi>0?"700":"500",justifyContent:N?"center":"flex-start",position:"relative"},title:"Notifications",children:[qi>0?f.jsx(PB,{size:18}):f.jsx(D2,{size:18}),!N&&f.jsx("span",{children:"Notifications"}),qi>0&&f.jsx("span",{style:{position:N?"absolute":"static",top:N?"4px":"auto",right:N?"4px":"auto",marginLeft:N?"0":"auto",backgroundColor:"#DC2626",color:"#FFFFFF",padding:"2px 6px",borderRadius:"10px",fontSize:"11px",fontWeight:"700",minWidth:"18px",textAlign:"center"},children:qi})]})}),f.jsx("nav",{style:{flex:1,padding:"8px"},children:X.map(Z=>f.jsxs("button",{onClick:()=>P(Z.id),style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:N?"12px":"11px 14px",marginBottom:"4px",borderRadius:"8px",border:"none",backgroundColor:D===Z.id?"#2874A6":"transparent",color:D===Z.id?"#FFFFFF":"#94A3B8",cursor:"pointer",fontSize:"14px",fontWeight:D===Z.id?"600":"500",justifyContent:N?"center":"flex-start"},title:Z.label,children:[f.jsx(Z.icon,{size:18}),!N&&f.jsx("span",{children:Z.label})]},Z.id))}),f.jsxs("div",{style:{padding:"8px",borderTop:"1px solid #334155"},children:[f.jsxs("button",{onClick:()=>{_(!0),H({currentPassword:"",newPassword:"",confirmPassword:""}),w("")},style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:N?"12px":"11px 14px",marginBottom:"8px",borderRadius:"8px",border:"none",backgroundColor:"#475569",color:"#FFFFFF",cursor:"pointer",fontSize:"14px",fontWeight:"500",justifyContent:N?"center":"flex-start"},title:"Change Password",children:[f.jsx(Nd,{size:18}),!N&&f.jsx("span",{children:"Change Password"})]}),f.jsxs("button",{onClick:Yp,style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:N?"12px":"11px 14px",borderRadius:"8px",border:"none",backgroundColor:"#DC2626",color:"#FFFFFF",cursor:"pointer",fontSize:"14px",fontWeight:"600",justifyContent:N?"center":"flex-start"},title:"Logout",children:[f.jsx(nl,{size:18}),!N&&f.jsx("span",{children:"Logout"})]})]})]})},X4=()=>f.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(Vm,{size:18,color:"#64748B"}),f.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"})]}),f.jsxs("div",{style:{position:"relative"},children:[f.jsx(Pd,{size:15,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"text",placeholder:"Search...",value:Xe.searchText,onChange:m=>Ls(C=>({...C,searchText:m.target.value})),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"160px"}})]}),f.jsxs("select",{value:Xe.party,onChange:m=>Ls(C=>({...C,party:m.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:Xe.party?"#EFF6FF":"#FFFFFF"},children:[f.jsx("option",{value:"",children:"All Parties"}),Qa.map(m=>f.jsx("option",{value:m,children:m},m))]}),f.jsxs("select",{value:Xe.billStatus,onChange:m=>Ls(C=>({...C,billStatus:m.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:Xe.billStatus?"#EFF6FF":"#FFFFFF"},children:[f.jsx("option",{value:"",children:"Bill Status"}),f.jsx("option",{value:"Yes",children:"Yes"}),f.jsx("option",{value:"Not Yet",children:"Not Yet"})]}),f.jsxs("select",{value:Xe.invoiceStatus,onChange:m=>Ls(C=>({...C,invoiceStatus:m.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:Xe.invoiceStatus?"#EFF6FF":"#FFFFFF"},children:[f.jsx("option",{value:"",children:"Invoice Status"}),f.jsx("option",{value:"Generated",children:"Generated"}),f.jsx("option",{value:"Not Generated",children:"Not Generated"}),f.jsx("option",{value:"Paid",children:"Paid"})]}),ec&&f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:Jo,style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(nl,{size:14})," Clear"]}),f.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",Jl.length," of ",ge.length]})]})]})}),ly=()=>{const m=ge.filter(R=>R.toBeBilled==="Yes"&&R.invoiceGenerated&&R.mailingSent==="Yes"&&(R.receiptStatus==="Received"||R.receiptStatus==="Cancelled"||R.receiptStatus==="Closed")),C=ge.filter(R=>!(R.toBeBilled==="Yes"&&R.invoiceGenerated&&R.mailingSent==="Yes"&&(R.receiptStatus==="Received"||R.receiptStatus==="Cancelled"||R.receiptStatus==="Closed"))),X=Pn==="open"?C:m,Z=X.filter(R=>{var pe,Re,ue,Te,He;if(Xe.party&&R.partyName!==Xe.party||Xe.billStatus&&R.toBeBilled!==Xe.billStatus||Xe.invoiceType&&R.invoiceType!==Xe.invoiceType||Xe.mailingStatus&&(Xe.mailingStatus==="Sent"&&R.mailingSent!=="Yes"||Xe.mailingStatus==="Not Sent"&&R.mailingSent==="Yes")||Xe.invoiceStatus&&(Xe.invoiceStatus==="Generated"&&!R.invoiceGenerated||Xe.invoiceStatus==="Not Generated"&&R.invoiceGenerated||Xe.invoiceStatus==="Approved"&&R.invoiceStatus!=="Approved"||Xe.invoiceStatus==="Need Edits"&&R.invoiceStatus!=="Need Edits"||Xe.invoiceStatus==="Paid"&&R.invoiceStatus!=="Paid"))return!1;if(Xe.searchText){const ee=Xe.searchText.toLowerCase();if(!((pe=R.partyName)!=null&&pe.toLowerCase().includes(ee))&&!((Re=R.senderName)!=null&&Re.toLowerCase().includes(ee))&&!((ue=R.campaignName)!=null&&ue.toLowerCase().includes(ee))&&!((Te=R.subject)!=null&&Te.toLowerCase().includes(ee))&&!((He=R.invoiceNo)!=null&&He.toLowerCase().includes(ee)))return!1}return!0}),J=Z.reduce((R,pe)=>{const Re=pe.partyName||"Unknown";return R[Re]||(R[Re]=[]),R[Re].push(pe),R},{}),re=Object.keys(J).sort();return f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[f.jsxs("div",{children:[f.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Master Sheet"}),f.jsxs("p",{style:{margin:"4px 0 0",fontSize:"14px",color:"#64748B"},children:[ge.length," campaigns  ",Qa.length," parties  ",ge.filter(R=>R.invoiceGenerated).length," invoiced"]})]}),f.jsxs("div",{style:{display:"flex",gap:"10px"},children:[f.jsx("input",{type:"file",ref:L0,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:Ru}),f.jsx(Ye,{icon:$s,label:"Upload Data",variant:"brand",onClick:()=>{var R;return(R=L0.current)==null?void 0:R.click()}}),Ut&&ge.length>0&&f.jsx(Ye,{icon:Hs,label:"Clear All Data",variant:"danger",onClick:()=>Dn(!0)})]})]}),f.jsxs("div",{style:{display:"flex",gap:"4px",marginBottom:"16px",backgroundColor:"#F1F5F9",padding:"4px",borderRadius:"10px",width:"fit-content"},children:[f.jsxs("button",{onClick:()=>Ms("open"),style:{padding:"10px 20px",fontSize:"14px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:Pn==="open"?"#FFFFFF":"transparent",color:Pn==="open"?"#1E293B":"#64748B",boxShadow:Pn==="open"?"0 2px 4px rgba(0,0,0,0.1)":"none"},children:[" Open Invoices (",C.length,")"]}),f.jsxs("button",{onClick:()=>Ms("closed"),style:{padding:"10px 20px",fontSize:"14px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:Pn==="closed"?"#FFFFFF":"transparent",color:Pn==="closed"?"#1E293B":"#64748B",boxShadow:Pn==="closed"?"0 2px 4px rgba(0,0,0,0.1)":"none"},children:[" Closed Invoices (",m.length,")"]})]}),ge.length>0&&X4(),re.length===0?f.jsx(En,{children:f.jsxs("div",{style:{padding:"60px",textAlign:"center",color:"#94A3B8"},children:[f.jsx($s,{size:48,style:{marginBottom:"16px",opacity:.5}}),f.jsx("div",{style:{fontSize:"18px",fontWeight:"600"},children:ec?"No matching records":Pn==="closed"?"No closed invoices yet":"No Data Yet"}),f.jsx("div",{style:{fontSize:"14px",marginTop:"4px"},children:ec?"Try adjusting your filters":Pn==="closed"?"Invoices will appear here once billed, mailed, and payment received":"Upload an Excel file to get started"})]})}):f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:re.map(R=>{const pe=J[R],Re=qo.has(R),ue=pe.filter(ee=>ee.toBeBilled==="Yes").length,Te=pe.filter(ee=>ee.invoiceGenerated).length,He=pe.filter(ee=>ee.toBeBilled==="Yes").reduce((ee,Ke)=>ee+(parseFloat(Ke.totalWithGst)||0),0);return f.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:[f.jsxs("div",{onClick:()=>oy(R),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",backgroundColor:Pn==="closed"?"#F0FDF4":"#F8FAFC",cursor:"pointer",borderBottom:Re?"3px solid #2874A6":"none"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[Re?f.jsx(M2,{size:22,color:"#2874A6"}):f.jsx(Bm,{size:22,color:"#64748B"}),f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:"700",fontSize:"16px",color:"#1E293B"},children:R}),f.jsxs("div",{style:{fontSize:"13px",color:"#64748B",marginTop:"3px"},children:[pe.length," campaigns  ",ue," billed  ",Te," invoiced"]})]})]}),He>0&&f.jsxs("div",{style:{textAlign:"right"},children:[f.jsx("div",{style:{fontSize:"11px",color:"#64748B",textTransform:"uppercase"},children:"Total"}),f.jsx("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:ut(He)})]})]}),Re&&f.jsx("div",{style:{overflowX:"auto"},children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px",minWidth:"2100px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#F1F5F9"},children:[f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Date"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"100px"},children:"Sender"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",minWidth:"180px"},children:"Campaign / Subject"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"160px"},children:"Email ID"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"70px"},children:"Mailer"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"80px"},children:"Bill?"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"right",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Amount"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Type"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Generate"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"110px"},children:"Invoice No."}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"90px"},children:"Inv Date"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"right",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"100px"},children:"Inv Amount"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#7C3AED",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"50px"},children:"C#"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"120px"},children:"Status/Approve"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"120px"},children:"Actions"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#059669",borderBottom:"2px solid #E2E8F0",backgroundColor:"#F0FDF4",width:"80px"},children:"Mailed?"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#059669",borderBottom:"2px solid #E2E8F0",backgroundColor:"#F0FDF4",width:"90px"},children:"Mail Date"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#7C3AED",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"100px"},children:"Receipt"})]})}),f.jsx("tbody",{children:pe.map(ee=>{var Le,Qe;const Ke=ee.invoiceType==="Combined"&&qp(ee.combinationCode)&&ee.mailingSent!=="Yes";Ja(ee);const fe=wt[ee.id]&&wt[ee.id].length>0;return f.jsxs("tr",{style:{backgroundColor:ee.toBeBilled==="Yes"?ee.invoiceGenerated?"#F0FDF4":"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #F1F5F9"},children:[f.jsx("td",{style:{padding:"12px 14px",whiteSpace:"nowrap",fontSize:"13px"},children:mr(ee.date)}),f.jsx("td",{style:{padding:"12px 14px",fontWeight:"600",fontSize:"13px"},children:ee.senderName}),f.jsxs("td",{style:{padding:"12px 14px"},children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"13px",lineHeight:"1.4",color:"#1E293B"},children:((Qe=(Le=ee.campaignName)==null?void 0:Le.split("--")[0])==null?void 0:Qe.trim())||ee.senderName}),ee.subject&&f.jsx("div",{style:{fontSize:"12px",color:"#64748B",marginTop:"4px",lineHeight:"1.3"},children:ee.subject})]}),f.jsx("td",{style:{padding:"10px 14px"},children:f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[ee.emailId&&f.jsx("div",{style:{fontSize:"11px",color:"#1E40AF",backgroundColor:"#EFF6FF",padding:"2px 6px",borderRadius:"4px",display:"inline-block"},children:ee.emailId}),(ee.additionalEmails||[]).map((Ne,Je)=>f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[f.jsx("span",{style:{fontSize:"11px",color:"#059669",backgroundColor:"#F0FDF4",padding:"2px 6px",borderRadius:"4px"},children:Ne}),f.jsx("button",{onClick:()=>Fu(ee.id,Ne),style:{background:"none",border:"none",cursor:"pointer",padding:"2px",color:"#DC2626"},title:"Remove",children:f.jsx(nl,{size:12})})]},Je)),f.jsxs("button",{onClick:()=>{zr(ee),ca(""),Fr(!0)},style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",color:"#2874A6",background:"none",border:"none",cursor:"pointer",padding:"2px 0"},children:[f.jsx(B2,{size:12})," Add"]})]})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:fe?f.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[f.jsx("span",{style:{color:"#22C55E",fontWeight:"700",fontSize:"14px"},children:""}),f.jsx("button",{onClick:()=>{zr(ee),Ii(null),Ga(!0),gt(!0)},style:{fontSize:"10px",color:"#64748B",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},children:"Replace"})]}):f.jsx(Ye,{icon:MB,small:!0,variant:"default",onClick:()=>{zr(ee),Ii(null),Ga(!1),gt(!0)}})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:f.jsxs("select",{value:ee.toBeBilled,onChange:Ne=>P4(ee.id,Ne.target.value),disabled:ee.invoiceGenerated||!On,style:{padding:"6px 8px",fontSize:"12px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:ee.toBeBilled==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:ee.toBeBilled==="Yes"?"#DCFCE7":"#FFFFFF",color:ee.toBeBilled==="Yes"?"#166534":"#64748B",cursor:ee.invoiceGenerated||!On?"not-allowed":"pointer",width:"70px",opacity:!On&&!ee.invoiceGenerated?.6:1},children:[f.jsx("option",{value:"Not Yet",children:"Not Yet"}),f.jsx("option",{value:"Yes",children:"Yes"})]})}),f.jsx("td",{style:{padding:"10px 14px"},children:f.jsx("input",{type:"number",value:ee.invoiceAmount||"",onChange:Ne=>J0(ee.id,"invoiceAmount",Ne.target.value),disabled:ee.invoiceGenerated,placeholder:"0",style:{width:"80px",padding:"6px 8px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #D1D5DB",borderRadius:"6px",textAlign:"right",backgroundColor:ee.invoiceGenerated?"#F3F4F6":"#FFFFFF"}})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:ee.invoiceGenerated?f.jsx(tg,{status:ee.invoiceType,small:!0}):ee.toBeBilled==="Yes"?f.jsxs("select",{value:ee.invoiceType||"Individual",onChange:Ne=>J0(ee.id,"invoiceType",Ne.target.value),style:{padding:"6px 6px",fontSize:"11px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:ee.invoiceType==="Combined"?"#7C3AED":"#A5B4FC",backgroundColor:ee.invoiceType==="Combined"?"#F3E8FF":"#E0E7FF",color:ee.invoiceType==="Combined"?"#6B21A8":"#3730A3",cursor:"pointer",width:"80px"},children:[f.jsx("option",{value:"Individual",children:"Individual"}),f.jsx("option",{value:"Combined",children:"Combined"})]}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:ee.toBeBilled==="Yes"&&!ee.invoiceGenerated&&ee.invoiceAmount&&Ut?ee.invoiceType==="Individual"?f.jsx(Ye,{icon:Hu,label:"Create",small:!0,variant:"warning",onClick:()=>O4(ee)}):f.jsx(Ye,{icon:VB,label:"Combine",small:!0,variant:"purple",onClick:()=>B4(ee)}):ee.toBeBilled==="Yes"&&!ee.invoiceGenerated&&ee.invoiceAmount&&On?f.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Finance to create"}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF"},children:ee.invoiceNo?f.jsx("span",{style:{fontWeight:"700",color:"#1E40AF",fontSize:"12px"},children:ee.invoiceNo}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF",fontSize:"12px"},children:ee.invoiceDate?mr(ee.invoiceDate):"-"}),f.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF",textAlign:"right",fontWeight:"700",color:"#1E40AF",fontSize:"13px"},children:ee.invoiceTotalAmount?Vt(ee.invoiceTotalAmount):"-"}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:ee.combinationCode&&ee.combinationCode!=="NA"?f.jsx("span",{style:{fontWeight:"700",color:"#7C3AED",fontSize:"12px"},children:ee.combinationCode}):"-"}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:ee.invoiceGenerated?On?f.jsx("button",{onClick:()=>G0(ee),style:{padding:"5px 10px",fontSize:"11px",fontWeight:"700",border:"1.5px solid",borderRadius:"6px",cursor:"pointer",backgroundColor:ee.invoiceStatus==="Approved"?"#DCFCE7":ee.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",borderColor:ee.invoiceStatus==="Approved"?"#22C55E":ee.invoiceStatus==="Need Edits"?"#DC2626":"#F59E0B",color:ee.invoiceStatus==="Approved"?"#166534":ee.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:ee.invoiceStatus==="Approved"?" Approved":ee.invoiceStatus==="Need Edits"?" Need Edits":" Review"}):f.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px"},children:[f.jsx("span",{style:{padding:"4px 10px",fontSize:"11px",fontWeight:"700",borderRadius:"6px",backgroundColor:ee.invoiceStatus==="Approved"?"#DCFCE7":ee.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",color:ee.invoiceStatus==="Approved"?"#166534":ee.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:ee.invoiceStatus==="Approved"?" Approved":ee.invoiceStatus==="Need Edits"?" Need Edits":" Pending"}),(ee.editComments||ee.approvalRemarks)&&f.jsx("button",{onClick:()=>{zr(ee),Pt(!0)},style:{fontSize:"9px",color:ee.invoiceStatus==="Need Edits"?"#991B1B":"#166534",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},title:ee.editComments||ee.approvalRemarks,children:"View Remarks"})]}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:ee.invoiceGenerated&&ee.invoiceStatus==="Approved"?f.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[f.jsx(Ye,{icon:Rd,small:!0,onClick:()=>Nu(ee),title:"View Invoice"}),Ut&&f.jsx(Ye,{icon:Um,small:!0,variant:"brand",onClick:()=>{zr(ee),ht(!0)},title:"Send Email"}),Ut&&f.jsx(Ye,{icon:Hs,small:!0,variant:"danger",onClick:()=>rc(ee),title:"Delete"})]}):ee.invoiceGenerated?f.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[f.jsx(Ye,{icon:Rd,small:!0,onClick:()=>Nu(ee),title:"View Invoice"}),Ut&&f.jsx(Ye,{icon:Hs,small:!0,variant:"danger",onClick:()=>rc(ee),title:"Delete"})]}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#F0FDF4"},children:ee.invoiceGenerated&&ee.invoiceStatus==="Approved"&&Ut?Ke?f.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Combined sent"}):f.jsxs("select",{value:ee.mailingSent||"No",onChange:Ne=>J0(ee.id,"mailingSent",Ne.target.value),style:{padding:"5px 8px",fontSize:"11px",fontWeight:"700",border:"2px solid",borderRadius:"6px",borderColor:ee.mailingSent==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:ee.mailingSent==="Yes"?"#DCFCE7":"#FFFFFF",color:ee.mailingSent==="Yes"?"#166534":"#64748B",cursor:"pointer",width:"60px"},children:[f.jsx("option",{value:"No",children:"No"}),f.jsx("option",{value:"Yes",children:"Yes"})]}):ee.invoiceGenerated&&ee.invoiceStatus==="Approved"&&On?f.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"11px",fontWeight:"600",backgroundColor:ee.mailingSent==="Yes"?"#DCFCE7":"#FEF3C7",color:ee.mailingSent==="Yes"?"#166534":"#92400E"},children:ee.mailingSent==="Yes"?" Yes":" No"}):ee.invoiceGenerated&&ee.invoiceStatus!=="Approved"?f.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Approve first"}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#F0FDF4"},children:ee.mailingSent==="Yes"?Ut?f.jsx("input",{type:"date",value:ee.mailDate||ee.invoiceDate||"",onChange:Ne=>J0(ee.id,"mailDate",Ne.target.value),style:{padding:"4px 6px",fontSize:"11px",border:"1.5px solid #D1D5DB",borderRadius:"6px",width:"100%"}}):f.jsx("span",{style:{fontSize:"11px"},children:mr(ee.mailDate||ee.invoiceDate)}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:ee.receiptStatus==="Received"||ee.receiptStatus==="Closed"?f.jsxs("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"700",backgroundColor:"#DCFCE7",color:"#166534"},children:[" ",ee.receiptNo||"Received"]}):ee.receiptStatus==="Cancelled"?f.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:" Cancelled"}):ee.invoiceGenerated&&ee.invoiceStatus==="Approved"?f.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"600",backgroundColor:"#FEF3C7",color:"#92400E"},children:" Pending"}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})})]},ee.id)})})]})})]},R)})}),X.length>0&&f.jsxs("div",{style:{marginTop:"16px",padding:"16px 20px",backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsxs("div",{style:{display:"flex",gap:"24px",fontSize:"14px",color:"#475569"},children:[f.jsxs("span",{children:[" Total: ",f.jsx("strong",{children:Z.length})]}),f.jsxs("span",{children:[" To Bill: ",f.jsx("strong",{children:Z.filter(R=>R.toBeBilled==="Yes").length})]}),f.jsxs("span",{children:[" Invoiced: ",f.jsx("strong",{children:Z.filter(R=>R.invoiceGenerated).length})]}),f.jsxs("span",{children:[" Approved: ",f.jsx("strong",{children:Z.filter(R=>R.invoiceStatus==="Approved").length})]}),Pn==="closed"&&f.jsxs("span",{children:[" Closed: ",f.jsx("strong",{children:Z.filter(R=>R.receiptStatus==="Received"||R.receiptStatus==="Cancelled"||R.receiptStatus==="Closed").length})]})]}),f.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:["Total: ",ut(Z.filter(R=>R.toBeBilled==="Yes").reduce((R,pe)=>R+(parseFloat(pe.totalWithGst)||0),0))]})]})]})},Y4=()=>{const m=new Map;sn.filter(ue=>ue.invoiceGenerated).forEach(ue=>{m.has(ue.invoiceNo)?m.get(ue.invoiceNo).campaigns.push(ue):m.set(ue.invoiceNo,{invoiceNo:ue.invoiceNo,partyName:ue.partyName,date:ue.invoiceDate,invoiceType:ue.invoiceType,combinationCode:ue.combinationCode,invoiceStatus:ue.invoiceStatus,mailingSent:ue.mailingSent,receiptStatus:ue.receiptStatus||"Pending",receiptNo:ue.receiptNo,campaigns:[ue],totalAmount:parseFloat(ue.invoiceTotalAmount)||0,isFromMaster:!0})});const C=ue=>{if(!ue)return"";const Te=ue.split("/");return Te.length>=3?Te.slice(1).join("/"):Te.length===2?Te.join("/"):Te[Te.length-1]},X=xi.filter(ue=>{var Te;return ue.isHistorical&&(ue.type==="creditnote"||((Te=ue.vchNo)==null?void 0:Te.toUpperCase().startsWith("CN")))}),Z=new Map;Yl.forEach(ue=>{const Te=C(ue.invoiceNo);Te&&Z.set(Te,ue)}),X.forEach(ue=>{const Te=C(ue.vchNo);Te&&!Z.has(Te)&&Z.set(Te,ue)}),xi.filter(ue=>{var Te;return ue.isHistorical&&ue.type!=="creditnote"&&!((Te=ue.vchNo)!=null&&Te.toUpperCase().startsWith("CN"))&&ue.debit>0}).forEach(ue=>{if(!m.has(ue.vchNo)){const Te=_s.find(Je=>Je.invoiceNo===ue.vchNo),He=C(ue.vchNo),ee=Z.get(He),Ke=ee?Math.abs(parseFloat(ee.totalAmount)||parseFloat(ee.credit)||parseFloat(ee.debit)||0):0,fe=parseFloat(ue.debit)||0;if(ee&&Ke>=fe)return;const Qe=!Te&&!(ue.amountReceived>0),Ne=ee&&Ke>0&&Ke<fe;if(Qe||Ne){const Je=Ne?fe-Ke:fe;m.set(ue.vchNo,{invoiceNo:ue.vchNo,partyName:ue.partyName,date:ue.date,invoiceType:"Historical",combinationCode:"",invoiceStatus:"Approved",mailingSent:"Yes",receiptStatus:Ne?"Partial CN":"Pending",receiptNo:"",campaigns:[],totalAmount:fe,pendingAmount:Je,hasPartialCN:Ne,cnAmount:Ke,isHistorical:!0,historicalEntry:ue})}}});let J=Array.from(m.values());if(er.party&&(J=J.filter(ue=>Er(ue.partyName,er.party))),er.invoiceStatus&&(J=J.filter(ue=>ue.invoiceStatus===er.invoiceStatus)),er.receiptStatus&&(er.receiptStatus==="Received"?J=J.filter(ue=>ue.receiptStatus==="Received"):er.receiptStatus==="Pending"&&(J=J.filter(ue=>ue.receiptStatus!=="Received"))),er.invoiceType&&(J=J.filter(ue=>ue.invoiceType===er.invoiceType)),er.searchText){const ue=er.searchText.toLowerCase();J=J.filter(Te=>{var He,ee;return((He=Te.invoiceNo)==null?void 0:He.toLowerCase().includes(ue))||((ee=Te.partyName)==null?void 0:ee.toLowerCase().includes(ue))})}const re={};J.forEach(ue=>{re[ue.partyName]||(re[ue.partyName]=[]),re[ue.partyName].push(ue)});const R=Object.keys(re).sort(),pe=er.party||er.invoiceStatus||er.receiptStatus||er.invoiceType||er.searchText,Re=Array.from(m.values());return f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[f.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Invoice & Receipt Register"}),On&&f.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"})]}),f.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(Vm,{size:18,color:"#64748B"}),f.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"})]}),f.jsxs("div",{style:{position:"relative"},children:[f.jsx(Pd,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"text",placeholder:"Search invoice...",value:er.searchText,onChange:ue=>hr(Te=>({...Te,searchText:ue.target.value})),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"160px"}})]}),f.jsxs("select",{value:er.party,onChange:ue=>hr(Te=>({...Te,party:ue.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[f.jsx("option",{value:"",children:"All Parties"}),Qa.map(ue=>f.jsx("option",{value:ue,children:ue},ue))]}),f.jsxs("select",{value:er.invoiceStatus,onChange:ue=>hr(Te=>({...Te,invoiceStatus:ue.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[f.jsx("option",{value:"",children:"All Status"}),f.jsx("option",{value:"Created",children:"Created"}),f.jsx("option",{value:"Approved",children:"Approved"}),f.jsx("option",{value:"Need Edits",children:"Need Edits"})]}),f.jsxs("select",{value:er.receiptStatus,onChange:ue=>hr(Te=>({...Te,receiptStatus:ue.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[f.jsx("option",{value:"",children:"All Receipts"}),f.jsx("option",{value:"Received",children:"Received"}),f.jsx("option",{value:"Pending",children:"Pending"})]}),f.jsxs("select",{value:er.invoiceType,onChange:ue=>hr(Te=>({...Te,invoiceType:ue.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[f.jsx("option",{value:"",children:"All Types"}),f.jsx("option",{value:"Individual",children:"Individual"}),f.jsx("option",{value:"Combined",children:"Combined"})]}),pe&&f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:()=>hr({party:"",invoiceStatus:"",receiptStatus:"",invoiceType:"",searchText:""}),style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(nl,{size:14})," Clear"]}),f.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",J.length," of ",Re.length]})]})]})}),f.jsx(En,{noPadding:!0,children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[f.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Date"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Type"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:"Amount"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#F0FDF4",color:"#166534"},children:"Received"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEF3C7",color:"#92400E"},children:"TDS"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:"CN Amt"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#EFF6FF",color:"#1E40AF"},children:"Balance"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Inv. Status"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Receipt No."}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"CN No."}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),f.jsx("tbody",{children:R.length===0?f.jsx("tr",{children:f.jsx("td",{colSpan:"12",style:{padding:"50px",textAlign:"center",color:"#94A3B8"},children:pe?"No matching invoices":"No invoices generated yet"})}):R.map(ue=>{const Te=re[ue],He=qo.has(ue);let ee=0;return Te.forEach(Ke=>{const fe=Q.find(_e=>_e.invoiceNo===Ke.invoiceNo),Le=Be.find(_e=>_e.invoiceNo===Ke.invoiceNo),Qe=Se.find(_e=>_e.invoiceNo===Ke.invoiceNo&&_e.type==="tds"),Ne=Se.find(_e=>_e.invoiceNo===Ke.invoiceNo&&_e.type==="discount"),Je=Ke.totalAmount||0,Ot=fe&&parseFloat(fe.amount)||0,jt=Qe?parseFloat(Qe.credit)||0:fe&&parseFloat(fe.tds)||0,zt=Le?Math.abs(parseFloat(Le.totalAmount)||0):0,_n=Ne&&parseFloat(Ne.credit)||0,Wr=Math.max(0,Je-Ot-jt-zt-_n);ee+=Wr}),f.jsxs(Wd.Fragment,{children:[f.jsxs("tr",{onClick:()=>oy(ue),style:{backgroundColor:"#1E3A5F",color:"white",cursor:"pointer",borderBottom:"1px solid #0F2744"},children:[f.jsx("td",{colSpan:"3",style:{padding:"10px 12px",fontWeight:"700",fontSize:"13px"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[He?f.jsx(M2,{size:18}):f.jsx(Bm,{size:18}),f.jsx(U2,{size:16}),ue,f.jsxs("span",{style:{backgroundColor:"#2874A6",padding:"2px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600"},children:[Te.length," inv"]})]})}),f.jsx("td",{colSpan:"4",style:{padding:"10px 12px"}}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",fontSize:"13px",backgroundColor:ee===0?"#22C55E":"#3B82F6"},children:ee===0?" Nil":`Bal: ${ut(ee)}`}),f.jsx("td",{colSpan:"4",style:{padding:"10px 12px"}})]}),He&&Te.map(Ke=>{const fe=Q.find(ie=>ie.invoiceNo===Ke.invoiceNo),Le=Be.find(ie=>ie.invoiceNo===Ke.invoiceNo),Qe=Se.find(ie=>ie.invoiceNo===Ke.invoiceNo&&ie.type==="tds"),Ne=Se.find(ie=>ie.invoiceNo===Ke.invoiceNo&&ie.type==="discount"),Je=Ke.totalAmount||0,Ot=fe&&parseFloat(fe.amount)||0,jt=Qe?parseFloat(Qe.credit)||0:fe&&parseFloat(fe.tds)||0,zt=Le?Math.abs(parseFloat(Le.totalAmount)||0):0,_n=Ne&&parseFloat(Ne.credit)||0,Wr=Math.max(0,Je-Ot-jt-zt-_n),_e=zt>=Je&&!fe;return f.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:Ke.invoiceType==="Combined"?"#FAF5FF":Wr===0?"#F0FDF4":"transparent"},children:[f.jsx("td",{style:{padding:"10px 12px 10px 36px",fontWeight:"700",color:Ke.invoiceType==="Combined"?"#7C3AED":"#2874A6"},children:Ke.invoiceNo}),f.jsx("td",{style:{padding:"10px 12px"},children:mr(Ke.date)}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsx(tg,{status:Ke.invoiceType,small:!0})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:ut(Je)}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#F0FDF4",color:Ot>0?"#166534":"#94A3B8"},children:Ot>0?ut(Ot):"-"}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#FEF3C7",color:jt>0?"#92400E":"#94A3B8"},children:jt>0?ut(jt):"-"}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#FEE2E2",color:zt>0?"#991B1B":"#94A3B8"},children:zt>0?ut(zt):"-"}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#EFF6FF",color:Wr>0?"#1E40AF":"#166534"},children:Wr===0?" Nil":ut(Wr)}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsx(tg,{status:Ke.invoiceStatus,small:!0})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:_e?f.jsx("span",{style:{padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:" Cancelled"}):fe?f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",justifyContent:"center"},children:[f.jsxs("button",{onClick:()=>Ri(fe),style:{padding:"4px 8px",borderRadius:"12px",fontSize:"10px",fontWeight:"700",backgroundColor:"#DCFCE7",color:"#166534",border:"none",cursor:"pointer",textDecoration:"underline"},title:"Click to view receipt",children:[" ",fe.receiptNo]}),Ut&&f.jsx("button",{onClick:()=>ri(fe),style:{padding:"2px 4px",borderRadius:"4px",fontSize:"10px",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete Receipt",children:""})]}):f.jsx("span",{style:{padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600",backgroundColor:"#FEF3C7",color:"#92400E"},children:" Pending"})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:Le?f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",justifyContent:"center"},children:[f.jsx("button",{onClick:()=>ic(Le),style:{padding:"4px 8px",borderRadius:"12px",fontSize:"10px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer",textDecoration:"underline"},title:"Click to view credit note",children:Le.creditNoteNo}),Ut&&f.jsx("button",{onClick:()=>q0(Le),style:{padding:"2px 4px",borderRadius:"4px",fontSize:"10px",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete Credit Note",children:""})]}):f.jsx("span",{style:{color:"#94A3B8",fontSize:"11px"},children:"-"})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsx("div",{style:{display:"flex",gap:"4px",justifyContent:"center",flexWrap:"wrap"},children:Ke.isHistorical?f.jsxs(f.Fragment,{children:[Ut&&!fe&&f.jsx(Ye,{icon:Hu,small:!0,variant:"success",onClick:()=>{const ie={invoiceNo:Ke.invoiceNo,partyName:Ke.partyName,invoiceDate:Ke.date,invoiceTotalAmount:Ke.totalAmount,invoiceStatus:"Approved",mailingSent:"Yes",invoiceType:"Historical",isHistorical:!0};Iu(ie)},title:"Create Receipt"}),Ut&&!Le&&f.jsx(Ye,{icon:Wu,small:!0,variant:"primary",onClick:()=>{const ie={invoiceNo:Ke.invoiceNo,partyName:Ke.partyName,invoiceDate:Ke.date,invoiceTotalAmount:Ke.totalAmount,invoiceStatus:"Approved",isHistorical:!0};bu(ie)},title:"Credit Note"})]}):f.jsxs(f.Fragment,{children:[f.jsx(Ye,{icon:Rd,small:!0,variant:"brand",onClick:()=>Nu(Ke.campaigns[0]),title:"View Invoice"}),Ut&&Ke.invoiceStatus==="Approved"&&Ke.mailingSent==="Yes"&&!fe&&f.jsx(Ye,{icon:Hu,small:!0,variant:"success",onClick:()=>Iu(Ke.campaigns[0]),title:"Create Receipt"}),Ut&&Ke.invoiceStatus==="Approved"&&!Le&&f.jsx(Ye,{icon:Wu,small:!0,variant:"primary",onClick:()=>bu(Ke.campaigns[0]),title:"Credit Note"}),Ut&&f.jsx(Ye,{icon:Hs,small:!0,variant:"danger",onClick:()=>rc(Ke.campaigns[0]),title:"Delete Invoice"})]})})})]},Ke.invoiceNo)})]},ue)})})]})})]})},q4=()=>{if(!G){alert("Please select a party first");return}const m=ti[G]||0,C=ge.filter(ie=>Er(ie.partyName,G)&&ie.invoiceGenerated&&ie.invoiceStatus==="Approved"),X=new Map;C.forEach(ie=>{X.has(ie.invoiceNo)?X.get(ie.invoiceNo).campaigns.push(ie):X.set(ie.invoiceNo,{invoiceNo:ie.invoiceNo,invoiceDate:ie.invoiceDate,campaigns:[ie],isFromMaster:!0})});const Z=Se.filter(ie=>{var rt;return Er(ie.partyName,G)&&ie.isHistorical&&ie.type!=="creditnote"&&!((rt=ie.vchNo)!=null&&rt.toUpperCase().startsWith("CN"))}),J=Se.filter(ie=>{var rt;return Er(ie.partyName,G)&&ie.isHistorical&&(ie.type==="creditnote"||((rt=ie.vchNo)==null?void 0:rt.toUpperCase().startsWith("CN")))}),re=Q.filter(ie=>Er(ie.partyName,G)),R=Be.filter(ie=>Er(ie.partyName,G)),pe=ie=>{if(!ie)return"";const rt=ie.split("/");return rt.length>=3?rt.slice(1).join("/"):rt.length===2?rt.join("/"):rt[rt.length-1]},Re=new Map;R.forEach(ie=>{const rt=pe(ie.invoiceNo);rt&&!Re.has(rt)&&Re.set(rt,{...ie,isSystemCN:!0})}),J.forEach(ie=>{const rt=pe(ie.vchNo);rt&&!Re.has(rt)&&Re.set(rt,{...ie,isHistoricalCN:!0})});let ue=[],Te=0,He=0,ee=0,Ke=0,fe=m;const Le=new Set;m!==0&&(Te+=m>0?m:0,He+=m<0?Math.abs(m):0,ue.push({date:"",particular:"Opening Balance",vchType:"",vchNo:"",debit:m>0?m:0,credit:m<0?Math.abs(m):0,receiptDate:"",amountReceived:0,tds:0,balance:m,status:"",isMain:!0,isOpening:!0}));const Qe=[];Array.from(X.values()).filter(ie=>{const rt=new Date(ie.invoiceDate);return rt>=new Date(_r.fromDate)&&rt<=new Date(_r.toDate)}).forEach(ie=>{Qe.push({...ie,entryType:"invoice",sortDate:ie.invoiceDate})}),Z.filter(ie=>{if(!ie.date)return!1;const rt=new Date(ie.date);return rt>=new Date(_r.fromDate)&&rt<=new Date(_r.toDate)}).forEach(ie=>{Qe.push({...ie,entryType:"invoice",sortDate:ie.date})}),Qe.sort((ie,rt)=>new Date(ie.sortDate)-new Date(rt.sortDate)),Qe.forEach(ie=>{var rt,pr;if(ie.isFromMaster){const Qt=ie;let Ir=0;Qt.campaigns.forEach(si=>Ir+=parseFloat(si.invoiceAmount)||0);const sr=(pr=(rt=Qt.campaigns[0])==null?void 0:rt.statePartyDetails)==null?void 0:pr.toUpperCase().includes("MAHARASHTRA"),br=sr?Ir*.09:0,ni=sr?Ir*.09:0,Rr=sr?0:Ir*.18,ii=Ir+br+ni+Rr,ar=pe(Qt.invoiceNo),Qr=Re.get(ar),Mn=!!Qr,ga=re.find(si=>si.invoiceNo===Qt.invoiceNo);fe+=ii,Te+=ii;let to=0,Ji=0,Zo="",Vs=Mn?"":"Pending";if(ga&&(Vs="Received",to=ga.amount||0,Ji=ga.tds||0,Zo=ga.date,ee+=to,Ke+=Ji,fe-=to+Ji+(ga.discount||0)),ue.push({date:Qt.invoiceDate,particular:G,vchType:"Sales",vchNo:Qt.invoiceNo,debit:ii,credit:0,receiptDate:Zo,amountReceived:to,tds:Ji,balance:Mn?"-":Vs==="Received"?0:ii-to-Ji,status:Vs,isMain:!0,hasCN:Mn}),ue.push({particular:"PROMOTIONAL TRADE EMAILER"+(Qt.campaigns.length>1?"S":""),credit:Ir,isMain:!1,hasCN:Mn}),sr?(ue.push({particular:"CGST",credit:br,isMain:!1,hasCN:Mn}),ue.push({particular:"SGST",credit:ni,isMain:!1,hasCN:Mn})):ue.push({particular:"IGST",credit:Rr,isMain:!1,hasCN:Mn}),Qr&&!Le.has(ar)){Le.add(ar);const si=Math.abs(Qr.totalAmount||Qr.credit||0);fe-=si,He+=si,ue.push({date:Qr.date,particular:G,vchType:"Credit Note",vchNo:Qr.creditNoteNo||Qr.vchNo,debit:0,credit:si,receiptDate:"",amountReceived:0,tds:0,balance:"-",status:"",isMain:!0,isCreditNote:!0,hasCN:!0});const ro=Math.abs(Qr.amount)||si/1.18,rd=Math.abs(Qr.gst)||si-ro;ue.push({particular:"PROMOTIONAL TRADE EMAILER",credit:ro,isMain:!1,isCreditNote:!0,hasCN:!0}),ue.push({particular:Qr.gstType||(sr?"CGST + SGST":"IGST"),credit:rd,isMain:!1,isCreditNote:!0,hasCN:!0})}}else if(ie.isHistorical){const Qt=ie.debit||0,Ir=ie.credit||0,sr=pe(ie.vchNo),br=Re.get(sr),ni=!!br;if(fe+=Qt-Ir,Te+=Qt,He+=Ir,ue.push({date:ie.date,particular:ie.particulars||G,vchType:ie.vchType||"Sales",vchNo:ie.vchNo,debit:Qt,credit:Ir,receiptDate:ie.receiptDate||"",amountReceived:ie.amountReceived||0,tds:ie.tdsReceived||0,balance:ni?"-":Qt-(ie.amountReceived||0)-(ie.tdsReceived||0),status:ni?"":ie.paymentStatus||"",isMain:!0,isHistorical:!0,hasCN:ni}),ie.subRows&&ie.subRows.length>0&&ie.subRows.forEach(Rr=>{ue.push({particular:Rr.particular,debit:Rr.debit,credit:Rr.credit,isMain:!1,hasCN:ni})}),br&&!Le.has(sr)){Le.add(sr);const Rr=Math.abs(br.totalAmount||br.credit||0);fe-=Rr,He+=Rr,ue.push({date:br.date,particular:G,vchType:"Credit Note",vchNo:br.creditNoteNo||br.vchNo,debit:0,credit:Rr,receiptDate:"",amountReceived:0,tds:0,balance:"-",status:"",isMain:!0,isCreditNote:!0,hasCN:!0}),br.subRows&&br.subRows.length>0&&br.subRows.forEach(ii=>{ue.push({particular:ii.particular,credit:Math.abs(ii.credit||0),isMain:!1,isCreditNote:!0,hasCN:!0})})}}});const Ne=ue.reduce((ie,rt)=>rt.isMain&&typeof rt.balance=="number"&&rt.balance>0?ie+rt.balance:ie,0),Je=(G||"").trim().toUpperCase(),Ot=pa.find(ie=>ie.partyNameUpper===Je)||{},jt=ge.find(ie=>{var rt;return((rt=ie.partyName)==null?void 0:rt.trim().toUpperCase())===Je}),zt=(jt==null?void 0:jt.statePartyDetails)||Ot.state||"",_n=Ot.gstin||Ya(G,zt),Wr=`
<!DOCTYPE html>
<html>
<head>
  <title>Ledger Account - ${G}</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; font-size: 11px; padding: 20px; }
    .header { text-align: center; margin-bottom: 15px; }
    .firm-name { font-size: 18px; font-weight: bold; color: #1E293B; }
    .firm-address { font-size: 10px; color: #666; margin-top: 2px; }
    .party-section { text-align: center; margin: 15px 0; padding: 10px; border: 1px solid #ddd; background: #f9f9f9; }
    .party-name { font-size: 14px; font-weight: bold; }
    .ledger-title { font-size: 11px; color: #666; }
    .party-address { font-size: 10px; color: #666; margin-top: 5px; }
    .party-gstin { font-size: 10px; color: #1a5276; margin-top: 3px; font-weight: 600; }
    .period { text-align: center; font-size: 11px; margin: 10px 0; font-weight: bold; }
    .totals { display: flex; justify-content: space-around; background: #e8f4fd; padding: 8px; margin-bottom: 10px; font-size: 10px; border: 1px solid #ccc; }
    .totals div { text-align: center; }
    .totals .label { color: #666; }
    .totals .value { font-weight: bold; font-size: 11px; }
    .closing-balance { text-align: center; background: #1E293B; color: white; padding: 10px; margin-bottom: 10px; font-size: 14px; font-weight: bold; }
    table { width: 100%; border-collapse: collapse; font-size: 10px; }
    th { background: #f0f0f0; border: 1px solid #ccc; padding: 6px 4px; text-align: left; font-weight: bold; }
    td { border: 1px solid #ddd; padding: 5px 4px; }
    .text-right { text-align: right; }
    .text-center { text-align: center; }
    .main-row { background: #fff; }
    .main-row-cn { background: #fffbeb; }
    .sub-row { background: #fafafa; }
    .sub-row-cn { background: #fffbeb; }
    .sub-row td { padding-left: 20px; color: #666; font-size: 9px; }
    .opening-row { background: #fef3c7; font-weight: bold; }
    .credit-note-row { background: #fffbeb; }
    .status-received { background: #dcfce7; color: #166534; padding: 2px 6px; border-radius: 3px; font-size: 9px; }
    .status-pending { background: #fef3c7; color: #92400e; padding: 2px 6px; border-radius: 3px; font-size: 9px; }
    .debit { color: #dc2626; }
    .credit { color: #059669; }
    @media print { 
      body { padding: 10px; } 
      @page { size: landscape; margin: 10mm; }
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="firm-name">${S.name}</div>
    <div class="firm-address">${S.address}</div>
    <div class="firm-address">${S.addressLine2}, ${S.city}</div>
    <div class="firm-address">E-Mail: ${S.email}</div>
  </div>
  
  <div class="party-section">
    <div class="party-name">${G}</div>
    <div class="ledger-title">Ledger Account</div>
    ${zt?`<div class="party-address">${zt}</div>`:""}
    ${_n?`<div class="party-gstin">GSTIN: ${_n}</div>`:""}
  </div>
  
  <div class="period">${mr(_r.fromDate)} to ${mr(_r.toDate)}</div>
  
  <div class="closing-balance">
    Closing Balance: ${Vt(Math.abs(Ne))} ${Ne>0?"(Dr)":Ne<0?"(Cr)":""}
  </div>
  
  <div class="totals">
    <div><div class="label">Debit</div><div class="value">${Vt(Te)}</div></div>
    <div><div class="label">Credit</div><div class="value">${Vt(He)}</div></div>
    <div><div class="label">Amount Received</div><div class="value credit">${Vt(ee)}</div></div>
    <div><div class="label">TDS Received</div><div class="value">${Vt(Ke)}</div></div>
  </div>
  
  <table>
    <thead>
      <tr>
        <th style="width:65px">Date</th>
        <th>Particular</th>
        <th style="width:70px" class="text-center">Vch Type</th>
        <th style="width:100px">Vch No.</th>
        <th style="width:80px" class="text-right">Debit</th>
        <th style="width:80px" class="text-right">Credit</th>
        <th style="width:70px" class="text-center">Date of Receipt</th>
        <th style="width:85px" class="text-right">Amount Received</th>
        <th style="width:70px" class="text-right">TDS Received</th>
        <th style="width:75px" class="text-right">Balance</th>
        <th style="width:70px" class="text-center">Payment Status</th>
      </tr>
    </thead>
    <tbody>
      ${ue.map(ie=>ie.isMain?`
        <tr class="${ie.isOpening?"opening-row":ie.hasCN||ie.isCreditNote?"main-row-cn":"main-row"}">
          <td>${ie.date?mr(ie.date):""}</td>
          <td style="font-weight:600">${ie.particular}</td>
          <td class="text-center">${ie.vchType||""}</td>
          <td style="color:#2874A6;font-weight:600">${ie.vchNo||""}</td>
          <td class="text-right">${ie.debit>0?Vt(ie.debit):""}</td>
          <td class="text-right" style="color:#DC2626">${ie.credit>0?Vt(ie.credit):""}</td>
          <td class="text-center">${ie.receiptDate?mr(ie.receiptDate):""}</td>
          <td class="text-right credit">${ie.amountReceived>0?Vt(ie.amountReceived):""}</td>
          <td class="text-right">${ie.tds>0?Vt(ie.tds):""}</td>
          <td class="text-right">${ie.balance==="-"?"-":ie.balance>0?Vt(ie.balance):""}</td>
          <td class="text-center">${ie.status?`<span class="${ie.status==="Received"?"status-received":"status-pending"}">${ie.status}</span>`:""}</td>
        </tr>
      `:`
        <tr class="${ie.hasCN||ie.isCreditNote?"sub-row-cn":"sub-row"}">
          <td></td>
          <td style="padding-left:20px;color:#666">${ie.particular}</td>
          <td></td>
          <td></td>
          <td class="text-right">${ie.debit?Vt(ie.debit):""}</td>
          <td class="text-right">${ie.credit?Vt(ie.credit):""}</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
      `).join("")}
    </tbody>
  </table>
  
  <script>window.onload = function() { window.print(); }<\/script>
</body>
</html>`,_e=window.open("","_blank");_e.document.write(Wr),_e.document.close()},Q4=()=>{const m=R=>{const pe=ti[R]||0,Re=ge.filter(Ne=>Er(Ne.partyName,R)&&Ne.invoiceGenerated&&Ne.invoiceStatus==="Approved"),ue=new Map;Re.forEach(Ne=>{ue.has(Ne.invoiceNo)?ue.get(Ne.invoiceNo).campaigns.push(Ne):ue.set(Ne.invoiceNo,{invoiceNo:Ne.invoiceNo,campaigns:[Ne],totalAmount:parseFloat(Ne.invoiceTotalAmount)||0})});const Te=Q.filter(Ne=>Er(Ne.partyName,R)),He=Be.filter(Ne=>Er(Ne.partyName,R)),ee=Se.filter(Ne=>{var Je;return Er(Ne.partyName,R)&&Ne.isHistorical&&Ne.type!=="creditnote"&&!((Je=Ne.vchNo)!=null&&Je.toUpperCase().startsWith("CN"))}),Ke=Se.filter(Ne=>{var Je;return Er(Ne.partyName,R)&&Ne.isHistorical&&(Ne.type==="creditnote"||((Je=Ne.vchNo)==null?void 0:Je.toUpperCase().startsWith("CN")))}),fe=Ne=>{if(!Ne)return"";const Je=Ne.split("/");return Je.length>=3?Je.slice(1).join("/"):Je.length===2?Je.join("/"):Je[Je.length-1]},Le=new Map;He.forEach(Ne=>{const Je=fe(Ne.invoiceNo);Je&&!Le.has(Je)&&Le.set(Je,Ne)}),Ke.forEach(Ne=>{const Je=fe(Ne.vchNo);Je&&!Le.has(Je)&&Le.set(Je,Ne)});let Qe=0;return pe>0&&(Qe+=pe),Array.from(ue.values()).forEach(Ne=>{const Je=Ne.totalAmount,Ot=fe(Ne.invoiceNo),jt=Le.get(Ot),zt=jt?Math.abs(parseFloat(jt.totalAmount)||parseFloat(jt.credit)||0):0;if(!(jt&&zt>=Je)){let Wr=jt?Je-zt:Je;const _e=Te.find(ie=>ie.invoiceNo===Ne.invoiceNo);if(_e){const ie=Wr-(parseFloat(_e.amount)||0)-(parseFloat(_e.tds)||0)-(parseFloat(_e.discount)||0);ie>0&&(Qe+=ie)}else Wr>0&&(Qe+=Wr)}}),ee.forEach(Ne=>{const Je=fe(Ne.vchNo),Ot=Le.get(Je),jt=Ot?Math.abs(parseFloat(Ot.totalAmount)||parseFloat(Ot.credit)||parseFloat(Ot.debit)||0):0,zt=parseFloat(Ne.debit)||0;if(!(Ot&&jt>=zt)){let Wr=Ot?zt-jt:zt;const _e=parseFloat(Ne.amountReceived)||0,ie=parseFloat(Ne.tdsReceived)||0,rt=Wr-_e-ie;rt>0&&(Qe+=rt)}}),Qe},C=pa.filter(R=>R.partyName.toLowerCase().includes(ua.toLowerCase())||R.state&&R.state.toLowerCase().includes(ua.toLowerCase())),X=R=>{const pe=(R||"").trim().toUpperCase(),Re=ge.find(Te=>{var He;return((He=Te.partyName)==null?void 0:He.trim().toUpperCase())===pe});if(Re!=null&&Re.statePartyDetails)return Re.statePartyDetails;const ue=pa.find(Te=>Te.partyNameUpper===pe);return(ue==null?void 0:ue.state)||""},Z=R=>{const pe=(R||"").trim().toUpperCase(),Re=pa.find(Te=>Te.partyNameUpper===pe);if(Re!=null&&Re.gstin)return Re.gstin;const ue=ge.find(Te=>{var He;return((He=Te.partyName)==null?void 0:He.trim().toUpperCase())===pe});return ue?Ya(R,ue.statePartyDetails):""},re=(()=>{if(!G)return{entries:[],totals:{debit:0,credit:0,received:0,tds:0,balance:0}};const R=ti[G]||0,pe=_e=>{if(!_e)return"";const ie=_e.split("/");return ie.length>=3?ie.slice(1).join("/"):ie.length===2?ie.join("/"):ie[ie.length-1]},Re=ge.filter(_e=>Er(_e.partyName,G)&&_e.invoiceGenerated&&_e.invoiceStatus==="Approved"),ue=new Map;Re.forEach(_e=>{ue.has(_e.invoiceNo)?ue.get(_e.invoiceNo).campaigns.push(_e):ue.set(_e.invoiceNo,{invoiceNo:_e.invoiceNo,invoiceDate:_e.invoiceDate,invoiceType:_e.invoiceType,combinationCode:_e.combinationCode,receiptStatus:_e.receiptStatus,receiptNo:_e.receiptNo,receiptDate:_e.receiptDate,creditNoteNo:_e.creditNoteNo,campaigns:[_e],isFromMaster:!0})});const Te=Se.filter(_e=>{var ie;return Er(_e.partyName,G)&&_e.isHistorical&&_e.type!=="creditnote"&&!((ie=_e.vchNo)!=null&&ie.toUpperCase().startsWith("CN"))}),He=Se.filter(_e=>{var ie;return Er(_e.partyName,G)&&_e.isHistorical&&(_e.type==="creditnote"||((ie=_e.vchNo)==null?void 0:ie.toUpperCase().startsWith("CN")))}),ee=Q.filter(_e=>Er(_e.partyName,G)),Ke=Be.filter(_e=>Er(_e.partyName,G)),fe=new Map;Ke.forEach(_e=>{const ie=pe(_e.invoiceNo);ie&&!fe.has(ie)&&fe.set(ie,{..._e,isSystemCN:!0})}),He.forEach(_e=>{const ie=pe(_e.vchNo);ie&&!fe.has(ie)&&fe.set(ie,{..._e,isHistoricalCN:!0})});const Le=[];let Qe=R,Ne=0,Je=0,Ot=0,jt=0;const zt=new Set;R!==0&&(Le.push({id:"opening",date:"",particular:"Opening Balance",vchType:"",vchNo:"",debit:R>0?R:0,credit:R<0?Math.abs(R):0,receiptDate:"",amountReceived:0,tdsReceived:0,balance:R,paymentStatus:"",isOpening:!0,subRows:[]}),Ne+=R>0?R:0,Je+=R<0?Math.abs(R):0);const _n=[];Array.from(ue.values()).filter(_e=>{const ie=new Date(_e.invoiceDate),rt=new Date(_r.fromDate),pr=new Date(_r.toDate);return ie>=rt&&ie<=pr}).forEach(_e=>{_n.push({..._e,entryType:"invoice",sortDate:_e.invoiceDate})}),Te.filter(_e=>{if(!_e.date)return!1;const ie=new Date(_e.date),rt=new Date(_r.fromDate),pr=new Date(_r.toDate);return ie>=rt&&ie<=pr}).forEach(_e=>{_n.push({..._e,entryType:_e.type||"invoice",sortDate:_e.date})}),_n.sort((_e,ie)=>new Date(_e.sortDate)-new Date(ie.sortDate)),_n.forEach(_e=>{var ie,rt;if(_e.isFromMaster){const pr=_e;let Qt=0;pr.campaigns.forEach(Us=>{Qt+=parseFloat(Us.invoiceAmount)||0});const Ir=(rt=(ie=pr.campaigns[0])==null?void 0:ie.statePartyDetails)==null?void 0:rt.toUpperCase().includes("MAHARASHTRA"),sr=Ir?Qt*.09:0,br=Ir?Qt*.09:0,ni=Ir?0:Qt*.18,Rr=Qt+sr+br+ni,ii=pe(pr.invoiceNo),ar=fe.get(ii),Qr=ar?Math.abs(ar.totalAmount||ar.credit||0):0,Mn=!!ar,ga=Mn&&Qr>=Rr,to=Mn&&!ga?Rr-Qr:0,Ji=ee.find(Us=>Us.invoiceNo===pr.invoiceNo);Qe+=Rr,Ne+=Rr;const Zo=[{particular:"PROMOTIONAL TRADE EMAILER"+(pr.campaigns.length>1?"S":""),credit:Qt}];Ir?(Zo.push({particular:"CGST",credit:sr}),Zo.push({particular:"SGST",credit:br})):Zo.push({particular:"IGST",credit:ni});let Vs="",si=0,ro=0,rd="",ac=Rr;if(Ji?(Vs="Received",si=Ji.amount||0,ro=Ji.tds||0,rd=Ji.date,Ot+=si,jt+=ro,ac=Rr-si-ro-(Ji.discount||0),Qe-=si+ro+(Ji.discount||0)):pr.receiptStatus==="Received"?(Vs="Received",ac=0):ga?(Vs="CN Closed",ac=0):Mn&&to>0?(Vs="Partial CN",ac=to):Vs="Pending",Le.push({id:pr.invoiceNo,date:pr.invoiceDate,particular:G,vchType:"Sales",vchNo:pr.invoiceNo,debit:Rr,credit:0,receiptDate:rd,amountReceived:si,tdsReceived:ro,balance:ga?"-":ac>0?ac:0,paymentStatus:Vs,isInvoice:!0,hasCN:Mn,subRows:Zo}),ar&&!zt.has(ii)){zt.add(ii);const Us=Math.abs(ar.totalAmount||ar.credit||0);Qe-=Us,Je+=Us;const el=[];if(ar.amount&&el.push({particular:"PROMOTIONAL TRADE EMAILER",credit:Math.abs(ar.amount)}),ar.gst&&el.push({particular:ar.gstType||(Ir?"CGST + SGST":"IGST"),credit:Math.abs(ar.gst)}),el.length===0&&Us>0){const dy=Us/1.18,iF=Us-dy;el.push({particular:"PROMOTIONAL TRADE EMAILER",credit:dy}),el.push({particular:Ir?"CGST + SGST":"IGST",credit:iF})}Le.push({id:ar.id||ar.creditNoteNo||`cn-${ii}`,date:ar.date,particular:G,vchType:"Credit Note",vchNo:ar.creditNoteNo||ar.vchNo,debit:0,credit:Us,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:ar.isHistoricalCN&&ar.subRows||el})}}else if(_e.isHistorical){const pr=_e.debit||0,Qt=_e.credit||0,Ir=pe(_e.vchNo),sr=fe.get(Ir),br=sr?Math.abs(sr.totalAmount||sr.credit||0):0,ni=!!sr,Rr=ni&&br>=pr,ii=ni&&!Rr?pr-br:0;Qe+=pr-Qt,Ne+=pr,Je+=Qt,_e.amountReceived&&(Ot+=_e.amountReceived),_e.tdsReceived&&(jt+=_e.tdsReceived);const ar=_e.subRows||[];let Qr=pr-(_e.amountReceived||0)-(_e.tdsReceived||0),Mn=_e.paymentStatus||"";Rr?(Qr=0,Mn="CN Closed"):ni&&ii>0&&(Qr=ii-(_e.amountReceived||0)-(_e.tdsReceived||0),Qr>0&&(Mn="Partial CN")),Le.push({id:_e.id,date:_e.date,particular:_e.particulars||G,vchType:_e.vchType||"Sales",vchNo:_e.vchNo,debit:pr,credit:Qt,receiptDate:_e.receiptDate||"",amountReceived:_e.amountReceived||0,tdsReceived:_e.tdsReceived||0,balance:Rr?"-":Qr>0?Qr:0,paymentStatus:Mn,isInvoice:!0,isHistorical:!0,hasCN:ni,subRows:ar}),sr&&!zt.has(Ir)&&(zt.add(Ir),Qe-=br,Je+=br,Le.push({id:sr.id||sr.creditNoteNo||sr.vchNo||`cn-${Ir}`,date:sr.date,particular:G,vchType:"Credit Note",vchNo:sr.creditNoteNo||sr.vchNo,debit:0,credit:br,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:sr.subRows||[]}))}});const Wr=Le.reduce((_e,ie)=>typeof ie.balance=="number"&&ie.balance>0?_e+ie.balance:_e,0);return{entries:Le,totals:{debit:Ne,credit:Je,received:Ot,tds:jt,balance:Wr}}})();return f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[f.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Party Ledgers"}),f.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[On&&f.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"}),Ut&&f.jsx(Ye,{icon:$s,label:"Import Historical",variant:"brand",onClick:()=>da(!0)}),Ut&&G&&Se.some(R=>Er(R.partyName,G)&&R.isHistorical)&&f.jsx(Ye,{icon:Hs,label:"Clear Historical",variant:"danger",onClick:Za}),Ut&&f.jsx(Ye,{icon:zm,label:"Opening Balance",variant:"primary",onClick:()=>Yr(!0)})]})]}),f.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(OB,{size:18,color:"#64748B"}),f.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Period:"})]}),f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx("input",{type:"date",value:_r.fromDate,onChange:R=>Ki(pe=>({...pe,fromDate:R.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}}),f.jsx("span",{style:{color:"#64748B"},children:"to"}),f.jsx("input",{type:"date",value:_r.toDate,onChange:R=>Ki(pe=>({...pe,toDate:R.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}})]}),f.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:"10px"},children:G&&f.jsx(Ye,{icon:zu,label:"Download PDF",variant:"brand",onClick:q4})})]})}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr",gap:"16px"},children:[f.jsxs(En,{title:"Parties",noPadding:!0,children:[f.jsx("div",{style:{padding:"12px",borderBottom:"1px solid #E2E8F0"},children:f.jsxs("div",{style:{position:"relative"},children:[f.jsx(Pd,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"text",placeholder:"Search party...",value:ua,onChange:R=>$a(R.target.value),style:{width:"100%",padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",boxSizing:"border-box"}})]})}),f.jsx("div",{style:{maxHeight:"450px",overflowY:"auto"},children:C.length===0?f.jsx("div",{style:{padding:"30px",textAlign:"center",color:"#94A3B8",fontSize:"14px"},children:ua?"No matching parties":"No parties yet"}):C.map((R,pe)=>{const Re=m(R.partyName);return f.jsxs("div",{onClick:()=>q(R.partyName),style:{padding:"14px 18px",borderBottom:"1px solid #F1F5F9",cursor:"pointer",backgroundColor:G===R.partyName?"#EFF6FF":"transparent",borderLeft:G===R.partyName?"4px solid #2874A6":"4px solid transparent"},children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"14px",color:"#1E293B"},children:R.partyName}),R.state&&f.jsxs("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"2px"},children:[" ",R.state]}),R.gstin&&f.jsxs("div",{style:{fontSize:"10px",color:"#2874A6",marginTop:"1px"},children:["GST: ",R.gstin]}),f.jsxs("div",{style:{fontSize:"14px",color:Re>0?"#DC2626":"#059669",fontWeight:"700",marginTop:"4px"},children:[Re>0?"Dr. ":"Cr. ",ut(Math.abs(Re))]})]},`${R.partyName}-${R.state}-${pe}`)})})]}),f.jsx(En,{title:G?"Ledger Account":"Select a Party",noPadding:!0,children:G?f.jsxs("div",{style:{fontSize:"12px"},children:[f.jsxs("div",{style:{textAlign:"center",padding:"16px",borderBottom:"2px solid #1E3A5F",backgroundColor:"#F8FAFC"},children:[f.jsx("div",{style:{fontSize:"16px",fontWeight:"700",color:"#1E3A5F"},children:S.name}),f.jsx("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"4px"},children:S.address}),f.jsxs("div",{style:{fontSize:"11px",color:"#64748B"},children:[S.addressLine2,", ",S.city]}),f.jsxs("div",{style:{fontSize:"11px",color:"#64748B"},children:["E-Mail: ",S.email]})]}),f.jsxs("div",{style:{textAlign:"center",padding:"12px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FFFFFF"},children:[f.jsx("div",{style:{fontSize:"14px",fontWeight:"700",color:"#1E293B"},children:G}),f.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#64748B"},children:"Ledger Account"}),X(G)&&f.jsxs("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"4px"},children:[" ",X(G)]}),Z(G)&&f.jsxs("div",{style:{fontSize:"11px",color:"#2874A6",marginTop:"3px",fontWeight:"600"},children:["GSTIN: ",Z(G)]})]}),f.jsx("div",{style:{textAlign:"center",padding:"8px",backgroundColor:"#F1F5F9",borderBottom:"1px solid #E2E8F0"},children:f.jsxs("span",{style:{fontSize:"11px",fontWeight:"600",color:"#475569"},children:[mr(_r.fromDate)," to ",mr(_r.toDate)]})}),f.jsxs("div",{style:{backgroundColor:"#1E293B",color:"white",padding:"12px 16px",display:"flex",justifyContent:"center",alignItems:"center",gap:"12px",borderBottom:"3px solid #F59E0B"},children:[f.jsx("span",{style:{fontSize:"14px",fontWeight:"600"},children:"Closing Balance:"}),f.jsxs("span",{style:{fontSize:"18px",fontWeight:"700",color:re.totals.balance>0?"#FCA5A5":"#86EFAC"},children:[Vt(Math.abs(re.totals.balance))," ",re.totals.balance>0?"(Dr)":re.totals.balance<0?"(Cr)":""]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",backgroundColor:"#EFF6FF",borderBottom:"2px solid #2874A6",fontSize:"11px"},children:[f.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[f.jsx("div",{style:{color:"#64748B"},children:"Debit"}),f.jsx("div",{style:{fontWeight:"700",color:"#1E293B"},children:Vt(re.totals.debit)})]}),f.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[f.jsx("div",{style:{color:"#64748B"},children:"Credit"}),f.jsx("div",{style:{fontWeight:"700",color:"#DC2626"},children:Vt(re.totals.credit)})]}),f.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[f.jsx("div",{style:{color:"#64748B"},children:"Amount Received"}),f.jsx("div",{style:{fontWeight:"700",color:"#059669"},children:Vt(re.totals.received)})]}),f.jsxs("div",{style:{padding:"8px",textAlign:"center"},children:[f.jsx("div",{style:{color:"#64748B"},children:"TDS Received"}),f.jsx("div",{style:{fontWeight:"700",color:"#1E293B"},children:Vt(re.totals.tds)})]})]}),f.jsx("div",{style:{overflowX:"auto"},children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px",minWidth:"1000px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[f.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",width:"75px",borderRight:"1px solid #E2E8F0"},children:"Date"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",minWidth:"150px",borderRight:"1px solid #E2E8F0"},children:"Particular"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"80px",borderRight:"1px solid #E2E8F0"},children:"Vch Type"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",width:"110px",borderRight:"1px solid #E2E8F0"},children:"Vch No."}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Debit"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Credit"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"85px",borderRight:"1px solid #E2E8F0"},children:"Date of Receipt"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Amount Received"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"80px",borderRight:"1px solid #E2E8F0"},children:"TDS Received"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"85px",borderRight:"1px solid #E2E8F0"},children:"Balance"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"75px",borderRight:"1px solid #E2E8F0"},children:"Payment Status"}),Ut&&f.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"50px"},children:"Action"})]})}),f.jsx("tbody",{children:re.entries.length===0?f.jsx("tr",{children:f.jsx("td",{colSpan:Ut?"12":"11",style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:"No entries in selected period"})}):re.entries.map(R=>f.jsxs(Wd.Fragment,{children:[f.jsxs("tr",{style:{backgroundColor:R.isOpening?"#FEF3C7":R.hasCN||R.isCreditNote?"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #E2E8F0",borderLeft:R.hasCN||R.isCreditNote?"4px solid #F59E0B":"none"},children:[f.jsx("td",{style:{padding:"8px",borderRight:"1px solid #E2E8F0"},children:R.date?mr(R.date):""}),f.jsx("td",{style:{padding:"8px",fontWeight:"600",color:R.isCreditNote?"#DC2626":"#1E293B",borderRight:"1px solid #E2E8F0"},children:R.particular}),f.jsx("td",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #E2E8F0"},children:R.vchType&&f.jsx("span",{style:{padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:R.vchType==="Sales"?"#DCFCE7":"#FEE2E2",color:R.vchType==="Sales"?"#166534":"#991B1B"},children:R.vchType})}),f.jsx("td",{style:{padding:"8px",borderRight:"1px solid #E2E8F0"},children:R.vchNo&&R.isInvoice&&!R.isHistorical?f.jsx("button",{onClick:()=>eo(R.vchNo),style:{background:"none",border:"none",padding:0,fontWeight:"600",color:"#2874A6",cursor:"pointer",textDecoration:"underline",fontSize:"11px"},title:"Click to view invoice",children:R.vchNo}):f.jsx("span",{style:{fontWeight:"600",color:R.isCreditNote?"#DC2626":"#2874A6"},children:R.vchNo})}),f.jsx("td",{style:{padding:"8px",textAlign:"right",fontWeight:"600",borderRight:"1px solid #E2E8F0"},children:R.debit>0?Vt(R.debit):""}),f.jsx("td",{style:{padding:"8px",textAlign:"right",color:"#DC2626",borderRight:"1px solid #E2E8F0"},children:R.credit>0?Vt(R.credit):""}),f.jsx("td",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #E2E8F0"},children:R.receiptDate?mr(R.receiptDate):""}),f.jsx("td",{style:{padding:"8px",textAlign:"right",color:"#059669",fontWeight:R.amountReceived>0?"600":"400",borderRight:"1px solid #E2E8F0"},children:R.amountReceived>0?Vt(R.amountReceived):""}),f.jsx("td",{style:{padding:"8px",textAlign:"right",borderRight:"1px solid #E2E8F0"},children:R.tdsReceived>0?Vt(R.tdsReceived):""}),f.jsx("td",{style:{padding:"8px",textAlign:"right",fontWeight:"600",color:typeof R.balance=="number"&&R.balance>0?"#DC2626":"",borderRight:"1px solid #E2E8F0"},children:R.isOpening?R.balance>0?Vt(R.balance):"":R.balance==="-"?"-":typeof R.balance=="number"&&R.balance>0?Vt(R.balance):"-"}),f.jsx("td",{style:{padding:"8px",textAlign:"center"},children:R.paymentStatus&&f.jsx("span",{style:{padding:"2px 8px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:R.paymentStatus==="Received"?"#DCFCE7":"#FEF3C7",color:R.paymentStatus==="Received"?"#166534":"#92400E"},children:R.paymentStatus})}),Ut&&f.jsx("td",{style:{padding:"8px",textAlign:"center"},children:R.isHistorical&&!R.isOpening&&f.jsx("button",{onClick:()=>Q0(Se.find(pe=>pe.id===R.id)),style:{padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete historical entry",children:""})})]}),R.subRows&&R.subRows.length>0&&R.subRows.map((pe,Re)=>f.jsxs("tr",{style:{backgroundColor:R.isOpening?"#FEF3C7":R.hasCN||R.isCreditNote?"#FFFBEB":"#FFFFFF",borderBottom:Re===R.subRows.length-1?"2px solid #CBD5E1":"1px solid #E2E8F0",borderLeft:R.hasCN||R.isCreditNote?"4px solid #F59E0B":"none"},children:[f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px 6px 30px",color:"#475569",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:pe.particular}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:pe.debit?Vt(pe.debit):""}),f.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:pe.credit?Vt(pe.credit):""}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),Ut&&f.jsx("td",{style:{padding:"6px 8px"}})]},`${R.id}-sub-${Re}`))]},R.id))})]})})]}):f.jsx("div",{style:{padding:"60px",textAlign:"center",color:"#94A3B8"},children:"Select a party to view ledger"})})]})]})},[sc,cy]=ve.useState(""),ed=ve.useMemo(()=>{const m=new Map,C=J=>{if(!J)return"";const re=J.split("/");return re.length>=3?re.slice(1).join("/"):re.length===2?re.join("/"):re[re.length-1]},X=xi.filter(J=>{var re;return J.isHistorical&&(J.type==="creditnote"||((re=J.vchNo)==null?void 0:re.toUpperCase().startsWith("CN")))}),Z=new Map;return Yl.forEach(J=>{const re=C(J.invoiceNo);re&&Z.set(re,J)}),X.forEach(J=>{const re=C(J.vchNo);re&&!Z.has(re)&&Z.set(re,J)}),sn.filter(J=>J.invoiceGenerated&&J.invoiceStatus==="Approved").forEach(J=>{if(m.has(J.invoiceNo))m.has(J.invoiceNo)&&m.get(J.invoiceNo).campaigns.push(J);else{const re=_s.find(Te=>Te.invoiceNo===J.invoiceNo),R=Yl.find(Te=>Te.invoiceNo===J.invoiceNo),pe=parseFloat(J.invoiceTotalAmount)||0,Re=R?Math.abs(parseFloat(R.totalAmount)||parseFloat(R.credit)||0):0,ue=R&&Re>=pe;if(!re&&!ue){const Te=R?pe-Re:pe;m.set(J.invoiceNo,{invoiceNo:J.invoiceNo,partyName:J.partyName,invoiceDate:J.invoiceDate,invoiceTotalAmount:J.invoiceTotalAmount,pendingAmount:Te,hasPartialCN:!!R&&!ue&&Re>0,cnAmount:Re,subject:J.subject,campaigns:[J],isHistorical:!1,invoiceType:J.invoiceType||"Individual"})}}}),xi.filter(J=>{var re;return J.isHistorical&&J.type!=="creditnote"&&!((re=J.vchNo)!=null&&re.toUpperCase().startsWith("CN"))&&J.debit>0}).forEach(J=>{if(!m.has(J.vchNo)){const re=_s.find(Ke=>Ke.invoiceNo===J.vchNo),R=C(J.vchNo),pe=Z.get(R),Re=pe?Math.abs(parseFloat(pe.totalAmount)||parseFloat(pe.credit)||parseFloat(pe.debit)||0):0,ue=parseFloat(J.debit)||0,Te=pe&&Re>=ue;if(re||Te)return;const He=!(J.amountReceived>0),ee=pe&&Re>0&&Re<ue;if(He||ee){const Ke=ee?ue-Re:ue;m.set(J.vchNo,{invoiceNo:J.vchNo,partyName:J.partyName,invoiceDate:J.date,invoiceTotalAmount:ue,pendingAmount:Ke,hasPartialCN:ee,cnAmount:Re,subject:J.particulars||J.narration,campaigns:[],isHistorical:!0})}}}),Array.from(m.values()).sort((J,re)=>J.partyName.localeCompare(re.partyName))},[sn,_s,Yl,xi]),J4=ve.useMemo(()=>{const m={};return ql.forEach(C=>{m[C.invoiceNo]||(m[C.invoiceNo]=[]),m[C.invoiceNo].push(C)}),Object.keys(m).forEach(C=>{m[C].sort((X,Z)=>new Date(Z.followupDate)-new Date(X.followupDate))}),m},[ql]),uy=ve.useMemo(()=>{const m=new Date().toISOString().split("T")[0];return ql.filter(C=>C.nextFollowupDate&&C.nextFollowupDate>=m).sort((C,X)=>new Date(C.nextFollowupDate)-new Date(X.nextFollowupDate))},[ql]),td=ve.useMemo(()=>{let m=ed;if(sc){const X=sc.toLowerCase();m=ed.filter(Z=>{var J,re,R;return((J=Z.invoiceNo)==null?void 0:J.toLowerCase().includes(X))||((re=Z.partyName)==null?void 0:re.toLowerCase().includes(X))||((R=Z.subject)==null?void 0:R.toLowerCase().includes(X))})}const C={};return m.forEach(X=>{C[X.partyName]||(C[X.partyName]={partyName:X.partyName,invoices:[],totalAmount:0}),C[X.partyName].invoices.push(X),C[X.partyName].totalAmount+=parseFloat(X.pendingAmount||X.invoiceTotalAmount)||0}),Object.values(C).sort((X,Z)=>X.partyName.localeCompare(Z.partyName))},[ed,sc]),Z4=()=>{const m=td.reduce((C,X)=>C+X.invoices.length,0);return f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[f.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Followups"}),f.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[f.jsxs("span",{style:{padding:"6px 12px",backgroundColor:"#EFF6FF",borderRadius:"6px",fontSize:"12px",color:"#1E40AF",fontWeight:"600"},children:[td.length," Parties | ",m," Invoices"]}),On&&f.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"})]})]}),f.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(Vm,{size:18,color:"#64748B"}),f.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Search:"})]}),f.jsxs("div",{style:{position:"relative",flex:1,maxWidth:"300px"},children:[f.jsx(Pd,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"text",placeholder:"Search party, invoice, subject...",value:sc,onChange:C=>cy(C.target.value),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"100%"}})]}),sc&&f.jsxs("button",{onClick:()=>cy(""),style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(nl,{size:14})," Clear"]}),sc&&f.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",m," of ",ed.length]})]})}),uy.length>0&&f.jsx(En,{title:" Upcoming Followups",style:{marginBottom:"16px"},children:f.jsx("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:uy.slice(0,5).map(C=>f.jsxs("div",{style:{padding:"10px 14px",backgroundColor:new Date(C.nextFollowupDate).toISOString().split("T")[0]===new Date().toISOString().split("T")[0]?"#FEE2E2":"#FEF3C7",borderRadius:"8px",border:"1px solid #FCD34D"},children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#92400E"},children:C.invoiceNo}),f.jsx("div",{style:{fontSize:"11px",color:"#78716C"},children:C.partyName}),f.jsxs("div",{style:{fontSize:"12px",fontWeight:"600",color:"#DC2626",marginTop:"4px"},children:[" ",mr(C.nextFollowupDate)]})]},C.id))})}),td.length===0?f.jsx(En,{children:f.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:" No pending invoices! All payments received."})}):td.map(C=>f.jsxs(En,{style:{marginBottom:"16px"},noPadding:!0,children:[f.jsxs("div",{style:{padding:"12px 16px",backgroundColor:"#1E293B",color:"white",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[f.jsxs("span",{style:{fontSize:"15px",fontWeight:"700"},children:[" ",C.partyName]}),f.jsxs("span",{style:{padding:"3px 10px",backgroundColor:"#3B82F6",borderRadius:"12px",fontSize:"11px",fontWeight:"600"},children:[C.invoices.length," Invoice",C.invoices.length>1?"s":""]})]}),f.jsxs("div",{style:{fontSize:"14px",fontWeight:"700",color:"#FCD34D"},children:["Total: ",ut(C.totalAmount)]})]}),f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[f.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Type"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Invoice Date"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:"Amount"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Days Pending"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Last Followup"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),f.jsx("tbody",{children:C.invoices.map(X=>{var pe,Re,ue;const Z=J4[X.invoiceNo]||[],J=Z[0],re=Math.floor((new Date-new Date(X.invoiceDate))/(1e3*60*60*24)),R=X.isHistorical?"Historical":X.invoiceType||(((pe=X.campaigns)==null?void 0:pe.length)>1?"Combined":"Individual");return f.jsxs(Wd.Fragment,{children:[f.jsxs("tr",{style:{borderBottom:"1px solid #E2E8F0",backgroundColor:re>30?"#FEF2F2":re>15?"#FFFBEB":"#FFFFFF"},children:[f.jsxs("td",{style:{padding:"10px 12px",fontWeight:"600",color:"#2874A6"},children:[X.invoiceNo,X.hasPartialCN&&f.jsx("span",{style:{marginLeft:"6px",padding:"2px 6px",backgroundColor:"#FEF3C7",color:"#92400E",borderRadius:"4px",fontSize:"9px",fontWeight:"700"},children:"Partial CN"})]}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsx("span",{style:{padding:"3px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"600",backgroundColor:R==="Historical"?"#E0E7FF":R==="Combined"?"#F3E8FF":"#DCFCE7",color:R==="Historical"?"#3730A3":R==="Combined"?"#7C3AED":"#166534"},children:R})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:mr(X.invoiceDate)}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600"},children:X.hasPartialCN?f.jsxs("div",{children:[f.jsx("div",{style:{color:"#DC2626"},children:ut(X.pendingAmount)}),f.jsx("div",{style:{fontSize:"9px",color:"#64748B",textDecoration:"line-through"},children:ut(X.invoiceTotalAmount)})]}):ut(X.invoiceTotalAmount)}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsxs("span",{style:{padding:"3px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"700",backgroundColor:re>30?"#FEE2E2":re>15?"#FEF3C7":"#DCFCE7",color:re>30?"#991B1B":re>15?"#92400E":"#166534"},children:[re," days"]})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center",fontSize:"11px"},children:J?f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:"600"},children:mr(J.followupDate)}),f.jsxs("div",{style:{color:"#64748B",fontSize:"10px"},children:[(Re=J.notes)==null?void 0:Re.substring(0,30),((ue=J.notes)==null?void 0:ue.length)>30?"...":""]})]}):f.jsx("span",{style:{color:"#DC2626",fontWeight:"600"},children:"No followup yet"})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsxs("div",{style:{display:"flex",gap:"4px",justifyContent:"center"},children:[Ut&&f.jsx(Ye,{icon:zm,small:!0,variant:"primary",onClick:()=>u(X),title:"Add Followup"}),f.jsx(Ye,{icon:jm,small:!0,variant:"brand",onClick:()=>se(X),title:"Copy Email Template"}),f.jsx(Ye,{icon:Um,small:!0,variant:"success",onClick:()=>he(X),title:"Search in Gmail"})]})})]}),Z.length>0&&f.jsx("tr",{children:f.jsxs("td",{colSpan:"7",style:{padding:"8px 12px 12px 40px",backgroundColor:"#F8FAFC"},children:[f.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#64748B",marginBottom:"6px"},children:"Followup History:"}),f.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:Z.map(Te=>f.jsxs("div",{style:{padding:"6px 10px",backgroundColor:"#FFFFFF",borderRadius:"6px",border:"1px solid #E2E8F0",fontSize:"11px"},children:[f.jsx("div",{style:{fontWeight:"600",color:"#2874A6"},children:mr(Te.followupDate)}),f.jsx("div",{style:{color:"#475569",marginTop:"2px"},children:Te.notes}),Te.nextFollowupDate&&f.jsxs("div",{style:{color:"#DC2626",marginTop:"2px",fontSize:"10px"},children:["Next: ",mr(Te.nextFollowupDate)]}),Ut&&f.jsx("button",{onClick:()=>k(Te.id),style:{background:"none",border:"none",color:"#DC2626",cursor:"pointer",fontSize:"10px",padding:"2px 0",marginTop:"4px"},children:" Delete"})]},Te.id))})]})})]},X.invoiceNo)})})]})]},C.partyName))]})},fy=()=>{const m=ge.filter(J=>J.invoiceGenerated).reduce((J,re)=>J+(parseFloat(re.invoiceTotalAmount)||0),0),C=ge.filter(J=>J.invoiceStatus==="Paid").reduce((J,re)=>J+(parseFloat(re.invoiceTotalAmount)||0),0),X=ge.filter(J=>J.invoiceStatus==="Approved").reduce((J,re)=>J+(parseFloat(re.invoiceTotalAmount)||0),0),Z=ge.filter(J=>J.invoiceStatus==="Need Edits").length;return f.jsxs("div",{children:[f.jsx("h1",{style:{margin:"0 0 16px",fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Reports"}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px"},children:[f.jsxs(En,{children:[f.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Total Invoiced"}),f.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:ut(m)})]}),f.jsxs(En,{children:[f.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Approved"}),f.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669"},children:ut(X)})]}),f.jsxs(En,{children:[f.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Need Edits"}),f.jsxs("div",{style:{fontSize:"24px",fontWeight:"700",color:"#DC2626"},children:[Z," invoices"]})]}),f.jsxs(En,{children:[f.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Paid"}),f.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669"},children:ut(C)})]})]})]})},eF=()=>f.jsxs("div",{children:[f.jsx("h1",{style:{margin:"0 0 16px",fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Settings"}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[f.jsxs(En,{title:" Invoice Series",children:[f.jsx(gr,{label:"Invoice Prefix",value:S.invoicePrefix,onChange:m=>b(C=>({...C,invoicePrefix:m.target.value})),small:!0}),f.jsx(gr,{label:"Next Invoice Number",type:"number",value:Y,onChange:m=>de(parseInt(m.target.value)||1),small:!0}),f.jsx(gr,{label:"Next Combine Code",type:"number",value:Ae,onChange:m=>Pe(parseInt(m.target.value)||1),small:!0}),f.jsxs("div",{style:{padding:"10px",backgroundColor:"#EFF6FF",borderRadius:"8px",fontSize:"14px"},children:[f.jsx("strong",{children:"Preview:"})," ",S.invoicePrefix,Y]})]}),f.jsxs(En,{title:" Mailer Logo",children:[f.jsx("input",{type:"file",ref:Tu,accept:"image/*",style:{display:"none"},onChange:z4}),gn?f.jsxs("div",{style:{textAlign:"center"},children:[f.jsx("img",{src:gn,alt:"Logo",style:{maxWidth:"250px",maxHeight:"60px",marginBottom:"12px",border:"1px solid #E2E8F0",padding:"8px",borderRadius:"8px"}}),f.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"center"},children:[f.jsx(Ye,{icon:zB,label:"Change",small:!0,onClick:()=>{var m;return(m=Tu.current)==null?void 0:m.click()}}),f.jsx(Ye,{icon:Hs,label:"Remove",variant:"danger",small:!0,onClick:()=>Fi(null)})]})]}):f.jsxs("div",{onClick:()=>{var m;return(m=Tu.current)==null?void 0:m.click()},style:{border:"2px dashed #CBD5E1",borderRadius:"10px",padding:"30px",textAlign:"center",cursor:"pointer"},children:[f.jsx($s,{size:32,color:"#94A3B8",style:{marginBottom:"8px"}}),f.jsx("p",{style:{margin:0,color:"#64748B",fontSize:"14px"},children:"Click to upload"})]})]}),f.jsxs(En,{title:" WhatsApp Notifications",children:[f.jsx("div",{style:{marginBottom:"16px"},children:f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"10px",cursor:"pointer"},children:[f.jsx("input",{type:"checkbox",checked:ne.enabled,onChange:m=>oe(C=>({...C,enabled:m.target.checked})),style:{width:"18px",height:"18px",cursor:"pointer"}}),f.jsx("span",{style:{fontSize:"14px",fontWeight:"600",color:"#1E293B"},children:"Enable WhatsApp Notifications"})]})}),ne.enabled&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{style:{padding:"12px",backgroundColor:"#DCFCE7",borderRadius:"8px",marginBottom:"16px",fontSize:"12px",color:"#166534",border:"1px solid #86EFAC"},children:[f.jsx("strong",{children:" FREE Setup using CallMeBot:"}),f.jsx("br",{}),"1. Save this number in contacts: ",f.jsx("strong",{children:"+34 644 71 81 99"}),f.jsx("br",{}),"2. Send this message to the number on WhatsApp: ",f.jsx("strong",{children:'"I allow callmebot to send me messages"'}),f.jsx("br",{}),"3. You'll receive an API key - enter it below",f.jsx("br",{}),"4. Repeat for each phone number you want to receive notifications"]}),f.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",marginBottom:"12px",border:"1px solid #E2E8F0"},children:[f.jsxs("div",{style:{fontSize:"13px",fontWeight:"700",color:"#1E293B",marginBottom:"10px",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(Dd,{size:16})," Finance Team"]}),f.jsx(gr,{label:"Phone (with country code)",value:ne.financePhone,onChange:m=>oe(C=>({...C,financePhone:m.target.value})),placeholder:"919876543210",small:!0}),f.jsx(gr,{label:"API Key (from CallMeBot)",value:ne.financeApiKey,onChange:m=>oe(C=>({...C,financeApiKey:m.target.value})),placeholder:"123456",small:!0}),ne.financePhone&&ne.financeApiKey&&f.jsx(Ye,{icon:j2,label:"Test Finance",variant:"success",small:!0,onClick:()=>z0(ne.financePhone,ne.financeApiKey)})]}),f.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",border:"1px solid #E2E8F0"},children:[f.jsxs("div",{style:{fontSize:"13px",fontWeight:"700",color:"#1E293B",marginBottom:"10px",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(Dd,{size:16})," Director"]}),f.jsx(gr,{label:"Phone (with country code)",value:ne.directorPhone,onChange:m=>oe(C=>({...C,directorPhone:m.target.value})),placeholder:"919876543210",small:!0}),f.jsx(gr,{label:"API Key (from CallMeBot)",value:ne.directorApiKey,onChange:m=>oe(C=>({...C,directorApiKey:m.target.value})),placeholder:"123456",small:!0}),ne.directorPhone&&ne.directorApiKey&&f.jsx(Ye,{icon:j2,label:"Test Director",variant:"success",small:!0,onClick:()=>z0(ne.directorPhone,ne.directorApiKey)})]})]}),!ne.enabled&&f.jsx("div",{style:{padding:"20px",backgroundColor:"#F8FAFC",borderRadius:"8px",textAlign:"center",color:"#64748B",fontSize:"13px"},children:"WhatsApp notifications are disabled. Enable to receive FREE alerts for invoices, approvals, and payments."})]}),f.jsxs(En,{title:" Default Invoice Values",children:[f.jsx("input",{type:"file",ref:B0,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:Ue}),f.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[f.jsx(Ye,{icon:$s,label:"Upload",variant:"brand",small:!0,onClick:()=>{var m;return(m=B0.current)==null?void 0:m.click()}}),f.jsx(Ye,{icon:zu,label:"Template",small:!0,onClick:Wt})]}),Object.keys(gs).length>0&&f.jsx("div",{style:{maxHeight:"180px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"8px"},children:Object.entries(gs).map(([m,C])=>f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px 14px",borderBottom:"1px solid #F1F5F9",fontSize:"13px"},children:[f.jsx("span",{children:m}),f.jsx("span",{style:{fontWeight:"700"},children:ut(C)})]},m))})]}),f.jsxs(En,{title:" Party Master",children:[f.jsx("input",{type:"file",ref:ys,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:qr}),f.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[f.jsx(Ye,{icon:$s,label:"Upload Parties",variant:"brand",small:!0,onClick:()=>{var m;return(m=ys.current)==null?void 0:m.click()}}),f.jsx(Ye,{icon:zu,label:"Template",small:!0,onClick:Ft})]}),f.jsxs("div",{style:{padding:"10px",backgroundColor:"#EFF6FF",borderRadius:"8px",fontSize:"12px",color:"#1E40AF",marginBottom:"12px"},children:[f.jsx("strong",{children:"Upload Format:"})," Name of Ledger, Ledger Group, State Name, GST Registration Type, GSTIN/UIN"]}),Object.keys(yn).length>0&&f.jsxs("div",{style:{maxHeight:"150px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"8px"},children:[Object.entries(yn).slice(0,20).map(([m,C])=>f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 12px",borderBottom:"1px solid #F1F5F9",fontSize:"11px"},children:[f.jsx("span",{style:{fontWeight:"600"},children:m.length>30?m.substring(0,30)+"...":m}),f.jsxs("span",{style:{color:"#64748B"},children:[C.stateName||"-"," | ",C.gstin?C.gstin.substring(0,10)+"...":"-"]})]},m)),Object.keys(yn).length>20&&f.jsxs("div",{style:{padding:"8px 12px",textAlign:"center",color:"#64748B",fontSize:"11px"},children:["... and ",Object.keys(yn).length-20," more parties"]})]}),Object.keys(yn).length===0&&f.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#94A3B8",fontSize:"13px"},children:"No party master uploaded yet"})]}),f.jsxs(En,{title:" Data Management",children:[f.jsxs("div",{style:{padding:"16px",backgroundColor:"#FEF2F2",borderRadius:"10px",border:"1px solid #FCA5A5",marginBottom:"16px"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"14px",marginBottom:"8px"},children:" Danger Zone"}),f.jsxs("div",{style:{fontSize:"13px",color:"#7F1D1D",marginBottom:"16px"},children:["This will permanently delete all data including:",f.jsxs("ul",{style:{margin:"8px 0 0 16px",padding:0},children:[f.jsx("li",{children:"All campaigns and master data"}),f.jsx("li",{children:"All invoices and receipts"}),f.jsx("li",{children:"All ledger entries"}),f.jsx("li",{children:"All mailer images"}),f.jsx("li",{children:"Opening balances and settings"})]})]}),f.jsx(Ye,{icon:Hs,label:"Clear All Data",variant:"danger",onClick:()=>Dn(!0)})]}),f.jsxs("div",{style:{fontSize:"12px",color:"#64748B"},children:[f.jsx("strong",{children:"Current Data:"}),f.jsx("br",{})," ",ge.length," campaigns",f.jsx("br",{})," ",Se.length," ledger entries",f.jsx("br",{})," ",Q.length," receipts",f.jsx("br",{})," ",Object.keys(wt).length," mailer images"]})]})]})]}),tF=()=>f.jsxs(f.Fragment,{children:[f.jsx(wn,{isOpen:W4,onClose:()=>{ny(!1),sy("")},title:" Invoice Preview",width:"950px",children:ae&&iy&&f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px",padding:"14px 18px",backgroundColor:"#DCFCE7",borderRadius:"10px",border:"2px solid #22C55E"},children:[f.jsxs("div",{children:[f.jsxs("span",{style:{fontWeight:"700",fontSize:"16px",color:"#166534"},children:["Invoice: ",ae.invoiceNo]}),ae.invoiceType==="Combined"&&f.jsxs("span",{style:{marginLeft:"12px",padding:"4px 10px",backgroundColor:"#7C3AED",color:"white",borderRadius:"6px",fontSize:"12px",fontWeight:"600"},children:["Combined - C",ae.combinationCode]})]}),f.jsxs("button",{onClick:()=>$4(ae),style:{padding:"14px 28px",fontSize:"16px",fontWeight:"bold",border:"none",borderRadius:"10px",cursor:"pointer",backgroundColor:"#22C55E",color:"white",display:"flex",alignItems:"center",gap:"10px",boxShadow:"0 2px 8px rgba(34, 197, 94, 0.4)"},children:[f.jsx(zu,{size:20}),"Download Invoice"]})]}),f.jsx("div",{style:{border:"2px solid #E2E8F0",borderRadius:"10px",overflow:"hidden",backgroundColor:"#f5f5f5"},children:f.jsx("iframe",{id:"invoice-viewer-iframe",srcDoc:iy,style:{width:"100%",height:"480px",border:"none",backgroundColor:"white"},title:"Invoice Preview"})}),f.jsxs("div",{style:{marginTop:"12px",padding:"14px 18px",backgroundColor:"#FEF3C7",borderRadius:"10px",border:"1px solid #FCD34D"},children:[f.jsx("div",{style:{fontSize:"14px",color:"#92400E",fontWeight:"600",marginBottom:"6px"},children:" How to Save as PDF:"}),f.jsxs("ol",{style:{fontSize:"13px",color:"#92400E",margin:"0",paddingLeft:"20px",lineHeight:"1.8"},children:[f.jsxs("li",{children:["Click ",f.jsx("strong",{children:'"Download Invoice"'})," button above"]}),f.jsxs("li",{children:["Open the downloaded ",f.jsx("strong",{children:".html file"})," in Chrome/Edge browser"]}),f.jsxs("li",{children:["Print dialog will open automatically - select ",f.jsx("strong",{children:'"Save as PDF"'})]}),f.jsxs("li",{children:["Click ",f.jsx("strong",{children:"Save"})," to get your PDF!"]})]})]})]})}),f.jsx(wn,{isOpen:mi,onClose:()=>{Pt(!1),Gi(""),Ie({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1})},title:On?" Review & Approve Invoice":" Invoice Details",width:"550px",children:ae&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice:"})," ",ae.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Party:"})," ",ae.partyName]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Amount:"})," ",ut(ae.invoiceTotalAmount)]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Email:"})," ",ae.emailId||"Not set"]}),f.jsxs("div",{style:{fontSize:"14px"},children:[f.jsx("strong",{children:"Invoice Type:"})," ",f.jsx("span",{style:{color:ae.invoiceType==="Combined"?"#7C3AED":"#2874A6",fontWeight:"600"},children:ae.invoiceType||"Individual"})]}),ae.invoiceType==="Combined"&&f.jsxs("div",{style:{marginTop:"8px",fontSize:"13px",color:"#7C3AED"},children:[f.jsx("strong",{children:"Combined Campaigns:"})," ",js(ae).map(m=>m.senderName).join(", ")]})]}),ae.editComments&&f.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[f.jsx("div",{style:{fontWeight:"600",color:"#991B1B",fontSize:"13px",marginBottom:"4px"},children:" Need Edits - Director Remarks:"}),f.jsx("div",{style:{fontSize:"13px",color:"#7F1D1D"},children:ae.editComments})]}),ae.approvalRemarks&&ae.invoiceStatus==="Approved"&&f.jsxs("div",{style:{backgroundColor:"#DCFCE7",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[f.jsx("div",{style:{fontWeight:"600",color:"#166534",fontSize:"13px",marginBottom:"4px"},children:" Approved - Director Remarks:"}),f.jsx("div",{style:{fontSize:"13px",color:"#15803D"},children:ae.approvalRemarks})]}),On?f.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#166534",fontSize:"14px",marginBottom:"12px"},children:" Approval Confirmations"}),f.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",marginBottom:"12px",cursor:"pointer"},children:[f.jsx("input",{type:"checkbox",checked:Ge.particularsApproved,onChange:m=>Ie(C=>({...C,particularsApproved:m.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"1. Particulars & Amount Approved"}),f.jsxs("div",{style:{fontSize:"12px",color:"#15803D"},children:["I confirm that the invoice particulars and amount (",ut(ae.invoiceTotalAmount),") are correct."]})]})]}),f.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",marginBottom:"12px",cursor:"pointer"},children:[f.jsx("input",{type:"checkbox",checked:Ge.emailApproved,onChange:m=>Ie(C=>({...C,emailApproved:m.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"2. Email ID Approved for Mailing"}),f.jsxs("div",{style:{fontSize:"12px",color:"#15803D"},children:["I confirm that ",f.jsx("strong",{children:ae.emailId||"the specified email"})," should be used for mailing."]})]})]}),f.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",cursor:"pointer"},children:[f.jsx("input",{type:"checkbox",checked:Ge.invoiceTypeApproved,onChange:m=>Ie(C=>({...C,invoiceTypeApproved:m.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"3. Invoice Type Confirmed"}),f.jsx("div",{style:{fontSize:"12px",color:"#15803D"},children:ae.invoiceType==="Combined"?`I confirm that a Combined Invoice is required for these ${js(ae).length} campaigns.`:"I confirm that an Individual Invoice is required (not combined with others)."})]})]})]}):f.jsxs("div",{style:{backgroundColor:ae.invoiceStatus==="Approved"?"#DCFCE7":ae.invoiceStatus==="Need Edits"?"#FEF3C7":"#F8FAFC",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid "+(ae.invoiceStatus==="Approved"?"#86EFAC":ae.invoiceStatus==="Need Edits"?"#FCD34D":"#E2E8F0")},children:[f.jsx("div",{style:{fontWeight:"600",color:ae.invoiceStatus==="Approved"?"#166534":ae.invoiceStatus==="Need Edits"?"#92400E":"#64748B",fontSize:"14px"},children:ae.invoiceStatus==="Approved"?" Approved by Director":ae.invoiceStatus==="Need Edits"?" Edits Required by Director":" Pending Director Approval"}),f.jsx("div",{style:{fontSize:"13px",color:ae.invoiceStatus==="Approved"?"#15803D":ae.invoiceStatus==="Need Edits"?"#A16207":"#64748B",marginTop:"6px"},children:ae.invoiceStatus==="Approved"?"This invoice has been approved and is ready for mailing.":ae.invoiceStatus==="Need Edits"?"Please make the required changes and resubmit for approval.":"This invoice is awaiting Director approval."})]}),On&&f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:" Remarks (optional for Approve, visible to Finance)"}),f.jsx("textarea",{value:ki,onChange:m=>Gi(m.target.value),placeholder:"Enter remarks or comments...",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[f.jsx(Ye,{label:"Close",onClick:()=>{Pt(!1),Gi(""),Ie({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1})}}),On&&f.jsxs(f.Fragment,{children:[f.jsx(Ye,{label:"Need Edits",variant:"danger",icon:UB,onClick:K0}),f.jsx(Ye,{label:"Approve",variant:"success",icon:HB,onClick:tc})]})]})]})}),f.jsx(wn,{isOpen:vr,onClose:()=>nr(!1),title:" Delete Invoice",width:"450px",children:ae&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"15px",marginBottom:"8px"},children:" Are you sure?"}),f.jsxs("div",{style:{fontSize:"14px",color:"#7F1D1D",lineHeight:"1.5"},children:["This will delete invoice ",f.jsx("strong",{children:ae.invoiceNo})," and reset the campaign(s) to allow re-generation.",ae.invoiceType==="Combined"&&f.jsxs("div",{style:{marginTop:"8px"},children:[f.jsxs("strong",{children:["All ",js(ae).length," combined campaigns"]})," will be reset to Individual type for re-selection."]})]})]}),f.jsxs("div",{style:{backgroundColor:"#F8FAFC",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"13px"},children:[f.jsx("strong",{children:"Invoice:"})," ",ae.invoiceNo]}),f.jsxs("div",{style:{fontSize:"13px"},children:[f.jsx("strong",{children:"Party:"})," ",ae.partyName]}),f.jsxs("div",{style:{fontSize:"13px"},children:[f.jsx("strong",{children:"Amount:"})," ",ut(ae.invoiceTotalAmount)]})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>nr(!1)}),f.jsx(Ye,{label:"Delete Invoice",variant:"danger",icon:Hs,onClick:nc})]})]})}),f.jsx(wn,{isOpen:pi,onClose:()=>Fr(!1),title:" Add Email Address",width:"400px",children:ae&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"13px"},children:[f.jsx("strong",{children:"Campaign:"})," ",ae.senderName]}),f.jsxs("div",{style:{fontSize:"13px",marginTop:"4px"},children:[f.jsx("strong",{children:"Current:"})," ",ae.emailId||"None"]})]}),f.jsx(gr,{label:"Additional Email Address",type:"email",value:Os,onChange:m=>ca(m.target.value),placeholder:"email@example.com",small:!0}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>Fr(!1)}),f.jsx(Ye,{label:"Add Email",variant:"brand",icon:B2,onClick:()=>{Os&&Os.includes("@")?(Cu(ae.id,Os),Fr(!1),ca("")):alert("Please enter a valid email address")}})]})]})}),f.jsx(wn,{isOpen:A,onClose:()=>{_(!1),H({currentPassword:"",newPassword:"",confirmPassword:""}),w("")},title:" Change Password",width:"400px",children:f.jsxs("div",{children:[f.jsx("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:f.jsxs("div",{style:{fontSize:"13px"},children:[f.jsx("strong",{children:"User:"})," ",r==="director"?"Director":"Finance Team"]})}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Current Password"}),f.jsx("input",{type:"password",value:O.currentPassword,onChange:m=>H(C=>({...C,currentPassword:m.target.value})),placeholder:"Enter current password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"New Password"}),f.jsx("input",{type:"password",value:O.newPassword,onChange:m=>H(C=>({...C,newPassword:m.target.value})),placeholder:"Enter new password (min 6 characters)",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Confirm New Password"}),f.jsx("input",{type:"password",value:O.confirmPassword,onChange:m=>H(C=>({...C,confirmPassword:m.target.value})),placeholder:"Confirm new password",onKeyPress:m=>m.key==="Enter"&&Ql(),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),j&&f.jsx("div",{style:{marginBottom:"16px",padding:"10px",backgroundColor:"#FEE2E2",borderRadius:"8px",color:"#991B1B",fontSize:"13px"},children:j}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>{_(!1),H({currentPassword:"",newPassword:"",confirmPassword:""}),w("")}}),f.jsx(Ye,{label:"Change Password",variant:"brand",icon:Nd,onClick:Ql})]})]})}),f.jsx(wn,{isOpen:A,onClose:()=>{_(!1),w(""),H({currentPassword:"",newPassword:"",confirmPassword:""})},title:" Change Password",width:"400px",children:f.jsxs("div",{children:[f.jsx("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:f.jsxs("div",{style:{fontSize:"13px",color:"#1E40AF"},children:["Changing password for: ",f.jsx("strong",{children:r==="director"?"Director":"Finance Team"})]})}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Current Password"}),f.jsx("input",{type:"password",value:O.currentPassword,onChange:m=>H(C=>({...C,currentPassword:m.target.value})),placeholder:"Enter current password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"New Password"}),f.jsx("input",{type:"password",value:O.newPassword,onChange:m=>H(C=>({...C,newPassword:m.target.value})),placeholder:"Enter new password (min 6 chars)",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Confirm New Password"}),f.jsx("input",{type:"password",value:O.confirmPassword,onChange:m=>H(C=>({...C,confirmPassword:m.target.value})),placeholder:"Re-enter new password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),j&&f.jsx("div",{style:{marginBottom:"16px",padding:"10px",backgroundColor:"#FEE2E2",borderRadius:"8px",color:"#991B1B",fontSize:"13px"},children:j}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>{_(!1),w(""),H({currentPassword:"",newPassword:"",confirmPassword:""})}}),f.jsx(Ye,{label:"Change Password",variant:"brand",icon:Nd,onClick:Ql})]})]})}),f.jsx(wn,{isOpen:hi,onClose:()=>{$i(!1),kt(new Set),st(null)},title:" Combine Invoices",width:"700px",children:We&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#F3E8FF",padding:"14px 18px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"15px",fontWeight:"700",color:"#6B21A8"},children:["Party: ",We]}),f.jsx("div",{style:{fontSize:"13px",color:"#7C3AED",marginTop:"4px"},children:"Select 2+ campaigns to combine into a single invoice"})]}),f.jsx("div",{style:{maxHeight:"350px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"10px"},children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#F8FAFC",position:"sticky",top:0},children:[f.jsx("th",{style:{padding:"12px",textAlign:"center",width:"50px"},children:""}),f.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Sender"}),f.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Subject"}),f.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Date"}),f.jsx("th",{style:{padding:"12px",textAlign:"right"},children:"Amount"})]})}),f.jsx("tbody",{children:Zl(We).map(m=>{var C;return f.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:Et.has(m.id)?"#F3E8FF":"transparent",cursor:"pointer"},onClick:()=>L4(m.id),children:[f.jsx("td",{style:{padding:"12px",textAlign:"center"},children:f.jsx("input",{type:"checkbox",checked:Et.has(m.id),onChange:()=>{},style:{width:"18px",height:"18px",cursor:"pointer"}})}),f.jsx("td",{style:{padding:"12px",fontWeight:"600"},children:m.senderName}),f.jsxs("td",{style:{padding:"12px",color:"#64748B"},children:[(C=m.subject)==null?void 0:C.substring(0,35),"..."]}),f.jsx("td",{style:{padding:"12px"},children:mr(m.date)}),f.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:ut(m.totalWithGst)})]},m.id)})})]})}),f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px 18px",borderRadius:"10px",marginTop:"16px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsxs("div",{style:{fontSize:"14px",color:"#64748B"},children:["Selected: ",f.jsx("strong",{children:Et.size})," | Combine Code: ",f.jsxs("strong",{children:["C",Ae]})]}),f.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#2874A6"},children:["Total: ",ut(ge.filter(m=>Et.has(m.id)).reduce((m,C)=>m+(parseFloat(C.totalWithGst)||0),0))]})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>{$i(!1),kt(new Set)}}),f.jsx(Ye,{label:"Create Combined Invoice",variant:"purple",icon:Hu,disabled:Et.size<2,onClick:M4})]})]})}),f.jsxs(wn,{isOpen:Bt,onClose:()=>{gt(!1),Ii(null),Ga(!1)},title:vn?" Replace Mailer":" Upload Mailer",width:"550px",children:[f.jsx("input",{type:"file",ref:wu,accept:"image/*",style:{display:"none"},onChange:j4}),ae&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"14px"},children:[f.jsxs("div",{style:{fontSize:"14px"},children:[f.jsx("strong",{children:"Sender:"})," ",ae.senderName]}),f.jsxs("div",{style:{fontSize:"14px",marginTop:"4px"},children:[f.jsx("strong",{children:"Subject:"})," ",ae.subject]})]}),vn&&wt[ae.id]&&f.jsx("div",{style:{backgroundColor:"#FEF3C7",padding:"12px",borderRadius:"10px",marginBottom:"14px",border:"1px solid #FCD34D"},children:f.jsxs("div",{style:{fontWeight:"600",color:"#92400E",fontSize:"13px"},children:[" This will replace ",wt[ae.id].length," existing image(s)"]})}),f.jsxs("div",{style:{backgroundColor:"#FEF3C7",padding:"14px",borderRadius:"10px",marginBottom:"14px",border:"1px solid #FCD34D"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#92400E",marginBottom:"8px",fontSize:"14px"},children:"Step 1: Find Mailer in Gmail"}),f.jsxs("button",{onClick:()=>U4(ae.subject),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 18px",backgroundColor:"#EA4335",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:[f.jsx(jB,{size:16})," Search in Gmail"]})]}),f.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"14px",borderRadius:"10px",border:"1px solid #86EFAC"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#166534",marginBottom:"8px",fontSize:"14px"},children:"Step 2: Paste Screenshot"}),f.jsx("div",{ref:j0,tabIndex:0,onPaste:V4,onClick:()=>{var m;return(m=j0.current)==null?void 0:m.focus()},style:{border:xn?"3px solid #22C55E":"3px dashed #22C55E",borderRadius:"10px",padding:xn?"8px":"30px",textAlign:"center",cursor:"pointer",backgroundColor:xn?"#FFFFFF":"#ECFDF5",minHeight:"100px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",outline:"none"},children:xn?f.jsxs(f.Fragment,{children:[f.jsx("img",{src:xn,alt:"Pasted",style:{maxWidth:"100%",maxHeight:"200px",borderRadius:"8px",marginBottom:"10px"}}),f.jsxs("div",{style:{display:"flex",gap:"8px"},children:[f.jsx(Ye,{icon:O2,label:"Save",variant:"success",onClick:()=>ty(xn)}),f.jsx(Ye,{icon:Hs,label:"Clear",variant:"danger",onClick:()=>Ii(null)})]})]}):f.jsxs(f.Fragment,{children:[f.jsx(jm,{size:36,color:"#22C55E",style:{marginBottom:"8px"}}),f.jsx("div",{style:{fontWeight:"700",fontSize:"14px",color:"#166534"},children:"Click here & Press Ctrl+V"})]})}),f.jsxs("div",{style:{textAlign:"center",marginTop:"12px"},children:[f.jsx("span",{style:{color:"#64748B",fontSize:"13px"},children:" OR "}),f.jsx("div",{style:{marginTop:"8px"},children:f.jsx(Ye,{icon:$s,label:"Browse Files",onClick:()=>{var m;return(m=wu.current)==null?void 0:m.click()}})})]})]})]})]}),f.jsx(wn,{isOpen:bt,onClose:()=>ht(!1),title:" Send Invoice Email",width:"600px",children:ae&&f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",gap:"0",marginBottom:"16px",border:"2px solid #E2E8F0",borderRadius:"8px",overflow:"hidden"},children:[f.jsx("button",{onClick:()=>la("reply"),style:{flex:1,padding:"12px",backgroundColor:oa==="reply"?"#2874A6":"#F8FAFC",color:oa==="reply"?"white":"#64748B",border:"none",cursor:"pointer",fontWeight:"700",fontSize:"14px"},children:" Reply to Thread"}),f.jsx("button",{onClick:()=>la("new"),style:{flex:1,padding:"12px",backgroundColor:oa==="new"?"#2874A6":"#F8FAFC",color:oa==="new"?"white":"#64748B",border:"none",cursor:"pointer",fontWeight:"700",fontSize:"14px"},children:" New Email"})]}),f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice:"})," ",ae.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Amount:"})," ",ut(ae.invoiceTotalAmount||ae.totalWithGst)]}),ae.invoiceType==="Combined"&&f.jsxs("div",{style:{fontSize:"13px",marginTop:"8px",color:"#7C3AED"},children:[f.jsx("strong",{children:"Campaigns:"})," ",js(ae).map(m=>m.senderName).join(", ")]}),f.jsx("div",{style:{fontSize:"14px",marginTop:"8px"},children:f.jsx("strong",{children:"Recipients:"})}),f.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",marginTop:"6px"},children:[Ja(ae).map((m,C)=>f.jsx("span",{style:{padding:"4px 10px",backgroundColor:"#DBEAFE",borderRadius:"6px",fontSize:"13px",color:"#1E40AF"},children:m},C)),Ja(ae).length===0&&f.jsx("span",{style:{color:"#94A3B8"},children:"No email addresses"})]})]}),oa==="reply"?f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[f.jsx("span",{style:{fontWeight:"700",fontSize:"14px"},children:"Email Body:"}),f.jsx("button",{onClick:()=>{navigator.clipboard.writeText(Z0(ae)),alert(" Copied!")},style:{padding:"6px 14px",backgroundColor:"#22C55E",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"600"},children:" Copy"})]}),f.jsx("div",{style:{fontSize:"13px",backgroundColor:"#F8FAFC",padding:"14px",borderRadius:"10px",whiteSpace:"pre-wrap",maxHeight:"200px",overflowY:"auto",fontFamily:"monospace",border:"1px solid #E2E8F0",lineHeight:"1.5"},children:Z0(ae)})]}):f.jsxs("div",{style:{display:"flex",gap:"10px"},children:[f.jsx("button",{onClick:()=>{const m=Ja(ae),C=encodeURIComponent(m.join(",")),X=encodeURIComponent(ry(ae)),Z=encodeURIComponent(Z0(ae));window.open(`https://mail.google.com/mail/?view=cm&to=${C}&su=${X}&body=${Z}`,"_blank")},style:{padding:"12px 20px",backgroundColor:"#EA4335",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"700"},children:" Open Gmail"}),f.jsx("button",{onClick:()=>{const m=Ja(ae),C=encodeURIComponent(m.join(";")),X=encodeURIComponent(ry(ae)),Z=encodeURIComponent(Z0(ae));window.open(`https://outlook.live.com/mail/0/deeplink/compose?to=${C}&subject=${X}&body=${Z}`,"_blank")},style:{padding:"12px 20px",backgroundColor:"#0078D4",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"700"},children:" Open Outlook"})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[f.jsx(Ye,{label:"View Invoice",icon:Rd,onClick:()=>{ht(!1),Nu(ae)}}),f.jsx(Ye,{label:"Close",onClick:()=>ht(!1)})]})]})}),f.jsx(wn,{isOpen:$e,onClose:()=>Zt(!1),title:" Record Payment",width:"500px",children:ae&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px"},children:[f.jsx("strong",{children:"Invoice:"})," ",ae.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginTop:"4px"},children:[f.jsx("strong",{children:"Party:"})," ",ae.partyName]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[f.jsx(gr,{label:"Payment Amount",type:"number",value:Yt.amount,onChange:m=>Yi({...Yt,amount:m.target.value}),small:!0}),f.jsx(gr,{label:"Date",type:"date",value:Yt.date,onChange:m=>Yi({...Yt,date:m.target.value}),small:!0})]}),f.jsx(Vd,{label:"Payment Mode",value:Yt.mode,onChange:m=>Yi({...Yt,mode:m.target.value}),options:[{value:"Bank",label:"Bank Transfer"},{value:"UPI",label:"UPI"},{value:"Cheque",label:"Cheque"},{value:"Cash",label:"Cash"}],small:!0}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[f.jsx(gr,{label:"TDS Deducted",type:"number",value:Yt.tds,onChange:m=>Yi({...Yt,tds:m.target.value}),placeholder:"0",small:!0}),f.jsx(gr,{label:"Discount",type:"number",value:Yt.discount,onChange:m=>Yi({...Yt,discount:m.target.value}),placeholder:"0",small:!0})]}),f.jsx(gr,{label:"Narration",value:Yt.narration,onChange:m=>Yi({...Yt,narration:m.target.value}),placeholder:"Reference",small:!0}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>Zt(!1)}),f.jsx(Ye,{label:"Record Payment",variant:"success",icon:BB,onClick:G4})]})]})}),f.jsxs(wn,{isOpen:pn,onClose:()=>Yr(!1),title:" Set Opening Balance",width:"450px",children:[f.jsx(Vd,{label:"Select Party",value:gi.partyName,onChange:m=>Gl({...gi,partyName:m.target.value}),options:[{value:"",label:"Choose a party..."},...Qa.map(m=>({value:m,label:m}))],small:!0}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"12px"},children:[f.jsx(gr,{label:"Amount",type:"number",value:gi.amount,onChange:m=>Gl({...gi,amount:m.target.value}),small:!0}),f.jsx(Vd,{label:"Type",value:gi.type,onChange:m=>Gl({...gi,type:m.target.value}),options:[{value:"Dr",label:"Debit"},{value:"Cr",label:"Credit"}],small:!0})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>Yr(!1)}),f.jsx(Ye,{label:"Save",variant:"brand",onClick:()=>{gi.partyName&&gi.amount&&(Yo(m=>({...m,[gi.partyName]:gi.type==="Dr"?parseFloat(gi.amount):-parseFloat(gi.amount)})),Yr(!1),Gl({partyName:"",amount:"",type:"Dr"}))}})]})]}),f.jsxs(wn,{isOpen:xs,onClose:()=>da(!1),title:" Import Historical Ledger",width:"600px",children:[f.jsx("input",{type:"file",ref:Su,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:an}),f.jsxs("div",{style:{padding:"16px",backgroundColor:"#EFF6FF",borderRadius:"10px",marginBottom:"16px",border:"1px solid #BFDBFE"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#1E40AF",marginBottom:"8px",fontSize:"14px"},children:" How to Import Historical Ledger"}),f.jsxs("div",{style:{fontSize:"12px",color:"#1E3A8A",lineHeight:"1.6"},children:[f.jsx("p",{style:{margin:"0 0 8px 0"},children:"Upload your existing ledger data in the format shown in the template. This will import all historical transactions."}),f.jsxs("p",{style:{margin:0},children:[f.jsx("strong",{children:"Supported columns:"})," Date, Particular, Vch Type, Vch No., Debit, Credit, Date of Receipt, Amount Received, TDS Received, Balance, Payment Status"]})]})]}),G&&f.jsxs("div",{style:{padding:"12px",backgroundColor:"#DCFCE7",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[f.jsxs("div",{style:{fontSize:"13px",color:"#166534"},children:[f.jsx("strong",{children:" Selected Party:"})," ",G]}),f.jsx("div",{style:{fontSize:"11px",color:"#15803D",marginTop:"4px"},children:"All entries from the uploaded file will be imported for this party"})]}),!G&&f.jsxs("div",{style:{padding:"12px",backgroundColor:"#FEE2E2",borderRadius:"8px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[f.jsx("div",{style:{fontSize:"13px",color:"#991B1B"},children:f.jsx("strong",{children:" No Party Selected"})}),f.jsx("div",{style:{fontSize:"12px",color:"#B91C1C",marginTop:"4px"},children:'Please close this modal and select a party from the Parties list on the left, then click "Import Historical" again.'})]}),f.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginBottom:"16px"},children:[f.jsx(Ye,{icon:zu,label:"Download Template",variant:"brand",onClick:on}),G?f.jsx(Ye,{icon:$s,label:"Upload Ledger",variant:"success",onClick:()=>{var m;return(m=Su.current)==null?void 0:m.click()}}):f.jsxs("button",{disabled:!0,style:{padding:"8px 16px",fontSize:"13px",fontWeight:"600",border:"none",borderRadius:"8px",backgroundColor:"#E2E8F0",color:"#94A3B8",cursor:"not-allowed",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx($s,{size:16})," Upload Ledger"]})]}),f.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",border:"1px solid #E2E8F0"},children:[f.jsx("div",{style:{fontWeight:"600",color:"#475569",marginBottom:"8px",fontSize:"13px"},children:" Expected Format (matches your ledger export):"}),f.jsx("div",{style:{overflowX:"auto"},children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#E2E8F0"},children:[f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Date"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Particular"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Vch Type"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Vch No."}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Debit"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Credit"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Amt Recd"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Status"})]})}),f.jsx("tbody",{children:f.jsxs("tr",{children:[f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"02-Jun-21"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"DB Corp Ltd"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"Sales"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"MB/2020-21/0411"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0",textAlign:"right"},children:"6,000"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0",textAlign:"right"},children:"44,371"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"Received"})]})})]})})]}),f.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:f.jsx(Ye,{label:"Close",onClick:()=>da(!1)})})]}),f.jsx(wn,{isOpen:Zn,onClose:()=>{ct(!1),ce({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"})},title:" Create Receipt",width:"550px",children:ae&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice:"})," ",ae.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Party:"})," ",ae.partyName]}),f.jsxs("div",{style:{fontSize:"14px"},children:[f.jsx("strong",{children:"Invoice Amount:"})," ",ut(ae.invoiceTotalAmount)]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[f.jsx(gr,{label:"Receipt Date",type:"date",value:te.date,onChange:m=>ce({...te,date:m.target.value}),small:!0}),f.jsx(Vd,{label:"Payment Mode",value:te.mode,onChange:m=>ce({...te,mode:m.target.value}),options:[{value:"Bank",label:"Bank Transfer"},{value:"Cash",label:"Cash"},{value:"Cheque",label:"Cheque"},{value:"UPI",label:"UPI"}],small:!0})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"12px",marginBottom:"12px"},children:[f.jsx(gr,{label:"Amount Received",type:"number",value:te.amount,onChange:m=>ce({...te,amount:m.target.value}),placeholder:"0.00",small:!0}),f.jsx(gr,{label:"TDS Deducted",type:"number",value:te.tds,onChange:m=>ce({...te,tds:m.target.value}),placeholder:"0.00",small:!0}),f.jsx(gr,{label:"Discount",type:"number",value:te.discount,onChange:m=>ce({...te,discount:m.target.value}),placeholder:"0.00",small:!0})]}),f.jsx("div",{style:{backgroundColor:"#F0FDF4",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:f.jsxs("div",{style:{fontSize:"14px",fontWeight:"700",color:"#166534"},children:["Total Credit: ",ut((parseFloat(te.amount)||0)+(parseFloat(te.tds)||0)+(parseFloat(te.discount)||0))]})}),f.jsx(gr,{label:"Narration",value:te.narration,onChange:m=>ce({...te,narration:m.target.value}),placeholder:"Payment reference, remarks...",small:!0}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Payment Advisory (Optional)"}),f.jsx("input",{type:"file",ref:V0,accept:"image/*,.pdf",onChange:Y0,style:{display:"none"}}),te.paymentAdvisory?f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[f.jsx("div",{style:{flex:1,padding:"10px",backgroundColor:"#F0FDF4",borderRadius:"8px",fontSize:"13px",color:"#166534"},children:" Payment advisory attached"}),f.jsx("button",{onClick:()=>ce(m=>({...m,paymentAdvisory:null})),style:{padding:"8px",border:"none",backgroundColor:"#FEE2E2",borderRadius:"6px",cursor:"pointer",color:"#991B1B"},children:f.jsx(nl,{size:16})})]}):f.jsxs("button",{onClick:()=>{var m;return(m=V0.current)==null?void 0:m.click()},style:{padding:"10px 16px",border:"1.5px dashed #D1D5DB",borderRadius:"8px",backgroundColor:"#F9FAFB",cursor:"pointer",fontSize:"13px",color:"#6B7280",display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx($s,{size:16})," Attach Payment Advisory"]})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>ct(!1)}),f.jsx(Ye,{label:"Create Receipt",variant:"success",icon:Hu,onClick:ma})]})]})}),f.jsx(wn,{isOpen:ir,onClose:()=>{yr(!1),Me({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]})},title:" Create Credit Note",width:"500px",children:ae&&(()=>{var re;const m=(re=ae.statePartyDetails)==null?void 0:re.toUpperCase().includes("MAHARASHTRA"),C=m?"CGST + SGST (9% + 9%)":"IGST (18%)",X=parseFloat(xe.amount)||0,Z=parseFloat(xe.gst)||0,J=X+Z;return f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice:"})," ",ae.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Party:"})," ",ae.partyName]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice Amount:"})," ",ut(ae.invoiceTotalAmount)]}),f.jsxs("div",{style:{fontSize:"12px",color:"#2563EB"},children:[f.jsx("strong",{children:"GST Type:"})," ",m?"CGST + SGST (Intra-state)":"IGST (Inter-state)"]})]}),f.jsx("div",{style:{marginBottom:"12px"},children:f.jsx(gr,{label:"Credit Note Date",type:"date",value:xe.date,onChange:R=>Me({...xe,date:R.target.value}),small:!0})}),f.jsxs("div",{style:{backgroundColor:"#FEF2F2",padding:"14px",borderRadius:"10px",marginBottom:"12px",border:"1px solid #FECACA"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#991B1B",marginBottom:"10px",fontSize:"13px"},children:" Credit Note Breakdown"}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[f.jsx(gr,{label:"Base Amount",type:"number",value:xe.amount,onChange:R=>Me({...xe,amount:R.target.value}),placeholder:"0.00",small:!0}),f.jsx(gr,{label:C,type:"number",value:xe.gst,onChange:R=>Me({...xe,gst:R.target.value}),placeholder:"0.00",small:!0})]}),f.jsxs("div",{style:{marginTop:"10px",padding:"8px",backgroundColor:"#FEE2E2",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsx("span",{style:{fontSize:"13px",fontWeight:"600",color:"#991B1B"},children:"Total Credit:"}),f.jsx("span",{style:{fontSize:"15px",fontWeight:"700",color:"#991B1B"},children:ut(J)})]})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Reason for Credit Note *"}),f.jsx("textarea",{value:xe.reason,onChange:R=>Me({...xe,reason:R.target.value}),placeholder:"Enter reason for issuing credit note...",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>yr(!1)}),f.jsx(Ye,{label:"Create Credit Note",variant:"danger",icon:Wu,onClick:X0})]})]})})()}),f.jsx(wn,{isOpen:z,onClose:()=>{B(!1),W(null)},title:" Add Followup",width:"500px",children:L&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice:"})," ",L.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Party:"})," ",L.partyName]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Amount:"})," ",ut(L.invoiceTotalAmount||L.totalAmount)]}),f.jsxs("div",{style:{fontSize:"14px"},children:[f.jsx("strong",{children:"Invoice Date:"})," ",mr(L.invoiceDate||L.date)]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[f.jsx(gr,{label:"Followup Date",type:"date",value:U.date,onChange:m=>le({...U,date:m.target.value}),small:!0}),f.jsx(gr,{label:"Next Followup Date",type:"date",value:U.nextFollowupDate,onChange:m=>le({...U,nextFollowupDate:m.target.value}),small:!0})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Followup Notes *"}),f.jsx("textarea",{value:U.notes,onChange:m=>le({...U,notes:m.target.value}),placeholder:"Enter followup notes (e.g., Spoke with accounts team, payment promised by next week)",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Status"}),f.jsxs("select",{value:U.status,onChange:m=>le({...U,status:m.target.value}),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px"},children:[f.jsx("option",{value:"Pending",children:"Pending"}),f.jsx("option",{value:"Promised",children:"Promised - Payment Expected"}),f.jsx("option",{value:"Disputed",children:"Disputed"}),f.jsx("option",{value:"No Response",children:"No Response"})]})]}),f.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[f.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#166534",marginBottom:"8px"},children:" Quick Actions"}),f.jsxs("div",{style:{display:"flex",gap:"8px"},children:[f.jsx(Ye,{icon:jm,label:"Copy Email Template",small:!0,variant:"brand",onClick:()=>se(L)}),f.jsx(Ye,{icon:Um,label:"Search in Gmail",small:!0,variant:"success",onClick:()=>he(L)})]})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>B(!1)}),f.jsx(Ye,{label:"Save Followup",variant:"primary",icon:zm,onClick:v})]})]})}),f.jsx(wn,{isOpen:dr,onClose:()=>Dn(!1),title:" Clear All Data",width:"500px",children:f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"20px",borderRadius:"12px",marginBottom:"20px",border:"2px solid #FCA5A5"},children:[f.jsxs("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"18px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(R2,{size:24})," Warning: This action cannot be undone!"]}),f.jsxs("div",{style:{fontSize:"14px",color:"#7F1D1D",lineHeight:"1.6"},children:["This will permanently delete:",f.jsxs("ul",{style:{margin:"12px 0 0 20px",padding:0},children:[f.jsxs("li",{children:[f.jsx("strong",{children:ge.length})," campaigns from Master Sheet"]}),f.jsxs("li",{children:[f.jsx("strong",{children:ge.filter(m=>m.invoiceGenerated).length})," generated invoices"]}),f.jsxs("li",{children:[f.jsx("strong",{children:Q.length})," receipts"]}),f.jsxs("li",{children:[f.jsx("strong",{children:Be.length})," credit notes"]}),f.jsxs("li",{children:[f.jsx("strong",{children:Se.length})," ledger entries"]}),f.jsxs("li",{children:[f.jsx("strong",{children:Object.keys(wt).length})," mailer images"]}),f.jsx("li",{children:"All opening balances"})]})]})]}),f.jsx("div",{style:{backgroundColor:"#FEF3C7",padding:"14px",borderRadius:"8px",marginBottom:"20px",border:"1px solid #FCD34D"},children:f.jsxs("div",{style:{fontSize:"13px",color:"#92400E"},children:[f.jsx("strong",{children:"Note:"})," Invoice series numbers will be reset to 1. Your company settings and mailer logo will be preserved."]})}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>Dn(!1)}),f.jsx(Ye,{label:"Yes, Clear All Data",variant:"danger",icon:Hs,onClick:D4})]})]})}),f.jsx(wn,{isOpen:fa,onClose:()=>$l(!1),title:" Notifications",width:"550px",children:f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[f.jsx("div",{style:{fontSize:"14px",color:"#64748B"},children:qi>0?`${qi} unread`:"No unread notifications"}),f.jsxs("div",{style:{display:"flex",gap:"8px"},children:[qi>0&&f.jsx("button",{onClick:H0,style:{padding:"6px 12px",fontSize:"12px",fontWeight:"600",border:"1px solid #E2E8F0",borderRadius:"6px",backgroundColor:"#F8FAFC",color:"#475569",cursor:"pointer"},children:"Mark all as read"}),Ci.length>0&&Ut&&f.jsx("button",{onClick:$0,style:{padding:"6px 12px",fontSize:"12px",fontWeight:"600",border:"1px solid #FCA5A5",borderRadius:"6px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer"},children:"Clear all"})]})]}),f.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:ha.length===0?f.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:[f.jsx(D2,{size:40,style:{marginBottom:"12px",opacity:.5}}),f.jsx("div",{style:{fontSize:"16px",fontWeight:"600"},children:"No notifications"}),f.jsx("div",{style:{fontSize:"13px",marginTop:"4px"},children:"You're all caught up!"})]}):ha.map(m=>{const C=!(m.read&&m.read[r]),X=J=>{switch(J){case"upload":return"";case"invoice":return"";case"approval":return"";case"edit":return"";case"receipt":return"";default:return""}},Z=J=>{switch(J){case"upload":return"#EFF6FF";case"invoice":return"#FEF3C7";case"approval":return"#DCFCE7";case"edit":return"#FEE2E2";case"receipt":return"#F0FDF4";default:return"#F8FAFC"}};return f.jsx("div",{onClick:()=>W0(m.id),style:{padding:"14px",borderRadius:"10px",marginBottom:"8px",backgroundColor:C?Z(m.type):"#F8FAFC",border:C?"2px solid #2874A6":"1px solid #E2E8F0",cursor:"pointer",transition:"all 0.2s ease"},children:f.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[f.jsx("div",{style:{fontSize:"20px"},children:X(m.type)}),f.jsxs("div",{style:{flex:1},children:[f.jsx("div",{style:{fontSize:"14px",fontWeight:C?"600":"500",color:"#1E293B",lineHeight:"1.4"},children:m.message}),f.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"8px",fontSize:"11px",color:"#64748B"},children:[f.jsxs("span",{children:["By: ",m.createdBy==="finance"?"Finance Team":"Director"]}),f.jsx("span",{children:""}),f.jsx("span",{children:new Date(m.createdAt).toLocaleString()})]})]}),C&&f.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#DC2626",flexShrink:0}})]})},m.id)})})]})})]}),rF=()=>{switch(D){case"master":return ly();case"invoices":return Y4();case"ledgers":return Q4();case"followups":return Z4();case"reports":return fy();case"settings":return r==="finance"?eF():fy();default:return ly()}},nF=()=>f.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 50%, #1E3A5F 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',padding:"20px"},children:f.jsxs("div",{style:{backgroundColor:"#FFFFFF",padding:"0",borderRadius:"24px",boxShadow:"0 25px 50px -12px rgba(0,0,0,0.25)",width:"420px",maxWidth:"95vw",overflow:"hidden"},children:[f.jsxs("div",{style:{background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 100%)",padding:"32px 40px",textAlign:"center"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:"8px"},children:[f.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"60px",height:"auto",borderRadius:"8px",backgroundColor:"white",padding:"4px"}}),f.jsx("span",{style:{fontSize:"36px",fontWeight:"800",color:"#FFFFFF",letterSpacing:"-1px"},children:"FinMate"})]}),f.jsx("p",{style:{margin:0,color:"rgba(255,255,255,0.8)",fontSize:"14px",fontWeight:"500"},children:"Finance Management System"})]}),f.jsxs("div",{style:{padding:"32px 40px"},children:[f.jsxs("div",{style:{marginBottom:"24px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#1E3A5F",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Username"}),f.jsxs("div",{style:{position:"relative"},children:[f.jsx(U2,{size:18,style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"text",value:i.username,onChange:m=>s(C=>({...C,username:m.target.value})),placeholder:"Enter username",style:{width:"100%",padding:"14px 14px 14px 44px",borderRadius:"12px",border:"2px solid #E2E8F0",fontSize:"15px",boxSizing:"border-box",transition:"border-color 0.2s, box-shadow 0.2s",outline:"none"},onFocus:m=>{m.target.style.borderColor="#2874A6",m.target.style.boxShadow="0 0 0 3px rgba(40,116,166,0.1)"},onBlur:m=>{m.target.style.borderColor="#E2E8F0",m.target.style.boxShadow="none"}})]})]}),f.jsxs("div",{style:{marginBottom:"28px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#1E3A5F",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Password"}),f.jsxs("div",{style:{position:"relative"},children:[f.jsx(Nd,{size:18,style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"password",value:i.password,onChange:m=>s(C=>({...C,password:m.target.value})),placeholder:"Enter password",onKeyPress:m=>m.key==="Enter"&&Qi(),style:{width:"100%",padding:"14px 14px 14px 44px",borderRadius:"12px",border:"2px solid #E2E8F0",fontSize:"15px",boxSizing:"border-box",transition:"border-color 0.2s, box-shadow 0.2s",outline:"none"},onFocus:m=>{m.target.style.borderColor="#2874A6",m.target.style.boxShadow="0 0 0 3px rgba(40,116,166,0.1)"},onBlur:m=>{m.target.style.borderColor="#E2E8F0",m.target.style.boxShadow="none"}})]})]}),a&&f.jsxs("div",{style:{marginBottom:"20px",padding:"14px",backgroundColor:"#FEF2F2",borderRadius:"12px",color:"#DC2626",fontSize:"14px",textAlign:"center",border:"1px solid #FECACA",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[f.jsx(R2,{size:18}),a]}),f.jsx("button",{onClick:Qi,style:{width:"100%",padding:"16px",fontSize:"16px",fontWeight:"700",border:"none",borderRadius:"12px",cursor:E?"pointer":"wait",background:E?"linear-gradient(135deg, #1E3A5F 0%, #2874A6 100%)":"#94A3B8",color:"white",transition:"transform 0.2s, box-shadow 0.2s",boxShadow:E?"0 4px 14px rgba(40,116,166,0.4)":"none",opacity:E?1:.7},disabled:!E,onMouseOver:m=>{E&&(m.target.style.transform="translateY(-2px)",m.target.style.boxShadow="0 6px 20px rgba(40,116,166,0.5)")},onMouseOut:m=>{E&&(m.target.style.transform="translateY(0)",m.target.style.boxShadow="0 4px 14px rgba(40,116,166,0.4)")},children:E?"Sign In":"Loading..."}),f.jsxs("div",{style:{marginTop:"24px",textAlign:"center",color:"#94A3B8",fontSize:"12px"},children:[f.jsx("span",{children:"Powered by "}),f.jsx("span",{style:{fontWeight:"600",color:"#1E3A5F"},children:"JAC"}),f.jsx("span",{children:"  Strategy | Talent | Results"})]})]})]})});return t?l?f.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 50%, #1E3A5F 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[f.jsxs("div",{style:{textAlign:"center"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:"24px"},children:[f.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"50px",height:"auto",borderRadius:"8px",backgroundColor:"white",padding:"4px"}}),f.jsx("span",{style:{fontSize:"32px",fontWeight:"800",color:"#FFFFFF",letterSpacing:"-1px"},children:"FinMate"})]}),f.jsx(L2,{size:48,style:{animation:"spin 1s linear infinite",color:"#FFFFFF",marginBottom:"16px"}}),f.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:"#FFFFFF"},children:"Loading your data..."}),f.jsx("div",{style:{fontSize:"14px",color:"rgba(255,255,255,0.7)",marginTop:"8px"},children:"Please wait while we sync with the cloud"})]}),f.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]}):f.jsxs("div",{style:{display:"flex",height:"100vh",backgroundColor:"#F1F5F9",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[K4(),f.jsx("main",{style:{flex:1,overflow:"auto",padding:"20px"},children:rF()}),tF(),f.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]}):nF()}rg.createRoot(document.getElementById("root")).render(f.jsx(Wd.StrictMode,{children:f.jsx(PW,{})}));
