(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function J4(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var fw={exports:{}},yp={},hw={exports:{}},Nt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ff=Symbol.for("react.element"),Z4=Symbol.for("react.portal"),eb=Symbol.for("react.fragment"),tb=Symbol.for("react.strict_mode"),rb=Symbol.for("react.profiler"),nb=Symbol.for("react.provider"),ib=Symbol.for("react.context"),sb=Symbol.for("react.forward_ref"),ab=Symbol.for("react.suspense"),ob=Symbol.for("react.memo"),lb=Symbol.for("react.lazy"),Cy=Symbol.iterator;function cb(t){return t===null||typeof t!="object"?null:(t=Cy&&t[Cy]||t["@@iterator"],typeof t=="function"?t:null)}var pw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},gw=Object.assign,mw={};function Cu(t,e,r){this.props=t,this.context=e,this.refs=mw,this.updater=r||pw}Cu.prototype.isReactComponent={};Cu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Cu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function xw(){}xw.prototype=Cu.prototype;function Lx(t,e,r){this.props=t,this.context=e,this.refs=mw,this.updater=r||pw}var Bx=Lx.prototype=new xw;Bx.constructor=Lx;gw(Bx,Cu.prototype);Bx.isPureReactComponent=!0;var Fy=Array.isArray,vw=Object.prototype.hasOwnProperty,jx={current:null},yw={key:!0,ref:!0,__self:!0,__source:!0};function _w(t,e,r){var n,i={},s=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)vw.call(e,n)&&!yw.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:Ff,type:t,key:s,ref:a,props:i,_owner:jx.current}}function ub(t,e){return{$$typeof:Ff,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Ux(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ff}function db(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var by=/\/+/g;function ag(t,e){return typeof t=="object"&&t!==null&&t.key!=null?db(""+t.key):e.toString(36)}function Q0(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Ff:case Z4:a=!0}}if(a)return a=t,i=i(a),t=n===""?"."+ag(a,0):n,Fy(i)?(r="",t!=null&&(r=t.replace(by,"$&/")+"/"),Q0(i,e,r,"",function(u){return u})):i!=null&&(Ux(i)&&(i=ub(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(by,"$&/")+"/")+t)),e.push(i)),1;if(a=0,n=n===""?".":n+":",Fy(t))for(var o=0;o<t.length;o++){s=t[o];var l=n+ag(s,o);a+=Q0(s,e,r,l,i)}else if(l=cb(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=n+ag(s,o++),a+=Q0(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function u0(t,e,r){if(t==null)return t;var n=[],i=0;return Q0(t,n,"","",function(s){return e.call(r,s,i++)}),n}function fb(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ci={current:null},J0={transition:null},hb={ReactCurrentDispatcher:Ci,ReactCurrentBatchConfig:J0,ReactCurrentOwner:jx};function Ew(){throw Error("act(...) is not supported in production builds of React.")}Nt.Children={map:u0,forEach:function(t,e,r){u0(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return u0(t,function(){e++}),e},toArray:function(t){return u0(t,function(e){return e})||[]},only:function(t){if(!Ux(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Nt.Component=Cu;Nt.Fragment=eb;Nt.Profiler=rb;Nt.PureComponent=Lx;Nt.StrictMode=tb;Nt.Suspense=ab;Nt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hb;Nt.act=Ew;Nt.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=gw({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=jx.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)vw.call(e,l)&&!yw.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:Ff,type:t.type,key:i,ref:s,props:n,_owner:a}};Nt.createContext=function(t){return t={$$typeof:ib,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:nb,_context:t},t.Consumer=t};Nt.createElement=_w;Nt.createFactory=function(t){var e=_w.bind(null,t);return e.type=t,e};Nt.createRef=function(){return{current:null}};Nt.forwardRef=function(t){return{$$typeof:sb,render:t}};Nt.isValidElement=Ux;Nt.lazy=function(t){return{$$typeof:lb,_payload:{_status:-1,_result:t},_init:fb}};Nt.memo=function(t,e){return{$$typeof:ob,type:t,compare:e===void 0?null:e}};Nt.startTransition=function(t){var e=J0.transition;J0.transition={};try{t()}finally{J0.transition=e}};Nt.unstable_act=Ew;Nt.useCallback=function(t,e){return Ci.current.useCallback(t,e)};Nt.useContext=function(t){return Ci.current.useContext(t)};Nt.useDebugValue=function(){};Nt.useDeferredValue=function(t){return Ci.current.useDeferredValue(t)};Nt.useEffect=function(t,e){return Ci.current.useEffect(t,e)};Nt.useId=function(){return Ci.current.useId()};Nt.useImperativeHandle=function(t,e,r){return Ci.current.useImperativeHandle(t,e,r)};Nt.useInsertionEffect=function(t,e){return Ci.current.useInsertionEffect(t,e)};Nt.useLayoutEffect=function(t,e){return Ci.current.useLayoutEffect(t,e)};Nt.useMemo=function(t,e){return Ci.current.useMemo(t,e)};Nt.useReducer=function(t,e,r){return Ci.current.useReducer(t,e,r)};Nt.useRef=function(t){return Ci.current.useRef(t)};Nt.useState=function(t){return Ci.current.useState(t)};Nt.useSyncExternalStore=function(t,e,r){return Ci.current.useSyncExternalStore(t,e,r)};Nt.useTransition=function(){return Ci.current.useTransition()};Nt.version="18.3.1";hw.exports=Nt;var ve=hw.exports;const Z0=J4(ve);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pb=ve,gb=Symbol.for("react.element"),mb=Symbol.for("react.fragment"),xb=Object.prototype.hasOwnProperty,vb=pb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,yb={key:!0,ref:!0,__self:!0,__source:!0};function ww(t,e,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)xb.call(e,n)&&!yb.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:gb,type:t,key:s,ref:a,props:i,_owner:vb.current}}yp.Fragment=mb;yp.jsx=ww;yp.jsxs=ww;fw.exports=yp;var c=fw.exports,um={},Sw={exports:{}},as={},Tw={exports:{}},Aw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Te,ie){var Ce=Te.length;Te.push(ie);e:for(;0<Ce;){var Be=Ce-1>>>1,W=Te[Be];if(0<i(W,ie))Te[Be]=ie,Te[Ce]=W,Ce=Be;else break e}}function r(Te){return Te.length===0?null:Te[0]}function n(Te){if(Te.length===0)return null;var ie=Te[0],Ce=Te.pop();if(Ce!==ie){Te[0]=Ce;e:for(var Be=0,W=Te.length,ne=W>>>1;Be<ne;){var re=2*(Be+1)-1,q=Te[re],xe=re+1,we=Te[xe];if(0>i(q,Ce))xe<W&&0>i(we,q)?(Te[Be]=we,Te[xe]=Ce,Be=xe):(Te[Be]=q,Te[re]=Ce,Be=re);else if(xe<W&&0>i(we,Ce))Te[Be]=we,Te[xe]=Ce,Be=xe;else break e}}return ie}function i(Te,ie){var Ce=Te.sortIndex-ie.sortIndex;return Ce!==0?Ce:Te.id-ie.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],u=[],f=1,p=null,g=3,m=!1,y=!1,x=!1,w=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(Te){for(var ie=r(u);ie!==null;){if(ie.callback===null)n(u);else if(ie.startTime<=Te)n(u),ie.sortIndex=ie.expirationTime,e(l,ie);else break;ie=r(u)}}function P(Te){if(x=!1,E(Te),!y)if(r(l)!==null)y=!0,Pe(Y);else{var ie=r(u);ie!==null&&be(P,ie.startTime-Te)}}function Y(Te,ie){y=!1,x&&(x=!1,A(F),F=-1),m=!0;var Ce=g;try{for(E(ie),p=r(l);p!==null&&(!(p.expirationTime>ie)||Te&&!R());){var Be=p.callback;if(typeof Be=="function"){p.callback=null,g=p.priorityLevel;var W=Be(p.expirationTime<=ie);ie=t.unstable_now(),typeof W=="function"?p.callback=W:p===r(l)&&n(l),E(ie)}else n(l);p=r(l)}if(p!==null)var ne=!0;else{var re=r(u);re!==null&&be(P,re.startTime-ie),ne=!1}return ne}finally{p=null,g=Ce,m=!1}}var V=!1,T=null,F=-1,S=5,I=-1;function R(){return!(t.unstable_now()-I<S)}function D(){if(T!==null){var Te=t.unstable_now();I=Te;var ie=!0;try{ie=T(!0,Te)}finally{ie?N():(V=!1,T=null)}}else V=!1}var N;if(typeof k=="function")N=function(){k(D)};else if(typeof MessageChannel<"u"){var $e=new MessageChannel,_e=$e.port2;$e.port1.onmessage=D,N=function(){_e.postMessage(null)}}else N=function(){w(D,0)};function Pe(Te){T=Te,V||(V=!0,N())}function be(Te,ie){F=w(function(){Te(t.unstable_now())},ie)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Te){Te.callback=null},t.unstable_continueExecution=function(){y||m||(y=!0,Pe(Y))},t.unstable_forceFrameRate=function(Te){0>Te||125<Te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<Te?Math.floor(1e3/Te):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(Te){switch(g){case 1:case 2:case 3:var ie=3;break;default:ie=g}var Ce=g;g=ie;try{return Te()}finally{g=Ce}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Te,ie){switch(Te){case 1:case 2:case 3:case 4:case 5:break;default:Te=3}var Ce=g;g=Te;try{return ie()}finally{g=Ce}},t.unstable_scheduleCallback=function(Te,ie,Ce){var Be=t.unstable_now();switch(typeof Ce=="object"&&Ce!==null?(Ce=Ce.delay,Ce=typeof Ce=="number"&&0<Ce?Be+Ce:Be):Ce=Be,Te){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=Ce+W,Te={id:f++,callback:ie,priorityLevel:Te,startTime:Ce,expirationTime:W,sortIndex:-1},Ce>Be?(Te.sortIndex=Ce,e(u,Te),r(l)===null&&Te===r(u)&&(x?(A(F),F=-1):x=!0,be(P,Ce-Be))):(Te.sortIndex=W,e(l,Te),y||m||(y=!0,Pe(Y))),Te},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(Te){var ie=g;return function(){var Ce=g;g=ie;try{return Te.apply(this,arguments)}finally{g=Ce}}}})(Aw);Tw.exports=Aw;var _b=Tw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eb=ve,is=_b;function Me(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var kw=new Set,Ud={};function nc(t,e){lu(t,e),lu(t+"Capture",e)}function lu(t,e){for(Ud[t]=e,t=0;t<e.length;t++)kw.add(e[t])}var qa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),dm=Object.prototype.hasOwnProperty,wb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Iy={},Ny={};function Sb(t){return dm.call(Ny,t)?!0:dm.call(Iy,t)?!1:wb.test(t)?Ny[t]=!0:(Iy[t]=!0,!1)}function Tb(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Ab(t,e,r,n){if(e===null||typeof e>"u"||Tb(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Fi(t,e,r,n,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var qn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){qn[t]=new Fi(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];qn[e]=new Fi(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){qn[t]=new Fi(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){qn[t]=new Fi(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){qn[t]=new Fi(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){qn[t]=new Fi(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){qn[t]=new Fi(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){qn[t]=new Fi(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){qn[t]=new Fi(t,5,!1,t.toLowerCase(),null,!1,!1)});var Vx=/[\-:]([a-z])/g;function zx(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Vx,zx);qn[e]=new Fi(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Vx,zx);qn[e]=new Fi(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Vx,zx);qn[e]=new Fi(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){qn[t]=new Fi(t,1,!1,t.toLowerCase(),null,!1,!1)});qn.xlinkHref=new Fi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){qn[t]=new Fi(t,1,!1,t.toLowerCase(),null,!0,!0)});function Wx(t,e,r,n){var i=qn.hasOwnProperty(e)?qn[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Ab(e,r,i,n)&&(r=null),n||i===null?Sb(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var ao=Eb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,d0=Symbol.for("react.element"),Pc=Symbol.for("react.portal"),Oc=Symbol.for("react.fragment"),Hx=Symbol.for("react.strict_mode"),fm=Symbol.for("react.profiler"),Cw=Symbol.for("react.provider"),Fw=Symbol.for("react.context"),$x=Symbol.for("react.forward_ref"),hm=Symbol.for("react.suspense"),pm=Symbol.for("react.suspense_list"),Gx=Symbol.for("react.memo"),To=Symbol.for("react.lazy"),bw=Symbol.for("react.offscreen"),Ry=Symbol.iterator;function Yu(t){return t===null||typeof t!="object"?null:(t=Ry&&t[Ry]||t["@@iterator"],typeof t=="function"?t:null)}var Mr=Object.assign,og;function od(t){if(og===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);og=e&&e[1]||""}return`
`+og+t}var lg=!1;function cg(t,e){if(!t||lg)return"";lg=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{lg=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?od(t):""}function kb(t){switch(t.tag){case 5:return od(t.type);case 16:return od("Lazy");case 13:return od("Suspense");case 19:return od("SuspenseList");case 0:case 2:case 15:return t=cg(t.type,!1),t;case 11:return t=cg(t.type.render,!1),t;case 1:return t=cg(t.type,!0),t;default:return""}}function gm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Oc:return"Fragment";case Pc:return"Portal";case fm:return"Profiler";case Hx:return"StrictMode";case hm:return"Suspense";case pm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Fw:return(t.displayName||"Context")+".Consumer";case Cw:return(t._context.displayName||"Context")+".Provider";case $x:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Gx:return e=t.displayName||null,e!==null?e:gm(t.type)||"Memo";case To:e=t._payload,t=t._init;try{return gm(t(e))}catch{}}return null}function Cb(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return gm(e);case 8:return e===Hx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Qo(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Iw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Fb(t){var e=Iw(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function f0(t){t._valueTracker||(t._valueTracker=Fb(t))}function Nw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=Iw(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function yh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function mm(t,e){var r=e.checked;return Mr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function Dy(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Qo(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Rw(t,e){e=e.checked,e!=null&&Wx(t,"checked",e,!1)}function xm(t,e){Rw(t,e);var r=Qo(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?vm(t,e.type,r):e.hasOwnProperty("defaultValue")&&vm(t,e.type,Qo(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Py(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function vm(t,e,r){(e!=="number"||yh(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var ld=Array.isArray;function Yc(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Qo(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function ym(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Me(91));return Mr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Oy(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Me(92));if(ld(r)){if(1<r.length)throw Error(Me(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Qo(r)}}function Dw(t,e){var r=Qo(e.value),n=Qo(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function My(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Pw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _m(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Pw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var h0,Ow=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(h0=h0||document.createElement("div"),h0.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=h0.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Vd(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var vd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},bb=["Webkit","ms","Moz","O"];Object.keys(vd).forEach(function(t){bb.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),vd[e]=vd[t]})});function Mw(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||vd.hasOwnProperty(t)&&vd[t]?(""+e).trim():e+"px"}function Lw(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Mw(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var Ib=Mr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Em(t,e){if(e){if(Ib[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Me(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Me(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Me(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Me(62))}}function wm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Sm=null;function Kx(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Tm=null,Xc=null,qc=null;function Ly(t){if(t=Nf(t)){if(typeof Tm!="function")throw Error(Me(280));var e=t.stateNode;e&&(e=Tp(e),Tm(t.stateNode,t.type,e))}}function Bw(t){Xc?qc?qc.push(t):qc=[t]:Xc=t}function jw(){if(Xc){var t=Xc,e=qc;if(qc=Xc=null,Ly(t),e)for(t=0;t<e.length;t++)Ly(e[t])}}function Uw(t,e){return t(e)}function Vw(){}var ug=!1;function zw(t,e,r){if(ug)return t(e,r);ug=!0;try{return Uw(t,e,r)}finally{ug=!1,(Xc!==null||qc!==null)&&(Vw(),jw())}}function zd(t,e){var r=t.stateNode;if(r===null)return null;var n=Tp(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Me(231,e,typeof r));return r}var Am=!1;if(qa)try{var Xu={};Object.defineProperty(Xu,"passive",{get:function(){Am=!0}}),window.addEventListener("test",Xu,Xu),window.removeEventListener("test",Xu,Xu)}catch{Am=!1}function Nb(t,e,r,n,i,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(f){this.onError(f)}}var yd=!1,_h=null,Eh=!1,km=null,Rb={onError:function(t){yd=!0,_h=t}};function Db(t,e,r,n,i,s,a,o,l){yd=!1,_h=null,Nb.apply(Rb,arguments)}function Pb(t,e,r,n,i,s,a,o,l){if(Db.apply(this,arguments),yd){if(yd){var u=_h;yd=!1,_h=null}else throw Error(Me(198));Eh||(Eh=!0,km=u)}}function ic(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function Ww(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function By(t){if(ic(t)!==t)throw Error(Me(188))}function Ob(t){var e=t.alternate;if(!e){if(e=ic(t),e===null)throw Error(Me(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return By(i),t;if(s===n)return By(i),e;s=s.sibling}throw Error(Me(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(Me(189))}}if(r.alternate!==n)throw Error(Me(190))}if(r.tag!==3)throw Error(Me(188));return r.stateNode.current===r?t:e}function Hw(t){return t=Ob(t),t!==null?$w(t):null}function $w(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=$w(t);if(e!==null)return e;t=t.sibling}return null}var Gw=is.unstable_scheduleCallback,jy=is.unstable_cancelCallback,Mb=is.unstable_shouldYield,Lb=is.unstable_requestPaint,Kr=is.unstable_now,Bb=is.unstable_getCurrentPriorityLevel,Yx=is.unstable_ImmediatePriority,Kw=is.unstable_UserBlockingPriority,wh=is.unstable_NormalPriority,jb=is.unstable_LowPriority,Yw=is.unstable_IdlePriority,_p=null,ma=null;function Ub(t){if(ma&&typeof ma.onCommitFiberRoot=="function")try{ma.onCommitFiberRoot(_p,t,void 0,(t.current.flags&128)===128)}catch{}}var Qs=Math.clz32?Math.clz32:Wb,Vb=Math.log,zb=Math.LN2;function Wb(t){return t>>>=0,t===0?32:31-(Vb(t)/zb|0)|0}var p0=64,g0=4194304;function cd(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Sh(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=cd(o):(s&=a,s!==0&&(n=cd(s)))}else a=r&~i,a!==0?n=cd(a):s!==0&&(n=cd(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Qs(e),i=1<<r,n|=t[r],e&=~i;return n}function Hb(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $b(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-Qs(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=Hb(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function Cm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Xw(){var t=p0;return p0<<=1,!(p0&4194240)&&(p0=64),t}function dg(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function bf(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Qs(e),t[e]=r}function Gb(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-Qs(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function Xx(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Qs(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var sr=0;function qw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Qw,qx,Jw,Zw,eS,Fm=!1,m0=[],Bo=null,jo=null,Uo=null,Wd=new Map,Hd=new Map,ko=[],Kb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Uy(t,e){switch(t){case"focusin":case"focusout":Bo=null;break;case"dragenter":case"dragleave":jo=null;break;case"mouseover":case"mouseout":Uo=null;break;case"pointerover":case"pointerout":Wd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hd.delete(e.pointerId)}}function qu(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Nf(e),e!==null&&qx(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function Yb(t,e,r,n,i){switch(e){case"focusin":return Bo=qu(Bo,t,e,r,n,i),!0;case"dragenter":return jo=qu(jo,t,e,r,n,i),!0;case"mouseover":return Uo=qu(Uo,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return Wd.set(s,qu(Wd.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Hd.set(s,qu(Hd.get(s)||null,t,e,r,n,i)),!0}return!1}function tS(t){var e=Fl(t.target);if(e!==null){var r=ic(e);if(r!==null){if(e=r.tag,e===13){if(e=Ww(r),e!==null){t.blockedOn=e,eS(t.priority,function(){Jw(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function eh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=bm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);Sm=n,r.target.dispatchEvent(n),Sm=null}else return e=Nf(r),e!==null&&qx(e),t.blockedOn=r,!1;e.shift()}return!0}function Vy(t,e,r){eh(t)&&r.delete(e)}function Xb(){Fm=!1,Bo!==null&&eh(Bo)&&(Bo=null),jo!==null&&eh(jo)&&(jo=null),Uo!==null&&eh(Uo)&&(Uo=null),Wd.forEach(Vy),Hd.forEach(Vy)}function Qu(t,e){t.blockedOn===e&&(t.blockedOn=null,Fm||(Fm=!0,is.unstable_scheduleCallback(is.unstable_NormalPriority,Xb)))}function $d(t){function e(i){return Qu(i,t)}if(0<m0.length){Qu(m0[0],t);for(var r=1;r<m0.length;r++){var n=m0[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Bo!==null&&Qu(Bo,t),jo!==null&&Qu(jo,t),Uo!==null&&Qu(Uo,t),Wd.forEach(e),Hd.forEach(e),r=0;r<ko.length;r++)n=ko[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<ko.length&&(r=ko[0],r.blockedOn===null);)tS(r),r.blockedOn===null&&ko.shift()}var Qc=ao.ReactCurrentBatchConfig,Th=!0;function qb(t,e,r,n){var i=sr,s=Qc.transition;Qc.transition=null;try{sr=1,Qx(t,e,r,n)}finally{sr=i,Qc.transition=s}}function Qb(t,e,r,n){var i=sr,s=Qc.transition;Qc.transition=null;try{sr=4,Qx(t,e,r,n)}finally{sr=i,Qc.transition=s}}function Qx(t,e,r,n){if(Th){var i=bm(t,e,r,n);if(i===null)Eg(t,e,n,Ah,r),Uy(t,n);else if(Yb(i,t,e,r,n))n.stopPropagation();else if(Uy(t,n),e&4&&-1<Kb.indexOf(t)){for(;i!==null;){var s=Nf(i);if(s!==null&&Qw(s),s=bm(t,e,r,n),s===null&&Eg(t,e,n,Ah,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Eg(t,e,n,null,r)}}var Ah=null;function bm(t,e,r,n){if(Ah=null,t=Kx(n),t=Fl(t),t!==null)if(e=ic(t),e===null)t=null;else if(r=e.tag,r===13){if(t=Ww(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ah=t,null}function rS(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Bb()){case Yx:return 1;case Kw:return 4;case wh:case jb:return 16;case Yw:return 536870912;default:return 16}default:return 16}}var Ro=null,Jx=null,th=null;function nS(){if(th)return th;var t,e=Jx,r=e.length,n,i="value"in Ro?Ro.value:Ro.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===i[s-n];n++);return th=i.slice(t,1<n?1-n:void 0)}function rh(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function x0(){return!0}function zy(){return!1}function os(t){function e(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?x0:zy,this.isPropagationStopped=zy,this}return Mr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=x0)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=x0)},persist:function(){},isPersistent:x0}),e}var Fu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zx=os(Fu),If=Mr({},Fu,{view:0,detail:0}),Jb=os(If),fg,hg,Ju,Ep=Mr({},If,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:e1,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ju&&(Ju&&t.type==="mousemove"?(fg=t.screenX-Ju.screenX,hg=t.screenY-Ju.screenY):hg=fg=0,Ju=t),fg)},movementY:function(t){return"movementY"in t?t.movementY:hg}}),Wy=os(Ep),Zb=Mr({},Ep,{dataTransfer:0}),eI=os(Zb),tI=Mr({},If,{relatedTarget:0}),pg=os(tI),rI=Mr({},Fu,{animationName:0,elapsedTime:0,pseudoElement:0}),nI=os(rI),iI=Mr({},Fu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),sI=os(iI),aI=Mr({},Fu,{data:0}),Hy=os(aI),oI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},lI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},cI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function uI(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=cI[t])?!!e[t]:!1}function e1(){return uI}var dI=Mr({},If,{key:function(t){if(t.key){var e=oI[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=rh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?lI[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:e1,charCode:function(t){return t.type==="keypress"?rh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?rh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),fI=os(dI),hI=Mr({},Ep,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$y=os(hI),pI=Mr({},If,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:e1}),gI=os(pI),mI=Mr({},Fu,{propertyName:0,elapsedTime:0,pseudoElement:0}),xI=os(mI),vI=Mr({},Ep,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),yI=os(vI),_I=[9,13,27,32],t1=qa&&"CompositionEvent"in window,_d=null;qa&&"documentMode"in document&&(_d=document.documentMode);var EI=qa&&"TextEvent"in window&&!_d,iS=qa&&(!t1||_d&&8<_d&&11>=_d),Gy=" ",Ky=!1;function sS(t,e){switch(t){case"keyup":return _I.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function aS(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Mc=!1;function wI(t,e){switch(t){case"compositionend":return aS(e);case"keypress":return e.which!==32?null:(Ky=!0,Gy);case"textInput":return t=e.data,t===Gy&&Ky?null:t;default:return null}}function SI(t,e){if(Mc)return t==="compositionend"||!t1&&sS(t,e)?(t=nS(),th=Jx=Ro=null,Mc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return iS&&e.locale!=="ko"?null:e.data;default:return null}}var TI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Yy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!TI[t.type]:e==="textarea"}function oS(t,e,r,n){Bw(n),e=kh(e,"onChange"),0<e.length&&(r=new Zx("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Ed=null,Gd=null;function AI(t){vS(t,0)}function wp(t){var e=jc(t);if(Nw(e))return t}function kI(t,e){if(t==="change")return e}var lS=!1;if(qa){var gg;if(qa){var mg="oninput"in document;if(!mg){var Xy=document.createElement("div");Xy.setAttribute("oninput","return;"),mg=typeof Xy.oninput=="function"}gg=mg}else gg=!1;lS=gg&&(!document.documentMode||9<document.documentMode)}function qy(){Ed&&(Ed.detachEvent("onpropertychange",cS),Gd=Ed=null)}function cS(t){if(t.propertyName==="value"&&wp(Gd)){var e=[];oS(e,Gd,t,Kx(t)),zw(AI,e)}}function CI(t,e,r){t==="focusin"?(qy(),Ed=e,Gd=r,Ed.attachEvent("onpropertychange",cS)):t==="focusout"&&qy()}function FI(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return wp(Gd)}function bI(t,e){if(t==="click")return wp(e)}function II(t,e){if(t==="input"||t==="change")return wp(e)}function NI(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ta=typeof Object.is=="function"?Object.is:NI;function Kd(t,e){if(ta(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!dm.call(e,i)||!ta(t[i],e[i]))return!1}return!0}function Qy(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Jy(t,e){var r=Qy(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Qy(r)}}function uS(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?uS(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function dS(){for(var t=window,e=yh();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=yh(t.document)}return e}function r1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function RI(t){var e=dS(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&uS(r.ownerDocument.documentElement,r)){if(n!==null&&r1(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=Jy(r,s);var a=Jy(r,n);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var DI=qa&&"documentMode"in document&&11>=document.documentMode,Lc=null,Im=null,wd=null,Nm=!1;function Zy(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Nm||Lc==null||Lc!==yh(n)||(n=Lc,"selectionStart"in n&&r1(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),wd&&Kd(wd,n)||(wd=n,n=kh(Im,"onSelect"),0<n.length&&(e=new Zx("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Lc)))}function v0(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Bc={animationend:v0("Animation","AnimationEnd"),animationiteration:v0("Animation","AnimationIteration"),animationstart:v0("Animation","AnimationStart"),transitionend:v0("Transition","TransitionEnd")},xg={},fS={};qa&&(fS=document.createElement("div").style,"AnimationEvent"in window||(delete Bc.animationend.animation,delete Bc.animationiteration.animation,delete Bc.animationstart.animation),"TransitionEvent"in window||delete Bc.transitionend.transition);function Sp(t){if(xg[t])return xg[t];if(!Bc[t])return t;var e=Bc[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in fS)return xg[t]=e[r];return t}var hS=Sp("animationend"),pS=Sp("animationiteration"),gS=Sp("animationstart"),mS=Sp("transitionend"),xS=new Map,e_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function al(t,e){xS.set(t,e),nc(e,[t])}for(var vg=0;vg<e_.length;vg++){var yg=e_[vg],PI=yg.toLowerCase(),OI=yg[0].toUpperCase()+yg.slice(1);al(PI,"on"+OI)}al(hS,"onAnimationEnd");al(pS,"onAnimationIteration");al(gS,"onAnimationStart");al("dblclick","onDoubleClick");al("focusin","onFocus");al("focusout","onBlur");al(mS,"onTransitionEnd");lu("onMouseEnter",["mouseout","mouseover"]);lu("onMouseLeave",["mouseout","mouseover"]);lu("onPointerEnter",["pointerout","pointerover"]);lu("onPointerLeave",["pointerout","pointerover"]);nc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));nc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));nc("onBeforeInput",["compositionend","keypress","textInput","paste"]);nc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));nc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));nc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ud="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),MI=new Set("cancel close invalid load scroll toggle".split(" ").concat(ud));function t_(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,Pb(n,e,void 0,t),t.currentTarget=null}function vS(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;t_(i,o,u),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;t_(i,o,u),s=l}}}if(Eh)throw t=km,Eh=!1,km=null,t}function vr(t,e){var r=e[Mm];r===void 0&&(r=e[Mm]=new Set);var n=t+"__bubble";r.has(n)||(yS(e,t,2,!1),r.add(n))}function _g(t,e,r){var n=0;e&&(n|=4),yS(r,t,n,e)}var y0="_reactListening"+Math.random().toString(36).slice(2);function Yd(t){if(!t[y0]){t[y0]=!0,kw.forEach(function(r){r!=="selectionchange"&&(MI.has(r)||_g(r,!1,t),_g(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[y0]||(e[y0]=!0,_g("selectionchange",!1,e))}}function yS(t,e,r,n){switch(rS(e)){case 1:var i=qb;break;case 4:i=Qb;break;default:i=Qx}r=i.bind(null,e,r,t),i=void 0,!Am||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function Eg(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=Fl(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}zw(function(){var u=s,f=Kx(r),p=[];e:{var g=xS.get(t);if(g!==void 0){var m=Zx,y=t;switch(t){case"keypress":if(rh(r)===0)break e;case"keydown":case"keyup":m=fI;break;case"focusin":y="focus",m=pg;break;case"focusout":y="blur",m=pg;break;case"beforeblur":case"afterblur":m=pg;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Wy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=eI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=gI;break;case hS:case pS:case gS:m=nI;break;case mS:m=xI;break;case"scroll":m=Jb;break;case"wheel":m=yI;break;case"copy":case"cut":case"paste":m=sI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=$y}var x=(e&4)!==0,w=!x&&t==="scroll",A=x?g!==null?g+"Capture":null:g;x=[];for(var k=u,E;k!==null;){E=k;var P=E.stateNode;if(E.tag===5&&P!==null&&(E=P,A!==null&&(P=zd(k,A),P!=null&&x.push(Xd(k,P,E)))),w)break;k=k.return}0<x.length&&(g=new m(g,y,null,r,f),p.push({event:g,listeners:x}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",g&&r!==Sm&&(y=r.relatedTarget||r.fromElement)&&(Fl(y)||y[Qa]))break e;if((m||g)&&(g=f.window===f?f:(g=f.ownerDocument)?g.defaultView||g.parentWindow:window,m?(y=r.relatedTarget||r.toElement,m=u,y=y?Fl(y):null,y!==null&&(w=ic(y),y!==w||y.tag!==5&&y.tag!==6)&&(y=null)):(m=null,y=u),m!==y)){if(x=Wy,P="onMouseLeave",A="onMouseEnter",k="mouse",(t==="pointerout"||t==="pointerover")&&(x=$y,P="onPointerLeave",A="onPointerEnter",k="pointer"),w=m==null?g:jc(m),E=y==null?g:jc(y),g=new x(P,k+"leave",m,r,f),g.target=w,g.relatedTarget=E,P=null,Fl(f)===u&&(x=new x(A,k+"enter",y,r,f),x.target=E,x.relatedTarget=w,P=x),w=P,m&&y)t:{for(x=m,A=y,k=0,E=x;E;E=Ac(E))k++;for(E=0,P=A;P;P=Ac(P))E++;for(;0<k-E;)x=Ac(x),k--;for(;0<E-k;)A=Ac(A),E--;for(;k--;){if(x===A||A!==null&&x===A.alternate)break t;x=Ac(x),A=Ac(A)}x=null}else x=null;m!==null&&r_(p,g,m,x,!1),y!==null&&w!==null&&r_(p,w,y,x,!0)}}e:{if(g=u?jc(u):window,m=g.nodeName&&g.nodeName.toLowerCase(),m==="select"||m==="input"&&g.type==="file")var Y=kI;else if(Yy(g))if(lS)Y=II;else{Y=FI;var V=CI}else(m=g.nodeName)&&m.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(Y=bI);if(Y&&(Y=Y(t,u))){oS(p,Y,r,f);break e}V&&V(t,g,u),t==="focusout"&&(V=g._wrapperState)&&V.controlled&&g.type==="number"&&vm(g,"number",g.value)}switch(V=u?jc(u):window,t){case"focusin":(Yy(V)||V.contentEditable==="true")&&(Lc=V,Im=u,wd=null);break;case"focusout":wd=Im=Lc=null;break;case"mousedown":Nm=!0;break;case"contextmenu":case"mouseup":case"dragend":Nm=!1,Zy(p,r,f);break;case"selectionchange":if(DI)break;case"keydown":case"keyup":Zy(p,r,f)}var T;if(t1)e:{switch(t){case"compositionstart":var F="onCompositionStart";break e;case"compositionend":F="onCompositionEnd";break e;case"compositionupdate":F="onCompositionUpdate";break e}F=void 0}else Mc?sS(t,r)&&(F="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(F="onCompositionStart");F&&(iS&&r.locale!=="ko"&&(Mc||F!=="onCompositionStart"?F==="onCompositionEnd"&&Mc&&(T=nS()):(Ro=f,Jx="value"in Ro?Ro.value:Ro.textContent,Mc=!0)),V=kh(u,F),0<V.length&&(F=new Hy(F,t,null,r,f),p.push({event:F,listeners:V}),T?F.data=T:(T=aS(r),T!==null&&(F.data=T)))),(T=EI?wI(t,r):SI(t,r))&&(u=kh(u,"onBeforeInput"),0<u.length&&(f=new Hy("onBeforeInput","beforeinput",null,r,f),p.push({event:f,listeners:u}),f.data=T))}vS(p,e)})}function Xd(t,e,r){return{instance:t,listener:e,currentTarget:r}}function kh(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=zd(t,r),s!=null&&n.unshift(Xd(t,s,i)),s=zd(t,e),s!=null&&n.push(Xd(t,s,i))),t=t.return}return n}function Ac(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function r_(t,e,r,n,i){for(var s=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,i?(l=zd(r,s),l!=null&&a.unshift(Xd(r,l,o))):i||(l=zd(r,s),l!=null&&a.push(Xd(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var LI=/\r\n?/g,BI=/\u0000|\uFFFD/g;function n_(t){return(typeof t=="string"?t:""+t).replace(LI,`
`).replace(BI,"")}function _0(t,e,r){if(e=n_(e),n_(t)!==e&&r)throw Error(Me(425))}function Ch(){}var Rm=null,Dm=null;function Pm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Om=typeof setTimeout=="function"?setTimeout:void 0,jI=typeof clearTimeout=="function"?clearTimeout:void 0,i_=typeof Promise=="function"?Promise:void 0,UI=typeof queueMicrotask=="function"?queueMicrotask:typeof i_<"u"?function(t){return i_.resolve(null).then(t).catch(VI)}:Om;function VI(t){setTimeout(function(){throw t})}function wg(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),$d(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);$d(e)}function Vo(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function s_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var bu=Math.random().toString(36).slice(2),pa="__reactFiber$"+bu,qd="__reactProps$"+bu,Qa="__reactContainer$"+bu,Mm="__reactEvents$"+bu,zI="__reactListeners$"+bu,WI="__reactHandles$"+bu;function Fl(t){var e=t[pa];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Qa]||r[pa]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=s_(t);t!==null;){if(r=t[pa])return r;t=s_(t)}return e}t=r,r=t.parentNode}return null}function Nf(t){return t=t[pa]||t[Qa],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function jc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Me(33))}function Tp(t){return t[qd]||null}var Lm=[],Uc=-1;function ol(t){return{current:t}}function _r(t){0>Uc||(t.current=Lm[Uc],Lm[Uc]=null,Uc--)}function pr(t,e){Uc++,Lm[Uc]=t.current,t.current=e}var Jo={},fi=ol(Jo),zi=ol(!1),Vl=Jo;function cu(t,e){var r=t.type.contextTypes;if(!r)return Jo;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Wi(t){return t=t.childContextTypes,t!=null}function Fh(){_r(zi),_r(fi)}function a_(t,e,r){if(fi.current!==Jo)throw Error(Me(168));pr(fi,e),pr(zi,r)}function _S(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(Me(108,Cb(t)||"Unknown",i));return Mr({},r,n)}function bh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Jo,Vl=fi.current,pr(fi,t),pr(zi,zi.current),!0}function o_(t,e,r){var n=t.stateNode;if(!n)throw Error(Me(169));r?(t=_S(t,e,Vl),n.__reactInternalMemoizedMergedChildContext=t,_r(zi),_r(fi),pr(fi,t)):_r(zi),pr(zi,r)}var Ba=null,Ap=!1,Sg=!1;function ES(t){Ba===null?Ba=[t]:Ba.push(t)}function HI(t){Ap=!0,ES(t)}function ll(){if(!Sg&&Ba!==null){Sg=!0;var t=0,e=sr;try{var r=Ba;for(sr=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Ba=null,Ap=!1}catch(i){throw Ba!==null&&(Ba=Ba.slice(t+1)),Gw(Yx,ll),i}finally{sr=e,Sg=!1}}return null}var Vc=[],zc=0,Ih=null,Nh=0,As=[],ks=0,zl=null,ja=1,Ua="";function Sl(t,e){Vc[zc++]=Nh,Vc[zc++]=Ih,Ih=t,Nh=e}function wS(t,e,r){As[ks++]=ja,As[ks++]=Ua,As[ks++]=zl,zl=t;var n=ja;t=Ua;var i=32-Qs(n)-1;n&=~(1<<i),r+=1;var s=32-Qs(e)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,ja=1<<32-Qs(e)+i|r<<i|n,Ua=s+t}else ja=1<<s|r<<i|n,Ua=t}function n1(t){t.return!==null&&(Sl(t,1),wS(t,1,0))}function i1(t){for(;t===Ih;)Ih=Vc[--zc],Vc[zc]=null,Nh=Vc[--zc],Vc[zc]=null;for(;t===zl;)zl=As[--ks],As[ks]=null,Ua=As[--ks],As[ks]=null,ja=As[--ks],As[ks]=null}var rs=null,ts=null,Fr=!1,Ks=null;function SS(t,e){var r=Fs(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function l_(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,rs=t,ts=Vo(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,rs=t,ts=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=zl!==null?{id:ja,overflow:Ua}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Fs(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,rs=t,ts=null,!0):!1;default:return!1}}function Bm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function jm(t){if(Fr){var e=ts;if(e){var r=e;if(!l_(t,e)){if(Bm(t))throw Error(Me(418));e=Vo(r.nextSibling);var n=rs;e&&l_(t,e)?SS(n,r):(t.flags=t.flags&-4097|2,Fr=!1,rs=t)}}else{if(Bm(t))throw Error(Me(418));t.flags=t.flags&-4097|2,Fr=!1,rs=t}}}function c_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;rs=t}function E0(t){if(t!==rs)return!1;if(!Fr)return c_(t),Fr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Pm(t.type,t.memoizedProps)),e&&(e=ts)){if(Bm(t))throw TS(),Error(Me(418));for(;e;)SS(t,e),e=Vo(e.nextSibling)}if(c_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Me(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){ts=Vo(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}ts=null}}else ts=rs?Vo(t.stateNode.nextSibling):null;return!0}function TS(){for(var t=ts;t;)t=Vo(t.nextSibling)}function uu(){ts=rs=null,Fr=!1}function s1(t){Ks===null?Ks=[t]:Ks.push(t)}var $I=ao.ReactCurrentBatchConfig;function Zu(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Me(309));var n=r.stateNode}if(!n)throw Error(Me(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(Me(284));if(!r._owner)throw Error(Me(290,t))}return t}function w0(t,e){throw t=Object.prototype.toString.call(e),Error(Me(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function u_(t){var e=t._init;return e(t._payload)}function AS(t){function e(A,k){if(t){var E=A.deletions;E===null?(A.deletions=[k],A.flags|=16):E.push(k)}}function r(A,k){if(!t)return null;for(;k!==null;)e(A,k),k=k.sibling;return null}function n(A,k){for(A=new Map;k!==null;)k.key!==null?A.set(k.key,k):A.set(k.index,k),k=k.sibling;return A}function i(A,k){return A=$o(A,k),A.index=0,A.sibling=null,A}function s(A,k,E){return A.index=E,t?(E=A.alternate,E!==null?(E=E.index,E<k?(A.flags|=2,k):E):(A.flags|=2,k)):(A.flags|=1048576,k)}function a(A){return t&&A.alternate===null&&(A.flags|=2),A}function o(A,k,E,P){return k===null||k.tag!==6?(k=Ig(E,A.mode,P),k.return=A,k):(k=i(k,E),k.return=A,k)}function l(A,k,E,P){var Y=E.type;return Y===Oc?f(A,k,E.props.children,P,E.key):k!==null&&(k.elementType===Y||typeof Y=="object"&&Y!==null&&Y.$$typeof===To&&u_(Y)===k.type)?(P=i(k,E.props),P.ref=Zu(A,k,E),P.return=A,P):(P=ch(E.type,E.key,E.props,null,A.mode,P),P.ref=Zu(A,k,E),P.return=A,P)}function u(A,k,E,P){return k===null||k.tag!==4||k.stateNode.containerInfo!==E.containerInfo||k.stateNode.implementation!==E.implementation?(k=Ng(E,A.mode,P),k.return=A,k):(k=i(k,E.children||[]),k.return=A,k)}function f(A,k,E,P,Y){return k===null||k.tag!==7?(k=Pl(E,A.mode,P,Y),k.return=A,k):(k=i(k,E),k.return=A,k)}function p(A,k,E){if(typeof k=="string"&&k!==""||typeof k=="number")return k=Ig(""+k,A.mode,E),k.return=A,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case d0:return E=ch(k.type,k.key,k.props,null,A.mode,E),E.ref=Zu(A,null,k),E.return=A,E;case Pc:return k=Ng(k,A.mode,E),k.return=A,k;case To:var P=k._init;return p(A,P(k._payload),E)}if(ld(k)||Yu(k))return k=Pl(k,A.mode,E,null),k.return=A,k;w0(A,k)}return null}function g(A,k,E,P){var Y=k!==null?k.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return Y!==null?null:o(A,k,""+E,P);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case d0:return E.key===Y?l(A,k,E,P):null;case Pc:return E.key===Y?u(A,k,E,P):null;case To:return Y=E._init,g(A,k,Y(E._payload),P)}if(ld(E)||Yu(E))return Y!==null?null:f(A,k,E,P,null);w0(A,E)}return null}function m(A,k,E,P,Y){if(typeof P=="string"&&P!==""||typeof P=="number")return A=A.get(E)||null,o(k,A,""+P,Y);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case d0:return A=A.get(P.key===null?E:P.key)||null,l(k,A,P,Y);case Pc:return A=A.get(P.key===null?E:P.key)||null,u(k,A,P,Y);case To:var V=P._init;return m(A,k,E,V(P._payload),Y)}if(ld(P)||Yu(P))return A=A.get(E)||null,f(k,A,P,Y,null);w0(k,P)}return null}function y(A,k,E,P){for(var Y=null,V=null,T=k,F=k=0,S=null;T!==null&&F<E.length;F++){T.index>F?(S=T,T=null):S=T.sibling;var I=g(A,T,E[F],P);if(I===null){T===null&&(T=S);break}t&&T&&I.alternate===null&&e(A,T),k=s(I,k,F),V===null?Y=I:V.sibling=I,V=I,T=S}if(F===E.length)return r(A,T),Fr&&Sl(A,F),Y;if(T===null){for(;F<E.length;F++)T=p(A,E[F],P),T!==null&&(k=s(T,k,F),V===null?Y=T:V.sibling=T,V=T);return Fr&&Sl(A,F),Y}for(T=n(A,T);F<E.length;F++)S=m(T,A,F,E[F],P),S!==null&&(t&&S.alternate!==null&&T.delete(S.key===null?F:S.key),k=s(S,k,F),V===null?Y=S:V.sibling=S,V=S);return t&&T.forEach(function(R){return e(A,R)}),Fr&&Sl(A,F),Y}function x(A,k,E,P){var Y=Yu(E);if(typeof Y!="function")throw Error(Me(150));if(E=Y.call(E),E==null)throw Error(Me(151));for(var V=Y=null,T=k,F=k=0,S=null,I=E.next();T!==null&&!I.done;F++,I=E.next()){T.index>F?(S=T,T=null):S=T.sibling;var R=g(A,T,I.value,P);if(R===null){T===null&&(T=S);break}t&&T&&R.alternate===null&&e(A,T),k=s(R,k,F),V===null?Y=R:V.sibling=R,V=R,T=S}if(I.done)return r(A,T),Fr&&Sl(A,F),Y;if(T===null){for(;!I.done;F++,I=E.next())I=p(A,I.value,P),I!==null&&(k=s(I,k,F),V===null?Y=I:V.sibling=I,V=I);return Fr&&Sl(A,F),Y}for(T=n(A,T);!I.done;F++,I=E.next())I=m(T,A,F,I.value,P),I!==null&&(t&&I.alternate!==null&&T.delete(I.key===null?F:I.key),k=s(I,k,F),V===null?Y=I:V.sibling=I,V=I);return t&&T.forEach(function(D){return e(A,D)}),Fr&&Sl(A,F),Y}function w(A,k,E,P){if(typeof E=="object"&&E!==null&&E.type===Oc&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case d0:e:{for(var Y=E.key,V=k;V!==null;){if(V.key===Y){if(Y=E.type,Y===Oc){if(V.tag===7){r(A,V.sibling),k=i(V,E.props.children),k.return=A,A=k;break e}}else if(V.elementType===Y||typeof Y=="object"&&Y!==null&&Y.$$typeof===To&&u_(Y)===V.type){r(A,V.sibling),k=i(V,E.props),k.ref=Zu(A,V,E),k.return=A,A=k;break e}r(A,V);break}else e(A,V);V=V.sibling}E.type===Oc?(k=Pl(E.props.children,A.mode,P,E.key),k.return=A,A=k):(P=ch(E.type,E.key,E.props,null,A.mode,P),P.ref=Zu(A,k,E),P.return=A,A=P)}return a(A);case Pc:e:{for(V=E.key;k!==null;){if(k.key===V)if(k.tag===4&&k.stateNode.containerInfo===E.containerInfo&&k.stateNode.implementation===E.implementation){r(A,k.sibling),k=i(k,E.children||[]),k.return=A,A=k;break e}else{r(A,k);break}else e(A,k);k=k.sibling}k=Ng(E,A.mode,P),k.return=A,A=k}return a(A);case To:return V=E._init,w(A,k,V(E._payload),P)}if(ld(E))return y(A,k,E,P);if(Yu(E))return x(A,k,E,P);w0(A,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,k!==null&&k.tag===6?(r(A,k.sibling),k=i(k,E),k.return=A,A=k):(r(A,k),k=Ig(E,A.mode,P),k.return=A,A=k),a(A)):r(A,k)}return w}var du=AS(!0),kS=AS(!1),Rh=ol(null),Dh=null,Wc=null,a1=null;function o1(){a1=Wc=Dh=null}function l1(t){var e=Rh.current;_r(Rh),t._currentValue=e}function Um(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Jc(t,e){Dh=t,a1=Wc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Vi=!0),t.firstContext=null)}function Ns(t){var e=t._currentValue;if(a1!==t)if(t={context:t,memoizedValue:e,next:null},Wc===null){if(Dh===null)throw Error(Me(308));Wc=t,Dh.dependencies={lanes:0,firstContext:t}}else Wc=Wc.next=t;return e}var bl=null;function c1(t){bl===null?bl=[t]:bl.push(t)}function CS(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,c1(e)):(r.next=i.next,i.next=r),e.interleaved=r,Ja(t,n)}function Ja(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Ao=!1;function u1(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function FS(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function $a(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function zo(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Kt&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,Ja(t,r)}return i=n.interleaved,i===null?(e.next=e,c1(n)):(e.next=i.next,i.next=e),n.interleaved=e,Ja(t,r)}function nh(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Xx(t,r)}}function d_(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Ph(t,e,r,n){var i=t.updateQueue;Ao=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?s=u:a.next=u,a=l;var f=t.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==a&&(o===null?f.firstBaseUpdate=u:o.next=u,f.lastBaseUpdate=l))}if(s!==null){var p=i.baseState;a=0,f=u=l=null,o=s;do{var g=o.lane,m=o.eventTime;if((n&g)===g){f!==null&&(f=f.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=t,x=o;switch(g=e,m=r,x.tag){case 1:if(y=x.payload,typeof y=="function"){p=y.call(m,p,g);break e}p=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=x.payload,g=typeof y=="function"?y.call(m,p,g):y,g==null)break e;p=Mr({},p,g);break e;case 2:Ao=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,g=i.effects,g===null?i.effects=[o]:g.push(o))}else m={eventTime:m,lane:g,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(u=f=m,l=p):f=f.next=m,a|=g;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;g=o,o=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(f===null&&(l=p),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Hl|=a,t.lanes=a,t.memoizedState=p}}function f_(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Me(191,i));i.call(n)}}}var Rf={},xa=ol(Rf),Qd=ol(Rf),Jd=ol(Rf);function Il(t){if(t===Rf)throw Error(Me(174));return t}function d1(t,e){switch(pr(Jd,e),pr(Qd,t),pr(xa,Rf),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:_m(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=_m(e,t)}_r(xa),pr(xa,e)}function fu(){_r(xa),_r(Qd),_r(Jd)}function bS(t){Il(Jd.current);var e=Il(xa.current),r=_m(e,t.type);e!==r&&(pr(Qd,t),pr(xa,r))}function f1(t){Qd.current===t&&(_r(xa),_r(Qd))}var Rr=ol(0);function Oh(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Tg=[];function h1(){for(var t=0;t<Tg.length;t++)Tg[t]._workInProgressVersionPrimary=null;Tg.length=0}var ih=ao.ReactCurrentDispatcher,Ag=ao.ReactCurrentBatchConfig,Wl=0,Or=null,mn=null,Dn=null,Mh=!1,Sd=!1,Zd=0,GI=0;function ei(){throw Error(Me(321))}function p1(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!ta(t[r],e[r]))return!1;return!0}function g1(t,e,r,n,i,s){if(Wl=s,Or=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ih.current=t===null||t.memoizedState===null?qI:QI,t=r(n,i),Sd){s=0;do{if(Sd=!1,Zd=0,25<=s)throw Error(Me(301));s+=1,Dn=mn=null,e.updateQueue=null,ih.current=JI,t=r(n,i)}while(Sd)}if(ih.current=Lh,e=mn!==null&&mn.next!==null,Wl=0,Dn=mn=Or=null,Mh=!1,e)throw Error(Me(300));return t}function m1(){var t=Zd!==0;return Zd=0,t}function ha(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dn===null?Or.memoizedState=Dn=t:Dn=Dn.next=t,Dn}function Rs(){if(mn===null){var t=Or.alternate;t=t!==null?t.memoizedState:null}else t=mn.next;var e=Dn===null?Or.memoizedState:Dn.next;if(e!==null)Dn=e,mn=t;else{if(t===null)throw Error(Me(310));mn=t,t={memoizedState:mn.memoizedState,baseState:mn.baseState,baseQueue:mn.baseQueue,queue:mn.queue,next:null},Dn===null?Or.memoizedState=Dn=t:Dn=Dn.next=t}return Dn}function ef(t,e){return typeof e=="function"?e(t):e}function kg(t){var e=Rs(),r=e.queue;if(r===null)throw Error(Me(311));r.lastRenderedReducer=t;var n=mn,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,u=s;do{var f=u.lane;if((Wl&f)===f)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var p={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=p,a=n):l=l.next=p,Or.lanes|=f,Hl|=f}u=u.next}while(u!==null&&u!==s);l===null?a=n:l.next=o,ta(n,e.memoizedState)||(Vi=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,Or.lanes|=s,Hl|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Cg(t){var e=Rs(),r=e.queue;if(r===null)throw Error(Me(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);ta(s,e.memoizedState)||(Vi=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function IS(){}function NS(t,e){var r=Or,n=Rs(),i=e(),s=!ta(n.memoizedState,i);if(s&&(n.memoizedState=i,Vi=!0),n=n.queue,x1(PS.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||Dn!==null&&Dn.memoizedState.tag&1){if(r.flags|=2048,tf(9,DS.bind(null,r,n,i,e),void 0,null),Mn===null)throw Error(Me(349));Wl&30||RS(r,e,i)}return i}function RS(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Or.updateQueue,e===null?(e={lastEffect:null,stores:null},Or.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function DS(t,e,r,n){e.value=r,e.getSnapshot=n,OS(e)&&MS(t)}function PS(t,e,r){return r(function(){OS(e)&&MS(t)})}function OS(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!ta(t,r)}catch{return!0}}function MS(t){var e=Ja(t,1);e!==null&&Js(e,t,1,-1)}function h_(t){var e=ha();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ef,lastRenderedState:t},e.queue=t,t=t.dispatch=XI.bind(null,Or,t),[e.memoizedState,t]}function tf(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Or.updateQueue,e===null?(e={lastEffect:null,stores:null},Or.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function LS(){return Rs().memoizedState}function sh(t,e,r,n){var i=ha();Or.flags|=t,i.memoizedState=tf(1|e,r,void 0,n===void 0?null:n)}function kp(t,e,r,n){var i=Rs();n=n===void 0?null:n;var s=void 0;if(mn!==null){var a=mn.memoizedState;if(s=a.destroy,n!==null&&p1(n,a.deps)){i.memoizedState=tf(e,r,s,n);return}}Or.flags|=t,i.memoizedState=tf(1|e,r,s,n)}function p_(t,e){return sh(8390656,8,t,e)}function x1(t,e){return kp(2048,8,t,e)}function BS(t,e){return kp(4,2,t,e)}function jS(t,e){return kp(4,4,t,e)}function US(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function VS(t,e,r){return r=r!=null?r.concat([t]):null,kp(4,4,US.bind(null,e,t),r)}function v1(){}function zS(t,e){var r=Rs();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&p1(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function WS(t,e){var r=Rs();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&p1(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function HS(t,e,r){return Wl&21?(ta(r,e)||(r=Xw(),Or.lanes|=r,Hl|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Vi=!0),t.memoizedState=r)}function KI(t,e){var r=sr;sr=r!==0&&4>r?r:4,t(!0);var n=Ag.transition;Ag.transition={};try{t(!1),e()}finally{sr=r,Ag.transition=n}}function $S(){return Rs().memoizedState}function YI(t,e,r){var n=Ho(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},GS(t))KS(e,r);else if(r=CS(t,e,r,n),r!==null){var i=Ai();Js(r,t,n,i),YS(r,e,n)}}function XI(t,e,r){var n=Ho(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(GS(t))KS(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,ta(o,a)){var l=e.interleaved;l===null?(i.next=i,c1(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=CS(t,e,i,n),r!==null&&(i=Ai(),Js(r,t,n,i),YS(r,e,n))}}function GS(t){var e=t.alternate;return t===Or||e!==null&&e===Or}function KS(t,e){Sd=Mh=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function YS(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Xx(t,r)}}var Lh={readContext:Ns,useCallback:ei,useContext:ei,useEffect:ei,useImperativeHandle:ei,useInsertionEffect:ei,useLayoutEffect:ei,useMemo:ei,useReducer:ei,useRef:ei,useState:ei,useDebugValue:ei,useDeferredValue:ei,useTransition:ei,useMutableSource:ei,useSyncExternalStore:ei,useId:ei,unstable_isNewReconciler:!1},qI={readContext:Ns,useCallback:function(t,e){return ha().memoizedState=[t,e===void 0?null:e],t},useContext:Ns,useEffect:p_,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,sh(4194308,4,US.bind(null,e,t),r)},useLayoutEffect:function(t,e){return sh(4194308,4,t,e)},useInsertionEffect:function(t,e){return sh(4,2,t,e)},useMemo:function(t,e){var r=ha();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=ha();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=YI.bind(null,Or,t),[n.memoizedState,t]},useRef:function(t){var e=ha();return t={current:t},e.memoizedState=t},useState:h_,useDebugValue:v1,useDeferredValue:function(t){return ha().memoizedState=t},useTransition:function(){var t=h_(!1),e=t[0];return t=KI.bind(null,t[1]),ha().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Or,i=ha();if(Fr){if(r===void 0)throw Error(Me(407));r=r()}else{if(r=e(),Mn===null)throw Error(Me(349));Wl&30||RS(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,p_(PS.bind(null,n,s,t),[t]),n.flags|=2048,tf(9,DS.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=ha(),e=Mn.identifierPrefix;if(Fr){var r=Ua,n=ja;r=(n&~(1<<32-Qs(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Zd++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=GI++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},QI={readContext:Ns,useCallback:zS,useContext:Ns,useEffect:x1,useImperativeHandle:VS,useInsertionEffect:BS,useLayoutEffect:jS,useMemo:WS,useReducer:kg,useRef:LS,useState:function(){return kg(ef)},useDebugValue:v1,useDeferredValue:function(t){var e=Rs();return HS(e,mn.memoizedState,t)},useTransition:function(){var t=kg(ef)[0],e=Rs().memoizedState;return[t,e]},useMutableSource:IS,useSyncExternalStore:NS,useId:$S,unstable_isNewReconciler:!1},JI={readContext:Ns,useCallback:zS,useContext:Ns,useEffect:x1,useImperativeHandle:VS,useInsertionEffect:BS,useLayoutEffect:jS,useMemo:WS,useReducer:Cg,useRef:LS,useState:function(){return Cg(ef)},useDebugValue:v1,useDeferredValue:function(t){var e=Rs();return mn===null?e.memoizedState=t:HS(e,mn.memoizedState,t)},useTransition:function(){var t=Cg(ef)[0],e=Rs().memoizedState;return[t,e]},useMutableSource:IS,useSyncExternalStore:NS,useId:$S,unstable_isNewReconciler:!1};function $s(t,e){if(t&&t.defaultProps){e=Mr({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Vm(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Mr({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Cp={isMounted:function(t){return(t=t._reactInternals)?ic(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Ai(),i=Ho(t),s=$a(n,i);s.payload=e,r!=null&&(s.callback=r),e=zo(t,s,i),e!==null&&(Js(e,t,i,n),nh(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Ai(),i=Ho(t),s=$a(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=zo(t,s,i),e!==null&&(Js(e,t,i,n),nh(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Ai(),n=Ho(t),i=$a(r,n);i.tag=2,e!=null&&(i.callback=e),e=zo(t,i,n),e!==null&&(Js(e,t,n,r),nh(e,t,n))}};function g_(t,e,r,n,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,a):e.prototype&&e.prototype.isPureReactComponent?!Kd(r,n)||!Kd(i,s):!0}function XS(t,e,r){var n=!1,i=Jo,s=e.contextType;return typeof s=="object"&&s!==null?s=Ns(s):(i=Wi(e)?Vl:fi.current,n=e.contextTypes,s=(n=n!=null)?cu(t,i):Jo),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Cp,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function m_(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Cp.enqueueReplaceState(e,e.state,null)}function zm(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},u1(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Ns(s):(s=Wi(e)?Vl:fi.current,i.context=cu(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Vm(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Cp.enqueueReplaceState(i,i.state,null),Ph(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function hu(t,e){try{var r="",n=e;do r+=kb(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Fg(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Wm(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var ZI=typeof WeakMap=="function"?WeakMap:Map;function qS(t,e,r){r=$a(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){jh||(jh=!0,Zm=n),Wm(t,e)},r}function QS(t,e,r){r=$a(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){Wm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Wm(t,e),typeof n!="function"&&(Wo===null?Wo=new Set([this]):Wo.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function x_(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new ZI;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=hN.bind(null,t,e,r),e.then(t,t))}function v_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function y_(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=$a(-1,1),e.tag=2,zo(r,e,1))),r.lanes|=1),t)}var eN=ao.ReactCurrentOwner,Vi=!1;function wi(t,e,r,n){e.child=t===null?kS(e,null,r,n):du(e,t.child,r,n)}function __(t,e,r,n,i){r=r.render;var s=e.ref;return Jc(e,i),n=g1(t,e,r,n,s,i),r=m1(),t!==null&&!Vi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Za(t,e,i)):(Fr&&r&&n1(e),e.flags|=1,wi(t,e,n,i),e.child)}function E_(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!k1(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,JS(t,e,s,n,i)):(t=ch(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:Kd,r(a,n)&&t.ref===e.ref)return Za(t,e,i)}return e.flags|=1,t=$o(s,n),t.ref=e.ref,t.return=e,e.child=t}function JS(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(Kd(s,n)&&t.ref===e.ref)if(Vi=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(Vi=!0);else return e.lanes=t.lanes,Za(t,e,i)}return Hm(t,e,r,n,i)}function ZS(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},pr($c,qi),qi|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,pr($c,qi),qi|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,pr($c,qi),qi|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,pr($c,qi),qi|=n;return wi(t,e,i,r),e.child}function eT(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Hm(t,e,r,n,i){var s=Wi(r)?Vl:fi.current;return s=cu(e,s),Jc(e,i),r=g1(t,e,r,n,s,i),n=m1(),t!==null&&!Vi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Za(t,e,i)):(Fr&&n&&n1(e),e.flags|=1,wi(t,e,r,i),e.child)}function w_(t,e,r,n,i){if(Wi(r)){var s=!0;bh(e)}else s=!1;if(Jc(e,i),e.stateNode===null)ah(t,e),XS(e,r,n),zm(e,r,n,i),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,u=r.contextType;typeof u=="object"&&u!==null?u=Ns(u):(u=Wi(r)?Vl:fi.current,u=cu(e,u));var f=r.getDerivedStateFromProps,p=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";p||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==u)&&m_(e,a,n,u),Ao=!1;var g=e.memoizedState;a.state=g,Ph(e,n,a,i),l=e.memoizedState,o!==n||g!==l||zi.current||Ao?(typeof f=="function"&&(Vm(e,r,f,n),l=e.memoizedState),(o=Ao||g_(e,r,o,n,g,l,u))?(p||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=u,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,FS(t,e),o=e.memoizedProps,u=e.type===e.elementType?o:$s(e.type,o),a.props=u,p=e.pendingProps,g=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=Ns(l):(l=Wi(r)?Vl:fi.current,l=cu(e,l));var m=r.getDerivedStateFromProps;(f=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==p||g!==l)&&m_(e,a,n,l),Ao=!1,g=e.memoizedState,a.state=g,Ph(e,n,a,i);var y=e.memoizedState;o!==p||g!==y||zi.current||Ao?(typeof m=="function"&&(Vm(e,r,m,n),y=e.memoizedState),(u=Ao||g_(e,r,u,n,g,y,l)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,y,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,y,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=y),a.props=n,a.state=y,a.context=l,n=u):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),n=!1)}return $m(t,e,r,n,s,i)}function $m(t,e,r,n,i,s){eT(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return i&&o_(e,r,!1),Za(t,e,s);n=e.stateNode,eN.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=du(e,t.child,null,s),e.child=du(e,null,o,s)):wi(t,e,o,s),e.memoizedState=n.state,i&&o_(e,r,!0),e.child}function tT(t){var e=t.stateNode;e.pendingContext?a_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&a_(t,e.context,!1),d1(t,e.containerInfo)}function S_(t,e,r,n,i){return uu(),s1(i),e.flags|=256,wi(t,e,r,n),e.child}var Gm={dehydrated:null,treeContext:null,retryLane:0};function Km(t){return{baseLanes:t,cachePool:null,transitions:null}}function rT(t,e,r){var n=e.pendingProps,i=Rr.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),pr(Rr,i&1),t===null)return jm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,s?(n=e.mode,s=e.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=Ip(a,n,0,null),t=Pl(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Km(r),e.memoizedState=Gm,t):y1(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return tN(t,e,a,n,o,i,r);if(s){s=n.fallback,a=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=$o(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=$o(o,s):(s=Pl(s,a,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,a=t.child.memoizedState,a=a===null?Km(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~r,e.memoizedState=Gm,n}return s=t.child,t=s.sibling,n=$o(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function y1(t,e){return e=Ip({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function S0(t,e,r,n){return n!==null&&s1(n),du(e,t.child,null,r),t=y1(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function tN(t,e,r,n,i,s,a){if(r)return e.flags&256?(e.flags&=-257,n=Fg(Error(Me(422))),S0(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=Ip({mode:"visible",children:n.children},i,0,null),s=Pl(s,i,a,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&du(e,t.child,null,a),e.child.memoizedState=Km(a),e.memoizedState=Gm,s);if(!(e.mode&1))return S0(t,e,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(Me(419)),n=Fg(s,n,void 0),S0(t,e,a,n)}if(o=(a&t.childLanes)!==0,Vi||o){if(n=Mn,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Ja(t,i),Js(n,t,i,-1))}return A1(),n=Fg(Error(Me(421))),S0(t,e,a,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=pN.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,ts=Vo(i.nextSibling),rs=e,Fr=!0,Ks=null,t!==null&&(As[ks++]=ja,As[ks++]=Ua,As[ks++]=zl,ja=t.id,Ua=t.overflow,zl=e),e=y1(e,n.children),e.flags|=4096,e)}function T_(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Um(t.return,e,r)}function bg(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function nT(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(wi(t,e,n.children,r),n=Rr.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&T_(t,r,e);else if(t.tag===19)T_(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(pr(Rr,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&Oh(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),bg(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Oh(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}bg(e,!0,r,null,s);break;case"together":bg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ah(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Za(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Hl|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Me(153));if(e.child!==null){for(t=e.child,r=$o(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=$o(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function rN(t,e,r){switch(e.tag){case 3:tT(e),uu();break;case 5:bS(e);break;case 1:Wi(e.type)&&bh(e);break;case 4:d1(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;pr(Rh,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(pr(Rr,Rr.current&1),e.flags|=128,null):r&e.child.childLanes?rT(t,e,r):(pr(Rr,Rr.current&1),t=Za(t,e,r),t!==null?t.sibling:null);pr(Rr,Rr.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return nT(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),pr(Rr,Rr.current),n)break;return null;case 22:case 23:return e.lanes=0,ZS(t,e,r)}return Za(t,e,r)}var iT,Ym,sT,aT;iT=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Ym=function(){};sT=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,Il(xa.current);var s=null;switch(r){case"input":i=mm(t,i),n=mm(t,n),s=[];break;case"select":i=Mr({},i,{value:void 0}),n=Mr({},n,{value:void 0}),s=[];break;case"textarea":i=ym(t,i),n=ym(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Ch)}Em(r,n);var a;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Ud.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var l=n[u];if(o=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Ud.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&vr("scroll",t),s||o===l||(s=[])):(s=s||[]).push(u,l))}r&&(s=s||[]).push("style",r);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};aT=function(t,e,r,n){r!==n&&(e.flags|=4)};function ed(t,e){if(!Fr)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function ti(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function nN(t,e,r){var n=e.pendingProps;switch(i1(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ti(e),null;case 1:return Wi(e.type)&&Fh(),ti(e),null;case 3:return n=e.stateNode,fu(),_r(zi),_r(fi),h1(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(E0(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ks!==null&&(rx(Ks),Ks=null))),Ym(t,e),ti(e),null;case 5:f1(e);var i=Il(Jd.current);if(r=e.type,t!==null&&e.stateNode!=null)sT(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Me(166));return ti(e),null}if(t=Il(xa.current),E0(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[pa]=e,n[qd]=s,t=(e.mode&1)!==0,r){case"dialog":vr("cancel",n),vr("close",n);break;case"iframe":case"object":case"embed":vr("load",n);break;case"video":case"audio":for(i=0;i<ud.length;i++)vr(ud[i],n);break;case"source":vr("error",n);break;case"img":case"image":case"link":vr("error",n),vr("load",n);break;case"details":vr("toggle",n);break;case"input":Dy(n,s),vr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},vr("invalid",n);break;case"textarea":Oy(n,s),vr("invalid",n)}Em(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&_0(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&_0(n.textContent,o,t),i=["children",""+o]):Ud.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&vr("scroll",n)}switch(r){case"input":f0(n),Py(n,s,!0);break;case"textarea":f0(n),My(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Ch)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Pw(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[pa]=e,t[qd]=n,iT(t,e,!1,!1),e.stateNode=t;e:{switch(a=wm(r,n),r){case"dialog":vr("cancel",t),vr("close",t),i=n;break;case"iframe":case"object":case"embed":vr("load",t),i=n;break;case"video":case"audio":for(i=0;i<ud.length;i++)vr(ud[i],t);i=n;break;case"source":vr("error",t),i=n;break;case"img":case"image":case"link":vr("error",t),vr("load",t),i=n;break;case"details":vr("toggle",t),i=n;break;case"input":Dy(t,n),i=mm(t,n),vr("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=Mr({},n,{value:void 0}),vr("invalid",t);break;case"textarea":Oy(t,n),i=ym(t,n),vr("invalid",t);break;default:i=n}Em(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?Lw(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Ow(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Vd(t,l):typeof l=="number"&&Vd(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Ud.hasOwnProperty(s)?l!=null&&s==="onScroll"&&vr("scroll",t):l!=null&&Wx(t,s,l,a))}switch(r){case"input":f0(t),Py(t,n,!1);break;case"textarea":f0(t),My(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Qo(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?Yc(t,!!n.multiple,s,!1):n.defaultValue!=null&&Yc(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Ch)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ti(e),null;case 6:if(t&&e.stateNode!=null)aT(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Me(166));if(r=Il(Jd.current),Il(xa.current),E0(e)){if(n=e.stateNode,r=e.memoizedProps,n[pa]=e,(s=n.nodeValue!==r)&&(t=rs,t!==null))switch(t.tag){case 3:_0(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&_0(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[pa]=e,e.stateNode=n}return ti(e),null;case 13:if(_r(Rr),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Fr&&ts!==null&&e.mode&1&&!(e.flags&128))TS(),uu(),e.flags|=98560,s=!1;else if(s=E0(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(Me(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Me(317));s[pa]=e}else uu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ti(e),s=!1}else Ks!==null&&(rx(Ks),Ks=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Rr.current&1?yn===0&&(yn=3):A1())),e.updateQueue!==null&&(e.flags|=4),ti(e),null);case 4:return fu(),Ym(t,e),t===null&&Yd(e.stateNode.containerInfo),ti(e),null;case 10:return l1(e.type._context),ti(e),null;case 17:return Wi(e.type)&&Fh(),ti(e),null;case 19:if(_r(Rr),s=e.memoizedState,s===null)return ti(e),null;if(n=(e.flags&128)!==0,a=s.rendering,a===null)if(n)ed(s,!1);else{if(yn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Oh(t),a!==null){for(e.flags|=128,ed(s,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return pr(Rr,Rr.current&1|2),e.child}t=t.sibling}s.tail!==null&&Kr()>pu&&(e.flags|=128,n=!0,ed(s,!1),e.lanes=4194304)}else{if(!n)if(t=Oh(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),ed(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Fr)return ti(e),null}else 2*Kr()-s.renderingStartTime>pu&&r!==1073741824&&(e.flags|=128,n=!0,ed(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(r=s.last,r!==null?r.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Kr(),e.sibling=null,r=Rr.current,pr(Rr,n?r&1|2:r&1),e):(ti(e),null);case 22:case 23:return T1(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?qi&1073741824&&(ti(e),e.subtreeFlags&6&&(e.flags|=8192)):ti(e),null;case 24:return null;case 25:return null}throw Error(Me(156,e.tag))}function iN(t,e){switch(i1(e),e.tag){case 1:return Wi(e.type)&&Fh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return fu(),_r(zi),_r(fi),h1(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return f1(e),null;case 13:if(_r(Rr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Me(340));uu()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return _r(Rr),null;case 4:return fu(),null;case 10:return l1(e.type._context),null;case 22:case 23:return T1(),null;case 24:return null;default:return null}}var T0=!1,oi=!1,sN=typeof WeakSet=="function"?WeakSet:Set,Qe=null;function Hc(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){jr(t,e,n)}else r.current=null}function Xm(t,e,r){try{r()}catch(n){jr(t,e,n)}}var A_=!1;function aN(t,e){if(Rm=Th,t=dS(),r1(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,u=0,f=0,p=t,g=null;t:for(;;){for(var m;p!==r||i!==0&&p.nodeType!==3||(o=a+i),p!==s||n!==0&&p.nodeType!==3||(l=a+n),p.nodeType===3&&(a+=p.nodeValue.length),(m=p.firstChild)!==null;)g=p,p=m;for(;;){if(p===t)break t;if(g===r&&++u===i&&(o=a),g===s&&++f===n&&(l=a),(m=p.nextSibling)!==null)break;p=g,g=p.parentNode}p=m}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Dm={focusedElem:t,selectionRange:r},Th=!1,Qe=e;Qe!==null;)if(e=Qe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Qe=t;else for(;Qe!==null;){e=Qe;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var x=y.memoizedProps,w=y.memoizedState,A=e.stateNode,k=A.getSnapshotBeforeUpdate(e.elementType===e.type?x:$s(e.type,x),w);A.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var E=e.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Me(163))}}catch(P){jr(e,e.return,P)}if(t=e.sibling,t!==null){t.return=e.return,Qe=t;break}Qe=e.return}return y=A_,A_=!1,y}function Td(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Xm(e,r,s)}i=i.next}while(i!==n)}}function Fp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function qm(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function oT(t){var e=t.alternate;e!==null&&(t.alternate=null,oT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[pa],delete e[qd],delete e[Mm],delete e[zI],delete e[WI])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function lT(t){return t.tag===5||t.tag===3||t.tag===4}function k_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||lT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Qm(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Ch));else if(n!==4&&(t=t.child,t!==null))for(Qm(t,e,r),t=t.sibling;t!==null;)Qm(t,e,r),t=t.sibling}function Jm(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Jm(t,e,r),t=t.sibling;t!==null;)Jm(t,e,r),t=t.sibling}var Wn=null,Gs=!1;function _o(t,e,r){for(r=r.child;r!==null;)cT(t,e,r),r=r.sibling}function cT(t,e,r){if(ma&&typeof ma.onCommitFiberUnmount=="function")try{ma.onCommitFiberUnmount(_p,r)}catch{}switch(r.tag){case 5:oi||Hc(r,e);case 6:var n=Wn,i=Gs;Wn=null,_o(t,e,r),Wn=n,Gs=i,Wn!==null&&(Gs?(t=Wn,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Wn.removeChild(r.stateNode));break;case 18:Wn!==null&&(Gs?(t=Wn,r=r.stateNode,t.nodeType===8?wg(t.parentNode,r):t.nodeType===1&&wg(t,r),$d(t)):wg(Wn,r.stateNode));break;case 4:n=Wn,i=Gs,Wn=r.stateNode.containerInfo,Gs=!0,_o(t,e,r),Wn=n,Gs=i;break;case 0:case 11:case 14:case 15:if(!oi&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&Xm(r,e,a),i=i.next}while(i!==n)}_o(t,e,r);break;case 1:if(!oi&&(Hc(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){jr(r,e,o)}_o(t,e,r);break;case 21:_o(t,e,r);break;case 22:r.mode&1?(oi=(n=oi)||r.memoizedState!==null,_o(t,e,r),oi=n):_o(t,e,r);break;default:_o(t,e,r)}}function C_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new sN),e.forEach(function(n){var i=gN.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Vs(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:Wn=o.stateNode,Gs=!1;break e;case 3:Wn=o.stateNode.containerInfo,Gs=!0;break e;case 4:Wn=o.stateNode.containerInfo,Gs=!0;break e}o=o.return}if(Wn===null)throw Error(Me(160));cT(s,a,i),Wn=null,Gs=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){jr(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)uT(e,t),e=e.sibling}function uT(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Vs(e,t),ca(t),n&4){try{Td(3,t,t.return),Fp(3,t)}catch(x){jr(t,t.return,x)}try{Td(5,t,t.return)}catch(x){jr(t,t.return,x)}}break;case 1:Vs(e,t),ca(t),n&512&&r!==null&&Hc(r,r.return);break;case 5:if(Vs(e,t),ca(t),n&512&&r!==null&&Hc(r,r.return),t.flags&32){var i=t.stateNode;try{Vd(i,"")}catch(x){jr(t,t.return,x)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=r!==null?r.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&Rw(i,s),wm(o,a);var u=wm(o,s);for(a=0;a<l.length;a+=2){var f=l[a],p=l[a+1];f==="style"?Lw(i,p):f==="dangerouslySetInnerHTML"?Ow(i,p):f==="children"?Vd(i,p):Wx(i,f,p,u)}switch(o){case"input":xm(i,s);break;case"textarea":Dw(i,s);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?Yc(i,!!s.multiple,m,!1):g!==!!s.multiple&&(s.defaultValue!=null?Yc(i,!!s.multiple,s.defaultValue,!0):Yc(i,!!s.multiple,s.multiple?[]:"",!1))}i[qd]=s}catch(x){jr(t,t.return,x)}}break;case 6:if(Vs(e,t),ca(t),n&4){if(t.stateNode===null)throw Error(Me(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(x){jr(t,t.return,x)}}break;case 3:if(Vs(e,t),ca(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{$d(e.containerInfo)}catch(x){jr(t,t.return,x)}break;case 4:Vs(e,t),ca(t);break;case 13:Vs(e,t),ca(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(w1=Kr())),n&4&&C_(t);break;case 22:if(f=r!==null&&r.memoizedState!==null,t.mode&1?(oi=(u=oi)||f,Vs(e,t),oi=u):Vs(e,t),ca(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(Qe=t,f=t.child;f!==null;){for(p=Qe=f;Qe!==null;){switch(g=Qe,m=g.child,g.tag){case 0:case 11:case 14:case 15:Td(4,g,g.return);break;case 1:Hc(g,g.return);var y=g.stateNode;if(typeof y.componentWillUnmount=="function"){n=g,r=g.return;try{e=n,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(x){jr(n,r,x)}}break;case 5:Hc(g,g.return);break;case 22:if(g.memoizedState!==null){b_(p);continue}}m!==null?(m.return=g,Qe=m):b_(p)}f=f.sibling}e:for(f=null,p=t;;){if(p.tag===5){if(f===null){f=p;try{i=p.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=p.stateNode,l=p.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Mw("display",a))}catch(x){jr(t,t.return,x)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(x){jr(t,t.return,x)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Vs(e,t),ca(t),n&4&&C_(t);break;case 21:break;default:Vs(e,t),ca(t)}}function ca(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(lT(r)){var n=r;break e}r=r.return}throw Error(Me(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Vd(i,""),n.flags&=-33);var s=k_(t);Jm(t,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=k_(t);Qm(t,o,a);break;default:throw Error(Me(161))}}catch(l){jr(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function oN(t,e,r){Qe=t,dT(t)}function dT(t,e,r){for(var n=(t.mode&1)!==0;Qe!==null;){var i=Qe,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||T0;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||oi;o=T0;var u=oi;if(T0=a,(oi=l)&&!u)for(Qe=i;Qe!==null;)a=Qe,l=a.child,a.tag===22&&a.memoizedState!==null?I_(i):l!==null?(l.return=a,Qe=l):I_(i);for(;s!==null;)Qe=s,dT(s),s=s.sibling;Qe=i,T0=o,oi=u}F_(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Qe=s):F_(t)}}function F_(t){for(;Qe!==null;){var e=Qe;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:oi||Fp(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!oi)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:$s(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&f_(e,s,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}f_(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&$d(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Me(163))}oi||e.flags&512&&qm(e)}catch(g){jr(e,e.return,g)}}if(e===t){Qe=null;break}if(r=e.sibling,r!==null){r.return=e.return,Qe=r;break}Qe=e.return}}function b_(t){for(;Qe!==null;){var e=Qe;if(e===t){Qe=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Qe=r;break}Qe=e.return}}function I_(t){for(;Qe!==null;){var e=Qe;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Fp(4,e)}catch(l){jr(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){jr(e,i,l)}}var s=e.return;try{qm(e)}catch(l){jr(e,s,l)}break;case 5:var a=e.return;try{qm(e)}catch(l){jr(e,a,l)}}}catch(l){jr(e,e.return,l)}if(e===t){Qe=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Qe=o;break}Qe=e.return}}var lN=Math.ceil,Bh=ao.ReactCurrentDispatcher,_1=ao.ReactCurrentOwner,bs=ao.ReactCurrentBatchConfig,Kt=0,Mn=null,nn=null,Yn=0,qi=0,$c=ol(0),yn=0,rf=null,Hl=0,bp=0,E1=0,Ad=null,Ui=null,w1=0,pu=1/0,La=null,jh=!1,Zm=null,Wo=null,A0=!1,Do=null,Uh=0,kd=0,ex=null,oh=-1,lh=0;function Ai(){return Kt&6?Kr():oh!==-1?oh:oh=Kr()}function Ho(t){return t.mode&1?Kt&2&&Yn!==0?Yn&-Yn:$I.transition!==null?(lh===0&&(lh=Xw()),lh):(t=sr,t!==0||(t=window.event,t=t===void 0?16:rS(t.type)),t):1}function Js(t,e,r,n){if(50<kd)throw kd=0,ex=null,Error(Me(185));bf(t,r,n),(!(Kt&2)||t!==Mn)&&(t===Mn&&(!(Kt&2)&&(bp|=r),yn===4&&Co(t,Yn)),Hi(t,n),r===1&&Kt===0&&!(e.mode&1)&&(pu=Kr()+500,Ap&&ll()))}function Hi(t,e){var r=t.callbackNode;$b(t,e);var n=Sh(t,t===Mn?Yn:0);if(n===0)r!==null&&jy(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&jy(r),e===1)t.tag===0?HI(N_.bind(null,t)):ES(N_.bind(null,t)),UI(function(){!(Kt&6)&&ll()}),r=null;else{switch(qw(n)){case 1:r=Yx;break;case 4:r=Kw;break;case 16:r=wh;break;case 536870912:r=Yw;break;default:r=wh}r=yT(r,fT.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function fT(t,e){if(oh=-1,lh=0,Kt&6)throw Error(Me(327));var r=t.callbackNode;if(Zc()&&t.callbackNode!==r)return null;var n=Sh(t,t===Mn?Yn:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Vh(t,n);else{e=n;var i=Kt;Kt|=2;var s=pT();(Mn!==t||Yn!==e)&&(La=null,pu=Kr()+500,Dl(t,e));do try{dN();break}catch(o){hT(t,o)}while(!0);o1(),Bh.current=s,Kt=i,nn!==null?e=0:(Mn=null,Yn=0,e=yn)}if(e!==0){if(e===2&&(i=Cm(t),i!==0&&(n=i,e=tx(t,i))),e===1)throw r=rf,Dl(t,0),Co(t,n),Hi(t,Kr()),r;if(e===6)Co(t,n);else{if(i=t.current.alternate,!(n&30)&&!cN(i)&&(e=Vh(t,n),e===2&&(s=Cm(t),s!==0&&(n=s,e=tx(t,s))),e===1))throw r=rf,Dl(t,0),Co(t,n),Hi(t,Kr()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(Me(345));case 2:Tl(t,Ui,La);break;case 3:if(Co(t,n),(n&130023424)===n&&(e=w1+500-Kr(),10<e)){if(Sh(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){Ai(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Om(Tl.bind(null,t,Ui,La),e);break}Tl(t,Ui,La);break;case 4:if(Co(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var a=31-Qs(n);s=1<<a,a=e[a],a>i&&(i=a),n&=~s}if(n=i,n=Kr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*lN(n/1960))-n,10<n){t.timeoutHandle=Om(Tl.bind(null,t,Ui,La),n);break}Tl(t,Ui,La);break;case 5:Tl(t,Ui,La);break;default:throw Error(Me(329))}}}return Hi(t,Kr()),t.callbackNode===r?fT.bind(null,t):null}function tx(t,e){var r=Ad;return t.current.memoizedState.isDehydrated&&(Dl(t,e).flags|=256),t=Vh(t,e),t!==2&&(e=Ui,Ui=r,e!==null&&rx(e)),t}function rx(t){Ui===null?Ui=t:Ui.push.apply(Ui,t)}function cN(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!ta(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Co(t,e){for(e&=~E1,e&=~bp,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Qs(e),n=1<<r;t[r]=-1,e&=~n}}function N_(t){if(Kt&6)throw Error(Me(327));Zc();var e=Sh(t,0);if(!(e&1))return Hi(t,Kr()),null;var r=Vh(t,e);if(t.tag!==0&&r===2){var n=Cm(t);n!==0&&(e=n,r=tx(t,n))}if(r===1)throw r=rf,Dl(t,0),Co(t,e),Hi(t,Kr()),r;if(r===6)throw Error(Me(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Tl(t,Ui,La),Hi(t,Kr()),null}function S1(t,e){var r=Kt;Kt|=1;try{return t(e)}finally{Kt=r,Kt===0&&(pu=Kr()+500,Ap&&ll())}}function $l(t){Do!==null&&Do.tag===0&&!(Kt&6)&&Zc();var e=Kt;Kt|=1;var r=bs.transition,n=sr;try{if(bs.transition=null,sr=1,t)return t()}finally{sr=n,bs.transition=r,Kt=e,!(Kt&6)&&ll()}}function T1(){qi=$c.current,_r($c)}function Dl(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,jI(r)),nn!==null)for(r=nn.return;r!==null;){var n=r;switch(i1(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Fh();break;case 3:fu(),_r(zi),_r(fi),h1();break;case 5:f1(n);break;case 4:fu();break;case 13:_r(Rr);break;case 19:_r(Rr);break;case 10:l1(n.type._context);break;case 22:case 23:T1()}r=r.return}if(Mn=t,nn=t=$o(t.current,null),Yn=qi=e,yn=0,rf=null,E1=bp=Hl=0,Ui=Ad=null,bl!==null){for(e=0;e<bl.length;e++)if(r=bl[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}bl=null}return t}function hT(t,e){do{var r=nn;try{if(o1(),ih.current=Lh,Mh){for(var n=Or.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Mh=!1}if(Wl=0,Dn=mn=Or=null,Sd=!1,Zd=0,_1.current=null,r===null||r.return===null){yn=1,rf=e,nn=null;break}e:{var s=t,a=r.return,o=r,l=e;if(e=Yn,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,f=o,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var g=f.alternate;g?(f.updateQueue=g.updateQueue,f.memoizedState=g.memoizedState,f.lanes=g.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=v_(a);if(m!==null){m.flags&=-257,y_(m,a,o,s,e),m.mode&1&&x_(s,u,e),e=m,l=u;var y=e.updateQueue;if(y===null){var x=new Set;x.add(l),e.updateQueue=x}else y.add(l);break e}else{if(!(e&1)){x_(s,u,e),A1();break e}l=Error(Me(426))}}else if(Fr&&o.mode&1){var w=v_(a);if(w!==null){!(w.flags&65536)&&(w.flags|=256),y_(w,a,o,s,e),s1(hu(l,o));break e}}s=l=hu(l,o),yn!==4&&(yn=2),Ad===null?Ad=[s]:Ad.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var A=qS(s,l,e);d_(s,A);break e;case 1:o=l;var k=s.type,E=s.stateNode;if(!(s.flags&128)&&(typeof k.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Wo===null||!Wo.has(E)))){s.flags|=65536,e&=-e,s.lanes|=e;var P=QS(s,o,e);d_(s,P);break e}}s=s.return}while(s!==null)}mT(r)}catch(Y){e=Y,nn===r&&r!==null&&(nn=r=r.return);continue}break}while(!0)}function pT(){var t=Bh.current;return Bh.current=Lh,t===null?Lh:t}function A1(){(yn===0||yn===3||yn===2)&&(yn=4),Mn===null||!(Hl&268435455)&&!(bp&268435455)||Co(Mn,Yn)}function Vh(t,e){var r=Kt;Kt|=2;var n=pT();(Mn!==t||Yn!==e)&&(La=null,Dl(t,e));do try{uN();break}catch(i){hT(t,i)}while(!0);if(o1(),Kt=r,Bh.current=n,nn!==null)throw Error(Me(261));return Mn=null,Yn=0,yn}function uN(){for(;nn!==null;)gT(nn)}function dN(){for(;nn!==null&&!Mb();)gT(nn)}function gT(t){var e=vT(t.alternate,t,qi);t.memoizedProps=t.pendingProps,e===null?mT(t):nn=e,_1.current=null}function mT(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=iN(r,e),r!==null){r.flags&=32767,nn=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{yn=6,nn=null;return}}else if(r=nN(r,e,qi),r!==null){nn=r;return}if(e=e.sibling,e!==null){nn=e;return}nn=e=t}while(e!==null);yn===0&&(yn=5)}function Tl(t,e,r){var n=sr,i=bs.transition;try{bs.transition=null,sr=1,fN(t,e,r,n)}finally{bs.transition=i,sr=n}return null}function fN(t,e,r,n){do Zc();while(Do!==null);if(Kt&6)throw Error(Me(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Me(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(Gb(t,s),t===Mn&&(nn=Mn=null,Yn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||A0||(A0=!0,yT(wh,function(){return Zc(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=bs.transition,bs.transition=null;var a=sr;sr=1;var o=Kt;Kt|=4,_1.current=null,aN(t,r),uT(r,t),RI(Dm),Th=!!Rm,Dm=Rm=null,t.current=r,oN(r),Lb(),Kt=o,sr=a,bs.transition=s}else t.current=r;if(A0&&(A0=!1,Do=t,Uh=i),s=t.pendingLanes,s===0&&(Wo=null),Ub(r.stateNode),Hi(t,Kr()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(jh)throw jh=!1,t=Zm,Zm=null,t;return Uh&1&&t.tag!==0&&Zc(),s=t.pendingLanes,s&1?t===ex?kd++:(kd=0,ex=t):kd=0,ll(),null}function Zc(){if(Do!==null){var t=qw(Uh),e=bs.transition,r=sr;try{if(bs.transition=null,sr=16>t?16:t,Do===null)var n=!1;else{if(t=Do,Do=null,Uh=0,Kt&6)throw Error(Me(331));var i=Kt;for(Kt|=4,Qe=t.current;Qe!==null;){var s=Qe,a=s.child;if(Qe.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(Qe=u;Qe!==null;){var f=Qe;switch(f.tag){case 0:case 11:case 15:Td(8,f,s)}var p=f.child;if(p!==null)p.return=f,Qe=p;else for(;Qe!==null;){f=Qe;var g=f.sibling,m=f.return;if(oT(f),f===u){Qe=null;break}if(g!==null){g.return=m,Qe=g;break}Qe=m}}}var y=s.alternate;if(y!==null){var x=y.child;if(x!==null){y.child=null;do{var w=x.sibling;x.sibling=null,x=w}while(x!==null)}}Qe=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,Qe=a;else e:for(;Qe!==null;){if(s=Qe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Td(9,s,s.return)}var A=s.sibling;if(A!==null){A.return=s.return,Qe=A;break e}Qe=s.return}}var k=t.current;for(Qe=k;Qe!==null;){a=Qe;var E=a.child;if(a.subtreeFlags&2064&&E!==null)E.return=a,Qe=E;else e:for(a=k;Qe!==null;){if(o=Qe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Fp(9,o)}}catch(Y){jr(o,o.return,Y)}if(o===a){Qe=null;break e}var P=o.sibling;if(P!==null){P.return=o.return,Qe=P;break e}Qe=o.return}}if(Kt=i,ll(),ma&&typeof ma.onPostCommitFiberRoot=="function")try{ma.onPostCommitFiberRoot(_p,t)}catch{}n=!0}return n}finally{sr=r,bs.transition=e}}return!1}function R_(t,e,r){e=hu(r,e),e=qS(t,e,1),t=zo(t,e,1),e=Ai(),t!==null&&(bf(t,1,e),Hi(t,e))}function jr(t,e,r){if(t.tag===3)R_(t,t,r);else for(;e!==null;){if(e.tag===3){R_(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Wo===null||!Wo.has(n))){t=hu(r,t),t=QS(e,t,1),e=zo(e,t,1),t=Ai(),e!==null&&(bf(e,1,t),Hi(e,t));break}}e=e.return}}function hN(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Ai(),t.pingedLanes|=t.suspendedLanes&r,Mn===t&&(Yn&r)===r&&(yn===4||yn===3&&(Yn&130023424)===Yn&&500>Kr()-w1?Dl(t,0):E1|=r),Hi(t,e)}function xT(t,e){e===0&&(t.mode&1?(e=g0,g0<<=1,!(g0&130023424)&&(g0=4194304)):e=1);var r=Ai();t=Ja(t,e),t!==null&&(bf(t,e,r),Hi(t,r))}function pN(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),xT(t,r)}function gN(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Me(314))}n!==null&&n.delete(e),xT(t,r)}var vT;vT=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||zi.current)Vi=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Vi=!1,rN(t,e,r);Vi=!!(t.flags&131072)}else Vi=!1,Fr&&e.flags&1048576&&wS(e,Nh,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;ah(t,e),t=e.pendingProps;var i=cu(e,fi.current);Jc(e,r),i=g1(null,e,n,t,i,r);var s=m1();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Wi(n)?(s=!0,bh(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,u1(e),i.updater=Cp,e.stateNode=i,i._reactInternals=e,zm(e,n,t,r),e=$m(null,e,n,!0,s,r)):(e.tag=0,Fr&&s&&n1(e),wi(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(ah(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=xN(n),t=$s(n,t),i){case 0:e=Hm(null,e,n,t,r);break e;case 1:e=w_(null,e,n,t,r);break e;case 11:e=__(null,e,n,t,r);break e;case 14:e=E_(null,e,n,$s(n.type,t),r);break e}throw Error(Me(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:$s(n,i),Hm(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:$s(n,i),w_(t,e,n,i,r);case 3:e:{if(tT(e),t===null)throw Error(Me(387));n=e.pendingProps,s=e.memoizedState,i=s.element,FS(t,e),Ph(e,n,null,r);var a=e.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=hu(Error(Me(423)),e),e=S_(t,e,n,r,i);break e}else if(n!==i){i=hu(Error(Me(424)),e),e=S_(t,e,n,r,i);break e}else for(ts=Vo(e.stateNode.containerInfo.firstChild),rs=e,Fr=!0,Ks=null,r=kS(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(uu(),n===i){e=Za(t,e,r);break e}wi(t,e,n,r)}e=e.child}return e;case 5:return bS(e),t===null&&jm(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,Pm(n,i)?a=null:s!==null&&Pm(n,s)&&(e.flags|=32),eT(t,e),wi(t,e,a,r),e.child;case 6:return t===null&&jm(e),null;case 13:return rT(t,e,r);case 4:return d1(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=du(e,null,n,r):wi(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:$s(n,i),__(t,e,n,i,r);case 7:return wi(t,e,e.pendingProps,r),e.child;case 8:return wi(t,e,e.pendingProps.children,r),e.child;case 12:return wi(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,pr(Rh,n._currentValue),n._currentValue=a,s!==null)if(ta(s.value,a)){if(s.children===i.children&&!zi.current){e=Za(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=$a(-1,r&-r),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?l.next=l:(l.next=f.next,f.next=l),u.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Um(s.return,r,e),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(Me(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Um(a,r,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}wi(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,Jc(e,r),i=Ns(i),n=n(i),e.flags|=1,wi(t,e,n,r),e.child;case 14:return n=e.type,i=$s(n,e.pendingProps),i=$s(n.type,i),E_(t,e,n,i,r);case 15:return JS(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:$s(n,i),ah(t,e),e.tag=1,Wi(n)?(t=!0,bh(e)):t=!1,Jc(e,r),XS(e,n,i),zm(e,n,i,r),$m(null,e,n,!0,t,r);case 19:return nT(t,e,r);case 22:return ZS(t,e,r)}throw Error(Me(156,e.tag))};function yT(t,e){return Gw(t,e)}function mN(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fs(t,e,r,n){return new mN(t,e,r,n)}function k1(t){return t=t.prototype,!(!t||!t.isReactComponent)}function xN(t){if(typeof t=="function")return k1(t)?1:0;if(t!=null){if(t=t.$$typeof,t===$x)return 11;if(t===Gx)return 14}return 2}function $o(t,e){var r=t.alternate;return r===null?(r=Fs(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function ch(t,e,r,n,i,s){var a=2;if(n=t,typeof t=="function")k1(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Oc:return Pl(r.children,i,s,e);case Hx:a=8,i|=8;break;case fm:return t=Fs(12,r,e,i|2),t.elementType=fm,t.lanes=s,t;case hm:return t=Fs(13,r,e,i),t.elementType=hm,t.lanes=s,t;case pm:return t=Fs(19,r,e,i),t.elementType=pm,t.lanes=s,t;case bw:return Ip(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Cw:a=10;break e;case Fw:a=9;break e;case $x:a=11;break e;case Gx:a=14;break e;case To:a=16,n=null;break e}throw Error(Me(130,t==null?t:typeof t,""))}return e=Fs(a,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function Pl(t,e,r,n){return t=Fs(7,t,n,e),t.lanes=r,t}function Ip(t,e,r,n){return t=Fs(22,t,n,e),t.elementType=bw,t.lanes=r,t.stateNode={isHidden:!1},t}function Ig(t,e,r){return t=Fs(6,t,null,e),t.lanes=r,t}function Ng(t,e,r){return e=Fs(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function vN(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=dg(0),this.expirationTimes=dg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dg(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function C1(t,e,r,n,i,s,a,o,l){return t=new vN(t,e,r,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Fs(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},u1(s),t}function yN(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Pc,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function _T(t){if(!t)return Jo;t=t._reactInternals;e:{if(ic(t)!==t||t.tag!==1)throw Error(Me(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Wi(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Me(171))}if(t.tag===1){var r=t.type;if(Wi(r))return _S(t,r,e)}return e}function ET(t,e,r,n,i,s,a,o,l){return t=C1(r,n,!0,t,i,s,a,o,l),t.context=_T(null),r=t.current,n=Ai(),i=Ho(r),s=$a(n,i),s.callback=e??null,zo(r,s,i),t.current.lanes=i,bf(t,i,n),Hi(t,n),t}function Np(t,e,r,n){var i=e.current,s=Ai(),a=Ho(i);return r=_T(r),e.context===null?e.context=r:e.pendingContext=r,e=$a(s,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=zo(i,e,a),t!==null&&(Js(t,i,a,s),nh(t,i,a)),a}function zh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function D_(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function F1(t,e){D_(t,e),(t=t.alternate)&&D_(t,e)}function _N(){return null}var wT=typeof reportError=="function"?reportError:function(t){console.error(t)};function b1(t){this._internalRoot=t}Rp.prototype.render=b1.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Me(409));Np(t,e,null,null)};Rp.prototype.unmount=b1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;$l(function(){Np(null,t,null,null)}),e[Qa]=null}};function Rp(t){this._internalRoot=t}Rp.prototype.unstable_scheduleHydration=function(t){if(t){var e=Zw();t={blockedOn:null,target:t,priority:e};for(var r=0;r<ko.length&&e!==0&&e<ko[r].priority;r++);ko.splice(r,0,t),r===0&&tS(t)}};function I1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Dp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function P_(){}function EN(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=zh(a);s.call(u)}}var a=ET(e,n,t,0,null,!1,!1,"",P_);return t._reactRootContainer=a,t[Qa]=a.current,Yd(t.nodeType===8?t.parentNode:t),$l(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var u=zh(l);o.call(u)}}var l=C1(t,0,!1,null,null,!1,!1,"",P_);return t._reactRootContainer=l,t[Qa]=l.current,Yd(t.nodeType===8?t.parentNode:t),$l(function(){Np(e,l,r,n)}),l}function Pp(t,e,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=zh(a);o.call(l)}}Np(e,a,t,i)}else a=EN(r,e,t,i,n);return zh(a)}Qw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=cd(e.pendingLanes);r!==0&&(Xx(e,r|1),Hi(e,Kr()),!(Kt&6)&&(pu=Kr()+500,ll()))}break;case 13:$l(function(){var n=Ja(t,1);if(n!==null){var i=Ai();Js(n,t,1,i)}}),F1(t,1)}};qx=function(t){if(t.tag===13){var e=Ja(t,134217728);if(e!==null){var r=Ai();Js(e,t,134217728,r)}F1(t,134217728)}};Jw=function(t){if(t.tag===13){var e=Ho(t),r=Ja(t,e);if(r!==null){var n=Ai();Js(r,t,e,n)}F1(t,e)}};Zw=function(){return sr};eS=function(t,e){var r=sr;try{return sr=t,e()}finally{sr=r}};Tm=function(t,e,r){switch(e){case"input":if(xm(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=Tp(n);if(!i)throw Error(Me(90));Nw(n),xm(n,i)}}}break;case"textarea":Dw(t,r);break;case"select":e=r.value,e!=null&&Yc(t,!!r.multiple,e,!1)}};Uw=S1;Vw=$l;var wN={usingClientEntryPoint:!1,Events:[Nf,jc,Tp,Bw,jw,S1]},td={findFiberByHostInstance:Fl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},SN={bundleType:td.bundleType,version:td.version,rendererPackageName:td.rendererPackageName,rendererConfig:td.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ao.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Hw(t),t===null?null:t.stateNode},findFiberByHostInstance:td.findFiberByHostInstance||_N,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var k0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!k0.isDisabled&&k0.supportsFiber)try{_p=k0.inject(SN),ma=k0}catch{}}as.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wN;as.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!I1(e))throw Error(Me(200));return yN(t,e,null,r)};as.createRoot=function(t,e){if(!I1(t))throw Error(Me(299));var r=!1,n="",i=wT;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=C1(t,1,!1,null,null,r,!1,n,i),t[Qa]=e.current,Yd(t.nodeType===8?t.parentNode:t),new b1(e)};as.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Me(188)):(t=Object.keys(t).join(","),Error(Me(268,t)));return t=Hw(e),t=t===null?null:t.stateNode,t};as.flushSync=function(t){return $l(t)};as.hydrate=function(t,e,r){if(!Dp(e))throw Error(Me(200));return Pp(null,t,e,!0,r)};as.hydrateRoot=function(t,e,r){if(!I1(t))throw Error(Me(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=wT;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=ET(e,null,t,1,r??null,i,!1,s,a),t[Qa]=e.current,Yd(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new Rp(e)};as.render=function(t,e,r){if(!Dp(e))throw Error(Me(200));return Pp(null,t,e,!1,r)};as.unmountComponentAtNode=function(t){if(!Dp(t))throw Error(Me(40));return t._reactRootContainer?($l(function(){Pp(null,null,t,!1,function(){t._reactRootContainer=null,t[Qa]=null})}),!0):!1};as.unstable_batchedUpdates=S1;as.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Dp(r))throw Error(Me(200));if(t==null||t._reactInternals===void 0)throw Error(Me(38));return Pp(t,e,r,!1,n)};as.version="18.3.1-next-f1338f8080-20240426";function ST(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ST)}catch(t){console.error(t)}}ST(),Sw.exports=as;var TN=Sw.exports,O_=TN;um.createRoot=O_.createRoot,um.hydrateRoot=O_.hydrateRoot;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Wh={};Wh.version="0.18.5";var TT=1252,AN=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],N1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},R1=function(t){AN.indexOf(t)!=-1&&(TT=N1[0]=t)};function kN(){R1(1252)}var Ys=function(t){R1(t)};function D1(){Ys(1200),kN()}function M_(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function CN(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function AT(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var dd=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?CN(t.slice(2)):e==254&&r==255?AT(t.slice(2)):e==65279?t.slice(1):t},C0=function(e){return String.fromCharCode(e)},L_=function(e){return String.fromCharCode(e)},nf,Po="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function sf(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,u=0;u<t.length;)r=t.charCodeAt(u++),s=r>>2,n=t.charCodeAt(u++),a=(r&3)<<4|n>>4,i=t.charCodeAt(u++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=Po.charAt(s)+Po.charAt(a)+Po.charAt(o)+Po.charAt(l);return e}function ss(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)s=Po.indexOf(t.charAt(u++)),a=Po.indexOf(t.charAt(u++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=Po.indexOf(t.charAt(u++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Po.indexOf(t.charAt(u++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Ft=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),oo=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Zo(t){return Ft?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function B_(t){return Ft?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Zi=function(e){return Ft?oo(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Op(t){if(typeof ArrayBuffer>"u")return Zi(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function cl(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function FN(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function P1(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return P1(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Pn=Ft?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:oo(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function bN(t){for(var e=[],r=0,n=t.length+250,i=Zo(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Zo(65535),n=65530)}return e.push(i.slice(0,r)),Pn(e)}var ki=/\u0000/g,fd=/[\u0001-\u0006]/g;function eu(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Xs(t,e){var r=""+t;return r.length>=e?r:Ur("0",e-r.length)+r}function O1(t,e){var r=""+t;return r.length>=e?r:Ur(" ",e-r.length)+r}function Hh(t,e){var r=""+t;return r.length>=e?r:r+Ur(" ",e-r.length)}function IN(t,e){var r=""+Math.round(t);return r.length>=e?r:Ur("0",e-r.length)+r}function NN(t,e){var r=""+t;return r.length>=e?r:Ur("0",e-r.length)+r}var j_=Math.pow(2,32);function kc(t,e){if(t>j_||t<-j_)return IN(t,e);var r=Math.round(t);return NN(r,e)}function $h(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var U_=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Rg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function RN(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var lt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},V_={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},DN={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Gh(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,l=1,u=0,f=0,p=Math.floor(i);u<e&&(p=Math.floor(i),o=p*a+s,f=p*u+l,!(i-p<5e-8));)i=1/(i-p),s=a,a=o,l=u,u=f;if(f>e&&(u>e?(f=l,o=s):(f=u,o=a)),!r)return[0,n*o,f];var g=Math.floor(n*o/f);return[g,n*o-g*f,f]}function Nl(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=jN(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var kT=new Date(1899,11,31,0,0,0),PN=kT.getTime(),ON=new Date(1900,2,1,0,0,0);function CT(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=ON&&(r+=24*60*60*1e3),(r-(PN+(t.getTimezoneOffset()-kT.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function M1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function MN(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function LN(t){var e=t<0?12:11,r=M1(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function BN(t){var e=M1(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function af(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=LN(t):e===10?r=t.toFixed(10).substr(0,12):r=BN(t),M1(MN(r.toUpperCase()))}function Gl(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):af(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Ds(14,CT(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function jN(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function UN(t,e,r,n){var i="",s=0,a=0,o=r.y,l,u=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,u=e.length;break;case 3:return Rg[r.m-1][1];case 5:return Rg[r.m-1][0];default:return Rg[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,u=e.length;break;case 3:return U_[r.q][0];default:return U_[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Xs(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=Xs(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:l=o,u=1;break}var f=u>0?Xs(l,u):"";return f}function Oo(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var FT=/%/g;function VN(t,e,r){var n=e.replace(FT,""),i=e.length-n.length;return Ga(t,n,r*Math.pow(10,2*i))+Ur("%",i)}function zN(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ga(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function bT(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+bT(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var IT=/# (\?+)( ?)\/( ?)(\d+)/;function WN(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?Ur(" ",t[1].length+1+t[4].length):O1(a,t[1].length)+t[2]+"/"+t[3]+Xs(o,t[4].length))}function HN(t,e,r){return r+(e===0?"":""+e)+Ur(" ",t[1].length+2+t[4].length)}var NT=/^#*0*\.([0#]+)/,RT=/\).*[0#]/,DT=/\(###\) ###\\?-####/;function Si(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function z_(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function W_(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function $N(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function GN(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function _s(t,e,r){if(t.charCodeAt(0)===40&&!e.match(RT)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?_s("n",n,r):"("+_s("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return zN(t,e,r);if(e.indexOf("%")!==-1)return VN(t,e,r);if(e.indexOf("E")!==-1)return bT(e,r);if(e.charCodeAt(0)===36)return"$"+_s(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+kc(l,e.length);if(e.match(/^[#?]+$/))return i=kc(r,0),i==="0"&&(i=""),i.length>e.length?i:Si(e.substr(0,e.length-i.length))+i;if(s=e.match(IT))return WN(s,l,u);if(e.match(/^#+0+$/))return u+kc(l,e.length-e.indexOf("0"));if(s=e.match(NT))return i=z_(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Si(s[1])).replace(/\.$/,"."+Si(s[1])).replace(/\.(\d*)$/,function(y,x){return"."+x+Ur("0",Si(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+z_(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Oo(kc(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+_s(t,e,-r):Oo(""+(Math.floor(r)+$N(r,s[1].length)))+"."+Xs(W_(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return _s(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=eu(_s(t,e.replace(/[\\-]/g,""),r)),a=0,eu(eu(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match(DT))return i=_s(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Gh(l,Math.pow(10,a)-1,!1),i=""+u,f=Ga("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=Hh(o[2],a),f.length<s[4].length&&(f=Si(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Gh(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?O1(o[1],a)+s[2]+"/"+s[3]+Hh(o[2],a):Ur(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=kc(r,0),e.length<=i.length?i:Si(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var p=e.indexOf(".")-a,g=e.length-i.length-p;return Si(e.substr(0,p)+i+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=W_(r,s[1].length),r<0?"-"+_s(t,e,-r):Oo(GN(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Xs(0,3-y.length):"")+y})+"."+Xs(a,s[1].length);switch(e){case"###,##0.00":return _s(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Oo(kc(l,0));return m!=="0"?u+m:"";case"###,###.00":return _s(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return _s(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function KN(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ga(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function YN(t,e,r){var n=e.replace(FT,""),i=e.length-n.length;return Ga(t,n,r*Math.pow(10,2*i))+Ur("%",i)}function PT(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+PT(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function da(t,e,r){if(t.charCodeAt(0)===40&&!e.match(RT)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?da("n",n,r):"("+da("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return KN(t,e,r);if(e.indexOf("%")!==-1)return YN(t,e,r);if(e.indexOf("E")!==-1)return PT(e,r);if(e.charCodeAt(0)===36)return"$"+da(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Xs(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:Si(e.substr(0,e.length-i.length))+i;if(s=e.match(IT))return HN(s,l,u);if(e.match(/^#+0+$/))return u+Xs(l,e.length-e.indexOf("0"));if(s=e.match(NT))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Si(s[1])).replace(/\.$/,"."+Si(s[1])),i=i.replace(/\.(\d*)$/,function(y,x){return"."+x+Ur("0",Si(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Oo(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+da(t,e,-r):Oo(""+r)+"."+Ur("0",s[1].length);if(s=e.match(/^#,#*,#0/))return da(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=eu(da(t,e.replace(/[\\-]/g,""),r)),a=0,eu(eu(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match(DT))return i=da(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Gh(l,Math.pow(10,a)-1,!1),i=""+u,f=Ga("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=Hh(o[2],a),f.length<s[4].length&&(f=Si(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Gh(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?O1(o[1],a)+s[2]+"/"+s[3]+Hh(o[2],a):Ur(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:Si(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var p=e.indexOf(".")-a,g=e.length-i.length-p;return Si(e.substr(0,p)+i+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+da(t,e,-r):Oo(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Xs(0,3-y.length):"")+y})+"."+Xs(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var m=Oo(""+l);return m!=="0"?u+m:"";default:if(e.match(/\.[0#?]*$/))return da(t,e.slice(0,e.lastIndexOf(".")),r)+Si(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Ga(t,e,r){return(r|0)===r?da(t,e,r):_s(t,e,r)}function XN(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var OT=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Iu(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":$h(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(OT))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function qN(t,e,r,n){for(var i=[],s="",a=0,o="",l="t",u,f,p,g="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!$h(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(p=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(p);i[i.length]={t:"t",v:s},++a;break;case"\\":var m=t.charAt(++a),y=m==="("||m===")"?m:"t";i[i.length]={t:y,v:m},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(u==null&&(u=Nl(e,r,t.charAt(a+1)==="2"),u==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=Nl(e,r),u==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=g),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var x={t:o,v:o};if(u==null&&(u=Nl(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",g="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",a+=5,g="h"):t.substr(a,5).toUpperCase()==="/"?(u!=null&&(x.v=u.H>=12?"":""),x.t="T",a+=5,g="h"):(x.t="t",++a),u==null&&x.t==="T")return"";i[i.length]=x,l=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(OT)){if(u==null&&(u=Nl(e,r),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Iu(t)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var w=0,A=0,k;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=g,l="h",w<1&&(w=1);break;case"s":(k=i[a].v.match(/\.0+$/))&&(A=Math.max(A,k[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&i[a].v.match(/[Hh]/)&&(w=1),w<2&&i[a].v.match(/[Mm]/)&&(w=2),w<3&&i[a].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var E="",P;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=UN(i[a].t.charCodeAt(0),i[a].v,u,A),i[a].t="t";break;case"n":case"?":for(P=a+1;i[P]!=null&&((o=i[P].t)==="?"||o==="D"||(o===" "||o==="t")&&i[P+1]!=null&&(i[P+1].t==="?"||i[P+1].t==="t"&&i[P+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[P].v==="/"||i[P].v===" "&&i[P+1]!=null&&i[P+1].t=="?"));)i[a].v+=i[P].v,i[P]={v:"",t:";"},++P;E+=i[a].v,a=P-1;break;case"G":i[a].t="t",i[a].v=Gl(e,r);break}var Y="",V,T;if(E.length>0){E.charCodeAt(0)==40?(V=e<0&&E.charCodeAt(0)===45?-e:e,T=Ga("n",E,V)):(V=e<0&&n>1?-e:e,T=Ga("n",E,V),V<0&&i[0]&&i[0].t=="t"&&(T=T.substr(1),i[0].v="-"+i[0].v)),P=T.length-1;var F=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){F=a;break}var S=i.length;if(F===i.length&&T.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(P>=i[a].v.length-1?(P-=i[a].v.length,i[a].v=T.substr(P+1,i[a].v.length)):P<0?i[a].v="":(i[a].v=T.substr(0,P+1),P=-1),i[a].t="t",S=a);P>=0&&S<i.length&&(i[S].v=T.substr(0,P+1)+i[S].v)}else if(F!==i.length&&T.indexOf("E")===-1){for(P=T.indexOf(".")-1,a=F;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(f=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")-1:i[a].v.length-1,Y=i[a].v.substr(f+1);f>=0;--f)P>=0&&(i[a].v.charAt(f)==="0"||i[a].v.charAt(f)==="#")&&(Y=T.charAt(P--)+Y);i[a].v=Y,i[a].t="t",S=a}for(P>=0&&S<i.length&&(i[S].v=T.substr(0,P+1)+i[S].v),P=T.indexOf(".")+1,a=F;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==F)){for(f=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")+1:0,Y=i[a].v.substr(0,f);f<i[a].v.length;++f)P<T.length&&(Y+=T.charAt(P++));i[a].v=Y,i[a].t="t",S=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(V=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Ga(i[a].t,i[a].v,V),i[a].t="t");var I="";for(a=0;a!==i.length;++a)i[a]!=null&&(I+=i[a].v);return I}var H_=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function $_(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function QN(t,e){var r=XN(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(H_),o=r[1].match(H_);return $_(e,a)?[n,r[0]]:$_(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function Ds(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:lt)[t],n==null&&(n=r.table&&r.table[V_[t]]||lt[V_[t]]),n==null&&(n=DN[t]||"General");break}if($h(n,0))return Gl(e,r);e instanceof Date&&(e=CT(e,r.date1904));var i=QN(n,e);if($h(i[1]))return Gl(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return qN(i[1],e,r,i[0])}function Ka(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(lt[r]==null){e<0&&(e=r);continue}if(lt[r]==t){e=r;break}}e<0&&(e=391)}return lt[e]=t,e}function Mp(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Ka(t[e],e)}function Nu(){lt=RN()}var JN={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},MT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function ZN(t){var e=typeof t=="number"?lt[t]:t;return e=e.replace(MT,"(\\d+)"),new RegExp("^"+e+"$")}function eR(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(MT)||[]).forEach(function(p,g){var m=parseInt(r[g+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=m;break;case"d":s=m;break;case"h":a=m;break;case"s":l=m;break;case"m":a>=0?o=m:i=m;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?u:n==-1&&i==-1&&s==-1?f:u+"T"+f}var tR=function(){var t={};t.version="1.2.0";function e(){for(var T=0,F=new Array(256),S=0;S!=256;++S)T=S,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,F[S]=T;return typeof Int32Array<"u"?new Int32Array(F):F}var r=e();function n(T){var F=0,S=0,I=0,R=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)R[I]=T[I];for(I=0;I!=256;++I)for(S=T[I],F=256+I;F<4096;F+=256)S=R[F]=S>>>8^T[S&255];var D=[];for(I=1;I!=16;++I)D[I-1]=typeof Int32Array<"u"?R.subarray(I*256,I*256+256):R.slice(I*256,I*256+256);return D}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],u=i[4],f=i[5],p=i[6],g=i[7],m=i[8],y=i[9],x=i[10],w=i[11],A=i[12],k=i[13],E=i[14];function P(T,F){for(var S=F^-1,I=0,R=T.length;I<R;)S=S>>>8^r[(S^T.charCodeAt(I++))&255];return~S}function Y(T,F){for(var S=F^-1,I=T.length-15,R=0;R<I;)S=E[T[R++]^S&255]^k[T[R++]^S>>8&255]^A[T[R++]^S>>16&255]^w[T[R++]^S>>>24]^x[T[R++]]^y[T[R++]]^m[T[R++]]^g[T[R++]]^p[T[R++]]^f[T[R++]]^u[T[R++]]^l[T[R++]]^o[T[R++]]^a[T[R++]]^s[T[R++]]^r[T[R++]];for(I+=15;R<I;)S=S>>>8^r[(S^T[R++])&255];return~S}function V(T,F){for(var S=F^-1,I=0,R=T.length,D=0,N=0;I<R;)D=T.charCodeAt(I++),D<128?S=S>>>8^r[(S^D)&255]:D<2048?(S=S>>>8^r[(S^(192|D>>6&31))&255],S=S>>>8^r[(S^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,N=T.charCodeAt(I++)&1023,S=S>>>8^r[(S^(240|D>>8&7))&255],S=S>>>8^r[(S^(128|D>>2&63))&255],S=S>>>8^r[(S^(128|N>>6&15|(D&3)<<4))&255],S=S>>>8^r[(S^(128|N&63))&255]):(S=S>>>8^r[(S^(224|D>>12&15))&255],S=S>>>8^r[(S^(128|D>>6&63))&255],S=S>>>8^r[(S^(128|D&63))&255]);return~S}return t.table=r,t.bstr=P,t.buf=Y,t.str=V,t}(),tt=function(){var e={};e.version="1.2.1";function r(b,G){for(var L=b.split("/"),U=G.split("/"),X=0,Q=0,ue=Math.min(L.length,U.length);X<ue;++X){if(Q=L[X].length-U[X].length)return Q;if(L[X]!=U[X])return L[X]<U[X]?-1:1}return L.length-U.length}function n(b){if(b.charAt(b.length-1)=="/")return b.slice(0,-1).indexOf("/")===-1?b:n(b.slice(0,-1));var G=b.lastIndexOf("/");return G===-1?b:b.slice(0,G+1)}function i(b){if(b.charAt(b.length-1)=="/")return i(b.slice(0,-1));var G=b.lastIndexOf("/");return G===-1?b:b.slice(G+1)}function s(b,G){typeof G=="string"&&(G=new Date(G));var L=G.getHours();L=L<<6|G.getMinutes(),L=L<<5|G.getSeconds()>>>1,b.write_shift(2,L);var U=G.getFullYear()-1980;U=U<<4|G.getMonth()+1,U=U<<5|G.getDate(),b.write_shift(2,U)}function a(b){var G=b.read_shift(2)&65535,L=b.read_shift(2)&65535,U=new Date,X=L&31;L>>>=5;var Q=L&15;L>>>=4,U.setMilliseconds(0),U.setFullYear(L+1980),U.setMonth(Q-1),U.setDate(X);var ue=G&31;G>>>=5;var pe=G&63;return G>>>=6,U.setHours(G),U.setMinutes(pe),U.setSeconds(ue<<1),U}function o(b){$n(b,0);for(var G={},L=0;b.l<=b.length-4;){var U=b.read_shift(2),X=b.read_shift(2),Q=b.l+X,ue={};switch(U){case 21589:L=b.read_shift(1),L&1&&(ue.mtime=b.read_shift(4)),X>5&&(L&2&&(ue.atime=b.read_shift(4)),L&4&&(ue.ctime=b.read_shift(4))),ue.mtime&&(ue.mt=new Date(ue.mtime*1e3));break}b.l=Q,G[U]=ue}return G}var l;function u(){return l||(l={})}function f(b,G){if(b[0]==80&&b[1]==75)return Ms(b,G);if((b[0]|32)==109&&(b[1]|32)==105)return an(b,G);if(b.length<512)throw new Error("CFB file size "+b.length+" < 512");var L=3,U=512,X=0,Q=0,ue=0,pe=0,fe=0,se=[],he=b.slice(0,512);$n(he,0);var Se=p(he);switch(L=Se[0],L){case 3:U=512;break;case 4:U=4096;break;case 0:if(Se[1]==0)return Ms(b,G);default:throw new Error("Major Version: Expected 3 or 4 saw "+L)}U!==512&&(he=b.slice(0,U),$n(he,28));var Ue=b.slice(0,U);g(he,L);var Ke=he.read_shift(4,"i");if(L===3&&Ke!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ke);he.l+=4,ue=he.read_shift(4,"i"),he.l+=4,he.chk("00100000","Mini Stream Cutoff Size: "),pe=he.read_shift(4,"i"),X=he.read_shift(4,"i"),fe=he.read_shift(4,"i"),Q=he.read_shift(4,"i");for(var Re=-1,Ye=0;Ye<109&&(Re=he.read_shift(4,"i"),!(Re<0));++Ye)se[Ye]=Re;var ct=m(b,U);w(fe,Q,ct,U,se);var Lt=k(ct,ue,se,U);Lt[ue].name="!Directory",X>0&&pe!==N&&(Lt[pe].name="!MiniFAT"),Lt[se[0]].name="!FAT",Lt.fat_addrs=se,Lt.ssz=U;var Bt={},hr=[],Pi=[],lr=[];E(ue,Lt,ct,hr,X,Bt,Pi,pe),y(Pi,lr,hr),hr.shift();var us={FileIndex:Pi,FullPaths:lr};return G&&G.raw&&(us.raw={header:Ue,sectors:ct}),us}function p(b){if(b[b.l]==80&&b[b.l+1]==75)return[0,0];b.chk($e,"Header Signature: "),b.l+=16;var G=b.read_shift(2,"u");return[b.read_shift(2,"u"),G]}function g(b,G){var L=9;switch(b.l+=2,L=b.read_shift(2)){case 9:if(G!=3)throw new Error("Sector Shift: Expected 9 saw "+L);break;case 12:if(G!=4)throw new Error("Sector Shift: Expected 12 saw "+L);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+L)}b.chk("0600","Mini Sector Shift: "),b.chk("000000000000","Reserved: ")}function m(b,G){for(var L=Math.ceil(b.length/G)-1,U=[],X=1;X<L;++X)U[X-1]=b.slice(X*G,(X+1)*G);return U[L-1]=b.slice(L*G),U}function y(b,G,L){for(var U=0,X=0,Q=0,ue=0,pe=0,fe=L.length,se=[],he=[];U<fe;++U)se[U]=he[U]=U,G[U]=L[U];for(;pe<he.length;++pe)U=he[pe],X=b[U].L,Q=b[U].R,ue=b[U].C,se[U]===U&&(X!==-1&&se[X]!==X&&(se[U]=se[X]),Q!==-1&&se[Q]!==Q&&(se[U]=se[Q])),ue!==-1&&(se[ue]=U),X!==-1&&U!=se[U]&&(se[X]=se[U],he.lastIndexOf(X)<pe&&he.push(X)),Q!==-1&&U!=se[U]&&(se[Q]=se[U],he.lastIndexOf(Q)<pe&&he.push(Q));for(U=1;U<fe;++U)se[U]===U&&(Q!==-1&&se[Q]!==Q?se[U]=se[Q]:X!==-1&&se[X]!==X&&(se[U]=se[X]));for(U=1;U<fe;++U)if(b[U].type!==0){if(pe=U,pe!=se[pe])do pe=se[pe],G[U]=G[pe]+"/"+G[U];while(pe!==0&&se[pe]!==-1&&pe!=se[pe]);se[U]=-1}for(G[0]+="/",U=1;U<fe;++U)b[U].type!==2&&(G[U]+="/")}function x(b,G,L){for(var U=b.start,X=b.size,Q=[],ue=U;L&&X>0&&ue>=0;)Q.push(G.slice(ue*D,ue*D+D)),X-=D,ue=kl(L,ue*4);return Q.length===0?ye(0):Pn(Q).slice(0,b.size)}function w(b,G,L,U,X){var Q=N;if(b===N){if(G!==0)throw new Error("DIFAT chain shorter than expected")}else if(b!==-1){var ue=L[b],pe=(U>>>2)-1;if(!ue)return;for(var fe=0;fe<pe&&(Q=kl(ue,fe*4))!==N;++fe)X.push(Q);w(kl(ue,U-4),G-1,L,U,X)}}function A(b,G,L,U,X){var Q=[],ue=[];X||(X=[]);var pe=U-1,fe=0,se=0;for(fe=G;fe>=0;){X[fe]=!0,Q[Q.length]=fe,ue.push(b[fe]);var he=L[Math.floor(fe*4/U)];if(se=fe*4&pe,U<4+se)throw new Error("FAT boundary crossed: "+fe+" 4 "+U);if(!b[he])break;fe=kl(b[he],se)}return{nodes:Q,data:n2([ue])}}function k(b,G,L,U){var X=b.length,Q=[],ue=[],pe=[],fe=[],se=U-1,he=0,Se=0,Ue=0,Ke=0;for(he=0;he<X;++he)if(pe=[],Ue=he+G,Ue>=X&&(Ue-=X),!ue[Ue]){fe=[];var Re=[];for(Se=Ue;Se>=0;){Re[Se]=!0,ue[Se]=!0,pe[pe.length]=Se,fe.push(b[Se]);var Ye=L[Math.floor(Se*4/U)];if(Ke=Se*4&se,U<4+Ke)throw new Error("FAT boundary crossed: "+Se+" 4 "+U);if(!b[Ye]||(Se=kl(b[Ye],Ke),Re[Se]))break}Q[Ue]={nodes:pe,data:n2([fe])}}return Q}function E(b,G,L,U,X,Q,ue,pe){for(var fe=0,se=U.length?2:0,he=G[b].data,Se=0,Ue=0,Ke;Se<he.length;Se+=128){var Re=he.slice(Se,Se+128);$n(Re,64),Ue=Re.read_shift(2),Ke=W1(Re,0,Ue-se),U.push(Ke);var Ye={name:Ke,type:Re.read_shift(1),color:Re.read_shift(1),L:Re.read_shift(4,"i"),R:Re.read_shift(4,"i"),C:Re.read_shift(4,"i"),clsid:Re.read_shift(16),state:Re.read_shift(4,"i"),start:0,size:0},ct=Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2);ct!==0&&(Ye.ct=P(Re,Re.l-8));var Lt=Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2);Lt!==0&&(Ye.mt=P(Re,Re.l-8)),Ye.start=Re.read_shift(4,"i"),Ye.size=Re.read_shift(4,"i"),Ye.size<0&&Ye.start<0&&(Ye.size=Ye.type=0,Ye.start=N,Ye.name=""),Ye.type===5?(fe=Ye.start,X>0&&fe!==N&&(G[fe].name="!StreamData")):Ye.size>=4096?(Ye.storage="fat",G[Ye.start]===void 0&&(G[Ye.start]=A(L,Ye.start,G.fat_addrs,G.ssz)),G[Ye.start].name=Ye.name,Ye.content=G[Ye.start].data.slice(0,Ye.size)):(Ye.storage="minifat",Ye.size<0?Ye.size=0:fe!==N&&Ye.start!==N&&G[fe]&&(Ye.content=x(Ye,G[fe].data,(G[pe]||{}).data))),Ye.content&&$n(Ye.content,0),Q[Ke]=Ye,ue.push(Ye)}}function P(b,G){return new Date((Ji(b,G+4)/1e7*Math.pow(2,32)+Ji(b,G)/1e7-11644473600)*1e3)}function Y(b,G){return u(),f(l.readFileSync(b),G)}function V(b,G){var L=G&&G.type;switch(L||Ft&&Buffer.isBuffer(b)&&(L="buffer"),L||"base64"){case"file":return Y(b,G);case"base64":return f(Zi(ss(b)),G);case"binary":return f(Zi(b),G)}return f(b,G)}function T(b,G){var L=G||{},U=L.root||"Root Entry";if(b.FullPaths||(b.FullPaths=[]),b.FileIndex||(b.FileIndex=[]),b.FullPaths.length!==b.FileIndex.length)throw new Error("inconsistent CFB structure");b.FullPaths.length===0&&(b.FullPaths[0]=U+"/",b.FileIndex[0]={name:U,type:5}),L.CLSID&&(b.FileIndex[0].clsid=L.CLSID),F(b)}function F(b){var G="Sh33tJ5";if(!tt.find(b,"/"+G)){var L=ye(4);L[0]=55,L[1]=L[3]=50,L[2]=54,b.FileIndex.push({name:G,type:2,content:L,size:4,L:69,R:69,C:69}),b.FullPaths.push(b.FullPaths[0]+G),S(b)}}function S(b,G){T(b);for(var L=!1,U=!1,X=b.FullPaths.length-1;X>=0;--X){var Q=b.FileIndex[X];switch(Q.type){case 0:U?L=!0:(b.FileIndex.pop(),b.FullPaths.pop());break;case 1:case 2:case 5:U=!0,isNaN(Q.R*Q.L*Q.C)&&(L=!0),Q.R>-1&&Q.L>-1&&Q.R==Q.L&&(L=!0);break;default:L=!0;break}}if(!(!L&&!G)){var ue=new Date(1987,1,19),pe=0,fe=Object.create?Object.create(null):{},se=[];for(X=0;X<b.FullPaths.length;++X)fe[b.FullPaths[X]]=!0,b.FileIndex[X].type!==0&&se.push([b.FullPaths[X],b.FileIndex[X]]);for(X=0;X<se.length;++X){var he=n(se[X][0]);U=fe[he],U||(se.push([he,{name:i(he).replace("/",""),type:1,clsid:Pe,ct:ue,mt:ue,content:null}]),fe[he]=!0)}for(se.sort(function(Ke,Re){return r(Ke[0],Re[0])}),b.FullPaths=[],b.FileIndex=[],X=0;X<se.length;++X)b.FullPaths[X]=se[X][0],b.FileIndex[X]=se[X][1];for(X=0;X<se.length;++X){var Se=b.FileIndex[X],Ue=b.FullPaths[X];if(Se.name=i(Ue).replace("/",""),Se.L=Se.R=Se.C=-(Se.color=1),Se.size=Se.content?Se.content.length:0,Se.start=0,Se.clsid=Se.clsid||Pe,X===0)Se.C=se.length>1?1:-1,Se.size=0,Se.type=5;else if(Ue.slice(-1)=="/"){for(pe=X+1;pe<se.length&&n(b.FullPaths[pe])!=Ue;++pe);for(Se.C=pe>=se.length?-1:pe,pe=X+1;pe<se.length&&n(b.FullPaths[pe])!=n(Ue);++pe);Se.R=pe>=se.length?-1:pe,Se.type=1}else n(b.FullPaths[X+1]||"")==n(Ue)&&(Se.R=X+1),Se.type=2}}}function I(b,G){var L=G||{};if(L.fileType=="mad")return qr(b,L);switch(S(b),L.fileType){case"zip":return Br(b,L)}var U=function(Ke){for(var Re=0,Ye=0,ct=0;ct<Ke.FileIndex.length;++ct){var Lt=Ke.FileIndex[ct];if(Lt.content){var Bt=Lt.content.length;Bt>0&&(Bt<4096?Re+=Bt+63>>6:Ye+=Bt+511>>9)}}for(var hr=Ke.FullPaths.length+3>>2,Pi=Re+7>>3,lr=Re+127>>7,us=Pi+Ye+hr+lr,Ir=us+127>>7,ds=Ir<=109?0:Math.ceil((Ir-109)/127);us+Ir+ds+127>>7>Ir;)ds=++Ir<=109?0:Math.ceil((Ir-109)/127);var st=[1,ds,Ir,lr,hr,Ye,Re,0];return Ke.FileIndex[0].size=Re<<6,st[7]=(Ke.FileIndex[0].start=st[0]+st[1]+st[2]+st[3]+st[4]+st[5])+(st[6]+7>>3),st}(b),X=ye(U[7]<<9),Q=0,ue=0;{for(Q=0;Q<8;++Q)X.write_shift(1,_e[Q]);for(Q=0;Q<8;++Q)X.write_shift(2,0);for(X.write_shift(2,62),X.write_shift(2,3),X.write_shift(2,65534),X.write_shift(2,9),X.write_shift(2,6),Q=0;Q<3;++Q)X.write_shift(2,0);for(X.write_shift(4,0),X.write_shift(4,U[2]),X.write_shift(4,U[0]+U[1]+U[2]+U[3]-1),X.write_shift(4,0),X.write_shift(4,4096),X.write_shift(4,U[3]?U[0]+U[1]+U[2]-1:N),X.write_shift(4,U[3]),X.write_shift(-4,U[1]?U[0]-1:N),X.write_shift(4,U[1]),Q=0;Q<109;++Q)X.write_shift(-4,Q<U[2]?U[1]+Q:-1)}if(U[1])for(ue=0;ue<U[1];++ue){for(;Q<236+ue*127;++Q)X.write_shift(-4,Q<U[2]?U[1]+Q:-1);X.write_shift(-4,ue===U[1]-1?N:ue+1)}var pe=function(Ke){for(ue+=Ke;Q<ue-1;++Q)X.write_shift(-4,Q+1);Ke&&(++Q,X.write_shift(-4,N))};for(ue=Q=0,ue+=U[1];Q<ue;++Q)X.write_shift(-4,be.DIFSECT);for(ue+=U[2];Q<ue;++Q)X.write_shift(-4,be.FATSECT);pe(U[3]),pe(U[4]);for(var fe=0,se=0,he=b.FileIndex[0];fe<b.FileIndex.length;++fe)he=b.FileIndex[fe],he.content&&(se=he.content.length,!(se<4096)&&(he.start=ue,pe(se+511>>9)));for(pe(U[6]+7>>3);X.l&511;)X.write_shift(-4,be.ENDOFCHAIN);for(ue=Q=0,fe=0;fe<b.FileIndex.length;++fe)he=b.FileIndex[fe],he.content&&(se=he.content.length,!(!se||se>=4096)&&(he.start=ue,pe(se+63>>6)));for(;X.l&511;)X.write_shift(-4,be.ENDOFCHAIN);for(Q=0;Q<U[4]<<2;++Q){var Se=b.FullPaths[Q];if(!Se||Se.length===0){for(fe=0;fe<17;++fe)X.write_shift(4,0);for(fe=0;fe<3;++fe)X.write_shift(4,-1);for(fe=0;fe<12;++fe)X.write_shift(4,0);continue}he=b.FileIndex[Q],Q===0&&(he.start=he.size?he.start-1:N);var Ue=Q===0&&L.root||he.name;if(se=2*(Ue.length+1),X.write_shift(64,Ue,"utf16le"),X.write_shift(2,se),X.write_shift(1,he.type),X.write_shift(1,he.color),X.write_shift(-4,he.L),X.write_shift(-4,he.R),X.write_shift(-4,he.C),he.clsid)X.write_shift(16,he.clsid,"hex");else for(fe=0;fe<4;++fe)X.write_shift(4,0);X.write_shift(4,he.state||0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,he.start),X.write_shift(4,he.size),X.write_shift(4,0)}for(Q=1;Q<b.FileIndex.length;++Q)if(he=b.FileIndex[Q],he.size>=4096)if(X.l=he.start+1<<9,Ft&&Buffer.isBuffer(he.content))he.content.copy(X,X.l,0,he.size),X.l+=he.size+511&-512;else{for(fe=0;fe<he.size;++fe)X.write_shift(1,he.content[fe]);for(;fe&511;++fe)X.write_shift(1,0)}for(Q=1;Q<b.FileIndex.length;++Q)if(he=b.FileIndex[Q],he.size>0&&he.size<4096)if(Ft&&Buffer.isBuffer(he.content))he.content.copy(X,X.l,0,he.size),X.l+=he.size+63&-64;else{for(fe=0;fe<he.size;++fe)X.write_shift(1,he.content[fe]);for(;fe&63;++fe)X.write_shift(1,0)}if(Ft)X.l=X.length;else for(;X.l<X.length;)X.write_shift(1,0);return X}function R(b,G){var L=b.FullPaths.map(function(fe){return fe.toUpperCase()}),U=L.map(function(fe){var se=fe.split("/");return se[se.length-(fe.slice(-1)=="/"?2:1)]}),X=!1;G.charCodeAt(0)===47?(X=!0,G=L[0].slice(0,-1)+G):X=G.indexOf("/")!==-1;var Q=G.toUpperCase(),ue=X===!0?L.indexOf(Q):U.indexOf(Q);if(ue!==-1)return b.FileIndex[ue];var pe=!Q.match(fd);for(Q=Q.replace(ki,""),pe&&(Q=Q.replace(fd,"!")),ue=0;ue<L.length;++ue)if((pe?L[ue].replace(fd,"!"):L[ue]).replace(ki,"")==Q||(pe?U[ue].replace(fd,"!"):U[ue]).replace(ki,"")==Q)return b.FileIndex[ue];return null}var D=64,N=-2,$e="d0cf11e0a1b11ae1",_e=[208,207,17,224,161,177,26,225],Pe="00000000000000000000000000000000",be={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:N,FREESECT:-1,HEADER_SIGNATURE:$e,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Pe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Te(b,G,L){u();var U=I(b,L);l.writeFileSync(G,U)}function ie(b){for(var G=new Array(b.length),L=0;L<b.length;++L)G[L]=String.fromCharCode(b[L]);return G.join("")}function Ce(b,G){var L=I(b,G);switch(G&&G.type||"buffer"){case"file":return u(),l.writeFileSync(G.filename,L),L;case"binary":return typeof L=="string"?L:ie(L);case"base64":return sf(typeof L=="string"?L:ie(L));case"buffer":if(Ft)return Buffer.isBuffer(L)?L:oo(L);case"array":return typeof L=="string"?Zi(L):L}return L}var Be;function W(b){try{var G=b.InflateRaw,L=new G;if(L._processChunk(new Uint8Array([3,0]),L._finishFlushFlag),L.bytesRead)Be=b;else throw new Error("zlib does not expose bytesRead")}catch(U){console.error("cannot use native zlib: "+(U.message||U))}}function ne(b,G){if(!Be)return Os(b,G);var L=Be.InflateRaw,U=new L,X=U._processChunk(b.slice(b.l),U._finishFlushFlag);return b.l+=U.bytesRead,X}function re(b){return Be?Be.deflateRawSync(b):ft(b)}var q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],xe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],we=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function je(b){var G=(b<<1|b<<11)&139536|(b<<5|b<<15)&558144;return(G>>16|G>>8|G)&255}for(var Ie=typeof Uint8Array<"u",Ae=Ie?new Uint8Array(256):[],nt=0;nt<256;++nt)Ae[nt]=je(nt);function J(b,G){var L=Ae[b&255];return G<=8?L>>>8-G:(L=L<<8|Ae[b>>8&255],G<=16?L>>>16-G:(L=L<<8|Ae[b>>16&255],L>>>24-G))}function Mt(b,G){var L=G&7,U=G>>>3;return(b[U]|(L<=6?0:b[U+1]<<8))>>>L&3}function Et(b,G){var L=G&7,U=G>>>3;return(b[U]|(L<=5?0:b[U+1]<<8))>>>L&7}function Rt(b,G){var L=G&7,U=G>>>3;return(b[U]|(L<=4?0:b[U+1]<<8))>>>L&15}function mt(b,G){var L=G&7,U=G>>>3;return(b[U]|(L<=3?0:b[U+1]<<8))>>>L&31}function Ge(b,G){var L=G&7,U=G>>>3;return(b[U]|(L<=1?0:b[U+1]<<8))>>>L&127}function or(b,G,L){var U=G&7,X=G>>>3,Q=(1<<L)-1,ue=b[X]>>>U;return L<8-U||(ue|=b[X+1]<<8-U,L<16-U)||(ue|=b[X+2]<<16-U,L<24-U)||(ue|=b[X+3]<<24-U),ue&Q}function Ln(b,G,L){var U=G&7,X=G>>>3;return U<=5?b[X]|=(L&7)<<U:(b[X]|=L<<U&255,b[X+1]=(L&7)>>8-U),G+3}function sn(b,G,L){var U=G&7,X=G>>>3;return L=(L&1)<<U,b[X]|=L,G+1}function bi(b,G,L){var U=G&7,X=G>>>3;return L<<=U,b[X]|=L&255,L>>>=8,b[X+1]=L,G+8}function ls(b,G,L){var U=G&7,X=G>>>3;return L<<=U,b[X]|=L&255,L>>>=8,b[X+1]=L&255,b[X+2]=L>>>8,G+16}function Ii(b,G){var L=b.length,U=2*L>G?2*L:G+5,X=0;if(L>=G)return b;if(Ft){var Q=B_(U);if(b.copy)b.copy(Q);else for(;X<b.length;++X)Q[X]=b[X];return Q}else if(Ie){var ue=new Uint8Array(U);if(ue.set)ue.set(b);else for(;X<L;++X)ue[X]=b[X];return ue}return b.length=U,b}function Hr(b){for(var G=new Array(b),L=0;L<b;++L)G[L]=0;return G}function Ni(b,G,L){var U=1,X=0,Q=0,ue=0,pe=0,fe=b.length,se=Ie?new Uint16Array(32):Hr(32);for(Q=0;Q<32;++Q)se[Q]=0;for(Q=fe;Q<L;++Q)b[Q]=0;fe=b.length;var he=Ie?new Uint16Array(fe):Hr(fe);for(Q=0;Q<fe;++Q)se[X=b[Q]]++,U<X&&(U=X),he[Q]=0;for(se[0]=0,Q=1;Q<=U;++Q)se[Q+16]=pe=pe+se[Q-1]<<1;for(Q=0;Q<fe;++Q)pe=b[Q],pe!=0&&(he[Q]=se[pe+16]++);var Se=0;for(Q=0;Q<fe;++Q)if(Se=b[Q],Se!=0)for(pe=J(he[Q],U)>>U-Se,ue=(1<<U+4-Se)-1;ue>=0;--ue)G[pe|ue<<Se]=Se&15|Q<<4;return U}var er=Ie?new Uint16Array(512):Hr(512),br=Ie?new Uint16Array(32):Hr(32);if(!Ie){for(var gr=0;gr<512;++gr)er[gr]=0;for(gr=0;gr<32;++gr)br[gr]=0}(function(){for(var b=[],G=0;G<32;G++)b.push(5);Ni(b,br,32);var L=[];for(G=0;G<=143;G++)L.push(8);for(;G<=255;G++)L.push(9);for(;G<=279;G++)L.push(7);for(;G<=287;G++)L.push(8);Ni(L,er,288)})();var mi=function(){for(var G=Ie?new Uint8Array(32768):[],L=0,U=0;L<we.length-1;++L)for(;U<we[L+1];++U)G[U]=L;for(;U<32768;++U)G[U]=29;var X=Ie?new Uint8Array(259):[];for(L=0,U=0;L<xe.length-1;++L)for(;U<xe[L+1];++U)X[U]=L;function Q(pe,fe){for(var se=0;se<pe.length;){var he=Math.min(65535,pe.length-se),Se=se+he==pe.length;for(fe.write_shift(1,+Se),fe.write_shift(2,he),fe.write_shift(2,~he&65535);he-- >0;)fe[fe.l++]=pe[se++]}return fe.l}function ue(pe,fe){for(var se=0,he=0,Se=Ie?new Uint16Array(32768):[];he<pe.length;){var Ue=Math.min(65535,pe.length-he);if(Ue<10){for(se=Ln(fe,se,+(he+Ue==pe.length)),se&7&&(se+=8-(se&7)),fe.l=se/8|0,fe.write_shift(2,Ue),fe.write_shift(2,~Ue&65535);Ue-- >0;)fe[fe.l++]=pe[he++];se=fe.l*8;continue}se=Ln(fe,se,+(he+Ue==pe.length)+2);for(var Ke=0;Ue-- >0;){var Re=pe[he];Ke=(Ke<<5^Re)&32767;var Ye=-1,ct=0;if((Ye=Se[Ke])&&(Ye|=he&-32768,Ye>he&&(Ye-=32768),Ye<he))for(;pe[Ye+ct]==pe[he+ct]&&ct<250;)++ct;if(ct>2){Re=X[ct],Re<=22?se=bi(fe,se,Ae[Re+1]>>1)-1:(bi(fe,se,3),se+=5,bi(fe,se,Ae[Re-23]>>5),se+=3);var Lt=Re<8?0:Re-4>>2;Lt>0&&(ls(fe,se,ct-xe[Re]),se+=Lt),Re=G[he-Ye],se=bi(fe,se,Ae[Re]>>3),se-=3;var Bt=Re<4?0:Re-2>>1;Bt>0&&(ls(fe,se,he-Ye-we[Re]),se+=Bt);for(var hr=0;hr<ct;++hr)Se[Ke]=he&32767,Ke=(Ke<<5^pe[he])&32767,++he;Ue-=ct-1}else Re<=143?Re=Re+48:se=sn(fe,se,1),se=bi(fe,se,Ae[Re]),Se[Ke]=he&32767,++he}se=bi(fe,se,0)-1}return fe.l=(se+7)/8|0,fe.l}return function(fe,se){return fe.length<8?Q(fe,se):ue(fe,se)}}();function ft(b){var G=ye(50+Math.floor(b.length*1.1)),L=mi(b,G);return G.slice(0,L)}var mr=Ie?new Uint16Array(32768):Hr(32768),xr=Ie?new Uint16Array(32768):Hr(32768),Sr=Ie?new Uint16Array(128):Hr(128),xi=1,fo=1;function ho(b,G){var L=mt(b,G)+257;G+=5;var U=mt(b,G)+1;G+=5;var X=Rt(b,G)+4;G+=4;for(var Q=0,ue=Ie?new Uint8Array(19):Hr(19),pe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],fe=1,se=Ie?new Uint8Array(8):Hr(8),he=Ie?new Uint8Array(8):Hr(8),Se=ue.length,Ue=0;Ue<X;++Ue)ue[q[Ue]]=Q=Et(b,G),fe<Q&&(fe=Q),se[Q]++,G+=3;var Ke=0;for(se[0]=0,Ue=1;Ue<=fe;++Ue)he[Ue]=Ke=Ke+se[Ue-1]<<1;for(Ue=0;Ue<Se;++Ue)(Ke=ue[Ue])!=0&&(pe[Ue]=he[Ke]++);var Re=0;for(Ue=0;Ue<Se;++Ue)if(Re=ue[Ue],Re!=0){Ke=Ae[pe[Ue]]>>8-Re;for(var Ye=(1<<7-Re)-1;Ye>=0;--Ye)Sr[Ke|Ye<<Re]=Re&7|Ue<<3}var ct=[];for(fe=1;ct.length<L+U;)switch(Ke=Sr[Ge(b,G)],G+=Ke&7,Ke>>>=3){case 16:for(Q=3+Mt(b,G),G+=2,Ke=ct[ct.length-1];Q-- >0;)ct.push(Ke);break;case 17:for(Q=3+Et(b,G),G+=3;Q-- >0;)ct.push(0);break;case 18:for(Q=11+Ge(b,G),G+=7;Q-- >0;)ct.push(0);break;default:ct.push(Ke),fe<Ke&&(fe=Ke);break}var Lt=ct.slice(0,L),Bt=ct.slice(L);for(Ue=L;Ue<286;++Ue)Lt[Ue]=0;for(Ue=U;Ue<30;++Ue)Bt[Ue]=0;return xi=Ni(Lt,mr,286),fo=Ni(Bt,xr,30),G}function Uu(b,G){if(b[0]==3&&!(b[1]&3))return[Zo(G),2];for(var L=0,U=0,X=B_(G||1<<18),Q=0,ue=X.length>>>0,pe=0,fe=0;!(U&1);){if(U=Et(b,L),L+=3,U>>>1)U>>1==1?(pe=9,fe=5):(L=ho(b,L),pe=xi,fe=fo);else{L&7&&(L+=8-(L&7));var se=b[L>>>3]|b[(L>>>3)+1]<<8;if(L+=32,se>0)for(!G&&ue<Q+se&&(X=Ii(X,Q+se),ue=X.length);se-- >0;)X[Q++]=b[L>>>3],L+=8;continue}for(;;){!G&&ue<Q+32767&&(X=Ii(X,Q+32767),ue=X.length);var he=or(b,L,pe),Se=U>>>1==1?er[he]:mr[he];if(L+=Se&15,Se>>>=4,!(Se>>>8&255))X[Q++]=Se;else{if(Se==256)break;Se-=257;var Ue=Se<8?0:Se-4>>2;Ue>5&&(Ue=0);var Ke=Q+xe[Se];Ue>0&&(Ke+=or(b,L,Ue),L+=Ue),he=or(b,L,fe),Se=U>>>1==1?br[he]:xr[he],L+=Se&15,Se>>>=4;var Re=Se<4?0:Se-2>>1,Ye=we[Se];for(Re>0&&(Ye+=or(b,L,Re),L+=Re),!G&&ue<Ke&&(X=Ii(X,Ke+100),ue=X.length);Q<Ke;)X[Q]=X[Q-Ye],++Q}}}return G?[X,L+7>>>3]:[X.slice(0,Q),L+7>>>3]}function Os(b,G){var L=b.slice(b.l||0),U=Uu(L,G);return b.l+=U[1],U[0]}function fl(b,G){if(b)typeof console<"u"&&console.error(G);else throw new Error(G)}function Ms(b,G){var L=b;$n(L,0);var U=[],X=[],Q={FileIndex:U,FullPaths:X};T(Q,{root:G.root});for(var ue=L.length-4;(L[ue]!=80||L[ue+1]!=75||L[ue+2]!=5||L[ue+3]!=6)&&ue>=0;)--ue;L.l=ue+4,L.l+=4;var pe=L.read_shift(2);L.l+=6;var fe=L.read_shift(4);for(L.l=fe,ue=0;ue<pe;++ue){L.l+=20;var se=L.read_shift(4),he=L.read_shift(4),Se=L.read_shift(2),Ue=L.read_shift(2),Ke=L.read_shift(2);L.l+=8;var Re=L.read_shift(4),Ye=o(L.slice(L.l+Se,L.l+Se+Ue));L.l+=Se+Ue+Ke;var ct=L.l;L.l=Re+4,ce(L,se,he,Q,Ye),L.l=ct}return Q}function ce(b,G,L,U,X){b.l+=2;var Q=b.read_shift(2),ue=b.read_shift(2),pe=a(b);if(Q&8257)throw new Error("Unsupported ZIP encryption");for(var fe=b.read_shift(4),se=b.read_shift(4),he=b.read_shift(4),Se=b.read_shift(2),Ue=b.read_shift(2),Ke="",Re=0;Re<Se;++Re)Ke+=String.fromCharCode(b[b.l++]);if(Ue){var Ye=o(b.slice(b.l,b.l+Ue));(Ye[21589]||{}).mt&&(pe=Ye[21589].mt),((X||{})[21589]||{}).mt&&(pe=X[21589].mt)}b.l+=Ue;var ct=b.slice(b.l,b.l+se);switch(ue){case 8:ct=ne(b,he);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ue)}var Lt=!1;Q&8&&(fe=b.read_shift(4),fe==134695760&&(fe=b.read_shift(4),Lt=!0),se=b.read_shift(4),he=b.read_shift(4)),se!=G&&fl(Lt,"Bad compressed size: "+G+" != "+se),he!=L&&fl(Lt,"Bad uncompressed size: "+L+" != "+he),Ls(U,Ke,ct,{unsafe:!0,mt:pe})}function Br(b,G){var L=G||{},U=[],X=[],Q=ye(1),ue=L.compression?8:0,pe=0,fe=0,se=0,he=0,Se=0,Ue=b.FullPaths[0],Ke=Ue,Re=b.FileIndex[0],Ye=[],ct=0;for(fe=1;fe<b.FullPaths.length;++fe)if(Ke=b.FullPaths[fe].slice(Ue.length),Re=b.FileIndex[fe],!(!Re.size||!Re.content||Ke=="Sh33tJ5")){var Lt=he,Bt=ye(Ke.length);for(se=0;se<Ke.length;++se)Bt.write_shift(1,Ke.charCodeAt(se)&127);Bt=Bt.slice(0,Bt.l),Ye[Se]=tR.buf(Re.content,0);var hr=Re.content;ue==8&&(hr=re(hr)),Q=ye(30),Q.write_shift(4,67324752),Q.write_shift(2,20),Q.write_shift(2,pe),Q.write_shift(2,ue),Re.mt?s(Q,Re.mt):Q.write_shift(4,0),Q.write_shift(-4,Ye[Se]),Q.write_shift(4,hr.length),Q.write_shift(4,Re.content.length),Q.write_shift(2,Bt.length),Q.write_shift(2,0),he+=Q.length,U.push(Q),he+=Bt.length,U.push(Bt),he+=hr.length,U.push(hr),Q=ye(46),Q.write_shift(4,33639248),Q.write_shift(2,0),Q.write_shift(2,20),Q.write_shift(2,pe),Q.write_shift(2,ue),Q.write_shift(4,0),Q.write_shift(-4,Ye[Se]),Q.write_shift(4,hr.length),Q.write_shift(4,Re.content.length),Q.write_shift(2,Bt.length),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(4,0),Q.write_shift(4,Lt),ct+=Q.l,X.push(Q),ct+=Bt.length,X.push(Bt),++Se}return Q=ye(22),Q.write_shift(4,101010256),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,Se),Q.write_shift(2,Se),Q.write_shift(4,ct),Q.write_shift(4,he),Q.write_shift(2,0),Pn([Pn(U),Pn(X),Q])}var Ri={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function cs(b,G){if(b.ctype)return b.ctype;var L=b.name||"",U=L.match(/\.([^\.]+)$/);return U&&Ri[U[1]]||G&&(U=(L=G).match(/[\.\\]([^\.\\])+$/),U&&Ri[U[1]])?Ri[U[1]]:"application/octet-stream"}function ka(b){for(var G=sf(b),L=[],U=0;U<G.length;U+=76)L.push(G.slice(U,U+76));return L.join(`\r
`)+`\r
`}function na(b){var G=b.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(se){var he=se.charCodeAt(0).toString(16).toUpperCase();return"="+(he.length==1?"0"+he:he)});G=G.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),G.charAt(0)==`
`&&(G="=0D"+G.slice(1)),G=G.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var L=[],U=G.split(`\r
`),X=0;X<U.length;++X){var Q=U[X];if(Q.length==0){L.push("");continue}for(var ue=0;ue<Q.length;){var pe=76,fe=Q.slice(ue,ue+pe);fe.charAt(pe-1)=="="?pe--:fe.charAt(pe-2)=="="?pe-=2:fe.charAt(pe-3)=="="&&(pe-=3),fe=Q.slice(ue,ue+pe),ue+=pe,ue<Q.length&&(fe+="="),L.push(fe)}}return L.join(`\r
`)}function ia(b){for(var G=[],L=0;L<b.length;++L){for(var U=b[L];L<=b.length&&U.charAt(U.length-1)=="=";)U=U.slice(0,U.length-1)+b[++L];G.push(U)}for(var X=0;X<G.length;++X)G[X]=G[X].replace(/[=][0-9A-Fa-f]{2}/g,function(Q){return String.fromCharCode(parseInt(Q.slice(1),16))});return Zi(G.join(`\r
`))}function Di(b,G,L){for(var U="",X="",Q="",ue,pe=0;pe<10;++pe){var fe=G[pe];if(!fe||fe.match(/^\s*$/))break;var se=fe.match(/^(.*?):\s*([^\s].*)$/);if(se)switch(se[1].toLowerCase()){case"content-location":U=se[2].trim();break;case"content-type":Q=se[2].trim();break;case"content-transfer-encoding":X=se[2].trim();break}}switch(++pe,X.toLowerCase()){case"base64":ue=Zi(ss(G.slice(pe).join("")));break;case"quoted-printable":ue=ia(G.slice(pe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+X)}var he=Ls(b,U.slice(L.length),ue,{unsafe:!0});Q&&(he.ctype=Q)}function an(b,G){if(ie(b.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var L=G&&G.root||"",U=(Ft&&Buffer.isBuffer(b)?b.toString("binary"):ie(b)).split(`\r
`),X=0,Q="";for(X=0;X<U.length;++X)if(Q=U[X],!!/^Content-Location:/i.test(Q)&&(Q=Q.slice(Q.indexOf("file")),L||(L=Q.slice(0,Q.lastIndexOf("/")+1)),Q.slice(0,L.length)!=L))for(;L.length>0&&(L=L.slice(0,L.length-1),L=L.slice(0,L.lastIndexOf("/")+1),Q.slice(0,L.length)!=L););var ue=(U[1]||"").match(/boundary="(.*?)"/);if(!ue)throw new Error("MAD cannot find boundary");var pe="--"+(ue[1]||""),fe=[],se=[],he={FileIndex:fe,FullPaths:se};T(he);var Se,Ue=0;for(X=0;X<U.length;++X){var Ke=U[X];Ke!==pe&&Ke!==pe+"--"||(Ue++&&Di(he,U.slice(Se,X),L),Se=X)}return he}function qr(b,G){var L=G||{},U=L.boundary||"SheetJS";U="------="+U;for(var X=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+U.slice(2)+'"',"","",""],Q=b.FullPaths[0],ue=Q,pe=b.FileIndex[0],fe=1;fe<b.FullPaths.length;++fe)if(ue=b.FullPaths[fe].slice(Q.length),pe=b.FileIndex[fe],!(!pe.size||!pe.content||ue=="Sh33tJ5")){ue=ue.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ct){return"_x"+ct.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ct){return"_u"+ct.charCodeAt(0).toString(16)+"_"});for(var se=pe.content,he=Ft&&Buffer.isBuffer(se)?se.toString("binary"):ie(se),Se=0,Ue=Math.min(1024,he.length),Ke=0,Re=0;Re<=Ue;++Re)(Ke=he.charCodeAt(Re))>=32&&Ke<128&&++Se;var Ye=Se>=Ue*4/5;X.push(U),X.push("Content-Location: "+(L.root||"file:///C:/SheetJS/")+ue),X.push("Content-Transfer-Encoding: "+(Ye?"quoted-printable":"base64")),X.push("Content-Type: "+cs(pe,ue)),X.push(""),X.push(Ye?na(he):ka(he))}return X.push(U+`--\r
`),X.join(`\r
`)}function Ca(b){var G={};return T(G,b),G}function Ls(b,G,L,U){var X=U&&U.unsafe;X||T(b);var Q=!X&&tt.find(b,G);if(!Q){var ue=b.FullPaths[0];G.slice(0,ue.length)==ue?ue=G:(ue.slice(-1)!="/"&&(ue+="/"),ue=(ue+G).replace("//","/")),Q={name:i(G),type:2},b.FileIndex.push(Q),b.FullPaths.push(ue),X||tt.utils.cfb_gc(b)}return Q.content=L,Q.size=L?L.length:0,U&&(U.CLSID&&(Q.clsid=U.CLSID),U.mt&&(Q.mt=U.mt),U.ct&&(Q.ct=U.ct)),Q}function on(b,G){T(b);var L=tt.find(b,G);if(L){for(var U=0;U<b.FileIndex.length;++U)if(b.FileIndex[U]==L)return b.FileIndex.splice(U,1),b.FullPaths.splice(U,1),!0}return!1}function hc(b,G,L){T(b);var U=tt.find(b,G);if(U){for(var X=0;X<b.FileIndex.length;++X)if(b.FileIndex[X]==U)return b.FileIndex[X].name=i(L),b.FullPaths[X]=L,!0}return!1}function Ki(b){S(b,!0)}return e.find=R,e.read=V,e.parse=f,e.write=Ce,e.writeFile=Te,e.utils={cfb_new:Ca,cfb_add:Ls,cfb_del:on,cfb_mov:hc,cfb_gc:Ki,ReadShift:Cd,CheckField:iA,prep_blob:$n,bconcat:Pn,use_zlib:W,_deflateRaw:ft,_inflateRaw:Os,consts:be},e}();function rR(t){return typeof t=="string"?Op(t):Array.isArray(t)?FN(t):t}function Df(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Op(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?ga(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([rR(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=cl(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function nR(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Wr(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function G_(t,e){for(var r=[],n=Wr(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function Lp(t){for(var e=[],r=Wr(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Bp(t){for(var e=[],r=Wr(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function iR(t){for(var e=[],r=Wr(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Kh=new Date(1899,11,30,0,0,0);function En(t,e){var r=t.getTime(),n=Kh.getTime()+(t.getTimezoneOffset()-Kh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var LT=new Date,sR=Kh.getTime()+(LT.getTimezoneOffset()-Kh.getTimezoneOffset())*6e4,K_=LT.getTimezoneOffset();function jp(t){var e=new Date;return e.setTime(t*24*60*60*1e3+sR),e.getTimezoneOffset()!==K_&&e.setTime(e.getTime()+(e.getTimezoneOffset()-K_)*6e4),e}function aR(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[s],10)}return e}var Y_=new Date("2017-02-19T19:06:09.000Z"),BT=isNaN(Y_.getFullYear())?new Date("2/19/17"):Y_,oR=BT.getFullYear()==2017;function Er(t,e){var r=new Date(t);if(oR)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(BT.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Kl(t,e){if(Ft&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return ga(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return ga(AT(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return ga(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return ga(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function wr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=wr(t[r]));return e}function Ur(t,e){for(var r="";r.length<e;)r+=t;return r}function Zs(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var lR=["january","february","march","april","may","june","july","august","september","october","november","december"];function gu(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&lR.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var cR=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function jT(t){return t?t.content&&t.type?Kl(t.content,!0):t.data?dd(t.data):t.asNodeBuffer&&Ft?dd(t.asNodeBuffer().toString("binary")):t.asBinary?dd(t.asBinary()):t._data&&t._data.getContent?dd(Kl(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function UT(t){if(!t)return null;if(t.data)return M_(t.data);if(t.asNodeBuffer&&Ft)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?M_(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function uR(t){return t&&t.name.slice(-4)===".bin"?UT(t):jT(t)}function Ss(t,e){for(var r=t.FullPaths||Wr(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function L1(t,e){var r=Ss(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function tn(t,e,r){if(!r)return uR(L1(t,e));if(!e)return null;try{return tn(t,e)}catch{return null}}function es(t,e,r){if(!r)return jT(L1(t,e));if(!e)return null;try{return es(t,e)}catch{return null}}function dR(t,e,r){return UT(L1(t,e))}function X_(t){for(var e=t.FullPaths||Wr(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function St(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Ft?n=oo(r):n=bN(r),tt.utils.cfb_add(t,e,n)}tt.utils.cfb_add(t,e,r)}else t.file(e,r)}function B1(){return tt.utils.cfb_new()}function VT(t,e){switch(e.type){case"base64":return tt.read(t,{type:"base64"});case"binary":return tt.read(t,{type:"binary"});case"buffer":case"array":return tt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function hd(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var Xr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,fR=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,q_=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,hR=/<[^>]*>/g,gi=Xr.match(q_)?q_:hR,pR=/<\w*:/,gR=/<(\/?)\w+:/;function dt(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var a=t.match(fR),o=0,l="",u=0,f="",p="",g=1;if(a)for(u=0;u!=a.length;++u){for(p=a[u],s=0;s!=p.length&&p.charCodeAt(s)!==61;++s);for(f=p.slice(0,s).trim();p.charCodeAt(s+1)==32;)++s;for(g=(i=p.charCodeAt(s+1))==34||i==39?1:0,l=p.slice(s+1+g,p.length-g),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,n[f.toLowerCase()]=l;else{var m=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[m]&&f.slice(o-3,o)=="ext")continue;n[m]=l,n[m.toLowerCase()]=l}}return n}function Ta(t){return t.replace(gR,"<$1")}var zT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},j1=Lp(zT),Yt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(o,l){return zT[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),U1=/[&<>'"]/g,mR=/[\u0000-\u0008\u000b-\u001f]/g;function ir(t){var e=t+"";return e.replace(U1,function(r){return j1[r]}).replace(mR,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Q_(t){return ir(t).replace(/ /g,"_x0020_")}var WT=/[\u0000-\u001f]/g;function V1(t){var e=t+"";return e.replace(U1,function(r){return j1[r]}).replace(/\n/g,"<br/>").replace(WT,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function xR(t){var e=t+"";return e.replace(U1,function(r){return j1[r]}).replace(WT,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var J_=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function vR(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function yr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Dg(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function Z_(t){var e=Zo(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function e2(t){return oo(t,"binary").toString("utf8")}var F0="foo bar baz",ur=Ft&&(e2(F0)==Dg(F0)&&e2||Z_(F0)==Dg(F0)&&Z_)||Dg,ga=Ft?function(t){return oo(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},of=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),HT=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),yR=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),_R=/<\/?(?:vt:)?variant>/g,ER=/<(?:vt:)([^>]*)>([\s\S]*)</;function t2(t,e){var r=dt(t),n=t.match(yR(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(_R,"").match(ER);a&&i.push({v:ur(a[2]),t:a[1]})}),i}var $T=/(^\s|\s$|\n)/;function Gn(t,e){return"<"+t+(e.match($T)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function lf(t){return Wr(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function ze(t,e,r){return"<"+t+(r!=null?lf(r):"")+(e!=null?(e.match($T)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function nx(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function wR(t,e){switch(typeof t){case"string":var r=ze("vt:lpwstr",ir(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ze((t|0)==t?"vt:i4":"vt:r8",ir(String(t)));case"boolean":return ze("vt:bool",t?"true":"false")}if(t instanceof Date)return ze("vt:filetime",nx(t));throw new Error("Unable to serialize "+t)}function z1(t){if(Ft&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return ur(cl(P1(t)));throw new Error("Bad input format: expected Buffer or string")}var cf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,xn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},sc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Qi={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function SR(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function TR(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var r2=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},n2=Ft?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:oo(e)})):r2(t)}:r2,i2=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Va(t,i)));return n.join("").replace(ki,"")},W1=Ft?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(ki,""):i2(t,e,r)}:i2,s2=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},GT=Ft?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):s2(t,e,r)}:s2,a2=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(Ic(t,i)));return n.join("")},Pf=Ft?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):a2(e,r,n)}:a2,KT=function(t,e){var r=Ji(t,e);return r>0?Pf(t,e+4,e+4+r-1):""},YT=KT,XT=function(t,e){var r=Ji(t,e);return r>0?Pf(t,e+4,e+4+r-1):""},qT=XT,QT=function(t,e){var r=2*Ji(t,e);return r>0?Pf(t,e+4,e+4+r-1):""},JT=QT,ZT=function(e,r){var n=Ji(e,r);return n>0?W1(e,r+4,r+4+n):""},eA=ZT,tA=function(t,e){var r=Ji(t,e);return r>0?Pf(t,e+4,e+4+r):""},rA=tA,nA=function(t,e){return SR(t,e)},Yh=nA,H1=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Ft&&(YT=function(e,r){if(!Buffer.isBuffer(e))return KT(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},qT=function(e,r){if(!Buffer.isBuffer(e))return XT(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},JT=function(e,r){if(!Buffer.isBuffer(e))return QT(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},eA=function(e,r){if(!Buffer.isBuffer(e))return ZT(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},rA=function(e,r){if(!Buffer.isBuffer(e))return tA(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Yh=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):nA(e,r)},H1=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Ic=function(t,e){return t[e]},Va=function(t,e){return t[e+1]*256+t[e]},AR=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Ji=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},kl=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},kR=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Cd(t,e){var r="",n,i,s=[],a,o,l,u;switch(e){case"dbcs":if(u=this.l,Ft&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(Va(this,u)),u+=2;t*=2;break;case"utf8":r=Pf(this,this.l,this.l+t);break;case"utf16le":t*=2,r=W1(this,this.l,this.l+t);break;case"wstr":return Cd.call(this,t,"dbcs");case"lpstr-ansi":r=YT(this,this.l),t=4+Ji(this,this.l);break;case"lpstr-cp":r=qT(this,this.l),t=4+Ji(this,this.l);break;case"lpwstr":r=JT(this,this.l),t=4+2*Ji(this,this.l);break;case"lpp4":t=4+Ji(this,this.l),r=eA(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Ji(this,this.l),r=rA(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=Ic(this,this.l+t++))!==0;)s.push(C0(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=Va(this,this.l+t))!==0;)s.push(C0(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Ic(this,u),this.l=u+1,o=Cd.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(C0(Va(this,u))),u+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Ic(this,u),this.l=u+1,o=Cd.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(C0(Ic(this,u))),u+=1}r=s.join("");break;default:switch(t){case 1:return n=Ic(this,this.l),this.l++,n;case 2:return n=(e==="i"?AR:Va)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?kl:kR)(this,this.l),this.l+=4,n):(i=Ji(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=Yh(this,this.l):i=Yh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=GT(this,this.l,t);break}}return this.l+=t,r}var CR=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},FR=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},bR=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function IR(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)bR(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,CR(this,e,this.l);break;case 8:if(n=8,r==="f"){TR(this,e,this.l);break}case 16:break;case-4:n=4,FR(this,e,this.l);break}return this.l+=n,this}function iA(t,e){var r=GT(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function $n(t,e){t.l=e,t.read_shift=Cd,t.chk=iA,t.write_shift=IR}function hi(t,e){t.l+=e}function ye(t){var e=Zo(t);return $n(e,0),e}function lo(t,e,r){if(t){var n,i,s;$n(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var u=gf[o]||gf[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;l=t.l+s;var f=u.f&&u.f(t,s,r);if(t.l=l,e(f,u,o))return}}}function $i(){var t=[],e=Ft?256:2048,r=function(u){var f=ye(u);return $n(f,0),f},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,e)))},a=function(){return i(),Pn(t)},o=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function ke(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=gf[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&H1(r)&&t.push(r)}}function Fd(t,e,r){var n=wr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function o2(t,e,r){var n=wr(t);return n.s=Fd(n.s,e.s,r),n.e=Fd(n.e,e.s,r),n}function bd(t,e){if(t.cRel&&t.c<0)for(t=wr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=wr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=ut(t);return!t.cRel&&t.cRel!=null&&(r=DR(r)),!t.rRel&&t.rRel!=null&&(r=NR(r)),r}function Pg(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Dr(t.s.c)+":"+(t.e.cRel?"":"$")+Dr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Yr(t.s.r)+":"+(t.e.rRel?"":"$")+Yr(t.e.r):bd(t.s,e.biff)+":"+bd(t.e,e.biff)}function $1(t){return parseInt(RR(t),10)-1}function Yr(t){return""+(t+1)}function NR(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function RR(t){return t.replace(/\$(\d+)$/,"$1")}function G1(t){for(var e=PR(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Dr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function DR(t){return t.replace(/^([A-Z])/,"$$$1")}function PR(t){return t.replace(/^\$([A-Z])/,"$1")}function OR(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Pr(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function ut(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Gi(t){var e=t.indexOf(":");return e==-1?{s:Pr(t),e:Pr(t)}:{s:Pr(t.slice(0,e)),e:Pr(t.slice(e+1))}}function wt(t,e){return typeof e>"u"||typeof e=="number"?wt(t.s,t.e):(typeof t!="string"&&(t=ut(t)),typeof e!="string"&&(e=ut(e)),t==e?t:t+":"+e)}function Xt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function l2(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Ds(t.z,r?En(e):e)}catch{}try{return t.w=Ds((t.XF||{}).numFmtId||(r?14:0),r?En(e):e)}catch{return""+e}}function eo(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?co[t.v]||t.v:e==null?l2(t,t.v):l2(t,e))}function ul(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function sA(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Pr(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=Xt(s["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),a==-1&&(u.e.r=a=f.e.r+1)}for(var p=0;p!=e.length;++p)if(e[p]){if(!Array.isArray(e[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=e[p].length;++g)if(!(typeof e[p][g]>"u")){var m={v:e[p][g]},y=a+p,x=o+g;if(u.s.r>y&&(u.s.r=y),u.s.c>x&&(u.s.c=x),u.e.r<y&&(u.e.r=y),u.e.c<x&&(u.e.c=x),e[p][g]&&typeof e[p][g]=="object"&&!Array.isArray(e[p][g])&&!(e[p][g]instanceof Date))m=e[p][g];else if(Array.isArray(m.v)&&(m.f=e[p][g][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||lt[14],n.cellDates?(m.t="d",m.w=Ds(m.z,En(m.v))):(m.t="n",m.v=En(m.v),m.w=Ds(m.z,m.v))):m.t="s";if(i)s[y]||(s[y]=[]),s[y][x]&&s[y][x].z&&(m.z=s[y][x].z),s[y][x]=m;else{var w=ut({c:x,r:y});s[w]&&s[w].z&&(m.z=s[w].z),s[w]=m}}}return u.s.c<1e7&&(s["!ref"]=wt(u)),s}function Ru(t,e){return sA(null,t,e)}function MR(t){return t.read_shift(4,"i")}function ea(t,e){return e||(e=ye(4)),e.write_shift(4,t),e}function di(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function On(t,e){var r=!1;return e==null&&(r=!0,e=ye(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function LR(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function BR(t,e){return e||(e=ye(4)),e.write_shift(2,0),e.write_shift(2,0),e}function K1(t,e){var r=t.l,n=t.read_shift(1),i=di(t),s=[],a={t:i,h:i};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)s.push(LR(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function jR(t,e){var r=!1;return e==null&&(r=!0,e=ye(15+4*t.t.length)),e.write_shift(1,0),On(t.t,e),r?e.slice(0,e.l):e}var UR=K1;function VR(t,e){var r=!1;return e==null&&(r=!0,e=ye(23+4*t.t.length)),e.write_shift(1,1),On(t.t,e),e.write_shift(4,1),BR({},e),r?e.slice(0,e.l):e}function Ps(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function ac(t,e){return e==null&&(e=ye(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function oc(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function lc(t,e){return e==null&&(e=ye(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var zR=di,aA=On;function Y1(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Xh(t,e){var r=!1;return e==null&&(r=!0,e=ye(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var WR=di,ix=Y1,X1=Xh;function q1(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?Yh([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):kl(e,0)>>2;return r?i/100:i}function oA(t,e){e==null&&(e=ye(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function lA(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function HR(t,e){return e||(e=ye(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var cc=lA,Du=HR;function ui(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Yl(t,e){return(e||ye(8)).write_shift(8,t,"f")}function $R(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var u=Ol[i];u&&(e.rgb=df(u));break;case 2:e.rgb=df([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function qh(t,e){if(e||(e=ye(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function GR(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function KR(t,e){e||(e=ye(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function cA(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function YR(t){return cA(t,1)}function XR(t){return cA(t,2)}var Q1=2,ji=3,b0=11,c2=12,Qh=19,I0=64,qR=65,QR=71,JR=4108,ZR=4126,Nn=80,uA=81,eD=[Nn,uA],sx={1:{n:"CodePage",t:Q1},2:{n:"Category",t:Nn},3:{n:"PresentationFormat",t:Nn},4:{n:"ByteCount",t:ji},5:{n:"LineCount",t:ji},6:{n:"ParagraphCount",t:ji},7:{n:"SlideCount",t:ji},8:{n:"NoteCount",t:ji},9:{n:"HiddenCount",t:ji},10:{n:"MultimediaClipCount",t:ji},11:{n:"ScaleCrop",t:b0},12:{n:"HeadingPairs",t:JR},13:{n:"TitlesOfParts",t:ZR},14:{n:"Manager",t:Nn},15:{n:"Company",t:Nn},16:{n:"LinksUpToDate",t:b0},17:{n:"CharacterCount",t:ji},19:{n:"SharedDoc",t:b0},22:{n:"HyperlinksChanged",t:b0},23:{n:"AppVersion",t:ji,p:"version"},24:{n:"DigSig",t:qR},26:{n:"ContentType",t:Nn},27:{n:"ContentStatus",t:Nn},28:{n:"Language",t:Nn},29:{n:"Version",t:Nn},255:{},2147483648:{n:"Locale",t:Qh},2147483651:{n:"Behavior",t:Qh},1919054434:{}},ax={1:{n:"CodePage",t:Q1},2:{n:"Title",t:Nn},3:{n:"Subject",t:Nn},4:{n:"Author",t:Nn},5:{n:"Keywords",t:Nn},6:{n:"Comments",t:Nn},7:{n:"Template",t:Nn},8:{n:"LastAuthor",t:Nn},9:{n:"RevNumber",t:Nn},10:{n:"EditTime",t:I0},11:{n:"LastPrinted",t:I0},12:{n:"CreatedDate",t:I0},13:{n:"ModifiedDate",t:I0},14:{n:"PageCount",t:ji},15:{n:"WordCount",t:ji},16:{n:"CharCount",t:ji},17:{n:"Thumbnail",t:QR},18:{n:"Application",t:Nn},19:{n:"DocSecurity",t:ji},255:{},2147483648:{n:"Locale",t:Qh},2147483651:{n:"Behavior",t:Qh},1919054434:{}},u2={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},tD=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function rD(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var nD=rD([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ol=wr(nD),co={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},dA={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ox={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},N0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function J1(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function iD(t){var e=J1();if(!t||!t.match)return e;var r={};if((t.match(gi)||[]).forEach(function(n){var i=dt(n);switch(i[0].replace(pR,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[ox[i.ContentType]]!==void 0&&e[ox[i.ContentType]].push(i.PartName);break}}),e.xmlns!==xn.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function fA(t,e){var r=iR(ox),n=[],i;n[n.length]=Xr,n[n.length]=ze("Types",null,{xmlns:xn.CT,"xmlns:xsd":xn.xsd,"xmlns:xsi":xn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return ze("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],n[n.length]=ze("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:N0[l][e.bookType]||N0[l].xlsx}))},a=function(l){(t[l]||[]).forEach(function(u){n[n.length]=ze("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:N0[l][e.bookType]||N0[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(u){n[n.length]=ze("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var bt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function uf(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Id(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(gi)||[]).forEach(function(i){var s=dt(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:hd(s.Target,e);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}function tu(t){var e=[Xr,ze("Relationships",null,{xmlns:xn.RELS})];return Wr(t["!id"]).forEach(function(r){e[e.length]=ze("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function nr(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[bt.HLINK,bt.XPATH,bt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var sD="application/vnd.oasis.opendocument.spreadsheet";function aD(t,e){for(var r=z1(t),n,i;n=cf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=dt(n[0],!1),i.path=="/"&&i.type!==sD)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function oD(t){var e=[Xr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function d2(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function lD(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function cD(t){var e=[Xr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(d2(t[r][0],t[r][1])),e.push(lD("",t[r][0]));return e.push(d2("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function hA(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Wh.version+"</meta:generator></office:meta></office:document-meta>"}var Is=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],uD=function(){for(var t=new Array(Is.length),e=0;e<Is.length;++e){var r=Is[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function pA(t){var e={};t=ur(t);for(var r=0;r<Is.length;++r){var n=Is[r],i=t.match(uD[r]);i!=null&&i.length>0&&(e[n[1]]=Yt(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Er(e[n[1]]))}return e}function Og(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=ir(e),n[n.length]=r?ze(t,e,r):Gn(t,e))}function gA(t,e){var r=e||{},n=[Xr,ze("cp:coreProperties",null,{"xmlns:cp":xn.CORE_PROPS,"xmlns:dc":xn.dc,"xmlns:dcterms":xn.dcterms,"xmlns:dcmitype":xn.dcmitype,"xmlns:xsi":xn.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&Og("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:nx(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&Og("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:nx(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Is.length;++s){var a=Is[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Og(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ml=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],mA=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function xA(t,e,r,n){var i=[];if(typeof t=="string")i=t2(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(f){return{v:f}}));var a=typeof e=="string"?t2(e,n).map(function(f){return f.v}):e,o=0,l=0;if(a.length>0)for(var u=0;u!==i.length;u+=2){switch(l=+i[u+1].v,i[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function dD(t,e,r){var n={};return e||(e={}),t=ur(t),Ml.forEach(function(i){var s=(t.match(of(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=Yt(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&xA(n.HeadingPairs,n.TitlesOfParts,e,r),e}function vA(t){var e=[],r=ze;return t||(t={}),t.Application="SheetJS",e[e.length]=Xr,e[e.length]=ze("Properties",null,{xmlns:xn.EXT_PROPS,"xmlns:vt":xn.vt}),Ml.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=ir(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+ir(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var fD=/<[^>]+>[^<]*/g;function hD(t,e){var r={},n="",i=t.match(fD);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=dt(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Yt(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),u=l[0].slice(4),f=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=Yt(f);break;case"bool":r[n]=yr(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=Er(f);break;case"cy":case"error":r[n]=Yt(f);break;default:if(u.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,u,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}function yA(t){var e=[Xr,ze("Properties",null,{xmlns:xn.CUST_PROPS,"xmlns:vt":xn.vt})];if(!t)return e.join("");var r=1;return Wr(t).forEach(function(i){++r,e[e.length]=ze("property",wR(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:ir(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var lx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Mg;function pD(t,e,r){Mg||(Mg=Lp(lx)),e=Mg[e]||e,t[e]=r}function gD(t,e){var r=[];return Wr(lx).map(function(n){for(var i=0;i<Is.length;++i)if(Is[i][1]==n)return Is[i];for(i=0;i<Ml.length;++i)if(Ml[i][1]==n)return Ml[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Gn(lx[n[1]]||n[1],i))}}),ze("DocumentProperties",r.join(""),{xmlns:Qi.o})}function mD(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&Wr(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<Is.length;++a)if(s==Is[a][1])return;for(a=0;a<Ml.length;++a)if(s==Ml[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(ze(Q_(s),o,{"dt:dt":l}))}}),e&&Wr(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(ze(Q_(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Qi.o+'">'+i.join("")+"</"+n+">"}function Z1(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function xD(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=ye(8);return a.write_shift(4,n),a.write_shift(4,i),a}function _A(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function EA(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function wA(t,e,r){return e===31?EA(t):_A(t,e,r)}function cx(t,e,r){return wA(t,e,r===!1?0:4)}function vD(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return wA(t,e,0)}function yD(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(ki,""),t.l-i&2&&(t.l+=2)}return r}function _D(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(ki,"");return r}function ED(t){var e=t.l,r=Jh(t,uA);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Jh(t,ji);return[r,n]}function wD(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(ED(t));return r}function f2(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),a=t.read_shift(4);n[s]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(ki,"").replace(fd,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function SA(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function SD(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Jh(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==c2&&n!==e&&eD.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===c2?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return _A(t,n,4).replace(ki,"");case 31:return EA(t);case 64:return Z1(t);case 65:return SA(t);case 71:return SD(t);case 80:return cx(t,n,!s.raw).replace(ki,"");case 81:return vD(t,n).replace(ki,"");case 4108:return wD(t);case 4126:case 4127:return n==4127?yD(t):_D(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function h2(t,e){var r=ye(4),n=ye(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=ye(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=xD(e);break;case 31:case 80:for(n=ye(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Pn([r,n])}function p2(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0,o=0,l=-1,u={};for(a=0;a!=i;++a){var f=t.read_shift(4),p=t.read_shift(4);s[a]=[f,p+r]}s.sort(function(k,E){return k[1]-E[1]});var g={};for(a=0;a!=i;++a){if(t.l!==s[a][1]){var m=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:t.l+2===s[a][1]&&(t.l+=2,m=!1);break;case 80:t.l<=s[a][1]&&(t.l=s[a][1],m=!1);break;case 4108:t.l<=s[a][1]&&(t.l=s[a][1],m=!1);break}if((!e||a==0)&&t.l<=s[a][1]&&(m=!1,t.l=s[a][1]),m)throw new Error("Read Error: Expected address "+s[a][1]+" at "+t.l+" :"+a)}if(e){var y=e[s[a][0]];if(g[y.n]=Jh(t,y.t,{raw:!0}),y.p==="version"&&(g[y.n]=String(g[y.n]>>16)+"."+("0000"+String(g[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(g[y.n]){case 0:g[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ys(o=g[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[y.n])}}else if(s[a][0]===1){if(o=g.CodePage=Jh(t,Q1),Ys(o),l!==-1){var x=t.l;t.l=s[l][1],u=f2(t,o),t.l=x}}else if(s[a][0]===0){if(o===0){l=a,t.l=s[a+1][1];continue}u=f2(t,o)}else{var w=u[s[a][0]],A;switch(t[t.l]){case 65:t.l+=4,A=SA(t);break;case 30:t.l+=4,A=cx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,A=cx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,A=t.read_shift(4,"i");break;case 19:t.l+=4,A=t.read_shift(4);break;case 5:t.l+=4,A=t.read_shift(8,"f");break;case 11:t.l+=4,A=$r(t,4);break;case 64:t.l+=4,A=Er(Z1(t));break;default:throw new Error("unparsed value: "+t[t.l])}g[w]=A}}return t.l=r+n,g}var TA=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function TD(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function g2(t,e,r){var n=ye(8),i=[],s=[],a=8,o=0,l=ye(8),u=ye(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),s.push(l),i.push(u),a+=8+l.length,!e){u=ye(8),u.write_shift(4,0),i.unshift(u);var f=[ye(4)];for(f[0].write_shift(4,t.length),o=0;o<t.length;++o){var p=t[o][0];for(l=ye(8+2*(p.length+1)+(p.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,p.length+1),l.write_shift(0,p,"dbcs");l.l!=l.length;)l.write_shift(1,0);f.push(l)}l=Pn(f),s.unshift(l),a+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(TA.indexOf(t[o][0])>-1||mA.indexOf(t[o][0])>-1)&&t[o][1]!=null){var g=t[o][1],m=0;if(e){m=+e[t[o][0]];var y=r[m];if(y.p=="version"&&typeof g=="string"){var x=g.split(".");g=(+x[0]<<16)+(+x[1]||0)}l=h2(y.t,g)}else{var w=TD(g);w==-1&&(w=31,g=String(g)),l=h2(w,g)}s.push(l),u=ye(8),u.write_shift(4,e?m:2+o),i.push(u),a+=8+l.length}var A=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,A),A+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),Pn([n].concat(i).concat(s))}function m2(t,e,r){var n=t.content;if(!n)return{};$n(n,0);var i,s,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),f=n.read_shift(16);if(f!==tt.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),l=n.read_shift(4));var p=p2(n,e),g={SystemIdentifier:u};for(var m in p)g[m]=p[m];if(g.FMTID=s,i===1)return g;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var y;try{y=p2(n,null)}catch{}for(m in y)g[m]=y[m];return g.FMTID=[s,a],g}function x2(t,e,r,n,i,s){var a=ye(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,tt.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=g2(t,r,n);if(o.push(l),i){var u=g2(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(u)}return Pn(o)}function Eo(t,e){return t.read_shift(e),null}function AD(t,e){e||(e=ye(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function kD(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function $r(t,e){return t.read_shift(e)===1}function Ti(t,e){return e||(e=ye(2)),e.write_shift(2,+!!t),e}function rn(t){return t.read_shift(2,"u")}function Ts(t,e){return e||(e=ye(2)),e.write_shift(2,t),e}function AA(t,e){return kD(t,e,rn)}function CD(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function kA(t,e,r){return r||(r=ye(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Of(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return a}function FD(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,s=1+(r&1),a=0,o,l={};i&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",f=e===0?"":t.read_shift(e,u);return i&&(t.l+=4*a),n&&(t.l+=o),l.t=f,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function bD(t){var e=t.t||"",r=ye(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=ye(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return Pn(i)}function Xl(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Mf(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Xl(t,n,r)}function uc(t,e,r){if(r.biff>5)return Mf(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function CA(t,e,r){return r||(r=ye(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function ID(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function ND(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(ki,"");return n&&(t.l+=24),i}function RD(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(s>>1,"utf16le").replace(ki,"");return r+a}function DD(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return ND(t);case"0303000000000000c000000000000046":return RD(t);default:throw new Error("Unsupported Moniker "+r)}}function R0(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(ki,""):"";return r}function v2(t,e){e||(e=ye(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function PD(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,a,o,l,u="",f,p;i&16&&(s=R0(t,r-t.l)),i&128&&(a=R0(t,r-t.l)),(i&257)===257&&(o=R0(t,r-t.l)),(i&257)===1&&(l=DD(t,r-t.l)),i&8&&(u=R0(t,r-t.l)),i&32&&(f=t.read_shift(16)),i&64&&(p=Z1(t)),t.l=r;var g=a||o||l||"";g&&u&&(g+="#"+u),g||(g="#"+u),i&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var m={Target:g};return f&&(m.guid=f),p&&(m.time=p),s&&(m.Tooltip=s),m}function OD(t){var e=ye(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),v2(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&v2(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function FA(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function bA(t,e){var r=FA(t);return r[3]=0,r}function Aa(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function ql(t,e,r,n){return n||(n=ye(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function MD(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function LD(t,e,r){return e===0?"":uc(t,e,r)}function BD(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function IA(t){var e=t.read_shift(2),r=q1(t);return[e,r]}function jD(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=Of(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function Up(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function NA(t,e){return e||(e=ye(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function RA(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var UD=RA;function DA(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function VD(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function zD(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function ri(t){t.l+=2,t.l+=t.read_shift(2)}var WD={0:ri,4:ri,5:ri,6:ri,7:zD,8:ri,9:ri,10:ri,11:ri,12:ri,13:VD,14:ri,15:ri,16:ri,17:ri,18:ri,19:ri,20:ri,21:DA};function HD(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(WD[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function D0(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function ev(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ye(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function $D(t,e){return e===0||t.read_shift(2),1200}function GD(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=uc(t,0,r);return t.read_shift(e+n-t.l),i}function KD(t,e){var r=!e||e.biff==8,n=ye(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function YD(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function XD(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=Of(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function qD(t,e){var r=!e||e.biff>=8?2:1,n=ye(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function QD(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0;a!=i&&t.l<r;++a)s.push(FD(t));return s.Count=n,s.Unique=i,s}function JD(t,e){var r=ye(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=bD(t[i]);var s=Pn([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function ZD(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function e3(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function t3(t){var e=MD(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function r3(t){return t.read_shift(2),t.read_shift(4)}function y2(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function n3(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),u=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:u}}function i3(){var t=ye(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function s3(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function a3(t){var e=ye(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function o3(){}function l3(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Of(t,0,r),n}function c3(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=ye(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function u3(t){var e=Aa(t);return e.isst=t.read_shift(4),e}function d3(t,e,r,n){var i=ye(10);return ql(t,e,n,i),i.write_shift(4,r),i}function f3(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=Aa(t);r.biff==2&&t.l++;var s=Mf(t,n-t.l,r);return i.val=s,i}function h3(t,e,r,n,i){var s=!i||i.biff==8,a=ye(8+ +s+(1+s)*r.length);return ql(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function p3(t,e,r){var n=t.read_shift(2),i=uc(t,0,r);return[n,i]}function g3(t,e,r,n){var i=r&&r.biff==5;n||(n=ye(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var m3=uc;function _2(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),a=t.read_shift(i),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:s,c:o},e:{r:a,c:l}}}function x3(t,e){var r=e.biff==8||!e.biff?4:2,n=ye(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function v3(t){var e=t.read_shift(2),r=t.read_shift(2),n=IA(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function y3(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(IA(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function _3(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function E3(t,e,r,n){var i={},s=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return i.patternType=tD[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function w3(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=E3(t,e,n.fStyle,r),n}function E2(t,e,r,n){var i=r&&r.biff==5;n||(n=ye(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function S3(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function T3(t){var e=ye(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function w2(t,e,r){var n=Aa(t);(r.biff==2||e==9)&&++t.l;var i=CD(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function A3(t,e,r,n,i,s){var a=ye(8);return ql(t,e,n,a),kA(r,s,a),a}function k3(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Aa(t),i=ui(t);return n.val=i,n}function C3(t,e,r,n){var i=ye(14);return ql(t,e,n,i),Yl(r,i),i}var S2=LD;function F3(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=Xl(t,s),o=[];n>t.l;)o.push(Mf(t));return[s,i,a,o]}function T2(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=jD(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var b3=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function A2(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var u=Xl(t,a,r);i&32&&(u=b3[u.charCodeAt(0)]);var f=n-t.l;r&&r.biff==2&&--f;var p=n==t.l||o===0||!(f>0)?[]:H5(t,f,r,o);return{chKey:s,Name:u,itab:l,rgce:p}}function PA(t,e,r){if(r.biff<8)return I3(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(BD(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function I3(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Of(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function N3(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=Xl(t,n,r),a=Xl(t,i,r);return[s,a]}function R3(t,e,r){var n=RA(t);t.l++;var i=t.read_shift(1);return e-=8,[$5(t,e,r),i,n]}function k2(t,e,r){var n=UD(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,z5(t,e,r)]}function D3(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function P3(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=uc(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},o,a,s]}}function O3(t,e,r){return P3(t,e,r)}function M3(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Up(t));return r}function L3(t){var e=ye(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)NA(t[r],e);return e}function B3(t,e,r){if(r&&r.biff<8)return U3(t,e,r);var n=DA(t),i=HD(t,e-22,n[1]);return{cmo:n,ft:i}}var j3={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function U3(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((j3[n]||hi)(t,e,r)),{cmo:[i,n,s],ft:a}}function V3(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:a=ID(t,6,r);var o=t.read_shift(2);t.read_shift(2),rn(t,2);var l=t.read_shift(2);t.l+=l;for(var u=1;u<t.lens.length-1;++u){if(t.l-n!=t.lens[u])throw new Error("TxO: bad continue record");var f=t[t.l],p=Xl(t,t.lens[u+1]-t.lens[u]-1);if(i+=p,i.length>=(f?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function z3(t,e){var r=Up(t);t.l+=16;var n=PD(t,e-24);return[r,n]}function W3(t){var e=ye(24),r=Pr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return Pn([e,OD(t[1])])}function H3(t,e){t.read_shift(2);var r=Up(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(ki,""),[r,n]}function $3(t){var e=t[1].Tooltip,r=ye(10+2*(e.length+1));r.write_shift(2,2048);var n=Pr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function G3(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=u2[r]||r,r=t.read_shift(2),e[1]=u2[r]||r,e}function K3(t){return t||(t=ye(4)),t.write_shift(2,1),t.write_shift(2,1),t}function Y3(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(bA(t));return r}function X3(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(bA(t));return r}function q3(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function OA(t,e,r){if(!r.cellStyles)return hi(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var u={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function Q3(t,e){var r=ye(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function J3(t,e){var r={};return e<32||(t.l+=16,r.header=ui(t),r.footer=ui(t),t.l+=2),r}function Z3(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}function e6(t){for(var e=ye(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var t6=Aa,r6=AA,n6=Mf;function i6(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function s6(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Aa(t);++t.l;var i=uc(t,e-7,r);return n.t="str",n.val=i,n}function a6(t){var e=Aa(t);++t.l;var r=ui(t);return e.t="n",e.val=r,e}function o6(t,e,r){var n=ye(15);return Uf(n,t,e),n.write_shift(8,r,"f"),n}function l6(t){var e=Aa(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function c6(t,e,r){var n=ye(9);return Uf(n,t,e),n.write_shift(2,r),n}function u6(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function d6(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function f6(t,e,r){var n=t.l+e,i=Aa(t),s=t.read_shift(2),a=Xl(t,s,r);return t.l=n,i.t="str",i.val=a,i}var h6=[2,3,48,49,131,139,140,245],ux=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Lp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],f=Zo(1);switch(l.type){case"base64":f=Zi(ss(o));break;case"binary":f=Zi(o);break;case"buffer":case"array":f=o;break}$n(f,0);var p=f.read_shift(1),g=!!(p&136),m=!1,y=!1;switch(p){case 2:break;case 3:break;case 48:m=!0,g=!0;break;case 49:m=!0,g=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var x=0,w=521;p==2&&(x=f.read_shift(2)),f.l+=3,p!=2&&(x=f.read_shift(4)),x>1048576&&(x=1e6),p!=2&&(w=f.read_shift(2));var A=f.read_shift(2),k=l.codepage||1252;p!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(k=t[f[f.l]]),f.l+=1,f.l+=2),y&&(f.l+=36);for(var E=[],P={},Y=Math.min(f.length,p==2?521:w-10-(m?264:0)),V=y?32:11;f.l<Y&&f[f.l]!=13;)switch(P={},P.name=nf.utils.decode(k,f.slice(f.l,f.l+V)).replace(/[\u0000\r\n].*$/g,""),f.l+=V,P.type=String.fromCharCode(f.read_shift(1)),p!=2&&!y&&(P.offset=f.read_shift(4)),P.len=f.read_shift(1),p==2&&(P.offset=f.read_shift(2)),P.dec=f.read_shift(1),P.name.length&&E.push(P),p!=2&&(f.l+=y?13:14),P.type){case"B":(!m||P.len!=8)&&l.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+P.type)}if(f[f.l]!==13&&(f.l=w-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=w;var T=0,F=0;for(u[0]=[],F=0;F!=E.length;++F)u[0][F]=E[F].name;for(;x-- >0;){if(f[f.l]===42){f.l+=A;continue}for(++f.l,u[++T]=[],F=0,F=0;F!=E.length;++F){var S=f.slice(f.l,f.l+E[F].len);f.l+=E[F].len,$n(S,0);var I=nf.utils.decode(k,S);switch(E[F].type){case"C":I.trim().length&&(u[T][F]=I.replace(/\s+$/,""));break;case"D":I.length===8?u[T][F]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):u[T][F]=I;break;case"F":u[T][F]=parseFloat(I.trim());break;case"+":case"I":u[T][F]=y?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":u[T][F]=!0;break;case"N":case"F":u[T][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));u[T][F]="##MEMO##"+(y?parseInt(I.trim(),10):S.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(u[T][F]=+I||0);break;case"@":u[T][F]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":u[T][F]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":u[T][F]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[T][F]=-S.read_shift(-8,"f");break;case"B":if(m&&E[F].len==8){u[T][F]=S.read_shift(8,"f");break}case"G":case"P":S.l+=E[F].len;break;case"0":if(E[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[F].type)}}}if(p!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=E,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var f=Ru(r(o,u),u);return f["!cols"]=u.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete u.DBF,f}function i(o,l){try{return ul(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var u=l||{};if(+u.codepage>=0&&Ys(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=$i(),p=tp(o,{header:1,raw:!0,cellDates:!0}),g=p[0],m=p.slice(1),y=o["!cols"]||[],x=0,w=0,A=0,k=1;for(x=0;x<g.length;++x){if(((y[x]||{}).DBF||{}).name){g[x]=y[x].DBF.name,++A;continue}if(g[x]!=null){if(++A,typeof g[x]=="number"&&(g[x]=g[x].toString(10)),typeof g[x]!="string")throw new Error("DBF Invalid column name "+g[x]+" |"+typeof g[x]+"|");if(g.indexOf(g[x])!==x){for(w=0;w<1024;++w)if(g.indexOf(g[x]+"_"+w)==-1){g[x]+="_"+w;break}}}}var E=Xt(o["!ref"]),P=[],Y=[],V=[];for(x=0;x<=E.e.c-E.s.c;++x){var T="",F="",S=0,I=[];for(w=0;w<m.length;++w)m[w][x]!=null&&I.push(m[w][x]);if(I.length==0||g[x]==null){P[x]="?";continue}for(w=0;w<I.length;++w){switch(typeof I[w]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=I[w]instanceof Date?"D":"C";break;default:F="C"}S=Math.max(S,String(I[w]).length),T=T&&T!=F?"C":F}S>250&&(S=250),F=((y[x]||{}).DBF||{}).type,F=="C"&&y[x].DBF.len>S&&(S=y[x].DBF.len),T=="B"&&F=="N"&&(T="N",V[x]=y[x].DBF.dec,S=y[x].DBF.len),Y[x]=T=="C"||F=="N"?S:s[T]||0,k+=Y[x],P[x]=T}var R=f.next(32);for(R.write_shift(4,318902576),R.write_shift(4,m.length),R.write_shift(2,296+32*A),R.write_shift(2,k),x=0;x<4;++x)R.write_shift(4,0);for(R.write_shift(4,0|(+e[TT]||3)<<8),x=0,w=0;x<g.length;++x)if(g[x]!=null){var D=f.next(32),N=(g[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,N,"sbcs"),D.write_shift(1,P[x]=="?"?"C":P[x],"sbcs"),D.write_shift(4,w),D.write_shift(1,Y[x]||s[P[x]]||0),D.write_shift(1,V[x]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),w+=Y[x]||s[P[x]]||0}var $e=f.next(264);for($e.write_shift(4,13),x=0;x<65;++x)$e.write_shift(4,0);for(x=0;x<m.length;++x){var _e=f.next(k);for(_e.write_shift(1,0),w=0;w<g.length;++w)if(g[w]!=null)switch(P[w]){case"L":_e.write_shift(1,m[x][w]==null?63:m[x][w]?84:70);break;case"B":_e.write_shift(8,m[x][w]||0,"f");break;case"N":var Pe="0";for(typeof m[x][w]=="number"&&(Pe=m[x][w].toFixed(V[w]||0)),A=0;A<Y[w]-Pe.length;++A)_e.write_shift(1,32);_e.write_shift(1,Pe,"sbcs");break;case"D":m[x][w]?(_e.write_shift(4,("0000"+m[x][w].getFullYear()).slice(-4),"sbcs"),_e.write_shift(2,("00"+(m[x][w].getMonth()+1)).slice(-2),"sbcs"),_e.write_shift(2,("00"+m[x][w].getDate()).slice(-2),"sbcs")):_e.write_shift(8,"00000000","sbcs");break;case"C":var be=String(m[x][w]!=null?m[x][w]:"").slice(0,Y[w]);for(_e.write_shift(1,be,"sbcs"),A=0;A<Y[w]-be.length;++A)_e.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),MA=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Wr(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(g,m){var y=t[m];return typeof y=="number"?L_(y):y},n=function(g,m,y){var x=m.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return x==59?g:L_(x)};t["|"]=254;function i(g,m){switch(m.type){case"base64":return s(ss(g),m);case"binary":return s(g,m);case"buffer":return s(Ft&&Buffer.isBuffer(g)?g.toString("binary"):cl(g),m);case"array":return s(Kl(g),m)}throw new Error("Unrecognized type "+m.type)}function s(g,m){var y=g.split(/[\n\r]+/),x=-1,w=-1,A=0,k=0,E=[],P=[],Y=null,V={},T=[],F=[],S=[],I=0,R;for(+m.codepage>=0&&Ys(+m.codepage);A!==y.length;++A){I=0;var D=y[A].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),N=D.replace(/;;/g,"\0").split(";").map(function(q){return q.replace(/\u0000/g,";")}),$e=N[0],_e;if(D.length>0)switch($e){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":N[1].charAt(0)=="P"&&P.push(D.slice(3).replace(/;;/g,";"));break;case"C":var Pe=!1,be=!1,Te=!1,ie=!1,Ce=-1,Be=-1;for(k=1;k<N.length;++k)switch(N[k].charAt(0)){case"A":break;case"X":w=parseInt(N[k].slice(1))-1,be=!0;break;case"Y":for(x=parseInt(N[k].slice(1))-1,be||(w=0),R=E.length;R<=x;++R)E[R]=[];break;case"K":_e=N[k].slice(1),_e.charAt(0)==='"'?_e=_e.slice(1,_e.length-1):_e==="TRUE"?_e=!0:_e==="FALSE"?_e=!1:isNaN(Zs(_e))?isNaN(gu(_e).getDate())||(_e=Er(_e)):(_e=Zs(_e),Y!==null&&Iu(Y)&&(_e=jp(_e))),Pe=!0;break;case"E":ie=!0;var W=ru(N[k].slice(1),{r:x,c:w});E[x][w]=[E[x][w],W];break;case"S":Te=!0,E[x][w]=[E[x][w],"S5S"];break;case"G":break;case"R":Ce=parseInt(N[k].slice(1))-1;break;case"C":Be=parseInt(N[k].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}if(Pe&&(E[x][w]&&E[x][w].length==2?E[x][w][0]=_e:E[x][w]=_e,Y=null),Te){if(ie)throw new Error("SYLK shared formula cannot have own formula");var ne=Ce>-1&&E[Ce][Be];if(!ne||!ne[1])throw new Error("SYLK shared formula cannot find base");E[x][w][1]=ek(ne[1],{r:x-Ce,c:w-Be})}break;case"F":var re=0;for(k=1;k<N.length;++k)switch(N[k].charAt(0)){case"X":w=parseInt(N[k].slice(1))-1,++re;break;case"Y":for(x=parseInt(N[k].slice(1))-1,R=E.length;R<=x;++R)E[R]=[];break;case"M":I=parseInt(N[k].slice(1))/20;break;case"F":break;case"G":break;case"P":Y=P[parseInt(N[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=N[k].slice(1).split(" "),R=parseInt(S[0],10);R<=parseInt(S[1],10);++R)I=parseInt(S[2],10),F[R-1]=I===0?{hidden:!0}:{wch:I},el(F[R-1]);break;case"C":w=parseInt(N[k].slice(1))-1,F[w]||(F[w]={});break;case"R":x=parseInt(N[k].slice(1))-1,T[x]||(T[x]={}),I>0?(T[x].hpt=I,T[x].hpx=xu(I)):I===0&&(T[x].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}re<1&&(Y=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}}return T.length>0&&(V["!rows"]=T),F.length>0&&(V["!cols"]=F),m&&m.sheetRows&&(E=E.slice(0,m.sheetRows)),[E,V]}function a(g,m){var y=i(g,m),x=y[0],w=y[1],A=Ru(x,m);return Wr(w).forEach(function(k){A[k]=w[k]}),A}function o(g,m){return ul(a(g,m),m)}function l(g,m,y,x){var w="C;Y"+(y+1)+";X"+(x+1)+";K";switch(g.t){case"n":w+=g.v||0,g.f&&!g.F&&(w+=";E"+av(g.f,{r:y,c:x}));break;case"b":w+=g.v?"TRUE":"FALSE";break;case"e":w+=g.w||g.v;break;case"d":w+='"'+(g.w||g.v)+'"';break;case"s":w+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function u(g,m){m.forEach(function(y,x){var w="F;W"+(x+1)+" "+(x+1)+" ";y.hidden?w+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=ff(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=hf(y.wpx)),typeof y.wch=="number"&&(w+=Math.round(y.wch))),w.charAt(w.length-1)!=" "&&g.push(w)})}function f(g,m){m.forEach(function(y,x){var w="F;";y.hidden?w+="M0;":y.hpt?w+="M"+20*y.hpt+";":y.hpx&&(w+="M"+20*pf(y.hpx)+";"),w.length>2&&g.push(w+"R"+(x+1))})}function p(g,m){var y=["ID;PWXL;N;E"],x=[],w=Xt(g["!ref"]),A,k=Array.isArray(g),E=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),g["!cols"]&&u(y,g["!cols"]),g["!rows"]&&f(y,g["!rows"]),y.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var P=w.s.r;P<=w.e.r;++P)for(var Y=w.s.c;Y<=w.e.c;++Y){var V=ut({r:P,c:Y});A=k?(g[P]||[])[Y]:g[V],!(!A||A.v==null&&(!A.f||A.F))&&x.push(l(A,g,P,Y))}return y.join(E)+E+x.join(E)+E+"E"+E}return{to_workbook:o,to_sheet:a,from_sheet:p}}(),LA=function(){function t(s,a){switch(a.type){case"base64":return e(ss(s),a);case"binary":return e(s,a);case"buffer":return e(Ft&&Buffer.isBuffer(s)?s.toString("binary"):cl(s),a);case"array":return e(Kl(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,u=-1,f=0,p=[];f!==o.length;++f){if(o[f].trim()==="BOT"){p[++l]=[],u=0;continue}if(!(l<0)){var g=o[f].trim().split(","),m=g[0],y=g[1];++f;for(var x=o[f]||"";(x.match(/["]/g)||[]).length&1&&f<o.length-1;)x+=`
`+o[++f];switch(x=x.trim(),+m){case-1:if(x==="BOT"){p[++l]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?p[l][u]=!0:x==="FALSE"?p[l][u]=!1:isNaN(Zs(y))?isNaN(gu(y).getDate())?p[l][u]=y:p[l][u]=Er(y):p[l][u]=Zs(y),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),p[l][u++]=x!==""?x:null;break}if(x==="EOD")break}}return a&&a.sheetRows&&(p=p.slice(0,a.sheetRows)),p}function r(s,a){return Ru(t(s,a),a)}function n(s,a){return ul(r(s,a),a)}var i=function(){var s=function(l,u,f,p,g){l.push(u),l.push(f+","+p),l.push('"'+g.replace(/"/g,'""')+'"')},a=function(l,u,f,p){l.push(u+","+f),l.push(u==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(l){var u=[],f=Xt(l["!ref"]),p,g=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,f.e.r-f.s.r+1,""),s(u,"TUPLES",0,f.e.c-f.s.c+1,""),s(u,"DATA",0,0,"");for(var m=f.s.r;m<=f.e.r;++m){a(u,-1,0,"BOT");for(var y=f.s.c;y<=f.e.c;++y){var x=ut({r:m,c:y});if(p=g?(l[m]||[])[y]:l[x],!p){a(u,1,0,"");continue}switch(p.t){case"n":var w=p.w;!w&&p.v!=null&&(w=p.v),w==null?p.f&&!p.F?a(u,1,0,"="+p.f):a(u,1,0,""):a(u,0,w,"V");break;case"b":a(u,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":a(u,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=Ds(p.z||lt[14],En(Er(p.v)))),a(u,0,p.w,"V");break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var A=`\r
`,k=u.join(A);return k}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),BA=function(){function t(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,g){for(var m=p.split(`
`),y=-1,x=-1,w=0,A=[];w!==m.length;++w){var k=m[w].trim().split(":");if(k[0]==="cell"){var E=Pr(k[1]);if(A.length<=E.r)for(y=A.length;y<=E.r;++y)A[y]||(A[y]=[]);switch(y=E.r,x=E.c,k[2]){case"t":A[y][x]=t(k[3]);break;case"v":A[y][x]=+k[3];break;case"vtf":var P=k[k.length-1];case"vtc":switch(k[3]){case"nl":A[y][x]=!!+k[4];break;default:A[y][x]=+k[4];break}k[2]=="vtf"&&(A[y][x]=[A[y][x],P])}}}return g&&g.sheetRows&&(A=A.slice(0,g.sheetRows)),A}function n(p,g){return Ru(r(p,g),g)}function i(p,g){return ul(n(p,g),g)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(p){if(!p||!p["!ref"])return"";for(var g=[],m=[],y,x="",w=Gi(p["!ref"]),A=Array.isArray(p),k=w.s.r;k<=w.e.r;++k)for(var E=w.s.c;E<=w.e.c;++E)if(x=ut({r:k,c:E}),y=A?(p[k]||[])[E]:p[x],!(!y||y.v==null||y.t==="z")){switch(m=["cell",x,"t"],y.t){case"s":case"str":m.push(e(y.v));break;case"n":y.f?(m[2]="vtf",m[3]="n",m[4]=y.v,m[5]=e(y.f)):(m[2]="v",m[3]=y.v);break;case"b":m[2]="vt"+(y.f?"f":"c"),m[3]="nl",m[4]=y.v?"1":"0",m[5]=e(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var P=En(Er(y.v));m[2]="vtc",m[3]="nd",m[4]=""+P,m[5]=y.w||Ds(y.z||lt[14],P);break;case"e":continue}g.push(m.join(":"))}return g.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function f(p){return[s,a,o,a,u(p),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),mu=function(){function t(f,p,g,m,y){y.raw?p[g][m]=f:f===""||(f==="TRUE"?p[g][m]=!0:f==="FALSE"?p[g][m]=!1:isNaN(Zs(f))?isNaN(gu(f).getDate())?p[g][m]=f:p[g][m]=Er(f):p[g][m]=Zs(f))}function e(f,p){var g=p||{},m=[];if(!f||f.length===0)return m;for(var y=f.split(/[\r\n]/),x=y.length-1;x>=0&&y[x].length===0;)--x;for(var w=10,A=0,k=0;k<=x;++k)A=y[k].indexOf(" "),A==-1?A=y[k].length:A++,w=Math.max(w,A);for(k=0;k<=x;++k){m[k]=[];var E=0;for(t(y[k].slice(0,w).trim(),m,k,E,g),E=1;E<=(y[k].length-w)/10+1;++E)t(y[k].slice(w+(E-1)*10,w+E*10).trim(),m,k,E,g)}return g.sheetRows&&(m=m.slice(0,g.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var p={},g=!1,m=0,y=0;m<f.length;++m)(y=f.charCodeAt(m))==34?g=!g:!g&&y in r&&(p[y]=(p[y]||0)+1);y=[];for(m in p)Object.prototype.hasOwnProperty.call(p,m)&&y.push([p[m],m]);if(!y.length){p=n;for(m in p)Object.prototype.hasOwnProperty.call(p,m)&&y.push([p[m],m])}return y.sort(function(x,w){return x[0]-w[0]||n[x[1]]-n[w[1]]}),r[y.pop()[1]]||44}function s(f,p){var g=p||{},m="",y=g.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(m=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(m=f.charAt(4),f=f.slice(6)):m=i(f.slice(0,1024)):g&&g.FS?m=g.FS:m=i(f.slice(0,1024));var w=0,A=0,k=0,E=0,P=0,Y=m.charCodeAt(0),V=!1,T=0,F=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var S=g.dateNF!=null?ZN(g.dateNF):null;function I(){var R=f.slice(E,P),D={};if(R.charAt(0)=='"'&&R.charAt(R.length-1)=='"'&&(R=R.slice(1,-1).replace(/""/g,'"')),R.length===0)D.t="z";else if(g.raw)D.t="s",D.v=R;else if(R.trim().length===0)D.t="s",D.v=R;else if(R.charCodeAt(0)==61)R.charCodeAt(1)==34&&R.charCodeAt(R.length-1)==34?(D.t="s",D.v=R.slice(2,-1).replace(/""/g,'"')):F8(R)?(D.t="n",D.f=R.slice(1)):(D.t="s",D.v=R);else if(R=="TRUE")D.t="b",D.v=!0;else if(R=="FALSE")D.t="b",D.v=!1;else if(!isNaN(k=Zs(R)))D.t="n",g.cellText!==!1&&(D.w=R),D.v=k;else if(!isNaN(gu(R).getDate())||S&&R.match(S)){D.z=g.dateNF||lt[14];var N=0;S&&R.match(S)&&(R=eR(R,g.dateNF,R.match(S)||[]),N=1),g.cellDates?(D.t="d",D.v=Er(R,N)):(D.t="n",D.v=En(Er(R,N))),g.cellText!==!1&&(D.w=Ds(D.z,D.v instanceof Date?En(D.v):D.v)),g.cellNF||delete D.z}else D.t="s",D.v=R;if(D.t=="z"||(g.dense?(y[w]||(y[w]=[]),y[w][A]=D):y[ut({c:A,r:w})]=D),E=P+1,F=f.charCodeAt(E),x.e.c<A&&(x.e.c=A),x.e.r<w&&(x.e.r=w),T==Y)++A;else if(A=0,++w,g.sheetRows&&g.sheetRows<=w)return!0}e:for(;P<f.length;++P)switch(T=f.charCodeAt(P)){case 34:F===34&&(V=!V);break;case Y:case 10:case 13:if(!V&&I())break e;break}return P-E>0&&I(),y["!ref"]=wt(x),y}function a(f,p){return!(p&&p.PRN)||p.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,p):Ru(e(f,p),p)}function o(f,p){var g="",m=p.type=="string"?[0,0,0,0]:pv(f,p);switch(p.type){case"base64":g=ss(f);break;case"binary":g=f;break;case"buffer":p.codepage==65001?g=f.toString("utf8"):p.codepage&&typeof nf<"u"||(g=Ft&&Buffer.isBuffer(f)?f.toString("binary"):cl(f));break;case"array":g=Kl(f);break;case"string":g=f;break;default:throw new Error("Unrecognized type "+p.type)}return m[0]==239&&m[1]==187&&m[2]==191?g=ur(g.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?g=ur(g):p.type=="binary"&&typeof nf<"u",g.slice(0,19)=="socialcalc:version:"?BA.to_sheet(p.type=="string"?g:ur(g),p):a(g,p)}function l(f,p){return ul(o(f,p),p)}function u(f){for(var p=[],g=Xt(f["!ref"]),m,y=Array.isArray(f),x=g.s.r;x<=g.e.r;++x){for(var w=[],A=g.s.c;A<=g.e.c;++A){var k=ut({r:x,c:A});if(m=y?(f[x]||[])[A]:f[k],!m||m.v==null){w.push("          ");continue}for(var E=(m.w||(eo(m),m.w)||"").slice(0,10);E.length<10;)E+=" ";w.push(E+(A===0?" ":""))}p.push(w.join(""))}return p.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}();function p6(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=MA.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return mu.to_workbook(t,e)}}var Ll=function(){function t(W,ne,re){if(W){$n(W,W.l||0);for(var q=re.Enum||Ce;W.l<W.length;){var xe=W.read_shift(2),we=q[xe]||q[65535],je=W.read_shift(2),Ie=W.l+je,Ae=we.f&&we.f(W,je,re);if(W.l=Ie,ne(Ae,we,xe))return}}}function e(W,ne){switch(ne.type){case"base64":return r(Zi(ss(W)),ne);case"binary":return r(Zi(W),ne);case"buffer":case"array":return r(W,ne)}throw"Unsupported type "+ne.type}function r(W,ne){if(!W)return W;var re=ne||{},q=re.dense?[]:{},xe="Sheet1",we="",je=0,Ie={},Ae=[],nt=[],J={s:{r:0,c:0},e:{r:0,c:0}},Mt=re.sheetRows||0;if(W[2]==0&&(W[3]==8||W[3]==9)&&W.length>=16&&W[14]==5&&W[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(W[2]==2)re.Enum=Ce,t(W,function(Ge,or,Ln){switch(Ln){case 0:re.vers=Ge,Ge>=4096&&(re.qpro=!0);break;case 6:J=Ge;break;case 204:Ge&&(we=Ge);break;case 222:we=Ge;break;case 15:case 51:re.qpro||(Ge[1].v=Ge[1].v.slice(1));case 13:case 14:case 16:Ln==14&&(Ge[2]&112)==112&&(Ge[2]&15)>1&&(Ge[2]&15)<15&&(Ge[1].z=re.dateNF||lt[14],re.cellDates&&(Ge[1].t="d",Ge[1].v=jp(Ge[1].v))),re.qpro&&Ge[3]>je&&(q["!ref"]=wt(J),Ie[xe]=q,Ae.push(xe),q=re.dense?[]:{},J={s:{r:0,c:0},e:{r:0,c:0}},je=Ge[3],xe=we||"Sheet"+(je+1),we="");var sn=re.dense?(q[Ge[0].r]||[])[Ge[0].c]:q[ut(Ge[0])];if(sn){sn.t=Ge[1].t,sn.v=Ge[1].v,Ge[1].z!=null&&(sn.z=Ge[1].z),Ge[1].f!=null&&(sn.f=Ge[1].f);break}re.dense?(q[Ge[0].r]||(q[Ge[0].r]=[]),q[Ge[0].r][Ge[0].c]=Ge[1]):q[ut(Ge[0])]=Ge[1];break}},re);else if(W[2]==26||W[2]==14)re.Enum=Be,W[2]==14&&(re.qpro=!0,W.l=0),t(W,function(Ge,or,Ln){switch(Ln){case 204:xe=Ge;break;case 22:Ge[1].v=Ge[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ge[3]>je&&(q["!ref"]=wt(J),Ie[xe]=q,Ae.push(xe),q=re.dense?[]:{},J={s:{r:0,c:0},e:{r:0,c:0}},je=Ge[3],xe="Sheet"+(je+1)),Mt>0&&Ge[0].r>=Mt)break;re.dense?(q[Ge[0].r]||(q[Ge[0].r]=[]),q[Ge[0].r][Ge[0].c]=Ge[1]):q[ut(Ge[0])]=Ge[1],J.e.c<Ge[0].c&&(J.e.c=Ge[0].c),J.e.r<Ge[0].r&&(J.e.r=Ge[0].r);break;case 27:Ge[14e3]&&(nt[Ge[14e3][0]]=Ge[14e3][1]);break;case 1537:nt[Ge[0]]=Ge[1],Ge[0]==je&&(xe=Ge[1]);break}},re);else throw new Error("Unrecognized LOTUS BOF "+W[2]);if(q["!ref"]=wt(J),Ie[we||xe]=q,Ae.push(we||xe),!nt.length)return{SheetNames:Ae,Sheets:Ie};for(var Et={},Rt=[],mt=0;mt<nt.length;++mt)Ie[Ae[mt]]?(Rt.push(nt[mt]||Ae[mt]),Et[nt[mt]]=Ie[nt[mt]]||Ie[Ae[mt]]):(Rt.push(nt[mt]),Et[nt[mt]]={"!ref":"A1"});return{SheetNames:Rt,Sheets:Et}}function n(W,ne){var re=ne||{};if(+re.codepage>=0&&Ys(+re.codepage),re.type=="string")throw new Error("Cannot write WK1 to JS string");var q=$i(),xe=Xt(W["!ref"]),we=Array.isArray(W),je=[];We(q,0,s(1030)),We(q,6,l(xe));for(var Ie=Math.min(xe.e.r,8191),Ae=xe.s.r;Ae<=Ie;++Ae)for(var nt=Yr(Ae),J=xe.s.c;J<=xe.e.c;++J){Ae===xe.s.r&&(je[J]=Dr(J));var Mt=je[J]+nt,Et=we?(W[Ae]||[])[J]:W[Mt];if(!(!Et||Et.t=="z"))if(Et.t=="n")(Et.v|0)==Et.v&&Et.v>=-32768&&Et.v<=32767?We(q,13,m(Ae,J,Et.v)):We(q,14,x(Ae,J,Et.v));else{var Rt=eo(Et);We(q,15,p(Ae,J,Rt.slice(0,239)))}}return We(q,1),q.end()}function i(W,ne){var re=ne||{};if(+re.codepage>=0&&Ys(+re.codepage),re.type=="string")throw new Error("Cannot write WK3 to JS string");var q=$i();We(q,0,a(W));for(var xe=0,we=0;xe<W.SheetNames.length;++xe)(W.Sheets[W.SheetNames[xe]]||{})["!ref"]&&We(q,27,ie(W.SheetNames[xe],we++));var je=0;for(xe=0;xe<W.SheetNames.length;++xe){var Ie=W.Sheets[W.SheetNames[xe]];if(!(!Ie||!Ie["!ref"])){for(var Ae=Xt(Ie["!ref"]),nt=Array.isArray(Ie),J=[],Mt=Math.min(Ae.e.r,8191),Et=Ae.s.r;Et<=Mt;++Et)for(var Rt=Yr(Et),mt=Ae.s.c;mt<=Ae.e.c;++mt){Et===Ae.s.r&&(J[mt]=Dr(mt));var Ge=J[mt]+Rt,or=nt?(Ie[Et]||[])[mt]:Ie[Ge];if(!(!or||or.t=="z"))if(or.t=="n")We(q,23,I(Et,mt,je,or.v));else{var Ln=eo(or);We(q,22,T(Et,mt,je,Ln.slice(0,239)))}}++je}}return We(q,1),q.end()}function s(W){var ne=ye(2);return ne.write_shift(2,W),ne}function a(W){var ne=ye(26);ne.write_shift(2,4096),ne.write_shift(2,4),ne.write_shift(4,0);for(var re=0,q=0,xe=0,we=0;we<W.SheetNames.length;++we){var je=W.SheetNames[we],Ie=W.Sheets[je];if(!(!Ie||!Ie["!ref"])){++xe;var Ae=Gi(Ie["!ref"]);re<Ae.e.r&&(re=Ae.e.r),q<Ae.e.c&&(q=Ae.e.c)}}return re>8191&&(re=8191),ne.write_shift(2,re),ne.write_shift(1,xe),ne.write_shift(1,q),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(1,1),ne.write_shift(1,2),ne.write_shift(4,0),ne.write_shift(4,0),ne}function o(W,ne,re){var q={s:{c:0,r:0},e:{c:0,r:0}};return ne==8&&re.qpro?(q.s.c=W.read_shift(1),W.l++,q.s.r=W.read_shift(2),q.e.c=W.read_shift(1),W.l++,q.e.r=W.read_shift(2),q):(q.s.c=W.read_shift(2),q.s.r=W.read_shift(2),ne==12&&re.qpro&&(W.l+=2),q.e.c=W.read_shift(2),q.e.r=W.read_shift(2),ne==12&&re.qpro&&(W.l+=2),q.s.c==65535&&(q.s.c=q.e.c=q.s.r=q.e.r=0),q)}function l(W){var ne=ye(8);return ne.write_shift(2,W.s.c),ne.write_shift(2,W.s.r),ne.write_shift(2,W.e.c),ne.write_shift(2,W.e.r),ne}function u(W,ne,re){var q=[{c:0,r:0},{t:"n",v:0},0,0];return re.qpro&&re.vers!=20768?(q[0].c=W.read_shift(1),q[3]=W.read_shift(1),q[0].r=W.read_shift(2),W.l+=2):(q[2]=W.read_shift(1),q[0].c=W.read_shift(2),q[0].r=W.read_shift(2)),q}function f(W,ne,re){var q=W.l+ne,xe=u(W,ne,re);if(xe[1].t="s",re.vers==20768){W.l++;var we=W.read_shift(1);return xe[1].v=W.read_shift(we,"utf8"),xe}return re.qpro&&W.l++,xe[1].v=W.read_shift(q-W.l,"cstr"),xe}function p(W,ne,re){var q=ye(7+re.length);q.write_shift(1,255),q.write_shift(2,ne),q.write_shift(2,W),q.write_shift(1,39);for(var xe=0;xe<q.length;++xe){var we=re.charCodeAt(xe);q.write_shift(1,we>=128?95:we)}return q.write_shift(1,0),q}function g(W,ne,re){var q=u(W,ne,re);return q[1].v=W.read_shift(2,"i"),q}function m(W,ne,re){var q=ye(7);return q.write_shift(1,255),q.write_shift(2,ne),q.write_shift(2,W),q.write_shift(2,re,"i"),q}function y(W,ne,re){var q=u(W,ne,re);return q[1].v=W.read_shift(8,"f"),q}function x(W,ne,re){var q=ye(13);return q.write_shift(1,255),q.write_shift(2,ne),q.write_shift(2,W),q.write_shift(8,re,"f"),q}function w(W,ne,re){var q=W.l+ne,xe=u(W,ne,re);if(xe[1].v=W.read_shift(8,"f"),re.qpro)W.l=q;else{var we=W.read_shift(2);P(W.slice(W.l,W.l+we),xe),W.l+=we}return xe}function A(W,ne,re){var q=ne&32768;return ne&=-32769,ne=(q?W:0)+(ne>=8192?ne-16384:ne),(q?"":"$")+(re?Dr(ne):Yr(ne))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function P(W,ne){$n(W,0);for(var re=[],q=0,xe="",we="",je="",Ie="";W.l<W.length;){var Ae=W[W.l++];switch(Ae){case 0:re.push(W.read_shift(8,"f"));break;case 1:we=A(ne[0].c,W.read_shift(2),!0),xe=A(ne[0].r,W.read_shift(2),!1),re.push(we+xe);break;case 2:{var nt=A(ne[0].c,W.read_shift(2),!0),J=A(ne[0].r,W.read_shift(2),!1);we=A(ne[0].c,W.read_shift(2),!0),xe=A(ne[0].r,W.read_shift(2),!1),re.push(nt+J+":"+we+xe)}break;case 3:if(W.l<W.length){console.error("WK1 premature formula end");return}break;case 4:re.push("("+re.pop()+")");break;case 5:re.push(W.read_shift(2));break;case 6:{for(var Mt="";Ae=W[W.l++];)Mt+=String.fromCharCode(Ae);re.push('"'+Mt.replace(/"/g,'""')+'"')}break;case 8:re.push("-"+re.pop());break;case 23:re.push("+"+re.pop());break;case 22:re.push("NOT("+re.pop()+")");break;case 20:case 21:Ie=re.pop(),je=re.pop(),re.push(["AND","OR"][Ae-20]+"("+je+","+Ie+")");break;default:if(Ae<32&&E[Ae])Ie=re.pop(),je=re.pop(),re.push(je+E[Ae]+Ie);else if(k[Ae]){if(q=k[Ae][1],q==69&&(q=W[W.l++]),q>re.length){console.error("WK1 bad formula parse 0x"+Ae.toString(16)+":|"+re.join("|")+"|");return}var Et=re.slice(-q);re.length-=q,re.push(k[Ae][0]+"("+Et.join(",")+")")}else return Ae<=7?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=24?console.error("WK1 unsupported op "+Ae.toString(16)):Ae<=30?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=115?console.error("WK1 unsupported function opcode "+Ae.toString(16)):console.error("WK1 unrecognized opcode "+Ae.toString(16))}}re.length==1?ne[1].f=""+re[0]:console.error("WK1 bad formula parse |"+re.join("|")+"|")}function Y(W){var ne=[{c:0,r:0},{t:"n",v:0},0];return ne[0].r=W.read_shift(2),ne[3]=W[W.l++],ne[0].c=W[W.l++],ne}function V(W,ne){var re=Y(W);return re[1].t="s",re[1].v=W.read_shift(ne-4,"cstr"),re}function T(W,ne,re,q){var xe=ye(6+q.length);xe.write_shift(2,W),xe.write_shift(1,re),xe.write_shift(1,ne),xe.write_shift(1,39);for(var we=0;we<q.length;++we){var je=q.charCodeAt(we);xe.write_shift(1,je>=128?95:je)}return xe.write_shift(1,0),xe}function F(W,ne){var re=Y(W);re[1].v=W.read_shift(2);var q=re[1].v>>1;if(re[1].v&1)switch(q&7){case 0:q=(q>>3)*5e3;break;case 1:q=(q>>3)*500;break;case 2:q=(q>>3)/20;break;case 3:q=(q>>3)/200;break;case 4:q=(q>>3)/2e3;break;case 5:q=(q>>3)/2e4;break;case 6:q=(q>>3)/16;break;case 7:q=(q>>3)/64;break}return re[1].v=q,re}function S(W,ne){var re=Y(W),q=W.read_shift(4),xe=W.read_shift(4),we=W.read_shift(2);if(we==65535)return q===0&&xe===3221225472?(re[1].t="e",re[1].v=15):q===0&&xe===3489660928?(re[1].t="e",re[1].v=42):re[1].v=0,re;var je=we&32768;return we=(we&32767)-16446,re[1].v=(1-je*2)*(xe*Math.pow(2,we+32)+q*Math.pow(2,we)),re}function I(W,ne,re,q){var xe=ye(14);if(xe.write_shift(2,W),xe.write_shift(1,re),xe.write_shift(1,ne),q==0)return xe.write_shift(4,0),xe.write_shift(4,0),xe.write_shift(2,65535),xe;var we=0,je=0,Ie=0,Ae=0;return q<0&&(we=1,q=-q),je=Math.log2(q)|0,q/=Math.pow(2,je-31),Ae=q>>>0,Ae&2147483648||(q/=2,++je,Ae=q>>>0),q-=Ae,Ae|=2147483648,Ae>>>=0,q*=Math.pow(2,32),Ie=q>>>0,xe.write_shift(4,Ie),xe.write_shift(4,Ae),je+=16383+(we?32768:0),xe.write_shift(2,je),xe}function R(W,ne){var re=S(W);return W.l+=ne-14,re}function D(W,ne){var re=Y(W),q=W.read_shift(4);return re[1].v=q>>6,re}function N(W,ne){var re=Y(W),q=W.read_shift(8,"f");return re[1].v=q,re}function $e(W,ne){var re=N(W);return W.l+=ne-10,re}function _e(W,ne){return W[W.l+ne-1]==0?W.read_shift(ne,"cstr"):""}function Pe(W,ne){var re=W[W.l++];re>ne-1&&(re=ne-1);for(var q="";q.length<re;)q+=String.fromCharCode(W[W.l++]);return q}function be(W,ne,re){if(!(!re.qpro||ne<21)){var q=W.read_shift(1);W.l+=17,W.l+=1,W.l+=2;var xe=W.read_shift(ne-21,"cstr");return[q,xe]}}function Te(W,ne){for(var re={},q=W.l+ne;W.l<q;){var xe=W.read_shift(2);if(xe==14e3){for(re[xe]=[0,""],re[xe][0]=W.read_shift(2);W[W.l];)re[xe][1]+=String.fromCharCode(W[W.l]),W.l++;W.l++}}return re}function ie(W,ne){var re=ye(5+W.length);re.write_shift(2,14e3),re.write_shift(2,ne);for(var q=0;q<W.length;++q){var xe=W.charCodeAt(q);re[re.l++]=xe>127?95:xe}return re[re.l++]=0,re}var Ce={0:{n:"BOF",f:rn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:y},15:{n:"LABEL",f},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:_e},222:{n:"SHEETNAMELP",f:Pe},65535:{n:""}},Be={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:V},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:R},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Te},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:N},40:{n:"FORMULA28",f:$e},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:_e},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:be},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function g6(t){var e={},r=t.match(gi),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=dt(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=N1[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var m6=function(){var t=of("t"),e=of("rPr");function r(s){var a=s.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:Yt(a[1])},l=s.match(e);return l&&(o.s=g6(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),x6=function(){var e=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),v6=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,y6=/<(?:\w+:)?r>/,_6=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function tv(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Yt(ur(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=ur(t),r&&(n.h=V1(n.t))):t.match(y6)&&(n.r=ur(t),n.t=Yt(ur((t.replace(_6,"").match(v6)||[]).join("").replace(gi,""))),r&&(n.h=x6(m6(n.r)))),n):{t:""}}var E6=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,w6=/<(?:\w+:)?(?:si|sstItem)>/g,S6=/<\/(?:\w+:)?(?:si|sstItem)>/;function T6(t,e){var r=[],n="";if(!t)return r;var i=t.match(E6);if(i){n=i[2].replace(w6,"").split(S6);for(var s=0;s!=n.length;++s){var a=tv(n[s].trim(),e);a!=null&&(r[r.length]=a)}i=dt(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var A6=/^\s|\s$|[\t\n\r]/;function jA(t,e){if(!e.bookSST)return"";var r=[Xr];r[r.length]=ze("sst",null,{xmlns:sc[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(A6)&&(s+=' xml:space="preserve"'),s+=">"+ir(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function k6(t){return[t.read_shift(4),t.read_shift(4)]}function C6(t,e){var r=[],n=!1;return lo(t,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function F6(t,e){return e||(e=ye(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var b6=jR;function I6(t){var e=$i();ke(e,159,F6(t));for(var r=0;r<t.length;++r)ke(e,19,b6(t[r]));return ke(e,160),e.end()}function UA(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Ya(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function N6(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Ya(t,4),e.U=Ya(t,4),e.W=Ya(t,4),e}function R6(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function D6(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(R6(t));return e}function P6(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function O6(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Ya(t,4),e.U=Ya(t,4),e.W=Ya(t,4),e}function M6(t){var e=O6(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function VA(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function zA(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function L6(t){var e=Ya(t);switch(e.Minor){case 2:return[e.Minor,B6(t)];case 3:return[e.Minor,j6()];case 4:return[e.Minor,U6(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function B6(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=VA(t,r),i=zA(t,t.length-t.l);return{t:"Std",h:n,v:i}}function j6(){throw new Error("File is password-protected: ECMA-376 Extensible")}function U6(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(gi,function(s){var a=dt(s);switch(Ta(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function V6(t,e){var r={},n=r.EncryptionVersionInfo=Ya(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=VA(t,i),e-=i,r.EncryptionVerifier=zA(t,e),r}function z6(t){var e={},r=e.EncryptionVersionInfo=Ya(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function rv(t){var e=0,r,n=UA(t),i=n.length+1,s,a,o,l,u;for(r=Zo(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=e&16384?1:0,l=e<<1&32767,u=o|l,e=u^a;return e^52811}var WA=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],l=104,u=a.length-1;u>=0;--u)for(var f=a[u],p=0;p!=7;++p)f&64&&(o^=r[l]),f*=2,--l;return o};return function(a){for(var o=UA(a),l=s(o),u=o.length,f=Zo(16),p=0;p!=16;++p)f[p]=0;var g,m,y;for((u&1)===1&&(g=l>>8,f[u]=i(t[0],g),--u,g=l&255,m=o[o.length-1],f[u]=i(m,g));u>0;)--u,g=l>>8,f[u]=i(o[u],g),--u,g=l&255,f[u]=i(o[u],g);for(u=15,y=15-o.length;y>0;)g=l>>8,f[u]=i(t[y],g),--u,--y,g=l&255,f[u]=i(o[u],g),--u,--y;return f}}(),W6=function(t,e,r,n,i){i||(i=e),n||(n=WA(t));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},H6=function(t){var e=0,r=WA(t);return function(n){var i=W6("",n,e,r);return e=i[1],i[0]}};function $6(t,e,r,n){var i={key:rn(t),verificationBytes:rn(t)};return r.password&&(i.verifier=rv(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=H6(r.password)),i}function G6(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=z6(t):n.Data=V6(t,e),n}function K6(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?G6(t,e-2,n):$6(t,r.biff>=8?e:e-2,r,n),n}var HA=function(){function t(i,s){switch(s.type){case"base64":return e(ss(i),s);case"binary":return e(i,s);case"buffer":return e(Ft&&Buffer.isBuffer(i)?i.toString("binary"):cl(i),s);case"array":return e(Kl(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,p){Array.isArray(o)&&(o[p]=[]);for(var g=/\\\w+\b/g,m=0,y,x=-1;y=g.exec(f);){switch(y[0]){case"\\cell":var w=f.slice(m,g.lastIndex-y[0].length);if(w[0]==" "&&(w=w.slice(1)),++x,w.length){var A={v:w,t:"s"};Array.isArray(o)?o[p][x]=A:o[ut({r:p,c:x})]=A}break}m=g.lastIndex}x>u.e.c&&(u.e.c=x)}),o["!ref"]=wt(u),o}function r(i,s){return ul(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=Xt(i["!ref"]),o,l=Array.isArray(i),u=a.s.r;u<=a.e.r;++u){s.push("\\trowd\\trautofit1");for(var f=a.s.c;f<=a.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=a.s.c;f<=a.e.c;++f){var p=ut({r:u,c:f});o=l?(i[u]||[])[f]:i[p],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(eo(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function Y6(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function df(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function X6(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),a=i-s;if(a===0)return[0,0,e];var o=0,l=0,u=i+s;switch(l=a/(u>1?2-u:u),i){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,l,u/2]}function q6(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=i*o,a[0]+=i,a[1]+=l;break;case 1:l=i*(2-o),a[0]+=l,a[1]+=i;break;case 2:l=i*(o-2),a[1]+=i,a[2]+=l;break;case 3:l=i*(4-o),a[1]+=l,a[2]+=i;break;case 4:l=i*(o-4),a[2]+=i,a[0]+=l;break;case 5:l=i*(6-o),a[2]+=l,a[0]+=i;break}for(var u=0;u!=3;++u)a[u]=Math.round(a[u]*255);return a}function Zh(t,e){if(e===0)return t;var r=X6(Y6(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),df(q6(r))}var $A=6,Q6=15,J6=1,li=$A;function ff(t){return Math.floor((t+Math.round(128/li)/256)*li)}function hf(t){return Math.floor((t-5)/li*100+.5)/100}function ep(t){return Math.round((t*li+5)/li*256)/256}function Lg(t){return ep(hf(ff(t)))}function nv(t){var e=Math.abs(t-Lg(t)),r=li;if(e>.005)for(li=J6;li<Q6;++li)Math.abs(t-Lg(t))<=e&&(e=Math.abs(t-Lg(t)),r=li);li=r}function el(t){t.width?(t.wpx=ff(t.width),t.wch=hf(t.wpx),t.MDW=li):t.wpx?(t.wch=hf(t.wpx),t.width=ep(t.wch),t.MDW=li):typeof t.wch=="number"&&(t.width=ep(t.wch),t.wpx=ff(t.width),t.MDW=li),t.customWidth&&delete t.customWidth}var Z6=96,GA=Z6;function pf(t){return t*96/GA}function xu(t){return t*GA/96}var eP={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function tP(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(gi)||[]).forEach(function(a){var o=dt(a);switch(Ta(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=yr(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=yr(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function rP(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(gi)||[]).forEach(function(a){var o=dt(a);switch(Ta(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function nP(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(gi)||[]).forEach(function(a){var o=dt(a);switch(Ta(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=ur(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?yr(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?yr(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?yr(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?yr(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?yr(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?yr(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?yr(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=N1[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=yr(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=Ol[i.color.index];i.color.index==81&&(l=Ol[1]),l||(l=Ol[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=Zh(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function iP(t,e,r){e.NumberFmt=[];for(var n=Wr(lt),i=0;i<n.length;++i)e.NumberFmt[n[i]]=lt[n[i]];var s=t[0].match(gi);if(s)for(i=0;i<s.length;++i){var a=dt(s[i]);switch(Ta(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Yt(ur(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}Ka(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function sP(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=ze("numFmt",null,{numFmtId:n,formatCode:ir(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=ze("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var P0=["numFmtId","fillId","fontId","borderId","xfId"],O0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function aP(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(gi)||[]).forEach(function(s){var a=dt(s),o=0;switch(Ta(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<P0.length;++o)n[P0[o]]&&(n[P0[o]]=parseInt(n[P0[o]],10));for(o=0;o<O0.length;++o)n[O0[o]]&&(n[O0[o]]=yr(n[O0[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=yr(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function oP(t){var e=[];return e[e.length]=ze("cellXfs",null),t.forEach(function(r){e[e.length]=ze("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=ze("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var lP=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,u){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=o.match(e))&&iP(p,f,u),(p=o.match(i))&&nP(p,f,l,u),(p=o.match(n))&&rP(p,f,l,u),(p=o.match(s))&&tP(p,f,l,u),(p=o.match(r))&&aP(p,f,u),f}}();function KA(t,e){var r=[Xr,ze("styleSheet",null,{xmlns:sc[0],"xmlns:vt":xn.vt})],n;return t.SSF&&(n=sP(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=oP(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function cP(t,e){var r=t.read_shift(2),n=di(t);return[r,n]}function uP(t,e,r){r||(r=ye(6+4*e.length)),r.write_shift(2,t),On(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function dP(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=GR(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=$R(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=di(t),n}function fP(t,e){e||(e=ye(25+4*32)),e.write_shift(2,t.sz*20),KR(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),qh(t.color,e);var n=0;return n=2,e.write_shift(1,n),On(t.name,e),e.length>e.l?e.slice(0,e.l):e}var hP=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Bg,pP=hi;function C2(t,e){e||(e=ye(4*3+8*7+16*1)),Bg||(Bg=Lp(hP));var r=Bg[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(qh({auto:1},e),qh({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function gP(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function YA(t,e,r){r||(r=ye(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function rd(t,e){return e||(e=ye(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var mP=hi;function xP(t,e){return e||(e=ye(51)),e.write_shift(1,0),rd(null,e),rd(null,e),rd(null,e),rd(null,e),rd(null,e),e.length>e.l?e.slice(0,e.l):e}function vP(t,e){return e||(e=ye(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Xh(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function yP(t,e,r){var n=ye(2052);return n.write_shift(4,t),Xh(e,n),Xh(r,n),n.length>n.l?n.slice(0,n.l):n}function _P(t,e,r){var n={};n.NumberFmt=[];for(var i in lt)n.NumberFmt[i]=lt[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return lo(t,function(l,u,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],Ka(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=Zh(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(f),a=!0;break;case 38:s.pop(),a=!1;break;default:if(u.T>0)s.push(f);else if(u.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function EP(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(ke(t,615,ea(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&ke(t,44,uP(i,e[i]))}),ke(t,616))}}function wP(t){var e=1;ke(t,611,ea(e)),ke(t,43,fP({sz:12,color:{theme:1},name:"Calibri",family:2})),ke(t,612)}function SP(t){var e=2;ke(t,603,ea(e)),ke(t,45,C2({patternType:"none"})),ke(t,45,C2({patternType:"gray125"})),ke(t,604)}function TP(t){var e=1;ke(t,613,ea(e)),ke(t,46,xP()),ke(t,614)}function AP(t){var e=1;ke(t,626,ea(e)),ke(t,47,YA({numFmtId:0},65535)),ke(t,627)}function kP(t,e){ke(t,617,ea(e.length)),e.forEach(function(r){ke(t,47,YA(r,0))}),ke(t,618)}function CP(t){var e=1;ke(t,619,ea(e)),ke(t,48,vP({xfId:0,name:"Normal"})),ke(t,620)}function FP(t){var e=0;ke(t,505,ea(e)),ke(t,506)}function bP(t){var e=0;ke(t,508,yP(e,"TableStyleMedium9","PivotStyleMedium4")),ke(t,509)}function IP(t,e){var r=$i();return ke(r,278),EP(r,t.SSF),wP(r),SP(r),TP(r),AP(r),kP(r,e.cellXfs),CP(r),FP(r),bP(r),ke(r,279),r.end()}var NP=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function RP(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(gi)||[]).forEach(function(i){var s=dt(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[NP.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function DP(){}function PP(){}var OP=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,MP=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,LP=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function BP(t,e,r){e.themeElements={};var n;[["clrScheme",OP,RP],["fontScheme",MP,DP],["fmtScheme",LP,PP]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var jP=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function XA(t,e){(!t||t.length===0)&&(t=iv());var r,n={};if(!(r=t.match(jP)))throw new Error("themeElements not found in theme");return BP(r[0],n,e),n.raw=t,n}function iv(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Xr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function UP(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var a;try{a=VT(s,{type:"array"})}catch{return}var o=es(a,"theme/theme/theme1.xml",!0);if(o)return XA(o,r)}}function VP(t){return t.read_shift(4)}function zP(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=WP(t,4);break;case 2:e.xclrValue=FA(t);break;case 3:e.xclrValue=VP(t);break;case 4:t.l+=4;break}return t.l+=8,e}function WP(t,e){return hi(t,e)}function HP(t,e){return hi(t,e)}function $P(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=zP(t);break;case 6:n[1]=HP(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function GP(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push($P(t,r-t.l));return{ixfe:n,ext:s}}function KP(t,e){e.forEach(function(r){switch(r[0]){}})}function YP(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:di(t)}}function XP(t){var e=ye(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),On(t.name,e),e.slice(0,e.l)}function qP(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function QP(t){var e=ye(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function JP(t,e){var r=ye(8+2*e.length);return r.write_shift(4,t),On(e,r),r.slice(0,r.l)}function ZP(t){return t.l+=4,t.read_shift(4)!=0}function e8(t,e){var r=ye(8);return r.write_shift(4,t),r.write_shift(4,1),r}function t8(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return lo(t,function(l,u,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(p){o==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):o==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(f),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!u.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function r8(){var t=$i();return ke(t,332),ke(t,334,ea(1)),ke(t,335,XP({name:"XLDAPR",version:12e4,flags:3496657072})),ke(t,336),ke(t,339,JP(1,"XLDAPR")),ke(t,52),ke(t,35,ea(514)),ke(t,4096,ea(0)),ke(t,4097,Ts(1)),ke(t,36),ke(t,53),ke(t,340),ke(t,337,e8(1)),ke(t,51,QP([[1,0]])),ke(t,338),ke(t,333),t.end()}function n8(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,a;return t.replace(gi,function(o){var l=dt(o);switch(Ta(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(a=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function qA(){var t=[Xr];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function i8(t){var e=[];if(!t)return e;var r=1;return(t.match(gi)||[]).forEach(function(n){var i=dt(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function s8(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=ut(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function a8(t,e,r){var n=[];return lo(t,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function o8(t,e,r,n){if(!t)return t;var i=n||{},s=!1;lo(t,function(o,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},i)}function l8(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Gc=1024;function QA(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[ze("xml",null,{"xmlns:v":Qi.v,"xmlns:o":Qi.o,"xmlns:x":Qi.x,"xmlns:mv":Qi.mv}).replace(/\/>/,">"),ze("o:shapelayout",ze("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),ze("v:shapetype",[ze("v:stroke",null,{joinstyle:"miter"}),ze("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Gc<t*1e3;)Gc+=1e3;return e.forEach(function(s){var a=Pr(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?ze("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=ze("v:fill",l,o),f={on:"t",obscured:"t"};++Gc,i=i.concat(["<v:shape"+lf({id:"_x0000_s"+Gc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,ze("v:shadow",null,f),ze("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Gn("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Gn("x:AutoFill","False"),Gn("x:Row",String(a.r)),Gn("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function F2(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(a){var o=Pr(a.ref);if(i?(t[o.r]||(t[o.r]=[]),s=t[o.r][o.c]):s=t[a.ref],!s){s={t:"z"},i?t[o.r][o.c]=s:t[a.ref]=s;var l=Xt(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var u=wt(l);u!==t["!ref"]&&(t["!ref"]=u)}s.c||(s.c=[]);var f={a:a.author,t:a.t,r:a.r,T:r};a.h&&(f.h=a.h);for(var p=s.c.length-1;p>=0;--p){if(!r&&s.c[p].T)return;r&&!s.c[p].T&&s.c.splice(p,1)}if(r&&n){for(p=0;p<n.length;++p)if(f.a==n[p].id){f.a=n[p].name||f.a;break}}s.c.push(f)})}function c8(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=dt(o[0]),u={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=Pr(l.ref);if(!(e.sheetRows&&e.sheetRows<=f.r)){var p=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!p&&!!p[1]&&tv(p[1])||{r:"",t:"",h:""};u.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),u.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(u.h=g.h),n.push(u)}}}}),n}function JA(t){var e=[Xr,ze("comments",null,{xmlns:sc[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=ir(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(ir(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Gn("t",ir(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(Gn("t",ir(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function u8(t,e){var r=[],n=!1,i={},s=0;return t.replace(gi,function(o,l){var u=dt(o);switch(Ta(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":i.t=t.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function d8(t,e,r){var n=[Xr,ze("ThreadedComments",null,{xmlns:xn.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(ze("threadedComment",Gn("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function f8(t,e){var r=[],n=!1;return t.replace(gi,function(s){var a=dt(s);switch(Ta(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function h8(t){var e=[Xr,ze("personList",null,{xmlns:xn.TCMNT,"xmlns:x":sc[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(ze("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function p8(t){var e={};e.iauthor=t.read_shift(4);var r=cc(t);return e.rfx=r.s,e.ref=ut(r.s),t.l+=16,e}function g8(t,e){return e==null&&(e=ye(36)),e.write_shift(4,t[1].iauthor),Du(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var m8=di;function x8(t){return On(t.slice(0,54))}function v8(t,e){var r=[],n=[],i={},s=!1;return lo(t,function(o,l,u){switch(u){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function y8(t){var e=$i(),r=[];return ke(e,628),ke(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),ke(e,632,x8(i.a)))})}),ke(e,631),ke(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Pr(n[0]),e:Pr(n[0])};ke(e,635,g8([s,i])),i.t&&i.t.length>0&&ke(e,637,VR(i)),ke(e,636),delete i.iauthor})}),ke(e,634),ke(e,629),e.end()}var _8="application/vnd.ms-office.vbaProject";function E8(t){var e=tt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");tt.utils.cfb_add(e,i,t.FileIndex[n].content)}}),tt.write(e)}function w8(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&tt.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var ZA=["xlsb","xlsm","xlam","biff8","xla"];function S8(){return{"!type":"dialog"}}function T8(){return{"!type":"dialog"}}function A8(){return{"!type":"macro"}}function k8(){return{"!type":"macro"}}var ru=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,f=a.length>0?parseInt(a,10)|0:0;return o?f+=e.c:--f,l?u+=e.r:--u,i+(o?"":"$")+Dr(f)+(l?"":"$")+Yr(u)}return function(i,s){return e=s,i.replace(t,r)}}(),sv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,av=function(){return function(e,r){return e.replace(sv,function(n,i,s,a,o,l){var u=G1(a)-(s?0:r.c),f=$1(l)-(o?0:r.r),p=f==0?"":o?f+1:"["+f+"]",g=u==0?"":s?u+1:"["+u+"]";return i+"R"+p+"C"+g})}}();function ek(t,e){return t.replace(sv,function(r,n,i,s,a,o){return n+(i=="$"?i+s:Dr(G1(s)+e.c))+(a=="$"?a+o:Yr($1(o)+e.r))})}function C8(t,e,r){var n=Gi(e),i=n.s,s=Pr(r),a={r:s.r-i.r,c:s.c-i.c};return ek(t,a)}function F8(t){return t.length!=1}function b2(t){return t.replace(/_xlfn\./g,"")}function Jr(t){t.l+=1}function tl(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function tk(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return rk(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=tl(t),o=tl(t);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function rk(t){var e=tl(t),r=tl(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function b8(t,e,r){if(r.biff<8)return rk(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=tl(t),a=tl(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function nk(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return I8(t);var n=t.read_shift(r&&r.biff==12?4:2),i=tl(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function I8(t){var e=tl(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function N8(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function R8(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return D8(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function D8(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function P8(t,e,r){var n=(t[t.l++]&96)>>5,i=tk(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function O8(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=tk(t,s,r);return[n,i,a]}function M8(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function L8(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function B8(t,e,r){var n=(t[t.l++]&96)>>5,i=b8(t,e-1,r);return[n,i]}function j8(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function I2(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function U8(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function V8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function z8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function W8(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function H8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function ik(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function $8(t){return t.read_shift(2),ik(t)}function G8(t){return t.read_shift(2),ik(t)}function K8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=nk(t,0,r);return[n,i]}function Y8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=R8(t,0,r);return[n,i]}function X8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=nk(t,0,r);return[n,i,s]}function q8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[Z5[i],ok[i],n]}function Q8(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:J8(t);return[i,(s[0]===0?ok:J5)[s[1]]]}function J8(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function Z8(t,e,r){t.l+=r&&r.biff==2?3:4}function e5(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function t5(t){return t.l++,co[t.read_shift(1)]}function r5(t){return t.l++,t.read_shift(2)}function n5(t){return t.l++,t.read_shift(1)!==0}function i5(t){return t.l++,ui(t)}function s5(t,e,r){return t.l++,Of(t,e-1,r)}function a5(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=$r(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=co[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=ui(t);break;case 2:r[1]=uc(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function o5(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?cc:Up)(t));return i}function l5(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=a5(t,r.biff);return a}function c5(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function u5(t,e,r){if(r.biff==5)return d5(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function d5(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function f5(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function h5(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function p5(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function g5(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var m5=hi,x5=hi,v5=hi;function Lf(t,e,r){return t.l+=2,[N8(t)]}function ov(t){return t.l+=6,[]}var y5=Lf,_5=ov,E5=ov,w5=Lf;function sk(t){return t.l+=2,[rn(t),t.read_shift(2)&1]}var S5=Lf,T5=sk,A5=ov,k5=Lf,C5=Lf,F5=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function b5(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=F5[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function I5(t){return t.l+=2,[t.read_shift(4)]}function N5(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function R5(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function D5(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function P5(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function O5(t){return t.l+=4,[0,0]}var N2={1:{n:"PtgExp",f:e5},2:{n:"PtgTbl",f:v5},3:{n:"PtgAdd",f:Jr},4:{n:"PtgSub",f:Jr},5:{n:"PtgMul",f:Jr},6:{n:"PtgDiv",f:Jr},7:{n:"PtgPower",f:Jr},8:{n:"PtgConcat",f:Jr},9:{n:"PtgLt",f:Jr},10:{n:"PtgLe",f:Jr},11:{n:"PtgEq",f:Jr},12:{n:"PtgGe",f:Jr},13:{n:"PtgGt",f:Jr},14:{n:"PtgNe",f:Jr},15:{n:"PtgIsect",f:Jr},16:{n:"PtgUnion",f:Jr},17:{n:"PtgRange",f:Jr},18:{n:"PtgUplus",f:Jr},19:{n:"PtgUminus",f:Jr},20:{n:"PtgPercent",f:Jr},21:{n:"PtgParen",f:Jr},22:{n:"PtgMissArg",f:Jr},23:{n:"PtgStr",f:s5},26:{n:"PtgSheet",f:N5},27:{n:"PtgEndSheet",f:R5},28:{n:"PtgErr",f:t5},29:{n:"PtgBool",f:n5},30:{n:"PtgInt",f:r5},31:{n:"PtgNum",f:i5},32:{n:"PtgArray",f:j8},33:{n:"PtgFunc",f:q8},34:{n:"PtgFuncVar",f:Q8},35:{n:"PtgName",f:c5},36:{n:"PtgRef",f:K8},37:{n:"PtgArea",f:P8},38:{n:"PtgMemArea",f:f5},39:{n:"PtgMemErr",f:m5},40:{n:"PtgMemNoMem",f:x5},41:{n:"PtgMemFunc",f:h5},42:{n:"PtgRefErr",f:p5},43:{n:"PtgAreaErr",f:M8},44:{n:"PtgRefN",f:Y8},45:{n:"PtgAreaN",f:B8},46:{n:"PtgMemAreaN",f:D5},47:{n:"PtgMemNoMemN",f:P5},57:{n:"PtgNameX",f:u5},58:{n:"PtgRef3d",f:X8},59:{n:"PtgArea3d",f:O8},60:{n:"PtgRefErr3d",f:g5},61:{n:"PtgAreaErr3d",f:L8},255:{}},M5={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},L5={1:{n:"PtgElfLel",f:sk},2:{n:"PtgElfRw",f:k5},3:{n:"PtgElfCol",f:y5},6:{n:"PtgElfRwV",f:C5},7:{n:"PtgElfColV",f:w5},10:{n:"PtgElfRadical",f:S5},11:{n:"PtgElfRadicalS",f:A5},13:{n:"PtgElfColS",f:_5},15:{n:"PtgElfColSV",f:E5},16:{n:"PtgElfRadicalLel",f:T5},25:{n:"PtgList",f:b5},29:{n:"PtgSxName",f:I5},255:{}},B5={0:{n:"PtgAttrNoop",f:O5},1:{n:"PtgAttrSemi",f:H8},2:{n:"PtgAttrIf",f:z8},4:{n:"PtgAttrChoose",f:U8},8:{n:"PtgAttrGoto",f:V8},16:{n:"PtgAttrSum",f:Z8},32:{n:"PtgAttrBaxcel",f:I2},33:{n:"PtgAttrBaxcel",f:I2},64:{n:"PtgAttrSpace",f:$8},65:{n:"PtgAttrSpaceSemi",f:G8},128:{n:"PtgAttrIfError",f:W8},255:{}};function Bf(t,e,r,n){if(n.biff<8)return hi(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=l5(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=o5(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(hi(t,e)),s}function jf(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=N2[s]||N2[M5[s]],(s===24||s===25)&&(i=(s===24?L5:B5)[t[t.l+1]]),!i||!i.f?hi(t,e):a.push([i.n,i.f(t,e,r)]);return a}function j5(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var U5={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function V5(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function ak(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function R2(t,e,r){var n=ak(t,e,r);return n=="#REF"?n:V5(n,r)}function ai(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,u,f,p=0,g=0,m,y="";if(!t[0]||!t[0][0])return"";for(var x=-1,w="",A=0,k=t[0].length;A<k;++A){var E=t[0][A];switch(E[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),x>=0){switch(t[0][x][1][0]){case 0:w=Ur(" ",t[0][x][1][1]);break;case 1:w=Ur("\r",t[0][x][1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}u=u+w,x=-1}o.push(u+U5[E[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Fd(E[1][1],a,i),o.push(bd(f,s));break;case"PtgRefN":f=r?Fd(E[1][1],r,i):E[1][1],o.push(bd(f,s));break;case"PtgRef3d":p=E[1][1],f=Fd(E[1][2],a,i),y=R2(n,p,i),o.push(y+"!"+bd(f,s));break;case"PtgFunc":case"PtgFuncVar":var P=E[1][0],Y=E[1][1];P||(P=0),P&=127;var V=P==0?[]:o.slice(-P);o.length-=P,Y==="User"&&(Y=V.shift()),o.push(Y+"("+V.join(",")+")");break;case"PtgBool":o.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(E[1]);break;case"PtgNum":o.push(String(E[1]));break;case"PtgStr":o.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(E[1]);break;case"PtgAreaN":m=o2(E[1][1],r?{s:r}:a,i),o.push(Pg(m,i));break;case"PtgArea":m=o2(E[1][1],a,i),o.push(Pg(m,i));break;case"PtgArea3d":p=E[1][1],m=E[1][2],y=R2(n,p,i),o.push(y+"!"+Pg(m,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=E[1][2];var T=(n.names||[])[g-1]||(n[0]||[])[g],F=T?T.Name:"SH33TJSNAME"+String(g);F&&F.slice(0,6)=="_xlfn."&&!i.xlfn&&(F=F.slice(6)),o.push(F);break;case"PtgNameX":var S=E[1][1];g=E[1][2];var I;if(i.biff<=5)S<0&&(S=-S),n[S]&&(I=n[S][g]);else{var R="";if(((n[S]||[])[0]||[])[0]==14849||(((n[S]||[])[0]||[])[0]==1025?n[S][g]&&n[S][g].itab>0&&(R=n.SheetNames[n[S][g].itab-1]+"!"):R=n.SheetNames[g-1]+"!"),n[S]&&n[S][g])R+=n[S][g].Name;else if(n[0]&&n[0][g])R+=n[0][g].Name;else{var D=(ak(n,S,i)||"").split(";;");D[g-1]?R=D[g-1]:R+="SH33TJSERRX"}o.push(R);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var N="(",$e=")";if(x>=0){switch(w="",t[0][x][1][0]){case 2:N=Ur(" ",t[0][x][1][1])+N;break;case 3:N=Ur("\r",t[0][x][1][1])+N;break;case 4:$e=Ur(" ",t[0][x][1][1])+$e;break;case 5:$e=Ur("\r",t[0][x][1][1])+$e;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}x=-1}o.push(N+o.pop()+$e);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:E[1][1],r:E[1][0]};var _e={c:r.c,r:r.r};if(n.sharedf[ut(f)]){var Pe=n.sharedf[ut(f)];o.push(ai(Pe,a,_e,n,i))}else{var be=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){o.push(ai(u[1],a,_e,n,i)),be=!0;break}be||o.push(E[1])}break;case"PtgArray":o.push("{"+j5(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=A;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var Te=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&Te.indexOf(t[0][A][0])==-1){E=t[0][x];var ie=!0;switch(E[1][0]){case 4:ie=!1;case 0:w=Ur(" ",E[1][1]);break;case 5:ie=!1;case 1:w=Ur("\r",E[1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}o.push((ie?w:"")+o.pop()+(ie?"":w)),x=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function z5(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],hi(t,e-2)];var o=jf(t,a,r);return e!==a+i&&(s=Bf(t,e-a-i,o,r)),t.l=n,[o,s]}function W5(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],hi(t,e-2)];var o=jf(t,a,r);return e!==a+i&&(s=Bf(t,e-a-i,o,r)),t.l=n,[o,s]}function H5(t,e,r,n){var i=t.l+e,s=jf(t,n,r),a;return i!==t.l&&(a=Bf(t,i-t.l,s,r)),[s,a]}function $5(t,e,r){var n=t.l+e,i,s=t.read_shift(2),a=jf(t,s,r);return s==65535?[[],hi(t,e-2)]:(e!==s+2&&(i=Bf(t,n-s-2,a,r)),[a,i])}function G5(t){var e;if(Va(t,t.l+6)!==65535)return[ui(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function K5(t){if(t==null){var e=ye(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Yl(t);return Yl(0)}function jg(t,e,r){var n=t.l+e,i=Aa(t);r.biff==2&&++t.l;var s=G5(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=W5(t,n-t.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function Y5(t,e,r,n,i){var s=ql(e,r,i),a=K5(t.v),o=ye(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=ye(t.bf.length),f=0;f<t.bf.length;++f)u[f]=t.bf[f];var p=Pn([s,a,o,u]);return p}function Vp(t,e,r){var n=t.read_shift(4),i=jf(t,n,r),s=t.read_shift(4),a=s>0?Bf(t,s,i,r):null;return[i,a]}var X5=Vp,zp=Vp,q5=Vp,Q5=Vp,J5={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ok={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Z5={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function D2(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function eO(t){var e="of:="+t.replace(sv,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Ug(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function tO(t){return t.replace(/\./,"!")}var Nd={},nu={},Rd=typeof Map<"u";function lv(t,e,r){var n=0,i=t.length;if(r){if(Rd?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=Rd?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(Rd?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function Wp(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(li=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=hf(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=ep(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Bl(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function dl(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Ka(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function lk(t,e,r,n,i,s){try{n.cellNF&&(t.z=lt[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Er(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(lt[e]==null&&Ka(JN[e]||"General",e),t.t==="e")t.w=t.w||co[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=af(t.v);else if(t.t==="d"){var a=En(t.v);(a|0)===a?t.w=a.toString(10):t.w=af(a)}else{if(t.v===void 0)return"";t.w=Gl(t.v,nu)}else t.t==="d"?t.w=Ds(e,En(t.v),nu):t.w=Ds(e,t.v,nu)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Zh(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Zh(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function rO(t,e,r){if(t&&t["!ref"]){var n=Xt(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function nO(t,e){var r=Xt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=wt(r))}var iO=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,sO=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,aO=/<(?:\w:)?hyperlink [^>]*>/mg,oO=/"(\w*:\w*)"/,lO=/<(?:\w:)?col\b[^>]*[\/]?>/g,cO=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,uO=/<(?:\w:)?pageMargins[^>]*\/>/g,ck=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,dO=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,fO=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function hO(t,e,r,n,i,s,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",f="",p=t.match(sO);p?(u=t.slice(0,p.index),f=t.slice(p.index+p[0].length)):u=f=t;var g=u.match(ck);g?cv(g[0],o,i,r):(g=u.match(dO))&&gO(g[0],g[1]||"",o,i,r);var m=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var y=u.slice(m,m+50).match(oO);y&&nO(o,y[1])}var x=u.match(fO);x&&x[1]&&FO(x[1],i);var w=[];if(e.cellStyles){var A=u.match(lO);A&&SO(w,A)}p&&NO(p[1],o,e,l,s,a);var k=f.match(cO);k&&(o["!autofilter"]=AO(k[0]));var E=[],P=f.match(iO);if(P)for(m=0;m!=P.length;++m)E[m]=Xt(P[m].slice(P[m].indexOf('"')+1));var Y=f.match(aO);Y&&_O(o,Y,n);var V=f.match(uO);if(V&&(o["!margins"]=EO(dt(V[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=wt(l)),e.sheetRows>0&&o["!ref"]){var T=Xt(o["!ref"]);e.sheetRows<=+T.e.r&&(T.e.r=e.sheetRows-1,T.e.r>l.e.r&&(T.e.r=l.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>l.e.c&&(T.e.c=l.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),o["!fullref"]=o["!ref"],o["!ref"]=wt(T))}return w.length>0&&(o["!cols"]=w),E.length>0&&(o["!merges"]=E),o}function pO(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+wt(t[r])+'"/>';return e+"</mergeCells>"}function cv(t,e,r,n){var i=dt(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Yt(ur(i.codeName)))}function gO(t,e,r,n,i){cv(t.slice(0,t.indexOf(">")),r,n,i)}function mO(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=ga(ir(l))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),o=(o||"")+ze("outlinePr",null,u)}!s&&!o||(i[i.length]=ze("sheetPr",o,a))}var xO=["objects","scenarios","selectLockedCells","selectUnlockedCells"],vO=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function yO(t){var e={sheet:1};return xO.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),vO.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=rv(t.password).toString(16).toUpperCase()),ze("sheetProtection",null,e)}function _O(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=dt(ur(e[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+Yt(s.location))):(s.Target="#"+Yt(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Xt(s.ref),l=o.s.r;l<=o.e.r;++l)for(var u=o.s.c;u<=o.e.c;++u){var f=ut({c:u,r:l});n?(t[l]||(t[l]=[]),t[l][u]||(t[l][u]={t:"z",v:void 0}),t[l][u].l=s):(t[f]||(t[f]={t:"z",v:void 0}),t[f].l=s)}}}function EO(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function wO(t){return Bl(t),ze("pageMargins",null,t)}function SO(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=dt(e[n],!0);i.hidden&&(i.hidden=yr(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,nv(i.width)),el(i);s<=a;)t[s++]=wr(i)}}function TO(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=ze("col",null,Wp(i,n)));return r[r.length]="</cols>",r.join("")}function AO(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function kO(t,e,r,n){var i=typeof t.ref=="string"?t.ref:wt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=Gi(i);a.s.r==a.e.r&&(a.e.r=Gi(e["!ref"]).e.r,i=wt(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),ze("autoFilter",null,{ref:i})}var CO=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function FO(t,e){e.Views||(e.Views=[{}]),(t.match(CO)||[]).forEach(function(r,n){var i=dt(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),yr(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function bO(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ze("sheetViews",ze("sheetView",null,i),{})}function IO(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=co[t.v];break;case"d":n&&n.cellDates?i=Er(t.v,-1).toISOString():(t=wr(t),t.t="n",i=""+(t.v=En(Er(t.v)))),typeof t.z>"u"&&(t.z=lt[14]);break;default:i=t.v;break}var o=Gn("v",ir(i)),l={r:e},u=dl(n.cellXfs,t,n);switch(u!==0&&(l.s=u),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Gn("v",""+lv(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=a),typeof t.f=="string"&&t.f){var f=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=ze("f",ir(t.f),f)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),ze("c",o,l)}var NO=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=of("v"),a=of("f");return function(l,u,f,p,g,m){for(var y=0,x="",w=[],A=[],k=0,E=0,P=0,Y="",V,T,F=0,S=0,I,R,D=0,N=0,$e=Array.isArray(m.CellXf),_e,Pe=[],be=[],Te=Array.isArray(u),ie=[],Ce={},Be=!1,W=!!f.sheetStubs,ne=l.split(e),re=0,q=ne.length;re!=q;++re){x=ne[re].trim();var xe=x.length;if(xe!==0){var we=0;e:for(y=0;y<xe;++y)switch(x[y]){case">":if(x[y-1]!="/"){++y;break e}if(f&&f.cellStyles){if(T=dt(x.slice(we,y),!0),F=T.r!=null?parseInt(T.r,10):F+1,S=-1,f.sheetRows&&f.sheetRows<F)continue;Ce={},Be=!1,T.ht&&(Be=!0,Ce.hpt=parseFloat(T.ht),Ce.hpx=xu(Ce.hpt)),T.hidden=="1"&&(Be=!0,Ce.hidden=!0),T.outlineLevel!=null&&(Be=!0,Ce.level=+T.outlineLevel),Be&&(ie[F-1]=Ce)}break;case"<":we=y;break}if(we>=y)break;if(T=dt(x.slice(we,y),!0),F=T.r!=null?parseInt(T.r,10):F+1,S=-1,!(f.sheetRows&&f.sheetRows<F)){p.s.r>F-1&&(p.s.r=F-1),p.e.r<F-1&&(p.e.r=F-1),f&&f.cellStyles&&(Ce={},Be=!1,T.ht&&(Be=!0,Ce.hpt=parseFloat(T.ht),Ce.hpx=xu(Ce.hpt)),T.hidden=="1"&&(Be=!0,Ce.hidden=!0),T.outlineLevel!=null&&(Be=!0,Ce.level=+T.outlineLevel),Be&&(ie[F-1]=Ce)),w=x.slice(y).split(t);for(var je=0;je!=w.length&&w[je].trim().charAt(0)=="<";++je);for(w=w.slice(je),y=0;y!=w.length;++y)if(x=w[y].trim(),x.length!==0){if(A=x.match(r),k=y,E=0,P=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,A!=null&&A.length===2){for(k=0,Y=A[1],E=0;E!=Y.length&&!((P=Y.charCodeAt(E)-64)<1||P>26);++E)k=26*k+P;--k,S=k}else++S;for(E=0;E!=x.length&&x.charCodeAt(E)!==62;++E);if(++E,T=dt(x.slice(0,E),!0),T.r||(T.r=ut({r:F-1,c:S})),Y=x.slice(E),V={t:""},(A=Y.match(s))!=null&&A[1]!==""&&(V.v=Yt(A[1])),f.cellFormula){if((A=Y.match(a))!=null&&A[1]!==""){if(V.f=Yt(ur(A[1])).replace(/\r\n/g,`
`),f.xlfn||(V.f=b2(V.f)),A[0].indexOf('t="array"')>-1)V.F=(Y.match(i)||[])[1],V.F.indexOf(":")>-1&&Pe.push([Xt(V.F),V.F]);else if(A[0].indexOf('t="shared"')>-1){R=dt(A[0]);var Ie=Yt(ur(A[1]));f.xlfn||(Ie=b2(Ie)),be[parseInt(R.si,10)]=[R,Ie,T.r]}}else(A=Y.match(/<f[^>]*\/>/))&&(R=dt(A[0]),be[R.si]&&(V.f=C8(be[R.si][1],be[R.si][2],T.r)));var Ae=Pr(T.r);for(E=0;E<Pe.length;++E)Ae.r>=Pe[E][0].s.r&&Ae.r<=Pe[E][0].e.r&&Ae.c>=Pe[E][0].s.c&&Ae.c<=Pe[E][0].e.c&&(V.F=Pe[E][1])}if(T.t==null&&V.v===void 0)if(V.f||V.F)V.v=0,V.t="n";else if(W)V.t="z";else continue;else V.t=T.t||"n";switch(p.s.c>S&&(p.s.c=S),p.e.c<S&&(p.e.c=S),V.t){case"n":if(V.v==""||V.v==null){if(!W)continue;V.t="z"}else V.v=parseFloat(V.v);break;case"s":if(typeof V.v>"u"){if(!W)continue;V.t="z"}else I=Nd[parseInt(V.v,10)],V.v=I.t,V.r=I.r,f.cellHTML&&(V.h=I.h);break;case"str":V.t="s",V.v=V.v!=null?ur(V.v):"",f.cellHTML&&(V.h=V1(V.v));break;case"inlineStr":A=Y.match(n),V.t="s",A!=null&&(I=tv(A[1]))?(V.v=I.t,f.cellHTML&&(V.h=I.h)):V.v="";break;case"b":V.v=yr(V.v);break;case"d":f.cellDates?V.v=Er(V.v,1):(V.v=En(Er(V.v,1)),V.t="n");break;case"e":(!f||f.cellText!==!1)&&(V.w=V.v),V.v=dA[V.v];break}if(D=N=0,_e=null,$e&&T.s!==void 0&&(_e=m.CellXf[T.s],_e!=null&&(_e.numFmtId!=null&&(D=_e.numFmtId),f.cellStyles&&_e.fillId!=null&&(N=_e.fillId))),lk(V,D,N,f,g,m),f.cellDates&&$e&&V.t=="n"&&Iu(lt[D])&&(V.t="d",V.v=jp(V.v)),T.cm&&f.xlmeta){var nt=(f.xlmeta.Cell||[])[+T.cm-1];nt&&nt.type=="XLDAPR"&&(V.D=!0)}if(Te){var J=Pr(T.r);u[J.r]||(u[J.r]=[]),u[J.r][J.c]=V}else u[T.r]=V}}}}ie.length>0&&(u["!rows"]=ie)}}();function RO(t,e,r,n){var i=[],s=[],a=Xt(t["!ref"]),o="",l,u="",f=[],p=0,g=0,m=t["!rows"],y=Array.isArray(t),x={r:u},w,A=-1;for(g=a.s.c;g<=a.e.c;++g)f[g]=Dr(g);for(p=a.s.r;p<=a.e.r;++p){for(s=[],u=Yr(p),g=a.s.c;g<=a.e.c;++g){l=f[g]+u;var k=y?(t[p]||[])[g]:t[l];k!==void 0&&(o=IO(k,l,t,e))!=null&&s.push(o)}(s.length>0||m&&m[p])&&(x={r:u},m&&m[p]&&(w=m[p],w.hidden&&(x.hidden=1),A=-1,w.hpx?A=pf(w.hpx):w.hpt&&(A=w.hpt),A>-1&&(x.ht=A,x.customHeight=1),w.level&&(x.outlineLevel=w.level)),i[i.length]=ze("row",s.join(""),x))}if(m)for(;p<m.length;++p)m&&m[p]&&(x={r:p+1},w=m[p],w.hidden&&(x.hidden=1),A=-1,w.hpx?A=pf(w.hpx):w.hpt&&(A=w.hpt),A>-1&&(x.ht=A,x.customHeight=1),w.level&&(x.outlineLevel=w.level),i[i.length]=ze("row","",x));return i.join("")}function uk(t,e,r,n){var i=[Xr,ze("worksheet",null,{xmlns:sc[0],"xmlns:r":xn.r})],s=r.SheetNames[t],a=0,o="",l=r.Sheets[s];l==null&&(l={});var u=l["!ref"]||"A1",f=Xt(u);if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),u=wt(f)}n||(n={}),l["!comments"]=[];var p=[];mO(l,r,t,e,i),i[i.length]=ze("dimension",null,{ref:u}),i[i.length]=bO(l,e,t,r),e.sheetFormat&&(i[i.length]=ze("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=TO(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=RO(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=yO(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=kO(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=pO(l["!merges"]));var g=-1,m,y=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(m={ref:x[0]},x[1].Target.charAt(0)!="#"&&(y=nr(n,-1,ir(x[1].Target).replace(/#.*$/,""),bt.HLINK),m["r:id"]="rId"+y),(g=x[1].Target.indexOf("#"))>-1&&(m.location=ir(x[1].Target.slice(g+1))),x[1].Tooltip&&(m.tooltip=ir(x[1].Tooltip)),i[i.length]=ze("hyperlink",null,m))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=wO(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Gn("ignoredErrors",ze("ignoredError",null,{numberStoredAsText:1,sqref:u}))),p.length>0&&(y=nr(n,-1,"../drawings/drawing"+(t+1)+".xml",bt.DRAW),i[i.length]=ze("drawing",null,{"r:id":"rId"+y}),l["!drawing"]=p),l["!comments"].length>0&&(y=nr(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",bt.VML),i[i.length]=ze("legacyDrawing",null,{"r:id":"rId"+y}),l["!legacy"]=y),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function DO(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function PO(t,e,r){var n=ye(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=pf(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var u={r:t,c:0},f=0;f<16;++f)if(!(e.s.c>f+1<<10||e.e.c<f<<10)){for(var p=-1,g=-1,m=f<<10;m<f+1<<10;++m){u.c=m;var y=Array.isArray(r)?(r[u.r]||[])[u.c]:r[ut(u)];y&&(p<0&&(p=m),g=m)}p<0||(++o,n.write_shift(4,p),n.write_shift(4,g))}var x=n.l;return n.l=l,n.write_shift(4,o),n.l=x,n.length>n.l?n.slice(0,n.l):n}function OO(t,e,r,n){var i=PO(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&ke(t,0,i)}var MO=cc,LO=Du;function BO(){}function jO(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=zR(t),r}function UO(t,e,r){r==null&&(r=ye(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return qh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),aA(t,r),r.slice(0,r.l)}function VO(t){var e=Ps(t);return[e]}function zO(t,e,r){return r==null&&(r=ye(8)),ac(e,r)}function WO(t){var e=oc(t);return[e]}function HO(t,e,r){return r==null&&(r=ye(4)),lc(e,r)}function $O(t){var e=Ps(t),r=t.read_shift(1);return[e,r,"b"]}function GO(t,e,r){return r==null&&(r=ye(9)),ac(e,r),r.write_shift(1,t.v?1:0),r}function KO(t){var e=oc(t),r=t.read_shift(1);return[e,r,"b"]}function YO(t,e,r){return r==null&&(r=ye(5)),lc(e,r),r.write_shift(1,t.v?1:0),r}function XO(t){var e=Ps(t),r=t.read_shift(1);return[e,r,"e"]}function qO(t,e,r){return r==null&&(r=ye(9)),ac(e,r),r.write_shift(1,t.v),r}function QO(t){var e=oc(t),r=t.read_shift(1);return[e,r,"e"]}function JO(t,e,r){return r==null&&(r=ye(8)),lc(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function ZO(t){var e=Ps(t),r=t.read_shift(4);return[e,r,"s"]}function eM(t,e,r){return r==null&&(r=ye(12)),ac(e,r),r.write_shift(4,e.v),r}function tM(t){var e=oc(t),r=t.read_shift(4);return[e,r,"s"]}function rM(t,e,r){return r==null&&(r=ye(8)),lc(e,r),r.write_shift(4,e.v),r}function nM(t){var e=Ps(t),r=ui(t);return[e,r,"n"]}function iM(t,e,r){return r==null&&(r=ye(16)),ac(e,r),Yl(t.v,r),r}function dk(t){var e=oc(t),r=ui(t);return[e,r,"n"]}function sM(t,e,r){return r==null&&(r=ye(12)),lc(e,r),Yl(t.v,r),r}function aM(t){var e=Ps(t),r=q1(t);return[e,r,"n"]}function oM(t,e,r){return r==null&&(r=ye(12)),ac(e,r),oA(t.v,r),r}function lM(t){var e=oc(t),r=q1(t);return[e,r,"n"]}function cM(t,e,r){return r==null&&(r=ye(8)),lc(e,r),oA(t.v,r),r}function uM(t){var e=Ps(t),r=K1(t);return[e,r,"is"]}function dM(t){var e=Ps(t),r=di(t);return[e,r,"str"]}function fM(t,e,r){return r==null&&(r=ye(12+4*t.v.length)),ac(e,r),On(t.v,r),r.length>r.l?r.slice(0,r.l):r}function hM(t){var e=oc(t),r=di(t);return[e,r,"str"]}function pM(t,e,r){return r==null&&(r=ye(8+4*t.v.length)),lc(e,r),On(t.v,r),r.length>r.l?r.slice(0,r.l):r}function gM(t,e,r){var n=t.l+e,i=Ps(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=zp(t,n-t.l,r);a[3]=ai(o,null,i,r.supbooks,r)}else t.l=n;return a}function mM(t,e,r){var n=t.l+e,i=Ps(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=zp(t,n-t.l,r);a[3]=ai(o,null,i,r.supbooks,r)}else t.l=n;return a}function xM(t,e,r){var n=t.l+e,i=Ps(t);i.r=r["!row"];var s=ui(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=zp(t,n-t.l,r);a[3]=ai(o,null,i,r.supbooks,r)}else t.l=n;return a}function vM(t,e,r){var n=t.l+e,i=Ps(t);i.r=r["!row"];var s=di(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=zp(t,n-t.l,r);a[3]=ai(o,null,i,r.supbooks,r)}else t.l=n;return a}var yM=cc,_M=Du;function EM(t,e){return e==null&&(e=ye(4)),e.write_shift(4,t),e}function wM(t,e){var r=t.l+e,n=cc(t),i=Y1(t),s=di(t),a=di(t),o=di(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function SM(t,e){var r=ye(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Du({s:Pr(t[0]),e:Pr(t[0])},r),X1("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return On(i||"",r),On(t[1].Tooltip||"",r),On("",r),r.slice(0,r.l)}function TM(){}function AM(t,e,r){var n=t.l+e,i=lA(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=X5(t,n-t.l,r);a[1]=o}else t.l=n;return a}function kM(t,e,r){var n=t.l+e,i=cc(t),s=[i];if(r.cellFormula){var a=Q5(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function CM(t,e,r){r==null&&(r=ye(18));var n=Wp(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var fk=["left","right","top","bottom","header","footer"];function FM(t){var e={};return fk.forEach(function(r){e[r]=ui(t)}),e}function bM(t,e){return e==null&&(e=ye(6*8)),Bl(t),fk.forEach(function(r){Yl(t[r],e)}),e}function IM(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function NM(t,e,r){r==null&&(r=ye(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function RM(t){var e=ye(24);return e.write_shift(4,4),e.write_shift(4,1),Du(t,e),e}function DM(t,e){return e==null&&(e=ye(16*4+2)),e.write_shift(2,t.password?rv(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function PM(){}function OM(){}function MM(t,e,r,n,i,s,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},u,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,g=!1,m,y,x,w,A,k,E,P,Y,V=[];o.biff=12,o["!row"]=0;var T=0,F=!1,S=[],I={},R=o.supbooks||i.supbooks||[[]];if(R.sharedf=I,R.arrayf=S,R.SheetNames=i.SheetNames||i.Sheets.map(function(Te){return Te.name}),!o.supbooks&&(o.supbooks=R,i.Names))for(var D=0;D<i.Names.length;++D)R[0][D+1]=i.Names[D];var N=[],$e=[],_e=!1;gf[16]={n:"BrtShortReal",f:dk};var Pe;if(lo(t,function(ie,Ce,Be){if(!g)switch(Be){case 148:u=ie;break;case 0:m=ie,o.sheetRows&&o.sheetRows<=m.r&&(g=!0),P=Yr(w=m.r),o["!row"]=m.r,(ie.hidden||ie.hpt||ie.level!=null)&&(ie.hpt&&(ie.hpx=xu(ie.hpt)),$e[ie.r]=ie);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:ie[2]},ie[2]){case"n":y.v=ie[1];break;case"s":E=Nd[ie[1]],y.v=E.t,y.r=E.r;break;case"b":y.v=!!ie[1];break;case"e":y.v=ie[1],o.cellText!==!1&&(y.w=co[y.v]);break;case"str":y.t="s",y.v=ie[1];break;case"is":y.t="s",y.v=ie[1].t;break}if((x=a.CellXf[ie[0].iStyleRef])&&lk(y,x.numFmtId,null,o,s,a),A=ie[0].c==-1?A+1:ie[0].c,o.dense?(l[w]||(l[w]=[]),l[w][A]=y):l[Dr(A)+P]=y,o.cellFormula){for(F=!1,T=0;T<S.length;++T){var W=S[T];m.r>=W[0].s.r&&m.r<=W[0].e.r&&A>=W[0].s.c&&A<=W[0].e.c&&(y.F=wt(W[0]),F=!0)}!F&&ie.length>3&&(y.f=ie[3])}if(f.s.r>m.r&&(f.s.r=m.r),f.s.c>A&&(f.s.c=A),f.e.r<m.r&&(f.e.r=m.r),f.e.c<A&&(f.e.c=A),o.cellDates&&x&&y.t=="n"&&Iu(lt[x.numFmtId])){var ne=Nl(y.v);ne&&(y.t="d",y.v=new Date(ne.y,ne.m-1,ne.d,ne.H,ne.M,ne.S,ne.u))}Pe&&(Pe.type=="XLDAPR"&&(y.D=!0),Pe=void 0);break;case 1:case 12:if(!o.sheetStubs||p)break;y={t:"z",v:void 0},A=ie[0].c==-1?A+1:ie[0].c,o.dense?(l[w]||(l[w]=[]),l[w][A]=y):l[Dr(A)+P]=y,f.s.r>m.r&&(f.s.r=m.r),f.s.c>A&&(f.s.c=A),f.e.r<m.r&&(f.e.r=m.r),f.e.c<A&&(f.e.c=A),Pe&&(Pe.type=="XLDAPR"&&(y.D=!0),Pe=void 0);break;case 176:V.push(ie);break;case 49:Pe=((o.xlmeta||{}).Cell||[])[ie-1];break;case 494:var re=n["!id"][ie.relId];for(re?(ie.Target=re.Target,ie.loc&&(ie.Target+="#"+ie.loc),ie.Rel=re):ie.relId==""&&(ie.Target="#"+ie.loc),w=ie.rfx.s.r;w<=ie.rfx.e.r;++w)for(A=ie.rfx.s.c;A<=ie.rfx.e.c;++A)o.dense?(l[w]||(l[w]=[]),l[w][A]||(l[w][A]={t:"z",v:void 0}),l[w][A].l=ie):(k=ut({c:A,r:w}),l[k]||(l[k]={t:"z",v:void 0}),l[k].l=ie);break;case 426:if(!o.cellFormula)break;S.push(ie),Y=o.dense?l[w][A]:l[Dr(A)+P],Y.f=ai(ie[1],f,{r:m.r,c:A},R,o),Y.F=wt(ie[0]);break;case 427:if(!o.cellFormula)break;I[ut(ie[0].s)]=ie[1],Y=o.dense?l[w][A]:l[Dr(A)+P],Y.f=ai(ie[1],f,{r:m.r,c:A},R,o);break;case 60:if(!o.cellStyles)break;for(;ie.e>=ie.s;)N[ie.e--]={width:ie.w/256,hidden:!!(ie.flags&1),level:ie.level},_e||(_e=!0,nv(ie.w/256)),el(N[ie.e+1]);break;case 161:l["!autofilter"]={ref:wt(ie)};break;case 476:l["!margins"]=ie;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),ie.name&&(i.Sheets[r].CodeName=ie.name),(ie.above||ie.left)&&(l["!outline"]={above:ie.above,left:ie.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),ie.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!Ce.T){if(!p||o.WTF)throw new Error("Unexpected record 0x"+Be.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=wt(u||f)),o.sheetRows&&l["!ref"]){var be=Xt(l["!ref"]);o.sheetRows<=+be.e.r&&(be.e.r=o.sheetRows-1,be.e.r>f.e.r&&(be.e.r=f.e.r),be.e.r<be.s.r&&(be.s.r=be.e.r),be.e.c>f.e.c&&(be.e.c=f.e.c),be.e.c<be.s.c&&(be.s.c=be.e.c),l["!fullref"]=l["!ref"],l["!ref"]=wt(be))}return V.length>0&&(l["!merges"]=V),N.length>0&&(l["!cols"]=N),$e.length>0&&(l["!rows"]=$e),l}function LM(t,e,r,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=wr(e),e.z=e.z||lt[14],e.v=En(Er(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r,c:n};switch(l.s=dl(i.cellXfs,e,i),e.l&&s["!links"].push([ut(l),e.l]),e.c&&s["!comments"].push([ut(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=lv(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?ke(t,18,rM(e,l)):ke(t,7,eM(e,l))):(l.t="str",a?ke(t,17,pM(e,l)):ke(t,6,fM(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?ke(t,13,cM(e,l)):ke(t,2,oM(e,l)):a?ke(t,16,sM(e,l)):ke(t,5,iM(e,l)),!0;case"b":return l.t="b",a?ke(t,15,YO(e,l)):ke(t,4,GO(e,l)),!0;case"e":return l.t="e",a?ke(t,14,JO(e,l)):ke(t,3,qO(e,l)),!0}return a?ke(t,12,HO(e,l)):ke(t,1,zO(e,l)),!0}function BM(t,e,r,n){var i=Xt(e["!ref"]||"A1"),s,a="",o=[];ke(t,145);var l=Array.isArray(e),u=i.e.r;e["!rows"]&&(u=Math.max(i.e.r,e["!rows"].length-1));for(var f=i.s.r;f<=u;++f){a=Yr(f),OO(t,e,i,f);var p=!1;if(f<=i.e.r)for(var g=i.s.c;g<=i.e.c;++g){f===i.s.r&&(o[g]=Dr(g)),s=o[g]+a;var m=l?(e[f]||[])[g]:e[s];if(!m){p=!1;continue}p=LM(t,m,f,g,n,e,p)}}ke(t,146)}function jM(t,e){!e||!e["!merges"]||(ke(t,177,EM(e["!merges"].length)),e["!merges"].forEach(function(r){ke(t,176,_M(r))}),ke(t,178))}function UM(t,e){!e||!e["!cols"]||(ke(t,390),e["!cols"].forEach(function(r,n){r&&ke(t,60,CM(n,r))}),ke(t,391))}function VM(t,e){!e||!e["!ref"]||(ke(t,648),ke(t,649,RM(Xt(e["!ref"]))),ke(t,650))}function zM(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=nr(r,-1,n[1].Target.replace(/#.*$/,""),bt.HLINK);ke(t,494,SM(n,i))}}),delete e["!links"]}function WM(t,e,r,n){if(e["!comments"].length>0){var i=nr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",bt.VML);ke(t,551,X1("rId"+i)),e["!legacy"]=i}}function HM(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:wt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Gi(s);o.s.r==o.e.r&&(o.e.r=Gi(e["!ref"]).e.r,s=wt(o));for(var l=0;l<a.length;++l){var u=a[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),ke(t,161,Du(Xt(s))),ke(t,162)}}function $M(t,e,r){ke(t,133),ke(t,137,NM(e,r)),ke(t,138),ke(t,134)}function GM(t,e){e["!protect"]&&ke(t,535,DM(e["!protect"]))}function KM(t,e,r,n){var i=$i(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=Xt(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],ke(i,129),(r.vbaraw||a["!outline"])&&ke(i,147,UO(o,a["!outline"])),ke(i,148,LO(l)),$M(i,a,r.Workbook),UM(i,a),BM(i,a,t,e),GM(i,a),HM(i,a,r,t),jM(i,a),zM(i,a,n),a["!margins"]&&ke(i,476,bM(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&VM(i,a),WM(i,a,t,n),ke(i,130),i.end()}function YM(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var i=Yt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function XM(t,e,r,n,i,s){var a=s||{"!type":"chart"};if(!t)return s;var o=0,l=0,u="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var g=YM(p);f.s.r=f.s.c=0,f.e.c=o,u=Dr(o),g[0].forEach(function(m,y){a[u+Yr(y)]={t:"n",v:m,z:g[1]},l=y}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(a["!ref"]=wt(f)),a}function qM(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(ck);return o&&cv(o[0],s,i,r),(a=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function QM(t,e){t.l+=10;var r=di(t);return{name:r}}function JM(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return lo(t,function(l,u,f){switch(f){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var uv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],ZM=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],eL=[],tL=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function P2(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=yr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function O2(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=yr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function hk(t){O2(t.WBProps,uv),O2(t.CalcPr,tL),P2(t.WBView,ZM),P2(t.Sheets,eL),nu.date1904=yr(t.WBProps.date1904)}function rL(t){return!t.Workbook||!t.Workbook.WBProps?"false":yr(t.Workbook.WBProps.date1904)?"true":"false"}var nL="][*?/\\".split("");function pk(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return nL.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function iL(t,e,r){t.forEach(function(n,i){pk(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function sL(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];iL(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)rO(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var aL=/<\w+:workbook/;function oL(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(t.replace(gi,function(l,u){var f=dt(l);switch(Ta(f[0])){case"<?xml":break;case"<workbook":l.match(aL)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[i];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":uv.forEach(function(p){if(f[p[0]]!=null)switch(p[2]){case"bool":r.WBProps[p[0]]=yr(f[p[0]]);break;case"int":r.WBProps[p[0]]=parseInt(f[p[0]],10);break;default:r.WBProps[p[0]]=f[p[0]]}}),f.codeName&&(r.WBProps.CodeName=ur(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=Yt(ur(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=ur(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),yr(f.hidden||"0")&&(s.Hidden=!0),a=u+l.length;break;case"</definedName>":s.Ref=Yt(ur(t.slice(a,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),sc.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return hk(r),r}function gk(t){var e=[Xr];e[e.length]=ze("workbook",null,{xmlns:sc[0],"xmlns:r":xn.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(uv.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=ze("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:ir(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=ze("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=ze("definedName",ir(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function lL(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=ix(t),r.name=di(t),r}function cL(t,e){return e||(e=ye(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),X1(t.strRelID,e),On(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function uL(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?di(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function dL(t,e){e||(e=ye(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),aA(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function fL(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function hL(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=WR(t),a=q5(t,0,r),o=Y1(t);t.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function pL(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],gf[16]={n:"BrtFRTArchID$",f:fL},lo(t,function(l,u,f){switch(f){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=ai(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([f,l]):a[0]=[f,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(f),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!u.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},e),hk(r),r.Names=s,r.supbooks=a,r}function gL(t,e){ke(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};ke(t,156,cL(i))}ke(t,144)}function mL(t,e){e||(e=ye(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return On("SheetJS",e),On(Wh.version,e),On(Wh.version,e),On("7262",e),e.length>e.l?e.slice(0,e.l):e}function xL(t,e){e||(e=ye(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function vL(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(ke(t,135),ke(t,158,xL(i)),ke(t,136))}}function yL(t,e){var r=$i();return ke(r,131),ke(r,128,mL()),ke(r,153,dL(t.Workbook&&t.Workbook.WBProps||null)),vL(r,t),gL(r,t),ke(r,132),r.end()}function _L(t,e,r){return e.slice(-4)===".bin"?pL(t,r):oL(t,r)}function EL(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?MM(t,n,r,i,s,a,o):hO(t,n,r,i,s,a,o)}function wL(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?JM(t,n,r,i,s):qM(t,n,r,i,s)}function SL(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?A8():k8()}function TL(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?S8():T8()}function AL(t,e,r,n){return e.slice(-4)===".bin"?_P(t,r,n):lP(t,r,n)}function kL(t,e,r){return XA(t,r)}function CL(t,e,r){return e.slice(-4)===".bin"?C6(t,r):T6(t,r)}function FL(t,e,r){return e.slice(-4)===".bin"?v8(t,r):c8(t,r)}function bL(t,e,r){return e.slice(-4)===".bin"?a8(t):i8(t)}function IL(t,e,r,n){return r.slice(-4)===".bin"?o8(t,e,r,n):void 0}function NL(t,e,r){return e.slice(-4)===".bin"?t8(t,e,r):n8(t,e,r)}function RL(t,e,r){return(e.slice(-4)===".bin"?yL:gk)(t)}function DL(t,e,r,n,i){return(e.slice(-4)===".bin"?KM:uk)(t,r,n,i)}function PL(t,e,r){return(e.slice(-4)===".bin"?IP:KA)(t,r)}function OL(t,e,r){return(e.slice(-4)===".bin"?I6:jA)(t,r)}function ML(t,e,r){return(e.slice(-4)===".bin"?y8:JA)(t)}function LL(t){return(t.slice(-4)===".bin"?r8:qA)()}var mk=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,xk=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function zs(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(mk),s,a,o,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(xk),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function BL(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(mk),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(xk),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var Dd;function jL(t,e){var r=Dd[t]||Yt(t);return r==="General"?Gl(e):Ds(r,e)}function UL(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=yr(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Er(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Yt(e)]=i}function VL(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||co[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=af(t.v):t.w=Gl(t.v):t.w=jL(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=Dd[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Iu(n)){var i=Nl(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function zL(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=eP[n.Pattern]||n.Pattern)}t[e.ID]=e}function WL(t,e,r,n,i,s,a,o,l,u){var f="General",p=n.StyleID,g={};u=u||{};var m=[],y=0;for(p===void 0&&o&&(p=o.StyleID),p===void 0&&a&&(p=a.StyleID);s[p]!==void 0&&(s[p].nf&&(f=s[p].nf),s[p].Interior&&m.push(s[p].Interior),!!s[p].Parent);)p=s[p].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=yr(t);break;case"String":n.t="s",n.r=J_(Yt(t)),n.v=t.indexOf("<")>-1?Yt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Er(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Yt(t):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=dA[t],u.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=J_(e||t));break}if(VL(n,f,u),u.cellFormula!==!1)if(n.Formula){var x=Yt(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=ru(x,i),delete n.Formula,n.ArrayRange=="RC"?n.F=ru("RC:RC",i):n.ArrayRange&&(n.F=ru(n.ArrayRange,i),l.push([Xt(n.F),n.F]))}else for(y=0;y<l.length;++y)i.r>=l[y][0].s.r&&i.r<=l[y][0].e.r&&i.c>=l[y][0].s.c&&i.c<=l[y][0].e.c&&(n.F=l[y][1]);u.cellStyles&&(m.forEach(function(w){!g.patternType&&w.patternType&&(g.patternType=w.patternType)}),n.s=g),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function HL(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Vg(t,e){var r=e||{};Nu();var n=dd(z1(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=ur(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=wr(r);return a.type="string",mu.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(or){i.indexOf("<"+or)>=0&&(s=!0)}),s)return bB(n,r);Dd={"General Number":"General","General Date":lt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":lt[15],"Short Date":lt[14],"Long Time":lt[19],"Medium Time":lt[18],"Short Time":lt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:lt[2],Standard:lt[4],Percent:lt[10],Scientific:lt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],u,f={},p=[],g=r.dense?[]:{},m="",y={},x={},w=zs('<Data ss:Type="String">'),A=0,k=0,E=0,P={s:{r:2e6,c:2e6},e:{r:0,c:0}},Y={},V={},T="",F=0,S=[],I={},R={},D=0,N=[],$e=[],_e={},Pe=[],be,Te=!1,ie=[],Ce=[],Be={},W=0,ne=0,re={Sheets:[],WBProps:{date1904:!1}},q={};cf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var xe="";o=cf.exec(n);)switch(o[3]=(xe=o[3]).toLowerCase()){case"data":if(xe=="data"){if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?WL(n.slice(A,o.index),T,w,l[l.length-1][0]=="comment"?_e:y,{c:k,r:E},Y,Pe[k],x,ie,r):(T="",w=zs(o[0]),A=o.index+o[0].length);break;case"cell":if(o[1]==="/")if($e.length>0&&(y.c=$e),(!r.sheetRows||r.sheetRows>E)&&y.v!==void 0&&(r.dense?(g[E]||(g[E]=[]),g[E][k]=y):g[Dr(k)+Yr(E)]=y),y.HRef&&(y.l={Target:Yt(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(W=k+(parseInt(y.MergeAcross,10)|0),ne=E+(parseInt(y.MergeDown,10)|0),S.push({s:{c:k,r:E},e:{c:W,r:ne}})),!r.sheetStubs)y.MergeAcross?k=W+1:++k;else if(y.MergeAcross||y.MergeDown){for(var we=k;we<=W;++we)for(var je=E;je<=ne;++je)(we>k||je>E)&&(r.dense?(g[je]||(g[je]=[]),g[je][we]={t:"z"}):g[Dr(we)+Yr(je)]={t:"z"});k=W+1}else++k;else y=BL(o[0]),y.Index&&(k=+y.Index-1),k<P.s.c&&(P.s.c=k),k>P.e.c&&(P.e.c=k),o[0].slice(-2)==="/>"&&++k,$e=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(E<P.s.r&&(P.s.r=E),E>P.e.r&&(P.e.r=E),o[0].slice(-2)==="/>"&&(x=zs(o[0]),x.Index&&(E=+x.Index-1)),k=0,++E):(x=zs(o[0]),x.Index&&(E=+x.Index-1),Be={},(x.AutoFitHeight=="0"||x.Height)&&(Be.hpx=parseInt(x.Height,10),Be.hpt=pf(Be.hpx),Ce[E]=Be),x.Hidden=="1"&&(Be.hidden=!0,Ce[E]=Be));break;case"worksheet":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));p.push(m),P.s.r<=P.e.r&&P.s.c<=P.e.c&&(g["!ref"]=wt(P),r.sheetRows&&r.sheetRows<=P.e.r&&(g["!fullref"]=g["!ref"],P.e.r=r.sheetRows-1,g["!ref"]=wt(P))),S.length&&(g["!merges"]=S),Pe.length>0&&(g["!cols"]=Pe),Ce.length>0&&(g["!rows"]=Ce),f[m]=g}else P={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=k=0,l.push([o[3],!1]),u=zs(o[0]),m=Yt(u.Name),g=r.dense?[]:{},S=[],ie=[],Ce=[],q={name:m,Hidden:0},re.Sheets.push(q);break;case"table":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),Pe=[],Te=!1}break;case"style":o[1]==="/"?zL(Y,V,r):V=zs(o[0]);break;case"numberformat":V.nf=Yt(zs(o[0]).Format||"General"),Dd[V.nf]&&(V.nf=Dd[V.nf]);for(var Ie=0;Ie!=392&&lt[Ie]!=V.nf;++Ie);if(Ie==392){for(Ie=57;Ie!=392;++Ie)if(lt[Ie]==null){Ka(V.nf,Ie);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(be=zs(o[0]),be.Hidden&&(be.hidden=!0,delete be.Hidden),be.Width&&(be.wpx=parseInt(be.Width,10)),!Te&&be.wpx>10){Te=!0,li=$A;for(var Ae=0;Ae<Pe.length;++Ae)Pe[Ae]&&el(Pe[Ae])}Te&&el(be),Pe[be.Index-1||Pe.length]=be;for(var nt=0;nt<+be.Span;++nt)Pe[Pe.length]=wr(be);break;case"namedrange":if(o[1]==="/")break;re.Names||(re.Names=[]);var J=dt(o[0]),Mt={Name:J.Name,Ref:ru(J.RefersTo.slice(1),{r:0,c:0})};re.Sheets.length>0&&(Mt.Sheet=re.Sheets.length-1),re.Names.push(Mt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?T+=n.slice(F,o.index):F=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;V.Interior=zs(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?pD(I,xe,n.slice(D,o.index)):D=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));HL(_e),$e.push(_e)}else l.push([o[3],!1]),u=zs(o[0]),_e={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Et=zs(o[0]);g["!autofilter"]={ref:ru(Et.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return U2(n,r);var Rt=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Rt=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Rt=!1}break;case"excelworkbook":switch(o[3]){case"date1904":re.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Rt=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Rt=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(D,o.index)){case"SheetHidden":q.Hidden=1;break;case"SheetVeryHidden":q.Hidden=2;break}else D=o.index+o[0].length;break;case"header":g["!margins"]||Bl(g["!margins"]={},"xlml"),isNaN(+dt(o[0]).Margin)||(g["!margins"].header=+dt(o[0]).Margin);break;case"footer":g["!margins"]||Bl(g["!margins"]={},"xlml"),isNaN(+dt(o[0]).Margin)||(g["!margins"].footer=+dt(o[0]).Margin);break;case"pagemargins":var mt=dt(o[0]);g["!margins"]||Bl(g["!margins"]={},"xlml"),isNaN(+mt.Top)||(g["!margins"].top=+mt.Top),isNaN(+mt.Left)||(g["!margins"].left=+mt.Left),isNaN(+mt.Right)||(g["!margins"].right=+mt.Right),isNaN(+mt.Bottom)||(g["!margins"].bottom=+mt.Bottom);break;case"displayrighttoleft":re.Views||(re.Views=[]),re.Views[0]||(re.Views[0]={}),re.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Rt=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Rt=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Rt=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Rt=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Rt=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Rt=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Rt=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Rt=!1}break;case"smarttags":break;default:Rt=!1;break}if(Rt||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?UL(R,xe,N,n.slice(D,o.index)):(N=o,D=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Ge={};return!r.bookSheets&&!r.bookProps&&(Ge.Sheets=f),Ge.SheetNames=p,Ge.Workbook=re,Ge.SSF=wr(lt),Ge.Props=I,Ge.Custprops=R,Ge}function dx(t,e){switch(fv(e=e||{}),e.type||"base64"){case"base64":return Vg(ss(t),e);case"binary":case"buffer":case"file":return Vg(t,e);case"array":return Vg(cl(t),e)}}function $L(t,e){var r=[];return t.Props&&r.push(gD(t.Props,e)),t.Custprops&&r.push(mD(t.Props,t.Custprops)),r.join("")}function GL(){return""}function KL(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(ze("NumberFormat",null,{"ss:Format":ir(lt[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(ze("Style",s.join(""),a))}),ze("Styles",r.join(""))}function vk(t){return ze("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+av(t.Ref,{r:0,c:0})})}function YL(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(vk(i)))}return ze("Names",r.join(""))}function XL(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(vk(o)))}return s.join("")}function qL(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(ze("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(ze("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(ze("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(ze("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(Gn("ProtectContents","True")),t["!protect"].objects&&i.push(Gn("ProtectObjects","True")),t["!protect"].scenarios&&i.push(Gn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(Gn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(Gn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":ze("WorksheetOptions",i.join(""),{xmlns:Qi.x})}function QL(t){return t.map(function(e){var r=vR(e.t||""),n=ze("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ze("Comment",n,{"ss:Author":e.a})}).join("")}function JL(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+ir(av(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var l=Pr(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=ir(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=ir(t.l.Tooltip))),r["!merges"])for(var u=r["!merges"],f=0;f!=u.length;++f)u[f].s.c!=a.c||u[f].s.r!=a.r||(u[f].e.c>u[f].s.c&&(o["ss:MergeAcross"]=u[f].e.c-u[f].s.c),u[f].e.r>u[f].s.r&&(o["ss:MergeDown"]=u[f].e.r-u[f].s.r));var p="",g="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":p="Number",g=String(t.v);break;case"b":p="Boolean",g=t.v?"1":"0";break;case"e":p="Error",g=co[t.v];break;case"d":p="DateTime",g=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||lt[14]);break;case"s":p="String",g=xR(t.v||"");break}var m=dl(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+m),o["ss:Index"]=a.c+1;var y=t.v!=null?g:"",x=t.t=="z"?"":'<Data ss:Type="'+p+'">'+y+"</Data>";return(t.c||[]).length>0&&(x+=QL(t.c)),ze("Cell",x,o)}function ZL(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=xu(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function eB(t,e,r,n){if(!t["!ref"])return"";var i=Xt(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(w,A){el(w);var k=!!w.width,E=Wp(A,w),P={"ss:Index":A+1};k&&(P["ss:Width"]=ff(E.width)),w.hidden&&(P["ss:Hidden"]="1"),o.push(ze("Column",null,P))});for(var l=Array.isArray(t),u=i.s.r;u<=i.e.r;++u){for(var f=[ZL(u,(t["!rows"]||[])[u])],p=i.s.c;p<=i.e.c;++p){var g=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>p)&&!(s[a].s.r>u)&&!(s[a].e.c<p)&&!(s[a].e.r<u)){(s[a].s.c!=p||s[a].s.r!=u)&&(g=!0);break}if(!g){var m={r:u,c:p},y=ut(m),x=l?(t[u]||[])[p]:t[y];f.push(JL(x,y,t,e,r,n,m))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function tB(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?XL(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?eB(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(qL(s,e,t,r)),n.join("")}function rB(t,e){e||(e={}),t.SSF||(t.SSF=wr(lt)),t.SSF&&(Nu(),Mp(t.SSF),e.revssf=Bp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],dl(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push($L(t,e)),r.push(GL()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(ze("Worksheet",tB(n,e,t),{"ss:Name":ir(t.SheetNames[n])}));return r[2]=KL(t,e),r[3]=YL(t),Xr+ze("Workbook",r.join(""),{xmlns:Qi.ss,"xmlns:o":Qi.o,"xmlns:x":Qi.x,"xmlns:ss":Qi.ss,"xmlns:dt":Qi.dt,"xmlns:html":Qi.html})}function nB(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=YR(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=XR(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var iB=[60,1084,2066,2165,2175];function sB(t,e,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var l=Va(r,r.l),u=fx[l],f=0;u!=null&&iB.indexOf(l)>-1;)s=Va(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=r.slice(f,r.l+4+s),a.push(o),r.l+=4+s,u=fx[l=Va(r,r.l)];var p=Pn(a);$n(p,0);var g=0;p.lens=[];for(var m=0;m<a.length;++m)p.lens.push(g),g+=a[m].length;if(p.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+p.length+" < "+n;return e.f(p,p.length,i)}function ua(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=lt[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||co[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=af(t.v):t.w=Gl(t.v):t.w=Ds(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&Iu(lt[n]||String(n))){var i=Nl(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function M0(t,e,r){return{v:t,ixfe:e,t:r}}function aB(t,e){var r={opts:{}},n={},i=e.dense?[]:{},s={},a={},o=null,l=[],u="",f={},p,g="",m,y,x,w,A={},k=[],E,P,Y=[],V=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},F={},S=function(ft){return ft<8?Ol[ft]:ft<64&&V[ft-8]||Ol[ft]},I=function(ft,mr,xr){var Sr=mr.XF.data;if(!(!Sr||!Sr.patternType||!xr||!xr.cellStyles)){mr.s={},mr.s.patternType=Sr.patternType;var xi;(xi=df(S(Sr.icvFore)))&&(mr.s.fgColor={rgb:xi}),(xi=df(S(Sr.icvBack)))&&(mr.s.bgColor={rgb:xi})}},R=function(ft,mr,xr){if(!(Be>1)&&!(xr.sheetRows&&ft.r>=xr.sheetRows)){if(xr.cellStyles&&mr.XF&&mr.XF.data&&I(ft,mr,xr),delete mr.ixfe,delete mr.XF,p=ft,g=ut(ft),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),ft.r<a.s.r&&(a.s.r=ft.r),ft.c<a.s.c&&(a.s.c=ft.c),ft.r+1>a.e.r&&(a.e.r=ft.r+1),ft.c+1>a.e.c&&(a.e.c=ft.c+1),xr.cellFormula&&mr.f){for(var Sr=0;Sr<k.length;++Sr)if(!(k[Sr][0].s.c>ft.c||k[Sr][0].s.r>ft.r)&&!(k[Sr][0].e.c<ft.c||k[Sr][0].e.r<ft.r)){mr.F=wt(k[Sr][0]),(k[Sr][0].s.c!=ft.c||k[Sr][0].s.r!=ft.r)&&delete mr.f,mr.f&&(mr.f=""+ai(k[Sr][1],a,ft,ie,D));break}}xr.dense?(i[ft.r]||(i[ft.r]=[]),i[ft.r][ft.c]=mr):i[g]=mr}},D={enc:!1,sbcch:0,snames:[],sharedf:A,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(D.password=e.password);var N,$e=[],_e=[],Pe=[],be=[],Te=!1,ie=[];ie.SheetNames=D.snames,ie.sharedf=D.sharedf,ie.arrayf=D.arrayf,ie.names=[],ie.XTI=[];var Ce=0,Be=0,W=0,ne=[],re=[],q;D.codepage=1200,Ys(1200);for(var xe=!1;t.l<t.length-1;){var we=t.l,je=t.read_shift(2);if(je===0&&Ce===10)break;var Ie=t.l===t.length?0:t.read_shift(2),Ae=fx[je];if(Ae&&Ae.f){if(e.bookSheets&&Ce===133&&je!==133)break;if(Ce=je,Ae.r===2||Ae.r==12){var nt=t.read_shift(2);if(Ie-=2,!D.enc&&nt!==je&&((nt&255)<<8|nt>>8)!==je)throw new Error("rt mismatch: "+nt+"!="+je);Ae.r==12&&(t.l+=10,Ie-=10)}var J={};if(je===10?J=Ae.f(t,Ie,D):J=sB(je,Ae,t,Ie,D),Be==0&&[9,521,1033,2057].indexOf(Ce)===-1)continue;switch(je){case 34:r.opts.Date1904=T.WBProps.date1904=J;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(t.l=0),D.enc=J,!e.password)throw new Error("File is password-protected");if(J.valid==null)throw new Error("Encryption scheme unsupported");if(!J.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=J;break;case 66:var Mt=Number(J);switch(Mt){case 21010:Mt=1200;break;case 32768:Mt=1e4;break;case 32769:Mt=1252;break}Ys(D.codepage=Mt),xe=!0;break;case 317:D.rrtabid=J;break;case 25:D.winlocked=J;break;case 439:r.opts.RefreshAll=J;break;case 12:r.opts.CalcCount=J;break;case 16:r.opts.CalcDelta=J;break;case 17:r.opts.CalcIter=J;break;case 13:r.opts.CalcMode=J;break;case 14:r.opts.CalcPrecision=J;break;case 95:r.opts.CalcSaveRecalc=J;break;case 15:D.CalcRefMode=J;break;case 2211:r.opts.FullCalc=J;break;case 129:J.fDialog&&(i["!type"]="dialog"),J.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),J.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:Y.push(J);break;case 430:ie.push([J]),ie[ie.length-1].XTI=[];break;case 35:case 547:ie[ie.length-1].push(J);break;case 24:case 536:q={Name:J.Name,Ref:ai(J.rgce,a,null,ie,D)},J.itab>0&&(q.Sheet=J.itab-1),ie.names.push(q),ie[0]||(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].push(J),J.Name=="_xlnm._FilterDatabase"&&J.itab>0&&J.rgce&&J.rgce[0]&&J.rgce[0][0]&&J.rgce[0][0][0]=="PtgArea3d"&&(re[J.itab-1]={ref:wt(J.rgce[0][0][1][2])});break;case 22:D.ExternCount=J;break;case 23:ie.length==0&&(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].XTI=ie[ie.length-1].XTI.concat(J),ie.XTI=ie.XTI.concat(J);break;case 2196:if(D.biff<8)break;q!=null&&(q.Comment=J[1]);break;case 18:i["!protect"]=J;break;case 19:J!==0&&D.WTF&&console.error("Password verifier: "+J);break;case 133:s[J.pos]=J,D.snames.push(J.name);break;case 10:{if(--Be)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=wt(a),e.sheetRows&&e.sheetRows<=a.e.r){var Et=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=wt(a),a.e.r=Et}a.e.r++,a.e.c++}$e.length>0&&(i["!merges"]=$e),_e.length>0&&(i["!objects"]=_e),Pe.length>0&&(i["!cols"]=Pe),be.length>0&&(i["!rows"]=be),T.Sheets.push(F)}u===""?f=i:n[u]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[je]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[J.BIFFVer]||8),D.biffguess=J.BIFFVer==0,J.BIFFVer==0&&J.dt==4096&&(D.biff=5,xe=!0,Ys(D.codepage=28591)),D.biff==8&&J.BIFFVer==0&&J.dt==16&&(D.biff=2),Be++)break;if(i=e.dense?[]:{},D.biff<8&&!xe&&(xe=!0,Ys(D.codepage=e.codepage||1252)),D.biff<5||J.BIFFVer==0&&J.dt==4096){u===""&&(u="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var Rt={pos:t.l-Ie,name:u};s[Rt.pos]=Rt,D.snames.push(u)}else u=(s[we]||{name:""}).name;J.dt==32&&(i["!type"]="chart"),J.dt==64&&(i["!type"]="macro"),$e=[],_e=[],D.arrayf=k=[],Pe=[],be=[],Te=!1,F={Hidden:(s[we]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[J.r]||[])[J.c]:i[ut({c:J.c,r:J.r})])&&++J.c,E={ixfe:J.ixfe,XF:Y[J.ixfe]||{},v:J.val,t:"n"},W>0&&(E.z=ne[E.ixfe>>8&63]),ua(E,e,r.opts.Date1904),R({c:J.c,r:J.r},E,e);break;case 5:case 517:E={ixfe:J.ixfe,XF:Y[J.ixfe],v:J.val,t:J.t},W>0&&(E.z=ne[E.ixfe>>8&63]),ua(E,e,r.opts.Date1904),R({c:J.c,r:J.r},E,e);break;case 638:E={ixfe:J.ixfe,XF:Y[J.ixfe],v:J.rknum,t:"n"},W>0&&(E.z=ne[E.ixfe>>8&63]),ua(E,e,r.opts.Date1904),R({c:J.c,r:J.r},E,e);break;case 189:for(var mt=J.c;mt<=J.C;++mt){var Ge=J.rkrec[mt-J.c][0];E={ixfe:Ge,XF:Y[Ge],v:J.rkrec[mt-J.c][1],t:"n"},W>0&&(E.z=ne[E.ixfe>>8&63]),ua(E,e,r.opts.Date1904),R({c:mt,r:J.r},E,e)}break;case 6:case 518:case 1030:{if(J.val=="String"){o=J;break}if(E=M0(J.val,J.cell.ixfe,J.tt),E.XF=Y[E.ixfe],e.cellFormula){var or=J.formula;if(or&&or[0]&&or[0][0]&&or[0][0][0]=="PtgExp"){var Ln=or[0][0][1][0],sn=or[0][0][1][1],bi=ut({r:Ln,c:sn});A[bi]?E.f=""+ai(J.formula,a,J.cell,ie,D):E.F=((e.dense?(i[Ln]||[])[sn]:i[bi])||{}).F}else E.f=""+ai(J.formula,a,J.cell,ie,D)}W>0&&(E.z=ne[E.ixfe>>8&63]),ua(E,e,r.opts.Date1904),R(J.cell,E,e),o=J}break;case 7:case 519:if(o)o.val=J,E=M0(J,o.cell.ixfe,"s"),E.XF=Y[E.ixfe],e.cellFormula&&(E.f=""+ai(o.formula,a,o.cell,ie,D)),W>0&&(E.z=ne[E.ixfe>>8&63]),ua(E,e,r.opts.Date1904),R(o.cell,E,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(J);var ls=ut(J[0].s);if(m=e.dense?(i[J[0].s.r]||[])[J[0].s.c]:i[ls],e.cellFormula&&m){if(!o||!ls||!m)break;m.f=""+ai(J[1],a,J[0],ie,D),m.F=wt(J[0])}}break;case 1212:{if(!e.cellFormula)break;if(g){if(!o)break;A[ut(o.cell)]=J[0],m=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[ut(o.cell)],(m||{}).f=""+ai(J[0],a,p,ie,D)}}break;case 253:E=M0(l[J.isst].t,J.ixfe,"s"),l[J.isst].h&&(E.h=l[J.isst].h),E.XF=Y[E.ixfe],W>0&&(E.z=ne[E.ixfe>>8&63]),ua(E,e,r.opts.Date1904),R({c:J.c,r:J.r},E,e);break;case 513:e.sheetStubs&&(E={ixfe:J.ixfe,XF:Y[J.ixfe],t:"z"},W>0&&(E.z=ne[E.ixfe>>8&63]),ua(E,e,r.opts.Date1904),R({c:J.c,r:J.r},E,e));break;case 190:if(e.sheetStubs)for(var Ii=J.c;Ii<=J.C;++Ii){var Hr=J.ixfe[Ii-J.c];E={ixfe:Hr,XF:Y[Hr],t:"z"},W>0&&(E.z=ne[E.ixfe>>8&63]),ua(E,e,r.opts.Date1904),R({c:Ii,r:J.r},E,e)}break;case 214:case 516:case 4:E=M0(J.val,J.ixfe,"s"),E.XF=Y[E.ixfe],W>0&&(E.z=ne[E.ixfe>>8&63]),ua(E,e,r.opts.Date1904),R({c:J.c,r:J.r},E,e);break;case 0:case 512:Be===1&&(a=J);break;case 252:l=J;break;case 1054:if(D.biff==4){ne[W++]=J[1];for(var Ni=0;Ni<W+163&&lt[Ni]!=J[1];++Ni);Ni>=163&&Ka(J[1],W+163)}else Ka(J[1],J[0]);break;case 30:{ne[W++]=J;for(var er=0;er<W+163&&lt[er]!=J;++er);er>=163&&Ka(J,W+163)}break;case 229:$e=$e.concat(J);break;case 93:_e[J.cmo[0]]=D.lastobj=J;break;case 438:D.lastobj.TxO=J;break;case 127:D.lastobj.ImData=J;break;case 440:for(w=J[0].s.r;w<=J[0].e.r;++w)for(x=J[0].s.c;x<=J[0].e.c;++x)m=e.dense?(i[w]||[])[x]:i[ut({c:x,r:w})],m&&(m.l=J[1]);break;case 2048:for(w=J[0].s.r;w<=J[0].e.r;++w)for(x=J[0].s.c;x<=J[0].e.c;++x)m=e.dense?(i[w]||[])[x]:i[ut({c:x,r:w})],m&&m.l&&(m.l.Tooltip=J[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;m=e.dense?(i[J[0].r]||[])[J[0].c]:i[ut(J[0])];var br=_e[J[2]];m||(e.dense?(i[J[0].r]||(i[J[0].r]=[]),m=i[J[0].r][J[0].c]={t:"z"}):m=i[ut(J[0])]={t:"z"},a.e.r=Math.max(a.e.r,J[0].r),a.s.r=Math.min(a.s.r,J[0].r),a.e.c=Math.max(a.e.c,J[0].c),a.s.c=Math.min(a.s.c,J[0].c)),m.c||(m.c=[]),y={a:J[1],t:br.TxO.t},m.c.push(y)}break;case 2173:KP(Y[J.ixfe],J.ext);break;case 125:{if(!D.cellStyles)break;for(;J.e>=J.s;)Pe[J.e--]={width:J.w/256,level:J.level||0,hidden:!!(J.flags&1)},Te||(Te=!0,nv(J.w/256)),el(Pe[J.e+1])}break;case 520:{var gr={};J.level!=null&&(be[J.r]=gr,gr.level=J.level),J.hidden&&(be[J.r]=gr,gr.hidden=!0),J.hpt&&(be[J.r]=gr,gr.hpt=J.hpt,gr.hpx=xu(J.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Bl(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[je]]=J;break;case 161:i["!margins"]||Bl(i["!margins"]={}),i["!margins"].header=J.header,i["!margins"].footer=J.footer;break;case 574:J.RTL&&(T.Views[0].RTL=!0);break;case 146:V=J;break;case 2198:N=J;break;case 140:P=J;break;case 442:u?F.CodeName=J||F.name:T.WBProps.CodeName=J||"ThisWorkbook";break}}else Ae||console.error("Missing Info for XLS Record 0x"+je.toString(16)),t.l+=Ie}return r.SheetNames=Wr(s).sort(function(mi,ft){return Number(mi)-Number(ft)}).map(function(mi){return s[mi].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&re.forEach(function(mi,ft){r.Sheets[r.SheetNames[ft]]["!autofilter"]=mi}),r.Strings=l,r.SSF=wr(lt),D.enc&&(r.Encryption=D.enc),N&&(r.Themes=N),r.Metadata={},P!==void 0&&(r.Metadata.Country=P),ie.names.length>0&&(T.Names=ie.names),r.Workbook=T,r}var Pd={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function oB(t,e,r){var n=tt.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=m2(n,sx,Pd.DSI);for(var s in i)e[s]=i[s]}catch(u){if(r.WTF)throw u}var a=tt.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=m2(a,ax,Pd.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(u){if(r.WTF)throw u}e.HeadingPairs&&e.TitlesOfParts&&(xA(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function lB(t,e){var r=[],n=[],i=[],s=0,a,o=G_(sx,"n"),l=G_(ax,"n");if(t.Props)for(a=Wr(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=Wr(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var u=[];for(s=0;s<i.length;++s)TA.indexOf(i[s][0])>-1||mA.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);n.length&&tt.utils.cfb_add(e,"/SummaryInformation",x2(n,Pd.SI,l,ax)),(r.length||u.length)&&tt.utils.cfb_add(e,"/DocumentSummaryInformation",x2(r,Pd.DSI,o,sx,u.length?u:null,Pd.UDI))}function yk(t,e){e||(e={}),fv(e),D1(),e.codepage&&R1(e.codepage);var r,n;if(t.FullPaths){if(tt.find(t,"/encryption"))throw new Error("File is password-protected");r=tt.find(t,"!CompObj"),n=tt.find(t,"/Workbook")||tt.find(t,"/Book")}else{switch(e.type){case"base64":t=Zi(ss(t));break;case"binary":t=Zi(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}$n(t,0),n={content:t}}var i,s;if(r&&nB(r),e.bookProps&&!e.bookSheets)i={};else{var a=Ft?"buffer":"array";if(n&&n.content)i=aB(n.content,e);else if((s=tt.find(t,"PerfectOffice_MAIN"))&&s.content)i=Ll.to_workbook(s.content,(e.type=a,e));else if((s=tt.find(t,"NativeContent_MAIN"))&&s.content)i=Ll.to_workbook(s.content,(e.type=a,e));else throw(s=tt.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&tt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=E8(t))}var o={};return t.FullPaths&&oB(t,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=t),i}function cB(t,e){var r=e||{},n=tt.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return tt.utils.cfb_add(n,i,_k(t,r)),r.biff==8&&(t.Props||t.Custprops)&&lB(t,n),r.biff==8&&t.vbaraw&&w8(n,tt.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var gf={0:{f:DO},1:{f:VO},2:{f:aM},3:{f:XO},4:{f:$O},5:{f:nM},6:{f:dM},7:{f:ZO},8:{f:vM},9:{f:xM},10:{f:gM},11:{f:mM},12:{f:WO},13:{f:lM},14:{f:QO},15:{f:KO},16:{f:dk},17:{f:hM},18:{f:tM},19:{f:K1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:hL},40:{},42:{},43:{f:dP},44:{f:cP},45:{f:pP},46:{f:mP},47:{f:gP},48:{},49:{f:MR},50:{},51:{f:qP},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:OA},62:{f:uM},63:{f:s8},64:{f:PM},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:hi,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:IM},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:jO},148:{f:MO,p:16},151:{f:TM},152:{},153:{f:uL},154:{},155:{},156:{f:lL},157:{},158:{},159:{T:1,f:k6},160:{T:-1},161:{T:1,f:cc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:yM},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:YP},336:{T:-1},337:{f:ZP,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ix},357:{},358:{},359:{},360:{T:1},361:{},362:{f:PA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:AM},427:{f:kM},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:FM},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:BO},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:wM},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ix},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:m8},633:{T:1},634:{T:-1},635:{T:1,f:p8},636:{T:-1},637:{f:UR},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:QM},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:OM},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},fx={6:{f:jg},10:{f:Eo},12:{f:rn},13:{f:rn},14:{f:$r},15:{f:$r},16:{f:ui},17:{f:$r},18:{f:$r},19:{f:rn},20:{f:S2},21:{f:S2},23:{f:PA},24:{f:A2},25:{f:$r},26:{},27:{},28:{f:O3},29:{},34:{f:$r},35:{f:T2},38:{f:ui},39:{f:ui},40:{f:ui},41:{f:ui},42:{f:$r},43:{f:$r},47:{f:K6},49:{f:l3},51:{f:rn},60:{},61:{f:n3},64:{f:$r},65:{f:o3},66:{f:rn},77:{},80:{},81:{},82:{},85:{f:rn},89:{},90:{},91:{},92:{f:GD},93:{f:B3},94:{},95:{f:$r},96:{},97:{},99:{f:$r},125:{f:OA},128:{f:S3},129:{f:YD},130:{f:rn},131:{f:$r},132:{f:$r},133:{f:XD},134:{},140:{f:G3},141:{f:rn},144:{},146:{f:X3},151:{},152:{},153:{},154:{},155:{},156:{f:rn},157:{},158:{},160:{f:r6},161:{f:J3},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:y3},190:{f:_3},193:{f:Eo},197:{},198:{},199:{},200:{},201:{},202:{f:$r},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:rn},220:{},221:{f:$r},222:{},224:{f:w3},225:{f:$D},226:{f:Eo},227:{},229:{f:M3},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:QD},253:{f:u3},255:{f:ZD},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:AA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:$r},353:{f:Eo},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:F3},431:{f:$r},432:{},433:{},434:{},437:{},438:{f:V3},439:{f:$r},440:{f:z3},441:{},442:{f:Mf},443:{},444:{f:rn},445:{},446:{},448:{f:Eo},449:{f:r3,r:2},450:{f:Eo},512:{f:_2},513:{f:t6},515:{f:k3},516:{f:f3},517:{f:w2},519:{f:n6},520:{f:e3},523:{},545:{f:k2},549:{f:y2},566:{},574:{f:s3},638:{f:v3},659:{},1048:{},1054:{f:p3},1084:{},1212:{f:R3},2048:{f:H3},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:D0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Eo},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:q3,r:12},2173:{f:GP,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:$r,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:N3,r:12},2197:{},2198:{f:UP,r:12},2199:{},2200:{},2201:{},2202:{f:D3,r:12},2203:{f:Eo},2204:{},2205:{},2206:{},2207:{},2211:{f:t3},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:rn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Z3},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Y3},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:_2},1:{},2:{f:l6},3:{f:a6},4:{f:s6},5:{f:w2},7:{f:u6},8:{},9:{f:D0},11:{},22:{f:rn},30:{f:m3},31:{},32:{},33:{f:k2},36:{},37:{f:y2},50:{f:d6},62:{},52:{},67:{},68:{f:rn},69:{},86:{},126:{},127:{f:i6},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:f6},223:{},234:{},354:{},421:{},518:{f:jg},521:{f:D0},536:{f:A2},547:{f:T2},561:{},579:{},1030:{f:jg},1033:{f:D0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function We(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&H1(r)&&t.push(r)}}function uB(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return We(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;var f=t.next(4);for(f.write_shift(2,s),f.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u;l<i;){for(f=t.next(4),f.write_shift(2,60),u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;f.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u}}}function Uf(t,e,r){return t||(t=ye(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function dB(t,e,r,n){var i=ye(9);return Uf(i,t,e),kA(r,n||"b",i),i}function fB(t,e,r){var n=ye(8+2*r.length);return Uf(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function hB(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?En(Er(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?We(t,2,c6(r,n,i)):We(t,3,o6(r,n,i));return;case"b":case"e":We(t,5,dB(r,n,e.v,e.t));return;case"s":case"str":We(t,4,fB(r,n,(e.v||"").slice(0,255)));return}We(t,1,Uf(null,r,n))}function pB(t,e,r,n){var i=Array.isArray(e),s=Xt(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=wt(s)}for(var u=s.s.r;u<=s.e.r;++u){o=Yr(u);for(var f=s.s.c;f<=s.e.c;++f){u===s.s.r&&(l[f]=Dr(f)),a=l[f]+o;var p=i?(e[u]||[])[f]:e[a];p&&hB(t,p,u,f)}}}function gB(t,e){for(var r=e||{},n=$i(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return We(n,r.biff==4?1033:r.biff==3?521:9,ev(t,16,r)),pB(n,t.Sheets[t.SheetNames[i]],i,r),We(n,10),n.end()}function mB(t,e,r){We(t,49,c3({sz:12,name:"Arial"},r))}function xB(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&We(t,1054,g3(i,e[i],r))})}function vB(t,e){var r=ye(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),We(t,2151,r),r=ye(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),NA(Xt(e["!ref"]||"A1"),r),r.write_shift(4,4),We(t,2152,r)}function yB(t,e){for(var r=0;r<16;++r)We(t,224,E2({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){We(t,224,E2(n,0,e))})}function _B(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];We(t,440,W3(n)),n[1].Tooltip&&We(t,2048,$3(n))}delete e["!links"]}function EB(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&We(t,125,Q3(Wp(i,n),i))})}}function wB(t,e,r,n,i){var s=16+dl(i.cellXfs,e,i);if(e.v==null&&!e.bf){We(t,513,ql(r,n,s));return}if(e.bf)We(t,6,Y5(e,r,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?En(Er(e.v)):e.v;We(t,515,C3(r,n,a,s));break;case"b":case"e":We(t,517,A3(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=lv(i.Strings,e.v,i.revStrings);We(t,253,d3(r,n,o,s))}else We(t,516,h3(r,n,(e.v||"").slice(0,255),s,i));break;default:We(t,513,ql(r,n,s))}}function SB(t,e,r){var n=$i(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},l=Array.isArray(s),u=e.biff==8,f,p="",g=[],m=Xt(s["!ref"]||"A1"),y=u?65536:16384;if(m.e.c>255||m.e.r>=y){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,y-1)}We(n,2057,ev(r,16,e)),We(n,13,Ts(1)),We(n,12,Ts(100)),We(n,15,Ti(!0)),We(n,17,Ti(!1)),We(n,16,Yl(.001)),We(n,95,Ti(!0)),We(n,42,Ti(!1)),We(n,43,Ti(!1)),We(n,130,Ts(1)),We(n,128,T3()),We(n,131,Ti(!1)),We(n,132,Ti(!1)),u&&EB(n,s["!cols"]),We(n,512,x3(m,e)),u&&(s["!links"]=[]);for(var x=m.s.r;x<=m.e.r;++x){p=Yr(x);for(var w=m.s.c;w<=m.e.c;++w){x===m.s.r&&(g[w]=Dr(w)),f=g[w]+p;var A=l?(s[x]||[])[w]:s[f];A&&(wB(n,A,x,w,e),u&&A.l&&s["!links"].push([f,A.l]))}}var k=o.CodeName||o.name||i;return u&&We(n,574,a3((a.Views||[])[0])),u&&(s["!merges"]||[]).length&&We(n,229,L3(s["!merges"])),u&&_B(n,s),We(n,442,CA(k)),u&&vB(n,s),We(n,10),n.end()}function TB(t,e,r){var n=$i(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(We(n,2057,ev(t,5,r)),r.bookType=="xla"&&We(n,135),We(n,225,o?Ts(1200):null),We(n,193,AD(2)),l&&We(n,191),l&&We(n,192),We(n,226),We(n,92,KD("SheetJS",r)),We(n,66,Ts(o?1200:1252)),o&&We(n,353,Ts(0)),o&&We(n,448),We(n,317,e6(t.SheetNames.length)),o&&t.vbaraw&&We(n,211),o&&t.vbaraw){var u=a.CodeName||"ThisWorkbook";We(n,442,CA(u))}We(n,156,Ts(17)),We(n,25,Ti(!1)),We(n,18,Ti(!1)),We(n,19,Ts(0)),o&&We(n,431,Ti(!1)),o&&We(n,444,Ts(0)),We(n,61,i3()),We(n,64,Ti(!1)),We(n,141,Ts(0)),We(n,34,Ti(rL(t)=="true")),We(n,14,Ti(!0)),o&&We(n,439,Ti(!1)),We(n,218,Ts(0)),mB(n,t,r),xB(n,t.SSF,r),yB(n,r),o&&We(n,352,Ti(!1));var f=n.end(),p=$i();o&&We(p,140,K3()),o&&r.Strings&&uB(p,252,JD(r.Strings)),We(p,10);var g=p.end(),m=$i(),y=0,x=0;for(x=0;x<t.SheetNames.length;++x)y+=(o?12:11)+(o?2:1)*t.SheetNames[x].length;var w=f.length+y+g.length;for(x=0;x<t.SheetNames.length;++x){var A=s[x]||{};We(m,133,qD({pos:w,hs:A.Hidden||0,dt:0,name:t.SheetNames[x]},r)),w+=e[x].length}var k=m.end();if(y!=k.length)throw new Error("BS8 "+y+" != "+k.length);var E=[];return f.length&&E.push(f),k.length&&E.push(k),g.length&&E.push(g),Pn(E)}function AB(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=wr(lt)),t&&t.SSF&&(Nu(),Mp(t.SSF),r.revssf=Bp(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,hv(r),r.cellXfs=[],dl(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=SB(i,r,t);return n.unshift(TB(t,n,r)),Pn(n)}function _k(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Gi(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return AB(t,e);case 4:case 3:case 2:return gB(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function M2(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),a=i.index,o=s&&s.index||t.length,l=cR(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,f=0,p=0,g=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(a=0;a<l.length;++a){var x=l[a].trim(),w=x.slice(0,3).toLowerCase();if(w=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}f=0;continue}if(!(w!="<td"&&w!="<th")){var A=x.split(/<\/t[dh]>/i);for(o=0;o<A.length;++o){var k=A[o].trim();if(k.match(/<t[dh]/i)){for(var E=k,P=0;E.charAt(0)=="<"&&(P=E.indexOf(">"))>-1;)E=E.slice(P+1);for(var Y=0;Y<y.length;++Y){var V=y[Y];V.s.c==f&&V.s.r<u&&u<=V.e.r&&(f=V.e.c+1,Y=-1)}var T=dt(k.slice(0,k.indexOf(">")));g=T.colspan?+T.colspan:1,((p=+T.rowspan)>1||g>1)&&y.push({s:{r:u,c:f},e:{r:u+(p||1)-1,c:f+g-1}});var F=T.t||T["data-t"]||"";if(!E.length){f+=g;continue}if(E=HT(E),m.s.r>u&&(m.s.r=u),m.e.r<u&&(m.e.r=u),m.s.c>f&&(m.s.c=f),m.e.c<f&&(m.e.c=f),!E.length){f+=g;continue}var S={t:"s",v:E};r.raw||!E.trim().length||F=="s"||(E==="TRUE"?S={t:"b",v:!0}:E==="FALSE"?S={t:"b",v:!1}:isNaN(Zs(E))?isNaN(gu(E).getDate())||(S={t:"d",v:Er(E)},r.cellDates||(S={t:"n",v:En(S.v)}),S.z=r.dateNF||lt[14]):S={t:"n",v:Zs(E)}),r.dense?(n[u]||(n[u]=[]),n[u][f]=S):n[ut({r:u,c:f})]=S,f+=g}}}}return n["!ref"]=wt(m),y.length&&(n["!merges"]=y),n}function kB(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>a)&&!(i[u].e.r<r||i[u].e.c<a)){if(i[u].s.r<r||i[u].s.c<a){o=-1;break}o=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(o<0)){var f=ut({r,c:a}),p=n.dense?(t[r]||[])[a]:t[f],g=p&&p.v!=null&&(p.h||V1(p.w||(eo(p),p.w)||""))||"",m={};o>1&&(m.rowspan=o),l>1&&(m.colspan=l),n.editable?g='<span contenteditable="true">'+g+"</span>":p&&(m["data-t"]=p&&p.t||"z",p.v!=null&&(m["data-v"]=p.v),p.z!=null&&(m["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+p.l.Target+'">'+g+"</a>")),m.id=(n.id||"sjs")+"-"+f,s.push(ze("td",g,m))}}var y="<tr>";return y+s.join("")+"</tr>"}var CB='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',FB="</body></html>";function bB(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ul(M2(r[0],e),e);var n=mv();return r.forEach(function(i,s){xv(n,M2(i,e),"Sheet"+(s+1))}),n}function IB(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Ek(t,e){var r=e||{},n=r.header!=null?r.header:CB,i=r.footer!=null?r.footer:FB,s=[n],a=Gi(t["!ref"]);r.dense=Array.isArray(t),s.push(IB(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(kB(t,a,o,r));return s.push("</table>"+i),s.join("")}function wk(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Pr(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var f=Gi(t["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),i==-1&&(u.e.r=i=f.e.r+1)}var p=[],g=0,m=t["!rows"]||(t["!rows"]=[]),y=0,x=0,w=0,A=0,k=0,E=0;for(t["!cols"]||(t["!cols"]=[]);y<o.length&&x<l;++y){var P=o[y];if(L2(P)){if(n.display)continue;m[x]={hidden:!0}}var Y=P.children;for(w=A=0;w<Y.length;++w){var V=Y[w];if(!(n.display&&L2(V))){var T=V.hasAttribute("data-v")?V.getAttribute("data-v"):V.hasAttribute("v")?V.getAttribute("v"):HT(V.innerHTML),F=V.getAttribute("data-z")||V.getAttribute("z");for(g=0;g<p.length;++g){var S=p[g];S.s.c==A+s&&S.s.r<x+i&&x+i<=S.e.r&&(A=S.e.c+1-s,g=-1)}E=+V.getAttribute("colspan")||1,((k=+V.getAttribute("rowspan")||1)>1||E>1)&&p.push({s:{r:x+i,c:A+s},e:{r:x+i+(k||1)-1,c:A+s+(E||1)-1}});var I={t:"s",v:T},R=V.getAttribute("data-t")||V.getAttribute("t")||"";T!=null&&(T.length==0?I.t=R||"z":n.raw||T.trim().length==0||R=="s"||(T==="TRUE"?I={t:"b",v:!0}:T==="FALSE"?I={t:"b",v:!1}:isNaN(Zs(T))?isNaN(gu(T).getDate())||(I={t:"d",v:Er(T)},n.cellDates||(I={t:"n",v:En(I.v)}),I.z=n.dateNF||lt[14]):I={t:"n",v:Zs(T)})),I.z===void 0&&F!=null&&(I.z=F);var D="",N=V.getElementsByTagName("A");if(N&&N.length)for(var $e=0;$e<N.length&&!(N[$e].hasAttribute("href")&&(D=N[$e].getAttribute("href"),D.charAt(0)!="#"));++$e);D&&D.charAt(0)!="#"&&(I.l={Target:D}),n.dense?(t[x+i]||(t[x+i]=[]),t[x+i][A+s]=I):t[ut({c:A+s,r:x+i})]=I,u.e.c<A+s&&(u.e.c=A+s),A+=E}}++x}return p.length&&(t["!merges"]=(t["!merges"]||[]).concat(p)),u.e.r=Math.max(u.e.r,x-1+i),t["!ref"]=wt(u),x>=l&&(t["!fullref"]=wt((u.e.r=o.length-y+x-1+i,u))),t}function Sk(t,e){var r=e||{},n=r.dense?[]:{};return wk(n,t,e)}function NB(t,e){return ul(Sk(t,e),e)}function L2(t){var e="",r=RB(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function RB(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function DB(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Yt(e.replace(/<[^>]*>/g,""));return[r]}var B2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Tk(t,e){var r=e||{},n=z1(t),i=[],s,a,o={name:""},l="",u=0,f,p,g={},m=[],y=r.dense?[]:{},x,w,A={value:""},k="",E=0,P=[],Y=-1,V=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}},F=0,S={},I=[],R={},D=0,N=0,$e=[],_e=1,Pe=1,be=[],Te={Names:[]},ie={},Ce=["",""],Be=[],W={},ne="",re=0,q=!1,xe=!1,we=0;for(cf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=cf.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(T.e.c>=T.s.c&&T.e.r>=T.s.r?y["!ref"]=wt(T):y["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=T.e.r&&(y["!fullref"]=y["!ref"],T.e.r=r.sheetRows-1,y["!ref"]=wt(T)),I.length&&(y["!merges"]=I),$e.length&&(y["!rows"]=$e),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),m.push(f.name),g[f.name]=y,xe=!1):x[0].charAt(x[0].length-2)!=="/"&&(f=dt(x[0],!1),Y=V=-1,T.s.r=T.s.c=1e7,T.e.r=T.e.c=0,y=r.dense?[]:{},I=[],$e=[],xe=!0);break;case"table-row-group":x[1]==="/"?--F:++F;break;case"table-row":case"":if(x[1]==="/"){Y+=_e,_e=1;break}if(p=dt(x[0],!1),p.?Y=p.-1:Y==-1&&(Y=0),_e=+p["number-rows-repeated"]||1,_e<10)for(we=0;we<_e;++we)F>0&&($e[Y+we]={level:F});V=-1;break;case"covered-table-cell":x[1]!=="/"&&++V,r.sheetStubs&&(r.dense?(y[Y]||(y[Y]=[]),y[Y][V]={t:"z"}):y[ut({r:Y,c:V})]={t:"z"}),k="",P=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++V,A=dt(x[0],!1),Pe=parseInt(A["number-columns-repeated"]||"1",10),w={t:"z",v:null},A.formula&&r.cellFormula!=!1&&(w.f=D2(Yt(A.formula))),(A.||A["value-type"])=="string"&&(w.t="s",w.v=Yt(A["string-value"]||""),r.dense?(y[Y]||(y[Y]=[]),y[Y][V]=w):y[ut({r:Y,c:V})]=w),V+=Pe-1;else if(x[1]!=="/"){++V,k="",E=0,P=[],Pe=1;var je=_e?Y+_e-1:Y;if(V>T.e.c&&(T.e.c=V),V<T.s.c&&(T.s.c=V),Y<T.s.r&&(T.s.r=Y),je>T.e.r&&(T.e.r=je),A=dt(x[0],!1),Be=[],W={},w={t:A.||A["value-type"],v:null},r.cellFormula)if(A.formula&&(A.formula=Yt(A.formula)),A["number-matrix-columns-spanned"]&&A["number-matrix-rows-spanned"]&&(D=parseInt(A["number-matrix-rows-spanned"],10)||0,N=parseInt(A["number-matrix-columns-spanned"],10)||0,R={s:{r:Y,c:V},e:{r:Y+D-1,c:V+N-1}},w.F=wt(R),be.push([R,w.F])),A.formula)w.f=D2(A.formula);else for(we=0;we<be.length;++we)Y>=be[we][0].s.r&&Y<=be[we][0].e.r&&V>=be[we][0].s.c&&V<=be[we][0].e.c&&(w.F=be[we][1]);switch((A["number-columns-spanned"]||A["number-rows-spanned"])&&(D=parseInt(A["number-rows-spanned"],10)||0,N=parseInt(A["number-columns-spanned"],10)||0,R={s:{r:Y,c:V},e:{r:Y+D-1,c:V+N-1}},I.push(R)),A["number-columns-repeated"]&&(Pe=parseInt(A["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=yr(A["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(A.value);break;case"percentage":w.t="n",w.v=parseFloat(A.value);break;case"currency":w.t="n",w.v=parseFloat(A.value);break;case"date":w.t="d",w.v=Er(A["date-value"]),r.cellDates||(w.t="n",w.v=En(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=aR(A["time-value"])/86400,r.cellDates&&(w.t="d",w.v=jp(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(A.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",A["string-value"]!=null&&(k=Yt(A["string-value"]),P=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(q=!1,w.t==="s"&&(w.v=k||"",P.length&&(w.R=P),q=E==0),ie.Target&&(w.l=ie),Be.length>0&&(w.c=Be,Be=[]),k&&r.cellText!==!1&&(w.w=k),q&&(w.t="z",delete w.v),(!q||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=Y))for(var Ie=0;Ie<_e;++Ie){if(Pe=parseInt(A["number-columns-repeated"]||"1",10),r.dense)for(y[Y+Ie]||(y[Y+Ie]=[]),y[Y+Ie][V]=Ie==0?w:wr(w);--Pe>0;)y[Y+Ie][V+Pe]=wr(w);else for(y[ut({r:Y+Ie,c:V})]=w;--Pe>0;)y[ut({r:Y+Ie,c:V+Pe})]=wr(w);T.e.c<=V&&(T.e.c=V)}Pe=parseInt(A["number-columns-repeated"]||"1",10),V+=Pe-1,Pe=0,w={},k="",P=[]}ie={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s;W.t=k,P.length&&(W.R=P),W.a=ne,Be.push(W)}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);ne="",re=0,k="",E=0,P=[];break;case"creator":x[1]==="/"?ne=n.slice(re,x.index):re=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);k="",E=0,P=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(S[o.name]=l,(s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&(l="",o=dt(x[0],!1),i.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=dt(x[0],!1),l+=B2[x[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=dt(x[0],!1),l+=B2[x[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,x.index);break}else u=x.index+x[0].length;break;case"named-range":a=dt(x[0],!1),Ce=Ug(a["cell-range-address"]);var Ae={Name:a.name,Ref:Ce[0]+"!"+Ce[1]};xe&&(Ae.Sheet=m.length),Te.Names.push(Ae);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(x[1]==="/"&&(!A||!A["string-value"])){var nt=DB(n.slice(E,x.index));k=(k.length>0?k+`
`:"")+nt[0]}else dt(x[0],!1),E=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{Ce=Ug(dt(x[0])["target-range-address"]),g[Ce[0]]["!autofilter"]={ref:Ce[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(ie=dt(x[0],!1),!ie.href)break;ie.Target=Yt(ie.href),delete ie.href,ie.Target.charAt(0)=="#"&&ie.Target.indexOf(".")>-1?(Ce=Ug(ie.Target.slice(1)),ie.Target="#"+Ce[0]+"!"+Ce[1]):ie.Target.match(/^\.\.[\\\/]/)&&(ie.Target=ie.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var J={Sheets:g,SheetNames:m,Workbook:Te};return r.bookSheets&&delete J.Sheets,J}function j2(t,e){e=e||{},Ss(t,"META-INF/manifest.xml")&&aD(tn(t,"META-INF/manifest.xml"),e);var r=es(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Tk(ur(r),e);return Ss(t,"meta.xml")&&(n.Props=pA(tn(t,"meta.xml"))),n}function U2(t,e){return Tk(t,e)}var PB=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+lf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Xr+e}}(),V2=function(){var t=function(s){return ir(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+ir(a.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,f=0,p=Gi(s["!ref"]||"A1"),g=s["!merges"]||[],m=0,y=Array.isArray(s);if(s["!cols"])for(f=0;f<=p.e.c;++f)l.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var x="",w=s["!rows"]||[];for(u=0;u<p.s.r;++u)x=w[u]?' table:style-name="ro'+w[u].ods+'"':"",l.push("        <table:table-row"+x+`></table:table-row>
`);for(;u<=p.e.r;++u){for(x=w[u]?' table:style-name="ro'+w[u].ods+'"':"",l.push("        <table:table-row"+x+`>
`),f=0;f<p.s.c;++f)l.push(e);for(;f<=p.e.c;++f){var A=!1,k={},E="";for(m=0;m!=g.length;++m)if(!(g[m].s.c>f)&&!(g[m].s.r>u)&&!(g[m].e.c<f)&&!(g[m].e.r<u)){(g[m].s.c!=f||g[m].s.r!=u)&&(A=!0),k["table:number-columns-spanned"]=g[m].e.c-g[m].s.c+1,k["table:number-rows-spanned"]=g[m].e.r-g[m].s.r+1;break}if(A){l.push(r);continue}var P=ut({r:u,c:f}),Y=y?(s[u]||[])[f]:s[P];if(Y&&Y.f&&(k["table:formula"]=ir(eO(Y.f)),Y.F&&Y.F.slice(0,P.length)==P)){var V=Gi(Y.F);k["table:number-matrix-columns-spanned"]=V.e.c-V.s.c+1,k["table:number-matrix-rows-spanned"]=V.e.r-V.s.r+1}if(!Y){l.push(e);continue}switch(Y.t){case"b":E=Y.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=Y.v?"true":"false";break;case"n":E=Y.w||String(Y.v||0),k["office:value-type"]="float",k["office:value"]=Y.v||0;break;case"s":case"str":E=Y.v==null?"":Y.v,k["office:value-type"]="string";break;case"d":E=Y.w||Er(Y.v).toISOString(),k["office:value-type"]="date",k["office:date-value"]=Er(Y.v).toISOString(),k["table:style-name"]="ce1";break;default:l.push(e);continue}var T=t(E);if(Y.l&&Y.l.Target){var F=Y.l.Target;F=F.charAt(0)=="#"?"#"+tO(F.slice(1)):F,F.charAt(0)!="#"&&!F.match(/^\w+:/)&&(F="../"+F),T=ze("text:a",T,{"xlink:href":F.replace(/&/g,"&amp;")})}l.push("          "+ze("table:table-cell",ze("text:p",T,{}),k)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var f=0;f<u["!cols"].length;++f)if(u["!cols"][f]){var p=u["!cols"][f];if(p.width==null&&p.wpx==null&&p.wch==null)continue;el(p),p.ods=o;var g=u["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var f=0;f<u["!rows"].length;++f)if(u["!rows"][f]){u["!rows"][f].ods=l;var p=u["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[Xr],u=lf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=lf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+f+`>
`),l.push(hA().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var p=0;p!=a.SheetNames.length;++p)l.push(n(a.Sheets[a.SheetNames[p]],a,p));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function Ak(t,e){if(e.bookType=="fods")return V2(t,e);var r=B1(),n="",i=[],s=[];return n="mimetype",St(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",St(r,n,V2(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",St(r,n,PB(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",St(r,n,Xr+hA()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",St(r,n,cD(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",St(r,n,oD(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ql(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function hx(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):ur(cl(t))}function OB(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Zi(ga(t))}function MB(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function rl(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function z2(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function LB(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function BB(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function mf(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function rr(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function zr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Qt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=mf(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=mf(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:o,type:s};e[i]==null?e[i]=[u]:e[i].push(u)}return e}function zn(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(rr(n*8+i.type)),i.type==2&&e.push(rr(i.data.length)),e.push(i.data))})}),rl(e)}function dv(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function Es(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=mf(t,n),s=Qt(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:zr(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=Qt(o.data),u=zr(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=s[3])!=null&&e[0]&&(a.merge=zr(s[3][0].data)>>>0>0),r.push(a)}return r}function Cc(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:rr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:rr(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:rr(a.data.length)}],n[2].push({data:zn(a.meta),type:2})});var s=zn(n);e.push(rr(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),rl(e)}function jB(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=mf(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,u=0;if(s==1?(u=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[rl(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var f=rl(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function ws(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(jB(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return rl(e)}function Fc(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=rr(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return rl(e)}function UB(t,e,r,n){var i=Ql(t),s=i.getUint32(4,!0),a=(n>1?12:8)+z2(s&(n>1?3470:398))*4,o=-1,l=-1,u=NaN,f=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=z2(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(a,!0),a+=4),s&32&&(u=i.getFloat64(a,!0),a+=8),s&64&&(f.setTime(f.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var p;switch(t[2]){case 0:break;case 2:p={t:"n",v:u};break;case 3:p={t:"s",v:e[l]};break;case 5:p={t:"d",v:f};break;case 6:p={t:"b",v:u>0};break;case 7:p={t:"n",v:u/86400};break;case 8:p={t:"e",v:0};break;case 9:if(o>-1)p={t:"s",v:r[o]};else if(l>-1)p={t:"s",v:e[l]};else if(!isNaN(u))p={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return p}function VB(t,e,r){var n=Ql(t),i=n.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,u=NaN,f=new Date(2001,0,1);i&1&&(l=LB(t,s),s+=16),i&2&&(u=n.getFloat64(s,!0),s+=8),i&4&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var p;switch(t[1]){case 0:break;case 2:p={t:"n",v:l};break;case 3:p={t:"s",v:e[o]};break;case 5:p={t:"d",v:f};break;case 6:p={t:"b",v:u>0};break;case 7:p={t:"n",v:u/86400};break;case 8:p={t:"e",v:0};break;case 9:if(a>-1)p={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:p={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return p}function zg(t,e){var r=new Uint8Array(32),n=Ql(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,BB(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function Wg(t,e){var r=new Uint8Array(32),n=Ql(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function zB(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return UB(t,e,r,t[0]);case 5:return VB(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function ii(t){var e=Qt(t);return mf(e[1][0].data)}function W2(t,e){var r=Qt(e.data),n=zr(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=Qt(a.data),l=zr(o[1][0].data)>>>0;switch(n){case 1:s[l]=hx(o[3][0].data);break;case 8:{var u=t[ii(o[9][0].data)][0],f=Qt(u.data),p=t[ii(f[1][0].data)][0],g=zr(p.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var m=Qt(p.data);s[l]=m[3].map(function(y){return hx(y.data)}).join("")}break}}),s}function WB(t,e){var r,n,i,s,a,o,l,u,f,p,g,m,y,x,w=Qt(t),A=zr(w[1][0].data)>>>0,k=zr(w[2][0].data)>>>0,E=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&zr(w[8][0].data)>0||!1,P,Y;if((s=(i=w[7])==null?void 0:i[0])!=null&&s.data&&e!=0)P=(o=(a=w[7])==null?void 0:a[0])==null?void 0:o.data,Y=(u=(l=w[6])==null?void 0:l[0])==null?void 0:u.data;else if((p=(f=w[4])==null?void 0:f[0])!=null&&p.data&&e!=1)P=(m=(g=w[4])==null?void 0:g[0])==null?void 0:m.data,Y=(x=(y=w[3])==null?void 0:y[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var V=E?4:1,T=Ql(P),F=[],S=0;S<P.length/2;++S){var I=T.getUint16(S*2,!0);I<65535&&F.push([S,I])}if(F.length!=k)throw"Expected ".concat(k," cells, found ").concat(F.length);var R=[];for(S=0;S<F.length-1;++S)R[F[S][0]]=Y.subarray(F[S][1]*V,F[S+1][1]*V);return F.length>=1&&(R[F[F.length-1][0]]=Y.subarray(F[F.length-1][1]*V)),{R:A,cells:R}}function HB(t,e){var r,n=Qt(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?zr(n[7][0].data)>>>0>0?1:0:-1,s=dv(n[5],function(a){return WB(a,i)});return{nrows:zr(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,u){if(a[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));a[o.R][u]=l}),a},[])}}function $B(t,e,r){var n,i=Qt(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(zr(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(zr(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=wt(s);var a=Qt(i[4][0].data),o=W2(t,t[ii(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?W2(t,t[ii(a[17][0].data)][0]):[],u=Qt(a[3][0].data),f=0;u[1].forEach(function(p){var g=Qt(p.data),m=t[ii(g[2][0].data)][0],y=zr(m.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var x=HB(t,m);x.data.forEach(function(w,A){w.forEach(function(k,E){var P=ut({r:f+A,c:E}),Y=zB(k,o,l);Y&&(r[P]=Y)})}),f+=x.nrows})}function GB(t,e){var r=Qt(e.data),n={"!ref":"A1"},i=t[ii(r[2][0].data)],s=zr(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return $B(t,i[0],n),n}function KB(t,e){var r,n=Qt(e.data),i={name:(r=n[1])!=null&&r[0]?hx(n[1][0].data):"",sheets:[]},s=dv(n[2],ii);return s.forEach(function(a){t[a].forEach(function(o){var l=zr(o.meta[1][0].data);l==6e3&&i.sheets.push(GB(t,o))})}),i}function YB(t,e){var r=mv(),n=Qt(e.data),i=dv(n[1],ii);if(i.forEach(function(s){t[s].forEach(function(a){var o=zr(a.meta[1][0].data);if(o==2){var l=KB(t,a);l.sheets.forEach(function(u,f){xv(r,u,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Hg(t){var e,r,n,i,s={},a=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=ws(l.content)}catch(p){return console.log("?? "+l.content.length+" "+(p.message||p))}var f;try{f=Es(u)}catch(p){return console.log("## "+(p.message||p))}f.forEach(function(p){s[p.id]=p.messages,a.push(p.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&zr(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(u){var f=zr(u.meta[1][0].data)>>>0;if(f==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return YB(s,o)}function XB(t,e,r){var n,i,s,a;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=t[8])==null?void 0:s[0])==null?void 0:a.data)&&zr(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=Ql(t[7][0].data),f=0,p=[],g=Ql(t[4][0].data),m=0,y=[],x=0;x<e.length;++x){if(e[x]==null){u.setUint16(x*2,65535,!0),g.setUint16(x*2,65535);continue}u.setUint16(x*2,f,!0),g.setUint16(x*2,m,!0);var w,A;switch(typeof e[x]){case"string":w=zg({t:"s",v:e[x]},r),A=Wg({t:"s",v:e[x]},r);break;case"number":w=zg({t:"n",v:e[x]},r),A=Wg({t:"n",v:e[x]},r);break;case"boolean":w=zg({t:"b",v:e[x]},r),A=Wg({t:"b",v:e[x]},r);break;default:throw new Error("Unsupported value "+e[x])}p.push(w),f+=w.length,y.push(A),m+=A.length,++l}for(t[2][0].data=rr(l);x<t[7][0].data.length/2;++x)u.setUint16(x*2,65535,!0),g.setUint16(x*2,65535,!0);return t[6][0].data=rl(p),t[3][0].data=rl(y),l}function qB(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Gi(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(wt(n)));var s=tp(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(ne){return ne.forEach(function(re){typeof re=="string"&&a.push(re)})});var o={},l=[],u=tt.read(e.numbers,{type:"base64"});u.FileIndex.map(function(ne,re){return[ne,u.FullPaths[re]]}).forEach(function(ne){var re=ne[0],q=ne[1];if(re.type==2&&re.name.match(/\.iwa/)){var xe=re.content,we=ws(xe),je=Es(we);je.forEach(function(Ie){l.push(Ie.id),o[Ie.id]={deps:[],location:q,type:zr(Ie.messages[0].meta[1][0].data)}})}}),l.sort(function(ne,re){return ne-re});var f=l.filter(function(ne){return ne>1}).map(function(ne){return[ne,rr(ne)]});u.FileIndex.map(function(ne,re){return[ne,u.FullPaths[re]]}).forEach(function(ne){var re=ne[0];if(ne[1],!!re.name.match(/\.iwa/)){var q=Es(ws(re.content));q.forEach(function(xe){xe.messages.forEach(function(we){f.forEach(function(je){xe.messages.some(function(Ie){return zr(Ie.meta[1][0].data)!=11006&&MB(Ie.data,je[1])})&&o[je[0]].deps.push(xe.id)})})})}});for(var p=tt.find(u,o[1].location),g=Es(ws(p.content)),m,y=0;y<g.length;++y){var x=g[y];x.id==1&&(m=x)}var w=ii(Qt(m.messages[0].data)[1][0].data);for(p=tt.find(u,o[w].location),g=Es(ws(p.content)),y=0;y<g.length;++y)x=g[y],x.id==w&&(m=x);for(w=ii(Qt(m.messages[0].data)[2][0].data),p=tt.find(u,o[w].location),g=Es(ws(p.content)),y=0;y<g.length;++y)x=g[y],x.id==w&&(m=x);for(w=ii(Qt(m.messages[0].data)[2][0].data),p=tt.find(u,o[w].location),g=Es(ws(p.content)),y=0;y<g.length;++y)x=g[y],x.id==w&&(m=x);var A=Qt(m.messages[0].data);{A[6][0].data=rr(n.e.r+1),A[7][0].data=rr(n.e.c+1);var k=ii(A[46][0].data),E=tt.find(u,o[k].location),P=Es(ws(E.content));{for(var Y=0;Y<P.length&&P[Y].id!=k;++Y);if(P[Y].id!=k)throw"Bad ColumnRowUIDMapArchive";var V=Qt(P[Y].messages[0].data);V[1]=[],V[2]=[],V[3]=[];for(var T=0;T<=n.e.c;++T){var F=[];F[1]=F[2]=[{type:0,data:rr(T+420690)}],V[1].push({type:2,data:zn(F)}),V[2].push({type:0,data:rr(T)}),V[3].push({type:0,data:rr(T)})}V[4]=[],V[5]=[],V[6]=[];for(var S=0;S<=n.e.r;++S)F=[],F[1]=F[2]=[{type:0,data:rr(S+726270)}],V[4].push({type:2,data:zn(F)}),V[5].push({type:0,data:rr(S)}),V[6].push({type:0,data:rr(S)});P[Y].messages[0].data=zn(V)}E.content=Fc(Cc(P)),E.size=E.content.length,delete A[46];var I=Qt(A[4][0].data);{I[7][0].data=rr(n.e.r+1);var R=Qt(I[1][0].data),D=ii(R[2][0].data);E=tt.find(u,o[D].location),P=Es(ws(E.content));{if(P[0].id!=D)throw"Bad HeaderStorageBucket";var N=Qt(P[0].messages[0].data);for(S=0;S<s.length;++S){var $e=Qt(N[2][0].data);$e[1][0].data=rr(S),$e[4][0].data=rr(s[S].length),N[2][S]={type:N[2][0].type,data:zn($e)}}P[0].messages[0].data=zn(N)}E.content=Fc(Cc(P)),E.size=E.content.length;var _e=ii(I[2][0].data);E=tt.find(u,o[_e].location),P=Es(ws(E.content));{if(P[0].id!=_e)throw"Bad HeaderStorageBucket";for(N=Qt(P[0].messages[0].data),T=0;T<=n.e.c;++T)$e=Qt(N[2][0].data),$e[1][0].data=rr(T),$e[4][0].data=rr(n.e.r+1),N[2][T]={type:N[2][0].type,data:zn($e)};P[0].messages[0].data=zn(N)}E.content=Fc(Cc(P)),E.size=E.content.length;var Pe=ii(I[4][0].data);(function(){for(var ne=tt.find(u,o[Pe].location),re=Es(ws(ne.content)),q,xe=0;xe<re.length;++xe){var we=re[xe];we.id==Pe&&(q=we)}var je=Qt(q.messages[0].data);{je[3]=[];var Ie=[];a.forEach(function(J,Mt){Ie[1]=[{type:0,data:rr(Mt)}],Ie[2]=[{type:0,data:rr(1)}],Ie[3]=[{type:2,data:OB(J)}],je[3].push({type:2,data:zn(Ie)})})}q.messages[0].data=zn(je);var Ae=Cc(re),nt=Fc(Ae);ne.content=nt,ne.size=ne.content.length})();var be=Qt(I[3][0].data);{var Te=be[1][0];delete be[2];var ie=Qt(Te.data);{var Ce=ii(ie[2][0].data);(function(){for(var ne=tt.find(u,o[Ce].location),re=Es(ws(ne.content)),q,xe=0;xe<re.length;++xe){var we=re[xe];we.id==Ce&&(q=we)}var je=Qt(q.messages[0].data);{delete je[6],delete be[7];var Ie=new Uint8Array(je[5][0].data);je[5]=[];for(var Ae=0,nt=0;nt<=n.e.r;++nt){var J=Qt(Ie);Ae+=XB(J,s[nt],a),J[1][0].data=rr(nt),je[5].push({data:zn(J),type:2})}je[1]=[{type:0,data:rr(n.e.c+1)}],je[2]=[{type:0,data:rr(n.e.r+1)}],je[3]=[{type:0,data:rr(Ae)}],je[4]=[{type:0,data:rr(n.e.r+1)}]}q.messages[0].data=zn(je);var Mt=Cc(re),Et=Fc(Mt);ne.content=Et,ne.size=ne.content.length})()}Te.data=zn(ie)}I[3][0].data=zn(be)}A[4][0].data=zn(I)}m.messages[0].data=zn(A);var Be=Cc(g),W=Fc(Be);return p.content=W,p.size=p.content.length,u}function kk(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function fv(t){kk([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function hv(t){kk([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function QB(t){return bt.WS.indexOf(t)>-1?"sheet":t==bt.CS?"chart":t==bt.DS?"dialog":t==bt.MS?"macro":t&&t.length?t:"sheet"}function JB(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,QB(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function ZB(t,e,r,n,i,s,a,o,l,u,f,p){try{s[n]=Id(es(t,r,!0),e);var g=tn(t,e),m;switch(o){case"sheet":m=EL(g,e,i,l,s[n],u,f,p);break;case"chart":if(m=wL(g,e,i,l,s[n],u,f,p),!m||!m["!drawel"])break;var y=hd(m["!drawel"].Target,e),x=uf(y),w=l8(es(t,y,!0),Id(es(t,x,!0),y)),A=hd(w,y),k=uf(A);m=XM(es(t,A,!0),A,l,Id(es(t,k,!0),A),u,m);break;case"macro":m=SL(g,e,i,l,s[n],u,f,p);break;case"dialog":m=TL(g,e,i,l,s[n],u,f,p);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=m;var E=[];s&&s[n]&&Wr(s[n]).forEach(function(P){var Y="";if(s[n][P].Type==bt.CMNT){Y=hd(s[n][P].Target,e);var V=FL(tn(t,Y,!0),Y,l);if(!V||!V.length)return;F2(m,V,!1)}s[n][P].Type==bt.TCMNT&&(Y=hd(s[n][P].Target,e),E=E.concat(u8(tn(t,Y,!0),l)))}),E&&E.length&&F2(m,E,!0,l.people||[])}catch(P){if(l.WTF)throw P}}function ys(t){return t.charAt(0)=="/"?t.slice(1):t}function ej(t,e){if(Nu(),e=e||{},fv(e),Ss(t,"META-INF/manifest.xml")||Ss(t,"objectdata.xml"))return j2(t,e);if(Ss(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Hg<"u"){if(t.FileIndex)return Hg(t);var r=tt.utils.cfb_new();return X_(t).forEach(function($e){St(r,$e,dR(t,$e))}),Hg(r)}throw new Error("Unsupported NUMBERS file")}if(!Ss(t,"[Content_Types].xml"))throw Ss(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ss(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=X_(t),i=iD(es(t,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",tn(t,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!tn(t,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},u={};if(!e.bookSheets&&!e.bookProps){if(Nd=[],i.sst)try{Nd=CL(tn(t,ys(i.sst)),i.sst,e)}catch($e){if(e.WTF)throw $e}e.cellStyles&&i.themes.length&&(l=kL(es(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(u=AL(tn(t,ys(i.style)),i.style,l,e))}i.links.map(function($e){try{var _e=Id(es(t,uf(ys($e))),$e);return IL(tn(t,ys($e)),_e,$e,e)}catch{}});var f=_L(tn(t,ys(i.workbooks[0])),i.workbooks[0],e),p={},g="";i.coreprops.length&&(g=tn(t,ys(i.coreprops[0]),!0),g&&(p=pA(g)),i.extprops.length!==0&&(g=tn(t,ys(i.extprops[0]),!0),g&&dD(g,p,e)));var m={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(g=es(t,ys(i.custprops[0]),!0),g&&(m=hD(g,e)));var y={};if((e.bookSheets||e.bookProps)&&(f.Sheets?a=f.Sheets.map(function(_e){return _e.name}):p.Worksheets&&p.SheetNames.length>0&&(a=p.SheetNames),e.bookProps&&(y.Props=p,y.Custprops=m),e.bookSheets&&typeof a<"u"&&(y.SheetNames=a),e.bookSheets?y.SheetNames:e.bookProps))return y;a={};var x={};e.bookDeps&&i.calcchain&&(x=bL(tn(t,ys(i.calcchain)),i.calcchain));var w=0,A={},k,E;{var P=f.Sheets;p.Worksheets=P.length,p.SheetNames=[];for(var Y=0;Y!=P.length;++Y)p.SheetNames[Y]=P[Y].name}var V=s?"bin":"xml",T=i.workbooks[0].lastIndexOf("/"),F=(i.workbooks[0].slice(0,T+1)+"_rels/"+i.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");Ss(t,F)||(F="xl/_rels/workbook."+V+".rels");var S=Id(es(t,F,!0),F.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=NL(tn(t,ys(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=f8(tn(t,ys(i.people[0])),e)),S&&(S=JB(S,f.Sheets));var I=tn(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=p.Worksheets;++w){var R="sheet";if(S&&S[w]?(k="xl/"+S[w][1].replace(/[\/]?xl\//,""),Ss(t,k)||(k=S[w][1]),Ss(t,k)||(k=F.replace(/_rels\/.*$/,"")+S[w][1]),R=S[w][2]):(k="xl/worksheets/sheet"+(w+1-I)+"."+V,k=k.replace(/sheet0\./,"sheet.")),E=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(w!=e.sheets)continue e;break;case"string":if(p.SheetNames[w].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var D=!1,N=0;N!=e.sheets.length;++N)typeof e.sheets[N]=="number"&&e.sheets[N]==w&&(D=1),typeof e.sheets[N]=="string"&&e.sheets[N].toLowerCase()==p.SheetNames[w].toLowerCase()&&(D=1);if(!D)continue e}}ZB(t,k,E,p.SheetNames[w],w,A,a,R,e,f,l,u)}return y={Directory:i,Workbook:f,Props:p,Custprops:m,Deps:x,Sheets:a,SheetNames:p.SheetNames,Strings:Nd,Styles:u,Themes:l,SSF:wr(lt)},e&&e.bookFiles&&(t.files?(y.keys=n,y.files=t.files):(y.keys=[],y.files={},t.FullPaths.forEach(function($e,_e){$e=$e.replace(/^Root Entry[\/]/,""),y.keys.push($e),y.files[$e]=t.FileIndex[_e]}))),e&&e.bookVBA&&(i.vba.length>0?y.vbaraw=tn(t,ys(i.vba[0]),!0):i.defaults&&i.defaults.bin===_8&&(y.vbaraw=tn(t,"xl/vbaProject.bin",!0))),y}function tj(t,e){var r=e||{},n="Workbook",i=tt.find(t,n);try{if(n="/!DataSpaces/Version",i=tt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(N6(i.content),n="/!DataSpaces/DataSpaceMap",i=tt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=D6(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=tt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=P6(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=tt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);M6(i.content)}catch{}if(n="/EncryptionInfo",i=tt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=L6(i.content);if(n="/EncryptedPackage",i=tt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function rj(t,e){return e.bookType=="ods"?Ak(t,e):e.bookType=="numbers"?qB(t,e):e.bookType=="xlsb"?nj(t,e):ij(t,e)}function nj(t,e){Gc=1024,t&&!t.SSF&&(t.SSF=wr(lt)),t&&t.SSF&&(Nu(),Mp(t.SSF),e.revssf=Bp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Rd?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=ZA.indexOf(e.bookType)>-1,i=J1();hv(e=e||{});var s=B1(),a="",o=0;if(e.cellXfs=[],dl(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",St(s,a,gA(t.Props,e)),i.coreprops.push(a),nr(e.rels,2,a,bt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,St(s,a,vA(t.Props)),i.extprops.push(a),nr(e.rels,3,a,bt.EXT_PROPS),t.Custprops!==t.Props&&Wr(t.Custprops||{}).length>0&&(a="docProps/custom.xml",St(s,a,yA(t.Custprops)),i.custprops.push(a),nr(e.rels,4,a,bt.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var f={"!id":{}},p=t.Sheets[t.SheetNames[o-1]],g=(p||{})["!type"]||"sheet";switch(g){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,St(s,a,DL(o-1,a,e,t,f)),i.sheets.push(a),nr(e.wbrels,-1,"worksheets/sheet"+o+"."+r,bt.WS[0])}if(p){var m=p["!comments"],y=!1,x="";m&&m.length>0&&(x="xl/comments"+o+"."+r,St(s,x,ML(m,x)),i.comments.push(x),nr(f,-1,"../comments"+o+"."+r,bt.CMNT),y=!0),p["!legacy"]&&y&&St(s,"xl/drawings/vmlDrawing"+o+".vml",QA(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}f["!id"].rId1&&St(s,uf(a),tu(f))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,St(s,a,OL(e.Strings,a,e)),i.strs.push(a),nr(e.wbrels,-1,"sharedStrings."+r,bt.SST)),a="xl/workbook."+r,St(s,a,RL(t,a)),i.workbooks.push(a),nr(e.rels,1,a,bt.WB),a="xl/theme/theme1.xml",St(s,a,iv(t.Themes,e)),i.themes.push(a),nr(e.wbrels,-1,"theme/theme1.xml",bt.THEME),a="xl/styles."+r,St(s,a,PL(t,a,e)),i.styles.push(a),nr(e.wbrels,-1,"styles."+r,bt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",St(s,a,t.vbaraw),i.vba.push(a),nr(e.wbrels,-1,"vbaProject.bin",bt.VBA)),a="xl/metadata."+r,St(s,a,LL(a)),i.metadata.push(a),nr(e.wbrels,-1,"metadata."+r,bt.XLMETA),St(s,"[Content_Types].xml",fA(i,e)),St(s,"_rels/.rels",tu(e.rels)),St(s,"xl/_rels/workbook."+r+".rels",tu(e.wbrels)),delete e.revssf,delete e.ssf,s}function ij(t,e){Gc=1024,t&&!t.SSF&&(t.SSF=wr(lt)),t&&t.SSF&&(Nu(),Mp(t.SSF),e.revssf=Bp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Rd?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=ZA.indexOf(e.bookType)>-1,i=J1();hv(e=e||{});var s=B1(),a="",o=0;if(e.cellXfs=[],dl(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",St(s,a,gA(t.Props,e)),i.coreprops.push(a),nr(e.rels,2,a,bt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,St(s,a,vA(t.Props)),i.extprops.push(a),nr(e.rels,3,a,bt.EXT_PROPS),t.Custprops!==t.Props&&Wr(t.Custprops||{}).length>0&&(a="docProps/custom.xml",St(s,a,yA(t.Custprops)),i.custprops.push(a),nr(e.rels,4,a,bt.CUST_PROPS));var f=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var p={"!id":{}},g=t.Sheets[t.SheetNames[o-1]],m=(g||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,St(s,a,uk(o-1,e,t,p)),i.sheets.push(a),nr(e.wbrels,-1,"worksheets/sheet"+o+"."+r,bt.WS[0])}if(g){var y=g["!comments"],x=!1,w="";if(y&&y.length>0){var A=!1;y.forEach(function(k){k[1].forEach(function(E){E.T==!0&&(A=!0)})}),A&&(w="xl/threadedComments/threadedComment"+o+"."+r,St(s,w,d8(y,f,e)),i.threadedcomments.push(w),nr(p,-1,"../threadedComments/threadedComment"+o+"."+r,bt.TCMNT)),w="xl/comments"+o+"."+r,St(s,w,JA(y)),i.comments.push(w),nr(p,-1,"../comments"+o+"."+r,bt.CMNT),x=!0}g["!legacy"]&&x&&St(s,"xl/drawings/vmlDrawing"+o+".vml",QA(o,g["!comments"])),delete g["!comments"],delete g["!legacy"]}p["!id"].rId1&&St(s,uf(a),tu(p))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,St(s,a,jA(e.Strings,e)),i.strs.push(a),nr(e.wbrels,-1,"sharedStrings."+r,bt.SST)),a="xl/workbook."+r,St(s,a,gk(t)),i.workbooks.push(a),nr(e.rels,1,a,bt.WB),a="xl/theme/theme1.xml",St(s,a,iv(t.Themes,e)),i.themes.push(a),nr(e.wbrels,-1,"theme/theme1.xml",bt.THEME),a="xl/styles."+r,St(s,a,KA(t,e)),i.styles.push(a),nr(e.wbrels,-1,"styles."+r,bt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",St(s,a,t.vbaraw),i.vba.push(a),nr(e.wbrels,-1,"vbaProject.bin",bt.VBA)),a="xl/metadata."+r,St(s,a,qA()),i.metadata.push(a),nr(e.wbrels,-1,"metadata."+r,bt.XLMETA),f.length>1&&(a="xl/persons/person.xml",St(s,a,h8(f)),i.people.push(a),nr(e.wbrels,-1,"persons/person.xml",bt.PEOPLE)),St(s,"[Content_Types].xml",fA(i,e)),St(s,"_rels/.rels",tu(e.rels)),St(s,"xl/_rels/workbook."+r+".rels",tu(e.wbrels)),delete e.revssf,delete e.ssf,s}function pv(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=ss(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function sj(t,e){return tt.find(t,"EncryptedPackage")?tj(t,e):yk(t,e)}function aj(t,e){var r,n=t,i=e||{};return i.type||(i.type=Ft&&Buffer.isBuffer(t)?"buffer":"base64"),r=VT(n,i),ej(r,i)}function Ck(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return dx(t.slice(r),e);default:break e}return mu.to_workbook(t,e)}function oj(t,e){var r="",n=pv(t,e);switch(e.type){case"base64":r=ss(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Kl(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=ur(r)),e.type="binary",Ck(r,e)}function lj(t,e){var r=t;return e.type=="base64"&&(r=ss(r)),r=nf.utils.decode(1200,r.slice(2),"str"),e.type="binary",Ck(r,e)}function cj(t){return t.match(/[^\x00-\x7F]/)?ga(t):t}function $g(t,e,r,n){return n?(r.type="string",mu.to_workbook(t,r)):mu.to_workbook(e,r)}function Cl(t,e){D1();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Cl(new Uint8Array(t),(r=wr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),nu={},r.dateNF&&(nu.dateNF=r.dateNF),r.type||(r.type=Ft&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Ft?"buffer":"binary",n=nR(t),typeof Uint8Array<"u"&&!Ft&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=cj(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=wr(r),r.type="array",Cl(P1(n),r)}switch((i=pv(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return sj(tt.read(n,r),r);break;case 9:if(i[1]<=8)return yk(n,r);break;case 60:return dx(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return p6(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return LA.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?aj(n,r):$g(t,n,r,s);case 239:return i[3]===60?dx(n,r):$g(t,n,r,s);case 255:if(i[1]===254)return lj(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Ll.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Ll.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return ux.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return HA.to_workbook(n,r);break;case 10:case 13:case 32:return oj(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return h6.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?ux.to_workbook(n,r):$g(t,n,r,s)}function Fk(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Df(e.file,tt.write(t,{type:Ft?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return tt.write(t,e)}function uj(t,e){var r=wr(e||{}),n=rj(t,r);return dj(n,r)}function dj(t,e){var r={},n=Ft?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?tt.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Op(i))}return e.password&&typeof encrypt_agile<"u"?Fk(encrypt_agile(i,e.password),e):e.type==="file"?Df(e.file,i):e.type=="string"?ur(i):i}function fj(t,e){var r=e||{},n=cB(t,r);return Fk(n,r)}function fa(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return sf(ga(n));case"binary":return ga(n);case"string":return t;case"file":return Df(e.file,n,"utf8");case"buffer":return Ft?oo(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):fa(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function hj(t,e){switch(e.type){case"base64":return sf(t);case"binary":return t;case"string":return t;case"file":return Df(e.file,t,"binary");case"buffer":return Ft?oo(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function L0(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?sf(r):e.type=="string"?ur(r):r;case"file":return Df(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function bk(t,e){D1(),sL(t);var r=wr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=bk(t,r);return r.type="array",Op(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return fa(rB(t,r),r);case"slk":case"sylk":return fa(MA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return fa(Ek(t.Sheets[t.SheetNames[i]],r),r);case"txt":return hj(Ik(t.Sheets[t.SheetNames[i]],r),r);case"csv":return fa(gv(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return fa(LA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return L0(ux.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return fa(mu.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return fa(HA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return fa(BA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return fa(Ak(t,r),r);case"wk1":return L0(Ll.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return L0(Ll.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),L0(_k(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),fj(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return uj(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function pj(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function bc(t,e,r){var n={};return n.type="file",n.file=e,pj(n),bk(t,n)}function gj(t,e,r,n,i,s,a,o){var l=Yr(r),u=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),p=!0,g=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:r,enumerable:!1})}catch{g.__rowNum__=r}else g.__rowNum__=r;if(!a||t[r])for(var m=e.s.c;m<=e.e.c;++m){var y=a?t[r][m]:t[n[m]+l];if(y===void 0||y.t===void 0){if(u===void 0)continue;s[m]!=null&&(g[s[m]]=u);continue}var x=y.v;switch(y.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(s[m]!=null){if(x==null)if(y.t=="e"&&x===null)g[s[m]]=null;else if(u!==void 0)g[s[m]]=u;else if(f&&x===null)g[s[m]]=null;else continue;else g[s[m]]=f&&(y.t!=="n"||y.t==="n"&&o.rawNumbers!==!1)?x:eo(y,x,o);x!=null&&(p=!1)}}return{row:g,isempty:p}}function tp(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},f=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":l=Xt(f);break;case"number":l=Xt(t["!ref"]),l.s.r=f;break;default:l=f}n>0&&(i=0);var p=Yr(l.s.r),g=[],m=[],y=0,x=0,w=Array.isArray(t),A=l.s.r,k=0,E={};w&&!t[A]&&(t[A]=[]);var P=u.skipHidden&&t["!cols"]||[],Y=u.skipHidden&&t["!rows"]||[];for(k=l.s.c;k<=l.e.c;++k)if(!(P[k]||{}).hidden)switch(g[k]=Dr(k),r=w?t[A][k]:t[g[k]+p],n){case 1:s[k]=k-l.s.c;break;case 2:s[k]=g[k];break;case 3:s[k]=u.header[k-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=eo(r,null,u),x=E[a]||0,!x)E[a]=1;else{do o=a+"_"+x++;while(E[o]);E[a]=x,E[o]=1}s[k]=o}for(A=l.s.r+i;A<=l.e.r;++A)if(!(Y[A]||{}).hidden){var V=gj(t,l,A,g,n,s,w,u);(V.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(m[y++]=V.row)}return m.length=y,m}var H2=/"/g;function mj(t,e,r,n,i,s,a,o){for(var l=!0,u=[],f="",p=Yr(r),g=e.s.c;g<=e.e.c;++g)if(n[g]){var m=o.dense?(t[r]||[])[g]:t[n[g]+p];if(m==null)f="";else if(m.v!=null){l=!1,f=""+(o.rawNumbers&&m.t=="n"?m.v:eo(m,null,o));for(var y=0,x=0;y!==f.length;++y)if((x=f.charCodeAt(y))===i||x===s||x===34||o.forceQuotes){f='"'+f.replace(H2,'""')+'"';break}f=="ID"&&(f='"ID"')}else m.f!=null&&!m.F?(l=!1,f="="+m.f,f.indexOf(",")>=0&&(f='"'+f.replace(H2,'""')+'"')):f="";u.push(f)}return o.blankrows===!1&&l?null:u.join(a)}function gv(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=Xt(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),f="",p=[];n.dense=Array.isArray(t);for(var g=n.skipHidden&&t["!cols"]||[],m=n.skipHidden&&t["!rows"]||[],y=i.s.c;y<=i.e.c;++y)(g[y]||{}).hidden||(p[y]=Dr(y));for(var x=0,w=i.s.r;w<=i.e.r;++w)(m[w]||{}).hidden||(f=mj(t,i,w,p,a,l,s,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((x++?o:"")+f)));return delete n.dense,r.join("")}function Ik(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=gv(t,e);return r}function xj(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=Xt(t["!ref"]),s="",a=[],o,l=[],u=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=Dr(o);for(var f=i.s.r;f<=i.e.r;++f)for(s=Yr(f),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=u?(t[f]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function Nk(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Pr(n.origin):n.origin;a=l.r,o=l.c}var u,f={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var p=Xt(s["!ref"]);f.e.c=Math.max(f.e.c,p.e.c),f.e.r=Math.max(f.e.r,p.e.r),a==-1&&(a=p.e.r+1,f.e.r=a+e.length-1+i)}else a==-1&&(a=0,f.e.r=e.length-1+i);var g=n.header||[],m=0;e.forEach(function(x,w){Wr(x).forEach(function(A){(m=g.indexOf(A))==-1&&(g[m=g.length]=A);var k=x[A],E="z",P="",Y=ut({c:o+m,r:a+w+i});u=xf(s,Y),k&&typeof k=="object"&&!(k instanceof Date)?s[Y]=k:(typeof k=="number"?E="n":typeof k=="boolean"?E="b":typeof k=="string"?E="s":k instanceof Date?(E="d",n.cellDates||(E="n",k=En(k)),P=n.dateNF||lt[14]):k===null&&n.nullError&&(E="e",k=0),u?(u.t=E,u.v=k,delete u.w,delete u.R,P&&(u.z=P)):s[Y]=u={t:E,v:k},P&&(u.z=P))})}),f.e.c=Math.max(f.e.c,o+g.length-1);var y=Yr(a);if(i)for(m=0;m<g.length;++m)s[Dr(m+o)+y]={t:"s",v:g[m]};return s["!ref"]=wt(f),s}function vj(t,e){return Nk(null,t,e)}function xf(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Pr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?xf(t,ut(e)):xf(t,ut({r:e,c:r||0}))}function yj(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function mv(){return{SheetNames:[],Sheets:{}}}function xv(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(pk(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function _j(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=yj(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function Ej(t,e){return t.z=e,t}function Rk(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function wj(t,e,r){return Rk(t,"#"+e,r)}function Sj(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function Tj(t,e,r,n){for(var i=typeof e!="string"?e:Xt(e),s=typeof e=="string"?e:wt(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=xf(t,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var fr={encode_col:Dr,encode_row:Yr,encode_cell:ut,encode_range:wt,decode_col:G1,decode_row:$1,split_cell:OR,decode_cell:Pr,decode_range:Gi,format_cell:eo,sheet_add_aoa:sA,sheet_add_json:Nk,sheet_add_dom:wk,aoa_to_sheet:Ru,json_to_sheet:vj,table_to_sheet:Sk,table_to_book:NB,sheet_to_csv:gv,sheet_to_txt:Ik,sheet_to_json:tp,sheet_to_html:Ek,sheet_to_formulae:xj,sheet_to_row_object_array:tp,sheet_get_cell:xf,book_new:mv,book_append_sheet:xv,book_set_sheet_visibility:_j,cell_set_number_format:Ej,cell_set_hyperlink:Rk,cell_set_internal_link:wj,cell_add_comment:Sj,sheet_set_array_formula:Tj,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Aj={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kj=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),kt=(t,e)=>{const r=ve.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:l,...u},f)=>ve.createElement("svg",{ref:f,...Aj,width:i,height:i,stroke:n,strokeWidth:a?Number(s)*24/Number(i):s,className:["lucide",`lucide-${kj(t)}`,o].join(" "),...u},[...e.map(([p,g])=>ve.createElement(p,g)),...Array.isArray(l)?l:[l]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $2=kt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G2=kt("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cj=kt("BellRing",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K2=kt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y2=kt("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fj=kt("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bj=kt("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gg=kt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kg=kt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ij=kt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B0=kt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yg=kt("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nj=kt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wo=kt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rj=kt("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j0=kt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nd=kt("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const id=kt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xg=kt("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X2=kt("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U0=kt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qg=kt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dj=kt("Merge",[["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M12 2v10.3a4 4 0 0 1-1.172 2.872L4 22",key:"1hyw0i"}],["path",{d:"m20 22-5-5",key:"1m27yz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pj=kt("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oj=kt("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V0=kt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q2=kt("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sd=kt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qg=kt("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wl=kt("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mj=kt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z0=kt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q2=kt("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lj=kt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J2=kt("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bj=kt("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=kt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=kt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z2=kt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ma=kt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var eE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dk=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},jj=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[r++],a=t[r++],o=t[r++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},Pk={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,o=a?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,f=s>>2,p=(s&3)<<4|o>>4;let g=(o&15)<<2|u>>6,m=u&63;l||(m=64,a||(g=64)),n.push(r[f],r[p],r[g],r[m])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Dk(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):jj(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const u=i<t.length?r[t.charAt(i)]:64;++i;const p=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||u==null||p==null)throw new Uj;const g=s<<2|o>>4;if(n.push(g),u!==64){const m=o<<4&240|u>>2;if(n.push(m),p!==64){const y=u<<6&192|p;n.push(y)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Uj extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Vj=function(t){const e=Dk(t);return Pk.encodeByteArray(e,!0)},rp=function(t){return Vj(t).replace(/\./g,"")},Ok=function(t){try{return Pk.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zj(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wj=()=>zj().__FIREBASE_DEFAULTS__,Hj=()=>{if(typeof process>"u"||typeof eE>"u")return;const t=eE.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},$j=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Ok(t[1]);return e&&JSON.parse(e)},Hp=()=>{try{return Wj()||Hj()||$j()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Mk=t=>{var e,r;return(r=(e=Hp())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},Gj=t=>{const e=Mk(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},Lk=()=>{var t;return(t=Hp())===null||t===void 0?void 0:t.config},Bk=t=>{var e;return(e=Hp())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kj{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yj(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[rp(JSON.stringify(r)),rp(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Xj(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(pi())}function qj(){var t;const e=(t=Hp())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Qj(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Jj(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Zj(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function e9(){const t=pi();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function t9(){return!qj()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function r9(){try{return typeof indexedDB=="object"}catch{return!1}}function n9(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i9="FirebaseError";class uo extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=i9,Object.setPrototypeOf(this,uo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Vf.prototype.create)}}class Vf{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?s9(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new uo(i,o,n)}}function s9(t,e){return t.replace(a9,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const a9=/\{\$([^}]+)}/g;function o9(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function np(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const s=t[i],a=e[i];if(tE(s)&&tE(a)){if(!np(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function tE(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zf(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function l9(t,e){const r=new c9(t,e);return r.subscribe.bind(r)}class c9{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");u9(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=Jg),i.error===void 0&&(i.error=Jg),i.complete===void 0&&(i.complete=Jg);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function u9(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Jg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ra(t){return t&&t._delegate?t._delegate:t}class Jl{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Al="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d9{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new Kj;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(h9(e))try{this.getOrInitializeService({instanceIdentifier:Al})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=Al){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Al){return this.instances.has(e)}getOptions(e=Al){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:f9(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Al){return this.component?this.component.multipleInstances?e:Al:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function f9(t){return t===Al?void 0:t}function h9(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p9{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new d9(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Wt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Wt||(Wt={}));const g9={debug:Wt.DEBUG,verbose:Wt.VERBOSE,info:Wt.INFO,warn:Wt.WARN,error:Wt.ERROR,silent:Wt.SILENT},m9=Wt.INFO,x9={[Wt.DEBUG]:"log",[Wt.VERBOSE]:"log",[Wt.INFO]:"info",[Wt.WARN]:"warn",[Wt.ERROR]:"error"},v9=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=x9[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class vv{constructor(e){this.name=e,this._logLevel=m9,this._logHandler=v9,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Wt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?g9[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Wt.DEBUG,...e),this._logHandler(this,Wt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Wt.VERBOSE,...e),this._logHandler(this,Wt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Wt.INFO,...e),this._logHandler(this,Wt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Wt.WARN,...e),this._logHandler(this,Wt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Wt.ERROR,...e),this._logHandler(this,Wt.ERROR,...e)}}const y9=(t,e)=>e.some(r=>t instanceof r);let rE,nE;function _9(){return rE||(rE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function E9(){return nE||(nE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const jk=new WeakMap,px=new WeakMap,Uk=new WeakMap,Zg=new WeakMap,yv=new WeakMap;function w9(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(Go(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&jk.set(r,t)}).catch(()=>{}),yv.set(e,t),e}function S9(t){if(px.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});px.set(t,e)}let gx={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return px.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Uk.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Go(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function T9(t){gx=t(gx)}function A9(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(em(this),e,...r);return Uk.set(n,e.sort?e.sort():[e]),Go(n)}:E9().includes(t)?function(...e){return t.apply(em(this),e),Go(jk.get(this))}:function(...e){return Go(t.apply(em(this),e))}}function k9(t){return typeof t=="function"?A9(t):(t instanceof IDBTransaction&&S9(t),y9(t,_9())?new Proxy(t,gx):t)}function Go(t){if(t instanceof IDBRequest)return w9(t);if(Zg.has(t))return Zg.get(t);const e=k9(t);return e!==t&&(Zg.set(t,e),yv.set(e,t)),e}const em=t=>yv.get(t);function C9(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),o=Go(a);return n&&a.addEventListener("upgradeneeded",l=>{n(Go(a.result),l.oldVersion,l.newVersion,Go(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const F9=["get","getKey","getAll","getAllKeys","count"],b9=["put","add","delete","clear"],tm=new Map;function iE(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(tm.get(e))return tm.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=b9.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||F9.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let u=l.store;return n&&(u=u.index(o.shift())),(await Promise.all([u[r](...o),i&&l.done]))[0]};return tm.set(e,s),s}T9(t=>({...t,get:(e,r,n)=>iE(e,r)||t.get(e,r,n),has:(e,r)=>!!iE(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I9{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(N9(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function N9(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const mx="@firebase/app",sE="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const to=new vv("@firebase/app"),R9="@firebase/app-compat",D9="@firebase/analytics-compat",P9="@firebase/analytics",O9="@firebase/app-check-compat",M9="@firebase/app-check",L9="@firebase/auth",B9="@firebase/auth-compat",j9="@firebase/database",U9="@firebase/data-connect",V9="@firebase/database-compat",z9="@firebase/functions",W9="@firebase/functions-compat",H9="@firebase/installations",$9="@firebase/installations-compat",G9="@firebase/messaging",K9="@firebase/messaging-compat",Y9="@firebase/performance",X9="@firebase/performance-compat",q9="@firebase/remote-config",Q9="@firebase/remote-config-compat",J9="@firebase/storage",Z9="@firebase/storage-compat",e7="@firebase/firestore",t7="@firebase/vertexai-preview",r7="@firebase/firestore-compat",n7="firebase",i7="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xx="[DEFAULT]",s7={[mx]:"fire-core",[R9]:"fire-core-compat",[P9]:"fire-analytics",[D9]:"fire-analytics-compat",[M9]:"fire-app-check",[O9]:"fire-app-check-compat",[L9]:"fire-auth",[B9]:"fire-auth-compat",[j9]:"fire-rtdb",[U9]:"fire-data-connect",[V9]:"fire-rtdb-compat",[z9]:"fire-fn",[W9]:"fire-fn-compat",[H9]:"fire-iid",[$9]:"fire-iid-compat",[G9]:"fire-fcm",[K9]:"fire-fcm-compat",[Y9]:"fire-perf",[X9]:"fire-perf-compat",[q9]:"fire-rc",[Q9]:"fire-rc-compat",[J9]:"fire-gcs",[Z9]:"fire-gcs-compat",[e7]:"fire-fst",[r7]:"fire-fst-compat",[t7]:"fire-vertex","fire-js":"fire-js",[n7]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ip=new Map,a7=new Map,vx=new Map;function aE(t,e){try{t.container.addComponent(e)}catch(r){to.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function vu(t){const e=t.name;if(vx.has(e))return to.debug(`There were multiple attempts to register component ${e}.`),!1;vx.set(e,t);for(const r of ip.values())aE(r,t);for(const r of a7.values())aE(r,t);return!0}function _v(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Mo(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o7={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ko=new Vf("app","Firebase",o7);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l7{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Jl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ko.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pu=i7;function Vk(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:xx,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw Ko.create("bad-app-name",{appName:String(i)});if(r||(r=Lk()),!r)throw Ko.create("no-options");const s=ip.get(i);if(s){if(np(r,s.options)&&np(n,s.config))return s;throw Ko.create("duplicate-app",{appName:i})}const a=new p9(i);for(const l of vx.values())a.addComponent(l);const o=new l7(r,n,a);return ip.set(i,o),o}function zk(t=xx){const e=ip.get(t);if(!e&&t===xx&&Lk())return Vk();if(!e)throw Ko.create("no-app",{appName:t});return e}function Yo(t,e,r){var n;let i=(n=s7[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),to.warn(o.join(" "));return}vu(new Jl(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c7="firebase-heartbeat-database",u7=1,vf="firebase-heartbeat-store";let rm=null;function Wk(){return rm||(rm=C9(c7,u7,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(vf)}catch(r){console.warn(r)}}}}).catch(t=>{throw Ko.create("idb-open",{originalErrorMessage:t.message})})),rm}async function d7(t){try{const r=(await Wk()).transaction(vf),n=await r.objectStore(vf).get(Hk(t));return await r.done,n}catch(e){if(e instanceof uo)to.warn(e.message);else{const r=Ko.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});to.warn(r.message)}}}async function oE(t,e){try{const n=(await Wk()).transaction(vf,"readwrite");await n.objectStore(vf).put(e,Hk(t)),await n.done}catch(r){if(r instanceof uo)to.warn(r.message);else{const n=Ko.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});to.warn(n.message)}}}function Hk(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f7=1024,h7=30*24*60*60*1e3;class p7{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new m7(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=lE();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=h7}),this._storage.overwrite(this._heartbeatsCache))}catch(n){to.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=lE(),{heartbeatsToSend:n,unsentEntries:i}=g7(this._heartbeatsCache.heartbeats),s=rp(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return to.warn(r),""}}}function lE(){return new Date().toISOString().substring(0,10)}function g7(t,e=f7){const r=[];let n=t.slice();for(const i of t){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),cE(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),cE(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class m7{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return r9()?n9().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await d7(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return oE(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return oE(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function cE(t){return rp(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x7(t){vu(new Jl("platform-logger",e=>new I9(e),"PRIVATE")),vu(new Jl("heartbeat",e=>new p7(e),"PRIVATE")),Yo(mx,sE,t),Yo(mx,sE,"esm2017"),Yo("fire-js","")}x7("");var v7="firebase",y7="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Yo(v7,y7,"app");var uE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var jl,$k;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,F){function S(){}S.prototype=F.prototype,T.D=F.prototype,T.prototype=new S,T.prototype.constructor=T,T.C=function(I,R,D){for(var N=Array(arguments.length-2),$e=2;$e<arguments.length;$e++)N[$e-2]=arguments[$e];return F.prototype[R].apply(I,N)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,F,S){S||(S=0);var I=Array(16);if(typeof F=="string")for(var R=0;16>R;++R)I[R]=F.charCodeAt(S++)|F.charCodeAt(S++)<<8|F.charCodeAt(S++)<<16|F.charCodeAt(S++)<<24;else for(R=0;16>R;++R)I[R]=F[S++]|F[S++]<<8|F[S++]<<16|F[S++]<<24;F=T.g[0],S=T.g[1],R=T.g[2];var D=T.g[3],N=F+(D^S&(R^D))+I[0]+3614090360&4294967295;F=S+(N<<7&4294967295|N>>>25),N=D+(R^F&(S^R))+I[1]+3905402710&4294967295,D=F+(N<<12&4294967295|N>>>20),N=R+(S^D&(F^S))+I[2]+606105819&4294967295,R=D+(N<<17&4294967295|N>>>15),N=S+(F^R&(D^F))+I[3]+3250441966&4294967295,S=R+(N<<22&4294967295|N>>>10),N=F+(D^S&(R^D))+I[4]+4118548399&4294967295,F=S+(N<<7&4294967295|N>>>25),N=D+(R^F&(S^R))+I[5]+1200080426&4294967295,D=F+(N<<12&4294967295|N>>>20),N=R+(S^D&(F^S))+I[6]+2821735955&4294967295,R=D+(N<<17&4294967295|N>>>15),N=S+(F^R&(D^F))+I[7]+4249261313&4294967295,S=R+(N<<22&4294967295|N>>>10),N=F+(D^S&(R^D))+I[8]+1770035416&4294967295,F=S+(N<<7&4294967295|N>>>25),N=D+(R^F&(S^R))+I[9]+2336552879&4294967295,D=F+(N<<12&4294967295|N>>>20),N=R+(S^D&(F^S))+I[10]+4294925233&4294967295,R=D+(N<<17&4294967295|N>>>15),N=S+(F^R&(D^F))+I[11]+2304563134&4294967295,S=R+(N<<22&4294967295|N>>>10),N=F+(D^S&(R^D))+I[12]+1804603682&4294967295,F=S+(N<<7&4294967295|N>>>25),N=D+(R^F&(S^R))+I[13]+4254626195&4294967295,D=F+(N<<12&4294967295|N>>>20),N=R+(S^D&(F^S))+I[14]+2792965006&4294967295,R=D+(N<<17&4294967295|N>>>15),N=S+(F^R&(D^F))+I[15]+1236535329&4294967295,S=R+(N<<22&4294967295|N>>>10),N=F+(R^D&(S^R))+I[1]+4129170786&4294967295,F=S+(N<<5&4294967295|N>>>27),N=D+(S^R&(F^S))+I[6]+3225465664&4294967295,D=F+(N<<9&4294967295|N>>>23),N=R+(F^S&(D^F))+I[11]+643717713&4294967295,R=D+(N<<14&4294967295|N>>>18),N=S+(D^F&(R^D))+I[0]+3921069994&4294967295,S=R+(N<<20&4294967295|N>>>12),N=F+(R^D&(S^R))+I[5]+3593408605&4294967295,F=S+(N<<5&4294967295|N>>>27),N=D+(S^R&(F^S))+I[10]+38016083&4294967295,D=F+(N<<9&4294967295|N>>>23),N=R+(F^S&(D^F))+I[15]+3634488961&4294967295,R=D+(N<<14&4294967295|N>>>18),N=S+(D^F&(R^D))+I[4]+3889429448&4294967295,S=R+(N<<20&4294967295|N>>>12),N=F+(R^D&(S^R))+I[9]+568446438&4294967295,F=S+(N<<5&4294967295|N>>>27),N=D+(S^R&(F^S))+I[14]+3275163606&4294967295,D=F+(N<<9&4294967295|N>>>23),N=R+(F^S&(D^F))+I[3]+4107603335&4294967295,R=D+(N<<14&4294967295|N>>>18),N=S+(D^F&(R^D))+I[8]+1163531501&4294967295,S=R+(N<<20&4294967295|N>>>12),N=F+(R^D&(S^R))+I[13]+2850285829&4294967295,F=S+(N<<5&4294967295|N>>>27),N=D+(S^R&(F^S))+I[2]+4243563512&4294967295,D=F+(N<<9&4294967295|N>>>23),N=R+(F^S&(D^F))+I[7]+1735328473&4294967295,R=D+(N<<14&4294967295|N>>>18),N=S+(D^F&(R^D))+I[12]+2368359562&4294967295,S=R+(N<<20&4294967295|N>>>12),N=F+(S^R^D)+I[5]+4294588738&4294967295,F=S+(N<<4&4294967295|N>>>28),N=D+(F^S^R)+I[8]+2272392833&4294967295,D=F+(N<<11&4294967295|N>>>21),N=R+(D^F^S)+I[11]+1839030562&4294967295,R=D+(N<<16&4294967295|N>>>16),N=S+(R^D^F)+I[14]+4259657740&4294967295,S=R+(N<<23&4294967295|N>>>9),N=F+(S^R^D)+I[1]+2763975236&4294967295,F=S+(N<<4&4294967295|N>>>28),N=D+(F^S^R)+I[4]+1272893353&4294967295,D=F+(N<<11&4294967295|N>>>21),N=R+(D^F^S)+I[7]+4139469664&4294967295,R=D+(N<<16&4294967295|N>>>16),N=S+(R^D^F)+I[10]+3200236656&4294967295,S=R+(N<<23&4294967295|N>>>9),N=F+(S^R^D)+I[13]+681279174&4294967295,F=S+(N<<4&4294967295|N>>>28),N=D+(F^S^R)+I[0]+3936430074&4294967295,D=F+(N<<11&4294967295|N>>>21),N=R+(D^F^S)+I[3]+3572445317&4294967295,R=D+(N<<16&4294967295|N>>>16),N=S+(R^D^F)+I[6]+76029189&4294967295,S=R+(N<<23&4294967295|N>>>9),N=F+(S^R^D)+I[9]+3654602809&4294967295,F=S+(N<<4&4294967295|N>>>28),N=D+(F^S^R)+I[12]+3873151461&4294967295,D=F+(N<<11&4294967295|N>>>21),N=R+(D^F^S)+I[15]+530742520&4294967295,R=D+(N<<16&4294967295|N>>>16),N=S+(R^D^F)+I[2]+3299628645&4294967295,S=R+(N<<23&4294967295|N>>>9),N=F+(R^(S|~D))+I[0]+4096336452&4294967295,F=S+(N<<6&4294967295|N>>>26),N=D+(S^(F|~R))+I[7]+1126891415&4294967295,D=F+(N<<10&4294967295|N>>>22),N=R+(F^(D|~S))+I[14]+2878612391&4294967295,R=D+(N<<15&4294967295|N>>>17),N=S+(D^(R|~F))+I[5]+4237533241&4294967295,S=R+(N<<21&4294967295|N>>>11),N=F+(R^(S|~D))+I[12]+1700485571&4294967295,F=S+(N<<6&4294967295|N>>>26),N=D+(S^(F|~R))+I[3]+2399980690&4294967295,D=F+(N<<10&4294967295|N>>>22),N=R+(F^(D|~S))+I[10]+4293915773&4294967295,R=D+(N<<15&4294967295|N>>>17),N=S+(D^(R|~F))+I[1]+2240044497&4294967295,S=R+(N<<21&4294967295|N>>>11),N=F+(R^(S|~D))+I[8]+1873313359&4294967295,F=S+(N<<6&4294967295|N>>>26),N=D+(S^(F|~R))+I[15]+4264355552&4294967295,D=F+(N<<10&4294967295|N>>>22),N=R+(F^(D|~S))+I[6]+2734768916&4294967295,R=D+(N<<15&4294967295|N>>>17),N=S+(D^(R|~F))+I[13]+1309151649&4294967295,S=R+(N<<21&4294967295|N>>>11),N=F+(R^(S|~D))+I[4]+4149444226&4294967295,F=S+(N<<6&4294967295|N>>>26),N=D+(S^(F|~R))+I[11]+3174756917&4294967295,D=F+(N<<10&4294967295|N>>>22),N=R+(F^(D|~S))+I[2]+718787259&4294967295,R=D+(N<<15&4294967295|N>>>17),N=S+(D^(R|~F))+I[9]+3951481745&4294967295,T.g[0]=T.g[0]+F&4294967295,T.g[1]=T.g[1]+(R+(N<<21&4294967295|N>>>11))&4294967295,T.g[2]=T.g[2]+R&4294967295,T.g[3]=T.g[3]+D&4294967295}n.prototype.u=function(T,F){F===void 0&&(F=T.length);for(var S=F-this.blockSize,I=this.B,R=this.h,D=0;D<F;){if(R==0)for(;D<=S;)i(this,T,D),D+=this.blockSize;if(typeof T=="string"){for(;D<F;)if(I[R++]=T.charCodeAt(D++),R==this.blockSize){i(this,I),R=0;break}}else for(;D<F;)if(I[R++]=T[D++],R==this.blockSize){i(this,I),R=0;break}}this.h=R,this.o+=F},n.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var F=1;F<T.length-8;++F)T[F]=0;var S=8*this.o;for(F=T.length-8;F<T.length;++F)T[F]=S&255,S/=256;for(this.u(T),T=Array(16),F=S=0;4>F;++F)for(var I=0;32>I;I+=8)T[S++]=this.g[F]>>>I&255;return T};function s(T,F){var S=o;return Object.prototype.hasOwnProperty.call(S,T)?S[T]:S[T]=F(T)}function a(T,F){this.h=F;for(var S=[],I=!0,R=T.length-1;0<=R;R--){var D=T[R]|0;I&&D==F||(S[R]=D,I=!1)}this.g=S}var o={};function l(T){return-128<=T&&128>T?s(T,function(F){return new a([F|0],0>F?-1:0)}):new a([T|0],0>T?-1:0)}function u(T){if(isNaN(T)||!isFinite(T))return p;if(0>T)return w(u(-T));for(var F=[],S=1,I=0;T>=S;I++)F[I]=T/S|0,S*=4294967296;return new a(F,0)}function f(T,F){if(T.length==0)throw Error("number format error: empty string");if(F=F||10,2>F||36<F)throw Error("radix out of range: "+F);if(T.charAt(0)=="-")return w(f(T.substring(1),F));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=u(Math.pow(F,8)),I=p,R=0;R<T.length;R+=8){var D=Math.min(8,T.length-R),N=parseInt(T.substring(R,R+D),F);8>D?(D=u(Math.pow(F,D)),I=I.j(D).add(u(N))):(I=I.j(S),I=I.add(u(N)))}return I}var p=l(0),g=l(1),m=l(16777216);t=a.prototype,t.m=function(){if(x(this))return-w(this).m();for(var T=0,F=1,S=0;S<this.g.length;S++){var I=this.i(S);T+=(0<=I?I:4294967296+I)*F,F*=4294967296}return T},t.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(y(this))return"0";if(x(this))return"-"+w(this).toString(T);for(var F=u(Math.pow(T,6)),S=this,I="";;){var R=P(S,F).g;S=A(S,R.j(F));var D=((0<S.g.length?S.g[0]:S.h)>>>0).toString(T);if(S=R,y(S))return D+I;for(;6>D.length;)D="0"+D;I=D+I}},t.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function y(T){if(T.h!=0)return!1;for(var F=0;F<T.g.length;F++)if(T.g[F]!=0)return!1;return!0}function x(T){return T.h==-1}t.l=function(T){return T=A(this,T),x(T)?-1:y(T)?0:1};function w(T){for(var F=T.g.length,S=[],I=0;I<F;I++)S[I]=~T.g[I];return new a(S,~T.h).add(g)}t.abs=function(){return x(this)?w(this):this},t.add=function(T){for(var F=Math.max(this.g.length,T.g.length),S=[],I=0,R=0;R<=F;R++){var D=I+(this.i(R)&65535)+(T.i(R)&65535),N=(D>>>16)+(this.i(R)>>>16)+(T.i(R)>>>16);I=N>>>16,D&=65535,N&=65535,S[R]=N<<16|D}return new a(S,S[S.length-1]&-2147483648?-1:0)};function A(T,F){return T.add(w(F))}t.j=function(T){if(y(this)||y(T))return p;if(x(this))return x(T)?w(this).j(w(T)):w(w(this).j(T));if(x(T))return w(this.j(w(T)));if(0>this.l(m)&&0>T.l(m))return u(this.m()*T.m());for(var F=this.g.length+T.g.length,S=[],I=0;I<2*F;I++)S[I]=0;for(I=0;I<this.g.length;I++)for(var R=0;R<T.g.length;R++){var D=this.i(I)>>>16,N=this.i(I)&65535,$e=T.i(R)>>>16,_e=T.i(R)&65535;S[2*I+2*R]+=N*_e,k(S,2*I+2*R),S[2*I+2*R+1]+=D*_e,k(S,2*I+2*R+1),S[2*I+2*R+1]+=N*$e,k(S,2*I+2*R+1),S[2*I+2*R+2]+=D*$e,k(S,2*I+2*R+2)}for(I=0;I<F;I++)S[I]=S[2*I+1]<<16|S[2*I];for(I=F;I<2*F;I++)S[I]=0;return new a(S,0)};function k(T,F){for(;(T[F]&65535)!=T[F];)T[F+1]+=T[F]>>>16,T[F]&=65535,F++}function E(T,F){this.g=T,this.h=F}function P(T,F){if(y(F))throw Error("division by zero");if(y(T))return new E(p,p);if(x(T))return F=P(w(T),F),new E(w(F.g),w(F.h));if(x(F))return F=P(T,w(F)),new E(w(F.g),F.h);if(30<T.g.length){if(x(T)||x(F))throw Error("slowDivide_ only works with positive integers.");for(var S=g,I=F;0>=I.l(T);)S=Y(S),I=Y(I);var R=V(S,1),D=V(I,1);for(I=V(I,2),S=V(S,2);!y(I);){var N=D.add(I);0>=N.l(T)&&(R=R.add(S),D=N),I=V(I,1),S=V(S,1)}return F=A(T,R.j(F)),new E(R,F)}for(R=p;0<=T.l(F);){for(S=Math.max(1,Math.floor(T.m()/F.m())),I=Math.ceil(Math.log(S)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),D=u(S),N=D.j(F);x(N)||0<N.l(T);)S-=I,D=u(S),N=D.j(F);y(D)&&(D=g),R=R.add(D),T=A(T,N)}return new E(R,T)}t.A=function(T){return P(this,T).h},t.and=function(T){for(var F=Math.max(this.g.length,T.g.length),S=[],I=0;I<F;I++)S[I]=this.i(I)&T.i(I);return new a(S,this.h&T.h)},t.or=function(T){for(var F=Math.max(this.g.length,T.g.length),S=[],I=0;I<F;I++)S[I]=this.i(I)|T.i(I);return new a(S,this.h|T.h)},t.xor=function(T){for(var F=Math.max(this.g.length,T.g.length),S=[],I=0;I<F;I++)S[I]=this.i(I)^T.i(I);return new a(S,this.h^T.h)};function Y(T){for(var F=T.g.length+1,S=[],I=0;I<F;I++)S[I]=T.i(I)<<1|T.i(I-1)>>>31;return new a(S,T.h)}function V(T,F){var S=F>>5;F%=32;for(var I=T.g.length-S,R=[],D=0;D<I;D++)R[D]=0<F?T.i(D+S)>>>F|T.i(D+S+1)<<32-F:T.i(D+S);return new a(R,T.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,$k=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=f,jl=a}).apply(typeof uE<"u"?uE:typeof self<"u"?self:typeof window<"u"?window:{});var W0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Gk,pd,Kk,uh,yx,Yk,Xk,qk;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,v,C){return d==Array.prototype||d==Object.prototype||(d[v]=C.value),d};function r(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof W0=="object"&&W0];for(var v=0;v<d.length;++v){var C=d[v];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var n=r(this);function i(d,v){if(v)e:{var C=n;d=d.split(".");for(var O=0;O<d.length-1;O++){var le=d[O];if(!(le in C))break e;C=C[le]}d=d[d.length-1],O=C[d],v=v(O),v!=O&&v!=null&&e(C,d,{configurable:!0,writable:!0,value:v})}}function s(d,v){d instanceof String&&(d+="");var C=0,O=!1,le={next:function(){if(!O&&C<d.length){var me=C++;return{value:v(me,d[me]),done:!1}}return O=!0,{done:!0,value:void 0}}};return le[Symbol.iterator]=function(){return le},le}i("Array.prototype.values",function(d){return d||function(){return s(this,function(v,C){return C})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(d){var v=typeof d;return v=v!="object"?v:d?Array.isArray(d)?"array":v:"null",v=="array"||v=="object"&&typeof d.length=="number"}function u(d){var v=typeof d;return v=="object"&&d!=null||v=="function"}function f(d,v,C){return d.call.apply(d.bind,arguments)}function p(d,v,C){if(!d)throw Error();if(2<arguments.length){var O=Array.prototype.slice.call(arguments,2);return function(){var le=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(le,O),d.apply(v,le)}}return function(){return d.apply(v,arguments)}}function g(d,v,C){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,g.apply(null,arguments)}function m(d,v){var C=Array.prototype.slice.call(arguments,1);return function(){var O=C.slice();return O.push.apply(O,arguments),d.apply(this,O)}}function y(d,v){function C(){}C.prototype=v.prototype,d.aa=v.prototype,d.prototype=new C,d.prototype.constructor=d,d.Qb=function(O,le,me){for(var He=Array(arguments.length-2),tr=2;tr<arguments.length;tr++)He[tr-2]=arguments[tr];return v.prototype[le].apply(O,He)}}function x(d){const v=d.length;if(0<v){const C=Array(v);for(let O=0;O<v;O++)C[O]=d[O];return C}return[]}function w(d,v){for(let C=1;C<arguments.length;C++){const O=arguments[C];if(l(O)){const le=d.length||0,me=O.length||0;d.length=le+me;for(let He=0;He<me;He++)d[le+He]=O[He]}else d.push(O)}}class A{constructor(v,C){this.i=v,this.j=C,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function k(d){return/^[\s\xa0]*$/.test(d)}function E(){var d=o.navigator;return d&&(d=d.userAgent)?d:""}function P(d){return P[" "](d),d}P[" "]=function(){};var Y=E().indexOf("Gecko")!=-1&&!(E().toLowerCase().indexOf("webkit")!=-1&&E().indexOf("Edge")==-1)&&!(E().indexOf("Trident")!=-1||E().indexOf("MSIE")!=-1)&&E().indexOf("Edge")==-1;function V(d,v,C){for(const O in d)v.call(C,d[O],O,d)}function T(d,v){for(const C in d)v.call(void 0,d[C],C,d)}function F(d){const v={};for(const C in d)v[C]=d[C];return v}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(d,v){let C,O;for(let le=1;le<arguments.length;le++){O=arguments[le];for(C in O)d[C]=O[C];for(let me=0;me<S.length;me++)C=S[me],Object.prototype.hasOwnProperty.call(O,C)&&(d[C]=O[C])}}function R(d){var v=1;d=d.split(":");const C=[];for(;0<v&&d.length;)C.push(d.shift()),v--;return d.length&&C.push(d.join(":")),C}function D(d){o.setTimeout(()=>{throw d},0)}function N(){var d=ie;let v=null;return d.g&&(v=d.g,d.g=d.g.next,d.g||(d.h=null),v.next=null),v}class $e{constructor(){this.h=this.g=null}add(v,C){const O=_e.get();O.set(v,C),this.h?this.h.next=O:this.g=O,this.h=O}}var _e=new A(()=>new Pe,d=>d.reset());class Pe{constructor(){this.next=this.g=this.h=null}set(v,C){this.h=v,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let be,Te=!1,ie=new $e,Ce=()=>{const d=o.Promise.resolve(void 0);be=()=>{d.then(Be)}};var Be=()=>{for(var d;d=N();){try{d.h.call(d.g)}catch(C){D(C)}var v=_e;v.j(d),100>v.h&&(v.h++,d.next=v.g,v.g=d)}Te=!1};function W(){this.s=this.s,this.C=this.C}W.prototype.s=!1,W.prototype.ma=function(){this.s||(this.s=!0,this.N())},W.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ne(d,v){this.type=d,this.g=this.target=v,this.defaultPrevented=!1}ne.prototype.h=function(){this.defaultPrevented=!0};var re=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var d=!1,v=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const C=()=>{};o.addEventListener("test",C,v),o.removeEventListener("test",C,v)}catch{}return d}();function q(d,v){if(ne.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var C=this.type=d.type,O=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=v,v=d.relatedTarget){if(Y){e:{try{P(v.nodeName);var le=!0;break e}catch{}le=!1}le||(v=null)}}else C=="mouseover"?v=d.fromElement:C=="mouseout"&&(v=d.toElement);this.relatedTarget=v,O?(this.clientX=O.clientX!==void 0?O.clientX:O.pageX,this.clientY=O.clientY!==void 0?O.clientY:O.pageY,this.screenX=O.screenX||0,this.screenY=O.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:xe[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&q.aa.h.call(this)}}y(q,ne);var xe={2:"touch",3:"pen",4:"mouse"};q.prototype.h=function(){q.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var we="closure_listenable_"+(1e6*Math.random()|0),je=0;function Ie(d,v,C,O,le){this.listener=d,this.proxy=null,this.src=v,this.type=C,this.capture=!!O,this.ha=le,this.key=++je,this.da=this.fa=!1}function Ae(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function nt(d){this.src=d,this.g={},this.h=0}nt.prototype.add=function(d,v,C,O,le){var me=d.toString();d=this.g[me],d||(d=this.g[me]=[],this.h++);var He=Mt(d,v,O,le);return-1<He?(v=d[He],C||(v.fa=!1)):(v=new Ie(v,this.src,me,!!O,le),v.fa=C,d.push(v)),v};function J(d,v){var C=v.type;if(C in d.g){var O=d.g[C],le=Array.prototype.indexOf.call(O,v,void 0),me;(me=0<=le)&&Array.prototype.splice.call(O,le,1),me&&(Ae(v),d.g[C].length==0&&(delete d.g[C],d.h--))}}function Mt(d,v,C,O){for(var le=0;le<d.length;++le){var me=d[le];if(!me.da&&me.listener==v&&me.capture==!!C&&me.ha==O)return le}return-1}var Et="closure_lm_"+(1e6*Math.random()|0),Rt={};function mt(d,v,C,O,le){if(Array.isArray(v)){for(var me=0;me<v.length;me++)mt(d,v[me],C,O,le);return null}return C=Ni(C),d&&d[we]?d.K(v,C,u(O)?!!O.capture:!1,le):Ge(d,v,C,!1,O,le)}function Ge(d,v,C,O,le,me){if(!v)throw Error("Invalid event type");var He=u(le)?!!le.capture:!!le,tr=Ii(d);if(tr||(d[Et]=tr=new nt(d)),C=tr.add(v,C,O,He,me),C.proxy)return C;if(O=or(),C.proxy=O,O.src=d,O.listener=C,d.addEventListener)re||(le=He),le===void 0&&(le=!1),d.addEventListener(v.toString(),O,le);else if(d.attachEvent)d.attachEvent(bi(v.toString()),O);else if(d.addListener&&d.removeListener)d.addListener(O);else throw Error("addEventListener and attachEvent are unavailable.");return C}function or(){function d(C){return v.call(d.src,d.listener,C)}const v=ls;return d}function Ln(d,v,C,O,le){if(Array.isArray(v))for(var me=0;me<v.length;me++)Ln(d,v[me],C,O,le);else O=u(O)?!!O.capture:!!O,C=Ni(C),d&&d[we]?(d=d.i,v=String(v).toString(),v in d.g&&(me=d.g[v],C=Mt(me,C,O,le),-1<C&&(Ae(me[C]),Array.prototype.splice.call(me,C,1),me.length==0&&(delete d.g[v],d.h--)))):d&&(d=Ii(d))&&(v=d.g[v.toString()],d=-1,v&&(d=Mt(v,C,O,le)),(C=-1<d?v[d]:null)&&sn(C))}function sn(d){if(typeof d!="number"&&d&&!d.da){var v=d.src;if(v&&v[we])J(v.i,d);else{var C=d.type,O=d.proxy;v.removeEventListener?v.removeEventListener(C,O,d.capture):v.detachEvent?v.detachEvent(bi(C),O):v.addListener&&v.removeListener&&v.removeListener(O),(C=Ii(v))?(J(C,d),C.h==0&&(C.src=null,v[Et]=null)):Ae(d)}}}function bi(d){return d in Rt?Rt[d]:Rt[d]="on"+d}function ls(d,v){if(d.da)d=!0;else{v=new q(v,this);var C=d.listener,O=d.ha||d.src;d.fa&&sn(d),d=C.call(O,v)}return d}function Ii(d){return d=d[Et],d instanceof nt?d:null}var Hr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ni(d){return typeof d=="function"?d:(d[Hr]||(d[Hr]=function(v){return d.handleEvent(v)}),d[Hr])}function er(){W.call(this),this.i=new nt(this),this.M=this,this.F=null}y(er,W),er.prototype[we]=!0,er.prototype.removeEventListener=function(d,v,C,O){Ln(this,d,v,C,O)};function br(d,v){var C,O=d.F;if(O)for(C=[];O;O=O.F)C.push(O);if(d=d.M,O=v.type||v,typeof v=="string")v=new ne(v,d);else if(v instanceof ne)v.target=v.target||d;else{var le=v;v=new ne(O,d),I(v,le)}if(le=!0,C)for(var me=C.length-1;0<=me;me--){var He=v.g=C[me];le=gr(He,O,!0,v)&&le}if(He=v.g=d,le=gr(He,O,!0,v)&&le,le=gr(He,O,!1,v)&&le,C)for(me=0;me<C.length;me++)He=v.g=C[me],le=gr(He,O,!1,v)&&le}er.prototype.N=function(){if(er.aa.N.call(this),this.i){var d=this.i,v;for(v in d.g){for(var C=d.g[v],O=0;O<C.length;O++)Ae(C[O]);delete d.g[v],d.h--}}this.F=null},er.prototype.K=function(d,v,C,O){return this.i.add(String(d),v,!1,C,O)},er.prototype.L=function(d,v,C,O){return this.i.add(String(d),v,!0,C,O)};function gr(d,v,C,O){if(v=d.i.g[String(v)],!v)return!0;v=v.concat();for(var le=!0,me=0;me<v.length;++me){var He=v[me];if(He&&!He.da&&He.capture==C){var tr=He.listener,fn=He.ha||He.src;He.fa&&J(d.i,He),le=tr.call(fn,O)!==!1&&le}}return le&&!O.defaultPrevented}function mi(d,v,C){if(typeof d=="function")C&&(d=g(d,C));else if(d&&typeof d.handleEvent=="function")d=g(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:o.setTimeout(d,v||0)}function ft(d){d.g=mi(()=>{d.g=null,d.i&&(d.i=!1,ft(d))},d.l);const v=d.h;d.h=null,d.m.apply(null,v)}class mr extends W{constructor(v,C){super(),this.m=v,this.l=C,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:ft(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function xr(d){W.call(this),this.h=d,this.g={}}y(xr,W);var Sr=[];function xi(d){V(d.g,function(v,C){this.g.hasOwnProperty(C)&&sn(v)},d),d.g={}}xr.prototype.N=function(){xr.aa.N.call(this),xi(this)},xr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var fo=o.JSON.stringify,ho=o.JSON.parse,Uu=class{stringify(d){return o.JSON.stringify(d,void 0)}parse(d){return o.JSON.parse(d,void 0)}};function Os(){}Os.prototype.h=null;function fl(d){return d.h||(d.h=d.i())}function Ms(){}var ce={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Br(){ne.call(this,"d")}y(Br,ne);function Ri(){ne.call(this,"c")}y(Ri,ne);var cs={},ka=null;function na(){return ka=ka||new er}cs.La="serverreachability";function ia(d){ne.call(this,cs.La,d)}y(ia,ne);function Di(d){const v=na();br(v,new ia(v))}cs.STAT_EVENT="statevent";function an(d,v){ne.call(this,cs.STAT_EVENT,d),this.stat=v}y(an,ne);function qr(d){const v=na();br(v,new an(v,d))}cs.Ma="timingevent";function Ca(d,v){ne.call(this,cs.Ma,d),this.size=v}y(Ca,ne);function Ls(d,v){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){d()},v)}function on(){this.g=!0}on.prototype.xa=function(){this.g=!1};function hc(d,v,C,O,le,me){d.info(function(){if(d.g)if(me)for(var He="",tr=me.split("&"),fn=0;fn<tr.length;fn++){var Ht=tr[fn].split("=");if(1<Ht.length){var hn=Ht[0];Ht=Ht[1];var An=hn.split("_");He=2<=An.length&&An[1]=="type"?He+(hn+"="+Ht+"&"):He+(hn+"=redacted&")}}else He=null;else He=me;return"XMLHTTP REQ ("+O+") [attempt "+le+"]: "+v+`
`+C+`
`+He})}function Ki(d,v,C,O,le,me,He){d.info(function(){return"XMLHTTP RESP ("+O+") [ attempt "+le+"]: "+v+`
`+C+`
`+me+" "+He})}function b(d,v,C,O){d.info(function(){return"XMLHTTP TEXT ("+v+"): "+L(d,C)+(O?" "+O:"")})}function G(d,v){d.info(function(){return"TIMEOUT: "+v})}on.prototype.info=function(){};function L(d,v){if(!d.g)return v;if(!v)return null;try{var C=JSON.parse(v);if(C){for(d=0;d<C.length;d++)if(Array.isArray(C[d])){var O=C[d];if(!(2>O.length)){var le=O[1];if(Array.isArray(le)&&!(1>le.length)){var me=le[0];if(me!="noop"&&me!="stop"&&me!="close")for(var He=1;He<le.length;He++)le[He]=""}}}}return fo(C)}catch{return v}}var U={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},X={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Q;function ue(){}y(ue,Os),ue.prototype.g=function(){return new XMLHttpRequest},ue.prototype.i=function(){return{}},Q=new ue;function pe(d,v,C,O){this.j=d,this.i=v,this.l=C,this.R=O||1,this.U=new xr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new fe}function fe(){this.i=null,this.g="",this.h=!1}var se={},he={};function Se(d,v,C){d.L=1,d.v=Ia(cn(v)),d.m=C,d.P=!0,Ue(d,null)}function Ue(d,v){d.F=Date.now(),Ye(d),d.A=cn(d.v);var C=d.A,O=d.R;Array.isArray(O)||(O=[String(O)]),Jf(C.i,"t",O),d.C=0,C=d.j.J,d.h=new fe,d.g=s0(d.j,C?v:null,!d.m),0<d.O&&(d.M=new mr(g(d.Y,d,d.g),d.O)),v=d.U,C=d.g,O=d.ca;var le="readystatechange";Array.isArray(le)||(le&&(Sr[0]=le.toString()),le=Sr);for(var me=0;me<le.length;me++){var He=mt(C,le[me],O||v.handleEvent,!1,v.h||v);if(!He)break;v.g[He.key]=He}v=d.H?F(d.H):{},d.m?(d.u||(d.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,v)):(d.u="GET",d.g.ea(d.A,d.u,null,v)),Di(),hc(d.i,d.u,d.A,d.l,d.R,d.m)}pe.prototype.ca=function(d){d=d.target;const v=this.M;v&&gs(d)==3?v.j():this.Y(d)},pe.prototype.Y=function(d){try{if(d==this.g)e:{const An=gs(this.g);var v=this.g.Ba();const Oa=this.g.Z();if(!(3>An)&&(An!=3||this.g&&(this.h.h||this.g.oa()||xl(this.g)))){this.J||An!=4||v==7||(v==8||0>=Oa?Di(3):Di(2)),Lt(this);var C=this.g.Z();this.X=C;t:if(Ke(this)){var O=xl(this.g);d="";var le=O.length,me=gs(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){hr(this),Bt(this);var He="";break t}this.h.i=new o.TextDecoder}for(v=0;v<le;v++)this.h.h=!0,d+=this.h.i.decode(O[v],{stream:!(me&&v==le-1)});O.length=0,this.h.g+=d,this.C=0,He=this.h.g}else He=this.g.oa();if(this.o=C==200,Ki(this.i,this.u,this.A,this.l,this.R,An,C),this.o){if(this.T&&!this.K){t:{if(this.g){var tr,fn=this.g;if((tr=fn.g?fn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(tr)){var Ht=tr;break t}}Ht=null}if(C=Ht)b(this.i,this.l,C,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Pi(this,C);else{this.o=!1,this.s=3,qr(12),hr(this),Bt(this);break e}}if(this.P){C=!0;let Xi;for(;!this.J&&this.C<He.length;)if(Xi=Re(this,He),Xi==he){An==4&&(this.s=4,qr(14),C=!1),b(this.i,this.l,null,"[Incomplete Response]");break}else if(Xi==se){this.s=4,qr(15),b(this.i,this.l,He,"[Invalid Chunk]"),C=!1;break}else b(this.i,this.l,Xi,null),Pi(this,Xi);if(Ke(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),An!=4||He.length!=0||this.h.h||(this.s=1,qr(16),C=!1),this.o=this.o&&C,!C)b(this.i,this.l,He,"[Invalid Chunked Response]"),hr(this),Bt(this);else if(0<He.length&&!this.W){this.W=!0;var hn=this.j;hn.g==this&&hn.ba&&!hn.M&&(hn.j.info("Great, no buffering proxy detected. Bytes received: "+He.length),Zn(hn),hn.M=!0,qr(11))}}else b(this.i,this.l,He,null),Pi(this,He);An==4&&hr(this),this.o&&!this.J&&(An==4?i0(this.j,this):(this.o=!1,Ye(this)))}else Qr(this.g),C==400&&0<He.indexOf("Unknown SID")?(this.s=3,qr(12)):(this.s=0,qr(13)),hr(this),Bt(this)}}}catch{}finally{}};function Ke(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function Re(d,v){var C=d.C,O=v.indexOf(`
`,C);return O==-1?he:(C=Number(v.substring(C,O)),isNaN(C)?se:(O+=1,O+C>v.length?he:(v=v.slice(O,O+C),d.C=O+C,v)))}pe.prototype.cancel=function(){this.J=!0,hr(this)};function Ye(d){d.S=Date.now()+d.I,ct(d,d.I)}function ct(d,v){if(d.B!=null)throw Error("WatchDog timer not null");d.B=Ls(g(d.ba,d),v)}function Lt(d){d.B&&(o.clearTimeout(d.B),d.B=null)}pe.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(G(this.i,this.A),this.L!=2&&(Di(),qr(17)),hr(this),this.s=2,Bt(this)):ct(this,this.S-d)};function Bt(d){d.j.G==0||d.J||i0(d.j,d)}function hr(d){Lt(d);var v=d.M;v&&typeof v.ma=="function"&&v.ma(),d.M=null,xi(d.U),d.g&&(v=d.g,d.g=null,v.abort(),v.ma())}function Pi(d,v){try{var C=d.j;if(C.G!=0&&(C.g==d||st(C.h,d))){if(!d.K&&st(C.h,d)&&C.G==3){try{var O=C.Da.g.parse(v)}catch{O=null}if(Array.isArray(O)&&O.length==3){var le=O;if(le[0]==0){e:if(!C.u){if(C.g)if(C.g.F+3e3<d.F)yc(C),xo(C);else break e;vc(C),qr(18)}}else C.za=le[1],0<C.za-C.T&&37500>le[2]&&C.F&&C.v==0&&!C.C&&(C.C=Ls(g(C.Za,C),6e3));if(1>=ds(C.h)&&C.ca){try{C.ca()}catch{}C.ca=void 0}}else Un(C,11)}else if((d.K||C.g==d)&&yc(C),!k(v))for(le=C.Da.g.parse(v),v=0;v<le.length;v++){let Ht=le[v];if(C.T=Ht[0],Ht=Ht[1],C.G==2)if(Ht[0]=="c"){C.K=Ht[1],C.ia=Ht[2];const hn=Ht[3];hn!=null&&(C.la=hn,C.j.info("VER="+C.la));const An=Ht[4];An!=null&&(C.Aa=An,C.j.info("SVER="+C.Aa));const Oa=Ht[5];Oa!=null&&typeof Oa=="number"&&0<Oa&&(O=1.5*Oa,C.L=O,C.j.info("backChannelRequestTimeoutMs_="+O)),O=C;const Xi=d.g;if(Xi){const wc=Xi.g?Xi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(wc){var me=O.h;me.g||wc.indexOf("spdy")==-1&&wc.indexOf("quic")==-1&&wc.indexOf("h2")==-1||(me.j=me.l,me.g=new Set,me.h&&(Bs(me,me.h),me.h=null))}if(O.D){const _l=Xi.g?Xi.g.getResponseHeader("X-HTTP-Session-Id"):null;_l&&(O.ya=_l,Ut(O.I,O.D,_l))}}C.G=3,C.l&&C.l.ua(),C.ba&&(C.R=Date.now()-d.F,C.j.info("Handshake RTT: "+C.R+"ms")),O=C;var He=d;if(O.qa=_c(O,O.J?O.ia:null,O.W),He.K){jt(O.h,He);var tr=He,fn=O.L;fn&&(tr.I=fn),tr.B&&(Lt(tr),Ye(tr)),O.g=He}else vo(O);0<C.i.length&&Ra(C)}else Ht[0]!="stop"&&Ht[0]!="close"||Un(C,7);else C.G==3&&(Ht[0]=="stop"||Ht[0]=="close"?Ht[0]=="stop"?Un(C,7):_i(C):Ht[0]!="noop"&&C.l&&C.l.ta(Ht),C.v=0)}}Di(4)}catch{}}var lr=class{constructor(d,v){this.g=d,this.map=v}};function us(d){this.l=d||10,o.PerformanceNavigationTiming?(d=o.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ir(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function ds(d){return d.h?1:d.g?d.g.size:0}function st(d,v){return d.h?d.h==v:d.g?d.g.has(v):!1}function Bs(d,v){d.g?d.g.add(v):d.h=v}function jt(d,v){d.h&&d.h==v?d.h=null:d.g&&d.g.has(v)&&d.g.delete(v)}us.prototype.cancel=function(){if(this.i=Oi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function Oi(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let v=d.i;for(const C of d.g.values())v=v.concat(C.D);return v}return x(d.i)}function ln(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(l(d)){for(var v=[],C=d.length,O=0;O<C;O++)v.push(d[O]);return v}v=[],C=0;for(O in d)v[C++]=d[O];return v}function Fa(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(l(d)||typeof d=="string"){var v=[];d=d.length;for(var C=0;C<d;C++)v.push(C);return v}v=[],C=0;for(const O in d)v[C++]=O;return v}}}function ba(d,v){if(d.forEach&&typeof d.forEach=="function")d.forEach(v,void 0);else if(l(d)||typeof d=="string")Array.prototype.forEach.call(d,v,void 0);else for(var C=Fa(d),O=ln(d),le=O.length,me=0;me<le;me++)v.call(void 0,O[me],C&&C[me],d)}var sa=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function pc(d,v){if(d){d=d.split("&");for(var C=0;C<d.length;C++){var O=d[C].indexOf("="),le=null;if(0<=O){var me=d[C].substring(0,O);le=d[C].substring(O+1)}else me=d[C];v(me,le?decodeURIComponent(le.replace(/\+/g," ")):"")}}}function js(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof js){this.h=d.h,aa(this,d.j),this.o=d.o,this.g=d.g,Bn(this,d.s),this.l=d.l;var v=d.i,C=new yi;C.i=v.i,v.g&&(C.g=new Map(v.g),C.h=v.h),po(this,C),this.m=d.m}else d&&(v=String(d).match(sa))?(this.h=!1,aa(this,v[1]||"",!0),this.o=fs(v[2]||""),this.g=fs(v[3]||"",!0),Bn(this,v[4]),this.l=fs(v[5]||"",!0),po(this,v[6]||"",!0),this.m=fs(v[7]||"")):(this.h=!1,this.i=new yi(null,this.h))}js.prototype.toString=function(){var d=[],v=this.j;v&&d.push(hs(v,hl,!0),":");var C=this.g;return(C||v=="file")&&(d.push("//"),(v=this.o)&&d.push(hs(v,hl,!0),"@"),d.push(encodeURIComponent(String(C)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.s,C!=null&&d.push(":",String(C))),(C=this.l)&&(this.g&&C.charAt(0)!="/"&&d.push("/"),d.push(hs(C,C.charAt(0)=="/"?gc:vi,!0))),(C=this.i.toString())&&d.push("?",C),(C=this.m)&&d.push("#",hs(C,mc)),d.join("")};function cn(d){return new js(d)}function aa(d,v,C){d.j=C?fs(v,!0):v,d.j&&(d.j=d.j.replace(/:$/,""))}function Bn(d,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);d.s=v}else d.s=null}function po(d,v,C){v instanceof yi?(d.i=v,Zf(d.i,d.h)):(C||(v=hs(v,Mi)),d.i=new yi(v,d.h))}function Ut(d,v,C){d.i.set(v,C)}function Ia(d){return Ut(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function fs(d,v){return d?v?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function hs(d,v,C){return typeof d=="string"?(d=encodeURI(d).replace(v,Vu),C&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function Vu(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var hl=/[#\/\?@]/g,vi=/[#\?:]/g,gc=/[#\?]/g,Mi=/[#\?@]/g,mc=/#/g;function yi(d,v){this.h=this.g=null,this.i=d||null,this.j=!!v}function ps(d){d.g||(d.g=new Map,d.h=0,d.i&&pc(d.i,function(v,C){d.add(decodeURIComponent(v.replace(/\+/g," ")),C)}))}t=yi.prototype,t.add=function(d,v){ps(this),this.i=null,d=Us(this,d);var C=this.g.get(d);return C||this.g.set(d,C=[]),C.push(v),this.h+=1,this};function un(d,v){ps(d),v=Us(d,v),d.g.has(v)&&(d.i=null,d.h-=d.g.get(v).length,d.g.delete(v))}function pl(d,v){return ps(d),v=Us(d,v),d.g.has(v)}t.forEach=function(d,v){ps(this),this.g.forEach(function(C,O){C.forEach(function(le){d.call(v,le,O,this)},this)},this)},t.na=function(){ps(this);const d=Array.from(this.g.values()),v=Array.from(this.g.keys()),C=[];for(let O=0;O<v.length;O++){const le=d[O];for(let me=0;me<le.length;me++)C.push(v[O])}return C},t.V=function(d){ps(this);let v=[];if(typeof d=="string")pl(this,d)&&(v=v.concat(this.g.get(Us(this,d))));else{d=Array.from(this.g.values());for(let C=0;C<d.length;C++)v=v.concat(d[C])}return v},t.set=function(d,v){return ps(this),this.i=null,d=Us(this,d),pl(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[v]),this.h+=1,this},t.get=function(d,v){return d?(d=this.V(d),0<d.length?String(d[0]):v):v};function Jf(d,v,C){un(d,v),0<C.length&&(d.i=null,d.g.set(Us(d,v),x(C)),d.h+=C.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],v=Array.from(this.g.keys());for(var C=0;C<v.length;C++){var O=v[C];const me=encodeURIComponent(String(O)),He=this.V(O);for(O=0;O<He.length;O++){var le=me;He[O]!==""&&(le+="="+encodeURIComponent(String(He[O]))),d.push(le)}}return this.i=d.join("&")};function Us(d,v){return v=String(v),d.j&&(v=v.toLowerCase()),v}function Zf(d,v){v&&!d.j&&(ps(d),d.i=null,d.g.forEach(function(C,O){var le=O.toLowerCase();O!=le&&(un(this,O),Jf(this,le,C))},d)),d.j=v}function zu(d,v){const C=new on;if(o.Image){const O=new Image;O.onload=m(Li,C,"TestLoadImage: loaded",!0,v,O),O.onerror=m(Li,C,"TestLoadImage: error",!1,v,O),O.onabort=m(Li,C,"TestLoadImage: abort",!1,v,O),O.ontimeout=m(Li,C,"TestLoadImage: timeout",!1,v,O),o.setTimeout(function(){O.ontimeout&&O.ontimeout()},1e4),O.src=d}else v(!1)}function vt(d,v){const C=new on,O=new AbortController,le=setTimeout(()=>{O.abort(),Li(C,"TestPingServer: timeout",!1,v)},1e4);fetch(d,{signal:O.signal}).then(me=>{clearTimeout(le),me.ok?Li(C,"TestPingServer: ok",!0,v):Li(C,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(le),Li(C,"TestPingServer: error",!1,v)})}function Li(d,v,C,O,le){try{le&&(le.onload=null,le.onerror=null,le.onabort=null,le.ontimeout=null),O(C)}catch{}}function Tr(){this.g=new Uu}function go(d,v,C){const O=C||"";try{ba(d,function(le,me){let He=le;u(le)&&(He=fo(le)),v.push(O+me+"="+encodeURIComponent(He))})}catch(le){throw v.push(O+"type="+encodeURIComponent("_badmap")),le}}function gl(d){this.l=d.Ub||null,this.j=d.eb||!1}y(gl,Os),gl.prototype.g=function(){return new ml(this.l,this.j)},gl.prototype.i=function(d){return function(){return d}}({});function ml(d,v){er.call(this),this.D=d,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(ml,er),t=ml.prototype,t.open=function(d,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=v,this.readyState=1,mo(this)},t.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(v.body=d),(this.D||o).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Na(this)),this.readyState=0},t.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,mo(this)),this.g&&(this.readyState=3,mo(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Wu(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function Wu(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}t.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var v=d.value?d.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!d.done}))&&(this.response=this.responseText+=v)}d.done?Na(this):mo(this),this.readyState==3&&Wu(this)}},t.Ra=function(d){this.g&&(this.response=this.responseText=d,Na(this))},t.Qa=function(d){this.g&&(this.response=d,Na(this))},t.ga=function(){this.g&&Na(this)};function Na(d){d.readyState=4,d.l=null,d.j=null,d.v=null,mo(d)}t.setRequestHeader=function(d,v){this.u.append(d,v)},t.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],v=this.h.entries();for(var C=v.next();!C.done;)C=C.value,d.push(C[0]+": "+C[1]),C=v.next();return d.join(`\r
`)};function mo(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(ml.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function Hu(d){let v="";return V(d,function(C,O){v+=O,v+=":",v+=C,v+=`\r
`}),v}function xc(d,v,C){e:{for(O in C){var O=!1;break e}O=!0}O||(C=Hu(C),typeof d=="string"?C!=null&&encodeURIComponent(String(C)):Ut(d,v,C))}function cr(d){er.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(cr,er);var e0=/^https?$/i,t0=["POST","PUT"];t=cr.prototype,t.Ha=function(d){this.J=d},t.ea=function(d,v,C,O){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);v=v?v.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Q.g(),this.v=this.o?fl(this.o):fl(Q),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(v,String(d),!0),this.B=!1}catch(me){dn(this,me);return}if(d=C||"",C=new Map(this.headers),O)if(Object.getPrototypeOf(O)===Object.prototype)for(var le in O)C.set(le,O[le]);else if(typeof O.keys=="function"&&typeof O.get=="function")for(const me of O.keys())C.set(me,O.get(me));else throw Error("Unknown input type for opt_headers: "+String(O));O=Array.from(C.keys()).find(me=>me.toLowerCase()=="content-type"),le=o.FormData&&d instanceof o.FormData,!(0<=Array.prototype.indexOf.call(t0,v,void 0))||O||le||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[me,He]of C)this.g.setRequestHeader(me,He);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Bi(this),this.u=!0,this.g.send(d),this.u=!1}catch(me){dn(this,me)}};function dn(d,v){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=v,d.m=5,wn(d),Jn(d)}function wn(d){d.A||(d.A=!0,br(d,"complete"),br(d,"error"))}t.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,br(this,"complete"),br(this,"abort"),Jn(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Jn(this,!0)),cr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?jn(this):this.bb())},t.bb=function(){jn(this)};function jn(d){if(d.h&&typeof a<"u"&&(!d.v[1]||gs(d)!=4||d.Z()!=2)){if(d.u&&gs(d)==4)mi(d.Ea,0,d);else if(br(d,"readystatechange"),gs(d)==4){d.h=!1;try{const He=d.Z();e:switch(He){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var C;if(!(C=v)){var O;if(O=He===0){var le=String(d.D).match(sa)[1]||null;!le&&o.self&&o.self.location&&(le=o.self.location.protocol.slice(0,-1)),O=!e0.test(le?le.toLowerCase():"")}C=O}if(C)br(d,"complete"),br(d,"success");else{d.m=6;try{var me=2<gs(d)?d.g.statusText:""}catch{me=""}d.l=me+" ["+d.Z()+"]",wn(d)}}finally{Jn(d)}}}}function Jn(d,v){if(d.g){Bi(d);const C=d.g,O=d.v[0]?()=>{}:null;d.g=null,d.v=null,v||br(d,"ready");try{C.onreadystatechange=O}catch{}}}function Bi(d){d.I&&(o.clearTimeout(d.I),d.I=null)}t.isActive=function(){return!!this.g};function gs(d){return d.g?d.g.readyState:0}t.Z=function(){try{return 2<gs(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(d){if(this.g){var v=this.g.responseText;return d&&v.indexOf(d)==0&&(v=v.substring(d.length)),ho(v)}};function xl(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function Qr(d){const v={};d=(d.g&&2<=gs(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let O=0;O<d.length;O++){if(k(d[O]))continue;var C=R(d[O]);const le=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const me=v[le]||[];v[le]=me,me.push(C)}T(v,function(O){return O.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ms(d,v,C){return C&&C.internalChannelParams&&C.internalChannelParams[d]||v}function qt(d){this.Aa=0,this.i=[],this.j=new on,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ms("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ms("baseRetryDelayMs",5e3,d),this.cb=ms("retryDelaySeedMs",1e4,d),this.Wa=ms("forwardChannelMaxRetries",2,d),this.wa=ms("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new us(d&&d.concurrentRequestLimit),this.Da=new Tr,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=qt.prototype,t.la=8,t.G=1,t.connect=function(d,v,C,O){qr(0),this.W=d,this.H=v||{},C&&O!==void 0&&(this.H.OSID=C,this.H.OAID=O),this.F=this.X,this.I=_c(this,null,this.W),Ra(this)};function _i(d){if(vl(d),d.G==3){var v=d.U++,C=cn(d.I);if(Ut(C,"SID",d.K),Ut(C,"RID",v),Ut(C,"TYPE","terminate"),Pa(d,C),v=new pe(d,d.j,v),v.L=2,v.v=Ia(cn(C)),C=!1,o.navigator&&o.navigator.sendBeacon)try{C=o.navigator.sendBeacon(v.v.toString(),"")}catch{}!C&&o.Image&&(new Image().src=v.v,C=!0),C||(v.g=s0(v.j,null),v.g.ea(v.v)),v.F=Date.now(),Ye(v)}Gu(d)}function xo(d){d.g&&(Zn(d),d.g.cancel(),d.g=null)}function vl(d){xo(d),d.u&&(o.clearTimeout(d.u),d.u=null),yc(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&o.clearTimeout(d.s),d.s=null)}function Ra(d){if(!Ir(d.h)&&!d.s){d.s=!0;var v=d.Ga;be||Ce(),Te||(be(),Te=!0),ie.add(v,d),d.B=0}}function Da(d,v){return ds(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=v.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=Ls(g(d.Ga,d,v),yl(d,d.B)),d.B++,!0)}t.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const le=new pe(this,this.j,d);let me=this.o;if(this.S&&(me?(me=F(me),I(me,this.S)):me=this.S),this.m!==null||this.O||(le.H=me,me=null),this.P)e:{for(var v=0,C=0;C<this.i.length;C++){t:{var O=this.i[C];if("__data__"in O.map&&(O=O.map.__data__,typeof O=="string")){O=O.length;break t}O=void 0}if(O===void 0)break;if(v+=O,4096<v){v=C;break e}if(v===4096||C===this.i.length-1){v=C+1;break e}}v=1e3}else v=1e3;v=r0(this,le,v),C=cn(this.I),Ut(C,"RID",d),Ut(C,"CVER",22),this.D&&Ut(C,"X-HTTP-Session-Id",this.D),Pa(this,C),me&&(this.O?v="headers="+encodeURIComponent(String(Hu(me)))+"&"+v:this.m&&xc(C,this.m,me)),Bs(this.h,le),this.Ua&&Ut(C,"TYPE","init"),this.P?(Ut(C,"$req",v),Ut(C,"SID","null"),le.T=!0,Se(le,C,null)):Se(le,C,v),this.G=2}}else this.G==3&&(d?$u(this,d):this.i.length==0||Ir(this.h)||$u(this))};function $u(d,v){var C;v?C=v.l:C=d.U++;const O=cn(d.I);Ut(O,"SID",d.K),Ut(O,"RID",C),Ut(O,"AID",d.T),Pa(d,O),d.m&&d.o&&xc(O,d.m,d.o),C=new pe(d,d.j,C,d.B+1),d.m===null&&(C.H=d.o),v&&(d.i=v.D.concat(d.i)),v=r0(d,C,1e3),C.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),Bs(d.h,C),Se(C,O,v)}function Pa(d,v){d.H&&V(d.H,function(C,O){Ut(v,O,C)}),d.l&&ba({},function(C,O){Ut(v,O,C)})}function r0(d,v,C){C=Math.min(d.i.length,C);var O=d.l?g(d.l.Na,d.l,d):null;e:{var le=d.i;let me=-1;for(;;){const He=["count="+C];me==-1?0<C?(me=le[0].g,He.push("ofs="+me)):me=0:He.push("ofs="+me);let tr=!0;for(let fn=0;fn<C;fn++){let Ht=le[fn].g;const hn=le[fn].map;if(Ht-=me,0>Ht)me=Math.max(0,le[fn].g-100),tr=!1;else try{go(hn,He,"req"+Ht+"_")}catch{O&&O(hn)}}if(tr){O=He.join("&");break e}}}return d=d.i.splice(0,C),v.D=d,O}function vo(d){if(!d.g&&!d.u){d.Y=1;var v=d.Fa;be||Ce(),Te||(be(),Te=!0),ie.add(v,d),d.v=0}}function vc(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=Ls(g(d.Fa,d),yl(d,d.v)),d.v++,!0)}t.Fa=function(){if(this.u=null,n0(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=Ls(g(this.ab,this),d)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,qr(10),xo(this),n0(this))};function Zn(d){d.A!=null&&(o.clearTimeout(d.A),d.A=null)}function n0(d){d.g=new pe(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var v=cn(d.qa);Ut(v,"RID","rpc"),Ut(v,"SID",d.K),Ut(v,"AID",d.T),Ut(v,"CI",d.F?"0":"1"),!d.F&&d.ja&&Ut(v,"TO",d.ja),Ut(v,"TYPE","xmlhttp"),Pa(d,v),d.m&&d.o&&xc(v,d.m,d.o),d.L&&(d.g.I=d.L);var C=d.g;d=d.ia,C.L=1,C.v=Ia(cn(v)),C.m=null,C.P=!0,Ue(C,d)}t.Za=function(){this.C!=null&&(this.C=null,xo(this),vc(this),qr(19))};function yc(d){d.C!=null&&(o.clearTimeout(d.C),d.C=null)}function i0(d,v){var C=null;if(d.g==v){yc(d),Zn(d),d.g=null;var O=2}else if(st(d.h,v))C=v.D,jt(d.h,v),O=1;else return;if(d.G!=0){if(v.o)if(O==1){C=v.m?v.m.length:0,v=Date.now()-v.F;var le=d.B;O=na(),br(O,new Ca(O,C)),Ra(d)}else vo(d);else if(le=v.s,le==3||le==0&&0<v.X||!(O==1&&Da(d,v)||O==2&&vc(d)))switch(C&&0<C.length&&(v=d.h,v.i=v.i.concat(C)),le){case 1:Un(d,5);break;case 4:Un(d,10);break;case 3:Un(d,6);break;default:Un(d,2)}}}function yl(d,v){let C=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(C*=2),C*v}function Un(d,v){if(d.j.info("Error code "+v),v==2){var C=g(d.fb,d),O=d.Xa;const le=!O;O=new js(O||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||aa(O,"https"),Ia(O),le?zu(O.toString(),C):vt(O.toString(),C)}else qr(2);d.G=0,d.l&&d.l.sa(v),Gu(d),vl(d)}t.fb=function(d){d?(this.j.info("Successfully pinged google.com"),qr(2)):(this.j.info("Failed to ping google.com"),qr(1))};function Gu(d){if(d.G=0,d.ka=[],d.l){const v=Oi(d.h);(v.length!=0||d.i.length!=0)&&(w(d.ka,v),w(d.ka,d.i),d.h.i.length=0,x(d.i),d.i.length=0),d.l.ra()}}function _c(d,v,C){var O=C instanceof js?cn(C):new js(C);if(O.g!="")v&&(O.g=v+"."+O.g),Bn(O,O.s);else{var le=o.location;O=le.protocol,v=v?v+"."+le.hostname:le.hostname,le=+le.port;var me=new js(null);O&&aa(me,O),v&&(me.g=v),le&&Bn(me,le),C&&(me.l=C),O=me}return C=d.D,v=d.ya,C&&v&&Ut(O,C,v),Ut(O,"VER",d.la),Pa(d,O),O}function s0(d,v,C){if(v&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=d.Ca&&!d.pa?new cr(new gl({eb:C})):new cr(d.pa),v.Ha(d.J),v}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function dr(){}t=dr.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Sn(){}Sn.prototype.g=function(d,v){return new Tn(d,v)};function Tn(d,v){er.call(this),this.g=new qt(v),this.l=d,this.h=v&&v.messageUrlParams||null,d=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(d?d["X-WebChannel-Content-Type"]=v.messageContentType:d={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(d?d["X-WebChannel-Client-Profile"]=v.va:d={"X-WebChannel-Client-Profile":v.va}),this.g.S=d,(d=v&&v.Sb)&&!k(d)&&(this.g.m=d),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!k(v)&&(this.g.D=v,d=this.h,d!==null&&v in d&&(d=this.h,v in d&&delete d[v])),this.j=new yo(this)}y(Tn,er),Tn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Tn.prototype.close=function(){_i(this.g)},Tn.prototype.o=function(d){var v=this.g;if(typeof d=="string"){var C={};C.__data__=d,d=C}else this.u&&(C={},C.__data__=fo(d),d=C);v.i.push(new lr(v.Ya++,d)),v.G==3&&Ra(v)},Tn.prototype.N=function(){this.g.l=null,delete this.j,_i(this.g),delete this.g,Tn.aa.N.call(this)};function Yi(d){Br.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var v=d.__sm__;if(v){e:{for(const C in v){d=C;break e}d=void 0}(this.i=d)&&(d=this.i,v=v!==null&&d in v?v[d]:void 0),this.data=v}else this.data=d}y(Yi,Br);function Ec(){Ri.call(this),this.status=1}y(Ec,Ri);function yo(d){this.g=d}y(yo,dr),yo.prototype.ua=function(){br(this.g,"a")},yo.prototype.ta=function(d){br(this.g,new Yi(d))},yo.prototype.sa=function(d){br(this.g,new Ec)},yo.prototype.ra=function(){br(this.g,"b")},Sn.prototype.createWebChannel=Sn.prototype.g,Tn.prototype.send=Tn.prototype.o,Tn.prototype.open=Tn.prototype.m,Tn.prototype.close=Tn.prototype.close,qk=function(){return new Sn},Xk=function(){return na()},Yk=cs,yx={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},U.NO_ERROR=0,U.TIMEOUT=8,U.HTTP_ERROR=6,uh=U,X.COMPLETE="complete",Kk=X,Ms.EventType=ce,ce.OPEN="a",ce.CLOSE="b",ce.ERROR="c",ce.MESSAGE="d",er.prototype.listen=er.prototype.K,pd=Ms,cr.prototype.listenOnce=cr.prototype.L,cr.prototype.getLastError=cr.prototype.Ka,cr.prototype.getLastErrorCode=cr.prototype.Ba,cr.prototype.getStatus=cr.prototype.Z,cr.prototype.getResponseJson=cr.prototype.Oa,cr.prototype.getResponseText=cr.prototype.oa,cr.prototype.send=cr.prototype.ea,cr.prototype.setWithCredentials=cr.prototype.Ha,Gk=cr}).apply(typeof W0<"u"?W0:typeof self<"u"?self:typeof window<"u"?window:{});const dE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}si.UNAUTHENTICATED=new si(null),si.GOOGLE_CREDENTIALS=new si("google-credentials-uid"),si.FIRST_PARTY=new si("first-party-uid"),si.MOCK_USER=new si("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ou="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zl=new vv("@firebase/firestore");function ad(){return Zl.logLevel}function Ze(t,...e){if(Zl.logLevel<=Wt.DEBUG){const r=e.map(Ev);Zl.debug(`Firestore (${Ou}): ${t}`,...r)}}function ro(t,...e){if(Zl.logLevel<=Wt.ERROR){const r=e.map(Ev);Zl.error(`Firestore (${Ou}): ${t}`,...r)}}function yu(t,...e){if(Zl.logLevel<=Wt.WARN){const r=e.map(Ev);Zl.warn(`Firestore (${Ou}): ${t}`,...r)}}function Ev(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gt(t="Unexpected state"){const e=`FIRESTORE (${Ou}) INTERNAL ASSERTION FAILED: `+t;throw ro(e),new Error(e)}function ar(t,e){t||gt()}function _t(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class it extends uo{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qk{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class _7{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(si.UNAUTHENTICATED))}shutdown(){}}class E7{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class w7{constructor(e){this.t=e,this.currentUser=si.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){ar(this.o===void 0);let n=this.i;const i=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let s=new Xo;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Xo,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{Ze("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Ze("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Xo)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Ze("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(ar(typeof n.accessToken=="string"),new Qk(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ar(e===null||typeof e=="string"),new si(e)}}class S7{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=si.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class T7{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new S7(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(si.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class A7{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class k7{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){ar(this.o===void 0);const n=s=>{s.error!=null&&Ze("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,Ze("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{Ze("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Ze("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(ar(typeof r.token=="string"),this.R=r.token,new A7(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C7(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=C7(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=e.charAt(i[s]%e.length))}return n}}function Jt(t,e){return t<e?-1:t>e?1:0}function _u(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new it(Oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new it(Oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new it(Oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new it(Oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return _n.fromMillis(Date.now())}static fromDate(e){return _n.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new _n(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Jt(this.nanoseconds,e.nanoseconds):Jt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new yt(e)}static min(){return new yt(new _n(0,0))}static max(){return new yt(new _n(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(e,r,n){r===void 0?r=0:r>e.length&&gt(),n===void 0?n=e.length-r:n>e.length-r&&gt(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return yf.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof yf?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const s=e.get(i),a=r.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class Vr extends yf{construct(e,r,n){return new Vr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new it(Oe.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Vr(r)}static emptyPath(){return new Vr([])}}const F7=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Kn extends yf{construct(e,r,n){return new Kn(e,r,n)}static isValidIdentifier(e){return F7.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Kn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Kn(["__name__"])}static fromServerFormat(e){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new it(Oe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new it(Oe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new it(Oe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new it(Oe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Kn(r)}static emptyPath(){return new Kn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e){this.path=e}static fromPath(e){return new at(Vr.fromString(e))}static fromName(e){return new at(Vr.fromString(e).popFirst(5))}static empty(){return new at(Vr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Vr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Vr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new at(new Vr(e.slice()))}}function b7(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=yt.fromTimestamp(n===1e9?new _n(r+1,0):new _n(r,n));return new nl(i,at.empty(),e)}function I7(t){return new nl(t.readTime,t.key,-1)}class nl{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new nl(yt.min(),at.empty(),-1)}static max(){return new nl(yt.max(),at.empty(),-1)}}function N7(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=at.comparator(t.documentKey,e.documentKey),r!==0?r:Jt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R7="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class D7{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wf(t){if(t.code!==Oe.FAILED_PRECONDITION||t.message!==R7)throw t;Ze("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&gt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Ne((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Ne?r:Ne.resolve(r)}catch(r){return Ne.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Ne.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Ne.reject(r)}static resolve(e){return new Ne((r,n)=>{r(e)})}static reject(e){return new Ne((r,n)=>{n(e)})}static waitFor(e){return new Ne((r,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},l=>n(l))}),a=!0,s===i&&r()})}static or(e){let r=Ne.resolve(!1);for(const n of e)r=r.next(i=>i?Ne.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(e,r){return new Ne((n,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const u=l;r(e[u]).next(f=>{a[u]=f,++o,o===s&&n(a)},f=>i(f))}})}static doWhile(e,r){return new Ne((n,i)=>{const s=()=>{e()===!0?r().next(()=>{s()},i):n()};s()})}}function P7(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Hf(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wv{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}wv.oe=-1;function $p(t){return t==null}function sp(t){return t===0&&1/t==-1/0}function O7(t){return typeof t=="number"&&Number.isInteger(t)&&!sp(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fE(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Mu(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function Zk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(e,r){this.comparator=e,this.root=r||Hn.EMPTY}insert(e,r){return new Lr(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Hn.BLACK,null,null))}remove(e){return new Lr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Hn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new H0(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new H0(this.root,e,this.comparator,!1)}getReverseIterator(){return new H0(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new H0(this.root,e,this.comparator,!0)}}class H0{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Hn{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n??Hn.RED,this.left=i??Hn.EMPTY,this.right=s??Hn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,s){return new Hn(e??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Hn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return Hn.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Hn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Hn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw gt();const e=this.left.check();if(e!==this.right.check())throw gt();return e+(this.isRed()?0:1)}}Hn.EMPTY=null,Hn.RED=!0,Hn.BLACK=!1;Hn.EMPTY=new class{constructor(){this.size=0}get key(){throw gt()}get value(){throw gt()}get color(){throw gt()}get left(){throw gt()}get right(){throw gt()}copy(e,r,n,i,s){return this}insert(e,r,n){return new Hn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(e){this.comparator=e,this.data=new Lr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new hE(this.data.getIterator())}getIteratorFrom(e){return new hE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Xn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Xn(this.comparator);return r.data=e,r}}class hE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(e){this.fields=e,e.sort(Kn.comparator)}static empty(){return new qs([])}unionWith(e){let r=new Xn(Kn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new qs(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return _u(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eC extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new eC("Invalid base64 string: "+s):s}}(e);return new Qn(r)}static fromUint8Array(e){const r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new Qn(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Jt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Qn.EMPTY_BYTE_STRING=new Qn("");const M7=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function il(t){if(ar(!!t),typeof t=="string"){let e=0;const r=M7.exec(t);if(ar(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Gr(t.seconds),nanos:Gr(t.nanos)}}function Gr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ec(t){return typeof t=="string"?Qn.fromBase64String(t):Qn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sv(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function Tv(t){const e=t.mapValue.fields.__previous_value__;return Sv(e)?Tv(e):e}function _f(t){const e=il(t.mapValue.fields.__local_write_time__.timestampValue);return new _n(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L7{constructor(e,r,n,i,s,a,o,l,u){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=u}}class Ef{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new Ef("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Ef&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $0={mapValue:{}};function tc(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Sv(t)?4:j7(t)?9007199254740991:B7(t)?10:11:gt()}function wa(t,e){if(t===e)return!0;const r=tc(t);if(r!==tc(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return _f(t).isEqual(_f(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=il(i.timestampValue),o=il(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return ec(i.bytesValue).isEqual(ec(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Gr(i.geoPointValue.latitude)===Gr(s.geoPointValue.latitude)&&Gr(i.geoPointValue.longitude)===Gr(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Gr(i.integerValue)===Gr(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=Gr(i.doubleValue),o=Gr(s.doubleValue);return a===o?sp(a)===sp(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return _u(t.arrayValue.values||[],e.arrayValue.values||[],wa);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(fE(a)!==fE(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!wa(a[l],o[l])))return!1;return!0}(t,e);default:return gt()}}function wf(t,e){return(t.values||[]).find(r=>wa(r,e))!==void 0}function Eu(t,e){if(t===e)return 0;const r=tc(t),n=tc(e);if(r!==n)return Jt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Jt(t.booleanValue,e.booleanValue);case 2:return function(s,a){const o=Gr(s.integerValue||s.doubleValue),l=Gr(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return pE(t.timestampValue,e.timestampValue);case 4:return pE(_f(t),_f(e));case 5:return Jt(t.stringValue,e.stringValue);case 6:return function(s,a){const o=ec(s),l=ec(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let u=0;u<o.length&&u<l.length;u++){const f=Jt(o[u],l[u]);if(f!==0)return f}return Jt(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const o=Jt(Gr(s.latitude),Gr(a.latitude));return o!==0?o:Jt(Gr(s.longitude),Gr(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return gE(t.arrayValue,e.arrayValue);case 10:return function(s,a){var o,l,u,f;const p=s.fields||{},g=a.fields||{},m=(o=p.value)===null||o===void 0?void 0:o.arrayValue,y=(l=g.value)===null||l===void 0?void 0:l.arrayValue,x=Jt(((u=m==null?void 0:m.values)===null||u===void 0?void 0:u.length)||0,((f=y==null?void 0:y.values)===null||f===void 0?void 0:f.length)||0);return x!==0?x:gE(m,y)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===$0.mapValue&&a===$0.mapValue)return 0;if(s===$0.mapValue)return 1;if(a===$0.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),u=a.fields||{},f=Object.keys(u);l.sort(),f.sort();for(let p=0;p<l.length&&p<f.length;++p){const g=Jt(l[p],f[p]);if(g!==0)return g;const m=Eu(o[l[p]],u[f[p]]);if(m!==0)return m}return Jt(l.length,f.length)}(t.mapValue,e.mapValue);default:throw gt()}}function pE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Jt(t,e);const r=il(t),n=il(e),i=Jt(r.seconds,n.seconds);return i!==0?i:Jt(r.nanos,n.nanos)}function gE(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const s=Eu(r[i],n[i]);if(s)return s}return Jt(r.length,n.length)}function wu(t){return _x(t)}function _x(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=il(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return ec(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return at.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=_x(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${_x(r.fields[a])}`;return i+"}"}(t.mapValue):gt()}function Ex(t){return!!t&&"integerValue"in t}function Av(t){return!!t&&"arrayValue"in t}function mE(t){return!!t&&"nullValue"in t}function xE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function dh(t){return!!t&&"mapValue"in t}function B7(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function Od(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Mu(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Od(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Od(t.arrayValue.values[r]);return e}return Object.assign({},t)}function j7(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs{constructor(e){this.value=e}static empty(){return new Cs({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!dh(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Od(r)}setAll(e){let r=Kn.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=Od(a):i.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(e){const r=this.field(e.popLast());dh(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return wa(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];dh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Mu(r,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new Cs(Od(this.value))}}function tC(t){const e=[];return Mu(t.fields,(r,n)=>{const i=new Kn([r]);if(dh(n)){const s=tC(n.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new qs(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(e,r,n,i,s,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new ci(e,0,yt.min(),yt.min(),yt.min(),Cs.empty(),0)}static newFoundDocument(e,r,n,i){return new ci(e,1,r,yt.min(),n,i,0)}static newNoDocument(e,r){return new ci(e,2,r,yt.min(),yt.min(),Cs.empty(),0)}static newUnknownDocument(e,r){return new ci(e,3,r,yt.min(),yt.min(),Cs.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(yt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Cs.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Cs.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=yt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ci&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ci(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(e,r){this.position=e,this.inclusive=r}}function vE(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?n=at.comparator(at.fromName(a.referenceValue),r.key):n=Eu(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function yE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!wa(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class op{constructor(e,r="asc"){this.field=e,this.dir=r}}function U7(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rC{}class vn extends rC{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new z7(e,r,n):r==="array-contains"?new $7(e,n):r==="in"?new G7(e,n):r==="not-in"?new K7(e,n):r==="array-contains-any"?new Y7(e,n):new vn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new W7(e,n):new H7(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(Eu(r,this.value)):r!==null&&tc(this.value)===tc(r)&&this.matchesComparison(Eu(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return gt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Sa extends rC{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new Sa(e,r)}matches(e){return nC(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function nC(t){return t.op==="and"}function iC(t){return V7(t)&&nC(t)}function V7(t){for(const e of t.filters)if(e instanceof Sa)return!1;return!0}function wx(t){if(t instanceof vn)return t.field.canonicalString()+t.op.toString()+wu(t.value);if(iC(t))return t.filters.map(e=>wx(e)).join(",");{const e=t.filters.map(r=>wx(r)).join(",");return`${t.op}(${e})`}}function sC(t,e){return t instanceof vn?function(n,i){return i instanceof vn&&n.op===i.op&&n.field.isEqual(i.field)&&wa(n.value,i.value)}(t,e):t instanceof Sa?function(n,i){return i instanceof Sa&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&sC(a,i.filters[o]),!0):!1}(t,e):void gt()}function aC(t){return t instanceof vn?function(r){return`${r.field.canonicalString()} ${r.op} ${wu(r.value)}`}(t):t instanceof Sa?function(r){return r.op.toString()+" {"+r.getFilters().map(aC).join(" ,")+"}"}(t):"Filter"}class z7 extends vn{constructor(e,r,n){super(e,r,n),this.key=at.fromName(n.referenceValue)}matches(e){const r=at.comparator(e.key,this.key);return this.matchesComparison(r)}}class W7 extends vn{constructor(e,r){super(e,"in",r),this.keys=oC("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class H7 extends vn{constructor(e,r){super(e,"not-in",r),this.keys=oC("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function oC(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>at.fromName(n.referenceValue))}class $7 extends vn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Av(r)&&wf(r.arrayValue,this.value)}}class G7 extends vn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&wf(this.value.arrayValue,r)}}class K7 extends vn{constructor(e,r){super(e,"not-in",r)}matches(e){if(wf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!wf(this.value.arrayValue,r)}}class Y7 extends vn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Av(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>wf(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X7{constructor(e,r=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ue=null}}function _E(t,e=null,r=[],n=[],i=null,s=null,a=null){return new X7(t,e,r,n,i,s,a)}function kv(t){const e=_t(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>wx(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),$p(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>wu(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>wu(n)).join(",")),e.ue=r}return e.ue}function Cv(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!U7(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!sC(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!yE(t.startAt,e.startAt)&&yE(t.endAt,e.endAt)}function Sx(t){return at.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gp{constructor(e,r=null,n=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function q7(t,e,r,n,i,s,a,o){return new Gp(t,e,r,n,i,s,a,o)}function Kp(t){return new Gp(t)}function EE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Q7(t){return t.collectionGroup!==null}function Md(t){const e=_t(t);if(e.ce===null){e.ce=[];const r=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Xn(Kn.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(o=o.add(u.field))})}),o})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new op(s,n))}),r.has(Kn.keyField().canonicalString())||e.ce.push(new op(Kn.keyField(),n))}return e.ce}function va(t){const e=_t(t);return e.le||(e.le=J7(e,Md(t))),e.le}function J7(t,e){if(t.limitType==="F")return _E(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new op(i.field,s)});const r=t.endAt?new ap(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new ap(t.startAt.position,t.startAt.inclusive):null;return _E(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Tx(t,e,r){return new Gp(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Yp(t,e){return Cv(va(t),va(e))&&t.limitType===e.limitType}function lC(t){return`${kv(va(t))}|lt:${t.limitType}`}function Nc(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>aC(i)).join(", ")}]`),$p(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>wu(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>wu(i)).join(",")),`Target(${n})`}(va(t))}; limitType=${t.limitType})`}function Xp(t,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):at.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,i){for(const s of Md(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,o,l){const u=vE(a,o,l);return a.inclusive?u<=0:u<0}(n.startAt,Md(n),i)||n.endAt&&!function(a,o,l){const u=vE(a,o,l);return a.inclusive?u>=0:u>0}(n.endAt,Md(n),i))}(t,e)}function Z7(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function cC(t){return(e,r)=>{let n=!1;for(const i of Md(t)){const s=eU(i,e,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function eU(t,e,r){const n=t.field.isKeyField()?at.comparator(e.key,r.key):function(s,a,o){const l=a.data.field(s),u=o.data.field(s);return l!==null&&u!==null?Eu(l,u):gt()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return gt()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Mu(this.inner,(r,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return Zk(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tU=new Lr(at.comparator);function no(){return tU}const uC=new Lr(at.comparator);function gd(...t){let e=uC;for(const r of t)e=e.insert(r.key,r);return e}function dC(t){let e=uC;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Rl(){return Ld()}function fC(){return Ld()}function Ld(){return new Lu(t=>t.toString(),(t,e)=>t.isEqual(e))}const rU=new Lr(at.comparator),nU=new Xn(at.comparator);function Ot(...t){let e=nU;for(const r of t)e=e.add(r);return e}const iU=new Xn(Jt);function sU(){return iU}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:sp(e)?"-0":e}}function hC(t){return{integerValue:""+t}}function aU(t,e){return O7(e)?hC(e):Fv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qp{constructor(){this._=void 0}}function oU(t,e,r){return t instanceof lp?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Sv(s)&&(s=Tv(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(r,e):t instanceof Sf?gC(t,e):t instanceof Tf?mC(t,e):function(i,s){const a=pC(i,s),o=wE(a)+wE(i.Pe);return Ex(a)&&Ex(i.Pe)?hC(o):Fv(i.serializer,o)}(t,e)}function lU(t,e,r){return t instanceof Sf?gC(t,e):t instanceof Tf?mC(t,e):r}function pC(t,e){return t instanceof cp?function(n){return Ex(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class lp extends qp{}class Sf extends qp{constructor(e){super(),this.elements=e}}function gC(t,e){const r=xC(e);for(const n of t.elements)r.some(i=>wa(i,n))||r.push(n);return{arrayValue:{values:r}}}class Tf extends qp{constructor(e){super(),this.elements=e}}function mC(t,e){let r=xC(e);for(const n of t.elements)r=r.filter(i=>!wa(i,n));return{arrayValue:{values:r}}}class cp extends qp{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function wE(t){return Gr(t.integerValue||t.doubleValue)}function xC(t){return Av(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function cU(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof Sf&&i instanceof Sf||n instanceof Tf&&i instanceof Tf?_u(n.elements,i.elements,wa):n instanceof cp&&i instanceof cp?wa(n.Pe,i.Pe):n instanceof lp&&i instanceof lp}(t.transform,e.transform)}class uU{constructor(e,r){this.version=e,this.transformResults=r}}class Xa{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Xa}static exists(e){return new Xa(void 0,e)}static updateTime(e){return new Xa(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function fh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Qp{}function vC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new _C(t.key,Xa.none()):new $f(t.key,t.data,Xa.none());{const r=t.data,n=Cs.empty();let i=new Xn(Kn.comparator);for(let s of e.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new dc(t.key,n,new qs(i.toArray()),Xa.none())}}function dU(t,e,r){t instanceof $f?function(i,s,a){const o=i.value.clone(),l=TE(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof dc?function(i,s,a){if(!fh(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=TE(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(yC(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function Bd(t,e,r,n){return t instanceof $f?function(s,a,o,l){if(!fh(s.precondition,a))return o;const u=s.value.clone(),f=AE(s.fieldTransforms,l,a);return u.setAll(f),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null}(t,e,r,n):t instanceof dc?function(s,a,o,l){if(!fh(s.precondition,a))return o;const u=AE(s.fieldTransforms,l,a),f=a.data;return f.setAll(yC(s)),f.setAll(u),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(t,e,r,n):function(s,a,o){return fh(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function fU(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),s=pC(n.transform,i||null);s!=null&&(r===null&&(r=Cs.empty()),r.set(n.field,s))}return r||null}function SE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&_u(n,i,(s,a)=>cU(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class $f extends Qp{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class dc extends Qp{constructor(e,r,n,i,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function yC(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function TE(t,e,r){const n=new Map;ar(t.length===r.length);for(let i=0;i<r.length;i++){const s=t[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,lU(a,o,r[i]))}return n}function AE(t,e,r){const n=new Map;for(const i of t){const s=i.transform,a=r.data.field(i.field);n.set(i.field,oU(s,a,e))}return n}class _C extends Qp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class hU extends Qp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pU{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&dU(s,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Bd(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Bd(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=fC();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;const l=vC(a,o);l!==null&&n.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(yt.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Ot())}isEqual(e){return this.batchId===e.batchId&&_u(this.mutations,e.mutations,(r,n)=>SE(r,n))&&_u(this.baseMutations,e.baseMutations,(r,n)=>SE(r,n))}}class bv{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){ar(e.mutations.length===n.length);let i=function(){return rU}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new bv(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gU{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mU{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var en,$t;function xU(t){switch(t){default:return gt();case Oe.CANCELLED:case Oe.UNKNOWN:case Oe.DEADLINE_EXCEEDED:case Oe.RESOURCE_EXHAUSTED:case Oe.INTERNAL:case Oe.UNAVAILABLE:case Oe.UNAUTHENTICATED:return!1;case Oe.INVALID_ARGUMENT:case Oe.NOT_FOUND:case Oe.ALREADY_EXISTS:case Oe.PERMISSION_DENIED:case Oe.FAILED_PRECONDITION:case Oe.ABORTED:case Oe.OUT_OF_RANGE:case Oe.UNIMPLEMENTED:case Oe.DATA_LOSS:return!0}}function EC(t){if(t===void 0)return ro("GRPC error has no .code"),Oe.UNKNOWN;switch(t){case en.OK:return Oe.OK;case en.CANCELLED:return Oe.CANCELLED;case en.UNKNOWN:return Oe.UNKNOWN;case en.DEADLINE_EXCEEDED:return Oe.DEADLINE_EXCEEDED;case en.RESOURCE_EXHAUSTED:return Oe.RESOURCE_EXHAUSTED;case en.INTERNAL:return Oe.INTERNAL;case en.UNAVAILABLE:return Oe.UNAVAILABLE;case en.UNAUTHENTICATED:return Oe.UNAUTHENTICATED;case en.INVALID_ARGUMENT:return Oe.INVALID_ARGUMENT;case en.NOT_FOUND:return Oe.NOT_FOUND;case en.ALREADY_EXISTS:return Oe.ALREADY_EXISTS;case en.PERMISSION_DENIED:return Oe.PERMISSION_DENIED;case en.FAILED_PRECONDITION:return Oe.FAILED_PRECONDITION;case en.ABORTED:return Oe.ABORTED;case en.OUT_OF_RANGE:return Oe.OUT_OF_RANGE;case en.UNIMPLEMENTED:return Oe.UNIMPLEMENTED;case en.DATA_LOSS:return Oe.DATA_LOSS;default:return gt()}}($t=en||(en={}))[$t.OK=0]="OK",$t[$t.CANCELLED=1]="CANCELLED",$t[$t.UNKNOWN=2]="UNKNOWN",$t[$t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",$t[$t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",$t[$t.NOT_FOUND=5]="NOT_FOUND",$t[$t.ALREADY_EXISTS=6]="ALREADY_EXISTS",$t[$t.PERMISSION_DENIED=7]="PERMISSION_DENIED",$t[$t.UNAUTHENTICATED=16]="UNAUTHENTICATED",$t[$t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",$t[$t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",$t[$t.ABORTED=10]="ABORTED",$t[$t.OUT_OF_RANGE=11]="OUT_OF_RANGE",$t[$t.UNIMPLEMENTED=12]="UNIMPLEMENTED",$t[$t.INTERNAL=13]="INTERNAL",$t[$t.UNAVAILABLE=14]="UNAVAILABLE",$t[$t.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vU(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yU=new jl([4294967295,4294967295],0);function kE(t){const e=vU().encode(t),r=new $k;return r.update(e),new Uint8Array(r.digest())}function CE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new jl([r,n],0),new jl([i,s],0)]}class Iv{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new md(`Invalid padding: ${r}`);if(n<0)throw new md(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new md(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new md(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=jl.fromNumber(this.Ie)}Ee(e,r,n){let i=e.add(r.multiply(jl.fromNumber(n)));return i.compare(yU)===1&&(i=new jl([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=kE(e),[n,i]=CE(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);if(!this.de(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new Iv(s,i,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const r=kE(e),[n,i]=CE(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);this.Ae(a)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class md extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jp{constructor(e,r,n,i,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,Gf.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Jp(yt.min(),i,new Lr(Jt),no(),Ot())}}class Gf{constructor(e,r,n,i,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Gf(n,r,Ot(),Ot(),Ot())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hh{constructor(e,r,n,i){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=i}}class wC{constructor(e,r){this.targetId=e,this.me=r}}class SC{constructor(e,r,n=Qn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class FE{constructor(){this.fe=0,this.ge=IE(),this.pe=Qn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ot(),r=Ot(),n=Ot();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:gt()}}),new Gf(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=IE()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ar(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class _U{constructor(e){this.Le=e,this.Be=new Map,this.ke=no(),this.qe=bE(),this.Qe=new Lr(Jt)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:gt()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,i)=>{this.ze(i)&&r(i)})}He(e){const r=e.targetId,n=e.me.count,i=this.Je(r);if(i){const s=i.target;if(Sx(s))if(n===0){const a=new at(s.path);this.Ue(r,a,ci.newNoDocument(a,yt.min()))}else ar(n===1);else{const a=this.Ye(r);if(a!==n){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(r);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,u)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let a,o;try{a=ec(n).toUint8Array()}catch(l){if(l instanceof eC)return yu("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new Iv(a,i,s)}catch(l){return yu(l instanceof md?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,s,null),i++)}),i}rt(e){const r=new Map;this.Be.forEach((s,a)=>{const o=this.Je(a);if(o){if(s.current&&Sx(o.target)){const l=new at(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,ci.newNoDocument(l,e))}s.be&&(r.set(a,s.ve()),s.Ce())}});let n=Ot();this.qe.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const u=this.Je(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));const i=new Jp(e,r,this.Qe,this.ke,n);return this.ke=no(),this.qe=bE(),this.Qe=new Lr(Jt),i}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,r)?i.Fe(r,1):i.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new FE,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new Xn(Jt),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||Ze("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new FE),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function bE(){return new Lr(at.comparator)}function IE(){return new Lr(at.comparator)}const EU={asc:"ASCENDING",desc:"DESCENDING"},wU={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},SU={and:"AND",or:"OR"};class TU{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Ax(t,e){return t.useProto3Json||$p(e)?e:{value:e}}function up(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function TC(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function AU(t,e){return up(t,e.toTimestamp())}function ya(t){return ar(!!t),yt.fromTimestamp(function(r){const n=il(r);return new _n(n.seconds,n.nanos)}(t))}function Nv(t,e){return kx(t,e).canonicalString()}function kx(t,e){const r=function(i){return new Vr(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function AC(t){const e=Vr.fromString(t);return ar(IC(e)),e}function Cx(t,e){return Nv(t.databaseId,e.path)}function nm(t,e){const r=AC(e);if(r.get(1)!==t.databaseId.projectId)throw new it(Oe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new it(Oe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new at(CC(r))}function kC(t,e){return Nv(t.databaseId,e)}function kU(t){const e=AC(t);return e.length===4?Vr.emptyPath():CC(e)}function Fx(t){return new Vr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function CC(t){return ar(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function NE(t,e,r){return{name:Cx(t,e),fields:r.value.mapValue.fields}}function CU(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:gt()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,f){return u.useProto3Json?(ar(f===void 0||typeof f=="string"),Qn.fromBase64String(f||"")):(ar(f===void 0||f instanceof Buffer||f instanceof Uint8Array),Qn.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(u){const f=u.code===void 0?Oe.UNKNOWN:EC(u.code);return new it(f,u.message||"")}(a);r=new SC(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=nm(t,n.document.name),s=ya(n.document.updateTime),a=n.document.createTime?ya(n.document.createTime):yt.min(),o=new Cs({mapValue:{fields:n.document.fields}}),l=ci.newFoundDocument(i,s,a,o),u=n.targetIds||[],f=n.removedTargetIds||[];r=new hh(u,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=nm(t,n.document),s=n.readTime?ya(n.readTime):yt.min(),a=ci.newNoDocument(i,s),o=n.removedTargetIds||[];r=new hh([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=nm(t,n.document),s=n.removedTargetIds||[];r=new hh([],s,i,null)}else{if(!("filter"in e))return gt();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new mU(i,s),o=n.targetId;r=new wC(o,a)}}return r}function FU(t,e){let r;if(e instanceof $f)r={update:NE(t,e.key,e.value)};else if(e instanceof _C)r={delete:Cx(t,e.key)};else if(e instanceof dc)r={update:NE(t,e.key,e.data),updateMask:LU(e.fieldMask)};else{if(!(e instanceof hU))return gt();r={verify:Cx(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof lp)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Sf)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Tf)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof cp)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw gt()}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:AU(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:gt()}(t,e.precondition)),r}function bU(t,e){return t&&t.length>0?(ar(e!==void 0),t.map(r=>function(i,s){let a=i.updateTime?ya(i.updateTime):ya(s);return a.isEqual(yt.min())&&(a=ya(s)),new uU(a,i.transformResults||[])}(r,e))):[]}function IU(t,e){return{documents:[kC(t,e.path)]}}function NU(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=kC(t,i);const s=function(u){if(u.length!==0)return bC(Sa.create(u,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const a=function(u){if(u.length!==0)return u.map(f=>function(g){return{field:Rc(g.field),direction:PU(g.dir)}}(f))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=Ax(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:r,parent:i}}function RU(t){let e=kU(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){ar(n===1);const f=r.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];r.where&&(s=function(p){const g=FC(p);return g instanceof Sa&&iC(g)?g.getFilters():[g]}(r.where));let a=[];r.orderBy&&(a=function(p){return p.map(g=>function(y){return new op(Dc(y.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(g))}(r.orderBy));let o=null;r.limit&&(o=function(p){let g;return g=typeof p=="object"?p.value:p,$p(g)?null:g}(r.limit));let l=null;r.startAt&&(l=function(p){const g=!!p.before,m=p.values||[];return new ap(m,g)}(r.startAt));let u=null;return r.endAt&&(u=function(p){const g=!p.before,m=p.values||[];return new ap(m,g)}(r.endAt)),q7(e,i,a,s,o,"F",l,u)}function DU(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return gt()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function FC(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Dc(r.unaryFilter.field);return vn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Dc(r.unaryFilter.field);return vn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Dc(r.unaryFilter.field);return vn.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Dc(r.unaryFilter.field);return vn.create(a,"!=",{nullValue:"NULL_VALUE"});default:return gt()}}(t):t.fieldFilter!==void 0?function(r){return vn.create(Dc(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return gt()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Sa.create(r.compositeFilter.filters.map(n=>FC(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return gt()}}(r.compositeFilter.op))}(t):gt()}function PU(t){return EU[t]}function OU(t){return wU[t]}function MU(t){return SU[t]}function Rc(t){return{fieldPath:t.canonicalString()}}function Dc(t){return Kn.fromServerFormat(t.fieldPath)}function bC(t){return t instanceof vn?function(r){if(r.op==="=="){if(xE(r.value))return{unaryFilter:{field:Rc(r.field),op:"IS_NAN"}};if(mE(r.value))return{unaryFilter:{field:Rc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(xE(r.value))return{unaryFilter:{field:Rc(r.field),op:"IS_NOT_NAN"}};if(mE(r.value))return{unaryFilter:{field:Rc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Rc(r.field),op:OU(r.op),value:r.value}}}(t):t instanceof Sa?function(r){const n=r.getFilters().map(i=>bC(i));return n.length===1?n[0]:{compositeFilter:{op:MU(r.op),filters:n}}}(t):gt()}function LU(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function IC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(e,r,n,i,s=yt.min(),a=yt.min(),o=Qn.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Lo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Lo(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Lo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Lo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BU{constructor(e){this.ct=e}}function jU(t){const e=RU({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Tx(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UU{constructor(){this.un=new VU}addToCollectionParentIndex(e,r){return this.un.add(r),Ne.resolve()}getCollectionParents(e,r){return Ne.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return Ne.resolve()}deleteFieldIndex(e,r){return Ne.resolve()}deleteAllFieldIndexes(e){return Ne.resolve()}createTargetIndexes(e,r){return Ne.resolve()}getDocumentsMatchingTarget(e,r){return Ne.resolve(null)}getIndexType(e,r){return Ne.resolve(0)}getFieldIndexes(e,r){return Ne.resolve([])}getNextCollectionGroupToUpdate(e){return Ne.resolve(null)}getMinOffset(e,r){return Ne.resolve(nl.min())}getMinOffsetFromCollectionGroup(e,r){return Ne.resolve(nl.min())}updateCollectionGroup(e,r,n){return Ne.resolve()}updateIndexEntries(e,r){return Ne.resolve()}}class VU{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new Xn(Vr.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Xn(Vr.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Su{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Su(0)}static kn(){return new Su(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zU{constructor(){this.changes=new Lu(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,ci.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Ne.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WU{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HU{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Bd(n.mutation,i,qs.empty(),_n.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Ot()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Ot()){const i=Rl();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(s=>{let a=gd();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=Rl();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Ot()))}populateOverlays(e,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,i){let s=no();const a=Ld(),o=function(){return Ld()}();return r.forEach((l,u)=>{const f=n.get(u.key);i.has(u.key)&&(f===void 0||f.mutation instanceof dc)?s=s.insert(u.key,u):f!==void 0?(a.set(u.key,f.mutation.getFieldMask()),Bd(f.mutation,u,f.mutation.getFieldMask(),_n.now())):a.set(u.key,qs.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,f)=>a.set(u,f)),r.forEach((u,f)=>{var p;return o.set(u,new WU(f,(p=a.get(u))!==null&&p!==void 0?p:null))}),o))}recalculateAndSaveOverlays(e,r){const n=Ld();let i=new Lr((a,o)=>a-o),s=Ot();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const u=r.get(l);if(u===null)return;let f=n.get(l)||qs.empty();f=o.applyToLocalView(u,f),n.set(l,f);const p=(i.get(o.batchId)||Ot()).add(l);i=i.insert(o.batchId,p)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),u=l.key,f=l.value,p=fC();f.forEach(g=>{if(!s.has(g)){const m=vC(r.get(g),n.get(g));m!==null&&p.set(g,m),s=s.add(g)}}),a.push(this.documentOverlayCache.saveOverlays(e,u,p))}return Ne.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return at.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):Q7(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-s.size):Ne.resolve(Rl());let o=-1,l=s;return a.next(u=>Ne.forEach(u,(f,p)=>(o<p.largestBatchId&&(o=p.largestBatchId),s.get(f)?Ne.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{l=l.insert(f,g)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,Ot())).next(f=>({batchId:o,changes:dC(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new at(r)).next(n=>{let i=gd();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const s=r.collectionGroup;let a=gd();return this.indexManager.getCollectionParents(e,s).next(o=>Ne.forEach(o,l=>{const u=function(p,g){return new Gp(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(r,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,n,i).next(f=>{f.forEach((p,g)=>{a=a.insert(p,g)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,i))).next(a=>{s.forEach((l,u)=>{const f=u.getKey();a.get(f)===null&&(a=a.insert(f,ci.newInvalidDocument(f)))});let o=gd();return a.forEach((l,u)=>{const f=s.get(l);f!==void 0&&Bd(f.mutation,u,qs.empty(),_n.now()),Xp(r,u)&&(o=o.insert(l,u))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $U{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return Ne.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:ya(i.createTime)}}(r)),Ne.resolve()}getNamedQuery(e,r){return Ne.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(i){return{name:i.name,query:jU(i.bundledQuery),readTime:ya(i.readTime)}}(r)),Ne.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GU{constructor(){this.overlays=new Lr(at.comparator),this.Ir=new Map}getOverlay(e,r){return Ne.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Rl();return Ne.forEach(r,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,s)=>{this.ht(e,r,s)}),Ne.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.Ir.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),Ne.resolve()}getOverlaysForCollection(e,r,n){const i=Rl(),s=r.length+1,a=new at(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,u=l.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>n&&i.set(l.getKey(),l)}return Ne.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let s=new Lr((u,f)=>u-f);const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let f=s.get(u.largestBatchId);f===null&&(f=Rl(),s=s.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const o=Rl(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,f)=>o.set(u,f)),!(o.size()>=i)););return Ne.resolve(o)}ht(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new gU(r,n));let s=this.Ir.get(r);s===void 0&&(s=Ot(),this.Ir.set(r,s)),this.Ir.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KU{constructor(){this.sessionToken=Qn.EMPTY_BYTE_STRING}getSessionToken(e){return Ne.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Ne.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv{constructor(){this.Tr=new Xn(Rn.Er),this.dr=new Xn(Rn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new Rn(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new Rn(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new at(new Vr([])),n=new Rn(r,e),i=new Rn(r,e+1),s=[];return this.dr.forEachInRange([n,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new at(new Vr([])),n=new Rn(r,e),i=new Rn(r,e+1);let s=Ot();return this.dr.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const r=new Rn(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Rn{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return at.comparator(e.key,r.key)||Jt(e.wr,r.wr)}static Ar(e,r){return Jt(e.wr,r.wr)||at.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YU{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new Xn(Rn.Er)}checkEmpty(e){return Ne.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new pU(s,r,n,i);this.mutationQueue.push(a);for(const o of i)this.br=this.br.add(new Rn(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Ne.resolve(a)}lookupMutationBatch(e,r){return Ne.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.vr(n),s=i<0?0:i;return Ne.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Ne.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Ne.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Rn(r,0),i=new Rn(r,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,i],a=>{const o=this.Dr(a.wr);s.push(o)}),Ne.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Xn(Jt);return r.forEach(i=>{const s=new Rn(i,0),a=new Rn(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],o=>{n=n.add(o.wr)})}),Ne.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let s=n;at.isDocumentKey(s)||(s=s.child(""));const a=new Rn(new at(s),0);let o=new Xn(Jt);return this.br.forEachWhile(l=>{const u=l.key.path;return!!n.isPrefixOf(u)&&(u.length===i&&(o=o.add(l.wr)),!0)},a),Ne.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const i=this.Dr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){ar(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return Ne.forEach(r.mutations,i=>{const s=new Rn(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new Rn(r,0),i=this.br.firstAfterOrEqual(n);return Ne.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ne.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XU{constructor(e){this.Mr=e,this.docs=function(){return new Lr(at.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Ne.resolve(n?n.document.mutableCopy():ci.newInvalidDocument(r))}getEntries(e,r){let n=no();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():ci.newInvalidDocument(i))}),Ne.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let s=no();const a=r.path,o=new at(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:u,value:{document:f}}=l.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||N7(I7(f),n)<=0||(i.has(f.key)||Xp(r,f))&&(s=s.insert(f.key,f.mutableCopy()))}return Ne.resolve(s)}getAllFromCollectionGroup(e,r,n,i){gt()}Or(e,r){return Ne.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new qU(this)}getSize(e){return Ne.resolve(this.size)}}class qU extends zU{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)}),Ne.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QU{constructor(e){this.persistence=e,this.Nr=new Lu(r=>kv(r),Cv),this.lastRemoteSnapshotVersion=yt.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Rv,this.targetCount=0,this.kr=Su.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,i)=>r(i)),Ne.resolve()}getLastRemoteSnapshotVersion(e){return Ne.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ne.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Ne.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),Ne.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new Su(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,Ne.resolve()}updateTargetData(e,r){return this.Kn(r),Ne.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,Ne.resolve()}removeTargets(e,r,n){let i=0;const s=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),Ne.waitFor(s).next(()=>i)}getTargetCount(e){return Ne.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return Ne.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),Ne.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),Ne.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),Ne.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return Ne.resolve(n)}containsKey(e,r){return Ne.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JU{constructor(e,r){this.qr={},this.overlays={},this.Qr=new wv(0),this.Kr=!1,this.Kr=!0,this.$r=new KU,this.referenceDelegate=e(this),this.Ur=new QU(this),this.indexManager=new UU,this.remoteDocumentCache=function(i){return new XU(i)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new BU(r),this.Gr=new $U(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new GU,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new YU(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){Ze("MemoryPersistence","Starting transaction:",e);const i=new ZU(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,r){return Ne.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class ZU extends D7{constructor(e){super(),this.currentSequenceNumber=e}}class Dv{constructor(e){this.persistence=e,this.Jr=new Rv,this.Yr=null}static Zr(e){return new Dv(e)}get Xr(){if(this.Yr)return this.Yr;throw gt()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),Ne.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),Ne.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),Ne.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(i=>this.Xr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ne.forEach(this.Xr,n=>{const i=at.fromPath(n);return this.ei(e,i).next(s=>{s||r.removeEntry(i,yt.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return Ne.or([()=>Ne.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pv{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=i}static Wi(e,r){let n=Ot(),i=Ot();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Pv(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eV{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tV{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return t9()?8:P7(pi())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,i){const s={result:null};return this.Yi(e,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new eV;return this.Xi(e,r,a).next(o=>{if(s.result=o,this.zi)return this.es(e,r,a,o.size)})}).next(()=>s.result)}es(e,r,n,i){return n.documentReadCount<this.ji?(ad()<=Wt.DEBUG&&Ze("QueryEngine","SDK will not create cache indexes for query:",Nc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Ne.resolve()):(ad()<=Wt.DEBUG&&Ze("QueryEngine","Query:",Nc(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(ad()<=Wt.DEBUG&&Ze("QueryEngine","The SDK decides to create cache indexes for query:",Nc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,va(r))):Ne.resolve())}Yi(e,r){if(EE(r))return Ne.resolve(null);let n=va(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=Tx(r,null,"F"),n=va(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=Ot(...s);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const u=this.ts(r,o);return this.ns(r,u,a,l.readTime)?this.Yi(e,Tx(r,null,"F")):this.rs(e,u,r,l)}))})))}Zi(e,r,n,i){return EE(r)||i.isEqual(yt.min())?Ne.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const a=this.ts(r,s);return this.ns(r,a,n,i)?Ne.resolve(null):(ad()<=Wt.DEBUG&&Ze("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Nc(r)),this.rs(e,a,r,b7(i,-1)).next(o=>o))})}ts(e,r){let n=new Xn(cC(e));return r.forEach((i,s)=>{Xp(e,s)&&(n=n.add(s))}),n}ns(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,r,n){return ad()<=Wt.DEBUG&&Ze("QueryEngine","Using full collection scan to execute query:",Nc(r)),this.Ji.getDocumentsMatchingQuery(e,r,nl.min(),n)}rs(e,r,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rV{constructor(e,r,n,i){this.persistence=e,this.ss=r,this.serializer=i,this.os=new Lr(Jt),this._s=new Lu(s=>kv(s),Cv),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new HU(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function nV(t,e,r,n){return new rV(t,e,r,n)}async function NC(t,e){const r=_t(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let l=Ot();for(const u of i){a.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}for(const u of s){o.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}return r.localDocuments.getDocuments(n,l).next(u=>({hs:u,removedBatchIds:a,addedBatchIds:o}))})})}function iV(t,e){const r=_t(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,u,f){const p=u.batch,g=p.keys();let m=Ne.resolve();return g.forEach(y=>{m=m.next(()=>f.getEntry(l,y)).next(x=>{const w=u.docVersions.get(y);ar(w!==null),x.version.compareTo(w)<0&&(p.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),f.addEntry(x)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(l,p))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=Ot();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(l=l.add(o.batch.mutations[u].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function RC(t){const e=_t(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function sV(t,e){const r=_t(t),n=e.snapshotVersion;let i=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.cs.newChangeBuffer({trackRemovals:!0});i=r.os;const o=[];e.targetChanges.forEach((f,p)=>{const g=i.get(p);if(!g)return;o.push(r.Ur.removeMatchingKeys(s,f.removedDocuments,p).next(()=>r.Ur.addMatchingKeys(s,f.addedDocuments,p)));let m=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?m=m.withResumeToken(Qn.EMPTY_BYTE_STRING,yt.min()).withLastLimboFreeSnapshotVersion(yt.min()):f.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(f.resumeToken,n)),i=i.insert(p,m),function(x,w,A){return x.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0}(g,m,f)&&o.push(r.Ur.updateTargetData(s,m))});let l=no(),u=Ot();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,f))}),o.push(aV(s,a,e.documentUpdates).next(f=>{l=f.Ps,u=f.Is})),!n.isEqual(yt.min())){const f=r.Ur.getLastRemoteSnapshotVersion(s).next(p=>r.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(f)}return Ne.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(r.os=i,s))}function aV(t,e,r){let n=Ot(),i=Ot();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let a=no();return r.forEach((o,l)=>{const u=s.get(o);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(yt.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):Ze("LocalStore","Ignoring outdated watch update for ",o,". Current version:",u.version," Watch version:",l.version)}),{Ps:a,Is:i}})}function oV(t,e){const r=_t(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function lV(t,e){const r=_t(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Ur.getTargetData(n,e).next(s=>s?(i=s,Ne.resolve(i)):r.Ur.allocateTargetId(n).next(a=>(i=new Lo(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.os.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function bx(t,e,r){const n=_t(t),i=n.os.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!Hf(a))throw a;Ze("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(i.target)}function RE(t,e,r){const n=_t(t);let i=yt.min(),s=Ot();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,u,f){const p=_t(l),g=p._s.get(f);return g!==void 0?Ne.resolve(p.os.get(g)):p.Ur.getTargetData(u,f)}(n,a,va(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,r?i:yt.min(),r?s:Ot())).next(o=>(cV(n,Z7(e),o),{documents:o,Ts:s})))}function cV(t,e,r){let n=t.us.get(e)||yt.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.us.set(e,n)}class DE{constructor(){this.activeTargetIds=sU()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class uV{constructor(){this.so=new DE,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new DE,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dV{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PE{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Ze("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Ze("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let G0=null;function im(){return G0===null?G0=function(){return 268435456+Math.round(2147483648*Math.random())}():G0++,"0x"+G0.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fV={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hV{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ni="WebChannelConnection";class pV extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(r,n,i,s,a){const o=im(),l=this.xo(r,n.toUriEncodedString());Ze("RestConnection",`Sending RPC '${r}' ${o}:`,l,i);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,s,a),this.No(r,l,u,i).then(f=>(Ze("RestConnection",`Received RPC '${r}' ${o}: `,f),f),f=>{throw yu("RestConnection",`RPC '${r}' ${o} failed with error: `,f,"url: ",l,"request:",i),f})}Lo(r,n,i,s,a,o){return this.Mo(r,n,i,s,a)}Oo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ou}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>r[a]=s),i&&i.headers.forEach((s,a)=>r[a]=s)}xo(r,n){const i=fV[r];return`${this.Do}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,i){const s=im();return new Promise((a,o)=>{const l=new Gk;l.setWithCredentials(!0),l.listenOnce(Kk.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case uh.NO_ERROR:const f=l.getResponseJson();Ze(ni,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),a(f);break;case uh.TIMEOUT:Ze(ni,`RPC '${e}' ${s} timed out`),o(new it(Oe.DEADLINE_EXCEEDED,"Request time out"));break;case uh.HTTP_ERROR:const p=l.getStatus();if(Ze(ni,`RPC '${e}' ${s} failed with status:`,p,"response text:",l.getResponseText()),p>0){let g=l.getResponseJson();Array.isArray(g)&&(g=g[0]);const m=g==null?void 0:g.error;if(m&&m.status&&m.message){const y=function(w){const A=w.toLowerCase().replace(/_/g,"-");return Object.values(Oe).indexOf(A)>=0?A:Oe.UNKNOWN}(m.status);o(new it(y,m.message))}else o(new it(Oe.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new it(Oe.UNAVAILABLE,"Connection failed."));break;default:gt()}}finally{Ze(ni,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);Ze(ni,`RPC '${e}' ${s} sending request:`,i),l.send(r,"POST",u,n,15)})}Bo(e,r,n){const i=im(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=qk(),o=Xk(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const f=s.join("");Ze(ni,`Creating RPC '${e}' stream ${i}: ${f}`,l);const p=a.createWebChannel(f,l);let g=!1,m=!1;const y=new hV({Io:w=>{m?Ze(ni,`Not sending because RPC '${e}' stream ${i} is closed:`,w):(g||(Ze(ni,`Opening RPC '${e}' stream ${i} transport.`),p.open(),g=!0),Ze(ni,`RPC '${e}' stream ${i} sending:`,w),p.send(w))},To:()=>p.close()}),x=(w,A,k)=>{w.listen(A,E=>{try{k(E)}catch(P){setTimeout(()=>{throw P},0)}})};return x(p,pd.EventType.OPEN,()=>{m||(Ze(ni,`RPC '${e}' stream ${i} transport opened.`),y.yo())}),x(p,pd.EventType.CLOSE,()=>{m||(m=!0,Ze(ni,`RPC '${e}' stream ${i} transport closed`),y.So())}),x(p,pd.EventType.ERROR,w=>{m||(m=!0,yu(ni,`RPC '${e}' stream ${i} transport errored:`,w),y.So(new it(Oe.UNAVAILABLE,"The operation could not be completed")))}),x(p,pd.EventType.MESSAGE,w=>{var A;if(!m){const k=w.data[0];ar(!!k);const E=k,P=E.error||((A=E[0])===null||A===void 0?void 0:A.error);if(P){Ze(ni,`RPC '${e}' stream ${i} received error:`,P);const Y=P.status;let V=function(S){const I=en[S];if(I!==void 0)return EC(I)}(Y),T=P.message;V===void 0&&(V=Oe.INTERNAL,T="Unknown error status: "+Y+" with message "+P.message),m=!0,y.So(new it(V,T)),p.close()}else Ze(ni,`RPC '${e}' stream ${i} received:`,k),y.bo(k)}}),x(o,Yk.STAT_EVENT,w=>{w.stat===yx.PROXY?Ze(ni,`RPC '${e}' stream ${i} detected buffering proxy`):w.stat===yx.NOPROXY&&Ze(ni,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{y.wo()},0),y}}function sm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zp(t){return new TU(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(e,r,n=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,r-n);i>0&&Ze("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{constructor(e,r,n,i,s,a,o,l){this.ui=e,this.Ho=n,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new DC(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===Oe.RESOURCE_EXHAUSTED?(ro(r.toString()),ro("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===Oe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Yo===r&&this.P_(n,i)},n=>{e(()=>{const i=new it(Oe.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(i)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{n(()=>this.I_(i))}),this.stream.onMessage(i=>{n(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Ze("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(Ze("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class gV extends PC{constructor(e,r,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=CU(this.serializer,e),n=function(s){if(!("targetChange"in s))return yt.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?yt.min():a.readTime?ya(a.readTime):yt.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=Fx(this.serializer),r.addTarget=function(s,a){let o;const l=a.target;if(o=Sx(l)?{documents:IU(s,l)}:{query:NU(s,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=TC(s,a.resumeToken);const u=Ax(s,a.expectedCount);u!==null&&(o.expectedCount=u)}else if(a.snapshotVersion.compareTo(yt.min())>0){o.readTime=up(s,a.snapshotVersion.toTimestamp());const u=Ax(s,a.expectedCount);u!==null&&(o.expectedCount=u)}return o}(this.serializer,e);const n=DU(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=Fx(this.serializer),r.removeTarget=e,this.a_(r)}}class mV extends PC{constructor(e,r,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return ar(!!e.streamToken),this.lastStreamToken=e.streamToken,ar(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ar(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=bU(e.writeResults,e.commitTime),n=ya(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=Fx(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>FU(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xV extends class{}{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new it(Oe.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,kx(r,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new it(Oe.UNKNOWN,s.toString())})}Lo(e,r,n,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,kx(r,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new it(Oe.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class vV{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ro(r),this.D_=!1):Ze("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yV{constructor(e,r,n,i,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{n.enqueueAndForget(async()=>{fc(this)&&(Ze("RemoteStore","Restarting streams for network reachability change."),await async function(l){const u=_t(l);u.L_.add(4),await Kf(u),u.q_.set("Unknown"),u.L_.delete(4),await eg(u)}(this))})}),this.q_=new vV(n,i)}}async function eg(t){if(fc(t))for(const e of t.B_)await e(!0)}async function Kf(t){for(const e of t.B_)await e(!1)}function OC(t,e){const r=_t(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),Bv(r)?Lv(r):Bu(r).r_()&&Mv(r,e))}function Ov(t,e){const r=_t(t),n=Bu(r);r.N_.delete(e),n.r_()&&MC(r,e),r.N_.size===0&&(n.r_()?n.o_():fc(r)&&r.q_.set("Unknown"))}function Mv(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(yt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Bu(t).A_(e)}function MC(t,e){t.Q_.xe(e),Bu(t).R_(e)}function Lv(t){t.Q_=new _U({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Bu(t).start(),t.q_.v_()}function Bv(t){return fc(t)&&!Bu(t).n_()&&t.N_.size>0}function fc(t){return _t(t).L_.size===0}function LC(t){t.Q_=void 0}async function _V(t){t.q_.set("Online")}async function EV(t){t.N_.forEach((e,r)=>{Mv(t,e)})}async function wV(t,e){LC(t),Bv(t)?(t.q_.M_(e),Lv(t)):t.q_.set("Unknown")}async function SV(t,e,r){if(t.q_.set("Online"),e instanceof SC&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.N_.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.N_.delete(o),i.Q_.removeTarget(o))}(t,e)}catch(n){Ze("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await dp(t,n)}else if(e instanceof hh?t.Q_.Ke(e):e instanceof wC?t.Q_.He(e):t.Q_.We(e),!r.isEqual(yt.min()))try{const n=await RC(t.localStore);r.compareTo(n)>=0&&await function(s,a){const o=s.Q_.rt(a);return o.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const f=s.N_.get(u);f&&s.N_.set(u,f.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,u)=>{const f=s.N_.get(l);if(!f)return;s.N_.set(l,f.withResumeToken(Qn.EMPTY_BYTE_STRING,f.snapshotVersion)),MC(s,l);const p=new Lo(f.target,l,u,f.sequenceNumber);Mv(s,p)}),s.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Ze("RemoteStore","Failed to raise snapshot:",n),await dp(t,n)}}async function dp(t,e,r){if(!Hf(e))throw e;t.L_.add(1),await Kf(t),t.q_.set("Offline"),r||(r=()=>RC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ze("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await eg(t)})}function BC(t,e){return e().catch(r=>dp(t,r,e))}async function tg(t){const e=_t(t),r=sl(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;TV(e);)try{const i=await oV(e.localStore,n);if(i===null){e.O_.length===0&&r.o_();break}n=i.batchId,AV(e,i)}catch(i){await dp(e,i)}jC(e)&&UC(e)}function TV(t){return fc(t)&&t.O_.length<10}function AV(t,e){t.O_.push(e);const r=sl(t);r.r_()&&r.V_&&r.m_(e.mutations)}function jC(t){return fc(t)&&!sl(t).n_()&&t.O_.length>0}function UC(t){sl(t).start()}async function kV(t){sl(t).p_()}async function CV(t){const e=sl(t);for(const r of t.O_)e.m_(r.mutations)}async function FV(t,e,r){const n=t.O_.shift(),i=bv.from(n,e,r);await BC(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await tg(t)}async function bV(t,e){e&&sl(t).V_&&await async function(n,i){if(function(a){return xU(a)&&a!==Oe.ABORTED}(i.code)){const s=n.O_.shift();sl(n).s_(),await BC(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await tg(n)}}(t,e),jC(t)&&UC(t)}async function OE(t,e){const r=_t(t);r.asyncQueue.verifyOperationInProgress(),Ze("RemoteStore","RemoteStore received new credentials");const n=fc(r);r.L_.add(3),await Kf(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await eg(r)}async function IV(t,e){const r=_t(t);e?(r.L_.delete(2),await eg(r)):e||(r.L_.add(2),await Kf(r),r.q_.set("Unknown"))}function Bu(t){return t.K_||(t.K_=function(r,n,i){const s=_t(r);return s.w_(),new gV(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:_V.bind(null,t),Ro:EV.bind(null,t),mo:wV.bind(null,t),d_:SV.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Bv(t)?Lv(t):t.q_.set("Unknown")):(await t.K_.stop(),LC(t))})),t.K_}function sl(t){return t.U_||(t.U_=function(r,n,i){const s=_t(r);return s.w_(),new mV(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:kV.bind(null,t),mo:bV.bind(null,t),f_:CV.bind(null,t),g_:FV.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await tg(t)):(await t.U_.stop(),t.O_.length>0&&(Ze("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jv{constructor(e,r,n,i,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Xo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,s){const a=Date.now()+n,o=new jv(e,r,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new it(Oe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Uv(t,e){if(ro("AsyncQueue",`${e}: ${t}`),Hf(t))return new it(Oe.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(e){this.comparator=e?(r,n)=>e(r,n)||at.comparator(r.key,n.key):(r,n)=>at.comparator(r.key,n.key),this.keyedMap=gd(),this.sortedSet=new Lr(this.comparator)}static emptySet(e){return new iu(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof iu)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new iu;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ME{constructor(){this.W_=new Lr(at.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):gt():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class Tu{constructor(e,r,n,i,s,a,o,l,u){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,r,n,i,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new Tu(e,r,iu.emptySet(r),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Yp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NV{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class RV{constructor(){this.queries=LE(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const i=_t(r),s=i.queries;i.queries=LE(),s.forEach((a,o)=>{for(const l of o.j_)l.onError(n)})})(this,new it(Oe.ABORTED,"Firestore shutting down"))}}function LE(){return new Lu(t=>lC(t),Yp)}async function VC(t,e){const r=_t(t);let n=3;const i=e.query;let s=r.queries.get(i);s?!s.H_()&&e.J_()&&(n=2):(s=new NV,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(i,!0);break;case 1:s.z_=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const o=Uv(a,`Initialization of query '${Nc(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,s),s.j_.push(e),e.Z_(r.onlineState),s.z_&&e.X_(s.z_)&&Vv(r)}async function zC(t,e){const r=_t(t),n=e.query;let i=3;const s=r.queries.get(n);if(s){const a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function DV(t,e){const r=_t(t);let n=!1;for(const i of e){const s=i.query,a=r.queries.get(s);if(a){for(const o of a.j_)o.X_(i)&&(n=!0);a.z_=i}}n&&Vv(r)}function PV(t,e,r){const n=_t(t),i=n.queries.get(e);if(i)for(const s of i.j_)s.onError(r);n.queries.delete(e)}function Vv(t){t.Y_.forEach(e=>{e.next()})}var Ix,BE;(BE=Ix||(Ix={})).ea="default",BE.Cache="cache";class WC{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new Tu(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=Tu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Ix.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{constructor(e){this.key=e}}class $C{constructor(e){this.key=e}}class OV{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ot(),this.mutatedKeys=Ot(),this.Aa=cC(e),this.Ra=new iu(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new ME,i=r?r.Ra:this.Ra;let s=r?r.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,p)=>{const g=i.get(f),m=Xp(this.query,p)?p:null,y=!!g&&this.mutatedKeys.has(g.key),x=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let w=!1;g&&m?g.data.isEqual(m.data)?y!==x&&(n.track({type:3,doc:m}),w=!0):this.ga(g,m)||(n.track({type:2,doc:m}),w=!0,(l&&this.Aa(m,l)>0||u&&this.Aa(m,u)<0)&&(o=!0)):!g&&m?(n.track({type:0,doc:m}),w=!0):g&&!m&&(n.track({type:1,doc:g}),w=!0,(l||u)&&(o=!0)),w&&(m?(a=a.add(m),s=x?s.add(f):s.delete(f)):(a=a.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),s=s.delete(f.key),n.track({type:1,doc:f})}return{Ra:a,fa:n,ns:o,mutatedKeys:s}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((f,p)=>function(m,y){const x=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return gt()}};return x(m)-x(y)}(f.type,p.type)||this.Aa(f.doc,p.doc)),this.pa(n),i=i!=null&&i;const o=r&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,u=l!==this.Ea;return this.Ea=l,a.length!==0||u?{snapshot:new Tu(this.query,e.Ra,s,a,e.mutatedKeys,l===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new ME,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ot(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new $C(n))}),this.da.forEach(n=>{e.has(n)||r.push(new HC(n))}),r}ba(e){this.Ta=e.Ts,this.da=Ot();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return Tu.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class MV{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class LV{constructor(e){this.key=e,this.va=!1}}class BV{constructor(e,r,n,i,s,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Lu(o=>lC(o),Yp),this.Ma=new Map,this.xa=new Set,this.Oa=new Lr(at.comparator),this.Na=new Map,this.La=new Rv,this.Ba={},this.ka=new Map,this.qa=Su.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function jV(t,e,r=!0){const n=QC(t);let i;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await GC(n,e,r,!0),i}async function UV(t,e){const r=QC(t);await GC(r,e,!0,!1)}async function GC(t,e,r,n){const i=await lV(t.localStore,va(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,r);let o;return n&&(o=await VV(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&OC(t.remoteStore,i),o}async function VV(t,e,r,n,i){t.Ka=(p,g,m)=>async function(x,w,A,k){let E=w.view.ma(A);E.ns&&(E=await RE(x.localStore,w.query,!1).then(({documents:T})=>w.view.ma(T,E)));const P=k&&k.targetChanges.get(w.targetId),Y=k&&k.targetMismatches.get(w.targetId)!=null,V=w.view.applyChanges(E,x.isPrimaryClient,P,Y);return UE(x,w.targetId,V.wa),V.snapshot}(t,p,g,m);const s=await RE(t.localStore,e,!0),a=new OV(e,s.Ts),o=a.ma(s.documents),l=Gf.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),u=a.applyChanges(o,t.isPrimaryClient,l);UE(t,r,u.wa);const f=new MV(e,r,a);return t.Fa.set(e,f),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),u.snapshot}async function zV(t,e,r){const n=_t(t),i=n.Fa.get(e),s=n.Ma.get(i.targetId);if(s.length>1)return n.Ma.set(i.targetId,s.filter(a=>!Yp(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await bx(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Ov(n.remoteStore,i.targetId),Nx(n,i.targetId)}).catch(Wf)):(Nx(n,i.targetId),await bx(n.localStore,i.targetId,!0))}async function WV(t,e){const r=_t(t),n=r.Fa.get(e),i=r.Ma.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Ov(r.remoteStore,n.targetId))}async function HV(t,e,r){const n=QV(t);try{const i=await function(a,o){const l=_t(a),u=_n.now(),f=o.reduce((m,y)=>m.add(y.key),Ot());let p,g;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let y=no(),x=Ot();return l.cs.getEntries(m,f).next(w=>{y=w,y.forEach((A,k)=>{k.isValidDocument()||(x=x.add(A))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,y)).next(w=>{p=w;const A=[];for(const k of o){const E=fU(k,p.get(k.key).overlayedDocument);E!=null&&A.push(new dc(k.key,E,tC(E.value.mapValue),Xa.exists(!0)))}return l.mutationQueue.addMutationBatch(m,u,A,o)}).next(w=>{g=w;const A=w.applyToLocalDocumentSet(p,x);return l.documentOverlayCache.saveOverlays(m,w.batchId,A)})}).then(()=>({batchId:g.batchId,changes:dC(p)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,l){let u=a.Ba[a.currentUser.toKey()];u||(u=new Lr(Jt)),u=u.insert(o,l),a.Ba[a.currentUser.toKey()]=u}(n,i.batchId,r),await Yf(n,i.changes),await tg(n.remoteStore)}catch(i){const s=Uv(i,"Failed to persist write");r.reject(s)}}async function KC(t,e){const r=_t(t);try{const n=await sV(r.localStore,e);e.targetChanges.forEach((i,s)=>{const a=r.Na.get(s);a&&(ar(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?ar(a.va):i.removedDocuments.size>0&&(ar(a.va),a.va=!1))}),await Yf(r,n,e)}catch(n){await Wf(n)}}function jE(t,e,r){const n=_t(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Fa.forEach((s,a)=>{const o=a.view.Z_(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const l=_t(a);l.onlineState=o;let u=!1;l.queries.forEach((f,p)=>{for(const g of p.j_)g.Z_(o)&&(u=!0)}),u&&Vv(l)}(n.eventManager,e),i.length&&n.Ca.d_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function $V(t,e,r){const n=_t(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Na.get(e),s=i&&i.key;if(s){let a=new Lr(at.comparator);a=a.insert(s,ci.newNoDocument(s,yt.min()));const o=Ot().add(s),l=new Jp(yt.min(),new Map,new Lr(Jt),a,o);await KC(n,l),n.Oa=n.Oa.remove(s),n.Na.delete(e),zv(n)}else await bx(n.localStore,e,!1).then(()=>Nx(n,e,r)).catch(Wf)}async function GV(t,e){const r=_t(t),n=e.batch.batchId;try{const i=await iV(r.localStore,e);XC(r,n,null),YC(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Yf(r,i)}catch(i){await Wf(i)}}async function KV(t,e,r){const n=_t(t);try{const i=await function(a,o){const l=_t(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return l.mutationQueue.lookupMutationBatch(u,o).next(p=>(ar(p!==null),f=p.keys(),l.mutationQueue.removeMutationBatch(u,p))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,f,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>l.localDocuments.getDocuments(u,f))})}(n.localStore,e);XC(n,e,r),YC(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Yf(n,i)}catch(i){await Wf(i)}}function YC(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function XC(t,e,r){const n=_t(t);let i=n.Ba[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(r?s.reject(r):s.resolve(),i=i.remove(e)),n.Ba[n.currentUser.toKey()]=i}}function Nx(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||qC(t,n)})}function qC(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(Ov(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),zv(t))}function UE(t,e,r){for(const n of r)n instanceof HC?(t.La.addReference(n.key,e),YV(t,n)):n instanceof $C?(Ze("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||qC(t,n.key)):gt()}function YV(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(Ze("SyncEngine","New document in limbo: "+r),t.xa.add(n),zv(t))}function zv(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new at(Vr.fromString(e)),n=t.qa.next();t.Na.set(n,new LV(r)),t.Oa=t.Oa.insert(r,n),OC(t.remoteStore,new Lo(va(Kp(r.path)),n,"TargetPurposeLimboResolution",wv.oe))}}async function Yf(t,e,r){const n=_t(t),i=[],s=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{a.push(n.Ka(l,e,r).then(u=>{var f;if((u||r)&&n.isPrimaryClient){const p=u?!u.fromCache:(f=r==null?void 0:r.targetChanges.get(l.targetId))===null||f===void 0?void 0:f.current;n.sharedClientState.updateQueryState(l.targetId,p?"current":"not-current")}if(u){i.push(u);const p=Pv.Wi(l.targetId,u);s.push(p)}}))}),await Promise.all(a),n.Ca.d_(i),await async function(l,u){const f=_t(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>Ne.forEach(u,g=>Ne.forEach(g.$i,m=>f.persistence.referenceDelegate.addReference(p,g.targetId,m)).next(()=>Ne.forEach(g.Ui,m=>f.persistence.referenceDelegate.removeReference(p,g.targetId,m)))))}catch(p){if(!Hf(p))throw p;Ze("LocalStore","Failed to update sequence numbers: "+p)}for(const p of u){const g=p.targetId;if(!p.fromCache){const m=f.os.get(g),y=m.snapshotVersion,x=m.withLastLimboFreeSnapshotVersion(y);f.os=f.os.insert(g,x)}}}(n.localStore,s))}async function XV(t,e){const r=_t(t);if(!r.currentUser.isEqual(e)){Ze("SyncEngine","User change. New user:",e.toKey());const n=await NC(r.localStore,e);r.currentUser=e,function(s,a){s.ka.forEach(o=>{o.forEach(l=>{l.reject(new it(Oe.CANCELLED,a))})}),s.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Yf(r,n.hs)}}function qV(t,e){const r=_t(t),n=r.Na.get(e);if(n&&n.va)return Ot().add(n.key);{let i=Ot();const s=r.Ma.get(e);if(!s)return i;for(const a of s){const o=r.Fa.get(a);i=i.unionWith(o.view.Va)}return i}}function QC(t){const e=_t(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=KC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=qV.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=$V.bind(null,e),e.Ca.d_=DV.bind(null,e.eventManager),e.Ca.$a=PV.bind(null,e.eventManager),e}function QV(t){const e=_t(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=GV.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=KV.bind(null,e),e}class fp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Zp(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return nV(this.persistence,new tV,e.initialUser,this.serializer)}Ga(e){return new JU(Dv.Zr,this.serializer)}Wa(e){return new uV}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}fp.provider={build:()=>new fp};class Rx{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>jE(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=XV.bind(null,this.syncEngine),await IV(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new RV}()}createDatastore(e){const r=Zp(e.databaseInfo.databaseId),n=function(s){return new pV(s)}(e.databaseInfo);return function(s,a,o,l){return new xV(s,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,s,a,o){return new yV(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>jE(this.syncEngine,r,0),function(){return PE.D()?new PE:new dV}())}createSyncEngine(e,r){return function(i,s,a,o,l,u,f){const p=new BV(i,s,a,o,l,u);return f&&(p.Qa=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const s=_t(i);Ze("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Kf(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Rx.provider={build:()=>new Rx};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JC{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):ro("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JV{constructor(e,r,n,i,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=si.UNAUTHENTICATED,this.clientId=Jk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{Ze("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(Ze("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Xo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Uv(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function am(t,e){t.asyncQueue.verifyOperationInProgress(),Ze("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await NC(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function VE(t,e){t.asyncQueue.verifyOperationInProgress();const r=await ZV(t);Ze("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>OE(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>OE(e.remoteStore,i)),t._onlineComponents=e}async function ZV(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ze("FirestoreClient","Using user provided OfflineComponentProvider");try{await am(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===Oe.FAILED_PRECONDITION||i.code===Oe.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;yu("Error using user provided cache. Falling back to memory cache: "+r),await am(t,new fp)}}else Ze("FirestoreClient","Using default OfflineComponentProvider"),await am(t,new fp);return t._offlineComponents}async function ZC(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ze("FirestoreClient","Using user provided OnlineComponentProvider"),await VE(t,t._uninitializedComponentsProvider._online)):(Ze("FirestoreClient","Using default OnlineComponentProvider"),await VE(t,new Rx))),t._onlineComponents}function ez(t){return ZC(t).then(e=>e.syncEngine)}async function Dx(t){const e=await ZC(t),r=e.eventManager;return r.onListen=jV.bind(null,e.syncEngine),r.onUnlisten=zV.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=UV.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=WV.bind(null,e.syncEngine),r}function tz(t,e,r={}){const n=new Xo;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,u){const f=new JC({next:g=>{f.Za(),a.enqueueAndForget(()=>zC(s,p));const m=g.docs.has(o);!m&&g.fromCache?u.reject(new it(Oe.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&g.fromCache&&l&&l.source==="server"?u.reject(new it(Oe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),p=new WC(Kp(o.path),f,{includeMetadataChanges:!0,_a:!0});return VC(s,p)}(await Dx(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eF(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zE=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rz(t,e,r){if(!r)throw new it(Oe.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function nz(t,e,r,n){if(e===!0&&n===!0)throw new it(Oe.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function WE(t){if(!at.isDocumentKey(t))throw new it(Oe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Wv(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":gt()}function qo(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new it(Oe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Wv(t);throw new it(Oe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HE{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new it(Oe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new it(Oe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}nz("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=eF((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new it(Oe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new it(Oe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new it(Oe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Hv{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new HE({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new it(Oe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new it(Oe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new HE(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new _7;switch(n.type){case"firstParty":return new T7(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new it(Oe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=zE.get(r);n&&(Ze("ComponentProvider","Removing Datastore"),zE.delete(r),n.terminate())}(this),Promise.resolve()}}function iz(t,e,r,n={}){var i;const s=(t=qo(t,Hv))._getSettings(),a=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&yu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=si.MOCK_USER;else{o=Yj(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const u=n.mockUserToken.sub||n.mockUserToken.user_id;if(!u)throw new it(Oe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new si(u)}t._authCredentials=new E7(new Qk(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new rg(this.firestore,e,this._query)}}class ns{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Af(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ns(this.firestore,e,this._key)}}class Af extends rg{constructor(e,r,n){super(e,r,Kp(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ns(this.firestore,null,new at(e))}withConverter(e){return new Af(this.firestore,e,this._path)}}function $v(t,e,...r){if(t=ra(t),arguments.length===1&&(e=Jk.newId()),rz("doc","path",e),t instanceof Hv){const n=Vr.fromString(e,...r);return WE(n),new ns(t,null,new at(n))}{if(!(t instanceof ns||t instanceof Af))throw new it(Oe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Vr.fromString(e,...r));return WE(n),new ns(t.firestore,t instanceof Af?t.converter:null,new at(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $E{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new DC(this,"async_queue_retry"),this.Vu=()=>{const n=sm();n&&Ze("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=sm();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=sm();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new Xo;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Hf(e))throw e;Ze("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw ro("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const i=jv.createAndSchedule(this,e,r,n,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&gt()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function GE(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const i=r;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class kf extends Hv{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new $E,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new $E(e),this._firestoreClient=void 0,await e}}}function sz(t,e){const r=typeof t=="object"?t:zk(),n=typeof t=="string"?t:"(default)",i=_v(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=Gj("firestore");s&&iz(i,...s)}return i}function Gv(t){if(t._terminated)throw new it(Oe.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||az(t),t._firestoreClient}function az(t){var e,r,n;const i=t._freezeSettings(),s=function(o,l,u,f){return new L7(o,l,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,eF(f.experimentalLongPollingOptions),f.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new JV(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Au(Qn.fromBase64String(e))}catch(r){throw new it(Oe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Au(Qn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kv{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new it(Oe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Kn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tF{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yv{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new it(Oe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new it(Oe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Jt(this._lat,e._lat)||Jt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xv{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oz=/^__.*__$/;class lz{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new dc(e,this.data,this.fieldMask,r,this.fieldTransforms):new $f(e,this.data,r,this.fieldTransforms)}}function rF(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw gt()}}class qv{constructor(e,r,n,i,s,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new qv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return hp(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(rF(this.Cu)&&oz.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class cz{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Zp(e)}Qu(e,r,n,i=!1){return new qv({Cu:e,methodName:r,qu:n,path:Kn.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function uz(t){const e=t._freezeSettings(),r=Zp(t._databaseId);return new cz(t._databaseId,!!e.ignoreUndefinedProperties,r)}function dz(t,e,r,n,i,s={}){const a=t.Qu(s.merge||s.mergeFields?2:0,e,r,i);aF("Data must be an object, but it was:",a,n);const o=iF(n,a);let l,u;if(s.merge)l=new qs(a.fieldMask),u=a.fieldTransforms;else if(s.mergeFields){const f=[];for(const p of s.mergeFields){const g=fz(e,p,r);if(!a.contains(g))throw new it(Oe.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);pz(f,g)||f.push(g)}l=new qs(f),u=a.fieldTransforms.filter(p=>l.covers(p.field))}else l=null,u=a.fieldTransforms;return new lz(new Cs(o),l,u)}function nF(t,e){if(sF(t=ra(t)))return aF("Unsupported field value:",e,t),iF(t,e);if(t instanceof tF)return function(n,i){if(!rF(i.Cu))throw i.Bu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let l=nF(o,i.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(t,e)}return function(n,i){if((n=ra(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return aU(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=_n.fromDate(n);return{timestampValue:up(i.serializer,s)}}if(n instanceof _n){const s=new _n(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:up(i.serializer,s)}}if(n instanceof Yv)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Au)return{bytesValue:TC(i.serializer,n._byteString)};if(n instanceof ns){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Nv(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof Xv)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return Fv(o.serializer,l)})}}}}}}(n,i);throw i.Bu(`Unsupported field value: ${Wv(n)}`)}(t,e)}function iF(t,e){const r={};return Zk(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Mu(t,(n,i)=>{const s=nF(i,e.Mu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function sF(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof _n||t instanceof Yv||t instanceof Au||t instanceof ns||t instanceof tF||t instanceof Xv)}function aF(t,e,r){if(!sF(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=Wv(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function fz(t,e,r){if((e=ra(e))instanceof Kv)return e._internalPath;if(typeof e=="string")return oF(t,e);throw hp("Field path arguments must be of type string or ",t,!1,void 0,r)}const hz=new RegExp("[~\\*/\\[\\]]");function oF(t,e,r){if(e.search(hz)>=0)throw hp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Kv(...e.split("."))._internalPath}catch{throw hp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function hp(t,e,r,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${i}`),l+=")"),new it(Oe.INVALID_ARGUMENT,o+t+l)}function pz(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lF{constructor(e,r,n,i,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ns(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new gz(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(cF("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class gz extends lF{data(){return super.data()}}function cF(t,e){return typeof e=="string"?oF(t,e):e instanceof Kv?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mz(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new it(Oe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class xz{convertValue(e,r="none"){switch(tc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Gr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(ec(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw gt()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Mu(e,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,i;const s=(i=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(a=>Gr(a.doubleValue));return new Xv(s)}convertGeoPoint(e){return new Yv(Gr(e.latitude),Gr(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Tv(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(_f(e));default:return null}}convertTimestamp(e){const r=il(e);return new _n(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Vr.fromString(e);ar(IC(n));const i=new Ef(n.get(1),n.get(3)),s=new at(n.popFirst(5));return i.isEqual(r)||ro(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vz(t,e,r){let n;return n=t?t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class uF extends lF{constructor(e,r,n,i,s,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new ph(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(cF("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class ph extends uF{data(e={}){return super.data(e)}}class yz{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new xd(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new ph(this._firestore,this._userDataWriter,n.key,n,new xd(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new it(Oe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const l=new ph(i._firestore,i._userDataWriter,o.doc.key,o.doc,new xd(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new ph(i._firestore,i._userDataWriter,o.doc.key,o.doc,new xd(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,f=-1;return o.type!==0&&(u=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),f=a.indexOf(o.doc.key)),{type:_z(o.type),doc:l,oldIndex:u,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function _z(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return gt()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ez(t){t=qo(t,ns);const e=qo(t.firestore,kf);return tz(Gv(e),t._key).then(r=>fF(e,t,r))}class dF extends xz{constructor(e){super(),this.firestore=e}convertBytes(e){return new Au(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new ns(this.firestore,null,r)}}function wz(t,e,r){t=qo(t,ns);const n=qo(t.firestore,kf),i=vz(t.converter,e);return Tz(n,[dz(uz(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,Xa.none())])}function Sz(t,...e){var r,n,i;t=ra(t);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||GE(e[a])||(s=e[a],a++);const o={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(GE(e[a])){const p=e[a];e[a]=(r=p.next)===null||r===void 0?void 0:r.bind(p),e[a+1]=(n=p.error)===null||n===void 0?void 0:n.bind(p),e[a+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let l,u,f;if(t instanceof ns)u=qo(t.firestore,kf),f=Kp(t._key.path),l={next:p=>{e[a]&&e[a](fF(u,t,p))},error:e[a+1],complete:e[a+2]};else{const p=qo(t,rg);u=qo(p.firestore,kf),f=p._query;const g=new dF(u);l={next:m=>{e[a]&&e[a](new yz(u,g,p,m))},error:e[a+1],complete:e[a+2]},mz(t._query)}return function(g,m,y,x){const w=new JC(x),A=new WC(m,w,y);return g.asyncQueue.enqueueAndForget(async()=>VC(await Dx(g),A)),()=>{w.Za(),g.asyncQueue.enqueueAndForget(async()=>zC(await Dx(g),A))}}(Gv(u),f,o,l)}function Tz(t,e){return function(n,i){const s=new Xo;return n.asyncQueue.enqueueAndForget(async()=>HV(await ez(n),i,s)),s.promise}(Gv(t),e)}function fF(t,e,r){const n=r.docs.get(e._key),i=new dF(t);return new uF(t,i,e._key,n,new xd(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){Ou=i})(Pu),vu(new Jl("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new kf(new w7(n.getProvider("auth-internal")),new k7(n.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new it(Oe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ef(u.options.projectId,f)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),Yo(dE,"4.7.3",e),Yo(dE,"4.7.3","esm2017")})();function Qv(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function hF(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Az=hF,pF=new Vf("auth","Firebase",hF());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pp=new vv("@firebase/auth");function kz(t,...e){pp.logLevel<=Wt.WARN&&pp.warn(`Auth (${Pu}): ${t}`,...e)}function gh(t,...e){pp.logLevel<=Wt.ERROR&&pp.error(`Auth (${Pu}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function io(t,...e){throw Jv(t,...e)}function _a(t,...e){return Jv(t,...e)}function gF(t,e,r){const n=Object.assign(Object.assign({},Az()),{[e]:r});return new Vf("auth","Firebase",n).create(e,{appName:t.name})}function Ul(t){return gF(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Jv(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return pF.create(t,...e)}function pt(t,e,...r){if(!t)throw Jv(e,...r)}function za(t){const e="INTERNAL ASSERTION FAILED: "+t;throw gh(e),new Error(e)}function so(t,e){t||za(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Px(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Cz(){return KE()==="http:"||KE()==="https:"}function KE(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fz(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Cz()||Jj()||"connection"in navigator)?navigator.onLine:!0}function bz(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xf{constructor(e,r){this.shortDelay=e,this.longDelay=r,so(r>e,"Short delay should be less than long delay!"),this.isMobile=Xj()||Zj()}get(){return Fz()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zv(t,e){so(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mF{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;za("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;za("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;za("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iz={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nz=new Xf(3e4,6e4);function ey(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function ju(t,e,r,n,i={}){return xF(t,i,async()=>{let s={},a={};n&&(e==="GET"?a=n:s={body:JSON.stringify(n)});const o=zf(Object.assign({key:t.config.apiKey},a)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:l},s);return Qj()||(u.referrerPolicy="no-referrer"),mF.fetch()(vF(t,t.config.apiHost,r,o),u)})}async function xF(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},Iz),e);try{const i=new Dz(t),s=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw K0(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,u]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw K0(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw K0(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw K0(t,"user-disabled",a);const f=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw gF(t,f,u);io(t,f)}}catch(i){if(i instanceof uo)throw i;io(t,"network-request-failed",{message:String(i)})}}async function Rz(t,e,r,n,i={}){const s=await ju(t,e,r,n,i);return"mfaPendingCredential"in s&&io(t,"multi-factor-auth-required",{_serverResponse:s}),s}function vF(t,e,r,n){const i=`${e}${r}?${n}`;return t.config.emulator?Zv(t.config,i):`${t.config.apiScheme}://${i}`}class Dz{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(_a(this.auth,"network-request-failed")),Nz.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function K0(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=_a(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pz(t,e){return ju(t,"POST","/v1/accounts:delete",e)}async function yF(t,e){return ju(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jd(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Oz(t,e=!1){const r=ra(t),n=await r.getIdToken(e),i=ty(n);pt(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:jd(om(i.auth_time)),issuedAtTime:jd(om(i.iat)),expirationTime:jd(om(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function om(t){return Number(t)*1e3}function ty(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return gh("JWT malformed, contained fewer than 3 sections"),null;try{const i=Ok(r);return i?JSON.parse(i):(gh("Failed to decode base64 JWT payload"),null)}catch(i){return gh("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function YE(t){const e=ty(t);return pt(e,"internal-error"),pt(typeof e.exp<"u","internal-error"),pt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cf(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof uo&&Mz(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function Mz({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lz{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ox{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=jd(this.lastLoginAt),this.creationTime=jd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gp(t){var e;const r=t.auth,n=await t.getIdToken(),i=await Cf(t,yF(r,{idToken:n}));pt(i==null?void 0:i.users.length,r,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?_F(s.providerUserInfo):[],o=jz(t.providerData,a),l=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),f=l?u:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Ox(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(t,p)}async function Bz(t){const e=ra(t);await gp(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function jz(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function _F(t){return t.map(e=>{var{providerId:r}=e,n=Qv(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uz(t,e){const r=await xF(t,{},async()=>{const n=zf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=vF(t,i,"/v1/token",`key=${s}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",mF.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function Vz(t,e){return ju(t,"POST","/v2/accounts:revokeToken",ey(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){pt(e.idToken,"internal-error"),pt(typeof e.idToken<"u","internal-error"),pt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):YE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){pt(e.length!==0,"internal-error");const r=YE(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(pt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:s}=await Uz(e,r);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new su;return n&&(pt(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(pt(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(pt(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new su,this.toJSON())}_performRefresh(){return za("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function So(t,e){pt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Wa{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,s=Qv(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Lz(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Ox(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await Cf(this,this.stsTokenManager.getToken(this.auth,e));return pt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return Oz(this,e)}reload(){return Bz(this)}_assign(e){this!==e&&(pt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Wa(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){pt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await gp(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Mo(this.auth.app))return Promise.reject(Ul(this.auth));const e=await this.getIdToken();return await Cf(this,Pz(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,s,a,o,l,u,f;const p=(n=r.displayName)!==null&&n!==void 0?n:void 0,g=(i=r.email)!==null&&i!==void 0?i:void 0,m=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,y=(a=r.photoURL)!==null&&a!==void 0?a:void 0,x=(o=r.tenantId)!==null&&o!==void 0?o:void 0,w=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,A=(u=r.createdAt)!==null&&u!==void 0?u:void 0,k=(f=r.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:E,emailVerified:P,isAnonymous:Y,providerData:V,stsTokenManager:T}=r;pt(E&&T,e,"internal-error");const F=su.fromJSON(this.name,T);pt(typeof E=="string",e,"internal-error"),So(p,e.name),So(g,e.name),pt(typeof P=="boolean",e,"internal-error"),pt(typeof Y=="boolean",e,"internal-error"),So(m,e.name),So(y,e.name),So(x,e.name),So(w,e.name),So(A,e.name),So(k,e.name);const S=new Wa({uid:E,auth:e,email:g,emailVerified:P,displayName:p,isAnonymous:Y,photoURL:y,phoneNumber:m,tenantId:x,stsTokenManager:F,createdAt:A,lastLoginAt:k});return V&&Array.isArray(V)&&(S.providerData=V.map(I=>Object.assign({},I))),w&&(S._redirectEventId=w),S}static async _fromIdTokenResponse(e,r,n=!1){const i=new su;i.updateFromServerResponse(r);const s=new Wa({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await gp(s),s}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];pt(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?_F(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),o=new su;o.updateFromIdToken(n);const l=new Wa({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Ox(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XE=new Map;function Ha(t){so(t instanceof Function,"Expected a class definition");let e=XE.get(t);return e?(so(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,XE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EF{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}EF.type="NONE";const qE=EF;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mh(t,e,r){return`firebase:${t}:${e}:${r}`}class au{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=mh(this.userKey,i.apiKey,s),this.fullPersistenceKey=mh("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Wa._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new au(Ha(qE),e,n);const i=(await Promise.all(r.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||Ha(qE);const a=mh(n,e.config.apiKey,e.name);let o=null;for(const u of r)try{const f=await u._get(a);if(f){const p=Wa._fromJSON(e,f);u!==s&&(o=p),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new au(s,e,n):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async u=>{if(u!==s)try{await u._remove(a)}catch{}})),new au(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(AF(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(wF(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(CF(e))return"Blackberry";if(FF(e))return"Webos";if(SF(e))return"Safari";if((e.includes("chrome/")||TF(e))&&!e.includes("edge/"))return"Chrome";if(kF(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function wF(t=pi()){return/firefox\//i.test(t)}function SF(t=pi()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function TF(t=pi()){return/crios\//i.test(t)}function AF(t=pi()){return/iemobile/i.test(t)}function kF(t=pi()){return/android/i.test(t)}function CF(t=pi()){return/blackberry/i.test(t)}function FF(t=pi()){return/webos/i.test(t)}function ry(t=pi()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function zz(t=pi()){var e;return ry(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Wz(){return e9()&&document.documentMode===10}function bF(t=pi()){return ry(t)||kF(t)||FF(t)||CF(t)||/windows phone/i.test(t)||AF(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IF(t,e=[]){let r;switch(t){case"Browser":r=QE(pi());break;case"Worker":r=`${QE(pi())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Pu}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hz{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $z(t,e={}){return ju(t,"GET","/v2/passwordPolicy",ey(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gz=6;class Kz{constructor(e){var r,n,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:Gz,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yz{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new JE(this),this.idTokenSubscription=new JE(this),this.beforeStateQueue=new Hz(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=pF,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Ha(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await au.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await yF(this,{idToken:e}),n=await Wa._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Mo(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return pt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await gp(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=bz()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Mo(this.app))return Promise.reject(Ul(this));const r=e?ra(e):null;return r&&pt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&pt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Mo(this.app)?Promise.reject(Ul(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Mo(this.app)?Promise.reject(Ul(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ha(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await $z(this),r=new Kz(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Vf("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await Vz(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Ha(e)||this._popupRedirectResolver;pt(r,this,"argument-error"),this.redirectPersistenceManager=await au.create(this,[Ha(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(pt(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,i);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return pt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=IF(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&kz(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function ny(t){return ra(t)}class JE{constructor(e){this.auth=e,this.observer=null,this.addObserver=l9(r=>this.observer=r)}get next(){return pt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let iy={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Xz(t){iy=t}function qz(t){return iy.loadJS(t)}function Qz(){return iy.gapiScript}function Jz(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zz(t,e){const r=_v(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),s=r.getOptions();if(np(s,e??{}))return i;io(i,"already-initialized")}return r.initialize({options:e})}function eW(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Ha);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function tW(t,e,r){const n=ny(t);pt(n._canInitEmulator,n,"emulator-config-failed"),pt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,s=NF(e),{host:a,port:o}=rW(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${s}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),nW()}function NF(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function rW(t){const e=NF(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:ZE(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:ZE(a)}}}function ZE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function nW(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RF{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return za("not implemented")}_getIdTokenResponse(e){return za("not implemented")}_linkToIdToken(e,r){return za("not implemented")}_getReauthenticationResolver(e){return za("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ou(t,e){return Rz(t,"POST","/v1/accounts:signInWithIdp",ey(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iW="http://localhost";class rc extends RF{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new rc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):io("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,s=Qv(r,["providerId","signInMethod"]);if(!n||!i)return null;const a=new rc(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return ou(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,ou(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,ou(e,r)}buildRequest(){const e={requestUri:iW,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=zf(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DF{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qf extends DF{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo extends qf{constructor(){super("facebook.com")}static credential(e){return rc._fromParams({providerId:Fo.PROVIDER_ID,signInMethod:Fo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fo.credentialFromTaggedObject(e)}static credentialFromError(e){return Fo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fo.credential(e.oauthAccessToken)}catch{return null}}}Fo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Fo.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo extends qf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return rc._fromParams({providerId:bo.PROVIDER_ID,signInMethod:bo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return bo.credentialFromTaggedObject(e)}static credentialFromError(e){return bo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return bo.credential(r,n)}catch{return null}}}bo.GOOGLE_SIGN_IN_METHOD="google.com";bo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io extends qf{constructor(){super("github.com")}static credential(e){return rc._fromParams({providerId:Io.PROVIDER_ID,signInMethod:Io.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Io.credentialFromTaggedObject(e)}static credentialFromError(e){return Io.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Io.credential(e.oauthAccessToken)}catch{return null}}}Io.GITHUB_SIGN_IN_METHOD="github.com";Io.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No extends qf{constructor(){super("twitter.com")}static credential(e,r){return rc._fromParams({providerId:No.PROVIDER_ID,signInMethod:No.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return No.credentialFromTaggedObject(e)}static credentialFromError(e){return No.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return No.credential(r,n)}catch{return null}}}No.TWITTER_SIGN_IN_METHOD="twitter.com";No.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const s=await Wa._fromIdTokenResponse(e,n,i),a=ew(n);return new ku({user:s,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=ew(n);return new ku({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function ew(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mp extends uo{constructor(e,r,n,i){var s;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,mp.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new mp(e,r,n,i)}}function PF(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?mp._fromErrorAndOperation(t,s,e,n):s})}async function sW(t,e,r=!1){const n=await Cf(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return ku._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aW(t,e,r=!1){const{auth:n}=t;if(Mo(n.app))return Promise.reject(Ul(n));const i="reauthenticate";try{const s=await Cf(t,PF(n,i,e,t),r);pt(s.idToken,n,"internal-error");const a=ty(s.idToken);pt(a,n,"internal-error");const{sub:o}=a;return pt(t.uid===o,n,"user-mismatch"),ku._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&io(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oW(t,e,r=!1){if(Mo(t.app))return Promise.reject(Ul(t));const n="signIn",i=await PF(t,n,e),s=await ku._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(s.user),s}function lW(t,e,r,n){return ra(t).onIdTokenChanged(e,r,n)}function cW(t,e,r){return ra(t).beforeAuthStateChanged(e,r)}const xp="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OF{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(xp,"1"),this.storage.removeItem(xp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uW=1e3,dW=10;class MF extends OF{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=bF(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);Wz()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,dW):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},uW)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}MF.type="LOCAL";const fW=MF;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LF extends OF{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}LF.type="SESSION";const BF=LF;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hW(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new ng(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:s}=r.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async u=>u(r.origin,s)),l=await hW(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ng.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sy(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pW{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const u=sy("",20);i.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(p){const g=p;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(g.data.response);break;default:clearTimeout(f),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ea(){return window}function gW(t){Ea().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jF(){return typeof Ea().WorkerGlobalScope<"u"&&typeof Ea().importScripts=="function"}async function mW(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function xW(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function vW(){return jF()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UF="firebaseLocalStorageDb",yW=1,vp="firebaseLocalStorage",VF="fbase_key";class Qf{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function ig(t,e){return t.transaction([vp],e?"readwrite":"readonly").objectStore(vp)}function _W(){const t=indexedDB.deleteDatabase(UF);return new Qf(t).toPromise()}function Mx(){const t=indexedDB.open(UF,yW);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(vp,{keyPath:VF})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(vp)?e(n):(n.close(),await _W(),e(await Mx()))})})}async function tw(t,e,r){const n=ig(t,!0).put({[VF]:e,value:r});return new Qf(n).toPromise()}async function EW(t,e){const r=ig(t,!1).get(e),n=await new Qf(r).toPromise();return n===void 0?null:n.value}function rw(t,e){const r=ig(t,!0).delete(e);return new Qf(r).toPromise()}const wW=800,SW=3;class zF{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Mx(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>SW)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return jF()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ng._getInstance(vW()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await mW(),!this.activeServiceWorker)return;this.sender=new pW(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||xW()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Mx();return await tw(e,xp,"1"),await rw(e,xp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>tw(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>EW(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>rw(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=ig(i,!1).getAll();return new Qf(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),wW)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}zF.type="LOCAL";const TW=zF;new Xf(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AW(t,e){return e?Ha(e):(pt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay extends RF{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ou(e,this._buildIdpRequest())}_linkToIdToken(e,r){return ou(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return ou(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function kW(t){return oW(t.auth,new ay(t),t.bypassAuthState)}function CW(t){const{auth:e,user:r}=t;return pt(r,e,"internal-error"),aW(r,new ay(t),t.bypassAuthState)}async function FW(t){const{auth:e,user:r}=t;return pt(r,e,"internal-error"),sW(r,new ay(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WF{constructor(e,r,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return kW;case"linkViaPopup":case"linkViaRedirect":return FW;case"reauthViaPopup":case"reauthViaRedirect":return CW;default:io(this.auth,"internal-error")}}resolve(e){so(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){so(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bW=new Xf(2e3,1e4);class Kc extends WF{constructor(e,r,n,i,s){super(e,r,i,s),this.provider=n,this.authWindow=null,this.pollId=null,Kc.currentPopupAction&&Kc.currentPopupAction.cancel(),Kc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return pt(e,this.auth,"internal-error"),e}async onExecution(){so(this.filter.length===1,"Popup operations only handle one event");const e=sy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(_a(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(_a(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Kc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_a(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,bW.get())};e()}}Kc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IW="pendingRedirect",xh=new Map;class NW extends WF{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=xh.get(this.auth._key());if(!e){try{const n=await RW(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}xh.set(this.auth._key(),e)}return this.bypassAuthState||xh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function RW(t,e){const r=OW(e),n=PW(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function DW(t,e){xh.set(t._key(),e)}function PW(t){return Ha(t._redirectPersistence)}function OW(t){return mh(IW,t.config.apiKey,t.name)}async function MW(t,e,r=!1){if(Mo(t.app))return Promise.reject(Ul(t));const n=ny(t),i=AW(n,e),a=await new NW(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LW=10*60*1e3;class BW{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!jW(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!HF(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(_a(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=LW&&this.cachedEventUids.clear(),this.cachedEventUids.has(nw(e))}saveEventToCache(e){this.cachedEventUids.add(nw(e)),this.lastProcessedEventTime=Date.now()}}function nw(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function HF({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function jW(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return HF(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UW(t,e={}){return ju(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VW=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,zW=/^https?/;async function WW(t){if(t.config.emulator)return;const{authorizedDomains:e}=await UW(t);for(const r of e)try{if(HW(r))return}catch{}io(t,"unauthorized-domain")}function HW(t){const e=Px(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!zW.test(r))return!1;if(VW.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $W=new Xf(3e4,6e4);function iw(){const t=Ea().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function GW(t){return new Promise((e,r)=>{var n,i,s;function a(){iw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{iw(),r(_a(t,"network-request-failed"))},timeout:$W.get()})}if(!((i=(n=Ea().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Ea().gapi)===null||s===void 0)&&s.load)a();else{const o=Jz("iframefcb");return Ea()[o]=()=>{gapi.load?a():r(_a(t,"network-request-failed"))},qz(`${Qz()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw vh=null,e})}let vh=null;function KW(t){return vh=vh||GW(t),vh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YW=new Xf(5e3,15e3),XW="__/auth/iframe",qW="emulator/auth/iframe",QW={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},JW=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ZW(t){const e=t.config;pt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Zv(e,qW):`https://${t.config.authDomain}/${XW}`,n={apiKey:e.apiKey,appName:t.name,v:Pu},i=JW.get(t.config.apiHost);i&&(n.eid=i);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${zf(n).slice(1)}`}async function eH(t){const e=await KW(t),r=Ea().gapi;return pt(r,t,"internal-error"),e.open({where:document.body,url:ZW(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:QW,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const a=_a(t,"network-request-failed"),o=Ea().setTimeout(()=>{s(a)},YW.get());function l(){Ea().clearTimeout(o),i(n)}n.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tH={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},rH=500,nH=600,iH="_blank",sH="http://localhost";class sw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function aH(t,e,r,n=rH,i=nH){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},tH),{width:n.toString(),height:i.toString(),top:s,left:a}),u=pi().toLowerCase();r&&(o=TF(u)?iH:r),wF(u)&&(e=e||sH,l.scrollbars="yes");const f=Object.entries(l).reduce((g,[m,y])=>`${g}${m}=${y},`,"");if(zz(u)&&o!=="_self")return oH(e||"",o),new sw(null);const p=window.open(e||"",o,f);pt(p,t,"popup-blocked");try{p.focus()}catch{}return new sw(p)}function oH(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lH="__/auth/handler",cH="emulator/auth/handler",uH=encodeURIComponent("fac");async function aw(t,e,r,n,i,s){pt(t.config.authDomain,t,"auth-domain-config-required"),pt(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Pu,eventId:i};if(e instanceof DF){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",o9(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))a[f]=p}if(e instanceof qf){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const f of Object.keys(o))o[f]===void 0&&delete o[f];const l=await t._getAppCheckToken(),u=l?`#${uH}=${encodeURIComponent(l)}`:"";return`${dH(t)}?${zf(o).slice(1)}${u}`}function dH({config:t}){return t.emulator?Zv(t,cH):`https://${t.authDomain}/${lH}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lm="webStorageSupport";class fH{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=BF,this._completeRedirectFn=MW,this._overrideRedirectResult=DW}async _openPopup(e,r,n,i){var s;so((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await aw(e,r,n,Px(),i);return aH(e,a,sy())}async _openRedirect(e,r,n,i){await this._originValidation(e);const s=await aw(e,r,n,Px(),i);return gW(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:s}=this.eventManagers[r];return i?Promise.resolve(i):(so(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await eH(e),n=new BW(e);return r.register("authEvent",i=>(pt(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(lm,{type:lm},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[lm];a!==void 0&&r(!!a),io(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=WW(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return bF()||SF()||ry()}}const hH=fH;var ow="@firebase/auth",lw="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pH{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){pt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gH(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function mH(t){vu(new Jl("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;pt(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:IF(t)},u=new Yz(n,i,s,l);return eW(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),vu(new Jl("auth-internal",e=>{const r=ny(e.getProvider("auth").getImmediate());return(n=>new pH(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Yo(ow,lw,gH(t)),Yo(ow,lw,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xH=5*60,vH=Bk("authIdTokenMaxAge")||xH;let cw=null;const yH=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>vH)return;const i=r==null?void 0:r.token;cw!==i&&(cw=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function _H(t=zk()){const e=_v(t,"auth");if(e.isInitialized())return e.getImmediate();const r=Zz(t,{popupRedirectResolver:hH,persistence:[TW,fW,BF]}),n=Bk("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const a=yH(s.toString());cW(r,a,()=>a(r.currentUser)),lW(r,o=>a(o))}}const i=Mk("auth");return i&&tW(r,`http://${i}`),r}function EH(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}Xz({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const s=_a("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",EH().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});mH("Browser");const wH={apiKey:"AIzaSyAZZ0804o11q-hS6p7XJZNK_FPGJgXpmPc",authDomain:"finance-automation-b28e8.firebaseapp.com",projectId:"finance-automation-b28e8",storageBucket:"finance-automation-b28e8.firebasestorage.app",messagingSenderId:"832501526859",appId:"1:832501526859:web:3a64f40f9db732af1b78ce"},$F=Vk(wH),oy=sz($F);_H($F);const cm=async(t,e)=>{try{return await wz($v(oy,"appState",t),{masterData:e.masterData||[],servicesData:e.servicesData||[],ledgerEntries:e.ledgerEntries||[],receipts:e.receipts||[],creditNotes:e.creditNotes||[],openingBalances:e.openingBalances||{},mailerImages:e.mailerImages||{},mailerLogo:e.mailerLogo||null,companyConfig:e.companyConfig||{},nextInvoiceNo:e.nextInvoiceNo||1,nextCombineNo:e.nextCombineNo||1,nextReceiptNo:e.nextReceiptNo||1,nextCreditNoteNo:e.nextCreditNoteNo||1,nextServiceInvoiceNo:e.nextServiceInvoiceNo||1,invoiceValues:e.invoiceValues||{},notifications:e.notifications||[],whatsappSettings:e.whatsappSettings||{},partyMaster:e.partyMaster||[],followups:e.followups||[],userPasswords:e.userPasswords||{},updatedAt:new Date().toISOString()}),!0}catch(r){return console.error("Error saving app state:",r),!1}},uw=async t=>{try{const e=await Ez($v(oy,"appState",t));return e.exists()?e.data():null}catch(e){return console.error("Error loading app state:",e),null}},SH=(t,e)=>{const r=$v(oy,"appState",t);return Sz(r,n=>{n.exists()&&e(n.data())},n=>{console.error("Error in real-time listener:",n)})},et=t=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2,maximumFractionDigits:2}).format(t||0),zt=t=>""+new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t||0),At=t=>{if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return t;const r=e.getDate().toString().padStart(2,"0"),n=e.toLocaleString("en-US",{month:"short"}),i=e.getFullYear();return`${r}-${n}-${i}`},TH=t=>{if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return t;const r=e.getDate(),n=e.toLocaleString("en-US",{month:"short"}),i=e.getFullYear();return`${r}${(a=>{if(a>3&&a<21)return"th";switch(a%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}})(r)} ${n}, ${i}`},Y0=t=>{const e=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],r=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];if(t===0)return"Zero";const n=l=>l<20?e[l]:l<100?r[Math.floor(l/10)]+(l%10?" "+e[l%10]:""):e[Math.floor(l/100)]+" Hundred"+(l%100?" "+n(l%100):""),i=l=>l<1e3?n(l):l<1e5?n(Math.floor(l/1e3))+" Thousand"+(l%1e3?" "+n(l%1e3):""):l<1e7?n(Math.floor(l/1e5))+" Lakh"+(l%1e5?" "+i(l%1e5):""):n(Math.floor(l/1e7))+" Crore"+(l%1e7?" "+i(l%1e7):""),s=Math.floor(t),a=Math.round((t-s)*100);let o="INR "+i(s);return a>0&&(o+=" and "+i(a)+" Paise"),o+" Only"},dw=t=>{if(!t)return"";const e=/[\w.-]+@[\w.-]+\.\w+/g,r=t.match(e);return r?r[0]:""},AH=t=>({Approved:{bg:"#DCFCE7",text:"#166534",border:"#86EFAC"},Created:{bg:"#DBEAFE",text:"#1E40AF",border:"#93C5FD"},"Need Edits":{bg:"#FEE2E2",text:"#991B1B",border:"#FCA5A5"},Paid:{bg:"#D1FAE5",text:"#065F46",border:"#6EE7B7"},Individual:{bg:"#E0E7FF",text:"#3730A3",border:"#A5B4FC"},Combined:{bg:"#F3E8FF",text:"#6B21A8",border:"#DDD6FE"},Yes:{bg:"#DCFCE7",text:"#166534",border:"#86EFAC"},No:{bg:"#FEF3C7",text:"#92400E",border:"#FCD34D"},"Not Yet":{bg:"#F1F5F9",text:"#475569",border:"#CBD5E1"},Pending:{bg:"#FEF3C7",text:"#92400E",border:"#FCD34D"},Sent:{bg:"#D1FAE5",text:"#065F46",border:"#6EE7B7"}})[t]||{bg:"#F1F5F9",text:"#475569",border:"#CBD5E1"},X0=({status:t,small:e=!1})=>{const r=AH(t);return c.jsx("span",{style:{display:"inline-flex",alignItems:"center",padding:e?"2px 8px":"4px 12px",borderRadius:"6px",fontSize:e?"11px":"12px",fontWeight:"600",backgroundColor:r.bg,color:r.text,border:`1px solid ${r.border}`},children:t})},qe=({icon:t,label:e,onClick:r,variant:n="default",disabled:i=!1,small:s=!1})=>{const a={default:{bg:"#F8FAFC",hoverBg:"#E2E8F0",text:"#475569",border:"#CBD5E1"},primary:{bg:"#2874A6",hoverBg:"#1a5276",text:"#FFFFFF",border:"#2874A6"},success:{bg:"#059669",hoverBg:"#047857",text:"#FFFFFF",border:"#059669"},warning:{bg:"#D97706",hoverBg:"#B45309",text:"#FFFFFF",border:"#D97706"},danger:{bg:"#DC2626",hoverBg:"#B91C1C",text:"#FFFFFF",border:"#DC2626"},brand:{bg:"#2874A6",hoverBg:"#1a5276",text:"#FFFFFF",border:"#2874A6"},purple:{bg:"#7C3AED",hoverBg:"#6D28D9",text:"#FFFFFF",border:"#7C3AED"},secondary:{bg:"#F1F5F9",hoverBg:"#E2E8F0",text:"#475569",border:"#CBD5E1"}},o=a[n]||a.default;return c.jsxs("button",{onClick:r,disabled:i,title:e,style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:s?"5px 10px":"8px 14px",borderRadius:"6px",fontSize:s?"11px":"13px",fontWeight:"600",backgroundColor:i?"#F1F5F9":o.bg,color:i?"#94A3B8":o.text,border:`1px solid ${i?"#E2E8F0":o.border}`,cursor:i?"not-allowed":"pointer",transition:"all 0.15s ease",whiteSpace:"nowrap",opacity:i?.6:1},onMouseEnter:l=>!i&&(l.target.style.backgroundColor=o.hoverBg),onMouseLeave:l=>!i&&(l.target.style.backgroundColor=o.bg),children:[t&&c.jsx(t,{size:s?14:16}),e&&c.jsx("span",{children:e})]})},Cr=({label:t,type:e="text",value:r,onChange:n,placeholder:i,disabled:s,small:a})=>c.jsxs("div",{style:{marginBottom:a?"12px":"16px"},children:[t&&c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:t}),c.jsx("input",{type:e,value:r,onChange:n,placeholder:i,disabled:s,style:{width:"100%",padding:a?"8px 12px":"10px 14px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:a?"13px":"14px",backgroundColor:s?"#F9FAFB":"#FFFFFF",boxSizing:"border-box"}})]}),q0=({label:t,value:e,onChange:r,options:n,small:i})=>c.jsxs("div",{style:{marginBottom:i?"12px":"16px"},children:[t&&c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:t}),c.jsx("select",{value:e,onChange:r,style:{width:"100%",padding:i?"8px 12px":"10px 14px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:i?"13px":"14px",backgroundColor:"#FFFFFF",boxSizing:"border-box"},children:n.map(s=>c.jsx("option",{value:s.value,children:s.label},s.value))})]}),Zr=({title:t,children:e,actions:r,noPadding:n=!1})=>c.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",boxShadow:"0 2px 8px rgba(0,0,0,0.06)",overflow:"hidden"},children:[t&&c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"14px 20px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FAFBFC"},children:[c.jsx("h3",{style:{margin:0,fontSize:"15px",fontWeight:"700",color:"#1E293B"},children:t}),r&&c.jsx("div",{style:{display:"flex",gap:"10px"},children:r})]}),c.jsx("div",{style:{padding:n?0:"20px"},children:e})]}),In=({isOpen:t,onClose:e,title:r,children:n,width:i="500px"})=>t?c.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(15, 23, 42, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(4px)"},onClick:e,children:c.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"16px",width:i,maxWidth:"95vw",maxHeight:"90vh",overflow:"hidden",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},onClick:s=>s.stopPropagation(),children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FAFBFC"},children:[c.jsx("h2",{style:{margin:0,fontSize:"16px",fontWeight:"700",color:"#1E293B"},children:r}),c.jsx("button",{onClick:e,style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748B"},children:c.jsx(Ma,{size:20})})]}),c.jsx("div",{style:{padding:"20px",maxHeight:"calc(90vh - 100px)",overflowY:"auto"},children:n})]})}):null;function kH(){const[t,e]=ve.useState(()=>{const h=localStorage.getItem("financeAppLogin");return h?JSON.parse(h).isLoggedIn:!1}),[r,n]=ve.useState(()=>{const h=localStorage.getItem("financeAppLogin");return h?JSON.parse(h).userRole:null}),[i,s]=ve.useState({username:"",password:""}),[a,o]=ve.useState(""),[l,u]=ve.useState(!1),[f,p]=ve.useState(!1),[g,m]=ve.useState(null),[y,x]=ve.useState({finance:"finance123",director:"director123"}),[w,A]=ve.useState(!1),[k,E]=ve.useState(!1),[P,Y]=ve.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[V,T]=ve.useState(""),F={finance:{role:"finance",name:"Finance Team"},director:{role:"director",name:"Director"}};ve.useEffect(()=>{(async()=>{try{const _=await uw("indreesh-media");_&&_.userPasswords&&(x(_.userPasswords),console.log("Passwords loaded from Firebase"))}catch(_){console.error("Error loading passwords:",_)}A(!0)})()},[]);const[S,I]=ve.useState({name:"Indreesh Media LLP",brand:"JAC",address:"A-1701 Sweet Home CHS LTD, SVP, Plot No: 24",addressLine2:"Andheri West, Nr Last Bus St",city:"Mumbai-400053",gstin:"27AAIFI6351A1ZM",stateCode:"27",stateName:"Maharashtra",email:"alliances@mediabrief.com",phone:"+91 7021911036",website:"www.mediabrief.com",pan:"AAIFI6351A",bank:{name:"Axis Bank",account:"921020009075531",branch:"Andheri",ifsc:"UTIB0000020",holder:"Indreesh Media LLP"},invoicePrefix:"MB/2025-26/",hsnCode:"998365",gstRate:18}),[R,D]=ve.useState("master"),[N,$e]=ve.useState(!1),[_e,Pe]=ve.useState([]),[be,Te]=ve.useState([]),[ie,Ce]=ve.useState([]),[Be,W]=ve.useState([]),[ne,re]=ve.useState([]),[q,xe]=ve.useState(null),[we,je]=ve.useState(null),[Ie,Ae]=ve.useState(1),[nt,J]=ve.useState(1),[Mt,Et]=ve.useState(1),[Rt,mt]=ve.useState(1),[Ge,or]=ve.useState(1),[Ln,sn]=ve.useState(!1),[bi,ls]=ve.useState(!1),[Ii,Hr]=ve.useState(!1),[Ni,er]=ve.useState(!1),[br,gr]=ve.useState(!1),[mi,ft]=ve.useState(!1),[mr,xr]=ve.useState(!1),[Sr,xi]=ve.useState(!1),[fo,ho]=ve.useState(!1),[Uu,Os]=ve.useState(!1),[fl,Ms]=ve.useState(!1),[ce,Br]=ve.useState(null),[Ri,cs]=ve.useState("reply"),[ka,na]=ve.useState(""),[ia,Di]=ve.useState(""),[an,qr]=ve.useState({fromDate:"2020-01-01",toDate:new Date().toISOString().split("T")[0]}),[Ca,Ls]=ve.useState(""),[on,hc]=ve.useState("open"),[Ki,b]=ve.useState("open"),[G,L]=ve.useState(!1),[U,X]=ve.useState(null),[Q,ue]=ve.useState(new Set),[pe,fe]=ve.useState({party:"",billStatus:"",invoiceStatus:""}),[se,he]=ve.useState({party:"",invoiceNo:"",dateFrom:"",dateTo:""}),[Se,Ue]=ve.useState({party:"",invoiceStatus:"",receiptStatus:"",invoiceType:"",searchText:""}),[Ke,Re]=ve.useState([]),[Ye,ct]=ve.useState(!1),[Lt,Bt]=ve.useState([]),[hr,Pi]=ve.useState(!1),[lr,us]=ve.useState(null),[Ir,ds]=ve.useState({date:new Date().toISOString().split("T")[0],notes:"",nextFollowupDate:"",status:"Pending"}),[st,Bs]=ve.useState({enabled:!1,financePhone:"",financeApiKey:"",directorPhone:"",directorApiKey:""}),[jt,Oi]=ve.useState({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),[ln,Fa]=ve.useState({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]}),[ba,sa]=ve.useState({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1}),[pc,js]=ve.useState(null),[cn,aa]=ve.useState(new Set),[Bn,po]=ve.useState({}),[Ut,Ia]=ve.useState(null),[fs,hs]=ve.useState(null),[Vu,hl]=ve.useState(!1),[vi,gc]=ve.useState({}),[Mi,mc]=ve.useState({partyName:"",amount:"",type:"Dr"}),[yi,ps]=ve.useState({}),[un,pl]=ve.useState({}),[Jf,Us]=ve.useState(!1),[Zf,zu]=ve.useState(new Set),[vt,Li]=ve.useState({party:"",billStatus:"",invoiceStatus:"",mailingStatus:"",invoiceType:"",combinationCode:"",searchText:""}),[Tr,go]=ve.useState({amount:"",date:new Date().toISOString().split("T")[0],mode:"Bank",tds:"",discount:"",narration:""}),gl=ve.useRef(null),ml=ve.useRef(null),Wu=ve.useRef(null),Na=ve.useRef(null),mo=ve.useRef(null),Hu=ve.useRef(null),xc=ve.useRef(null),cr=ve.useRef(null),e0=ve.useRef(null),t0=ve.useRef(null),dn=ve.useMemo(()=>Array.isArray(_e)?_e:[],[_e]),wn=ve.useMemo(()=>Array.isArray(be)?be:[],[be]),jn=ve.useMemo(()=>Array.isArray(ie)?ie:[],[ie]),Jn=ve.useMemo(()=>Array.isArray(Be)?Be:[],[Be]),Bi=ve.useMemo(()=>Array.isArray(ne)?ne:[],[ne]),gs=ve.useMemo(()=>Array.isArray(Ke)?Ke:[],[Ke]),xl=ve.useMemo(()=>Array.isArray(Lt)?Lt:[],[Lt]),Qr=ve.useMemo(()=>un&&typeof un=="object"&&!Array.isArray(un)?un:{},[un]),ms=ve.useMemo(()=>vi&&typeof vi=="object"&&!Array.isArray(vi)?vi:{},[vi]),qt=(h,_)=>!h||!_?!1:h.trim().toUpperCase()===_.trim().toUpperCase(),_i=ve.useCallback(h=>{if(!h)return"";const _=h.toUpperCase().trim();return _.includes("MAHARASHTRA")||_==="MH"?"MAHARASHTRA":_.includes("DELHI")||_==="DL"||_.includes("NEW DELHI")?"DELHI":_.includes("KARNATAKA")||_==="KA"||_.includes("BANGALORE")||_.includes("BENGALURU")?"KARNATAKA":_.includes("TAMIL")||_==="TN"||_.includes("CHENNAI")?"TAMIL NADU":_.includes("TELANGANA")||_==="TG"||_==="TS"||_.includes("HYDERABAD")?"TELANGANA":_.includes("UTTAR PRADESH")||_==="UP"||_.includes("NOIDA")||_.includes("LUCKNOW")?"UTTAR PRADESH":_.includes("WEST BENGAL")||_==="WB"||_.includes("KOLKATA")?"WEST BENGAL":_.includes("GUJARAT")||_==="GJ"||_.includes("AHMEDABAD")?"GUJARAT":_.includes("RAJASTHAN")||_==="RJ"||_.includes("JAIPUR")?"RAJASTHAN":_.includes("PUNJAB")||_==="PB"?"PUNJAB":_.includes("HARYANA")||_==="HR"||_.includes("GURGAON")||_.includes("GURUGRAM")?"HARYANA":_.includes("MADHYA PRADESH")||_==="MP"||_.includes("BHOPAL")?"MADHYA PRADESH":_.includes("ANDHRA")||_==="AP"?"ANDHRA PRADESH":_.includes("KERALA")||_==="KL"?"KERALA":_.includes("ODISHA")||_.includes("ORISSA")||_==="OR"||_==="OD"?"ODISHA":_.includes("BIHAR")||_==="BR"?"BIHAR":_.includes("JHARKHAND")||_==="JH"?"JHARKHAND":_.includes("ASSAM")||_==="AS"?"ASSAM":_.includes("CHHATTISGARH")||_==="CG"?"CHHATTISGARH":_.includes("GOA")||_==="GA"?"GOA":_.includes("HIMACHAL")||_==="HP"?"HIMACHAL PRADESH":_.includes("JAMMU")||_==="JK"?"JAMMU AND KASHMIR":_.includes("UTTARAKHAND")||_.includes("UTTARANCHAL")||_==="UK"?"UTTARAKHAND":_.includes("MUMBAI")?"MAHARASHTRA":_.includes("CHANDIGARH")?"CHANDIGARH":_},[]),xo=ve.useCallback((h,_)=>{var H;if(!h)return"";const z=_i(_),Z=h.trim().toUpperCase(),B=`${Z}|${z}`;if((H=Qr[B])!=null&&H.gstin)return Qr[B].gstin;for(const j in Qr){const M=Qr[j];if((M.partyName||"").trim().toUpperCase()===Z&&M.normalizedState===z)return M.gstin||""}for(const j in Qr){const M=Qr[j];if((M.partyName||"").trim().toUpperCase()===Z&&M.gstin)return M.gstin}return""},[Qr,_i]),vl=ve.useCallback((h,_)=>{var H;if(!h)return"";const z=_i(_),Z=h.trim().toUpperCase(),B=`${Z}|${z}`;if((H=Qr[B])!=null&&H.address)return Qr[B].address;for(const j in Qr){const M=Qr[j];if((M.partyName||"").trim().toUpperCase()===Z&&M.normalizedState===z)return M.address||""}for(const j in Qr){const M=Qr[j];if((M.partyName||"").trim().toUpperCase()===Z&&M.address)return M.address}return""},[Qr,_i]),Ra=ve.useRef(!1),Da=ve.useRef(null),$u=async()=>{u(!0);try{const h=await uw("indreesh-media");h&&(Array.isArray(h.masterData)&&Pe(h.masterData),Array.isArray(h.servicesData)&&Te(h.servicesData),Array.isArray(h.ledgerEntries)&&Ce(h.ledgerEntries),Array.isArray(h.receipts)&&W(h.receipts),Array.isArray(h.creditNotes)&&re(h.creditNotes),Array.isArray(h.notifications)&&Re(h.notifications),Array.isArray(h.followups)&&Bt(h.followups),h.openingBalances&&typeof h.openingBalances=="object"&&!Array.isArray(h.openingBalances)&&gc(h.openingBalances),h.mailerImages&&typeof h.mailerImages=="object"&&!Array.isArray(h.mailerImages)&&po(h.mailerImages),h.partyMaster&&typeof h.partyMaster=="object"&&!Array.isArray(h.partyMaster)&&pl(h.partyMaster),h.userPasswords&&typeof h.userPasswords=="object"&&!Array.isArray(h.userPasswords)&&x(h.userPasswords),h.mailerLogo&&Ia(h.mailerLogo),h.companyConfig&&I(_=>({..._,...h.companyConfig,name:"Indreesh Media LLP",bank:{...h.companyConfig.bank||_.bank,holder:"Indreesh Media LLP"}})),h.nextInvoiceNo&&Ae(h.nextInvoiceNo),h.nextCombineNo&&J(h.nextCombineNo),h.nextReceiptNo&&Et(h.nextReceiptNo),h.nextCreditNoteNo&&mt(h.nextCreditNoteNo),h.nextServiceInvoiceNo&&or(h.nextServiceInvoiceNo),h.invoiceValues&&ps(h.invoiceValues),h.whatsappSettings&&Bs(_=>({..._,...h.whatsappSettings})),console.log("Data loaded from Firebase"))}catch(h){console.error("Error loading data:",h)}u(!1)},Pa=ve.useCallback(async()=>{p(!0);try{console.log("Saving to Firebase:",{masterDataCount:_e==null?void 0:_e.length,servicesDataCount:be==null?void 0:be.length,servicesDataSample:be==null?void 0:be.slice(0,1),receiptsCount:Be==null?void 0:Be.length,creditNotesCount:ne==null?void 0:ne.length}),await cm("indreesh-media",{masterData:_e,servicesData:be,ledgerEntries:ie,receipts:Be,creditNotes:ne,openingBalances:vi,mailerImages:Bn,mailerLogo:Ut,companyConfig:S,nextInvoiceNo:Ie,nextCombineNo:nt,nextReceiptNo:Mt,nextCreditNoteNo:Rt,nextServiceInvoiceNo:Ge,invoiceValues:yi,notifications:Ke,whatsappSettings:st,partyMaster:un,followups:Lt,userPasswords:y}),m(new Date),console.log("Data saved to Firebase successfully")}catch(h){console.error("Error saving data:",h)}p(!1)},[_e,be,ie,Be,ne,vi,Bn,Ut,S,Ie,nt,Mt,Rt,Ge,yi,Ke,st,un,Lt,y]);ve.useEffect(()=>{if(t&&!Ra.current)return cr.current&&clearTimeout(cr.current),cr.current=setTimeout(()=>{Ra.current||Pa()},1e3),()=>{cr.current&&clearTimeout(cr.current)}},[_e,be,ie,Be,ne,vi,Bn,Ut,S,Ie,nt,Mt,Rt,Ge,yi,Ke,st,un,Lt,y,t]);const r0=async(h,_,z)=>{if(!st.enabled){console.log("WhatsApp notifications not enabled");return}z==="finance"&&st.financePhone&&st.financeApiKey?vo(st.financePhone,st.financeApiKey,h,_):z==="director"&&st.directorPhone&&st.directorApiKey?vo(st.directorPhone,st.directorApiKey,h,_):z==="all"&&(st.financePhone&&st.financeApiKey&&vo(st.financePhone,st.financeApiKey,h,_),st.directorPhone&&st.directorApiKey&&vo(st.directorPhone,st.directorApiKey,h,_))},vo=async(h,_,z,Z)=>{try{const H=`*${{upload:" DATA UPLOAD",invoice:" INVOICE",approval:" APPROVED",edit:" EDIT REQUIRED",receipt:" PAYMENT",info:" UPDATE"}[z]||" NOTIFICATION"}*

${Z}

_${S.name}_
_${new Date().toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})}_`,j=`https://api.callmebot.com/whatsapp.php?phone=${h}&text=${encodeURIComponent(H)}&apikey=${_}`;fetch(j,{mode:"no-cors"}).then(()=>console.log("WhatsApp notification sent to:",h)).catch(M=>console.log("WhatsApp send attempted:",h))}catch(B){console.error("Failed to send WhatsApp notification:",B)}},vc=(h,_)=>{if(!h||!_){alert("Please enter phone number and API key first");return}vo(h,_,"info","Test notification from Indreesh Media LLP. WhatsApp notifications are working!"),alert("Test message sent! Check your WhatsApp.")},Zn=(h,_,z="all")=>{const Z={id:Date.now()+Math.random(),type:h,message:_,forRole:z,createdAt:new Date().toISOString(),createdBy:r,read:{finance:!1,director:!1}};Re(B=>[Z,...B].slice(0,50)),r0(h,_,z)},n0=h=>{Re(_=>(Array.isArray(_)?_:[]).map(Z=>Z.id===h?{...Z,read:{...Z.read,[r]:!0}}:Z))},yc=()=>{Re(h=>(Array.isArray(h)?h:[]).map(z=>({...z,read:{...z.read,[r]:!0}})))},i0=()=>{Re([])},yl=ve.useMemo(()=>gs.filter(h=>h.forRole==="all"||h.forRole===r||h.createdBy!==r).map(h=>({...h,read:h.read||{finance:!1,director:!1}})),[gs,r]),Un=ve.useMemo(()=>r?yl.filter(h=>!(h.read&&h.read[r])).length:0,[yl,r]),Gu=async()=>{const h=F[i.username.toLowerCase()],_=y[i.username.toLowerCase()];h&&_===i.password?(e(!0),n(h.role),localStorage.setItem("financeAppLogin",JSON.stringify({isLoggedIn:!0,userRole:h.role})),o(""),s({username:"",password:""}),await $u()):o("Invalid username or password")},_c=async()=>{if(!P.currentPassword||!P.newPassword||!P.confirmPassword){T("Please fill all fields");return}const h=r==="director"?"director":"finance";if(y[h]!==P.currentPassword){T("Current password is incorrect");return}if(P.newPassword!==P.confirmPassword){T("New passwords do not match");return}if(P.newPassword.length<6){T("Password must be at least 6 characters");return}const _={...y,[h]:P.newPassword};x(_);try{await cm("indreesh-media",{masterData:_e,ledgerEntries:ie,receipts:Be,creditNotes:ne,openingBalances:vi,mailerImages:Bn,mailerLogo:Ut,companyConfig:S,nextInvoiceNo:Ie,nextCombineNo:nt,nextReceiptNo:Mt,nextCreditNoteNo:Rt,invoiceValues:yi,notifications:Ke,whatsappSettings:st,partyMaster:un,followups:Lt,userPasswords:_}),console.log("Password saved to Firebase")}catch(z){console.error("Error saving password:",z),T("Failed to save password. Please try again.");return}E(!1),Y({currentPassword:"",newPassword:"",confirmPassword:""}),T(""),alert(" Password changed successfully!")},s0=()=>{Pa(),e(!1),n(null),D("master"),localStorage.removeItem("financeAppLogin")};ve.useEffect(()=>{const h=localStorage.getItem("financeAppLogin");if(h){const{isLoggedIn:_}=JSON.parse(h);_&&$u()}},[]),ve.useEffect(()=>{if(!t){Da.current&&(Da.current(),Da.current=null);return}return Da.current=SH("indreesh-media",h=>{h&&(console.log("Firebase data received:",{hasMasterData:Array.isArray(h.masterData)?h.masterData.length:"not array",hasServicesData:Array.isArray(h.servicesData)?h.servicesData.length:"not array",servicesDataRaw:h.servicesData,hasReceipts:Array.isArray(h.receipts)?h.receipts.length:"not array",hasCreditNotes:Array.isArray(h.creditNotes)?h.creditNotes.length:"not array"}),Ra.current=!0,Array.isArray(h.masterData)&&Pe(h.masterData),Array.isArray(h.servicesData)&&Te(h.servicesData),Array.isArray(h.ledgerEntries)&&Ce(h.ledgerEntries),Array.isArray(h.receipts)&&W(h.receipts),Array.isArray(h.creditNotes)&&re(h.creditNotes),Array.isArray(h.notifications)&&Re(h.notifications),Array.isArray(h.followups)&&Bt(h.followups),h.openingBalances&&typeof h.openingBalances=="object"&&!Array.isArray(h.openingBalances)&&gc(h.openingBalances),h.mailerImages&&typeof h.mailerImages=="object"&&!Array.isArray(h.mailerImages)&&po(h.mailerImages),h.partyMaster&&typeof h.partyMaster=="object"&&!Array.isArray(h.partyMaster)&&pl(h.partyMaster),h.userPasswords&&typeof h.userPasswords=="object"&&!Array.isArray(h.userPasswords)&&x(h.userPasswords),h.mailerLogo&&Ia(h.mailerLogo),h.companyConfig&&I(_=>({..._,...h.companyConfig,name:"Indreesh Media LLP",bank:{...h.companyConfig.bank||_.bank,holder:"Indreesh Media LLP"}})),h.nextInvoiceNo&&Ae(h.nextInvoiceNo),h.nextCombineNo&&J(h.nextCombineNo),h.nextReceiptNo&&Et(h.nextReceiptNo),h.nextCreditNoteNo&&mt(h.nextCreditNoteNo),h.nextServiceInvoiceNo&&or(h.nextServiceInvoiceNo),h.invoiceValues&&ps(h.invoiceValues),h.whatsappSettings&&Bs(_=>({..._,...h.whatsappSettings})),setTimeout(()=>{Ra.current=!1},500),console.log("Real-time sync: Data updated from Firebase"))}),()=>{Da.current&&(Da.current(),Da.current=null)}},[t]),ve.useEffect(()=>{if(wn.length>0){const h=new Set(wn.map(_=>_.partyName).filter(Boolean));ue(_=>_.size===0||_.size!==h.size?h:_)}},[wn]);const dr=r==="finance",Sn=r==="director",Tn=ve.useMemo(()=>{const h=new Set;return dn.forEach(_=>{_.partyName&&h.add(_.partyName)}),Object.values(Qr).forEach(_=>{_.partyName&&h.add(_.partyName)}),jn.forEach(_=>{_.partyName&&h.add(_.partyName)}),Object.keys(ms).forEach(_=>{_&&h.add(_)}),Array.from(h).filter(Boolean).sort()},[dn,Qr,jn,ms]),Yi=ve.useMemo(()=>{const h=[],_=new Set,z=new Set,Z=B=>{if(!B)return"";const H=B.toUpperCase().trim();return H.includes("MAHARASHTRA")||H==="MH"||H.includes("MUMBAI")?"MAHARASHTRA":H.includes("DELHI")||H==="DL"||H.includes("NEW DELHI")?"DELHI":H.includes("KARNATAKA")||H==="KA"||H.includes("BANGALORE")||H.includes("BENGALURU")?"KARNATAKA":H.includes("TAMIL")||H==="TN"||H.includes("CHENNAI")?"TAMIL NADU":H.includes("TELANGANA")||H==="TG"||H==="TS"||H.includes("HYDERABAD")?"TELANGANA":H.includes("UTTAR PRADESH")||H==="UP"||H.includes("NOIDA")||H.includes("LUCKNOW")?"UTTAR PRADESH":H.includes("WEST BENGAL")||H==="WB"||H.includes("KOLKATA")?"WEST BENGAL":H.includes("GUJARAT")||H==="GJ"||H.includes("AHMEDABAD")?"GUJARAT":H.includes("RAJASTHAN")||H==="RJ"||H.includes("JAIPUR")?"RAJASTHAN":H.includes("PUNJAB")||H==="PB"?"PUNJAB":H.includes("HARYANA")||H==="HR"||H.includes("GURGAON")||H.includes("GURUGRAM")?"HARYANA":H.includes("MADHYA PRADESH")||H==="MP"||H.includes("BHOPAL")?"MADHYA PRADESH":H.includes("ANDHRA")||H==="AP"?"ANDHRA PRADESH":H.includes("KERALA")||H==="KL"?"KERALA":H.includes("ODISHA")||H.includes("ORISSA")||H==="OR"||H==="OD"?"ODISHA":H.includes("BIHAR")||H==="BR"?"BIHAR":H.includes("JHARKHAND")||H==="JH"?"JHARKHAND":H.includes("ASSAM")||H==="AS"?"ASSAM":H.includes("CHHATTISGARH")||H==="CG"?"CHHATTISGARH":H.includes("GOA")||H==="GA"?"GOA":H.includes("HIMACHAL")||H==="HP"?"HIMACHAL PRADESH":H.includes("JAMMU")||H==="JK"?"JAMMU AND KASHMIR":H.includes("UTTARAKHAND")||H.includes("UTTARANCHAL")||H==="UK"?"UTTARAKHAND":H.includes("CHANDIGARH")?"CHANDIGARH":H};return Object.entries(Qr).forEach(([B,H])=>{if(H.partyName){const j=H.normalizedState||Z(H.stateName),M=H.partyName.trim().toUpperCase(),ae=`${M}|${j}`;_.has(ae)||(_.add(ae),z.add(M),h.push({partyName:H.partyName,partyNameUpper:M,state:H.stateName||"",normalizedState:j,gstin:H.gstin||"",address:H.address||"",fromPartyMaster:!0}))}}),dn.forEach(B=>{if(B.partyName){const H=B.partyName.trim().toUpperCase(),j=Z(B.statePartyDetails),M=`${H}|${j}`;_.has(M)||(_.add(M),z.add(H),h.push({partyName:B.partyName,partyNameUpper:H,state:B.statePartyDetails||"",normalizedState:j,gstin:"",address:"",fromPartyMaster:!1}))}}),jn.forEach(B=>{if(B.partyName){const H=B.partyName.trim().toUpperCase(),j=Z(B.state||B.statePartyDetails||""),M=`${H}|${j}`;_.has(M)||(_.add(M),z.add(H),h.push({partyName:B.partyName,partyNameUpper:H,state:B.state||B.statePartyDetails||"",normalizedState:j,gstin:"",address:"",fromPartyMaster:!1}))}}),Object.keys(ms).forEach(B=>{const H=B.trim().toUpperCase();B&&!z.has(H)&&(z.add(H),h.push({partyName:B,partyNameUpper:H,state:"",normalizedState:"",gstin:"",address:"",fromPartyMaster:!1}))}),wn.forEach(B=>{if(B.partyName){const H=B.partyName.trim().toUpperCase(),j=Z(B.statePartyDetails),M=`${H}|${j}`;_.has(M)||(_.add(M),z.add(H),h.push({partyName:B.partyName,partyNameUpper:H,state:B.statePartyDetails||"",normalizedState:j,gstin:B.gstin||"",address:B.address||"",fromPartyMaster:!1}))}}),h.sort((B,H)=>B.partyName.localeCompare(H.partyName))},[dn,wn,Qr,jn,ms]);ve.useMemo(()=>[...new Set(dn.filter(_=>_.combinationCode&&_.combinationCode!=="NA").map(_=>_.combinationCode))].sort((_,z)=>parseInt(_)-parseInt(z)),[dn]);const Ec=ve.useMemo(()=>dn.filter(h=>{var _,z,Z,B,H,j;if(vt.party&&h.partyName!==vt.party||vt.billStatus&&h.toBeBilled!==vt.billStatus||vt.invoiceStatus&&(vt.invoiceStatus==="Generated"&&!h.invoiceGenerated||vt.invoiceStatus==="Not Generated"&&h.invoiceGenerated||vt.invoiceStatus==="Paid"&&h.invoiceStatus!=="Paid")||vt.mailingStatus&&h.mailingSent!==vt.mailingStatus||vt.invoiceType&&h.invoiceType!==vt.invoiceType||vt.combinationCode&&h.combinationCode!==vt.combinationCode)return!1;if(vt.searchText){const M=vt.searchText.toLowerCase();if(!(((_=h.senderName)==null?void 0:_.toLowerCase().includes(M))||((z=h.subject)==null?void 0:z.toLowerCase().includes(M))||((Z=h.campaignName)==null?void 0:Z.toLowerCase().includes(M))||((B=h.invoiceNo)==null?void 0:B.toLowerCase().includes(M))||((H=h.partyName)==null?void 0:H.toLowerCase().includes(M))||((j=h.emailId)==null?void 0:j.toLowerCase().includes(M))))return!1}return!0}),[dn,vt]);ve.useMemo(()=>{const h={};return Ec.forEach(_=>{h[_.partyName]||(h[_.partyName]=[]),h[_.partyName].push(_)}),Object.keys(h).forEach(_=>{h[_].sort((z,Z)=>z.toBeBilled==="Yes"&&Z.toBeBilled!=="Yes"?-1:z.toBeBilled!=="Yes"&&Z.toBeBilled==="Yes"?1:0)}),h},[Ec]),ve.useMemo(()=>{if(!q)return[];const h=ms[q]||0;let _=h;const z=jn.filter(Z=>qt(Z.partyName,q)).sort((Z,B)=>new Date(Z.date)-new Date(B.date)).map(Z=>(_=_+Z.debit-Z.credit,{...Z,balance:_}));return h!==0?[{id:"opening",date:"",particulars:"Opening Balance",debit:h>0?h:0,credit:h<0?Math.abs(h):0,balance:h,isOpening:!0},...z]:z},[q,jn,ms]);const yo=h=>dn.filter(_=>qt(_.partyName,h)&&_.toBeBilled==="Yes"&&!_.invoiceGenerated&&_.invoiceAmount),d=h=>!h||h==="NA"?!1:dn.some(_=>_.combinationCode===h&&_.mailingSent==="Yes"),v=h=>h.invoiceType==="Combined"&&h.combinationCode!=="NA"?dn.filter(_=>_.combinationCode===h.combinationCode):[h],C=()=>{Li({party:"",billStatus:"",invoiceStatus:"",mailingStatus:"",invoiceType:"",combinationCode:"",searchText:""})},O=Object.values(vt).some(h=>h!==""),le=h=>{const _=[];return h.emailId&&_.push(h.emailId),h.additionalEmails&&h.additionalEmails.length>0&&_.push(...h.additionalEmails),_},me=(h,_)=>{!_||!_.includes("@")||Pe(z=>z.map(Z=>{if(Z.id===h){const B=Z.additionalEmails||[];if(!B.includes(_)&&_!==Z.emailId)return{...Z,additionalEmails:[...B,_]}}return Z}))},He=(h,_)=>{Pe(z=>z.map(Z=>Z.id===h?{...Z,additionalEmails:(Z.additionalEmails||[]).filter(B=>B!==_)}:Z))},tr=h=>{Br(h),Di(h.editComments||h.approvalRemarks||""),sa({particularsApproved:h.particularsApproved||!1,emailApproved:h.emailApproved||!1,invoiceTypeApproved:h.invoiceTypeApproved||!1}),xr(!0)},fn=()=>{if(!ce)return;if(!ba.particularsApproved||!ba.emailApproved||!ba.invoiceTypeApproved){alert("Please confirm all approval checkboxes before approving.");return}const h={invoiceStatus:"Approved",approvalRemarks:ia.trim()||"",editComments:"",particularsApproved:!0,emailApproved:!0,invoiceTypeApproved:!0,approvedBy:r,approvedDate:new Date().toISOString()};let _=[];ce.invoiceType==="Combined"&&ce.combinationCode!=="NA"?(_=_e.filter(j=>j.combinationCode===ce.combinationCode),Pe(j=>j.map(M=>M.combinationCode===ce.combinationCode?{...M,...h}:M))):(_=[ce],Pe(j=>j.map(M=>M.id===ce.id?{...M,...h}:M)));const z=parseFloat(ce.invoiceTotalAmount)||0,Z=_.map(j=>{var M,ae;return j.senderName||((ae=(M=j.campaignName)==null?void 0:M.split("--")[0])==null?void 0:ae.trim())}).join(", "),B=`${ce.invoiceNo} - ${Z}`;Ce(j=>[...j,{id:Date.now(),partyName:ce.partyName,date:ce.invoiceDate,particulars:"Promotional Trade Mailer",narration:B,debit:z,credit:0,type:"invoice",invoiceNo:ce.invoiceNo,combinationCode:ce.combinationCode}]);const H=ia.trim()?` | Remarks: "${ia.trim()}"`:"";Zn("approval",` Invoice ${ce.invoiceNo} has been APPROVED by Director${H} - ready for mailing`,"finance"),xr(!1),Br(null),sa({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1}),Di(""),alert(` Invoice Approved!

The invoice is now ready for mailing.`)},Ht=()=>{if(!ce)return;const h=ia.trim();ce.invoiceType==="Combined"&&ce.combinationCode!=="NA"?Pe(z=>z.map(Z=>Z.combinationCode===ce.combinationCode?{...Z,invoiceStatus:"Need Edits",editComments:h,approvalRemarks:""}:Z)):Pe(z=>z.map(Z=>Z.id===ce.id?{...Z,invoiceStatus:"Need Edits",editComments:h,approvalRemarks:""}:Z));const _=h?`: "${h}"`:"";Zn("edit",` Invoice ${ce.invoiceNo} marked as NEED EDITS by Director${_}`,"finance"),xr(!1),Br(null),Di("")},hn=h=>{Br(h);const _=parseFloat(h.invoiceTotalAmount)||0;Oi({amount:_.toFixed(2),tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),ho(!0)},An=()=>{if(!ce||!jt.amount){alert("Please enter receipt amount");return}if(ce.invoiceStatus!=="Approved"){alert("Receipt cannot be posted. Invoice must be approved first.");return}if(!ce.isHistorical&&ce.mailingSent!=="Yes"){alert("Receipt cannot be posted. Invoice must be mailed first.");return}const h=`RCP/${new Date().getFullYear()}-${String(new Date().getFullYear()+1).slice(-2)}/${Mt}`,_=parseFloat(jt.amount)||0,z=parseFloat(jt.tds)||0,Z=parseFloat(jt.discount)||0,B=_+z+Z,H=v(ce),j=H.map(Ee=>Ee.subject||Ee.senderName).join(", "),M=j.length>50?j.substring(0,47)+"...":j,ae={id:Date.now(),receiptNo:h,invoiceNo:ce.invoiceNo,partyName:ce.partyName,date:jt.date,amount:_,tds:z,discount:Z,totalCredit:B,narration:jt.narration,paymentAdvisory:jt.paymentAdvisory,mode:jt.mode,campaigns:H.map(Ee=>({senderName:Ee.senderName,subject:Ee.subject}))};W(Ee=>[...Ee,ae]);const te=jt.narration||M;_>0&&Ce(Ee=>[...Ee,{id:Date.now(),partyName:ce.partyName,date:jt.date,particulars:`Payment Received - ${te}`,narration:`${ce.invoiceNo} | ${jt.mode}`,debit:0,credit:_,type:"receipt",receiptNo:h,invoiceNo:ce.invoiceNo,paymentAdvisory:jt.paymentAdvisory}]),z>0&&Ce(Ee=>[...Ee,{id:Date.now()+1,partyName:ce.partyName,date:jt.date,particulars:"TDS Deducted",narration:`Against ${ce.invoiceNo}`,debit:0,credit:z,type:"tds",receiptNo:h,invoiceNo:ce.invoiceNo}]),Z>0&&Ce(Ee=>[...Ee,{id:Date.now()+2,partyName:ce.partyName,date:jt.date,particulars:"Discount Given",narration:`Against ${ce.invoiceNo}`,debit:0,credit:Z,type:"discount",receiptNo:h,invoiceNo:ce.invoiceNo}]);const ge=parseFloat(ce.invoiceTotalAmount)||0,de=ne.find(Ee=>Ee.invoiceNo===ce.invoiceNo),ee=de?Math.abs(parseFloat(de.totalAmount)||0):0,oe=ge-B-ee<=0;ce.invoiceType==="Combined"&&ce.combinationCode!=="NA"?Pe(Ee=>Ee.map(De=>De.combinationCode===ce.combinationCode?{...De,receiptStatus:oe?"Closed":"Received",receiptNo:h,receiptDate:jt.date}:De)):ce.isHistorical||Pe(Ee=>Ee.map(De=>De.id===ce.id?{...De,receiptStatus:oe?"Closed":"Received",receiptNo:h,receiptDate:jt.date}:De)),Et(Ee=>Ee+1),Zn("receipt",` Payment received for ${ce.partyName} - Receipt ${h} - ${et(B)}`,"director"),ho(!1),Br(null),Oi({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),alert(` Receipt Created!

Receipt No: ${h}
Amount: ${et(B)}`)},Oa=h=>{Br(h),Fa({amount:"",tds:"",discount:"",reason:"",date:new Date().toISOString().split("T")[0]}),Os(!0)},Xi=()=>{var Ee;if(!ce||!ln.amount&&!ln.gst||!ln.reason){alert("Please enter Amount and/or GST and reason");return}const h=ce.invoiceNo.match(/(\d{4}-\d{2})/),_=h?h[1]:`${new Date().getFullYear()}-${String(new Date().getFullYear()+1).slice(-2)}`,z=ce.invoiceNo.split("/").pop(),Z=`CN/${_}/${z}`,B=parseFloat(ln.amount)||0,H=parseFloat(ln.gst)||0,j=B+H,ae=((Ee=ce.statePartyDetails)==null?void 0:Ee.toUpperCase().includes("MAHARASHTRA"))?"CGST/SGST":"IGST",te={id:Date.now(),creditNoteNo:Z,invoiceNo:ce.invoiceNo,partyName:ce.partyName,date:ln.date,amount:B,gst:H,gstType:ae,totalAmount:j,reason:ln.reason};re(De=>[...De,te]);const ge=parseFloat(ce.invoiceTotalAmount)||0,de=Be.find(De=>De.invoiceNo===ce.invoiceNo),ee=de?parseFloat(de.amount)+parseFloat(de.tds||0)+parseFloat(de.discount||0):0,Ve=j>=ge-ee;ce.isHistorical||Pe(De=>De.map(Xe=>Xe.invoiceNo===ce.invoiceNo?{...Xe,creditNoteNo:Z,receiptStatus:Ve?"Cancelled":Xe.receiptStatus}:Xe)),mt(De=>De+1),Os(!1),Br(null),Fa({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]});let oe=` Credit Note Created!

Credit Note No: ${Z}`;B>0&&(oe+=`
Base Amount: ${et(B)}`),H>0&&(oe+=`
${ae}: ${et(H)}`),oe+=`
Total: ${et(j)}`,Ve&&(oe+=`

 Invoice fully covered by CN - marked as Cancelled`),alert(oe)},wc=h=>{var Z;const _=(Z=h.target.files)==null?void 0:Z[0];if(!_)return;const z=new FileReader;z.onload=B=>{Oi(H=>({...H,paymentAdvisory:B.target.result}))},z.readAsDataURL(_),h.target.value=""},_l=h=>{Br(h),xi(!0)},GF=()=>{if(!ce)return;const h=ce.invoiceNo;ce.invoiceType==="Combined"&&ce.combinationCode!=="NA"?Pe(Z=>Z.map(B=>B.combinationCode===ce.combinationCode?{...B,invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",invoiceType:"Individual",combinationCode:"NA",mailingSent:"No",mailDate:"",editComments:"",receiptStatus:"",receiptNo:"",receiptDate:""}:B)):Pe(Z=>Z.map(B=>B.id===ce.id?{...B,invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",invoiceType:"Individual",combinationCode:"NA",mailingSent:"No",mailDate:"",editComments:"",receiptStatus:"",receiptNo:"",receiptDate:""}:B)),Ce(Z=>Z.filter(B=>B.invoiceNo!==h));const _=Be.filter(Z=>Z.invoiceNo===h);_.length>0&&W(Z=>Z.filter(B=>B.invoiceNo!==h)),xi(!1),Br(null);const z=_.length>0?`
${_.length} receipt(s) also deleted.`:"";alert(` Invoice ${h} deleted.${z}

You can now regenerate the invoice.`)},KF=h=>{confirm(`Delete Receipt ${h.receiptNo}?

This will also update the invoice status back to Pending.`)&&(W(_=>_.filter(z=>z.id!==h.id)),Pe(_=>_.map(z=>z.invoiceNo===h.invoiceNo?{...z,receiptStatus:"",receiptNo:"",receiptDate:""}:z)),alert(` Receipt ${h.receiptNo} deleted.`))},YF=h=>{confirm(`Delete Credit Note ${h.creditNoteNo}?

This will remove the CN association from the invoice.`)&&(re(_=>_.filter(z=>z.id!==h.id)),Pe(_=>_.map(z=>z.invoiceNo===h.invoiceNo?{...z,creditNoteNo:""}:z)),alert(` Credit Note ${h.creditNoteNo} deleted.`))},XF=h=>{confirm(`Delete historical entry?

Vch No: ${h.vchNo||"N/A"}
Amount: ${h.debit||h.credit}

This action cannot be undone.`)&&(Ce(_=>_.filter(z=>z.id!==h.id)),alert(" Historical entry deleted."))},qF=()=>{if(!q||!confirm(`Delete ALL historical entries for "${q}"?

This will remove all imported historical data for this party.`))return;const h=ie.filter(_=>qt(_.partyName,q)&&_.isHistorical).length;Ce(_=>_.filter(z=>!(qt(z.partyName,q)&&z.isHistorical))),alert(` ${h} historical entries deleted for ${q}.`)},QF=h=>{us(h),ds({date:new Date().toISOString().split("T")[0],notes:"",nextFollowupDate:"",status:"Pending"}),Pi(!0)},JF=()=>{var _,z;if(!lr)return;const h={id:Date.now(),invoiceNo:lr.invoiceNo,partyName:lr.partyName,invoiceDate:lr.invoiceDate||lr.date,invoiceAmount:lr.invoiceTotalAmount||lr.totalAmount,subject:((z=(_=lr.campaigns)==null?void 0:_[0])==null?void 0:z.subject)||lr.subject||"",followupDate:Ir.date,notes:Ir.notes,nextFollowupDate:Ir.nextFollowupDate,status:Ir.status};Bt(Z=>[...Z,h]),Pi(!1),us(null),Zn("followup",`Followup added for ${lr.invoiceNo}`,"all"),alert(` Followup recorded for ${lr.invoiceNo}`)},ZF=h=>{confirm("Delete this followup entry?")&&Bt(_=>_.filter(z=>z.id!==h))},e4=h=>{var M,ae;const _=h.subject||((ae=(M=h.campaigns)==null?void 0:M[0])==null?void 0:ae.subject)||"",z=h.partyName,Z=h.invoiceNo,B=et(h.invoiceTotalAmount||h.totalAmount||0),H=At(h.invoiceDate||h.date);return`Subject: RE: ${_} - Payment Followup for Invoice ${Z}

Dear Sir/Madam,

Greetings from ${S.name}!

This is a gentle reminder regarding the outstanding payment for:

Invoice No: ${Z}
Invoice Date: ${H}
Amount: ${B}
Party: ${z}

We kindly request you to process the payment at the earliest. If the payment has already been made, please share the payment details for our records.

For any queries, please feel free to reach out.

Thanks & Regards,
Finance Team
${S.name}
Email: ${S.email}
Phone: ${S.phone}`},ly=h=>{const _=e4(h);navigator.clipboard.writeText(_),alert(" Followup email template copied to clipboard!")},cy=h=>{var Z,B;const _=h.subject||((B=(Z=h.campaigns)==null?void 0:Z[0])==null?void 0:B.subject)||"",z=encodeURIComponent(_);window.open(`https://mail.google.com/mail/u/0/#search/${z}`,"_blank")},t4=h=>{var Z;const _=(Z=h.target.files)==null?void 0:Z[0];if(!_)return;const z=new FileReader;z.onload=B=>{const H=Cl(B.target.result,{type:"binary"}),j=H.SheetNames[0],M=H.Sheets[j],ae=fr.sheet_to_json(M),te={};ae.forEach(ge=>{const de=ge["Party Name"]||ge["PARTY NAME"]||ge.PartyName||"",ee=parseFloat(ge.Amount||ge.AMOUNT||ge["Invoice Amount"]||0);de&&ee>0&&(te[de.trim()]=ee)}),ps(ge=>({...ge,...te})),alert(` Loaded ${Object.keys(te).length} party invoice values!`)},z.readAsBinaryString(_),h.target.value=""},r4=()=>{const h=fr.json_to_sheet([{"Party Name":"ABC Group Private Limited",Amount:5500},{"Party Name":"XYZ Media Pvt Ltd",Amount:7500}]),_=fr.book_new();fr.book_append_sheet(_,h,"Invoice Values"),bc(_,"Invoice_Values_Template.xlsx")},n4=h=>{var Z;const _=(Z=h.target.files)==null?void 0:Z[0];if(!_)return;const z=new FileReader;z.onload=B=>{const H=Cl(B.target.result,{type:"binary"}),j=H.SheetNames[0],M=H.Sheets[j],ae=fr.sheet_to_json(M),te={...un};let ge=0;ae.forEach(de=>{const ee=(de["Name of Ledger"]||de["Party Name"]||de["NAME OF LEDGER"]||de["PARTY NAME"]||"").trim(),Ve=(de["State Name"]||de["STATE NAME"]||de.State||de.STATE||"").trim(),oe=(de.Address||de.ADDRESS||de["Party Address"]||de["PARTY ADDRESS"]||"").trim();if(ee){const Ee=_i(Ve),De=`${ee.toUpperCase()}|${Ee}`;te[De]={partyName:ee,partyNameUpper:ee.toUpperCase(),ledgerGroup:de["Ledger Group"]||de["LEDGER GROUP"]||"Sundry Debtors",stateName:Ve,normalizedState:Ee,gstRegType:de["GST Registration Type"]||de["GST REGISTRATION TYPE"]||"Regular",gstin:(de["GSTIN/UIN"]||de.GSTIN||de.GST||"").trim(),address:oe},ge++}}),pl(te),alert(` Party Master Updated!

${ge} party-state combinations loaded.`)},z.readAsBinaryString(_),h.target.value=""},i4=()=>{const h=fr.json_to_sheet([{"Sl. No.":1,"Name of Ledger":"ABC PRIVATE LIMITED",Address:"123 Business Park, Andheri East","Ledger Group":"Sundry Debtors","State Name":"Maharashtra","GST Registration Type":"Regular","GSTIN/UIN":"27AAACA1234A1ZQ"},{"Sl. No.":2,"Name of Ledger":"XYZ MEDIA PVT LTD",Address:"456 Media Tower, Connaught Place","Ledger Group":"Sundry Debtors","State Name":"Delhi","GST Registration Type":"Regular","GSTIN/UIN":"07AAACX5678B1ZR"}]),_=fr.book_new();fr.book_append_sheet(_,h,"Party Master"),bc(_,"Party_Master_Template.xlsx")},s4=h=>{var Z;const _=(Z=h.target.files)==null?void 0:Z[0];if(!_)return;if(!q){alert(" Please select a party first from the list, then import their historical ledger."),h.target.value="";return}const z=new FileReader;z.onload=B=>{const H=Cl(B.target.result,{type:"binary",cellDates:!0}),j=H.SheetNames[0],M=H.Sheets[j],ae=fr.sheet_to_json(M,{raw:!1}),te=[];let ge=0,de=null;const ee=oe=>{if(!oe)return 0;const Ee=String(oe).replace(/,/g,"").replace(/[^\d.-]/g,"");return parseFloat(Ee)||0},Ve=oe=>{if(!oe||typeof oe!="string")return"";const Ee=oe.trim(),De=Ee.split(/[-\/]/);if(De.length===3){const Xe={jan:"01",feb:"02",mar:"03",apr:"04",may:"05",jun:"06",jul:"07",aug:"08",sep:"09",oct:"10",nov:"11",dec:"12"},Je=De[1].toLowerCase().substring(0,3);if(Xe[Je]){const ot=De[0].padStart(2,"0");return`${De[2].length===2?parseInt(De[2])>50?"19"+De[2]:"20"+De[2]:De[2]}-${Xe[Je]}-${ot}`}}return Ee};ae.forEach((oe,Ee)=>{const De=Ve(oe.Date||oe.DATE||oe.date||""),Xe=(oe.Particular||oe.PARTICULAR||oe.Particulars||oe.PARTICULARS||"").trim(),Je=(oe["Vch Type"]||oe["VCH TYPE"]||oe["Voucher Type"]||oe["vch type"]||"").trim(),ot=(oe["Vch No."]||oe["VCH NO."]||oe["Voucher No"]||oe["Invoice No"]||oe["Vch No"]||oe["vch no."]||"").trim(),xt=ee(oe.Debit||oe.DEBIT||oe.debit),Le=ee(oe.Credit||oe.CREDIT||oe.credit),rt=oe["Date of Receipt"]||oe["DATE OF RECEIPT"]||oe["Receipt Date"]||"",Dt=ee(oe["Amount Received"]||oe["AMOUNT RECEIVED"]||oe["amount received"]),Tt=ee(oe["TDS amount Received"]||oe["TDS Received"]||oe.TDS||oe.tds),It=ee(oe.Balance||oe.BALANCE||oe.balance),oa=(oe["Payment Status"]||oe["PAYMENT STATUS"]||oe.Status||oe.status||"").trim();if(!De&&(Xe.toUpperCase().includes("PROMOTIONAL")||Xe.toUpperCase().includes("IGST")||Xe.toUpperCase().includes("CGST")||Xe.toUpperCase().includes("SGST")||Xe.toUpperCase().includes("TRADE EMAILER"))&&de)de.subRows||(de.subRows=[]),de.subRows.push({particular:Xe,debit:xt,credit:Le});else if(De&&(ot||xt>0||Le>0)){de&&(te.push(de),ge++);let Fe="invoice";Je.toLowerCase().includes("credit note")||ot.toUpperCase().startsWith("CN")?Fe="creditnote":Je.toLowerCase().includes("receipt")?Fe="receipt":(Je.toLowerCase().includes("sale")||xt>0)&&(Fe="invoice"),de={id:Date.now()+Ee,partyName:q,date:De,particulars:Xe||q,narration:ot,vchType:Je||"Sales",vchNo:ot,debit:xt,credit:Le,receiptDate:rt,amountReceived:Dt,tdsReceived:Tt,balance:It,paymentStatus:oa,type:Fe,isHistorical:!0,subRows:[]}}}),de&&(te.push(de),ge++),console.log("Parsed entries with sub-rows:",te),ge>0?(Ce(oe=>[...oe,...te]),alert(` Historical Ledger Uploaded!

${ge} entries added for "${q}".`)):alert(` No valid ledger entries found in the file.

Make sure your file has these columns:
 Date (e.g., 02-Jun-21)
 Vch Type (e.g., Sales, Credit Note)
 Vch No. (e.g., MB/2022-23/128)
 Debit or Credit amount`)},z.readAsBinaryString(_),h.target.value="",Us(!1)},a4=()=>{const h=fr.json_to_sheet([{Date:"02-Jun-21",Particular:"ABC Corp Ltd.","Vch Type":"Sales","Vch No.":"MB/2020-21/0411",Debit:6e3,Credit:"","Date of Receipt":"","Amount Received":44371,"TDS amount Received":5880,Balance:"","Payment Status":"Received"},{Date:"",Particular:"PROMOTIONAL TRADE EMAILERS","Vch Type":"","Vch No.":"",Debit:"",Credit:22500,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""},{Date:"",Particular:"IGST","Vch Type":"","Vch No.":"",Debit:"",Credit:4050,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""},{Date:"26-Mar-25",Particular:"ABC Corp Ltd.","Vch Type":"Credit Note","Vch No.":"CN/2022-23/128",Debit:"",Credit:26550,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""}]),_=fr.book_new();fr.book_append_sheet(_,h,"Historical Ledger"),bc(_,"Historical_Ledger_Template.xlsx")},o4=h=>{const _=_e.find(z=>z.invoiceNo===h);_?Ku(_):alert("Invoice not found in system. This may be a historical entry.")},l4=h=>{_e.find(z=>z.invoiceNo===h.invoiceNo);let _=` RECEIPT DETAILS

`;_+=`Receipt No: ${h.receiptNo}
`,_+=`Date: ${At(h.date)}
`,_+=`Party: ${h.partyName}
`,_+=`Invoice: ${h.invoiceNo}

`,_+=`
`,_+=`Amount Received: ${et(h.amount||0)}
`,_+=`TDS: ${et(h.tds||0)}
`,_+=`Discount: ${et(h.discount||0)}
`,_+=`
`,_+=`Total: ${et((h.amount||0)+(h.tds||0)+(h.discount||0))}
`,h.remarks&&(_+=`
Remarks: ${h.remarks}`),alert(_)},c4=h=>{let _=` CREDIT NOTE DETAILS

`;_+=`Credit Note No: ${h.creditNoteNo}
`,_+=`Date: ${At(h.date)}
`,_+=`Party: ${h.partyName}
`,_+=`Against Invoice: ${h.invoiceNo}

`,_+=`
`,_+=`Base Amount: ${et(h.amount||0)}
`,_+=`${h.gstType||"GST"}: ${et(h.gst||0)}
`,_+=`
`,_+=`Total Credit: ${et(h.totalAmount||(h.amount||0)+(h.gst||0))}
`,h.reason&&(_+=`
Reason: ${h.reason}`),alert(_)},u4=h=>{var Z;const _=(Z=h.target.files)==null?void 0:Z[0];if(!_)return;const z=new FileReader;z.onload=B=>{const H=Cl(B.target.result,{type:"binary",cellDates:!0}),j=H.SheetNames[0],M=H.Sheets[j],ae=fr.sheet_to_json(M,{raw:!1}),te=new Set(dn.map(oe=>`${oe.date}|${oe.time||""}|${oe.campaignName||""}|${oe.subject}`.toLowerCase()));let ge=0,de=0;const ee=ae.map((oe,Ee)=>{const De=oe["CAMPAIGN NAME"]||oe["Campaign Name"]||"",Xe=dw(De);let Je=oe.DATE||oe.Date||new Date;typeof Je=="string"&&(Je=new Date(Je));const ot=(oe["PARTY NAME"]||oe["Party Name"]||"").trim(),xt=oe["SENDER NAME"]||oe["Sender Name"]||"",Le=oe.SUBJECT||oe.Subject||"",rt=oe.TIME||oe.Time||"",Dt=yi[ot]||"",Tt=Je instanceof Date&&!isNaN(Je)?Je.toISOString().split("T")[0]:"",It=`${Tt}|${rt}|${De}|${Le}`.toLowerCase();return te.has(It)?(ge++,null):(te.add(It),de++,{id:Date.now()+Ee+Math.random(),sno:oe.SNO||oe["SNO."]||oe.Sno||Ee+1,date:Tt,month:oe.Month||oe.MONTH||"",statePartyDetails:oe["State/Party Details"]||oe["STATE/PARTY DETAILS"]||"",partyName:ot,senderName:xt,campaignName:De,subject:Le,emailId:Xe,additionalEmails:[],toBeBilled:"Not Yet",invoiceAmount:Dt,cgst:"",sgst:"",igst:"",totalWithGst:"",invoiceType:"Individual",combinationCode:"NA",invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",mailingSent:"No",mailerUploaded:!1,editComments:""})}).filter(oe=>oe!==null);if(ee.length>0){Pe(Ee=>[...Ee,...ee]);const oe=[...new Set(ee.map(Ee=>Ee.partyName))];zu(Ee=>{const De=new Set(Ee);return oe.forEach(Xe=>De.add(Xe)),De})}let Ve=` Upload Complete!

`;Ve+=` ${de} new campaigns added
`,ge>0&&(Ve+=` ${ge} duplicate entries skipped`),de>0&&Zn("upload",` ${de} new campaigns uploaded to Master Sheet`,"director"),alert(Ve)},z.readAsBinaryString(_),h.target.value=""},d4=async()=>{Pe([]),Te([]),Ce([]),W([]),re([]),po({}),gc({}),Ae(1),J(1),Et(1),mt(1),or(1),xe(null),je(null),zu(new Set),Bt([]),pl({}),Re([]);try{await cm("indreesh-media",{masterData:[],servicesData:[],ledgerEntries:[],receipts:[],creditNotes:[],openingBalances:{},mailerImages:{},mailerLogo:Ut,companyConfig:S,nextInvoiceNo:1,nextCombineNo:1,nextReceiptNo:1,nextCreditNoteNo:1,nextServiceInvoiceNo:1,invoiceValues:yi,notifications:[],whatsappSettings:st,partyMaster:{},followups:[],userPasswords:y}),console.log("Data cleared and saved to Firebase")}catch(h){console.error("Error clearing data:",h)}Ms(!1),alert(" All master data, invoices, receipts, and ledger entries have been cleared!")},uy=h=>{var Z;const _=parseFloat(h.invoiceAmount)||0;if((Z=h.statePartyDetails)==null?void 0:Z.toUpperCase().includes("MAHARASHTRA")){const B=_*.09,H=_*.09;return{cgst:B,sgst:H,igst:0,total:_+B+H}}else{const B=_*.18;return{cgst:0,sgst:0,igst:B,total:_+B}}},f4=(h,_)=>{const z=_e.find(Z=>Z.id===h);Pe(Z=>Z.map(B=>{if(B.id===h){if(_==="Yes"&&B.invoiceAmount){const H=uy(B);return{...B,toBeBilled:_,cgst:H.cgst.toFixed(2),sgst:H.sgst.toFixed(2),igst:H.igst.toFixed(2),totalWithGst:H.total.toFixed(2)}}return{...B,toBeBilled:_}}return B})),_==="Yes"&&z&&Zn("info",` Campaign marked for billing: ${z.partyName} - ${z.senderName}`,"finance")},a0=(h,_,z)=>{Pe(Z=>Z.map(B=>{if(B.id===h){const H={...B,[_]:z};if(_==="invoiceAmount"&&B.toBeBilled==="Yes"){const j=uy(H);return{...H,cgst:j.cgst.toFixed(2),sgst:j.sgst.toFixed(2),igst:j.igst.toFixed(2),totalWithGst:j.total.toFixed(2)}}return H}return B}))},h4=h=>{const _=`${S.invoicePrefix}${Ie}`,z=new Date().toISOString().split("T")[0],Z=parseFloat(h.totalWithGst)||parseFloat(h.invoiceAmount)*1.18;Pe(B=>B.map(H=>H.id===h.id?{...H,invoiceNo:_,invoiceDate:z,invoiceTotalAmount:Z.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created",invoiceType:"Individual",combinationCode:"NA"}:H)),Ae(B=>B+1),Zn("invoice",` New Invoice ${_} created for ${h.partyName} - ${et(Z)}`,"director"),alert(` Invoice Generated!

Invoice No: ${_}
Amount: ${et(Z)}

Please review and Approve or mark as Need Edits.`)},p4=()=>{if(cn.size<2){alert("Please select at least 2 campaigns to combine");return}const h=`${S.invoicePrefix}${Ie}`,_=new Date().toISOString().split("T")[0],z=String(nt);let Z=0;const B=_e.filter(H=>cn.has(H.id));B.forEach(H=>{Z+=parseFloat(H.totalWithGst)||parseFloat(H.invoiceAmount)*1.18}),Pe(H=>H.map(j=>cn.has(j.id)?{...j,invoiceNo:h,invoiceDate:_,invoiceTotalAmount:Z.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created",invoiceType:"Combined",combinationCode:z,mailingSent:"No"}:j)),Ae(H=>H+1),J(H=>H+1),gr(!1),aa(new Set),Zn("invoice",` Combined Invoice ${h} created for ${pc} (${B.length} campaigns) - ${et(Z)}`,"director"),js(null),alert(` Combined Invoice Generated!

Invoice No: ${h}
Campaigns: ${cn.size}
Total: ${et(Z)}

Please review and Approve or mark as Need Edits.`)},g4=h=>{aa(_=>{const z=new Set(_);return z.has(h)?z.delete(h):z.add(h),z})},m4=h=>{js(h.partyName),aa(new Set([h.id])),gr(!0)},x4=h=>{var Z;const _=(Z=h.target.files)==null?void 0:Z[0];if(!_||!ce)return;const z=new FileReader;z.onload=B=>dy(B.target.result),z.readAsDataURL(_),h.target.value=""},dy=h=>{if(!ce)return;const _=ce.id;po(Vu?z=>({...z,[_]:[h]}):z=>({...z,[_]:[...z[_]||[],h]})),Pe(z=>z.map(Z=>Z.id===ce.id?{...Z,mailerUploaded:!0}:Z)),hs(null),hl(!1),sn(!1),alert(" Mailer image saved!")},v4=h=>{var z;const _=(z=h.clipboardData)==null?void 0:z.items;if(_){for(let Z=0;Z<_.length;Z++)if(_[Z].type.indexOf("image")!==-1){const B=_[Z].getAsFile(),H=new FileReader;H.onload=j=>hs(j.target.result),H.readAsDataURL(B),h.preventDefault();break}}},y4=h=>{const _=encodeURIComponent(h||"campaign");window.open(`https://mail.google.com/mail/u/0/#search/${_}`,"_blank")},_4=h=>{var Z;const _=(Z=h.target.files)==null?void 0:Z[0];if(!_)return;const z=new FileReader;z.onload=B=>Ia(B.target.result),z.readAsDataURL(_),h.target.value=""},fy=h=>{const _=v(h);if(_.length>1){const z=_.map(Z=>Z.senderName).join(", ");return`Invoice ${h.invoiceNo||""} - ${z}`}return`Invoice ${h.invoiceNo||""} - ${h.senderName} - ${h.subject}`},o0=h=>{const _=v(h),z=parseFloat(h.invoiceTotalAmount)||parseFloat(h.totalWithGst)||parseFloat(h.invoiceAmount)*1.18;let Z="";return _.length>1?(Z=`Campaigns included in this invoice:
`,_.forEach((B,H)=>{Z+=`${H+1}. ${B.senderName} - ${B.subject}
`})):Z=`Campaign: ${h.senderName}
Subject: ${h.subject}`,`Dear Sir/Madam,

Please find attached the invoice for the following:

${Z}

Invoice No: ${h.invoiceNo||"To be generated"}
Invoice Amount: ${et(z)}

Kindly process the payment at your earliest convenience.

Bank Details:
Bank: ${S.bank.name}
A/C No: ${S.bank.account}
IFSC: ${S.bank.ifsc}
Branch: ${S.bank.branch}

Thank you for your business.

Best Regards,
${S.name}
${S.email}`},[E4,hy]=ve.useState(!1),[py,gy]=ve.useState(""),my=h=>{var oe;let _=[h],z=parseFloat(h.invoiceAmount)||0;h.invoiceType==="Combined"&&h.combinationCode!=="NA"&&(_=_e.filter(Ee=>Ee.combinationCode===h.combinationCode),z=_.reduce((Ee,De)=>Ee+(parseFloat(De.invoiceAmount)||0),0));const Z=xo(h.partyName,h.statePartyDetails),B=vl(h.partyName,h.statePartyDetails),H=(oe=h.statePartyDetails)==null?void 0:oe.toUpperCase().includes("MAHARASHTRA"),j=H?z*.09:0,M=H?z*.09:0,ae=H?0:z*.18,te=j+M+ae,ge=z+te,de=_.map((Ee,De)=>`
      <tr>
        <td style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px;">${De+1}</td>
        <td style="border: 1px solid #000; padding: 8px; font-size: 12px;">
          <div style="font-weight: 600;">PROMOTIONAL TRADE EMAILER</div>
          <div style="font-style: italic; color: #555; font-size: 11px; margin-top: 2px;">${Ee.senderName||""} - ${At(Ee.date)}</div>
          <div style="font-style: italic; color: #555; font-size: 11px;">Subject: ${Ee.subject||""}</div>
        </td>
        <td style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px;">${S.hsnCode}</td>
        <td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${zt(parseFloat(Ee.invoiceAmount)||0)}</td>
      </tr>
    `).join("");let ee=[];h.invoiceType==="Combined"&&h.combinationCode!=="NA"?_.forEach(Ee=>{(Bn[Ee.id]||[]).forEach(Xe=>ee.push({img:Xe,campaign:Ee}))}):(Bn[h.id]||[]).forEach(De=>ee.push({img:De,campaign:h}));const Ve=ee.map(({img:Ee,campaign:De})=>`
      <div class="page-break-before" style="page-break-before: always; padding: 40px; text-align: center; background: white;">
        ${Ut?`<div style="margin-bottom: 20px;"><img src="${Ut}" alt="Logo" style="max-height: 70px;" /></div>`:`
          <div style="text-align: center; margin-bottom: 25px;">
            <span style="font-size: 22px; font-weight: bold; color: #2874A6;">${S.name}</span>
          </div>
        `}
        <h2 style="font-size: 20px; text-decoration: underline; margin: 25px 0;">MAILER SUPPORTING</h2>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>MAILER DATE:</strong> ${TH(De.date)}</p>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>CAMPAIGN:</strong> ${De.senderName}</p>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>SUBJECT:</strong> ${De.subject||"Campaign"}</p>
        <div style="margin-top: 25px;"><img src="${Ee}" alt="Mailer" style="max-width: 100%; max-height: 550px; border: 1px solid #ddd;" /></div>
      </div>
    `).join("");return`
  <div style="max-width: 900px; margin: 0 auto; padding: 15px; background: white; font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4;">
    <style>
      @media print {
        @page { size: A4; margin: 8mm; }
        body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        .page-break-before { page-break-before: always; }
      }
    </style>
    <div style="border: 2px solid #000; background: white;">
      <div style="text-align: center; padding: 12px; font-size: 18px; font-weight: bold; border-bottom: 2px solid #000; background: #f8f8f8;">Tax Invoice</div>
      <div style="text-align: center; font-size: 11px; font-style: italic; padding: 5px; border-bottom: 1px solid #000; background: #fafafa;">(Original for Recipient)</div>
      <div style="display: flex; border-bottom: 2px solid #000;">
        <div style="flex: 1.5; padding: 12px; border-right: 2px solid #000;">
          <div style="font-size: 16px; font-weight: bold; margin-bottom: 8px; color: #1a5276;">${S.name}</div>
          <div style="font-size: 11px; line-height: 1.5; color: #333;">${S.address}<br>${S.addressLine2}<br>${S.city}<br><strong>GSTIN/UIN:</strong> ${S.gstin}<br><strong>State:</strong> ${S.stateName}, Code: ${S.stateCode}<br><strong>Contact:</strong> ${S.phone}<br><strong>E-Mail:</strong> ${S.email}</div>
        </div>
        <div style="flex: 1; font-size: 12px;">
          <div style="display: flex; border-bottom: 1px solid #000;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Invoice No.</div><div style="flex: 1; padding: 8px; font-weight: 600; color: #1a5276;">${h.invoiceNo||""}</div></div>
          <div style="display: flex;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Dated</div><div style="flex: 1; padding: 8px;">${At(h.invoiceDate||h.date)}</div></div>
        </div>
      </div>
      <div style="padding: 10px 12px; border-bottom: 2px solid #000; background: #fafafa;">
        <div style="font-size: 11px; color: #666; margin-bottom: 3px;">Buyer (Bill to)</div>
        <div style="font-size: 14px; font-weight: bold; margin-bottom: 4px; color: #1a5276;">${h.partyName}</div>
        <div style="font-size: 11px; color: #333;">${B?B+"<br>":""}${h.statePartyDetails||""}${Z?"<br><strong>GSTIN/UIN:</strong> "+Z:""}<br>Place of Supply: ${h.statePartyDetails||S.stateName}</div>
      </div>
      <table style="width: 100%; border-collapse: collapse;">
        <thead><tr style="background: #e8e8e8;"><th style="border: 1px solid #000; padding: 10px; width: 45px; font-size: 12px;">Sl No.</th><th style="border: 1px solid #000; padding: 10px; font-size: 12px;">Particulars</th><th style="border: 1px solid #000; padding: 10px; width: 80px; font-size: 12px;">HSN/SAC</th><th style="border: 1px solid #000; padding: 10px; width: 100px; text-align: right; font-size: 12px;">Amount</th></tr></thead>
        <tbody>
          ${de}
          ${_.length>1?'<tr style="background: #f5f5f5;"><td colspan="3" style="border: 1px solid #000; padding: 10px; text-align: right; font-weight: bold; font-size: 13px;">Sub Total</td><td style="border: 1px solid #000; padding: 10px; text-align: right; font-weight: bold; font-size: 13px;">'+zt(z)+"</td></tr>":""}
          ${H?`<tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">CGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${zt(j)}</td></tr><tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">SGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${zt(M)}</td></tr>`:`<tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">IGST @ 18%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${zt(ae)}</td></tr>`}
          <tr style="background: #2874A6; color: white;"><td colspan="3" style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;">Total</td><td style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;"> ${ge.toLocaleString("en-IN",{minimumFractionDigits:2})}</td></tr>
        </tbody>
      </table>
      <div style="padding: 10px 12px; border: 1px solid #000; border-top: none; background: #fafafa;"><div style="color: #666; font-size: 11px; margin-bottom: 3px;">Amount Chargeable (in words)</div><div style="font-weight: bold; font-size: 13px;">${Y0(ge)}</div></div>
      <div style="display: flex; border-top: 2px solid #000;">
        <div style="flex: 1; padding: 10px 12px; border-right: 2px solid #000; font-size: 11px;"><div><strong>Company's PAN:</strong> ${S.pan}</div><div style="margin-top: 4px;"><strong>MSME Reg. No.:</strong> UDYAM-MH-19-0057219</div></div>
        <div style="flex: 1.2; padding: 10px 12px; font-size: 11px;">
          <div style="font-weight: bold; margin-bottom: 6px; color: #1a5276;">Company's Bank Details</div>
          <div style="line-height: 1.5;"><strong>A/c Holder:</strong> ${S.bank.holder}<br><strong>Bank:</strong> ${S.bank.name}<br><strong>A/c No.:</strong> ${S.bank.account}<br><strong>IFSC:</strong> ${S.bank.ifsc}</div>
          <div style="text-align: right; margin-top: 30px;"><div style="font-weight: bold;">for ${S.name}</div><div style="margin-top: 25px; border-top: 1px solid #000; display: inline-block; padding-top: 4px; font-size: 10px;">Authorised Signatory</div></div>
        </div>
      </div>
      <div style="text-align: center; padding: 8px; background: #f0f0f0; border-top: 1px solid #000; font-size: 10px; color: #666; font-style: italic;">This is a Computer Generated Invoice</div>
    </div>
  </div>
  ${Ve}
`},w4=h=>{const _=my(h);gy(_),Br(h),hy(!0)},S4=h=>{const _=`<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Invoice ${h.invoiceNo||""}</title>
  <style>
    @page { size: A4; margin: 10mm; }
    @media print { body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } }
    body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }
  </style>
</head>
<body>
${my(h)}
<script>
  // Auto-open print dialog when file is opened
  window.onload = function() { 
    setTimeout(function() { window.print(); }, 500); 
  };
<\/script>
</body>
</html>`,z=new Blob([_],{type:"text/html"}),Z=URL.createObjectURL(z),B=document.createElement("a");B.href=Z,B.download=`Invoice_${(h.invoiceNo||"draft").replace(/\//g,"-")}.html`,document.body.appendChild(B),B.click(),document.body.removeChild(B),URL.revokeObjectURL(Z)},Ku=h=>{w4(h)},T4=()=>{const h=parseFloat(Tr.amount)||0,_=parseFloat(Tr.tds)||0,z=parseFloat(Tr.discount)||0,Z=h+_+z;let B=parseFloat(ce.invoiceTotalAmount)||parseFloat(ce.totalWithGst)||parseFloat(ce.invoiceAmount)*1.18;const H=Z>=B?"Paid":"Partially Paid";ce.invoiceType==="Combined"&&ce.combinationCode!=="NA"?Pe(M=>M.map(ae=>ae.combinationCode===ce.combinationCode?{...ae,invoiceStatus:H}:ae)):Pe(M=>M.map(ae=>ae.id===ce.id?{...ae,invoiceStatus:H}:ae));const j=[];h>0&&j.push({id:Date.now(),partyName:ce.partyName,date:Tr.date,particulars:Tr.narration?`Payment Received - ${Tr.mode} (${Tr.narration})`:`Payment Received - ${Tr.mode}`,debit:0,credit:h,type:"payment"}),_>0&&j.push({id:Date.now()+1,partyName:ce.partyName,date:Tr.date,particulars:`TDS Deducted - Inv: ${ce.invoiceNo}`,debit:0,credit:_,type:"tds"}),z>0&&j.push({id:Date.now()+2,partyName:ce.partyName,date:Tr.date,particulars:`Discount Allowed - Inv: ${ce.invoiceNo}`,debit:0,credit:z,type:"discount"}),Ce(M=>[...M,...j]),Hr(!1),Br(null)},xy=h=>{zu(_=>{const z=new Set(_);return z.has(h)?z.delete(h):z.add(h),z})},A4=()=>{const z=r==="director"?[{id:"master",icon:J2,label:"Master Sheet"},{id:"services",icon:Xg,label:"Services Sheet"},{id:"invoices",icon:nd,label:"Invoice Register"},{id:"receipts",icon:wl,label:"Receipt Register"},{id:"ledgers",icon:Y2,label:"Party Ledgers"},{id:"followups",icon:V0,label:"Followups"},{id:"reports",icon:G2,label:"Reports"}]:[{id:"master",icon:J2,label:"Master Sheet"},{id:"services",icon:Xg,label:"Services Sheet"},{id:"invoices",icon:nd,label:"Invoice Register"},{id:"receipts",icon:wl,label:"Receipt Register"},{id:"ledgers",icon:Y2,label:"Party Ledgers"},{id:"followups",icon:V0,label:"Followups"},{id:"reports",icon:G2,label:"Reports"},{id:"settings",icon:Lj,label:"Settings"}];return c.jsxs("div",{style:{width:N?"60px":"220px",backgroundColor:"#1E293B",color:"#FFFFFF",display:"flex",flexDirection:"column",transition:"width 0.2s ease",flexShrink:0},children:[c.jsxs("div",{style:{padding:N?"12px":"16px",borderBottom:"1px solid #334155",display:"flex",alignItems:"center",justifyContent:N?"center":"space-between"},children:[!N&&c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[c.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"32px",height:"auto",borderRadius:"4px",backgroundColor:"white",padding:"2px"}}),c.jsxs("div",{children:[c.jsx("div",{style:{fontSize:"16px",fontWeight:"700"},children:"FinMate"}),c.jsx("div",{style:{fontSize:"10px",color:"#94A3B8"},children:r==="director"?"Director View":"Finance Team"})]})]}),c.jsx("button",{onClick:()=>$e(!N),style:{background:"none",border:"none",color:"#94A3B8",cursor:"pointer",padding:"4px"},children:N?c.jsx(B0,{size:18}):c.jsx(Ij,{size:18})})]}),!N&&c.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #334155",fontSize:"11px"},children:f?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#FCD34D"},children:[c.jsx(X2,{size:12,style:{animation:"spin 1s linear infinite"}}),c.jsx("span",{children:"Saving..."})]}):g?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#86EFAC"},children:[c.jsx(Gg,{size:12}),c.jsxs("span",{children:["Saved ",g.toLocaleTimeString()]})]}):c.jsx("div",{style:{color:"#94A3B8"},children:"Cloud Sync Active"})}),c.jsx("div",{style:{padding:"8px",borderBottom:"1px solid #334155"},children:c.jsxs("button",{onClick:()=>ct(!0),style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:N?"12px":"11px 14px",borderRadius:"8px",border:"none",backgroundColor:Un>0?"#FEF3C7":"#334155",color:Un>0?"#92400E":"#94A3B8",cursor:"pointer",fontSize:"14px",fontWeight:Un>0?"700":"500",justifyContent:N?"center":"flex-start",position:"relative"},title:"Notifications",children:[Un>0?c.jsx(Cj,{size:18}):c.jsx(K2,{size:18}),!N&&c.jsx("span",{children:"Notifications"}),Un>0&&c.jsx("span",{style:{position:N?"absolute":"static",top:N?"4px":"auto",right:N?"4px":"auto",marginLeft:N?"0":"auto",backgroundColor:"#DC2626",color:"#FFFFFF",padding:"2px 6px",borderRadius:"10px",fontSize:"11px",fontWeight:"700",minWidth:"18px",textAlign:"center"},children:Un})]})}),c.jsx("nav",{style:{flex:1,padding:"8px"},children:z.map(Z=>c.jsxs("button",{onClick:()=>D(Z.id),style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:N?"12px":"11px 14px",marginBottom:"4px",borderRadius:"8px",border:"none",backgroundColor:R===Z.id?"#2874A6":"transparent",color:R===Z.id?"#FFFFFF":"#94A3B8",cursor:"pointer",fontSize:"14px",fontWeight:R===Z.id?"600":"500",justifyContent:N?"center":"flex-start"},title:Z.label,children:[c.jsx(Z.icon,{size:18}),!N&&c.jsx("span",{children:Z.label})]},Z.id))}),c.jsxs("div",{style:{padding:"8px",borderTop:"1px solid #334155"},children:[c.jsxs("button",{onClick:()=>{E(!0),Y({currentPassword:"",newPassword:"",confirmPassword:""}),T("")},style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:N?"12px":"11px 14px",marginBottom:"8px",borderRadius:"8px",border:"none",backgroundColor:"#475569",color:"#FFFFFF",cursor:"pointer",fontSize:"14px",fontWeight:"500",justifyContent:N?"center":"flex-start"},title:"Change Password",children:[c.jsx(U0,{size:18}),!N&&c.jsx("span",{children:"Change Password"})]}),c.jsxs("button",{onClick:s0,style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:N?"12px":"11px 14px",borderRadius:"8px",border:"none",backgroundColor:"#DC2626",color:"#FFFFFF",cursor:"pointer",fontSize:"14px",fontWeight:"600",justifyContent:N?"center":"flex-start"},title:"Logout",children:[c.jsx(Ma,{size:18}),!N&&c.jsx("span",{children:"Logout"})]})]})]})},k4=()=>c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(id,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"})]}),c.jsxs("div",{style:{position:"relative"},children:[c.jsx(z0,{size:15,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",placeholder:"Search...",value:vt.searchText,onChange:h=>Li(_=>({..._,searchText:h.target.value})),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"160px"}})]}),c.jsxs("select",{value:vt.party,onChange:h=>Li(_=>({..._,party:h.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:vt.party?"#EFF6FF":"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Parties"}),Tn.map(h=>c.jsx("option",{value:h,children:h},h))]}),c.jsxs("select",{value:vt.billStatus,onChange:h=>Li(_=>({..._,billStatus:h.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:vt.billStatus?"#EFF6FF":"#FFFFFF"},children:[c.jsx("option",{value:"",children:"Bill Status"}),c.jsx("option",{value:"Yes",children:"Yes"}),c.jsx("option",{value:"Not Yet",children:"Not Yet"})]}),c.jsxs("select",{value:vt.invoiceStatus,onChange:h=>Li(_=>({..._,invoiceStatus:h.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:vt.invoiceStatus?"#EFF6FF":"#FFFFFF"},children:[c.jsx("option",{value:"",children:"Invoice Status"}),c.jsx("option",{value:"Generated",children:"Generated"}),c.jsx("option",{value:"Not Generated",children:"Not Generated"}),c.jsx("option",{value:"Paid",children:"Paid"})]}),O&&c.jsxs(c.Fragment,{children:[c.jsxs("button",{onClick:C,style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(Ma,{size:14})," Clear"]}),c.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",Ec.length," of ",_e.length]})]})]})}),vy=()=>{const h=_e.filter(j=>j.toBeBilled==="Yes"&&j.invoiceGenerated&&j.mailingSent==="Yes"&&(j.receiptStatus==="Received"||j.receiptStatus==="Cancelled"||j.receiptStatus==="Closed")),_=_e.filter(j=>!(j.toBeBilled==="Yes"&&j.invoiceGenerated&&j.mailingSent==="Yes"&&(j.receiptStatus==="Received"||j.receiptStatus==="Cancelled"||j.receiptStatus==="Closed"))),z=on==="open"?_:h,Z=z.filter(j=>{var M,ae,te,ge,de;if(vt.party&&j.partyName!==vt.party||vt.billStatus&&j.toBeBilled!==vt.billStatus||vt.invoiceType&&j.invoiceType!==vt.invoiceType||vt.mailingStatus&&(vt.mailingStatus==="Sent"&&j.mailingSent!=="Yes"||vt.mailingStatus==="Not Sent"&&j.mailingSent==="Yes")||vt.invoiceStatus&&(vt.invoiceStatus==="Generated"&&!j.invoiceGenerated||vt.invoiceStatus==="Not Generated"&&j.invoiceGenerated||vt.invoiceStatus==="Approved"&&j.invoiceStatus!=="Approved"||vt.invoiceStatus==="Need Edits"&&j.invoiceStatus!=="Need Edits"||vt.invoiceStatus==="Paid"&&j.invoiceStatus!=="Paid"))return!1;if(vt.searchText){const ee=vt.searchText.toLowerCase();if(!((M=j.partyName)!=null&&M.toLowerCase().includes(ee))&&!((ae=j.senderName)!=null&&ae.toLowerCase().includes(ee))&&!((te=j.campaignName)!=null&&te.toLowerCase().includes(ee))&&!((ge=j.subject)!=null&&ge.toLowerCase().includes(ee))&&!((de=j.invoiceNo)!=null&&de.toLowerCase().includes(ee)))return!1}return!0}),B=Z.reduce((j,M)=>{const ae=M.partyName||"Unknown";return j[ae]||(j[ae]=[]),j[ae].push(M),j},{}),H=Object.keys(B).sort();return c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsxs("div",{children:[c.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Master Sheet"}),c.jsxs("p",{style:{margin:"4px 0 0",fontSize:"14px",color:"#64748B"},children:[_e.length," campaigns  ",Tn.length," parties  ",_e.filter(j=>j.invoiceGenerated).length," invoiced"]})]}),c.jsxs("div",{style:{display:"flex",gap:"10px"},children:[c.jsx("input",{type:"file",ref:gl,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:u4}),c.jsx(qe,{icon:Hs,label:"Upload Data",variant:"brand",onClick:()=>{var j;return(j=gl.current)==null?void 0:j.click()}}),dr&&_e.length>0&&c.jsx(qe,{icon:Ws,label:"Clear All Data",variant:"danger",onClick:()=>Ms(!0)})]})]}),c.jsxs("div",{style:{display:"flex",gap:"4px",marginBottom:"16px",backgroundColor:"#F1F5F9",padding:"4px",borderRadius:"10px",width:"fit-content"},children:[c.jsxs("button",{onClick:()=>hc("open"),style:{padding:"10px 20px",fontSize:"14px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:on==="open"?"#FFFFFF":"transparent",color:on==="open"?"#1E293B":"#64748B",boxShadow:on==="open"?"0 2px 4px rgba(0,0,0,0.1)":"none"},children:[" Open Invoices (",_.length,")"]}),c.jsxs("button",{onClick:()=>hc("closed"),style:{padding:"10px 20px",fontSize:"14px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:on==="closed"?"#FFFFFF":"transparent",color:on==="closed"?"#1E293B":"#64748B",boxShadow:on==="closed"?"0 2px 4px rgba(0,0,0,0.1)":"none"},children:[" Closed Invoices (",h.length,")"]})]}),_e.length>0&&k4(),H.length===0?c.jsx(Zr,{children:c.jsxs("div",{style:{padding:"60px",textAlign:"center",color:"#94A3B8"},children:[c.jsx(Hs,{size:48,style:{marginBottom:"16px",opacity:.5}}),c.jsx("div",{style:{fontSize:"18px",fontWeight:"600"},children:O?"No matching records":on==="closed"?"No closed invoices yet":"No Data Yet"}),c.jsx("div",{style:{fontSize:"14px",marginTop:"4px"},children:O?"Try adjusting your filters":on==="closed"?"Invoices will appear here once billed, mailed, and payment received":"Upload an Excel file to get started"})]})}):c.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:H.map(j=>{const M=B[j],ae=Zf.has(j),te=M.filter(ee=>ee.toBeBilled==="Yes").length,ge=M.filter(ee=>ee.invoiceGenerated).length,de=M.filter(ee=>ee.toBeBilled==="Yes").reduce((ee,Ve)=>ee+(parseFloat(Ve.totalWithGst)||0),0);return c.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:[c.jsxs("div",{onClick:()=>xy(j),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",backgroundColor:on==="closed"?"#F0FDF4":"#F8FAFC",cursor:"pointer",borderBottom:ae?"3px solid #2874A6":"none"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[ae?c.jsx(Kg,{size:22,color:"#2874A6"}):c.jsx(B0,{size:22,color:"#64748B"}),c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"700",fontSize:"16px",color:"#1E293B"},children:j}),c.jsxs("div",{style:{fontSize:"13px",color:"#64748B",marginTop:"3px"},children:[M.length," campaigns  ",te," billed  ",ge," invoiced"]})]})]}),de>0&&c.jsxs("div",{style:{textAlign:"right"},children:[c.jsx("div",{style:{fontSize:"11px",color:"#64748B",textTransform:"uppercase"},children:"Total"}),c.jsx("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:et(de)})]})]}),ae&&c.jsx("div",{style:{overflowX:"auto"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px",minWidth:"2100px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F1F5F9"},children:[c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Date"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"100px"},children:"Sender"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",minWidth:"180px"},children:"Campaign / Subject"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"160px"},children:"Email ID"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"70px"},children:"Mailer"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"80px"},children:"Bill?"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"right",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Amount"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Type"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Generate"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"110px"},children:"Invoice No."}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"90px"},children:"Inv Date"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"right",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"100px"},children:"Inv Amount"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#7C3AED",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"50px"},children:"C#"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"120px"},children:"Status/Approve"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"120px"},children:"Actions"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#059669",borderBottom:"2px solid #E2E8F0",backgroundColor:"#F0FDF4",width:"80px"},children:"Mailed?"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#059669",borderBottom:"2px solid #E2E8F0",backgroundColor:"#F0FDF4",width:"90px"},children:"Mail Date"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#7C3AED",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"100px"},children:"Receipt"})]})}),c.jsx("tbody",{children:M.map(ee=>{var Ee,De;const Ve=ee.invoiceType==="Combined"&&d(ee.combinationCode)&&ee.mailingSent!=="Yes";le(ee);const oe=Bn[ee.id]&&Bn[ee.id].length>0;return c.jsxs("tr",{style:{backgroundColor:ee.toBeBilled==="Yes"?ee.invoiceGenerated?"#F0FDF4":"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #F1F5F9"},children:[c.jsx("td",{style:{padding:"12px 14px",whiteSpace:"nowrap",fontSize:"13px"},children:At(ee.date)}),c.jsx("td",{style:{padding:"12px 14px",fontWeight:"600",fontSize:"13px"},children:ee.senderName}),c.jsxs("td",{style:{padding:"12px 14px"},children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",lineHeight:"1.4",color:"#1E293B"},children:((De=(Ee=ee.campaignName)==null?void 0:Ee.split("--")[0])==null?void 0:De.trim())||ee.senderName}),ee.subject&&c.jsx("div",{style:{fontSize:"12px",color:"#64748B",marginTop:"4px",lineHeight:"1.3"},children:ee.subject})]}),c.jsx("td",{style:{padding:"10px 14px"},children:c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[ee.emailId&&c.jsx("div",{style:{fontSize:"11px",color:"#1E40AF",backgroundColor:"#EFF6FF",padding:"2px 6px",borderRadius:"4px",display:"inline-block"},children:ee.emailId}),(ee.additionalEmails||[]).map((Xe,Je)=>c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[c.jsx("span",{style:{fontSize:"11px",color:"#059669",backgroundColor:"#F0FDF4",padding:"2px 6px",borderRadius:"4px"},children:Xe}),c.jsx("button",{onClick:()=>He(ee.id,Xe),style:{background:"none",border:"none",cursor:"pointer",padding:"2px",color:"#DC2626"},title:"Remove",children:c.jsx(Ma,{size:12})})]},Je)),c.jsxs("button",{onClick:()=>{Br(ee),na(""),ft(!0)},style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",color:"#2874A6",background:"none",border:"none",cursor:"pointer",padding:"2px 0"},children:[c.jsx(q2,{size:12})," Add"]})]})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:oe?c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[c.jsx("span",{style:{color:"#22C55E",fontWeight:"700",fontSize:"14px"},children:""}),c.jsx("button",{onClick:()=>{Br(ee),hs(null),hl(!0),sn(!0)},style:{fontSize:"10px",color:"#64748B",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},children:"Replace"})]}):c.jsx(qe,{icon:bj,small:!0,variant:"default",onClick:()=>{Br(ee),hs(null),hl(!1),sn(!0)}})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:c.jsxs("select",{value:ee.toBeBilled,onChange:Xe=>f4(ee.id,Xe.target.value),disabled:ee.invoiceGenerated||!Sn,style:{padding:"6px 8px",fontSize:"12px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:ee.toBeBilled==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:ee.toBeBilled==="Yes"?"#DCFCE7":"#FFFFFF",color:ee.toBeBilled==="Yes"?"#166534":"#64748B",cursor:ee.invoiceGenerated||!Sn?"not-allowed":"pointer",width:"70px",opacity:!Sn&&!ee.invoiceGenerated?.6:1},children:[c.jsx("option",{value:"Not Yet",children:"Not Yet"}),c.jsx("option",{value:"Yes",children:"Yes"})]})}),c.jsx("td",{style:{padding:"10px 14px"},children:c.jsx("input",{type:"number",value:ee.invoiceAmount||"",onChange:Xe=>a0(ee.id,"invoiceAmount",Xe.target.value),disabled:ee.invoiceGenerated,placeholder:"0",style:{width:"80px",padding:"6px 8px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #D1D5DB",borderRadius:"6px",textAlign:"right",backgroundColor:ee.invoiceGenerated?"#F3F4F6":"#FFFFFF"}})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:ee.invoiceGenerated?c.jsx(X0,{status:ee.invoiceType,small:!0}):ee.toBeBilled==="Yes"?c.jsxs("select",{value:ee.invoiceType||"Individual",onChange:Xe=>a0(ee.id,"invoiceType",Xe.target.value),style:{padding:"6px 6px",fontSize:"11px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:ee.invoiceType==="Combined"?"#7C3AED":"#A5B4FC",backgroundColor:ee.invoiceType==="Combined"?"#F3E8FF":"#E0E7FF",color:ee.invoiceType==="Combined"?"#6B21A8":"#3730A3",cursor:"pointer",width:"80px"},children:[c.jsx("option",{value:"Individual",children:"Individual"}),c.jsx("option",{value:"Combined",children:"Combined"})]}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:ee.toBeBilled==="Yes"&&!ee.invoiceGenerated&&ee.invoiceAmount&&dr?ee.invoiceType==="Individual"?c.jsx(qe,{icon:wl,label:"Create",small:!0,variant:"warning",onClick:()=>h4(ee)}):c.jsx(qe,{icon:Dj,label:"Combine",small:!0,variant:"purple",onClick:()=>m4(ee)}):ee.toBeBilled==="Yes"&&!ee.invoiceGenerated&&ee.invoiceAmount&&Sn?c.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Finance to create"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF"},children:ee.invoiceNo?c.jsx("span",{style:{fontWeight:"700",color:"#1E40AF",fontSize:"12px"},children:ee.invoiceNo}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF",fontSize:"12px"},children:ee.invoiceDate?At(ee.invoiceDate):"-"}),c.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF",textAlign:"right",fontWeight:"700",color:"#1E40AF",fontSize:"13px"},children:ee.invoiceTotalAmount?zt(ee.invoiceTotalAmount):"-"}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:ee.combinationCode&&ee.combinationCode!=="NA"?c.jsx("span",{style:{fontWeight:"700",color:"#7C3AED",fontSize:"12px"},children:ee.combinationCode}):"-"}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:ee.invoiceGenerated?Sn?c.jsx("button",{onClick:()=>tr(ee),style:{padding:"5px 10px",fontSize:"11px",fontWeight:"700",border:"1.5px solid",borderRadius:"6px",cursor:"pointer",backgroundColor:ee.invoiceStatus==="Approved"?"#DCFCE7":ee.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",borderColor:ee.invoiceStatus==="Approved"?"#22C55E":ee.invoiceStatus==="Need Edits"?"#DC2626":"#F59E0B",color:ee.invoiceStatus==="Approved"?"#166534":ee.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:ee.invoiceStatus==="Approved"?" Approved":ee.invoiceStatus==="Need Edits"?" Need Edits":" Review"}):c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px"},children:[c.jsx("span",{style:{padding:"4px 10px",fontSize:"11px",fontWeight:"700",borderRadius:"6px",backgroundColor:ee.invoiceStatus==="Approved"?"#DCFCE7":ee.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",color:ee.invoiceStatus==="Approved"?"#166534":ee.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:ee.invoiceStatus==="Approved"?" Approved":ee.invoiceStatus==="Need Edits"?" Need Edits":" Pending"}),(ee.editComments||ee.approvalRemarks)&&c.jsx("button",{onClick:()=>{Br(ee),xr(!0)},style:{fontSize:"9px",color:ee.invoiceStatus==="Need Edits"?"#991B1B":"#166534",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},title:ee.editComments||ee.approvalRemarks,children:"View Remarks"})]}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:ee.invoiceGenerated&&ee.invoiceStatus==="Approved"?c.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[c.jsx(qe,{icon:j0,small:!0,onClick:()=>Ku(ee),title:"View Invoice"}),dr&&c.jsx(qe,{icon:qg,small:!0,variant:"brand",onClick:()=>{Br(ee),ls(!0)},title:"Send Email"}),dr&&c.jsx(qe,{icon:Ws,small:!0,variant:"danger",onClick:()=>_l(ee),title:"Delete"})]}):ee.invoiceGenerated?c.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[c.jsx(qe,{icon:j0,small:!0,onClick:()=>Ku(ee),title:"View Invoice"}),dr&&c.jsx(qe,{icon:Ws,small:!0,variant:"danger",onClick:()=>_l(ee),title:"Delete"})]}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#F0FDF4"},children:ee.invoiceGenerated&&ee.invoiceStatus==="Approved"&&dr?Ve?c.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Combined sent"}):c.jsxs("select",{value:ee.mailingSent||"No",onChange:Xe=>a0(ee.id,"mailingSent",Xe.target.value),style:{padding:"5px 8px",fontSize:"11px",fontWeight:"700",border:"2px solid",borderRadius:"6px",borderColor:ee.mailingSent==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:ee.mailingSent==="Yes"?"#DCFCE7":"#FFFFFF",color:ee.mailingSent==="Yes"?"#166534":"#64748B",cursor:"pointer",width:"60px"},children:[c.jsx("option",{value:"No",children:"No"}),c.jsx("option",{value:"Yes",children:"Yes"})]}):ee.invoiceGenerated&&ee.invoiceStatus==="Approved"&&Sn?c.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"11px",fontWeight:"600",backgroundColor:ee.mailingSent==="Yes"?"#DCFCE7":"#FEF3C7",color:ee.mailingSent==="Yes"?"#166534":"#92400E"},children:ee.mailingSent==="Yes"?" Yes":" No"}):ee.invoiceGenerated&&ee.invoiceStatus!=="Approved"?c.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Approve first"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#F0FDF4"},children:ee.mailingSent==="Yes"?dr?c.jsx("input",{type:"date",value:ee.mailDate||ee.invoiceDate||"",onChange:Xe=>a0(ee.id,"mailDate",Xe.target.value),style:{padding:"4px 6px",fontSize:"11px",border:"1.5px solid #D1D5DB",borderRadius:"6px",width:"100%"}}):c.jsx("span",{style:{fontSize:"11px"},children:At(ee.mailDate||ee.invoiceDate)}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:ee.receiptStatus==="Received"||ee.receiptStatus==="Closed"?c.jsxs("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"700",backgroundColor:"#DCFCE7",color:"#166534"},children:[" ",ee.receiptNo||"Received"]}):ee.receiptStatus==="Cancelled"?c.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:" Cancelled"}):ee.invoiceGenerated&&ee.invoiceStatus==="Approved"?c.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"600",backgroundColor:"#FEF3C7",color:"#92400E"},children:" Pending"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})})]},ee.id)})})]})})]},j)})}),z.length>0&&c.jsxs("div",{style:{marginTop:"16px",padding:"16px 20px",backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsxs("div",{style:{display:"flex",gap:"24px",fontSize:"14px",color:"#475569"},children:[c.jsxs("span",{children:[" Total: ",c.jsx("strong",{children:Z.length})]}),c.jsxs("span",{children:[" To Bill: ",c.jsx("strong",{children:Z.filter(j=>j.toBeBilled==="Yes").length})]}),c.jsxs("span",{children:[" Invoiced: ",c.jsx("strong",{children:Z.filter(j=>j.invoiceGenerated).length})]}),c.jsxs("span",{children:[" Approved: ",c.jsx("strong",{children:Z.filter(j=>j.invoiceStatus==="Approved").length})]}),on==="closed"&&c.jsxs("span",{children:[" Closed: ",c.jsx("strong",{children:Z.filter(j=>j.receiptStatus==="Received"||j.receiptStatus==="Cancelled"||j.receiptStatus==="Closed").length})]})]}),c.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:["Total: ",et(Z.filter(j=>j.toBeBilled==="Yes").reduce((j,M)=>j+(parseFloat(M.totalWithGst)||0),0))]})]})]})},C4=h=>{var Z;const _=(Z=h.target.files)==null?void 0:Z[0];if(!_)return;const z=new FileReader;z.onload=B=>{const H=Cl(B.target.result,{type:"binary",cellDates:!0}),j=H.SheetNames[0],M=H.Sheets[j],ae=fr.sheet_to_json(M,{raw:!1}),te=new Set(wn.map(oe=>`${oe.date}|${oe.time||""}|${oe.campaignName||""}|${oe.subject}`.toLowerCase()));let ge=0,de=0;const ee=ae.map((oe,Ee)=>{const De=oe["CAMPAIGN NAME"]||oe["Campaign Name"]||oe["SERVICE TYPE"]||oe["Service Type"]||"",Xe=dw(De);let Je=oe.DATE||oe.Date||new Date;typeof Je=="string"&&(Je=new Date(Je));const ot=(oe["PARTY NAME"]||oe["Party Name"]||"").trim(),xt=oe["SENDER NAME"]||oe["Sender Name"]||"",Le=oe.SUBJECT||oe.Subject||oe.DESCRIPTION||oe.Description||"",rt=oe.TIME||oe.Time||"",Dt=yi[ot]||"",Tt=Je instanceof Date&&!isNaN(Je)?Je.toISOString().split("T")[0]:"",It=`${Tt}|${rt}|${De}|${Le}`.toLowerCase();return te.has(It)?(ge++,null):(te.add(It),de++,{id:Date.now()+Ee+Math.random(),sno:oe.SNO||oe["SNO."]||oe.Sno||Ee+1,date:Tt,month:oe.Month||oe.MONTH||"",time:rt,statePartyDetails:oe["State/Party Details"]||oe["STATE/PARTY DETAILS"]||oe.STATE||oe.State||"",partyName:ot,senderName:xt,campaignName:De,subject:Le,emailId:Xe||oe.EMAIL||oe.Email||"",additionalEmails:[],toBeBilled:"Not Yet",invoiceAmount:oe.AMOUNT||oe.Amount||Dt||"",cgst:"",sgst:"",igst:"",totalWithGst:"",invoiceType:"Individual",combinationCode:"NA",invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",mailingSent:"No",mailerUploaded:!1,editComments:"",isService:!0})}).filter(oe=>oe!==null);if(ee.length>0){Te(Ee=>{const De=[...Ee,...ee];return console.log("Services data updated:",De.length,"entries"),De});const oe=[...new Set(ee.map(Ee=>Ee.partyName))];ue(Ee=>{const De=new Set(Ee);return oe.forEach(Xe=>De.add(Xe)),De}),setTimeout(()=>{console.log("Triggering immediate save for services data..."),Pa()},500)}let Ve=` Services Upload Complete!

`;Ve+=` ${de} new entries added
`,ge>0&&(Ve+=` ${ge} duplicate entries skipped`),de>0&&Zn("upload",` ${de} new services uploaded`,"director"),alert(Ve)},z.readAsBinaryString(_),h.target.value=""},yy=(h,_,z)=>{Te(Z=>Z.map(B=>B.id===h?{...B,[_]:z}:B))},F4=h=>{ue(_=>{const z=new Set(_);return z.has(h)?z.delete(h):z.add(h),z})},b4=h=>{const _=be.find(z=>z.id===h);if(_!=null&&_.invoiceGenerated&&(_==null?void 0:_.invoiceStatus)==="Approved"){alert("Cannot delete approved invoices");return}confirm("Delete this service entry?")&&Te(z=>z.filter(Z=>Z.id!==h))},I4=h=>{var ge;const _=be.find(de=>de.id===h);if(!_)return;if(!_.invoiceAmount||parseFloat(_.invoiceAmount)<=0){alert("Please enter a valid invoice amount");return}const z=`${S.invoicePrefix}${Ge}`,Z=new Date().toISOString().split("T")[0],B=(ge=_.statePartyDetails)==null?void 0:ge.toUpperCase().includes("MAHARASHTRA"),H=parseFloat(_.invoiceAmount),j=B?H*.09:0,M=B?H*.09:0,ae=B?0:H*.18,te=H+j+M+ae;Te(de=>de.map(ee=>ee.id===h?{...ee,invoiceNo:z,invoiceDate:Z,invoiceTotalAmount:te.toFixed(2),cgst:j.toFixed(2),sgst:M.toFixed(2),igst:ae.toFixed(2),totalWithGst:te.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created"}:ee)),or(de=>de+1),Zn("invoice_created",`Service Invoice ${z} created for ${_.partyName}`,"director")},_y=(h,_,z="")=>{_==="approve"?(Te(Z=>Z.map(B=>B.id===h.id?{...B,invoiceStatus:"Approved",directorRemarks:z||null}:B)),Zn("invoice_approved",`Service Invoice ${h.invoiceNo} approved`,"finance")):_==="needsEdit"&&(Te(Z=>Z.map(B=>B.id===h.id?{...B,invoiceStatus:"Need Edits",directorRemarks:z}:B)),Zn("invoice_needs_edit",`Service Invoice ${h.invoiceNo}: ${z}`,"finance"))},Ey=h=>{const _=getPartyGstinFromMaster(h.partyName,h.statePartyDetails),z=vl(h.partyName,h.statePartyDetails),Z=h.statePartyDetails,B=parseFloat(h.invoiceAmount)||0,H=parseFloat(h.cgst)||0,j=parseFloat(h.sgst)||0,M=parseFloat(h.igst)||0,ae=parseFloat(h.invoiceTotalAmount)||B+H+j+M,te=H>0,ge=`
<!DOCTYPE html>
<html>
<head>
  <title>Tax Invoice - ${h.invoiceNo}</title>
  <style>
    @media print { body { -webkit-print-color-adjust: exact !important; } @page { size: A4; margin: 10mm; } }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; font-size: 12px; }
    .invoice-container { max-width: 800px; margin: 0 auto; border: 2px solid #000; }
  </style>
</head>
<body>
  <div class="invoice-container">
    <div style="text-align: center; padding: 15px; border-bottom: 2px solid #000; font-size: 20px; font-weight: bold;">Tax Invoice</div>
    <div style="text-align: center; padding: 5px; border-bottom: 1px solid #000; font-style: italic; font-size: 11px; background: #f5f5f5;">(Original for Recipient)</div>
    <div style="display: flex; border-bottom: 2px solid #000;">
      <div style="flex: 1.5; padding: 12px; border-right: 2px solid #000;">
        <div style="font-size: 16px; font-weight: bold; color: #1a5276; margin-bottom: 8px;">${S.name}</div>
        <div style="font-size: 11px; line-height: 1.5;">${S.address}<br>${S.addressLine2}, ${S.city}<br><strong>GSTIN/UIN:</strong> ${S.gstin}<br><strong>State:</strong> ${S.stateName}, Code: ${S.stateCode}<br><strong>Contact:</strong> ${S.phone}<br><strong>E-Mail:</strong> ${S.email}</div>
      </div>
      <div style="flex: 1; padding: 0;">
        <div style="display: flex; border-bottom: 1px solid #000;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Invoice No.</div><div style="flex: 1; padding: 8px; color: #1a5276; font-weight: bold;">${h.invoiceNo}</div></div>
        <div style="display: flex;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Dated</div><div style="flex: 1; padding: 8px;">${At(h.invoiceDate)}</div></div>
      </div>
    </div>
    <div style="padding: 10px 12px; border-bottom: 2px solid #000; background: #fafafa;">
      <div style="font-size: 11px; color: #666; margin-bottom: 3px;">Buyer (Bill to)</div>
      <div style="font-size: 14px; font-weight: bold; margin-bottom: 4px; color: #1a5276;">${h.partyName}</div>
      <div style="font-size: 11px; color: #333;">${z?z+"<br>":""}${Z||""}${_?"<br><strong>GSTIN/UIN:</strong> "+_:""}<br>Place of Supply: ${Z||S.stateName}</div>
    </div>
    <table style="width: 100%; border-collapse: collapse;">
      <thead><tr style="background: #e8e8e8;"><th style="border: 1px solid #000; padding: 10px; width: 45px;">Sl No.</th><th style="border: 1px solid #000; padding: 10px;">Particulars</th><th style="border: 1px solid #000; padding: 10px; width: 80px;">HSN/SAC</th><th style="border: 1px solid #000; padding: 10px; width: 100px; text-align: right;">Amount</th></tr></thead>
      <tbody>
        <tr>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">1</td>
          <td style="border: 1px solid #000; padding: 8px;">
            <div style="font-weight: 600;">${(h.campaignName||"SERVICE").toUpperCase()}</div>
            <div style="font-style: italic; color: #555; font-size: 11px; margin-top: 2px;">${h.subject||""}</div>
            <div style="font-style: italic; color: #555; font-size: 11px;">Date: ${At(h.date)}</div>
          </td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${S.hsnCode}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: right;">${zt(B)}</td>
        </tr>
        ${te?`
          <tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600;">CGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right;">${zt(H)}</td></tr>
          <tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600;">SGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right;">${zt(j)}</td></tr>
        `:`
          <tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600;">IGST @ 18%</td><td style="border: 1px solid #000; padding: 8px; text-align: right;">${zt(M)}</td></tr>
        `}
        <tr style="background: #2874A6; color: white;"><td colspan="3" style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;">Total</td><td style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;"> ${ae.toLocaleString("en-IN",{minimumFractionDigits:2})}</td></tr>
      </tbody>
    </table>
    <div style="padding: 10px 12px; border: 1px solid #000; border-top: none; background: #fafafa;"><div style="color: #666; font-size: 11px; margin-bottom: 3px;">Amount Chargeable (in words)</div><div style="font-weight: bold; font-size: 13px;">${Y0(ae)}</div></div>
    <div style="display: flex; border-top: 2px solid #000;">
      <div style="flex: 1; padding: 10px 12px; border-right: 2px solid #000; font-size: 11px;"><div><strong>Company's PAN:</strong> ${S.pan}</div><div style="margin-top: 4px;"><strong>MSME Reg. No.:</strong> UDYAM-MH-19-0057219</div></div>
      <div style="flex: 1.2; padding: 10px 12px; font-size: 11px;">
        <div style="font-weight: bold; margin-bottom: 6px; color: #1a5276;">Company's Bank Details</div>
        <div style="line-height: 1.5;"><strong>A/c Holder:</strong> ${S.bank.holder}<br><strong>Bank:</strong> ${S.bank.name}<br><strong>A/c No.:</strong> ${S.bank.account}<br><strong>IFSC:</strong> ${S.bank.ifsc}</div>
        <div style="text-align: right; margin-top: 30px;"><div style="font-weight: bold;">for ${S.name}</div><div style="margin-top: 25px; border-top: 1px solid #000; display: inline-block; padding-top: 4px; font-size: 10px;">Authorised Signatory</div></div>
      </div>
    </div>
    <div style="text-align: center; padding: 8px; background: #f0f0f0; border-top: 1px solid #000; font-size: 10px; color: #666; font-style: italic;">This is a Computer Generated Invoice</div>
  </div>
</body>
</html>`,de=window.open("","_blank");de.document.write(ge),de.document.close(),de.print()},N4=ve.useMemo(()=>[...new Set(wn.map(h=>h.partyName).filter(Boolean))].sort(),[wn]),sg=ve.useMemo(()=>wn.filter(h=>!(pe.party&&h.partyName!==pe.party||pe.billStatus&&h.toBeBilled!==pe.billStatus||pe.invoiceStatus&&(pe.invoiceStatus==="Pending"&&h.invoiceGenerated||pe.invoiceStatus==="Created"&&h.invoiceStatus!=="Created"||pe.invoiceStatus==="Approved"&&h.invoiceStatus!=="Approved"||pe.invoiceStatus==="Need Edits"&&h.invoiceStatus!=="Need Edits"))),[wn,pe]),R4=()=>{const h=r==="director",_=r==="finance";console.log("Services Render Debug:",{servicesDataType:typeof be,servicesDataIsArray:Array.isArray(be),servicesDataLength:be==null?void 0:be.length,safeServicesDataLength:wn.length,filteredServicesDataLength:sg.length,role:r,serviceFilters:pe,servicesSheetTab:Ki,rawServicesData:be});const z=sg.filter(M=>!M.invoiceGenerated||M.invoiceStatus!=="Approved"),Z=sg.filter(M=>M.invoiceGenerated&&M.invoiceStatus==="Approved"),B=Ki==="open"?z:Z;console.log("Services Tab Data:",{openCount:z.length,closedCount:Z.length,currentTab:Ki});const H={};B.forEach(M=>{const ae=M.partyName||"Unknown";H[ae]||(H[ae]=[]),H[ae].push(M)});const j=Object.keys(H).sort();if(h&&j.length>0&&Q.size===0){const M=new Set(j);ue(M)}return c.jsxs("div",{style:{padding:"20px"},children:[c.jsx("input",{type:"file",ref:ml,onChange:C4,accept:".xlsx,.xls,.csv",style:{display:"none"}}),c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[c.jsxs("div",{children:[c.jsx("h1",{style:{fontSize:"22px",fontWeight:"700",color:"#1E293B",marginBottom:"4px"},children:" Services Sheet"}),c.jsxs("p",{style:{fontSize:"13px",color:"#64748B"},children:["Non-campaign invoices  Total: ",wn.length," entries"]})]}),c.jsx("div",{style:{display:"flex",gap:"10px"},children:_&&c.jsxs(c.Fragment,{children:[c.jsx(qe,{icon:Hs,label:"Upload Excel",onClick:()=>{var M;return(M=ml.current)==null?void 0:M.click()}}),c.jsx(qe,{icon:sd,label:"Add Entry",variant:"primary",onClick:()=>L(!0)})]})})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsx(id,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"}),c.jsxs("select",{value:pe.party,onChange:M=>fe(ae=>({...ae,party:M.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"},children:[c.jsx("option",{value:"",children:"All Parties"}),N4.map(M=>c.jsx("option",{value:M,children:M},M))]}),c.jsxs("select",{value:pe.billStatus,onChange:M=>fe(ae=>({...ae,billStatus:M.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"},children:[c.jsx("option",{value:"",children:"All Bill Status"}),c.jsx("option",{value:"Yes",children:"To Be Billed"}),c.jsx("option",{value:"No",children:"Not Billing"}),c.jsx("option",{value:"Not Yet",children:"Not Yet"})]}),c.jsxs("select",{value:pe.invoiceStatus,onChange:M=>fe(ae=>({...ae,invoiceStatus:M.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"},children:[c.jsx("option",{value:"",children:"All Invoice Status"}),c.jsx("option",{value:"Pending",children:"Pending"}),c.jsx("option",{value:"Created",children:"Created"}),c.jsx("option",{value:"Approved",children:"Approved"}),c.jsx("option",{value:"Need Edits",children:"Need Edits"})]}),(pe.party||pe.billStatus||pe.invoiceStatus)&&c.jsxs("button",{onClick:()=>fe({party:"",billStatus:"",invoiceStatus:""}),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer"},children:[c.jsx(Ma,{size:14})," Clear"]})]})}),c.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"20px",justifyContent:"space-between",alignItems:"center"},children:[c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsxs("button",{onClick:()=>b("open"),style:{padding:"10px 20px",fontSize:"13px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:Ki==="open"?"#2874A6":"#E2E8F0",color:Ki==="open"?"#FFFFFF":"#64748B"},children:["Open (",z.length,")"]}),c.jsxs("button",{onClick:()=>b("closed"),style:{padding:"10px 20px",fontSize:"13px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:Ki==="closed"?"#22C55E":"#E2E8F0",color:Ki==="closed"?"#FFFFFF":"#64748B"},children:["Closed (",Z.length,")"]})]}),c.jsx("button",{onClick:()=>{Q.size===j.length?ue(new Set):ue(new Set(j))},style:{padding:"8px 16px",fontSize:"12px",fontWeight:"600",border:"1px solid #CBD5E1",borderRadius:"6px",cursor:"pointer",backgroundColor:"#F8FAFC",color:"#475569"},children:Q.size===j.length?"Collapse All":"Expand All"})]}),c.jsx(Zr,{title:`Services - ${Ki==="open"?"Open":"Closed"}`,noPadding:!0,children:j.length===0?c.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:[c.jsx(Xg,{size:40,style:{marginBottom:"10px",opacity:.5}}),c.jsx("p",{children:"No services in this tab"}),_&&c.jsx("p",{style:{marginTop:"10px",fontSize:"13px"},children:"Upload Excel or Add Entry to get started"})]}):j.map(M=>{const ae=H[M],te=Q.has(M),ge=ae.filter(de=>de.toBeBilled==="Yes").reduce((de,ee)=>de+(parseFloat(ee.totalWithGst)||parseFloat(ee.invoiceAmount)||0),0);return c.jsxs("div",{style:{borderBottom:"2px solid #E2E8F0"},children:[c.jsxs("div",{onClick:()=>F4(M),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",backgroundColor:Ki==="closed"?"#F0FDF4":"#F8FAFC",cursor:"pointer",borderBottom:te?"3px solid #2874A6":"none"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[te?c.jsx(Kg,{size:20,color:"#2874A6"}):c.jsx(B0,{size:20,color:"#64748B"}),c.jsx("span",{style:{fontWeight:"700",fontSize:"15px",color:"#1E293B"},children:M}),c.jsxs("span",{style:{padding:"4px 10px",backgroundColor:"#E0E7FF",color:"#3730A3",borderRadius:"9999px",fontSize:"12px",fontWeight:"600"},children:[ae.length," items"]})]}),c.jsx("div",{style:{fontWeight:"700",color:"#059669"},children:et(ge)})]}),te&&c.jsx("div",{style:{overflowX:"auto"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F1F5F9"},children:[c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569"},children:"Date"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569"},children:"State"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569"},children:"Sender"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569"},children:"Campaign/Service"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569"},children:"Subject"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"To Bill"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"600",color:"#475569"},children:"Amount"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"Invoice"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"Status"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"Actions"})]})}),c.jsx("tbody",{children:ae.map(de=>c.jsxs("tr",{style:{backgroundColor:de.toBeBilled==="Yes"?de.invoiceGenerated?"#F0FDF4":"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #F1F5F9"},children:[c.jsx("td",{style:{padding:"10px 8px"},children:At(de.date)}),c.jsx("td",{style:{padding:"10px 8px",fontSize:"11px",color:"#64748B"},children:de.statePartyDetails||"-"}),c.jsx("td",{style:{padding:"10px 8px",fontSize:"11px"},children:de.senderName||"-"}),c.jsx("td",{style:{padding:"10px 8px",fontWeight:"500",maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis"},children:de.campaignName||"-"}),c.jsx("td",{style:{padding:"10px 8px",maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis"},children:de.subject||"-"}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:c.jsx("button",{onClick:()=>h&&!de.invoiceGenerated&&yy(de.id,"toBeBilled",de.toBeBilled==="Yes"?"No":"Yes"),disabled:de.invoiceGenerated||!h,style:{padding:"6px 8px",fontSize:"12px",fontWeight:"600",border:"2px solid",borderRadius:"6px",cursor:de.invoiceGenerated||!h?"not-allowed":"pointer",borderColor:de.toBeBilled==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:de.toBeBilled==="Yes"?"#DCFCE7":"#FFFFFF",color:de.toBeBilled==="Yes"?"#166534":"#64748B",width:"70px"},children:de.toBeBilled||"Not Yet"})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"right"},children:de.invoiceGenerated?c.jsxs("span",{style:{fontWeight:"600"},children:["",parseFloat(de.invoiceAmount||0).toLocaleString("en-IN")]}):c.jsx("input",{type:"number",value:de.invoiceAmount||"",onChange:ee=>yy(de.id,"invoiceAmount",ee.target.value),disabled:de.invoiceGenerated,placeholder:"0",style:{width:"80px",padding:"6px",fontSize:"12px",border:"1.5px solid #E2E8F0",borderRadius:"6px",textAlign:"right"}})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:de.invoiceGenerated?c.jsx("span",{style:{fontSize:"11px",color:"#2874A6",fontWeight:"600",cursor:"pointer"},onClick:()=>Ey(de),children:de.invoiceNo}):_&&de.toBeBilled==="Yes"&&de.invoiceAmount?c.jsx("button",{onClick:()=>I4(de.id),style:{padding:"6px 10px",fontSize:"11px",backgroundColor:"#2874A6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Generate"}):"-"}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:de.invoiceGenerated?c.jsx(X0,{status:de.invoiceStatus,small:!0}):"-"}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:c.jsxs("div",{style:{display:"flex",gap:"4px",justifyContent:"center"},children:[h&&de.invoiceGenerated&&de.invoiceStatus==="Created"&&c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:()=>_y(de,"approve"),style:{padding:"6px 8px",backgroundColor:"#22C55E",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},title:"Approve",children:c.jsx(Gg,{size:14})}),c.jsx("button",{onClick:()=>{const ee=prompt("Remarks:");ee&&_y(de,"needsEdit",ee)},style:{padding:"6px 8px",backgroundColor:"#F59E0B",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},title:"Need Edits",children:c.jsx(Oj,{size:14})})]}),_&&!de.invoiceGenerated&&c.jsx("button",{onClick:()=>b4(de.id),style:{padding:"6px 8px",backgroundColor:"#EF4444",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},title:"Delete",children:c.jsx(Ws,{size:14})}),de.invoiceGenerated&&c.jsx("button",{onClick:()=>Ey(de),style:{padding:"6px 8px",backgroundColor:"#2874A6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},title:"Print",children:c.jsx(Qg,{size:14})})]})})]},de.id))})]})})]},M)})}),B.length>0&&c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"16px"},children:c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"16px 24px",borderRadius:"10px",border:"2px solid #86EFAC"},children:[c.jsx("div",{style:{fontSize:"12px",color:"#166534",fontWeight:"600",marginBottom:"4px"},children:"To Be Billed Total"}),c.jsx("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:et(B.filter(M=>M.toBeBilled==="Yes").reduce((M,ae)=>M+(parseFloat(ae.totalWithGst)||parseFloat(ae.invoiceAmount)||0),0))})]})}),c.jsx(In,{isOpen:G,onClose:()=>L(!1),title:" Add Service Entry",width:"700px",children:c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"12px"},children:[c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Date *"}),c.jsx("input",{type:"date",id:"svcDate",defaultValue:new Date().toISOString().split("T")[0],style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Time"}),c.jsx("input",{type:"text",id:"svcTime",placeholder:"HH:MM",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"State"}),c.jsx("input",{type:"text",id:"svcState",placeholder:"Maharashtra",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Party Name *"}),c.jsx("input",{list:"svcPartyList",id:"svcParty",placeholder:"Party name",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}}),c.jsx("datalist",{id:"svcPartyList",children:Object.values(un).map((M,ae)=>c.jsx("option",{value:M.partyName},ae))})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Sender Name"}),c.jsx("input",{type:"text",id:"svcSender",placeholder:"Sender",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Campaign Name / Service Type *"}),c.jsx("input",{type:"text",id:"svcCampaign",placeholder:"e.g. Podcast Production, Video Editing",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Subject / Description *"}),c.jsx("textarea",{id:"svcSubject",rows:2,placeholder:"Description",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Email"}),c.jsx("input",{type:"email",id:"svcEmail",placeholder:"email@example.com",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Amount (without GST)"}),c.jsx("input",{type:"number",id:"svcAmount",placeholder:"0",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]})]}),c.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"8px"},children:[c.jsx(qe,{label:"Cancel",variant:"secondary",onClick:()=>L(!1)}),c.jsx(qe,{label:"Add Entry",icon:sd,onClick:()=>{var de,ee,Ve,oe,Ee,De,Xe,Je,ot,xt,Le,rt;const M=(ee=(de=document.getElementById("svcParty"))==null?void 0:de.value)==null?void 0:ee.trim(),ae=(oe=(Ve=document.getElementById("svcCampaign"))==null?void 0:Ve.value)==null?void 0:oe.trim(),te=(De=(Ee=document.getElementById("svcSubject"))==null?void 0:Ee.value)==null?void 0:De.trim();if(!M||!ae||!te){alert("Fill required fields");return}const ge={id:Date.now().toString(),sno:wn.length+1,date:((Xe=document.getElementById("svcDate"))==null?void 0:Xe.value)||new Date().toISOString().split("T")[0],time:((Je=document.getElementById("svcTime"))==null?void 0:Je.value)||"",month:"",statePartyDetails:((ot=document.getElementById("svcState"))==null?void 0:ot.value)||"",partyName:M,senderName:((xt=document.getElementById("svcSender"))==null?void 0:xt.value)||"",campaignName:ae,subject:te,emailId:((Le=document.getElementById("svcEmail"))==null?void 0:Le.value)||"",additionalEmails:[],toBeBilled:"Not Yet",invoiceAmount:((rt=document.getElementById("svcAmount"))==null?void 0:rt.value)||"",cgst:"",sgst:"",igst:"",totalWithGst:"",invoiceType:"Individual",combinationCode:"NA",invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",mailingSent:"No",mailerUploaded:!1,editComments:"",isService:!0};Te(Dt=>[...Dt,ge]),ue(Dt=>new Set([...Dt,M])),L(!1)}})]})]})})]})},D4=h=>{const _=[],z=ae=>{if(!ae)return"";const te=ae.split("/");return te.length>=3?te.slice(1).join("/"):te.length===2?te.join("/"):te[te.length-1]},Z=jn.filter(ae=>{var te;return ae.isHistorical&&(ae.type==="creditnote"||((te=ae.vchNo)==null?void 0:te.toUpperCase().startsWith("CN")))}),B=new Map;Bi.forEach(ae=>{const te=z(ae.invoiceNo);te&&B.set(te,{...ae,isSystemCN:!0})}),Z.forEach(ae=>{const te=z(ae.vchNo);te&&!B.has(te)&&B.set(te,{...ae,isHistoricalCN:!0})});const H={};h.forEach(ae=>{const te=ae.partyName||"Unknown";H[te]||(H[te]=[]),H[te].push(ae)}),Object.keys(H).sort().forEach(ae=>{H[ae].forEach(ge=>{const de=z(ge.invoiceNo),ee=B.get(de),Ve=ee?Math.abs(parseFloat(ee.totalAmount||ee.credit||ee.debit)||0):0,oe=Jn.filter(ot=>ot.invoiceNo===ge.invoiceNo),Ee=oe.reduce((ot,xt)=>ot+(parseFloat(xt.amount)||0),0),De=oe.reduce((ot,xt)=>ot+(parseFloat(xt.tds||xt.tdsAmount)||0),0),Xe=ge.totalAmount-Ee-De-Ve;let Je="Pending";Ve>=ge.totalAmount?Je="Cancelled":Xe<=0?Je="Paid":(Ee>0||De>0||Ve>0)&&(Je="Partial"),_.push({"Party Name":ae,"Invoice No":ge.invoiceNo,Date:At(ge.date),Type:ge.isService?"Service":ge.invoiceType||"Individual",Amount:ge.totalAmount,Received:Ee||"",TDS:De||"","CN Amount":Ve||"",Balance:Xe>0?Xe:0,"Invoice Status":ge.invoiceStatus,"Receipt Status":Je,"Receipt No":oe.map(ot=>ot.receiptNo).join(", "),"CN No":ee?ee.isSystemCN?ee.creditNoteNo:ee.vchNo:""})})});const j=fr.json_to_sheet(_),M=fr.book_new();fr.book_append_sheet(M,j,"Invoice Register"),bc(M,`Invoice_Register_${new Date().toISOString().split("T")[0]}.xlsx`)},P4=()=>{const h=fr.book_new();let _=0;const z=Z=>{if(!Z)return"";const B=Z.split("/");return B.length>=3?B.slice(1).join("/"):B.length===2?B.join("/"):B[B.length-1]};if(Yi.forEach(Z=>{const B=Z.partyName,H=Z.normalizedState,j=vi[B]||0,M=[...dn,...wn].filter(K=>qt(K.partyName,B)&&K.invoiceGenerated&&K.invoiceStatus==="Approved"&&(!H||_i(K.statePartyDetails)===H)),ae=new Map;M.forEach(K=>{ae.has(K.invoiceNo)?ae.get(K.invoiceNo).campaigns.push(K):ae.set(K.invoiceNo,{invoiceNo:K.invoiceNo,invoiceDate:K.invoiceDate,campaigns:[K],statePartyDetails:K.statePartyDetails})});const te=new Set(Array.from(ae.keys())),ge=Jn.filter(K=>qt(K.partyName,B)&&(!H||te.has(K.invoiceNo))),de=Bi.filter(K=>qt(K.partyName,B)&&(!H||te.has(K.invoiceNo))),ee=H?[]:jn.filter(K=>{var Fe;return qt(K.partyName,B)&&K.isHistorical&&!((Fe=K.vchNo)!=null&&Fe.toUpperCase().startsWith("CN"))}),Ve=H?[]:jn.filter(K=>{var Fe;return qt(K.partyName,B)&&K.isHistorical&&((Fe=K.vchNo)==null?void 0:Fe.toUpperCase().startsWith("CN"))}),oe=new Map;de.forEach(K=>{const Fe=z(K.invoiceNo);Fe&&oe.set(Fe,{...K,isSystemCN:!0})}),Ve.forEach(K=>{const Fe=z(K.vchNo);Fe&&!oe.has(Fe)&&oe.set(Fe,K)});const Ee=[];let De=j,Xe=0,Je=0,ot=0,xt=0;const Le=new Set;Ee.push([B]),Ee.push(["Ledger Account"]),Z.address&&Ee.push([Z.address]),Z.state&&Ee.push([Z.state]),Z.gstin&&Ee.push(["GSTIN: "+Z.gstin]),Ee.push([]),Ee.push(["Date","Particular","Vch Type","Vch No.","Debit","Credit","Date of Receipt","Amount Received","TDS Received","Balance","Payment Status"]),j!==0&&(Ee.push(["","Opening Balance","","",j>0?j:"",j<0?Math.abs(j):"","","","",j,""]),j>0?Xe+=j:Je+=Math.abs(j));const rt=[];if(Array.from(ae.values()).forEach(K=>{rt.push({...K,entryType:"invoice",sortDate:K.invoiceDate})}),ee.forEach(K=>{rt.push({...K,entryType:"historical",sortDate:K.date})}),rt.sort((K,Fe)=>new Date(K.sortDate)-new Date(Fe.sortDate)),rt.forEach(K=>{var Fe;if(K.entryType==="invoice"){const Pt=K,ht=Pt.campaigns.reduce((gn,Vn)=>gn+(parseFloat(Vn.invoiceAmount)||0),0),Zt=(Fe=Pt.statePartyDetails)==null?void 0:Fe.toUpperCase().includes("MAHARASHTRA"),Gt=Zt?ht*.09:0,Vt=Zt?ht*.09:0,Nr=Zt?0:ht*.18,Ar=ht+Gt+Vt+Nr,kr=ge.filter(gn=>gn.invoiceNo===Pt.invoiceNo),kn=kr.reduce((gn,Vn)=>gn+(parseFloat(Vn.amount)||0),0),Ct=kr.reduce((gn,Vn)=>gn+(parseFloat(Vn.tds||Vn.tdsAmount)||0),0),Cn=kr.length>0?At(kr[0].date):"",Fn=z(Pt.invoiceNo),bn=oe.get(Fn),Ei=bn?Math.abs(parseFloat(bn.totalAmount||bn.credit)||0):0,xs=!!bn;let vs="Pending",pn=Ar-kn-Ct;if(xs&&Ei>=Ar?(vs="CN Closed",pn=0):(kn>0||Ct>0)&&(vs="Received"),De+=Ar,Xe+=Ar,Ee.push([At(Pt.invoiceDate),B,"Sales",Pt.invoiceNo,Ar,"",Cn,kn||"",Ct||"",xs?"-":pn,vs]),Ee.push(["","    PROMOTIONAL TRADE EMAILER"+(Pt.campaigns.length>1?"S":""),"","","",ht,"","","","",""]),Zt?(Ee.push(["","    CGST","","","",Gt,"","","","",""]),Ee.push(["","    SGST","","","",Vt,"","","","",""])):Ee.push(["","    IGST","","","",Nr,"","","","",""]),(kn>0||Ct>0)&&(De-=kn+Ct,ot+=kn,xt+=Ct),bn&&!Le.has(Fn)){Le.add(Fn),De-=Ei,Je+=Ei,Ee.push([At(bn.date),B,"Credit Note",bn.creditNoteNo||bn.vchNo,"",Ei,"","","","-",""]);const gn=Ei/1.18,Vn=Ei-gn;Ee.push(["","    PROMOTIONAL TRADE EMAILER","","","",gn,"","","","",""]),Zt?Ee.push(["","    CGST/SGST","","","",Vn,"","","","",""]):Ee.push(["","    IGST","","","",Vn,"","","","",""])}}else if(K.entryType==="historical"){const Pt=K,ht=parseFloat(Pt.debit)||0,Zt=z(Pt.vchNo),Gt=oe.get(Zt),Vt=!!Gt;if(De+=ht,Xe+=ht,Ee.push([At(Pt.date),Pt.particular||B,Pt.vchType||"Sales",Pt.vchNo||"",ht,"",Pt.receiptDate?At(Pt.receiptDate):"",Pt.amountReceived||"",Pt.tdsReceived||"",Vt?"-":De,Vt?"CN Closed":Pt.paymentStatus||""]),Gt&&!Le.has(Zt)){Le.add(Zt);const Nr=Math.abs(parseFloat(Gt.totalAmount||Gt.credit||Gt.debit)||0);De-=Nr,Je+=Nr,Ee.push([At(Gt.date),B,"Credit Note",Gt.creditNoteNo||Gt.vchNo,"",Nr,"","","","-",""])}}}),Ee.length<=7)return;Ee.push([]),Ee.push(["","TOTAL","","",Xe,Je,"",ot,xt,"",""]),Ee.push(["","Closing Balance","","",De>0?De:"",De<0?Math.abs(De):"","","","",De,""]);let Dt=B.substring(0,25).replace(/[\\\/\*\?\[\]:]/g,"");H&&(Dt+="-"+H.substring(0,4));let Tt=Dt,It=1;for(;h.SheetNames.includes(Tt);)Tt=Dt.substring(0,27)+It++;const oa=fr.aoa_to_sheet(Ee);fr.book_append_sheet(h,oa,Tt),_++}),_===0){alert("No ledger data to export");return}bc(h,`All_Ledgers_${new Date().toISOString().split("T")[0]}.xlsx`)},O4=()=>{const h=j=>{const M=parseFloat(j.totalAmount)||0;let ae=parseFloat(j.baseAmount)||parseFloat(j.amount)||0,te=parseFloat(j.gst)||(parseFloat(j.cgstAmount)||0)+(parseFloat(j.sgstAmount)||0)+(parseFloat(j.igstAmount)||0);return ae===0&&M>0&&(ae=M/1.18,te=M-ae),{base:ae,gst:te,total:M}},_=Jn.map(j=>{const M=parseFloat(j.amount)||0,ae=parseFloat(j.tds)||parseFloat(j.tdsAmount)||0;return{Type:"Receipt","Voucher No":j.receiptNo,Date:At(j.date),"Party Name":j.partyName,"Against Invoice":j.invoiceNo,Amount:M,TDS:ae,Total:M+ae,"Payment Mode":j.paymentMode||j.mode||"Bank Transfer",Narration:j.narration||""}}),z=Bi.map(j=>{const M=h(j);return{Type:"Credit Note","Voucher No":j.creditNoteNo,Date:At(j.date),"Party Name":j.partyName,"Against Invoice":j.invoiceNo,"Base Amount":M.base,GST:M.gst,Total:M.total,Reason:j.reason||""}}),Z=fr.book_new();if(_.length>0){const j=fr.json_to_sheet(_);fr.book_append_sheet(Z,j,"Receipts")}if(z.length>0){const j=fr.json_to_sheet(z);fr.book_append_sheet(Z,j,"Credit Notes")}const B=[..._.map(j=>({...j,"Base Amount":"",GST:"",Reason:""})),...z.map(j=>({Type:j.Type,"Voucher No":j["Voucher No"],Date:j.Date,"Party Name":j["Party Name"],"Against Invoice":j["Against Invoice"],Amount:j["Base Amount"],TDS:j.GST,Total:j.Total,"Payment Mode":"",Narration:j.Reason}))],H=fr.json_to_sheet(B);fr.book_append_sheet(Z,H,"Combined"),bc(Z,`Receipt_CN_Register_${new Date().toISOString().split("T")[0]}.xlsx`)},M4=h=>{const _=parseFloat(h.amount)||0,z=parseFloat(h.tds)||parseFloat(h.tdsAmount)||0,Z=_+z,B=`<!DOCTYPE html><html><head><title>Receipt - ${h.receiptNo}</title><style>@media print{@page{size:A5;margin:10mm}}*{margin:0;padding:0;box-sizing:border-box}body{font-family:Arial,sans-serif;font-size:12px;padding:20px}.voucher{max-width:600px;margin:0 auto;border:2px solid #000}.header{text-align:center;padding:15px;border-bottom:2px solid #000;background:#f5f5f5}.title{font-size:18px;font-weight:bold;color:#1a5276}.company{font-size:14px;font-weight:bold;margin-top:5px}.details{padding:15px}.row{display:flex;margin-bottom:10px}.label{width:140px;font-weight:bold}.value{flex:1}.amount-box{background:#e8f4fd;padding:15px;margin:15px 0;border-radius:8px;text-align:center}.amount{font-size:24px;font-weight:bold;color:#1a5276}.footer{padding:15px;border-top:1px solid #ddd;display:flex;justify-content:space-between}.signature{text-align:center;margin-top:40px}.signature-line{border-top:1px solid #000;width:150px;margin:0 auto;padding-top:5px}</style></head><body><div class="voucher"><div class="header"><div class="title">RECEIPT VOUCHER</div><div class="company">${S.name}</div><div style="font-size:10px;color:#666;margin-top:3px">${S.address}, ${S.city}</div></div><div class="details"><div class="row"><div class="label">Receipt No:</div><div class="value" style="font-weight:bold;color:#1a5276">${h.receiptNo}</div></div><div class="row"><div class="label">Date:</div><div class="value">${At(h.date)}</div></div><div class="row"><div class="label">Received From:</div><div class="value" style="font-weight:bold">${h.partyName}</div></div><div class="row"><div class="label">Against Invoice:</div><div class="value">${h.invoiceNo}</div></div><div class="row"><div class="label">Payment Mode:</div><div class="value">${h.paymentMode||h.mode||"Bank Transfer"}</div></div>${h.narration?`<div class="row"><div class="label">Narration:</div><div class="value">${h.narration}</div></div>`:""}<div class="amount-box"><div style="font-size:12px;color:#666">Amount Received</div><div class="amount">${_.toLocaleString("en-IN",{minimumFractionDigits:2})}</div>${z>0?`<div style="font-size:11px;color:#666;margin-top:5px">TDS: ${z.toLocaleString("en-IN",{minimumFractionDigits:2})}</div>`:""}<div style="font-size:11px;margin-top:8px"><strong>Total:</strong> ${Z.toLocaleString("en-IN",{minimumFractionDigits:2})}</div></div><div style="font-size:11px;color:#666;margin-top:10px"><strong>Amount in words:</strong> ${Y0(Z)}</div></div><div class="footer"><div class="signature"><div class="signature-line">Receiver's Signature</div></div><div class="signature"><div class="signature-line">Authorised Signatory</div></div></div></div></body></html>`,H=window.open("","_blank");H.document.write(B),H.document.close(),H.print()},L4=h=>{const _=parseFloat(h.totalAmount)||0;let z=parseFloat(h.baseAmount)||parseFloat(h.amount)||0,Z=parseFloat(h.gst)||(parseFloat(h.cgstAmount)||0)+(parseFloat(h.sgstAmount)||0)+(parseFloat(h.igstAmount)||0);z===0&&_>0&&(z=_/1.18,Z=_-z);const B=`<!DOCTYPE html><html><head><title>CN - ${h.creditNoteNo}</title><style>@media print{@page{size:A5;margin:10mm}}*{margin:0;padding:0;box-sizing:border-box}body{font-family:Arial,sans-serif;font-size:12px;padding:20px}.voucher{max-width:600px;margin:0 auto;border:2px solid #000}.header{text-align:center;padding:15px;border-bottom:2px solid #000;background:#fef3c7}.title{font-size:18px;font-weight:bold;color:#92400e}.company{font-size:14px;font-weight:bold;margin-top:5px}.details{padding:15px}.row{display:flex;margin-bottom:10px}.label{width:140px;font-weight:bold}.value{flex:1}.amount-box{background:#fef3c7;padding:15px;margin:15px 0;border-radius:8px;text-align:center}.amount{font-size:24px;font-weight:bold;color:#92400e}.footer{padding:15px;border-top:1px solid #ddd;display:flex;justify-content:space-between}.signature{text-align:center;margin-top:40px}.signature-line{border-top:1px solid #000;width:150px;margin:0 auto;padding-top:5px}</style></head><body><div class="voucher"><div class="header"><div class="title">CREDIT NOTE</div><div class="company">${S.name}</div><div style="font-size:10px;color:#666;margin-top:3px">${S.address}, ${S.city}</div></div><div class="details"><div class="row"><div class="label">Credit Note No:</div><div class="value" style="font-weight:bold;color:#92400e">${h.creditNoteNo}</div></div><div class="row"><div class="label">Date:</div><div class="value">${At(h.date)}</div></div><div class="row"><div class="label">Party Name:</div><div class="value" style="font-weight:bold">${h.partyName}</div></div><div class="row"><div class="label">Against Invoice:</div><div class="value">${h.invoiceNo}</div></div><div class="row"><div class="label">Reason:</div><div class="value">${h.reason||"Adjustment"}</div></div><div class="amount-box"><div style="font-size:12px;color:#666">Credit Amount</div><div class="amount">${_.toLocaleString("en-IN",{minimumFractionDigits:2})}</div><div style="font-size:10px;color:#666;margin-top:5px">Base: ${z.toLocaleString("en-IN",{minimumFractionDigits:2})} | GST: ${Z.toLocaleString("en-IN",{minimumFractionDigits:2})}</div></div><div style="font-size:11px;color:#666;margin-top:10px"><strong>Amount in words:</strong> ${Y0(_)}</div></div><div class="footer"><div class="signature"><div class="signature-line">Party Signature</div></div><div class="signature"><div class="signature-line">Authorised Signatory</div></div></div></div></body></html>`,H=window.open("","_blank");H.document.write(B),H.document.close(),H.print()},B4=()=>{const h=new Map;dn.filter(te=>te.invoiceGenerated).forEach(te=>{h.has(te.invoiceNo)?h.get(te.invoiceNo).campaigns.push(te):h.set(te.invoiceNo,{invoiceNo:te.invoiceNo,partyName:te.partyName,date:te.invoiceDate,invoiceType:te.invoiceType,combinationCode:te.combinationCode,invoiceStatus:te.invoiceStatus,mailingSent:te.mailingSent,receiptStatus:te.receiptStatus||"Pending",receiptNo:te.receiptNo,campaigns:[te],totalAmount:parseFloat(te.invoiceTotalAmount)||0,isFromMaster:!0,source:"Campaign"})}),wn.filter(te=>te.invoiceGenerated).forEach(te=>{h.has(te.invoiceNo)||h.set(te.invoiceNo,{invoiceNo:te.invoiceNo,partyName:te.partyName,date:te.invoiceDate,invoiceType:"Service",combinationCode:"NA",invoiceStatus:te.invoiceStatus,mailingSent:te.mailingSent,receiptStatus:te.receiptStatus||"Pending",receiptNo:te.receiptNo,campaigns:[te],totalAmount:parseFloat(te.invoiceTotalAmount)||0,isFromMaster:!1,isService:!0,source:"Service",serviceType:te.serviceType})});const _=te=>{if(!te)return"";const ge=te.split("/");return ge.length>=3?ge.slice(1).join("/"):ge.length===2?ge.join("/"):ge[ge.length-1]},z=jn.filter(te=>{var ge;return te.isHistorical&&(te.type==="creditnote"||((ge=te.vchNo)==null?void 0:ge.toUpperCase().startsWith("CN")))}),Z=new Map;Bi.forEach(te=>{const ge=_(te.invoiceNo);ge&&Z.set(ge,te)}),z.forEach(te=>{const ge=_(te.vchNo);ge&&!Z.has(ge)&&Z.set(ge,te)}),jn.filter(te=>{var ge;return te.isHistorical&&te.type!=="creditnote"&&!((ge=te.vchNo)!=null&&ge.toUpperCase().startsWith("CN"))&&te.debit>0}).forEach(te=>{if(!h.has(te.vchNo)){const ge=Jn.find(Je=>Je.invoiceNo===te.vchNo),de=_(te.vchNo),ee=Z.get(de),Ve=ee?Math.abs(parseFloat(ee.totalAmount)||parseFloat(ee.credit)||parseFloat(ee.debit)||0):0,oe=parseFloat(te.debit)||0;if(ee&&Ve>=oe)return;const De=!ge&&!(te.amountReceived>0),Xe=ee&&Ve>0&&Ve<oe;if(De||Xe){const Je=Xe?oe-Ve:oe;h.set(te.vchNo,{invoiceNo:te.vchNo,partyName:te.partyName,date:te.date,invoiceType:"Historical",combinationCode:"",invoiceStatus:"Approved",mailingSent:"Yes",receiptStatus:Xe?"Partial CN":"Pending",receiptNo:"",campaigns:[],totalAmount:oe,pendingAmount:Je,hasPartialCN:Xe,cnAmount:Ve,isHistorical:!0,historicalEntry:te})}}});let B=Array.from(h.values());if(Se.party&&(B=B.filter(te=>qt(te.partyName,Se.party))),Se.invoiceStatus&&(B=B.filter(te=>te.invoiceStatus===Se.invoiceStatus)),Se.receiptStatus&&(Se.receiptStatus==="Received"?B=B.filter(te=>te.receiptStatus==="Received"):Se.receiptStatus==="Pending"&&(B=B.filter(te=>te.receiptStatus!=="Received"))),Se.invoiceType&&(B=B.filter(te=>te.invoiceType===Se.invoiceType)),Se.searchText){const te=Se.searchText.toLowerCase();B=B.filter(ge=>{var de,ee;return((de=ge.invoiceNo)==null?void 0:de.toLowerCase().includes(te))||((ee=ge.partyName)==null?void 0:ee.toLowerCase().includes(te))})}const H={};B.forEach(te=>{H[te.partyName]||(H[te.partyName]=[]),H[te.partyName].push(te)});const j=Object.keys(H).sort(),M=Se.party||Se.invoiceStatus||Se.receiptStatus||Se.invoiceType||Se.searchText,ae=Array.from(h.values());return c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Invoice & Receipt Register"}),c.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[c.jsx(qe,{icon:wo,label:"Export Excel",variant:"secondary",onClick:()=>D4(B)}),Sn&&c.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"})]})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(id,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"})]}),c.jsxs("div",{style:{position:"relative"},children:[c.jsx(z0,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",placeholder:"Search invoice...",value:Se.searchText,onChange:te=>Ue(ge=>({...ge,searchText:te.target.value})),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"160px"}})]}),c.jsxs("select",{value:Se.party,onChange:te=>Ue(ge=>({...ge,party:te.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Parties"}),Tn.map(te=>c.jsx("option",{value:te,children:te},te))]}),c.jsxs("select",{value:Se.invoiceStatus,onChange:te=>Ue(ge=>({...ge,invoiceStatus:te.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Status"}),c.jsx("option",{value:"Created",children:"Created"}),c.jsx("option",{value:"Approved",children:"Approved"}),c.jsx("option",{value:"Need Edits",children:"Need Edits"})]}),c.jsxs("select",{value:Se.receiptStatus,onChange:te=>Ue(ge=>({...ge,receiptStatus:te.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Receipts"}),c.jsx("option",{value:"Received",children:"Received"}),c.jsx("option",{value:"Pending",children:"Pending"})]}),c.jsxs("select",{value:Se.invoiceType,onChange:te=>Ue(ge=>({...ge,invoiceType:te.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Types"}),c.jsx("option",{value:"Individual",children:"Individual"}),c.jsx("option",{value:"Combined",children:"Combined"})]}),M&&c.jsxs(c.Fragment,{children:[c.jsxs("button",{onClick:()=>Ue({party:"",invoiceStatus:"",receiptStatus:"",invoiceType:"",searchText:""}),style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(Ma,{size:14})," Clear"]}),c.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",B.length," of ",ae.length]})]})]})}),c.jsx(Zr,{noPadding:!0,children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[c.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Date"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Type"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:"Amount"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#F0FDF4",color:"#166534"},children:"Received"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEF3C7",color:"#92400E"},children:"TDS"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:"CN Amt"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#EFF6FF",color:"#1E40AF"},children:"Balance"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Inv. Status"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Receipt No."}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"CN No."}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),c.jsx("tbody",{children:j.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:"12",style:{padding:"50px",textAlign:"center",color:"#94A3B8"},children:M?"No matching invoices":"No invoices generated yet"})}):j.map(te=>{const ge=H[te],de=Zf.has(te);let ee=0;return ge.forEach(Ve=>{const oe=Be.find(Tt=>Tt.invoiceNo===Ve.invoiceNo),Ee=ne.find(Tt=>Tt.invoiceNo===Ve.invoiceNo),De=ie.find(Tt=>Tt.invoiceNo===Ve.invoiceNo&&Tt.type==="tds"),Xe=ie.find(Tt=>Tt.invoiceNo===Ve.invoiceNo&&Tt.type==="discount"),Je=Ve.totalAmount||0,ot=oe&&parseFloat(oe.amount)||0,xt=De?parseFloat(De.credit)||0:oe&&parseFloat(oe.tds)||0,Le=Ee?Math.abs(parseFloat(Ee.totalAmount)||0):0,rt=Xe&&parseFloat(Xe.credit)||0,Dt=Math.max(0,Je-ot-xt-Le-rt);ee+=Dt}),c.jsxs(Z0.Fragment,{children:[c.jsxs("tr",{onClick:()=>xy(te),style:{backgroundColor:"#1E3A5F",color:"white",cursor:"pointer",borderBottom:"1px solid #0F2744"},children:[c.jsx("td",{colSpan:"3",style:{padding:"10px 12px",fontWeight:"700",fontSize:"13px"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[de?c.jsx(Kg,{size:18}):c.jsx(B0,{size:18}),c.jsx(Z2,{size:16}),te,c.jsxs("span",{style:{backgroundColor:"#2874A6",padding:"2px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600"},children:[ge.length," inv"]})]})}),c.jsx("td",{colSpan:"4",style:{padding:"10px 12px"}}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",fontSize:"13px",backgroundColor:ee===0?"#22C55E":"#3B82F6"},children:ee===0?" Nil":`Bal: ${et(ee)}`}),c.jsx("td",{colSpan:"4",style:{padding:"10px 12px"}})]}),de&&ge.map(Ve=>{const oe=Be.find(It=>It.invoiceNo===Ve.invoiceNo),Ee=ne.find(It=>It.invoiceNo===Ve.invoiceNo),De=ie.find(It=>It.invoiceNo===Ve.invoiceNo&&It.type==="tds"),Xe=ie.find(It=>It.invoiceNo===Ve.invoiceNo&&It.type==="discount"),Je=Ve.totalAmount||0,ot=oe&&parseFloat(oe.amount)||0,xt=De?parseFloat(De.credit)||0:oe&&parseFloat(oe.tds)||0,Le=Ee?Math.abs(parseFloat(Ee.totalAmount)||0):0,rt=Xe&&parseFloat(Xe.credit)||0,Dt=Math.max(0,Je-ot-xt-Le-rt),Tt=Le>=Je&&!oe;return c.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:Ve.invoiceType==="Combined"?"#FAF5FF":Dt===0?"#F0FDF4":"transparent"},children:[c.jsx("td",{style:{padding:"10px 12px 10px 36px",fontWeight:"700",color:Ve.invoiceType==="Combined"?"#7C3AED":"#2874A6"},children:Ve.invoiceNo}),c.jsx("td",{style:{padding:"10px 12px"},children:At(Ve.date)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsx(X0,{status:Ve.invoiceType,small:!0})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:et(Je)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#F0FDF4",color:ot>0?"#166534":"#94A3B8"},children:ot>0?et(ot):"-"}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#FEF3C7",color:xt>0?"#92400E":"#94A3B8"},children:xt>0?et(xt):"-"}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#FEE2E2",color:Le>0?"#991B1B":"#94A3B8"},children:Le>0?et(Le):"-"}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#EFF6FF",color:Dt>0?"#1E40AF":"#166534"},children:Dt===0?" Nil":et(Dt)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsx(X0,{status:Ve.invoiceStatus,small:!0})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:Tt?c.jsx("span",{style:{padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:" Cancelled"}):oe?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",justifyContent:"center"},children:[c.jsxs("button",{onClick:()=>l4(oe),style:{padding:"4px 8px",borderRadius:"12px",fontSize:"10px",fontWeight:"700",backgroundColor:"#DCFCE7",color:"#166534",border:"none",cursor:"pointer",textDecoration:"underline"},title:"Click to view receipt",children:[" ",oe.receiptNo]}),dr&&c.jsx("button",{onClick:()=>KF(oe),style:{padding:"2px 4px",borderRadius:"4px",fontSize:"10px",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete Receipt",children:""})]}):c.jsx("span",{style:{padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600",backgroundColor:"#FEF3C7",color:"#92400E"},children:" Pending"})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:Ee?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",justifyContent:"center"},children:[c.jsx("button",{onClick:()=>c4(Ee),style:{padding:"4px 8px",borderRadius:"12px",fontSize:"10px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer",textDecoration:"underline"},title:"Click to view credit note",children:Ee.creditNoteNo}),dr&&c.jsx("button",{onClick:()=>YF(Ee),style:{padding:"2px 4px",borderRadius:"4px",fontSize:"10px",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete Credit Note",children:""})]}):c.jsx("span",{style:{color:"#94A3B8",fontSize:"11px"},children:"-"})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsx("div",{style:{display:"flex",gap:"4px",justifyContent:"center",flexWrap:"wrap"},children:Ve.isHistorical?c.jsxs(c.Fragment,{children:[dr&&!oe&&c.jsx(qe,{icon:wl,small:!0,variant:"success",onClick:()=>{const It={invoiceNo:Ve.invoiceNo,partyName:Ve.partyName,invoiceDate:Ve.date,invoiceTotalAmount:Ve.totalAmount,invoiceStatus:"Approved",mailingSent:"Yes",invoiceType:"Historical",isHistorical:!0};hn(It)},title:"Create Receipt"}),dr&&!Ee&&c.jsx(qe,{icon:nd,small:!0,variant:"primary",onClick:()=>{const It={invoiceNo:Ve.invoiceNo,partyName:Ve.partyName,invoiceDate:Ve.date,invoiceTotalAmount:Ve.totalAmount,invoiceStatus:"Approved",isHistorical:!0};Oa(It)},title:"Credit Note"})]}):c.jsxs(c.Fragment,{children:[c.jsx(qe,{icon:j0,small:!0,variant:"brand",onClick:()=>Ku(Ve.campaigns[0]),title:"View Invoice"}),dr&&Ve.invoiceStatus==="Approved"&&Ve.mailingSent==="Yes"&&!oe&&c.jsx(qe,{icon:wl,small:!0,variant:"success",onClick:()=>hn(Ve.campaigns[0]),title:"Create Receipt"}),dr&&Ve.invoiceStatus==="Approved"&&!Ee&&c.jsx(qe,{icon:nd,small:!0,variant:"primary",onClick:()=>Oa(Ve.campaigns[0]),title:"Credit Note"}),dr&&c.jsx(qe,{icon:Ws,small:!0,variant:"danger",onClick:()=>_l(Ve.campaigns[0]),title:"Delete Invoice"})]})})})]},Ve.invoiceNo)})]},te)})})]})})]})},j4=()=>{if(!q){alert("Please select a party first");return}const h=vi[q]||0,_=_e.filter(K=>qt(K.partyName,q)&&K.invoiceGenerated&&K.invoiceStatus==="Approved"&&(!we||_i(K.statePartyDetails)===we)),z=new Map;_.forEach(K=>{z.has(K.invoiceNo)?z.get(K.invoiceNo).campaigns.push(K):z.set(K.invoiceNo,{invoiceNo:K.invoiceNo,invoiceDate:K.invoiceDate,campaigns:[K],isFromMaster:!0})});const Z=new Set(Array.from(z.keys())),B=we?[]:ie.filter(K=>{var Fe;return qt(K.partyName,q)&&K.isHistorical&&K.type!=="creditnote"&&!((Fe=K.vchNo)!=null&&Fe.toUpperCase().startsWith("CN"))}),H=we?[]:ie.filter(K=>{var Fe;return qt(K.partyName,q)&&K.isHistorical&&(K.type==="creditnote"||((Fe=K.vchNo)==null?void 0:Fe.toUpperCase().startsWith("CN")))}),j=Be.filter(K=>qt(K.partyName,q)&&(!we||Z.has(K.invoiceNo))),M=ne.filter(K=>qt(K.partyName,q)&&(!we||Z.has(K.invoiceNo))),ae=K=>{if(!K)return"";const Fe=K.split("/");return Fe.length>=3?Fe.slice(1).join("/"):Fe.length===2?Fe.join("/"):Fe[Fe.length-1]},te=new Map;M.forEach(K=>{const Fe=ae(K.invoiceNo);Fe&&!te.has(Fe)&&te.set(Fe,{...K,isSystemCN:!0})}),H.forEach(K=>{const Fe=ae(K.vchNo);Fe&&!te.has(Fe)&&te.set(Fe,{...K,isHistoricalCN:!0})});let ge=[],de=0,ee=0,Ve=0,oe=0,Ee=h;const De=new Set;h!==0&&(de+=h>0?h:0,ee+=h<0?Math.abs(h):0,ge.push({date:"",particular:"Opening Balance",vchType:"",vchNo:"",debit:h>0?h:0,credit:h<0?Math.abs(h):0,receiptDate:"",amountReceived:0,tds:0,balance:h,status:"",isMain:!0,isOpening:!0}));const Xe=[];Array.from(z.values()).filter(K=>{const Fe=new Date(K.invoiceDate);return Fe>=new Date(an.fromDate)&&Fe<=new Date(an.toDate)}).forEach(K=>{Xe.push({...K,entryType:"invoice",sortDate:K.invoiceDate})}),B.filter(K=>{if(!K.date)return!1;const Fe=new Date(K.date);return Fe>=new Date(an.fromDate)&&Fe<=new Date(an.toDate)}).forEach(K=>{Xe.push({...K,entryType:"invoice",sortDate:K.date})}),Xe.sort((K,Fe)=>new Date(K.sortDate)-new Date(Fe.sortDate)),Xe.forEach(K=>{var Fe,Pt;if(K.isFromMaster){const ht=K;let Zt=0;ht.campaigns.forEach(pn=>Zt+=parseFloat(pn.invoiceAmount)||0);const Gt=(Pt=(Fe=ht.campaigns[0])==null?void 0:Fe.statePartyDetails)==null?void 0:Pt.toUpperCase().includes("MAHARASHTRA"),Vt=Gt?Zt*.09:0,Nr=Gt?Zt*.09:0,Ar=Gt?0:Zt*.18,kr=Zt+Vt+Nr+Ar,kn=ae(ht.invoiceNo),Ct=te.get(kn),Cn=!!Ct,Fn=j.find(pn=>pn.invoiceNo===ht.invoiceNo);Ee+=kr,de+=kr;let bn=0,Ei=0,xs="",vs=Cn?"":"Pending";if(Fn&&(vs="Received",bn=Fn.amount||0,Ei=Fn.tds||0,xs=Fn.date,Ve+=bn,oe+=Ei,Ee-=bn+Ei+(Fn.discount||0)),ge.push({date:ht.invoiceDate,particular:q,vchType:"Sales",vchNo:ht.invoiceNo,debit:kr,credit:0,receiptDate:xs,amountReceived:bn,tds:Ei,balance:Cn?"-":vs==="Received"?0:kr-bn-Ei,status:vs,isMain:!0,hasCN:Cn}),ge.push({particular:"PROMOTIONAL TRADE EMAILER"+(ht.campaigns.length>1?"S":""),credit:Zt,isMain:!1,hasCN:Cn}),Gt?(ge.push({particular:"CGST",credit:Vt,isMain:!1,hasCN:Cn}),ge.push({particular:"SGST",credit:Nr,isMain:!1,hasCN:Cn})):ge.push({particular:"IGST",credit:Ar,isMain:!1,hasCN:Cn}),Ct&&!De.has(kn)){De.add(kn);const pn=Math.abs(Ct.totalAmount||Ct.credit||0);Ee-=pn,ee+=pn,ge.push({date:Ct.date,particular:q,vchType:"Credit Note",vchNo:Ct.creditNoteNo||Ct.vchNo,debit:0,credit:pn,receiptDate:"",amountReceived:0,tds:0,balance:"-",status:"",isMain:!0,isCreditNote:!0,hasCN:!0});const gn=Math.abs(Ct.amount)||pn/1.18,Vn=Math.abs(Ct.gst)||pn-gn;ge.push({particular:"PROMOTIONAL TRADE EMAILER",credit:gn,isMain:!1,isCreditNote:!0,hasCN:!0}),ge.push({particular:Ct.gstType||(Gt?"CGST + SGST":"IGST"),credit:Vn,isMain:!1,isCreditNote:!0,hasCN:!0})}}else if(K.isHistorical){const ht=K.debit||0,Zt=K.credit||0,Gt=ae(K.vchNo),Vt=te.get(Gt),Nr=!!Vt;if(Ee+=ht-Zt,de+=ht,ee+=Zt,ge.push({date:K.date,particular:K.particulars||q,vchType:K.vchType||"Sales",vchNo:K.vchNo,debit:ht,credit:Zt,receiptDate:K.receiptDate||"",amountReceived:K.amountReceived||0,tds:K.tdsReceived||0,balance:Nr?"-":ht-(K.amountReceived||0)-(K.tdsReceived||0),status:Nr?"":K.paymentStatus||"",isMain:!0,isHistorical:!0,hasCN:Nr}),K.subRows&&K.subRows.length>0&&K.subRows.forEach(Ar=>{ge.push({particular:Ar.particular,debit:Ar.debit,credit:Ar.credit,isMain:!1,hasCN:Nr})}),Vt&&!De.has(Gt)){De.add(Gt);const Ar=Math.abs(Vt.totalAmount||Vt.credit||0);Ee-=Ar,ee+=Ar,ge.push({date:Vt.date,particular:q,vchType:"Credit Note",vchNo:Vt.creditNoteNo||Vt.vchNo,debit:0,credit:Ar,receiptDate:"",amountReceived:0,tds:0,balance:"-",status:"",isMain:!0,isCreditNote:!0,hasCN:!0}),Vt.subRows&&Vt.subRows.length>0&&Vt.subRows.forEach(kr=>{ge.push({particular:kr.particular,credit:Math.abs(kr.credit||0),isMain:!1,isCreditNote:!0,hasCN:!0})})}}});const Je=ge.reduce((K,Fe)=>Fe.isMain&&typeof Fe.balance=="number"&&Fe.balance>0?K+Fe.balance:K,0),ot=(q||"").trim().toUpperCase();let xt={};we&&(xt=Yi.find(K=>K.partyNameUpper===ot&&K.normalizedState===we)||{}),xt.state||(xt=Yi.find(K=>K.partyNameUpper===ot)||{});const Le=_e.find(K=>{var Fe;return((Fe=K.partyName)==null?void 0:Fe.trim().toUpperCase())===ot}),rt=xt.state||(Le==null?void 0:Le.statePartyDetails)||"",Dt=xt.address||vl(q,rt)||"",Tt=xt.gstin||xo(q,rt),It=`
<!DOCTYPE html>
<html>
<head>
  <title>Ledger Account - ${q}</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; font-size: 11px; padding: 20px; }
    .header { text-align: center; margin-bottom: 15px; }
    .firm-name { font-size: 18px; font-weight: bold; color: #1E293B; }
    .firm-address { font-size: 10px; color: #666; margin-top: 2px; }
    .party-section { text-align: center; margin: 15px 0; padding: 10px; border: 1px solid #ddd; background: #f9f9f9; }
    .party-name { font-size: 14px; font-weight: bold; }
    .ledger-title { font-size: 11px; color: #666; }
    .party-address { font-size: 10px; color: #666; margin-top: 5px; }
    .party-gstin { font-size: 10px; color: #1a5276; margin-top: 3px; font-weight: 600; }
    .period { text-align: center; font-size: 11px; margin: 10px 0; font-weight: bold; }
    .totals { display: flex; justify-content: space-around; background: #e8f4fd; padding: 8px; margin-bottom: 10px; font-size: 10px; border: 1px solid #ccc; }
    .totals div { text-align: center; }
    .totals .label { color: #666; }
    .totals .value { font-weight: bold; font-size: 11px; }
    .closing-balance { text-align: center; background: #1E293B; color: white; padding: 10px; margin-bottom: 10px; font-size: 14px; font-weight: bold; }
    table { width: 100%; border-collapse: collapse; font-size: 10px; }
    th { background: #f0f0f0; border: 1px solid #ccc; padding: 6px 4px; text-align: left; font-weight: bold; }
    td { border: 1px solid #ddd; padding: 5px 4px; }
    .text-right { text-align: right; }
    .text-center { text-align: center; }
    .main-row { background: #fff; }
    .main-row-cn { background: #fffbeb; }
    .sub-row { background: #fafafa; }
    .sub-row-cn { background: #fffbeb; }
    .sub-row td { padding-left: 20px; color: #666; font-size: 9px; }
    .opening-row { background: #fef3c7; font-weight: bold; }
    .credit-note-row { background: #fffbeb; }
    .status-received { background: #dcfce7; color: #166534; padding: 2px 6px; border-radius: 3px; font-size: 9px; }
    .status-pending { background: #fef3c7; color: #92400e; padding: 2px 6px; border-radius: 3px; font-size: 9px; }
    .debit { color: #dc2626; }
    .credit { color: #059669; }
    @media print { 
      body { padding: 10px; } 
      @page { size: landscape; margin: 10mm; }
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="firm-name">${S.name}</div>
    <div class="firm-address">${S.address}</div>
    <div class="firm-address">${S.addressLine2}, ${S.city}</div>
    <div class="firm-address">E-Mail: ${S.email}</div>
  </div>
  
  <div class="party-section">
    <div class="party-name">${q}</div>
    <div class="ledger-title">Ledger Account</div>
    ${Dt?`<div class="party-address">${Dt}</div>`:""}
    ${rt?`<div class="party-address"> ${rt}</div>`:""}
    ${Tt?`<div class="party-gstin">GSTIN: ${Tt}</div>`:""}
  </div>
  
  <div class="period">${At(an.fromDate)} to ${At(an.toDate)}</div>
  
  <div class="closing-balance">
    Closing Balance: ${zt(Math.abs(Je))} ${Je>0?"(Dr)":Je<0?"(Cr)":""}
  </div>
  
  <div class="totals">
    <div><div class="label">Debit</div><div class="value">${zt(de)}</div></div>
    <div><div class="label">Credit</div><div class="value">${zt(ee)}</div></div>
    <div><div class="label">Amount Received</div><div class="value credit">${zt(Ve)}</div></div>
    <div><div class="label">TDS Received</div><div class="value">${zt(oe)}</div></div>
  </div>
  
  <table>
    <thead>
      <tr>
        <th style="width:65px">Date</th>
        <th>Particular</th>
        <th style="width:70px" class="text-center">Vch Type</th>
        <th style="width:100px">Vch No.</th>
        <th style="width:80px" class="text-right">Debit</th>
        <th style="width:80px" class="text-right">Credit</th>
        <th style="width:70px" class="text-center">Date of Receipt</th>
        <th style="width:85px" class="text-right">Amount Received</th>
        <th style="width:70px" class="text-right">TDS Received</th>
        <th style="width:75px" class="text-right">Balance</th>
        <th style="width:70px" class="text-center">Payment Status</th>
      </tr>
    </thead>
    <tbody>
      ${ge.map(K=>K.isMain?`
        <tr class="${K.isOpening?"opening-row":K.hasCN||K.isCreditNote?"main-row-cn":"main-row"}">
          <td>${K.date?At(K.date):""}</td>
          <td style="font-weight:600">${K.particular}</td>
          <td class="text-center">${K.vchType||""}</td>
          <td style="color:#2874A6;font-weight:600">${K.vchNo||""}</td>
          <td class="text-right">${K.debit>0?zt(K.debit):""}</td>
          <td class="text-right" style="color:#DC2626">${K.credit>0?zt(K.credit):""}</td>
          <td class="text-center">${K.receiptDate?At(K.receiptDate):""}</td>
          <td class="text-right credit">${K.amountReceived>0?zt(K.amountReceived):""}</td>
          <td class="text-right">${K.tds>0?zt(K.tds):""}</td>
          <td class="text-right">${K.balance==="-"?"-":K.balance>0?zt(K.balance):""}</td>
          <td class="text-center">${K.status?`<span class="${K.status==="Received"?"status-received":"status-pending"}">${K.status}</span>`:""}</td>
        </tr>
      `:`
        <tr class="${K.hasCN||K.isCreditNote?"sub-row-cn":"sub-row"}">
          <td></td>
          <td style="padding-left:20px;color:#666">${K.particular}</td>
          <td></td>
          <td></td>
          <td class="text-right">${K.debit?zt(K.debit):""}</td>
          <td class="text-right">${K.credit?zt(K.credit):""}</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
      `).join("")}
    </tbody>
  </table>
  
  <script>window.onload = function() { window.print(); }<\/script>
</body>
</html>`,oa=window.open("","_blank");oa.document.write(It),oa.document.close()},U4=ve.useMemo(()=>{const h=new Set;return Jn.forEach(_=>h.add(_.partyName)),Bi.forEach(_=>h.add(_.partyName)),[...h].filter(Boolean).sort()},[Jn,Bi]),V4=ve.useMemo(()=>Jn.filter(h=>{var _;return!(se.party&&h.partyName!==se.party||se.invoiceNo&&!((_=h.invoiceNo)!=null&&_.toLowerCase().includes(se.invoiceNo.toLowerCase()))||se.dateFrom&&h.date<se.dateFrom||se.dateTo&&h.date>se.dateTo)}),[Jn,se]),z4=ve.useMemo(()=>Bi.filter(h=>{var _;return!(se.party&&h.partyName!==se.party||se.invoiceNo&&!((_=h.invoiceNo)!=null&&_.toLowerCase().includes(se.invoiceNo.toLowerCase()))||se.dateFrom&&h.date<se.dateFrom||se.dateTo&&h.date>se.dateTo)}),[Bi,se]),W4=()=>{const h=[...V4].sort((j,M)=>new Date(M.date)-new Date(j.date)),_=[...z4].sort((j,M)=>new Date(M.date)-new Date(j.date)),z=h.reduce((j,M)=>j+(parseFloat(M.amount)||0),0),Z=h.reduce((j,M)=>j+(parseFloat(M.tds)||parseFloat(M.tds||M.tdsAmount)||0),0),B=_.reduce((j,M)=>j+(parseFloat(M.totalAmount)||0),0),H=j=>{const M=parseFloat(j.totalAmount)||0;let ae=parseFloat(j.baseAmount)||parseFloat(j.amount)||0,te=parseFloat(j.gst)||(parseFloat(j.cgstAmount)||0)+(parseFloat(j.sgstAmount)||0)+(parseFloat(j.igstAmount)||0);return ae===0&&M>0&&(ae=M/1.18,te=M-ae),{base:ae,gst:te,total:M}};return c.jsxs("div",{style:{padding:"20px"},children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[c.jsxs("div",{children:[c.jsx("h1",{style:{fontSize:"22px",fontWeight:"700",color:"#1E293B",marginBottom:"4px"},children:" Receipt Register"}),c.jsx("p",{style:{fontSize:"13px",color:"#64748B"},children:"All receipts, TDS, and credit notes"})]}),c.jsx(qe,{icon:wo,label:"Export Excel",variant:"secondary",onClick:O4})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsx(id,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"}),c.jsxs("select",{value:se.party,onChange:j=>he(M=>({...M,party:j.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"},children:[c.jsx("option",{value:"",children:"All Parties"}),U4.map(j=>c.jsx("option",{value:j,children:j},j))]}),c.jsx("input",{type:"text",placeholder:"Invoice No",value:se.invoiceNo,onChange:j=>he(M=>({...M,invoiceNo:j.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"140px"}}),c.jsx("input",{type:"date",value:se.dateFrom,onChange:j=>he(M=>({...M,dateFrom:j.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}}),c.jsx("span",{style:{color:"#64748B"},children:"to"}),c.jsx("input",{type:"date",value:se.dateTo,onChange:j=>he(M=>({...M,dateTo:j.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}}),(se.party||se.invoiceNo||se.dateFrom||se.dateTo)&&c.jsxs("button",{onClick:()=>he({party:"",invoiceNo:"",dateFrom:"",dateTo:""}),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer"},children:[c.jsx(Ma,{size:14})," Clear"]})]})}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px",marginBottom:"20px"},children:[c.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",padding:"20px",border:"1px solid #E2E8F0"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#64748B",marginBottom:"8px"},children:"Receipts"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:h.length})]}),c.jsxs("div",{style:{backgroundColor:"#F0FDF4",borderRadius:"12px",padding:"20px",border:"1px solid #BBF7D0"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#166534",marginBottom:"8px"},children:"Amount Received"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#166534"},children:et(z)})]}),c.jsxs("div",{style:{backgroundColor:"#FEF3C7",borderRadius:"12px",padding:"20px",border:"1px solid #FDE68A"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#92400E",marginBottom:"8px"},children:"TDS Received"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#92400E"},children:et(Z)})]}),c.jsxs("div",{style:{backgroundColor:"#FEE2E2",borderRadius:"12px",padding:"20px",border:"1px solid #FCA5A5"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#991B1B",marginBottom:"8px"},children:"Credit Notes"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#991B1B"},children:et(B)})]})]}),c.jsx(Zr,{title:`Receipts (${h.length})`,noPadding:!0,children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Receipt No"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Date"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Party Name"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700",backgroundColor:"#F0FDF4",color:"#166534"},children:"Amount"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEF3C7",color:"#92400E"},children:"TDS"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"Total"}),c.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700"},children:"Payment Mode"}),c.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),c.jsx("tbody",{children:h.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:"9",style:{padding:"50px",textAlign:"center",color:"#94A3B8"},children:"No receipts found"})}):h.map(j=>{const M=parseFloat(j.amount)||0,ae=parseFloat(j.tds)||parseFloat(j.tdsAmount)||0;return c.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9"},children:[c.jsx("td",{style:{padding:"12px",fontWeight:"600",color:"#2874A6"},children:j.receiptNo}),c.jsx("td",{style:{padding:"12px"},children:At(j.date)}),c.jsx("td",{style:{padding:"12px",fontWeight:"500"},children:j.partyName}),c.jsx("td",{style:{padding:"12px",color:"#64748B"},children:j.invoiceNo}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"600",color:"#166534",backgroundColor:"#F0FDF4"},children:et(M)}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"600",color:"#92400E",backgroundColor:"#FEF3C7"},children:et(ae)}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:et(M+ae)}),c.jsx("td",{style:{padding:"12px",textAlign:"center"},children:c.jsx("span",{style:{padding:"4px 8px",fontSize:"10px",fontWeight:"600",borderRadius:"9999px",backgroundColor:"#E0E7FF",color:"#3730A3"},children:j.paymentMode||j.mode||"Bank Transfer"})}),c.jsx("td",{style:{padding:"12px",textAlign:"center"},children:c.jsxs("button",{onClick:()=>M4(j),style:{padding:"6px 10px",fontSize:"11px",backgroundColor:"#2874A6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:[c.jsx(Qg,{size:12})," Print"]})})]},j.id||j.receiptNo)})})]})}),c.jsx("div",{style:{marginTop:"30px"},children:c.jsx(Zr,{title:`Credit Notes (${_.length})`,noPadding:!0,children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#FEF3C7",borderBottom:"2px solid #FDE68A"},children:[c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"CN No"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Date"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Party Name"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Against Invoice"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"Base Amount"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"GST"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"Total"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Reason"}),c.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),c.jsx("tbody",{children:_.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:"9",style:{padding:"50px",textAlign:"center",color:"#94A3B8"},children:"No credit notes found"})}):_.map(j=>{const M=H(j);return c.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:"#FFFBEB"},children:[c.jsx("td",{style:{padding:"12px",fontWeight:"600",color:"#92400E"},children:j.creditNoteNo}),c.jsx("td",{style:{padding:"12px"},children:At(j.date)}),c.jsx("td",{style:{padding:"12px",fontWeight:"500"},children:j.partyName}),c.jsx("td",{style:{padding:"12px",color:"#64748B"},children:j.invoiceNo}),c.jsx("td",{style:{padding:"12px",textAlign:"right"},children:et(M.base)}),c.jsx("td",{style:{padding:"12px",textAlign:"right"},children:et(M.gst)}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"700",color:"#92400E"},children:et(M.total)}),c.jsx("td",{style:{padding:"12px",fontSize:"11px",color:"#64748B"},children:j.reason||"-"}),c.jsx("td",{style:{padding:"12px",textAlign:"center"},children:c.jsxs("button",{onClick:()=>L4(j),style:{padding:"6px 10px",fontSize:"11px",backgroundColor:"#92400E",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:[c.jsx(Qg,{size:12})," Print"]})})]},j.id||j.creditNoteNo)})})]})})})]})},H4=()=>{const h=(M,ae)=>{const te=vi[M]||0,ge=_e.filter(Le=>qt(Le.partyName,M)&&Le.invoiceGenerated&&Le.invoiceStatus==="Approved"&&(!ae||_i(Le.statePartyDetails)===ae)),de=be.filter(Le=>qt(Le.partyName,M)&&Le.invoiceGenerated&&Le.invoiceStatus==="Approved"&&(!ae||_i(Le.statePartyDetails)===ae)),ee=new Map;ge.forEach(Le=>{ee.has(Le.invoiceNo)?ee.get(Le.invoiceNo).campaigns.push(Le):ee.set(Le.invoiceNo,{invoiceNo:Le.invoiceNo,campaigns:[Le],totalAmount:parseFloat(Le.invoiceTotalAmount)||0})}),de.forEach(Le=>{ee.has(Le.invoiceNo)||ee.set(Le.invoiceNo,{invoiceNo:Le.invoiceNo,totalAmount:parseFloat(Le.invoiceTotalAmount)||0,isService:!0})});const Ve=new Set(Array.from(ee.keys())),oe=Be.filter(Le=>qt(Le.partyName,M)&&(!ae||Ve.has(Le.invoiceNo))),Ee=ne.filter(Le=>qt(Le.partyName,M)&&(!ae||Ve.has(Le.invoiceNo))),De=ae?[]:ie.filter(Le=>{var rt;return qt(Le.partyName,M)&&Le.isHistorical&&Le.type!=="creditnote"&&!((rt=Le.vchNo)!=null&&rt.toUpperCase().startsWith("CN"))}),Xe=ae?[]:ie.filter(Le=>{var rt;return qt(Le.partyName,M)&&Le.isHistorical&&(Le.type==="creditnote"||((rt=Le.vchNo)==null?void 0:rt.toUpperCase().startsWith("CN")))}),Je=Le=>{if(!Le)return"";const rt=Le.split("/");return rt.length>=3?rt.slice(1).join("/"):rt.length===2?rt.join("/"):rt[rt.length-1]},ot=new Map;Ee.forEach(Le=>{const rt=Je(Le.invoiceNo);rt&&!ot.has(rt)&&ot.set(rt,Le)}),Xe.forEach(Le=>{const rt=Je(Le.vchNo);rt&&!ot.has(rt)&&ot.set(rt,Le)});let xt=0;return te>0&&(xt+=te),Array.from(ee.values()).forEach(Le=>{const rt=Le.totalAmount,Dt=Je(Le.invoiceNo),Tt=ot.get(Dt),It=Tt?Math.abs(parseFloat(Tt.totalAmount)||parseFloat(Tt.credit)||0):0;if(!(Tt&&It>=rt)){let K=Tt?rt-It:rt;const Fe=oe.find(Pt=>Pt.invoiceNo===Le.invoiceNo);if(Fe){const Pt=K-(parseFloat(Fe.amount)||0)-(parseFloat(Fe.tds)||0)-(parseFloat(Fe.discount)||0);Pt>0&&(xt+=Pt)}else K>0&&(xt+=K)}}),De.forEach(Le=>{const rt=Je(Le.vchNo),Dt=ot.get(rt),Tt=Dt?Math.abs(parseFloat(Dt.totalAmount)||parseFloat(Dt.credit)||parseFloat(Dt.debit)||0):0,It=parseFloat(Le.debit)||0;if(!(Dt&&Tt>=It)){let K=Dt?It-Tt:It;const Fe=parseFloat(Le.amountReceived)||0,Pt=parseFloat(Le.tdsReceived)||0,ht=K-Fe-Pt;ht>0&&(xt+=ht)}}),xt},_=Yi.filter(M=>M.partyName.toLowerCase().includes(Ca.toLowerCase())||M.state&&M.state.toLowerCase().includes(Ca.toLowerCase())),z=M=>{if(we){const de=Yi.find(ee=>ee.partyNameUpper===(M||"").trim().toUpperCase()&&ee.normalizedState===we);if(de!=null&&de.state)return de.state}const ae=(M||"").trim().toUpperCase(),te=_e.find(de=>{var ee;return((ee=de.partyName)==null?void 0:ee.trim().toUpperCase())===ae});if(te!=null&&te.statePartyDetails)return te.statePartyDetails;const ge=Yi.find(de=>de.partyNameUpper===ae);return(ge==null?void 0:ge.state)||""},Z=M=>{const ae=(M||"").trim().toUpperCase();if(we){const ge=Yi.find(de=>de.partyNameUpper===ae&&de.normalizedState===we);if(ge!=null&&ge.address)return ge.address}const te=Yi.find(ge=>ge.partyNameUpper===ae);return te!=null&&te.address?te.address:vl(M,z(M))},B=M=>{const ae=(M||"").trim().toUpperCase();if(we){const de=Yi.find(ee=>ee.partyNameUpper===ae&&ee.normalizedState===we);if(de!=null&&de.gstin)return de.gstin}const te=Yi.find(de=>de.partyNameUpper===ae);if(te!=null&&te.gstin)return te.gstin;const ge=_e.find(de=>{var ee;return((ee=de.partyName)==null?void 0:ee.trim().toUpperCase())===ae});return ge?xo(M,ge.statePartyDetails):""},j=(()=>{if(!q)return{entries:[],totals:{debit:0,credit:0,received:0,tds:0,balance:0}};const M=vi[q]||0,ae=K=>{if(!K)return"";const Fe=K.split("/");return Fe.length>=3?Fe.slice(1).join("/"):Fe.length===2?Fe.join("/"):Fe[Fe.length-1]},te=_e.filter(K=>qt(K.partyName,q)&&K.invoiceGenerated&&K.invoiceStatus==="Approved"&&(!we||_i(K.statePartyDetails)===we)),ge=be.filter(K=>qt(K.partyName,q)&&K.invoiceGenerated&&K.invoiceStatus==="Approved"&&(!we||_i(K.statePartyDetails)===we)),de=new Map;te.forEach(K=>{de.has(K.invoiceNo)?de.get(K.invoiceNo).campaigns.push(K):de.set(K.invoiceNo,{invoiceNo:K.invoiceNo,invoiceDate:K.invoiceDate,invoiceType:K.invoiceType,combinationCode:K.combinationCode,receiptStatus:K.receiptStatus,receiptNo:K.receiptNo,receiptDate:K.receiptDate,creditNoteNo:K.creditNoteNo,campaigns:[K],isFromMaster:!0})}),ge.forEach(K=>{de.has(K.invoiceNo)||de.set(K.invoiceNo,{invoiceNo:K.invoiceNo,invoiceDate:K.invoiceDate,invoiceType:"Service",combinationCode:"NA",receiptStatus:K.receiptStatus,receiptNo:K.receiptNo,receiptDate:K.receiptDate,creditNoteNo:K.creditNoteNo,campaigns:[K],isFromMaster:!1,isService:!0,serviceType:K.serviceType})});const ee=new Set(Array.from(de.keys())),Ve=we?[]:ie.filter(K=>{var Fe;return qt(K.partyName,q)&&K.isHistorical&&K.type!=="creditnote"&&!((Fe=K.vchNo)!=null&&Fe.toUpperCase().startsWith("CN"))}),oe=we?[]:ie.filter(K=>{var Fe;return qt(K.partyName,q)&&K.isHistorical&&(K.type==="creditnote"||((Fe=K.vchNo)==null?void 0:Fe.toUpperCase().startsWith("CN")))}),Ee=Be.filter(K=>qt(K.partyName,q)&&(!we||ee.has(K.invoiceNo))),De=ne.filter(K=>qt(K.partyName,q)&&(!we||ee.has(K.invoiceNo))),Xe=new Map;De.forEach(K=>{const Fe=ae(K.invoiceNo);Fe&&!Xe.has(Fe)&&Xe.set(Fe,{...K,isSystemCN:!0})}),oe.forEach(K=>{const Fe=ae(K.vchNo);Fe&&!Xe.has(Fe)&&Xe.set(Fe,{...K,isHistoricalCN:!0})});const Je=[];let ot=M,xt=0,Le=0,rt=0,Dt=0;const Tt=new Set;M!==0&&(Je.push({id:"opening",date:"",particular:"Opening Balance",vchType:"",vchNo:"",debit:M>0?M:0,credit:M<0?Math.abs(M):0,receiptDate:"",amountReceived:0,tdsReceived:0,balance:M,paymentStatus:"",isOpening:!0,subRows:[]}),xt+=M>0?M:0,Le+=M<0?Math.abs(M):0);const It=[];Array.from(de.values()).filter(K=>{const Fe=new Date(K.invoiceDate),Pt=new Date(an.fromDate),ht=new Date(an.toDate);return Fe>=Pt&&Fe<=ht}).forEach(K=>{It.push({...K,entryType:"invoice",sortDate:K.invoiceDate})}),Ve.filter(K=>{if(!K.date)return!1;const Fe=new Date(K.date),Pt=new Date(an.fromDate),ht=new Date(an.toDate);return Fe>=Pt&&Fe<=ht}).forEach(K=>{It.push({...K,entryType:K.type||"invoice",sortDate:K.date})}),It.sort((K,Fe)=>new Date(K.sortDate)-new Date(Fe.sortDate)),It.forEach(K=>{var Fe,Pt;if(K.isFromMaster){const ht=K;let Zt=0;ht.campaigns.forEach(la=>{Zt+=parseFloat(la.invoiceAmount)||0});const Gt=(Pt=(Fe=ht.campaigns[0])==null?void 0:Fe.statePartyDetails)==null?void 0:Pt.toUpperCase().includes("MAHARASHTRA"),Vt=Gt?Zt*.09:0,Nr=Gt?Zt*.09:0,Ar=Gt?0:Zt*.18,kr=Zt+Vt+Nr+Ar,kn=ae(ht.invoiceNo),Ct=Xe.get(kn),Cn=Ct?Math.abs(Ct.totalAmount||Ct.credit||0):0,Fn=!!Ct,bn=Fn&&Cn>=kr,Ei=Fn&&!bn?kr-Cn:0,xs=Ee.find(la=>la.invoiceNo===ht.invoiceNo);ot+=kr,xt+=kr;const vs=[{particular:"PROMOTIONAL TRADE EMAILER"+(ht.campaigns.length>1?"S":""),credit:Zt}];Gt?(vs.push({particular:"CGST",credit:Vt}),vs.push({particular:"SGST",credit:Nr})):vs.push({particular:"IGST",credit:Ar});let pn="",gn=0,Vn=0,Ay="",Tc=kr;if(xs?(pn="Received",gn=xs.amount||0,Vn=xs.tds||0,Ay=xs.date,rt+=gn,Dt+=Vn,Tc=kr-gn-Vn-(xs.discount||0),ot-=gn+Vn+(xs.discount||0)):ht.receiptStatus==="Received"?(pn="Received",Tc=0):bn?(pn="CN Closed",Tc=0):Fn&&Ei>0?(pn="Partial CN",Tc=Ei):pn="Pending",Je.push({id:ht.invoiceNo,date:ht.invoiceDate,particular:q,vchType:"Sales",vchNo:ht.invoiceNo,debit:kr,credit:0,receiptDate:Ay,amountReceived:gn,tdsReceived:Vn,balance:bn?"-":Tc>0?Tc:0,paymentStatus:pn,isInvoice:!0,hasCN:Fn,subRows:vs}),Ct&&!Tt.has(kn)){Tt.add(kn);const la=Math.abs(Ct.totalAmount||Ct.credit||0);ot-=la,Le+=la;const El=[];if(Ct.amount&&El.push({particular:"PROMOTIONAL TRADE EMAILER",credit:Math.abs(Ct.amount)}),Ct.gst&&El.push({particular:Ct.gstType||(Gt?"CGST + SGST":"IGST"),credit:Math.abs(Ct.gst)}),El.length===0&&la>0){const ky=la/1.18,Q4=la-ky;El.push({particular:"PROMOTIONAL TRADE EMAILER",credit:ky}),El.push({particular:Gt?"CGST + SGST":"IGST",credit:Q4})}Je.push({id:Ct.id||Ct.creditNoteNo||`cn-${kn}`,date:Ct.date,particular:q,vchType:"Credit Note",vchNo:Ct.creditNoteNo||Ct.vchNo,debit:0,credit:la,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:Ct.isHistoricalCN&&Ct.subRows||El})}}else if(K.isHistorical){const ht=K.debit||0,Zt=K.credit||0,Gt=ae(K.vchNo),Vt=Xe.get(Gt),Nr=Vt?Math.abs(Vt.totalAmount||Vt.credit||0):0,Ar=!!Vt,kr=Ar&&Nr>=ht,kn=Ar&&!kr?ht-Nr:0;ot+=ht-Zt,xt+=ht,Le+=Zt,K.amountReceived&&(rt+=K.amountReceived),K.tdsReceived&&(Dt+=K.tdsReceived);const Ct=K.subRows||[];let Cn=ht-(K.amountReceived||0)-(K.tdsReceived||0),Fn=K.paymentStatus||"";kr?(Cn=0,Fn="CN Closed"):Ar&&kn>0&&(Cn=kn-(K.amountReceived||0)-(K.tdsReceived||0),Cn>0&&(Fn="Partial CN")),Je.push({id:K.id,date:K.date,particular:K.particulars||q,vchType:K.vchType||"Sales",vchNo:K.vchNo,debit:ht,credit:Zt,receiptDate:K.receiptDate||"",amountReceived:K.amountReceived||0,tdsReceived:K.tdsReceived||0,balance:kr?"-":Cn>0?Cn:0,paymentStatus:Fn,isInvoice:!0,isHistorical:!0,hasCN:Ar,subRows:Ct}),Vt&&!Tt.has(Gt)&&(Tt.add(Gt),ot-=Nr,Le+=Nr,Je.push({id:Vt.id||Vt.creditNoteNo||Vt.vchNo||`cn-${Gt}`,date:Vt.date,particular:q,vchType:"Credit Note",vchNo:Vt.creditNoteNo||Vt.vchNo,debit:0,credit:Nr,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:Vt.subRows||[]}))}});const oa=Je.reduce((K,Fe)=>typeof Fe.balance=="number"&&Fe.balance>0?K+Fe.balance:K,0);return{entries:Je,totals:{debit:xt,credit:Le,received:rt,tds:Dt,balance:oa}}})();return c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Party Ledgers"}),c.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[c.jsx(qe,{icon:wo,label:"Export All",variant:"secondary",onClick:P4}),Sn&&c.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"}),dr&&c.jsx(qe,{icon:Hs,label:"Import Historical",variant:"brand",onClick:()=>Us(!0)}),dr&&q&&ie.some(M=>qt(M.partyName,q)&&M.isHistorical)&&c.jsx(qe,{icon:Ws,label:"Clear Historical",variant:"danger",onClick:qF}),dr&&c.jsx(qe,{icon:sd,label:"Opening Balance",variant:"primary",onClick:()=>er(!0)})]})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(Fj,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Period:"})]}),c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx("input",{type:"date",value:an.fromDate,onChange:M=>qr(ae=>({...ae,fromDate:M.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}}),c.jsx("span",{style:{color:"#64748B"},children:"to"}),c.jsx("input",{type:"date",value:an.toDate,onChange:M=>qr(ae=>({...ae,toDate:M.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}})]}),c.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:"10px"},children:q&&c.jsx(qe,{icon:wo,label:"Download PDF",variant:"brand",onClick:j4})})]})}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr",gap:"16px"},children:[c.jsxs(Zr,{title:"Parties",noPadding:!0,children:[c.jsx("div",{style:{padding:"12px",borderBottom:"1px solid #E2E8F0"},children:c.jsxs("div",{style:{position:"relative"},children:[c.jsx(z0,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",placeholder:"Search party...",value:Ca,onChange:M=>Ls(M.target.value),style:{width:"100%",padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",boxSizing:"border-box"}})]})}),c.jsx("div",{style:{maxHeight:"450px",overflowY:"auto"},children:_.length===0?c.jsx("div",{style:{padding:"30px",textAlign:"center",color:"#94A3B8",fontSize:"14px"},children:Ca?"No matching parties":"No parties yet"}):_.map((M,ae)=>{const te=h(M.partyName,M.normalizedState),ge=qt(q,M.partyName)&&we===M.normalizedState;return c.jsxs("div",{onClick:()=>{xe(M.partyName),je(M.normalizedState||null)},style:{padding:"14px 18px",borderBottom:"1px solid #F1F5F9",cursor:"pointer",backgroundColor:ge?"#EFF6FF":"transparent",borderLeft:ge?"4px solid #2874A6":"4px solid transparent"},children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"14px",color:"#1E293B"},children:M.partyName}),M.state&&c.jsxs("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"2px"},children:[" ",M.state]}),M.gstin&&c.jsxs("div",{style:{fontSize:"10px",color:"#2874A6",marginTop:"1px"},children:["GST: ",M.gstin]}),c.jsxs("div",{style:{fontSize:"14px",color:te>0?"#DC2626":"#059669",fontWeight:"700",marginTop:"4px"},children:[te>0?"Dr. ":"Cr. ",et(Math.abs(te))]})]},`${M.partyName}-${M.state}-${ae}`)})})]}),c.jsx(Zr,{title:q?"Ledger Account":"Select a Party",noPadding:!0,children:q?c.jsxs("div",{style:{fontSize:"12px"},children:[c.jsxs("div",{style:{textAlign:"center",padding:"16px",borderBottom:"2px solid #1E3A5F",backgroundColor:"#F8FAFC"},children:[c.jsx("div",{style:{fontSize:"16px",fontWeight:"700",color:"#1E3A5F"},children:S.name}),c.jsx("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"4px"},children:S.address}),c.jsxs("div",{style:{fontSize:"11px",color:"#64748B"},children:[S.addressLine2,", ",S.city]}),c.jsxs("div",{style:{fontSize:"11px",color:"#64748B"},children:["E-Mail: ",S.email]})]}),c.jsxs("div",{style:{textAlign:"center",padding:"12px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FFFFFF"},children:[c.jsx("div",{style:{fontSize:"14px",fontWeight:"700",color:"#1E293B"},children:q}),c.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#64748B"},children:"Ledger Account"}),Z(q)&&c.jsx("div",{style:{fontSize:"11px",color:"#475569",marginTop:"4px"},children:Z(q)}),z(q)&&c.jsxs("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"2px"},children:[" ",z(q)]}),B(q)&&c.jsxs("div",{style:{fontSize:"11px",color:"#2874A6",marginTop:"3px",fontWeight:"600"},children:["GSTIN: ",B(q)]})]}),c.jsx("div",{style:{textAlign:"center",padding:"8px",backgroundColor:"#F1F5F9",borderBottom:"1px solid #E2E8F0"},children:c.jsxs("span",{style:{fontSize:"11px",fontWeight:"600",color:"#475569"},children:[At(an.fromDate)," to ",At(an.toDate)]})}),c.jsxs("div",{style:{backgroundColor:"#1E293B",color:"white",padding:"12px 16px",display:"flex",justifyContent:"center",alignItems:"center",gap:"12px",borderBottom:"3px solid #F59E0B"},children:[c.jsx("span",{style:{fontSize:"14px",fontWeight:"600"},children:"Closing Balance:"}),c.jsxs("span",{style:{fontSize:"18px",fontWeight:"700",color:j.totals.balance>0?"#FCA5A5":"#86EFAC"},children:[zt(Math.abs(j.totals.balance))," ",j.totals.balance>0?"(Dr)":j.totals.balance<0?"(Cr)":""]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",backgroundColor:"#EFF6FF",borderBottom:"2px solid #2874A6",fontSize:"11px"},children:[c.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[c.jsx("div",{style:{color:"#64748B"},children:"Debit"}),c.jsx("div",{style:{fontWeight:"700",color:"#1E293B"},children:zt(j.totals.debit)})]}),c.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[c.jsx("div",{style:{color:"#64748B"},children:"Credit"}),c.jsx("div",{style:{fontWeight:"700",color:"#DC2626"},children:zt(j.totals.credit)})]}),c.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[c.jsx("div",{style:{color:"#64748B"},children:"Amount Received"}),c.jsx("div",{style:{fontWeight:"700",color:"#059669"},children:zt(j.totals.received)})]}),c.jsxs("div",{style:{padding:"8px",textAlign:"center"},children:[c.jsx("div",{style:{color:"#64748B"},children:"TDS Received"}),c.jsx("div",{style:{fontWeight:"700",color:"#1E293B"},children:zt(j.totals.tds)})]})]}),c.jsx("div",{style:{overflowX:"auto"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px",minWidth:"1000px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",width:"75px",borderRight:"1px solid #E2E8F0"},children:"Date"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",minWidth:"150px",borderRight:"1px solid #E2E8F0"},children:"Particular"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"80px",borderRight:"1px solid #E2E8F0"},children:"Vch Type"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",width:"110px",borderRight:"1px solid #E2E8F0"},children:"Vch No."}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Debit"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Credit"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"85px",borderRight:"1px solid #E2E8F0"},children:"Date of Receipt"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Amount Received"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"80px",borderRight:"1px solid #E2E8F0"},children:"TDS Received"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"85px",borderRight:"1px solid #E2E8F0"},children:"Balance"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"75px",borderRight:"1px solid #E2E8F0"},children:"Payment Status"}),dr&&c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"50px"},children:"Action"})]})}),c.jsx("tbody",{children:j.entries.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:dr?"12":"11",style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:"No entries in selected period"})}):j.entries.map(M=>c.jsxs(Z0.Fragment,{children:[c.jsxs("tr",{style:{backgroundColor:M.isOpening?"#FEF3C7":M.hasCN||M.isCreditNote?"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #E2E8F0",borderLeft:M.hasCN||M.isCreditNote?"4px solid #F59E0B":"none"},children:[c.jsx("td",{style:{padding:"8px",borderRight:"1px solid #E2E8F0"},children:M.date?At(M.date):""}),c.jsx("td",{style:{padding:"8px",fontWeight:"600",color:M.isCreditNote?"#DC2626":"#1E293B",borderRight:"1px solid #E2E8F0"},children:M.particular}),c.jsx("td",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #E2E8F0"},children:M.vchType&&c.jsx("span",{style:{padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:M.vchType==="Sales"?"#DCFCE7":"#FEE2E2",color:M.vchType==="Sales"?"#166534":"#991B1B"},children:M.vchType})}),c.jsx("td",{style:{padding:"8px",borderRight:"1px solid #E2E8F0"},children:M.vchNo&&M.isInvoice&&!M.isHistorical?c.jsx("button",{onClick:()=>o4(M.vchNo),style:{background:"none",border:"none",padding:0,fontWeight:"600",color:"#2874A6",cursor:"pointer",textDecoration:"underline",fontSize:"11px"},title:"Click to view invoice",children:M.vchNo}):c.jsx("span",{style:{fontWeight:"600",color:M.isCreditNote?"#DC2626":"#2874A6"},children:M.vchNo})}),c.jsx("td",{style:{padding:"8px",textAlign:"right",fontWeight:"600",borderRight:"1px solid #E2E8F0"},children:M.debit>0?zt(M.debit):""}),c.jsx("td",{style:{padding:"8px",textAlign:"right",color:"#DC2626",borderRight:"1px solid #E2E8F0"},children:M.credit>0?zt(M.credit):""}),c.jsx("td",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #E2E8F0"},children:M.receiptDate?At(M.receiptDate):""}),c.jsx("td",{style:{padding:"8px",textAlign:"right",color:"#059669",fontWeight:M.amountReceived>0?"600":"400",borderRight:"1px solid #E2E8F0"},children:M.amountReceived>0?zt(M.amountReceived):""}),c.jsx("td",{style:{padding:"8px",textAlign:"right",borderRight:"1px solid #E2E8F0"},children:M.tdsReceived>0?zt(M.tdsReceived):""}),c.jsx("td",{style:{padding:"8px",textAlign:"right",fontWeight:"600",color:typeof M.balance=="number"&&M.balance>0?"#DC2626":"",borderRight:"1px solid #E2E8F0"},children:M.isOpening?M.balance>0?zt(M.balance):"":M.balance==="-"?"-":typeof M.balance=="number"&&M.balance>0?zt(M.balance):"-"}),c.jsx("td",{style:{padding:"8px",textAlign:"center"},children:M.paymentStatus&&c.jsx("span",{style:{padding:"2px 8px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:M.paymentStatus==="Received"?"#DCFCE7":"#FEF3C7",color:M.paymentStatus==="Received"?"#166534":"#92400E"},children:M.paymentStatus})}),dr&&c.jsx("td",{style:{padding:"8px",textAlign:"center"},children:M.isHistorical&&!M.isOpening&&c.jsx("button",{onClick:()=>XF(ie.find(ae=>ae.id===M.id)),style:{padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete historical entry",children:""})})]}),M.subRows&&M.subRows.length>0&&M.subRows.map((ae,te)=>c.jsxs("tr",{style:{backgroundColor:M.isOpening?"#FEF3C7":M.hasCN||M.isCreditNote?"#FFFBEB":"#FFFFFF",borderBottom:te===M.subRows.length-1?"2px solid #CBD5E1":"1px solid #E2E8F0",borderLeft:M.hasCN||M.isCreditNote?"4px solid #F59E0B":"none"},children:[c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px 6px 30px",color:"#475569",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:ae.particular}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:ae.debit?zt(ae.debit):""}),c.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:ae.credit?zt(ae.credit):""}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),dr&&c.jsx("td",{style:{padding:"6px 8px"}})]},`${M.id}-sub-${te}`))]},M.id))})]})})]}):c.jsx("div",{style:{padding:"60px",textAlign:"center",color:"#94A3B8"},children:"Select a party to view ledger"})})]})]})},[Sc,wy]=ve.useState(""),l0=ve.useMemo(()=>{const h=new Map,_=B=>{if(!B)return"";const H=B.split("/");return H.length>=3?H.slice(1).join("/"):H.length===2?H.join("/"):H[H.length-1]},z=jn.filter(B=>{var H;return B.isHistorical&&(B.type==="creditnote"||((H=B.vchNo)==null?void 0:H.toUpperCase().startsWith("CN")))}),Z=new Map;return Bi.forEach(B=>{const H=_(B.invoiceNo);H&&Z.set(H,B)}),z.forEach(B=>{const H=_(B.vchNo);H&&!Z.has(H)&&Z.set(H,B)}),dn.filter(B=>B.invoiceGenerated&&B.invoiceStatus==="Approved").forEach(B=>{if(h.has(B.invoiceNo))h.has(B.invoiceNo)&&h.get(B.invoiceNo).campaigns.push(B);else{const H=Jn.find(ge=>ge.invoiceNo===B.invoiceNo),j=Bi.find(ge=>ge.invoiceNo===B.invoiceNo),M=parseFloat(B.invoiceTotalAmount)||0,ae=j?Math.abs(parseFloat(j.totalAmount)||parseFloat(j.credit)||0):0,te=j&&ae>=M;if(!H&&!te){const ge=j?M-ae:M;h.set(B.invoiceNo,{invoiceNo:B.invoiceNo,partyName:B.partyName,invoiceDate:B.invoiceDate,invoiceTotalAmount:B.invoiceTotalAmount,pendingAmount:ge,hasPartialCN:!!j&&!te&&ae>0,cnAmount:ae,subject:B.subject,campaigns:[B],isHistorical:!1,invoiceType:B.invoiceType||"Individual"})}}}),jn.filter(B=>{var H;return B.isHistorical&&B.type!=="creditnote"&&!((H=B.vchNo)!=null&&H.toUpperCase().startsWith("CN"))&&B.debit>0}).forEach(B=>{if(!h.has(B.vchNo)){const H=Jn.find(Ve=>Ve.invoiceNo===B.vchNo),j=_(B.vchNo),M=Z.get(j),ae=M?Math.abs(parseFloat(M.totalAmount)||parseFloat(M.credit)||parseFloat(M.debit)||0):0,te=parseFloat(B.debit)||0,ge=M&&ae>=te;if(H||ge)return;const de=!(B.amountReceived>0),ee=M&&ae>0&&ae<te;if(de||ee){const Ve=ee?te-ae:te;h.set(B.vchNo,{invoiceNo:B.vchNo,partyName:B.partyName,invoiceDate:B.date,invoiceTotalAmount:te,pendingAmount:Ve,hasPartialCN:ee,cnAmount:ae,subject:B.particulars||B.narration,campaigns:[],isHistorical:!0})}}}),Array.from(h.values()).sort((B,H)=>B.partyName.localeCompare(H.partyName))},[dn,Jn,Bi,jn]),$4=ve.useMemo(()=>{const h={};return xl.forEach(_=>{h[_.invoiceNo]||(h[_.invoiceNo]=[]),h[_.invoiceNo].push(_)}),Object.keys(h).forEach(_=>{h[_].sort((z,Z)=>new Date(Z.followupDate)-new Date(z.followupDate))}),h},[xl]),Sy=ve.useMemo(()=>{const h=new Date().toISOString().split("T")[0];return xl.filter(_=>_.nextFollowupDate&&_.nextFollowupDate>=h).sort((_,z)=>new Date(_.nextFollowupDate)-new Date(z.nextFollowupDate))},[xl]),c0=ve.useMemo(()=>{let h=l0;if(Sc){const z=Sc.toLowerCase();h=l0.filter(Z=>{var B,H,j;return((B=Z.invoiceNo)==null?void 0:B.toLowerCase().includes(z))||((H=Z.partyName)==null?void 0:H.toLowerCase().includes(z))||((j=Z.subject)==null?void 0:j.toLowerCase().includes(z))})}const _={};return h.forEach(z=>{_[z.partyName]||(_[z.partyName]={partyName:z.partyName,invoices:[],totalAmount:0}),_[z.partyName].invoices.push(z),_[z.partyName].totalAmount+=parseFloat(z.pendingAmount||z.invoiceTotalAmount)||0}),Object.values(_).sort((z,Z)=>z.partyName.localeCompare(Z.partyName))},[l0,Sc]),G4=()=>{const h=c0.reduce((_,z)=>_+z.invoices.length,0);return c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Followups"}),c.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[c.jsxs("span",{style:{padding:"6px 12px",backgroundColor:"#EFF6FF",borderRadius:"6px",fontSize:"12px",color:"#1E40AF",fontWeight:"600"},children:[c0.length," Parties | ",h," Invoices"]}),Sn&&c.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"})]})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(id,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Search:"})]}),c.jsxs("div",{style:{position:"relative",flex:1,maxWidth:"300px"},children:[c.jsx(z0,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",placeholder:"Search party, invoice, subject...",value:Sc,onChange:_=>wy(_.target.value),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"100%"}})]}),Sc&&c.jsxs("button",{onClick:()=>wy(""),style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(Ma,{size:14})," Clear"]}),Sc&&c.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",h," of ",l0.length]})]})}),Sy.length>0&&c.jsx(Zr,{title:" Upcoming Followups",style:{marginBottom:"16px"},children:c.jsx("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:Sy.slice(0,5).map(_=>c.jsxs("div",{style:{padding:"10px 14px",backgroundColor:new Date(_.nextFollowupDate).toISOString().split("T")[0]===new Date().toISOString().split("T")[0]?"#FEE2E2":"#FEF3C7",borderRadius:"8px",border:"1px solid #FCD34D"},children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#92400E"},children:_.invoiceNo}),c.jsx("div",{style:{fontSize:"11px",color:"#78716C"},children:_.partyName}),c.jsxs("div",{style:{fontSize:"12px",fontWeight:"600",color:"#DC2626",marginTop:"4px"},children:[" ",At(_.nextFollowupDate)]})]},_.id))})}),c0.length===0?c.jsx(Zr,{children:c.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:" No pending invoices! All payments received."})}):c0.map(_=>c.jsxs(Zr,{style:{marginBottom:"16px"},noPadding:!0,children:[c.jsxs("div",{style:{padding:"12px 16px",backgroundColor:"#1E293B",color:"white",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[c.jsxs("span",{style:{fontSize:"15px",fontWeight:"700"},children:[" ",_.partyName]}),c.jsxs("span",{style:{padding:"3px 10px",backgroundColor:"#3B82F6",borderRadius:"12px",fontSize:"11px",fontWeight:"600"},children:[_.invoices.length," Invoice",_.invoices.length>1?"s":""]})]}),c.jsxs("div",{style:{fontSize:"14px",fontWeight:"700",color:"#FCD34D"},children:["Total: ",et(_.totalAmount)]})]}),c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[c.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Type"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Invoice Date"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:"Amount"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Days Pending"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Last Followup"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),c.jsx("tbody",{children:_.invoices.map(z=>{var M,ae,te;const Z=$4[z.invoiceNo]||[],B=Z[0],H=Math.floor((new Date-new Date(z.invoiceDate))/(1e3*60*60*24)),j=z.isHistorical?"Historical":z.invoiceType||(((M=z.campaigns)==null?void 0:M.length)>1?"Combined":"Individual");return c.jsxs(Z0.Fragment,{children:[c.jsxs("tr",{style:{borderBottom:"1px solid #E2E8F0",backgroundColor:H>30?"#FEF2F2":H>15?"#FFFBEB":"#FFFFFF"},children:[c.jsxs("td",{style:{padding:"10px 12px",fontWeight:"600",color:"#2874A6"},children:[z.invoiceNo,z.hasPartialCN&&c.jsx("span",{style:{marginLeft:"6px",padding:"2px 6px",backgroundColor:"#FEF3C7",color:"#92400E",borderRadius:"4px",fontSize:"9px",fontWeight:"700"},children:"Partial CN"})]}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsx("span",{style:{padding:"3px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"600",backgroundColor:j==="Historical"?"#E0E7FF":j==="Combined"?"#F3E8FF":"#DCFCE7",color:j==="Historical"?"#3730A3":j==="Combined"?"#7C3AED":"#166534"},children:j})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:At(z.invoiceDate)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600"},children:z.hasPartialCN?c.jsxs("div",{children:[c.jsx("div",{style:{color:"#DC2626"},children:et(z.pendingAmount)}),c.jsx("div",{style:{fontSize:"9px",color:"#64748B",textDecoration:"line-through"},children:et(z.invoiceTotalAmount)})]}):et(z.invoiceTotalAmount)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsxs("span",{style:{padding:"3px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"700",backgroundColor:H>30?"#FEE2E2":H>15?"#FEF3C7":"#DCFCE7",color:H>30?"#991B1B":H>15?"#92400E":"#166534"},children:[H," days"]})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center",fontSize:"11px"},children:B?c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"600"},children:At(B.followupDate)}),c.jsxs("div",{style:{color:"#64748B",fontSize:"10px"},children:[(ae=B.notes)==null?void 0:ae.substring(0,30),((te=B.notes)==null?void 0:te.length)>30?"...":""]})]}):c.jsx("span",{style:{color:"#DC2626",fontWeight:"600"},children:"No followup yet"})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsxs("div",{style:{display:"flex",gap:"4px",justifyContent:"center"},children:[dr&&c.jsx(qe,{icon:sd,small:!0,variant:"primary",onClick:()=>QF(z),title:"Add Followup"}),c.jsx(qe,{icon:Yg,small:!0,variant:"brand",onClick:()=>ly(z),title:"Copy Email Template"}),c.jsx(qe,{icon:qg,small:!0,variant:"success",onClick:()=>cy(z),title:"Search in Gmail"})]})})]}),Z.length>0&&c.jsx("tr",{children:c.jsxs("td",{colSpan:"7",style:{padding:"8px 12px 12px 40px",backgroundColor:"#F8FAFC"},children:[c.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#64748B",marginBottom:"6px"},children:"Followup History:"}),c.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:Z.map(ge=>c.jsxs("div",{style:{padding:"6px 10px",backgroundColor:"#FFFFFF",borderRadius:"6px",border:"1px solid #E2E8F0",fontSize:"11px"},children:[c.jsx("div",{style:{fontWeight:"600",color:"#2874A6"},children:At(ge.followupDate)}),c.jsx("div",{style:{color:"#475569",marginTop:"2px"},children:ge.notes}),ge.nextFollowupDate&&c.jsxs("div",{style:{color:"#DC2626",marginTop:"2px",fontSize:"10px"},children:["Next: ",At(ge.nextFollowupDate)]}),dr&&c.jsx("button",{onClick:()=>ZF(ge.id),style:{background:"none",border:"none",color:"#DC2626",cursor:"pointer",fontSize:"10px",padding:"2px 0",marginTop:"4px"},children:" Delete"})]},ge.id))})]})})]},z.invoiceNo)})})]})]},_.partyName))]})},Ty=()=>{const h=_e.filter(B=>B.invoiceGenerated).reduce((B,H)=>B+(parseFloat(H.invoiceTotalAmount)||0),0),_=_e.filter(B=>B.invoiceStatus==="Paid").reduce((B,H)=>B+(parseFloat(H.invoiceTotalAmount)||0),0),z=_e.filter(B=>B.invoiceStatus==="Approved").reduce((B,H)=>B+(parseFloat(H.invoiceTotalAmount)||0),0),Z=_e.filter(B=>B.invoiceStatus==="Need Edits").length;return c.jsxs("div",{children:[c.jsx("h1",{style:{margin:"0 0 16px",fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Reports"}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px"},children:[c.jsxs(Zr,{children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Total Invoiced"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:et(h)})]}),c.jsxs(Zr,{children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Approved"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669"},children:et(z)})]}),c.jsxs(Zr,{children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Need Edits"}),c.jsxs("div",{style:{fontSize:"24px",fontWeight:"700",color:"#DC2626"},children:[Z," invoices"]})]}),c.jsxs(Zr,{children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Paid"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669"},children:et(_)})]})]})]})},K4=()=>c.jsxs("div",{children:[c.jsx("h1",{style:{margin:"0 0 16px",fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Settings"}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[c.jsxs(Zr,{title:" Invoice Series",children:[c.jsx(Cr,{label:"Invoice Prefix",value:S.invoicePrefix,onChange:h=>I(_=>({..._,invoicePrefix:h.target.value})),small:!0}),c.jsx(Cr,{label:"Next Invoice Number",type:"number",value:Ie,onChange:h=>Ae(parseInt(h.target.value)||1),small:!0}),c.jsx(Cr,{label:"Next Combine Code",type:"number",value:nt,onChange:h=>J(parseInt(h.target.value)||1),small:!0}),c.jsxs("div",{style:{padding:"10px",backgroundColor:"#EFF6FF",borderRadius:"8px",fontSize:"14px"},children:[c.jsx("strong",{children:"Preview:"})," ",S.invoicePrefix,Ie]})]}),c.jsxs(Zr,{title:" Mailer Logo",children:[c.jsx("input",{type:"file",ref:Na,accept:"image/*",style:{display:"none"},onChange:_4}),Ut?c.jsxs("div",{style:{textAlign:"center"},children:[c.jsx("img",{src:Ut,alt:"Logo",style:{maxWidth:"250px",maxHeight:"60px",marginBottom:"12px",border:"1px solid #E2E8F0",padding:"8px",borderRadius:"8px"}}),c.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"center"},children:[c.jsx(qe,{icon:Mj,label:"Change",small:!0,onClick:()=>{var h;return(h=Na.current)==null?void 0:h.click()}}),c.jsx(qe,{icon:Ws,label:"Remove",variant:"danger",small:!0,onClick:()=>Ia(null)})]})]}):c.jsxs("div",{onClick:()=>{var h;return(h=Na.current)==null?void 0:h.click()},style:{border:"2px dashed #CBD5E1",borderRadius:"10px",padding:"30px",textAlign:"center",cursor:"pointer"},children:[c.jsx(Hs,{size:32,color:"#94A3B8",style:{marginBottom:"8px"}}),c.jsx("p",{style:{margin:0,color:"#64748B",fontSize:"14px"},children:"Click to upload"})]})]}),c.jsxs(Zr,{title:" WhatsApp Notifications",children:[c.jsx("div",{style:{marginBottom:"16px"},children:c.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"10px",cursor:"pointer"},children:[c.jsx("input",{type:"checkbox",checked:st.enabled,onChange:h=>Bs(_=>({..._,enabled:h.target.checked})),style:{width:"18px",height:"18px",cursor:"pointer"}}),c.jsx("span",{style:{fontSize:"14px",fontWeight:"600",color:"#1E293B"},children:"Enable WhatsApp Notifications"})]})}),st.enabled&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{style:{padding:"12px",backgroundColor:"#DCFCE7",borderRadius:"8px",marginBottom:"16px",fontSize:"12px",color:"#166534",border:"1px solid #86EFAC"},children:[c.jsx("strong",{children:" FREE Setup using CallMeBot:"}),c.jsx("br",{}),"1. Save this number in contacts: ",c.jsx("strong",{children:"+34 644 71 81 99"}),c.jsx("br",{}),"2. Send this message to the number on WhatsApp: ",c.jsx("strong",{children:'"I allow callmebot to send me messages"'}),c.jsx("br",{}),"3. You'll receive an API key - enter it below",c.jsx("br",{}),"4. Repeat for each phone number you want to receive notifications"]}),c.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",marginBottom:"12px",border:"1px solid #E2E8F0"},children:[c.jsxs("div",{style:{fontSize:"13px",fontWeight:"700",color:"#1E293B",marginBottom:"10px",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(V0,{size:16})," Finance Team"]}),c.jsx(Cr,{label:"Phone (with country code)",value:st.financePhone,onChange:h=>Bs(_=>({..._,financePhone:h.target.value})),placeholder:"919876543210",small:!0}),c.jsx(Cr,{label:"API Key (from CallMeBot)",value:st.financeApiKey,onChange:h=>Bs(_=>({..._,financeApiKey:h.target.value})),placeholder:"123456",small:!0}),st.financePhone&&st.financeApiKey&&c.jsx(qe,{icon:Q2,label:"Test Finance",variant:"success",small:!0,onClick:()=>vc(st.financePhone,st.financeApiKey)})]}),c.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",border:"1px solid #E2E8F0"},children:[c.jsxs("div",{style:{fontSize:"13px",fontWeight:"700",color:"#1E293B",marginBottom:"10px",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(V0,{size:16})," Director"]}),c.jsx(Cr,{label:"Phone (with country code)",value:st.directorPhone,onChange:h=>Bs(_=>({..._,directorPhone:h.target.value})),placeholder:"919876543210",small:!0}),c.jsx(Cr,{label:"API Key (from CallMeBot)",value:st.directorApiKey,onChange:h=>Bs(_=>({..._,directorApiKey:h.target.value})),placeholder:"123456",small:!0}),st.directorPhone&&st.directorApiKey&&c.jsx(qe,{icon:Q2,label:"Test Director",variant:"success",small:!0,onClick:()=>vc(st.directorPhone,st.directorApiKey)})]})]}),!st.enabled&&c.jsx("div",{style:{padding:"20px",backgroundColor:"#F8FAFC",borderRadius:"8px",textAlign:"center",color:"#64748B",fontSize:"13px"},children:"WhatsApp notifications are disabled. Enable to receive FREE alerts for invoices, approvals, and payments."})]}),c.jsxs(Zr,{title:" Default Invoice Values",children:[c.jsx("input",{type:"file",ref:mo,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:t4}),c.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[c.jsx(qe,{icon:Hs,label:"Upload",variant:"brand",small:!0,onClick:()=>{var h;return(h=mo.current)==null?void 0:h.click()}}),c.jsx(qe,{icon:wo,label:"Template",small:!0,onClick:r4})]}),Object.keys(yi).length>0&&c.jsx("div",{style:{maxHeight:"180px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"8px"},children:Object.entries(yi).map(([h,_])=>c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px 14px",borderBottom:"1px solid #F1F5F9",fontSize:"13px"},children:[c.jsx("span",{children:h}),c.jsx("span",{style:{fontWeight:"700"},children:et(_)})]},h))})]}),c.jsxs(Zr,{title:" Party Master",children:[c.jsx("input",{type:"file",ref:e0,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:n4}),c.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[c.jsx(qe,{icon:Hs,label:"Upload Parties",variant:"brand",small:!0,onClick:()=>{var h;return(h=e0.current)==null?void 0:h.click()}}),c.jsx(qe,{icon:wo,label:"Template",small:!0,onClick:i4})]}),c.jsxs("div",{style:{padding:"10px",backgroundColor:"#EFF6FF",borderRadius:"8px",fontSize:"12px",color:"#1E40AF",marginBottom:"12px"},children:[c.jsx("strong",{children:"Upload Format:"})," Name of Ledger, Ledger Group, State Name, GST Registration Type, GSTIN/UIN"]}),Object.keys(un).length>0&&c.jsxs("div",{style:{maxHeight:"150px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"8px"},children:[Object.entries(un).slice(0,20).map(([h,_])=>c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 12px",borderBottom:"1px solid #F1F5F9",fontSize:"11px"},children:[c.jsx("span",{style:{fontWeight:"600"},children:h.length>30?h.substring(0,30)+"...":h}),c.jsxs("span",{style:{color:"#64748B"},children:[_.stateName||"-"," | ",_.gstin?_.gstin.substring(0,10)+"...":"-"]})]},h)),Object.keys(un).length>20&&c.jsxs("div",{style:{padding:"8px 12px",textAlign:"center",color:"#64748B",fontSize:"11px"},children:["... and ",Object.keys(un).length-20," more parties"]})]}),Object.keys(un).length===0&&c.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#94A3B8",fontSize:"13px"},children:"No party master uploaded yet"})]}),c.jsxs(Zr,{title:" Data Management",children:[c.jsxs("div",{style:{padding:"16px",backgroundColor:"#FEF2F2",borderRadius:"10px",border:"1px solid #FCA5A5",marginBottom:"16px"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"14px",marginBottom:"8px"},children:" Danger Zone"}),c.jsxs("div",{style:{fontSize:"13px",color:"#7F1D1D",marginBottom:"16px"},children:["This will permanently delete all data including:",c.jsxs("ul",{style:{margin:"8px 0 0 16px",padding:0},children:[c.jsx("li",{children:"All campaigns and master data"}),c.jsx("li",{children:"All invoices and receipts"}),c.jsx("li",{children:"All ledger entries"}),c.jsx("li",{children:"All mailer images"}),c.jsx("li",{children:"Opening balances and settings"})]})]}),c.jsx(qe,{icon:Ws,label:"Clear All Data",variant:"danger",onClick:()=>Ms(!0)})]}),c.jsxs("div",{style:{fontSize:"12px",color:"#64748B"},children:[c.jsx("strong",{children:"Current Data:"}),c.jsx("br",{})," ",_e.length," campaigns",c.jsx("br",{})," ",ie.length," ledger entries",c.jsx("br",{})," ",Be.length," receipts",c.jsx("br",{})," ",Object.keys(Bn).length," mailer images"]})]})]})]}),Y4=()=>c.jsxs(c.Fragment,{children:[c.jsx(In,{isOpen:E4,onClose:()=>{hy(!1),gy("")},title:" Invoice Preview",width:"950px",children:ce&&py&&c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px",padding:"14px 18px",backgroundColor:"#DCFCE7",borderRadius:"10px",border:"2px solid #22C55E"},children:[c.jsxs("div",{children:[c.jsxs("span",{style:{fontWeight:"700",fontSize:"16px",color:"#166534"},children:["Invoice: ",ce.invoiceNo]}),ce.invoiceType==="Combined"&&c.jsxs("span",{style:{marginLeft:"12px",padding:"4px 10px",backgroundColor:"#7C3AED",color:"white",borderRadius:"6px",fontSize:"12px",fontWeight:"600"},children:["Combined - C",ce.combinationCode]})]}),c.jsxs("button",{onClick:()=>S4(ce),style:{padding:"14px 28px",fontSize:"16px",fontWeight:"bold",border:"none",borderRadius:"10px",cursor:"pointer",backgroundColor:"#22C55E",color:"white",display:"flex",alignItems:"center",gap:"10px",boxShadow:"0 2px 8px rgba(34, 197, 94, 0.4)"},children:[c.jsx(wo,{size:20}),"Download Invoice"]})]}),c.jsx("div",{style:{border:"2px solid #E2E8F0",borderRadius:"10px",overflow:"hidden",backgroundColor:"#f5f5f5"},children:c.jsx("iframe",{id:"invoice-viewer-iframe",srcDoc:py,style:{width:"100%",height:"480px",border:"none",backgroundColor:"white"},title:"Invoice Preview"})}),c.jsxs("div",{style:{marginTop:"12px",padding:"14px 18px",backgroundColor:"#FEF3C7",borderRadius:"10px",border:"1px solid #FCD34D"},children:[c.jsx("div",{style:{fontSize:"14px",color:"#92400E",fontWeight:"600",marginBottom:"6px"},children:" How to Save as PDF:"}),c.jsxs("ol",{style:{fontSize:"13px",color:"#92400E",margin:"0",paddingLeft:"20px",lineHeight:"1.8"},children:[c.jsxs("li",{children:["Click ",c.jsx("strong",{children:'"Download Invoice"'})," button above"]}),c.jsxs("li",{children:["Open the downloaded ",c.jsx("strong",{children:".html file"})," in Chrome/Edge browser"]}),c.jsxs("li",{children:["Print dialog will open automatically - select ",c.jsx("strong",{children:'"Save as PDF"'})]}),c.jsxs("li",{children:["Click ",c.jsx("strong",{children:"Save"})," to get your PDF!"]})]})]})]})}),c.jsx(In,{isOpen:mr,onClose:()=>{xr(!1),Di(""),sa({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1})},title:Sn?" Review & Approve Invoice":" Invoice Details",width:"550px",children:ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",ce.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",ce.partyName]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Amount:"})," ",et(ce.invoiceTotalAmount)]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Email:"})," ",ce.emailId||"Not set"]}),c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Invoice Type:"})," ",c.jsx("span",{style:{color:ce.invoiceType==="Combined"?"#7C3AED":"#2874A6",fontWeight:"600"},children:ce.invoiceType||"Individual"})]}),ce.invoiceType==="Combined"&&c.jsxs("div",{style:{marginTop:"8px",fontSize:"13px",color:"#7C3AED"},children:[c.jsx("strong",{children:"Combined Campaigns:"})," ",v(ce).map(h=>h.senderName).join(", ")]})]}),ce.editComments&&c.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[c.jsx("div",{style:{fontWeight:"600",color:"#991B1B",fontSize:"13px",marginBottom:"4px"},children:" Need Edits - Director Remarks:"}),c.jsx("div",{style:{fontSize:"13px",color:"#7F1D1D"},children:ce.editComments})]}),ce.approvalRemarks&&ce.invoiceStatus==="Approved"&&c.jsxs("div",{style:{backgroundColor:"#DCFCE7",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[c.jsx("div",{style:{fontWeight:"600",color:"#166534",fontSize:"13px",marginBottom:"4px"},children:" Approved - Director Remarks:"}),c.jsx("div",{style:{fontSize:"13px",color:"#15803D"},children:ce.approvalRemarks})]}),Sn?c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#166534",fontSize:"14px",marginBottom:"12px"},children:" Approval Confirmations"}),c.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",marginBottom:"12px",cursor:"pointer"},children:[c.jsx("input",{type:"checkbox",checked:ba.particularsApproved,onChange:h=>sa(_=>({..._,particularsApproved:h.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"1. Particulars & Amount Approved"}),c.jsxs("div",{style:{fontSize:"12px",color:"#15803D"},children:["I confirm that the invoice particulars and amount (",et(ce.invoiceTotalAmount),") are correct."]})]})]}),c.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",marginBottom:"12px",cursor:"pointer"},children:[c.jsx("input",{type:"checkbox",checked:ba.emailApproved,onChange:h=>sa(_=>({..._,emailApproved:h.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"2. Email ID Approved for Mailing"}),c.jsxs("div",{style:{fontSize:"12px",color:"#15803D"},children:["I confirm that ",c.jsx("strong",{children:ce.emailId||"the specified email"})," should be used for mailing."]})]})]}),c.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",cursor:"pointer"},children:[c.jsx("input",{type:"checkbox",checked:ba.invoiceTypeApproved,onChange:h=>sa(_=>({..._,invoiceTypeApproved:h.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"3. Invoice Type Confirmed"}),c.jsx("div",{style:{fontSize:"12px",color:"#15803D"},children:ce.invoiceType==="Combined"?`I confirm that a Combined Invoice is required for these ${v(ce).length} campaigns.`:"I confirm that an Individual Invoice is required (not combined with others)."})]})]})]}):c.jsxs("div",{style:{backgroundColor:ce.invoiceStatus==="Approved"?"#DCFCE7":ce.invoiceStatus==="Need Edits"?"#FEF3C7":"#F8FAFC",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid "+(ce.invoiceStatus==="Approved"?"#86EFAC":ce.invoiceStatus==="Need Edits"?"#FCD34D":"#E2E8F0")},children:[c.jsx("div",{style:{fontWeight:"600",color:ce.invoiceStatus==="Approved"?"#166534":ce.invoiceStatus==="Need Edits"?"#92400E":"#64748B",fontSize:"14px"},children:ce.invoiceStatus==="Approved"?" Approved by Director":ce.invoiceStatus==="Need Edits"?" Edits Required by Director":" Pending Director Approval"}),c.jsx("div",{style:{fontSize:"13px",color:ce.invoiceStatus==="Approved"?"#15803D":ce.invoiceStatus==="Need Edits"?"#A16207":"#64748B",marginTop:"6px"},children:ce.invoiceStatus==="Approved"?"This invoice has been approved and is ready for mailing.":ce.invoiceStatus==="Need Edits"?"Please make the required changes and resubmit for approval.":"This invoice is awaiting Director approval."})]}),Sn&&c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:" Remarks (optional for Approve, visible to Finance)"}),c.jsx("textarea",{value:ia,onChange:h=>Di(h.target.value),placeholder:"Enter remarks or comments...",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(qe,{label:"Close",onClick:()=>{xr(!1),Di(""),sa({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1})}}),Sn&&c.jsxs(c.Fragment,{children:[c.jsx(qe,{label:"Need Edits",variant:"danger",icon:Pj,onClick:Ht}),c.jsx(qe,{label:"Approve",variant:"success",icon:Bj,onClick:fn})]})]})]})}),c.jsx(In,{isOpen:Sr,onClose:()=>xi(!1),title:" Delete Invoice",width:"450px",children:ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"15px",marginBottom:"8px"},children:" Are you sure?"}),c.jsxs("div",{style:{fontSize:"14px",color:"#7F1D1D",lineHeight:"1.5"},children:["This will delete invoice ",c.jsx("strong",{children:ce.invoiceNo})," and reset the campaign(s) to allow re-generation.",ce.invoiceType==="Combined"&&c.jsxs("div",{style:{marginTop:"8px"},children:[c.jsxs("strong",{children:["All ",v(ce).length," combined campaigns"]})," will be reset to Individual type for re-selection."]})]})]}),c.jsxs("div",{style:{backgroundColor:"#F8FAFC",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"Invoice:"})," ",ce.invoiceNo]}),c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"Party:"})," ",ce.partyName]}),c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"Amount:"})," ",et(ce.invoiceTotalAmount)]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(qe,{label:"Cancel",onClick:()=>xi(!1)}),c.jsx(qe,{label:"Delete Invoice",variant:"danger",icon:Ws,onClick:GF})]})]})}),c.jsx(In,{isOpen:mi,onClose:()=>ft(!1),title:" Add Email Address",width:"400px",children:ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"Campaign:"})," ",ce.senderName]}),c.jsxs("div",{style:{fontSize:"13px",marginTop:"4px"},children:[c.jsx("strong",{children:"Current:"})," ",ce.emailId||"None"]})]}),c.jsx(Cr,{label:"Additional Email Address",type:"email",value:ka,onChange:h=>na(h.target.value),placeholder:"email@example.com",small:!0}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:[c.jsx(qe,{label:"Cancel",onClick:()=>ft(!1)}),c.jsx(qe,{label:"Add Email",variant:"brand",icon:q2,onClick:()=>{ka&&ka.includes("@")?(me(ce.id,ka),ft(!1),na("")):alert("Please enter a valid email address")}})]})]})}),c.jsx(In,{isOpen:k,onClose:()=>{E(!1),Y({currentPassword:"",newPassword:"",confirmPassword:""}),T("")},title:" Change Password",width:"400px",children:c.jsxs("div",{children:[c.jsx("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"User:"})," ",r==="director"?"Director":"Finance Team"]})}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Current Password"}),c.jsx("input",{type:"password",value:P.currentPassword,onChange:h=>Y(_=>({..._,currentPassword:h.target.value})),placeholder:"Enter current password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"New Password"}),c.jsx("input",{type:"password",value:P.newPassword,onChange:h=>Y(_=>({..._,newPassword:h.target.value})),placeholder:"Enter new password (min 6 characters)",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Confirm New Password"}),c.jsx("input",{type:"password",value:P.confirmPassword,onChange:h=>Y(_=>({..._,confirmPassword:h.target.value})),placeholder:"Confirm new password",onKeyPress:h=>h.key==="Enter"&&_c(),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),V&&c.jsx("div",{style:{marginBottom:"16px",padding:"10px",backgroundColor:"#FEE2E2",borderRadius:"8px",color:"#991B1B",fontSize:"13px"},children:V}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[c.jsx(qe,{label:"Cancel",onClick:()=>{E(!1),Y({currentPassword:"",newPassword:"",confirmPassword:""}),T("")}}),c.jsx(qe,{label:"Change Password",variant:"brand",icon:U0,onClick:_c})]})]})}),c.jsx(In,{isOpen:k,onClose:()=>{E(!1),T(""),Y({currentPassword:"",newPassword:"",confirmPassword:""})},title:" Change Password",width:"400px",children:c.jsxs("div",{children:[c.jsx("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:c.jsxs("div",{style:{fontSize:"13px",color:"#1E40AF"},children:["Changing password for: ",c.jsx("strong",{children:r==="director"?"Director":"Finance Team"})]})}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Current Password"}),c.jsx("input",{type:"password",value:P.currentPassword,onChange:h=>Y(_=>({..._,currentPassword:h.target.value})),placeholder:"Enter current password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"New Password"}),c.jsx("input",{type:"password",value:P.newPassword,onChange:h=>Y(_=>({..._,newPassword:h.target.value})),placeholder:"Enter new password (min 6 chars)",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Confirm New Password"}),c.jsx("input",{type:"password",value:P.confirmPassword,onChange:h=>Y(_=>({..._,confirmPassword:h.target.value})),placeholder:"Re-enter new password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),V&&c.jsx("div",{style:{marginBottom:"16px",padding:"10px",backgroundColor:"#FEE2E2",borderRadius:"8px",color:"#991B1B",fontSize:"13px"},children:V}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[c.jsx(qe,{label:"Cancel",onClick:()=>{E(!1),T(""),Y({currentPassword:"",newPassword:"",confirmPassword:""})}}),c.jsx(qe,{label:"Change Password",variant:"brand",icon:U0,onClick:_c})]})]})}),c.jsx(In,{isOpen:br,onClose:()=>{gr(!1),aa(new Set),js(null)},title:" Combine Invoices",width:"700px",children:pc&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#F3E8FF",padding:"14px 18px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"15px",fontWeight:"700",color:"#6B21A8"},children:["Party: ",pc]}),c.jsx("div",{style:{fontSize:"13px",color:"#7C3AED",marginTop:"4px"},children:"Select 2+ campaigns to combine into a single invoice"})]}),c.jsx("div",{style:{maxHeight:"350px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"10px"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",position:"sticky",top:0},children:[c.jsx("th",{style:{padding:"12px",textAlign:"center",width:"50px"},children:""}),c.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Sender"}),c.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Subject"}),c.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Date"}),c.jsx("th",{style:{padding:"12px",textAlign:"right"},children:"Amount"})]})}),c.jsx("tbody",{children:yo(pc).map(h=>{var _;return c.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:cn.has(h.id)?"#F3E8FF":"transparent",cursor:"pointer"},onClick:()=>g4(h.id),children:[c.jsx("td",{style:{padding:"12px",textAlign:"center"},children:c.jsx("input",{type:"checkbox",checked:cn.has(h.id),onChange:()=>{},style:{width:"18px",height:"18px",cursor:"pointer"}})}),c.jsx("td",{style:{padding:"12px",fontWeight:"600"},children:h.senderName}),c.jsxs("td",{style:{padding:"12px",color:"#64748B"},children:[(_=h.subject)==null?void 0:_.substring(0,35),"..."]}),c.jsx("td",{style:{padding:"12px"},children:At(h.date)}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:et(h.totalWithGst)})]},h.id)})})]})}),c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px 18px",borderRadius:"10px",marginTop:"16px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsxs("div",{style:{fontSize:"14px",color:"#64748B"},children:["Selected: ",c.jsx("strong",{children:cn.size})," | Combine Code: ",c.jsxs("strong",{children:["C",nt]})]}),c.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#2874A6"},children:["Total: ",et(_e.filter(h=>cn.has(h.id)).reduce((h,_)=>h+(parseFloat(_.totalWithGst)||0),0))]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[c.jsx(qe,{label:"Cancel",onClick:()=>{gr(!1),aa(new Set)}}),c.jsx(qe,{label:"Create Combined Invoice",variant:"purple",icon:wl,disabled:cn.size<2,onClick:p4})]})]})}),c.jsxs(In,{isOpen:Ln,onClose:()=>{sn(!1),hs(null),hl(!1)},title:Vu?" Replace Mailer":" Upload Mailer",width:"550px",children:[c.jsx("input",{type:"file",ref:Wu,accept:"image/*",style:{display:"none"},onChange:x4}),ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"14px"},children:[c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Sender:"})," ",ce.senderName]}),c.jsxs("div",{style:{fontSize:"14px",marginTop:"4px"},children:[c.jsx("strong",{children:"Subject:"})," ",ce.subject]})]}),Vu&&Bn[ce.id]&&c.jsx("div",{style:{backgroundColor:"#FEF3C7",padding:"12px",borderRadius:"10px",marginBottom:"14px",border:"1px solid #FCD34D"},children:c.jsxs("div",{style:{fontWeight:"600",color:"#92400E",fontSize:"13px"},children:[" This will replace ",Bn[ce.id].length," existing image(s)"]})}),c.jsxs("div",{style:{backgroundColor:"#FEF3C7",padding:"14px",borderRadius:"10px",marginBottom:"14px",border:"1px solid #FCD34D"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#92400E",marginBottom:"8px",fontSize:"14px"},children:"Step 1: Find Mailer in Gmail"}),c.jsxs("button",{onClick:()=>y4(ce.subject),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 18px",backgroundColor:"#EA4335",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:[c.jsx(Rj,{size:16})," Search in Gmail"]})]}),c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"14px",borderRadius:"10px",border:"1px solid #86EFAC"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#166534",marginBottom:"8px",fontSize:"14px"},children:"Step 2: Paste Screenshot"}),c.jsx("div",{ref:Hu,tabIndex:0,onPaste:v4,onClick:()=>{var h;return(h=Hu.current)==null?void 0:h.focus()},style:{border:fs?"3px solid #22C55E":"3px dashed #22C55E",borderRadius:"10px",padding:fs?"8px":"30px",textAlign:"center",cursor:"pointer",backgroundColor:fs?"#FFFFFF":"#ECFDF5",minHeight:"100px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",outline:"none"},children:fs?c.jsxs(c.Fragment,{children:[c.jsx("img",{src:fs,alt:"Pasted",style:{maxWidth:"100%",maxHeight:"200px",borderRadius:"8px",marginBottom:"10px"}}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsx(qe,{icon:Gg,label:"Save",variant:"success",onClick:()=>dy(fs)}),c.jsx(qe,{icon:Ws,label:"Clear",variant:"danger",onClick:()=>hs(null)})]})]}):c.jsxs(c.Fragment,{children:[c.jsx(Yg,{size:36,color:"#22C55E",style:{marginBottom:"8px"}}),c.jsx("div",{style:{fontWeight:"700",fontSize:"14px",color:"#166534"},children:"Click here & Press Ctrl+V"})]})}),c.jsxs("div",{style:{textAlign:"center",marginTop:"12px"},children:[c.jsx("span",{style:{color:"#64748B",fontSize:"13px"},children:" OR "}),c.jsx("div",{style:{marginTop:"8px"},children:c.jsx(qe,{icon:Hs,label:"Browse Files",onClick:()=>{var h;return(h=Wu.current)==null?void 0:h.click()}})})]})]})]})]}),c.jsx(In,{isOpen:bi,onClose:()=>ls(!1),title:" Send Invoice Email",width:"600px",children:ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",gap:"0",marginBottom:"16px",border:"2px solid #E2E8F0",borderRadius:"8px",overflow:"hidden"},children:[c.jsx("button",{onClick:()=>cs("reply"),style:{flex:1,padding:"12px",backgroundColor:Ri==="reply"?"#2874A6":"#F8FAFC",color:Ri==="reply"?"white":"#64748B",border:"none",cursor:"pointer",fontWeight:"700",fontSize:"14px"},children:" Reply to Thread"}),c.jsx("button",{onClick:()=>cs("new"),style:{flex:1,padding:"12px",backgroundColor:Ri==="new"?"#2874A6":"#F8FAFC",color:Ri==="new"?"white":"#64748B",border:"none",cursor:"pointer",fontWeight:"700",fontSize:"14px"},children:" New Email"})]}),c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",ce.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Amount:"})," ",et(ce.invoiceTotalAmount||ce.totalWithGst)]}),ce.invoiceType==="Combined"&&c.jsxs("div",{style:{fontSize:"13px",marginTop:"8px",color:"#7C3AED"},children:[c.jsx("strong",{children:"Campaigns:"})," ",v(ce).map(h=>h.senderName).join(", ")]}),c.jsx("div",{style:{fontSize:"14px",marginTop:"8px"},children:c.jsx("strong",{children:"Recipients:"})}),c.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",marginTop:"6px"},children:[le(ce).map((h,_)=>c.jsx("span",{style:{padding:"4px 10px",backgroundColor:"#DBEAFE",borderRadius:"6px",fontSize:"13px",color:"#1E40AF"},children:h},_)),le(ce).length===0&&c.jsx("span",{style:{color:"#94A3B8"},children:"No email addresses"})]})]}),Ri==="reply"?c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[c.jsx("span",{style:{fontWeight:"700",fontSize:"14px"},children:"Email Body:"}),c.jsx("button",{onClick:()=>{navigator.clipboard.writeText(o0(ce)),alert(" Copied!")},style:{padding:"6px 14px",backgroundColor:"#22C55E",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"600"},children:" Copy"})]}),c.jsx("div",{style:{fontSize:"13px",backgroundColor:"#F8FAFC",padding:"14px",borderRadius:"10px",whiteSpace:"pre-wrap",maxHeight:"200px",overflowY:"auto",fontFamily:"monospace",border:"1px solid #E2E8F0",lineHeight:"1.5"},children:o0(ce)})]}):c.jsxs("div",{style:{display:"flex",gap:"10px"},children:[c.jsx("button",{onClick:()=>{const h=le(ce),_=encodeURIComponent(h.join(",")),z=encodeURIComponent(fy(ce)),Z=encodeURIComponent(o0(ce));window.open(`https://mail.google.com/mail/?view=cm&to=${_}&su=${z}&body=${Z}`,"_blank")},style:{padding:"12px 20px",backgroundColor:"#EA4335",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"700"},children:" Open Gmail"}),c.jsx("button",{onClick:()=>{const h=le(ce),_=encodeURIComponent(h.join(";")),z=encodeURIComponent(fy(ce)),Z=encodeURIComponent(o0(ce));window.open(`https://outlook.live.com/mail/0/deeplink/compose?to=${_}&subject=${z}&body=${Z}`,"_blank")},style:{padding:"12px 20px",backgroundColor:"#0078D4",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"700"},children:" Open Outlook"})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[c.jsx(qe,{label:"View Invoice",icon:j0,onClick:()=>{ls(!1),Ku(ce)}}),c.jsx(qe,{label:"Close",onClick:()=>ls(!1)})]})]})}),c.jsx(In,{isOpen:Ii,onClose:()=>Hr(!1),title:" Record Payment",width:"500px",children:ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Invoice:"})," ",ce.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginTop:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",ce.partyName]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsx(Cr,{label:"Payment Amount",type:"number",value:Tr.amount,onChange:h=>go({...Tr,amount:h.target.value}),small:!0}),c.jsx(Cr,{label:"Date",type:"date",value:Tr.date,onChange:h=>go({...Tr,date:h.target.value}),small:!0})]}),c.jsx(q0,{label:"Payment Mode",value:Tr.mode,onChange:h=>go({...Tr,mode:h.target.value}),options:[{value:"Bank",label:"Bank Transfer"},{value:"UPI",label:"UPI"},{value:"Cheque",label:"Cheque"},{value:"Cash",label:"Cash"}],small:!0}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsx(Cr,{label:"TDS Deducted",type:"number",value:Tr.tds,onChange:h=>go({...Tr,tds:h.target.value}),placeholder:"0",small:!0}),c.jsx(Cr,{label:"Discount",type:"number",value:Tr.discount,onChange:h=>go({...Tr,discount:h.target.value}),placeholder:"0",small:!0})]}),c.jsx(Cr,{label:"Narration",value:Tr.narration,onChange:h=>go({...Tr,narration:h.target.value}),placeholder:"Reference",small:!0}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[c.jsx(qe,{label:"Cancel",onClick:()=>Hr(!1)}),c.jsx(qe,{label:"Record Payment",variant:"success",icon:Nj,onClick:T4})]})]})}),c.jsxs(In,{isOpen:Ni,onClose:()=>er(!1),title:" Set Opening Balance",width:"450px",children:[c.jsx(q0,{label:"Select Party",value:Mi.partyName,onChange:h=>mc({...Mi,partyName:h.target.value}),options:[{value:"",label:"Choose a party..."},...Tn.map(h=>({value:h,label:h}))],small:!0}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"12px"},children:[c.jsx(Cr,{label:"Amount",type:"number",value:Mi.amount,onChange:h=>mc({...Mi,amount:h.target.value}),small:!0}),c.jsx(q0,{label:"Type",value:Mi.type,onChange:h=>mc({...Mi,type:h.target.value}),options:[{value:"Dr",label:"Debit"},{value:"Cr",label:"Credit"}],small:!0})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[c.jsx(qe,{label:"Cancel",onClick:()=>er(!1)}),c.jsx(qe,{label:"Save",variant:"brand",onClick:()=>{Mi.partyName&&Mi.amount&&(gc(h=>({...h,[Mi.partyName]:Mi.type==="Dr"?parseFloat(Mi.amount):-parseFloat(Mi.amount)})),er(!1),mc({partyName:"",amount:"",type:"Dr"}))}})]})]}),c.jsxs(In,{isOpen:Jf,onClose:()=>Us(!1),title:" Import Historical Ledger",width:"600px",children:[c.jsx("input",{type:"file",ref:t0,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:s4}),c.jsxs("div",{style:{padding:"16px",backgroundColor:"#EFF6FF",borderRadius:"10px",marginBottom:"16px",border:"1px solid #BFDBFE"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#1E40AF",marginBottom:"8px",fontSize:"14px"},children:" How to Import Historical Ledger"}),c.jsxs("div",{style:{fontSize:"12px",color:"#1E3A8A",lineHeight:"1.6"},children:[c.jsx("p",{style:{margin:"0 0 8px 0"},children:"Upload your existing ledger data in the format shown in the template. This will import all historical transactions."}),c.jsxs("p",{style:{margin:0},children:[c.jsx("strong",{children:"Supported columns:"})," Date, Particular, Vch Type, Vch No., Debit, Credit, Date of Receipt, Amount Received, TDS Received, Balance, Payment Status"]})]})]}),q&&c.jsxs("div",{style:{padding:"12px",backgroundColor:"#DCFCE7",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[c.jsxs("div",{style:{fontSize:"13px",color:"#166534"},children:[c.jsx("strong",{children:" Selected Party:"})," ",q]}),c.jsx("div",{style:{fontSize:"11px",color:"#15803D",marginTop:"4px"},children:"All entries from the uploaded file will be imported for this party"})]}),!q&&c.jsxs("div",{style:{padding:"12px",backgroundColor:"#FEE2E2",borderRadius:"8px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[c.jsx("div",{style:{fontSize:"13px",color:"#991B1B"},children:c.jsx("strong",{children:" No Party Selected"})}),c.jsx("div",{style:{fontSize:"12px",color:"#B91C1C",marginTop:"4px"},children:'Please close this modal and select a party from the Parties list on the left, then click "Import Historical" again.'})]}),c.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginBottom:"16px"},children:[c.jsx(qe,{icon:wo,label:"Download Template",variant:"brand",onClick:a4}),q?c.jsx(qe,{icon:Hs,label:"Upload Ledger",variant:"success",onClick:()=>{var h;return(h=t0.current)==null?void 0:h.click()}}):c.jsxs("button",{disabled:!0,style:{padding:"8px 16px",fontSize:"13px",fontWeight:"600",border:"none",borderRadius:"8px",backgroundColor:"#E2E8F0",color:"#94A3B8",cursor:"not-allowed",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(Hs,{size:16})," Upload Ledger"]})]}),c.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",border:"1px solid #E2E8F0"},children:[c.jsx("div",{style:{fontWeight:"600",color:"#475569",marginBottom:"8px",fontSize:"13px"},children:" Expected Format (matches your ledger export):"}),c.jsx("div",{style:{overflowX:"auto"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#E2E8F0"},children:[c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Date"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Particular"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Vch Type"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Vch No."}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Debit"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Credit"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Amt Recd"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Status"})]})}),c.jsx("tbody",{children:c.jsxs("tr",{children:[c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"02-Jun-21"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"DB Corp Ltd"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"Sales"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"MB/2020-21/0411"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0",textAlign:"right"},children:"6,000"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0",textAlign:"right"},children:"44,371"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"Received"})]})})]})})]}),c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:c.jsx(qe,{label:"Close",onClick:()=>Us(!1)})})]}),c.jsx(In,{isOpen:fo,onClose:()=>{ho(!1),Oi({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"})},title:" Create Receipt",width:"550px",children:ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",ce.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",ce.partyName]}),c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Invoice Amount:"})," ",et(ce.invoiceTotalAmount)]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[c.jsx(Cr,{label:"Receipt Date",type:"date",value:jt.date,onChange:h=>Oi({...jt,date:h.target.value}),small:!0}),c.jsx(q0,{label:"Payment Mode",value:jt.mode,onChange:h=>Oi({...jt,mode:h.target.value}),options:[{value:"Bank",label:"Bank Transfer"},{value:"Cash",label:"Cash"},{value:"Cheque",label:"Cheque"},{value:"UPI",label:"UPI"}],small:!0})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"12px",marginBottom:"12px"},children:[c.jsx(Cr,{label:"Amount Received",type:"number",value:jt.amount,onChange:h=>Oi({...jt,amount:h.target.value}),placeholder:"0.00",small:!0}),c.jsx(Cr,{label:"TDS Deducted",type:"number",value:jt.tds,onChange:h=>Oi({...jt,tds:h.target.value}),placeholder:"0.00",small:!0}),c.jsx(Cr,{label:"Discount",type:"number",value:jt.discount,onChange:h=>Oi({...jt,discount:h.target.value}),placeholder:"0.00",small:!0})]}),c.jsx("div",{style:{backgroundColor:"#F0FDF4",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:c.jsxs("div",{style:{fontSize:"14px",fontWeight:"700",color:"#166534"},children:["Total Credit: ",et((parseFloat(jt.amount)||0)+(parseFloat(jt.tds)||0)+(parseFloat(jt.discount)||0))]})}),c.jsx(Cr,{label:"Narration",value:jt.narration,onChange:h=>Oi({...jt,narration:h.target.value}),placeholder:"Payment reference, remarks...",small:!0}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Payment Advisory (Optional)"}),c.jsx("input",{type:"file",ref:xc,accept:"image/*,.pdf",onChange:wc,style:{display:"none"}}),jt.paymentAdvisory?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[c.jsx("div",{style:{flex:1,padding:"10px",backgroundColor:"#F0FDF4",borderRadius:"8px",fontSize:"13px",color:"#166534"},children:" Payment advisory attached"}),c.jsx("button",{onClick:()=>Oi(h=>({...h,paymentAdvisory:null})),style:{padding:"8px",border:"none",backgroundColor:"#FEE2E2",borderRadius:"6px",cursor:"pointer",color:"#991B1B"},children:c.jsx(Ma,{size:16})})]}):c.jsxs("button",{onClick:()=>{var h;return(h=xc.current)==null?void 0:h.click()},style:{padding:"10px 16px",border:"1.5px dashed #D1D5DB",borderRadius:"8px",backgroundColor:"#F9FAFB",cursor:"pointer",fontSize:"13px",color:"#6B7280",display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(Hs,{size:16})," Attach Payment Advisory"]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(qe,{label:"Cancel",onClick:()=>ho(!1)}),c.jsx(qe,{label:"Create Receipt",variant:"success",icon:wl,onClick:An})]})]})}),c.jsx(In,{isOpen:Uu,onClose:()=>{Os(!1),Fa({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]})},title:" Create Credit Note",width:"500px",children:ce&&(()=>{var H;const h=(H=ce.statePartyDetails)==null?void 0:H.toUpperCase().includes("MAHARASHTRA"),_=h?"CGST + SGST (9% + 9%)":"IGST (18%)",z=parseFloat(ln.amount)||0,Z=parseFloat(ln.gst)||0,B=z+Z;return c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",ce.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",ce.partyName]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice Amount:"})," ",et(ce.invoiceTotalAmount)]}),c.jsxs("div",{style:{fontSize:"12px",color:"#2563EB"},children:[c.jsx("strong",{children:"GST Type:"})," ",h?"CGST + SGST (Intra-state)":"IGST (Inter-state)"]})]}),c.jsx("div",{style:{marginBottom:"12px"},children:c.jsx(Cr,{label:"Credit Note Date",type:"date",value:ln.date,onChange:j=>Fa({...ln,date:j.target.value}),small:!0})}),c.jsxs("div",{style:{backgroundColor:"#FEF2F2",padding:"14px",borderRadius:"10px",marginBottom:"12px",border:"1px solid #FECACA"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#991B1B",marginBottom:"10px",fontSize:"13px"},children:" Credit Note Breakdown"}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsx(Cr,{label:"Base Amount",type:"number",value:ln.amount,onChange:j=>Fa({...ln,amount:j.target.value}),placeholder:"0.00",small:!0}),c.jsx(Cr,{label:_,type:"number",value:ln.gst,onChange:j=>Fa({...ln,gst:j.target.value}),placeholder:"0.00",small:!0})]}),c.jsxs("div",{style:{marginTop:"10px",padding:"8px",backgroundColor:"#FEE2E2",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsx("span",{style:{fontSize:"13px",fontWeight:"600",color:"#991B1B"},children:"Total Credit:"}),c.jsx("span",{style:{fontSize:"15px",fontWeight:"700",color:"#991B1B"},children:et(B)})]})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Reason for Credit Note *"}),c.jsx("textarea",{value:ln.reason,onChange:j=>Fa({...ln,reason:j.target.value}),placeholder:"Enter reason for issuing credit note...",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(qe,{label:"Cancel",onClick:()=>Os(!1)}),c.jsx(qe,{label:"Create Credit Note",variant:"danger",icon:nd,onClick:Xi})]})]})})()}),c.jsx(In,{isOpen:hr,onClose:()=>{Pi(!1),us(null)},title:" Add Followup",width:"500px",children:lr&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",lr.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",lr.partyName]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Amount:"})," ",et(lr.invoiceTotalAmount||lr.totalAmount)]}),c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Invoice Date:"})," ",At(lr.invoiceDate||lr.date)]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[c.jsx(Cr,{label:"Followup Date",type:"date",value:Ir.date,onChange:h=>ds({...Ir,date:h.target.value}),small:!0}),c.jsx(Cr,{label:"Next Followup Date",type:"date",value:Ir.nextFollowupDate,onChange:h=>ds({...Ir,nextFollowupDate:h.target.value}),small:!0})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Followup Notes *"}),c.jsx("textarea",{value:Ir.notes,onChange:h=>ds({...Ir,notes:h.target.value}),placeholder:"Enter followup notes (e.g., Spoke with accounts team, payment promised by next week)",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Status"}),c.jsxs("select",{value:Ir.status,onChange:h=>ds({...Ir,status:h.target.value}),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px"},children:[c.jsx("option",{value:"Pending",children:"Pending"}),c.jsx("option",{value:"Promised",children:"Promised - Payment Expected"}),c.jsx("option",{value:"Disputed",children:"Disputed"}),c.jsx("option",{value:"No Response",children:"No Response"})]})]}),c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#166534",marginBottom:"8px"},children:" Quick Actions"}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsx(qe,{icon:Yg,label:"Copy Email Template",small:!0,variant:"brand",onClick:()=>ly(lr)}),c.jsx(qe,{icon:qg,label:"Search in Gmail",small:!0,variant:"success",onClick:()=>cy(lr)})]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(qe,{label:"Cancel",onClick:()=>Pi(!1)}),c.jsx(qe,{label:"Save Followup",variant:"primary",icon:sd,onClick:JF})]})]})}),c.jsx(In,{isOpen:fl,onClose:()=>Ms(!1),title:" Clear All Data",width:"500px",children:c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"20px",borderRadius:"12px",marginBottom:"20px",border:"2px solid #FCA5A5"},children:[c.jsxs("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"18px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx($2,{size:24})," Warning: This action cannot be undone!"]}),c.jsxs("div",{style:{fontSize:"14px",color:"#7F1D1D",lineHeight:"1.6"},children:["This will permanently delete:",c.jsxs("ul",{style:{margin:"12px 0 0 20px",padding:0},children:[c.jsxs("li",{children:[c.jsx("strong",{children:_e.length})," campaigns from Master Sheet"]}),c.jsxs("li",{children:[c.jsx("strong",{children:_e.filter(h=>h.invoiceGenerated).length})," generated invoices"]}),c.jsxs("li",{children:[c.jsx("strong",{children:Be.length})," receipts"]}),c.jsxs("li",{children:[c.jsx("strong",{children:ne.length})," credit notes"]}),c.jsxs("li",{children:[c.jsx("strong",{children:ie.length})," ledger entries"]}),c.jsxs("li",{children:[c.jsx("strong",{children:Object.keys(Bn).length})," mailer images"]}),c.jsx("li",{children:"All opening balances"})]})]})]}),c.jsx("div",{style:{backgroundColor:"#FEF3C7",padding:"14px",borderRadius:"8px",marginBottom:"20px",border:"1px solid #FCD34D"},children:c.jsxs("div",{style:{fontSize:"13px",color:"#92400E"},children:[c.jsx("strong",{children:"Note:"})," Invoice series numbers will be reset to 1. Your company settings and mailer logo will be preserved."]})}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[c.jsx(qe,{label:"Cancel",onClick:()=>Ms(!1)}),c.jsx(qe,{label:"Yes, Clear All Data",variant:"danger",icon:Ws,onClick:d4})]})]})}),c.jsx(In,{isOpen:Ye,onClose:()=>ct(!1),title:" Notifications",width:"550px",children:c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B"},children:Un>0?`${Un} unread`:"No unread notifications"}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[Un>0&&c.jsx("button",{onClick:yc,style:{padding:"6px 12px",fontSize:"12px",fontWeight:"600",border:"1px solid #E2E8F0",borderRadius:"6px",backgroundColor:"#F8FAFC",color:"#475569",cursor:"pointer"},children:"Mark all as read"}),Ke.length>0&&dr&&c.jsx("button",{onClick:i0,style:{padding:"6px 12px",fontSize:"12px",fontWeight:"600",border:"1px solid #FCA5A5",borderRadius:"6px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer"},children:"Clear all"})]})]}),c.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:yl.length===0?c.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:[c.jsx(K2,{size:40,style:{marginBottom:"12px",opacity:.5}}),c.jsx("div",{style:{fontSize:"16px",fontWeight:"600"},children:"No notifications"}),c.jsx("div",{style:{fontSize:"13px",marginTop:"4px"},children:"You're all caught up!"})]}):yl.map(h=>{const _=!(h.read&&h.read[r]),z=B=>{switch(B){case"upload":return"";case"invoice":return"";case"approval":return"";case"edit":return"";case"receipt":return"";default:return""}},Z=B=>{switch(B){case"upload":return"#EFF6FF";case"invoice":return"#FEF3C7";case"approval":return"#DCFCE7";case"edit":return"#FEE2E2";case"receipt":return"#F0FDF4";default:return"#F8FAFC"}};return c.jsx("div",{onClick:()=>n0(h.id),style:{padding:"14px",borderRadius:"10px",marginBottom:"8px",backgroundColor:_?Z(h.type):"#F8FAFC",border:_?"2px solid #2874A6":"1px solid #E2E8F0",cursor:"pointer",transition:"all 0.2s ease"},children:c.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[c.jsx("div",{style:{fontSize:"20px"},children:z(h.type)}),c.jsxs("div",{style:{flex:1},children:[c.jsx("div",{style:{fontSize:"14px",fontWeight:_?"600":"500",color:"#1E293B",lineHeight:"1.4"},children:h.message}),c.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"8px",fontSize:"11px",color:"#64748B"},children:[c.jsxs("span",{children:["By: ",h.createdBy==="finance"?"Finance Team":"Director"]}),c.jsx("span",{children:""}),c.jsx("span",{children:new Date(h.createdAt).toLocaleString()})]})]}),_&&c.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#DC2626",flexShrink:0}})]})},h.id)})})]})})]}),X4=()=>{switch(R){case"master":return vy();case"services":return R4();case"invoices":return B4();case"receipts":return W4();case"ledgers":return H4();case"followups":return G4();case"reports":return Ty();case"settings":return r==="finance"?K4():Ty();default:return vy()}},q4=()=>c.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 50%, #1E3A5F 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',padding:"20px"},children:c.jsxs("div",{style:{backgroundColor:"#FFFFFF",padding:"0",borderRadius:"24px",boxShadow:"0 25px 50px -12px rgba(0,0,0,0.25)",width:"420px",maxWidth:"95vw",overflow:"hidden"},children:[c.jsxs("div",{style:{background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 100%)",padding:"32px 40px",textAlign:"center"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:"8px"},children:[c.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"60px",height:"auto",borderRadius:"8px",backgroundColor:"white",padding:"4px"}}),c.jsx("span",{style:{fontSize:"36px",fontWeight:"800",color:"#FFFFFF",letterSpacing:"-1px"},children:"FinMate"})]}),c.jsx("p",{style:{margin:0,color:"rgba(255,255,255,0.8)",fontSize:"14px",fontWeight:"500"},children:"Finance Management System"})]}),c.jsxs("div",{style:{padding:"32px 40px"},children:[c.jsxs("div",{style:{marginBottom:"24px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#1E3A5F",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Username"}),c.jsxs("div",{style:{position:"relative"},children:[c.jsx(Z2,{size:18,style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",value:i.username,onChange:h=>s(_=>({..._,username:h.target.value})),placeholder:"Enter username",style:{width:"100%",padding:"14px 14px 14px 44px",borderRadius:"12px",border:"2px solid #E2E8F0",fontSize:"15px",boxSizing:"border-box",transition:"border-color 0.2s, box-shadow 0.2s",outline:"none"},onFocus:h=>{h.target.style.borderColor="#2874A6",h.target.style.boxShadow="0 0 0 3px rgba(40,116,166,0.1)"},onBlur:h=>{h.target.style.borderColor="#E2E8F0",h.target.style.boxShadow="none"}})]})]}),c.jsxs("div",{style:{marginBottom:"28px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#1E3A5F",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Password"}),c.jsxs("div",{style:{position:"relative"},children:[c.jsx(U0,{size:18,style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"password",value:i.password,onChange:h=>s(_=>({..._,password:h.target.value})),placeholder:"Enter password",onKeyPress:h=>h.key==="Enter"&&Gu(),style:{width:"100%",padding:"14px 14px 14px 44px",borderRadius:"12px",border:"2px solid #E2E8F0",fontSize:"15px",boxSizing:"border-box",transition:"border-color 0.2s, box-shadow 0.2s",outline:"none"},onFocus:h=>{h.target.style.borderColor="#2874A6",h.target.style.boxShadow="0 0 0 3px rgba(40,116,166,0.1)"},onBlur:h=>{h.target.style.borderColor="#E2E8F0",h.target.style.boxShadow="none"}})]})]}),a&&c.jsxs("div",{style:{marginBottom:"20px",padding:"14px",backgroundColor:"#FEF2F2",borderRadius:"12px",color:"#DC2626",fontSize:"14px",textAlign:"center",border:"1px solid #FECACA",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[c.jsx($2,{size:18}),a]}),c.jsx("button",{onClick:Gu,style:{width:"100%",padding:"16px",fontSize:"16px",fontWeight:"700",border:"none",borderRadius:"12px",cursor:w?"pointer":"wait",background:w?"linear-gradient(135deg, #1E3A5F 0%, #2874A6 100%)":"#94A3B8",color:"white",transition:"transform 0.2s, box-shadow 0.2s",boxShadow:w?"0 4px 14px rgba(40,116,166,0.4)":"none",opacity:w?1:.7},disabled:!w,onMouseOver:h=>{w&&(h.target.style.transform="translateY(-2px)",h.target.style.boxShadow="0 6px 20px rgba(40,116,166,0.5)")},onMouseOut:h=>{w&&(h.target.style.transform="translateY(0)",h.target.style.boxShadow="0 4px 14px rgba(40,116,166,0.4)")},children:w?"Sign In":"Loading..."}),c.jsxs("div",{style:{marginTop:"24px",textAlign:"center",color:"#94A3B8",fontSize:"12px"},children:[c.jsx("span",{children:"Powered by "}),c.jsx("span",{style:{fontWeight:"600",color:"#1E3A5F"},children:"JAC"}),c.jsx("span",{children:"  Strategy | Talent | Results"})]})]})]})});return t?l?c.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 50%, #1E3A5F 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[c.jsxs("div",{style:{textAlign:"center"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:"24px"},children:[c.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"50px",height:"auto",borderRadius:"8px",backgroundColor:"white",padding:"4px"}}),c.jsx("span",{style:{fontSize:"32px",fontWeight:"800",color:"#FFFFFF",letterSpacing:"-1px"},children:"FinMate"})]}),c.jsx(X2,{size:48,style:{animation:"spin 1s linear infinite",color:"#FFFFFF",marginBottom:"16px"}}),c.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:"#FFFFFF"},children:"Loading your data..."}),c.jsx("div",{style:{fontSize:"14px",color:"rgba(255,255,255,0.7)",marginTop:"8px"},children:"Please wait while we sync with the cloud"})]}),c.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]}):c.jsxs("div",{style:{display:"flex",height:"100vh",backgroundColor:"#F1F5F9",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[A4(),c.jsx("main",{style:{flex:1,overflow:"auto",padding:"20px"},children:X4()}),Y4(),c.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]}):q4()}um.createRoot(document.getElementById("root")).render(c.jsx(Z0.StrictMode,{children:c.jsx(kH,{})}));
