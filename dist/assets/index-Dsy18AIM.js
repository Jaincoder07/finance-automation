(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function JF(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var fw={exports:{}},yp={},hw={exports:{}},It={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ff=Symbol.for("react.element"),ZF=Symbol.for("react.portal"),eb=Symbol.for("react.fragment"),tb=Symbol.for("react.strict_mode"),rb=Symbol.for("react.profiler"),nb=Symbol.for("react.provider"),ib=Symbol.for("react.context"),sb=Symbol.for("react.forward_ref"),ab=Symbol.for("react.suspense"),ob=Symbol.for("react.memo"),lb=Symbol.for("react.lazy"),Cy=Symbol.iterator;function cb(t){return t===null||typeof t!="object"?null:(t=Cy&&t[Cy]||t["@@iterator"],typeof t=="function"?t:null)}var pw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},gw=Object.assign,mw={};function Cu(t,e,r){this.props=t,this.context=e,this.refs=mw,this.updater=r||pw}Cu.prototype.isReactComponent={};Cu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Cu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function xw(){}xw.prototype=Cu.prototype;function Mx(t,e,r){this.props=t,this.context=e,this.refs=mw,this.updater=r||pw}var Bx=Mx.prototype=new xw;Bx.constructor=Mx;gw(Bx,Cu.prototype);Bx.isPureReactComponent=!0;var Fy=Array.isArray,vw=Object.prototype.hasOwnProperty,Lx={current:null},yw={key:!0,ref:!0,__self:!0,__source:!0};function _w(t,e,r){var n,i={},s=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)vw.call(e,n)&&!yw.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:Ff,type:t,key:s,ref:a,props:i,_owner:Lx.current}}function ub(t,e){return{$$typeof:Ff,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function jx(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ff}function db(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var by=/\/+/g;function sg(t,e){return typeof t=="object"&&t!==null&&t.key!=null?db(""+t.key):e.toString(36)}function Q0(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Ff:case ZF:a=!0}}if(a)return a=t,i=i(a),t=n===""?"."+sg(a,0):n,Fy(i)?(r="",t!=null&&(r=t.replace(by,"$&/")+"/"),Q0(i,e,r,"",function(u){return u})):i!=null&&(jx(i)&&(i=ub(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(by,"$&/")+"/")+t)),e.push(i)),1;if(a=0,n=n===""?".":n+":",Fy(t))for(var o=0;o<t.length;o++){s=t[o];var l=n+sg(s,o);a+=Q0(s,e,r,l,i)}else if(l=cb(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=n+sg(s,o++),a+=Q0(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function u0(t,e,r){if(t==null)return t;var n=[],i=0;return Q0(t,n,"","",function(s){return e.call(r,s,i++)}),n}function fb(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var _i={current:null},J0={transition:null},hb={ReactCurrentDispatcher:_i,ReactCurrentBatchConfig:J0,ReactCurrentOwner:Lx};function Ew(){throw Error("act(...) is not supported in production builds of React.")}It.Children={map:u0,forEach:function(t,e,r){u0(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return u0(t,function(){e++}),e},toArray:function(t){return u0(t,function(e){return e})||[]},only:function(t){if(!jx(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};It.Component=Cu;It.Fragment=eb;It.Profiler=rb;It.PureComponent=Mx;It.StrictMode=tb;It.Suspense=ab;It.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hb;It.act=Ew;It.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=gw({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=Lx.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)vw.call(e,l)&&!yw.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:Ff,type:t.type,key:i,ref:s,props:n,_owner:a}};It.createContext=function(t){return t={$$typeof:ib,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:nb,_context:t},t.Consumer=t};It.createElement=_w;It.createFactory=function(t){var e=_w.bind(null,t);return e.type=t,e};It.createRef=function(){return{current:null}};It.forwardRef=function(t){return{$$typeof:sb,render:t}};It.isValidElement=jx;It.lazy=function(t){return{$$typeof:lb,_payload:{_status:-1,_result:t},_init:fb}};It.memo=function(t,e){return{$$typeof:ob,type:t,compare:e===void 0?null:e}};It.startTransition=function(t){var e=J0.transition;J0.transition={};try{t()}finally{J0.transition=e}};It.unstable_act=Ew;It.useCallback=function(t,e){return _i.current.useCallback(t,e)};It.useContext=function(t){return _i.current.useContext(t)};It.useDebugValue=function(){};It.useDeferredValue=function(t){return _i.current.useDeferredValue(t)};It.useEffect=function(t,e){return _i.current.useEffect(t,e)};It.useId=function(){return _i.current.useId()};It.useImperativeHandle=function(t,e,r){return _i.current.useImperativeHandle(t,e,r)};It.useInsertionEffect=function(t,e){return _i.current.useInsertionEffect(t,e)};It.useLayoutEffect=function(t,e){return _i.current.useLayoutEffect(t,e)};It.useMemo=function(t,e){return _i.current.useMemo(t,e)};It.useReducer=function(t,e,r){return _i.current.useReducer(t,e,r)};It.useRef=function(t){return _i.current.useRef(t)};It.useState=function(t){return _i.current.useState(t)};It.useSyncExternalStore=function(t,e,r){return _i.current.useSyncExternalStore(t,e,r)};It.useTransition=function(){return _i.current.useTransition()};It.version="18.3.1";hw.exports=It;var ve=hw.exports;const Z0=JF(ve);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pb=ve,gb=Symbol.for("react.element"),mb=Symbol.for("react.fragment"),xb=Object.prototype.hasOwnProperty,vb=pb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,yb={key:!0,ref:!0,__self:!0,__source:!0};function ww(t,e,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)xb.call(e,n)&&!yb.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:gb,type:t,key:s,ref:a,props:i,_owner:vb.current}}yp.Fragment=mb;yp.jsx=ww;yp.jsxs=ww;fw.exports=yp;var c=fw.exports,cm={},Sw={exports:{}},es={},Tw={exports:{}},Aw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Se,te){var Ce=Se.length;Se.push(te);e:for(;0<Ce;){var je=Ce-1>>>1,W=Se[je];if(0<i(W,te))Se[je]=te,Se[Ce]=W,Ce=je;else break e}}function r(Se){return Se.length===0?null:Se[0]}function n(Se){if(Se.length===0)return null;var te=Se[0],Ce=Se.pop();if(Ce!==te){Se[0]=Ce;e:for(var je=0,W=Se.length,re=W>>>1;je<re;){var ee=2*(je+1)-1,Y=Se[ee],xe=ee+1,Ee=Se[xe];if(0>i(Y,Ce))xe<W&&0>i(Ee,Y)?(Se[je]=Ee,Se[xe]=Ce,je=xe):(Se[je]=Y,Se[ee]=Ce,je=ee);else if(xe<W&&0>i(Ee,Ce))Se[je]=Ee,Se[xe]=Ce,je=xe;else break e}}return te}function i(Se,te){var Ce=Se.sortIndex-te.sortIndex;return Ce!==0?Ce:Se.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],u=[],f=1,p=null,g=3,m=!1,y=!1,x=!1,w=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(Se){for(var te=r(u);te!==null;){if(te.callback===null)n(u);else if(te.startTime<=Se)n(u),te.sortIndex=te.expirationTime,e(l,te);else break;te=r(u)}}function O(Se){if(x=!1,_(Se),!y)if(r(l)!==null)y=!0,Re(G);else{var te=r(u);te!==null&&Me(O,te.startTime-Se)}}function G(Se,te){y=!1,x&&(x=!1,A(F),F=-1),m=!0;var Ce=g;try{for(_(te),p=r(l);p!==null&&(!(p.expirationTime>te)||Se&&!R());){var je=p.callback;if(typeof je=="function"){p.callback=null,g=p.priorityLevel;var W=je(p.expirationTime<=te);te=t.unstable_now(),typeof W=="function"?p.callback=W:p===r(l)&&n(l),_(te)}else n(l);p=r(l)}if(p!==null)var re=!0;else{var ee=r(u);ee!==null&&Me(O,ee.startTime-te),re=!1}return re}finally{p=null,g=Ce,m=!1}}var U=!1,T=null,F=-1,S=5,I=-1;function R(){return!(t.unstable_now()-I<S)}function D(){if(T!==null){var Se=t.unstable_now();I=Se;var te=!0;try{te=T(!0,Se)}finally{te?N():(U=!1,T=null)}}else U=!1}var N;if(typeof k=="function")N=function(){k(D)};else if(typeof MessageChannel<"u"){var Ge=new MessageChannel,_e=Ge.port2;Ge.port1.onmessage=D,N=function(){_e.postMessage(null)}}else N=function(){w(D,0)};function Re(Se){T=Se,U||(U=!0,N())}function Me(Se,te){F=w(function(){Se(t.unstable_now())},te)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Se){Se.callback=null},t.unstable_continueExecution=function(){y||m||(y=!0,Re(G))},t.unstable_forceFrameRate=function(Se){0>Se||125<Se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<Se?Math.floor(1e3/Se):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(Se){switch(g){case 1:case 2:case 3:var te=3;break;default:te=g}var Ce=g;g=te;try{return Se()}finally{g=Ce}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Se,te){switch(Se){case 1:case 2:case 3:case 4:case 5:break;default:Se=3}var Ce=g;g=Se;try{return te()}finally{g=Ce}},t.unstable_scheduleCallback=function(Se,te,Ce){var je=t.unstable_now();switch(typeof Ce=="object"&&Ce!==null?(Ce=Ce.delay,Ce=typeof Ce=="number"&&0<Ce?je+Ce:je):Ce=je,Se){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=Ce+W,Se={id:f++,callback:te,priorityLevel:Se,startTime:Ce,expirationTime:W,sortIndex:-1},Ce>je?(Se.sortIndex=Ce,e(u,Se),r(l)===null&&Se===r(u)&&(x?(A(F),F=-1):x=!0,Me(O,Ce-je))):(Se.sortIndex=W,e(l,Se),y||m||(y=!0,Re(G))),Se},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(Se){var te=g;return function(){var Ce=g;g=te;try{return Se.apply(this,arguments)}finally{g=Ce}}}})(Aw);Tw.exports=Aw;var _b=Tw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eb=ve,Ji=_b;function Oe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var kw=new Set,Vd={};function nc(t,e){lu(t,e),lu(t+"Capture",e)}function lu(t,e){for(Vd[t]=e,t=0;t<e.length;t++)kw.add(e[t])}var $a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),um=Object.prototype.hasOwnProperty,wb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Iy={},Ny={};function Sb(t){return um.call(Ny,t)?!0:um.call(Iy,t)?!1:wb.test(t)?Ny[t]=!0:(Iy[t]=!0,!1)}function Tb(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Ab(t,e,r,n){if(e===null||typeof e>"u"||Tb(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ei(t,e,r,n,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var Vn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Vn[t]=new Ei(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Vn[e]=new Ei(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Vn[t]=new Ei(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Vn[t]=new Ei(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Vn[t]=new Ei(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Vn[t]=new Ei(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Vn[t]=new Ei(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Vn[t]=new Ei(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Vn[t]=new Ei(t,5,!1,t.toLowerCase(),null,!1,!1)});var Vx=/[\-:]([a-z])/g;function Ux(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Vx,Ux);Vn[e]=new Ei(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Vx,Ux);Vn[e]=new Ei(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Vx,Ux);Vn[e]=new Ei(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Vn[t]=new Ei(t,1,!1,t.toLowerCase(),null,!1,!1)});Vn.xlinkHref=new Ei("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Vn[t]=new Ei(t,1,!1,t.toLowerCase(),null,!0,!0)});function zx(t,e,r,n){var i=Vn.hasOwnProperty(e)?Vn[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Ab(e,r,i,n)&&(r=null),n||i===null?Sb(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var to=Eb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,d0=Symbol.for("react.element"),Pc=Symbol.for("react.portal"),Oc=Symbol.for("react.fragment"),Wx=Symbol.for("react.strict_mode"),dm=Symbol.for("react.profiler"),Cw=Symbol.for("react.provider"),Fw=Symbol.for("react.context"),Hx=Symbol.for("react.forward_ref"),fm=Symbol.for("react.suspense"),hm=Symbol.for("react.suspense_list"),$x=Symbol.for("react.memo"),So=Symbol.for("react.lazy"),bw=Symbol.for("react.offscreen"),Ry=Symbol.iterator;function Yu(t){return t===null||typeof t!="object"?null:(t=Ry&&t[Ry]||t["@@iterator"],typeof t=="function"?t:null)}var Ir=Object.assign,ag;function od(t){if(ag===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);ag=e&&e[1]||""}return`
`+ag+t}var og=!1;function lg(t,e){if(!t||og)return"";og=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{og=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?od(t):""}function kb(t){switch(t.tag){case 5:return od(t.type);case 16:return od("Lazy");case 13:return od("Suspense");case 19:return od("SuspenseList");case 0:case 2:case 15:return t=lg(t.type,!1),t;case 11:return t=lg(t.type.render,!1),t;case 1:return t=lg(t.type,!0),t;default:return""}}function pm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Oc:return"Fragment";case Pc:return"Portal";case dm:return"Profiler";case Wx:return"StrictMode";case fm:return"Suspense";case hm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Fw:return(t.displayName||"Context")+".Consumer";case Cw:return(t._context.displayName||"Context")+".Provider";case Hx:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case $x:return e=t.displayName||null,e!==null?e:pm(t.type)||"Memo";case So:e=t._payload,t=t._init;try{return pm(t(e))}catch{}}return null}function Cb(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pm(e);case 8:return e===Wx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function qo(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Iw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Fb(t){var e=Iw(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function f0(t){t._valueTracker||(t._valueTracker=Fb(t))}function Nw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=Iw(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function yh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function gm(t,e){var r=e.checked;return Ir({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function Dy(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=qo(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Rw(t,e){e=e.checked,e!=null&&zx(t,"checked",e,!1)}function mm(t,e){Rw(t,e);var r=qo(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?xm(t,e.type,r):e.hasOwnProperty("defaultValue")&&xm(t,e.type,qo(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Py(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function xm(t,e,r){(e!=="number"||yh(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var ld=Array.isArray;function Yc(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+qo(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function vm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Oe(91));return Ir({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Oy(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Oe(92));if(ld(r)){if(1<r.length)throw Error(Oe(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:qo(r)}}function Dw(t,e){var r=qo(e.value),n=qo(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function My(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Pw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ym(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Pw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var h0,Ow=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(h0=h0||document.createElement("div"),h0.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=h0.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ud(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var vd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},bb=["Webkit","ms","Moz","O"];Object.keys(vd).forEach(function(t){bb.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),vd[e]=vd[t]})});function Mw(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||vd.hasOwnProperty(t)&&vd[t]?(""+e).trim():e+"px"}function Bw(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Mw(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var Ib=Ir({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _m(t,e){if(e){if(Ib[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Oe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Oe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Oe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Oe(62))}}function Em(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wm=null;function Gx(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Sm=null,Xc=null,qc=null;function By(t){if(t=Nf(t)){if(typeof Sm!="function")throw Error(Oe(280));var e=t.stateNode;e&&(e=Tp(e),Sm(t.stateNode,t.type,e))}}function Lw(t){Xc?qc?qc.push(t):qc=[t]:Xc=t}function jw(){if(Xc){var t=Xc,e=qc;if(qc=Xc=null,By(t),e)for(t=0;t<e.length;t++)By(e[t])}}function Vw(t,e){return t(e)}function Uw(){}var cg=!1;function zw(t,e,r){if(cg)return t(e,r);cg=!0;try{return Vw(t,e,r)}finally{cg=!1,(Xc!==null||qc!==null)&&(Uw(),jw())}}function zd(t,e){var r=t.stateNode;if(r===null)return null;var n=Tp(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Oe(231,e,typeof r));return r}var Tm=!1;if($a)try{var Xu={};Object.defineProperty(Xu,"passive",{get:function(){Tm=!0}}),window.addEventListener("test",Xu,Xu),window.removeEventListener("test",Xu,Xu)}catch{Tm=!1}function Nb(t,e,r,n,i,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(f){this.onError(f)}}var yd=!1,_h=null,Eh=!1,Am=null,Rb={onError:function(t){yd=!0,_h=t}};function Db(t,e,r,n,i,s,a,o,l){yd=!1,_h=null,Nb.apply(Rb,arguments)}function Pb(t,e,r,n,i,s,a,o,l){if(Db.apply(this,arguments),yd){if(yd){var u=_h;yd=!1,_h=null}else throw Error(Oe(198));Eh||(Eh=!0,Am=u)}}function ic(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function Ww(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Ly(t){if(ic(t)!==t)throw Error(Oe(188))}function Ob(t){var e=t.alternate;if(!e){if(e=ic(t),e===null)throw Error(Oe(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Ly(i),t;if(s===n)return Ly(i),e;s=s.sibling}throw Error(Oe(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(Oe(189))}}if(r.alternate!==n)throw Error(Oe(190))}if(r.tag!==3)throw Error(Oe(188));return r.stateNode.current===r?t:e}function Hw(t){return t=Ob(t),t!==null?$w(t):null}function $w(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=$w(t);if(e!==null)return e;t=t.sibling}return null}var Gw=Ji.unstable_scheduleCallback,jy=Ji.unstable_cancelCallback,Mb=Ji.unstable_shouldYield,Bb=Ji.unstable_requestPaint,Wr=Ji.unstable_now,Lb=Ji.unstable_getCurrentPriorityLevel,Kx=Ji.unstable_ImmediatePriority,Kw=Ji.unstable_UserBlockingPriority,wh=Ji.unstable_NormalPriority,jb=Ji.unstable_LowPriority,Yw=Ji.unstable_IdlePriority,_p=null,ua=null;function Vb(t){if(ua&&typeof ua.onCommitFiberRoot=="function")try{ua.onCommitFiberRoot(_p,t,void 0,(t.current.flags&128)===128)}catch{}}var Gs=Math.clz32?Math.clz32:Wb,Ub=Math.log,zb=Math.LN2;function Wb(t){return t>>>=0,t===0?32:31-(Ub(t)/zb|0)|0}var p0=64,g0=4194304;function cd(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Sh(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=cd(o):(s&=a,s!==0&&(n=cd(s)))}else a=r&~i,a!==0?n=cd(a):s!==0&&(n=cd(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Gs(e),i=1<<r,n|=t[r],e&=~i;return n}function Hb(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $b(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-Gs(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=Hb(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function km(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Xw(){var t=p0;return p0<<=1,!(p0&4194240)&&(p0=64),t}function ug(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function bf(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Gs(e),t[e]=r}function Gb(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-Gs(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function Yx(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Gs(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var rr=0;function qw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Qw,Xx,Jw,Zw,eS,Cm=!1,m0=[],Bo=null,Lo=null,jo=null,Wd=new Map,Hd=new Map,Ao=[],Kb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Vy(t,e){switch(t){case"focusin":case"focusout":Bo=null;break;case"dragenter":case"dragleave":Lo=null;break;case"mouseover":case"mouseout":jo=null;break;case"pointerover":case"pointerout":Wd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hd.delete(e.pointerId)}}function qu(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Nf(e),e!==null&&Xx(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function Yb(t,e,r,n,i){switch(e){case"focusin":return Bo=qu(Bo,t,e,r,n,i),!0;case"dragenter":return Lo=qu(Lo,t,e,r,n,i),!0;case"mouseover":return jo=qu(jo,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return Wd.set(s,qu(Wd.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Hd.set(s,qu(Hd.get(s)||null,t,e,r,n,i)),!0}return!1}function tS(t){var e=Fl(t.target);if(e!==null){var r=ic(e);if(r!==null){if(e=r.tag,e===13){if(e=Ww(r),e!==null){t.blockedOn=e,eS(t.priority,function(){Jw(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function eh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=Fm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);wm=n,r.target.dispatchEvent(n),wm=null}else return e=Nf(r),e!==null&&Xx(e),t.blockedOn=r,!1;e.shift()}return!0}function Uy(t,e,r){eh(t)&&r.delete(e)}function Xb(){Cm=!1,Bo!==null&&eh(Bo)&&(Bo=null),Lo!==null&&eh(Lo)&&(Lo=null),jo!==null&&eh(jo)&&(jo=null),Wd.forEach(Uy),Hd.forEach(Uy)}function Qu(t,e){t.blockedOn===e&&(t.blockedOn=null,Cm||(Cm=!0,Ji.unstable_scheduleCallback(Ji.unstable_NormalPriority,Xb)))}function $d(t){function e(i){return Qu(i,t)}if(0<m0.length){Qu(m0[0],t);for(var r=1;r<m0.length;r++){var n=m0[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Bo!==null&&Qu(Bo,t),Lo!==null&&Qu(Lo,t),jo!==null&&Qu(jo,t),Wd.forEach(e),Hd.forEach(e),r=0;r<Ao.length;r++)n=Ao[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Ao.length&&(r=Ao[0],r.blockedOn===null);)tS(r),r.blockedOn===null&&Ao.shift()}var Qc=to.ReactCurrentBatchConfig,Th=!0;function qb(t,e,r,n){var i=rr,s=Qc.transition;Qc.transition=null;try{rr=1,qx(t,e,r,n)}finally{rr=i,Qc.transition=s}}function Qb(t,e,r,n){var i=rr,s=Qc.transition;Qc.transition=null;try{rr=4,qx(t,e,r,n)}finally{rr=i,Qc.transition=s}}function qx(t,e,r,n){if(Th){var i=Fm(t,e,r,n);if(i===null)_g(t,e,n,Ah,r),Vy(t,n);else if(Yb(i,t,e,r,n))n.stopPropagation();else if(Vy(t,n),e&4&&-1<Kb.indexOf(t)){for(;i!==null;){var s=Nf(i);if(s!==null&&Qw(s),s=Fm(t,e,r,n),s===null&&_g(t,e,n,Ah,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else _g(t,e,n,null,r)}}var Ah=null;function Fm(t,e,r,n){if(Ah=null,t=Gx(n),t=Fl(t),t!==null)if(e=ic(t),e===null)t=null;else if(r=e.tag,r===13){if(t=Ww(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ah=t,null}function rS(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Lb()){case Kx:return 1;case Kw:return 4;case wh:case jb:return 16;case Yw:return 536870912;default:return 16}default:return 16}}var No=null,Qx=null,th=null;function nS(){if(th)return th;var t,e=Qx,r=e.length,n,i="value"in No?No.value:No.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===i[s-n];n++);return th=i.slice(t,1<n?1-n:void 0)}function rh(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function x0(){return!0}function zy(){return!1}function ts(t){function e(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?x0:zy,this.isPropagationStopped=zy,this}return Ir(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=x0)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=x0)},persist:function(){},isPersistent:x0}),e}var Fu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jx=ts(Fu),If=Ir({},Fu,{view:0,detail:0}),Jb=ts(If),dg,fg,Ju,Ep=Ir({},If,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zx,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ju&&(Ju&&t.type==="mousemove"?(dg=t.screenX-Ju.screenX,fg=t.screenY-Ju.screenY):fg=dg=0,Ju=t),dg)},movementY:function(t){return"movementY"in t?t.movementY:fg}}),Wy=ts(Ep),Zb=Ir({},Ep,{dataTransfer:0}),eI=ts(Zb),tI=Ir({},If,{relatedTarget:0}),hg=ts(tI),rI=Ir({},Fu,{animationName:0,elapsedTime:0,pseudoElement:0}),nI=ts(rI),iI=Ir({},Fu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),sI=ts(iI),aI=Ir({},Fu,{data:0}),Hy=ts(aI),oI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},lI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},cI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function uI(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=cI[t])?!!e[t]:!1}function Zx(){return uI}var dI=Ir({},If,{key:function(t){if(t.key){var e=oI[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=rh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?lI[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zx,charCode:function(t){return t.type==="keypress"?rh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?rh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),fI=ts(dI),hI=Ir({},Ep,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$y=ts(hI),pI=Ir({},If,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zx}),gI=ts(pI),mI=Ir({},Fu,{propertyName:0,elapsedTime:0,pseudoElement:0}),xI=ts(mI),vI=Ir({},Ep,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),yI=ts(vI),_I=[9,13,27,32],e1=$a&&"CompositionEvent"in window,_d=null;$a&&"documentMode"in document&&(_d=document.documentMode);var EI=$a&&"TextEvent"in window&&!_d,iS=$a&&(!e1||_d&&8<_d&&11>=_d),Gy=" ",Ky=!1;function sS(t,e){switch(t){case"keyup":return _I.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function aS(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Mc=!1;function wI(t,e){switch(t){case"compositionend":return aS(e);case"keypress":return e.which!==32?null:(Ky=!0,Gy);case"textInput":return t=e.data,t===Gy&&Ky?null:t;default:return null}}function SI(t,e){if(Mc)return t==="compositionend"||!e1&&sS(t,e)?(t=nS(),th=Qx=No=null,Mc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return iS&&e.locale!=="ko"?null:e.data;default:return null}}var TI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Yy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!TI[t.type]:e==="textarea"}function oS(t,e,r,n){Lw(n),e=kh(e,"onChange"),0<e.length&&(r=new Jx("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Ed=null,Gd=null;function AI(t){vS(t,0)}function wp(t){var e=jc(t);if(Nw(e))return t}function kI(t,e){if(t==="change")return e}var lS=!1;if($a){var pg;if($a){var gg="oninput"in document;if(!gg){var Xy=document.createElement("div");Xy.setAttribute("oninput","return;"),gg=typeof Xy.oninput=="function"}pg=gg}else pg=!1;lS=pg&&(!document.documentMode||9<document.documentMode)}function qy(){Ed&&(Ed.detachEvent("onpropertychange",cS),Gd=Ed=null)}function cS(t){if(t.propertyName==="value"&&wp(Gd)){var e=[];oS(e,Gd,t,Gx(t)),zw(AI,e)}}function CI(t,e,r){t==="focusin"?(qy(),Ed=e,Gd=r,Ed.attachEvent("onpropertychange",cS)):t==="focusout"&&qy()}function FI(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return wp(Gd)}function bI(t,e){if(t==="click")return wp(e)}function II(t,e){if(t==="input"||t==="change")return wp(e)}function NI(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var qs=typeof Object.is=="function"?Object.is:NI;function Kd(t,e){if(qs(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!um.call(e,i)||!qs(t[i],e[i]))return!1}return!0}function Qy(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Jy(t,e){var r=Qy(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Qy(r)}}function uS(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?uS(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function dS(){for(var t=window,e=yh();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=yh(t.document)}return e}function t1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function RI(t){var e=dS(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&uS(r.ownerDocument.documentElement,r)){if(n!==null&&t1(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=Jy(r,s);var a=Jy(r,n);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var DI=$a&&"documentMode"in document&&11>=document.documentMode,Bc=null,bm=null,wd=null,Im=!1;function Zy(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Im||Bc==null||Bc!==yh(n)||(n=Bc,"selectionStart"in n&&t1(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),wd&&Kd(wd,n)||(wd=n,n=kh(bm,"onSelect"),0<n.length&&(e=new Jx("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Bc)))}function v0(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Lc={animationend:v0("Animation","AnimationEnd"),animationiteration:v0("Animation","AnimationIteration"),animationstart:v0("Animation","AnimationStart"),transitionend:v0("Transition","TransitionEnd")},mg={},fS={};$a&&(fS=document.createElement("div").style,"AnimationEvent"in window||(delete Lc.animationend.animation,delete Lc.animationiteration.animation,delete Lc.animationstart.animation),"TransitionEvent"in window||delete Lc.transitionend.transition);function Sp(t){if(mg[t])return mg[t];if(!Lc[t])return t;var e=Lc[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in fS)return mg[t]=e[r];return t}var hS=Sp("animationend"),pS=Sp("animationiteration"),gS=Sp("animationstart"),mS=Sp("transitionend"),xS=new Map,e_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function sl(t,e){xS.set(t,e),nc(e,[t])}for(var xg=0;xg<e_.length;xg++){var vg=e_[xg],PI=vg.toLowerCase(),OI=vg[0].toUpperCase()+vg.slice(1);sl(PI,"on"+OI)}sl(hS,"onAnimationEnd");sl(pS,"onAnimationIteration");sl(gS,"onAnimationStart");sl("dblclick","onDoubleClick");sl("focusin","onFocus");sl("focusout","onBlur");sl(mS,"onTransitionEnd");lu("onMouseEnter",["mouseout","mouseover"]);lu("onMouseLeave",["mouseout","mouseover"]);lu("onPointerEnter",["pointerout","pointerover"]);lu("onPointerLeave",["pointerout","pointerover"]);nc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));nc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));nc("onBeforeInput",["compositionend","keypress","textInput","paste"]);nc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));nc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));nc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ud="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),MI=new Set("cancel close invalid load scroll toggle".split(" ").concat(ud));function t_(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,Pb(n,e,void 0,t),t.currentTarget=null}function vS(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;t_(i,o,u),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;t_(i,o,u),s=l}}}if(Eh)throw t=Am,Eh=!1,Am=null,t}function pr(t,e){var r=e[Om];r===void 0&&(r=e[Om]=new Set);var n=t+"__bubble";r.has(n)||(yS(e,t,2,!1),r.add(n))}function yg(t,e,r){var n=0;e&&(n|=4),yS(r,t,n,e)}var y0="_reactListening"+Math.random().toString(36).slice(2);function Yd(t){if(!t[y0]){t[y0]=!0,kw.forEach(function(r){r!=="selectionchange"&&(MI.has(r)||yg(r,!1,t),yg(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[y0]||(e[y0]=!0,yg("selectionchange",!1,e))}}function yS(t,e,r,n){switch(rS(e)){case 1:var i=qb;break;case 4:i=Qb;break;default:i=qx}r=i.bind(null,e,r,t),i=void 0,!Tm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function _g(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=Fl(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}zw(function(){var u=s,f=Gx(r),p=[];e:{var g=xS.get(t);if(g!==void 0){var m=Jx,y=t;switch(t){case"keypress":if(rh(r)===0)break e;case"keydown":case"keyup":m=fI;break;case"focusin":y="focus",m=hg;break;case"focusout":y="blur",m=hg;break;case"beforeblur":case"afterblur":m=hg;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Wy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=eI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=gI;break;case hS:case pS:case gS:m=nI;break;case mS:m=xI;break;case"scroll":m=Jb;break;case"wheel":m=yI;break;case"copy":case"cut":case"paste":m=sI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=$y}var x=(e&4)!==0,w=!x&&t==="scroll",A=x?g!==null?g+"Capture":null:g;x=[];for(var k=u,_;k!==null;){_=k;var O=_.stateNode;if(_.tag===5&&O!==null&&(_=O,A!==null&&(O=zd(k,A),O!=null&&x.push(Xd(k,O,_)))),w)break;k=k.return}0<x.length&&(g=new m(g,y,null,r,f),p.push({event:g,listeners:x}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",g&&r!==wm&&(y=r.relatedTarget||r.fromElement)&&(Fl(y)||y[Ga]))break e;if((m||g)&&(g=f.window===f?f:(g=f.ownerDocument)?g.defaultView||g.parentWindow:window,m?(y=r.relatedTarget||r.toElement,m=u,y=y?Fl(y):null,y!==null&&(w=ic(y),y!==w||y.tag!==5&&y.tag!==6)&&(y=null)):(m=null,y=u),m!==y)){if(x=Wy,O="onMouseLeave",A="onMouseEnter",k="mouse",(t==="pointerout"||t==="pointerover")&&(x=$y,O="onPointerLeave",A="onPointerEnter",k="pointer"),w=m==null?g:jc(m),_=y==null?g:jc(y),g=new x(O,k+"leave",m,r,f),g.target=w,g.relatedTarget=_,O=null,Fl(f)===u&&(x=new x(A,k+"enter",y,r,f),x.target=_,x.relatedTarget=w,O=x),w=O,m&&y)t:{for(x=m,A=y,k=0,_=x;_;_=Ac(_))k++;for(_=0,O=A;O;O=Ac(O))_++;for(;0<k-_;)x=Ac(x),k--;for(;0<_-k;)A=Ac(A),_--;for(;k--;){if(x===A||A!==null&&x===A.alternate)break t;x=Ac(x),A=Ac(A)}x=null}else x=null;m!==null&&r_(p,g,m,x,!1),y!==null&&w!==null&&r_(p,w,y,x,!0)}}e:{if(g=u?jc(u):window,m=g.nodeName&&g.nodeName.toLowerCase(),m==="select"||m==="input"&&g.type==="file")var G=kI;else if(Yy(g))if(lS)G=II;else{G=FI;var U=CI}else(m=g.nodeName)&&m.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(G=bI);if(G&&(G=G(t,u))){oS(p,G,r,f);break e}U&&U(t,g,u),t==="focusout"&&(U=g._wrapperState)&&U.controlled&&g.type==="number"&&xm(g,"number",g.value)}switch(U=u?jc(u):window,t){case"focusin":(Yy(U)||U.contentEditable==="true")&&(Bc=U,bm=u,wd=null);break;case"focusout":wd=bm=Bc=null;break;case"mousedown":Im=!0;break;case"contextmenu":case"mouseup":case"dragend":Im=!1,Zy(p,r,f);break;case"selectionchange":if(DI)break;case"keydown":case"keyup":Zy(p,r,f)}var T;if(e1)e:{switch(t){case"compositionstart":var F="onCompositionStart";break e;case"compositionend":F="onCompositionEnd";break e;case"compositionupdate":F="onCompositionUpdate";break e}F=void 0}else Mc?sS(t,r)&&(F="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(F="onCompositionStart");F&&(iS&&r.locale!=="ko"&&(Mc||F!=="onCompositionStart"?F==="onCompositionEnd"&&Mc&&(T=nS()):(No=f,Qx="value"in No?No.value:No.textContent,Mc=!0)),U=kh(u,F),0<U.length&&(F=new Hy(F,t,null,r,f),p.push({event:F,listeners:U}),T?F.data=T:(T=aS(r),T!==null&&(F.data=T)))),(T=EI?wI(t,r):SI(t,r))&&(u=kh(u,"onBeforeInput"),0<u.length&&(f=new Hy("onBeforeInput","beforeinput",null,r,f),p.push({event:f,listeners:u}),f.data=T))}vS(p,e)})}function Xd(t,e,r){return{instance:t,listener:e,currentTarget:r}}function kh(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=zd(t,r),s!=null&&n.unshift(Xd(t,s,i)),s=zd(t,e),s!=null&&n.push(Xd(t,s,i))),t=t.return}return n}function Ac(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function r_(t,e,r,n,i){for(var s=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,i?(l=zd(r,s),l!=null&&a.unshift(Xd(r,l,o))):i||(l=zd(r,s),l!=null&&a.push(Xd(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var BI=/\r\n?/g,LI=/\u0000|\uFFFD/g;function n_(t){return(typeof t=="string"?t:""+t).replace(BI,`
`).replace(LI,"")}function _0(t,e,r){if(e=n_(e),n_(t)!==e&&r)throw Error(Oe(425))}function Ch(){}var Nm=null,Rm=null;function Dm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Pm=typeof setTimeout=="function"?setTimeout:void 0,jI=typeof clearTimeout=="function"?clearTimeout:void 0,i_=typeof Promise=="function"?Promise:void 0,VI=typeof queueMicrotask=="function"?queueMicrotask:typeof i_<"u"?function(t){return i_.resolve(null).then(t).catch(UI)}:Pm;function UI(t){setTimeout(function(){throw t})}function Eg(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),$d(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);$d(e)}function Vo(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function s_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var bu=Math.random().toString(36).slice(2),la="__reactFiber$"+bu,qd="__reactProps$"+bu,Ga="__reactContainer$"+bu,Om="__reactEvents$"+bu,zI="__reactListeners$"+bu,WI="__reactHandles$"+bu;function Fl(t){var e=t[la];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Ga]||r[la]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=s_(t);t!==null;){if(r=t[la])return r;t=s_(t)}return e}t=r,r=t.parentNode}return null}function Nf(t){return t=t[la]||t[Ga],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function jc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Oe(33))}function Tp(t){return t[qd]||null}var Mm=[],Vc=-1;function al(t){return{current:t}}function mr(t){0>Vc||(t.current=Mm[Vc],Mm[Vc]=null,Vc--)}function ur(t,e){Vc++,Mm[Vc]=t.current,t.current=e}var Qo={},ai=al(Qo),Mi=al(!1),Ul=Qo;function cu(t,e){var r=t.type.contextTypes;if(!r)return Qo;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Bi(t){return t=t.childContextTypes,t!=null}function Fh(){mr(Mi),mr(ai)}function a_(t,e,r){if(ai.current!==Qo)throw Error(Oe(168));ur(ai,e),ur(Mi,r)}function _S(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(Oe(108,Cb(t)||"Unknown",i));return Ir({},r,n)}function bh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Qo,Ul=ai.current,ur(ai,t),ur(Mi,Mi.current),!0}function o_(t,e,r){var n=t.stateNode;if(!n)throw Error(Oe(169));r?(t=_S(t,e,Ul),n.__reactInternalMemoizedMergedChildContext=t,mr(Mi),mr(ai),ur(ai,t)):mr(Mi),ur(Mi,r)}var Da=null,Ap=!1,wg=!1;function ES(t){Da===null?Da=[t]:Da.push(t)}function HI(t){Ap=!0,ES(t)}function ol(){if(!wg&&Da!==null){wg=!0;var t=0,e=rr;try{var r=Da;for(rr=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Da=null,Ap=!1}catch(i){throw Da!==null&&(Da=Da.slice(t+1)),Gw(Kx,ol),i}finally{rr=e,wg=!1}}return null}var Uc=[],zc=0,Ih=null,Nh=0,vs=[],ys=0,zl=null,Pa=1,Oa="";function Sl(t,e){Uc[zc++]=Nh,Uc[zc++]=Ih,Ih=t,Nh=e}function wS(t,e,r){vs[ys++]=Pa,vs[ys++]=Oa,vs[ys++]=zl,zl=t;var n=Pa;t=Oa;var i=32-Gs(n)-1;n&=~(1<<i),r+=1;var s=32-Gs(e)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,Pa=1<<32-Gs(e)+i|r<<i|n,Oa=s+t}else Pa=1<<s|r<<i|n,Oa=t}function r1(t){t.return!==null&&(Sl(t,1),wS(t,1,0))}function n1(t){for(;t===Ih;)Ih=Uc[--zc],Uc[zc]=null,Nh=Uc[--zc],Uc[zc]=null;for(;t===zl;)zl=vs[--ys],vs[ys]=null,Oa=vs[--ys],vs[ys]=null,Pa=vs[--ys],vs[ys]=null}var qi=null,Xi=null,wr=!1,zs=null;function SS(t,e){var r=Es(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function l_(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,qi=t,Xi=Vo(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,qi=t,Xi=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=zl!==null?{id:Pa,overflow:Oa}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Es(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,qi=t,Xi=null,!0):!1;default:return!1}}function Bm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Lm(t){if(wr){var e=Xi;if(e){var r=e;if(!l_(t,e)){if(Bm(t))throw Error(Oe(418));e=Vo(r.nextSibling);var n=qi;e&&l_(t,e)?SS(n,r):(t.flags=t.flags&-4097|2,wr=!1,qi=t)}}else{if(Bm(t))throw Error(Oe(418));t.flags=t.flags&-4097|2,wr=!1,qi=t}}}function c_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;qi=t}function E0(t){if(t!==qi)return!1;if(!wr)return c_(t),wr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Dm(t.type,t.memoizedProps)),e&&(e=Xi)){if(Bm(t))throw TS(),Error(Oe(418));for(;e;)SS(t,e),e=Vo(e.nextSibling)}if(c_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Oe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Xi=Vo(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Xi=null}}else Xi=qi?Vo(t.stateNode.nextSibling):null;return!0}function TS(){for(var t=Xi;t;)t=Vo(t.nextSibling)}function uu(){Xi=qi=null,wr=!1}function i1(t){zs===null?zs=[t]:zs.push(t)}var $I=to.ReactCurrentBatchConfig;function Zu(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Oe(309));var n=r.stateNode}if(!n)throw Error(Oe(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(Oe(284));if(!r._owner)throw Error(Oe(290,t))}return t}function w0(t,e){throw t=Object.prototype.toString.call(e),Error(Oe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function u_(t){var e=t._init;return e(t._payload)}function AS(t){function e(A,k){if(t){var _=A.deletions;_===null?(A.deletions=[k],A.flags|=16):_.push(k)}}function r(A,k){if(!t)return null;for(;k!==null;)e(A,k),k=k.sibling;return null}function n(A,k){for(A=new Map;k!==null;)k.key!==null?A.set(k.key,k):A.set(k.index,k),k=k.sibling;return A}function i(A,k){return A=Ho(A,k),A.index=0,A.sibling=null,A}function s(A,k,_){return A.index=_,t?(_=A.alternate,_!==null?(_=_.index,_<k?(A.flags|=2,k):_):(A.flags|=2,k)):(A.flags|=1048576,k)}function a(A){return t&&A.alternate===null&&(A.flags|=2),A}function o(A,k,_,O){return k===null||k.tag!==6?(k=bg(_,A.mode,O),k.return=A,k):(k=i(k,_),k.return=A,k)}function l(A,k,_,O){var G=_.type;return G===Oc?f(A,k,_.props.children,O,_.key):k!==null&&(k.elementType===G||typeof G=="object"&&G!==null&&G.$$typeof===So&&u_(G)===k.type)?(O=i(k,_.props),O.ref=Zu(A,k,_),O.return=A,O):(O=ch(_.type,_.key,_.props,null,A.mode,O),O.ref=Zu(A,k,_),O.return=A,O)}function u(A,k,_,O){return k===null||k.tag!==4||k.stateNode.containerInfo!==_.containerInfo||k.stateNode.implementation!==_.implementation?(k=Ig(_,A.mode,O),k.return=A,k):(k=i(k,_.children||[]),k.return=A,k)}function f(A,k,_,O,G){return k===null||k.tag!==7?(k=Pl(_,A.mode,O,G),k.return=A,k):(k=i(k,_),k.return=A,k)}function p(A,k,_){if(typeof k=="string"&&k!==""||typeof k=="number")return k=bg(""+k,A.mode,_),k.return=A,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case d0:return _=ch(k.type,k.key,k.props,null,A.mode,_),_.ref=Zu(A,null,k),_.return=A,_;case Pc:return k=Ig(k,A.mode,_),k.return=A,k;case So:var O=k._init;return p(A,O(k._payload),_)}if(ld(k)||Yu(k))return k=Pl(k,A.mode,_,null),k.return=A,k;w0(A,k)}return null}function g(A,k,_,O){var G=k!==null?k.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return G!==null?null:o(A,k,""+_,O);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case d0:return _.key===G?l(A,k,_,O):null;case Pc:return _.key===G?u(A,k,_,O):null;case So:return G=_._init,g(A,k,G(_._payload),O)}if(ld(_)||Yu(_))return G!==null?null:f(A,k,_,O,null);w0(A,_)}return null}function m(A,k,_,O,G){if(typeof O=="string"&&O!==""||typeof O=="number")return A=A.get(_)||null,o(k,A,""+O,G);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case d0:return A=A.get(O.key===null?_:O.key)||null,l(k,A,O,G);case Pc:return A=A.get(O.key===null?_:O.key)||null,u(k,A,O,G);case So:var U=O._init;return m(A,k,_,U(O._payload),G)}if(ld(O)||Yu(O))return A=A.get(_)||null,f(k,A,O,G,null);w0(k,O)}return null}function y(A,k,_,O){for(var G=null,U=null,T=k,F=k=0,S=null;T!==null&&F<_.length;F++){T.index>F?(S=T,T=null):S=T.sibling;var I=g(A,T,_[F],O);if(I===null){T===null&&(T=S);break}t&&T&&I.alternate===null&&e(A,T),k=s(I,k,F),U===null?G=I:U.sibling=I,U=I,T=S}if(F===_.length)return r(A,T),wr&&Sl(A,F),G;if(T===null){for(;F<_.length;F++)T=p(A,_[F],O),T!==null&&(k=s(T,k,F),U===null?G=T:U.sibling=T,U=T);return wr&&Sl(A,F),G}for(T=n(A,T);F<_.length;F++)S=m(T,A,F,_[F],O),S!==null&&(t&&S.alternate!==null&&T.delete(S.key===null?F:S.key),k=s(S,k,F),U===null?G=S:U.sibling=S,U=S);return t&&T.forEach(function(R){return e(A,R)}),wr&&Sl(A,F),G}function x(A,k,_,O){var G=Yu(_);if(typeof G!="function")throw Error(Oe(150));if(_=G.call(_),_==null)throw Error(Oe(151));for(var U=G=null,T=k,F=k=0,S=null,I=_.next();T!==null&&!I.done;F++,I=_.next()){T.index>F?(S=T,T=null):S=T.sibling;var R=g(A,T,I.value,O);if(R===null){T===null&&(T=S);break}t&&T&&R.alternate===null&&e(A,T),k=s(R,k,F),U===null?G=R:U.sibling=R,U=R,T=S}if(I.done)return r(A,T),wr&&Sl(A,F),G;if(T===null){for(;!I.done;F++,I=_.next())I=p(A,I.value,O),I!==null&&(k=s(I,k,F),U===null?G=I:U.sibling=I,U=I);return wr&&Sl(A,F),G}for(T=n(A,T);!I.done;F++,I=_.next())I=m(T,A,F,I.value,O),I!==null&&(t&&I.alternate!==null&&T.delete(I.key===null?F:I.key),k=s(I,k,F),U===null?G=I:U.sibling=I,U=I);return t&&T.forEach(function(D){return e(A,D)}),wr&&Sl(A,F),G}function w(A,k,_,O){if(typeof _=="object"&&_!==null&&_.type===Oc&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case d0:e:{for(var G=_.key,U=k;U!==null;){if(U.key===G){if(G=_.type,G===Oc){if(U.tag===7){r(A,U.sibling),k=i(U,_.props.children),k.return=A,A=k;break e}}else if(U.elementType===G||typeof G=="object"&&G!==null&&G.$$typeof===So&&u_(G)===U.type){r(A,U.sibling),k=i(U,_.props),k.ref=Zu(A,U,_),k.return=A,A=k;break e}r(A,U);break}else e(A,U);U=U.sibling}_.type===Oc?(k=Pl(_.props.children,A.mode,O,_.key),k.return=A,A=k):(O=ch(_.type,_.key,_.props,null,A.mode,O),O.ref=Zu(A,k,_),O.return=A,A=O)}return a(A);case Pc:e:{for(U=_.key;k!==null;){if(k.key===U)if(k.tag===4&&k.stateNode.containerInfo===_.containerInfo&&k.stateNode.implementation===_.implementation){r(A,k.sibling),k=i(k,_.children||[]),k.return=A,A=k;break e}else{r(A,k);break}else e(A,k);k=k.sibling}k=Ig(_,A.mode,O),k.return=A,A=k}return a(A);case So:return U=_._init,w(A,k,U(_._payload),O)}if(ld(_))return y(A,k,_,O);if(Yu(_))return x(A,k,_,O);w0(A,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,k!==null&&k.tag===6?(r(A,k.sibling),k=i(k,_),k.return=A,A=k):(r(A,k),k=bg(_,A.mode,O),k.return=A,A=k),a(A)):r(A,k)}return w}var du=AS(!0),kS=AS(!1),Rh=al(null),Dh=null,Wc=null,s1=null;function a1(){s1=Wc=Dh=null}function o1(t){var e=Rh.current;mr(Rh),t._currentValue=e}function jm(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Jc(t,e){Dh=t,s1=Wc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Oi=!0),t.firstContext=null)}function Ts(t){var e=t._currentValue;if(s1!==t)if(t={context:t,memoizedValue:e,next:null},Wc===null){if(Dh===null)throw Error(Oe(308));Wc=t,Dh.dependencies={lanes:0,firstContext:t}}else Wc=Wc.next=t;return e}var bl=null;function l1(t){bl===null?bl=[t]:bl.push(t)}function CS(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,l1(e)):(r.next=i.next,i.next=r),e.interleaved=r,Ka(t,n)}function Ka(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var To=!1;function c1(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function FS(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Va(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Uo(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Wt&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,Ka(t,r)}return i=n.interleaved,i===null?(e.next=e,l1(n)):(e.next=i.next,i.next=e),n.interleaved=e,Ka(t,r)}function nh(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Yx(t,r)}}function d_(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Ph(t,e,r,n){var i=t.updateQueue;To=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?s=u:a.next=u,a=l;var f=t.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==a&&(o===null?f.firstBaseUpdate=u:o.next=u,f.lastBaseUpdate=l))}if(s!==null){var p=i.baseState;a=0,f=u=l=null,o=s;do{var g=o.lane,m=o.eventTime;if((n&g)===g){f!==null&&(f=f.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=t,x=o;switch(g=e,m=r,x.tag){case 1:if(y=x.payload,typeof y=="function"){p=y.call(m,p,g);break e}p=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=x.payload,g=typeof y=="function"?y.call(m,p,g):y,g==null)break e;p=Ir({},p,g);break e;case 2:To=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,g=i.effects,g===null?i.effects=[o]:g.push(o))}else m={eventTime:m,lane:g,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(u=f=m,l=p):f=f.next=m,a|=g;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;g=o,o=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(f===null&&(l=p),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Hl|=a,t.lanes=a,t.memoizedState=p}}function f_(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Oe(191,i));i.call(n)}}}var Rf={},da=al(Rf),Qd=al(Rf),Jd=al(Rf);function Il(t){if(t===Rf)throw Error(Oe(174));return t}function u1(t,e){switch(ur(Jd,e),ur(Qd,t),ur(da,Rf),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ym(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=ym(e,t)}mr(da),ur(da,e)}function fu(){mr(da),mr(Qd),mr(Jd)}function bS(t){Il(Jd.current);var e=Il(da.current),r=ym(e,t.type);e!==r&&(ur(Qd,t),ur(da,r))}function d1(t){Qd.current===t&&(mr(da),mr(Qd))}var kr=al(0);function Oh(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Sg=[];function f1(){for(var t=0;t<Sg.length;t++)Sg[t]._workInProgressVersionPrimary=null;Sg.length=0}var ih=to.ReactCurrentDispatcher,Tg=to.ReactCurrentBatchConfig,Wl=0,br=null,dn=null,An=null,Mh=!1,Sd=!1,Zd=0,GI=0;function Yn(){throw Error(Oe(321))}function h1(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!qs(t[r],e[r]))return!1;return!0}function p1(t,e,r,n,i,s){if(Wl=s,br=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ih.current=t===null||t.memoizedState===null?qI:QI,t=r(n,i),Sd){s=0;do{if(Sd=!1,Zd=0,25<=s)throw Error(Oe(301));s+=1,An=dn=null,e.updateQueue=null,ih.current=JI,t=r(n,i)}while(Sd)}if(ih.current=Bh,e=dn!==null&&dn.next!==null,Wl=0,An=dn=br=null,Mh=!1,e)throw Error(Oe(300));return t}function g1(){var t=Zd!==0;return Zd=0,t}function oa(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return An===null?br.memoizedState=An=t:An=An.next=t,An}function As(){if(dn===null){var t=br.alternate;t=t!==null?t.memoizedState:null}else t=dn.next;var e=An===null?br.memoizedState:An.next;if(e!==null)An=e,dn=t;else{if(t===null)throw Error(Oe(310));dn=t,t={memoizedState:dn.memoizedState,baseState:dn.baseState,baseQueue:dn.baseQueue,queue:dn.queue,next:null},An===null?br.memoizedState=An=t:An=An.next=t}return An}function ef(t,e){return typeof e=="function"?e(t):e}function Ag(t){var e=As(),r=e.queue;if(r===null)throw Error(Oe(311));r.lastRenderedReducer=t;var n=dn,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,u=s;do{var f=u.lane;if((Wl&f)===f)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var p={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=p,a=n):l=l.next=p,br.lanes|=f,Hl|=f}u=u.next}while(u!==null&&u!==s);l===null?a=n:l.next=o,qs(n,e.memoizedState)||(Oi=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,br.lanes|=s,Hl|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function kg(t){var e=As(),r=e.queue;if(r===null)throw Error(Oe(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);qs(s,e.memoizedState)||(Oi=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function IS(){}function NS(t,e){var r=br,n=As(),i=e(),s=!qs(n.memoizedState,i);if(s&&(n.memoizedState=i,Oi=!0),n=n.queue,m1(PS.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||An!==null&&An.memoizedState.tag&1){if(r.flags|=2048,tf(9,DS.bind(null,r,n,i,e),void 0,null),Fn===null)throw Error(Oe(349));Wl&30||RS(r,e,i)}return i}function RS(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=br.updateQueue,e===null?(e={lastEffect:null,stores:null},br.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function DS(t,e,r,n){e.value=r,e.getSnapshot=n,OS(e)&&MS(t)}function PS(t,e,r){return r(function(){OS(e)&&MS(t)})}function OS(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!qs(t,r)}catch{return!0}}function MS(t){var e=Ka(t,1);e!==null&&Ks(e,t,1,-1)}function h_(t){var e=oa();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ef,lastRenderedState:t},e.queue=t,t=t.dispatch=XI.bind(null,br,t),[e.memoizedState,t]}function tf(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=br.updateQueue,e===null?(e={lastEffect:null,stores:null},br.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function BS(){return As().memoizedState}function sh(t,e,r,n){var i=oa();br.flags|=t,i.memoizedState=tf(1|e,r,void 0,n===void 0?null:n)}function kp(t,e,r,n){var i=As();n=n===void 0?null:n;var s=void 0;if(dn!==null){var a=dn.memoizedState;if(s=a.destroy,n!==null&&h1(n,a.deps)){i.memoizedState=tf(e,r,s,n);return}}br.flags|=t,i.memoizedState=tf(1|e,r,s,n)}function p_(t,e){return sh(8390656,8,t,e)}function m1(t,e){return kp(2048,8,t,e)}function LS(t,e){return kp(4,2,t,e)}function jS(t,e){return kp(4,4,t,e)}function VS(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function US(t,e,r){return r=r!=null?r.concat([t]):null,kp(4,4,VS.bind(null,e,t),r)}function x1(){}function zS(t,e){var r=As();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&h1(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function WS(t,e){var r=As();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&h1(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function HS(t,e,r){return Wl&21?(qs(r,e)||(r=Xw(),br.lanes|=r,Hl|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Oi=!0),t.memoizedState=r)}function KI(t,e){var r=rr;rr=r!==0&&4>r?r:4,t(!0);var n=Tg.transition;Tg.transition={};try{t(!1),e()}finally{rr=r,Tg.transition=n}}function $S(){return As().memoizedState}function YI(t,e,r){var n=Wo(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},GS(t))KS(e,r);else if(r=CS(t,e,r,n),r!==null){var i=vi();Ks(r,t,n,i),YS(r,e,n)}}function XI(t,e,r){var n=Wo(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(GS(t))KS(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,qs(o,a)){var l=e.interleaved;l===null?(i.next=i,l1(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=CS(t,e,i,n),r!==null&&(i=vi(),Ks(r,t,n,i),YS(r,e,n))}}function GS(t){var e=t.alternate;return t===br||e!==null&&e===br}function KS(t,e){Sd=Mh=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function YS(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Yx(t,r)}}var Bh={readContext:Ts,useCallback:Yn,useContext:Yn,useEffect:Yn,useImperativeHandle:Yn,useInsertionEffect:Yn,useLayoutEffect:Yn,useMemo:Yn,useReducer:Yn,useRef:Yn,useState:Yn,useDebugValue:Yn,useDeferredValue:Yn,useTransition:Yn,useMutableSource:Yn,useSyncExternalStore:Yn,useId:Yn,unstable_isNewReconciler:!1},qI={readContext:Ts,useCallback:function(t,e){return oa().memoizedState=[t,e===void 0?null:e],t},useContext:Ts,useEffect:p_,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,sh(4194308,4,VS.bind(null,e,t),r)},useLayoutEffect:function(t,e){return sh(4194308,4,t,e)},useInsertionEffect:function(t,e){return sh(4,2,t,e)},useMemo:function(t,e){var r=oa();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=oa();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=YI.bind(null,br,t),[n.memoizedState,t]},useRef:function(t){var e=oa();return t={current:t},e.memoizedState=t},useState:h_,useDebugValue:x1,useDeferredValue:function(t){return oa().memoizedState=t},useTransition:function(){var t=h_(!1),e=t[0];return t=KI.bind(null,t[1]),oa().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=br,i=oa();if(wr){if(r===void 0)throw Error(Oe(407));r=r()}else{if(r=e(),Fn===null)throw Error(Oe(349));Wl&30||RS(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,p_(PS.bind(null,n,s,t),[t]),n.flags|=2048,tf(9,DS.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=oa(),e=Fn.identifierPrefix;if(wr){var r=Oa,n=Pa;r=(n&~(1<<32-Gs(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Zd++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=GI++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},QI={readContext:Ts,useCallback:zS,useContext:Ts,useEffect:m1,useImperativeHandle:US,useInsertionEffect:LS,useLayoutEffect:jS,useMemo:WS,useReducer:Ag,useRef:BS,useState:function(){return Ag(ef)},useDebugValue:x1,useDeferredValue:function(t){var e=As();return HS(e,dn.memoizedState,t)},useTransition:function(){var t=Ag(ef)[0],e=As().memoizedState;return[t,e]},useMutableSource:IS,useSyncExternalStore:NS,useId:$S,unstable_isNewReconciler:!1},JI={readContext:Ts,useCallback:zS,useContext:Ts,useEffect:m1,useImperativeHandle:US,useInsertionEffect:LS,useLayoutEffect:jS,useMemo:WS,useReducer:kg,useRef:BS,useState:function(){return kg(ef)},useDebugValue:x1,useDeferredValue:function(t){var e=As();return dn===null?e.memoizedState=t:HS(e,dn.memoizedState,t)},useTransition:function(){var t=kg(ef)[0],e=As().memoizedState;return[t,e]},useMutableSource:IS,useSyncExternalStore:NS,useId:$S,unstable_isNewReconciler:!1};function Vs(t,e){if(t&&t.defaultProps){e=Ir({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Vm(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Ir({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Cp={isMounted:function(t){return(t=t._reactInternals)?ic(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=vi(),i=Wo(t),s=Va(n,i);s.payload=e,r!=null&&(s.callback=r),e=Uo(t,s,i),e!==null&&(Ks(e,t,i,n),nh(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=vi(),i=Wo(t),s=Va(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=Uo(t,s,i),e!==null&&(Ks(e,t,i,n),nh(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=vi(),n=Wo(t),i=Va(r,n);i.tag=2,e!=null&&(i.callback=e),e=Uo(t,i,n),e!==null&&(Ks(e,t,n,r),nh(e,t,n))}};function g_(t,e,r,n,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,a):e.prototype&&e.prototype.isPureReactComponent?!Kd(r,n)||!Kd(i,s):!0}function XS(t,e,r){var n=!1,i=Qo,s=e.contextType;return typeof s=="object"&&s!==null?s=Ts(s):(i=Bi(e)?Ul:ai.current,n=e.contextTypes,s=(n=n!=null)?cu(t,i):Qo),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Cp,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function m_(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Cp.enqueueReplaceState(e,e.state,null)}function Um(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},c1(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Ts(s):(s=Bi(e)?Ul:ai.current,i.context=cu(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Vm(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Cp.enqueueReplaceState(i,i.state,null),Ph(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function hu(t,e){try{var r="",n=e;do r+=kb(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Cg(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function zm(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var ZI=typeof WeakMap=="function"?WeakMap:Map;function qS(t,e,r){r=Va(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){jh||(jh=!0,Jm=n),zm(t,e)},r}function QS(t,e,r){r=Va(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){zm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){zm(t,e),typeof n!="function"&&(zo===null?zo=new Set([this]):zo.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function x_(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new ZI;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=hN.bind(null,t,e,r),e.then(t,t))}function v_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function y_(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Va(-1,1),e.tag=2,Uo(r,e,1))),r.lanes|=1),t)}var eN=to.ReactCurrentOwner,Oi=!1;function gi(t,e,r,n){e.child=t===null?kS(e,null,r,n):du(e,t.child,r,n)}function __(t,e,r,n,i){r=r.render;var s=e.ref;return Jc(e,i),n=p1(t,e,r,n,s,i),r=g1(),t!==null&&!Oi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ya(t,e,i)):(wr&&r&&r1(e),e.flags|=1,gi(t,e,n,i),e.child)}function E_(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!A1(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,JS(t,e,s,n,i)):(t=ch(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:Kd,r(a,n)&&t.ref===e.ref)return Ya(t,e,i)}return e.flags|=1,t=Ho(s,n),t.ref=e.ref,t.return=e,e.child=t}function JS(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(Kd(s,n)&&t.ref===e.ref)if(Oi=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(Oi=!0);else return e.lanes=t.lanes,Ya(t,e,i)}return Wm(t,e,r,n,i)}function ZS(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ur($c,Hi),Hi|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ur($c,Hi),Hi|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,ur($c,Hi),Hi|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,ur($c,Hi),Hi|=n;return gi(t,e,i,r),e.child}function eT(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Wm(t,e,r,n,i){var s=Bi(r)?Ul:ai.current;return s=cu(e,s),Jc(e,i),r=p1(t,e,r,n,s,i),n=g1(),t!==null&&!Oi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ya(t,e,i)):(wr&&n&&r1(e),e.flags|=1,gi(t,e,r,i),e.child)}function w_(t,e,r,n,i){if(Bi(r)){var s=!0;bh(e)}else s=!1;if(Jc(e,i),e.stateNode===null)ah(t,e),XS(e,r,n),Um(e,r,n,i),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,u=r.contextType;typeof u=="object"&&u!==null?u=Ts(u):(u=Bi(r)?Ul:ai.current,u=cu(e,u));var f=r.getDerivedStateFromProps,p=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";p||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==u)&&m_(e,a,n,u),To=!1;var g=e.memoizedState;a.state=g,Ph(e,n,a,i),l=e.memoizedState,o!==n||g!==l||Mi.current||To?(typeof f=="function"&&(Vm(e,r,f,n),l=e.memoizedState),(o=To||g_(e,r,o,n,g,l,u))?(p||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=u,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,FS(t,e),o=e.memoizedProps,u=e.type===e.elementType?o:Vs(e.type,o),a.props=u,p=e.pendingProps,g=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=Ts(l):(l=Bi(r)?Ul:ai.current,l=cu(e,l));var m=r.getDerivedStateFromProps;(f=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==p||g!==l)&&m_(e,a,n,l),To=!1,g=e.memoizedState,a.state=g,Ph(e,n,a,i);var y=e.memoizedState;o!==p||g!==y||Mi.current||To?(typeof m=="function"&&(Vm(e,r,m,n),y=e.memoizedState),(u=To||g_(e,r,u,n,g,y,l)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,y,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,y,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=y),a.props=n,a.state=y,a.context=l,n=u):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),n=!1)}return Hm(t,e,r,n,s,i)}function Hm(t,e,r,n,i,s){eT(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return i&&o_(e,r,!1),Ya(t,e,s);n=e.stateNode,eN.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=du(e,t.child,null,s),e.child=du(e,null,o,s)):gi(t,e,o,s),e.memoizedState=n.state,i&&o_(e,r,!0),e.child}function tT(t){var e=t.stateNode;e.pendingContext?a_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&a_(t,e.context,!1),u1(t,e.containerInfo)}function S_(t,e,r,n,i){return uu(),i1(i),e.flags|=256,gi(t,e,r,n),e.child}var $m={dehydrated:null,treeContext:null,retryLane:0};function Gm(t){return{baseLanes:t,cachePool:null,transitions:null}}function rT(t,e,r){var n=e.pendingProps,i=kr.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ur(kr,i&1),t===null)return Lm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,s?(n=e.mode,s=e.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=Ip(a,n,0,null),t=Pl(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Gm(r),e.memoizedState=$m,t):v1(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return tN(t,e,a,n,o,i,r);if(s){s=n.fallback,a=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=Ho(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=Ho(o,s):(s=Pl(s,a,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,a=t.child.memoizedState,a=a===null?Gm(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~r,e.memoizedState=$m,n}return s=t.child,t=s.sibling,n=Ho(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function v1(t,e){return e=Ip({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function S0(t,e,r,n){return n!==null&&i1(n),du(e,t.child,null,r),t=v1(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function tN(t,e,r,n,i,s,a){if(r)return e.flags&256?(e.flags&=-257,n=Cg(Error(Oe(422))),S0(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=Ip({mode:"visible",children:n.children},i,0,null),s=Pl(s,i,a,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&du(e,t.child,null,a),e.child.memoizedState=Gm(a),e.memoizedState=$m,s);if(!(e.mode&1))return S0(t,e,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(Oe(419)),n=Cg(s,n,void 0),S0(t,e,a,n)}if(o=(a&t.childLanes)!==0,Oi||o){if(n=Fn,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Ka(t,i),Ks(n,t,i,-1))}return T1(),n=Cg(Error(Oe(421))),S0(t,e,a,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=pN.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Xi=Vo(i.nextSibling),qi=e,wr=!0,zs=null,t!==null&&(vs[ys++]=Pa,vs[ys++]=Oa,vs[ys++]=zl,Pa=t.id,Oa=t.overflow,zl=e),e=v1(e,n.children),e.flags|=4096,e)}function T_(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),jm(t.return,e,r)}function Fg(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function nT(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(gi(t,e,n.children,r),n=kr.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&T_(t,r,e);else if(t.tag===19)T_(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(ur(kr,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&Oh(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),Fg(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Oh(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}Fg(e,!0,r,null,s);break;case"together":Fg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ah(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ya(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Hl|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Oe(153));if(e.child!==null){for(t=e.child,r=Ho(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Ho(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function rN(t,e,r){switch(e.tag){case 3:tT(e),uu();break;case 5:bS(e);break;case 1:Bi(e.type)&&bh(e);break;case 4:u1(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;ur(Rh,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(ur(kr,kr.current&1),e.flags|=128,null):r&e.child.childLanes?rT(t,e,r):(ur(kr,kr.current&1),t=Ya(t,e,r),t!==null?t.sibling:null);ur(kr,kr.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return nT(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ur(kr,kr.current),n)break;return null;case 22:case 23:return e.lanes=0,ZS(t,e,r)}return Ya(t,e,r)}var iT,Km,sT,aT;iT=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Km=function(){};sT=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,Il(da.current);var s=null;switch(r){case"input":i=gm(t,i),n=gm(t,n),s=[];break;case"select":i=Ir({},i,{value:void 0}),n=Ir({},n,{value:void 0}),s=[];break;case"textarea":i=vm(t,i),n=vm(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Ch)}_m(r,n);var a;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Vd.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var l=n[u];if(o=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Vd.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&pr("scroll",t),s||o===l||(s=[])):(s=s||[]).push(u,l))}r&&(s=s||[]).push("style",r);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};aT=function(t,e,r,n){r!==n&&(e.flags|=4)};function ed(t,e){if(!wr)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Xn(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function nN(t,e,r){var n=e.pendingProps;switch(n1(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xn(e),null;case 1:return Bi(e.type)&&Fh(),Xn(e),null;case 3:return n=e.stateNode,fu(),mr(Mi),mr(ai),f1(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(E0(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,zs!==null&&(tx(zs),zs=null))),Km(t,e),Xn(e),null;case 5:d1(e);var i=Il(Jd.current);if(r=e.type,t!==null&&e.stateNode!=null)sT(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Oe(166));return Xn(e),null}if(t=Il(da.current),E0(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[la]=e,n[qd]=s,t=(e.mode&1)!==0,r){case"dialog":pr("cancel",n),pr("close",n);break;case"iframe":case"object":case"embed":pr("load",n);break;case"video":case"audio":for(i=0;i<ud.length;i++)pr(ud[i],n);break;case"source":pr("error",n);break;case"img":case"image":case"link":pr("error",n),pr("load",n);break;case"details":pr("toggle",n);break;case"input":Dy(n,s),pr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},pr("invalid",n);break;case"textarea":Oy(n,s),pr("invalid",n)}_m(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&_0(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&_0(n.textContent,o,t),i=["children",""+o]):Vd.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&pr("scroll",n)}switch(r){case"input":f0(n),Py(n,s,!0);break;case"textarea":f0(n),My(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Ch)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Pw(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[la]=e,t[qd]=n,iT(t,e,!1,!1),e.stateNode=t;e:{switch(a=Em(r,n),r){case"dialog":pr("cancel",t),pr("close",t),i=n;break;case"iframe":case"object":case"embed":pr("load",t),i=n;break;case"video":case"audio":for(i=0;i<ud.length;i++)pr(ud[i],t);i=n;break;case"source":pr("error",t),i=n;break;case"img":case"image":case"link":pr("error",t),pr("load",t),i=n;break;case"details":pr("toggle",t),i=n;break;case"input":Dy(t,n),i=gm(t,n),pr("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=Ir({},n,{value:void 0}),pr("invalid",t);break;case"textarea":Oy(t,n),i=vm(t,n),pr("invalid",t);break;default:i=n}_m(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?Bw(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Ow(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Ud(t,l):typeof l=="number"&&Ud(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Vd.hasOwnProperty(s)?l!=null&&s==="onScroll"&&pr("scroll",t):l!=null&&zx(t,s,l,a))}switch(r){case"input":f0(t),Py(t,n,!1);break;case"textarea":f0(t),My(t);break;case"option":n.value!=null&&t.setAttribute("value",""+qo(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?Yc(t,!!n.multiple,s,!1):n.defaultValue!=null&&Yc(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Ch)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Xn(e),null;case 6:if(t&&e.stateNode!=null)aT(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Oe(166));if(r=Il(Jd.current),Il(da.current),E0(e)){if(n=e.stateNode,r=e.memoizedProps,n[la]=e,(s=n.nodeValue!==r)&&(t=qi,t!==null))switch(t.tag){case 3:_0(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&_0(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[la]=e,e.stateNode=n}return Xn(e),null;case 13:if(mr(kr),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(wr&&Xi!==null&&e.mode&1&&!(e.flags&128))TS(),uu(),e.flags|=98560,s=!1;else if(s=E0(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(Oe(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Oe(317));s[la]=e}else uu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Xn(e),s=!1}else zs!==null&&(tx(zs),zs=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||kr.current&1?pn===0&&(pn=3):T1())),e.updateQueue!==null&&(e.flags|=4),Xn(e),null);case 4:return fu(),Km(t,e),t===null&&Yd(e.stateNode.containerInfo),Xn(e),null;case 10:return o1(e.type._context),Xn(e),null;case 17:return Bi(e.type)&&Fh(),Xn(e),null;case 19:if(mr(kr),s=e.memoizedState,s===null)return Xn(e),null;if(n=(e.flags&128)!==0,a=s.rendering,a===null)if(n)ed(s,!1);else{if(pn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Oh(t),a!==null){for(e.flags|=128,ed(s,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return ur(kr,kr.current&1|2),e.child}t=t.sibling}s.tail!==null&&Wr()>pu&&(e.flags|=128,n=!0,ed(s,!1),e.lanes=4194304)}else{if(!n)if(t=Oh(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),ed(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!wr)return Xn(e),null}else 2*Wr()-s.renderingStartTime>pu&&r!==1073741824&&(e.flags|=128,n=!0,ed(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(r=s.last,r!==null?r.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Wr(),e.sibling=null,r=kr.current,ur(kr,n?r&1|2:r&1),e):(Xn(e),null);case 22:case 23:return S1(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Hi&1073741824&&(Xn(e),e.subtreeFlags&6&&(e.flags|=8192)):Xn(e),null;case 24:return null;case 25:return null}throw Error(Oe(156,e.tag))}function iN(t,e){switch(n1(e),e.tag){case 1:return Bi(e.type)&&Fh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return fu(),mr(Mi),mr(ai),f1(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return d1(e),null;case 13:if(mr(kr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Oe(340));uu()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return mr(kr),null;case 4:return fu(),null;case 10:return o1(e.type._context),null;case 22:case 23:return S1(),null;case 24:return null;default:return null}}var T0=!1,ti=!1,sN=typeof WeakSet=="function"?WeakSet:Set,Je=null;function Hc(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Dr(t,e,n)}else r.current=null}function Ym(t,e,r){try{r()}catch(n){Dr(t,e,n)}}var A_=!1;function aN(t,e){if(Nm=Th,t=dS(),t1(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,u=0,f=0,p=t,g=null;t:for(;;){for(var m;p!==r||i!==0&&p.nodeType!==3||(o=a+i),p!==s||n!==0&&p.nodeType!==3||(l=a+n),p.nodeType===3&&(a+=p.nodeValue.length),(m=p.firstChild)!==null;)g=p,p=m;for(;;){if(p===t)break t;if(g===r&&++u===i&&(o=a),g===s&&++f===n&&(l=a),(m=p.nextSibling)!==null)break;p=g,g=p.parentNode}p=m}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Rm={focusedElem:t,selectionRange:r},Th=!1,Je=e;Je!==null;)if(e=Je,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Je=t;else for(;Je!==null;){e=Je;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var x=y.memoizedProps,w=y.memoizedState,A=e.stateNode,k=A.getSnapshotBeforeUpdate(e.elementType===e.type?x:Vs(e.type,x),w);A.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Oe(163))}}catch(O){Dr(e,e.return,O)}if(t=e.sibling,t!==null){t.return=e.return,Je=t;break}Je=e.return}return y=A_,A_=!1,y}function Td(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Ym(e,r,s)}i=i.next}while(i!==n)}}function Fp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Xm(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function oT(t){var e=t.alternate;e!==null&&(t.alternate=null,oT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[la],delete e[qd],delete e[Om],delete e[zI],delete e[WI])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function lT(t){return t.tag===5||t.tag===3||t.tag===4}function k_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||lT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function qm(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Ch));else if(n!==4&&(t=t.child,t!==null))for(qm(t,e,r),t=t.sibling;t!==null;)qm(t,e,r),t=t.sibling}function Qm(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Qm(t,e,r),t=t.sibling;t!==null;)Qm(t,e,r),t=t.sibling}var Dn=null,Us=!1;function yo(t,e,r){for(r=r.child;r!==null;)cT(t,e,r),r=r.sibling}function cT(t,e,r){if(ua&&typeof ua.onCommitFiberUnmount=="function")try{ua.onCommitFiberUnmount(_p,r)}catch{}switch(r.tag){case 5:ti||Hc(r,e);case 6:var n=Dn,i=Us;Dn=null,yo(t,e,r),Dn=n,Us=i,Dn!==null&&(Us?(t=Dn,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Dn.removeChild(r.stateNode));break;case 18:Dn!==null&&(Us?(t=Dn,r=r.stateNode,t.nodeType===8?Eg(t.parentNode,r):t.nodeType===1&&Eg(t,r),$d(t)):Eg(Dn,r.stateNode));break;case 4:n=Dn,i=Us,Dn=r.stateNode.containerInfo,Us=!0,yo(t,e,r),Dn=n,Us=i;break;case 0:case 11:case 14:case 15:if(!ti&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&Ym(r,e,a),i=i.next}while(i!==n)}yo(t,e,r);break;case 1:if(!ti&&(Hc(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Dr(r,e,o)}yo(t,e,r);break;case 21:yo(t,e,r);break;case 22:r.mode&1?(ti=(n=ti)||r.memoizedState!==null,yo(t,e,r),ti=n):yo(t,e,r);break;default:yo(t,e,r)}}function C_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new sN),e.forEach(function(n){var i=gN.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Ms(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:Dn=o.stateNode,Us=!1;break e;case 3:Dn=o.stateNode.containerInfo,Us=!0;break e;case 4:Dn=o.stateNode.containerInfo,Us=!0;break e}o=o.return}if(Dn===null)throw Error(Oe(160));cT(s,a,i),Dn=null,Us=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){Dr(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)uT(e,t),e=e.sibling}function uT(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ms(e,t),na(t),n&4){try{Td(3,t,t.return),Fp(3,t)}catch(x){Dr(t,t.return,x)}try{Td(5,t,t.return)}catch(x){Dr(t,t.return,x)}}break;case 1:Ms(e,t),na(t),n&512&&r!==null&&Hc(r,r.return);break;case 5:if(Ms(e,t),na(t),n&512&&r!==null&&Hc(r,r.return),t.flags&32){var i=t.stateNode;try{Ud(i,"")}catch(x){Dr(t,t.return,x)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=r!==null?r.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&Rw(i,s),Em(o,a);var u=Em(o,s);for(a=0;a<l.length;a+=2){var f=l[a],p=l[a+1];f==="style"?Bw(i,p):f==="dangerouslySetInnerHTML"?Ow(i,p):f==="children"?Ud(i,p):zx(i,f,p,u)}switch(o){case"input":mm(i,s);break;case"textarea":Dw(i,s);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?Yc(i,!!s.multiple,m,!1):g!==!!s.multiple&&(s.defaultValue!=null?Yc(i,!!s.multiple,s.defaultValue,!0):Yc(i,!!s.multiple,s.multiple?[]:"",!1))}i[qd]=s}catch(x){Dr(t,t.return,x)}}break;case 6:if(Ms(e,t),na(t),n&4){if(t.stateNode===null)throw Error(Oe(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(x){Dr(t,t.return,x)}}break;case 3:if(Ms(e,t),na(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{$d(e.containerInfo)}catch(x){Dr(t,t.return,x)}break;case 4:Ms(e,t),na(t);break;case 13:Ms(e,t),na(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(E1=Wr())),n&4&&C_(t);break;case 22:if(f=r!==null&&r.memoizedState!==null,t.mode&1?(ti=(u=ti)||f,Ms(e,t),ti=u):Ms(e,t),na(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(Je=t,f=t.child;f!==null;){for(p=Je=f;Je!==null;){switch(g=Je,m=g.child,g.tag){case 0:case 11:case 14:case 15:Td(4,g,g.return);break;case 1:Hc(g,g.return);var y=g.stateNode;if(typeof y.componentWillUnmount=="function"){n=g,r=g.return;try{e=n,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(x){Dr(n,r,x)}}break;case 5:Hc(g,g.return);break;case 22:if(g.memoizedState!==null){b_(p);continue}}m!==null?(m.return=g,Je=m):b_(p)}f=f.sibling}e:for(f=null,p=t;;){if(p.tag===5){if(f===null){f=p;try{i=p.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=p.stateNode,l=p.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Mw("display",a))}catch(x){Dr(t,t.return,x)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(x){Dr(t,t.return,x)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Ms(e,t),na(t),n&4&&C_(t);break;case 21:break;default:Ms(e,t),na(t)}}function na(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(lT(r)){var n=r;break e}r=r.return}throw Error(Oe(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Ud(i,""),n.flags&=-33);var s=k_(t);Qm(t,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=k_(t);qm(t,o,a);break;default:throw Error(Oe(161))}}catch(l){Dr(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function oN(t,e,r){Je=t,dT(t)}function dT(t,e,r){for(var n=(t.mode&1)!==0;Je!==null;){var i=Je,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||T0;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||ti;o=T0;var u=ti;if(T0=a,(ti=l)&&!u)for(Je=i;Je!==null;)a=Je,l=a.child,a.tag===22&&a.memoizedState!==null?I_(i):l!==null?(l.return=a,Je=l):I_(i);for(;s!==null;)Je=s,dT(s),s=s.sibling;Je=i,T0=o,ti=u}F_(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Je=s):F_(t)}}function F_(t){for(;Je!==null;){var e=Je;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ti||Fp(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!ti)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:Vs(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&f_(e,s,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}f_(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&$d(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Oe(163))}ti||e.flags&512&&Xm(e)}catch(g){Dr(e,e.return,g)}}if(e===t){Je=null;break}if(r=e.sibling,r!==null){r.return=e.return,Je=r;break}Je=e.return}}function b_(t){for(;Je!==null;){var e=Je;if(e===t){Je=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Je=r;break}Je=e.return}}function I_(t){for(;Je!==null;){var e=Je;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Fp(4,e)}catch(l){Dr(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){Dr(e,i,l)}}var s=e.return;try{Xm(e)}catch(l){Dr(e,s,l)}break;case 5:var a=e.return;try{Xm(e)}catch(l){Dr(e,a,l)}}}catch(l){Dr(e,e.return,l)}if(e===t){Je=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Je=o;break}Je=e.return}}var lN=Math.ceil,Lh=to.ReactCurrentDispatcher,y1=to.ReactCurrentOwner,ws=to.ReactCurrentBatchConfig,Wt=0,Fn=null,Zr=null,Ln=0,Hi=0,$c=al(0),pn=0,rf=null,Hl=0,bp=0,_1=0,Ad=null,Pi=null,E1=0,pu=1/0,Ra=null,jh=!1,Jm=null,zo=null,A0=!1,Ro=null,Vh=0,kd=0,Zm=null,oh=-1,lh=0;function vi(){return Wt&6?Wr():oh!==-1?oh:oh=Wr()}function Wo(t){return t.mode&1?Wt&2&&Ln!==0?Ln&-Ln:$I.transition!==null?(lh===0&&(lh=Xw()),lh):(t=rr,t!==0||(t=window.event,t=t===void 0?16:rS(t.type)),t):1}function Ks(t,e,r,n){if(50<kd)throw kd=0,Zm=null,Error(Oe(185));bf(t,r,n),(!(Wt&2)||t!==Fn)&&(t===Fn&&(!(Wt&2)&&(bp|=r),pn===4&&ko(t,Ln)),Li(t,n),r===1&&Wt===0&&!(e.mode&1)&&(pu=Wr()+500,Ap&&ol()))}function Li(t,e){var r=t.callbackNode;$b(t,e);var n=Sh(t,t===Fn?Ln:0);if(n===0)r!==null&&jy(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&jy(r),e===1)t.tag===0?HI(N_.bind(null,t)):ES(N_.bind(null,t)),VI(function(){!(Wt&6)&&ol()}),r=null;else{switch(qw(n)){case 1:r=Kx;break;case 4:r=Kw;break;case 16:r=wh;break;case 536870912:r=Yw;break;default:r=wh}r=yT(r,fT.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function fT(t,e){if(oh=-1,lh=0,Wt&6)throw Error(Oe(327));var r=t.callbackNode;if(Zc()&&t.callbackNode!==r)return null;var n=Sh(t,t===Fn?Ln:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Uh(t,n);else{e=n;var i=Wt;Wt|=2;var s=pT();(Fn!==t||Ln!==e)&&(Ra=null,pu=Wr()+500,Dl(t,e));do try{dN();break}catch(o){hT(t,o)}while(!0);a1(),Lh.current=s,Wt=i,Zr!==null?e=0:(Fn=null,Ln=0,e=pn)}if(e!==0){if(e===2&&(i=km(t),i!==0&&(n=i,e=ex(t,i))),e===1)throw r=rf,Dl(t,0),ko(t,n),Li(t,Wr()),r;if(e===6)ko(t,n);else{if(i=t.current.alternate,!(n&30)&&!cN(i)&&(e=Uh(t,n),e===2&&(s=km(t),s!==0&&(n=s,e=ex(t,s))),e===1))throw r=rf,Dl(t,0),ko(t,n),Li(t,Wr()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(Oe(345));case 2:Tl(t,Pi,Ra);break;case 3:if(ko(t,n),(n&130023424)===n&&(e=E1+500-Wr(),10<e)){if(Sh(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){vi(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Pm(Tl.bind(null,t,Pi,Ra),e);break}Tl(t,Pi,Ra);break;case 4:if(ko(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var a=31-Gs(n);s=1<<a,a=e[a],a>i&&(i=a),n&=~s}if(n=i,n=Wr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*lN(n/1960))-n,10<n){t.timeoutHandle=Pm(Tl.bind(null,t,Pi,Ra),n);break}Tl(t,Pi,Ra);break;case 5:Tl(t,Pi,Ra);break;default:throw Error(Oe(329))}}}return Li(t,Wr()),t.callbackNode===r?fT.bind(null,t):null}function ex(t,e){var r=Ad;return t.current.memoizedState.isDehydrated&&(Dl(t,e).flags|=256),t=Uh(t,e),t!==2&&(e=Pi,Pi=r,e!==null&&tx(e)),t}function tx(t){Pi===null?Pi=t:Pi.push.apply(Pi,t)}function cN(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!qs(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ko(t,e){for(e&=~_1,e&=~bp,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Gs(e),n=1<<r;t[r]=-1,e&=~n}}function N_(t){if(Wt&6)throw Error(Oe(327));Zc();var e=Sh(t,0);if(!(e&1))return Li(t,Wr()),null;var r=Uh(t,e);if(t.tag!==0&&r===2){var n=km(t);n!==0&&(e=n,r=ex(t,n))}if(r===1)throw r=rf,Dl(t,0),ko(t,e),Li(t,Wr()),r;if(r===6)throw Error(Oe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Tl(t,Pi,Ra),Li(t,Wr()),null}function w1(t,e){var r=Wt;Wt|=1;try{return t(e)}finally{Wt=r,Wt===0&&(pu=Wr()+500,Ap&&ol())}}function $l(t){Ro!==null&&Ro.tag===0&&!(Wt&6)&&Zc();var e=Wt;Wt|=1;var r=ws.transition,n=rr;try{if(ws.transition=null,rr=1,t)return t()}finally{rr=n,ws.transition=r,Wt=e,!(Wt&6)&&ol()}}function S1(){Hi=$c.current,mr($c)}function Dl(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,jI(r)),Zr!==null)for(r=Zr.return;r!==null;){var n=r;switch(n1(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Fh();break;case 3:fu(),mr(Mi),mr(ai),f1();break;case 5:d1(n);break;case 4:fu();break;case 13:mr(kr);break;case 19:mr(kr);break;case 10:o1(n.type._context);break;case 22:case 23:S1()}r=r.return}if(Fn=t,Zr=t=Ho(t.current,null),Ln=Hi=e,pn=0,rf=null,_1=bp=Hl=0,Pi=Ad=null,bl!==null){for(e=0;e<bl.length;e++)if(r=bl[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}bl=null}return t}function hT(t,e){do{var r=Zr;try{if(a1(),ih.current=Bh,Mh){for(var n=br.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Mh=!1}if(Wl=0,An=dn=br=null,Sd=!1,Zd=0,y1.current=null,r===null||r.return===null){pn=1,rf=e,Zr=null;break}e:{var s=t,a=r.return,o=r,l=e;if(e=Ln,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,f=o,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var g=f.alternate;g?(f.updateQueue=g.updateQueue,f.memoizedState=g.memoizedState,f.lanes=g.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=v_(a);if(m!==null){m.flags&=-257,y_(m,a,o,s,e),m.mode&1&&x_(s,u,e),e=m,l=u;var y=e.updateQueue;if(y===null){var x=new Set;x.add(l),e.updateQueue=x}else y.add(l);break e}else{if(!(e&1)){x_(s,u,e),T1();break e}l=Error(Oe(426))}}else if(wr&&o.mode&1){var w=v_(a);if(w!==null){!(w.flags&65536)&&(w.flags|=256),y_(w,a,o,s,e),i1(hu(l,o));break e}}s=l=hu(l,o),pn!==4&&(pn=2),Ad===null?Ad=[s]:Ad.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var A=qS(s,l,e);d_(s,A);break e;case 1:o=l;var k=s.type,_=s.stateNode;if(!(s.flags&128)&&(typeof k.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(zo===null||!zo.has(_)))){s.flags|=65536,e&=-e,s.lanes|=e;var O=QS(s,o,e);d_(s,O);break e}}s=s.return}while(s!==null)}mT(r)}catch(G){e=G,Zr===r&&r!==null&&(Zr=r=r.return);continue}break}while(!0)}function pT(){var t=Lh.current;return Lh.current=Bh,t===null?Bh:t}function T1(){(pn===0||pn===3||pn===2)&&(pn=4),Fn===null||!(Hl&268435455)&&!(bp&268435455)||ko(Fn,Ln)}function Uh(t,e){var r=Wt;Wt|=2;var n=pT();(Fn!==t||Ln!==e)&&(Ra=null,Dl(t,e));do try{uN();break}catch(i){hT(t,i)}while(!0);if(a1(),Wt=r,Lh.current=n,Zr!==null)throw Error(Oe(261));return Fn=null,Ln=0,pn}function uN(){for(;Zr!==null;)gT(Zr)}function dN(){for(;Zr!==null&&!Mb();)gT(Zr)}function gT(t){var e=vT(t.alternate,t,Hi);t.memoizedProps=t.pendingProps,e===null?mT(t):Zr=e,y1.current=null}function mT(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=iN(r,e),r!==null){r.flags&=32767,Zr=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{pn=6,Zr=null;return}}else if(r=nN(r,e,Hi),r!==null){Zr=r;return}if(e=e.sibling,e!==null){Zr=e;return}Zr=e=t}while(e!==null);pn===0&&(pn=5)}function Tl(t,e,r){var n=rr,i=ws.transition;try{ws.transition=null,rr=1,fN(t,e,r,n)}finally{ws.transition=i,rr=n}return null}function fN(t,e,r,n){do Zc();while(Ro!==null);if(Wt&6)throw Error(Oe(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Oe(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(Gb(t,s),t===Fn&&(Zr=Fn=null,Ln=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||A0||(A0=!0,yT(wh,function(){return Zc(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=ws.transition,ws.transition=null;var a=rr;rr=1;var o=Wt;Wt|=4,y1.current=null,aN(t,r),uT(r,t),RI(Rm),Th=!!Nm,Rm=Nm=null,t.current=r,oN(r),Bb(),Wt=o,rr=a,ws.transition=s}else t.current=r;if(A0&&(A0=!1,Ro=t,Vh=i),s=t.pendingLanes,s===0&&(zo=null),Vb(r.stateNode),Li(t,Wr()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(jh)throw jh=!1,t=Jm,Jm=null,t;return Vh&1&&t.tag!==0&&Zc(),s=t.pendingLanes,s&1?t===Zm?kd++:(kd=0,Zm=t):kd=0,ol(),null}function Zc(){if(Ro!==null){var t=qw(Vh),e=ws.transition,r=rr;try{if(ws.transition=null,rr=16>t?16:t,Ro===null)var n=!1;else{if(t=Ro,Ro=null,Vh=0,Wt&6)throw Error(Oe(331));var i=Wt;for(Wt|=4,Je=t.current;Je!==null;){var s=Je,a=s.child;if(Je.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(Je=u;Je!==null;){var f=Je;switch(f.tag){case 0:case 11:case 15:Td(8,f,s)}var p=f.child;if(p!==null)p.return=f,Je=p;else for(;Je!==null;){f=Je;var g=f.sibling,m=f.return;if(oT(f),f===u){Je=null;break}if(g!==null){g.return=m,Je=g;break}Je=m}}}var y=s.alternate;if(y!==null){var x=y.child;if(x!==null){y.child=null;do{var w=x.sibling;x.sibling=null,x=w}while(x!==null)}}Je=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,Je=a;else e:for(;Je!==null;){if(s=Je,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Td(9,s,s.return)}var A=s.sibling;if(A!==null){A.return=s.return,Je=A;break e}Je=s.return}}var k=t.current;for(Je=k;Je!==null;){a=Je;var _=a.child;if(a.subtreeFlags&2064&&_!==null)_.return=a,Je=_;else e:for(a=k;Je!==null;){if(o=Je,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Fp(9,o)}}catch(G){Dr(o,o.return,G)}if(o===a){Je=null;break e}var O=o.sibling;if(O!==null){O.return=o.return,Je=O;break e}Je=o.return}}if(Wt=i,ol(),ua&&typeof ua.onPostCommitFiberRoot=="function")try{ua.onPostCommitFiberRoot(_p,t)}catch{}n=!0}return n}finally{rr=r,ws.transition=e}}return!1}function R_(t,e,r){e=hu(r,e),e=qS(t,e,1),t=Uo(t,e,1),e=vi(),t!==null&&(bf(t,1,e),Li(t,e))}function Dr(t,e,r){if(t.tag===3)R_(t,t,r);else for(;e!==null;){if(e.tag===3){R_(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(zo===null||!zo.has(n))){t=hu(r,t),t=QS(e,t,1),e=Uo(e,t,1),t=vi(),e!==null&&(bf(e,1,t),Li(e,t));break}}e=e.return}}function hN(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=vi(),t.pingedLanes|=t.suspendedLanes&r,Fn===t&&(Ln&r)===r&&(pn===4||pn===3&&(Ln&130023424)===Ln&&500>Wr()-E1?Dl(t,0):_1|=r),Li(t,e)}function xT(t,e){e===0&&(t.mode&1?(e=g0,g0<<=1,!(g0&130023424)&&(g0=4194304)):e=1);var r=vi();t=Ka(t,e),t!==null&&(bf(t,e,r),Li(t,r))}function pN(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),xT(t,r)}function gN(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Oe(314))}n!==null&&n.delete(e),xT(t,r)}var vT;vT=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Mi.current)Oi=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Oi=!1,rN(t,e,r);Oi=!!(t.flags&131072)}else Oi=!1,wr&&e.flags&1048576&&wS(e,Nh,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;ah(t,e),t=e.pendingProps;var i=cu(e,ai.current);Jc(e,r),i=p1(null,e,n,t,i,r);var s=g1();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Bi(n)?(s=!0,bh(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,c1(e),i.updater=Cp,e.stateNode=i,i._reactInternals=e,Um(e,n,t,r),e=Hm(null,e,n,!0,s,r)):(e.tag=0,wr&&s&&r1(e),gi(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(ah(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=xN(n),t=Vs(n,t),i){case 0:e=Wm(null,e,n,t,r);break e;case 1:e=w_(null,e,n,t,r);break e;case 11:e=__(null,e,n,t,r);break e;case 14:e=E_(null,e,n,Vs(n.type,t),r);break e}throw Error(Oe(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Vs(n,i),Wm(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Vs(n,i),w_(t,e,n,i,r);case 3:e:{if(tT(e),t===null)throw Error(Oe(387));n=e.pendingProps,s=e.memoizedState,i=s.element,FS(t,e),Ph(e,n,null,r);var a=e.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=hu(Error(Oe(423)),e),e=S_(t,e,n,r,i);break e}else if(n!==i){i=hu(Error(Oe(424)),e),e=S_(t,e,n,r,i);break e}else for(Xi=Vo(e.stateNode.containerInfo.firstChild),qi=e,wr=!0,zs=null,r=kS(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(uu(),n===i){e=Ya(t,e,r);break e}gi(t,e,n,r)}e=e.child}return e;case 5:return bS(e),t===null&&Lm(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,Dm(n,i)?a=null:s!==null&&Dm(n,s)&&(e.flags|=32),eT(t,e),gi(t,e,a,r),e.child;case 6:return t===null&&Lm(e),null;case 13:return rT(t,e,r);case 4:return u1(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=du(e,null,n,r):gi(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Vs(n,i),__(t,e,n,i,r);case 7:return gi(t,e,e.pendingProps,r),e.child;case 8:return gi(t,e,e.pendingProps.children,r),e.child;case 12:return gi(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,ur(Rh,n._currentValue),n._currentValue=a,s!==null)if(qs(s.value,a)){if(s.children===i.children&&!Mi.current){e=Ya(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Va(-1,r&-r),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?l.next=l:(l.next=f.next,f.next=l),u.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),jm(s.return,r,e),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(Oe(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),jm(a,r,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}gi(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,Jc(e,r),i=Ts(i),n=n(i),e.flags|=1,gi(t,e,n,r),e.child;case 14:return n=e.type,i=Vs(n,e.pendingProps),i=Vs(n.type,i),E_(t,e,n,i,r);case 15:return JS(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Vs(n,i),ah(t,e),e.tag=1,Bi(n)?(t=!0,bh(e)):t=!1,Jc(e,r),XS(e,n,i),Um(e,n,i,r),Hm(null,e,n,!0,t,r);case 19:return nT(t,e,r);case 22:return ZS(t,e,r)}throw Error(Oe(156,e.tag))};function yT(t,e){return Gw(t,e)}function mN(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Es(t,e,r,n){return new mN(t,e,r,n)}function A1(t){return t=t.prototype,!(!t||!t.isReactComponent)}function xN(t){if(typeof t=="function")return A1(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Hx)return 11;if(t===$x)return 14}return 2}function Ho(t,e){var r=t.alternate;return r===null?(r=Es(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function ch(t,e,r,n,i,s){var a=2;if(n=t,typeof t=="function")A1(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Oc:return Pl(r.children,i,s,e);case Wx:a=8,i|=8;break;case dm:return t=Es(12,r,e,i|2),t.elementType=dm,t.lanes=s,t;case fm:return t=Es(13,r,e,i),t.elementType=fm,t.lanes=s,t;case hm:return t=Es(19,r,e,i),t.elementType=hm,t.lanes=s,t;case bw:return Ip(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Cw:a=10;break e;case Fw:a=9;break e;case Hx:a=11;break e;case $x:a=14;break e;case So:a=16,n=null;break e}throw Error(Oe(130,t==null?t:typeof t,""))}return e=Es(a,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function Pl(t,e,r,n){return t=Es(7,t,n,e),t.lanes=r,t}function Ip(t,e,r,n){return t=Es(22,t,n,e),t.elementType=bw,t.lanes=r,t.stateNode={isHidden:!1},t}function bg(t,e,r){return t=Es(6,t,null,e),t.lanes=r,t}function Ig(t,e,r){return e=Es(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function vN(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ug(0),this.expirationTimes=ug(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ug(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function k1(t,e,r,n,i,s,a,o,l){return t=new vN(t,e,r,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Es(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},c1(s),t}function yN(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Pc,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function _T(t){if(!t)return Qo;t=t._reactInternals;e:{if(ic(t)!==t||t.tag!==1)throw Error(Oe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Bi(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Oe(171))}if(t.tag===1){var r=t.type;if(Bi(r))return _S(t,r,e)}return e}function ET(t,e,r,n,i,s,a,o,l){return t=k1(r,n,!0,t,i,s,a,o,l),t.context=_T(null),r=t.current,n=vi(),i=Wo(r),s=Va(n,i),s.callback=e??null,Uo(r,s,i),t.current.lanes=i,bf(t,i,n),Li(t,n),t}function Np(t,e,r,n){var i=e.current,s=vi(),a=Wo(i);return r=_T(r),e.context===null?e.context=r:e.pendingContext=r,e=Va(s,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Uo(i,e,a),t!==null&&(Ks(t,i,a,s),nh(t,i,a)),a}function zh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function D_(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function C1(t,e){D_(t,e),(t=t.alternate)&&D_(t,e)}function _N(){return null}var wT=typeof reportError=="function"?reportError:function(t){console.error(t)};function F1(t){this._internalRoot=t}Rp.prototype.render=F1.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Oe(409));Np(t,e,null,null)};Rp.prototype.unmount=F1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;$l(function(){Np(null,t,null,null)}),e[Ga]=null}};function Rp(t){this._internalRoot=t}Rp.prototype.unstable_scheduleHydration=function(t){if(t){var e=Zw();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Ao.length&&e!==0&&e<Ao[r].priority;r++);Ao.splice(r,0,t),r===0&&tS(t)}};function b1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Dp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function P_(){}function EN(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=zh(a);s.call(u)}}var a=ET(e,n,t,0,null,!1,!1,"",P_);return t._reactRootContainer=a,t[Ga]=a.current,Yd(t.nodeType===8?t.parentNode:t),$l(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var u=zh(l);o.call(u)}}var l=k1(t,0,!1,null,null,!1,!1,"",P_);return t._reactRootContainer=l,t[Ga]=l.current,Yd(t.nodeType===8?t.parentNode:t),$l(function(){Np(e,l,r,n)}),l}function Pp(t,e,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=zh(a);o.call(l)}}Np(e,a,t,i)}else a=EN(r,e,t,i,n);return zh(a)}Qw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=cd(e.pendingLanes);r!==0&&(Yx(e,r|1),Li(e,Wr()),!(Wt&6)&&(pu=Wr()+500,ol()))}break;case 13:$l(function(){var n=Ka(t,1);if(n!==null){var i=vi();Ks(n,t,1,i)}}),C1(t,1)}};Xx=function(t){if(t.tag===13){var e=Ka(t,134217728);if(e!==null){var r=vi();Ks(e,t,134217728,r)}C1(t,134217728)}};Jw=function(t){if(t.tag===13){var e=Wo(t),r=Ka(t,e);if(r!==null){var n=vi();Ks(r,t,e,n)}C1(t,e)}};Zw=function(){return rr};eS=function(t,e){var r=rr;try{return rr=t,e()}finally{rr=r}};Sm=function(t,e,r){switch(e){case"input":if(mm(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=Tp(n);if(!i)throw Error(Oe(90));Nw(n),mm(n,i)}}}break;case"textarea":Dw(t,r);break;case"select":e=r.value,e!=null&&Yc(t,!!r.multiple,e,!1)}};Vw=w1;Uw=$l;var wN={usingClientEntryPoint:!1,Events:[Nf,jc,Tp,Lw,jw,w1]},td={findFiberByHostInstance:Fl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},SN={bundleType:td.bundleType,version:td.version,rendererPackageName:td.rendererPackageName,rendererConfig:td.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:to.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Hw(t),t===null?null:t.stateNode},findFiberByHostInstance:td.findFiberByHostInstance||_N,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var k0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!k0.isDisabled&&k0.supportsFiber)try{_p=k0.inject(SN),ua=k0}catch{}}es.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wN;es.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!b1(e))throw Error(Oe(200));return yN(t,e,null,r)};es.createRoot=function(t,e){if(!b1(t))throw Error(Oe(299));var r=!1,n="",i=wT;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=k1(t,1,!1,null,null,r,!1,n,i),t[Ga]=e.current,Yd(t.nodeType===8?t.parentNode:t),new F1(e)};es.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Oe(188)):(t=Object.keys(t).join(","),Error(Oe(268,t)));return t=Hw(e),t=t===null?null:t.stateNode,t};es.flushSync=function(t){return $l(t)};es.hydrate=function(t,e,r){if(!Dp(e))throw Error(Oe(200));return Pp(null,t,e,!0,r)};es.hydrateRoot=function(t,e,r){if(!b1(t))throw Error(Oe(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=wT;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=ET(e,null,t,1,r??null,i,!1,s,a),t[Ga]=e.current,Yd(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new Rp(e)};es.render=function(t,e,r){if(!Dp(e))throw Error(Oe(200));return Pp(null,t,e,!1,r)};es.unmountComponentAtNode=function(t){if(!Dp(t))throw Error(Oe(40));return t._reactRootContainer?($l(function(){Pp(null,null,t,!1,function(){t._reactRootContainer=null,t[Ga]=null})}),!0):!1};es.unstable_batchedUpdates=w1;es.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Dp(r))throw Error(Oe(200));if(t==null||t._reactInternals===void 0)throw Error(Oe(38));return Pp(t,e,r,!1,n)};es.version="18.3.1-next-f1338f8080-20240426";function ST(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ST)}catch(t){console.error(t)}}ST(),Sw.exports=es;var TN=Sw.exports,O_=TN;cm.createRoot=O_.createRoot,cm.hydrateRoot=O_.hydrateRoot;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Wh={};Wh.version="0.18.5";var TT=1252,AN=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],I1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},N1=function(t){AN.indexOf(t)!=-1&&(TT=I1[0]=t)};function kN(){N1(1252)}var Ws=function(t){N1(t)};function R1(){Ws(1200),kN()}function M_(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function CN(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function AT(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var dd=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?CN(t.slice(2)):e==254&&r==255?AT(t.slice(2)):e==65279?t.slice(1):t},C0=function(e){return String.fromCharCode(e)},B_=function(e){return String.fromCharCode(e)},nf,Do="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function sf(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,u=0;u<t.length;)r=t.charCodeAt(u++),s=r>>2,n=t.charCodeAt(u++),a=(r&3)<<4|n>>4,i=t.charCodeAt(u++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=Do.charAt(s)+Do.charAt(a)+Do.charAt(o)+Do.charAt(l);return e}function Zi(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)s=Do.indexOf(t.charAt(u++)),a=Do.indexOf(t.charAt(u++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=Do.indexOf(t.charAt(u++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Do.indexOf(t.charAt(u++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var kt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ro=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Jo(t){return kt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function L_(t){return kt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Ki=function(e){return kt?ro(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Op(t){if(typeof ArrayBuffer>"u")return Ki(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function ll(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function FN(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function D1(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return D1(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var kn=kt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:ro(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function bN(t){for(var e=[],r=0,n=t.length+250,i=Jo(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Jo(65535),n=65530)}return e.push(i.slice(0,r)),kn(e)}var yi=/\u0000/g,fd=/[\u0001-\u0006]/g;function eu(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Hs(t,e){var r=""+t;return r.length>=e?r:Pr("0",e-r.length)+r}function P1(t,e){var r=""+t;return r.length>=e?r:Pr(" ",e-r.length)+r}function Hh(t,e){var r=""+t;return r.length>=e?r:r+Pr(" ",e-r.length)}function IN(t,e){var r=""+Math.round(t);return r.length>=e?r:Pr("0",e-r.length)+r}function NN(t,e){var r=""+t;return r.length>=e?r:Pr("0",e-r.length)+r}var j_=Math.pow(2,32);function kc(t,e){if(t>j_||t<-j_)return IN(t,e);var r=Math.round(t);return NN(r,e)}function $h(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var V_=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ng=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function RN(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var ut={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},U_={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},DN={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Gh(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,l=1,u=0,f=0,p=Math.floor(i);u<e&&(p=Math.floor(i),o=p*a+s,f=p*u+l,!(i-p<5e-8));)i=1/(i-p),s=a,a=o,l=u,u=f;if(f>e&&(u>e?(f=l,o=s):(f=u,o=a)),!r)return[0,n*o,f];var g=Math.floor(n*o/f);return[g,n*o-g*f,f]}function Nl(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=jN(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var kT=new Date(1899,11,31,0,0,0),PN=kT.getTime(),ON=new Date(1900,2,1,0,0,0);function CT(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=ON&&(r+=24*60*60*1e3),(r-(PN+(t.getTimezoneOffset()-kT.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function O1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function MN(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function BN(t){var e=t<0?12:11,r=O1(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function LN(t){var e=O1(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function af(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=BN(t):e===10?r=t.toFixed(10).substr(0,12):r=LN(t),O1(MN(r.toUpperCase()))}function Gl(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):af(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return ks(14,CT(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function jN(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function VN(t,e,r,n){var i="",s=0,a=0,o=r.y,l,u=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,u=e.length;break;case 3:return Ng[r.m-1][1];case 5:return Ng[r.m-1][0];default:return Ng[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,u=e.length;break;case 3:return V_[r.q][0];default:return V_[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Hs(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=Hs(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:l=o,u=1;break}var f=u>0?Hs(l,u):"";return f}function Po(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var FT=/%/g;function UN(t,e,r){var n=e.replace(FT,""),i=e.length-n.length;return Ua(t,n,r*Math.pow(10,2*i))+Pr("%",i)}function zN(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ua(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function bT(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+bT(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var IT=/# (\?+)( ?)\/( ?)(\d+)/;function WN(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?Pr(" ",t[1].length+1+t[4].length):P1(a,t[1].length)+t[2]+"/"+t[3]+Hs(o,t[4].length))}function HN(t,e,r){return r+(e===0?"":""+e)+Pr(" ",t[1].length+2+t[4].length)}var NT=/^#*0*\.([0#]+)/,RT=/\).*[0#]/,DT=/\(###\) ###\\?-####/;function mi(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function z_(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function W_(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function $N(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function GN(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function hs(t,e,r){if(t.charCodeAt(0)===40&&!e.match(RT)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?hs("n",n,r):"("+hs("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return zN(t,e,r);if(e.indexOf("%")!==-1)return UN(t,e,r);if(e.indexOf("E")!==-1)return bT(e,r);if(e.charCodeAt(0)===36)return"$"+hs(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+kc(l,e.length);if(e.match(/^[#?]+$/))return i=kc(r,0),i==="0"&&(i=""),i.length>e.length?i:mi(e.substr(0,e.length-i.length))+i;if(s=e.match(IT))return WN(s,l,u);if(e.match(/^#+0+$/))return u+kc(l,e.length-e.indexOf("0"));if(s=e.match(NT))return i=z_(r,s[1].length).replace(/^([^\.]+)$/,"$1."+mi(s[1])).replace(/\.$/,"."+mi(s[1])).replace(/\.(\d*)$/,function(y,x){return"."+x+Pr("0",mi(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+z_(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Po(kc(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+hs(t,e,-r):Po(""+(Math.floor(r)+$N(r,s[1].length)))+"."+Hs(W_(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return hs(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=eu(hs(t,e.replace(/[\\-]/g,""),r)),a=0,eu(eu(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match(DT))return i=hs(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Gh(l,Math.pow(10,a)-1,!1),i=""+u,f=Ua("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=Hh(o[2],a),f.length<s[4].length&&(f=mi(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Gh(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?P1(o[1],a)+s[2]+"/"+s[3]+Hh(o[2],a):Pr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=kc(r,0),e.length<=i.length?i:mi(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var p=e.indexOf(".")-a,g=e.length-i.length-p;return mi(e.substr(0,p)+i+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=W_(r,s[1].length),r<0?"-"+hs(t,e,-r):Po(GN(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Hs(0,3-y.length):"")+y})+"."+Hs(a,s[1].length);switch(e){case"###,##0.00":return hs(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Po(kc(l,0));return m!=="0"?u+m:"";case"###,###.00":return hs(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return hs(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function KN(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ua(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function YN(t,e,r){var n=e.replace(FT,""),i=e.length-n.length;return Ua(t,n,r*Math.pow(10,2*i))+Pr("%",i)}function PT(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+PT(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function sa(t,e,r){if(t.charCodeAt(0)===40&&!e.match(RT)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?sa("n",n,r):"("+sa("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return KN(t,e,r);if(e.indexOf("%")!==-1)return YN(t,e,r);if(e.indexOf("E")!==-1)return PT(e,r);if(e.charCodeAt(0)===36)return"$"+sa(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Hs(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:mi(e.substr(0,e.length-i.length))+i;if(s=e.match(IT))return HN(s,l,u);if(e.match(/^#+0+$/))return u+Hs(l,e.length-e.indexOf("0"));if(s=e.match(NT))return i=(""+r).replace(/^([^\.]+)$/,"$1."+mi(s[1])).replace(/\.$/,"."+mi(s[1])),i=i.replace(/\.(\d*)$/,function(y,x){return"."+x+Pr("0",mi(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Po(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+sa(t,e,-r):Po(""+r)+"."+Pr("0",s[1].length);if(s=e.match(/^#,#*,#0/))return sa(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=eu(sa(t,e.replace(/[\\-]/g,""),r)),a=0,eu(eu(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match(DT))return i=sa(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Gh(l,Math.pow(10,a)-1,!1),i=""+u,f=Ua("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=Hh(o[2],a),f.length<s[4].length&&(f=mi(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Gh(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?P1(o[1],a)+s[2]+"/"+s[3]+Hh(o[2],a):Pr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:mi(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var p=e.indexOf(".")-a,g=e.length-i.length-p;return mi(e.substr(0,p)+i+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+sa(t,e,-r):Po(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Hs(0,3-y.length):"")+y})+"."+Hs(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var m=Po(""+l);return m!=="0"?u+m:"";default:if(e.match(/\.[0#?]*$/))return sa(t,e.slice(0,e.lastIndexOf(".")),r)+mi(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Ua(t,e,r){return(r|0)===r?sa(t,e,r):hs(t,e,r)}function XN(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var OT=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Iu(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":$h(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(OT))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function qN(t,e,r,n){for(var i=[],s="",a=0,o="",l="t",u,f,p,g="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!$h(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(p=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(p);i[i.length]={t:"t",v:s},++a;break;case"\\":var m=t.charAt(++a),y=m==="("||m===")"?m:"t";i[i.length]={t:y,v:m},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(u==null&&(u=Nl(e,r,t.charAt(a+1)==="2"),u==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=Nl(e,r),u==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=g),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var x={t:o,v:o};if(u==null&&(u=Nl(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",g="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",a+=5,g="h"):t.substr(a,5).toUpperCase()==="/"?(u!=null&&(x.v=u.H>=12?"":""),x.t="T",a+=5,g="h"):(x.t="t",++a),u==null&&x.t==="T")return"";i[i.length]=x,l=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(OT)){if(u==null&&(u=Nl(e,r),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Iu(t)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var w=0,A=0,k;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=g,l="h",w<1&&(w=1);break;case"s":(k=i[a].v.match(/\.0+$/))&&(A=Math.max(A,k[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&i[a].v.match(/[Hh]/)&&(w=1),w<2&&i[a].v.match(/[Mm]/)&&(w=2),w<3&&i[a].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var _="",O;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=VN(i[a].t.charCodeAt(0),i[a].v,u,A),i[a].t="t";break;case"n":case"?":for(O=a+1;i[O]!=null&&((o=i[O].t)==="?"||o==="D"||(o===" "||o==="t")&&i[O+1]!=null&&(i[O+1].t==="?"||i[O+1].t==="t"&&i[O+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[O].v==="/"||i[O].v===" "&&i[O+1]!=null&&i[O+1].t=="?"));)i[a].v+=i[O].v,i[O]={v:"",t:";"},++O;_+=i[a].v,a=O-1;break;case"G":i[a].t="t",i[a].v=Gl(e,r);break}var G="",U,T;if(_.length>0){_.charCodeAt(0)==40?(U=e<0&&_.charCodeAt(0)===45?-e:e,T=Ua("n",_,U)):(U=e<0&&n>1?-e:e,T=Ua("n",_,U),U<0&&i[0]&&i[0].t=="t"&&(T=T.substr(1),i[0].v="-"+i[0].v)),O=T.length-1;var F=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){F=a;break}var S=i.length;if(F===i.length&&T.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(O>=i[a].v.length-1?(O-=i[a].v.length,i[a].v=T.substr(O+1,i[a].v.length)):O<0?i[a].v="":(i[a].v=T.substr(0,O+1),O=-1),i[a].t="t",S=a);O>=0&&S<i.length&&(i[S].v=T.substr(0,O+1)+i[S].v)}else if(F!==i.length&&T.indexOf("E")===-1){for(O=T.indexOf(".")-1,a=F;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(f=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")-1:i[a].v.length-1,G=i[a].v.substr(f+1);f>=0;--f)O>=0&&(i[a].v.charAt(f)==="0"||i[a].v.charAt(f)==="#")&&(G=T.charAt(O--)+G);i[a].v=G,i[a].t="t",S=a}for(O>=0&&S<i.length&&(i[S].v=T.substr(0,O+1)+i[S].v),O=T.indexOf(".")+1,a=F;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==F)){for(f=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")+1:0,G=i[a].v.substr(0,f);f<i[a].v.length;++f)O<T.length&&(G+=T.charAt(O++));i[a].v=G,i[a].t="t",S=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(U=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Ua(i[a].t,i[a].v,U),i[a].t="t");var I="";for(a=0;a!==i.length;++a)i[a]!=null&&(I+=i[a].v);return I}var H_=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function $_(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function QN(t,e){var r=XN(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(H_),o=r[1].match(H_);return $_(e,a)?[n,r[0]]:$_(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function ks(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ut)[t],n==null&&(n=r.table&&r.table[U_[t]]||ut[U_[t]]),n==null&&(n=DN[t]||"General");break}if($h(n,0))return Gl(e,r);e instanceof Date&&(e=CT(e,r.date1904));var i=QN(n,e);if($h(i[1]))return Gl(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return qN(i[1],e,r,i[0])}function za(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(ut[r]==null){e<0&&(e=r);continue}if(ut[r]==t){e=r;break}}e<0&&(e=391)}return ut[e]=t,e}function Mp(t){for(var e=0;e!=392;++e)t[e]!==void 0&&za(t[e],e)}function Nu(){ut=RN()}var JN={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},MT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function ZN(t){var e=typeof t=="number"?ut[t]:t;return e=e.replace(MT,"(\\d+)"),new RegExp("^"+e+"$")}function eR(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(MT)||[]).forEach(function(p,g){var m=parseInt(r[g+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=m;break;case"d":s=m;break;case"h":a=m;break;case"s":l=m;break;case"m":a>=0?o=m:i=m;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?u:n==-1&&i==-1&&s==-1?f:u+"T"+f}var tR=function(){var t={};t.version="1.2.0";function e(){for(var T=0,F=new Array(256),S=0;S!=256;++S)T=S,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,F[S]=T;return typeof Int32Array<"u"?new Int32Array(F):F}var r=e();function n(T){var F=0,S=0,I=0,R=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)R[I]=T[I];for(I=0;I!=256;++I)for(S=T[I],F=256+I;F<4096;F+=256)S=R[F]=S>>>8^T[S&255];var D=[];for(I=1;I!=16;++I)D[I-1]=typeof Int32Array<"u"?R.subarray(I*256,I*256+256):R.slice(I*256,I*256+256);return D}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],u=i[4],f=i[5],p=i[6],g=i[7],m=i[8],y=i[9],x=i[10],w=i[11],A=i[12],k=i[13],_=i[14];function O(T,F){for(var S=F^-1,I=0,R=T.length;I<R;)S=S>>>8^r[(S^T.charCodeAt(I++))&255];return~S}function G(T,F){for(var S=F^-1,I=T.length-15,R=0;R<I;)S=_[T[R++]^S&255]^k[T[R++]^S>>8&255]^A[T[R++]^S>>16&255]^w[T[R++]^S>>>24]^x[T[R++]]^y[T[R++]]^m[T[R++]]^g[T[R++]]^p[T[R++]]^f[T[R++]]^u[T[R++]]^l[T[R++]]^o[T[R++]]^a[T[R++]]^s[T[R++]]^r[T[R++]];for(I+=15;R<I;)S=S>>>8^r[(S^T[R++])&255];return~S}function U(T,F){for(var S=F^-1,I=0,R=T.length,D=0,N=0;I<R;)D=T.charCodeAt(I++),D<128?S=S>>>8^r[(S^D)&255]:D<2048?(S=S>>>8^r[(S^(192|D>>6&31))&255],S=S>>>8^r[(S^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,N=T.charCodeAt(I++)&1023,S=S>>>8^r[(S^(240|D>>8&7))&255],S=S>>>8^r[(S^(128|D>>2&63))&255],S=S>>>8^r[(S^(128|N>>6&15|(D&3)<<4))&255],S=S>>>8^r[(S^(128|N&63))&255]):(S=S>>>8^r[(S^(224|D>>12&15))&255],S=S>>>8^r[(S^(128|D>>6&63))&255],S=S>>>8^r[(S^(128|D&63))&255]);return~S}return t.table=r,t.bstr=O,t.buf=G,t.str=U,t}(),nt=function(){var e={};e.version="1.2.1";function r(b,H){for(var B=b.split("/"),L=H.split("/"),K=0,X=0,de=Math.min(B.length,L.length);K<de;++K){if(X=B[K].length-L[K].length)return X;if(B[K]!=L[K])return B[K]<L[K]?-1:1}return B.length-L.length}function n(b){if(b.charAt(b.length-1)=="/")return b.slice(0,-1).indexOf("/")===-1?b:n(b.slice(0,-1));var H=b.lastIndexOf("/");return H===-1?b:b.slice(0,H+1)}function i(b){if(b.charAt(b.length-1)=="/")return i(b.slice(0,-1));var H=b.lastIndexOf("/");return H===-1?b:b.slice(H+1)}function s(b,H){typeof H=="string"&&(H=new Date(H));var B=H.getHours();B=B<<6|H.getMinutes(),B=B<<5|H.getSeconds()>>>1,b.write_shift(2,B);var L=H.getFullYear()-1980;L=L<<4|H.getMonth()+1,L=L<<5|H.getDate(),b.write_shift(2,L)}function a(b){var H=b.read_shift(2)&65535,B=b.read_shift(2)&65535,L=new Date,K=B&31;B>>>=5;var X=B&15;B>>>=4,L.setMilliseconds(0),L.setFullYear(B+1980),L.setMonth(X-1),L.setDate(K);var de=H&31;H>>>=5;var pe=H&63;return H>>>=6,L.setHours(H),L.setMinutes(pe),L.setSeconds(de<<1),L}function o(b){On(b,0);for(var H={},B=0;b.l<=b.length-4;){var L=b.read_shift(2),K=b.read_shift(2),X=b.l+K,de={};switch(L){case 21589:B=b.read_shift(1),B&1&&(de.mtime=b.read_shift(4)),K>5&&(B&2&&(de.atime=b.read_shift(4)),B&4&&(de.ctime=b.read_shift(4))),de.mtime&&(de.mt=new Date(de.mtime*1e3));break}b.l=X,H[L]=de}return H}var l;function u(){return l||(l={})}function f(b,H){if(b[0]==80&&b[1]==75)return bs(b,H);if((b[0]|32)==109&&(b[1]|32)==105)return tn(b,H);if(b.length<512)throw new Error("CFB file size "+b.length+" < 512");var B=3,L=512,K=0,X=0,de=0,pe=0,ue=0,ae=[],fe=b.slice(0,512);On(fe,0);var we=p(fe);switch(B=we[0],B){case 3:L=512;break;case 4:L=4096;break;case 0:if(we[1]==0)return bs(b,H);default:throw new Error("Major Version: Expected 3 or 4 saw "+B)}L!==512&&(fe=b.slice(0,L),On(fe,28));var Ue=b.slice(0,L);g(fe,B);var Ye=fe.read_shift(4,"i");if(B===3&&Ye!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ye);fe.l+=4,de=fe.read_shift(4,"i"),fe.l+=4,fe.chk("00100000","Mini Stream Cutoff Size: "),pe=fe.read_shift(4,"i"),K=fe.read_shift(4,"i"),ue=fe.read_shift(4,"i"),X=fe.read_shift(4,"i");for(var Ne=-1,Xe=0;Xe<109&&(Ne=fe.read_shift(4,"i"),!(Ne<0));++Xe)ae[Xe]=Ne;var dt=m(b,L);w(ue,X,dt,L,ae);var Ot=k(dt,de,ae,L);Ot[de].name="!Directory",K>0&&pe!==N&&(Ot[pe].name="!MiniFAT"),Ot[ae[0]].name="!FAT",Ot.fat_addrs=ae,Ot.ssz=L;var Mt={},cr=[],Ci=[],sr=[];_(de,Ot,dt,cr,K,Mt,Ci,pe),y(Ci,sr,cr),cr.shift();var is={FileIndex:Ci,FullPaths:sr};return H&&H.raw&&(is.raw={header:Ue,sectors:dt}),is}function p(b){if(b[b.l]==80&&b[b.l+1]==75)return[0,0];b.chk(Ge,"Header Signature: "),b.l+=16;var H=b.read_shift(2,"u");return[b.read_shift(2,"u"),H]}function g(b,H){var B=9;switch(b.l+=2,B=b.read_shift(2)){case 9:if(H!=3)throw new Error("Sector Shift: Expected 9 saw "+B);break;case 12:if(H!=4)throw new Error("Sector Shift: Expected 12 saw "+B);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+B)}b.chk("0600","Mini Sector Shift: "),b.chk("000000000000","Reserved: ")}function m(b,H){for(var B=Math.ceil(b.length/H)-1,L=[],K=1;K<B;++K)L[K-1]=b.slice(K*H,(K+1)*H);return L[B-1]=b.slice(B*H),L}function y(b,H,B){for(var L=0,K=0,X=0,de=0,pe=0,ue=B.length,ae=[],fe=[];L<ue;++L)ae[L]=fe[L]=L,H[L]=B[L];for(;pe<fe.length;++pe)L=fe[pe],K=b[L].L,X=b[L].R,de=b[L].C,ae[L]===L&&(K!==-1&&ae[K]!==K&&(ae[L]=ae[K]),X!==-1&&ae[X]!==X&&(ae[L]=ae[X])),de!==-1&&(ae[de]=L),K!==-1&&L!=ae[L]&&(ae[K]=ae[L],fe.lastIndexOf(K)<pe&&fe.push(K)),X!==-1&&L!=ae[L]&&(ae[X]=ae[L],fe.lastIndexOf(X)<pe&&fe.push(X));for(L=1;L<ue;++L)ae[L]===L&&(X!==-1&&ae[X]!==X?ae[L]=ae[X]:K!==-1&&ae[K]!==K&&(ae[L]=ae[K]));for(L=1;L<ue;++L)if(b[L].type!==0){if(pe=L,pe!=ae[pe])do pe=ae[pe],H[L]=H[pe]+"/"+H[L];while(pe!==0&&ae[pe]!==-1&&pe!=ae[pe]);ae[L]=-1}for(H[0]+="/",L=1;L<ue;++L)b[L].type!==2&&(H[L]+="/")}function x(b,H,B){for(var L=b.start,K=b.size,X=[],de=L;B&&K>0&&de>=0;)X.push(H.slice(de*D,de*D+D)),K-=D,de=kl(B,de*4);return X.length===0?ye(0):kn(X).slice(0,b.size)}function w(b,H,B,L,K){var X=N;if(b===N){if(H!==0)throw new Error("DIFAT chain shorter than expected")}else if(b!==-1){var de=B[b],pe=(L>>>2)-1;if(!de)return;for(var ue=0;ue<pe&&(X=kl(de,ue*4))!==N;++ue)K.push(X);w(kl(de,L-4),H-1,B,L,K)}}function A(b,H,B,L,K){var X=[],de=[];K||(K=[]);var pe=L-1,ue=0,ae=0;for(ue=H;ue>=0;){K[ue]=!0,X[X.length]=ue,de.push(b[ue]);var fe=B[Math.floor(ue*4/L)];if(ae=ue*4&pe,L<4+ae)throw new Error("FAT boundary crossed: "+ue+" 4 "+L);if(!b[fe])break;ue=kl(b[fe],ae)}return{nodes:X,data:n2([de])}}function k(b,H,B,L){var K=b.length,X=[],de=[],pe=[],ue=[],ae=L-1,fe=0,we=0,Ue=0,Ye=0;for(fe=0;fe<K;++fe)if(pe=[],Ue=fe+H,Ue>=K&&(Ue-=K),!de[Ue]){ue=[];var Ne=[];for(we=Ue;we>=0;){Ne[we]=!0,de[we]=!0,pe[pe.length]=we,ue.push(b[we]);var Xe=B[Math.floor(we*4/L)];if(Ye=we*4&ae,L<4+Ye)throw new Error("FAT boundary crossed: "+we+" 4 "+L);if(!b[Xe]||(we=kl(b[Xe],Ye),Ne[we]))break}X[Ue]={nodes:pe,data:n2([ue])}}return X}function _(b,H,B,L,K,X,de,pe){for(var ue=0,ae=L.length?2:0,fe=H[b].data,we=0,Ue=0,Ye;we<fe.length;we+=128){var Ne=fe.slice(we,we+128);On(Ne,64),Ue=Ne.read_shift(2),Ye=z1(Ne,0,Ue-ae),L.push(Ye);var Xe={name:Ye,type:Ne.read_shift(1),color:Ne.read_shift(1),L:Ne.read_shift(4,"i"),R:Ne.read_shift(4,"i"),C:Ne.read_shift(4,"i"),clsid:Ne.read_shift(16),state:Ne.read_shift(4,"i"),start:0,size:0},dt=Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2);dt!==0&&(Xe.ct=O(Ne,Ne.l-8));var Ot=Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2);Ot!==0&&(Xe.mt=O(Ne,Ne.l-8)),Xe.start=Ne.read_shift(4,"i"),Xe.size=Ne.read_shift(4,"i"),Xe.size<0&&Xe.start<0&&(Xe.size=Xe.type=0,Xe.start=N,Xe.name=""),Xe.type===5?(ue=Xe.start,K>0&&ue!==N&&(H[ue].name="!StreamData")):Xe.size>=4096?(Xe.storage="fat",H[Xe.start]===void 0&&(H[Xe.start]=A(B,Xe.start,H.fat_addrs,H.ssz)),H[Xe.start].name=Xe.name,Xe.content=H[Xe.start].data.slice(0,Xe.size)):(Xe.storage="minifat",Xe.size<0?Xe.size=0:ue!==N&&Xe.start!==N&&H[ue]&&(Xe.content=x(Xe,H[ue].data,(H[pe]||{}).data))),Xe.content&&On(Xe.content,0),X[Ye]=Xe,de.push(Xe)}}function O(b,H){return new Date((Gi(b,H+4)/1e7*Math.pow(2,32)+Gi(b,H)/1e7-11644473600)*1e3)}function G(b,H){return u(),f(l.readFileSync(b),H)}function U(b,H){var B=H&&H.type;switch(B||kt&&Buffer.isBuffer(b)&&(B="buffer"),B||"base64"){case"file":return G(b,H);case"base64":return f(Ki(Zi(b)),H);case"binary":return f(Ki(b),H)}return f(b,H)}function T(b,H){var B=H||{},L=B.root||"Root Entry";if(b.FullPaths||(b.FullPaths=[]),b.FileIndex||(b.FileIndex=[]),b.FullPaths.length!==b.FileIndex.length)throw new Error("inconsistent CFB structure");b.FullPaths.length===0&&(b.FullPaths[0]=L+"/",b.FileIndex[0]={name:L,type:5}),B.CLSID&&(b.FileIndex[0].clsid=B.CLSID),F(b)}function F(b){var H="Sh33tJ5";if(!nt.find(b,"/"+H)){var B=ye(4);B[0]=55,B[1]=B[3]=50,B[2]=54,b.FileIndex.push({name:H,type:2,content:B,size:4,L:69,R:69,C:69}),b.FullPaths.push(b.FullPaths[0]+H),S(b)}}function S(b,H){T(b);for(var B=!1,L=!1,K=b.FullPaths.length-1;K>=0;--K){var X=b.FileIndex[K];switch(X.type){case 0:L?B=!0:(b.FileIndex.pop(),b.FullPaths.pop());break;case 1:case 2:case 5:L=!0,isNaN(X.R*X.L*X.C)&&(B=!0),X.R>-1&&X.L>-1&&X.R==X.L&&(B=!0);break;default:B=!0;break}}if(!(!B&&!H)){var de=new Date(1987,1,19),pe=0,ue=Object.create?Object.create(null):{},ae=[];for(K=0;K<b.FullPaths.length;++K)ue[b.FullPaths[K]]=!0,b.FileIndex[K].type!==0&&ae.push([b.FullPaths[K],b.FileIndex[K]]);for(K=0;K<ae.length;++K){var fe=n(ae[K][0]);L=ue[fe],L||(ae.push([fe,{name:i(fe).replace("/",""),type:1,clsid:Re,ct:de,mt:de,content:null}]),ue[fe]=!0)}for(ae.sort(function(Ye,Ne){return r(Ye[0],Ne[0])}),b.FullPaths=[],b.FileIndex=[],K=0;K<ae.length;++K)b.FullPaths[K]=ae[K][0],b.FileIndex[K]=ae[K][1];for(K=0;K<ae.length;++K){var we=b.FileIndex[K],Ue=b.FullPaths[K];if(we.name=i(Ue).replace("/",""),we.L=we.R=we.C=-(we.color=1),we.size=we.content?we.content.length:0,we.start=0,we.clsid=we.clsid||Re,K===0)we.C=ae.length>1?1:-1,we.size=0,we.type=5;else if(Ue.slice(-1)=="/"){for(pe=K+1;pe<ae.length&&n(b.FullPaths[pe])!=Ue;++pe);for(we.C=pe>=ae.length?-1:pe,pe=K+1;pe<ae.length&&n(b.FullPaths[pe])!=n(Ue);++pe);we.R=pe>=ae.length?-1:pe,we.type=1}else n(b.FullPaths[K+1]||"")==n(Ue)&&(we.R=K+1),we.type=2}}}function I(b,H){var B=H||{};if(B.fileType=="mad")return Gr(b,B);switch(S(b),B.fileType){case"zip":return Rr(b,B)}var L=function(Ye){for(var Ne=0,Xe=0,dt=0;dt<Ye.FileIndex.length;++dt){var Ot=Ye.FileIndex[dt];if(Ot.content){var Mt=Ot.content.length;Mt>0&&(Mt<4096?Ne+=Mt+63>>6:Xe+=Mt+511>>9)}}for(var cr=Ye.FullPaths.length+3>>2,Ci=Ne+7>>3,sr=Ne+127>>7,is=Ci+Xe+cr+sr,Tr=is+127>>7,ss=Tr<=109?0:Math.ceil((Tr-109)/127);is+Tr+ss+127>>7>Tr;)ss=++Tr<=109?0:Math.ceil((Tr-109)/127);var lt=[1,ss,Tr,sr,cr,Xe,Ne,0];return Ye.FileIndex[0].size=Ne<<6,lt[7]=(Ye.FileIndex[0].start=lt[0]+lt[1]+lt[2]+lt[3]+lt[4]+lt[5])+(lt[6]+7>>3),lt}(b),K=ye(L[7]<<9),X=0,de=0;{for(X=0;X<8;++X)K.write_shift(1,_e[X]);for(X=0;X<8;++X)K.write_shift(2,0);for(K.write_shift(2,62),K.write_shift(2,3),K.write_shift(2,65534),K.write_shift(2,9),K.write_shift(2,6),X=0;X<3;++X)K.write_shift(2,0);for(K.write_shift(4,0),K.write_shift(4,L[2]),K.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),K.write_shift(4,0),K.write_shift(4,4096),K.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:N),K.write_shift(4,L[3]),K.write_shift(-4,L[1]?L[0]-1:N),K.write_shift(4,L[1]),X=0;X<109;++X)K.write_shift(-4,X<L[2]?L[1]+X:-1)}if(L[1])for(de=0;de<L[1];++de){for(;X<236+de*127;++X)K.write_shift(-4,X<L[2]?L[1]+X:-1);K.write_shift(-4,de===L[1]-1?N:de+1)}var pe=function(Ye){for(de+=Ye;X<de-1;++X)K.write_shift(-4,X+1);Ye&&(++X,K.write_shift(-4,N))};for(de=X=0,de+=L[1];X<de;++X)K.write_shift(-4,Me.DIFSECT);for(de+=L[2];X<de;++X)K.write_shift(-4,Me.FATSECT);pe(L[3]),pe(L[4]);for(var ue=0,ae=0,fe=b.FileIndex[0];ue<b.FileIndex.length;++ue)fe=b.FileIndex[ue],fe.content&&(ae=fe.content.length,!(ae<4096)&&(fe.start=de,pe(ae+511>>9)));for(pe(L[6]+7>>3);K.l&511;)K.write_shift(-4,Me.ENDOFCHAIN);for(de=X=0,ue=0;ue<b.FileIndex.length;++ue)fe=b.FileIndex[ue],fe.content&&(ae=fe.content.length,!(!ae||ae>=4096)&&(fe.start=de,pe(ae+63>>6)));for(;K.l&511;)K.write_shift(-4,Me.ENDOFCHAIN);for(X=0;X<L[4]<<2;++X){var we=b.FullPaths[X];if(!we||we.length===0){for(ue=0;ue<17;++ue)K.write_shift(4,0);for(ue=0;ue<3;++ue)K.write_shift(4,-1);for(ue=0;ue<12;++ue)K.write_shift(4,0);continue}fe=b.FileIndex[X],X===0&&(fe.start=fe.size?fe.start-1:N);var Ue=X===0&&B.root||fe.name;if(ae=2*(Ue.length+1),K.write_shift(64,Ue,"utf16le"),K.write_shift(2,ae),K.write_shift(1,fe.type),K.write_shift(1,fe.color),K.write_shift(-4,fe.L),K.write_shift(-4,fe.R),K.write_shift(-4,fe.C),fe.clsid)K.write_shift(16,fe.clsid,"hex");else for(ue=0;ue<4;++ue)K.write_shift(4,0);K.write_shift(4,fe.state||0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,fe.start),K.write_shift(4,fe.size),K.write_shift(4,0)}for(X=1;X<b.FileIndex.length;++X)if(fe=b.FileIndex[X],fe.size>=4096)if(K.l=fe.start+1<<9,kt&&Buffer.isBuffer(fe.content))fe.content.copy(K,K.l,0,fe.size),K.l+=fe.size+511&-512;else{for(ue=0;ue<fe.size;++ue)K.write_shift(1,fe.content[ue]);for(;ue&511;++ue)K.write_shift(1,0)}for(X=1;X<b.FileIndex.length;++X)if(fe=b.FileIndex[X],fe.size>0&&fe.size<4096)if(kt&&Buffer.isBuffer(fe.content))fe.content.copy(K,K.l,0,fe.size),K.l+=fe.size+63&-64;else{for(ue=0;ue<fe.size;++ue)K.write_shift(1,fe.content[ue]);for(;ue&63;++ue)K.write_shift(1,0)}if(kt)K.l=K.length;else for(;K.l<K.length;)K.write_shift(1,0);return K}function R(b,H){var B=b.FullPaths.map(function(ue){return ue.toUpperCase()}),L=B.map(function(ue){var ae=ue.split("/");return ae[ae.length-(ue.slice(-1)=="/"?2:1)]}),K=!1;H.charCodeAt(0)===47?(K=!0,H=B[0].slice(0,-1)+H):K=H.indexOf("/")!==-1;var X=H.toUpperCase(),de=K===!0?B.indexOf(X):L.indexOf(X);if(de!==-1)return b.FileIndex[de];var pe=!X.match(fd);for(X=X.replace(yi,""),pe&&(X=X.replace(fd,"!")),de=0;de<B.length;++de)if((pe?B[de].replace(fd,"!"):B[de]).replace(yi,"")==X||(pe?L[de].replace(fd,"!"):L[de]).replace(yi,"")==X)return b.FileIndex[de];return null}var D=64,N=-2,Ge="d0cf11e0a1b11ae1",_e=[208,207,17,224,161,177,26,225],Re="00000000000000000000000000000000",Me={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:N,FREESECT:-1,HEADER_SIGNATURE:Ge,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Re,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Se(b,H,B){u();var L=I(b,B);l.writeFileSync(H,L)}function te(b){for(var H=new Array(b.length),B=0;B<b.length;++B)H[B]=String.fromCharCode(b[B]);return H.join("")}function Ce(b,H){var B=I(b,H);switch(H&&H.type||"buffer"){case"file":return u(),l.writeFileSync(H.filename,B),B;case"binary":return typeof B=="string"?B:te(B);case"base64":return sf(typeof B=="string"?B:te(B));case"buffer":if(kt)return Buffer.isBuffer(B)?B:ro(B);case"array":return typeof B=="string"?Ki(B):B}return B}var je;function W(b){try{var H=b.InflateRaw,B=new H;if(B._processChunk(new Uint8Array([3,0]),B._finishFlushFlag),B.bytesRead)je=b;else throw new Error("zlib does not expose bytesRead")}catch(L){console.error("cannot use native zlib: "+(L.message||L))}}function re(b,H){if(!je)return Fs(b,H);var B=je.InflateRaw,L=new B,K=L._processChunk(b.slice(b.l),L._finishFlushFlag);return b.l+=L.bytesRead,K}function ee(b){return je?je.deflateRawSync(b):pt(b)}var Y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],xe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ee=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Le(b){var H=(b<<1|b<<11)&139536|(b<<5|b<<15)&558144;return(H>>16|H>>8|H)&255}for(var Fe=typeof Uint8Array<"u",Ae=Fe?new Uint8Array(256):[],it=0;it<256;++it)Ae[it]=Le(it);function q(b,H){var B=Ae[b&255];return H<=8?B>>>8-H:(B=B<<8|Ae[b>>8&255],H<=16?B>>>16-H:(B=B<<8|Ae[b>>16&255],B>>>24-H))}function Pt(b,H){var B=H&7,L=H>>>3;return(b[L]|(B<=6?0:b[L+1]<<8))>>>B&3}function Et(b,H){var B=H&7,L=H>>>3;return(b[L]|(B<=5?0:b[L+1]<<8))>>>B&7}function Nt(b,H){var B=H&7,L=H>>>3;return(b[L]|(B<=4?0:b[L+1]<<8))>>>B&15}function xt(b,H){var B=H&7,L=H>>>3;return(b[L]|(B<=3?0:b[L+1]<<8))>>>B&31}function Ke(b,H){var B=H&7,L=H>>>3;return(b[L]|(B<=1?0:b[L+1]<<8))>>>B&127}function ir(b,H,B){var L=H&7,K=H>>>3,X=(1<<B)-1,de=b[K]>>>L;return B<8-L||(de|=b[K+1]<<8-L,B<16-L)||(de|=b[K+2]<<16-L,B<24-L)||(de|=b[K+3]<<24-L),de&X}function bn(b,H,B){var L=H&7,K=H>>>3;return L<=5?b[K]|=(B&7)<<L:(b[K]|=B<<L&255,b[K+1]=(B&7)>>8-L),H+3}function en(b,H,B){var L=H&7,K=H>>>3;return B=(B&1)<<L,b[K]|=B,H+1}function wi(b,H,B){var L=H&7,K=H>>>3;return B<<=L,b[K]|=B&255,B>>>=8,b[K+1]=B,H+8}function rs(b,H,B){var L=H&7,K=H>>>3;return B<<=L,b[K]|=B&255,B>>>=8,b[K+1]=B&255,b[K+2]=B>>>8,H+16}function Si(b,H){var B=b.length,L=2*B>H?2*B:H+5,K=0;if(B>=H)return b;if(kt){var X=L_(L);if(b.copy)b.copy(X);else for(;K<b.length;++K)X[K]=b[K];return X}else if(Fe){var de=new Uint8Array(L);if(de.set)de.set(b);else for(;K<B;++K)de[K]=b[K];return de}return b.length=L,b}function Lr(b){for(var H=new Array(b),B=0;B<b;++B)H[B]=0;return H}function Ti(b,H,B){var L=1,K=0,X=0,de=0,pe=0,ue=b.length,ae=Fe?new Uint16Array(32):Lr(32);for(X=0;X<32;++X)ae[X]=0;for(X=ue;X<B;++X)b[X]=0;ue=b.length;var fe=Fe?new Uint16Array(ue):Lr(ue);for(X=0;X<ue;++X)ae[K=b[X]]++,L<K&&(L=K),fe[X]=0;for(ae[0]=0,X=1;X<=L;++X)ae[X+16]=pe=pe+ae[X-1]<<1;for(X=0;X<ue;++X)pe=b[X],pe!=0&&(fe[X]=ae[pe+16]++);var we=0;for(X=0;X<ue;++X)if(we=b[X],we!=0)for(pe=q(fe[X],L)>>L-we,de=(1<<L+4-we)-1;de>=0;--de)H[pe|de<<we]=we&15|X<<4;return L}var qt=Fe?new Uint16Array(512):Lr(512),Sr=Fe?new Uint16Array(32):Lr(32);if(!Fe){for(var dr=0;dr<512;++dr)qt[dr]=0;for(dr=0;dr<32;++dr)Sr[dr]=0}(function(){for(var b=[],H=0;H<32;H++)b.push(5);Ti(b,Sr,32);var B=[];for(H=0;H<=143;H++)B.push(8);for(;H<=255;H++)B.push(9);for(;H<=279;H++)B.push(7);for(;H<=287;H++)B.push(8);Ti(B,qt,288)})();var ui=function(){for(var H=Fe?new Uint8Array(32768):[],B=0,L=0;B<Ee.length-1;++B)for(;L<Ee[B+1];++L)H[L]=B;for(;L<32768;++L)H[L]=29;var K=Fe?new Uint8Array(259):[];for(B=0,L=0;B<xe.length-1;++B)for(;L<xe[B+1];++L)K[L]=B;function X(pe,ue){for(var ae=0;ae<pe.length;){var fe=Math.min(65535,pe.length-ae),we=ae+fe==pe.length;for(ue.write_shift(1,+we),ue.write_shift(2,fe),ue.write_shift(2,~fe&65535);fe-- >0;)ue[ue.l++]=pe[ae++]}return ue.l}function de(pe,ue){for(var ae=0,fe=0,we=Fe?new Uint16Array(32768):[];fe<pe.length;){var Ue=Math.min(65535,pe.length-fe);if(Ue<10){for(ae=bn(ue,ae,+(fe+Ue==pe.length)),ae&7&&(ae+=8-(ae&7)),ue.l=ae/8|0,ue.write_shift(2,Ue),ue.write_shift(2,~Ue&65535);Ue-- >0;)ue[ue.l++]=pe[fe++];ae=ue.l*8;continue}ae=bn(ue,ae,+(fe+Ue==pe.length)+2);for(var Ye=0;Ue-- >0;){var Ne=pe[fe];Ye=(Ye<<5^Ne)&32767;var Xe=-1,dt=0;if((Xe=we[Ye])&&(Xe|=fe&-32768,Xe>fe&&(Xe-=32768),Xe<fe))for(;pe[Xe+dt]==pe[fe+dt]&&dt<250;)++dt;if(dt>2){Ne=K[dt],Ne<=22?ae=wi(ue,ae,Ae[Ne+1]>>1)-1:(wi(ue,ae,3),ae+=5,wi(ue,ae,Ae[Ne-23]>>5),ae+=3);var Ot=Ne<8?0:Ne-4>>2;Ot>0&&(rs(ue,ae,dt-xe[Ne]),ae+=Ot),Ne=H[fe-Xe],ae=wi(ue,ae,Ae[Ne]>>3),ae-=3;var Mt=Ne<4?0:Ne-2>>1;Mt>0&&(rs(ue,ae,fe-Xe-Ee[Ne]),ae+=Mt);for(var cr=0;cr<dt;++cr)we[Ye]=fe&32767,Ye=(Ye<<5^pe[fe])&32767,++fe;Ue-=dt-1}else Ne<=143?Ne=Ne+48:ae=en(ue,ae,1),ae=wi(ue,ae,Ae[Ne]),we[Ye]=fe&32767,++fe}ae=wi(ue,ae,0)-1}return ue.l=(ae+7)/8|0,ue.l}return function(ue,ae){return ue.length<8?X(ue,ae):de(ue,ae)}}();function pt(b){var H=ye(50+Math.floor(b.length*1.1)),B=ui(b,H);return H.slice(0,B)}var fr=Fe?new Uint16Array(32768):Lr(32768),hr=Fe?new Uint16Array(32768):Lr(32768),yr=Fe?new Uint16Array(128):Lr(128),di=1,ao=1;function oo(b,H){var B=xt(b,H)+257;H+=5;var L=xt(b,H)+1;H+=5;var K=Nt(b,H)+4;H+=4;for(var X=0,de=Fe?new Uint8Array(19):Lr(19),pe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ue=1,ae=Fe?new Uint8Array(8):Lr(8),fe=Fe?new Uint8Array(8):Lr(8),we=de.length,Ue=0;Ue<K;++Ue)de[Y[Ue]]=X=Et(b,H),ue<X&&(ue=X),ae[X]++,H+=3;var Ye=0;for(ae[0]=0,Ue=1;Ue<=ue;++Ue)fe[Ue]=Ye=Ye+ae[Ue-1]<<1;for(Ue=0;Ue<we;++Ue)(Ye=de[Ue])!=0&&(pe[Ue]=fe[Ye]++);var Ne=0;for(Ue=0;Ue<we;++Ue)if(Ne=de[Ue],Ne!=0){Ye=Ae[pe[Ue]]>>8-Ne;for(var Xe=(1<<7-Ne)-1;Xe>=0;--Xe)yr[Ye|Xe<<Ne]=Ne&7|Ue<<3}var dt=[];for(ue=1;dt.length<B+L;)switch(Ye=yr[Ke(b,H)],H+=Ye&7,Ye>>>=3){case 16:for(X=3+Pt(b,H),H+=2,Ye=dt[dt.length-1];X-- >0;)dt.push(Ye);break;case 17:for(X=3+Et(b,H),H+=3;X-- >0;)dt.push(0);break;case 18:for(X=11+Ke(b,H),H+=7;X-- >0;)dt.push(0);break;default:dt.push(Ye),ue<Ye&&(ue=Ye);break}var Ot=dt.slice(0,B),Mt=dt.slice(B);for(Ue=B;Ue<286;++Ue)Ot[Ue]=0;for(Ue=L;Ue<30;++Ue)Mt[Ue]=0;return di=Ti(Ot,fr,286),ao=Ti(Mt,hr,30),H}function Vu(b,H){if(b[0]==3&&!(b[1]&3))return[Jo(H),2];for(var B=0,L=0,K=L_(H||1<<18),X=0,de=K.length>>>0,pe=0,ue=0;!(L&1);){if(L=Et(b,B),B+=3,L>>>1)L>>1==1?(pe=9,ue=5):(B=oo(b,B),pe=di,ue=ao);else{B&7&&(B+=8-(B&7));var ae=b[B>>>3]|b[(B>>>3)+1]<<8;if(B+=32,ae>0)for(!H&&de<X+ae&&(K=Si(K,X+ae),de=K.length);ae-- >0;)K[X++]=b[B>>>3],B+=8;continue}for(;;){!H&&de<X+32767&&(K=Si(K,X+32767),de=K.length);var fe=ir(b,B,pe),we=L>>>1==1?qt[fe]:fr[fe];if(B+=we&15,we>>>=4,!(we>>>8&255))K[X++]=we;else{if(we==256)break;we-=257;var Ue=we<8?0:we-4>>2;Ue>5&&(Ue=0);var Ye=X+xe[we];Ue>0&&(Ye+=ir(b,B,Ue),B+=Ue),fe=ir(b,B,ue),we=L>>>1==1?Sr[fe]:hr[fe],B+=we&15,we>>>=4;var Ne=we<4?0:we-2>>1,Xe=Ee[we];for(Ne>0&&(Xe+=ir(b,B,Ne),B+=Ne),!H&&de<Ye&&(K=Si(K,Ye+100),de=K.length);X<Ye;)K[X]=K[X-Xe],++X}}}return H?[K,B+7>>>3]:[K.slice(0,X),B+7>>>3]}function Fs(b,H){var B=b.slice(b.l||0),L=Vu(B,H);return b.l+=L[1],L[0]}function dl(b,H){if(b)typeof console<"u"&&console.error(H);else throw new Error(H)}function bs(b,H){var B=b;On(B,0);var L=[],K=[],X={FileIndex:L,FullPaths:K};T(X,{root:H.root});for(var de=B.length-4;(B[de]!=80||B[de+1]!=75||B[de+2]!=5||B[de+3]!=6)&&de>=0;)--de;B.l=de+4,B.l+=4;var pe=B.read_shift(2);B.l+=6;var ue=B.read_shift(4);for(B.l=ue,de=0;de<pe;++de){B.l+=20;var ae=B.read_shift(4),fe=B.read_shift(4),we=B.read_shift(2),Ue=B.read_shift(2),Ye=B.read_shift(2);B.l+=8;var Ne=B.read_shift(4),Xe=o(B.slice(B.l+we,B.l+we+Ue));B.l+=we+Ue+Ye;var dt=B.l;B.l=Ne+4,ce(B,ae,fe,X,Xe),B.l=dt}return X}function ce(b,H,B,L,K){b.l+=2;var X=b.read_shift(2),de=b.read_shift(2),pe=a(b);if(X&8257)throw new Error("Unsupported ZIP encryption");for(var ue=b.read_shift(4),ae=b.read_shift(4),fe=b.read_shift(4),we=b.read_shift(2),Ue=b.read_shift(2),Ye="",Ne=0;Ne<we;++Ne)Ye+=String.fromCharCode(b[b.l++]);if(Ue){var Xe=o(b.slice(b.l,b.l+Ue));(Xe[21589]||{}).mt&&(pe=Xe[21589].mt),((K||{})[21589]||{}).mt&&(pe=K[21589].mt)}b.l+=Ue;var dt=b.slice(b.l,b.l+ae);switch(de){case 8:dt=re(b,fe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+de)}var Ot=!1;X&8&&(ue=b.read_shift(4),ue==134695760&&(ue=b.read_shift(4),Ot=!0),ae=b.read_shift(4),fe=b.read_shift(4)),ae!=H&&dl(Ot,"Bad compressed size: "+H+" != "+ae),fe!=B&&dl(Ot,"Bad uncompressed size: "+B+" != "+fe),Is(L,Ye,dt,{unsafe:!0,mt:pe})}function Rr(b,H){var B=H||{},L=[],K=[],X=ye(1),de=B.compression?8:0,pe=0,ue=0,ae=0,fe=0,we=0,Ue=b.FullPaths[0],Ye=Ue,Ne=b.FileIndex[0],Xe=[],dt=0;for(ue=1;ue<b.FullPaths.length;++ue)if(Ye=b.FullPaths[ue].slice(Ue.length),Ne=b.FileIndex[ue],!(!Ne.size||!Ne.content||Ye=="Sh33tJ5")){var Ot=fe,Mt=ye(Ye.length);for(ae=0;ae<Ye.length;++ae)Mt.write_shift(1,Ye.charCodeAt(ae)&127);Mt=Mt.slice(0,Mt.l),Xe[we]=tR.buf(Ne.content,0);var cr=Ne.content;de==8&&(cr=ee(cr)),X=ye(30),X.write_shift(4,67324752),X.write_shift(2,20),X.write_shift(2,pe),X.write_shift(2,de),Ne.mt?s(X,Ne.mt):X.write_shift(4,0),X.write_shift(-4,Xe[we]),X.write_shift(4,cr.length),X.write_shift(4,Ne.content.length),X.write_shift(2,Mt.length),X.write_shift(2,0),fe+=X.length,L.push(X),fe+=Mt.length,L.push(Mt),fe+=cr.length,L.push(cr),X=ye(46),X.write_shift(4,33639248),X.write_shift(2,0),X.write_shift(2,20),X.write_shift(2,pe),X.write_shift(2,de),X.write_shift(4,0),X.write_shift(-4,Xe[we]),X.write_shift(4,cr.length),X.write_shift(4,Ne.content.length),X.write_shift(2,Mt.length),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(4,0),X.write_shift(4,Ot),dt+=X.l,K.push(X),dt+=Mt.length,K.push(Mt),++we}return X=ye(22),X.write_shift(4,101010256),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,we),X.write_shift(2,we),X.write_shift(4,dt),X.write_shift(4,fe),X.write_shift(2,0),kn([kn(L),kn(K),X])}var Ai={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ns(b,H){if(b.ctype)return b.ctype;var B=b.name||"",L=B.match(/\.([^\.]+)$/);return L&&Ai[L[1]]||H&&(L=(B=H).match(/[\.\\]([^\.\\])+$/),L&&Ai[L[1]])?Ai[L[1]]:"application/octet-stream"}function _a(b){for(var H=sf(b),B=[],L=0;L<H.length;L+=76)B.push(H.slice(L,L+76));return B.join(`\r
`)+`\r
`}function Js(b){var H=b.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ae){var fe=ae.charCodeAt(0).toString(16).toUpperCase();return"="+(fe.length==1?"0"+fe:fe)});H=H.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),H.charAt(0)==`
`&&(H="=0D"+H.slice(1)),H=H.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var B=[],L=H.split(`\r
`),K=0;K<L.length;++K){var X=L[K];if(X.length==0){B.push("");continue}for(var de=0;de<X.length;){var pe=76,ue=X.slice(de,de+pe);ue.charAt(pe-1)=="="?pe--:ue.charAt(pe-2)=="="?pe-=2:ue.charAt(pe-3)=="="&&(pe-=3),ue=X.slice(de,de+pe),de+=pe,de<X.length&&(ue+="="),B.push(ue)}}return B.join(`\r
`)}function Zs(b){for(var H=[],B=0;B<b.length;++B){for(var L=b[B];B<=b.length&&L.charAt(L.length-1)=="=";)L=L.slice(0,L.length-1)+b[++B];H.push(L)}for(var K=0;K<H.length;++K)H[K]=H[K].replace(/[=][0-9A-Fa-f]{2}/g,function(X){return String.fromCharCode(parseInt(X.slice(1),16))});return Ki(H.join(`\r
`))}function ki(b,H,B){for(var L="",K="",X="",de,pe=0;pe<10;++pe){var ue=H[pe];if(!ue||ue.match(/^\s*$/))break;var ae=ue.match(/^(.*?):\s*([^\s].*)$/);if(ae)switch(ae[1].toLowerCase()){case"content-location":L=ae[2].trim();break;case"content-type":X=ae[2].trim();break;case"content-transfer-encoding":K=ae[2].trim();break}}switch(++pe,K.toLowerCase()){case"base64":de=Ki(Zi(H.slice(pe).join("")));break;case"quoted-printable":de=Zs(H.slice(pe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+K)}var fe=Is(b,L.slice(B.length),de,{unsafe:!0});X&&(fe.ctype=X)}function tn(b,H){if(te(b.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var B=H&&H.root||"",L=(kt&&Buffer.isBuffer(b)?b.toString("binary"):te(b)).split(`\r
`),K=0,X="";for(K=0;K<L.length;++K)if(X=L[K],!!/^Content-Location:/i.test(X)&&(X=X.slice(X.indexOf("file")),B||(B=X.slice(0,X.lastIndexOf("/")+1)),X.slice(0,B.length)!=B))for(;B.length>0&&(B=B.slice(0,B.length-1),B=B.slice(0,B.lastIndexOf("/")+1),X.slice(0,B.length)!=B););var de=(L[1]||"").match(/boundary="(.*?)"/);if(!de)throw new Error("MAD cannot find boundary");var pe="--"+(de[1]||""),ue=[],ae=[],fe={FileIndex:ue,FullPaths:ae};T(fe);var we,Ue=0;for(K=0;K<L.length;++K){var Ye=L[K];Ye!==pe&&Ye!==pe+"--"||(Ue++&&ki(fe,L.slice(we,K),B),we=K)}return fe}function Gr(b,H){var B=H||{},L=B.boundary||"SheetJS";L="------="+L;for(var K=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+L.slice(2)+'"',"","",""],X=b.FullPaths[0],de=X,pe=b.FileIndex[0],ue=1;ue<b.FullPaths.length;++ue)if(de=b.FullPaths[ue].slice(X.length),pe=b.FileIndex[ue],!(!pe.size||!pe.content||de=="Sh33tJ5")){de=de.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(dt){return"_x"+dt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(dt){return"_u"+dt.charCodeAt(0).toString(16)+"_"});for(var ae=pe.content,fe=kt&&Buffer.isBuffer(ae)?ae.toString("binary"):te(ae),we=0,Ue=Math.min(1024,fe.length),Ye=0,Ne=0;Ne<=Ue;++Ne)(Ye=fe.charCodeAt(Ne))>=32&&Ye<128&&++we;var Xe=we>=Ue*4/5;K.push(L),K.push("Content-Location: "+(B.root||"file:///C:/SheetJS/")+de),K.push("Content-Transfer-Encoding: "+(Xe?"quoted-printable":"base64")),K.push("Content-Type: "+ns(pe,de)),K.push(""),K.push(Xe?Js(fe):_a(fe))}return K.push(L+`--\r
`),K.join(`\r
`)}function Ea(b){var H={};return T(H,b),H}function Is(b,H,B,L){var K=L&&L.unsafe;K||T(b);var X=!K&&nt.find(b,H);if(!X){var de=b.FullPaths[0];H.slice(0,de.length)==de?de=H:(de.slice(-1)!="/"&&(de+="/"),de=(de+H).replace("//","/")),X={name:i(H),type:2},b.FileIndex.push(X),b.FullPaths.push(de),K||nt.utils.cfb_gc(b)}return X.content=B,X.size=B?B.length:0,L&&(L.CLSID&&(X.clsid=L.CLSID),L.mt&&(X.mt=L.mt),L.ct&&(X.ct=L.ct)),X}function rn(b,H){T(b);var B=nt.find(b,H);if(B){for(var L=0;L<b.FileIndex.length;++L)if(b.FileIndex[L]==B)return b.FileIndex.splice(L,1),b.FullPaths.splice(L,1),!0}return!1}function hc(b,H,B){T(b);var L=nt.find(b,H);if(L){for(var K=0;K<b.FileIndex.length;++K)if(b.FileIndex[K]==L)return b.FileIndex[K].name=i(B),b.FullPaths[K]=B,!0}return!1}function Ns(b){S(b,!0)}return e.find=R,e.read=U,e.parse=f,e.write=Ce,e.writeFile=Se,e.utils={cfb_new:Ea,cfb_add:Is,cfb_del:rn,cfb_mov:hc,cfb_gc:Ns,ReadShift:Cd,CheckField:iA,prep_blob:On,bconcat:kn,use_zlib:W,_deflateRaw:pt,_inflateRaw:Fs,consts:Me},e}();function rR(t){return typeof t=="string"?Op(t):Array.isArray(t)?FN(t):t}function Df(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Op(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?ca(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([rR(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=ll(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function nR(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Br(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function G_(t,e){for(var r=[],n=Br(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function Bp(t){for(var e=[],r=Br(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Lp(t){for(var e=[],r=Br(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function iR(t){for(var e=[],r=Br(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Kh=new Date(1899,11,30,0,0,0);function mn(t,e){var r=t.getTime(),n=Kh.getTime()+(t.getTimezoneOffset()-Kh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var BT=new Date,sR=Kh.getTime()+(BT.getTimezoneOffset()-Kh.getTimezoneOffset())*6e4,K_=BT.getTimezoneOffset();function jp(t){var e=new Date;return e.setTime(t*24*60*60*1e3+sR),e.getTimezoneOffset()!==K_&&e.setTime(e.getTime()+(e.getTimezoneOffset()-K_)*6e4),e}function aR(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[s],10)}return e}var Y_=new Date("2017-02-19T19:06:09.000Z"),LT=isNaN(Y_.getFullYear())?new Date("2/19/17"):Y_,oR=LT.getFullYear()==2017;function xr(t,e){var r=new Date(t);if(oR)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(LT.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Kl(t,e){if(kt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return ca(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return ca(AT(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return ca(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return ca(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function vr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=vr(t[r]));return e}function Pr(t,e){for(var r="";r.length<e;)r+=t;return r}function Ys(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var lR=["january","february","march","april","may","june","july","august","september","october","november","december"];function gu(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&lR.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var cR=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function jT(t){return t?t.content&&t.type?Kl(t.content,!0):t.data?dd(t.data):t.asNodeBuffer&&kt?dd(t.asNodeBuffer().toString("binary")):t.asBinary?dd(t.asBinary()):t._data&&t._data.getContent?dd(Kl(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function VT(t){if(!t)return null;if(t.data)return M_(t.data);if(t.asNodeBuffer&&kt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?M_(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function uR(t){return t&&t.name.slice(-4)===".bin"?VT(t):jT(t)}function ms(t,e){for(var r=t.FullPaths||Br(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function M1(t,e){var r=ms(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Qr(t,e,r){if(!r)return uR(M1(t,e));if(!e)return null;try{return Qr(t,e)}catch{return null}}function Yi(t,e,r){if(!r)return jT(M1(t,e));if(!e)return null;try{return Yi(t,e)}catch{return null}}function dR(t,e,r){return VT(M1(t,e))}function X_(t){for(var e=t.FullPaths||Br(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Tt(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return kt?n=ro(r):n=bN(r),nt.utils.cfb_add(t,e,n)}nt.utils.cfb_add(t,e,r)}else t.file(e,r)}function B1(){return nt.utils.cfb_new()}function UT(t,e){switch(e.type){case"base64":return nt.read(t,{type:"base64"});case"binary":return nt.read(t,{type:"binary"});case"buffer":case"array":return nt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function hd(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var $r=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,fR=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,q_=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,hR=/<[^>]*>/g,ci=$r.match(q_)?q_:hR,pR=/<\w*:/,gR=/<(\/?)\w+:/;function ht(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var a=t.match(fR),o=0,l="",u=0,f="",p="",g=1;if(a)for(u=0;u!=a.length;++u){for(p=a[u],s=0;s!=p.length&&p.charCodeAt(s)!==61;++s);for(f=p.slice(0,s).trim();p.charCodeAt(s+1)==32;)++s;for(g=(i=p.charCodeAt(s+1))==34||i==39?1:0,l=p.slice(s+1+g,p.length-g),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,n[f.toLowerCase()]=l;else{var m=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[m]&&f.slice(o-3,o)=="ext")continue;n[m]=l,n[m.toLowerCase()]=l}}return n}function va(t){return t.replace(gR,"<$1")}var zT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},L1=Bp(zT),Ht=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(o,l){return zT[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),j1=/[&<>'"]/g,mR=/[\u0000-\u0008\u000b-\u001f]/g;function tr(t){var e=t+"";return e.replace(j1,function(r){return L1[r]}).replace(mR,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Q_(t){return tr(t).replace(/ /g,"_x0020_")}var WT=/[\u0000-\u001f]/g;function V1(t){var e=t+"";return e.replace(j1,function(r){return L1[r]}).replace(/\n/g,"<br/>").replace(WT,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function xR(t){var e=t+"";return e.replace(j1,function(r){return L1[r]}).replace(WT,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var J_=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function vR(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function gr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Rg(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function Z_(t){var e=Jo(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function e2(t){return ro(t,"binary").toString("utf8")}var F0="foo bar baz",or=kt&&(e2(F0)==Rg(F0)&&e2||Z_(F0)==Rg(F0)&&Z_)||Rg,ca=kt?function(t){return ro(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},of=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),HT=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),yR=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),_R=/<\/?(?:vt:)?variant>/g,ER=/<(?:vt:)([^>]*)>([\s\S]*)</;function t2(t,e){var r=ht(t),n=t.match(yR(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(_R,"").match(ER);a&&i.push({v:or(a[2]),t:a[1]})}),i}var $T=/(^\s|\s$|\n)/;function Mn(t,e){return"<"+t+(e.match($T)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function lf(t){return Br(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function We(t,e,r){return"<"+t+(r!=null?lf(r):"")+(e!=null?(e.match($T)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function rx(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function wR(t,e){switch(typeof t){case"string":var r=We("vt:lpwstr",tr(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return We((t|0)==t?"vt:i4":"vt:r8",tr(String(t)));case"boolean":return We("vt:bool",t?"true":"false")}if(t instanceof Date)return We("vt:filetime",rx(t));throw new Error("Unable to serialize "+t)}function U1(t){if(kt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return or(ll(D1(t)));throw new Error("Bad input format: expected Buffer or string")}var cf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,fn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},sc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],$i={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function SR(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function TR(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var r2=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},n2=kt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:ro(e)})):r2(t)}:r2,i2=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Ma(t,i)));return n.join("").replace(yi,"")},z1=kt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(yi,""):i2(t,e,r)}:i2,s2=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},GT=kt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):s2(t,e,r)}:s2,a2=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(Ic(t,i)));return n.join("")},Pf=kt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):a2(e,r,n)}:a2,KT=function(t,e){var r=Gi(t,e);return r>0?Pf(t,e+4,e+4+r-1):""},YT=KT,XT=function(t,e){var r=Gi(t,e);return r>0?Pf(t,e+4,e+4+r-1):""},qT=XT,QT=function(t,e){var r=2*Gi(t,e);return r>0?Pf(t,e+4,e+4+r-1):""},JT=QT,ZT=function(e,r){var n=Gi(e,r);return n>0?z1(e,r+4,r+4+n):""},eA=ZT,tA=function(t,e){var r=Gi(t,e);return r>0?Pf(t,e+4,e+4+r):""},rA=tA,nA=function(t,e){return SR(t,e)},Yh=nA,W1=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};kt&&(YT=function(e,r){if(!Buffer.isBuffer(e))return KT(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},qT=function(e,r){if(!Buffer.isBuffer(e))return XT(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},JT=function(e,r){if(!Buffer.isBuffer(e))return QT(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},eA=function(e,r){if(!Buffer.isBuffer(e))return ZT(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},rA=function(e,r){if(!Buffer.isBuffer(e))return tA(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Yh=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):nA(e,r)},W1=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Ic=function(t,e){return t[e]},Ma=function(t,e){return t[e+1]*256+t[e]},AR=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Gi=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},kl=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},kR=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Cd(t,e){var r="",n,i,s=[],a,o,l,u;switch(e){case"dbcs":if(u=this.l,kt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(Ma(this,u)),u+=2;t*=2;break;case"utf8":r=Pf(this,this.l,this.l+t);break;case"utf16le":t*=2,r=z1(this,this.l,this.l+t);break;case"wstr":return Cd.call(this,t,"dbcs");case"lpstr-ansi":r=YT(this,this.l),t=4+Gi(this,this.l);break;case"lpstr-cp":r=qT(this,this.l),t=4+Gi(this,this.l);break;case"lpwstr":r=JT(this,this.l),t=4+2*Gi(this,this.l);break;case"lpp4":t=4+Gi(this,this.l),r=eA(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Gi(this,this.l),r=rA(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=Ic(this,this.l+t++))!==0;)s.push(C0(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=Ma(this,this.l+t))!==0;)s.push(C0(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Ic(this,u),this.l=u+1,o=Cd.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(C0(Ma(this,u))),u+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Ic(this,u),this.l=u+1,o=Cd.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(C0(Ic(this,u))),u+=1}r=s.join("");break;default:switch(t){case 1:return n=Ic(this,this.l),this.l++,n;case 2:return n=(e==="i"?AR:Ma)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?kl:kR)(this,this.l),this.l+=4,n):(i=Gi(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=Yh(this,this.l):i=Yh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=GT(this,this.l,t);break}}return this.l+=t,r}var CR=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},FR=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},bR=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function IR(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)bR(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,CR(this,e,this.l);break;case 8:if(n=8,r==="f"){TR(this,e,this.l);break}case 16:break;case-4:n=4,FR(this,e,this.l);break}return this.l+=n,this}function iA(t,e){var r=GT(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function On(t,e){t.l=e,t.read_shift=Cd,t.chk=iA,t.write_shift=IR}function oi(t,e){t.l+=e}function ye(t){var e=Jo(t);return On(e,0),e}function no(t,e,r){if(t){var n,i,s;On(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var u=gf[o]||gf[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;l=t.l+s;var f=u.f&&u.f(t,s,r);if(t.l=l,e(f,u,o))return}}}function ji(){var t=[],e=kt?256:2048,r=function(u){var f=ye(u);return On(f,0),f},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,e)))},a=function(){return i(),kn(t)},o=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function ke(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=gf[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&W1(r)&&t.push(r)}}function Fd(t,e,r){var n=vr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function o2(t,e,r){var n=vr(t);return n.s=Fd(n.s,e.s,r),n.e=Fd(n.e,e.s,r),n}function bd(t,e){if(t.cRel&&t.c<0)for(t=vr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=vr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=ft(t);return!t.cRel&&t.cRel!=null&&(r=DR(r)),!t.rRel&&t.rRel!=null&&(r=NR(r)),r}function Dg(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Cr(t.s.c)+":"+(t.e.cRel?"":"$")+Cr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Hr(t.s.r)+":"+(t.e.rRel?"":"$")+Hr(t.e.r):bd(t.s,e.biff)+":"+bd(t.e,e.biff)}function H1(t){return parseInt(RR(t),10)-1}function Hr(t){return""+(t+1)}function NR(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function RR(t){return t.replace(/\$(\d+)$/,"$1")}function $1(t){for(var e=PR(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Cr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function DR(t){return t.replace(/^([A-Z])/,"$$$1")}function PR(t){return t.replace(/^\$([A-Z])/,"$1")}function OR(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Fr(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function ft(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Vi(t){var e=t.indexOf(":");return e==-1?{s:Fr(t),e:Fr(t)}:{s:Fr(t.slice(0,e)),e:Fr(t.slice(e+1))}}function St(t,e){return typeof e>"u"||typeof e=="number"?St(t.s,t.e):(typeof t!="string"&&(t=ft(t)),typeof e!="string"&&(e=ft(e)),t==e?t:t+":"+e)}function $t(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function l2(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=ks(t.z,r?mn(e):e)}catch{}try{return t.w=ks((t.XF||{}).numFmtId||(r?14:0),r?mn(e):e)}catch{return""+e}}function Xa(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?io[t.v]||t.v:e==null?l2(t,t.v):l2(t,e))}function cl(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function sA(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Fr(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=$t(s["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),a==-1&&(u.e.r=a=f.e.r+1)}for(var p=0;p!=e.length;++p)if(e[p]){if(!Array.isArray(e[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=e[p].length;++g)if(!(typeof e[p][g]>"u")){var m={v:e[p][g]},y=a+p,x=o+g;if(u.s.r>y&&(u.s.r=y),u.s.c>x&&(u.s.c=x),u.e.r<y&&(u.e.r=y),u.e.c<x&&(u.e.c=x),e[p][g]&&typeof e[p][g]=="object"&&!Array.isArray(e[p][g])&&!(e[p][g]instanceof Date))m=e[p][g];else if(Array.isArray(m.v)&&(m.f=e[p][g][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||ut[14],n.cellDates?(m.t="d",m.w=ks(m.z,mn(m.v))):(m.t="n",m.v=mn(m.v),m.w=ks(m.z,m.v))):m.t="s";if(i)s[y]||(s[y]=[]),s[y][x]&&s[y][x].z&&(m.z=s[y][x].z),s[y][x]=m;else{var w=ft({c:x,r:y});s[w]&&s[w].z&&(m.z=s[w].z),s[w]=m}}}return u.s.c<1e7&&(s["!ref"]=St(u)),s}function Ru(t,e){return sA(null,t,e)}function MR(t){return t.read_shift(4,"i")}function Xs(t,e){return e||(e=ye(4)),e.write_shift(4,t),e}function si(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Cn(t,e){var r=!1;return e==null&&(r=!0,e=ye(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function BR(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function LR(t,e){return e||(e=ye(4)),e.write_shift(2,0),e.write_shift(2,0),e}function G1(t,e){var r=t.l,n=t.read_shift(1),i=si(t),s=[],a={t:i,h:i};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)s.push(BR(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function jR(t,e){var r=!1;return e==null&&(r=!0,e=ye(15+4*t.t.length)),e.write_shift(1,0),Cn(t.t,e),r?e.slice(0,e.l):e}var VR=G1;function UR(t,e){var r=!1;return e==null&&(r=!0,e=ye(23+4*t.t.length)),e.write_shift(1,1),Cn(t.t,e),e.write_shift(4,1),LR({},e),r?e.slice(0,e.l):e}function Cs(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function ac(t,e){return e==null&&(e=ye(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function oc(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function lc(t,e){return e==null&&(e=ye(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var zR=si,aA=Cn;function K1(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Xh(t,e){var r=!1;return e==null&&(r=!0,e=ye(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var WR=si,nx=K1,Y1=Xh;function X1(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?Yh([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):kl(e,0)>>2;return r?i/100:i}function oA(t,e){e==null&&(e=ye(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function lA(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function HR(t,e){return e||(e=ye(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var cc=lA,Du=HR;function ii(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Yl(t,e){return(e||ye(8)).write_shift(8,t,"f")}function $R(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var u=Ol[i];u&&(e.rgb=df(u));break;case 2:e.rgb=df([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function qh(t,e){if(e||(e=ye(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function GR(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function KR(t,e){e||(e=ye(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function cA(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function YR(t){return cA(t,1)}function XR(t){return cA(t,2)}var q1=2,Di=3,b0=11,c2=12,Qh=19,I0=64,qR=65,QR=71,JR=4108,ZR=4126,Sn=80,uA=81,eD=[Sn,uA],ix={1:{n:"CodePage",t:q1},2:{n:"Category",t:Sn},3:{n:"PresentationFormat",t:Sn},4:{n:"ByteCount",t:Di},5:{n:"LineCount",t:Di},6:{n:"ParagraphCount",t:Di},7:{n:"SlideCount",t:Di},8:{n:"NoteCount",t:Di},9:{n:"HiddenCount",t:Di},10:{n:"MultimediaClipCount",t:Di},11:{n:"ScaleCrop",t:b0},12:{n:"HeadingPairs",t:JR},13:{n:"TitlesOfParts",t:ZR},14:{n:"Manager",t:Sn},15:{n:"Company",t:Sn},16:{n:"LinksUpToDate",t:b0},17:{n:"CharacterCount",t:Di},19:{n:"SharedDoc",t:b0},22:{n:"HyperlinksChanged",t:b0},23:{n:"AppVersion",t:Di,p:"version"},24:{n:"DigSig",t:qR},26:{n:"ContentType",t:Sn},27:{n:"ContentStatus",t:Sn},28:{n:"Language",t:Sn},29:{n:"Version",t:Sn},255:{},2147483648:{n:"Locale",t:Qh},2147483651:{n:"Behavior",t:Qh},1919054434:{}},sx={1:{n:"CodePage",t:q1},2:{n:"Title",t:Sn},3:{n:"Subject",t:Sn},4:{n:"Author",t:Sn},5:{n:"Keywords",t:Sn},6:{n:"Comments",t:Sn},7:{n:"Template",t:Sn},8:{n:"LastAuthor",t:Sn},9:{n:"RevNumber",t:Sn},10:{n:"EditTime",t:I0},11:{n:"LastPrinted",t:I0},12:{n:"CreatedDate",t:I0},13:{n:"ModifiedDate",t:I0},14:{n:"PageCount",t:Di},15:{n:"WordCount",t:Di},16:{n:"CharCount",t:Di},17:{n:"Thumbnail",t:QR},18:{n:"Application",t:Sn},19:{n:"DocSecurity",t:Di},255:{},2147483648:{n:"Locale",t:Qh},2147483651:{n:"Behavior",t:Qh},1919054434:{}},u2={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},tD=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function rD(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var nD=rD([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ol=vr(nD),io={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},dA={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ax={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},N0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Q1(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function iD(t){var e=Q1();if(!t||!t.match)return e;var r={};if((t.match(ci)||[]).forEach(function(n){var i=ht(n);switch(i[0].replace(pR,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[ax[i.ContentType]]!==void 0&&e[ax[i.ContentType]].push(i.PartName);break}}),e.xmlns!==fn.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function fA(t,e){var r=iR(ax),n=[],i;n[n.length]=$r,n[n.length]=We("Types",null,{xmlns:fn.CT,"xmlns:xsd":fn.xsd,"xmlns:xsi":fn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return We("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],n[n.length]=We("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:N0[l][e.bookType]||N0[l].xlsx}))},a=function(l){(t[l]||[]).forEach(function(u){n[n.length]=We("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:N0[l][e.bookType]||N0[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(u){n[n.length]=We("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var bt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function uf(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Id(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(ci)||[]).forEach(function(i){var s=ht(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:hd(s.Target,e);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}function tu(t){var e=[$r,We("Relationships",null,{xmlns:fn.RELS})];return Br(t["!id"]).forEach(function(r){e[e.length]=We("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function er(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[bt.HLINK,bt.XPATH,bt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var sD="application/vnd.oasis.opendocument.spreadsheet";function aD(t,e){for(var r=U1(t),n,i;n=cf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=ht(n[0],!1),i.path=="/"&&i.type!==sD)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function oD(t){var e=[$r];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function d2(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function lD(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function cD(t){var e=[$r];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(d2(t[r][0],t[r][1])),e.push(lD("",t[r][0]));return e.push(d2("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function hA(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Wh.version+"</meta:generator></office:meta></office:document-meta>"}var Ss=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],uD=function(){for(var t=new Array(Ss.length),e=0;e<Ss.length;++e){var r=Ss[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function pA(t){var e={};t=or(t);for(var r=0;r<Ss.length;++r){var n=Ss[r],i=t.match(uD[r]);i!=null&&i.length>0&&(e[n[1]]=Ht(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=xr(e[n[1]]))}return e}function Pg(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=tr(e),n[n.length]=r?We(t,e,r):Mn(t,e))}function gA(t,e){var r=e||{},n=[$r,We("cp:coreProperties",null,{"xmlns:cp":fn.CORE_PROPS,"xmlns:dc":fn.dc,"xmlns:dcterms":fn.dcterms,"xmlns:dcmitype":fn.dcmitype,"xmlns:xsi":fn.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&Pg("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:rx(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&Pg("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:rx(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Ss.length;++s){var a=Ss[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Pg(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ml=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],mA=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function xA(t,e,r,n){var i=[];if(typeof t=="string")i=t2(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(f){return{v:f}}));var a=typeof e=="string"?t2(e,n).map(function(f){return f.v}):e,o=0,l=0;if(a.length>0)for(var u=0;u!==i.length;u+=2){switch(l=+i[u+1].v,i[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function dD(t,e,r){var n={};return e||(e={}),t=or(t),Ml.forEach(function(i){var s=(t.match(of(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=Ht(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&xA(n.HeadingPairs,n.TitlesOfParts,e,r),e}function vA(t){var e=[],r=We;return t||(t={}),t.Application="SheetJS",e[e.length]=$r,e[e.length]=We("Properties",null,{xmlns:fn.EXT_PROPS,"xmlns:vt":fn.vt}),Ml.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=tr(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+tr(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var fD=/<[^>]+>[^<]*/g;function hD(t,e){var r={},n="",i=t.match(fD);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=ht(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ht(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),u=l[0].slice(4),f=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=Ht(f);break;case"bool":r[n]=gr(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=xr(f);break;case"cy":case"error":r[n]=Ht(f);break;default:if(u.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,u,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}function yA(t){var e=[$r,We("Properties",null,{xmlns:fn.CUST_PROPS,"xmlns:vt":fn.vt})];if(!t)return e.join("");var r=1;return Br(t).forEach(function(i){++r,e[e.length]=We("property",wR(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:tr(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var ox={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Og;function pD(t,e,r){Og||(Og=Bp(ox)),e=Og[e]||e,t[e]=r}function gD(t,e){var r=[];return Br(ox).map(function(n){for(var i=0;i<Ss.length;++i)if(Ss[i][1]==n)return Ss[i];for(i=0;i<Ml.length;++i)if(Ml[i][1]==n)return Ml[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Mn(ox[n[1]]||n[1],i))}}),We("DocumentProperties",r.join(""),{xmlns:$i.o})}function mD(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&Br(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<Ss.length;++a)if(s==Ss[a][1])return;for(a=0;a<Ml.length;++a)if(s==Ml[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(We(Q_(s),o,{"dt:dt":l}))}}),e&&Br(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(We(Q_(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+$i.o+'">'+i.join("")+"</"+n+">"}function J1(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function xD(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=ye(8);return a.write_shift(4,n),a.write_shift(4,i),a}function _A(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function EA(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function wA(t,e,r){return e===31?EA(t):_A(t,e,r)}function lx(t,e,r){return wA(t,e,r===!1?0:4)}function vD(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return wA(t,e,0)}function yD(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(yi,""),t.l-i&2&&(t.l+=2)}return r}function _D(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(yi,"");return r}function ED(t){var e=t.l,r=Jh(t,uA);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Jh(t,Di);return[r,n]}function wD(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(ED(t));return r}function f2(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),a=t.read_shift(4);n[s]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(yi,"").replace(fd,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function SA(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function SD(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Jh(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==c2&&n!==e&&eD.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===c2?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return _A(t,n,4).replace(yi,"");case 31:return EA(t);case 64:return J1(t);case 65:return SA(t);case 71:return SD(t);case 80:return lx(t,n,!s.raw).replace(yi,"");case 81:return vD(t,n).replace(yi,"");case 4108:return wD(t);case 4126:case 4127:return n==4127?yD(t):_D(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function h2(t,e){var r=ye(4),n=ye(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=ye(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=xD(e);break;case 31:case 80:for(n=ye(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return kn([r,n])}function p2(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0,o=0,l=-1,u={};for(a=0;a!=i;++a){var f=t.read_shift(4),p=t.read_shift(4);s[a]=[f,p+r]}s.sort(function(k,_){return k[1]-_[1]});var g={};for(a=0;a!=i;++a){if(t.l!==s[a][1]){var m=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:t.l+2===s[a][1]&&(t.l+=2,m=!1);break;case 80:t.l<=s[a][1]&&(t.l=s[a][1],m=!1);break;case 4108:t.l<=s[a][1]&&(t.l=s[a][1],m=!1);break}if((!e||a==0)&&t.l<=s[a][1]&&(m=!1,t.l=s[a][1]),m)throw new Error("Read Error: Expected address "+s[a][1]+" at "+t.l+" :"+a)}if(e){var y=e[s[a][0]];if(g[y.n]=Jh(t,y.t,{raw:!0}),y.p==="version"&&(g[y.n]=String(g[y.n]>>16)+"."+("0000"+String(g[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(g[y.n]){case 0:g[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ws(o=g[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[y.n])}}else if(s[a][0]===1){if(o=g.CodePage=Jh(t,q1),Ws(o),l!==-1){var x=t.l;t.l=s[l][1],u=f2(t,o),t.l=x}}else if(s[a][0]===0){if(o===0){l=a,t.l=s[a+1][1];continue}u=f2(t,o)}else{var w=u[s[a][0]],A;switch(t[t.l]){case 65:t.l+=4,A=SA(t);break;case 30:t.l+=4,A=lx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,A=lx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,A=t.read_shift(4,"i");break;case 19:t.l+=4,A=t.read_shift(4);break;case 5:t.l+=4,A=t.read_shift(8,"f");break;case 11:t.l+=4,A=Ur(t,4);break;case 64:t.l+=4,A=xr(J1(t));break;default:throw new Error("unparsed value: "+t[t.l])}g[w]=A}}return t.l=r+n,g}var TA=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function TD(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function g2(t,e,r){var n=ye(8),i=[],s=[],a=8,o=0,l=ye(8),u=ye(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),s.push(l),i.push(u),a+=8+l.length,!e){u=ye(8),u.write_shift(4,0),i.unshift(u);var f=[ye(4)];for(f[0].write_shift(4,t.length),o=0;o<t.length;++o){var p=t[o][0];for(l=ye(8+2*(p.length+1)+(p.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,p.length+1),l.write_shift(0,p,"dbcs");l.l!=l.length;)l.write_shift(1,0);f.push(l)}l=kn(f),s.unshift(l),a+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(TA.indexOf(t[o][0])>-1||mA.indexOf(t[o][0])>-1)&&t[o][1]!=null){var g=t[o][1],m=0;if(e){m=+e[t[o][0]];var y=r[m];if(y.p=="version"&&typeof g=="string"){var x=g.split(".");g=(+x[0]<<16)+(+x[1]||0)}l=h2(y.t,g)}else{var w=TD(g);w==-1&&(w=31,g=String(g)),l=h2(w,g)}s.push(l),u=ye(8),u.write_shift(4,e?m:2+o),i.push(u),a+=8+l.length}var A=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,A),A+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),kn([n].concat(i).concat(s))}function m2(t,e,r){var n=t.content;if(!n)return{};On(n,0);var i,s,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),f=n.read_shift(16);if(f!==nt.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),l=n.read_shift(4));var p=p2(n,e),g={SystemIdentifier:u};for(var m in p)g[m]=p[m];if(g.FMTID=s,i===1)return g;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var y;try{y=p2(n,null)}catch{}for(m in y)g[m]=y[m];return g.FMTID=[s,a],g}function x2(t,e,r,n,i,s){var a=ye(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,nt.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=g2(t,r,n);if(o.push(l),i){var u=g2(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(u)}return kn(o)}function _o(t,e){return t.read_shift(e),null}function AD(t,e){e||(e=ye(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function kD(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function Ur(t,e){return t.read_shift(e)===1}function xi(t,e){return e||(e=ye(2)),e.write_shift(2,+!!t),e}function Jr(t){return t.read_shift(2,"u")}function xs(t,e){return e||(e=ye(2)),e.write_shift(2,t),e}function AA(t,e){return kD(t,e,Jr)}function CD(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function kA(t,e,r){return r||(r=ye(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Of(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return a}function FD(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,s=1+(r&1),a=0,o,l={};i&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",f=e===0?"":t.read_shift(e,u);return i&&(t.l+=4*a),n&&(t.l+=o),l.t=f,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function bD(t){var e=t.t||"",r=ye(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=ye(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return kn(i)}function Xl(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Mf(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Xl(t,n,r)}function uc(t,e,r){if(r.biff>5)return Mf(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function CA(t,e,r){return r||(r=ye(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function ID(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function ND(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(yi,"");return n&&(t.l+=24),i}function RD(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(s>>1,"utf16le").replace(yi,"");return r+a}function DD(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return ND(t);case"0303000000000000c000000000000046":return RD(t);default:throw new Error("Unsupported Moniker "+r)}}function R0(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(yi,""):"";return r}function v2(t,e){e||(e=ye(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function PD(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,a,o,l,u="",f,p;i&16&&(s=R0(t,r-t.l)),i&128&&(a=R0(t,r-t.l)),(i&257)===257&&(o=R0(t,r-t.l)),(i&257)===1&&(l=DD(t,r-t.l)),i&8&&(u=R0(t,r-t.l)),i&32&&(f=t.read_shift(16)),i&64&&(p=J1(t)),t.l=r;var g=a||o||l||"";g&&u&&(g+="#"+u),g||(g="#"+u),i&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var m={Target:g};return f&&(m.guid=f),p&&(m.time=p),s&&(m.Tooltip=s),m}function OD(t){var e=ye(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),v2(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&v2(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function FA(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function bA(t,e){var r=FA(t);return r[3]=0,r}function ya(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function ql(t,e,r,n){return n||(n=ye(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function MD(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function BD(t,e,r){return e===0?"":uc(t,e,r)}function LD(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function IA(t){var e=t.read_shift(2),r=X1(t);return[e,r]}function jD(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=Of(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function Vp(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function NA(t,e){return e||(e=ye(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function RA(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var VD=RA;function DA(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function UD(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function zD(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function qn(t){t.l+=2,t.l+=t.read_shift(2)}var WD={0:qn,4:qn,5:qn,6:qn,7:zD,8:qn,9:qn,10:qn,11:qn,12:qn,13:UD,14:qn,15:qn,16:qn,17:qn,18:qn,19:qn,20:qn,21:DA};function HD(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(WD[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function D0(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function Z1(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ye(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function $D(t,e){return e===0||t.read_shift(2),1200}function GD(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=uc(t,0,r);return t.read_shift(e+n-t.l),i}function KD(t,e){var r=!e||e.biff==8,n=ye(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function YD(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function XD(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=Of(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function qD(t,e){var r=!e||e.biff>=8?2:1,n=ye(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function QD(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0;a!=i&&t.l<r;++a)s.push(FD(t));return s.Count=n,s.Unique=i,s}function JD(t,e){var r=ye(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=bD(t[i]);var s=kn([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function ZD(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function e3(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function t3(t){var e=MD(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function r3(t){return t.read_shift(2),t.read_shift(4)}function y2(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function n3(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),u=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:u}}function i3(){var t=ye(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function s3(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function a3(t){var e=ye(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function o3(){}function l3(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Of(t,0,r),n}function c3(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=ye(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function u3(t){var e=ya(t);return e.isst=t.read_shift(4),e}function d3(t,e,r,n){var i=ye(10);return ql(t,e,n,i),i.write_shift(4,r),i}function f3(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=ya(t);r.biff==2&&t.l++;var s=Mf(t,n-t.l,r);return i.val=s,i}function h3(t,e,r,n,i){var s=!i||i.biff==8,a=ye(8+ +s+(1+s)*r.length);return ql(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function p3(t,e,r){var n=t.read_shift(2),i=uc(t,0,r);return[n,i]}function g3(t,e,r,n){var i=r&&r.biff==5;n||(n=ye(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var m3=uc;function _2(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),a=t.read_shift(i),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:s,c:o},e:{r:a,c:l}}}function x3(t,e){var r=e.biff==8||!e.biff?4:2,n=ye(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function v3(t){var e=t.read_shift(2),r=t.read_shift(2),n=IA(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function y3(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(IA(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function _3(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function E3(t,e,r,n){var i={},s=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return i.patternType=tD[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function w3(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=E3(t,e,n.fStyle,r),n}function E2(t,e,r,n){var i=r&&r.biff==5;n||(n=ye(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function S3(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function T3(t){var e=ye(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function w2(t,e,r){var n=ya(t);(r.biff==2||e==9)&&++t.l;var i=CD(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function A3(t,e,r,n,i,s){var a=ye(8);return ql(t,e,n,a),kA(r,s,a),a}function k3(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ya(t),i=ii(t);return n.val=i,n}function C3(t,e,r,n){var i=ye(14);return ql(t,e,n,i),Yl(r,i),i}var S2=BD;function F3(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=Xl(t,s),o=[];n>t.l;)o.push(Mf(t));return[s,i,a,o]}function T2(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=jD(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var b3=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function A2(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var u=Xl(t,a,r);i&32&&(u=b3[u.charCodeAt(0)]);var f=n-t.l;r&&r.biff==2&&--f;var p=n==t.l||o===0||!(f>0)?[]:H5(t,f,r,o);return{chKey:s,Name:u,itab:l,rgce:p}}function PA(t,e,r){if(r.biff<8)return I3(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(LD(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function I3(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Of(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function N3(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=Xl(t,n,r),a=Xl(t,i,r);return[s,a]}function R3(t,e,r){var n=RA(t);t.l++;var i=t.read_shift(1);return e-=8,[$5(t,e,r),i,n]}function k2(t,e,r){var n=VD(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,z5(t,e,r)]}function D3(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function P3(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=uc(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},o,a,s]}}function O3(t,e,r){return P3(t,e,r)}function M3(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Vp(t));return r}function B3(t){var e=ye(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)NA(t[r],e);return e}function L3(t,e,r){if(r&&r.biff<8)return V3(t,e,r);var n=DA(t),i=HD(t,e-22,n[1]);return{cmo:n,ft:i}}var j3={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function V3(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((j3[n]||oi)(t,e,r)),{cmo:[i,n,s],ft:a}}function U3(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:a=ID(t,6,r);var o=t.read_shift(2);t.read_shift(2),Jr(t,2);var l=t.read_shift(2);t.l+=l;for(var u=1;u<t.lens.length-1;++u){if(t.l-n!=t.lens[u])throw new Error("TxO: bad continue record");var f=t[t.l],p=Xl(t,t.lens[u+1]-t.lens[u]-1);if(i+=p,i.length>=(f?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function z3(t,e){var r=Vp(t);t.l+=16;var n=PD(t,e-24);return[r,n]}function W3(t){var e=ye(24),r=Fr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return kn([e,OD(t[1])])}function H3(t,e){t.read_shift(2);var r=Vp(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(yi,""),[r,n]}function $3(t){var e=t[1].Tooltip,r=ye(10+2*(e.length+1));r.write_shift(2,2048);var n=Fr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function G3(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=u2[r]||r,r=t.read_shift(2),e[1]=u2[r]||r,e}function K3(t){return t||(t=ye(4)),t.write_shift(2,1),t.write_shift(2,1),t}function Y3(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(bA(t));return r}function X3(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(bA(t));return r}function q3(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function OA(t,e,r){if(!r.cellStyles)return oi(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var u={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function Q3(t,e){var r=ye(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function J3(t,e){var r={};return e<32||(t.l+=16,r.header=ii(t),r.footer=ii(t),t.l+=2),r}function Z3(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}function e6(t){for(var e=ye(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var t6=ya,r6=AA,n6=Mf;function i6(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function s6(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ya(t);++t.l;var i=uc(t,e-7,r);return n.t="str",n.val=i,n}function a6(t){var e=ya(t);++t.l;var r=ii(t);return e.t="n",e.val=r,e}function o6(t,e,r){var n=ye(15);return Vf(n,t,e),n.write_shift(8,r,"f"),n}function l6(t){var e=ya(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function c6(t,e,r){var n=ye(9);return Vf(n,t,e),n.write_shift(2,r),n}function u6(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function d6(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function f6(t,e,r){var n=t.l+e,i=ya(t),s=t.read_shift(2),a=Xl(t,s,r);return t.l=n,i.t="str",i.val=a,i}var h6=[2,3,48,49,131,139,140,245],cx=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Bp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],f=Jo(1);switch(l.type){case"base64":f=Ki(Zi(o));break;case"binary":f=Ki(o);break;case"buffer":case"array":f=o;break}On(f,0);var p=f.read_shift(1),g=!!(p&136),m=!1,y=!1;switch(p){case 2:break;case 3:break;case 48:m=!0,g=!0;break;case 49:m=!0,g=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var x=0,w=521;p==2&&(x=f.read_shift(2)),f.l+=3,p!=2&&(x=f.read_shift(4)),x>1048576&&(x=1e6),p!=2&&(w=f.read_shift(2));var A=f.read_shift(2),k=l.codepage||1252;p!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(k=t[f[f.l]]),f.l+=1,f.l+=2),y&&(f.l+=36);for(var _=[],O={},G=Math.min(f.length,p==2?521:w-10-(m?264:0)),U=y?32:11;f.l<G&&f[f.l]!=13;)switch(O={},O.name=nf.utils.decode(k,f.slice(f.l,f.l+U)).replace(/[\u0000\r\n].*$/g,""),f.l+=U,O.type=String.fromCharCode(f.read_shift(1)),p!=2&&!y&&(O.offset=f.read_shift(4)),O.len=f.read_shift(1),p==2&&(O.offset=f.read_shift(2)),O.dec=f.read_shift(1),O.name.length&&_.push(O),p!=2&&(f.l+=y?13:14),O.type){case"B":(!m||O.len!=8)&&l.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+O.type)}if(f[f.l]!==13&&(f.l=w-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=w;var T=0,F=0;for(u[0]=[],F=0;F!=_.length;++F)u[0][F]=_[F].name;for(;x-- >0;){if(f[f.l]===42){f.l+=A;continue}for(++f.l,u[++T]=[],F=0,F=0;F!=_.length;++F){var S=f.slice(f.l,f.l+_[F].len);f.l+=_[F].len,On(S,0);var I=nf.utils.decode(k,S);switch(_[F].type){case"C":I.trim().length&&(u[T][F]=I.replace(/\s+$/,""));break;case"D":I.length===8?u[T][F]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):u[T][F]=I;break;case"F":u[T][F]=parseFloat(I.trim());break;case"+":case"I":u[T][F]=y?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":u[T][F]=!0;break;case"N":case"F":u[T][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));u[T][F]="##MEMO##"+(y?parseInt(I.trim(),10):S.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(u[T][F]=+I||0);break;case"@":u[T][F]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":u[T][F]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":u[T][F]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[T][F]=-S.read_shift(-8,"f");break;case"B":if(m&&_[F].len==8){u[T][F]=S.read_shift(8,"f");break}case"G":case"P":S.l+=_[F].len;break;case"0":if(_[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[F].type)}}}if(p!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=_,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var f=Ru(r(o,u),u);return f["!cols"]=u.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete u.DBF,f}function i(o,l){try{return cl(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var u=l||{};if(+u.codepage>=0&&Ws(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=ji(),p=tp(o,{header:1,raw:!0,cellDates:!0}),g=p[0],m=p.slice(1),y=o["!cols"]||[],x=0,w=0,A=0,k=1;for(x=0;x<g.length;++x){if(((y[x]||{}).DBF||{}).name){g[x]=y[x].DBF.name,++A;continue}if(g[x]!=null){if(++A,typeof g[x]=="number"&&(g[x]=g[x].toString(10)),typeof g[x]!="string")throw new Error("DBF Invalid column name "+g[x]+" |"+typeof g[x]+"|");if(g.indexOf(g[x])!==x){for(w=0;w<1024;++w)if(g.indexOf(g[x]+"_"+w)==-1){g[x]+="_"+w;break}}}}var _=$t(o["!ref"]),O=[],G=[],U=[];for(x=0;x<=_.e.c-_.s.c;++x){var T="",F="",S=0,I=[];for(w=0;w<m.length;++w)m[w][x]!=null&&I.push(m[w][x]);if(I.length==0||g[x]==null){O[x]="?";continue}for(w=0;w<I.length;++w){switch(typeof I[w]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=I[w]instanceof Date?"D":"C";break;default:F="C"}S=Math.max(S,String(I[w]).length),T=T&&T!=F?"C":F}S>250&&(S=250),F=((y[x]||{}).DBF||{}).type,F=="C"&&y[x].DBF.len>S&&(S=y[x].DBF.len),T=="B"&&F=="N"&&(T="N",U[x]=y[x].DBF.dec,S=y[x].DBF.len),G[x]=T=="C"||F=="N"?S:s[T]||0,k+=G[x],O[x]=T}var R=f.next(32);for(R.write_shift(4,318902576),R.write_shift(4,m.length),R.write_shift(2,296+32*A),R.write_shift(2,k),x=0;x<4;++x)R.write_shift(4,0);for(R.write_shift(4,0|(+e[TT]||3)<<8),x=0,w=0;x<g.length;++x)if(g[x]!=null){var D=f.next(32),N=(g[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,N,"sbcs"),D.write_shift(1,O[x]=="?"?"C":O[x],"sbcs"),D.write_shift(4,w),D.write_shift(1,G[x]||s[O[x]]||0),D.write_shift(1,U[x]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),w+=G[x]||s[O[x]]||0}var Ge=f.next(264);for(Ge.write_shift(4,13),x=0;x<65;++x)Ge.write_shift(4,0);for(x=0;x<m.length;++x){var _e=f.next(k);for(_e.write_shift(1,0),w=0;w<g.length;++w)if(g[w]!=null)switch(O[w]){case"L":_e.write_shift(1,m[x][w]==null?63:m[x][w]?84:70);break;case"B":_e.write_shift(8,m[x][w]||0,"f");break;case"N":var Re="0";for(typeof m[x][w]=="number"&&(Re=m[x][w].toFixed(U[w]||0)),A=0;A<G[w]-Re.length;++A)_e.write_shift(1,32);_e.write_shift(1,Re,"sbcs");break;case"D":m[x][w]?(_e.write_shift(4,("0000"+m[x][w].getFullYear()).slice(-4),"sbcs"),_e.write_shift(2,("00"+(m[x][w].getMonth()+1)).slice(-2),"sbcs"),_e.write_shift(2,("00"+m[x][w].getDate()).slice(-2),"sbcs")):_e.write_shift(8,"00000000","sbcs");break;case"C":var Me=String(m[x][w]!=null?m[x][w]:"").slice(0,G[w]);for(_e.write_shift(1,Me,"sbcs"),A=0;A<G[w]-Me.length;++A)_e.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),MA=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Br(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(g,m){var y=t[m];return typeof y=="number"?B_(y):y},n=function(g,m,y){var x=m.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return x==59?g:B_(x)};t["|"]=254;function i(g,m){switch(m.type){case"base64":return s(Zi(g),m);case"binary":return s(g,m);case"buffer":return s(kt&&Buffer.isBuffer(g)?g.toString("binary"):ll(g),m);case"array":return s(Kl(g),m)}throw new Error("Unrecognized type "+m.type)}function s(g,m){var y=g.split(/[\n\r]+/),x=-1,w=-1,A=0,k=0,_=[],O=[],G=null,U={},T=[],F=[],S=[],I=0,R;for(+m.codepage>=0&&Ws(+m.codepage);A!==y.length;++A){I=0;var D=y[A].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),N=D.replace(/;;/g,"\0").split(";").map(function(Y){return Y.replace(/\u0000/g,";")}),Ge=N[0],_e;if(D.length>0)switch(Ge){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":N[1].charAt(0)=="P"&&O.push(D.slice(3).replace(/;;/g,";"));break;case"C":var Re=!1,Me=!1,Se=!1,te=!1,Ce=-1,je=-1;for(k=1;k<N.length;++k)switch(N[k].charAt(0)){case"A":break;case"X":w=parseInt(N[k].slice(1))-1,Me=!0;break;case"Y":for(x=parseInt(N[k].slice(1))-1,Me||(w=0),R=_.length;R<=x;++R)_[R]=[];break;case"K":_e=N[k].slice(1),_e.charAt(0)==='"'?_e=_e.slice(1,_e.length-1):_e==="TRUE"?_e=!0:_e==="FALSE"?_e=!1:isNaN(Ys(_e))?isNaN(gu(_e).getDate())||(_e=xr(_e)):(_e=Ys(_e),G!==null&&Iu(G)&&(_e=jp(_e))),Re=!0;break;case"E":te=!0;var W=ru(N[k].slice(1),{r:x,c:w});_[x][w]=[_[x][w],W];break;case"S":Se=!0,_[x][w]=[_[x][w],"S5S"];break;case"G":break;case"R":Ce=parseInt(N[k].slice(1))-1;break;case"C":je=parseInt(N[k].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}if(Re&&(_[x][w]&&_[x][w].length==2?_[x][w][0]=_e:_[x][w]=_e,G=null),Se){if(te)throw new Error("SYLK shared formula cannot have own formula");var re=Ce>-1&&_[Ce][je];if(!re||!re[1])throw new Error("SYLK shared formula cannot find base");_[x][w][1]=ek(re[1],{r:x-Ce,c:w-je})}break;case"F":var ee=0;for(k=1;k<N.length;++k)switch(N[k].charAt(0)){case"X":w=parseInt(N[k].slice(1))-1,++ee;break;case"Y":for(x=parseInt(N[k].slice(1))-1,R=_.length;R<=x;++R)_[R]=[];break;case"M":I=parseInt(N[k].slice(1))/20;break;case"F":break;case"G":break;case"P":G=O[parseInt(N[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=N[k].slice(1).split(" "),R=parseInt(S[0],10);R<=parseInt(S[1],10);++R)I=parseInt(S[2],10),F[R-1]=I===0?{hidden:!0}:{wch:I},Zo(F[R-1]);break;case"C":w=parseInt(N[k].slice(1))-1,F[w]||(F[w]={});break;case"R":x=parseInt(N[k].slice(1))-1,T[x]||(T[x]={}),I>0?(T[x].hpt=I,T[x].hpx=xu(I)):I===0&&(T[x].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}ee<1&&(G=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}}return T.length>0&&(U["!rows"]=T),F.length>0&&(U["!cols"]=F),m&&m.sheetRows&&(_=_.slice(0,m.sheetRows)),[_,U]}function a(g,m){var y=i(g,m),x=y[0],w=y[1],A=Ru(x,m);return Br(w).forEach(function(k){A[k]=w[k]}),A}function o(g,m){return cl(a(g,m),m)}function l(g,m,y,x){var w="C;Y"+(y+1)+";X"+(x+1)+";K";switch(g.t){case"n":w+=g.v||0,g.f&&!g.F&&(w+=";E"+sv(g.f,{r:y,c:x}));break;case"b":w+=g.v?"TRUE":"FALSE";break;case"e":w+=g.w||g.v;break;case"d":w+='"'+(g.w||g.v)+'"';break;case"s":w+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function u(g,m){m.forEach(function(y,x){var w="F;W"+(x+1)+" "+(x+1)+" ";y.hidden?w+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=ff(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=hf(y.wpx)),typeof y.wch=="number"&&(w+=Math.round(y.wch))),w.charAt(w.length-1)!=" "&&g.push(w)})}function f(g,m){m.forEach(function(y,x){var w="F;";y.hidden?w+="M0;":y.hpt?w+="M"+20*y.hpt+";":y.hpx&&(w+="M"+20*pf(y.hpx)+";"),w.length>2&&g.push(w+"R"+(x+1))})}function p(g,m){var y=["ID;PWXL;N;E"],x=[],w=$t(g["!ref"]),A,k=Array.isArray(g),_=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),g["!cols"]&&u(y,g["!cols"]),g["!rows"]&&f(y,g["!rows"]),y.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var O=w.s.r;O<=w.e.r;++O)for(var G=w.s.c;G<=w.e.c;++G){var U=ft({r:O,c:G});A=k?(g[O]||[])[G]:g[U],!(!A||A.v==null&&(!A.f||A.F))&&x.push(l(A,g,O,G))}return y.join(_)+_+x.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:a,from_sheet:p}}(),BA=function(){function t(s,a){switch(a.type){case"base64":return e(Zi(s),a);case"binary":return e(s,a);case"buffer":return e(kt&&Buffer.isBuffer(s)?s.toString("binary"):ll(s),a);case"array":return e(Kl(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,u=-1,f=0,p=[];f!==o.length;++f){if(o[f].trim()==="BOT"){p[++l]=[],u=0;continue}if(!(l<0)){var g=o[f].trim().split(","),m=g[0],y=g[1];++f;for(var x=o[f]||"";(x.match(/["]/g)||[]).length&1&&f<o.length-1;)x+=`
`+o[++f];switch(x=x.trim(),+m){case-1:if(x==="BOT"){p[++l]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?p[l][u]=!0:x==="FALSE"?p[l][u]=!1:isNaN(Ys(y))?isNaN(gu(y).getDate())?p[l][u]=y:p[l][u]=xr(y):p[l][u]=Ys(y),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),p[l][u++]=x!==""?x:null;break}if(x==="EOD")break}}return a&&a.sheetRows&&(p=p.slice(0,a.sheetRows)),p}function r(s,a){return Ru(t(s,a),a)}function n(s,a){return cl(r(s,a),a)}var i=function(){var s=function(l,u,f,p,g){l.push(u),l.push(f+","+p),l.push('"'+g.replace(/"/g,'""')+'"')},a=function(l,u,f,p){l.push(u+","+f),l.push(u==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(l){var u=[],f=$t(l["!ref"]),p,g=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,f.e.r-f.s.r+1,""),s(u,"TUPLES",0,f.e.c-f.s.c+1,""),s(u,"DATA",0,0,"");for(var m=f.s.r;m<=f.e.r;++m){a(u,-1,0,"BOT");for(var y=f.s.c;y<=f.e.c;++y){var x=ft({r:m,c:y});if(p=g?(l[m]||[])[y]:l[x],!p){a(u,1,0,"");continue}switch(p.t){case"n":var w=p.w;!w&&p.v!=null&&(w=p.v),w==null?p.f&&!p.F?a(u,1,0,"="+p.f):a(u,1,0,""):a(u,0,w,"V");break;case"b":a(u,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":a(u,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=ks(p.z||ut[14],mn(xr(p.v)))),a(u,0,p.w,"V");break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var A=`\r
`,k=u.join(A);return k}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),LA=function(){function t(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,g){for(var m=p.split(`
`),y=-1,x=-1,w=0,A=[];w!==m.length;++w){var k=m[w].trim().split(":");if(k[0]==="cell"){var _=Fr(k[1]);if(A.length<=_.r)for(y=A.length;y<=_.r;++y)A[y]||(A[y]=[]);switch(y=_.r,x=_.c,k[2]){case"t":A[y][x]=t(k[3]);break;case"v":A[y][x]=+k[3];break;case"vtf":var O=k[k.length-1];case"vtc":switch(k[3]){case"nl":A[y][x]=!!+k[4];break;default:A[y][x]=+k[4];break}k[2]=="vtf"&&(A[y][x]=[A[y][x],O])}}}return g&&g.sheetRows&&(A=A.slice(0,g.sheetRows)),A}function n(p,g){return Ru(r(p,g),g)}function i(p,g){return cl(n(p,g),g)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(p){if(!p||!p["!ref"])return"";for(var g=[],m=[],y,x="",w=Vi(p["!ref"]),A=Array.isArray(p),k=w.s.r;k<=w.e.r;++k)for(var _=w.s.c;_<=w.e.c;++_)if(x=ft({r:k,c:_}),y=A?(p[k]||[])[_]:p[x],!(!y||y.v==null||y.t==="z")){switch(m=["cell",x,"t"],y.t){case"s":case"str":m.push(e(y.v));break;case"n":y.f?(m[2]="vtf",m[3]="n",m[4]=y.v,m[5]=e(y.f)):(m[2]="v",m[3]=y.v);break;case"b":m[2]="vt"+(y.f?"f":"c"),m[3]="nl",m[4]=y.v?"1":"0",m[5]=e(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var O=mn(xr(y.v));m[2]="vtc",m[3]="nd",m[4]=""+O,m[5]=y.w||ks(y.z||ut[14],O);break;case"e":continue}g.push(m.join(":"))}return g.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function f(p){return[s,a,o,a,u(p),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),mu=function(){function t(f,p,g,m,y){y.raw?p[g][m]=f:f===""||(f==="TRUE"?p[g][m]=!0:f==="FALSE"?p[g][m]=!1:isNaN(Ys(f))?isNaN(gu(f).getDate())?p[g][m]=f:p[g][m]=xr(f):p[g][m]=Ys(f))}function e(f,p){var g=p||{},m=[];if(!f||f.length===0)return m;for(var y=f.split(/[\r\n]/),x=y.length-1;x>=0&&y[x].length===0;)--x;for(var w=10,A=0,k=0;k<=x;++k)A=y[k].indexOf(" "),A==-1?A=y[k].length:A++,w=Math.max(w,A);for(k=0;k<=x;++k){m[k]=[];var _=0;for(t(y[k].slice(0,w).trim(),m,k,_,g),_=1;_<=(y[k].length-w)/10+1;++_)t(y[k].slice(w+(_-1)*10,w+_*10).trim(),m,k,_,g)}return g.sheetRows&&(m=m.slice(0,g.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var p={},g=!1,m=0,y=0;m<f.length;++m)(y=f.charCodeAt(m))==34?g=!g:!g&&y in r&&(p[y]=(p[y]||0)+1);y=[];for(m in p)Object.prototype.hasOwnProperty.call(p,m)&&y.push([p[m],m]);if(!y.length){p=n;for(m in p)Object.prototype.hasOwnProperty.call(p,m)&&y.push([p[m],m])}return y.sort(function(x,w){return x[0]-w[0]||n[x[1]]-n[w[1]]}),r[y.pop()[1]]||44}function s(f,p){var g=p||{},m="",y=g.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(m=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(m=f.charAt(4),f=f.slice(6)):m=i(f.slice(0,1024)):g&&g.FS?m=g.FS:m=i(f.slice(0,1024));var w=0,A=0,k=0,_=0,O=0,G=m.charCodeAt(0),U=!1,T=0,F=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var S=g.dateNF!=null?ZN(g.dateNF):null;function I(){var R=f.slice(_,O),D={};if(R.charAt(0)=='"'&&R.charAt(R.length-1)=='"'&&(R=R.slice(1,-1).replace(/""/g,'"')),R.length===0)D.t="z";else if(g.raw)D.t="s",D.v=R;else if(R.trim().length===0)D.t="s",D.v=R;else if(R.charCodeAt(0)==61)R.charCodeAt(1)==34&&R.charCodeAt(R.length-1)==34?(D.t="s",D.v=R.slice(2,-1).replace(/""/g,'"')):F8(R)?(D.t="n",D.f=R.slice(1)):(D.t="s",D.v=R);else if(R=="TRUE")D.t="b",D.v=!0;else if(R=="FALSE")D.t="b",D.v=!1;else if(!isNaN(k=Ys(R)))D.t="n",g.cellText!==!1&&(D.w=R),D.v=k;else if(!isNaN(gu(R).getDate())||S&&R.match(S)){D.z=g.dateNF||ut[14];var N=0;S&&R.match(S)&&(R=eR(R,g.dateNF,R.match(S)||[]),N=1),g.cellDates?(D.t="d",D.v=xr(R,N)):(D.t="n",D.v=mn(xr(R,N))),g.cellText!==!1&&(D.w=ks(D.z,D.v instanceof Date?mn(D.v):D.v)),g.cellNF||delete D.z}else D.t="s",D.v=R;if(D.t=="z"||(g.dense?(y[w]||(y[w]=[]),y[w][A]=D):y[ft({c:A,r:w})]=D),_=O+1,F=f.charCodeAt(_),x.e.c<A&&(x.e.c=A),x.e.r<w&&(x.e.r=w),T==G)++A;else if(A=0,++w,g.sheetRows&&g.sheetRows<=w)return!0}e:for(;O<f.length;++O)switch(T=f.charCodeAt(O)){case 34:F===34&&(U=!U);break;case G:case 10:case 13:if(!U&&I())break e;break}return O-_>0&&I(),y["!ref"]=St(x),y}function a(f,p){return!(p&&p.PRN)||p.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,p):Ru(e(f,p),p)}function o(f,p){var g="",m=p.type=="string"?[0,0,0,0]:hv(f,p);switch(p.type){case"base64":g=Zi(f);break;case"binary":g=f;break;case"buffer":p.codepage==65001?g=f.toString("utf8"):p.codepage&&typeof nf<"u"||(g=kt&&Buffer.isBuffer(f)?f.toString("binary"):ll(f));break;case"array":g=Kl(f);break;case"string":g=f;break;default:throw new Error("Unrecognized type "+p.type)}return m[0]==239&&m[1]==187&&m[2]==191?g=or(g.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?g=or(g):p.type=="binary"&&typeof nf<"u",g.slice(0,19)=="socialcalc:version:"?LA.to_sheet(p.type=="string"?g:or(g),p):a(g,p)}function l(f,p){return cl(o(f,p),p)}function u(f){for(var p=[],g=$t(f["!ref"]),m,y=Array.isArray(f),x=g.s.r;x<=g.e.r;++x){for(var w=[],A=g.s.c;A<=g.e.c;++A){var k=ft({r:x,c:A});if(m=y?(f[x]||[])[A]:f[k],!m||m.v==null){w.push("          ");continue}for(var _=(m.w||(Xa(m),m.w)||"").slice(0,10);_.length<10;)_+=" ";w.push(_+(A===0?" ":""))}p.push(w.join(""))}return p.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}();function p6(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=MA.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return mu.to_workbook(t,e)}}var Bl=function(){function t(W,re,ee){if(W){On(W,W.l||0);for(var Y=ee.Enum||Ce;W.l<W.length;){var xe=W.read_shift(2),Ee=Y[xe]||Y[65535],Le=W.read_shift(2),Fe=W.l+Le,Ae=Ee.f&&Ee.f(W,Le,ee);if(W.l=Fe,re(Ae,Ee,xe))return}}}function e(W,re){switch(re.type){case"base64":return r(Ki(Zi(W)),re);case"binary":return r(Ki(W),re);case"buffer":case"array":return r(W,re)}throw"Unsupported type "+re.type}function r(W,re){if(!W)return W;var ee=re||{},Y=ee.dense?[]:{},xe="Sheet1",Ee="",Le=0,Fe={},Ae=[],it=[],q={s:{r:0,c:0},e:{r:0,c:0}},Pt=ee.sheetRows||0;if(W[2]==0&&(W[3]==8||W[3]==9)&&W.length>=16&&W[14]==5&&W[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(W[2]==2)ee.Enum=Ce,t(W,function(Ke,ir,bn){switch(bn){case 0:ee.vers=Ke,Ke>=4096&&(ee.qpro=!0);break;case 6:q=Ke;break;case 204:Ke&&(Ee=Ke);break;case 222:Ee=Ke;break;case 15:case 51:ee.qpro||(Ke[1].v=Ke[1].v.slice(1));case 13:case 14:case 16:bn==14&&(Ke[2]&112)==112&&(Ke[2]&15)>1&&(Ke[2]&15)<15&&(Ke[1].z=ee.dateNF||ut[14],ee.cellDates&&(Ke[1].t="d",Ke[1].v=jp(Ke[1].v))),ee.qpro&&Ke[3]>Le&&(Y["!ref"]=St(q),Fe[xe]=Y,Ae.push(xe),Y=ee.dense?[]:{},q={s:{r:0,c:0},e:{r:0,c:0}},Le=Ke[3],xe=Ee||"Sheet"+(Le+1),Ee="");var en=ee.dense?(Y[Ke[0].r]||[])[Ke[0].c]:Y[ft(Ke[0])];if(en){en.t=Ke[1].t,en.v=Ke[1].v,Ke[1].z!=null&&(en.z=Ke[1].z),Ke[1].f!=null&&(en.f=Ke[1].f);break}ee.dense?(Y[Ke[0].r]||(Y[Ke[0].r]=[]),Y[Ke[0].r][Ke[0].c]=Ke[1]):Y[ft(Ke[0])]=Ke[1];break}},ee);else if(W[2]==26||W[2]==14)ee.Enum=je,W[2]==14&&(ee.qpro=!0,W.l=0),t(W,function(Ke,ir,bn){switch(bn){case 204:xe=Ke;break;case 22:Ke[1].v=Ke[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ke[3]>Le&&(Y["!ref"]=St(q),Fe[xe]=Y,Ae.push(xe),Y=ee.dense?[]:{},q={s:{r:0,c:0},e:{r:0,c:0}},Le=Ke[3],xe="Sheet"+(Le+1)),Pt>0&&Ke[0].r>=Pt)break;ee.dense?(Y[Ke[0].r]||(Y[Ke[0].r]=[]),Y[Ke[0].r][Ke[0].c]=Ke[1]):Y[ft(Ke[0])]=Ke[1],q.e.c<Ke[0].c&&(q.e.c=Ke[0].c),q.e.r<Ke[0].r&&(q.e.r=Ke[0].r);break;case 27:Ke[14e3]&&(it[Ke[14e3][0]]=Ke[14e3][1]);break;case 1537:it[Ke[0]]=Ke[1],Ke[0]==Le&&(xe=Ke[1]);break}},ee);else throw new Error("Unrecognized LOTUS BOF "+W[2]);if(Y["!ref"]=St(q),Fe[Ee||xe]=Y,Ae.push(Ee||xe),!it.length)return{SheetNames:Ae,Sheets:Fe};for(var Et={},Nt=[],xt=0;xt<it.length;++xt)Fe[Ae[xt]]?(Nt.push(it[xt]||Ae[xt]),Et[it[xt]]=Fe[it[xt]]||Fe[Ae[xt]]):(Nt.push(it[xt]),Et[it[xt]]={"!ref":"A1"});return{SheetNames:Nt,Sheets:Et}}function n(W,re){var ee=re||{};if(+ee.codepage>=0&&Ws(+ee.codepage),ee.type=="string")throw new Error("Cannot write WK1 to JS string");var Y=ji(),xe=$t(W["!ref"]),Ee=Array.isArray(W),Le=[];He(Y,0,s(1030)),He(Y,6,l(xe));for(var Fe=Math.min(xe.e.r,8191),Ae=xe.s.r;Ae<=Fe;++Ae)for(var it=Hr(Ae),q=xe.s.c;q<=xe.e.c;++q){Ae===xe.s.r&&(Le[q]=Cr(q));var Pt=Le[q]+it,Et=Ee?(W[Ae]||[])[q]:W[Pt];if(!(!Et||Et.t=="z"))if(Et.t=="n")(Et.v|0)==Et.v&&Et.v>=-32768&&Et.v<=32767?He(Y,13,m(Ae,q,Et.v)):He(Y,14,x(Ae,q,Et.v));else{var Nt=Xa(Et);He(Y,15,p(Ae,q,Nt.slice(0,239)))}}return He(Y,1),Y.end()}function i(W,re){var ee=re||{};if(+ee.codepage>=0&&Ws(+ee.codepage),ee.type=="string")throw new Error("Cannot write WK3 to JS string");var Y=ji();He(Y,0,a(W));for(var xe=0,Ee=0;xe<W.SheetNames.length;++xe)(W.Sheets[W.SheetNames[xe]]||{})["!ref"]&&He(Y,27,te(W.SheetNames[xe],Ee++));var Le=0;for(xe=0;xe<W.SheetNames.length;++xe){var Fe=W.Sheets[W.SheetNames[xe]];if(!(!Fe||!Fe["!ref"])){for(var Ae=$t(Fe["!ref"]),it=Array.isArray(Fe),q=[],Pt=Math.min(Ae.e.r,8191),Et=Ae.s.r;Et<=Pt;++Et)for(var Nt=Hr(Et),xt=Ae.s.c;xt<=Ae.e.c;++xt){Et===Ae.s.r&&(q[xt]=Cr(xt));var Ke=q[xt]+Nt,ir=it?(Fe[Et]||[])[xt]:Fe[Ke];if(!(!ir||ir.t=="z"))if(ir.t=="n")He(Y,23,I(Et,xt,Le,ir.v));else{var bn=Xa(ir);He(Y,22,T(Et,xt,Le,bn.slice(0,239)))}}++Le}}return He(Y,1),Y.end()}function s(W){var re=ye(2);return re.write_shift(2,W),re}function a(W){var re=ye(26);re.write_shift(2,4096),re.write_shift(2,4),re.write_shift(4,0);for(var ee=0,Y=0,xe=0,Ee=0;Ee<W.SheetNames.length;++Ee){var Le=W.SheetNames[Ee],Fe=W.Sheets[Le];if(!(!Fe||!Fe["!ref"])){++xe;var Ae=Vi(Fe["!ref"]);ee<Ae.e.r&&(ee=Ae.e.r),Y<Ae.e.c&&(Y=Ae.e.c)}}return ee>8191&&(ee=8191),re.write_shift(2,ee),re.write_shift(1,xe),re.write_shift(1,Y),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(1,1),re.write_shift(1,2),re.write_shift(4,0),re.write_shift(4,0),re}function o(W,re,ee){var Y={s:{c:0,r:0},e:{c:0,r:0}};return re==8&&ee.qpro?(Y.s.c=W.read_shift(1),W.l++,Y.s.r=W.read_shift(2),Y.e.c=W.read_shift(1),W.l++,Y.e.r=W.read_shift(2),Y):(Y.s.c=W.read_shift(2),Y.s.r=W.read_shift(2),re==12&&ee.qpro&&(W.l+=2),Y.e.c=W.read_shift(2),Y.e.r=W.read_shift(2),re==12&&ee.qpro&&(W.l+=2),Y.s.c==65535&&(Y.s.c=Y.e.c=Y.s.r=Y.e.r=0),Y)}function l(W){var re=ye(8);return re.write_shift(2,W.s.c),re.write_shift(2,W.s.r),re.write_shift(2,W.e.c),re.write_shift(2,W.e.r),re}function u(W,re,ee){var Y=[{c:0,r:0},{t:"n",v:0},0,0];return ee.qpro&&ee.vers!=20768?(Y[0].c=W.read_shift(1),Y[3]=W.read_shift(1),Y[0].r=W.read_shift(2),W.l+=2):(Y[2]=W.read_shift(1),Y[0].c=W.read_shift(2),Y[0].r=W.read_shift(2)),Y}function f(W,re,ee){var Y=W.l+re,xe=u(W,re,ee);if(xe[1].t="s",ee.vers==20768){W.l++;var Ee=W.read_shift(1);return xe[1].v=W.read_shift(Ee,"utf8"),xe}return ee.qpro&&W.l++,xe[1].v=W.read_shift(Y-W.l,"cstr"),xe}function p(W,re,ee){var Y=ye(7+ee.length);Y.write_shift(1,255),Y.write_shift(2,re),Y.write_shift(2,W),Y.write_shift(1,39);for(var xe=0;xe<Y.length;++xe){var Ee=ee.charCodeAt(xe);Y.write_shift(1,Ee>=128?95:Ee)}return Y.write_shift(1,0),Y}function g(W,re,ee){var Y=u(W,re,ee);return Y[1].v=W.read_shift(2,"i"),Y}function m(W,re,ee){var Y=ye(7);return Y.write_shift(1,255),Y.write_shift(2,re),Y.write_shift(2,W),Y.write_shift(2,ee,"i"),Y}function y(W,re,ee){var Y=u(W,re,ee);return Y[1].v=W.read_shift(8,"f"),Y}function x(W,re,ee){var Y=ye(13);return Y.write_shift(1,255),Y.write_shift(2,re),Y.write_shift(2,W),Y.write_shift(8,ee,"f"),Y}function w(W,re,ee){var Y=W.l+re,xe=u(W,re,ee);if(xe[1].v=W.read_shift(8,"f"),ee.qpro)W.l=Y;else{var Ee=W.read_shift(2);O(W.slice(W.l,W.l+Ee),xe),W.l+=Ee}return xe}function A(W,re,ee){var Y=re&32768;return re&=-32769,re=(Y?W:0)+(re>=8192?re-16384:re),(Y?"":"$")+(ee?Cr(re):Hr(re))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function O(W,re){On(W,0);for(var ee=[],Y=0,xe="",Ee="",Le="",Fe="";W.l<W.length;){var Ae=W[W.l++];switch(Ae){case 0:ee.push(W.read_shift(8,"f"));break;case 1:Ee=A(re[0].c,W.read_shift(2),!0),xe=A(re[0].r,W.read_shift(2),!1),ee.push(Ee+xe);break;case 2:{var it=A(re[0].c,W.read_shift(2),!0),q=A(re[0].r,W.read_shift(2),!1);Ee=A(re[0].c,W.read_shift(2),!0),xe=A(re[0].r,W.read_shift(2),!1),ee.push(it+q+":"+Ee+xe)}break;case 3:if(W.l<W.length){console.error("WK1 premature formula end");return}break;case 4:ee.push("("+ee.pop()+")");break;case 5:ee.push(W.read_shift(2));break;case 6:{for(var Pt="";Ae=W[W.l++];)Pt+=String.fromCharCode(Ae);ee.push('"'+Pt.replace(/"/g,'""')+'"')}break;case 8:ee.push("-"+ee.pop());break;case 23:ee.push("+"+ee.pop());break;case 22:ee.push("NOT("+ee.pop()+")");break;case 20:case 21:Fe=ee.pop(),Le=ee.pop(),ee.push(["AND","OR"][Ae-20]+"("+Le+","+Fe+")");break;default:if(Ae<32&&_[Ae])Fe=ee.pop(),Le=ee.pop(),ee.push(Le+_[Ae]+Fe);else if(k[Ae]){if(Y=k[Ae][1],Y==69&&(Y=W[W.l++]),Y>ee.length){console.error("WK1 bad formula parse 0x"+Ae.toString(16)+":|"+ee.join("|")+"|");return}var Et=ee.slice(-Y);ee.length-=Y,ee.push(k[Ae][0]+"("+Et.join(",")+")")}else return Ae<=7?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=24?console.error("WK1 unsupported op "+Ae.toString(16)):Ae<=30?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=115?console.error("WK1 unsupported function opcode "+Ae.toString(16)):console.error("WK1 unrecognized opcode "+Ae.toString(16))}}ee.length==1?re[1].f=""+ee[0]:console.error("WK1 bad formula parse |"+ee.join("|")+"|")}function G(W){var re=[{c:0,r:0},{t:"n",v:0},0];return re[0].r=W.read_shift(2),re[3]=W[W.l++],re[0].c=W[W.l++],re}function U(W,re){var ee=G(W);return ee[1].t="s",ee[1].v=W.read_shift(re-4,"cstr"),ee}function T(W,re,ee,Y){var xe=ye(6+Y.length);xe.write_shift(2,W),xe.write_shift(1,ee),xe.write_shift(1,re),xe.write_shift(1,39);for(var Ee=0;Ee<Y.length;++Ee){var Le=Y.charCodeAt(Ee);xe.write_shift(1,Le>=128?95:Le)}return xe.write_shift(1,0),xe}function F(W,re){var ee=G(W);ee[1].v=W.read_shift(2);var Y=ee[1].v>>1;if(ee[1].v&1)switch(Y&7){case 0:Y=(Y>>3)*5e3;break;case 1:Y=(Y>>3)*500;break;case 2:Y=(Y>>3)/20;break;case 3:Y=(Y>>3)/200;break;case 4:Y=(Y>>3)/2e3;break;case 5:Y=(Y>>3)/2e4;break;case 6:Y=(Y>>3)/16;break;case 7:Y=(Y>>3)/64;break}return ee[1].v=Y,ee}function S(W,re){var ee=G(W),Y=W.read_shift(4),xe=W.read_shift(4),Ee=W.read_shift(2);if(Ee==65535)return Y===0&&xe===3221225472?(ee[1].t="e",ee[1].v=15):Y===0&&xe===3489660928?(ee[1].t="e",ee[1].v=42):ee[1].v=0,ee;var Le=Ee&32768;return Ee=(Ee&32767)-16446,ee[1].v=(1-Le*2)*(xe*Math.pow(2,Ee+32)+Y*Math.pow(2,Ee)),ee}function I(W,re,ee,Y){var xe=ye(14);if(xe.write_shift(2,W),xe.write_shift(1,ee),xe.write_shift(1,re),Y==0)return xe.write_shift(4,0),xe.write_shift(4,0),xe.write_shift(2,65535),xe;var Ee=0,Le=0,Fe=0,Ae=0;return Y<0&&(Ee=1,Y=-Y),Le=Math.log2(Y)|0,Y/=Math.pow(2,Le-31),Ae=Y>>>0,Ae&2147483648||(Y/=2,++Le,Ae=Y>>>0),Y-=Ae,Ae|=2147483648,Ae>>>=0,Y*=Math.pow(2,32),Fe=Y>>>0,xe.write_shift(4,Fe),xe.write_shift(4,Ae),Le+=16383+(Ee?32768:0),xe.write_shift(2,Le),xe}function R(W,re){var ee=S(W);return W.l+=re-14,ee}function D(W,re){var ee=G(W),Y=W.read_shift(4);return ee[1].v=Y>>6,ee}function N(W,re){var ee=G(W),Y=W.read_shift(8,"f");return ee[1].v=Y,ee}function Ge(W,re){var ee=N(W);return W.l+=re-10,ee}function _e(W,re){return W[W.l+re-1]==0?W.read_shift(re,"cstr"):""}function Re(W,re){var ee=W[W.l++];ee>re-1&&(ee=re-1);for(var Y="";Y.length<ee;)Y+=String.fromCharCode(W[W.l++]);return Y}function Me(W,re,ee){if(!(!ee.qpro||re<21)){var Y=W.read_shift(1);W.l+=17,W.l+=1,W.l+=2;var xe=W.read_shift(re-21,"cstr");return[Y,xe]}}function Se(W,re){for(var ee={},Y=W.l+re;W.l<Y;){var xe=W.read_shift(2);if(xe==14e3){for(ee[xe]=[0,""],ee[xe][0]=W.read_shift(2);W[W.l];)ee[xe][1]+=String.fromCharCode(W[W.l]),W.l++;W.l++}}return ee}function te(W,re){var ee=ye(5+W.length);ee.write_shift(2,14e3),ee.write_shift(2,re);for(var Y=0;Y<W.length;++Y){var xe=W.charCodeAt(Y);ee[ee.l++]=xe>127?95:xe}return ee[ee.l++]=0,ee}var Ce={0:{n:"BOF",f:Jr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:y},15:{n:"LABEL",f},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:_e},222:{n:"SHEETNAMELP",f:Re},65535:{n:""}},je={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:U},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:R},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Se},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:N},40:{n:"FORMULA28",f:Ge},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:_e},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Me},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function g6(t){var e={},r=t.match(ci),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=ht(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=I1[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var m6=function(){var t=of("t"),e=of("rPr");function r(s){var a=s.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:Ht(a[1])},l=s.match(e);return l&&(o.s=g6(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),x6=function(){var e=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),v6=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,y6=/<(?:\w+:)?r>/,_6=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ev(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ht(or(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=or(t),r&&(n.h=V1(n.t))):t.match(y6)&&(n.r=or(t),n.t=Ht(or((t.replace(_6,"").match(v6)||[]).join("").replace(ci,""))),r&&(n.h=x6(m6(n.r)))),n):{t:""}}var E6=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,w6=/<(?:\w+:)?(?:si|sstItem)>/g,S6=/<\/(?:\w+:)?(?:si|sstItem)>/;function T6(t,e){var r=[],n="";if(!t)return r;var i=t.match(E6);if(i){n=i[2].replace(w6,"").split(S6);for(var s=0;s!=n.length;++s){var a=ev(n[s].trim(),e);a!=null&&(r[r.length]=a)}i=ht(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var A6=/^\s|\s$|[\t\n\r]/;function jA(t,e){if(!e.bookSST)return"";var r=[$r];r[r.length]=We("sst",null,{xmlns:sc[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(A6)&&(s+=' xml:space="preserve"'),s+=">"+tr(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function k6(t){return[t.read_shift(4),t.read_shift(4)]}function C6(t,e){var r=[],n=!1;return no(t,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function F6(t,e){return e||(e=ye(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var b6=jR;function I6(t){var e=ji();ke(e,159,F6(t));for(var r=0;r<t.length;++r)ke(e,19,b6(t[r]));return ke(e,160),e.end()}function VA(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Wa(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function N6(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Wa(t,4),e.U=Wa(t,4),e.W=Wa(t,4),e}function R6(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function D6(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(R6(t));return e}function P6(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function O6(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Wa(t,4),e.U=Wa(t,4),e.W=Wa(t,4),e}function M6(t){var e=O6(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function UA(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function zA(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function B6(t){var e=Wa(t);switch(e.Minor){case 2:return[e.Minor,L6(t)];case 3:return[e.Minor,j6()];case 4:return[e.Minor,V6(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function L6(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=UA(t,r),i=zA(t,t.length-t.l);return{t:"Std",h:n,v:i}}function j6(){throw new Error("File is password-protected: ECMA-376 Extensible")}function V6(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(ci,function(s){var a=ht(s);switch(va(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function U6(t,e){var r={},n=r.EncryptionVersionInfo=Wa(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=UA(t,i),e-=i,r.EncryptionVerifier=zA(t,e),r}function z6(t){var e={},r=e.EncryptionVersionInfo=Wa(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function tv(t){var e=0,r,n=VA(t),i=n.length+1,s,a,o,l,u;for(r=Jo(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=e&16384?1:0,l=e<<1&32767,u=o|l,e=u^a;return e^52811}var WA=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],l=104,u=a.length-1;u>=0;--u)for(var f=a[u],p=0;p!=7;++p)f&64&&(o^=r[l]),f*=2,--l;return o};return function(a){for(var o=VA(a),l=s(o),u=o.length,f=Jo(16),p=0;p!=16;++p)f[p]=0;var g,m,y;for((u&1)===1&&(g=l>>8,f[u]=i(t[0],g),--u,g=l&255,m=o[o.length-1],f[u]=i(m,g));u>0;)--u,g=l>>8,f[u]=i(o[u],g),--u,g=l&255,f[u]=i(o[u],g);for(u=15,y=15-o.length;y>0;)g=l>>8,f[u]=i(t[y],g),--u,--y,g=l&255,f[u]=i(o[u],g),--u,--y;return f}}(),W6=function(t,e,r,n,i){i||(i=e),n||(n=WA(t));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},H6=function(t){var e=0,r=WA(t);return function(n){var i=W6("",n,e,r);return e=i[1],i[0]}};function $6(t,e,r,n){var i={key:Jr(t),verificationBytes:Jr(t)};return r.password&&(i.verifier=tv(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=H6(r.password)),i}function G6(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=z6(t):n.Data=U6(t,e),n}function K6(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?G6(t,e-2,n):$6(t,r.biff>=8?e:e-2,r,n),n}var HA=function(){function t(i,s){switch(s.type){case"base64":return e(Zi(i),s);case"binary":return e(i,s);case"buffer":return e(kt&&Buffer.isBuffer(i)?i.toString("binary"):ll(i),s);case"array":return e(Kl(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,p){Array.isArray(o)&&(o[p]=[]);for(var g=/\\\w+\b/g,m=0,y,x=-1;y=g.exec(f);){switch(y[0]){case"\\cell":var w=f.slice(m,g.lastIndex-y[0].length);if(w[0]==" "&&(w=w.slice(1)),++x,w.length){var A={v:w,t:"s"};Array.isArray(o)?o[p][x]=A:o[ft({r:p,c:x})]=A}break}m=g.lastIndex}x>u.e.c&&(u.e.c=x)}),o["!ref"]=St(u),o}function r(i,s){return cl(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=$t(i["!ref"]),o,l=Array.isArray(i),u=a.s.r;u<=a.e.r;++u){s.push("\\trowd\\trautofit1");for(var f=a.s.c;f<=a.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=a.s.c;f<=a.e.c;++f){var p=ft({r:u,c:f});o=l?(i[u]||[])[f]:i[p],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Xa(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function Y6(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function df(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function X6(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),a=i-s;if(a===0)return[0,0,e];var o=0,l=0,u=i+s;switch(l=a/(u>1?2-u:u),i){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,l,u/2]}function q6(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=i*o,a[0]+=i,a[1]+=l;break;case 1:l=i*(2-o),a[0]+=l,a[1]+=i;break;case 2:l=i*(o-2),a[1]+=i,a[2]+=l;break;case 3:l=i*(4-o),a[1]+=l,a[2]+=i;break;case 4:l=i*(o-4),a[2]+=i,a[0]+=l;break;case 5:l=i*(6-o),a[2]+=l,a[0]+=i;break}for(var u=0;u!=3;++u)a[u]=Math.round(a[u]*255);return a}function Zh(t,e){if(e===0)return t;var r=X6(Y6(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),df(q6(r))}var $A=6,Q6=15,J6=1,ri=$A;function ff(t){return Math.floor((t+Math.round(128/ri)/256)*ri)}function hf(t){return Math.floor((t-5)/ri*100+.5)/100}function ep(t){return Math.round((t*ri+5)/ri*256)/256}function Mg(t){return ep(hf(ff(t)))}function rv(t){var e=Math.abs(t-Mg(t)),r=ri;if(e>.005)for(ri=J6;ri<Q6;++ri)Math.abs(t-Mg(t))<=e&&(e=Math.abs(t-Mg(t)),r=ri);ri=r}function Zo(t){t.width?(t.wpx=ff(t.width),t.wch=hf(t.wpx),t.MDW=ri):t.wpx?(t.wch=hf(t.wpx),t.width=ep(t.wch),t.MDW=ri):typeof t.wch=="number"&&(t.width=ep(t.wch),t.wpx=ff(t.width),t.MDW=ri),t.customWidth&&delete t.customWidth}var Z6=96,GA=Z6;function pf(t){return t*96/GA}function xu(t){return t*GA/96}var eP={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function tP(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(ci)||[]).forEach(function(a){var o=ht(a);switch(va(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=gr(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=gr(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function rP(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(ci)||[]).forEach(function(a){var o=ht(a);switch(va(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function nP(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(ci)||[]).forEach(function(a){var o=ht(a);switch(va(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=or(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?gr(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?gr(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?gr(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?gr(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?gr(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?gr(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?gr(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=I1[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=gr(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=Ol[i.color.index];i.color.index==81&&(l=Ol[1]),l||(l=Ol[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=Zh(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function iP(t,e,r){e.NumberFmt=[];for(var n=Br(ut),i=0;i<n.length;++i)e.NumberFmt[n[i]]=ut[n[i]];var s=t[0].match(ci);if(s)for(i=0;i<s.length;++i){var a=ht(s[i]);switch(va(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Ht(or(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}za(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function sP(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=We("numFmt",null,{numFmtId:n,formatCode:tr(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=We("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var P0=["numFmtId","fillId","fontId","borderId","xfId"],O0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function aP(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(ci)||[]).forEach(function(s){var a=ht(s),o=0;switch(va(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<P0.length;++o)n[P0[o]]&&(n[P0[o]]=parseInt(n[P0[o]],10));for(o=0;o<O0.length;++o)n[O0[o]]&&(n[O0[o]]=gr(n[O0[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=gr(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function oP(t){var e=[];return e[e.length]=We("cellXfs",null),t.forEach(function(r){e[e.length]=We("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=We("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var lP=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,u){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=o.match(e))&&iP(p,f,u),(p=o.match(i))&&nP(p,f,l,u),(p=o.match(n))&&rP(p,f,l,u),(p=o.match(s))&&tP(p,f,l,u),(p=o.match(r))&&aP(p,f,u),f}}();function KA(t,e){var r=[$r,We("styleSheet",null,{xmlns:sc[0],"xmlns:vt":fn.vt})],n;return t.SSF&&(n=sP(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=oP(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function cP(t,e){var r=t.read_shift(2),n=si(t);return[r,n]}function uP(t,e,r){r||(r=ye(6+4*e.length)),r.write_shift(2,t),Cn(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function dP(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=GR(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=$R(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=si(t),n}function fP(t,e){e||(e=ye(25+4*32)),e.write_shift(2,t.sz*20),KR(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),qh(t.color,e);var n=0;return n=2,e.write_shift(1,n),Cn(t.name,e),e.length>e.l?e.slice(0,e.l):e}var hP=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Bg,pP=oi;function C2(t,e){e||(e=ye(4*3+8*7+16*1)),Bg||(Bg=Bp(hP));var r=Bg[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(qh({auto:1},e),qh({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function gP(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function YA(t,e,r){r||(r=ye(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function rd(t,e){return e||(e=ye(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var mP=oi;function xP(t,e){return e||(e=ye(51)),e.write_shift(1,0),rd(null,e),rd(null,e),rd(null,e),rd(null,e),rd(null,e),e.length>e.l?e.slice(0,e.l):e}function vP(t,e){return e||(e=ye(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Xh(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function yP(t,e,r){var n=ye(2052);return n.write_shift(4,t),Xh(e,n),Xh(r,n),n.length>n.l?n.slice(0,n.l):n}function _P(t,e,r){var n={};n.NumberFmt=[];for(var i in ut)n.NumberFmt[i]=ut[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return no(t,function(l,u,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],za(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=Zh(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(f),a=!0;break;case 38:s.pop(),a=!1;break;default:if(u.T>0)s.push(f);else if(u.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function EP(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(ke(t,615,Xs(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&ke(t,44,uP(i,e[i]))}),ke(t,616))}}function wP(t){var e=1;ke(t,611,Xs(e)),ke(t,43,fP({sz:12,color:{theme:1},name:"Calibri",family:2})),ke(t,612)}function SP(t){var e=2;ke(t,603,Xs(e)),ke(t,45,C2({patternType:"none"})),ke(t,45,C2({patternType:"gray125"})),ke(t,604)}function TP(t){var e=1;ke(t,613,Xs(e)),ke(t,46,xP()),ke(t,614)}function AP(t){var e=1;ke(t,626,Xs(e)),ke(t,47,YA({numFmtId:0},65535)),ke(t,627)}function kP(t,e){ke(t,617,Xs(e.length)),e.forEach(function(r){ke(t,47,YA(r,0))}),ke(t,618)}function CP(t){var e=1;ke(t,619,Xs(e)),ke(t,48,vP({xfId:0,name:"Normal"})),ke(t,620)}function FP(t){var e=0;ke(t,505,Xs(e)),ke(t,506)}function bP(t){var e=0;ke(t,508,yP(e,"TableStyleMedium9","PivotStyleMedium4")),ke(t,509)}function IP(t,e){var r=ji();return ke(r,278),EP(r,t.SSF),wP(r),SP(r),TP(r),AP(r),kP(r,e.cellXfs),CP(r),FP(r),bP(r),ke(r,279),r.end()}var NP=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function RP(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(ci)||[]).forEach(function(i){var s=ht(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[NP.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function DP(){}function PP(){}var OP=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,MP=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,BP=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function LP(t,e,r){e.themeElements={};var n;[["clrScheme",OP,RP],["fontScheme",MP,DP],["fmtScheme",BP,PP]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var jP=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function XA(t,e){(!t||t.length===0)&&(t=nv());var r,n={};if(!(r=t.match(jP)))throw new Error("themeElements not found in theme");return LP(r[0],n,e),n.raw=t,n}function nv(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[$r];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function VP(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var a;try{a=UT(s,{type:"array"})}catch{return}var o=Yi(a,"theme/theme/theme1.xml",!0);if(o)return XA(o,r)}}function UP(t){return t.read_shift(4)}function zP(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=WP(t,4);break;case 2:e.xclrValue=FA(t);break;case 3:e.xclrValue=UP(t);break;case 4:t.l+=4;break}return t.l+=8,e}function WP(t,e){return oi(t,e)}function HP(t,e){return oi(t,e)}function $P(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=zP(t);break;case 6:n[1]=HP(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function GP(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push($P(t,r-t.l));return{ixfe:n,ext:s}}function KP(t,e){e.forEach(function(r){switch(r[0]){}})}function YP(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:si(t)}}function XP(t){var e=ye(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Cn(t.name,e),e.slice(0,e.l)}function qP(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function QP(t){var e=ye(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function JP(t,e){var r=ye(8+2*e.length);return r.write_shift(4,t),Cn(e,r),r.slice(0,r.l)}function ZP(t){return t.l+=4,t.read_shift(4)!=0}function e8(t,e){var r=ye(8);return r.write_shift(4,t),r.write_shift(4,1),r}function t8(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return no(t,function(l,u,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(p){o==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):o==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(f),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!u.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function r8(){var t=ji();return ke(t,332),ke(t,334,Xs(1)),ke(t,335,XP({name:"XLDAPR",version:12e4,flags:3496657072})),ke(t,336),ke(t,339,JP(1,"XLDAPR")),ke(t,52),ke(t,35,Xs(514)),ke(t,4096,Xs(0)),ke(t,4097,xs(1)),ke(t,36),ke(t,53),ke(t,340),ke(t,337,e8(1)),ke(t,51,QP([[1,0]])),ke(t,338),ke(t,333),t.end()}function n8(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,a;return t.replace(ci,function(o){var l=ht(o);switch(va(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(a=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function qA(){var t=[$r];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function i8(t){var e=[];if(!t)return e;var r=1;return(t.match(ci)||[]).forEach(function(n){var i=ht(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function s8(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=ft(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function a8(t,e,r){var n=[];return no(t,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function o8(t,e,r,n){if(!t)return t;var i=n||{},s=!1;no(t,function(o,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},i)}function l8(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Gc=1024;function QA(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[We("xml",null,{"xmlns:v":$i.v,"xmlns:o":$i.o,"xmlns:x":$i.x,"xmlns:mv":$i.mv}).replace(/\/>/,">"),We("o:shapelayout",We("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),We("v:shapetype",[We("v:stroke",null,{joinstyle:"miter"}),We("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Gc<t*1e3;)Gc+=1e3;return e.forEach(function(s){var a=Fr(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?We("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=We("v:fill",l,o),f={on:"t",obscured:"t"};++Gc,i=i.concat(["<v:shape"+lf({id:"_x0000_s"+Gc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,We("v:shadow",null,f),We("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Mn("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Mn("x:AutoFill","False"),Mn("x:Row",String(a.r)),Mn("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function F2(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(a){var o=Fr(a.ref);if(i?(t[o.r]||(t[o.r]=[]),s=t[o.r][o.c]):s=t[a.ref],!s){s={t:"z"},i?t[o.r][o.c]=s:t[a.ref]=s;var l=$t(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var u=St(l);u!==t["!ref"]&&(t["!ref"]=u)}s.c||(s.c=[]);var f={a:a.author,t:a.t,r:a.r,T:r};a.h&&(f.h=a.h);for(var p=s.c.length-1;p>=0;--p){if(!r&&s.c[p].T)return;r&&!s.c[p].T&&s.c.splice(p,1)}if(r&&n){for(p=0;p<n.length;++p)if(f.a==n[p].id){f.a=n[p].name||f.a;break}}s.c.push(f)})}function c8(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=ht(o[0]),u={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=Fr(l.ref);if(!(e.sheetRows&&e.sheetRows<=f.r)){var p=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!p&&!!p[1]&&ev(p[1])||{r:"",t:"",h:""};u.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),u.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(u.h=g.h),n.push(u)}}}}),n}function JA(t){var e=[$r,We("comments",null,{xmlns:sc[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=tr(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(tr(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Mn("t",tr(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(Mn("t",tr(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function u8(t,e){var r=[],n=!1,i={},s=0;return t.replace(ci,function(o,l){var u=ht(o);switch(va(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":i.t=t.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function d8(t,e,r){var n=[$r,We("ThreadedComments",null,{xmlns:fn.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(We("threadedComment",Mn("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function f8(t,e){var r=[],n=!1;return t.replace(ci,function(s){var a=ht(s);switch(va(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function h8(t){var e=[$r,We("personList",null,{xmlns:fn.TCMNT,"xmlns:x":sc[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(We("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function p8(t){var e={};e.iauthor=t.read_shift(4);var r=cc(t);return e.rfx=r.s,e.ref=ft(r.s),t.l+=16,e}function g8(t,e){return e==null&&(e=ye(36)),e.write_shift(4,t[1].iauthor),Du(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var m8=si;function x8(t){return Cn(t.slice(0,54))}function v8(t,e){var r=[],n=[],i={},s=!1;return no(t,function(o,l,u){switch(u){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function y8(t){var e=ji(),r=[];return ke(e,628),ke(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),ke(e,632,x8(i.a)))})}),ke(e,631),ke(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Fr(n[0]),e:Fr(n[0])};ke(e,635,g8([s,i])),i.t&&i.t.length>0&&ke(e,637,UR(i)),ke(e,636),delete i.iauthor})}),ke(e,634),ke(e,629),e.end()}var _8="application/vnd.ms-office.vbaProject";function E8(t){var e=nt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");nt.utils.cfb_add(e,i,t.FileIndex[n].content)}}),nt.write(e)}function w8(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&nt.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var ZA=["xlsb","xlsm","xlam","biff8","xla"];function S8(){return{"!type":"dialog"}}function T8(){return{"!type":"dialog"}}function A8(){return{"!type":"macro"}}function k8(){return{"!type":"macro"}}var ru=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,f=a.length>0?parseInt(a,10)|0:0;return o?f+=e.c:--f,l?u+=e.r:--u,i+(o?"":"$")+Cr(f)+(l?"":"$")+Hr(u)}return function(i,s){return e=s,i.replace(t,r)}}(),iv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,sv=function(){return function(e,r){return e.replace(iv,function(n,i,s,a,o,l){var u=$1(a)-(s?0:r.c),f=H1(l)-(o?0:r.r),p=f==0?"":o?f+1:"["+f+"]",g=u==0?"":s?u+1:"["+u+"]";return i+"R"+p+"C"+g})}}();function ek(t,e){return t.replace(iv,function(r,n,i,s,a,o){return n+(i=="$"?i+s:Cr($1(s)+e.c))+(a=="$"?a+o:Hr(H1(o)+e.r))})}function C8(t,e,r){var n=Vi(e),i=n.s,s=Fr(r),a={r:s.r-i.r,c:s.c-i.c};return ek(t,a)}function F8(t){return t.length!=1}function b2(t){return t.replace(/_xlfn\./g,"")}function Yr(t){t.l+=1}function el(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function tk(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return rk(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=el(t),o=el(t);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function rk(t){var e=el(t),r=el(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function b8(t,e,r){if(r.biff<8)return rk(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=el(t),a=el(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function nk(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return I8(t);var n=t.read_shift(r&&r.biff==12?4:2),i=el(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function I8(t){var e=el(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function N8(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function R8(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return D8(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function D8(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function P8(t,e,r){var n=(t[t.l++]&96)>>5,i=tk(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function O8(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=tk(t,s,r);return[n,i,a]}function M8(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function B8(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function L8(t,e,r){var n=(t[t.l++]&96)>>5,i=b8(t,e-1,r);return[n,i]}function j8(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function I2(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function V8(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function U8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function z8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function W8(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function H8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function ik(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function $8(t){return t.read_shift(2),ik(t)}function G8(t){return t.read_shift(2),ik(t)}function K8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=nk(t,0,r);return[n,i]}function Y8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=R8(t,0,r);return[n,i]}function X8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=nk(t,0,r);return[n,i,s]}function q8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[Z5[i],ok[i],n]}function Q8(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:J8(t);return[i,(s[0]===0?ok:J5)[s[1]]]}function J8(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function Z8(t,e,r){t.l+=r&&r.biff==2?3:4}function e5(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function t5(t){return t.l++,io[t.read_shift(1)]}function r5(t){return t.l++,t.read_shift(2)}function n5(t){return t.l++,t.read_shift(1)!==0}function i5(t){return t.l++,ii(t)}function s5(t,e,r){return t.l++,Of(t,e-1,r)}function a5(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ur(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=io[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=ii(t);break;case 2:r[1]=uc(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function o5(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?cc:Vp)(t));return i}function l5(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=a5(t,r.biff);return a}function c5(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function u5(t,e,r){if(r.biff==5)return d5(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function d5(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function f5(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function h5(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function p5(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function g5(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var m5=oi,x5=oi,v5=oi;function Bf(t,e,r){return t.l+=2,[N8(t)]}function av(t){return t.l+=6,[]}var y5=Bf,_5=av,E5=av,w5=Bf;function sk(t){return t.l+=2,[Jr(t),t.read_shift(2)&1]}var S5=Bf,T5=sk,A5=av,k5=Bf,C5=Bf,F5=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function b5(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=F5[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function I5(t){return t.l+=2,[t.read_shift(4)]}function N5(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function R5(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function D5(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function P5(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function O5(t){return t.l+=4,[0,0]}var N2={1:{n:"PtgExp",f:e5},2:{n:"PtgTbl",f:v5},3:{n:"PtgAdd",f:Yr},4:{n:"PtgSub",f:Yr},5:{n:"PtgMul",f:Yr},6:{n:"PtgDiv",f:Yr},7:{n:"PtgPower",f:Yr},8:{n:"PtgConcat",f:Yr},9:{n:"PtgLt",f:Yr},10:{n:"PtgLe",f:Yr},11:{n:"PtgEq",f:Yr},12:{n:"PtgGe",f:Yr},13:{n:"PtgGt",f:Yr},14:{n:"PtgNe",f:Yr},15:{n:"PtgIsect",f:Yr},16:{n:"PtgUnion",f:Yr},17:{n:"PtgRange",f:Yr},18:{n:"PtgUplus",f:Yr},19:{n:"PtgUminus",f:Yr},20:{n:"PtgPercent",f:Yr},21:{n:"PtgParen",f:Yr},22:{n:"PtgMissArg",f:Yr},23:{n:"PtgStr",f:s5},26:{n:"PtgSheet",f:N5},27:{n:"PtgEndSheet",f:R5},28:{n:"PtgErr",f:t5},29:{n:"PtgBool",f:n5},30:{n:"PtgInt",f:r5},31:{n:"PtgNum",f:i5},32:{n:"PtgArray",f:j8},33:{n:"PtgFunc",f:q8},34:{n:"PtgFuncVar",f:Q8},35:{n:"PtgName",f:c5},36:{n:"PtgRef",f:K8},37:{n:"PtgArea",f:P8},38:{n:"PtgMemArea",f:f5},39:{n:"PtgMemErr",f:m5},40:{n:"PtgMemNoMem",f:x5},41:{n:"PtgMemFunc",f:h5},42:{n:"PtgRefErr",f:p5},43:{n:"PtgAreaErr",f:M8},44:{n:"PtgRefN",f:Y8},45:{n:"PtgAreaN",f:L8},46:{n:"PtgMemAreaN",f:D5},47:{n:"PtgMemNoMemN",f:P5},57:{n:"PtgNameX",f:u5},58:{n:"PtgRef3d",f:X8},59:{n:"PtgArea3d",f:O8},60:{n:"PtgRefErr3d",f:g5},61:{n:"PtgAreaErr3d",f:B8},255:{}},M5={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},B5={1:{n:"PtgElfLel",f:sk},2:{n:"PtgElfRw",f:k5},3:{n:"PtgElfCol",f:y5},6:{n:"PtgElfRwV",f:C5},7:{n:"PtgElfColV",f:w5},10:{n:"PtgElfRadical",f:S5},11:{n:"PtgElfRadicalS",f:A5},13:{n:"PtgElfColS",f:_5},15:{n:"PtgElfColSV",f:E5},16:{n:"PtgElfRadicalLel",f:T5},25:{n:"PtgList",f:b5},29:{n:"PtgSxName",f:I5},255:{}},L5={0:{n:"PtgAttrNoop",f:O5},1:{n:"PtgAttrSemi",f:H8},2:{n:"PtgAttrIf",f:z8},4:{n:"PtgAttrChoose",f:V8},8:{n:"PtgAttrGoto",f:U8},16:{n:"PtgAttrSum",f:Z8},32:{n:"PtgAttrBaxcel",f:I2},33:{n:"PtgAttrBaxcel",f:I2},64:{n:"PtgAttrSpace",f:$8},65:{n:"PtgAttrSpaceSemi",f:G8},128:{n:"PtgAttrIfError",f:W8},255:{}};function Lf(t,e,r,n){if(n.biff<8)return oi(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=l5(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=o5(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(oi(t,e)),s}function jf(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=N2[s]||N2[M5[s]],(s===24||s===25)&&(i=(s===24?B5:L5)[t[t.l+1]]),!i||!i.f?oi(t,e):a.push([i.n,i.f(t,e,r)]);return a}function j5(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var V5={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function U5(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function ak(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function R2(t,e,r){var n=ak(t,e,r);return n=="#REF"?n:U5(n,r)}function ei(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,u,f,p=0,g=0,m,y="";if(!t[0]||!t[0][0])return"";for(var x=-1,w="",A=0,k=t[0].length;A<k;++A){var _=t[0][A];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),x>=0){switch(t[0][x][1][0]){case 0:w=Pr(" ",t[0][x][1][1]);break;case 1:w=Pr("\r",t[0][x][1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}u=u+w,x=-1}o.push(u+V5[_[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Fd(_[1][1],a,i),o.push(bd(f,s));break;case"PtgRefN":f=r?Fd(_[1][1],r,i):_[1][1],o.push(bd(f,s));break;case"PtgRef3d":p=_[1][1],f=Fd(_[1][2],a,i),y=R2(n,p,i),o.push(y+"!"+bd(f,s));break;case"PtgFunc":case"PtgFuncVar":var O=_[1][0],G=_[1][1];O||(O=0),O&=127;var U=O==0?[]:o.slice(-O);o.length-=O,G==="User"&&(G=U.shift()),o.push(G+"("+U.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":m=o2(_[1][1],r?{s:r}:a,i),o.push(Dg(m,i));break;case"PtgArea":m=o2(_[1][1],a,i),o.push(Dg(m,i));break;case"PtgArea3d":p=_[1][1],m=_[1][2],y=R2(n,p,i),o.push(y+"!"+Dg(m,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=_[1][2];var T=(n.names||[])[g-1]||(n[0]||[])[g],F=T?T.Name:"SH33TJSNAME"+String(g);F&&F.slice(0,6)=="_xlfn."&&!i.xlfn&&(F=F.slice(6)),o.push(F);break;case"PtgNameX":var S=_[1][1];g=_[1][2];var I;if(i.biff<=5)S<0&&(S=-S),n[S]&&(I=n[S][g]);else{var R="";if(((n[S]||[])[0]||[])[0]==14849||(((n[S]||[])[0]||[])[0]==1025?n[S][g]&&n[S][g].itab>0&&(R=n.SheetNames[n[S][g].itab-1]+"!"):R=n.SheetNames[g-1]+"!"),n[S]&&n[S][g])R+=n[S][g].Name;else if(n[0]&&n[0][g])R+=n[0][g].Name;else{var D=(ak(n,S,i)||"").split(";;");D[g-1]?R=D[g-1]:R+="SH33TJSERRX"}o.push(R);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var N="(",Ge=")";if(x>=0){switch(w="",t[0][x][1][0]){case 2:N=Pr(" ",t[0][x][1][1])+N;break;case 3:N=Pr("\r",t[0][x][1][1])+N;break;case 4:Ge=Pr(" ",t[0][x][1][1])+Ge;break;case 5:Ge=Pr("\r",t[0][x][1][1])+Ge;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}x=-1}o.push(N+o.pop()+Ge);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:_[1][1],r:_[1][0]};var _e={c:r.c,r:r.r};if(n.sharedf[ft(f)]){var Re=n.sharedf[ft(f)];o.push(ei(Re,a,_e,n,i))}else{var Me=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){o.push(ei(u[1],a,_e,n,i)),Me=!0;break}Me||o.push(_[1])}break;case"PtgArray":o.push("{"+j5(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=A;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var Se=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&Se.indexOf(t[0][A][0])==-1){_=t[0][x];var te=!0;switch(_[1][0]){case 4:te=!1;case 0:w=Pr(" ",_[1][1]);break;case 5:te=!1;case 1:w=Pr("\r",_[1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((te?w:"")+o.pop()+(te?"":w)),x=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function z5(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],oi(t,e-2)];var o=jf(t,a,r);return e!==a+i&&(s=Lf(t,e-a-i,o,r)),t.l=n,[o,s]}function W5(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],oi(t,e-2)];var o=jf(t,a,r);return e!==a+i&&(s=Lf(t,e-a-i,o,r)),t.l=n,[o,s]}function H5(t,e,r,n){var i=t.l+e,s=jf(t,n,r),a;return i!==t.l&&(a=Lf(t,i-t.l,s,r)),[s,a]}function $5(t,e,r){var n=t.l+e,i,s=t.read_shift(2),a=jf(t,s,r);return s==65535?[[],oi(t,e-2)]:(e!==s+2&&(i=Lf(t,n-s-2,a,r)),[a,i])}function G5(t){var e;if(Ma(t,t.l+6)!==65535)return[ii(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function K5(t){if(t==null){var e=ye(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Yl(t);return Yl(0)}function Lg(t,e,r){var n=t.l+e,i=ya(t);r.biff==2&&++t.l;var s=G5(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=W5(t,n-t.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function Y5(t,e,r,n,i){var s=ql(e,r,i),a=K5(t.v),o=ye(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=ye(t.bf.length),f=0;f<t.bf.length;++f)u[f]=t.bf[f];var p=kn([s,a,o,u]);return p}function Up(t,e,r){var n=t.read_shift(4),i=jf(t,n,r),s=t.read_shift(4),a=s>0?Lf(t,s,i,r):null;return[i,a]}var X5=Up,zp=Up,q5=Up,Q5=Up,J5={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ok={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Z5={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function D2(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function eO(t){var e="of:="+t.replace(iv,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function jg(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function tO(t){return t.replace(/\./,"!")}var Nd={},nu={},Rd=typeof Map<"u";function ov(t,e,r){var n=0,i=t.length;if(r){if(Rd?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=Rd?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(Rd?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function Wp(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(ri=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=hf(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=ep(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Ll(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function ul(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){za(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function lk(t,e,r,n,i,s){try{n.cellNF&&(t.z=ut[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=xr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(ut[e]==null&&za(JN[e]||"General",e),t.t==="e")t.w=t.w||io[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=af(t.v);else if(t.t==="d"){var a=mn(t.v);(a|0)===a?t.w=a.toString(10):t.w=af(a)}else{if(t.v===void 0)return"";t.w=Gl(t.v,nu)}else t.t==="d"?t.w=ks(e,mn(t.v),nu):t.w=ks(e,t.v,nu)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Zh(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Zh(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function rO(t,e,r){if(t&&t["!ref"]){var n=$t(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function nO(t,e){var r=$t(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=St(r))}var iO=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,sO=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,aO=/<(?:\w:)?hyperlink [^>]*>/mg,oO=/"(\w*:\w*)"/,lO=/<(?:\w:)?col\b[^>]*[\/]?>/g,cO=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,uO=/<(?:\w:)?pageMargins[^>]*\/>/g,ck=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,dO=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,fO=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function hO(t,e,r,n,i,s,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",f="",p=t.match(sO);p?(u=t.slice(0,p.index),f=t.slice(p.index+p[0].length)):u=f=t;var g=u.match(ck);g?lv(g[0],o,i,r):(g=u.match(dO))&&gO(g[0],g[1]||"",o,i,r);var m=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var y=u.slice(m,m+50).match(oO);y&&nO(o,y[1])}var x=u.match(fO);x&&x[1]&&FO(x[1],i);var w=[];if(e.cellStyles){var A=u.match(lO);A&&SO(w,A)}p&&NO(p[1],o,e,l,s,a);var k=f.match(cO);k&&(o["!autofilter"]=AO(k[0]));var _=[],O=f.match(iO);if(O)for(m=0;m!=O.length;++m)_[m]=$t(O[m].slice(O[m].indexOf('"')+1));var G=f.match(aO);G&&_O(o,G,n);var U=f.match(uO);if(U&&(o["!margins"]=EO(ht(U[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=St(l)),e.sheetRows>0&&o["!ref"]){var T=$t(o["!ref"]);e.sheetRows<=+T.e.r&&(T.e.r=e.sheetRows-1,T.e.r>l.e.r&&(T.e.r=l.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>l.e.c&&(T.e.c=l.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),o["!fullref"]=o["!ref"],o["!ref"]=St(T))}return w.length>0&&(o["!cols"]=w),_.length>0&&(o["!merges"]=_),o}function pO(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+St(t[r])+'"/>';return e+"</mergeCells>"}function lv(t,e,r,n){var i=ht(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Ht(or(i.codeName)))}function gO(t,e,r,n,i){lv(t.slice(0,t.indexOf(">")),r,n,i)}function mO(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=ca(tr(l))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),o=(o||"")+We("outlinePr",null,u)}!s&&!o||(i[i.length]=We("sheetPr",o,a))}var xO=["objects","scenarios","selectLockedCells","selectUnlockedCells"],vO=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function yO(t){var e={sheet:1};return xO.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),vO.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=tv(t.password).toString(16).toUpperCase()),We("sheetProtection",null,e)}function _O(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=ht(or(e[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+Ht(s.location))):(s.Target="#"+Ht(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=$t(s.ref),l=o.s.r;l<=o.e.r;++l)for(var u=o.s.c;u<=o.e.c;++u){var f=ft({c:u,r:l});n?(t[l]||(t[l]=[]),t[l][u]||(t[l][u]={t:"z",v:void 0}),t[l][u].l=s):(t[f]||(t[f]={t:"z",v:void 0}),t[f].l=s)}}}function EO(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function wO(t){return Ll(t),We("pageMargins",null,t)}function SO(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=ht(e[n],!0);i.hidden&&(i.hidden=gr(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,rv(i.width)),Zo(i);s<=a;)t[s++]=vr(i)}}function TO(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=We("col",null,Wp(i,n)));return r[r.length]="</cols>",r.join("")}function AO(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function kO(t,e,r,n){var i=typeof t.ref=="string"?t.ref:St(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=Vi(i);a.s.r==a.e.r&&(a.e.r=Vi(e["!ref"]).e.r,i=St(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),We("autoFilter",null,{ref:i})}var CO=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function FO(t,e){e.Views||(e.Views=[{}]),(t.match(CO)||[]).forEach(function(r,n){var i=ht(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),gr(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function bO(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),We("sheetViews",We("sheetView",null,i),{})}function IO(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=io[t.v];break;case"d":n&&n.cellDates?i=xr(t.v,-1).toISOString():(t=vr(t),t.t="n",i=""+(t.v=mn(xr(t.v)))),typeof t.z>"u"&&(t.z=ut[14]);break;default:i=t.v;break}var o=Mn("v",tr(i)),l={r:e},u=ul(n.cellXfs,t,n);switch(u!==0&&(l.s=u),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Mn("v",""+ov(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=a),typeof t.f=="string"&&t.f){var f=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=We("f",tr(t.f),f)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),We("c",o,l)}var NO=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=of("v"),a=of("f");return function(l,u,f,p,g,m){for(var y=0,x="",w=[],A=[],k=0,_=0,O=0,G="",U,T,F=0,S=0,I,R,D=0,N=0,Ge=Array.isArray(m.CellXf),_e,Re=[],Me=[],Se=Array.isArray(u),te=[],Ce={},je=!1,W=!!f.sheetStubs,re=l.split(e),ee=0,Y=re.length;ee!=Y;++ee){x=re[ee].trim();var xe=x.length;if(xe!==0){var Ee=0;e:for(y=0;y<xe;++y)switch(x[y]){case">":if(x[y-1]!="/"){++y;break e}if(f&&f.cellStyles){if(T=ht(x.slice(Ee,y),!0),F=T.r!=null?parseInt(T.r,10):F+1,S=-1,f.sheetRows&&f.sheetRows<F)continue;Ce={},je=!1,T.ht&&(je=!0,Ce.hpt=parseFloat(T.ht),Ce.hpx=xu(Ce.hpt)),T.hidden=="1"&&(je=!0,Ce.hidden=!0),T.outlineLevel!=null&&(je=!0,Ce.level=+T.outlineLevel),je&&(te[F-1]=Ce)}break;case"<":Ee=y;break}if(Ee>=y)break;if(T=ht(x.slice(Ee,y),!0),F=T.r!=null?parseInt(T.r,10):F+1,S=-1,!(f.sheetRows&&f.sheetRows<F)){p.s.r>F-1&&(p.s.r=F-1),p.e.r<F-1&&(p.e.r=F-1),f&&f.cellStyles&&(Ce={},je=!1,T.ht&&(je=!0,Ce.hpt=parseFloat(T.ht),Ce.hpx=xu(Ce.hpt)),T.hidden=="1"&&(je=!0,Ce.hidden=!0),T.outlineLevel!=null&&(je=!0,Ce.level=+T.outlineLevel),je&&(te[F-1]=Ce)),w=x.slice(y).split(t);for(var Le=0;Le!=w.length&&w[Le].trim().charAt(0)=="<";++Le);for(w=w.slice(Le),y=0;y!=w.length;++y)if(x=w[y].trim(),x.length!==0){if(A=x.match(r),k=y,_=0,O=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,A!=null&&A.length===2){for(k=0,G=A[1],_=0;_!=G.length&&!((O=G.charCodeAt(_)-64)<1||O>26);++_)k=26*k+O;--k,S=k}else++S;for(_=0;_!=x.length&&x.charCodeAt(_)!==62;++_);if(++_,T=ht(x.slice(0,_),!0),T.r||(T.r=ft({r:F-1,c:S})),G=x.slice(_),U={t:""},(A=G.match(s))!=null&&A[1]!==""&&(U.v=Ht(A[1])),f.cellFormula){if((A=G.match(a))!=null&&A[1]!==""){if(U.f=Ht(or(A[1])).replace(/\r\n/g,`
`),f.xlfn||(U.f=b2(U.f)),A[0].indexOf('t="array"')>-1)U.F=(G.match(i)||[])[1],U.F.indexOf(":")>-1&&Re.push([$t(U.F),U.F]);else if(A[0].indexOf('t="shared"')>-1){R=ht(A[0]);var Fe=Ht(or(A[1]));f.xlfn||(Fe=b2(Fe)),Me[parseInt(R.si,10)]=[R,Fe,T.r]}}else(A=G.match(/<f[^>]*\/>/))&&(R=ht(A[0]),Me[R.si]&&(U.f=C8(Me[R.si][1],Me[R.si][2],T.r)));var Ae=Fr(T.r);for(_=0;_<Re.length;++_)Ae.r>=Re[_][0].s.r&&Ae.r<=Re[_][0].e.r&&Ae.c>=Re[_][0].s.c&&Ae.c<=Re[_][0].e.c&&(U.F=Re[_][1])}if(T.t==null&&U.v===void 0)if(U.f||U.F)U.v=0,U.t="n";else if(W)U.t="z";else continue;else U.t=T.t||"n";switch(p.s.c>S&&(p.s.c=S),p.e.c<S&&(p.e.c=S),U.t){case"n":if(U.v==""||U.v==null){if(!W)continue;U.t="z"}else U.v=parseFloat(U.v);break;case"s":if(typeof U.v>"u"){if(!W)continue;U.t="z"}else I=Nd[parseInt(U.v,10)],U.v=I.t,U.r=I.r,f.cellHTML&&(U.h=I.h);break;case"str":U.t="s",U.v=U.v!=null?or(U.v):"",f.cellHTML&&(U.h=V1(U.v));break;case"inlineStr":A=G.match(n),U.t="s",A!=null&&(I=ev(A[1]))?(U.v=I.t,f.cellHTML&&(U.h=I.h)):U.v="";break;case"b":U.v=gr(U.v);break;case"d":f.cellDates?U.v=xr(U.v,1):(U.v=mn(xr(U.v,1)),U.t="n");break;case"e":(!f||f.cellText!==!1)&&(U.w=U.v),U.v=dA[U.v];break}if(D=N=0,_e=null,Ge&&T.s!==void 0&&(_e=m.CellXf[T.s],_e!=null&&(_e.numFmtId!=null&&(D=_e.numFmtId),f.cellStyles&&_e.fillId!=null&&(N=_e.fillId))),lk(U,D,N,f,g,m),f.cellDates&&Ge&&U.t=="n"&&Iu(ut[D])&&(U.t="d",U.v=jp(U.v)),T.cm&&f.xlmeta){var it=(f.xlmeta.Cell||[])[+T.cm-1];it&&it.type=="XLDAPR"&&(U.D=!0)}if(Se){var q=Fr(T.r);u[q.r]||(u[q.r]=[]),u[q.r][q.c]=U}else u[T.r]=U}}}}te.length>0&&(u["!rows"]=te)}}();function RO(t,e,r,n){var i=[],s=[],a=$t(t["!ref"]),o="",l,u="",f=[],p=0,g=0,m=t["!rows"],y=Array.isArray(t),x={r:u},w,A=-1;for(g=a.s.c;g<=a.e.c;++g)f[g]=Cr(g);for(p=a.s.r;p<=a.e.r;++p){for(s=[],u=Hr(p),g=a.s.c;g<=a.e.c;++g){l=f[g]+u;var k=y?(t[p]||[])[g]:t[l];k!==void 0&&(o=IO(k,l,t,e))!=null&&s.push(o)}(s.length>0||m&&m[p])&&(x={r:u},m&&m[p]&&(w=m[p],w.hidden&&(x.hidden=1),A=-1,w.hpx?A=pf(w.hpx):w.hpt&&(A=w.hpt),A>-1&&(x.ht=A,x.customHeight=1),w.level&&(x.outlineLevel=w.level)),i[i.length]=We("row",s.join(""),x))}if(m)for(;p<m.length;++p)m&&m[p]&&(x={r:p+1},w=m[p],w.hidden&&(x.hidden=1),A=-1,w.hpx?A=pf(w.hpx):w.hpt&&(A=w.hpt),A>-1&&(x.ht=A,x.customHeight=1),w.level&&(x.outlineLevel=w.level),i[i.length]=We("row","",x));return i.join("")}function uk(t,e,r,n){var i=[$r,We("worksheet",null,{xmlns:sc[0],"xmlns:r":fn.r})],s=r.SheetNames[t],a=0,o="",l=r.Sheets[s];l==null&&(l={});var u=l["!ref"]||"A1",f=$t(u);if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),u=St(f)}n||(n={}),l["!comments"]=[];var p=[];mO(l,r,t,e,i),i[i.length]=We("dimension",null,{ref:u}),i[i.length]=bO(l,e,t,r),e.sheetFormat&&(i[i.length]=We("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=TO(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=RO(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=yO(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=kO(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=pO(l["!merges"]));var g=-1,m,y=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(m={ref:x[0]},x[1].Target.charAt(0)!="#"&&(y=er(n,-1,tr(x[1].Target).replace(/#.*$/,""),bt.HLINK),m["r:id"]="rId"+y),(g=x[1].Target.indexOf("#"))>-1&&(m.location=tr(x[1].Target.slice(g+1))),x[1].Tooltip&&(m.tooltip=tr(x[1].Tooltip)),i[i.length]=We("hyperlink",null,m))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=wO(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Mn("ignoredErrors",We("ignoredError",null,{numberStoredAsText:1,sqref:u}))),p.length>0&&(y=er(n,-1,"../drawings/drawing"+(t+1)+".xml",bt.DRAW),i[i.length]=We("drawing",null,{"r:id":"rId"+y}),l["!drawing"]=p),l["!comments"].length>0&&(y=er(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",bt.VML),i[i.length]=We("legacyDrawing",null,{"r:id":"rId"+y}),l["!legacy"]=y),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function DO(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function PO(t,e,r){var n=ye(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=pf(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var u={r:t,c:0},f=0;f<16;++f)if(!(e.s.c>f+1<<10||e.e.c<f<<10)){for(var p=-1,g=-1,m=f<<10;m<f+1<<10;++m){u.c=m;var y=Array.isArray(r)?(r[u.r]||[])[u.c]:r[ft(u)];y&&(p<0&&(p=m),g=m)}p<0||(++o,n.write_shift(4,p),n.write_shift(4,g))}var x=n.l;return n.l=l,n.write_shift(4,o),n.l=x,n.length>n.l?n.slice(0,n.l):n}function OO(t,e,r,n){var i=PO(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&ke(t,0,i)}var MO=cc,BO=Du;function LO(){}function jO(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=zR(t),r}function VO(t,e,r){r==null&&(r=ye(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return qh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),aA(t,r),r.slice(0,r.l)}function UO(t){var e=Cs(t);return[e]}function zO(t,e,r){return r==null&&(r=ye(8)),ac(e,r)}function WO(t){var e=oc(t);return[e]}function HO(t,e,r){return r==null&&(r=ye(4)),lc(e,r)}function $O(t){var e=Cs(t),r=t.read_shift(1);return[e,r,"b"]}function GO(t,e,r){return r==null&&(r=ye(9)),ac(e,r),r.write_shift(1,t.v?1:0),r}function KO(t){var e=oc(t),r=t.read_shift(1);return[e,r,"b"]}function YO(t,e,r){return r==null&&(r=ye(5)),lc(e,r),r.write_shift(1,t.v?1:0),r}function XO(t){var e=Cs(t),r=t.read_shift(1);return[e,r,"e"]}function qO(t,e,r){return r==null&&(r=ye(9)),ac(e,r),r.write_shift(1,t.v),r}function QO(t){var e=oc(t),r=t.read_shift(1);return[e,r,"e"]}function JO(t,e,r){return r==null&&(r=ye(8)),lc(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function ZO(t){var e=Cs(t),r=t.read_shift(4);return[e,r,"s"]}function eM(t,e,r){return r==null&&(r=ye(12)),ac(e,r),r.write_shift(4,e.v),r}function tM(t){var e=oc(t),r=t.read_shift(4);return[e,r,"s"]}function rM(t,e,r){return r==null&&(r=ye(8)),lc(e,r),r.write_shift(4,e.v),r}function nM(t){var e=Cs(t),r=ii(t);return[e,r,"n"]}function iM(t,e,r){return r==null&&(r=ye(16)),ac(e,r),Yl(t.v,r),r}function dk(t){var e=oc(t),r=ii(t);return[e,r,"n"]}function sM(t,e,r){return r==null&&(r=ye(12)),lc(e,r),Yl(t.v,r),r}function aM(t){var e=Cs(t),r=X1(t);return[e,r,"n"]}function oM(t,e,r){return r==null&&(r=ye(12)),ac(e,r),oA(t.v,r),r}function lM(t){var e=oc(t),r=X1(t);return[e,r,"n"]}function cM(t,e,r){return r==null&&(r=ye(8)),lc(e,r),oA(t.v,r),r}function uM(t){var e=Cs(t),r=G1(t);return[e,r,"is"]}function dM(t){var e=Cs(t),r=si(t);return[e,r,"str"]}function fM(t,e,r){return r==null&&(r=ye(12+4*t.v.length)),ac(e,r),Cn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function hM(t){var e=oc(t),r=si(t);return[e,r,"str"]}function pM(t,e,r){return r==null&&(r=ye(8+4*t.v.length)),lc(e,r),Cn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function gM(t,e,r){var n=t.l+e,i=Cs(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=zp(t,n-t.l,r);a[3]=ei(o,null,i,r.supbooks,r)}else t.l=n;return a}function mM(t,e,r){var n=t.l+e,i=Cs(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=zp(t,n-t.l,r);a[3]=ei(o,null,i,r.supbooks,r)}else t.l=n;return a}function xM(t,e,r){var n=t.l+e,i=Cs(t);i.r=r["!row"];var s=ii(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=zp(t,n-t.l,r);a[3]=ei(o,null,i,r.supbooks,r)}else t.l=n;return a}function vM(t,e,r){var n=t.l+e,i=Cs(t);i.r=r["!row"];var s=si(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=zp(t,n-t.l,r);a[3]=ei(o,null,i,r.supbooks,r)}else t.l=n;return a}var yM=cc,_M=Du;function EM(t,e){return e==null&&(e=ye(4)),e.write_shift(4,t),e}function wM(t,e){var r=t.l+e,n=cc(t),i=K1(t),s=si(t),a=si(t),o=si(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function SM(t,e){var r=ye(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Du({s:Fr(t[0]),e:Fr(t[0])},r),Y1("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return Cn(i||"",r),Cn(t[1].Tooltip||"",r),Cn("",r),r.slice(0,r.l)}function TM(){}function AM(t,e,r){var n=t.l+e,i=lA(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=X5(t,n-t.l,r);a[1]=o}else t.l=n;return a}function kM(t,e,r){var n=t.l+e,i=cc(t),s=[i];if(r.cellFormula){var a=Q5(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function CM(t,e,r){r==null&&(r=ye(18));var n=Wp(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var fk=["left","right","top","bottom","header","footer"];function FM(t){var e={};return fk.forEach(function(r){e[r]=ii(t)}),e}function bM(t,e){return e==null&&(e=ye(6*8)),Ll(t),fk.forEach(function(r){Yl(t[r],e)}),e}function IM(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function NM(t,e,r){r==null&&(r=ye(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function RM(t){var e=ye(24);return e.write_shift(4,4),e.write_shift(4,1),Du(t,e),e}function DM(t,e){return e==null&&(e=ye(16*4+2)),e.write_shift(2,t.password?tv(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function PM(){}function OM(){}function MM(t,e,r,n,i,s,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},u,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,g=!1,m,y,x,w,A,k,_,O,G,U=[];o.biff=12,o["!row"]=0;var T=0,F=!1,S=[],I={},R=o.supbooks||i.supbooks||[[]];if(R.sharedf=I,R.arrayf=S,R.SheetNames=i.SheetNames||i.Sheets.map(function(Se){return Se.name}),!o.supbooks&&(o.supbooks=R,i.Names))for(var D=0;D<i.Names.length;++D)R[0][D+1]=i.Names[D];var N=[],Ge=[],_e=!1;gf[16]={n:"BrtShortReal",f:dk};var Re;if(no(t,function(te,Ce,je){if(!g)switch(je){case 148:u=te;break;case 0:m=te,o.sheetRows&&o.sheetRows<=m.r&&(g=!0),O=Hr(w=m.r),o["!row"]=m.r,(te.hidden||te.hpt||te.level!=null)&&(te.hpt&&(te.hpx=xu(te.hpt)),Ge[te.r]=te);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:te[2]},te[2]){case"n":y.v=te[1];break;case"s":_=Nd[te[1]],y.v=_.t,y.r=_.r;break;case"b":y.v=!!te[1];break;case"e":y.v=te[1],o.cellText!==!1&&(y.w=io[y.v]);break;case"str":y.t="s",y.v=te[1];break;case"is":y.t="s",y.v=te[1].t;break}if((x=a.CellXf[te[0].iStyleRef])&&lk(y,x.numFmtId,null,o,s,a),A=te[0].c==-1?A+1:te[0].c,o.dense?(l[w]||(l[w]=[]),l[w][A]=y):l[Cr(A)+O]=y,o.cellFormula){for(F=!1,T=0;T<S.length;++T){var W=S[T];m.r>=W[0].s.r&&m.r<=W[0].e.r&&A>=W[0].s.c&&A<=W[0].e.c&&(y.F=St(W[0]),F=!0)}!F&&te.length>3&&(y.f=te[3])}if(f.s.r>m.r&&(f.s.r=m.r),f.s.c>A&&(f.s.c=A),f.e.r<m.r&&(f.e.r=m.r),f.e.c<A&&(f.e.c=A),o.cellDates&&x&&y.t=="n"&&Iu(ut[x.numFmtId])){var re=Nl(y.v);re&&(y.t="d",y.v=new Date(re.y,re.m-1,re.d,re.H,re.M,re.S,re.u))}Re&&(Re.type=="XLDAPR"&&(y.D=!0),Re=void 0);break;case 1:case 12:if(!o.sheetStubs||p)break;y={t:"z",v:void 0},A=te[0].c==-1?A+1:te[0].c,o.dense?(l[w]||(l[w]=[]),l[w][A]=y):l[Cr(A)+O]=y,f.s.r>m.r&&(f.s.r=m.r),f.s.c>A&&(f.s.c=A),f.e.r<m.r&&(f.e.r=m.r),f.e.c<A&&(f.e.c=A),Re&&(Re.type=="XLDAPR"&&(y.D=!0),Re=void 0);break;case 176:U.push(te);break;case 49:Re=((o.xlmeta||{}).Cell||[])[te-1];break;case 494:var ee=n["!id"][te.relId];for(ee?(te.Target=ee.Target,te.loc&&(te.Target+="#"+te.loc),te.Rel=ee):te.relId==""&&(te.Target="#"+te.loc),w=te.rfx.s.r;w<=te.rfx.e.r;++w)for(A=te.rfx.s.c;A<=te.rfx.e.c;++A)o.dense?(l[w]||(l[w]=[]),l[w][A]||(l[w][A]={t:"z",v:void 0}),l[w][A].l=te):(k=ft({c:A,r:w}),l[k]||(l[k]={t:"z",v:void 0}),l[k].l=te);break;case 426:if(!o.cellFormula)break;S.push(te),G=o.dense?l[w][A]:l[Cr(A)+O],G.f=ei(te[1],f,{r:m.r,c:A},R,o),G.F=St(te[0]);break;case 427:if(!o.cellFormula)break;I[ft(te[0].s)]=te[1],G=o.dense?l[w][A]:l[Cr(A)+O],G.f=ei(te[1],f,{r:m.r,c:A},R,o);break;case 60:if(!o.cellStyles)break;for(;te.e>=te.s;)N[te.e--]={width:te.w/256,hidden:!!(te.flags&1),level:te.level},_e||(_e=!0,rv(te.w/256)),Zo(N[te.e+1]);break;case 161:l["!autofilter"]={ref:St(te)};break;case 476:l["!margins"]=te;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),te.name&&(i.Sheets[r].CodeName=te.name),(te.above||te.left)&&(l["!outline"]={above:te.above,left:te.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),te.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!Ce.T){if(!p||o.WTF)throw new Error("Unexpected record 0x"+je.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=St(u||f)),o.sheetRows&&l["!ref"]){var Me=$t(l["!ref"]);o.sheetRows<=+Me.e.r&&(Me.e.r=o.sheetRows-1,Me.e.r>f.e.r&&(Me.e.r=f.e.r),Me.e.r<Me.s.r&&(Me.s.r=Me.e.r),Me.e.c>f.e.c&&(Me.e.c=f.e.c),Me.e.c<Me.s.c&&(Me.s.c=Me.e.c),l["!fullref"]=l["!ref"],l["!ref"]=St(Me))}return U.length>0&&(l["!merges"]=U),N.length>0&&(l["!cols"]=N),Ge.length>0&&(l["!rows"]=Ge),l}function BM(t,e,r,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=vr(e),e.z=e.z||ut[14],e.v=mn(xr(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r,c:n};switch(l.s=ul(i.cellXfs,e,i),e.l&&s["!links"].push([ft(l),e.l]),e.c&&s["!comments"].push([ft(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=ov(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?ke(t,18,rM(e,l)):ke(t,7,eM(e,l))):(l.t="str",a?ke(t,17,pM(e,l)):ke(t,6,fM(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?ke(t,13,cM(e,l)):ke(t,2,oM(e,l)):a?ke(t,16,sM(e,l)):ke(t,5,iM(e,l)),!0;case"b":return l.t="b",a?ke(t,15,YO(e,l)):ke(t,4,GO(e,l)),!0;case"e":return l.t="e",a?ke(t,14,JO(e,l)):ke(t,3,qO(e,l)),!0}return a?ke(t,12,HO(e,l)):ke(t,1,zO(e,l)),!0}function LM(t,e,r,n){var i=$t(e["!ref"]||"A1"),s,a="",o=[];ke(t,145);var l=Array.isArray(e),u=i.e.r;e["!rows"]&&(u=Math.max(i.e.r,e["!rows"].length-1));for(var f=i.s.r;f<=u;++f){a=Hr(f),OO(t,e,i,f);var p=!1;if(f<=i.e.r)for(var g=i.s.c;g<=i.e.c;++g){f===i.s.r&&(o[g]=Cr(g)),s=o[g]+a;var m=l?(e[f]||[])[g]:e[s];if(!m){p=!1;continue}p=BM(t,m,f,g,n,e,p)}}ke(t,146)}function jM(t,e){!e||!e["!merges"]||(ke(t,177,EM(e["!merges"].length)),e["!merges"].forEach(function(r){ke(t,176,_M(r))}),ke(t,178))}function VM(t,e){!e||!e["!cols"]||(ke(t,390),e["!cols"].forEach(function(r,n){r&&ke(t,60,CM(n,r))}),ke(t,391))}function UM(t,e){!e||!e["!ref"]||(ke(t,648),ke(t,649,RM($t(e["!ref"]))),ke(t,650))}function zM(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=er(r,-1,n[1].Target.replace(/#.*$/,""),bt.HLINK);ke(t,494,SM(n,i))}}),delete e["!links"]}function WM(t,e,r,n){if(e["!comments"].length>0){var i=er(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",bt.VML);ke(t,551,Y1("rId"+i)),e["!legacy"]=i}}function HM(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:St(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Vi(s);o.s.r==o.e.r&&(o.e.r=Vi(e["!ref"]).e.r,s=St(o));for(var l=0;l<a.length;++l){var u=a[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),ke(t,161,Du($t(s))),ke(t,162)}}function $M(t,e,r){ke(t,133),ke(t,137,NM(e,r)),ke(t,138),ke(t,134)}function GM(t,e){e["!protect"]&&ke(t,535,DM(e["!protect"]))}function KM(t,e,r,n){var i=ji(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=$t(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],ke(i,129),(r.vbaraw||a["!outline"])&&ke(i,147,VO(o,a["!outline"])),ke(i,148,BO(l)),$M(i,a,r.Workbook),VM(i,a),LM(i,a,t,e),GM(i,a),HM(i,a,r,t),jM(i,a),zM(i,a,n),a["!margins"]&&ke(i,476,bM(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&UM(i,a),WM(i,a,t,n),ke(i,130),i.end()}function YM(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var i=Ht((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function XM(t,e,r,n,i,s){var a=s||{"!type":"chart"};if(!t)return s;var o=0,l=0,u="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var g=YM(p);f.s.r=f.s.c=0,f.e.c=o,u=Cr(o),g[0].forEach(function(m,y){a[u+Hr(y)]={t:"n",v:m,z:g[1]},l=y}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(a["!ref"]=St(f)),a}function qM(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(ck);return o&&lv(o[0],s,i,r),(a=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function QM(t,e){t.l+=10;var r=si(t);return{name:r}}function JM(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return no(t,function(l,u,f){switch(f){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var cv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],ZM=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],eB=[],tB=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function P2(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=gr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function O2(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=gr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function hk(t){O2(t.WBProps,cv),O2(t.CalcPr,tB),P2(t.WBView,ZM),P2(t.Sheets,eB),nu.date1904=gr(t.WBProps.date1904)}function rB(t){return!t.Workbook||!t.Workbook.WBProps?"false":gr(t.Workbook.WBProps.date1904)?"true":"false"}var nB="][*?/\\".split("");function pk(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return nB.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function iB(t,e,r){t.forEach(function(n,i){pk(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function sB(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];iB(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)rO(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var aB=/<\w+:workbook/;function oB(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(t.replace(ci,function(l,u){var f=ht(l);switch(va(f[0])){case"<?xml":break;case"<workbook":l.match(aB)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[i];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":cv.forEach(function(p){if(f[p[0]]!=null)switch(p[2]){case"bool":r.WBProps[p[0]]=gr(f[p[0]]);break;case"int":r.WBProps[p[0]]=parseInt(f[p[0]],10);break;default:r.WBProps[p[0]]=f[p[0]]}}),f.codeName&&(r.WBProps.CodeName=or(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=Ht(or(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=or(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),gr(f.hidden||"0")&&(s.Hidden=!0),a=u+l.length;break;case"</definedName>":s.Ref=Ht(or(t.slice(a,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),sc.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return hk(r),r}function gk(t){var e=[$r];e[e.length]=We("workbook",null,{xmlns:sc[0],"xmlns:r":fn.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(cv.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=We("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:tr(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=We("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=We("definedName",tr(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function lB(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=nx(t),r.name=si(t),r}function cB(t,e){return e||(e=ye(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Y1(t.strRelID,e),Cn(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function uB(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?si(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function dB(t,e){e||(e=ye(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),aA(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function fB(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function hB(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=WR(t),a=q5(t,0,r),o=K1(t);t.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function pB(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],gf[16]={n:"BrtFRTArchID$",f:fB},no(t,function(l,u,f){switch(f){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=ei(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([f,l]):a[0]=[f,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(f),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!u.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},e),hk(r),r.Names=s,r.supbooks=a,r}function gB(t,e){ke(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};ke(t,156,cB(i))}ke(t,144)}function mB(t,e){e||(e=ye(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Cn("SheetJS",e),Cn(Wh.version,e),Cn(Wh.version,e),Cn("7262",e),e.length>e.l?e.slice(0,e.l):e}function xB(t,e){e||(e=ye(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function vB(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(ke(t,135),ke(t,158,xB(i)),ke(t,136))}}function yB(t,e){var r=ji();return ke(r,131),ke(r,128,mB()),ke(r,153,dB(t.Workbook&&t.Workbook.WBProps||null)),vB(r,t),gB(r,t),ke(r,132),r.end()}function _B(t,e,r){return e.slice(-4)===".bin"?pB(t,r):oB(t,r)}function EB(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?MM(t,n,r,i,s,a,o):hO(t,n,r,i,s,a,o)}function wB(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?JM(t,n,r,i,s):qM(t,n,r,i,s)}function SB(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?A8():k8()}function TB(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?S8():T8()}function AB(t,e,r,n){return e.slice(-4)===".bin"?_P(t,r,n):lP(t,r,n)}function kB(t,e,r){return XA(t,r)}function CB(t,e,r){return e.slice(-4)===".bin"?C6(t,r):T6(t,r)}function FB(t,e,r){return e.slice(-4)===".bin"?v8(t,r):c8(t,r)}function bB(t,e,r){return e.slice(-4)===".bin"?a8(t):i8(t)}function IB(t,e,r,n){return r.slice(-4)===".bin"?o8(t,e,r,n):void 0}function NB(t,e,r){return e.slice(-4)===".bin"?t8(t,e,r):n8(t,e,r)}function RB(t,e,r){return(e.slice(-4)===".bin"?yB:gk)(t)}function DB(t,e,r,n,i){return(e.slice(-4)===".bin"?KM:uk)(t,r,n,i)}function PB(t,e,r){return(e.slice(-4)===".bin"?IP:KA)(t,r)}function OB(t,e,r){return(e.slice(-4)===".bin"?I6:jA)(t,r)}function MB(t,e,r){return(e.slice(-4)===".bin"?y8:JA)(t)}function BB(t){return(t.slice(-4)===".bin"?r8:qA)()}var mk=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,xk=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Bs(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(mk),s,a,o,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(xk),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function LB(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(mk),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(xk),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var Dd;function jB(t,e){var r=Dd[t]||Ht(t);return r==="General"?Gl(e):ks(r,e)}function VB(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=gr(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=xr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Ht(e)]=i}function UB(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||io[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=af(t.v):t.w=Gl(t.v):t.w=jB(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=Dd[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Iu(n)){var i=Nl(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function zB(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=eP[n.Pattern]||n.Pattern)}t[e.ID]=e}function WB(t,e,r,n,i,s,a,o,l,u){var f="General",p=n.StyleID,g={};u=u||{};var m=[],y=0;for(p===void 0&&o&&(p=o.StyleID),p===void 0&&a&&(p=a.StyleID);s[p]!==void 0&&(s[p].nf&&(f=s[p].nf),s[p].Interior&&m.push(s[p].Interior),!!s[p].Parent);)p=s[p].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=gr(t);break;case"String":n.t="s",n.r=J_(Ht(t)),n.v=t.indexOf("<")>-1?Ht(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(xr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Ht(t):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=dA[t],u.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=J_(e||t));break}if(UB(n,f,u),u.cellFormula!==!1)if(n.Formula){var x=Ht(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=ru(x,i),delete n.Formula,n.ArrayRange=="RC"?n.F=ru("RC:RC",i):n.ArrayRange&&(n.F=ru(n.ArrayRange,i),l.push([$t(n.F),n.F]))}else for(y=0;y<l.length;++y)i.r>=l[y][0].s.r&&i.r<=l[y][0].e.r&&i.c>=l[y][0].s.c&&i.c<=l[y][0].e.c&&(n.F=l[y][1]);u.cellStyles&&(m.forEach(function(w){!g.patternType&&w.patternType&&(g.patternType=w.patternType)}),n.s=g),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function HB(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Vg(t,e){var r=e||{};Nu();var n=dd(U1(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=or(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=vr(r);return a.type="string",mu.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ir){i.indexOf("<"+ir)>=0&&(s=!0)}),s)return bL(n,r);Dd={"General Number":"General","General Date":ut[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ut[15],"Short Date":ut[14],"Long Time":ut[19],"Medium Time":ut[18],"Short Time":ut[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ut[2],Standard:ut[4],Percent:ut[10],Scientific:ut[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],u,f={},p=[],g=r.dense?[]:{},m="",y={},x={},w=Bs('<Data ss:Type="String">'),A=0,k=0,_=0,O={s:{r:2e6,c:2e6},e:{r:0,c:0}},G={},U={},T="",F=0,S=[],I={},R={},D=0,N=[],Ge=[],_e={},Re=[],Me,Se=!1,te=[],Ce=[],je={},W=0,re=0,ee={Sheets:[],WBProps:{date1904:!1}},Y={};cf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var xe="";o=cf.exec(n);)switch(o[3]=(xe=o[3]).toLowerCase()){case"data":if(xe=="data"){if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?WB(n.slice(A,o.index),T,w,l[l.length-1][0]=="comment"?_e:y,{c:k,r:_},G,Re[k],x,te,r):(T="",w=Bs(o[0]),A=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(Ge.length>0&&(y.c=Ge),(!r.sheetRows||r.sheetRows>_)&&y.v!==void 0&&(r.dense?(g[_]||(g[_]=[]),g[_][k]=y):g[Cr(k)+Hr(_)]=y),y.HRef&&(y.l={Target:Ht(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(W=k+(parseInt(y.MergeAcross,10)|0),re=_+(parseInt(y.MergeDown,10)|0),S.push({s:{c:k,r:_},e:{c:W,r:re}})),!r.sheetStubs)y.MergeAcross?k=W+1:++k;else if(y.MergeAcross||y.MergeDown){for(var Ee=k;Ee<=W;++Ee)for(var Le=_;Le<=re;++Le)(Ee>k||Le>_)&&(r.dense?(g[Le]||(g[Le]=[]),g[Le][Ee]={t:"z"}):g[Cr(Ee)+Hr(Le)]={t:"z"});k=W+1}else++k;else y=LB(o[0]),y.Index&&(k=+y.Index-1),k<O.s.c&&(O.s.c=k),k>O.e.c&&(O.e.c=k),o[0].slice(-2)==="/>"&&++k,Ge=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(_<O.s.r&&(O.s.r=_),_>O.e.r&&(O.e.r=_),o[0].slice(-2)==="/>"&&(x=Bs(o[0]),x.Index&&(_=+x.Index-1)),k=0,++_):(x=Bs(o[0]),x.Index&&(_=+x.Index-1),je={},(x.AutoFitHeight=="0"||x.Height)&&(je.hpx=parseInt(x.Height,10),je.hpt=pf(je.hpx),Ce[_]=je),x.Hidden=="1"&&(je.hidden=!0,Ce[_]=je));break;case"worksheet":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));p.push(m),O.s.r<=O.e.r&&O.s.c<=O.e.c&&(g["!ref"]=St(O),r.sheetRows&&r.sheetRows<=O.e.r&&(g["!fullref"]=g["!ref"],O.e.r=r.sheetRows-1,g["!ref"]=St(O))),S.length&&(g["!merges"]=S),Re.length>0&&(g["!cols"]=Re),Ce.length>0&&(g["!rows"]=Ce),f[m]=g}else O={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=k=0,l.push([o[3],!1]),u=Bs(o[0]),m=Ht(u.Name),g=r.dense?[]:{},S=[],te=[],Ce=[],Y={name:m,Hidden:0},ee.Sheets.push(Y);break;case"table":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),Re=[],Se=!1}break;case"style":o[1]==="/"?zB(G,U,r):U=Bs(o[0]);break;case"numberformat":U.nf=Ht(Bs(o[0]).Format||"General"),Dd[U.nf]&&(U.nf=Dd[U.nf]);for(var Fe=0;Fe!=392&&ut[Fe]!=U.nf;++Fe);if(Fe==392){for(Fe=57;Fe!=392;++Fe)if(ut[Fe]==null){za(U.nf,Fe);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(Me=Bs(o[0]),Me.Hidden&&(Me.hidden=!0,delete Me.Hidden),Me.Width&&(Me.wpx=parseInt(Me.Width,10)),!Se&&Me.wpx>10){Se=!0,ri=$A;for(var Ae=0;Ae<Re.length;++Ae)Re[Ae]&&Zo(Re[Ae])}Se&&Zo(Me),Re[Me.Index-1||Re.length]=Me;for(var it=0;it<+Me.Span;++it)Re[Re.length]=vr(Me);break;case"namedrange":if(o[1]==="/")break;ee.Names||(ee.Names=[]);var q=ht(o[0]),Pt={Name:q.Name,Ref:ru(q.RefersTo.slice(1),{r:0,c:0})};ee.Sheets.length>0&&(Pt.Sheet=ee.Sheets.length-1),ee.Names.push(Pt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?T+=n.slice(F,o.index):F=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;U.Interior=Bs(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?pD(I,xe,n.slice(D,o.index)):D=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));HB(_e),Ge.push(_e)}else l.push([o[3],!1]),u=Bs(o[0]),_e={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Et=Bs(o[0]);g["!autofilter"]={ref:ru(Et.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return V2(n,r);var Nt=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Nt=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Nt=!1}break;case"excelworkbook":switch(o[3]){case"date1904":ee.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Nt=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Nt=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(D,o.index)){case"SheetHidden":Y.Hidden=1;break;case"SheetVeryHidden":Y.Hidden=2;break}else D=o.index+o[0].length;break;case"header":g["!margins"]||Ll(g["!margins"]={},"xlml"),isNaN(+ht(o[0]).Margin)||(g["!margins"].header=+ht(o[0]).Margin);break;case"footer":g["!margins"]||Ll(g["!margins"]={},"xlml"),isNaN(+ht(o[0]).Margin)||(g["!margins"].footer=+ht(o[0]).Margin);break;case"pagemargins":var xt=ht(o[0]);g["!margins"]||Ll(g["!margins"]={},"xlml"),isNaN(+xt.Top)||(g["!margins"].top=+xt.Top),isNaN(+xt.Left)||(g["!margins"].left=+xt.Left),isNaN(+xt.Right)||(g["!margins"].right=+xt.Right),isNaN(+xt.Bottom)||(g["!margins"].bottom=+xt.Bottom);break;case"displayrighttoleft":ee.Views||(ee.Views=[]),ee.Views[0]||(ee.Views[0]={}),ee.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Nt=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Nt=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Nt=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Nt=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Nt=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Nt=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Nt=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Nt=!1}break;case"smarttags":break;default:Nt=!1;break}if(Nt||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?VB(R,xe,N,n.slice(D,o.index)):(N=o,D=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Ke={};return!r.bookSheets&&!r.bookProps&&(Ke.Sheets=f),Ke.SheetNames=p,Ke.Workbook=ee,Ke.SSF=vr(ut),Ke.Props=I,Ke.Custprops=R,Ke}function ux(t,e){switch(dv(e=e||{}),e.type||"base64"){case"base64":return Vg(Zi(t),e);case"binary":case"buffer":case"file":return Vg(t,e);case"array":return Vg(ll(t),e)}}function $B(t,e){var r=[];return t.Props&&r.push(gD(t.Props,e)),t.Custprops&&r.push(mD(t.Props,t.Custprops)),r.join("")}function GB(){return""}function KB(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(We("NumberFormat",null,{"ss:Format":tr(ut[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(We("Style",s.join(""),a))}),We("Styles",r.join(""))}function vk(t){return We("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+sv(t.Ref,{r:0,c:0})})}function YB(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(vk(i)))}return We("Names",r.join(""))}function XB(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(vk(o)))}return s.join("")}function qB(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(We("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(We("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(We("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(We("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(Mn("ProtectContents","True")),t["!protect"].objects&&i.push(Mn("ProtectObjects","True")),t["!protect"].scenarios&&i.push(Mn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(Mn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(Mn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":We("WorksheetOptions",i.join(""),{xmlns:$i.x})}function QB(t){return t.map(function(e){var r=vR(e.t||""),n=We("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return We("Comment",n,{"ss:Author":e.a})}).join("")}function JB(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+tr(sv(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var l=Fr(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=tr(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=tr(t.l.Tooltip))),r["!merges"])for(var u=r["!merges"],f=0;f!=u.length;++f)u[f].s.c!=a.c||u[f].s.r!=a.r||(u[f].e.c>u[f].s.c&&(o["ss:MergeAcross"]=u[f].e.c-u[f].s.c),u[f].e.r>u[f].s.r&&(o["ss:MergeDown"]=u[f].e.r-u[f].s.r));var p="",g="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":p="Number",g=String(t.v);break;case"b":p="Boolean",g=t.v?"1":"0";break;case"e":p="Error",g=io[t.v];break;case"d":p="DateTime",g=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||ut[14]);break;case"s":p="String",g=xR(t.v||"");break}var m=ul(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+m),o["ss:Index"]=a.c+1;var y=t.v!=null?g:"",x=t.t=="z"?"":'<Data ss:Type="'+p+'">'+y+"</Data>";return(t.c||[]).length>0&&(x+=QB(t.c)),We("Cell",x,o)}function ZB(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=xu(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function eL(t,e,r,n){if(!t["!ref"])return"";var i=$t(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(w,A){Zo(w);var k=!!w.width,_=Wp(A,w),O={"ss:Index":A+1};k&&(O["ss:Width"]=ff(_.width)),w.hidden&&(O["ss:Hidden"]="1"),o.push(We("Column",null,O))});for(var l=Array.isArray(t),u=i.s.r;u<=i.e.r;++u){for(var f=[ZB(u,(t["!rows"]||[])[u])],p=i.s.c;p<=i.e.c;++p){var g=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>p)&&!(s[a].s.r>u)&&!(s[a].e.c<p)&&!(s[a].e.r<u)){(s[a].s.c!=p||s[a].s.r!=u)&&(g=!0);break}if(!g){var m={r:u,c:p},y=ft(m),x=l?(t[u]||[])[p]:t[y];f.push(JB(x,y,t,e,r,n,m))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function tL(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?XB(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?eL(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(qB(s,e,t,r)),n.join("")}function rL(t,e){e||(e={}),t.SSF||(t.SSF=vr(ut)),t.SSF&&(Nu(),Mp(t.SSF),e.revssf=Lp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],ul(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push($B(t,e)),r.push(GB()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(We("Worksheet",tL(n,e,t),{"ss:Name":tr(t.SheetNames[n])}));return r[2]=KB(t,e),r[3]=YB(t),$r+We("Workbook",r.join(""),{xmlns:$i.ss,"xmlns:o":$i.o,"xmlns:x":$i.x,"xmlns:ss":$i.ss,"xmlns:dt":$i.dt,"xmlns:html":$i.html})}function nL(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=YR(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=XR(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var iL=[60,1084,2066,2165,2175];function sL(t,e,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var l=Ma(r,r.l),u=dx[l],f=0;u!=null&&iL.indexOf(l)>-1;)s=Ma(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=r.slice(f,r.l+4+s),a.push(o),r.l+=4+s,u=dx[l=Ma(r,r.l)];var p=kn(a);On(p,0);var g=0;p.lens=[];for(var m=0;m<a.length;++m)p.lens.push(g),g+=a[m].length;if(p.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+p.length+" < "+n;return e.f(p,p.length,i)}function ia(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=ut[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||io[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=af(t.v):t.w=Gl(t.v):t.w=ks(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&Iu(ut[n]||String(n))){var i=Nl(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function M0(t,e,r){return{v:t,ixfe:e,t:r}}function aL(t,e){var r={opts:{}},n={},i=e.dense?[]:{},s={},a={},o=null,l=[],u="",f={},p,g="",m,y,x,w,A={},k=[],_,O,G=[],U=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},F={},S=function(pt){return pt<8?Ol[pt]:pt<64&&U[pt-8]||Ol[pt]},I=function(pt,fr,hr){var yr=fr.XF.data;if(!(!yr||!yr.patternType||!hr||!hr.cellStyles)){fr.s={},fr.s.patternType=yr.patternType;var di;(di=df(S(yr.icvFore)))&&(fr.s.fgColor={rgb:di}),(di=df(S(yr.icvBack)))&&(fr.s.bgColor={rgb:di})}},R=function(pt,fr,hr){if(!(je>1)&&!(hr.sheetRows&&pt.r>=hr.sheetRows)){if(hr.cellStyles&&fr.XF&&fr.XF.data&&I(pt,fr,hr),delete fr.ixfe,delete fr.XF,p=pt,g=ft(pt),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),pt.r<a.s.r&&(a.s.r=pt.r),pt.c<a.s.c&&(a.s.c=pt.c),pt.r+1>a.e.r&&(a.e.r=pt.r+1),pt.c+1>a.e.c&&(a.e.c=pt.c+1),hr.cellFormula&&fr.f){for(var yr=0;yr<k.length;++yr)if(!(k[yr][0].s.c>pt.c||k[yr][0].s.r>pt.r)&&!(k[yr][0].e.c<pt.c||k[yr][0].e.r<pt.r)){fr.F=St(k[yr][0]),(k[yr][0].s.c!=pt.c||k[yr][0].s.r!=pt.r)&&delete fr.f,fr.f&&(fr.f=""+ei(k[yr][1],a,pt,te,D));break}}hr.dense?(i[pt.r]||(i[pt.r]=[]),i[pt.r][pt.c]=fr):i[g]=fr}},D={enc:!1,sbcch:0,snames:[],sharedf:A,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(D.password=e.password);var N,Ge=[],_e=[],Re=[],Me=[],Se=!1,te=[];te.SheetNames=D.snames,te.sharedf=D.sharedf,te.arrayf=D.arrayf,te.names=[],te.XTI=[];var Ce=0,je=0,W=0,re=[],ee=[],Y;D.codepage=1200,Ws(1200);for(var xe=!1;t.l<t.length-1;){var Ee=t.l,Le=t.read_shift(2);if(Le===0&&Ce===10)break;var Fe=t.l===t.length?0:t.read_shift(2),Ae=dx[Le];if(Ae&&Ae.f){if(e.bookSheets&&Ce===133&&Le!==133)break;if(Ce=Le,Ae.r===2||Ae.r==12){var it=t.read_shift(2);if(Fe-=2,!D.enc&&it!==Le&&((it&255)<<8|it>>8)!==Le)throw new Error("rt mismatch: "+it+"!="+Le);Ae.r==12&&(t.l+=10,Fe-=10)}var q={};if(Le===10?q=Ae.f(t,Fe,D):q=sL(Le,Ae,t,Fe,D),je==0&&[9,521,1033,2057].indexOf(Ce)===-1)continue;switch(Le){case 34:r.opts.Date1904=T.WBProps.date1904=q;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(t.l=0),D.enc=q,!e.password)throw new Error("File is password-protected");if(q.valid==null)throw new Error("Encryption scheme unsupported");if(!q.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=q;break;case 66:var Pt=Number(q);switch(Pt){case 21010:Pt=1200;break;case 32768:Pt=1e4;break;case 32769:Pt=1252;break}Ws(D.codepage=Pt),xe=!0;break;case 317:D.rrtabid=q;break;case 25:D.winlocked=q;break;case 439:r.opts.RefreshAll=q;break;case 12:r.opts.CalcCount=q;break;case 16:r.opts.CalcDelta=q;break;case 17:r.opts.CalcIter=q;break;case 13:r.opts.CalcMode=q;break;case 14:r.opts.CalcPrecision=q;break;case 95:r.opts.CalcSaveRecalc=q;break;case 15:D.CalcRefMode=q;break;case 2211:r.opts.FullCalc=q;break;case 129:q.fDialog&&(i["!type"]="dialog"),q.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),q.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:G.push(q);break;case 430:te.push([q]),te[te.length-1].XTI=[];break;case 35:case 547:te[te.length-1].push(q);break;case 24:case 536:Y={Name:q.Name,Ref:ei(q.rgce,a,null,te,D)},q.itab>0&&(Y.Sheet=q.itab-1),te.names.push(Y),te[0]||(te[0]=[],te[0].XTI=[]),te[te.length-1].push(q),q.Name=="_xlnm._FilterDatabase"&&q.itab>0&&q.rgce&&q.rgce[0]&&q.rgce[0][0]&&q.rgce[0][0][0]=="PtgArea3d"&&(ee[q.itab-1]={ref:St(q.rgce[0][0][1][2])});break;case 22:D.ExternCount=q;break;case 23:te.length==0&&(te[0]=[],te[0].XTI=[]),te[te.length-1].XTI=te[te.length-1].XTI.concat(q),te.XTI=te.XTI.concat(q);break;case 2196:if(D.biff<8)break;Y!=null&&(Y.Comment=q[1]);break;case 18:i["!protect"]=q;break;case 19:q!==0&&D.WTF&&console.error("Password verifier: "+q);break;case 133:s[q.pos]=q,D.snames.push(q.name);break;case 10:{if(--je)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=St(a),e.sheetRows&&e.sheetRows<=a.e.r){var Et=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=St(a),a.e.r=Et}a.e.r++,a.e.c++}Ge.length>0&&(i["!merges"]=Ge),_e.length>0&&(i["!objects"]=_e),Re.length>0&&(i["!cols"]=Re),Me.length>0&&(i["!rows"]=Me),T.Sheets.push(F)}u===""?f=i:n[u]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[Le]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[q.BIFFVer]||8),D.biffguess=q.BIFFVer==0,q.BIFFVer==0&&q.dt==4096&&(D.biff=5,xe=!0,Ws(D.codepage=28591)),D.biff==8&&q.BIFFVer==0&&q.dt==16&&(D.biff=2),je++)break;if(i=e.dense?[]:{},D.biff<8&&!xe&&(xe=!0,Ws(D.codepage=e.codepage||1252)),D.biff<5||q.BIFFVer==0&&q.dt==4096){u===""&&(u="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var Nt={pos:t.l-Fe,name:u};s[Nt.pos]=Nt,D.snames.push(u)}else u=(s[Ee]||{name:""}).name;q.dt==32&&(i["!type"]="chart"),q.dt==64&&(i["!type"]="macro"),Ge=[],_e=[],D.arrayf=k=[],Re=[],Me=[],Se=!1,F={Hidden:(s[Ee]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[q.r]||[])[q.c]:i[ft({c:q.c,r:q.r})])&&++q.c,_={ixfe:q.ixfe,XF:G[q.ixfe]||{},v:q.val,t:"n"},W>0&&(_.z=re[_.ixfe>>8&63]),ia(_,e,r.opts.Date1904),R({c:q.c,r:q.r},_,e);break;case 5:case 517:_={ixfe:q.ixfe,XF:G[q.ixfe],v:q.val,t:q.t},W>0&&(_.z=re[_.ixfe>>8&63]),ia(_,e,r.opts.Date1904),R({c:q.c,r:q.r},_,e);break;case 638:_={ixfe:q.ixfe,XF:G[q.ixfe],v:q.rknum,t:"n"},W>0&&(_.z=re[_.ixfe>>8&63]),ia(_,e,r.opts.Date1904),R({c:q.c,r:q.r},_,e);break;case 189:for(var xt=q.c;xt<=q.C;++xt){var Ke=q.rkrec[xt-q.c][0];_={ixfe:Ke,XF:G[Ke],v:q.rkrec[xt-q.c][1],t:"n"},W>0&&(_.z=re[_.ixfe>>8&63]),ia(_,e,r.opts.Date1904),R({c:xt,r:q.r},_,e)}break;case 6:case 518:case 1030:{if(q.val=="String"){o=q;break}if(_=M0(q.val,q.cell.ixfe,q.tt),_.XF=G[_.ixfe],e.cellFormula){var ir=q.formula;if(ir&&ir[0]&&ir[0][0]&&ir[0][0][0]=="PtgExp"){var bn=ir[0][0][1][0],en=ir[0][0][1][1],wi=ft({r:bn,c:en});A[wi]?_.f=""+ei(q.formula,a,q.cell,te,D):_.F=((e.dense?(i[bn]||[])[en]:i[wi])||{}).F}else _.f=""+ei(q.formula,a,q.cell,te,D)}W>0&&(_.z=re[_.ixfe>>8&63]),ia(_,e,r.opts.Date1904),R(q.cell,_,e),o=q}break;case 7:case 519:if(o)o.val=q,_=M0(q,o.cell.ixfe,"s"),_.XF=G[_.ixfe],e.cellFormula&&(_.f=""+ei(o.formula,a,o.cell,te,D)),W>0&&(_.z=re[_.ixfe>>8&63]),ia(_,e,r.opts.Date1904),R(o.cell,_,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(q);var rs=ft(q[0].s);if(m=e.dense?(i[q[0].s.r]||[])[q[0].s.c]:i[rs],e.cellFormula&&m){if(!o||!rs||!m)break;m.f=""+ei(q[1],a,q[0],te,D),m.F=St(q[0])}}break;case 1212:{if(!e.cellFormula)break;if(g){if(!o)break;A[ft(o.cell)]=q[0],m=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[ft(o.cell)],(m||{}).f=""+ei(q[0],a,p,te,D)}}break;case 253:_=M0(l[q.isst].t,q.ixfe,"s"),l[q.isst].h&&(_.h=l[q.isst].h),_.XF=G[_.ixfe],W>0&&(_.z=re[_.ixfe>>8&63]),ia(_,e,r.opts.Date1904),R({c:q.c,r:q.r},_,e);break;case 513:e.sheetStubs&&(_={ixfe:q.ixfe,XF:G[q.ixfe],t:"z"},W>0&&(_.z=re[_.ixfe>>8&63]),ia(_,e,r.opts.Date1904),R({c:q.c,r:q.r},_,e));break;case 190:if(e.sheetStubs)for(var Si=q.c;Si<=q.C;++Si){var Lr=q.ixfe[Si-q.c];_={ixfe:Lr,XF:G[Lr],t:"z"},W>0&&(_.z=re[_.ixfe>>8&63]),ia(_,e,r.opts.Date1904),R({c:Si,r:q.r},_,e)}break;case 214:case 516:case 4:_=M0(q.val,q.ixfe,"s"),_.XF=G[_.ixfe],W>0&&(_.z=re[_.ixfe>>8&63]),ia(_,e,r.opts.Date1904),R({c:q.c,r:q.r},_,e);break;case 0:case 512:je===1&&(a=q);break;case 252:l=q;break;case 1054:if(D.biff==4){re[W++]=q[1];for(var Ti=0;Ti<W+163&&ut[Ti]!=q[1];++Ti);Ti>=163&&za(q[1],W+163)}else za(q[1],q[0]);break;case 30:{re[W++]=q;for(var qt=0;qt<W+163&&ut[qt]!=q;++qt);qt>=163&&za(q,W+163)}break;case 229:Ge=Ge.concat(q);break;case 93:_e[q.cmo[0]]=D.lastobj=q;break;case 438:D.lastobj.TxO=q;break;case 127:D.lastobj.ImData=q;break;case 440:for(w=q[0].s.r;w<=q[0].e.r;++w)for(x=q[0].s.c;x<=q[0].e.c;++x)m=e.dense?(i[w]||[])[x]:i[ft({c:x,r:w})],m&&(m.l=q[1]);break;case 2048:for(w=q[0].s.r;w<=q[0].e.r;++w)for(x=q[0].s.c;x<=q[0].e.c;++x)m=e.dense?(i[w]||[])[x]:i[ft({c:x,r:w})],m&&m.l&&(m.l.Tooltip=q[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;m=e.dense?(i[q[0].r]||[])[q[0].c]:i[ft(q[0])];var Sr=_e[q[2]];m||(e.dense?(i[q[0].r]||(i[q[0].r]=[]),m=i[q[0].r][q[0].c]={t:"z"}):m=i[ft(q[0])]={t:"z"},a.e.r=Math.max(a.e.r,q[0].r),a.s.r=Math.min(a.s.r,q[0].r),a.e.c=Math.max(a.e.c,q[0].c),a.s.c=Math.min(a.s.c,q[0].c)),m.c||(m.c=[]),y={a:q[1],t:Sr.TxO.t},m.c.push(y)}break;case 2173:KP(G[q.ixfe],q.ext);break;case 125:{if(!D.cellStyles)break;for(;q.e>=q.s;)Re[q.e--]={width:q.w/256,level:q.level||0,hidden:!!(q.flags&1)},Se||(Se=!0,rv(q.w/256)),Zo(Re[q.e+1])}break;case 520:{var dr={};q.level!=null&&(Me[q.r]=dr,dr.level=q.level),q.hidden&&(Me[q.r]=dr,dr.hidden=!0),q.hpt&&(Me[q.r]=dr,dr.hpt=q.hpt,dr.hpx=xu(q.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Ll(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Le]]=q;break;case 161:i["!margins"]||Ll(i["!margins"]={}),i["!margins"].header=q.header,i["!margins"].footer=q.footer;break;case 574:q.RTL&&(T.Views[0].RTL=!0);break;case 146:U=q;break;case 2198:N=q;break;case 140:O=q;break;case 442:u?F.CodeName=q||F.name:T.WBProps.CodeName=q||"ThisWorkbook";break}}else Ae||console.error("Missing Info for XLS Record 0x"+Le.toString(16)),t.l+=Fe}return r.SheetNames=Br(s).sort(function(ui,pt){return Number(ui)-Number(pt)}).map(function(ui){return s[ui].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&ee.forEach(function(ui,pt){r.Sheets[r.SheetNames[pt]]["!autofilter"]=ui}),r.Strings=l,r.SSF=vr(ut),D.enc&&(r.Encryption=D.enc),N&&(r.Themes=N),r.Metadata={},O!==void 0&&(r.Metadata.Country=O),te.names.length>0&&(T.Names=te.names),r.Workbook=T,r}var Pd={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function oL(t,e,r){var n=nt.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=m2(n,ix,Pd.DSI);for(var s in i)e[s]=i[s]}catch(u){if(r.WTF)throw u}var a=nt.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=m2(a,sx,Pd.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(u){if(r.WTF)throw u}e.HeadingPairs&&e.TitlesOfParts&&(xA(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function lL(t,e){var r=[],n=[],i=[],s=0,a,o=G_(ix,"n"),l=G_(sx,"n");if(t.Props)for(a=Br(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=Br(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var u=[];for(s=0;s<i.length;++s)TA.indexOf(i[s][0])>-1||mA.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);n.length&&nt.utils.cfb_add(e,"/SummaryInformation",x2(n,Pd.SI,l,sx)),(r.length||u.length)&&nt.utils.cfb_add(e,"/DocumentSummaryInformation",x2(r,Pd.DSI,o,ix,u.length?u:null,Pd.UDI))}function yk(t,e){e||(e={}),dv(e),R1(),e.codepage&&N1(e.codepage);var r,n;if(t.FullPaths){if(nt.find(t,"/encryption"))throw new Error("File is password-protected");r=nt.find(t,"!CompObj"),n=nt.find(t,"/Workbook")||nt.find(t,"/Book")}else{switch(e.type){case"base64":t=Ki(Zi(t));break;case"binary":t=Ki(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}On(t,0),n={content:t}}var i,s;if(r&&nL(r),e.bookProps&&!e.bookSheets)i={};else{var a=kt?"buffer":"array";if(n&&n.content)i=aL(n.content,e);else if((s=nt.find(t,"PerfectOffice_MAIN"))&&s.content)i=Bl.to_workbook(s.content,(e.type=a,e));else if((s=nt.find(t,"NativeContent_MAIN"))&&s.content)i=Bl.to_workbook(s.content,(e.type=a,e));else throw(s=nt.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&nt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=E8(t))}var o={};return t.FullPaths&&oL(t,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=t),i}function cL(t,e){var r=e||{},n=nt.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return nt.utils.cfb_add(n,i,_k(t,r)),r.biff==8&&(t.Props||t.Custprops)&&lL(t,n),r.biff==8&&t.vbaraw&&w8(n,nt.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var gf={0:{f:DO},1:{f:UO},2:{f:aM},3:{f:XO},4:{f:$O},5:{f:nM},6:{f:dM},7:{f:ZO},8:{f:vM},9:{f:xM},10:{f:gM},11:{f:mM},12:{f:WO},13:{f:lM},14:{f:QO},15:{f:KO},16:{f:dk},17:{f:hM},18:{f:tM},19:{f:G1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:hB},40:{},42:{},43:{f:dP},44:{f:cP},45:{f:pP},46:{f:mP},47:{f:gP},48:{},49:{f:MR},50:{},51:{f:qP},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:OA},62:{f:uM},63:{f:s8},64:{f:PM},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:oi,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:IM},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:jO},148:{f:MO,p:16},151:{f:TM},152:{},153:{f:uB},154:{},155:{},156:{f:lB},157:{},158:{},159:{T:1,f:k6},160:{T:-1},161:{T:1,f:cc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:yM},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:YP},336:{T:-1},337:{f:ZP,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:nx},357:{},358:{},359:{},360:{T:1},361:{},362:{f:PA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:AM},427:{f:kM},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:FM},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:LO},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:wM},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:nx},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:m8},633:{T:1},634:{T:-1},635:{T:1,f:p8},636:{T:-1},637:{f:VR},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:QM},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:OM},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},dx={6:{f:Lg},10:{f:_o},12:{f:Jr},13:{f:Jr},14:{f:Ur},15:{f:Ur},16:{f:ii},17:{f:Ur},18:{f:Ur},19:{f:Jr},20:{f:S2},21:{f:S2},23:{f:PA},24:{f:A2},25:{f:Ur},26:{},27:{},28:{f:O3},29:{},34:{f:Ur},35:{f:T2},38:{f:ii},39:{f:ii},40:{f:ii},41:{f:ii},42:{f:Ur},43:{f:Ur},47:{f:K6},49:{f:l3},51:{f:Jr},60:{},61:{f:n3},64:{f:Ur},65:{f:o3},66:{f:Jr},77:{},80:{},81:{},82:{},85:{f:Jr},89:{},90:{},91:{},92:{f:GD},93:{f:L3},94:{},95:{f:Ur},96:{},97:{},99:{f:Ur},125:{f:OA},128:{f:S3},129:{f:YD},130:{f:Jr},131:{f:Ur},132:{f:Ur},133:{f:XD},134:{},140:{f:G3},141:{f:Jr},144:{},146:{f:X3},151:{},152:{},153:{},154:{},155:{},156:{f:Jr},157:{},158:{},160:{f:r6},161:{f:J3},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:y3},190:{f:_3},193:{f:_o},197:{},198:{},199:{},200:{},201:{},202:{f:Ur},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Jr},220:{},221:{f:Ur},222:{},224:{f:w3},225:{f:$D},226:{f:_o},227:{},229:{f:M3},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:QD},253:{f:u3},255:{f:ZD},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:AA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ur},353:{f:_o},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:F3},431:{f:Ur},432:{},433:{},434:{},437:{},438:{f:U3},439:{f:Ur},440:{f:z3},441:{},442:{f:Mf},443:{},444:{f:Jr},445:{},446:{},448:{f:_o},449:{f:r3,r:2},450:{f:_o},512:{f:_2},513:{f:t6},515:{f:k3},516:{f:f3},517:{f:w2},519:{f:n6},520:{f:e3},523:{},545:{f:k2},549:{f:y2},566:{},574:{f:s3},638:{f:v3},659:{},1048:{},1054:{f:p3},1084:{},1212:{f:R3},2048:{f:H3},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:D0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:_o},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:q3,r:12},2173:{f:GP,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ur,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:N3,r:12},2197:{},2198:{f:VP,r:12},2199:{},2200:{},2201:{},2202:{f:D3,r:12},2203:{f:_o},2204:{},2205:{},2206:{},2207:{},2211:{f:t3},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Jr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Z3},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Y3},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:_2},1:{},2:{f:l6},3:{f:a6},4:{f:s6},5:{f:w2},7:{f:u6},8:{},9:{f:D0},11:{},22:{f:Jr},30:{f:m3},31:{},32:{},33:{f:k2},36:{},37:{f:y2},50:{f:d6},62:{},52:{},67:{},68:{f:Jr},69:{},86:{},126:{},127:{f:i6},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:f6},223:{},234:{},354:{},421:{},518:{f:Lg},521:{f:D0},536:{f:A2},547:{f:T2},561:{},579:{},1030:{f:Lg},1033:{f:D0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function He(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&W1(r)&&t.push(r)}}function uL(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return He(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;var f=t.next(4);for(f.write_shift(2,s),f.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u;l<i;){for(f=t.next(4),f.write_shift(2,60),u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;f.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u}}}function Vf(t,e,r){return t||(t=ye(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function dL(t,e,r,n){var i=ye(9);return Vf(i,t,e),kA(r,n||"b",i),i}function fL(t,e,r){var n=ye(8+2*r.length);return Vf(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function hL(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?mn(xr(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?He(t,2,c6(r,n,i)):He(t,3,o6(r,n,i));return;case"b":case"e":He(t,5,dL(r,n,e.v,e.t));return;case"s":case"str":He(t,4,fL(r,n,(e.v||"").slice(0,255)));return}He(t,1,Vf(null,r,n))}function pL(t,e,r,n){var i=Array.isArray(e),s=$t(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=St(s)}for(var u=s.s.r;u<=s.e.r;++u){o=Hr(u);for(var f=s.s.c;f<=s.e.c;++f){u===s.s.r&&(l[f]=Cr(f)),a=l[f]+o;var p=i?(e[u]||[])[f]:e[a];p&&hL(t,p,u,f)}}}function gL(t,e){for(var r=e||{},n=ji(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return He(n,r.biff==4?1033:r.biff==3?521:9,Z1(t,16,r)),pL(n,t.Sheets[t.SheetNames[i]],i,r),He(n,10),n.end()}function mL(t,e,r){He(t,49,c3({sz:12,name:"Arial"},r))}function xL(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&He(t,1054,g3(i,e[i],r))})}function vL(t,e){var r=ye(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),He(t,2151,r),r=ye(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),NA($t(e["!ref"]||"A1"),r),r.write_shift(4,4),He(t,2152,r)}function yL(t,e){for(var r=0;r<16;++r)He(t,224,E2({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){He(t,224,E2(n,0,e))})}function _L(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];He(t,440,W3(n)),n[1].Tooltip&&He(t,2048,$3(n))}delete e["!links"]}function EL(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&He(t,125,Q3(Wp(i,n),i))})}}function wL(t,e,r,n,i){var s=16+ul(i.cellXfs,e,i);if(e.v==null&&!e.bf){He(t,513,ql(r,n,s));return}if(e.bf)He(t,6,Y5(e,r,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?mn(xr(e.v)):e.v;He(t,515,C3(r,n,a,s));break;case"b":case"e":He(t,517,A3(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=ov(i.Strings,e.v,i.revStrings);He(t,253,d3(r,n,o,s))}else He(t,516,h3(r,n,(e.v||"").slice(0,255),s,i));break;default:He(t,513,ql(r,n,s))}}function SL(t,e,r){var n=ji(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},l=Array.isArray(s),u=e.biff==8,f,p="",g=[],m=$t(s["!ref"]||"A1"),y=u?65536:16384;if(m.e.c>255||m.e.r>=y){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,y-1)}He(n,2057,Z1(r,16,e)),He(n,13,xs(1)),He(n,12,xs(100)),He(n,15,xi(!0)),He(n,17,xi(!1)),He(n,16,Yl(.001)),He(n,95,xi(!0)),He(n,42,xi(!1)),He(n,43,xi(!1)),He(n,130,xs(1)),He(n,128,T3()),He(n,131,xi(!1)),He(n,132,xi(!1)),u&&EL(n,s["!cols"]),He(n,512,x3(m,e)),u&&(s["!links"]=[]);for(var x=m.s.r;x<=m.e.r;++x){p=Hr(x);for(var w=m.s.c;w<=m.e.c;++w){x===m.s.r&&(g[w]=Cr(w)),f=g[w]+p;var A=l?(s[x]||[])[w]:s[f];A&&(wL(n,A,x,w,e),u&&A.l&&s["!links"].push([f,A.l]))}}var k=o.CodeName||o.name||i;return u&&He(n,574,a3((a.Views||[])[0])),u&&(s["!merges"]||[]).length&&He(n,229,B3(s["!merges"])),u&&_L(n,s),He(n,442,CA(k)),u&&vL(n,s),He(n,10),n.end()}function TL(t,e,r){var n=ji(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(He(n,2057,Z1(t,5,r)),r.bookType=="xla"&&He(n,135),He(n,225,o?xs(1200):null),He(n,193,AD(2)),l&&He(n,191),l&&He(n,192),He(n,226),He(n,92,KD("SheetJS",r)),He(n,66,xs(o?1200:1252)),o&&He(n,353,xs(0)),o&&He(n,448),He(n,317,e6(t.SheetNames.length)),o&&t.vbaraw&&He(n,211),o&&t.vbaraw){var u=a.CodeName||"ThisWorkbook";He(n,442,CA(u))}He(n,156,xs(17)),He(n,25,xi(!1)),He(n,18,xi(!1)),He(n,19,xs(0)),o&&He(n,431,xi(!1)),o&&He(n,444,xs(0)),He(n,61,i3()),He(n,64,xi(!1)),He(n,141,xs(0)),He(n,34,xi(rB(t)=="true")),He(n,14,xi(!0)),o&&He(n,439,xi(!1)),He(n,218,xs(0)),mL(n,t,r),xL(n,t.SSF,r),yL(n,r),o&&He(n,352,xi(!1));var f=n.end(),p=ji();o&&He(p,140,K3()),o&&r.Strings&&uL(p,252,JD(r.Strings)),He(p,10);var g=p.end(),m=ji(),y=0,x=0;for(x=0;x<t.SheetNames.length;++x)y+=(o?12:11)+(o?2:1)*t.SheetNames[x].length;var w=f.length+y+g.length;for(x=0;x<t.SheetNames.length;++x){var A=s[x]||{};He(m,133,qD({pos:w,hs:A.Hidden||0,dt:0,name:t.SheetNames[x]},r)),w+=e[x].length}var k=m.end();if(y!=k.length)throw new Error("BS8 "+y+" != "+k.length);var _=[];return f.length&&_.push(f),k.length&&_.push(k),g.length&&_.push(g),kn(_)}function AL(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=vr(ut)),t&&t.SSF&&(Nu(),Mp(t.SSF),r.revssf=Lp(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,fv(r),r.cellXfs=[],ul(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=SL(i,r,t);return n.unshift(TL(t,n,r)),kn(n)}function _k(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Vi(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return AL(t,e);case 4:case 3:case 2:return gL(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function M2(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),a=i.index,o=s&&s.index||t.length,l=cR(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,f=0,p=0,g=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(a=0;a<l.length;++a){var x=l[a].trim(),w=x.slice(0,3).toLowerCase();if(w=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}f=0;continue}if(!(w!="<td"&&w!="<th")){var A=x.split(/<\/t[dh]>/i);for(o=0;o<A.length;++o){var k=A[o].trim();if(k.match(/<t[dh]/i)){for(var _=k,O=0;_.charAt(0)=="<"&&(O=_.indexOf(">"))>-1;)_=_.slice(O+1);for(var G=0;G<y.length;++G){var U=y[G];U.s.c==f&&U.s.r<u&&u<=U.e.r&&(f=U.e.c+1,G=-1)}var T=ht(k.slice(0,k.indexOf(">")));g=T.colspan?+T.colspan:1,((p=+T.rowspan)>1||g>1)&&y.push({s:{r:u,c:f},e:{r:u+(p||1)-1,c:f+g-1}});var F=T.t||T["data-t"]||"";if(!_.length){f+=g;continue}if(_=HT(_),m.s.r>u&&(m.s.r=u),m.e.r<u&&(m.e.r=u),m.s.c>f&&(m.s.c=f),m.e.c<f&&(m.e.c=f),!_.length){f+=g;continue}var S={t:"s",v:_};r.raw||!_.trim().length||F=="s"||(_==="TRUE"?S={t:"b",v:!0}:_==="FALSE"?S={t:"b",v:!1}:isNaN(Ys(_))?isNaN(gu(_).getDate())||(S={t:"d",v:xr(_)},r.cellDates||(S={t:"n",v:mn(S.v)}),S.z=r.dateNF||ut[14]):S={t:"n",v:Ys(_)}),r.dense?(n[u]||(n[u]=[]),n[u][f]=S):n[ft({r:u,c:f})]=S,f+=g}}}}return n["!ref"]=St(m),y.length&&(n["!merges"]=y),n}function kL(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>a)&&!(i[u].e.r<r||i[u].e.c<a)){if(i[u].s.r<r||i[u].s.c<a){o=-1;break}o=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(o<0)){var f=ft({r,c:a}),p=n.dense?(t[r]||[])[a]:t[f],g=p&&p.v!=null&&(p.h||V1(p.w||(Xa(p),p.w)||""))||"",m={};o>1&&(m.rowspan=o),l>1&&(m.colspan=l),n.editable?g='<span contenteditable="true">'+g+"</span>":p&&(m["data-t"]=p&&p.t||"z",p.v!=null&&(m["data-v"]=p.v),p.z!=null&&(m["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+p.l.Target+'">'+g+"</a>")),m.id=(n.id||"sjs")+"-"+f,s.push(We("td",g,m))}}var y="<tr>";return y+s.join("")+"</tr>"}var CL='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',FL="</body></html>";function bL(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return cl(M2(r[0],e),e);var n=gv();return r.forEach(function(i,s){mv(n,M2(i,e),"Sheet"+(s+1))}),n}function IL(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Ek(t,e){var r=e||{},n=r.header!=null?r.header:CL,i=r.footer!=null?r.footer:FL,s=[n],a=Vi(t["!ref"]);r.dense=Array.isArray(t),s.push(IL(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(kL(t,a,o,r));return s.push("</table>"+i),s.join("")}function wk(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Fr(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var f=Vi(t["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),i==-1&&(u.e.r=i=f.e.r+1)}var p=[],g=0,m=t["!rows"]||(t["!rows"]=[]),y=0,x=0,w=0,A=0,k=0,_=0;for(t["!cols"]||(t["!cols"]=[]);y<o.length&&x<l;++y){var O=o[y];if(B2(O)){if(n.display)continue;m[x]={hidden:!0}}var G=O.children;for(w=A=0;w<G.length;++w){var U=G[w];if(!(n.display&&B2(U))){var T=U.hasAttribute("data-v")?U.getAttribute("data-v"):U.hasAttribute("v")?U.getAttribute("v"):HT(U.innerHTML),F=U.getAttribute("data-z")||U.getAttribute("z");for(g=0;g<p.length;++g){var S=p[g];S.s.c==A+s&&S.s.r<x+i&&x+i<=S.e.r&&(A=S.e.c+1-s,g=-1)}_=+U.getAttribute("colspan")||1,((k=+U.getAttribute("rowspan")||1)>1||_>1)&&p.push({s:{r:x+i,c:A+s},e:{r:x+i+(k||1)-1,c:A+s+(_||1)-1}});var I={t:"s",v:T},R=U.getAttribute("data-t")||U.getAttribute("t")||"";T!=null&&(T.length==0?I.t=R||"z":n.raw||T.trim().length==0||R=="s"||(T==="TRUE"?I={t:"b",v:!0}:T==="FALSE"?I={t:"b",v:!1}:isNaN(Ys(T))?isNaN(gu(T).getDate())||(I={t:"d",v:xr(T)},n.cellDates||(I={t:"n",v:mn(I.v)}),I.z=n.dateNF||ut[14]):I={t:"n",v:Ys(T)})),I.z===void 0&&F!=null&&(I.z=F);var D="",N=U.getElementsByTagName("A");if(N&&N.length)for(var Ge=0;Ge<N.length&&!(N[Ge].hasAttribute("href")&&(D=N[Ge].getAttribute("href"),D.charAt(0)!="#"));++Ge);D&&D.charAt(0)!="#"&&(I.l={Target:D}),n.dense?(t[x+i]||(t[x+i]=[]),t[x+i][A+s]=I):t[ft({c:A+s,r:x+i})]=I,u.e.c<A+s&&(u.e.c=A+s),A+=_}}++x}return p.length&&(t["!merges"]=(t["!merges"]||[]).concat(p)),u.e.r=Math.max(u.e.r,x-1+i),t["!ref"]=St(u),x>=l&&(t["!fullref"]=St((u.e.r=o.length-y+x-1+i,u))),t}function Sk(t,e){var r=e||{},n=r.dense?[]:{};return wk(n,t,e)}function NL(t,e){return cl(Sk(t,e),e)}function B2(t){var e="",r=RL(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function RL(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function DL(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ht(e.replace(/<[^>]*>/g,""));return[r]}var L2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Tk(t,e){var r=e||{},n=U1(t),i=[],s,a,o={name:""},l="",u=0,f,p,g={},m=[],y=r.dense?[]:{},x,w,A={value:""},k="",_=0,O=[],G=-1,U=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}},F=0,S={},I=[],R={},D=0,N=0,Ge=[],_e=1,Re=1,Me=[],Se={Names:[]},te={},Ce=["",""],je=[],W={},re="",ee=0,Y=!1,xe=!1,Ee=0;for(cf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=cf.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(T.e.c>=T.s.c&&T.e.r>=T.s.r?y["!ref"]=St(T):y["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=T.e.r&&(y["!fullref"]=y["!ref"],T.e.r=r.sheetRows-1,y["!ref"]=St(T)),I.length&&(y["!merges"]=I),Ge.length&&(y["!rows"]=Ge),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),m.push(f.name),g[f.name]=y,xe=!1):x[0].charAt(x[0].length-2)!=="/"&&(f=ht(x[0],!1),G=U=-1,T.s.r=T.s.c=1e7,T.e.r=T.e.c=0,y=r.dense?[]:{},I=[],Ge=[],xe=!0);break;case"table-row-group":x[1]==="/"?--F:++F;break;case"table-row":case"":if(x[1]==="/"){G+=_e,_e=1;break}if(p=ht(x[0],!1),p.?G=p.-1:G==-1&&(G=0),_e=+p["number-rows-repeated"]||1,_e<10)for(Ee=0;Ee<_e;++Ee)F>0&&(Ge[G+Ee]={level:F});U=-1;break;case"covered-table-cell":x[1]!=="/"&&++U,r.sheetStubs&&(r.dense?(y[G]||(y[G]=[]),y[G][U]={t:"z"}):y[ft({r:G,c:U})]={t:"z"}),k="",O=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++U,A=ht(x[0],!1),Re=parseInt(A["number-columns-repeated"]||"1",10),w={t:"z",v:null},A.formula&&r.cellFormula!=!1&&(w.f=D2(Ht(A.formula))),(A.||A["value-type"])=="string"&&(w.t="s",w.v=Ht(A["string-value"]||""),r.dense?(y[G]||(y[G]=[]),y[G][U]=w):y[ft({r:G,c:U})]=w),U+=Re-1;else if(x[1]!=="/"){++U,k="",_=0,O=[],Re=1;var Le=_e?G+_e-1:G;if(U>T.e.c&&(T.e.c=U),U<T.s.c&&(T.s.c=U),G<T.s.r&&(T.s.r=G),Le>T.e.r&&(T.e.r=Le),A=ht(x[0],!1),je=[],W={},w={t:A.||A["value-type"],v:null},r.cellFormula)if(A.formula&&(A.formula=Ht(A.formula)),A["number-matrix-columns-spanned"]&&A["number-matrix-rows-spanned"]&&(D=parseInt(A["number-matrix-rows-spanned"],10)||0,N=parseInt(A["number-matrix-columns-spanned"],10)||0,R={s:{r:G,c:U},e:{r:G+D-1,c:U+N-1}},w.F=St(R),Me.push([R,w.F])),A.formula)w.f=D2(A.formula);else for(Ee=0;Ee<Me.length;++Ee)G>=Me[Ee][0].s.r&&G<=Me[Ee][0].e.r&&U>=Me[Ee][0].s.c&&U<=Me[Ee][0].e.c&&(w.F=Me[Ee][1]);switch((A["number-columns-spanned"]||A["number-rows-spanned"])&&(D=parseInt(A["number-rows-spanned"],10)||0,N=parseInt(A["number-columns-spanned"],10)||0,R={s:{r:G,c:U},e:{r:G+D-1,c:U+N-1}},I.push(R)),A["number-columns-repeated"]&&(Re=parseInt(A["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=gr(A["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(A.value);break;case"percentage":w.t="n",w.v=parseFloat(A.value);break;case"currency":w.t="n",w.v=parseFloat(A.value);break;case"date":w.t="d",w.v=xr(A["date-value"]),r.cellDates||(w.t="n",w.v=mn(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=aR(A["time-value"])/86400,r.cellDates&&(w.t="d",w.v=jp(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(A.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",A["string-value"]!=null&&(k=Ht(A["string-value"]),O=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(Y=!1,w.t==="s"&&(w.v=k||"",O.length&&(w.R=O),Y=_==0),te.Target&&(w.l=te),je.length>0&&(w.c=je,je=[]),k&&r.cellText!==!1&&(w.w=k),Y&&(w.t="z",delete w.v),(!Y||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=G))for(var Fe=0;Fe<_e;++Fe){if(Re=parseInt(A["number-columns-repeated"]||"1",10),r.dense)for(y[G+Fe]||(y[G+Fe]=[]),y[G+Fe][U]=Fe==0?w:vr(w);--Re>0;)y[G+Fe][U+Re]=vr(w);else for(y[ft({r:G+Fe,c:U})]=w;--Re>0;)y[ft({r:G+Fe,c:U+Re})]=vr(w);T.e.c<=U&&(T.e.c=U)}Re=parseInt(A["number-columns-repeated"]||"1",10),U+=Re-1,Re=0,w={},k="",O=[]}te={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s;W.t=k,O.length&&(W.R=O),W.a=re,je.push(W)}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);re="",ee=0,k="",_=0,O=[];break;case"creator":x[1]==="/"?re=n.slice(ee,x.index):ee=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);k="",_=0,O=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(S[o.name]=l,(s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&(l="",o=ht(x[0],!1),i.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=ht(x[0],!1),l+=L2[x[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=ht(x[0],!1),l+=L2[x[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,x.index);break}else u=x.index+x[0].length;break;case"named-range":a=ht(x[0],!1),Ce=jg(a["cell-range-address"]);var Ae={Name:a.name,Ref:Ce[0]+"!"+Ce[1]};xe&&(Ae.Sheet=m.length),Se.Names.push(Ae);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(x[1]==="/"&&(!A||!A["string-value"])){var it=DL(n.slice(_,x.index));k=(k.length>0?k+`
`:"")+it[0]}else ht(x[0],!1),_=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{Ce=jg(ht(x[0])["target-range-address"]),g[Ce[0]]["!autofilter"]={ref:Ce[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(te=ht(x[0],!1),!te.href)break;te.Target=Ht(te.href),delete te.href,te.Target.charAt(0)=="#"&&te.Target.indexOf(".")>-1?(Ce=jg(te.Target.slice(1)),te.Target="#"+Ce[0]+"!"+Ce[1]):te.Target.match(/^\.\.[\\\/]/)&&(te.Target=te.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var q={Sheets:g,SheetNames:m,Workbook:Se};return r.bookSheets&&delete q.Sheets,q}function j2(t,e){e=e||{},ms(t,"META-INF/manifest.xml")&&aD(Qr(t,"META-INF/manifest.xml"),e);var r=Yi(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Tk(or(r),e);return ms(t,"meta.xml")&&(n.Props=pA(Qr(t,"meta.xml"))),n}function V2(t,e){return Tk(t,e)}var PL=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+lf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return $r+e}}(),U2=function(){var t=function(s){return tr(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+tr(a.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,f=0,p=Vi(s["!ref"]||"A1"),g=s["!merges"]||[],m=0,y=Array.isArray(s);if(s["!cols"])for(f=0;f<=p.e.c;++f)l.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var x="",w=s["!rows"]||[];for(u=0;u<p.s.r;++u)x=w[u]?' table:style-name="ro'+w[u].ods+'"':"",l.push("        <table:table-row"+x+`></table:table-row>
`);for(;u<=p.e.r;++u){for(x=w[u]?' table:style-name="ro'+w[u].ods+'"':"",l.push("        <table:table-row"+x+`>
`),f=0;f<p.s.c;++f)l.push(e);for(;f<=p.e.c;++f){var A=!1,k={},_="";for(m=0;m!=g.length;++m)if(!(g[m].s.c>f)&&!(g[m].s.r>u)&&!(g[m].e.c<f)&&!(g[m].e.r<u)){(g[m].s.c!=f||g[m].s.r!=u)&&(A=!0),k["table:number-columns-spanned"]=g[m].e.c-g[m].s.c+1,k["table:number-rows-spanned"]=g[m].e.r-g[m].s.r+1;break}if(A){l.push(r);continue}var O=ft({r:u,c:f}),G=y?(s[u]||[])[f]:s[O];if(G&&G.f&&(k["table:formula"]=tr(eO(G.f)),G.F&&G.F.slice(0,O.length)==O)){var U=Vi(G.F);k["table:number-matrix-columns-spanned"]=U.e.c-U.s.c+1,k["table:number-matrix-rows-spanned"]=U.e.r-U.s.r+1}if(!G){l.push(e);continue}switch(G.t){case"b":_=G.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=G.v?"true":"false";break;case"n":_=G.w||String(G.v||0),k["office:value-type"]="float",k["office:value"]=G.v||0;break;case"s":case"str":_=G.v==null?"":G.v,k["office:value-type"]="string";break;case"d":_=G.w||xr(G.v).toISOString(),k["office:value-type"]="date",k["office:date-value"]=xr(G.v).toISOString(),k["table:style-name"]="ce1";break;default:l.push(e);continue}var T=t(_);if(G.l&&G.l.Target){var F=G.l.Target;F=F.charAt(0)=="#"?"#"+tO(F.slice(1)):F,F.charAt(0)!="#"&&!F.match(/^\w+:/)&&(F="../"+F),T=We("text:a",T,{"xlink:href":F.replace(/&/g,"&amp;")})}l.push("          "+We("table:table-cell",We("text:p",T,{}),k)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var f=0;f<u["!cols"].length;++f)if(u["!cols"][f]){var p=u["!cols"][f];if(p.width==null&&p.wpx==null&&p.wch==null)continue;Zo(p),p.ods=o;var g=u["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var f=0;f<u["!rows"].length;++f)if(u["!rows"][f]){u["!rows"][f].ods=l;var p=u["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[$r],u=lf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=lf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+f+`>
`),l.push(hA().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var p=0;p!=a.SheetNames.length;++p)l.push(n(a.Sheets[a.SheetNames[p]],a,p));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function Ak(t,e){if(e.bookType=="fods")return U2(t,e);var r=B1(),n="",i=[],s=[];return n="mimetype",Tt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Tt(r,n,U2(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Tt(r,n,PL(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Tt(r,n,$r+hA()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Tt(r,n,cD(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Tt(r,n,oD(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ql(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function fx(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):or(ll(t))}function OL(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Ki(ca(t))}function ML(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function tl(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function z2(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function BL(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function LL(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function mf(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Zt(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Mr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Yt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=mf(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=mf(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:o,type:s};e[i]==null?e[i]=[u]:e[i].push(u)}return e}function Rn(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(Zt(n*8+i.type)),i.type==2&&e.push(Zt(i.data.length)),e.push(i.data))})}),tl(e)}function uv(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function ps(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=mf(t,n),s=Yt(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:Mr(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=Yt(o.data),u=Mr(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=s[3])!=null&&e[0]&&(a.merge=Mr(s[3][0].data)>>>0>0),r.push(a)}return r}function Cc(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:Zt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Zt(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Zt(a.data.length)}],n[2].push({data:Rn(a.meta),type:2})});var s=Rn(n);e.push(Zt(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),tl(e)}function jL(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=mf(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,u=0;if(s==1?(u=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[tl(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var f=tl(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function gs(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(jL(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return tl(e)}function Fc(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=Zt(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return tl(e)}function VL(t,e,r,n){var i=Ql(t),s=i.getUint32(4,!0),a=(n>1?12:8)+z2(s&(n>1?3470:398))*4,o=-1,l=-1,u=NaN,f=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=z2(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(a,!0),a+=4),s&32&&(u=i.getFloat64(a,!0),a+=8),s&64&&(f.setTime(f.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var p;switch(t[2]){case 0:break;case 2:p={t:"n",v:u};break;case 3:p={t:"s",v:e[l]};break;case 5:p={t:"d",v:f};break;case 6:p={t:"b",v:u>0};break;case 7:p={t:"n",v:u/86400};break;case 8:p={t:"e",v:0};break;case 9:if(o>-1)p={t:"s",v:r[o]};else if(l>-1)p={t:"s",v:e[l]};else if(!isNaN(u))p={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return p}function UL(t,e,r){var n=Ql(t),i=n.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,u=NaN,f=new Date(2001,0,1);i&1&&(l=BL(t,s),s+=16),i&2&&(u=n.getFloat64(s,!0),s+=8),i&4&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var p;switch(t[1]){case 0:break;case 2:p={t:"n",v:l};break;case 3:p={t:"s",v:e[o]};break;case 5:p={t:"d",v:f};break;case 6:p={t:"b",v:u>0};break;case 7:p={t:"n",v:u/86400};break;case 8:p={t:"e",v:0};break;case 9:if(a>-1)p={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:p={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return p}function Ug(t,e){var r=new Uint8Array(32),n=Ql(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,LL(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function zg(t,e){var r=new Uint8Array(32),n=Ql(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function zL(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return VL(t,e,r,t[0]);case 5:return UL(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Jn(t){var e=Yt(t);return mf(e[1][0].data)}function W2(t,e){var r=Yt(e.data),n=Mr(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=Yt(a.data),l=Mr(o[1][0].data)>>>0;switch(n){case 1:s[l]=fx(o[3][0].data);break;case 8:{var u=t[Jn(o[9][0].data)][0],f=Yt(u.data),p=t[Jn(f[1][0].data)][0],g=Mr(p.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var m=Yt(p.data);s[l]=m[3].map(function(y){return fx(y.data)}).join("")}break}}),s}function WL(t,e){var r,n,i,s,a,o,l,u,f,p,g,m,y,x,w=Yt(t),A=Mr(w[1][0].data)>>>0,k=Mr(w[2][0].data)>>>0,_=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&Mr(w[8][0].data)>0||!1,O,G;if((s=(i=w[7])==null?void 0:i[0])!=null&&s.data&&e!=0)O=(o=(a=w[7])==null?void 0:a[0])==null?void 0:o.data,G=(u=(l=w[6])==null?void 0:l[0])==null?void 0:u.data;else if((p=(f=w[4])==null?void 0:f[0])!=null&&p.data&&e!=1)O=(m=(g=w[4])==null?void 0:g[0])==null?void 0:m.data,G=(x=(y=w[3])==null?void 0:y[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var U=_?4:1,T=Ql(O),F=[],S=0;S<O.length/2;++S){var I=T.getUint16(S*2,!0);I<65535&&F.push([S,I])}if(F.length!=k)throw"Expected ".concat(k," cells, found ").concat(F.length);var R=[];for(S=0;S<F.length-1;++S)R[F[S][0]]=G.subarray(F[S][1]*U,F[S+1][1]*U);return F.length>=1&&(R[F[F.length-1][0]]=G.subarray(F[F.length-1][1]*U)),{R:A,cells:R}}function HL(t,e){var r,n=Yt(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Mr(n[7][0].data)>>>0>0?1:0:-1,s=uv(n[5],function(a){return WL(a,i)});return{nrows:Mr(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,u){if(a[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));a[o.R][u]=l}),a},[])}}function $L(t,e,r){var n,i=Yt(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Mr(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Mr(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=St(s);var a=Yt(i[4][0].data),o=W2(t,t[Jn(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?W2(t,t[Jn(a[17][0].data)][0]):[],u=Yt(a[3][0].data),f=0;u[1].forEach(function(p){var g=Yt(p.data),m=t[Jn(g[2][0].data)][0],y=Mr(m.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var x=HL(t,m);x.data.forEach(function(w,A){w.forEach(function(k,_){var O=ft({r:f+A,c:_}),G=zL(k,o,l);G&&(r[O]=G)})}),f+=x.nrows})}function GL(t,e){var r=Yt(e.data),n={"!ref":"A1"},i=t[Jn(r[2][0].data)],s=Mr(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return $L(t,i[0],n),n}function KL(t,e){var r,n=Yt(e.data),i={name:(r=n[1])!=null&&r[0]?fx(n[1][0].data):"",sheets:[]},s=uv(n[2],Jn);return s.forEach(function(a){t[a].forEach(function(o){var l=Mr(o.meta[1][0].data);l==6e3&&i.sheets.push(GL(t,o))})}),i}function YL(t,e){var r=gv(),n=Yt(e.data),i=uv(n[1],Jn);if(i.forEach(function(s){t[s].forEach(function(a){var o=Mr(a.meta[1][0].data);if(o==2){var l=KL(t,a);l.sheets.forEach(function(u,f){mv(r,u,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Wg(t){var e,r,n,i,s={},a=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=gs(l.content)}catch(p){return console.log("?? "+l.content.length+" "+(p.message||p))}var f;try{f=ps(u)}catch(p){return console.log("## "+(p.message||p))}f.forEach(function(p){s[p.id]=p.messages,a.push(p.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Mr(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(u){var f=Mr(u.meta[1][0].data)>>>0;if(f==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return YL(s,o)}function XL(t,e,r){var n,i,s,a;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=t[8])==null?void 0:s[0])==null?void 0:a.data)&&Mr(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=Ql(t[7][0].data),f=0,p=[],g=Ql(t[4][0].data),m=0,y=[],x=0;x<e.length;++x){if(e[x]==null){u.setUint16(x*2,65535,!0),g.setUint16(x*2,65535);continue}u.setUint16(x*2,f,!0),g.setUint16(x*2,m,!0);var w,A;switch(typeof e[x]){case"string":w=Ug({t:"s",v:e[x]},r),A=zg({t:"s",v:e[x]},r);break;case"number":w=Ug({t:"n",v:e[x]},r),A=zg({t:"n",v:e[x]},r);break;case"boolean":w=Ug({t:"b",v:e[x]},r),A=zg({t:"b",v:e[x]},r);break;default:throw new Error("Unsupported value "+e[x])}p.push(w),f+=w.length,y.push(A),m+=A.length,++l}for(t[2][0].data=Zt(l);x<t[7][0].data.length/2;++x)u.setUint16(x*2,65535,!0),g.setUint16(x*2,65535,!0);return t[6][0].data=tl(p),t[3][0].data=tl(y),l}function qL(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Vi(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(St(n)));var s=tp(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(re){return re.forEach(function(ee){typeof ee=="string"&&a.push(ee)})});var o={},l=[],u=nt.read(e.numbers,{type:"base64"});u.FileIndex.map(function(re,ee){return[re,u.FullPaths[ee]]}).forEach(function(re){var ee=re[0],Y=re[1];if(ee.type==2&&ee.name.match(/\.iwa/)){var xe=ee.content,Ee=gs(xe),Le=ps(Ee);Le.forEach(function(Fe){l.push(Fe.id),o[Fe.id]={deps:[],location:Y,type:Mr(Fe.messages[0].meta[1][0].data)}})}}),l.sort(function(re,ee){return re-ee});var f=l.filter(function(re){return re>1}).map(function(re){return[re,Zt(re)]});u.FileIndex.map(function(re,ee){return[re,u.FullPaths[ee]]}).forEach(function(re){var ee=re[0];if(re[1],!!ee.name.match(/\.iwa/)){var Y=ps(gs(ee.content));Y.forEach(function(xe){xe.messages.forEach(function(Ee){f.forEach(function(Le){xe.messages.some(function(Fe){return Mr(Fe.meta[1][0].data)!=11006&&ML(Fe.data,Le[1])})&&o[Le[0]].deps.push(xe.id)})})})}});for(var p=nt.find(u,o[1].location),g=ps(gs(p.content)),m,y=0;y<g.length;++y){var x=g[y];x.id==1&&(m=x)}var w=Jn(Yt(m.messages[0].data)[1][0].data);for(p=nt.find(u,o[w].location),g=ps(gs(p.content)),y=0;y<g.length;++y)x=g[y],x.id==w&&(m=x);for(w=Jn(Yt(m.messages[0].data)[2][0].data),p=nt.find(u,o[w].location),g=ps(gs(p.content)),y=0;y<g.length;++y)x=g[y],x.id==w&&(m=x);for(w=Jn(Yt(m.messages[0].data)[2][0].data),p=nt.find(u,o[w].location),g=ps(gs(p.content)),y=0;y<g.length;++y)x=g[y],x.id==w&&(m=x);var A=Yt(m.messages[0].data);{A[6][0].data=Zt(n.e.r+1),A[7][0].data=Zt(n.e.c+1);var k=Jn(A[46][0].data),_=nt.find(u,o[k].location),O=ps(gs(_.content));{for(var G=0;G<O.length&&O[G].id!=k;++G);if(O[G].id!=k)throw"Bad ColumnRowUIDMapArchive";var U=Yt(O[G].messages[0].data);U[1]=[],U[2]=[],U[3]=[];for(var T=0;T<=n.e.c;++T){var F=[];F[1]=F[2]=[{type:0,data:Zt(T+420690)}],U[1].push({type:2,data:Rn(F)}),U[2].push({type:0,data:Zt(T)}),U[3].push({type:0,data:Zt(T)})}U[4]=[],U[5]=[],U[6]=[];for(var S=0;S<=n.e.r;++S)F=[],F[1]=F[2]=[{type:0,data:Zt(S+726270)}],U[4].push({type:2,data:Rn(F)}),U[5].push({type:0,data:Zt(S)}),U[6].push({type:0,data:Zt(S)});O[G].messages[0].data=Rn(U)}_.content=Fc(Cc(O)),_.size=_.content.length,delete A[46];var I=Yt(A[4][0].data);{I[7][0].data=Zt(n.e.r+1);var R=Yt(I[1][0].data),D=Jn(R[2][0].data);_=nt.find(u,o[D].location),O=ps(gs(_.content));{if(O[0].id!=D)throw"Bad HeaderStorageBucket";var N=Yt(O[0].messages[0].data);for(S=0;S<s.length;++S){var Ge=Yt(N[2][0].data);Ge[1][0].data=Zt(S),Ge[4][0].data=Zt(s[S].length),N[2][S]={type:N[2][0].type,data:Rn(Ge)}}O[0].messages[0].data=Rn(N)}_.content=Fc(Cc(O)),_.size=_.content.length;var _e=Jn(I[2][0].data);_=nt.find(u,o[_e].location),O=ps(gs(_.content));{if(O[0].id!=_e)throw"Bad HeaderStorageBucket";for(N=Yt(O[0].messages[0].data),T=0;T<=n.e.c;++T)Ge=Yt(N[2][0].data),Ge[1][0].data=Zt(T),Ge[4][0].data=Zt(n.e.r+1),N[2][T]={type:N[2][0].type,data:Rn(Ge)};O[0].messages[0].data=Rn(N)}_.content=Fc(Cc(O)),_.size=_.content.length;var Re=Jn(I[4][0].data);(function(){for(var re=nt.find(u,o[Re].location),ee=ps(gs(re.content)),Y,xe=0;xe<ee.length;++xe){var Ee=ee[xe];Ee.id==Re&&(Y=Ee)}var Le=Yt(Y.messages[0].data);{Le[3]=[];var Fe=[];a.forEach(function(q,Pt){Fe[1]=[{type:0,data:Zt(Pt)}],Fe[2]=[{type:0,data:Zt(1)}],Fe[3]=[{type:2,data:OL(q)}],Le[3].push({type:2,data:Rn(Fe)})})}Y.messages[0].data=Rn(Le);var Ae=Cc(ee),it=Fc(Ae);re.content=it,re.size=re.content.length})();var Me=Yt(I[3][0].data);{var Se=Me[1][0];delete Me[2];var te=Yt(Se.data);{var Ce=Jn(te[2][0].data);(function(){for(var re=nt.find(u,o[Ce].location),ee=ps(gs(re.content)),Y,xe=0;xe<ee.length;++xe){var Ee=ee[xe];Ee.id==Ce&&(Y=Ee)}var Le=Yt(Y.messages[0].data);{delete Le[6],delete Me[7];var Fe=new Uint8Array(Le[5][0].data);Le[5]=[];for(var Ae=0,it=0;it<=n.e.r;++it){var q=Yt(Fe);Ae+=XL(q,s[it],a),q[1][0].data=Zt(it),Le[5].push({data:Rn(q),type:2})}Le[1]=[{type:0,data:Zt(n.e.c+1)}],Le[2]=[{type:0,data:Zt(n.e.r+1)}],Le[3]=[{type:0,data:Zt(Ae)}],Le[4]=[{type:0,data:Zt(n.e.r+1)}]}Y.messages[0].data=Rn(Le);var Pt=Cc(ee),Et=Fc(Pt);re.content=Et,re.size=re.content.length})()}Se.data=Rn(te)}I[3][0].data=Rn(Me)}A[4][0].data=Rn(I)}m.messages[0].data=Rn(A);var je=Cc(g),W=Fc(je);return p.content=W,p.size=p.content.length,u}function kk(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function dv(t){kk([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function fv(t){kk([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function QL(t){return bt.WS.indexOf(t)>-1?"sheet":t==bt.CS?"chart":t==bt.DS?"dialog":t==bt.MS?"macro":t&&t.length?t:"sheet"}function JL(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,QL(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function ZL(t,e,r,n,i,s,a,o,l,u,f,p){try{s[n]=Id(Yi(t,r,!0),e);var g=Qr(t,e),m;switch(o){case"sheet":m=EB(g,e,i,l,s[n],u,f,p);break;case"chart":if(m=wB(g,e,i,l,s[n],u,f,p),!m||!m["!drawel"])break;var y=hd(m["!drawel"].Target,e),x=uf(y),w=l8(Yi(t,y,!0),Id(Yi(t,x,!0),y)),A=hd(w,y),k=uf(A);m=XM(Yi(t,A,!0),A,l,Id(Yi(t,k,!0),A),u,m);break;case"macro":m=SB(g,e,i,l,s[n],u,f,p);break;case"dialog":m=TB(g,e,i,l,s[n],u,f,p);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=m;var _=[];s&&s[n]&&Br(s[n]).forEach(function(O){var G="";if(s[n][O].Type==bt.CMNT){G=hd(s[n][O].Target,e);var U=FB(Qr(t,G,!0),G,l);if(!U||!U.length)return;F2(m,U,!1)}s[n][O].Type==bt.TCMNT&&(G=hd(s[n][O].Target,e),_=_.concat(u8(Qr(t,G,!0),l)))}),_&&_.length&&F2(m,_,!0,l.people||[])}catch(O){if(l.WTF)throw O}}function fs(t){return t.charAt(0)=="/"?t.slice(1):t}function ej(t,e){if(Nu(),e=e||{},dv(e),ms(t,"META-INF/manifest.xml")||ms(t,"objectdata.xml"))return j2(t,e);if(ms(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Wg<"u"){if(t.FileIndex)return Wg(t);var r=nt.utils.cfb_new();return X_(t).forEach(function(Ge){Tt(r,Ge,dR(t,Ge))}),Wg(r)}throw new Error("Unsupported NUMBERS file")}if(!ms(t,"[Content_Types].xml"))throw ms(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ms(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=X_(t),i=iD(Yi(t,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",Qr(t,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!Qr(t,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},u={};if(!e.bookSheets&&!e.bookProps){if(Nd=[],i.sst)try{Nd=CB(Qr(t,fs(i.sst)),i.sst,e)}catch(Ge){if(e.WTF)throw Ge}e.cellStyles&&i.themes.length&&(l=kB(Yi(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(u=AB(Qr(t,fs(i.style)),i.style,l,e))}i.links.map(function(Ge){try{var _e=Id(Yi(t,uf(fs(Ge))),Ge);return IB(Qr(t,fs(Ge)),_e,Ge,e)}catch{}});var f=_B(Qr(t,fs(i.workbooks[0])),i.workbooks[0],e),p={},g="";i.coreprops.length&&(g=Qr(t,fs(i.coreprops[0]),!0),g&&(p=pA(g)),i.extprops.length!==0&&(g=Qr(t,fs(i.extprops[0]),!0),g&&dD(g,p,e)));var m={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(g=Yi(t,fs(i.custprops[0]),!0),g&&(m=hD(g,e)));var y={};if((e.bookSheets||e.bookProps)&&(f.Sheets?a=f.Sheets.map(function(_e){return _e.name}):p.Worksheets&&p.SheetNames.length>0&&(a=p.SheetNames),e.bookProps&&(y.Props=p,y.Custprops=m),e.bookSheets&&typeof a<"u"&&(y.SheetNames=a),e.bookSheets?y.SheetNames:e.bookProps))return y;a={};var x={};e.bookDeps&&i.calcchain&&(x=bB(Qr(t,fs(i.calcchain)),i.calcchain));var w=0,A={},k,_;{var O=f.Sheets;p.Worksheets=O.length,p.SheetNames=[];for(var G=0;G!=O.length;++G)p.SheetNames[G]=O[G].name}var U=s?"bin":"xml",T=i.workbooks[0].lastIndexOf("/"),F=(i.workbooks[0].slice(0,T+1)+"_rels/"+i.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");ms(t,F)||(F="xl/_rels/workbook."+U+".rels");var S=Id(Yi(t,F,!0),F.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=NB(Qr(t,fs(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=f8(Qr(t,fs(i.people[0])),e)),S&&(S=JL(S,f.Sheets));var I=Qr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=p.Worksheets;++w){var R="sheet";if(S&&S[w]?(k="xl/"+S[w][1].replace(/[\/]?xl\//,""),ms(t,k)||(k=S[w][1]),ms(t,k)||(k=F.replace(/_rels\/.*$/,"")+S[w][1]),R=S[w][2]):(k="xl/worksheets/sheet"+(w+1-I)+"."+U,k=k.replace(/sheet0\./,"sheet.")),_=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(w!=e.sheets)continue e;break;case"string":if(p.SheetNames[w].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var D=!1,N=0;N!=e.sheets.length;++N)typeof e.sheets[N]=="number"&&e.sheets[N]==w&&(D=1),typeof e.sheets[N]=="string"&&e.sheets[N].toLowerCase()==p.SheetNames[w].toLowerCase()&&(D=1);if(!D)continue e}}ZL(t,k,_,p.SheetNames[w],w,A,a,R,e,f,l,u)}return y={Directory:i,Workbook:f,Props:p,Custprops:m,Deps:x,Sheets:a,SheetNames:p.SheetNames,Strings:Nd,Styles:u,Themes:l,SSF:vr(ut)},e&&e.bookFiles&&(t.files?(y.keys=n,y.files=t.files):(y.keys=[],y.files={},t.FullPaths.forEach(function(Ge,_e){Ge=Ge.replace(/^Root Entry[\/]/,""),y.keys.push(Ge),y.files[Ge]=t.FileIndex[_e]}))),e&&e.bookVBA&&(i.vba.length>0?y.vbaraw=Qr(t,fs(i.vba[0]),!0):i.defaults&&i.defaults.bin===_8&&(y.vbaraw=Qr(t,"xl/vbaProject.bin",!0))),y}function tj(t,e){var r=e||{},n="Workbook",i=nt.find(t,n);try{if(n="/!DataSpaces/Version",i=nt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(N6(i.content),n="/!DataSpaces/DataSpaceMap",i=nt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=D6(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=nt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=P6(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=nt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);M6(i.content)}catch{}if(n="/EncryptionInfo",i=nt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=B6(i.content);if(n="/EncryptedPackage",i=nt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function rj(t,e){return e.bookType=="ods"?Ak(t,e):e.bookType=="numbers"?qL(t,e):e.bookType=="xlsb"?nj(t,e):ij(t,e)}function nj(t,e){Gc=1024,t&&!t.SSF&&(t.SSF=vr(ut)),t&&t.SSF&&(Nu(),Mp(t.SSF),e.revssf=Lp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Rd?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=ZA.indexOf(e.bookType)>-1,i=Q1();fv(e=e||{});var s=B1(),a="",o=0;if(e.cellXfs=[],ul(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",Tt(s,a,gA(t.Props,e)),i.coreprops.push(a),er(e.rels,2,a,bt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,Tt(s,a,vA(t.Props)),i.extprops.push(a),er(e.rels,3,a,bt.EXT_PROPS),t.Custprops!==t.Props&&Br(t.Custprops||{}).length>0&&(a="docProps/custom.xml",Tt(s,a,yA(t.Custprops)),i.custprops.push(a),er(e.rels,4,a,bt.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var f={"!id":{}},p=t.Sheets[t.SheetNames[o-1]],g=(p||{})["!type"]||"sheet";switch(g){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Tt(s,a,DB(o-1,a,e,t,f)),i.sheets.push(a),er(e.wbrels,-1,"worksheets/sheet"+o+"."+r,bt.WS[0])}if(p){var m=p["!comments"],y=!1,x="";m&&m.length>0&&(x="xl/comments"+o+"."+r,Tt(s,x,MB(m,x)),i.comments.push(x),er(f,-1,"../comments"+o+"."+r,bt.CMNT),y=!0),p["!legacy"]&&y&&Tt(s,"xl/drawings/vmlDrawing"+o+".vml",QA(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}f["!id"].rId1&&Tt(s,uf(a),tu(f))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,Tt(s,a,OB(e.Strings,a,e)),i.strs.push(a),er(e.wbrels,-1,"sharedStrings."+r,bt.SST)),a="xl/workbook."+r,Tt(s,a,RB(t,a)),i.workbooks.push(a),er(e.rels,1,a,bt.WB),a="xl/theme/theme1.xml",Tt(s,a,nv(t.Themes,e)),i.themes.push(a),er(e.wbrels,-1,"theme/theme1.xml",bt.THEME),a="xl/styles."+r,Tt(s,a,PB(t,a,e)),i.styles.push(a),er(e.wbrels,-1,"styles."+r,bt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",Tt(s,a,t.vbaraw),i.vba.push(a),er(e.wbrels,-1,"vbaProject.bin",bt.VBA)),a="xl/metadata."+r,Tt(s,a,BB(a)),i.metadata.push(a),er(e.wbrels,-1,"metadata."+r,bt.XLMETA),Tt(s,"[Content_Types].xml",fA(i,e)),Tt(s,"_rels/.rels",tu(e.rels)),Tt(s,"xl/_rels/workbook."+r+".rels",tu(e.wbrels)),delete e.revssf,delete e.ssf,s}function ij(t,e){Gc=1024,t&&!t.SSF&&(t.SSF=vr(ut)),t&&t.SSF&&(Nu(),Mp(t.SSF),e.revssf=Lp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Rd?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=ZA.indexOf(e.bookType)>-1,i=Q1();fv(e=e||{});var s=B1(),a="",o=0;if(e.cellXfs=[],ul(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",Tt(s,a,gA(t.Props,e)),i.coreprops.push(a),er(e.rels,2,a,bt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,Tt(s,a,vA(t.Props)),i.extprops.push(a),er(e.rels,3,a,bt.EXT_PROPS),t.Custprops!==t.Props&&Br(t.Custprops||{}).length>0&&(a="docProps/custom.xml",Tt(s,a,yA(t.Custprops)),i.custprops.push(a),er(e.rels,4,a,bt.CUST_PROPS));var f=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var p={"!id":{}},g=t.Sheets[t.SheetNames[o-1]],m=(g||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Tt(s,a,uk(o-1,e,t,p)),i.sheets.push(a),er(e.wbrels,-1,"worksheets/sheet"+o+"."+r,bt.WS[0])}if(g){var y=g["!comments"],x=!1,w="";if(y&&y.length>0){var A=!1;y.forEach(function(k){k[1].forEach(function(_){_.T==!0&&(A=!0)})}),A&&(w="xl/threadedComments/threadedComment"+o+"."+r,Tt(s,w,d8(y,f,e)),i.threadedcomments.push(w),er(p,-1,"../threadedComments/threadedComment"+o+"."+r,bt.TCMNT)),w="xl/comments"+o+"."+r,Tt(s,w,JA(y)),i.comments.push(w),er(p,-1,"../comments"+o+"."+r,bt.CMNT),x=!0}g["!legacy"]&&x&&Tt(s,"xl/drawings/vmlDrawing"+o+".vml",QA(o,g["!comments"])),delete g["!comments"],delete g["!legacy"]}p["!id"].rId1&&Tt(s,uf(a),tu(p))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,Tt(s,a,jA(e.Strings,e)),i.strs.push(a),er(e.wbrels,-1,"sharedStrings."+r,bt.SST)),a="xl/workbook."+r,Tt(s,a,gk(t)),i.workbooks.push(a),er(e.rels,1,a,bt.WB),a="xl/theme/theme1.xml",Tt(s,a,nv(t.Themes,e)),i.themes.push(a),er(e.wbrels,-1,"theme/theme1.xml",bt.THEME),a="xl/styles."+r,Tt(s,a,KA(t,e)),i.styles.push(a),er(e.wbrels,-1,"styles."+r,bt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",Tt(s,a,t.vbaraw),i.vba.push(a),er(e.wbrels,-1,"vbaProject.bin",bt.VBA)),a="xl/metadata."+r,Tt(s,a,qA()),i.metadata.push(a),er(e.wbrels,-1,"metadata."+r,bt.XLMETA),f.length>1&&(a="xl/persons/person.xml",Tt(s,a,h8(f)),i.people.push(a),er(e.wbrels,-1,"persons/person.xml",bt.PEOPLE)),Tt(s,"[Content_Types].xml",fA(i,e)),Tt(s,"_rels/.rels",tu(e.rels)),Tt(s,"xl/_rels/workbook."+r+".rels",tu(e.wbrels)),delete e.revssf,delete e.ssf,s}function hv(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Zi(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function sj(t,e){return nt.find(t,"EncryptedPackage")?tj(t,e):yk(t,e)}function aj(t,e){var r,n=t,i=e||{};return i.type||(i.type=kt&&Buffer.isBuffer(t)?"buffer":"base64"),r=UT(n,i),ej(r,i)}function Ck(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return ux(t.slice(r),e);default:break e}return mu.to_workbook(t,e)}function oj(t,e){var r="",n=hv(t,e);switch(e.type){case"base64":r=Zi(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Kl(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=or(r)),e.type="binary",Ck(r,e)}function lj(t,e){var r=t;return e.type=="base64"&&(r=Zi(r)),r=nf.utils.decode(1200,r.slice(2),"str"),e.type="binary",Ck(r,e)}function cj(t){return t.match(/[^\x00-\x7F]/)?ca(t):t}function Hg(t,e,r,n){return n?(r.type="string",mu.to_workbook(t,r)):mu.to_workbook(e,r)}function Cl(t,e){R1();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Cl(new Uint8Array(t),(r=vr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),nu={},r.dateNF&&(nu.dateNF=r.dateNF),r.type||(r.type=kt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=kt?"buffer":"binary",n=nR(t),typeof Uint8Array<"u"&&!kt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=cj(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=vr(r),r.type="array",Cl(D1(n),r)}switch((i=hv(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return sj(nt.read(n,r),r);break;case 9:if(i[1]<=8)return yk(n,r);break;case 60:return ux(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return p6(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return BA.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?aj(n,r):Hg(t,n,r,s);case 239:return i[3]===60?ux(n,r):Hg(t,n,r,s);case 255:if(i[1]===254)return lj(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Bl.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Bl.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return cx.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return HA.to_workbook(n,r);break;case 10:case 13:case 32:return oj(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return h6.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?cx.to_workbook(n,r):Hg(t,n,r,s)}function Fk(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Df(e.file,nt.write(t,{type:kt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return nt.write(t,e)}function uj(t,e){var r=vr(e||{}),n=rj(t,r);return dj(n,r)}function dj(t,e){var r={},n=kt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?nt.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Op(i))}return e.password&&typeof encrypt_agile<"u"?Fk(encrypt_agile(i,e.password),e):e.type==="file"?Df(e.file,i):e.type=="string"?or(i):i}function fj(t,e){var r=e||{},n=cL(t,r);return Fk(n,r)}function aa(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return sf(ca(n));case"binary":return ca(n);case"string":return t;case"file":return Df(e.file,n,"utf8");case"buffer":return kt?ro(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):aa(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function hj(t,e){switch(e.type){case"base64":return sf(t);case"binary":return t;case"string":return t;case"file":return Df(e.file,t,"binary");case"buffer":return kt?ro(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function B0(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?sf(r):e.type=="string"?or(r):r;case"file":return Df(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function bk(t,e){R1(),sB(t);var r=vr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=bk(t,r);return r.type="array",Op(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return aa(rL(t,r),r);case"slk":case"sylk":return aa(MA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return aa(Ek(t.Sheets[t.SheetNames[i]],r),r);case"txt":return hj(Ik(t.Sheets[t.SheetNames[i]],r),r);case"csv":return aa(pv(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return aa(BA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return B0(cx.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return aa(mu.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return aa(HA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return aa(LA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return aa(Ak(t,r),r);case"wk1":return B0(Bl.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return B0(Bl.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),B0(_k(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),fj(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return uj(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function pj(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function bc(t,e,r){var n={};return n.type="file",n.file=e,pj(n),bk(t,n)}function gj(t,e,r,n,i,s,a,o){var l=Hr(r),u=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),p=!0,g=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:r,enumerable:!1})}catch{g.__rowNum__=r}else g.__rowNum__=r;if(!a||t[r])for(var m=e.s.c;m<=e.e.c;++m){var y=a?t[r][m]:t[n[m]+l];if(y===void 0||y.t===void 0){if(u===void 0)continue;s[m]!=null&&(g[s[m]]=u);continue}var x=y.v;switch(y.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(s[m]!=null){if(x==null)if(y.t=="e"&&x===null)g[s[m]]=null;else if(u!==void 0)g[s[m]]=u;else if(f&&x===null)g[s[m]]=null;else continue;else g[s[m]]=f&&(y.t!=="n"||y.t==="n"&&o.rawNumbers!==!1)?x:Xa(y,x,o);x!=null&&(p=!1)}}return{row:g,isempty:p}}function tp(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},f=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":l=$t(f);break;case"number":l=$t(t["!ref"]),l.s.r=f;break;default:l=f}n>0&&(i=0);var p=Hr(l.s.r),g=[],m=[],y=0,x=0,w=Array.isArray(t),A=l.s.r,k=0,_={};w&&!t[A]&&(t[A]=[]);var O=u.skipHidden&&t["!cols"]||[],G=u.skipHidden&&t["!rows"]||[];for(k=l.s.c;k<=l.e.c;++k)if(!(O[k]||{}).hidden)switch(g[k]=Cr(k),r=w?t[A][k]:t[g[k]+p],n){case 1:s[k]=k-l.s.c;break;case 2:s[k]=g[k];break;case 3:s[k]=u.header[k-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Xa(r,null,u),x=_[a]||0,!x)_[a]=1;else{do o=a+"_"+x++;while(_[o]);_[a]=x,_[o]=1}s[k]=o}for(A=l.s.r+i;A<=l.e.r;++A)if(!(G[A]||{}).hidden){var U=gj(t,l,A,g,n,s,w,u);(U.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(m[y++]=U.row)}return m.length=y,m}var H2=/"/g;function mj(t,e,r,n,i,s,a,o){for(var l=!0,u=[],f="",p=Hr(r),g=e.s.c;g<=e.e.c;++g)if(n[g]){var m=o.dense?(t[r]||[])[g]:t[n[g]+p];if(m==null)f="";else if(m.v!=null){l=!1,f=""+(o.rawNumbers&&m.t=="n"?m.v:Xa(m,null,o));for(var y=0,x=0;y!==f.length;++y)if((x=f.charCodeAt(y))===i||x===s||x===34||o.forceQuotes){f='"'+f.replace(H2,'""')+'"';break}f=="ID"&&(f='"ID"')}else m.f!=null&&!m.F?(l=!1,f="="+m.f,f.indexOf(",")>=0&&(f='"'+f.replace(H2,'""')+'"')):f="";u.push(f)}return o.blankrows===!1&&l?null:u.join(a)}function pv(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=$t(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),f="",p=[];n.dense=Array.isArray(t);for(var g=n.skipHidden&&t["!cols"]||[],m=n.skipHidden&&t["!rows"]||[],y=i.s.c;y<=i.e.c;++y)(g[y]||{}).hidden||(p[y]=Cr(y));for(var x=0,w=i.s.r;w<=i.e.r;++w)(m[w]||{}).hidden||(f=mj(t,i,w,p,a,l,s,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((x++?o:"")+f)));return delete n.dense,r.join("")}function Ik(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=pv(t,e);return r}function xj(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=$t(t["!ref"]),s="",a=[],o,l=[],u=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=Cr(o);for(var f=i.s.r;f<=i.e.r;++f)for(s=Hr(f),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=u?(t[f]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function Nk(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Fr(n.origin):n.origin;a=l.r,o=l.c}var u,f={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var p=$t(s["!ref"]);f.e.c=Math.max(f.e.c,p.e.c),f.e.r=Math.max(f.e.r,p.e.r),a==-1&&(a=p.e.r+1,f.e.r=a+e.length-1+i)}else a==-1&&(a=0,f.e.r=e.length-1+i);var g=n.header||[],m=0;e.forEach(function(x,w){Br(x).forEach(function(A){(m=g.indexOf(A))==-1&&(g[m=g.length]=A);var k=x[A],_="z",O="",G=ft({c:o+m,r:a+w+i});u=xf(s,G),k&&typeof k=="object"&&!(k instanceof Date)?s[G]=k:(typeof k=="number"?_="n":typeof k=="boolean"?_="b":typeof k=="string"?_="s":k instanceof Date?(_="d",n.cellDates||(_="n",k=mn(k)),O=n.dateNF||ut[14]):k===null&&n.nullError&&(_="e",k=0),u?(u.t=_,u.v=k,delete u.w,delete u.R,O&&(u.z=O)):s[G]=u={t:_,v:k},O&&(u.z=O))})}),f.e.c=Math.max(f.e.c,o+g.length-1);var y=Hr(a);if(i)for(m=0;m<g.length;++m)s[Cr(m+o)+y]={t:"s",v:g[m]};return s["!ref"]=St(f),s}function vj(t,e){return Nk(null,t,e)}function xf(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Fr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?xf(t,ft(e)):xf(t,ft({r:e,c:r||0}))}function yj(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function gv(){return{SheetNames:[],Sheets:{}}}function mv(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(pk(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function _j(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=yj(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function Ej(t,e){return t.z=e,t}function Rk(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function wj(t,e,r){return Rk(t,"#"+e,r)}function Sj(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function Tj(t,e,r,n){for(var i=typeof e!="string"?e:$t(e),s=typeof e=="string"?e:St(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=xf(t,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var Ar={encode_col:Cr,encode_row:Hr,encode_cell:ft,encode_range:St,decode_col:$1,decode_row:H1,split_cell:OR,decode_cell:Fr,decode_range:Vi,format_cell:Xa,sheet_add_aoa:sA,sheet_add_json:Nk,sheet_add_dom:wk,aoa_to_sheet:Ru,json_to_sheet:vj,table_to_sheet:Sk,table_to_book:NL,sheet_to_csv:pv,sheet_to_txt:Ik,sheet_to_json:tp,sheet_to_html:Ek,sheet_to_formulae:xj,sheet_to_row_object_array:tp,sheet_get_cell:xf,book_new:gv,book_append_sheet:mv,book_set_sheet_visibility:_j,cell_set_number_format:Ej,cell_set_hyperlink:Rk,cell_set_internal_link:wj,cell_add_comment:Sj,sheet_set_array_formula:Tj,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Aj={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kj=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),At=(t,e)=>{const r=ve.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:l,...u},f)=>ve.createElement("svg",{ref:f,...Aj,width:i,height:i,stroke:n,strokeWidth:a?Number(s)*24/Number(i):s,className:["lucide",`lucide-${kj(t)}`,o].join(" "),...u},[...e.map(([p,g])=>ve.createElement(p,g)),...Array.isArray(l)?l:[l]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $2=At("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G2=At("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cj=At("BellRing",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K2=At("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y2=At("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fj=At("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bj=At("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $g=At("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gg=At("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ij=At("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L0=At("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kg=At("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nj=At("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eo=At("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rj=At("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j0=At("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nd=At("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const id=At("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yg=At("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X2=At("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V0=At("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xg=At("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dj=At("Merge",[["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M12 2v10.3a4 4 0 0 1-1.172 2.872L4 22",key:"1hyw0i"}],["path",{d:"m20 22-5-5",key:"1m27yz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pj=At("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oj=At("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U0=At("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q2=At("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sd=At("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qg=At("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wl=At("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mj=At("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z0=At("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q2=At("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bj=At("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J2=At("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lj=At("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=At("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=At("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z2=At("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=At("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var eE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dk=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},jj=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[r++],a=t[r++],o=t[r++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},Pk={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,o=a?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,f=s>>2,p=(s&3)<<4|o>>4;let g=(o&15)<<2|u>>6,m=u&63;l||(m=64,a||(g=64)),n.push(r[f],r[p],r[g],r[m])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Dk(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):jj(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const u=i<t.length?r[t.charAt(i)]:64;++i;const p=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||u==null||p==null)throw new Vj;const g=s<<2|o>>4;if(n.push(g),u!==64){const m=o<<4&240|u>>2;if(n.push(m),p!==64){const y=u<<6&192|p;n.push(y)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Vj extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Uj=function(t){const e=Dk(t);return Pk.encodeByteArray(e,!0)},rp=function(t){return Uj(t).replace(/\./g,"")},Ok=function(t){try{return Pk.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zj(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wj=()=>zj().__FIREBASE_DEFAULTS__,Hj=()=>{if(typeof process>"u"||typeof eE>"u")return;const t=eE.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},$j=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Ok(t[1]);return e&&JSON.parse(e)},Hp=()=>{try{return Wj()||Hj()||$j()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Mk=t=>{var e,r;return(r=(e=Hp())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},Gj=t=>{const e=Mk(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},Bk=()=>{var t;return(t=Hp())===null||t===void 0?void 0:t.config},Lk=t=>{var e;return(e=Hp())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kj{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yj(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[rp(JSON.stringify(r)),rp(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function li(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Xj(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(li())}function qj(){var t;const e=(t=Hp())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Qj(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Jj(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Zj(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function e9(){const t=li();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function t9(){return!qj()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function r9(){try{return typeof indexedDB=="object"}catch{return!1}}function n9(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i9="FirebaseError";class so extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=i9,Object.setPrototypeOf(this,so.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Uf.prototype.create)}}class Uf{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?s9(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new so(i,o,n)}}function s9(t,e){return t.replace(a9,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const a9=/\{\$([^}]+)}/g;function o9(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function np(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const s=t[i],a=e[i];if(tE(s)&&tE(a)){if(!np(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function tE(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zf(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function l9(t,e){const r=new c9(t,e);return r.subscribe.bind(r)}class c9{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");u9(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=Qg),i.error===void 0&&(i.error=Qg),i.complete===void 0&&(i.complete=Qg);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function u9(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Qg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qs(t){return t&&t._delegate?t._delegate:t}class Jl{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Al="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d9{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new Kj;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(h9(e))try{this.getOrInitializeService({instanceIdentifier:Al})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=Al){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Al){return this.instances.has(e)}getOptions(e=Al){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:f9(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Al){return this.component?this.component.multipleInstances?e:Al:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function f9(t){return t===Al?void 0:t}function h9(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p9{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new d9(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Vt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Vt||(Vt={}));const g9={debug:Vt.DEBUG,verbose:Vt.VERBOSE,info:Vt.INFO,warn:Vt.WARN,error:Vt.ERROR,silent:Vt.SILENT},m9=Vt.INFO,x9={[Vt.DEBUG]:"log",[Vt.VERBOSE]:"log",[Vt.INFO]:"info",[Vt.WARN]:"warn",[Vt.ERROR]:"error"},v9=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=x9[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class xv{constructor(e){this.name=e,this._logLevel=m9,this._logHandler=v9,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Vt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?g9[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Vt.DEBUG,...e),this._logHandler(this,Vt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Vt.VERBOSE,...e),this._logHandler(this,Vt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Vt.INFO,...e),this._logHandler(this,Vt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Vt.WARN,...e),this._logHandler(this,Vt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Vt.ERROR,...e),this._logHandler(this,Vt.ERROR,...e)}}const y9=(t,e)=>e.some(r=>t instanceof r);let rE,nE;function _9(){return rE||(rE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function E9(){return nE||(nE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const jk=new WeakMap,hx=new WeakMap,Vk=new WeakMap,Jg=new WeakMap,vv=new WeakMap;function w9(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r($o(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&jk.set(r,t)}).catch(()=>{}),vv.set(e,t),e}function S9(t){if(hx.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});hx.set(t,e)}let px={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return hx.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Vk.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return $o(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function T9(t){px=t(px)}function A9(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Zg(this),e,...r);return Vk.set(n,e.sort?e.sort():[e]),$o(n)}:E9().includes(t)?function(...e){return t.apply(Zg(this),e),$o(jk.get(this))}:function(...e){return $o(t.apply(Zg(this),e))}}function k9(t){return typeof t=="function"?A9(t):(t instanceof IDBTransaction&&S9(t),y9(t,_9())?new Proxy(t,px):t)}function $o(t){if(t instanceof IDBRequest)return w9(t);if(Jg.has(t))return Jg.get(t);const e=k9(t);return e!==t&&(Jg.set(t,e),vv.set(e,t)),e}const Zg=t=>vv.get(t);function C9(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),o=$o(a);return n&&a.addEventListener("upgradeneeded",l=>{n($o(a.result),l.oldVersion,l.newVersion,$o(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const F9=["get","getKey","getAll","getAllKeys","count"],b9=["put","add","delete","clear"],em=new Map;function iE(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(em.get(e))return em.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=b9.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||F9.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let u=l.store;return n&&(u=u.index(o.shift())),(await Promise.all([u[r](...o),i&&l.done]))[0]};return em.set(e,s),s}T9(t=>({...t,get:(e,r,n)=>iE(e,r)||t.get(e,r,n),has:(e,r)=>!!iE(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I9{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(N9(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function N9(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const gx="@firebase/app",sE="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qa=new xv("@firebase/app"),R9="@firebase/app-compat",D9="@firebase/analytics-compat",P9="@firebase/analytics",O9="@firebase/app-check-compat",M9="@firebase/app-check",B9="@firebase/auth",L9="@firebase/auth-compat",j9="@firebase/database",V9="@firebase/data-connect",U9="@firebase/database-compat",z9="@firebase/functions",W9="@firebase/functions-compat",H9="@firebase/installations",$9="@firebase/installations-compat",G9="@firebase/messaging",K9="@firebase/messaging-compat",Y9="@firebase/performance",X9="@firebase/performance-compat",q9="@firebase/remote-config",Q9="@firebase/remote-config-compat",J9="@firebase/storage",Z9="@firebase/storage-compat",e7="@firebase/firestore",t7="@firebase/vertexai-preview",r7="@firebase/firestore-compat",n7="firebase",i7="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mx="[DEFAULT]",s7={[gx]:"fire-core",[R9]:"fire-core-compat",[P9]:"fire-analytics",[D9]:"fire-analytics-compat",[M9]:"fire-app-check",[O9]:"fire-app-check-compat",[B9]:"fire-auth",[L9]:"fire-auth-compat",[j9]:"fire-rtdb",[V9]:"fire-data-connect",[U9]:"fire-rtdb-compat",[z9]:"fire-fn",[W9]:"fire-fn-compat",[H9]:"fire-iid",[$9]:"fire-iid-compat",[G9]:"fire-fcm",[K9]:"fire-fcm-compat",[Y9]:"fire-perf",[X9]:"fire-perf-compat",[q9]:"fire-rc",[Q9]:"fire-rc-compat",[J9]:"fire-gcs",[Z9]:"fire-gcs-compat",[e7]:"fire-fst",[r7]:"fire-fst-compat",[t7]:"fire-vertex","fire-js":"fire-js",[n7]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ip=new Map,a7=new Map,xx=new Map;function aE(t,e){try{t.container.addComponent(e)}catch(r){qa.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function vu(t){const e=t.name;if(xx.has(e))return qa.debug(`There were multiple attempts to register component ${e}.`),!1;xx.set(e,t);for(const r of ip.values())aE(r,t);for(const r of a7.values())aE(r,t);return!0}function yv(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Oo(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o7={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Go=new Uf("app","Firebase",o7);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l7{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Jl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Go.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pu=i7;function Uk(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:mx,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw Go.create("bad-app-name",{appName:String(i)});if(r||(r=Bk()),!r)throw Go.create("no-options");const s=ip.get(i);if(s){if(np(r,s.options)&&np(n,s.config))return s;throw Go.create("duplicate-app",{appName:i})}const a=new p9(i);for(const l of xx.values())a.addComponent(l);const o=new l7(r,n,a);return ip.set(i,o),o}function zk(t=mx){const e=ip.get(t);if(!e&&t===mx&&Bk())return Uk();if(!e)throw Go.create("no-app",{appName:t});return e}function Ko(t,e,r){var n;let i=(n=s7[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),qa.warn(o.join(" "));return}vu(new Jl(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c7="firebase-heartbeat-database",u7=1,vf="firebase-heartbeat-store";let tm=null;function Wk(){return tm||(tm=C9(c7,u7,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(vf)}catch(r){console.warn(r)}}}}).catch(t=>{throw Go.create("idb-open",{originalErrorMessage:t.message})})),tm}async function d7(t){try{const r=(await Wk()).transaction(vf),n=await r.objectStore(vf).get(Hk(t));return await r.done,n}catch(e){if(e instanceof so)qa.warn(e.message);else{const r=Go.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});qa.warn(r.message)}}}async function oE(t,e){try{const n=(await Wk()).transaction(vf,"readwrite");await n.objectStore(vf).put(e,Hk(t)),await n.done}catch(r){if(r instanceof so)qa.warn(r.message);else{const n=Go.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});qa.warn(n.message)}}}function Hk(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f7=1024,h7=30*24*60*60*1e3;class p7{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new m7(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=lE();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=h7}),this._storage.overwrite(this._heartbeatsCache))}catch(n){qa.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=lE(),{heartbeatsToSend:n,unsentEntries:i}=g7(this._heartbeatsCache.heartbeats),s=rp(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return qa.warn(r),""}}}function lE(){return new Date().toISOString().substring(0,10)}function g7(t,e=f7){const r=[];let n=t.slice();for(const i of t){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),cE(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),cE(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class m7{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return r9()?n9().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await d7(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return oE(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return oE(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function cE(t){return rp(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x7(t){vu(new Jl("platform-logger",e=>new I9(e),"PRIVATE")),vu(new Jl("heartbeat",e=>new p7(e),"PRIVATE")),Ko(gx,sE,t),Ko(gx,sE,"esm2017"),Ko("fire-js","")}x7("");var v7="firebase",y7="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ko(v7,y7,"app");var uE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var jl,$k;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,F){function S(){}S.prototype=F.prototype,T.D=F.prototype,T.prototype=new S,T.prototype.constructor=T,T.C=function(I,R,D){for(var N=Array(arguments.length-2),Ge=2;Ge<arguments.length;Ge++)N[Ge-2]=arguments[Ge];return F.prototype[R].apply(I,N)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,F,S){S||(S=0);var I=Array(16);if(typeof F=="string")for(var R=0;16>R;++R)I[R]=F.charCodeAt(S++)|F.charCodeAt(S++)<<8|F.charCodeAt(S++)<<16|F.charCodeAt(S++)<<24;else for(R=0;16>R;++R)I[R]=F[S++]|F[S++]<<8|F[S++]<<16|F[S++]<<24;F=T.g[0],S=T.g[1],R=T.g[2];var D=T.g[3],N=F+(D^S&(R^D))+I[0]+3614090360&4294967295;F=S+(N<<7&4294967295|N>>>25),N=D+(R^F&(S^R))+I[1]+3905402710&4294967295,D=F+(N<<12&4294967295|N>>>20),N=R+(S^D&(F^S))+I[2]+606105819&4294967295,R=D+(N<<17&4294967295|N>>>15),N=S+(F^R&(D^F))+I[3]+3250441966&4294967295,S=R+(N<<22&4294967295|N>>>10),N=F+(D^S&(R^D))+I[4]+4118548399&4294967295,F=S+(N<<7&4294967295|N>>>25),N=D+(R^F&(S^R))+I[5]+1200080426&4294967295,D=F+(N<<12&4294967295|N>>>20),N=R+(S^D&(F^S))+I[6]+2821735955&4294967295,R=D+(N<<17&4294967295|N>>>15),N=S+(F^R&(D^F))+I[7]+4249261313&4294967295,S=R+(N<<22&4294967295|N>>>10),N=F+(D^S&(R^D))+I[8]+1770035416&4294967295,F=S+(N<<7&4294967295|N>>>25),N=D+(R^F&(S^R))+I[9]+2336552879&4294967295,D=F+(N<<12&4294967295|N>>>20),N=R+(S^D&(F^S))+I[10]+4294925233&4294967295,R=D+(N<<17&4294967295|N>>>15),N=S+(F^R&(D^F))+I[11]+2304563134&4294967295,S=R+(N<<22&4294967295|N>>>10),N=F+(D^S&(R^D))+I[12]+1804603682&4294967295,F=S+(N<<7&4294967295|N>>>25),N=D+(R^F&(S^R))+I[13]+4254626195&4294967295,D=F+(N<<12&4294967295|N>>>20),N=R+(S^D&(F^S))+I[14]+2792965006&4294967295,R=D+(N<<17&4294967295|N>>>15),N=S+(F^R&(D^F))+I[15]+1236535329&4294967295,S=R+(N<<22&4294967295|N>>>10),N=F+(R^D&(S^R))+I[1]+4129170786&4294967295,F=S+(N<<5&4294967295|N>>>27),N=D+(S^R&(F^S))+I[6]+3225465664&4294967295,D=F+(N<<9&4294967295|N>>>23),N=R+(F^S&(D^F))+I[11]+643717713&4294967295,R=D+(N<<14&4294967295|N>>>18),N=S+(D^F&(R^D))+I[0]+3921069994&4294967295,S=R+(N<<20&4294967295|N>>>12),N=F+(R^D&(S^R))+I[5]+3593408605&4294967295,F=S+(N<<5&4294967295|N>>>27),N=D+(S^R&(F^S))+I[10]+38016083&4294967295,D=F+(N<<9&4294967295|N>>>23),N=R+(F^S&(D^F))+I[15]+3634488961&4294967295,R=D+(N<<14&4294967295|N>>>18),N=S+(D^F&(R^D))+I[4]+3889429448&4294967295,S=R+(N<<20&4294967295|N>>>12),N=F+(R^D&(S^R))+I[9]+568446438&4294967295,F=S+(N<<5&4294967295|N>>>27),N=D+(S^R&(F^S))+I[14]+3275163606&4294967295,D=F+(N<<9&4294967295|N>>>23),N=R+(F^S&(D^F))+I[3]+4107603335&4294967295,R=D+(N<<14&4294967295|N>>>18),N=S+(D^F&(R^D))+I[8]+1163531501&4294967295,S=R+(N<<20&4294967295|N>>>12),N=F+(R^D&(S^R))+I[13]+2850285829&4294967295,F=S+(N<<5&4294967295|N>>>27),N=D+(S^R&(F^S))+I[2]+4243563512&4294967295,D=F+(N<<9&4294967295|N>>>23),N=R+(F^S&(D^F))+I[7]+1735328473&4294967295,R=D+(N<<14&4294967295|N>>>18),N=S+(D^F&(R^D))+I[12]+2368359562&4294967295,S=R+(N<<20&4294967295|N>>>12),N=F+(S^R^D)+I[5]+4294588738&4294967295,F=S+(N<<4&4294967295|N>>>28),N=D+(F^S^R)+I[8]+2272392833&4294967295,D=F+(N<<11&4294967295|N>>>21),N=R+(D^F^S)+I[11]+1839030562&4294967295,R=D+(N<<16&4294967295|N>>>16),N=S+(R^D^F)+I[14]+4259657740&4294967295,S=R+(N<<23&4294967295|N>>>9),N=F+(S^R^D)+I[1]+2763975236&4294967295,F=S+(N<<4&4294967295|N>>>28),N=D+(F^S^R)+I[4]+1272893353&4294967295,D=F+(N<<11&4294967295|N>>>21),N=R+(D^F^S)+I[7]+4139469664&4294967295,R=D+(N<<16&4294967295|N>>>16),N=S+(R^D^F)+I[10]+3200236656&4294967295,S=R+(N<<23&4294967295|N>>>9),N=F+(S^R^D)+I[13]+681279174&4294967295,F=S+(N<<4&4294967295|N>>>28),N=D+(F^S^R)+I[0]+3936430074&4294967295,D=F+(N<<11&4294967295|N>>>21),N=R+(D^F^S)+I[3]+3572445317&4294967295,R=D+(N<<16&4294967295|N>>>16),N=S+(R^D^F)+I[6]+76029189&4294967295,S=R+(N<<23&4294967295|N>>>9),N=F+(S^R^D)+I[9]+3654602809&4294967295,F=S+(N<<4&4294967295|N>>>28),N=D+(F^S^R)+I[12]+3873151461&4294967295,D=F+(N<<11&4294967295|N>>>21),N=R+(D^F^S)+I[15]+530742520&4294967295,R=D+(N<<16&4294967295|N>>>16),N=S+(R^D^F)+I[2]+3299628645&4294967295,S=R+(N<<23&4294967295|N>>>9),N=F+(R^(S|~D))+I[0]+4096336452&4294967295,F=S+(N<<6&4294967295|N>>>26),N=D+(S^(F|~R))+I[7]+1126891415&4294967295,D=F+(N<<10&4294967295|N>>>22),N=R+(F^(D|~S))+I[14]+2878612391&4294967295,R=D+(N<<15&4294967295|N>>>17),N=S+(D^(R|~F))+I[5]+4237533241&4294967295,S=R+(N<<21&4294967295|N>>>11),N=F+(R^(S|~D))+I[12]+1700485571&4294967295,F=S+(N<<6&4294967295|N>>>26),N=D+(S^(F|~R))+I[3]+2399980690&4294967295,D=F+(N<<10&4294967295|N>>>22),N=R+(F^(D|~S))+I[10]+4293915773&4294967295,R=D+(N<<15&4294967295|N>>>17),N=S+(D^(R|~F))+I[1]+2240044497&4294967295,S=R+(N<<21&4294967295|N>>>11),N=F+(R^(S|~D))+I[8]+1873313359&4294967295,F=S+(N<<6&4294967295|N>>>26),N=D+(S^(F|~R))+I[15]+4264355552&4294967295,D=F+(N<<10&4294967295|N>>>22),N=R+(F^(D|~S))+I[6]+2734768916&4294967295,R=D+(N<<15&4294967295|N>>>17),N=S+(D^(R|~F))+I[13]+1309151649&4294967295,S=R+(N<<21&4294967295|N>>>11),N=F+(R^(S|~D))+I[4]+4149444226&4294967295,F=S+(N<<6&4294967295|N>>>26),N=D+(S^(F|~R))+I[11]+3174756917&4294967295,D=F+(N<<10&4294967295|N>>>22),N=R+(F^(D|~S))+I[2]+718787259&4294967295,R=D+(N<<15&4294967295|N>>>17),N=S+(D^(R|~F))+I[9]+3951481745&4294967295,T.g[0]=T.g[0]+F&4294967295,T.g[1]=T.g[1]+(R+(N<<21&4294967295|N>>>11))&4294967295,T.g[2]=T.g[2]+R&4294967295,T.g[3]=T.g[3]+D&4294967295}n.prototype.u=function(T,F){F===void 0&&(F=T.length);for(var S=F-this.blockSize,I=this.B,R=this.h,D=0;D<F;){if(R==0)for(;D<=S;)i(this,T,D),D+=this.blockSize;if(typeof T=="string"){for(;D<F;)if(I[R++]=T.charCodeAt(D++),R==this.blockSize){i(this,I),R=0;break}}else for(;D<F;)if(I[R++]=T[D++],R==this.blockSize){i(this,I),R=0;break}}this.h=R,this.o+=F},n.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var F=1;F<T.length-8;++F)T[F]=0;var S=8*this.o;for(F=T.length-8;F<T.length;++F)T[F]=S&255,S/=256;for(this.u(T),T=Array(16),F=S=0;4>F;++F)for(var I=0;32>I;I+=8)T[S++]=this.g[F]>>>I&255;return T};function s(T,F){var S=o;return Object.prototype.hasOwnProperty.call(S,T)?S[T]:S[T]=F(T)}function a(T,F){this.h=F;for(var S=[],I=!0,R=T.length-1;0<=R;R--){var D=T[R]|0;I&&D==F||(S[R]=D,I=!1)}this.g=S}var o={};function l(T){return-128<=T&&128>T?s(T,function(F){return new a([F|0],0>F?-1:0)}):new a([T|0],0>T?-1:0)}function u(T){if(isNaN(T)||!isFinite(T))return p;if(0>T)return w(u(-T));for(var F=[],S=1,I=0;T>=S;I++)F[I]=T/S|0,S*=4294967296;return new a(F,0)}function f(T,F){if(T.length==0)throw Error("number format error: empty string");if(F=F||10,2>F||36<F)throw Error("radix out of range: "+F);if(T.charAt(0)=="-")return w(f(T.substring(1),F));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=u(Math.pow(F,8)),I=p,R=0;R<T.length;R+=8){var D=Math.min(8,T.length-R),N=parseInt(T.substring(R,R+D),F);8>D?(D=u(Math.pow(F,D)),I=I.j(D).add(u(N))):(I=I.j(S),I=I.add(u(N)))}return I}var p=l(0),g=l(1),m=l(16777216);t=a.prototype,t.m=function(){if(x(this))return-w(this).m();for(var T=0,F=1,S=0;S<this.g.length;S++){var I=this.i(S);T+=(0<=I?I:4294967296+I)*F,F*=4294967296}return T},t.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(y(this))return"0";if(x(this))return"-"+w(this).toString(T);for(var F=u(Math.pow(T,6)),S=this,I="";;){var R=O(S,F).g;S=A(S,R.j(F));var D=((0<S.g.length?S.g[0]:S.h)>>>0).toString(T);if(S=R,y(S))return D+I;for(;6>D.length;)D="0"+D;I=D+I}},t.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function y(T){if(T.h!=0)return!1;for(var F=0;F<T.g.length;F++)if(T.g[F]!=0)return!1;return!0}function x(T){return T.h==-1}t.l=function(T){return T=A(this,T),x(T)?-1:y(T)?0:1};function w(T){for(var F=T.g.length,S=[],I=0;I<F;I++)S[I]=~T.g[I];return new a(S,~T.h).add(g)}t.abs=function(){return x(this)?w(this):this},t.add=function(T){for(var F=Math.max(this.g.length,T.g.length),S=[],I=0,R=0;R<=F;R++){var D=I+(this.i(R)&65535)+(T.i(R)&65535),N=(D>>>16)+(this.i(R)>>>16)+(T.i(R)>>>16);I=N>>>16,D&=65535,N&=65535,S[R]=N<<16|D}return new a(S,S[S.length-1]&-2147483648?-1:0)};function A(T,F){return T.add(w(F))}t.j=function(T){if(y(this)||y(T))return p;if(x(this))return x(T)?w(this).j(w(T)):w(w(this).j(T));if(x(T))return w(this.j(w(T)));if(0>this.l(m)&&0>T.l(m))return u(this.m()*T.m());for(var F=this.g.length+T.g.length,S=[],I=0;I<2*F;I++)S[I]=0;for(I=0;I<this.g.length;I++)for(var R=0;R<T.g.length;R++){var D=this.i(I)>>>16,N=this.i(I)&65535,Ge=T.i(R)>>>16,_e=T.i(R)&65535;S[2*I+2*R]+=N*_e,k(S,2*I+2*R),S[2*I+2*R+1]+=D*_e,k(S,2*I+2*R+1),S[2*I+2*R+1]+=N*Ge,k(S,2*I+2*R+1),S[2*I+2*R+2]+=D*Ge,k(S,2*I+2*R+2)}for(I=0;I<F;I++)S[I]=S[2*I+1]<<16|S[2*I];for(I=F;I<2*F;I++)S[I]=0;return new a(S,0)};function k(T,F){for(;(T[F]&65535)!=T[F];)T[F+1]+=T[F]>>>16,T[F]&=65535,F++}function _(T,F){this.g=T,this.h=F}function O(T,F){if(y(F))throw Error("division by zero");if(y(T))return new _(p,p);if(x(T))return F=O(w(T),F),new _(w(F.g),w(F.h));if(x(F))return F=O(T,w(F)),new _(w(F.g),F.h);if(30<T.g.length){if(x(T)||x(F))throw Error("slowDivide_ only works with positive integers.");for(var S=g,I=F;0>=I.l(T);)S=G(S),I=G(I);var R=U(S,1),D=U(I,1);for(I=U(I,2),S=U(S,2);!y(I);){var N=D.add(I);0>=N.l(T)&&(R=R.add(S),D=N),I=U(I,1),S=U(S,1)}return F=A(T,R.j(F)),new _(R,F)}for(R=p;0<=T.l(F);){for(S=Math.max(1,Math.floor(T.m()/F.m())),I=Math.ceil(Math.log(S)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),D=u(S),N=D.j(F);x(N)||0<N.l(T);)S-=I,D=u(S),N=D.j(F);y(D)&&(D=g),R=R.add(D),T=A(T,N)}return new _(R,T)}t.A=function(T){return O(this,T).h},t.and=function(T){for(var F=Math.max(this.g.length,T.g.length),S=[],I=0;I<F;I++)S[I]=this.i(I)&T.i(I);return new a(S,this.h&T.h)},t.or=function(T){for(var F=Math.max(this.g.length,T.g.length),S=[],I=0;I<F;I++)S[I]=this.i(I)|T.i(I);return new a(S,this.h|T.h)},t.xor=function(T){for(var F=Math.max(this.g.length,T.g.length),S=[],I=0;I<F;I++)S[I]=this.i(I)^T.i(I);return new a(S,this.h^T.h)};function G(T){for(var F=T.g.length+1,S=[],I=0;I<F;I++)S[I]=T.i(I)<<1|T.i(I-1)>>>31;return new a(S,T.h)}function U(T,F){var S=F>>5;F%=32;for(var I=T.g.length-S,R=[],D=0;D<I;D++)R[D]=0<F?T.i(D+S)>>>F|T.i(D+S+1)<<32-F:T.i(D+S);return new a(R,T.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,$k=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=f,jl=a}).apply(typeof uE<"u"?uE:typeof self<"u"?self:typeof window<"u"?window:{});var W0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Gk,pd,Kk,uh,vx,Yk,Xk,qk;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,v,C){return d==Array.prototype||d==Object.prototype||(d[v]=C.value),d};function r(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof W0=="object"&&W0];for(var v=0;v<d.length;++v){var C=d[v];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var n=r(this);function i(d,v){if(v)e:{var C=n;d=d.split(".");for(var M=0;M<d.length-1;M++){var oe=d[M];if(!(oe in C))break e;C=C[oe]}d=d[d.length-1],M=C[d],v=v(M),v!=M&&v!=null&&e(C,d,{configurable:!0,writable:!0,value:v})}}function s(d,v){d instanceof String&&(d+="");var C=0,M=!1,oe={next:function(){if(!M&&C<d.length){var me=C++;return{value:v(me,d[me]),done:!1}}return M=!0,{done:!0,value:void 0}}};return oe[Symbol.iterator]=function(){return oe},oe}i("Array.prototype.values",function(d){return d||function(){return s(this,function(v,C){return C})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(d){var v=typeof d;return v=v!="object"?v:d?Array.isArray(d)?"array":v:"null",v=="array"||v=="object"&&typeof d.length=="number"}function u(d){var v=typeof d;return v=="object"&&d!=null||v=="function"}function f(d,v,C){return d.call.apply(d.bind,arguments)}function p(d,v,C){if(!d)throw Error();if(2<arguments.length){var M=Array.prototype.slice.call(arguments,2);return function(){var oe=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(oe,M),d.apply(v,oe)}}return function(){return d.apply(v,arguments)}}function g(d,v,C){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,g.apply(null,arguments)}function m(d,v){var C=Array.prototype.slice.call(arguments,1);return function(){var M=C.slice();return M.push.apply(M,arguments),d.apply(this,M)}}function y(d,v){function C(){}C.prototype=v.prototype,d.aa=v.prototype,d.prototype=new C,d.prototype.constructor=d,d.Qb=function(M,oe,me){for(var $e=Array(arguments.length-2),Qt=2;Qt<arguments.length;Qt++)$e[Qt-2]=arguments[Qt];return v.prototype[oe].apply(M,$e)}}function x(d){const v=d.length;if(0<v){const C=Array(v);for(let M=0;M<v;M++)C[M]=d[M];return C}return[]}function w(d,v){for(let C=1;C<arguments.length;C++){const M=arguments[C];if(l(M)){const oe=d.length||0,me=M.length||0;d.length=oe+me;for(let $e=0;$e<me;$e++)d[oe+$e]=M[$e]}else d.push(M)}}class A{constructor(v,C){this.i=v,this.j=C,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function k(d){return/^[\s\xa0]*$/.test(d)}function _(){var d=o.navigator;return d&&(d=d.userAgent)?d:""}function O(d){return O[" "](d),d}O[" "]=function(){};var G=_().indexOf("Gecko")!=-1&&!(_().toLowerCase().indexOf("webkit")!=-1&&_().indexOf("Edge")==-1)&&!(_().indexOf("Trident")!=-1||_().indexOf("MSIE")!=-1)&&_().indexOf("Edge")==-1;function U(d,v,C){for(const M in d)v.call(C,d[M],M,d)}function T(d,v){for(const C in d)v.call(void 0,d[C],C,d)}function F(d){const v={};for(const C in d)v[C]=d[C];return v}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(d,v){let C,M;for(let oe=1;oe<arguments.length;oe++){M=arguments[oe];for(C in M)d[C]=M[C];for(let me=0;me<S.length;me++)C=S[me],Object.prototype.hasOwnProperty.call(M,C)&&(d[C]=M[C])}}function R(d){var v=1;d=d.split(":");const C=[];for(;0<v&&d.length;)C.push(d.shift()),v--;return d.length&&C.push(d.join(":")),C}function D(d){o.setTimeout(()=>{throw d},0)}function N(){var d=te;let v=null;return d.g&&(v=d.g,d.g=d.g.next,d.g||(d.h=null),v.next=null),v}class Ge{constructor(){this.h=this.g=null}add(v,C){const M=_e.get();M.set(v,C),this.h?this.h.next=M:this.g=M,this.h=M}}var _e=new A(()=>new Re,d=>d.reset());class Re{constructor(){this.next=this.g=this.h=null}set(v,C){this.h=v,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let Me,Se=!1,te=new Ge,Ce=()=>{const d=o.Promise.resolve(void 0);Me=()=>{d.then(je)}};var je=()=>{for(var d;d=N();){try{d.h.call(d.g)}catch(C){D(C)}var v=_e;v.j(d),100>v.h&&(v.h++,d.next=v.g,v.g=d)}Se=!1};function W(){this.s=this.s,this.C=this.C}W.prototype.s=!1,W.prototype.ma=function(){this.s||(this.s=!0,this.N())},W.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function re(d,v){this.type=d,this.g=this.target=v,this.defaultPrevented=!1}re.prototype.h=function(){this.defaultPrevented=!0};var ee=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var d=!1,v=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const C=()=>{};o.addEventListener("test",C,v),o.removeEventListener("test",C,v)}catch{}return d}();function Y(d,v){if(re.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var C=this.type=d.type,M=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=v,v=d.relatedTarget){if(G){e:{try{O(v.nodeName);var oe=!0;break e}catch{}oe=!1}oe||(v=null)}}else C=="mouseover"?v=d.fromElement:C=="mouseout"&&(v=d.toElement);this.relatedTarget=v,M?(this.clientX=M.clientX!==void 0?M.clientX:M.pageX,this.clientY=M.clientY!==void 0?M.clientY:M.pageY,this.screenX=M.screenX||0,this.screenY=M.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:xe[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&Y.aa.h.call(this)}}y(Y,re);var xe={2:"touch",3:"pen",4:"mouse"};Y.prototype.h=function(){Y.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var Ee="closure_listenable_"+(1e6*Math.random()|0),Le=0;function Fe(d,v,C,M,oe){this.listener=d,this.proxy=null,this.src=v,this.type=C,this.capture=!!M,this.ha=oe,this.key=++Le,this.da=this.fa=!1}function Ae(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function it(d){this.src=d,this.g={},this.h=0}it.prototype.add=function(d,v,C,M,oe){var me=d.toString();d=this.g[me],d||(d=this.g[me]=[],this.h++);var $e=Pt(d,v,M,oe);return-1<$e?(v=d[$e],C||(v.fa=!1)):(v=new Fe(v,this.src,me,!!M,oe),v.fa=C,d.push(v)),v};function q(d,v){var C=v.type;if(C in d.g){var M=d.g[C],oe=Array.prototype.indexOf.call(M,v,void 0),me;(me=0<=oe)&&Array.prototype.splice.call(M,oe,1),me&&(Ae(v),d.g[C].length==0&&(delete d.g[C],d.h--))}}function Pt(d,v,C,M){for(var oe=0;oe<d.length;++oe){var me=d[oe];if(!me.da&&me.listener==v&&me.capture==!!C&&me.ha==M)return oe}return-1}var Et="closure_lm_"+(1e6*Math.random()|0),Nt={};function xt(d,v,C,M,oe){if(Array.isArray(v)){for(var me=0;me<v.length;me++)xt(d,v[me],C,M,oe);return null}return C=Ti(C),d&&d[Ee]?d.K(v,C,u(M)?!!M.capture:!1,oe):Ke(d,v,C,!1,M,oe)}function Ke(d,v,C,M,oe,me){if(!v)throw Error("Invalid event type");var $e=u(oe)?!!oe.capture:!!oe,Qt=Si(d);if(Qt||(d[Et]=Qt=new it(d)),C=Qt.add(v,C,M,$e,me),C.proxy)return C;if(M=ir(),C.proxy=M,M.src=d,M.listener=C,d.addEventListener)ee||(oe=$e),oe===void 0&&(oe=!1),d.addEventListener(v.toString(),M,oe);else if(d.attachEvent)d.attachEvent(wi(v.toString()),M);else if(d.addListener&&d.removeListener)d.addListener(M);else throw Error("addEventListener and attachEvent are unavailable.");return C}function ir(){function d(C){return v.call(d.src,d.listener,C)}const v=rs;return d}function bn(d,v,C,M,oe){if(Array.isArray(v))for(var me=0;me<v.length;me++)bn(d,v[me],C,M,oe);else M=u(M)?!!M.capture:!!M,C=Ti(C),d&&d[Ee]?(d=d.i,v=String(v).toString(),v in d.g&&(me=d.g[v],C=Pt(me,C,M,oe),-1<C&&(Ae(me[C]),Array.prototype.splice.call(me,C,1),me.length==0&&(delete d.g[v],d.h--)))):d&&(d=Si(d))&&(v=d.g[v.toString()],d=-1,v&&(d=Pt(v,C,M,oe)),(C=-1<d?v[d]:null)&&en(C))}function en(d){if(typeof d!="number"&&d&&!d.da){var v=d.src;if(v&&v[Ee])q(v.i,d);else{var C=d.type,M=d.proxy;v.removeEventListener?v.removeEventListener(C,M,d.capture):v.detachEvent?v.detachEvent(wi(C),M):v.addListener&&v.removeListener&&v.removeListener(M),(C=Si(v))?(q(C,d),C.h==0&&(C.src=null,v[Et]=null)):Ae(d)}}}function wi(d){return d in Nt?Nt[d]:Nt[d]="on"+d}function rs(d,v){if(d.da)d=!0;else{v=new Y(v,this);var C=d.listener,M=d.ha||d.src;d.fa&&en(d),d=C.call(M,v)}return d}function Si(d){return d=d[Et],d instanceof it?d:null}var Lr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ti(d){return typeof d=="function"?d:(d[Lr]||(d[Lr]=function(v){return d.handleEvent(v)}),d[Lr])}function qt(){W.call(this),this.i=new it(this),this.M=this,this.F=null}y(qt,W),qt.prototype[Ee]=!0,qt.prototype.removeEventListener=function(d,v,C,M){bn(this,d,v,C,M)};function Sr(d,v){var C,M=d.F;if(M)for(C=[];M;M=M.F)C.push(M);if(d=d.M,M=v.type||v,typeof v=="string")v=new re(v,d);else if(v instanceof re)v.target=v.target||d;else{var oe=v;v=new re(M,d),I(v,oe)}if(oe=!0,C)for(var me=C.length-1;0<=me;me--){var $e=v.g=C[me];oe=dr($e,M,!0,v)&&oe}if($e=v.g=d,oe=dr($e,M,!0,v)&&oe,oe=dr($e,M,!1,v)&&oe,C)for(me=0;me<C.length;me++)$e=v.g=C[me],oe=dr($e,M,!1,v)&&oe}qt.prototype.N=function(){if(qt.aa.N.call(this),this.i){var d=this.i,v;for(v in d.g){for(var C=d.g[v],M=0;M<C.length;M++)Ae(C[M]);delete d.g[v],d.h--}}this.F=null},qt.prototype.K=function(d,v,C,M){return this.i.add(String(d),v,!1,C,M)},qt.prototype.L=function(d,v,C,M){return this.i.add(String(d),v,!0,C,M)};function dr(d,v,C,M){if(v=d.i.g[String(v)],!v)return!0;v=v.concat();for(var oe=!0,me=0;me<v.length;++me){var $e=v[me];if($e&&!$e.da&&$e.capture==C){var Qt=$e.listener,ln=$e.ha||$e.src;$e.fa&&q(d.i,$e),oe=Qt.call(ln,M)!==!1&&oe}}return oe&&!M.defaultPrevented}function ui(d,v,C){if(typeof d=="function")C&&(d=g(d,C));else if(d&&typeof d.handleEvent=="function")d=g(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:o.setTimeout(d,v||0)}function pt(d){d.g=ui(()=>{d.g=null,d.i&&(d.i=!1,pt(d))},d.l);const v=d.h;d.h=null,d.m.apply(null,v)}class fr extends W{constructor(v,C){super(),this.m=v,this.l=C,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:pt(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function hr(d){W.call(this),this.h=d,this.g={}}y(hr,W);var yr=[];function di(d){U(d.g,function(v,C){this.g.hasOwnProperty(C)&&en(v)},d),d.g={}}hr.prototype.N=function(){hr.aa.N.call(this),di(this)},hr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ao=o.JSON.stringify,oo=o.JSON.parse,Vu=class{stringify(d){return o.JSON.stringify(d,void 0)}parse(d){return o.JSON.parse(d,void 0)}};function Fs(){}Fs.prototype.h=null;function dl(d){return d.h||(d.h=d.i())}function bs(){}var ce={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Rr(){re.call(this,"d")}y(Rr,re);function Ai(){re.call(this,"c")}y(Ai,re);var ns={},_a=null;function Js(){return _a=_a||new qt}ns.La="serverreachability";function Zs(d){re.call(this,ns.La,d)}y(Zs,re);function ki(d){const v=Js();Sr(v,new Zs(v))}ns.STAT_EVENT="statevent";function tn(d,v){re.call(this,ns.STAT_EVENT,d),this.stat=v}y(tn,re);function Gr(d){const v=Js();Sr(v,new tn(v,d))}ns.Ma="timingevent";function Ea(d,v){re.call(this,ns.Ma,d),this.size=v}y(Ea,re);function Is(d,v){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){d()},v)}function rn(){this.g=!0}rn.prototype.xa=function(){this.g=!1};function hc(d,v,C,M,oe,me){d.info(function(){if(d.g)if(me)for(var $e="",Qt=me.split("&"),ln=0;ln<Qt.length;ln++){var Ut=Qt[ln].split("=");if(1<Ut.length){var cn=Ut[0];Ut=Ut[1];var yn=cn.split("_");$e=2<=yn.length&&yn[1]=="type"?$e+(cn+"="+Ut+"&"):$e+(cn+"=redacted&")}}else $e=null;else $e=me;return"XMLHTTP REQ ("+M+") [attempt "+oe+"]: "+v+`
`+C+`
`+$e})}function Ns(d,v,C,M,oe,me,$e){d.info(function(){return"XMLHTTP RESP ("+M+") [ attempt "+oe+"]: "+v+`
`+C+`
`+me+" "+$e})}function b(d,v,C,M){d.info(function(){return"XMLHTTP TEXT ("+v+"): "+B(d,C)+(M?" "+M:"")})}function H(d,v){d.info(function(){return"TIMEOUT: "+v})}rn.prototype.info=function(){};function B(d,v){if(!d.g)return v;if(!v)return null;try{var C=JSON.parse(v);if(C){for(d=0;d<C.length;d++)if(Array.isArray(C[d])){var M=C[d];if(!(2>M.length)){var oe=M[1];if(Array.isArray(oe)&&!(1>oe.length)){var me=oe[0];if(me!="noop"&&me!="stop"&&me!="close")for(var $e=1;$e<oe.length;$e++)oe[$e]=""}}}}return ao(C)}catch{return v}}var L={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},K={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},X;function de(){}y(de,Fs),de.prototype.g=function(){return new XMLHttpRequest},de.prototype.i=function(){return{}},X=new de;function pe(d,v,C,M){this.j=d,this.i=v,this.l=C,this.R=M||1,this.U=new hr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ue}function ue(){this.i=null,this.g="",this.h=!1}var ae={},fe={};function we(d,v,C){d.L=1,d.v=Ta(sn(v)),d.m=C,d.P=!0,Ue(d,null)}function Ue(d,v){d.F=Date.now(),Xe(d),d.A=sn(d.v);var C=d.A,M=d.R;Array.isArray(M)||(M=[String(M)]),Jf(C.i,"t",M),d.C=0,C=d.j.J,d.h=new ue,d.g=s0(d.j,C?v:null,!d.m),0<d.O&&(d.M=new fr(g(d.Y,d,d.g),d.O)),v=d.U,C=d.g,M=d.ca;var oe="readystatechange";Array.isArray(oe)||(oe&&(yr[0]=oe.toString()),oe=yr);for(var me=0;me<oe.length;me++){var $e=xt(C,oe[me],M||v.handleEvent,!1,v.h||v);if(!$e)break;v.g[$e.key]=$e}v=d.H?F(d.H):{},d.m?(d.u||(d.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,v)):(d.u="GET",d.g.ea(d.A,d.u,null,v)),ki(),hc(d.i,d.u,d.A,d.l,d.R,d.m)}pe.prototype.ca=function(d){d=d.target;const v=this.M;v&&us(d)==3?v.j():this.Y(d)},pe.prototype.Y=function(d){try{if(d==this.g)e:{const yn=us(this.g);var v=this.g.Ba();const Fa=this.g.Z();if(!(3>yn)&&(yn!=3||this.g&&(this.h.h||this.g.oa()||ml(this.g)))){this.J||yn!=4||v==7||(v==8||0>=Fa?ki(3):ki(2)),Ot(this);var C=this.g.Z();this.X=C;t:if(Ye(this)){var M=ml(this.g);d="";var oe=M.length,me=us(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){cr(this),Mt(this);var $e="";break t}this.h.i=new o.TextDecoder}for(v=0;v<oe;v++)this.h.h=!0,d+=this.h.i.decode(M[v],{stream:!(me&&v==oe-1)});M.length=0,this.h.g+=d,this.C=0,$e=this.h.g}else $e=this.g.oa();if(this.o=C==200,Ns(this.i,this.u,this.A,this.l,this.R,yn,C),this.o){if(this.T&&!this.K){t:{if(this.g){var Qt,ln=this.g;if((Qt=ln.g?ln.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(Qt)){var Ut=Qt;break t}}Ut=null}if(C=Ut)b(this.i,this.l,C,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ci(this,C);else{this.o=!1,this.s=3,Gr(12),cr(this),Mt(this);break e}}if(this.P){C=!0;let Wi;for(;!this.J&&this.C<$e.length;)if(Wi=Ne(this,$e),Wi==fe){yn==4&&(this.s=4,Gr(14),C=!1),b(this.i,this.l,null,"[Incomplete Response]");break}else if(Wi==ae){this.s=4,Gr(15),b(this.i,this.l,$e,"[Invalid Chunk]"),C=!1;break}else b(this.i,this.l,Wi,null),Ci(this,Wi);if(Ye(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),yn!=4||$e.length!=0||this.h.h||(this.s=1,Gr(16),C=!1),this.o=this.o&&C,!C)b(this.i,this.l,$e,"[Invalid Chunked Response]"),cr(this),Mt(this);else if(0<$e.length&&!this.W){this.W=!0;var cn=this.j;cn.g==this&&cn.ba&&!cn.M&&(cn.j.info("Great, no buffering proxy detected. Bytes received: "+$e.length),Wn(cn),cn.M=!0,Gr(11))}}else b(this.i,this.l,$e,null),Ci(this,$e);yn==4&&cr(this),this.o&&!this.J&&(yn==4?i0(this.j,this):(this.o=!1,Xe(this)))}else Kr(this.g),C==400&&0<$e.indexOf("Unknown SID")?(this.s=3,Gr(12)):(this.s=0,Gr(13)),cr(this),Mt(this)}}}catch{}finally{}};function Ye(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function Ne(d,v){var C=d.C,M=v.indexOf(`
`,C);return M==-1?fe:(C=Number(v.substring(C,M)),isNaN(C)?ae:(M+=1,M+C>v.length?fe:(v=v.slice(M,M+C),d.C=M+C,v)))}pe.prototype.cancel=function(){this.J=!0,cr(this)};function Xe(d){d.S=Date.now()+d.I,dt(d,d.I)}function dt(d,v){if(d.B!=null)throw Error("WatchDog timer not null");d.B=Is(g(d.ba,d),v)}function Ot(d){d.B&&(o.clearTimeout(d.B),d.B=null)}pe.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(H(this.i,this.A),this.L!=2&&(ki(),Gr(17)),cr(this),this.s=2,Mt(this)):dt(this,this.S-d)};function Mt(d){d.j.G==0||d.J||i0(d.j,d)}function cr(d){Ot(d);var v=d.M;v&&typeof v.ma=="function"&&v.ma(),d.M=null,di(d.U),d.g&&(v=d.g,d.g=null,v.abort(),v.ma())}function Ci(d,v){try{var C=d.j;if(C.G!=0&&(C.g==d||lt(C.h,d))){if(!d.K&&lt(C.h,d)&&C.G==3){try{var M=C.Da.g.parse(v)}catch{M=null}if(Array.isArray(M)&&M.length==3){var oe=M;if(oe[0]==0){e:if(!C.u){if(C.g)if(C.g.F+3e3<d.F)yc(C),fo(C);else break e;vc(C),Gr(18)}}else C.za=oe[1],0<C.za-C.T&&37500>oe[2]&&C.F&&C.v==0&&!C.C&&(C.C=Is(g(C.Za,C),6e3));if(1>=ss(C.h)&&C.ca){try{C.ca()}catch{}C.ca=void 0}}else Nn(C,11)}else if((d.K||C.g==d)&&yc(C),!k(v))for(oe=C.Da.g.parse(v),v=0;v<oe.length;v++){let Ut=oe[v];if(C.T=Ut[0],Ut=Ut[1],C.G==2)if(Ut[0]=="c"){C.K=Ut[1],C.ia=Ut[2];const cn=Ut[3];cn!=null&&(C.la=cn,C.j.info("VER="+C.la));const yn=Ut[4];yn!=null&&(C.Aa=yn,C.j.info("SVER="+C.Aa));const Fa=Ut[5];Fa!=null&&typeof Fa=="number"&&0<Fa&&(M=1.5*Fa,C.L=M,C.j.info("backChannelRequestTimeoutMs_="+M)),M=C;const Wi=d.g;if(Wi){const wc=Wi.g?Wi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(wc){var me=M.h;me.g||wc.indexOf("spdy")==-1&&wc.indexOf("quic")==-1&&wc.indexOf("h2")==-1||(me.j=me.l,me.g=new Set,me.h&&(Rs(me,me.h),me.h=null))}if(M.D){const yl=Wi.g?Wi.g.getResponseHeader("X-HTTP-Session-Id"):null;yl&&(M.ya=yl,Lt(M.I,M.D,yl))}}C.G=3,C.l&&C.l.ua(),C.ba&&(C.R=Date.now()-d.F,C.j.info("Handshake RTT: "+C.R+"ms")),M=C;var $e=d;if(M.qa=_c(M,M.J?M.ia:null,M.W),$e.K){Bt(M.h,$e);var Qt=$e,ln=M.L;ln&&(Qt.I=ln),Qt.B&&(Ot(Qt),Xe(Qt)),M.g=$e}else po(M);0<C.i.length&&ka(C)}else Ut[0]!="stop"&&Ut[0]!="close"||Nn(C,7);else C.G==3&&(Ut[0]=="stop"||Ut[0]=="close"?Ut[0]=="stop"?Nn(C,7):pi(C):Ut[0]!="noop"&&C.l&&C.l.ta(Ut),C.v=0)}}ki(4)}catch{}}var sr=class{constructor(d,v){this.g=d,this.map=v}};function is(d){this.l=d||10,o.PerformanceNavigationTiming?(d=o.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Tr(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function ss(d){return d.h?1:d.g?d.g.size:0}function lt(d,v){return d.h?d.h==v:d.g?d.g.has(v):!1}function Rs(d,v){d.g?d.g.add(v):d.h=v}function Bt(d,v){d.h&&d.h==v?d.h=null:d.g&&d.g.has(v)&&d.g.delete(v)}is.prototype.cancel=function(){if(this.i=Fi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function Fi(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let v=d.i;for(const C of d.g.values())v=v.concat(C.D);return v}return x(d.i)}function nn(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(l(d)){for(var v=[],C=d.length,M=0;M<C;M++)v.push(d[M]);return v}v=[],C=0;for(M in d)v[C++]=d[M];return v}function wa(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(l(d)||typeof d=="string"){var v=[];d=d.length;for(var C=0;C<d;C++)v.push(C);return v}v=[],C=0;for(const M in d)v[C++]=M;return v}}}function Sa(d,v){if(d.forEach&&typeof d.forEach=="function")d.forEach(v,void 0);else if(l(d)||typeof d=="string")Array.prototype.forEach.call(d,v,void 0);else for(var C=wa(d),M=nn(d),oe=M.length,me=0;me<oe;me++)v.call(void 0,M[me],C&&C[me],d)}var ea=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function pc(d,v){if(d){d=d.split("&");for(var C=0;C<d.length;C++){var M=d[C].indexOf("="),oe=null;if(0<=M){var me=d[C].substring(0,M);oe=d[C].substring(M+1)}else me=d[C];v(me,oe?decodeURIComponent(oe.replace(/\+/g," ")):"")}}}function Ds(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof Ds){this.h=d.h,ta(this,d.j),this.o=d.o,this.g=d.g,In(this,d.s),this.l=d.l;var v=d.i,C=new hi;C.i=v.i,v.g&&(C.g=new Map(v.g),C.h=v.h),lo(this,C),this.m=d.m}else d&&(v=String(d).match(ea))?(this.h=!1,ta(this,v[1]||"",!0),this.o=as(v[2]||""),this.g=as(v[3]||"",!0),In(this,v[4]),this.l=as(v[5]||"",!0),lo(this,v[6]||"",!0),this.m=as(v[7]||"")):(this.h=!1,this.i=new hi(null,this.h))}Ds.prototype.toString=function(){var d=[],v=this.j;v&&d.push(os(v,fl,!0),":");var C=this.g;return(C||v=="file")&&(d.push("//"),(v=this.o)&&d.push(os(v,fl,!0),"@"),d.push(encodeURIComponent(String(C)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.s,C!=null&&d.push(":",String(C))),(C=this.l)&&(this.g&&C.charAt(0)!="/"&&d.push("/"),d.push(os(C,C.charAt(0)=="/"?gc:fi,!0))),(C=this.i.toString())&&d.push("?",C),(C=this.m)&&d.push("#",os(C,mc)),d.join("")};function sn(d){return new Ds(d)}function ta(d,v,C){d.j=C?as(v,!0):v,d.j&&(d.j=d.j.replace(/:$/,""))}function In(d,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);d.s=v}else d.s=null}function lo(d,v,C){v instanceof hi?(d.i=v,Zf(d.i,d.h)):(C||(v=os(v,bi)),d.i=new hi(v,d.h))}function Lt(d,v,C){d.i.set(v,C)}function Ta(d){return Lt(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function as(d,v){return d?v?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function os(d,v,C){return typeof d=="string"?(d=encodeURI(d).replace(v,Uu),C&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function Uu(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var fl=/[#\/\?@]/g,fi=/[#\?:]/g,gc=/[#\?]/g,bi=/[#\?@]/g,mc=/#/g;function hi(d,v){this.h=this.g=null,this.i=d||null,this.j=!!v}function ls(d){d.g||(d.g=new Map,d.h=0,d.i&&pc(d.i,function(v,C){d.add(decodeURIComponent(v.replace(/\+/g," ")),C)}))}t=hi.prototype,t.add=function(d,v){ls(this),this.i=null,d=Ps(this,d);var C=this.g.get(d);return C||this.g.set(d,C=[]),C.push(v),this.h+=1,this};function an(d,v){ls(d),v=Ps(d,v),d.g.has(v)&&(d.i=null,d.h-=d.g.get(v).length,d.g.delete(v))}function hl(d,v){return ls(d),v=Ps(d,v),d.g.has(v)}t.forEach=function(d,v){ls(this),this.g.forEach(function(C,M){C.forEach(function(oe){d.call(v,oe,M,this)},this)},this)},t.na=function(){ls(this);const d=Array.from(this.g.values()),v=Array.from(this.g.keys()),C=[];for(let M=0;M<v.length;M++){const oe=d[M];for(let me=0;me<oe.length;me++)C.push(v[M])}return C},t.V=function(d){ls(this);let v=[];if(typeof d=="string")hl(this,d)&&(v=v.concat(this.g.get(Ps(this,d))));else{d=Array.from(this.g.values());for(let C=0;C<d.length;C++)v=v.concat(d[C])}return v},t.set=function(d,v){return ls(this),this.i=null,d=Ps(this,d),hl(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[v]),this.h+=1,this},t.get=function(d,v){return d?(d=this.V(d),0<d.length?String(d[0]):v):v};function Jf(d,v,C){an(d,v),0<C.length&&(d.i=null,d.g.set(Ps(d,v),x(C)),d.h+=C.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],v=Array.from(this.g.keys());for(var C=0;C<v.length;C++){var M=v[C];const me=encodeURIComponent(String(M)),$e=this.V(M);for(M=0;M<$e.length;M++){var oe=me;$e[M]!==""&&(oe+="="+encodeURIComponent(String($e[M]))),d.push(oe)}}return this.i=d.join("&")};function Ps(d,v){return v=String(v),d.j&&(v=v.toLowerCase()),v}function Zf(d,v){v&&!d.j&&(ls(d),d.i=null,d.g.forEach(function(C,M){var oe=M.toLowerCase();M!=oe&&(an(this,M),Jf(this,oe,C))},d)),d.j=v}function zu(d,v){const C=new rn;if(o.Image){const M=new Image;M.onload=m(Ii,C,"TestLoadImage: loaded",!0,v,M),M.onerror=m(Ii,C,"TestLoadImage: error",!1,v,M),M.onabort=m(Ii,C,"TestLoadImage: abort",!1,v,M),M.ontimeout=m(Ii,C,"TestLoadImage: timeout",!1,v,M),o.setTimeout(function(){M.ontimeout&&M.ontimeout()},1e4),M.src=d}else v(!1)}function vt(d,v){const C=new rn,M=new AbortController,oe=setTimeout(()=>{M.abort(),Ii(C,"TestPingServer: timeout",!1,v)},1e4);fetch(d,{signal:M.signal}).then(me=>{clearTimeout(oe),me.ok?Ii(C,"TestPingServer: ok",!0,v):Ii(C,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(oe),Ii(C,"TestPingServer: error",!1,v)})}function Ii(d,v,C,M,oe){try{oe&&(oe.onload=null,oe.onerror=null,oe.onabort=null,oe.ontimeout=null),M(C)}catch{}}function _r(){this.g=new Vu}function co(d,v,C){const M=C||"";try{Sa(d,function(oe,me){let $e=oe;u(oe)&&($e=ao(oe)),v.push(M+me+"="+encodeURIComponent($e))})}catch(oe){throw v.push(M+"type="+encodeURIComponent("_badmap")),oe}}function pl(d){this.l=d.Ub||null,this.j=d.eb||!1}y(pl,Fs),pl.prototype.g=function(){return new gl(this.l,this.j)},pl.prototype.i=function(d){return function(){return d}}({});function gl(d,v){qt.call(this),this.D=d,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(gl,qt),t=gl.prototype,t.open=function(d,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=v,this.readyState=1,uo(this)},t.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(v.body=d),(this.D||o).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Aa(this)),this.readyState=0},t.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,uo(this)),this.g&&(this.readyState=3,uo(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Wu(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function Wu(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}t.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var v=d.value?d.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!d.done}))&&(this.response=this.responseText+=v)}d.done?Aa(this):uo(this),this.readyState==3&&Wu(this)}},t.Ra=function(d){this.g&&(this.response=this.responseText=d,Aa(this))},t.Qa=function(d){this.g&&(this.response=d,Aa(this))},t.ga=function(){this.g&&Aa(this)};function Aa(d){d.readyState=4,d.l=null,d.j=null,d.v=null,uo(d)}t.setRequestHeader=function(d,v){this.u.append(d,v)},t.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],v=this.h.entries();for(var C=v.next();!C.done;)C=C.value,d.push(C[0]+": "+C[1]),C=v.next();return d.join(`\r
`)};function uo(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(gl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function Hu(d){let v="";return U(d,function(C,M){v+=M,v+=":",v+=C,v+=`\r
`}),v}function xc(d,v,C){e:{for(M in C){var M=!1;break e}M=!0}M||(C=Hu(C),typeof d=="string"?C!=null&&encodeURIComponent(String(C)):Lt(d,v,C))}function ar(d){qt.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(ar,qt);var e0=/^https?$/i,t0=["POST","PUT"];t=ar.prototype,t.Ha=function(d){this.J=d},t.ea=function(d,v,C,M){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);v=v?v.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():X.g(),this.v=this.o?dl(this.o):dl(X),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(v,String(d),!0),this.B=!1}catch(me){on(this,me);return}if(d=C||"",C=new Map(this.headers),M)if(Object.getPrototypeOf(M)===Object.prototype)for(var oe in M)C.set(oe,M[oe]);else if(typeof M.keys=="function"&&typeof M.get=="function")for(const me of M.keys())C.set(me,M.get(me));else throw Error("Unknown input type for opt_headers: "+String(M));M=Array.from(C.keys()).find(me=>me.toLowerCase()=="content-type"),oe=o.FormData&&d instanceof o.FormData,!(0<=Array.prototype.indexOf.call(t0,v,void 0))||M||oe||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[me,$e]of C)this.g.setRequestHeader(me,$e);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{cs(this),this.u=!0,this.g.send(d),this.u=!1}catch(me){on(this,me)}};function on(d,v){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=v,d.m=5,Ui(d),Ni(d)}function Ui(d){d.A||(d.A=!0,Sr(d,"complete"),Sr(d,"error"))}t.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,Sr(this,"complete"),Sr(this,"abort"),Ni(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ni(this,!0)),ar.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?zn(this):this.bb())},t.bb=function(){zn(this)};function zn(d){if(d.h&&typeof a<"u"&&(!d.v[1]||us(d)!=4||d.Z()!=2)){if(d.u&&us(d)==4)ui(d.Ea,0,d);else if(Sr(d,"readystatechange"),us(d)==4){d.h=!1;try{const $e=d.Z();e:switch($e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var C;if(!(C=v)){var M;if(M=$e===0){var oe=String(d.D).match(ea)[1]||null;!oe&&o.self&&o.self.location&&(oe=o.self.location.protocol.slice(0,-1)),M=!e0.test(oe?oe.toLowerCase():"")}C=M}if(C)Sr(d,"complete"),Sr(d,"success");else{d.m=6;try{var me=2<us(d)?d.g.statusText:""}catch{me=""}d.l=me+" ["+d.Z()+"]",Ui(d)}}finally{Ni(d)}}}}function Ni(d,v){if(d.g){cs(d);const C=d.g,M=d.v[0]?()=>{}:null;d.g=null,d.v=null,v||Sr(d,"ready");try{C.onreadystatechange=M}catch{}}}function cs(d){d.I&&(o.clearTimeout(d.I),d.I=null)}t.isActive=function(){return!!this.g};function us(d){return d.g?d.g.readyState:0}t.Z=function(){try{return 2<us(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(d){if(this.g){var v=this.g.responseText;return d&&v.indexOf(d)==0&&(v=v.substring(d.length)),oo(v)}};function ml(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function Kr(d){const v={};d=(d.g&&2<=us(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let M=0;M<d.length;M++){if(k(d[M]))continue;var C=R(d[M]);const oe=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const me=v[oe]||[];v[oe]=me,me.push(C)}T(v,function(M){return M.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ds(d,v,C){return C&&C.internalChannelParams&&C.internalChannelParams[d]||v}function Gt(d){this.Aa=0,this.i=[],this.j=new rn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ds("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ds("baseRetryDelayMs",5e3,d),this.cb=ds("retryDelaySeedMs",1e4,d),this.Wa=ds("forwardChannelMaxRetries",2,d),this.wa=ds("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new is(d&&d.concurrentRequestLimit),this.Da=new _r,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Gt.prototype,t.la=8,t.G=1,t.connect=function(d,v,C,M){Gr(0),this.W=d,this.H=v||{},C&&M!==void 0&&(this.H.OSID=C,this.H.OAID=M),this.F=this.X,this.I=_c(this,null,this.W),ka(this)};function pi(d){if(xl(d),d.G==3){var v=d.U++,C=sn(d.I);if(Lt(C,"SID",d.K),Lt(C,"RID",v),Lt(C,"TYPE","terminate"),ho(d,C),v=new pe(d,d.j,v),v.L=2,v.v=Ta(sn(C)),C=!1,o.navigator&&o.navigator.sendBeacon)try{C=o.navigator.sendBeacon(v.v.toString(),"")}catch{}!C&&o.Image&&(new Image().src=v.v,C=!0),C||(v.g=s0(v.j,null),v.g.ea(v.v)),v.F=Date.now(),Xe(v)}Gu(d)}function fo(d){d.g&&(Wn(d),d.g.cancel(),d.g=null)}function xl(d){fo(d),d.u&&(o.clearTimeout(d.u),d.u=null),yc(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&o.clearTimeout(d.s),d.s=null)}function ka(d){if(!Tr(d.h)&&!d.s){d.s=!0;var v=d.Ga;Me||Ce(),Se||(Me(),Se=!0),te.add(v,d),d.B=0}}function Ca(d,v){return ss(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=v.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=Is(g(d.Ga,d,v),vl(d,d.B)),d.B++,!0)}t.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const oe=new pe(this,this.j,d);let me=this.o;if(this.S&&(me?(me=F(me),I(me,this.S)):me=this.S),this.m!==null||this.O||(oe.H=me,me=null),this.P)e:{for(var v=0,C=0;C<this.i.length;C++){t:{var M=this.i[C];if("__data__"in M.map&&(M=M.map.__data__,typeof M=="string")){M=M.length;break t}M=void 0}if(M===void 0)break;if(v+=M,4096<v){v=C;break e}if(v===4096||C===this.i.length-1){v=C+1;break e}}v=1e3}else v=1e3;v=r0(this,oe,v),C=sn(this.I),Lt(C,"RID",d),Lt(C,"CVER",22),this.D&&Lt(C,"X-HTTP-Session-Id",this.D),ho(this,C),me&&(this.O?v="headers="+encodeURIComponent(String(Hu(me)))+"&"+v:this.m&&xc(C,this.m,me)),Rs(this.h,oe),this.Ua&&Lt(C,"TYPE","init"),this.P?(Lt(C,"$req",v),Lt(C,"SID","null"),oe.T=!0,we(oe,C,null)):we(oe,C,v),this.G=2}}else this.G==3&&(d?$u(this,d):this.i.length==0||Tr(this.h)||$u(this))};function $u(d,v){var C;v?C=v.l:C=d.U++;const M=sn(d.I);Lt(M,"SID",d.K),Lt(M,"RID",C),Lt(M,"AID",d.T),ho(d,M),d.m&&d.o&&xc(M,d.m,d.o),C=new pe(d,d.j,C,d.B+1),d.m===null&&(C.H=d.o),v&&(d.i=v.D.concat(d.i)),v=r0(d,C,1e3),C.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),Rs(d.h,C),we(C,M,v)}function ho(d,v){d.H&&U(d.H,function(C,M){Lt(v,M,C)}),d.l&&Sa({},function(C,M){Lt(v,M,C)})}function r0(d,v,C){C=Math.min(d.i.length,C);var M=d.l?g(d.l.Na,d.l,d):null;e:{var oe=d.i;let me=-1;for(;;){const $e=["count="+C];me==-1?0<C?(me=oe[0].g,$e.push("ofs="+me)):me=0:$e.push("ofs="+me);let Qt=!0;for(let ln=0;ln<C;ln++){let Ut=oe[ln].g;const cn=oe[ln].map;if(Ut-=me,0>Ut)me=Math.max(0,oe[ln].g-100),Qt=!1;else try{co(cn,$e,"req"+Ut+"_")}catch{M&&M(cn)}}if(Qt){M=$e.join("&");break e}}}return d=d.i.splice(0,C),v.D=d,M}function po(d){if(!d.g&&!d.u){d.Y=1;var v=d.Fa;Me||Ce(),Se||(Me(),Se=!0),te.add(v,d),d.v=0}}function vc(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=Is(g(d.Fa,d),vl(d,d.v)),d.v++,!0)}t.Fa=function(){if(this.u=null,n0(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=Is(g(this.ab,this),d)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Gr(10),fo(this),n0(this))};function Wn(d){d.A!=null&&(o.clearTimeout(d.A),d.A=null)}function n0(d){d.g=new pe(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var v=sn(d.qa);Lt(v,"RID","rpc"),Lt(v,"SID",d.K),Lt(v,"AID",d.T),Lt(v,"CI",d.F?"0":"1"),!d.F&&d.ja&&Lt(v,"TO",d.ja),Lt(v,"TYPE","xmlhttp"),ho(d,v),d.m&&d.o&&xc(v,d.m,d.o),d.L&&(d.g.I=d.L);var C=d.g;d=d.ia,C.L=1,C.v=Ta(sn(v)),C.m=null,C.P=!0,Ue(C,d)}t.Za=function(){this.C!=null&&(this.C=null,fo(this),vc(this),Gr(19))};function yc(d){d.C!=null&&(o.clearTimeout(d.C),d.C=null)}function i0(d,v){var C=null;if(d.g==v){yc(d),Wn(d),d.g=null;var M=2}else if(lt(d.h,v))C=v.D,Bt(d.h,v),M=1;else return;if(d.G!=0){if(v.o)if(M==1){C=v.m?v.m.length:0,v=Date.now()-v.F;var oe=d.B;M=Js(),Sr(M,new Ea(M,C)),ka(d)}else po(d);else if(oe=v.s,oe==3||oe==0&&0<v.X||!(M==1&&Ca(d,v)||M==2&&vc(d)))switch(C&&0<C.length&&(v=d.h,v.i=v.i.concat(C)),oe){case 1:Nn(d,5);break;case 4:Nn(d,10);break;case 3:Nn(d,6);break;default:Nn(d,2)}}}function vl(d,v){let C=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(C*=2),C*v}function Nn(d,v){if(d.j.info("Error code "+v),v==2){var C=g(d.fb,d),M=d.Xa;const oe=!M;M=new Ds(M||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ta(M,"https"),Ta(M),oe?zu(M.toString(),C):vt(M.toString(),C)}else Gr(2);d.G=0,d.l&&d.l.sa(v),Gu(d),xl(d)}t.fb=function(d){d?(this.j.info("Successfully pinged google.com"),Gr(2)):(this.j.info("Failed to ping google.com"),Gr(1))};function Gu(d){if(d.G=0,d.ka=[],d.l){const v=Fi(d.h);(v.length!=0||d.i.length!=0)&&(w(d.ka,v),w(d.ka,d.i),d.h.i.length=0,x(d.i),d.i.length=0),d.l.ra()}}function _c(d,v,C){var M=C instanceof Ds?sn(C):new Ds(C);if(M.g!="")v&&(M.g=v+"."+M.g),In(M,M.s);else{var oe=o.location;M=oe.protocol,v=v?v+"."+oe.hostname:oe.hostname,oe=+oe.port;var me=new Ds(null);M&&ta(me,M),v&&(me.g=v),oe&&In(me,oe),C&&(me.l=C),M=me}return C=d.D,v=d.ya,C&&v&&Lt(M,C,v),Lt(M,"VER",d.la),ho(d,M),M}function s0(d,v,C){if(v&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=d.Ca&&!d.pa?new ar(new pl({eb:C})):new ar(d.pa),v.Ha(d.J),v}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function lr(){}t=lr.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function xn(){}xn.prototype.g=function(d,v){return new vn(d,v)};function vn(d,v){qt.call(this),this.g=new Gt(v),this.l=d,this.h=v&&v.messageUrlParams||null,d=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(d?d["X-WebChannel-Content-Type"]=v.messageContentType:d={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(d?d["X-WebChannel-Client-Profile"]=v.va:d={"X-WebChannel-Client-Profile":v.va}),this.g.S=d,(d=v&&v.Sb)&&!k(d)&&(this.g.m=d),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!k(v)&&(this.g.D=v,d=this.h,d!==null&&v in d&&(d=this.h,v in d&&delete d[v])),this.j=new go(this)}y(vn,qt),vn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},vn.prototype.close=function(){pi(this.g)},vn.prototype.o=function(d){var v=this.g;if(typeof d=="string"){var C={};C.__data__=d,d=C}else this.u&&(C={},C.__data__=ao(d),d=C);v.i.push(new sr(v.Ya++,d)),v.G==3&&ka(v)},vn.prototype.N=function(){this.g.l=null,delete this.j,pi(this.g),delete this.g,vn.aa.N.call(this)};function zi(d){Rr.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var v=d.__sm__;if(v){e:{for(const C in v){d=C;break e}d=void 0}(this.i=d)&&(d=this.i,v=v!==null&&d in v?v[d]:void 0),this.data=v}else this.data=d}y(zi,Rr);function Ec(){Ai.call(this),this.status=1}y(Ec,Ai);function go(d){this.g=d}y(go,lr),go.prototype.ua=function(){Sr(this.g,"a")},go.prototype.ta=function(d){Sr(this.g,new zi(d))},go.prototype.sa=function(d){Sr(this.g,new Ec)},go.prototype.ra=function(){Sr(this.g,"b")},xn.prototype.createWebChannel=xn.prototype.g,vn.prototype.send=vn.prototype.o,vn.prototype.open=vn.prototype.m,vn.prototype.close=vn.prototype.close,qk=function(){return new xn},Xk=function(){return Js()},Yk=ns,vx={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},L.NO_ERROR=0,L.TIMEOUT=8,L.HTTP_ERROR=6,uh=L,K.COMPLETE="complete",Kk=K,bs.EventType=ce,ce.OPEN="a",ce.CLOSE="b",ce.ERROR="c",ce.MESSAGE="d",qt.prototype.listen=qt.prototype.K,pd=bs,ar.prototype.listenOnce=ar.prototype.L,ar.prototype.getLastError=ar.prototype.Ka,ar.prototype.getLastErrorCode=ar.prototype.Ba,ar.prototype.getStatus=ar.prototype.Z,ar.prototype.getResponseJson=ar.prototype.Oa,ar.prototype.getResponseText=ar.prototype.oa,ar.prototype.send=ar.prototype.ea,ar.prototype.setWithCredentials=ar.prototype.Ha,Gk=ar}).apply(typeof W0<"u"?W0:typeof self<"u"?self:typeof window<"u"?window:{});const dE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Zn.UNAUTHENTICATED=new Zn(null),Zn.GOOGLE_CREDENTIALS=new Zn("google-credentials-uid"),Zn.FIRST_PARTY=new Zn("first-party-uid"),Zn.MOCK_USER=new Zn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ou="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zl=new xv("@firebase/firestore");function ad(){return Zl.logLevel}function Ze(t,...e){if(Zl.logLevel<=Vt.DEBUG){const r=e.map(_v);Zl.debug(`Firestore (${Ou}): ${t}`,...r)}}function Qa(t,...e){if(Zl.logLevel<=Vt.ERROR){const r=e.map(_v);Zl.error(`Firestore (${Ou}): ${t}`,...r)}}function yu(t,...e){if(Zl.logLevel<=Vt.WARN){const r=e.map(_v);Zl.warn(`Firestore (${Ou}): ${t}`,...r)}}function _v(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mt(t="Unexpected state"){const e=`FIRESTORE (${Ou}) INTERNAL ASSERTION FAILED: `+t;throw Qa(e),new Error(e)}function nr(t,e){t||mt()}function _t(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ot extends so{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qk{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class _7{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Zn.UNAUTHENTICATED))}shutdown(){}}class E7{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class w7{constructor(e){this.t=e,this.currentUser=Zn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){nr(this.o===void 0);let n=this.i;const i=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let s=new Yo;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Yo,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{Ze("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Ze("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Yo)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Ze("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(nr(typeof n.accessToken=="string"),new Qk(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return nr(e===null||typeof e=="string"),new Zn(e)}}class S7{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Zn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class T7{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new S7(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Zn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class A7{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class k7{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){nr(this.o===void 0);const n=s=>{s.error!=null&&Ze("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,Ze("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{Ze("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Ze("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(nr(typeof r.token=="string"),this.R=r.token,new A7(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C7(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=C7(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=e.charAt(i[s]%e.length))}return n}}function Xt(t,e){return t<e?-1:t>e?1:0}function _u(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new ot(Pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new ot(Pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new ot(Pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ot(Pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return gn.fromMillis(Date.now())}static fromDate(e){return gn.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new gn(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Xt(this.nanoseconds,e.nanoseconds):Xt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new yt(e)}static min(){return new yt(new gn(0,0))}static max(){return new yt(new gn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(e,r,n){r===void 0?r=0:r>e.length&&mt(),n===void 0?n=e.length-r:n>e.length-r&&mt(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return yf.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof yf?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const s=e.get(i),a=r.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class Or extends yf{construct(e,r,n){return new Or(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new ot(Pe.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Or(r)}static emptyPath(){return new Or([])}}const F7=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Bn extends yf{construct(e,r,n){return new Bn(e,r,n)}static isValidIdentifier(e){return F7.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Bn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Bn(["__name__"])}static fromServerFormat(e){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new ot(Pe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new ot(Pe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ot(Pe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new ot(Pe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Bn(r)}static emptyPath(){return new Bn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{constructor(e){this.path=e}static fromPath(e){return new ct(Or.fromString(e))}static fromName(e){return new ct(Or.fromString(e).popFirst(5))}static empty(){return new ct(Or.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Or.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Or.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ct(new Or(e.slice()))}}function b7(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=yt.fromTimestamp(n===1e9?new gn(r+1,0):new gn(r,n));return new rl(i,ct.empty(),e)}function I7(t){return new rl(t.readTime,t.key,-1)}class rl{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new rl(yt.min(),ct.empty(),-1)}static max(){return new rl(yt.max(),ct.empty(),-1)}}function N7(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=ct.comparator(t.documentKey,e.documentKey),r!==0?r:Xt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R7="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class D7{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wf(t){if(t.code!==Pe.FAILED_PRECONDITION||t.message!==R7)throw t;Ze("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&mt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Ie((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Ie?r:Ie.resolve(r)}catch(r){return Ie.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Ie.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Ie.reject(r)}static resolve(e){return new Ie((r,n)=>{r(e)})}static reject(e){return new Ie((r,n)=>{n(e)})}static waitFor(e){return new Ie((r,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},l=>n(l))}),a=!0,s===i&&r()})}static or(e){let r=Ie.resolve(!1);for(const n of e)r=r.next(i=>i?Ie.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(e,r){return new Ie((n,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const u=l;r(e[u]).next(f=>{a[u]=f,++o,o===s&&n(a)},f=>i(f))}})}static doWhile(e,r){return new Ie((n,i)=>{const s=()=>{e()===!0?r().next(()=>{s()},i):n()};s()})}}function P7(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Hf(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Ev.oe=-1;function $p(t){return t==null}function sp(t){return t===0&&1/t==-1/0}function O7(t){return typeof t=="number"&&Number.isInteger(t)&&!sp(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fE(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Mu(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function Zk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(e,r){this.comparator=e,this.root=r||Pn.EMPTY}insert(e,r){return new Nr(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Pn.BLACK,null,null))}remove(e){return new Nr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Pn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new H0(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new H0(this.root,e,this.comparator,!1)}getReverseIterator(){return new H0(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new H0(this.root,e,this.comparator,!0)}}class H0{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Pn{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n??Pn.RED,this.left=i??Pn.EMPTY,this.right=s??Pn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,s){return new Pn(e??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Pn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return Pn.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Pn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Pn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw mt();const e=this.left.check();if(e!==this.right.check())throw mt();return e+(this.isRed()?0:1)}}Pn.EMPTY=null,Pn.RED=!0,Pn.BLACK=!1;Pn.EMPTY=new class{constructor(){this.size=0}get key(){throw mt()}get value(){throw mt()}get color(){throw mt()}get left(){throw mt()}get right(){throw mt()}copy(e,r,n,i,s){return this}insert(e,r,n){return new Pn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e){this.comparator=e,this.data=new Nr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new hE(this.data.getIterator())}getIteratorFrom(e){return new hE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof jn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new jn(this.comparator);return r.data=e,r}}class hE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(e){this.fields=e,e.sort(Bn.comparator)}static empty(){return new $s([])}unionWith(e){let r=new jn(Bn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new $s(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return _u(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eC extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new eC("Invalid base64 string: "+s):s}}(e);return new Un(r)}static fromUint8Array(e){const r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new Un(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Xt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Un.EMPTY_BYTE_STRING=new Un("");const M7=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function nl(t){if(nr(!!t),typeof t=="string"){let e=0;const r=M7.exec(t);if(nr(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:zr(t.seconds),nanos:zr(t.nanos)}}function zr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ec(t){return typeof t=="string"?Un.fromBase64String(t):Un.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wv(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function Sv(t){const e=t.mapValue.fields.__previous_value__;return wv(e)?Sv(e):e}function _f(t){const e=nl(t.mapValue.fields.__local_write_time__.timestampValue);return new gn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B7{constructor(e,r,n,i,s,a,o,l,u){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=u}}class Ef{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new Ef("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Ef&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $0={mapValue:{}};function tc(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?wv(t)?4:j7(t)?9007199254740991:L7(t)?10:11:mt()}function ma(t,e){if(t===e)return!0;const r=tc(t);if(r!==tc(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return _f(t).isEqual(_f(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=nl(i.timestampValue),o=nl(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return ec(i.bytesValue).isEqual(ec(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return zr(i.geoPointValue.latitude)===zr(s.geoPointValue.latitude)&&zr(i.geoPointValue.longitude)===zr(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return zr(i.integerValue)===zr(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=zr(i.doubleValue),o=zr(s.doubleValue);return a===o?sp(a)===sp(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return _u(t.arrayValue.values||[],e.arrayValue.values||[],ma);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(fE(a)!==fE(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!ma(a[l],o[l])))return!1;return!0}(t,e);default:return mt()}}function wf(t,e){return(t.values||[]).find(r=>ma(r,e))!==void 0}function Eu(t,e){if(t===e)return 0;const r=tc(t),n=tc(e);if(r!==n)return Xt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Xt(t.booleanValue,e.booleanValue);case 2:return function(s,a){const o=zr(s.integerValue||s.doubleValue),l=zr(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return pE(t.timestampValue,e.timestampValue);case 4:return pE(_f(t),_f(e));case 5:return Xt(t.stringValue,e.stringValue);case 6:return function(s,a){const o=ec(s),l=ec(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let u=0;u<o.length&&u<l.length;u++){const f=Xt(o[u],l[u]);if(f!==0)return f}return Xt(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const o=Xt(zr(s.latitude),zr(a.latitude));return o!==0?o:Xt(zr(s.longitude),zr(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return gE(t.arrayValue,e.arrayValue);case 10:return function(s,a){var o,l,u,f;const p=s.fields||{},g=a.fields||{},m=(o=p.value)===null||o===void 0?void 0:o.arrayValue,y=(l=g.value)===null||l===void 0?void 0:l.arrayValue,x=Xt(((u=m==null?void 0:m.values)===null||u===void 0?void 0:u.length)||0,((f=y==null?void 0:y.values)===null||f===void 0?void 0:f.length)||0);return x!==0?x:gE(m,y)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===$0.mapValue&&a===$0.mapValue)return 0;if(s===$0.mapValue)return 1;if(a===$0.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),u=a.fields||{},f=Object.keys(u);l.sort(),f.sort();for(let p=0;p<l.length&&p<f.length;++p){const g=Xt(l[p],f[p]);if(g!==0)return g;const m=Eu(o[l[p]],u[f[p]]);if(m!==0)return m}return Xt(l.length,f.length)}(t.mapValue,e.mapValue);default:throw mt()}}function pE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Xt(t,e);const r=nl(t),n=nl(e),i=Xt(r.seconds,n.seconds);return i!==0?i:Xt(r.nanos,n.nanos)}function gE(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const s=Eu(r[i],n[i]);if(s)return s}return Xt(r.length,n.length)}function wu(t){return yx(t)}function yx(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=nl(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return ec(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return ct.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=yx(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${yx(r.fields[a])}`;return i+"}"}(t.mapValue):mt()}function _x(t){return!!t&&"integerValue"in t}function Tv(t){return!!t&&"arrayValue"in t}function mE(t){return!!t&&"nullValue"in t}function xE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function dh(t){return!!t&&"mapValue"in t}function L7(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function Od(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Mu(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Od(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Od(t.arrayValue.values[r]);return e}return Object.assign({},t)}function j7(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{constructor(e){this.value=e}static empty(){return new _s({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!dh(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Od(r)}setAll(e){let r=Bn.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=Od(a):i.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(e){const r=this.field(e.popLast());dh(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return ma(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];dh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Mu(r,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new _s(Od(this.value))}}function tC(t){const e=[];return Mu(t.fields,(r,n)=>{const i=new Bn([r]);if(dh(n)){const s=tC(n.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new $s(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e,r,n,i,s,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new ni(e,0,yt.min(),yt.min(),yt.min(),_s.empty(),0)}static newFoundDocument(e,r,n,i){return new ni(e,1,r,yt.min(),n,i,0)}static newNoDocument(e,r){return new ni(e,2,r,yt.min(),yt.min(),_s.empty(),0)}static newUnknownDocument(e,r){return new ni(e,3,r,yt.min(),yt.min(),_s.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(yt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=_s.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=_s.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=yt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ni&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ni(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(e,r){this.position=e,this.inclusive=r}}function vE(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?n=ct.comparator(ct.fromName(a.referenceValue),r.key):n=Eu(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function yE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!ma(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class op{constructor(e,r="asc"){this.field=e,this.dir=r}}function V7(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rC{}class hn extends rC{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new z7(e,r,n):r==="array-contains"?new $7(e,n):r==="in"?new G7(e,n):r==="not-in"?new K7(e,n):r==="array-contains-any"?new Y7(e,n):new hn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new W7(e,n):new H7(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(Eu(r,this.value)):r!==null&&tc(this.value)===tc(r)&&this.matchesComparison(Eu(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return mt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class xa extends rC{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new xa(e,r)}matches(e){return nC(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function nC(t){return t.op==="and"}function iC(t){return U7(t)&&nC(t)}function U7(t){for(const e of t.filters)if(e instanceof xa)return!1;return!0}function Ex(t){if(t instanceof hn)return t.field.canonicalString()+t.op.toString()+wu(t.value);if(iC(t))return t.filters.map(e=>Ex(e)).join(",");{const e=t.filters.map(r=>Ex(r)).join(",");return`${t.op}(${e})`}}function sC(t,e){return t instanceof hn?function(n,i){return i instanceof hn&&n.op===i.op&&n.field.isEqual(i.field)&&ma(n.value,i.value)}(t,e):t instanceof xa?function(n,i){return i instanceof xa&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&sC(a,i.filters[o]),!0):!1}(t,e):void mt()}function aC(t){return t instanceof hn?function(r){return`${r.field.canonicalString()} ${r.op} ${wu(r.value)}`}(t):t instanceof xa?function(r){return r.op.toString()+" {"+r.getFilters().map(aC).join(" ,")+"}"}(t):"Filter"}class z7 extends hn{constructor(e,r,n){super(e,r,n),this.key=ct.fromName(n.referenceValue)}matches(e){const r=ct.comparator(e.key,this.key);return this.matchesComparison(r)}}class W7 extends hn{constructor(e,r){super(e,"in",r),this.keys=oC("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class H7 extends hn{constructor(e,r){super(e,"not-in",r),this.keys=oC("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function oC(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>ct.fromName(n.referenceValue))}class $7 extends hn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Tv(r)&&wf(r.arrayValue,this.value)}}class G7 extends hn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&wf(this.value.arrayValue,r)}}class K7 extends hn{constructor(e,r){super(e,"not-in",r)}matches(e){if(wf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!wf(this.value.arrayValue,r)}}class Y7 extends hn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Tv(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>wf(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X7{constructor(e,r=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ue=null}}function _E(t,e=null,r=[],n=[],i=null,s=null,a=null){return new X7(t,e,r,n,i,s,a)}function Av(t){const e=_t(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Ex(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),$p(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>wu(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>wu(n)).join(",")),e.ue=r}return e.ue}function kv(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!V7(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!sC(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!yE(t.startAt,e.startAt)&&yE(t.endAt,e.endAt)}function wx(t){return ct.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gp{constructor(e,r=null,n=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function q7(t,e,r,n,i,s,a,o){return new Gp(t,e,r,n,i,s,a,o)}function Kp(t){return new Gp(t)}function EE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Q7(t){return t.collectionGroup!==null}function Md(t){const e=_t(t);if(e.ce===null){e.ce=[];const r=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new jn(Bn.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(o=o.add(u.field))})}),o})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new op(s,n))}),r.has(Bn.keyField().canonicalString())||e.ce.push(new op(Bn.keyField(),n))}return e.ce}function fa(t){const e=_t(t);return e.le||(e.le=J7(e,Md(t))),e.le}function J7(t,e){if(t.limitType==="F")return _E(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new op(i.field,s)});const r=t.endAt?new ap(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new ap(t.startAt.position,t.startAt.inclusive):null;return _E(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Sx(t,e,r){return new Gp(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Yp(t,e){return kv(fa(t),fa(e))&&t.limitType===e.limitType}function lC(t){return`${Av(fa(t))}|lt:${t.limitType}`}function Nc(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>aC(i)).join(", ")}]`),$p(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>wu(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>wu(i)).join(",")),`Target(${n})`}(fa(t))}; limitType=${t.limitType})`}function Xp(t,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):ct.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,i){for(const s of Md(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,o,l){const u=vE(a,o,l);return a.inclusive?u<=0:u<0}(n.startAt,Md(n),i)||n.endAt&&!function(a,o,l){const u=vE(a,o,l);return a.inclusive?u>=0:u>0}(n.endAt,Md(n),i))}(t,e)}function Z7(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function cC(t){return(e,r)=>{let n=!1;for(const i of Md(t)){const s=eV(i,e,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function eV(t,e,r){const n=t.field.isKeyField()?ct.comparator(e.key,r.key):function(s,a,o){const l=a.data.field(s),u=o.data.field(s);return l!==null&&u!==null?Eu(l,u):mt()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return mt()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bu{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Mu(this.inner,(r,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return Zk(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tV=new Nr(ct.comparator);function Ja(){return tV}const uC=new Nr(ct.comparator);function gd(...t){let e=uC;for(const r of t)e=e.insert(r.key,r);return e}function dC(t){let e=uC;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Rl(){return Bd()}function fC(){return Bd()}function Bd(){return new Bu(t=>t.toString(),(t,e)=>t.isEqual(e))}const rV=new Nr(ct.comparator),nV=new jn(ct.comparator);function Dt(...t){let e=nV;for(const r of t)e=e.add(r);return e}const iV=new jn(Xt);function sV(){return iV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:sp(e)?"-0":e}}function hC(t){return{integerValue:""+t}}function aV(t,e){return O7(e)?hC(e):Cv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qp{constructor(){this._=void 0}}function oV(t,e,r){return t instanceof lp?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&wv(s)&&(s=Sv(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(r,e):t instanceof Sf?gC(t,e):t instanceof Tf?mC(t,e):function(i,s){const a=pC(i,s),o=wE(a)+wE(i.Pe);return _x(a)&&_x(i.Pe)?hC(o):Cv(i.serializer,o)}(t,e)}function lV(t,e,r){return t instanceof Sf?gC(t,e):t instanceof Tf?mC(t,e):r}function pC(t,e){return t instanceof cp?function(n){return _x(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class lp extends qp{}class Sf extends qp{constructor(e){super(),this.elements=e}}function gC(t,e){const r=xC(e);for(const n of t.elements)r.some(i=>ma(i,n))||r.push(n);return{arrayValue:{values:r}}}class Tf extends qp{constructor(e){super(),this.elements=e}}function mC(t,e){let r=xC(e);for(const n of t.elements)r=r.filter(i=>!ma(i,n));return{arrayValue:{values:r}}}class cp extends qp{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function wE(t){return zr(t.integerValue||t.doubleValue)}function xC(t){return Tv(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function cV(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof Sf&&i instanceof Sf||n instanceof Tf&&i instanceof Tf?_u(n.elements,i.elements,ma):n instanceof cp&&i instanceof cp?ma(n.Pe,i.Pe):n instanceof lp&&i instanceof lp}(t.transform,e.transform)}class uV{constructor(e,r){this.version=e,this.transformResults=r}}class Ha{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Ha}static exists(e){return new Ha(void 0,e)}static updateTime(e){return new Ha(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function fh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Qp{}function vC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new _C(t.key,Ha.none()):new $f(t.key,t.data,Ha.none());{const r=t.data,n=_s.empty();let i=new jn(Bn.comparator);for(let s of e.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new dc(t.key,n,new $s(i.toArray()),Ha.none())}}function dV(t,e,r){t instanceof $f?function(i,s,a){const o=i.value.clone(),l=TE(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof dc?function(i,s,a){if(!fh(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=TE(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(yC(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function Ld(t,e,r,n){return t instanceof $f?function(s,a,o,l){if(!fh(s.precondition,a))return o;const u=s.value.clone(),f=AE(s.fieldTransforms,l,a);return u.setAll(f),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null}(t,e,r,n):t instanceof dc?function(s,a,o,l){if(!fh(s.precondition,a))return o;const u=AE(s.fieldTransforms,l,a),f=a.data;return f.setAll(yC(s)),f.setAll(u),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(t,e,r,n):function(s,a,o){return fh(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function fV(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),s=pC(n.transform,i||null);s!=null&&(r===null&&(r=_s.empty()),r.set(n.field,s))}return r||null}function SE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&_u(n,i,(s,a)=>cV(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class $f extends Qp{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class dc extends Qp{constructor(e,r,n,i,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function yC(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function TE(t,e,r){const n=new Map;nr(t.length===r.length);for(let i=0;i<r.length;i++){const s=t[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,lV(a,o,r[i]))}return n}function AE(t,e,r){const n=new Map;for(const i of t){const s=i.transform,a=r.data.field(i.field);n.set(i.field,oV(s,a,e))}return n}class _C extends Qp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class hV extends Qp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pV{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&dV(s,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Ld(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Ld(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=fC();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;const l=vC(a,o);l!==null&&n.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(yt.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Dt())}isEqual(e){return this.batchId===e.batchId&&_u(this.mutations,e.mutations,(r,n)=>SE(r,n))&&_u(this.baseMutations,e.baseMutations,(r,n)=>SE(r,n))}}class Fv{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){nr(e.mutations.length===n.length);let i=function(){return rV}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new Fv(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gV{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mV{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qr,zt;function xV(t){switch(t){default:return mt();case Pe.CANCELLED:case Pe.UNKNOWN:case Pe.DEADLINE_EXCEEDED:case Pe.RESOURCE_EXHAUSTED:case Pe.INTERNAL:case Pe.UNAVAILABLE:case Pe.UNAUTHENTICATED:return!1;case Pe.INVALID_ARGUMENT:case Pe.NOT_FOUND:case Pe.ALREADY_EXISTS:case Pe.PERMISSION_DENIED:case Pe.FAILED_PRECONDITION:case Pe.ABORTED:case Pe.OUT_OF_RANGE:case Pe.UNIMPLEMENTED:case Pe.DATA_LOSS:return!0}}function EC(t){if(t===void 0)return Qa("GRPC error has no .code"),Pe.UNKNOWN;switch(t){case qr.OK:return Pe.OK;case qr.CANCELLED:return Pe.CANCELLED;case qr.UNKNOWN:return Pe.UNKNOWN;case qr.DEADLINE_EXCEEDED:return Pe.DEADLINE_EXCEEDED;case qr.RESOURCE_EXHAUSTED:return Pe.RESOURCE_EXHAUSTED;case qr.INTERNAL:return Pe.INTERNAL;case qr.UNAVAILABLE:return Pe.UNAVAILABLE;case qr.UNAUTHENTICATED:return Pe.UNAUTHENTICATED;case qr.INVALID_ARGUMENT:return Pe.INVALID_ARGUMENT;case qr.NOT_FOUND:return Pe.NOT_FOUND;case qr.ALREADY_EXISTS:return Pe.ALREADY_EXISTS;case qr.PERMISSION_DENIED:return Pe.PERMISSION_DENIED;case qr.FAILED_PRECONDITION:return Pe.FAILED_PRECONDITION;case qr.ABORTED:return Pe.ABORTED;case qr.OUT_OF_RANGE:return Pe.OUT_OF_RANGE;case qr.UNIMPLEMENTED:return Pe.UNIMPLEMENTED;case qr.DATA_LOSS:return Pe.DATA_LOSS;default:return mt()}}(zt=qr||(qr={}))[zt.OK=0]="OK",zt[zt.CANCELLED=1]="CANCELLED",zt[zt.UNKNOWN=2]="UNKNOWN",zt[zt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",zt[zt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",zt[zt.NOT_FOUND=5]="NOT_FOUND",zt[zt.ALREADY_EXISTS=6]="ALREADY_EXISTS",zt[zt.PERMISSION_DENIED=7]="PERMISSION_DENIED",zt[zt.UNAUTHENTICATED=16]="UNAUTHENTICATED",zt[zt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",zt[zt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",zt[zt.ABORTED=10]="ABORTED",zt[zt.OUT_OF_RANGE=11]="OUT_OF_RANGE",zt[zt.UNIMPLEMENTED=12]="UNIMPLEMENTED",zt[zt.INTERNAL=13]="INTERNAL",zt[zt.UNAVAILABLE=14]="UNAVAILABLE",zt[zt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vV(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yV=new jl([4294967295,4294967295],0);function kE(t){const e=vV().encode(t),r=new $k;return r.update(e),new Uint8Array(r.digest())}function CE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new jl([r,n],0),new jl([i,s],0)]}class bv{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new md(`Invalid padding: ${r}`);if(n<0)throw new md(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new md(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new md(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=jl.fromNumber(this.Ie)}Ee(e,r,n){let i=e.add(r.multiply(jl.fromNumber(n)));return i.compare(yV)===1&&(i=new jl([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=kE(e),[n,i]=CE(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);if(!this.de(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new bv(s,i,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const r=kE(e),[n,i]=CE(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);this.Ae(a)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class md extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jp{constructor(e,r,n,i,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,Gf.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Jp(yt.min(),i,new Nr(Xt),Ja(),Dt())}}class Gf{constructor(e,r,n,i,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Gf(n,r,Dt(),Dt(),Dt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hh{constructor(e,r,n,i){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=i}}class wC{constructor(e,r){this.targetId=e,this.me=r}}class SC{constructor(e,r,n=Un.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class FE{constructor(){this.fe=0,this.ge=IE(),this.pe=Un.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Dt(),r=Dt(),n=Dt();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:mt()}}),new Gf(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=IE()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,nr(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class _V{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ja(),this.qe=bE(),this.Qe=new Nr(Xt)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:mt()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,i)=>{this.ze(i)&&r(i)})}He(e){const r=e.targetId,n=e.me.count,i=this.Je(r);if(i){const s=i.target;if(wx(s))if(n===0){const a=new ct(s.path);this.Ue(r,a,ni.newNoDocument(a,yt.min()))}else nr(n===1);else{const a=this.Ye(r);if(a!==n){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(r);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,u)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let a,o;try{a=ec(n).toUint8Array()}catch(l){if(l instanceof eC)return yu("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new bv(a,i,s)}catch(l){return yu(l instanceof md?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,s,null),i++)}),i}rt(e){const r=new Map;this.Be.forEach((s,a)=>{const o=this.Je(a);if(o){if(s.current&&wx(o.target)){const l=new ct(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,ni.newNoDocument(l,e))}s.be&&(r.set(a,s.ve()),s.Ce())}});let n=Dt();this.qe.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const u=this.Je(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));const i=new Jp(e,r,this.Qe,this.ke,n);return this.ke=Ja(),this.qe=bE(),this.Qe=new Nr(Xt),i}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,r)?i.Fe(r,1):i.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new FE,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new jn(Xt),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||Ze("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new FE),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function bE(){return new Nr(ct.comparator)}function IE(){return new Nr(ct.comparator)}const EV={asc:"ASCENDING",desc:"DESCENDING"},wV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},SV={and:"AND",or:"OR"};class TV{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Tx(t,e){return t.useProto3Json||$p(e)?e:{value:e}}function up(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function TC(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function AV(t,e){return up(t,e.toTimestamp())}function ha(t){return nr(!!t),yt.fromTimestamp(function(r){const n=nl(r);return new gn(n.seconds,n.nanos)}(t))}function Iv(t,e){return Ax(t,e).canonicalString()}function Ax(t,e){const r=function(i){return new Or(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function AC(t){const e=Or.fromString(t);return nr(IC(e)),e}function kx(t,e){return Iv(t.databaseId,e.path)}function rm(t,e){const r=AC(e);if(r.get(1)!==t.databaseId.projectId)throw new ot(Pe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new ot(Pe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new ct(CC(r))}function kC(t,e){return Iv(t.databaseId,e)}function kV(t){const e=AC(t);return e.length===4?Or.emptyPath():CC(e)}function Cx(t){return new Or(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function CC(t){return nr(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function NE(t,e,r){return{name:kx(t,e),fields:r.value.mapValue.fields}}function CV(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:mt()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,f){return u.useProto3Json?(nr(f===void 0||typeof f=="string"),Un.fromBase64String(f||"")):(nr(f===void 0||f instanceof Buffer||f instanceof Uint8Array),Un.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(u){const f=u.code===void 0?Pe.UNKNOWN:EC(u.code);return new ot(f,u.message||"")}(a);r=new SC(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=rm(t,n.document.name),s=ha(n.document.updateTime),a=n.document.createTime?ha(n.document.createTime):yt.min(),o=new _s({mapValue:{fields:n.document.fields}}),l=ni.newFoundDocument(i,s,a,o),u=n.targetIds||[],f=n.removedTargetIds||[];r=new hh(u,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=rm(t,n.document),s=n.readTime?ha(n.readTime):yt.min(),a=ni.newNoDocument(i,s),o=n.removedTargetIds||[];r=new hh([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=rm(t,n.document),s=n.removedTargetIds||[];r=new hh([],s,i,null)}else{if(!("filter"in e))return mt();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new mV(i,s),o=n.targetId;r=new wC(o,a)}}return r}function FV(t,e){let r;if(e instanceof $f)r={update:NE(t,e.key,e.value)};else if(e instanceof _C)r={delete:kx(t,e.key)};else if(e instanceof dc)r={update:NE(t,e.key,e.data),updateMask:BV(e.fieldMask)};else{if(!(e instanceof hV))return mt();r={verify:kx(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof lp)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Sf)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Tf)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof cp)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw mt()}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:AV(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:mt()}(t,e.precondition)),r}function bV(t,e){return t&&t.length>0?(nr(e!==void 0),t.map(r=>function(i,s){let a=i.updateTime?ha(i.updateTime):ha(s);return a.isEqual(yt.min())&&(a=ha(s)),new uV(a,i.transformResults||[])}(r,e))):[]}function IV(t,e){return{documents:[kC(t,e.path)]}}function NV(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=kC(t,i);const s=function(u){if(u.length!==0)return bC(xa.create(u,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const a=function(u){if(u.length!==0)return u.map(f=>function(g){return{field:Rc(g.field),direction:PV(g.dir)}}(f))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=Tx(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:r,parent:i}}function RV(t){let e=kV(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){nr(n===1);const f=r.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];r.where&&(s=function(p){const g=FC(p);return g instanceof xa&&iC(g)?g.getFilters():[g]}(r.where));let a=[];r.orderBy&&(a=function(p){return p.map(g=>function(y){return new op(Dc(y.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(g))}(r.orderBy));let o=null;r.limit&&(o=function(p){let g;return g=typeof p=="object"?p.value:p,$p(g)?null:g}(r.limit));let l=null;r.startAt&&(l=function(p){const g=!!p.before,m=p.values||[];return new ap(m,g)}(r.startAt));let u=null;return r.endAt&&(u=function(p){const g=!p.before,m=p.values||[];return new ap(m,g)}(r.endAt)),q7(e,i,a,s,o,"F",l,u)}function DV(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return mt()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function FC(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Dc(r.unaryFilter.field);return hn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Dc(r.unaryFilter.field);return hn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Dc(r.unaryFilter.field);return hn.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Dc(r.unaryFilter.field);return hn.create(a,"!=",{nullValue:"NULL_VALUE"});default:return mt()}}(t):t.fieldFilter!==void 0?function(r){return hn.create(Dc(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return mt()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return xa.create(r.compositeFilter.filters.map(n=>FC(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return mt()}}(r.compositeFilter.op))}(t):mt()}function PV(t){return EV[t]}function OV(t){return wV[t]}function MV(t){return SV[t]}function Rc(t){return{fieldPath:t.canonicalString()}}function Dc(t){return Bn.fromServerFormat(t.fieldPath)}function bC(t){return t instanceof hn?function(r){if(r.op==="=="){if(xE(r.value))return{unaryFilter:{field:Rc(r.field),op:"IS_NAN"}};if(mE(r.value))return{unaryFilter:{field:Rc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(xE(r.value))return{unaryFilter:{field:Rc(r.field),op:"IS_NOT_NAN"}};if(mE(r.value))return{unaryFilter:{field:Rc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Rc(r.field),op:OV(r.op),value:r.value}}}(t):t instanceof xa?function(r){const n=r.getFilters().map(i=>bC(i));return n.length===1?n[0]:{compositeFilter:{op:MV(r.op),filters:n}}}(t):mt()}function BV(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function IC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo{constructor(e,r,n,i,s=yt.min(),a=yt.min(),o=Un.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Mo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Mo(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Mo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Mo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LV{constructor(e){this.ct=e}}function jV(t){const e=RV({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Sx(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VV{constructor(){this.un=new UV}addToCollectionParentIndex(e,r){return this.un.add(r),Ie.resolve()}getCollectionParents(e,r){return Ie.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return Ie.resolve()}deleteFieldIndex(e,r){return Ie.resolve()}deleteAllFieldIndexes(e){return Ie.resolve()}createTargetIndexes(e,r){return Ie.resolve()}getDocumentsMatchingTarget(e,r){return Ie.resolve(null)}getIndexType(e,r){return Ie.resolve(0)}getFieldIndexes(e,r){return Ie.resolve([])}getNextCollectionGroupToUpdate(e){return Ie.resolve(null)}getMinOffset(e,r){return Ie.resolve(rl.min())}getMinOffsetFromCollectionGroup(e,r){return Ie.resolve(rl.min())}updateCollectionGroup(e,r,n){return Ie.resolve()}updateIndexEntries(e,r){return Ie.resolve()}}class UV{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new jn(Or.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new jn(Or.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Su{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Su(0)}static kn(){return new Su(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zV{constructor(){this.changes=new Bu(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,ni.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Ie.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WV{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HV{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Ld(n.mutation,i,$s.empty(),gn.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Dt()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Dt()){const i=Rl();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(s=>{let a=gd();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=Rl();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Dt()))}populateOverlays(e,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,i){let s=Ja();const a=Bd(),o=function(){return Bd()}();return r.forEach((l,u)=>{const f=n.get(u.key);i.has(u.key)&&(f===void 0||f.mutation instanceof dc)?s=s.insert(u.key,u):f!==void 0?(a.set(u.key,f.mutation.getFieldMask()),Ld(f.mutation,u,f.mutation.getFieldMask(),gn.now())):a.set(u.key,$s.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,f)=>a.set(u,f)),r.forEach((u,f)=>{var p;return o.set(u,new WV(f,(p=a.get(u))!==null&&p!==void 0?p:null))}),o))}recalculateAndSaveOverlays(e,r){const n=Bd();let i=new Nr((a,o)=>a-o),s=Dt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const u=r.get(l);if(u===null)return;let f=n.get(l)||$s.empty();f=o.applyToLocalView(u,f),n.set(l,f);const p=(i.get(o.batchId)||Dt()).add(l);i=i.insert(o.batchId,p)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),u=l.key,f=l.value,p=fC();f.forEach(g=>{if(!s.has(g)){const m=vC(r.get(g),n.get(g));m!==null&&p.set(g,m),s=s.add(g)}}),a.push(this.documentOverlayCache.saveOverlays(e,u,p))}return Ie.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return ct.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):Q7(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-s.size):Ie.resolve(Rl());let o=-1,l=s;return a.next(u=>Ie.forEach(u,(f,p)=>(o<p.largestBatchId&&(o=p.largestBatchId),s.get(f)?Ie.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{l=l.insert(f,g)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,Dt())).next(f=>({batchId:o,changes:dC(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new ct(r)).next(n=>{let i=gd();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const s=r.collectionGroup;let a=gd();return this.indexManager.getCollectionParents(e,s).next(o=>Ie.forEach(o,l=>{const u=function(p,g){return new Gp(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(r,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,n,i).next(f=>{f.forEach((p,g)=>{a=a.insert(p,g)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,i))).next(a=>{s.forEach((l,u)=>{const f=u.getKey();a.get(f)===null&&(a=a.insert(f,ni.newInvalidDocument(f)))});let o=gd();return a.forEach((l,u)=>{const f=s.get(l);f!==void 0&&Ld(f.mutation,u,$s.empty(),gn.now()),Xp(r,u)&&(o=o.insert(l,u))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $V{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return Ie.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:ha(i.createTime)}}(r)),Ie.resolve()}getNamedQuery(e,r){return Ie.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(i){return{name:i.name,query:jV(i.bundledQuery),readTime:ha(i.readTime)}}(r)),Ie.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GV{constructor(){this.overlays=new Nr(ct.comparator),this.Ir=new Map}getOverlay(e,r){return Ie.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Rl();return Ie.forEach(r,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,s)=>{this.ht(e,r,s)}),Ie.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.Ir.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),Ie.resolve()}getOverlaysForCollection(e,r,n){const i=Rl(),s=r.length+1,a=new ct(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,u=l.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>n&&i.set(l.getKey(),l)}return Ie.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let s=new Nr((u,f)=>u-f);const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let f=s.get(u.largestBatchId);f===null&&(f=Rl(),s=s.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const o=Rl(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,f)=>o.set(u,f)),!(o.size()>=i)););return Ie.resolve(o)}ht(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new gV(r,n));let s=this.Ir.get(r);s===void 0&&(s=Dt(),this.Ir.set(r,s)),this.Ir.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KV{constructor(){this.sessionToken=Un.EMPTY_BYTE_STRING}getSessionToken(e){return Ie.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Ie.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nv{constructor(){this.Tr=new jn(Tn.Er),this.dr=new jn(Tn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new Tn(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new Tn(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new ct(new Or([])),n=new Tn(r,e),i=new Tn(r,e+1),s=[];return this.dr.forEachInRange([n,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new ct(new Or([])),n=new Tn(r,e),i=new Tn(r,e+1);let s=Dt();return this.dr.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const r=new Tn(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Tn{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return ct.comparator(e.key,r.key)||Xt(e.wr,r.wr)}static Ar(e,r){return Xt(e.wr,r.wr)||ct.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YV{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new jn(Tn.Er)}checkEmpty(e){return Ie.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new pV(s,r,n,i);this.mutationQueue.push(a);for(const o of i)this.br=this.br.add(new Tn(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Ie.resolve(a)}lookupMutationBatch(e,r){return Ie.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.vr(n),s=i<0?0:i;return Ie.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Ie.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Ie.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Tn(r,0),i=new Tn(r,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,i],a=>{const o=this.Dr(a.wr);s.push(o)}),Ie.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new jn(Xt);return r.forEach(i=>{const s=new Tn(i,0),a=new Tn(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],o=>{n=n.add(o.wr)})}),Ie.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let s=n;ct.isDocumentKey(s)||(s=s.child(""));const a=new Tn(new ct(s),0);let o=new jn(Xt);return this.br.forEachWhile(l=>{const u=l.key.path;return!!n.isPrefixOf(u)&&(u.length===i&&(o=o.add(l.wr)),!0)},a),Ie.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const i=this.Dr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){nr(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return Ie.forEach(r.mutations,i=>{const s=new Tn(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new Tn(r,0),i=this.br.firstAfterOrEqual(n);return Ie.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ie.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XV{constructor(e){this.Mr=e,this.docs=function(){return new Nr(ct.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Ie.resolve(n?n.document.mutableCopy():ni.newInvalidDocument(r))}getEntries(e,r){let n=Ja();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():ni.newInvalidDocument(i))}),Ie.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let s=Ja();const a=r.path,o=new ct(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:u,value:{document:f}}=l.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||N7(I7(f),n)<=0||(i.has(f.key)||Xp(r,f))&&(s=s.insert(f.key,f.mutableCopy()))}return Ie.resolve(s)}getAllFromCollectionGroup(e,r,n,i){mt()}Or(e,r){return Ie.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new qV(this)}getSize(e){return Ie.resolve(this.size)}}class qV extends zV{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)}),Ie.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QV{constructor(e){this.persistence=e,this.Nr=new Bu(r=>Av(r),kv),this.lastRemoteSnapshotVersion=yt.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Nv,this.targetCount=0,this.kr=Su.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,i)=>r(i)),Ie.resolve()}getLastRemoteSnapshotVersion(e){return Ie.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ie.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Ie.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),Ie.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new Su(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,Ie.resolve()}updateTargetData(e,r){return this.Kn(r),Ie.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,Ie.resolve()}removeTargets(e,r,n){let i=0;const s=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),Ie.waitFor(s).next(()=>i)}getTargetCount(e){return Ie.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return Ie.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),Ie.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),Ie.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),Ie.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return Ie.resolve(n)}containsKey(e,r){return Ie.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JV{constructor(e,r){this.qr={},this.overlays={},this.Qr=new Ev(0),this.Kr=!1,this.Kr=!0,this.$r=new KV,this.referenceDelegate=e(this),this.Ur=new QV(this),this.indexManager=new VV,this.remoteDocumentCache=function(i){return new XV(i)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new LV(r),this.Gr=new $V(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new GV,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new YV(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){Ze("MemoryPersistence","Starting transaction:",e);const i=new ZV(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,r){return Ie.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class ZV extends D7{constructor(e){super(),this.currentSequenceNumber=e}}class Rv{constructor(e){this.persistence=e,this.Jr=new Nv,this.Yr=null}static Zr(e){return new Rv(e)}get Xr(){if(this.Yr)return this.Yr;throw mt()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),Ie.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),Ie.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),Ie.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(i=>this.Xr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ie.forEach(this.Xr,n=>{const i=ct.fromPath(n);return this.ei(e,i).next(s=>{s||r.removeEntry(i,yt.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return Ie.or([()=>Ie.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dv{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=i}static Wi(e,r){let n=Dt(),i=Dt();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Dv(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eU{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tU{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return t9()?8:P7(li())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,i){const s={result:null};return this.Yi(e,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new eU;return this.Xi(e,r,a).next(o=>{if(s.result=o,this.zi)return this.es(e,r,a,o.size)})}).next(()=>s.result)}es(e,r,n,i){return n.documentReadCount<this.ji?(ad()<=Vt.DEBUG&&Ze("QueryEngine","SDK will not create cache indexes for query:",Nc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Ie.resolve()):(ad()<=Vt.DEBUG&&Ze("QueryEngine","Query:",Nc(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(ad()<=Vt.DEBUG&&Ze("QueryEngine","The SDK decides to create cache indexes for query:",Nc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,fa(r))):Ie.resolve())}Yi(e,r){if(EE(r))return Ie.resolve(null);let n=fa(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=Sx(r,null,"F"),n=fa(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=Dt(...s);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const u=this.ts(r,o);return this.ns(r,u,a,l.readTime)?this.Yi(e,Sx(r,null,"F")):this.rs(e,u,r,l)}))})))}Zi(e,r,n,i){return EE(r)||i.isEqual(yt.min())?Ie.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const a=this.ts(r,s);return this.ns(r,a,n,i)?Ie.resolve(null):(ad()<=Vt.DEBUG&&Ze("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Nc(r)),this.rs(e,a,r,b7(i,-1)).next(o=>o))})}ts(e,r){let n=new jn(cC(e));return r.forEach((i,s)=>{Xp(e,s)&&(n=n.add(s))}),n}ns(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,r,n){return ad()<=Vt.DEBUG&&Ze("QueryEngine","Using full collection scan to execute query:",Nc(r)),this.Ji.getDocumentsMatchingQuery(e,r,rl.min(),n)}rs(e,r,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rU{constructor(e,r,n,i){this.persistence=e,this.ss=r,this.serializer=i,this.os=new Nr(Xt),this._s=new Bu(s=>Av(s),kv),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new HV(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function nU(t,e,r,n){return new rU(t,e,r,n)}async function NC(t,e){const r=_t(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let l=Dt();for(const u of i){a.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}for(const u of s){o.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}return r.localDocuments.getDocuments(n,l).next(u=>({hs:u,removedBatchIds:a,addedBatchIds:o}))})})}function iU(t,e){const r=_t(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,u,f){const p=u.batch,g=p.keys();let m=Ie.resolve();return g.forEach(y=>{m=m.next(()=>f.getEntry(l,y)).next(x=>{const w=u.docVersions.get(y);nr(w!==null),x.version.compareTo(w)<0&&(p.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),f.addEntry(x)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(l,p))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=Dt();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(l=l.add(o.batch.mutations[u].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function RC(t){const e=_t(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function sU(t,e){const r=_t(t),n=e.snapshotVersion;let i=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.cs.newChangeBuffer({trackRemovals:!0});i=r.os;const o=[];e.targetChanges.forEach((f,p)=>{const g=i.get(p);if(!g)return;o.push(r.Ur.removeMatchingKeys(s,f.removedDocuments,p).next(()=>r.Ur.addMatchingKeys(s,f.addedDocuments,p)));let m=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?m=m.withResumeToken(Un.EMPTY_BYTE_STRING,yt.min()).withLastLimboFreeSnapshotVersion(yt.min()):f.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(f.resumeToken,n)),i=i.insert(p,m),function(x,w,A){return x.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0}(g,m,f)&&o.push(r.Ur.updateTargetData(s,m))});let l=Ja(),u=Dt();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,f))}),o.push(aU(s,a,e.documentUpdates).next(f=>{l=f.Ps,u=f.Is})),!n.isEqual(yt.min())){const f=r.Ur.getLastRemoteSnapshotVersion(s).next(p=>r.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(f)}return Ie.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(r.os=i,s))}function aU(t,e,r){let n=Dt(),i=Dt();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let a=Ja();return r.forEach((o,l)=>{const u=s.get(o);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(yt.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):Ze("LocalStore","Ignoring outdated watch update for ",o,". Current version:",u.version," Watch version:",l.version)}),{Ps:a,Is:i}})}function oU(t,e){const r=_t(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function lU(t,e){const r=_t(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Ur.getTargetData(n,e).next(s=>s?(i=s,Ie.resolve(i)):r.Ur.allocateTargetId(n).next(a=>(i=new Mo(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.os.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function Fx(t,e,r){const n=_t(t),i=n.os.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!Hf(a))throw a;Ze("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(i.target)}function RE(t,e,r){const n=_t(t);let i=yt.min(),s=Dt();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,u,f){const p=_t(l),g=p._s.get(f);return g!==void 0?Ie.resolve(p.os.get(g)):p.Ur.getTargetData(u,f)}(n,a,fa(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,r?i:yt.min(),r?s:Dt())).next(o=>(cU(n,Z7(e),o),{documents:o,Ts:s})))}function cU(t,e,r){let n=t.us.get(e)||yt.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.us.set(e,n)}class DE{constructor(){this.activeTargetIds=sV()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class uU{constructor(){this.so=new DE,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new DE,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dU{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PE{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Ze("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Ze("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let G0=null;function nm(){return G0===null?G0=function(){return 268435456+Math.round(2147483648*Math.random())}():G0++,"0x"+G0.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hU{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qn="WebChannelConnection";class pU extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(r,n,i,s,a){const o=nm(),l=this.xo(r,n.toUriEncodedString());Ze("RestConnection",`Sending RPC '${r}' ${o}:`,l,i);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,s,a),this.No(r,l,u,i).then(f=>(Ze("RestConnection",`Received RPC '${r}' ${o}: `,f),f),f=>{throw yu("RestConnection",`RPC '${r}' ${o} failed with error: `,f,"url: ",l,"request:",i),f})}Lo(r,n,i,s,a,o){return this.Mo(r,n,i,s,a)}Oo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ou}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>r[a]=s),i&&i.headers.forEach((s,a)=>r[a]=s)}xo(r,n){const i=fU[r];return`${this.Do}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,i){const s=nm();return new Promise((a,o)=>{const l=new Gk;l.setWithCredentials(!0),l.listenOnce(Kk.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case uh.NO_ERROR:const f=l.getResponseJson();Ze(Qn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),a(f);break;case uh.TIMEOUT:Ze(Qn,`RPC '${e}' ${s} timed out`),o(new ot(Pe.DEADLINE_EXCEEDED,"Request time out"));break;case uh.HTTP_ERROR:const p=l.getStatus();if(Ze(Qn,`RPC '${e}' ${s} failed with status:`,p,"response text:",l.getResponseText()),p>0){let g=l.getResponseJson();Array.isArray(g)&&(g=g[0]);const m=g==null?void 0:g.error;if(m&&m.status&&m.message){const y=function(w){const A=w.toLowerCase().replace(/_/g,"-");return Object.values(Pe).indexOf(A)>=0?A:Pe.UNKNOWN}(m.status);o(new ot(y,m.message))}else o(new ot(Pe.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new ot(Pe.UNAVAILABLE,"Connection failed."));break;default:mt()}}finally{Ze(Qn,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);Ze(Qn,`RPC '${e}' ${s} sending request:`,i),l.send(r,"POST",u,n,15)})}Bo(e,r,n){const i=nm(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=qk(),o=Xk(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const f=s.join("");Ze(Qn,`Creating RPC '${e}' stream ${i}: ${f}`,l);const p=a.createWebChannel(f,l);let g=!1,m=!1;const y=new hU({Io:w=>{m?Ze(Qn,`Not sending because RPC '${e}' stream ${i} is closed:`,w):(g||(Ze(Qn,`Opening RPC '${e}' stream ${i} transport.`),p.open(),g=!0),Ze(Qn,`RPC '${e}' stream ${i} sending:`,w),p.send(w))},To:()=>p.close()}),x=(w,A,k)=>{w.listen(A,_=>{try{k(_)}catch(O){setTimeout(()=>{throw O},0)}})};return x(p,pd.EventType.OPEN,()=>{m||(Ze(Qn,`RPC '${e}' stream ${i} transport opened.`),y.yo())}),x(p,pd.EventType.CLOSE,()=>{m||(m=!0,Ze(Qn,`RPC '${e}' stream ${i} transport closed`),y.So())}),x(p,pd.EventType.ERROR,w=>{m||(m=!0,yu(Qn,`RPC '${e}' stream ${i} transport errored:`,w),y.So(new ot(Pe.UNAVAILABLE,"The operation could not be completed")))}),x(p,pd.EventType.MESSAGE,w=>{var A;if(!m){const k=w.data[0];nr(!!k);const _=k,O=_.error||((A=_[0])===null||A===void 0?void 0:A.error);if(O){Ze(Qn,`RPC '${e}' stream ${i} received error:`,O);const G=O.status;let U=function(S){const I=qr[S];if(I!==void 0)return EC(I)}(G),T=O.message;U===void 0&&(U=Pe.INTERNAL,T="Unknown error status: "+G+" with message "+O.message),m=!0,y.So(new ot(U,T)),p.close()}else Ze(Qn,`RPC '${e}' stream ${i} received:`,k),y.bo(k)}}),x(o,Yk.STAT_EVENT,w=>{w.stat===vx.PROXY?Ze(Qn,`RPC '${e}' stream ${i} detected buffering proxy`):w.stat===vx.NOPROXY&&Ze(Qn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{y.wo()},0),y}}function im(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zp(t){return new TV(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(e,r,n=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,r-n);i>0&&Ze("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{constructor(e,r,n,i,s,a,o,l){this.ui=e,this.Ho=n,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new DC(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===Pe.RESOURCE_EXHAUSTED?(Qa(r.toString()),Qa("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===Pe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Yo===r&&this.P_(n,i)},n=>{e(()=>{const i=new ot(Pe.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(i)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{n(()=>this.I_(i))}),this.stream.onMessage(i=>{n(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Ze("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(Ze("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class gU extends PC{constructor(e,r,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=CV(this.serializer,e),n=function(s){if(!("targetChange"in s))return yt.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?yt.min():a.readTime?ha(a.readTime):yt.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=Cx(this.serializer),r.addTarget=function(s,a){let o;const l=a.target;if(o=wx(l)?{documents:IV(s,l)}:{query:NV(s,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=TC(s,a.resumeToken);const u=Tx(s,a.expectedCount);u!==null&&(o.expectedCount=u)}else if(a.snapshotVersion.compareTo(yt.min())>0){o.readTime=up(s,a.snapshotVersion.toTimestamp());const u=Tx(s,a.expectedCount);u!==null&&(o.expectedCount=u)}return o}(this.serializer,e);const n=DV(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=Cx(this.serializer),r.removeTarget=e,this.a_(r)}}class mU extends PC{constructor(e,r,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return nr(!!e.streamToken),this.lastStreamToken=e.streamToken,nr(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){nr(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=bV(e.writeResults,e.commitTime),n=ha(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=Cx(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>FV(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xU extends class{}{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new ot(Pe.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,Ax(r,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ot(Pe.UNKNOWN,s.toString())})}Lo(e,r,n,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,Ax(r,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ot(Pe.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class vU{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Qa(r),this.D_=!1):Ze("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yU{constructor(e,r,n,i,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{n.enqueueAndForget(async()=>{fc(this)&&(Ze("RemoteStore","Restarting streams for network reachability change."),await async function(l){const u=_t(l);u.L_.add(4),await Kf(u),u.q_.set("Unknown"),u.L_.delete(4),await eg(u)}(this))})}),this.q_=new vU(n,i)}}async function eg(t){if(fc(t))for(const e of t.B_)await e(!0)}async function Kf(t){for(const e of t.B_)await e(!1)}function OC(t,e){const r=_t(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),Bv(r)?Mv(r):Lu(r).r_()&&Ov(r,e))}function Pv(t,e){const r=_t(t),n=Lu(r);r.N_.delete(e),n.r_()&&MC(r,e),r.N_.size===0&&(n.r_()?n.o_():fc(r)&&r.q_.set("Unknown"))}function Ov(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(yt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Lu(t).A_(e)}function MC(t,e){t.Q_.xe(e),Lu(t).R_(e)}function Mv(t){t.Q_=new _V({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Lu(t).start(),t.q_.v_()}function Bv(t){return fc(t)&&!Lu(t).n_()&&t.N_.size>0}function fc(t){return _t(t).L_.size===0}function BC(t){t.Q_=void 0}async function _U(t){t.q_.set("Online")}async function EU(t){t.N_.forEach((e,r)=>{Ov(t,e)})}async function wU(t,e){BC(t),Bv(t)?(t.q_.M_(e),Mv(t)):t.q_.set("Unknown")}async function SU(t,e,r){if(t.q_.set("Online"),e instanceof SC&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.N_.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.N_.delete(o),i.Q_.removeTarget(o))}(t,e)}catch(n){Ze("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await dp(t,n)}else if(e instanceof hh?t.Q_.Ke(e):e instanceof wC?t.Q_.He(e):t.Q_.We(e),!r.isEqual(yt.min()))try{const n=await RC(t.localStore);r.compareTo(n)>=0&&await function(s,a){const o=s.Q_.rt(a);return o.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const f=s.N_.get(u);f&&s.N_.set(u,f.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,u)=>{const f=s.N_.get(l);if(!f)return;s.N_.set(l,f.withResumeToken(Un.EMPTY_BYTE_STRING,f.snapshotVersion)),MC(s,l);const p=new Mo(f.target,l,u,f.sequenceNumber);Ov(s,p)}),s.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Ze("RemoteStore","Failed to raise snapshot:",n),await dp(t,n)}}async function dp(t,e,r){if(!Hf(e))throw e;t.L_.add(1),await Kf(t),t.q_.set("Offline"),r||(r=()=>RC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ze("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await eg(t)})}function LC(t,e){return e().catch(r=>dp(t,r,e))}async function tg(t){const e=_t(t),r=il(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;TU(e);)try{const i=await oU(e.localStore,n);if(i===null){e.O_.length===0&&r.o_();break}n=i.batchId,AU(e,i)}catch(i){await dp(e,i)}jC(e)&&VC(e)}function TU(t){return fc(t)&&t.O_.length<10}function AU(t,e){t.O_.push(e);const r=il(t);r.r_()&&r.V_&&r.m_(e.mutations)}function jC(t){return fc(t)&&!il(t).n_()&&t.O_.length>0}function VC(t){il(t).start()}async function kU(t){il(t).p_()}async function CU(t){const e=il(t);for(const r of t.O_)e.m_(r.mutations)}async function FU(t,e,r){const n=t.O_.shift(),i=Fv.from(n,e,r);await LC(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await tg(t)}async function bU(t,e){e&&il(t).V_&&await async function(n,i){if(function(a){return xV(a)&&a!==Pe.ABORTED}(i.code)){const s=n.O_.shift();il(n).s_(),await LC(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await tg(n)}}(t,e),jC(t)&&VC(t)}async function OE(t,e){const r=_t(t);r.asyncQueue.verifyOperationInProgress(),Ze("RemoteStore","RemoteStore received new credentials");const n=fc(r);r.L_.add(3),await Kf(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await eg(r)}async function IU(t,e){const r=_t(t);e?(r.L_.delete(2),await eg(r)):e||(r.L_.add(2),await Kf(r),r.q_.set("Unknown"))}function Lu(t){return t.K_||(t.K_=function(r,n,i){const s=_t(r);return s.w_(),new gU(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:_U.bind(null,t),Ro:EU.bind(null,t),mo:wU.bind(null,t),d_:SU.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Bv(t)?Mv(t):t.q_.set("Unknown")):(await t.K_.stop(),BC(t))})),t.K_}function il(t){return t.U_||(t.U_=function(r,n,i){const s=_t(r);return s.w_(),new mU(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:kU.bind(null,t),mo:bU.bind(null,t),f_:CU.bind(null,t),g_:FU.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await tg(t)):(await t.U_.stop(),t.O_.length>0&&(Ze("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lv{constructor(e,r,n,i,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Yo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,s){const a=Date.now()+n,o=new Lv(e,r,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ot(Pe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function jv(t,e){if(Qa("AsyncQueue",`${e}: ${t}`),Hf(t))return new ot(Pe.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(e){this.comparator=e?(r,n)=>e(r,n)||ct.comparator(r.key,n.key):(r,n)=>ct.comparator(r.key,n.key),this.keyedMap=gd(),this.sortedSet=new Nr(this.comparator)}static emptySet(e){return new iu(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof iu)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new iu;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ME{constructor(){this.W_=new Nr(ct.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):mt():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class Tu{constructor(e,r,n,i,s,a,o,l,u){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,r,n,i,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new Tu(e,r,iu.emptySet(r),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Yp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NU{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class RU{constructor(){this.queries=BE(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const i=_t(r),s=i.queries;i.queries=BE(),s.forEach((a,o)=>{for(const l of o.j_)l.onError(n)})})(this,new ot(Pe.ABORTED,"Firestore shutting down"))}}function BE(){return new Bu(t=>lC(t),Yp)}async function UC(t,e){const r=_t(t);let n=3;const i=e.query;let s=r.queries.get(i);s?!s.H_()&&e.J_()&&(n=2):(s=new NU,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(i,!0);break;case 1:s.z_=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const o=jv(a,`Initialization of query '${Nc(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,s),s.j_.push(e),e.Z_(r.onlineState),s.z_&&e.X_(s.z_)&&Vv(r)}async function zC(t,e){const r=_t(t),n=e.query;let i=3;const s=r.queries.get(n);if(s){const a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function DU(t,e){const r=_t(t);let n=!1;for(const i of e){const s=i.query,a=r.queries.get(s);if(a){for(const o of a.j_)o.X_(i)&&(n=!0);a.z_=i}}n&&Vv(r)}function PU(t,e,r){const n=_t(t),i=n.queries.get(e);if(i)for(const s of i.j_)s.onError(r);n.queries.delete(e)}function Vv(t){t.Y_.forEach(e=>{e.next()})}var bx,LE;(LE=bx||(bx={})).ea="default",LE.Cache="cache";class WC{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new Tu(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=Tu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==bx.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{constructor(e){this.key=e}}class $C{constructor(e){this.key=e}}class OU{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Dt(),this.mutatedKeys=Dt(),this.Aa=cC(e),this.Ra=new iu(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new ME,i=r?r.Ra:this.Ra;let s=r?r.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,p)=>{const g=i.get(f),m=Xp(this.query,p)?p:null,y=!!g&&this.mutatedKeys.has(g.key),x=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let w=!1;g&&m?g.data.isEqual(m.data)?y!==x&&(n.track({type:3,doc:m}),w=!0):this.ga(g,m)||(n.track({type:2,doc:m}),w=!0,(l&&this.Aa(m,l)>0||u&&this.Aa(m,u)<0)&&(o=!0)):!g&&m?(n.track({type:0,doc:m}),w=!0):g&&!m&&(n.track({type:1,doc:g}),w=!0,(l||u)&&(o=!0)),w&&(m?(a=a.add(m),s=x?s.add(f):s.delete(f)):(a=a.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),s=s.delete(f.key),n.track({type:1,doc:f})}return{Ra:a,fa:n,ns:o,mutatedKeys:s}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((f,p)=>function(m,y){const x=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return mt()}};return x(m)-x(y)}(f.type,p.type)||this.Aa(f.doc,p.doc)),this.pa(n),i=i!=null&&i;const o=r&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,u=l!==this.Ea;return this.Ea=l,a.length!==0||u?{snapshot:new Tu(this.query,e.Ra,s,a,e.mutatedKeys,l===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new ME,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Dt(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new $C(n))}),this.da.forEach(n=>{e.has(n)||r.push(new HC(n))}),r}ba(e){this.Ta=e.Ts,this.da=Dt();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return Tu.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class MU{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class BU{constructor(e){this.key=e,this.va=!1}}class LU{constructor(e,r,n,i,s,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Bu(o=>lC(o),Yp),this.Ma=new Map,this.xa=new Set,this.Oa=new Nr(ct.comparator),this.Na=new Map,this.La=new Nv,this.Ba={},this.ka=new Map,this.qa=Su.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function jU(t,e,r=!0){const n=QC(t);let i;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await GC(n,e,r,!0),i}async function VU(t,e){const r=QC(t);await GC(r,e,!0,!1)}async function GC(t,e,r,n){const i=await lU(t.localStore,fa(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,r);let o;return n&&(o=await UU(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&OC(t.remoteStore,i),o}async function UU(t,e,r,n,i){t.Ka=(p,g,m)=>async function(x,w,A,k){let _=w.view.ma(A);_.ns&&(_=await RE(x.localStore,w.query,!1).then(({documents:T})=>w.view.ma(T,_)));const O=k&&k.targetChanges.get(w.targetId),G=k&&k.targetMismatches.get(w.targetId)!=null,U=w.view.applyChanges(_,x.isPrimaryClient,O,G);return VE(x,w.targetId,U.wa),U.snapshot}(t,p,g,m);const s=await RE(t.localStore,e,!0),a=new OU(e,s.Ts),o=a.ma(s.documents),l=Gf.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),u=a.applyChanges(o,t.isPrimaryClient,l);VE(t,r,u.wa);const f=new MU(e,r,a);return t.Fa.set(e,f),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),u.snapshot}async function zU(t,e,r){const n=_t(t),i=n.Fa.get(e),s=n.Ma.get(i.targetId);if(s.length>1)return n.Ma.set(i.targetId,s.filter(a=>!Yp(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Fx(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Pv(n.remoteStore,i.targetId),Ix(n,i.targetId)}).catch(Wf)):(Ix(n,i.targetId),await Fx(n.localStore,i.targetId,!0))}async function WU(t,e){const r=_t(t),n=r.Fa.get(e),i=r.Ma.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Pv(r.remoteStore,n.targetId))}async function HU(t,e,r){const n=QU(t);try{const i=await function(a,o){const l=_t(a),u=gn.now(),f=o.reduce((m,y)=>m.add(y.key),Dt());let p,g;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let y=Ja(),x=Dt();return l.cs.getEntries(m,f).next(w=>{y=w,y.forEach((A,k)=>{k.isValidDocument()||(x=x.add(A))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,y)).next(w=>{p=w;const A=[];for(const k of o){const _=fV(k,p.get(k.key).overlayedDocument);_!=null&&A.push(new dc(k.key,_,tC(_.value.mapValue),Ha.exists(!0)))}return l.mutationQueue.addMutationBatch(m,u,A,o)}).next(w=>{g=w;const A=w.applyToLocalDocumentSet(p,x);return l.documentOverlayCache.saveOverlays(m,w.batchId,A)})}).then(()=>({batchId:g.batchId,changes:dC(p)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,l){let u=a.Ba[a.currentUser.toKey()];u||(u=new Nr(Xt)),u=u.insert(o,l),a.Ba[a.currentUser.toKey()]=u}(n,i.batchId,r),await Yf(n,i.changes),await tg(n.remoteStore)}catch(i){const s=jv(i,"Failed to persist write");r.reject(s)}}async function KC(t,e){const r=_t(t);try{const n=await sU(r.localStore,e);e.targetChanges.forEach((i,s)=>{const a=r.Na.get(s);a&&(nr(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?nr(a.va):i.removedDocuments.size>0&&(nr(a.va),a.va=!1))}),await Yf(r,n,e)}catch(n){await Wf(n)}}function jE(t,e,r){const n=_t(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Fa.forEach((s,a)=>{const o=a.view.Z_(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const l=_t(a);l.onlineState=o;let u=!1;l.queries.forEach((f,p)=>{for(const g of p.j_)g.Z_(o)&&(u=!0)}),u&&Vv(l)}(n.eventManager,e),i.length&&n.Ca.d_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function $U(t,e,r){const n=_t(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Na.get(e),s=i&&i.key;if(s){let a=new Nr(ct.comparator);a=a.insert(s,ni.newNoDocument(s,yt.min()));const o=Dt().add(s),l=new Jp(yt.min(),new Map,new Nr(Xt),a,o);await KC(n,l),n.Oa=n.Oa.remove(s),n.Na.delete(e),Uv(n)}else await Fx(n.localStore,e,!1).then(()=>Ix(n,e,r)).catch(Wf)}async function GU(t,e){const r=_t(t),n=e.batch.batchId;try{const i=await iU(r.localStore,e);XC(r,n,null),YC(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Yf(r,i)}catch(i){await Wf(i)}}async function KU(t,e,r){const n=_t(t);try{const i=await function(a,o){const l=_t(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return l.mutationQueue.lookupMutationBatch(u,o).next(p=>(nr(p!==null),f=p.keys(),l.mutationQueue.removeMutationBatch(u,p))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,f,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>l.localDocuments.getDocuments(u,f))})}(n.localStore,e);XC(n,e,r),YC(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Yf(n,i)}catch(i){await Wf(i)}}function YC(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function XC(t,e,r){const n=_t(t);let i=n.Ba[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(r?s.reject(r):s.resolve(),i=i.remove(e)),n.Ba[n.currentUser.toKey()]=i}}function Ix(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||qC(t,n)})}function qC(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(Pv(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),Uv(t))}function VE(t,e,r){for(const n of r)n instanceof HC?(t.La.addReference(n.key,e),YU(t,n)):n instanceof $C?(Ze("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||qC(t,n.key)):mt()}function YU(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(Ze("SyncEngine","New document in limbo: "+r),t.xa.add(n),Uv(t))}function Uv(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new ct(Or.fromString(e)),n=t.qa.next();t.Na.set(n,new BU(r)),t.Oa=t.Oa.insert(r,n),OC(t.remoteStore,new Mo(fa(Kp(r.path)),n,"TargetPurposeLimboResolution",Ev.oe))}}async function Yf(t,e,r){const n=_t(t),i=[],s=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{a.push(n.Ka(l,e,r).then(u=>{var f;if((u||r)&&n.isPrimaryClient){const p=u?!u.fromCache:(f=r==null?void 0:r.targetChanges.get(l.targetId))===null||f===void 0?void 0:f.current;n.sharedClientState.updateQueryState(l.targetId,p?"current":"not-current")}if(u){i.push(u);const p=Dv.Wi(l.targetId,u);s.push(p)}}))}),await Promise.all(a),n.Ca.d_(i),await async function(l,u){const f=_t(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>Ie.forEach(u,g=>Ie.forEach(g.$i,m=>f.persistence.referenceDelegate.addReference(p,g.targetId,m)).next(()=>Ie.forEach(g.Ui,m=>f.persistence.referenceDelegate.removeReference(p,g.targetId,m)))))}catch(p){if(!Hf(p))throw p;Ze("LocalStore","Failed to update sequence numbers: "+p)}for(const p of u){const g=p.targetId;if(!p.fromCache){const m=f.os.get(g),y=m.snapshotVersion,x=m.withLastLimboFreeSnapshotVersion(y);f.os=f.os.insert(g,x)}}}(n.localStore,s))}async function XU(t,e){const r=_t(t);if(!r.currentUser.isEqual(e)){Ze("SyncEngine","User change. New user:",e.toKey());const n=await NC(r.localStore,e);r.currentUser=e,function(s,a){s.ka.forEach(o=>{o.forEach(l=>{l.reject(new ot(Pe.CANCELLED,a))})}),s.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Yf(r,n.hs)}}function qU(t,e){const r=_t(t),n=r.Na.get(e);if(n&&n.va)return Dt().add(n.key);{let i=Dt();const s=r.Ma.get(e);if(!s)return i;for(const a of s){const o=r.Fa.get(a);i=i.unionWith(o.view.Va)}return i}}function QC(t){const e=_t(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=KC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=qU.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=$U.bind(null,e),e.Ca.d_=DU.bind(null,e.eventManager),e.Ca.$a=PU.bind(null,e.eventManager),e}function QU(t){const e=_t(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=GU.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=KU.bind(null,e),e}class fp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Zp(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return nU(this.persistence,new tU,e.initialUser,this.serializer)}Ga(e){return new JV(Rv.Zr,this.serializer)}Wa(e){return new uU}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}fp.provider={build:()=>new fp};class Nx{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>jE(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=XU.bind(null,this.syncEngine),await IU(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new RU}()}createDatastore(e){const r=Zp(e.databaseInfo.databaseId),n=function(s){return new pU(s)}(e.databaseInfo);return function(s,a,o,l){return new xU(s,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,s,a,o){return new yU(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>jE(this.syncEngine,r,0),function(){return PE.D()?new PE:new dU}())}createSyncEngine(e,r){return function(i,s,a,o,l,u,f){const p=new LU(i,s,a,o,l,u);return f&&(p.Qa=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const s=_t(i);Ze("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Kf(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Nx.provider={build:()=>new Nx};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JC{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Qa("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JU{constructor(e,r,n,i,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=Zn.UNAUTHENTICATED,this.clientId=Jk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{Ze("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(Ze("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Yo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=jv(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function sm(t,e){t.asyncQueue.verifyOperationInProgress(),Ze("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await NC(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function UE(t,e){t.asyncQueue.verifyOperationInProgress();const r=await ZU(t);Ze("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>OE(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>OE(e.remoteStore,i)),t._onlineComponents=e}async function ZU(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ze("FirestoreClient","Using user provided OfflineComponentProvider");try{await sm(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===Pe.FAILED_PRECONDITION||i.code===Pe.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;yu("Error using user provided cache. Falling back to memory cache: "+r),await sm(t,new fp)}}else Ze("FirestoreClient","Using default OfflineComponentProvider"),await sm(t,new fp);return t._offlineComponents}async function ZC(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ze("FirestoreClient","Using user provided OnlineComponentProvider"),await UE(t,t._uninitializedComponentsProvider._online)):(Ze("FirestoreClient","Using default OnlineComponentProvider"),await UE(t,new Nx))),t._onlineComponents}function ez(t){return ZC(t).then(e=>e.syncEngine)}async function Rx(t){const e=await ZC(t),r=e.eventManager;return r.onListen=jU.bind(null,e.syncEngine),r.onUnlisten=zU.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=VU.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=WU.bind(null,e.syncEngine),r}function tz(t,e,r={}){const n=new Yo;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,u){const f=new JC({next:g=>{f.Za(),a.enqueueAndForget(()=>zC(s,p));const m=g.docs.has(o);!m&&g.fromCache?u.reject(new ot(Pe.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&g.fromCache&&l&&l.source==="server"?u.reject(new ot(Pe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),p=new WC(Kp(o.path),f,{includeMetadataChanges:!0,_a:!0});return UC(s,p)}(await Rx(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e4(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zE=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rz(t,e,r){if(!r)throw new ot(Pe.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function nz(t,e,r,n){if(e===!0&&n===!0)throw new ot(Pe.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function WE(t){if(!ct.isDocumentKey(t))throw new ot(Pe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function zv(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":mt()}function Xo(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ot(Pe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=zv(t);throw new ot(Pe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HE{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new ot(Pe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ot(Pe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}nz("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=e4((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ot(Pe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ot(Pe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ot(Pe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Wv{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new HE({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ot(Pe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ot(Pe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new HE(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new _7;switch(n.type){case"firstParty":return new T7(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new ot(Pe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=zE.get(r);n&&(Ze("ComponentProvider","Removing Datastore"),zE.delete(r),n.terminate())}(this),Promise.resolve()}}function iz(t,e,r,n={}){var i;const s=(t=Xo(t,Wv))._getSettings(),a=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&yu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=Zn.MOCK_USER;else{o=Yj(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const u=n.mockUserToken.sub||n.mockUserToken.user_id;if(!u)throw new ot(Pe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Zn(u)}t._authCredentials=new E7(new Qk(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new rg(this.firestore,e,this._query)}}class Qi{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Af(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Qi(this.firestore,e,this._key)}}class Af extends rg{constructor(e,r,n){super(e,r,Kp(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Qi(this.firestore,null,new ct(e))}withConverter(e){return new Af(this.firestore,e,this._path)}}function Hv(t,e,...r){if(t=Qs(t),arguments.length===1&&(e=Jk.newId()),rz("doc","path",e),t instanceof Wv){const n=Or.fromString(e,...r);return WE(n),new Qi(t,null,new ct(n))}{if(!(t instanceof Qi||t instanceof Af))throw new ot(Pe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Or.fromString(e,...r));return WE(n),new Qi(t.firestore,t instanceof Af?t.converter:null,new ct(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $E{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new DC(this,"async_queue_retry"),this.Vu=()=>{const n=im();n&&Ze("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=im();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=im();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new Yo;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Hf(e))throw e;Ze("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw Qa("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const i=Lv.createAndSchedule(this,e,r,n,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&mt()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function GE(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const i=r;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class kf extends Wv{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new $E,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new $E(e),this._firestoreClient=void 0,await e}}}function sz(t,e){const r=typeof t=="object"?t:zk(),n=typeof t=="string"?t:"(default)",i=yv(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=Gj("firestore");s&&iz(i,...s)}return i}function $v(t){if(t._terminated)throw new ot(Pe.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||az(t),t._firestoreClient}function az(t){var e,r,n;const i=t._freezeSettings(),s=function(o,l,u,f){return new B7(o,l,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,e4(f.experimentalLongPollingOptions),f.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new JU(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Au(Un.fromBase64String(e))}catch(r){throw new ot(Pe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Au(Un.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gv{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new ot(Pe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Bn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t4{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kv{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new ot(Pe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new ot(Pe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Xt(this._lat,e._lat)||Xt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yv{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oz=/^__.*__$/;class lz{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new dc(e,this.data,this.fieldMask,r,this.fieldTransforms):new $f(e,this.data,r,this.fieldTransforms)}}function r4(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw mt()}}class Xv{constructor(e,r,n,i,s,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Xv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return hp(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(r4(this.Cu)&&oz.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class cz{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Zp(e)}Qu(e,r,n,i=!1){return new Xv({Cu:e,methodName:r,qu:n,path:Bn.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function uz(t){const e=t._freezeSettings(),r=Zp(t._databaseId);return new cz(t._databaseId,!!e.ignoreUndefinedProperties,r)}function dz(t,e,r,n,i,s={}){const a=t.Qu(s.merge||s.mergeFields?2:0,e,r,i);a4("Data must be an object, but it was:",a,n);const o=i4(n,a);let l,u;if(s.merge)l=new $s(a.fieldMask),u=a.fieldTransforms;else if(s.mergeFields){const f=[];for(const p of s.mergeFields){const g=fz(e,p,r);if(!a.contains(g))throw new ot(Pe.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);pz(f,g)||f.push(g)}l=new $s(f),u=a.fieldTransforms.filter(p=>l.covers(p.field))}else l=null,u=a.fieldTransforms;return new lz(new _s(o),l,u)}function n4(t,e){if(s4(t=Qs(t)))return a4("Unsupported field value:",e,t),i4(t,e);if(t instanceof t4)return function(n,i){if(!r4(i.Cu))throw i.Bu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let l=n4(o,i.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(t,e)}return function(n,i){if((n=Qs(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return aV(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=gn.fromDate(n);return{timestampValue:up(i.serializer,s)}}if(n instanceof gn){const s=new gn(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:up(i.serializer,s)}}if(n instanceof Kv)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Au)return{bytesValue:TC(i.serializer,n._byteString)};if(n instanceof Qi){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Iv(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof Yv)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return Cv(o.serializer,l)})}}}}}}(n,i);throw i.Bu(`Unsupported field value: ${zv(n)}`)}(t,e)}function i4(t,e){const r={};return Zk(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Mu(t,(n,i)=>{const s=n4(i,e.Mu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function s4(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof gn||t instanceof Kv||t instanceof Au||t instanceof Qi||t instanceof t4||t instanceof Yv)}function a4(t,e,r){if(!s4(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=zv(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function fz(t,e,r){if((e=Qs(e))instanceof Gv)return e._internalPath;if(typeof e=="string")return o4(t,e);throw hp("Field path arguments must be of type string or ",t,!1,void 0,r)}const hz=new RegExp("[~\\*/\\[\\]]");function o4(t,e,r){if(e.search(hz)>=0)throw hp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Gv(...e.split("."))._internalPath}catch{throw hp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function hp(t,e,r,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${i}`),l+=")"),new ot(Pe.INVALID_ARGUMENT,o+t+l)}function pz(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l4{constructor(e,r,n,i,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Qi(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new gz(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(c4("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class gz extends l4{data(){return super.data()}}function c4(t,e){return typeof e=="string"?o4(t,e):e instanceof Gv?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mz(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ot(Pe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class xz{convertValue(e,r="none"){switch(tc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return zr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(ec(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw mt()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Mu(e,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,i;const s=(i=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(a=>zr(a.doubleValue));return new Yv(s)}convertGeoPoint(e){return new Kv(zr(e.latitude),zr(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Sv(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(_f(e));default:return null}}convertTimestamp(e){const r=nl(e);return new gn(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Or.fromString(e);nr(IC(n));const i=new Ef(n.get(1),n.get(3)),s=new ct(n.popFirst(5));return i.isEqual(r)||Qa(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vz(t,e,r){let n;return n=t?t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class u4 extends l4{constructor(e,r,n,i,s,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new ph(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(c4("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class ph extends u4{data(e={}){return super.data(e)}}class yz{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new xd(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new ph(this._firestore,this._userDataWriter,n.key,n,new xd(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new ot(Pe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const l=new ph(i._firestore,i._userDataWriter,o.doc.key,o.doc,new xd(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new ph(i._firestore,i._userDataWriter,o.doc.key,o.doc,new xd(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,f=-1;return o.type!==0&&(u=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),f=a.indexOf(o.doc.key)),{type:_z(o.type),doc:l,oldIndex:u,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function _z(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return mt()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ez(t){t=Xo(t,Qi);const e=Xo(t.firestore,kf);return tz($v(e),t._key).then(r=>f4(e,t,r))}class d4 extends xz{constructor(e){super(),this.firestore=e}convertBytes(e){return new Au(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Qi(this.firestore,null,r)}}function wz(t,e,r){t=Xo(t,Qi);const n=Xo(t.firestore,kf),i=vz(t.converter,e);return Tz(n,[dz(uz(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,Ha.none())])}function Sz(t,...e){var r,n,i;t=Qs(t);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||GE(e[a])||(s=e[a],a++);const o={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(GE(e[a])){const p=e[a];e[a]=(r=p.next)===null||r===void 0?void 0:r.bind(p),e[a+1]=(n=p.error)===null||n===void 0?void 0:n.bind(p),e[a+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let l,u,f;if(t instanceof Qi)u=Xo(t.firestore,kf),f=Kp(t._key.path),l={next:p=>{e[a]&&e[a](f4(u,t,p))},error:e[a+1],complete:e[a+2]};else{const p=Xo(t,rg);u=Xo(p.firestore,kf),f=p._query;const g=new d4(u);l={next:m=>{e[a]&&e[a](new yz(u,g,p,m))},error:e[a+1],complete:e[a+2]},mz(t._query)}return function(g,m,y,x){const w=new JC(x),A=new WC(m,w,y);return g.asyncQueue.enqueueAndForget(async()=>UC(await Rx(g),A)),()=>{w.Za(),g.asyncQueue.enqueueAndForget(async()=>zC(await Rx(g),A))}}($v(u),f,o,l)}function Tz(t,e){return function(n,i){const s=new Yo;return n.asyncQueue.enqueueAndForget(async()=>HU(await ez(n),i,s)),s.promise}($v(t),e)}function f4(t,e,r){const n=r.docs.get(e._key),i=new d4(t);return new u4(t,i,e._key,n,new xd(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){Ou=i})(Pu),vu(new Jl("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new kf(new w7(n.getProvider("auth-internal")),new k7(n.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new ot(Pe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ef(u.options.projectId,f)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),Ko(dE,"4.7.3",e),Ko(dE,"4.7.3","esm2017")})();function qv(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function h4(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Az=h4,p4=new Uf("auth","Firebase",h4());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pp=new xv("@firebase/auth");function kz(t,...e){pp.logLevel<=Vt.WARN&&pp.warn(`Auth (${Pu}): ${t}`,...e)}function gh(t,...e){pp.logLevel<=Vt.ERROR&&pp.error(`Auth (${Pu}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Za(t,...e){throw Qv(t,...e)}function pa(t,...e){return Qv(t,...e)}function g4(t,e,r){const n=Object.assign(Object.assign({},Az()),{[e]:r});return new Uf("auth","Firebase",n).create(e,{appName:t.name})}function Vl(t){return g4(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Qv(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return p4.create(t,...e)}function gt(t,e,...r){if(!t)throw Qv(e,...r)}function Ba(t){const e="INTERNAL ASSERTION FAILED: "+t;throw gh(e),new Error(e)}function eo(t,e){t||Ba(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dx(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Cz(){return KE()==="http:"||KE()==="https:"}function KE(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fz(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Cz()||Jj()||"connection"in navigator)?navigator.onLine:!0}function bz(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xf{constructor(e,r){this.shortDelay=e,this.longDelay=r,eo(r>e,"Short delay should be less than long delay!"),this.isMobile=Xj()||Zj()}get(){return Fz()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jv(t,e){eo(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m4{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ba("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ba("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ba("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iz={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nz=new Xf(3e4,6e4);function Zv(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function ju(t,e,r,n,i={}){return x4(t,i,async()=>{let s={},a={};n&&(e==="GET"?a=n:s={body:JSON.stringify(n)});const o=zf(Object.assign({key:t.config.apiKey},a)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:l},s);return Qj()||(u.referrerPolicy="no-referrer"),m4.fetch()(v4(t,t.config.apiHost,r,o),u)})}async function x4(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},Iz),e);try{const i=new Dz(t),s=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw K0(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,u]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw K0(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw K0(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw K0(t,"user-disabled",a);const f=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw g4(t,f,u);Za(t,f)}}catch(i){if(i instanceof so)throw i;Za(t,"network-request-failed",{message:String(i)})}}async function Rz(t,e,r,n,i={}){const s=await ju(t,e,r,n,i);return"mfaPendingCredential"in s&&Za(t,"multi-factor-auth-required",{_serverResponse:s}),s}function v4(t,e,r,n){const i=`${e}${r}?${n}`;return t.config.emulator?Jv(t.config,i):`${t.config.apiScheme}://${i}`}class Dz{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(pa(this.auth,"network-request-failed")),Nz.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function K0(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=pa(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pz(t,e){return ju(t,"POST","/v1/accounts:delete",e)}async function y4(t,e){return ju(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jd(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Oz(t,e=!1){const r=Qs(t),n=await r.getIdToken(e),i=ey(n);gt(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:jd(am(i.auth_time)),issuedAtTime:jd(am(i.iat)),expirationTime:jd(am(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function am(t){return Number(t)*1e3}function ey(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return gh("JWT malformed, contained fewer than 3 sections"),null;try{const i=Ok(r);return i?JSON.parse(i):(gh("Failed to decode base64 JWT payload"),null)}catch(i){return gh("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function YE(t){const e=ey(t);return gt(e,"internal-error"),gt(typeof e.exp<"u","internal-error"),gt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cf(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof so&&Mz(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function Mz({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bz{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Px{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=jd(this.lastLoginAt),this.creationTime=jd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gp(t){var e;const r=t.auth,n=await t.getIdToken(),i=await Cf(t,y4(r,{idToken:n}));gt(i==null?void 0:i.users.length,r,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?_4(s.providerUserInfo):[],o=jz(t.providerData,a),l=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),f=l?u:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Px(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(t,p)}async function Lz(t){const e=Qs(t);await gp(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function jz(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function _4(t){return t.map(e=>{var{providerId:r}=e,n=qv(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vz(t,e){const r=await x4(t,{},async()=>{const n=zf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=v4(t,i,"/v1/token",`key=${s}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",m4.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function Uz(t,e){return ju(t,"POST","/v2/accounts:revokeToken",Zv(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){gt(e.idToken,"internal-error"),gt(typeof e.idToken<"u","internal-error"),gt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):YE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){gt(e.length!==0,"internal-error");const r=YE(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(gt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:s}=await Vz(e,r);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new su;return n&&(gt(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(gt(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(gt(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new su,this.toJSON())}_performRefresh(){return Ba("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wo(t,e){gt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class La{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,s=qv(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Bz(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Px(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await Cf(this,this.stsTokenManager.getToken(this.auth,e));return gt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return Oz(this,e)}reload(){return Lz(this)}_assign(e){this!==e&&(gt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new La(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){gt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await gp(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Oo(this.auth.app))return Promise.reject(Vl(this.auth));const e=await this.getIdToken();return await Cf(this,Pz(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,s,a,o,l,u,f;const p=(n=r.displayName)!==null&&n!==void 0?n:void 0,g=(i=r.email)!==null&&i!==void 0?i:void 0,m=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,y=(a=r.photoURL)!==null&&a!==void 0?a:void 0,x=(o=r.tenantId)!==null&&o!==void 0?o:void 0,w=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,A=(u=r.createdAt)!==null&&u!==void 0?u:void 0,k=(f=r.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:_,emailVerified:O,isAnonymous:G,providerData:U,stsTokenManager:T}=r;gt(_&&T,e,"internal-error");const F=su.fromJSON(this.name,T);gt(typeof _=="string",e,"internal-error"),wo(p,e.name),wo(g,e.name),gt(typeof O=="boolean",e,"internal-error"),gt(typeof G=="boolean",e,"internal-error"),wo(m,e.name),wo(y,e.name),wo(x,e.name),wo(w,e.name),wo(A,e.name),wo(k,e.name);const S=new La({uid:_,auth:e,email:g,emailVerified:O,displayName:p,isAnonymous:G,photoURL:y,phoneNumber:m,tenantId:x,stsTokenManager:F,createdAt:A,lastLoginAt:k});return U&&Array.isArray(U)&&(S.providerData=U.map(I=>Object.assign({},I))),w&&(S._redirectEventId=w),S}static async _fromIdTokenResponse(e,r,n=!1){const i=new su;i.updateFromServerResponse(r);const s=new La({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await gp(s),s}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];gt(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?_4(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),o=new su;o.updateFromIdToken(n);const l=new La({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Px(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XE=new Map;function ja(t){eo(t instanceof Function,"Expected a class definition");let e=XE.get(t);return e?(eo(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,XE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E4{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}E4.type="NONE";const qE=E4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mh(t,e,r){return`firebase:${t}:${e}:${r}`}class au{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=mh(this.userKey,i.apiKey,s),this.fullPersistenceKey=mh("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?La._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new au(ja(qE),e,n);const i=(await Promise.all(r.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||ja(qE);const a=mh(n,e.config.apiKey,e.name);let o=null;for(const u of r)try{const f=await u._get(a);if(f){const p=La._fromJSON(e,f);u!==s&&(o=p),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new au(s,e,n):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async u=>{if(u!==s)try{await u._remove(a)}catch{}})),new au(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(A4(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(w4(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(C4(e))return"Blackberry";if(F4(e))return"Webos";if(S4(e))return"Safari";if((e.includes("chrome/")||T4(e))&&!e.includes("edge/"))return"Chrome";if(k4(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function w4(t=li()){return/firefox\//i.test(t)}function S4(t=li()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function T4(t=li()){return/crios\//i.test(t)}function A4(t=li()){return/iemobile/i.test(t)}function k4(t=li()){return/android/i.test(t)}function C4(t=li()){return/blackberry/i.test(t)}function F4(t=li()){return/webos/i.test(t)}function ty(t=li()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function zz(t=li()){var e;return ty(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Wz(){return e9()&&document.documentMode===10}function b4(t=li()){return ty(t)||k4(t)||F4(t)||C4(t)||/windows phone/i.test(t)||A4(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I4(t,e=[]){let r;switch(t){case"Browser":r=QE(li());break;case"Worker":r=`${QE(li())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Pu}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hz{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $z(t,e={}){return ju(t,"GET","/v2/passwordPolicy",Zv(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gz=6;class Kz{constructor(e){var r,n,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:Gz,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yz{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new JE(this),this.idTokenSubscription=new JE(this),this.beforeStateQueue=new Hz(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=p4,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=ja(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await au.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await y4(this,{idToken:e}),n=await La._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Oo(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return gt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await gp(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=bz()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Oo(this.app))return Promise.reject(Vl(this));const r=e?Qs(e):null;return r&&gt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&gt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Oo(this.app)?Promise.reject(Vl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Oo(this.app)?Promise.reject(Vl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ja(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await $z(this),r=new Kz(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Uf("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await Uz(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&ja(e)||this._popupRedirectResolver;gt(r,this,"argument-error"),this.redirectPersistenceManager=await au.create(this,[ja(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(gt(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,i);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return gt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=I4(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&kz(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function ry(t){return Qs(t)}class JE{constructor(e){this.auth=e,this.observer=null,this.addObserver=l9(r=>this.observer=r)}get next(){return gt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ny={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Xz(t){ny=t}function qz(t){return ny.loadJS(t)}function Qz(){return ny.gapiScript}function Jz(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zz(t,e){const r=yv(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),s=r.getOptions();if(np(s,e??{}))return i;Za(i,"already-initialized")}return r.initialize({options:e})}function eW(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(ja);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function tW(t,e,r){const n=ry(t);gt(n._canInitEmulator,n,"emulator-config-failed"),gt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,s=N4(e),{host:a,port:o}=rW(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${s}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),nW()}function N4(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function rW(t){const e=N4(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:ZE(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:ZE(a)}}}function ZE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function nW(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R4{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Ba("not implemented")}_getIdTokenResponse(e){return Ba("not implemented")}_linkToIdToken(e,r){return Ba("not implemented")}_getReauthenticationResolver(e){return Ba("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ou(t,e){return Rz(t,"POST","/v1/accounts:signInWithIdp",Zv(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iW="http://localhost";class rc extends R4{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new rc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Za("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,s=qv(r,["providerId","signInMethod"]);if(!n||!i)return null;const a=new rc(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return ou(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,ou(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,ou(e,r)}buildRequest(){const e={requestUri:iW,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=zf(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D4{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qf extends D4{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co extends qf{constructor(){super("facebook.com")}static credential(e){return rc._fromParams({providerId:Co.PROVIDER_ID,signInMethod:Co.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Co.credentialFromTaggedObject(e)}static credentialFromError(e){return Co.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Co.credential(e.oauthAccessToken)}catch{return null}}}Co.FACEBOOK_SIGN_IN_METHOD="facebook.com";Co.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo extends qf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return rc._fromParams({providerId:Fo.PROVIDER_ID,signInMethod:Fo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Fo.credentialFromTaggedObject(e)}static credentialFromError(e){return Fo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Fo.credential(r,n)}catch{return null}}}Fo.GOOGLE_SIGN_IN_METHOD="google.com";Fo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo extends qf{constructor(){super("github.com")}static credential(e){return rc._fromParams({providerId:bo.PROVIDER_ID,signInMethod:bo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return bo.credentialFromTaggedObject(e)}static credentialFromError(e){return bo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return bo.credential(e.oauthAccessToken)}catch{return null}}}bo.GITHUB_SIGN_IN_METHOD="github.com";bo.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io extends qf{constructor(){super("twitter.com")}static credential(e,r){return rc._fromParams({providerId:Io.PROVIDER_ID,signInMethod:Io.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Io.credentialFromTaggedObject(e)}static credentialFromError(e){return Io.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Io.credential(r,n)}catch{return null}}}Io.TWITTER_SIGN_IN_METHOD="twitter.com";Io.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const s=await La._fromIdTokenResponse(e,n,i),a=ew(n);return new ku({user:s,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=ew(n);return new ku({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function ew(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mp extends so{constructor(e,r,n,i){var s;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,mp.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new mp(e,r,n,i)}}function P4(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?mp._fromErrorAndOperation(t,s,e,n):s})}async function sW(t,e,r=!1){const n=await Cf(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return ku._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aW(t,e,r=!1){const{auth:n}=t;if(Oo(n.app))return Promise.reject(Vl(n));const i="reauthenticate";try{const s=await Cf(t,P4(n,i,e,t),r);gt(s.idToken,n,"internal-error");const a=ey(s.idToken);gt(a,n,"internal-error");const{sub:o}=a;return gt(t.uid===o,n,"user-mismatch"),ku._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Za(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oW(t,e,r=!1){if(Oo(t.app))return Promise.reject(Vl(t));const n="signIn",i=await P4(t,n,e),s=await ku._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(s.user),s}function lW(t,e,r,n){return Qs(t).onIdTokenChanged(e,r,n)}function cW(t,e,r){return Qs(t).beforeAuthStateChanged(e,r)}const xp="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O4{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(xp,"1"),this.storage.removeItem(xp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uW=1e3,dW=10;class M4 extends O4{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=b4(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);Wz()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,dW):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},uW)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}M4.type="LOCAL";const fW=M4;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B4 extends O4{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}B4.type="SESSION";const L4=B4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hW(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new ng(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:s}=r.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async u=>u(r.origin,s)),l=await hW(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ng.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iy(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pW{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const u=iy("",20);i.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(p){const g=p;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(g.data.response);break;default:clearTimeout(f),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ga(){return window}function gW(t){ga().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j4(){return typeof ga().WorkerGlobalScope<"u"&&typeof ga().importScripts=="function"}async function mW(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function xW(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function vW(){return j4()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V4="firebaseLocalStorageDb",yW=1,vp="firebaseLocalStorage",U4="fbase_key";class Qf{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function ig(t,e){return t.transaction([vp],e?"readwrite":"readonly").objectStore(vp)}function _W(){const t=indexedDB.deleteDatabase(V4);return new Qf(t).toPromise()}function Ox(){const t=indexedDB.open(V4,yW);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(vp,{keyPath:U4})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(vp)?e(n):(n.close(),await _W(),e(await Ox()))})})}async function tw(t,e,r){const n=ig(t,!0).put({[U4]:e,value:r});return new Qf(n).toPromise()}async function EW(t,e){const r=ig(t,!1).get(e),n=await new Qf(r).toPromise();return n===void 0?null:n.value}function rw(t,e){const r=ig(t,!0).delete(e);return new Qf(r).toPromise()}const wW=800,SW=3;class z4{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ox(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>SW)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return j4()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ng._getInstance(vW()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await mW(),!this.activeServiceWorker)return;this.sender=new pW(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||xW()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ox();return await tw(e,xp,"1"),await rw(e,xp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>tw(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>EW(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>rw(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=ig(i,!1).getAll();return new Qf(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),wW)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}z4.type="LOCAL";const TW=z4;new Xf(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AW(t,e){return e?ja(e):(gt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sy extends R4{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ou(e,this._buildIdpRequest())}_linkToIdToken(e,r){return ou(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return ou(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function kW(t){return oW(t.auth,new sy(t),t.bypassAuthState)}function CW(t){const{auth:e,user:r}=t;return gt(r,e,"internal-error"),aW(r,new sy(t),t.bypassAuthState)}async function FW(t){const{auth:e,user:r}=t;return gt(r,e,"internal-error"),sW(r,new sy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W4{constructor(e,r,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return kW;case"linkViaPopup":case"linkViaRedirect":return FW;case"reauthViaPopup":case"reauthViaRedirect":return CW;default:Za(this.auth,"internal-error")}}resolve(e){eo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){eo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bW=new Xf(2e3,1e4);class Kc extends W4{constructor(e,r,n,i,s){super(e,r,i,s),this.provider=n,this.authWindow=null,this.pollId=null,Kc.currentPopupAction&&Kc.currentPopupAction.cancel(),Kc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return gt(e,this.auth,"internal-error"),e}async onExecution(){eo(this.filter.length===1,"Popup operations only handle one event");const e=iy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(pa(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(pa(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Kc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(pa(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,bW.get())};e()}}Kc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IW="pendingRedirect",xh=new Map;class NW extends W4{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=xh.get(this.auth._key());if(!e){try{const n=await RW(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}xh.set(this.auth._key(),e)}return this.bypassAuthState||xh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function RW(t,e){const r=OW(e),n=PW(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function DW(t,e){xh.set(t._key(),e)}function PW(t){return ja(t._redirectPersistence)}function OW(t){return mh(IW,t.config.apiKey,t.name)}async function MW(t,e,r=!1){if(Oo(t.app))return Promise.reject(Vl(t));const n=ry(t),i=AW(n,e),a=await new NW(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BW=10*60*1e3;class LW{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!jW(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!H4(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(pa(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=BW&&this.cachedEventUids.clear(),this.cachedEventUids.has(nw(e))}saveEventToCache(e){this.cachedEventUids.add(nw(e)),this.lastProcessedEventTime=Date.now()}}function nw(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function H4({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function jW(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return H4(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VW(t,e={}){return ju(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UW=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,zW=/^https?/;async function WW(t){if(t.config.emulator)return;const{authorizedDomains:e}=await VW(t);for(const r of e)try{if(HW(r))return}catch{}Za(t,"unauthorized-domain")}function HW(t){const e=Dx(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!zW.test(r))return!1;if(UW.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $W=new Xf(3e4,6e4);function iw(){const t=ga().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function GW(t){return new Promise((e,r)=>{var n,i,s;function a(){iw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{iw(),r(pa(t,"network-request-failed"))},timeout:$W.get()})}if(!((i=(n=ga().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=ga().gapi)===null||s===void 0)&&s.load)a();else{const o=Jz("iframefcb");return ga()[o]=()=>{gapi.load?a():r(pa(t,"network-request-failed"))},qz(`${Qz()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw vh=null,e})}let vh=null;function KW(t){return vh=vh||GW(t),vh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YW=new Xf(5e3,15e3),XW="__/auth/iframe",qW="emulator/auth/iframe",QW={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},JW=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ZW(t){const e=t.config;gt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Jv(e,qW):`https://${t.config.authDomain}/${XW}`,n={apiKey:e.apiKey,appName:t.name,v:Pu},i=JW.get(t.config.apiHost);i&&(n.eid=i);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${zf(n).slice(1)}`}async function eH(t){const e=await KW(t),r=ga().gapi;return gt(r,t,"internal-error"),e.open({where:document.body,url:ZW(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:QW,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const a=pa(t,"network-request-failed"),o=ga().setTimeout(()=>{s(a)},YW.get());function l(){ga().clearTimeout(o),i(n)}n.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tH={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},rH=500,nH=600,iH="_blank",sH="http://localhost";class sw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function aH(t,e,r,n=rH,i=nH){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},tH),{width:n.toString(),height:i.toString(),top:s,left:a}),u=li().toLowerCase();r&&(o=T4(u)?iH:r),w4(u)&&(e=e||sH,l.scrollbars="yes");const f=Object.entries(l).reduce((g,[m,y])=>`${g}${m}=${y},`,"");if(zz(u)&&o!=="_self")return oH(e||"",o),new sw(null);const p=window.open(e||"",o,f);gt(p,t,"popup-blocked");try{p.focus()}catch{}return new sw(p)}function oH(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lH="__/auth/handler",cH="emulator/auth/handler",uH=encodeURIComponent("fac");async function aw(t,e,r,n,i,s){gt(t.config.authDomain,t,"auth-domain-config-required"),gt(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Pu,eventId:i};if(e instanceof D4){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",o9(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))a[f]=p}if(e instanceof qf){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const f of Object.keys(o))o[f]===void 0&&delete o[f];const l=await t._getAppCheckToken(),u=l?`#${uH}=${encodeURIComponent(l)}`:"";return`${dH(t)}?${zf(o).slice(1)}${u}`}function dH({config:t}){return t.emulator?Jv(t,cH):`https://${t.authDomain}/${lH}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const om="webStorageSupport";class fH{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=L4,this._completeRedirectFn=MW,this._overrideRedirectResult=DW}async _openPopup(e,r,n,i){var s;eo((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await aw(e,r,n,Dx(),i);return aH(e,a,iy())}async _openRedirect(e,r,n,i){await this._originValidation(e);const s=await aw(e,r,n,Dx(),i);return gW(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:s}=this.eventManagers[r];return i?Promise.resolve(i):(eo(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await eH(e),n=new LW(e);return r.register("authEvent",i=>(gt(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(om,{type:om},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[om];a!==void 0&&r(!!a),Za(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=WW(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return b4()||S4()||ty()}}const hH=fH;var ow="@firebase/auth",lw="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pH{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){gt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gH(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function mH(t){vu(new Jl("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;gt(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:I4(t)},u=new Yz(n,i,s,l);return eW(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),vu(new Jl("auth-internal",e=>{const r=ry(e.getProvider("auth").getImmediate());return(n=>new pH(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ko(ow,lw,gH(t)),Ko(ow,lw,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xH=5*60,vH=Lk("authIdTokenMaxAge")||xH;let cw=null;const yH=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>vH)return;const i=r==null?void 0:r.token;cw!==i&&(cw=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function _H(t=zk()){const e=yv(t,"auth");if(e.isInitialized())return e.getImmediate();const r=Zz(t,{popupRedirectResolver:hH,persistence:[TW,fW,L4]}),n=Lk("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const a=yH(s.toString());cW(r,a,()=>a(r.currentUser)),lW(r,o=>a(o))}}const i=Mk("auth");return i&&tW(r,`http://${i}`),r}function EH(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}Xz({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const s=pa("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",EH().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});mH("Browser");const wH={apiKey:"AIzaSyAZZ0804o11q-hS6p7XJZNK_FPGJgXpmPc",authDomain:"finance-automation-b28e8.firebaseapp.com",projectId:"finance-automation-b28e8",storageBucket:"finance-automation-b28e8.firebasestorage.app",messagingSenderId:"832501526859",appId:"1:832501526859:web:3a64f40f9db732af1b78ce"},$4=Uk(wH),ay=sz($4);_H($4);const lm=async(t,e)=>{try{return await wz(Hv(ay,"appState",t),{masterData:e.masterData||[],ledgerEntries:e.ledgerEntries||[],receipts:e.receipts||[],creditNotes:e.creditNotes||[],openingBalances:e.openingBalances||{},mailerImages:e.mailerImages||{},mailerLogo:e.mailerLogo||null,companyConfig:e.companyConfig||{},nextInvoiceNo:e.nextInvoiceNo||1,nextCombineNo:e.nextCombineNo||1,nextReceiptNo:e.nextReceiptNo||1,nextCreditNoteNo:e.nextCreditNoteNo||1,invoiceValues:e.invoiceValues||{},notifications:e.notifications||[],whatsappSettings:e.whatsappSettings||{},partyMaster:e.partyMaster||[],followups:e.followups||[],updatedAt:new Date().toISOString()}),!0}catch(r){return console.error("Error saving app state:",r),!1}},uw=async t=>{try{const e=await Ez(Hv(ay,"appState",t));return e.exists()?e.data():null}catch(e){return console.error("Error loading app state:",e),null}},SH=(t,e)=>{const r=Hv(ay,"appState",t);return Sz(r,n=>{n.exists()&&e(n.data())},n=>{console.error("Error in real-time listener:",n)})},tt=t=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2,maximumFractionDigits:2}).format(t||0),jt=t=>""+new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t||0),Ft=t=>{if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return t;const r=e.getDate().toString().padStart(2,"0"),n=e.toLocaleString("en-US",{month:"short"}),i=e.getFullYear();return`${r}-${n}-${i}`},TH=t=>{if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return t;const r=e.getDate(),n=e.toLocaleString("en-US",{month:"short"}),i=e.getFullYear();return`${r}${(a=>{if(a>3&&a<21)return"th";switch(a%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}})(r)} ${n}, ${i}`},Y0=t=>{const e=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],r=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];if(t===0)return"Zero";const n=l=>l<20?e[l]:l<100?r[Math.floor(l/10)]+(l%10?" "+e[l%10]:""):e[Math.floor(l/100)]+" Hundred"+(l%100?" "+n(l%100):""),i=l=>l<1e3?n(l):l<1e5?n(Math.floor(l/1e3))+" Thousand"+(l%1e3?" "+n(l%1e3):""):l<1e7?n(Math.floor(l/1e5))+" Lakh"+(l%1e5?" "+i(l%1e5):""):n(Math.floor(l/1e7))+" Crore"+(l%1e7?" "+i(l%1e7):""),s=Math.floor(t),a=Math.round((t-s)*100);let o="INR "+i(s);return a>0&&(o+=" and "+i(a)+" Paise"),o+" Only"},dw=t=>{if(!t)return"";const e=/[\w.-]+@[\w.-]+\.\w+/g,r=t.match(e);return r?r[0]:""},AH=t=>({Approved:{bg:"#DCFCE7",text:"#166534",border:"#86EFAC"},Created:{bg:"#DBEAFE",text:"#1E40AF",border:"#93C5FD"},"Need Edits":{bg:"#FEE2E2",text:"#991B1B",border:"#FCA5A5"},Paid:{bg:"#D1FAE5",text:"#065F46",border:"#6EE7B7"},Individual:{bg:"#E0E7FF",text:"#3730A3",border:"#A5B4FC"},Combined:{bg:"#F3E8FF",text:"#6B21A8",border:"#DDD6FE"},Yes:{bg:"#DCFCE7",text:"#166534",border:"#86EFAC"},No:{bg:"#FEF3C7",text:"#92400E",border:"#FCD34D"},"Not Yet":{bg:"#F1F5F9",text:"#475569",border:"#CBD5E1"},Pending:{bg:"#FEF3C7",text:"#92400E",border:"#FCD34D"},Sent:{bg:"#D1FAE5",text:"#065F46",border:"#6EE7B7"}})[t]||{bg:"#F1F5F9",text:"#475569",border:"#CBD5E1"},X0=({status:t,small:e=!1})=>{const r=AH(t);return c.jsx("span",{style:{display:"inline-flex",alignItems:"center",padding:e?"2px 8px":"4px 12px",borderRadius:"6px",fontSize:e?"11px":"12px",fontWeight:"600",backgroundColor:r.bg,color:r.text,border:`1px solid ${r.border}`},children:t})},qe=({icon:t,label:e,onClick:r,variant:n="default",disabled:i=!1,small:s=!1})=>{const a={default:{bg:"#F8FAFC",hoverBg:"#E2E8F0",text:"#475569",border:"#CBD5E1"},primary:{bg:"#2874A6",hoverBg:"#1a5276",text:"#FFFFFF",border:"#2874A6"},success:{bg:"#059669",hoverBg:"#047857",text:"#FFFFFF",border:"#059669"},warning:{bg:"#D97706",hoverBg:"#B45309",text:"#FFFFFF",border:"#D97706"},danger:{bg:"#DC2626",hoverBg:"#B91C1C",text:"#FFFFFF",border:"#DC2626"},brand:{bg:"#2874A6",hoverBg:"#1a5276",text:"#FFFFFF",border:"#2874A6"},purple:{bg:"#7C3AED",hoverBg:"#6D28D9",text:"#FFFFFF",border:"#7C3AED"},secondary:{bg:"#F1F5F9",hoverBg:"#E2E8F0",text:"#475569",border:"#CBD5E1"}},o=a[n]||a.default;return c.jsxs("button",{onClick:r,disabled:i,title:e,style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:s?"5px 10px":"8px 14px",borderRadius:"6px",fontSize:s?"11px":"13px",fontWeight:"600",backgroundColor:i?"#F1F5F9":o.bg,color:i?"#94A3B8":o.text,border:`1px solid ${i?"#E2E8F0":o.border}`,cursor:i?"not-allowed":"pointer",transition:"all 0.15s ease",whiteSpace:"nowrap",opacity:i?.6:1},onMouseEnter:l=>!i&&(l.target.style.backgroundColor=o.hoverBg),onMouseLeave:l=>!i&&(l.target.style.backgroundColor=o.bg),children:[t&&c.jsx(t,{size:s?14:16}),e&&c.jsx("span",{children:e})]})},Er=({label:t,type:e="text",value:r,onChange:n,placeholder:i,disabled:s,small:a})=>c.jsxs("div",{style:{marginBottom:a?"12px":"16px"},children:[t&&c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:t}),c.jsx("input",{type:e,value:r,onChange:n,placeholder:i,disabled:s,style:{width:"100%",padding:a?"8px 12px":"10px 14px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:a?"13px":"14px",backgroundColor:s?"#F9FAFB":"#FFFFFF",boxSizing:"border-box"}})]}),q0=({label:t,value:e,onChange:r,options:n,small:i})=>c.jsxs("div",{style:{marginBottom:i?"12px":"16px"},children:[t&&c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:t}),c.jsx("select",{value:e,onChange:r,style:{width:"100%",padding:i?"8px 12px":"10px 14px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:i?"13px":"14px",backgroundColor:"#FFFFFF",boxSizing:"border-box"},children:n.map(s=>c.jsx("option",{value:s.value,children:s.label},s.value))})]}),Xr=({title:t,children:e,actions:r,noPadding:n=!1})=>c.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",boxShadow:"0 2px 8px rgba(0,0,0,0.06)",overflow:"hidden"},children:[t&&c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"14px 20px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FAFBFC"},children:[c.jsx("h3",{style:{margin:0,fontSize:"15px",fontWeight:"700",color:"#1E293B"},children:t}),r&&c.jsx("div",{style:{display:"flex",gap:"10px"},children:r})]}),c.jsx("div",{style:{padding:n?0:"20px"},children:e})]}),wn=({isOpen:t,onClose:e,title:r,children:n,width:i="500px"})=>t?c.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(15, 23, 42, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(4px)"},onClick:e,children:c.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"16px",width:i,maxWidth:"95vw",maxHeight:"90vh",overflow:"hidden",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},onClick:s=>s.stopPropagation(),children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FAFBFC"},children:[c.jsx("h2",{style:{margin:0,fontSize:"16px",fontWeight:"700",color:"#1E293B"},children:r}),c.jsx("button",{onClick:e,style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748B"},children:c.jsx(Na,{size:20})})]}),c.jsx("div",{style:{padding:"20px",maxHeight:"calc(90vh - 100px)",overflowY:"auto"},children:n})]})}):null;function kH(){const[t,e]=ve.useState(()=>{const h=localStorage.getItem("financeAppLogin");return h?JSON.parse(h).isLoggedIn:!1}),[r,n]=ve.useState(()=>{const h=localStorage.getItem("financeAppLogin");return h?JSON.parse(h).userRole:null}),[i,s]=ve.useState({username:"",password:""}),[a,o]=ve.useState(""),[l,u]=ve.useState(!1),[f,p]=ve.useState(!1),[g,m]=ve.useState(null),[y,x]=ve.useState({finance:"finance123",director:"director123"}),[w,A]=ve.useState(!1),[k,_]=ve.useState(!1),[O,G]=ve.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[U,T]=ve.useState(""),F={finance:{role:"finance",name:"Finance Team"},director:{role:"director",name:"Director"}};ve.useEffect(()=>{(async()=>{try{const E=await uw("indreesh-media");E&&E.userPasswords&&(x(E.userPasswords),console.log("Passwords loaded from Firebase"))}catch(E){console.error("Error loading passwords:",E)}A(!0)})()},[]);const[S,I]=ve.useState({name:"Indreesh Media LLP",brand:"JAC",address:"A-1701 Sweet Home CHS LTD, SVP, Plot No: 24",addressLine2:"Andheri West, Nr Last Bus St",city:"Mumbai-400053",gstin:"27AAIFI6351A1ZM",stateCode:"27",stateName:"Maharashtra",email:"alliances@mediabrief.com",phone:"+91 7021911036",website:"www.mediabrief.com",pan:"AAIFI6351A",bank:{name:"Axis Bank",account:"921020009075531",branch:"Andheri",ifsc:"UTIB0000020",holder:"Indreesh Media LLP"},invoicePrefix:"MB/2025-26/",hsnCode:"998365",gstRate:18}),[R,D]=ve.useState("master"),[N,Ge]=ve.useState(!1),[_e,Re]=ve.useState([]),[Me,Se]=ve.useState([]),[te,Ce]=ve.useState([]),[je,W]=ve.useState([]),[re,ee]=ve.useState([]),[Y,xe]=ve.useState(null),[Ee,Le]=ve.useState(null),[Fe,Ae]=ve.useState(1),[it,q]=ve.useState(1),[Pt,Et]=ve.useState(1),[Nt,xt]=ve.useState(1),[Ke,ir]=ve.useState(1),[bn,en]=ve.useState(!1),[wi,rs]=ve.useState(!1),[Si,Lr]=ve.useState(!1),[Ti,qt]=ve.useState(!1),[Sr,dr]=ve.useState(!1),[ui,pt]=ve.useState(!1),[fr,hr]=ve.useState(!1),[yr,di]=ve.useState(!1),[ao,oo]=ve.useState(!1),[Vu,Fs]=ve.useState(!1),[dl,bs]=ve.useState(!1),[ce,Rr]=ve.useState(null),[Ai,ns]=ve.useState("reply"),[_a,Js]=ve.useState(""),[Zs,ki]=ve.useState(""),[tn,Gr]=ve.useState({fromDate:"2020-01-01",toDate:new Date().toISOString().split("T")[0]}),[Ea,Is]=ve.useState(""),[rn,hc]=ve.useState("open"),[Ns,b]=ve.useState("open"),[H,B]=ve.useState(!1),[L,K]=ve.useState(null),[X,de]=ve.useState(new Set),[pe,ue]=ve.useState({party:"",billStatus:"",invoiceStatus:""}),[ae,fe]=ve.useState({party:"",invoiceNo:"",dateFrom:"",dateTo:""}),[we,Ue]=ve.useState({party:"",invoiceStatus:"",receiptStatus:"",invoiceType:"",searchText:""}),[Ye,Ne]=ve.useState([]),[Xe,dt]=ve.useState(!1),[Ot,Mt]=ve.useState([]),[cr,Ci]=ve.useState(!1),[sr,is]=ve.useState(null),[Tr,ss]=ve.useState({date:new Date().toISOString().split("T")[0],notes:"",nextFollowupDate:"",status:"Pending"}),[lt,Rs]=ve.useState({enabled:!1,financePhone:"",financeApiKey:"",directorPhone:"",directorApiKey:""}),[Bt,Fi]=ve.useState({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),[nn,wa]=ve.useState({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]}),[Sa,ea]=ve.useState({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1}),[pc,Ds]=ve.useState(null),[sn,ta]=ve.useState(new Set),[In,lo]=ve.useState({}),[Lt,Ta]=ve.useState(null),[as,os]=ve.useState(null),[Uu,fl]=ve.useState(!1),[fi,gc]=ve.useState({}),[bi,mc]=ve.useState({partyName:"",amount:"",type:"Dr"}),[hi,ls]=ve.useState({}),[an,hl]=ve.useState({}),[Jf,Ps]=ve.useState(!1),[Zf,zu]=ve.useState(new Set),[vt,Ii]=ve.useState({party:"",billStatus:"",invoiceStatus:"",mailingStatus:"",invoiceType:"",combinationCode:"",searchText:""}),[_r,co]=ve.useState({amount:"",date:new Date().toISOString().split("T")[0],mode:"Bank",tds:"",discount:"",narration:""}),pl=ve.useRef(null),gl=ve.useRef(null),Wu=ve.useRef(null),Aa=ve.useRef(null),uo=ve.useRef(null),Hu=ve.useRef(null),xc=ve.useRef(null),ar=ve.useRef(null),e0=ve.useRef(null),t0=ve.useRef(null),on=ve.useMemo(()=>Array.isArray(_e)?_e:[],[_e]),Ui=ve.useMemo(()=>Array.isArray(Me)?Me:[],[Me]),zn=ve.useMemo(()=>Array.isArray(te)?te:[],[te]),Ni=ve.useMemo(()=>Array.isArray(je)?je:[],[je]),cs=ve.useMemo(()=>Array.isArray(re)?re:[],[re]),us=ve.useMemo(()=>Array.isArray(Ye)?Ye:[],[Ye]),ml=ve.useMemo(()=>Array.isArray(Ot)?Ot:[],[Ot]),Kr=ve.useMemo(()=>an&&typeof an=="object"&&!Array.isArray(an)?an:{},[an]),ds=ve.useMemo(()=>fi&&typeof fi=="object"&&!Array.isArray(fi)?fi:{},[fi]),Gt=(h,E)=>!h||!E?!1:h.trim().toUpperCase()===E.trim().toUpperCase(),pi=ve.useCallback(h=>{if(!h)return"";const E=h.toUpperCase().trim();return E.includes("MAHARASHTRA")||E==="MH"?"MAHARASHTRA":E.includes("DELHI")||E==="DL"||E.includes("NEW DELHI")?"DELHI":E.includes("KARNATAKA")||E==="KA"||E.includes("BANGALORE")||E.includes("BENGALURU")?"KARNATAKA":E.includes("TAMIL")||E==="TN"||E.includes("CHENNAI")?"TAMIL NADU":E.includes("TELANGANA")||E==="TG"||E==="TS"||E.includes("HYDERABAD")?"TELANGANA":E.includes("UTTAR PRADESH")||E==="UP"||E.includes("NOIDA")||E.includes("LUCKNOW")?"UTTAR PRADESH":E.includes("WEST BENGAL")||E==="WB"||E.includes("KOLKATA")?"WEST BENGAL":E.includes("GUJARAT")||E==="GJ"||E.includes("AHMEDABAD")?"GUJARAT":E.includes("RAJASTHAN")||E==="RJ"||E.includes("JAIPUR")?"RAJASTHAN":E.includes("PUNJAB")||E==="PB"?"PUNJAB":E.includes("HARYANA")||E==="HR"||E.includes("GURGAON")||E.includes("GURUGRAM")?"HARYANA":E.includes("MADHYA PRADESH")||E==="MP"||E.includes("BHOPAL")?"MADHYA PRADESH":E.includes("ANDHRA")||E==="AP"?"ANDHRA PRADESH":E.includes("KERALA")||E==="KL"?"KERALA":E.includes("ODISHA")||E.includes("ORISSA")||E==="OR"||E==="OD"?"ODISHA":E.includes("BIHAR")||E==="BR"?"BIHAR":E.includes("JHARKHAND")||E==="JH"?"JHARKHAND":E.includes("ASSAM")||E==="AS"?"ASSAM":E.includes("CHHATTISGARH")||E==="CG"?"CHHATTISGARH":E.includes("GOA")||E==="GA"?"GOA":E.includes("HIMACHAL")||E==="HP"?"HIMACHAL PRADESH":E.includes("JAMMU")||E==="JK"?"JAMMU AND KASHMIR":E.includes("UTTARAKHAND")||E.includes("UTTARANCHAL")||E==="UK"?"UTTARAKHAND":E.includes("MUMBAI")?"MAHARASHTRA":E.includes("CHANDIGARH")?"CHANDIGARH":E},[]),fo=ve.useCallback((h,E)=>{var P;if(!h)return"";const z=pi(E),Q=h.trim().toUpperCase(),j=`${Q}|${z}`;if((P=Kr[j])!=null&&P.gstin)return Kr[j].gstin;for(const ne in Kr){const V=Kr[ne];if((V.partyName||"").trim().toUpperCase()===Q&&V.normalizedState===z)return V.gstin||""}for(const ne in Kr){const V=Kr[ne];if((V.partyName||"").trim().toUpperCase()===Q&&V.gstin)return V.gstin}return""},[Kr,pi]),xl=ve.useCallback((h,E)=>{var P;if(!h)return"";const z=pi(E),Q=h.trim().toUpperCase(),j=`${Q}|${z}`;if((P=Kr[j])!=null&&P.address)return Kr[j].address;for(const ne in Kr){const V=Kr[ne];if((V.partyName||"").trim().toUpperCase()===Q&&V.normalizedState===z)return V.address||""}for(const ne in Kr){const V=Kr[ne];if((V.partyName||"").trim().toUpperCase()===Q&&V.address)return V.address}return""},[Kr,pi]),ka=ve.useRef(!1),Ca=ve.useRef(null),$u=async()=>{u(!0);try{const h=await uw("indreesh-media");h&&(Array.isArray(h.masterData)&&Re(h.masterData),Array.isArray(h.servicesData)&&Se(h.servicesData),Array.isArray(h.ledgerEntries)&&Ce(h.ledgerEntries),Array.isArray(h.receipts)&&W(h.receipts),Array.isArray(h.creditNotes)&&ee(h.creditNotes),Array.isArray(h.notifications)&&Ne(h.notifications),Array.isArray(h.followups)&&Mt(h.followups),h.openingBalances&&typeof h.openingBalances=="object"&&!Array.isArray(h.openingBalances)&&gc(h.openingBalances),h.mailerImages&&typeof h.mailerImages=="object"&&!Array.isArray(h.mailerImages)&&lo(h.mailerImages),h.partyMaster&&typeof h.partyMaster=="object"&&!Array.isArray(h.partyMaster)&&hl(h.partyMaster),h.userPasswords&&typeof h.userPasswords=="object"&&!Array.isArray(h.userPasswords)&&x(h.userPasswords),h.mailerLogo&&Ta(h.mailerLogo),h.companyConfig&&I(E=>({...E,...h.companyConfig,name:"Indreesh Media LLP",bank:{...h.companyConfig.bank||E.bank,holder:"Indreesh Media LLP"}})),h.nextInvoiceNo&&Ae(h.nextInvoiceNo),h.nextCombineNo&&q(h.nextCombineNo),h.nextReceiptNo&&Et(h.nextReceiptNo),h.nextCreditNoteNo&&xt(h.nextCreditNoteNo),h.nextServiceInvoiceNo&&ir(h.nextServiceInvoiceNo),h.invoiceValues&&ls(h.invoiceValues),h.whatsappSettings&&Rs(E=>({...E,...h.whatsappSettings})),console.log("Data loaded from Firebase"))}catch(h){console.error("Error loading data:",h)}u(!1)},ho=ve.useCallback(async()=>{p(!0);try{await lm("indreesh-media",{masterData:_e,servicesData:Me,ledgerEntries:te,receipts:je,creditNotes:re,openingBalances:fi,mailerImages:In,mailerLogo:Lt,companyConfig:S,nextInvoiceNo:Fe,nextCombineNo:it,nextReceiptNo:Pt,nextCreditNoteNo:Nt,nextServiceInvoiceNo:Ke,invoiceValues:hi,notifications:Ye,whatsappSettings:lt,partyMaster:an,followups:Ot,userPasswords:y}),m(new Date),console.log("Data saved to Firebase")}catch(h){console.error("Error saving data:",h)}p(!1)},[_e,Me,te,je,re,fi,In,Lt,S,Fe,it,Pt,Nt,Ke,hi,Ye,lt,an,Ot,y]);ve.useEffect(()=>{if(t&&!ka.current)return ar.current&&clearTimeout(ar.current),ar.current=setTimeout(()=>{ka.current||ho()},1e3),()=>{ar.current&&clearTimeout(ar.current)}},[_e,Me,te,je,re,fi,In,Lt,S,Fe,it,Pt,Nt,Ke,hi,Ye,lt,an,Ot,y,t]);const r0=async(h,E,z)=>{if(!lt.enabled){console.log("WhatsApp notifications not enabled");return}z==="finance"&&lt.financePhone&&lt.financeApiKey?po(lt.financePhone,lt.financeApiKey,h,E):z==="director"&&lt.directorPhone&&lt.directorApiKey?po(lt.directorPhone,lt.directorApiKey,h,E):z==="all"&&(lt.financePhone&&lt.financeApiKey&&po(lt.financePhone,lt.financeApiKey,h,E),lt.directorPhone&&lt.directorApiKey&&po(lt.directorPhone,lt.directorApiKey,h,E))},po=async(h,E,z,Q)=>{try{const P=`*${{upload:" DATA UPLOAD",invoice:" INVOICE",approval:" APPROVED",edit:" EDIT REQUIRED",receipt:" PAYMENT",info:" UPDATE"}[z]||" NOTIFICATION"}*

${Q}

_${S.name}_
_${new Date().toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})}_`,ne=`https://api.callmebot.com/whatsapp.php?phone=${h}&text=${encodeURIComponent(P)}&apikey=${E}`;fetch(ne,{mode:"no-cors"}).then(()=>console.log("WhatsApp notification sent to:",h)).catch(V=>console.log("WhatsApp send attempted:",h))}catch(j){console.error("Failed to send WhatsApp notification:",j)}},vc=(h,E)=>{if(!h||!E){alert("Please enter phone number and API key first");return}po(h,E,"info","Test notification from Indreesh Media LLP. WhatsApp notifications are working!"),alert("Test message sent! Check your WhatsApp.")},Wn=(h,E,z="all")=>{const Q={id:Date.now()+Math.random(),type:h,message:E,forRole:z,createdAt:new Date().toISOString(),createdBy:r,read:{finance:!1,director:!1}};Ne(j=>[Q,...j].slice(0,50)),r0(h,E,z)},n0=h=>{Ne(E=>(Array.isArray(E)?E:[]).map(Q=>Q.id===h?{...Q,read:{...Q.read,[r]:!0}}:Q))},yc=()=>{Ne(h=>(Array.isArray(h)?h:[]).map(z=>({...z,read:{...z.read,[r]:!0}})))},i0=()=>{Ne([])},vl=ve.useMemo(()=>us.filter(h=>h.forRole==="all"||h.forRole===r||h.createdBy!==r).map(h=>({...h,read:h.read||{finance:!1,director:!1}})),[us,r]),Nn=ve.useMemo(()=>r?vl.filter(h=>!(h.read&&h.read[r])).length:0,[vl,r]),Gu=async()=>{const h=F[i.username.toLowerCase()],E=y[i.username.toLowerCase()];h&&E===i.password?(e(!0),n(h.role),localStorage.setItem("financeAppLogin",JSON.stringify({isLoggedIn:!0,userRole:h.role})),o(""),s({username:"",password:""}),await $u()):o("Invalid username or password")},_c=async()=>{if(!O.currentPassword||!O.newPassword||!O.confirmPassword){T("Please fill all fields");return}const h=r==="director"?"director":"finance";if(y[h]!==O.currentPassword){T("Current password is incorrect");return}if(O.newPassword!==O.confirmPassword){T("New passwords do not match");return}if(O.newPassword.length<6){T("Password must be at least 6 characters");return}const E={...y,[h]:O.newPassword};x(E);try{await lm("indreesh-media",{masterData:_e,ledgerEntries:te,receipts:je,creditNotes:re,openingBalances:fi,mailerImages:In,mailerLogo:Lt,companyConfig:S,nextInvoiceNo:Fe,nextCombineNo:it,nextReceiptNo:Pt,nextCreditNoteNo:Nt,invoiceValues:hi,notifications:Ye,whatsappSettings:lt,partyMaster:an,followups:Ot,userPasswords:E}),console.log("Password saved to Firebase")}catch(z){console.error("Error saving password:",z),T("Failed to save password. Please try again.");return}_(!1),G({currentPassword:"",newPassword:"",confirmPassword:""}),T(""),alert(" Password changed successfully!")},s0=()=>{ho(),e(!1),n(null),D("master"),localStorage.removeItem("financeAppLogin")};ve.useEffect(()=>{const h=localStorage.getItem("financeAppLogin");if(h){const{isLoggedIn:E}=JSON.parse(h);E&&$u()}},[]),ve.useEffect(()=>{if(!t){Ca.current&&(Ca.current(),Ca.current=null);return}return Ca.current=SH("indreesh-media",h=>{h&&(ka.current=!0,Array.isArray(h.masterData)&&Re(h.masterData),Array.isArray(h.servicesData)&&Se(h.servicesData),Array.isArray(h.ledgerEntries)&&Ce(h.ledgerEntries),Array.isArray(h.receipts)&&W(h.receipts),Array.isArray(h.creditNotes)&&ee(h.creditNotes),Array.isArray(h.notifications)&&Ne(h.notifications),Array.isArray(h.followups)&&Mt(h.followups),h.openingBalances&&typeof h.openingBalances=="object"&&!Array.isArray(h.openingBalances)&&gc(h.openingBalances),h.mailerImages&&typeof h.mailerImages=="object"&&!Array.isArray(h.mailerImages)&&lo(h.mailerImages),h.partyMaster&&typeof h.partyMaster=="object"&&!Array.isArray(h.partyMaster)&&hl(h.partyMaster),h.userPasswords&&typeof h.userPasswords=="object"&&!Array.isArray(h.userPasswords)&&x(h.userPasswords),h.mailerLogo&&Ta(h.mailerLogo),h.companyConfig&&I(E=>({...E,...h.companyConfig,name:"Indreesh Media LLP",bank:{...h.companyConfig.bank||E.bank,holder:"Indreesh Media LLP"}})),h.nextInvoiceNo&&Ae(h.nextInvoiceNo),h.nextCombineNo&&q(h.nextCombineNo),h.nextReceiptNo&&Et(h.nextReceiptNo),h.nextCreditNoteNo&&xt(h.nextCreditNoteNo),h.nextServiceInvoiceNo&&ir(h.nextServiceInvoiceNo),h.invoiceValues&&ls(h.invoiceValues),h.whatsappSettings&&Rs(E=>({...E,...h.whatsappSettings})),setTimeout(()=>{ka.current=!1},500),console.log("Real-time sync: Data updated from Firebase"))}),()=>{Ca.current&&(Ca.current(),Ca.current=null)}},[t]);const lr=r==="finance",xn=r==="director",vn=ve.useMemo(()=>{const h=new Set;return on.forEach(E=>{E.partyName&&h.add(E.partyName)}),Object.values(Kr).forEach(E=>{E.partyName&&h.add(E.partyName)}),zn.forEach(E=>{E.partyName&&h.add(E.partyName)}),Object.keys(ds).forEach(E=>{E&&h.add(E)}),Array.from(h).filter(Boolean).sort()},[on,Kr,zn,ds]),zi=ve.useMemo(()=>{const h=[],E=new Set,z=new Set,Q=j=>{if(!j)return"";const P=j.toUpperCase().trim();return P.includes("MAHARASHTRA")||P==="MH"||P.includes("MUMBAI")?"MAHARASHTRA":P.includes("DELHI")||P==="DL"||P.includes("NEW DELHI")?"DELHI":P.includes("KARNATAKA")||P==="KA"||P.includes("BANGALORE")||P.includes("BENGALURU")?"KARNATAKA":P.includes("TAMIL")||P==="TN"||P.includes("CHENNAI")?"TAMIL NADU":P.includes("TELANGANA")||P==="TG"||P==="TS"||P.includes("HYDERABAD")?"TELANGANA":P.includes("UTTAR PRADESH")||P==="UP"||P.includes("NOIDA")||P.includes("LUCKNOW")?"UTTAR PRADESH":P.includes("WEST BENGAL")||P==="WB"||P.includes("KOLKATA")?"WEST BENGAL":P.includes("GUJARAT")||P==="GJ"||P.includes("AHMEDABAD")?"GUJARAT":P.includes("RAJASTHAN")||P==="RJ"||P.includes("JAIPUR")?"RAJASTHAN":P.includes("PUNJAB")||P==="PB"?"PUNJAB":P.includes("HARYANA")||P==="HR"||P.includes("GURGAON")||P.includes("GURUGRAM")?"HARYANA":P.includes("MADHYA PRADESH")||P==="MP"||P.includes("BHOPAL")?"MADHYA PRADESH":P.includes("ANDHRA")||P==="AP"?"ANDHRA PRADESH":P.includes("KERALA")||P==="KL"?"KERALA":P.includes("ODISHA")||P.includes("ORISSA")||P==="OR"||P==="OD"?"ODISHA":P.includes("BIHAR")||P==="BR"?"BIHAR":P.includes("JHARKHAND")||P==="JH"?"JHARKHAND":P.includes("ASSAM")||P==="AS"?"ASSAM":P.includes("CHHATTISGARH")||P==="CG"?"CHHATTISGARH":P.includes("GOA")||P==="GA"?"GOA":P.includes("HIMACHAL")||P==="HP"?"HIMACHAL PRADESH":P.includes("JAMMU")||P==="JK"?"JAMMU AND KASHMIR":P.includes("UTTARAKHAND")||P.includes("UTTARANCHAL")||P==="UK"?"UTTARAKHAND":P.includes("CHANDIGARH")?"CHANDIGARH":P};return Object.entries(Kr).forEach(([j,P])=>{if(P.partyName){const ne=P.normalizedState||Q(P.stateName),V=P.partyName.trim().toUpperCase(),he=`${V}|${ne}`;E.has(he)||(E.add(he),z.add(V),h.push({partyName:P.partyName,partyNameUpper:V,state:P.stateName||"",normalizedState:ne,gstin:P.gstin||"",address:P.address||"",fromPartyMaster:!0}))}}),on.forEach(j=>{if(j.partyName){const P=j.partyName.trim().toUpperCase(),ne=Q(j.statePartyDetails),V=`${P}|${ne}`;E.has(V)||(E.add(V),z.add(P),h.push({partyName:j.partyName,partyNameUpper:P,state:j.statePartyDetails||"",normalizedState:ne,gstin:"",address:"",fromPartyMaster:!1}))}}),zn.forEach(j=>{if(j.partyName){const P=j.partyName.trim().toUpperCase(),ne=Q(j.state||j.statePartyDetails||""),V=`${P}|${ne}`;E.has(V)||(E.add(V),z.add(P),h.push({partyName:j.partyName,partyNameUpper:P,state:j.state||j.statePartyDetails||"",normalizedState:ne,gstin:"",address:"",fromPartyMaster:!1}))}}),Object.keys(ds).forEach(j=>{const P=j.trim().toUpperCase();j&&!z.has(P)&&(z.add(P),h.push({partyName:j,partyNameUpper:P,state:"",normalizedState:"",gstin:"",address:"",fromPartyMaster:!1}))}),Ui.forEach(j=>{if(j.partyName){const P=j.partyName.trim().toUpperCase(),ne=Q(j.statePartyDetails),V=`${P}|${ne}`;E.has(V)||(E.add(V),z.add(P),h.push({partyName:j.partyName,partyNameUpper:P,state:j.statePartyDetails||"",normalizedState:ne,gstin:j.gstin||"",address:j.address||"",fromPartyMaster:!1}))}}),h.sort((j,P)=>j.partyName.localeCompare(P.partyName))},[on,Ui,Kr,zn,ds]);ve.useMemo(()=>[...new Set(on.filter(E=>E.combinationCode&&E.combinationCode!=="NA").map(E=>E.combinationCode))].sort((E,z)=>parseInt(E)-parseInt(z)),[on]);const Ec=ve.useMemo(()=>on.filter(h=>{var E,z,Q,j,P,ne;if(vt.party&&h.partyName!==vt.party||vt.billStatus&&h.toBeBilled!==vt.billStatus||vt.invoiceStatus&&(vt.invoiceStatus==="Generated"&&!h.invoiceGenerated||vt.invoiceStatus==="Not Generated"&&h.invoiceGenerated||vt.invoiceStatus==="Paid"&&h.invoiceStatus!=="Paid")||vt.mailingStatus&&h.mailingSent!==vt.mailingStatus||vt.invoiceType&&h.invoiceType!==vt.invoiceType||vt.combinationCode&&h.combinationCode!==vt.combinationCode)return!1;if(vt.searchText){const V=vt.searchText.toLowerCase();if(!(((E=h.senderName)==null?void 0:E.toLowerCase().includes(V))||((z=h.subject)==null?void 0:z.toLowerCase().includes(V))||((Q=h.campaignName)==null?void 0:Q.toLowerCase().includes(V))||((j=h.invoiceNo)==null?void 0:j.toLowerCase().includes(V))||((P=h.partyName)==null?void 0:P.toLowerCase().includes(V))||((ne=h.emailId)==null?void 0:ne.toLowerCase().includes(V))))return!1}return!0}),[on,vt]);ve.useMemo(()=>{const h={};return Ec.forEach(E=>{h[E.partyName]||(h[E.partyName]=[]),h[E.partyName].push(E)}),Object.keys(h).forEach(E=>{h[E].sort((z,Q)=>z.toBeBilled==="Yes"&&Q.toBeBilled!=="Yes"?-1:z.toBeBilled!=="Yes"&&Q.toBeBilled==="Yes"?1:0)}),h},[Ec]),ve.useMemo(()=>{if(!Y)return[];const h=ds[Y]||0;let E=h;const z=zn.filter(Q=>Gt(Q.partyName,Y)).sort((Q,j)=>new Date(Q.date)-new Date(j.date)).map(Q=>(E=E+Q.debit-Q.credit,{...Q,balance:E}));return h!==0?[{id:"opening",date:"",particulars:"Opening Balance",debit:h>0?h:0,credit:h<0?Math.abs(h):0,balance:h,isOpening:!0},...z]:z},[Y,zn,ds]);const go=h=>on.filter(E=>Gt(E.partyName,h)&&E.toBeBilled==="Yes"&&!E.invoiceGenerated&&E.invoiceAmount),d=h=>!h||h==="NA"?!1:on.some(E=>E.combinationCode===h&&E.mailingSent==="Yes"),v=h=>h.invoiceType==="Combined"&&h.combinationCode!=="NA"?on.filter(E=>E.combinationCode===h.combinationCode):[h],C=()=>{Ii({party:"",billStatus:"",invoiceStatus:"",mailingStatus:"",invoiceType:"",combinationCode:"",searchText:""})},M=Object.values(vt).some(h=>h!==""),oe=h=>{const E=[];return h.emailId&&E.push(h.emailId),h.additionalEmails&&h.additionalEmails.length>0&&E.push(...h.additionalEmails),E},me=(h,E)=>{!E||!E.includes("@")||Re(z=>z.map(Q=>{if(Q.id===h){const j=Q.additionalEmails||[];if(!j.includes(E)&&E!==Q.emailId)return{...Q,additionalEmails:[...j,E]}}return Q}))},$e=(h,E)=>{Re(z=>z.map(Q=>Q.id===h?{...Q,additionalEmails:(Q.additionalEmails||[]).filter(j=>j!==E)}:Q))},Qt=h=>{Rr(h),ki(h.editComments||h.approvalRemarks||""),ea({particularsApproved:h.particularsApproved||!1,emailApproved:h.emailApproved||!1,invoiceTypeApproved:h.invoiceTypeApproved||!1}),hr(!0)},ln=()=>{if(!ce)return;if(!Sa.particularsApproved||!Sa.emailApproved||!Sa.invoiceTypeApproved){alert("Please confirm all approval checkboxes before approving.");return}const h={invoiceStatus:"Approved",approvalRemarks:Zs.trim()||"",editComments:"",particularsApproved:!0,emailApproved:!0,invoiceTypeApproved:!0,approvedBy:r,approvedDate:new Date().toISOString()};let E=[];ce.invoiceType==="Combined"&&ce.combinationCode!=="NA"?(E=_e.filter(ne=>ne.combinationCode===ce.combinationCode),Re(ne=>ne.map(V=>V.combinationCode===ce.combinationCode?{...V,...h}:V))):(E=[ce],Re(ne=>ne.map(V=>V.id===ce.id?{...V,...h}:V)));const z=parseFloat(ce.invoiceTotalAmount)||0,Q=E.map(ne=>{var V,he;return ne.senderName||((he=(V=ne.campaignName)==null?void 0:V.split("--")[0])==null?void 0:he.trim())}).join(", "),j=`${ce.invoiceNo} - ${Q}`;Ce(ne=>[...ne,{id:Date.now(),partyName:ce.partyName,date:ce.invoiceDate,particulars:"Promotional Trade Mailer",narration:j,debit:z,credit:0,type:"invoice",invoiceNo:ce.invoiceNo,combinationCode:ce.combinationCode}]);const P=Zs.trim()?` | Remarks: "${Zs.trim()}"`:"";Wn("approval",` Invoice ${ce.invoiceNo} has been APPROVED by Director${P} - ready for mailing`,"finance"),hr(!1),Rr(null),ea({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1}),ki(""),alert(` Invoice Approved!

The invoice is now ready for mailing.`)},Ut=()=>{if(!ce)return;const h=Zs.trim();ce.invoiceType==="Combined"&&ce.combinationCode!=="NA"?Re(z=>z.map(Q=>Q.combinationCode===ce.combinationCode?{...Q,invoiceStatus:"Need Edits",editComments:h,approvalRemarks:""}:Q)):Re(z=>z.map(Q=>Q.id===ce.id?{...Q,invoiceStatus:"Need Edits",editComments:h,approvalRemarks:""}:Q));const E=h?`: "${h}"`:"";Wn("edit",` Invoice ${ce.invoiceNo} marked as NEED EDITS by Director${E}`,"finance"),hr(!1),Rr(null),ki("")},cn=h=>{Rr(h);const E=parseFloat(h.invoiceTotalAmount)||0;Fi({amount:E.toFixed(2),tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),oo(!0)},yn=()=>{if(!ce||!Bt.amount){alert("Please enter receipt amount");return}if(ce.invoiceStatus!=="Approved"){alert("Receipt cannot be posted. Invoice must be approved first.");return}if(!ce.isHistorical&&ce.mailingSent!=="Yes"){alert("Receipt cannot be posted. Invoice must be mailed first.");return}const h=`RCP/${new Date().getFullYear()}-${String(new Date().getFullYear()+1).slice(-2)}/${Pt}`,E=parseFloat(Bt.amount)||0,z=parseFloat(Bt.tds)||0,Q=parseFloat(Bt.discount)||0,j=E+z+Q,P=v(ce),ne=P.map(Te=>Te.subject||Te.senderName).join(", "),V=ne.length>50?ne.substring(0,47)+"...":ne,he={id:Date.now(),receiptNo:h,invoiceNo:ce.invoiceNo,partyName:ce.partyName,date:Bt.date,amount:E,tds:z,discount:Q,totalCredit:j,narration:Bt.narration,paymentAdvisory:Bt.paymentAdvisory,mode:Bt.mode,campaigns:P.map(Te=>({senderName:Te.senderName,subject:Te.subject}))};W(Te=>[...Te,he]);const ie=Bt.narration||V;E>0&&Ce(Te=>[...Te,{id:Date.now(),partyName:ce.partyName,date:Bt.date,particulars:`Payment Received - ${ie}`,narration:`${ce.invoiceNo} | ${Bt.mode}`,debit:0,credit:E,type:"receipt",receiptNo:h,invoiceNo:ce.invoiceNo,paymentAdvisory:Bt.paymentAdvisory}]),z>0&&Ce(Te=>[...Te,{id:Date.now()+1,partyName:ce.partyName,date:Bt.date,particulars:"TDS Deducted",narration:`Against ${ce.invoiceNo}`,debit:0,credit:z,type:"tds",receiptNo:h,invoiceNo:ce.invoiceNo}]),Q>0&&Ce(Te=>[...Te,{id:Date.now()+2,partyName:ce.partyName,date:Bt.date,particulars:"Discount Given",narration:`Against ${ce.invoiceNo}`,debit:0,credit:Q,type:"discount",receiptNo:h,invoiceNo:ce.invoiceNo}]);const ge=parseFloat(ce.invoiceTotalAmount)||0,le=re.find(Te=>Te.invoiceNo===ce.invoiceNo),J=le?Math.abs(parseFloat(le.totalAmount)||0):0,se=ge-j-J<=0;ce.invoiceType==="Combined"&&ce.combinationCode!=="NA"?Re(Te=>Te.map(Ve=>Ve.combinationCode===ce.combinationCode?{...Ve,receiptStatus:se?"Closed":"Received",receiptNo:h,receiptDate:Bt.date}:Ve)):ce.isHistorical||Re(Te=>Te.map(Ve=>Ve.id===ce.id?{...Ve,receiptStatus:se?"Closed":"Received",receiptNo:h,receiptDate:Bt.date}:Ve)),Et(Te=>Te+1),Wn("receipt",` Payment received for ${ce.partyName} - Receipt ${h} - ${tt(j)}`,"director"),oo(!1),Rr(null),Fi({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),alert(` Receipt Created!

Receipt No: ${h}
Amount: ${tt(j)}`)},Fa=h=>{Rr(h),wa({amount:"",tds:"",discount:"",reason:"",date:new Date().toISOString().split("T")[0]}),Fs(!0)},Wi=()=>{var Te;if(!ce||!nn.amount&&!nn.gst||!nn.reason){alert("Please enter Amount and/or GST and reason");return}const h=ce.invoiceNo.match(/(\d{4}-\d{2})/),E=h?h[1]:`${new Date().getFullYear()}-${String(new Date().getFullYear()+1).slice(-2)}`,z=ce.invoiceNo.split("/").pop(),Q=`CN/${E}/${z}`,j=parseFloat(nn.amount)||0,P=parseFloat(nn.gst)||0,ne=j+P,he=((Te=ce.statePartyDetails)==null?void 0:Te.toUpperCase().includes("MAHARASHTRA"))?"CGST/SGST":"IGST",ie={id:Date.now(),creditNoteNo:Q,invoiceNo:ce.invoiceNo,partyName:ce.partyName,date:nn.date,amount:j,gst:P,gstType:he,totalAmount:ne,reason:nn.reason};ee(Ve=>[...Ve,ie]);const ge=parseFloat(ce.invoiceTotalAmount)||0,le=je.find(Ve=>Ve.invoiceNo===ce.invoiceNo),J=le?parseFloat(le.amount)+parseFloat(le.tds||0)+parseFloat(le.discount||0):0,be=ne>=ge-J;ce.isHistorical||Re(Ve=>Ve.map(Qe=>Qe.invoiceNo===ce.invoiceNo?{...Qe,creditNoteNo:Q,receiptStatus:be?"Cancelled":Qe.receiptStatus}:Qe)),xt(Ve=>Ve+1),Fs(!1),Rr(null),wa({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]});let se=` Credit Note Created!

Credit Note No: ${Q}`;j>0&&(se+=`
Base Amount: ${tt(j)}`),P>0&&(se+=`
${he}: ${tt(P)}`),se+=`
Total: ${tt(ne)}`,be&&(se+=`

 Invoice fully covered by CN - marked as Cancelled`),alert(se)},wc=h=>{var Q;const E=(Q=h.target.files)==null?void 0:Q[0];if(!E)return;const z=new FileReader;z.onload=j=>{Fi(P=>({...P,paymentAdvisory:j.target.result}))},z.readAsDataURL(E),h.target.value=""},yl=h=>{Rr(h),di(!0)},G4=()=>{if(!ce)return;const h=ce.invoiceNo;ce.invoiceType==="Combined"&&ce.combinationCode!=="NA"?Re(Q=>Q.map(j=>j.combinationCode===ce.combinationCode?{...j,invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",invoiceType:"Individual",combinationCode:"NA",mailingSent:"No",mailDate:"",editComments:"",receiptStatus:"",receiptNo:"",receiptDate:""}:j)):Re(Q=>Q.map(j=>j.id===ce.id?{...j,invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",invoiceType:"Individual",combinationCode:"NA",mailingSent:"No",mailDate:"",editComments:"",receiptStatus:"",receiptNo:"",receiptDate:""}:j)),Ce(Q=>Q.filter(j=>j.invoiceNo!==h));const E=je.filter(Q=>Q.invoiceNo===h);E.length>0&&W(Q=>Q.filter(j=>j.invoiceNo!==h)),di(!1),Rr(null);const z=E.length>0?`
${E.length} receipt(s) also deleted.`:"";alert(` Invoice ${h} deleted.${z}

You can now regenerate the invoice.`)},K4=h=>{confirm(`Delete Receipt ${h.receiptNo}?

This will also update the invoice status back to Pending.`)&&(W(E=>E.filter(z=>z.id!==h.id)),Re(E=>E.map(z=>z.invoiceNo===h.invoiceNo?{...z,receiptStatus:"",receiptNo:"",receiptDate:""}:z)),alert(` Receipt ${h.receiptNo} deleted.`))},Y4=h=>{confirm(`Delete Credit Note ${h.creditNoteNo}?

This will remove the CN association from the invoice.`)&&(ee(E=>E.filter(z=>z.id!==h.id)),Re(E=>E.map(z=>z.invoiceNo===h.invoiceNo?{...z,creditNoteNo:""}:z)),alert(` Credit Note ${h.creditNoteNo} deleted.`))},X4=h=>{confirm(`Delete historical entry?

Vch No: ${h.vchNo||"N/A"}
Amount: ${h.debit||h.credit}

This action cannot be undone.`)&&(Ce(E=>E.filter(z=>z.id!==h.id)),alert(" Historical entry deleted."))},q4=()=>{if(!Y||!confirm(`Delete ALL historical entries for "${Y}"?

This will remove all imported historical data for this party.`))return;const h=te.filter(E=>Gt(E.partyName,Y)&&E.isHistorical).length;Ce(E=>E.filter(z=>!(Gt(z.partyName,Y)&&z.isHistorical))),alert(` ${h} historical entries deleted for ${Y}.`)},Q4=h=>{is(h),ss({date:new Date().toISOString().split("T")[0],notes:"",nextFollowupDate:"",status:"Pending"}),Ci(!0)},J4=()=>{var E,z;if(!sr)return;const h={id:Date.now(),invoiceNo:sr.invoiceNo,partyName:sr.partyName,invoiceDate:sr.invoiceDate||sr.date,invoiceAmount:sr.invoiceTotalAmount||sr.totalAmount,subject:((z=(E=sr.campaigns)==null?void 0:E[0])==null?void 0:z.subject)||sr.subject||"",followupDate:Tr.date,notes:Tr.notes,nextFollowupDate:Tr.nextFollowupDate,status:Tr.status};Mt(Q=>[...Q,h]),Ci(!1),is(null),Wn("followup",`Followup added for ${sr.invoiceNo}`,"all"),alert(` Followup recorded for ${sr.invoiceNo}`)},Z4=h=>{confirm("Delete this followup entry?")&&Mt(E=>E.filter(z=>z.id!==h))},eF=h=>{var V,he;const E=h.subject||((he=(V=h.campaigns)==null?void 0:V[0])==null?void 0:he.subject)||"",z=h.partyName,Q=h.invoiceNo,j=tt(h.invoiceTotalAmount||h.totalAmount||0),P=Ft(h.invoiceDate||h.date);return`Subject: RE: ${E} - Payment Followup for Invoice ${Q}

Dear Sir/Madam,

Greetings from ${S.name}!

This is a gentle reminder regarding the outstanding payment for:

Invoice No: ${Q}
Invoice Date: ${P}
Amount: ${j}
Party: ${z}

We kindly request you to process the payment at the earliest. If the payment has already been made, please share the payment details for our records.

For any queries, please feel free to reach out.

Thanks & Regards,
Finance Team
${S.name}
Email: ${S.email}
Phone: ${S.phone}`},oy=h=>{const E=eF(h);navigator.clipboard.writeText(E),alert(" Followup email template copied to clipboard!")},ly=h=>{var Q,j;const E=h.subject||((j=(Q=h.campaigns)==null?void 0:Q[0])==null?void 0:j.subject)||"",z=encodeURIComponent(E);window.open(`https://mail.google.com/mail/u/0/#search/${z}`,"_blank")},tF=h=>{var Q;const E=(Q=h.target.files)==null?void 0:Q[0];if(!E)return;const z=new FileReader;z.onload=j=>{const P=Cl(j.target.result,{type:"binary"}),ne=P.SheetNames[0],V=P.Sheets[ne],he=Ar.sheet_to_json(V),ie={};he.forEach(ge=>{const le=ge["Party Name"]||ge["PARTY NAME"]||ge.PartyName||"",J=parseFloat(ge.Amount||ge.AMOUNT||ge["Invoice Amount"]||0);le&&J>0&&(ie[le.trim()]=J)}),ls(ge=>({...ge,...ie})),alert(` Loaded ${Object.keys(ie).length} party invoice values!`)},z.readAsBinaryString(E),h.target.value=""},rF=()=>{const h=Ar.json_to_sheet([{"Party Name":"ABC Group Private Limited",Amount:5500},{"Party Name":"XYZ Media Pvt Ltd",Amount:7500}]),E=Ar.book_new();Ar.book_append_sheet(E,h,"Invoice Values"),bc(E,"Invoice_Values_Template.xlsx")},nF=h=>{var Q;const E=(Q=h.target.files)==null?void 0:Q[0];if(!E)return;const z=new FileReader;z.onload=j=>{const P=Cl(j.target.result,{type:"binary"}),ne=P.SheetNames[0],V=P.Sheets[ne],he=Ar.sheet_to_json(V),ie={...an};let ge=0;he.forEach(le=>{const J=(le["Name of Ledger"]||le["Party Name"]||le["NAME OF LEDGER"]||le["PARTY NAME"]||"").trim(),be=(le["State Name"]||le["STATE NAME"]||le.State||le.STATE||"").trim(),se=(le.Address||le.ADDRESS||le["Party Address"]||le["PARTY ADDRESS"]||"").trim();if(J){const Te=pi(be),Ve=`${J.toUpperCase()}|${Te}`;ie[Ve]={partyName:J,partyNameUpper:J.toUpperCase(),ledgerGroup:le["Ledger Group"]||le["LEDGER GROUP"]||"Sundry Debtors",stateName:be,normalizedState:Te,gstRegType:le["GST Registration Type"]||le["GST REGISTRATION TYPE"]||"Regular",gstin:(le["GSTIN/UIN"]||le.GSTIN||le.GST||"").trim(),address:se},ge++}}),hl(ie),alert(` Party Master Updated!

${ge} party-state combinations loaded.`)},z.readAsBinaryString(E),h.target.value=""},iF=()=>{const h=Ar.json_to_sheet([{"Sl. No.":1,"Name of Ledger":"ABC PRIVATE LIMITED",Address:"123 Business Park, Andheri East","Ledger Group":"Sundry Debtors","State Name":"Maharashtra","GST Registration Type":"Regular","GSTIN/UIN":"27AAACA1234A1ZQ"},{"Sl. No.":2,"Name of Ledger":"XYZ MEDIA PVT LTD",Address:"456 Media Tower, Connaught Place","Ledger Group":"Sundry Debtors","State Name":"Delhi","GST Registration Type":"Regular","GSTIN/UIN":"07AAACX5678B1ZR"}]),E=Ar.book_new();Ar.book_append_sheet(E,h,"Party Master"),bc(E,"Party_Master_Template.xlsx")},sF=h=>{var Q;const E=(Q=h.target.files)==null?void 0:Q[0];if(!E)return;if(!Y){alert(" Please select a party first from the list, then import their historical ledger."),h.target.value="";return}const z=new FileReader;z.onload=j=>{const P=Cl(j.target.result,{type:"binary",cellDates:!0}),ne=P.SheetNames[0],V=P.Sheets[ne],he=Ar.sheet_to_json(V,{raw:!1}),ie=[];let ge=0,le=null;const J=se=>{if(!se)return 0;const Te=String(se).replace(/,/g,"").replace(/[^\d.-]/g,"");return parseFloat(Te)||0},be=se=>{if(!se||typeof se!="string")return"";const Te=se.trim(),Ve=Te.split(/[-\/]/);if(Ve.length===3){const Qe={jan:"01",feb:"02",mar:"03",apr:"04",may:"05",jun:"06",jul:"07",aug:"08",sep:"09",oct:"10",nov:"11",dec:"12"},rt=Ve[1].toLowerCase().substring(0,3);if(Qe[rt]){const Be=Ve[0].padStart(2,"0");return`${Ve[2].length===2?parseInt(Ve[2])>50?"19"+Ve[2]:"20"+Ve[2]:Ve[2]}-${Qe[rt]}-${Be}`}}return Te};he.forEach((se,Te)=>{const Ve=be(se.Date||se.DATE||se.date||""),Qe=(se.Particular||se.PARTICULAR||se.Particulars||se.PARTICULARS||"").trim(),rt=(se["Vch Type"]||se["VCH TYPE"]||se["Voucher Type"]||se["vch type"]||"").trim(),Be=(se["Vch No."]||se["VCH NO."]||se["Voucher No"]||se["Invoice No"]||se["Vch No"]||se["vch no."]||"").trim(),et=J(se.Debit||se.DEBIT||se.debit),De=J(se.Credit||se.CREDIT||se.credit),st=se["Date of Receipt"]||se["DATE OF RECEIPT"]||se["Receipt Date"]||"",Ct=J(se["Amount Received"]||se["AMOUNT RECEIVED"]||se["amount received"]),wt=J(se["TDS amount Received"]||se["TDS Received"]||se.TDS||se.tds),at=J(se.Balance||se.BALANCE||se.balance),_n=(se["Payment Status"]||se["PAYMENT STATUS"]||se.Status||se.status||"").trim();if(!Ve&&(Qe.toUpperCase().includes("PROMOTIONAL")||Qe.toUpperCase().includes("IGST")||Qe.toUpperCase().includes("CGST")||Qe.toUpperCase().includes("SGST")||Qe.toUpperCase().includes("TRADE EMAILER"))&&le)le.subRows||(le.subRows=[]),le.subRows.push({particular:Qe,debit:et,credit:De});else if(Ve&&(Be||et>0||De>0)){le&&(ie.push(le),ge++);let ze="invoice";rt.toLowerCase().includes("credit note")||Be.toUpperCase().startsWith("CN")?ze="creditnote":rt.toLowerCase().includes("receipt")?ze="receipt":(rt.toLowerCase().includes("sale")||et>0)&&(ze="invoice"),le={id:Date.now()+Te,partyName:Y,date:Ve,particulars:Qe||Y,narration:Be,vchType:rt||"Sales",vchNo:Be,debit:et,credit:De,receiptDate:st,amountReceived:Ct,tdsReceived:wt,balance:at,paymentStatus:_n,type:ze,isHistorical:!0,subRows:[]}}}),le&&(ie.push(le),ge++),console.log("Parsed entries with sub-rows:",ie),ge>0?(Ce(se=>[...se,...ie]),alert(` Historical Ledger Uploaded!

${ge} entries added for "${Y}".`)):alert(` No valid ledger entries found in the file.

Make sure your file has these columns:
 Date (e.g., 02-Jun-21)
 Vch Type (e.g., Sales, Credit Note)
 Vch No. (e.g., MB/2022-23/128)
 Debit or Credit amount`)},z.readAsBinaryString(E),h.target.value="",Ps(!1)},aF=()=>{const h=Ar.json_to_sheet([{Date:"02-Jun-21",Particular:"ABC Corp Ltd.","Vch Type":"Sales","Vch No.":"MB/2020-21/0411",Debit:6e3,Credit:"","Date of Receipt":"","Amount Received":44371,"TDS amount Received":5880,Balance:"","Payment Status":"Received"},{Date:"",Particular:"PROMOTIONAL TRADE EMAILERS","Vch Type":"","Vch No.":"",Debit:"",Credit:22500,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""},{Date:"",Particular:"IGST","Vch Type":"","Vch No.":"",Debit:"",Credit:4050,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""},{Date:"26-Mar-25",Particular:"ABC Corp Ltd.","Vch Type":"Credit Note","Vch No.":"CN/2022-23/128",Debit:"",Credit:26550,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""}]),E=Ar.book_new();Ar.book_append_sheet(E,h,"Historical Ledger"),bc(E,"Historical_Ledger_Template.xlsx")},oF=h=>{const E=_e.find(z=>z.invoiceNo===h);E?Ku(E):alert("Invoice not found in system. This may be a historical entry.")},lF=h=>{_e.find(z=>z.invoiceNo===h.invoiceNo);let E=` RECEIPT DETAILS

`;E+=`Receipt No: ${h.receiptNo}
`,E+=`Date: ${Ft(h.date)}
`,E+=`Party: ${h.partyName}
`,E+=`Invoice: ${h.invoiceNo}

`,E+=`
`,E+=`Amount Received: ${tt(h.amount||0)}
`,E+=`TDS: ${tt(h.tds||0)}
`,E+=`Discount: ${tt(h.discount||0)}
`,E+=`
`,E+=`Total: ${tt((h.amount||0)+(h.tds||0)+(h.discount||0))}
`,h.remarks&&(E+=`
Remarks: ${h.remarks}`),alert(E)},cF=h=>{let E=` CREDIT NOTE DETAILS

`;E+=`Credit Note No: ${h.creditNoteNo}
`,E+=`Date: ${Ft(h.date)}
`,E+=`Party: ${h.partyName}
`,E+=`Against Invoice: ${h.invoiceNo}

`,E+=`
`,E+=`Base Amount: ${tt(h.amount||0)}
`,E+=`${h.gstType||"GST"}: ${tt(h.gst||0)}
`,E+=`
`,E+=`Total Credit: ${tt(h.totalAmount||(h.amount||0)+(h.gst||0))}
`,h.reason&&(E+=`
Reason: ${h.reason}`),alert(E)},uF=h=>{var Q;const E=(Q=h.target.files)==null?void 0:Q[0];if(!E)return;const z=new FileReader;z.onload=j=>{const P=Cl(j.target.result,{type:"binary",cellDates:!0}),ne=P.SheetNames[0],V=P.Sheets[ne],he=Ar.sheet_to_json(V,{raw:!1}),ie=new Set(on.map(se=>`${se.date}|${se.time||""}|${se.campaignName||""}|${se.subject}`.toLowerCase()));let ge=0,le=0;const J=he.map((se,Te)=>{const Ve=se["CAMPAIGN NAME"]||se["Campaign Name"]||"",Qe=dw(Ve);let rt=se.DATE||se.Date||new Date;typeof rt=="string"&&(rt=new Date(rt));const Be=(se["PARTY NAME"]||se["Party Name"]||"").trim(),et=se["SENDER NAME"]||se["Sender Name"]||"",De=se.SUBJECT||se.Subject||"",st=se.TIME||se.Time||"",Ct=hi[Be]||"",wt=rt instanceof Date&&!isNaN(rt)?rt.toISOString().split("T")[0]:"",at=`${wt}|${st}|${Ve}|${De}`.toLowerCase();return ie.has(at)?(ge++,null):(ie.add(at),le++,{id:Date.now()+Te+Math.random(),sno:se.SNO||se["SNO."]||se.Sno||Te+1,date:wt,month:se.Month||se.MONTH||"",statePartyDetails:se["State/Party Details"]||se["STATE/PARTY DETAILS"]||"",partyName:Be,senderName:et,campaignName:Ve,subject:De,emailId:Qe,additionalEmails:[],toBeBilled:"Not Yet",invoiceAmount:Ct,cgst:"",sgst:"",igst:"",totalWithGst:"",invoiceType:"Individual",combinationCode:"NA",invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",mailingSent:"No",mailerUploaded:!1,editComments:""})}).filter(se=>se!==null);if(J.length>0){Re(Te=>[...Te,...J]);const se=[...new Set(J.map(Te=>Te.partyName))];zu(Te=>{const Ve=new Set(Te);return se.forEach(Qe=>Ve.add(Qe)),Ve})}let be=` Upload Complete!

`;be+=` ${le} new campaigns added
`,ge>0&&(be+=` ${ge} duplicate entries skipped`),le>0&&Wn("upload",` ${le} new campaigns uploaded to Master Sheet`,"director"),alert(be)},z.readAsBinaryString(E),h.target.value=""},dF=async()=>{Re([]),Se([]),Ce([]),W([]),ee([]),lo({}),gc({}),Ae(1),q(1),Et(1),xt(1),ir(1),xe(null),Le(null),zu(new Set),Mt([]),hl({}),Ne([]);try{await lm("indreesh-media",{masterData:[],servicesData:[],ledgerEntries:[],receipts:[],creditNotes:[],openingBalances:{},mailerImages:{},mailerLogo:Lt,companyConfig:S,nextInvoiceNo:1,nextCombineNo:1,nextReceiptNo:1,nextCreditNoteNo:1,nextServiceInvoiceNo:1,invoiceValues:hi,notifications:[],whatsappSettings:lt,partyMaster:{},followups:[],userPasswords:y}),console.log("Data cleared and saved to Firebase")}catch(h){console.error("Error clearing data:",h)}bs(!1),alert(" All master data, invoices, receipts, and ledger entries have been cleared!")},cy=h=>{var Q;const E=parseFloat(h.invoiceAmount)||0;if((Q=h.statePartyDetails)==null?void 0:Q.toUpperCase().includes("MAHARASHTRA")){const j=E*.09,P=E*.09;return{cgst:j,sgst:P,igst:0,total:E+j+P}}else{const j=E*.18;return{cgst:0,sgst:0,igst:j,total:E+j}}},fF=(h,E)=>{const z=_e.find(Q=>Q.id===h);Re(Q=>Q.map(j=>{if(j.id===h){if(E==="Yes"&&j.invoiceAmount){const P=cy(j);return{...j,toBeBilled:E,cgst:P.cgst.toFixed(2),sgst:P.sgst.toFixed(2),igst:P.igst.toFixed(2),totalWithGst:P.total.toFixed(2)}}return{...j,toBeBilled:E}}return j})),E==="Yes"&&z&&Wn("info",` Campaign marked for billing: ${z.partyName} - ${z.senderName}`,"finance")},a0=(h,E,z)=>{Re(Q=>Q.map(j=>{if(j.id===h){const P={...j,[E]:z};if(E==="invoiceAmount"&&j.toBeBilled==="Yes"){const ne=cy(P);return{...P,cgst:ne.cgst.toFixed(2),sgst:ne.sgst.toFixed(2),igst:ne.igst.toFixed(2),totalWithGst:ne.total.toFixed(2)}}return P}return j}))},hF=h=>{const E=`${S.invoicePrefix}${Fe}`,z=new Date().toISOString().split("T")[0],Q=parseFloat(h.totalWithGst)||parseFloat(h.invoiceAmount)*1.18;Re(j=>j.map(P=>P.id===h.id?{...P,invoiceNo:E,invoiceDate:z,invoiceTotalAmount:Q.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created",invoiceType:"Individual",combinationCode:"NA"}:P)),Ae(j=>j+1),Wn("invoice",` New Invoice ${E} created for ${h.partyName} - ${tt(Q)}`,"director"),alert(` Invoice Generated!

Invoice No: ${E}
Amount: ${tt(Q)}

Please review and Approve or mark as Need Edits.`)},pF=()=>{if(sn.size<2){alert("Please select at least 2 campaigns to combine");return}const h=`${S.invoicePrefix}${Fe}`,E=new Date().toISOString().split("T")[0],z=String(it);let Q=0;const j=_e.filter(P=>sn.has(P.id));j.forEach(P=>{Q+=parseFloat(P.totalWithGst)||parseFloat(P.invoiceAmount)*1.18}),Re(P=>P.map(ne=>sn.has(ne.id)?{...ne,invoiceNo:h,invoiceDate:E,invoiceTotalAmount:Q.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created",invoiceType:"Combined",combinationCode:z,mailingSent:"No"}:ne)),Ae(P=>P+1),q(P=>P+1),dr(!1),ta(new Set),Wn("invoice",` Combined Invoice ${h} created for ${pc} (${j.length} campaigns) - ${tt(Q)}`,"director"),Ds(null),alert(` Combined Invoice Generated!

Invoice No: ${h}
Campaigns: ${sn.size}
Total: ${tt(Q)}

Please review and Approve or mark as Need Edits.`)},gF=h=>{ta(E=>{const z=new Set(E);return z.has(h)?z.delete(h):z.add(h),z})},mF=h=>{Ds(h.partyName),ta(new Set([h.id])),dr(!0)},xF=h=>{var Q;const E=(Q=h.target.files)==null?void 0:Q[0];if(!E||!ce)return;const z=new FileReader;z.onload=j=>uy(j.target.result),z.readAsDataURL(E),h.target.value=""},uy=h=>{if(!ce)return;const E=ce.id;lo(Uu?z=>({...z,[E]:[h]}):z=>({...z,[E]:[...z[E]||[],h]})),Re(z=>z.map(Q=>Q.id===ce.id?{...Q,mailerUploaded:!0}:Q)),os(null),fl(!1),en(!1),alert(" Mailer image saved!")},vF=h=>{var z;const E=(z=h.clipboardData)==null?void 0:z.items;if(E){for(let Q=0;Q<E.length;Q++)if(E[Q].type.indexOf("image")!==-1){const j=E[Q].getAsFile(),P=new FileReader;P.onload=ne=>os(ne.target.result),P.readAsDataURL(j),h.preventDefault();break}}},yF=h=>{const E=encodeURIComponent(h||"campaign");window.open(`https://mail.google.com/mail/u/0/#search/${E}`,"_blank")},_F=h=>{var Q;const E=(Q=h.target.files)==null?void 0:Q[0];if(!E)return;const z=new FileReader;z.onload=j=>Ta(j.target.result),z.readAsDataURL(E),h.target.value=""},dy=h=>{const E=v(h);if(E.length>1){const z=E.map(Q=>Q.senderName).join(", ");return`Invoice ${h.invoiceNo||""} - ${z}`}return`Invoice ${h.invoiceNo||""} - ${h.senderName} - ${h.subject}`},o0=h=>{const E=v(h),z=parseFloat(h.invoiceTotalAmount)||parseFloat(h.totalWithGst)||parseFloat(h.invoiceAmount)*1.18;let Q="";return E.length>1?(Q=`Campaigns included in this invoice:
`,E.forEach((j,P)=>{Q+=`${P+1}. ${j.senderName} - ${j.subject}
`})):Q=`Campaign: ${h.senderName}
Subject: ${h.subject}`,`Dear Sir/Madam,

Please find attached the invoice for the following:

${Q}

Invoice No: ${h.invoiceNo||"To be generated"}
Invoice Amount: ${tt(z)}

Kindly process the payment at your earliest convenience.

Bank Details:
Bank: ${S.bank.name}
A/C No: ${S.bank.account}
IFSC: ${S.bank.ifsc}
Branch: ${S.bank.branch}

Thank you for your business.

Best Regards,
${S.name}
${S.email}`},[EF,fy]=ve.useState(!1),[hy,py]=ve.useState(""),gy=h=>{var se;let E=[h],z=parseFloat(h.invoiceAmount)||0;h.invoiceType==="Combined"&&h.combinationCode!=="NA"&&(E=_e.filter(Te=>Te.combinationCode===h.combinationCode),z=E.reduce((Te,Ve)=>Te+(parseFloat(Ve.invoiceAmount)||0),0));const Q=fo(h.partyName,h.statePartyDetails),j=xl(h.partyName,h.statePartyDetails),P=(se=h.statePartyDetails)==null?void 0:se.toUpperCase().includes("MAHARASHTRA"),ne=P?z*.09:0,V=P?z*.09:0,he=P?0:z*.18,ie=ne+V+he,ge=z+ie,le=E.map((Te,Ve)=>`
      <tr>
        <td style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px;">${Ve+1}</td>
        <td style="border: 1px solid #000; padding: 8px; font-size: 12px;">
          <div style="font-weight: 600;">PROMOTIONAL TRADE EMAILER</div>
          <div style="font-style: italic; color: #555; font-size: 11px; margin-top: 2px;">${Te.senderName||""} - ${Ft(Te.date)}</div>
          <div style="font-style: italic; color: #555; font-size: 11px;">Subject: ${Te.subject||""}</div>
        </td>
        <td style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px;">${S.hsnCode}</td>
        <td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${jt(parseFloat(Te.invoiceAmount)||0)}</td>
      </tr>
    `).join("");let J=[];h.invoiceType==="Combined"&&h.combinationCode!=="NA"?E.forEach(Te=>{(In[Te.id]||[]).forEach(Qe=>J.push({img:Qe,campaign:Te}))}):(In[h.id]||[]).forEach(Ve=>J.push({img:Ve,campaign:h}));const be=J.map(({img:Te,campaign:Ve})=>`
      <div class="page-break-before" style="page-break-before: always; padding: 40px; text-align: center; background: white;">
        ${Lt?`<div style="margin-bottom: 20px;"><img src="${Lt}" alt="Logo" style="max-height: 70px;" /></div>`:`
          <div style="text-align: center; margin-bottom: 25px;">
            <span style="font-size: 22px; font-weight: bold; color: #2874A6;">${S.name}</span>
          </div>
        `}
        <h2 style="font-size: 20px; text-decoration: underline; margin: 25px 0;">MAILER SUPPORTING</h2>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>MAILER DATE:</strong> ${TH(Ve.date)}</p>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>CAMPAIGN:</strong> ${Ve.senderName}</p>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>SUBJECT:</strong> ${Ve.subject||"Campaign"}</p>
        <div style="margin-top: 25px;"><img src="${Te}" alt="Mailer" style="max-width: 100%; max-height: 550px; border: 1px solid #ddd;" /></div>
      </div>
    `).join("");return`
  <div style="max-width: 900px; margin: 0 auto; padding: 15px; background: white; font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4;">
    <style>
      @media print {
        @page { size: A4; margin: 8mm; }
        body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        .page-break-before { page-break-before: always; }
      }
    </style>
    <div style="border: 2px solid #000; background: white;">
      <div style="text-align: center; padding: 12px; font-size: 18px; font-weight: bold; border-bottom: 2px solid #000; background: #f8f8f8;">Tax Invoice</div>
      <div style="text-align: center; font-size: 11px; font-style: italic; padding: 5px; border-bottom: 1px solid #000; background: #fafafa;">(Original for Recipient)</div>
      <div style="display: flex; border-bottom: 2px solid #000;">
        <div style="flex: 1.5; padding: 12px; border-right: 2px solid #000;">
          <div style="font-size: 16px; font-weight: bold; margin-bottom: 8px; color: #1a5276;">${S.name}</div>
          <div style="font-size: 11px; line-height: 1.5; color: #333;">${S.address}<br>${S.addressLine2}<br>${S.city}<br><strong>GSTIN/UIN:</strong> ${S.gstin}<br><strong>State:</strong> ${S.stateName}, Code: ${S.stateCode}<br><strong>Contact:</strong> ${S.phone}<br><strong>E-Mail:</strong> ${S.email}</div>
        </div>
        <div style="flex: 1; font-size: 12px;">
          <div style="display: flex; border-bottom: 1px solid #000;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Invoice No.</div><div style="flex: 1; padding: 8px; font-weight: 600; color: #1a5276;">${h.invoiceNo||""}</div></div>
          <div style="display: flex;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Dated</div><div style="flex: 1; padding: 8px;">${Ft(h.invoiceDate||h.date)}</div></div>
        </div>
      </div>
      <div style="padding: 10px 12px; border-bottom: 2px solid #000; background: #fafafa;">
        <div style="font-size: 11px; color: #666; margin-bottom: 3px;">Buyer (Bill to)</div>
        <div style="font-size: 14px; font-weight: bold; margin-bottom: 4px; color: #1a5276;">${h.partyName}</div>
        <div style="font-size: 11px; color: #333;">${j?j+"<br>":""}${h.statePartyDetails||""}${Q?"<br><strong>GSTIN/UIN:</strong> "+Q:""}<br>Place of Supply: ${h.statePartyDetails||S.stateName}</div>
      </div>
      <table style="width: 100%; border-collapse: collapse;">
        <thead><tr style="background: #e8e8e8;"><th style="border: 1px solid #000; padding: 10px; width: 45px; font-size: 12px;">Sl No.</th><th style="border: 1px solid #000; padding: 10px; font-size: 12px;">Particulars</th><th style="border: 1px solid #000; padding: 10px; width: 80px; font-size: 12px;">HSN/SAC</th><th style="border: 1px solid #000; padding: 10px; width: 100px; text-align: right; font-size: 12px;">Amount</th></tr></thead>
        <tbody>
          ${le}
          ${E.length>1?'<tr style="background: #f5f5f5;"><td colspan="3" style="border: 1px solid #000; padding: 10px; text-align: right; font-weight: bold; font-size: 13px;">Sub Total</td><td style="border: 1px solid #000; padding: 10px; text-align: right; font-weight: bold; font-size: 13px;">'+jt(z)+"</td></tr>":""}
          ${P?`<tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">CGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${jt(ne)}</td></tr><tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">SGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${jt(V)}</td></tr>`:`<tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">IGST @ 18%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${jt(he)}</td></tr>`}
          <tr style="background: #2874A6; color: white;"><td colspan="3" style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;">Total</td><td style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;"> ${ge.toLocaleString("en-IN",{minimumFractionDigits:2})}</td></tr>
        </tbody>
      </table>
      <div style="padding: 10px 12px; border: 1px solid #000; border-top: none; background: #fafafa;"><div style="color: #666; font-size: 11px; margin-bottom: 3px;">Amount Chargeable (in words)</div><div style="font-weight: bold; font-size: 13px;">${Y0(ge)}</div></div>
      <div style="display: flex; border-top: 2px solid #000;">
        <div style="flex: 1; padding: 10px 12px; border-right: 2px solid #000; font-size: 11px;"><div><strong>Company's PAN:</strong> ${S.pan}</div><div style="margin-top: 4px;"><strong>MSME Reg. No.:</strong> UDYAM-MH-19-0057219</div></div>
        <div style="flex: 1.2; padding: 10px 12px; font-size: 11px;">
          <div style="font-weight: bold; margin-bottom: 6px; color: #1a5276;">Company's Bank Details</div>
          <div style="line-height: 1.5;"><strong>A/c Holder:</strong> ${S.bank.holder}<br><strong>Bank:</strong> ${S.bank.name}<br><strong>A/c No.:</strong> ${S.bank.account}<br><strong>IFSC:</strong> ${S.bank.ifsc}</div>
          <div style="text-align: right; margin-top: 30px;"><div style="font-weight: bold;">for ${S.name}</div><div style="margin-top: 25px; border-top: 1px solid #000; display: inline-block; padding-top: 4px; font-size: 10px;">Authorised Signatory</div></div>
        </div>
      </div>
      <div style="text-align: center; padding: 8px; background: #f0f0f0; border-top: 1px solid #000; font-size: 10px; color: #666; font-style: italic;">This is a Computer Generated Invoice</div>
    </div>
  </div>
  ${be}
`},wF=h=>{const E=gy(h);py(E),Rr(h),fy(!0)},SF=h=>{const E=`<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Invoice ${h.invoiceNo||""}</title>
  <style>
    @page { size: A4; margin: 10mm; }
    @media print { body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } }
    body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }
  </style>
</head>
<body>
${gy(h)}
<script>
  // Auto-open print dialog when file is opened
  window.onload = function() { 
    setTimeout(function() { window.print(); }, 500); 
  };
<\/script>
</body>
</html>`,z=new Blob([E],{type:"text/html"}),Q=URL.createObjectURL(z),j=document.createElement("a");j.href=Q,j.download=`Invoice_${(h.invoiceNo||"draft").replace(/\//g,"-")}.html`,document.body.appendChild(j),j.click(),document.body.removeChild(j),URL.revokeObjectURL(Q)},Ku=h=>{wF(h)},TF=()=>{const h=parseFloat(_r.amount)||0,E=parseFloat(_r.tds)||0,z=parseFloat(_r.discount)||0,Q=h+E+z;let j=parseFloat(ce.invoiceTotalAmount)||parseFloat(ce.totalWithGst)||parseFloat(ce.invoiceAmount)*1.18;const P=Q>=j?"Paid":"Partially Paid";ce.invoiceType==="Combined"&&ce.combinationCode!=="NA"?Re(V=>V.map(he=>he.combinationCode===ce.combinationCode?{...he,invoiceStatus:P}:he)):Re(V=>V.map(he=>he.id===ce.id?{...he,invoiceStatus:P}:he));const ne=[];h>0&&ne.push({id:Date.now(),partyName:ce.partyName,date:_r.date,particulars:_r.narration?`Payment Received - ${_r.mode} (${_r.narration})`:`Payment Received - ${_r.mode}`,debit:0,credit:h,type:"payment"}),E>0&&ne.push({id:Date.now()+1,partyName:ce.partyName,date:_r.date,particulars:`TDS Deducted - Inv: ${ce.invoiceNo}`,debit:0,credit:E,type:"tds"}),z>0&&ne.push({id:Date.now()+2,partyName:ce.partyName,date:_r.date,particulars:`Discount Allowed - Inv: ${ce.invoiceNo}`,debit:0,credit:z,type:"discount"}),Ce(V=>[...V,...ne]),Lr(!1),Rr(null)},my=h=>{zu(E=>{const z=new Set(E);return z.has(h)?z.delete(h):z.add(h),z})},AF=()=>{const z=r==="director"?[{id:"master",icon:J2,label:"Master Sheet"},{id:"services",icon:Yg,label:"Services Sheet"},{id:"invoices",icon:nd,label:"Invoice Register"},{id:"receipts",icon:wl,label:"Receipt Register"},{id:"ledgers",icon:Y2,label:"Party Ledgers"},{id:"followups",icon:U0,label:"Followups"},{id:"reports",icon:G2,label:"Reports"}]:[{id:"master",icon:J2,label:"Master Sheet"},{id:"services",icon:Yg,label:"Services Sheet"},{id:"invoices",icon:nd,label:"Invoice Register"},{id:"receipts",icon:wl,label:"Receipt Register"},{id:"ledgers",icon:Y2,label:"Party Ledgers"},{id:"followups",icon:U0,label:"Followups"},{id:"reports",icon:G2,label:"Reports"},{id:"settings",icon:Bj,label:"Settings"}];return c.jsxs("div",{style:{width:N?"60px":"220px",backgroundColor:"#1E293B",color:"#FFFFFF",display:"flex",flexDirection:"column",transition:"width 0.2s ease",flexShrink:0},children:[c.jsxs("div",{style:{padding:N?"12px":"16px",borderBottom:"1px solid #334155",display:"flex",alignItems:"center",justifyContent:N?"center":"space-between"},children:[!N&&c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[c.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"32px",height:"auto",borderRadius:"4px",backgroundColor:"white",padding:"2px"}}),c.jsxs("div",{children:[c.jsx("div",{style:{fontSize:"16px",fontWeight:"700"},children:"FinMate"}),c.jsx("div",{style:{fontSize:"10px",color:"#94A3B8"},children:r==="director"?"Director View":"Finance Team"})]})]}),c.jsx("button",{onClick:()=>Ge(!N),style:{background:"none",border:"none",color:"#94A3B8",cursor:"pointer",padding:"4px"},children:N?c.jsx(L0,{size:18}):c.jsx(Ij,{size:18})})]}),!N&&c.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #334155",fontSize:"11px"},children:f?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#FCD34D"},children:[c.jsx(X2,{size:12,style:{animation:"spin 1s linear infinite"}}),c.jsx("span",{children:"Saving..."})]}):g?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#86EFAC"},children:[c.jsx($g,{size:12}),c.jsxs("span",{children:["Saved ",g.toLocaleTimeString()]})]}):c.jsx("div",{style:{color:"#94A3B8"},children:"Cloud Sync Active"})}),c.jsx("div",{style:{padding:"8px",borderBottom:"1px solid #334155"},children:c.jsxs("button",{onClick:()=>dt(!0),style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:N?"12px":"11px 14px",borderRadius:"8px",border:"none",backgroundColor:Nn>0?"#FEF3C7":"#334155",color:Nn>0?"#92400E":"#94A3B8",cursor:"pointer",fontSize:"14px",fontWeight:Nn>0?"700":"500",justifyContent:N?"center":"flex-start",position:"relative"},title:"Notifications",children:[Nn>0?c.jsx(Cj,{size:18}):c.jsx(K2,{size:18}),!N&&c.jsx("span",{children:"Notifications"}),Nn>0&&c.jsx("span",{style:{position:N?"absolute":"static",top:N?"4px":"auto",right:N?"4px":"auto",marginLeft:N?"0":"auto",backgroundColor:"#DC2626",color:"#FFFFFF",padding:"2px 6px",borderRadius:"10px",fontSize:"11px",fontWeight:"700",minWidth:"18px",textAlign:"center"},children:Nn})]})}),c.jsx("nav",{style:{flex:1,padding:"8px"},children:z.map(Q=>c.jsxs("button",{onClick:()=>D(Q.id),style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:N?"12px":"11px 14px",marginBottom:"4px",borderRadius:"8px",border:"none",backgroundColor:R===Q.id?"#2874A6":"transparent",color:R===Q.id?"#FFFFFF":"#94A3B8",cursor:"pointer",fontSize:"14px",fontWeight:R===Q.id?"600":"500",justifyContent:N?"center":"flex-start"},title:Q.label,children:[c.jsx(Q.icon,{size:18}),!N&&c.jsx("span",{children:Q.label})]},Q.id))}),c.jsxs("div",{style:{padding:"8px",borderTop:"1px solid #334155"},children:[c.jsxs("button",{onClick:()=>{_(!0),G({currentPassword:"",newPassword:"",confirmPassword:""}),T("")},style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:N?"12px":"11px 14px",marginBottom:"8px",borderRadius:"8px",border:"none",backgroundColor:"#475569",color:"#FFFFFF",cursor:"pointer",fontSize:"14px",fontWeight:"500",justifyContent:N?"center":"flex-start"},title:"Change Password",children:[c.jsx(V0,{size:18}),!N&&c.jsx("span",{children:"Change Password"})]}),c.jsxs("button",{onClick:s0,style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:N?"12px":"11px 14px",borderRadius:"8px",border:"none",backgroundColor:"#DC2626",color:"#FFFFFF",cursor:"pointer",fontSize:"14px",fontWeight:"600",justifyContent:N?"center":"flex-start"},title:"Logout",children:[c.jsx(Na,{size:18}),!N&&c.jsx("span",{children:"Logout"})]})]})]})},kF=()=>c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(id,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"})]}),c.jsxs("div",{style:{position:"relative"},children:[c.jsx(z0,{size:15,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",placeholder:"Search...",value:vt.searchText,onChange:h=>Ii(E=>({...E,searchText:h.target.value})),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"160px"}})]}),c.jsxs("select",{value:vt.party,onChange:h=>Ii(E=>({...E,party:h.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:vt.party?"#EFF6FF":"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Parties"}),vn.map(h=>c.jsx("option",{value:h,children:h},h))]}),c.jsxs("select",{value:vt.billStatus,onChange:h=>Ii(E=>({...E,billStatus:h.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:vt.billStatus?"#EFF6FF":"#FFFFFF"},children:[c.jsx("option",{value:"",children:"Bill Status"}),c.jsx("option",{value:"Yes",children:"Yes"}),c.jsx("option",{value:"Not Yet",children:"Not Yet"})]}),c.jsxs("select",{value:vt.invoiceStatus,onChange:h=>Ii(E=>({...E,invoiceStatus:h.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:vt.invoiceStatus?"#EFF6FF":"#FFFFFF"},children:[c.jsx("option",{value:"",children:"Invoice Status"}),c.jsx("option",{value:"Generated",children:"Generated"}),c.jsx("option",{value:"Not Generated",children:"Not Generated"}),c.jsx("option",{value:"Paid",children:"Paid"})]}),M&&c.jsxs(c.Fragment,{children:[c.jsxs("button",{onClick:C,style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(Na,{size:14})," Clear"]}),c.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",Ec.length," of ",_e.length]})]})]})}),xy=()=>{const h=_e.filter(ne=>ne.toBeBilled==="Yes"&&ne.invoiceGenerated&&ne.mailingSent==="Yes"&&(ne.receiptStatus==="Received"||ne.receiptStatus==="Cancelled"||ne.receiptStatus==="Closed")),E=_e.filter(ne=>!(ne.toBeBilled==="Yes"&&ne.invoiceGenerated&&ne.mailingSent==="Yes"&&(ne.receiptStatus==="Received"||ne.receiptStatus==="Cancelled"||ne.receiptStatus==="Closed"))),z=rn==="open"?E:h,Q=z.filter(ne=>{var V,he,ie,ge,le;if(vt.party&&ne.partyName!==vt.party||vt.billStatus&&ne.toBeBilled!==vt.billStatus||vt.invoiceType&&ne.invoiceType!==vt.invoiceType||vt.mailingStatus&&(vt.mailingStatus==="Sent"&&ne.mailingSent!=="Yes"||vt.mailingStatus==="Not Sent"&&ne.mailingSent==="Yes")||vt.invoiceStatus&&(vt.invoiceStatus==="Generated"&&!ne.invoiceGenerated||vt.invoiceStatus==="Not Generated"&&ne.invoiceGenerated||vt.invoiceStatus==="Approved"&&ne.invoiceStatus!=="Approved"||vt.invoiceStatus==="Need Edits"&&ne.invoiceStatus!=="Need Edits"||vt.invoiceStatus==="Paid"&&ne.invoiceStatus!=="Paid"))return!1;if(vt.searchText){const J=vt.searchText.toLowerCase();if(!((V=ne.partyName)!=null&&V.toLowerCase().includes(J))&&!((he=ne.senderName)!=null&&he.toLowerCase().includes(J))&&!((ie=ne.campaignName)!=null&&ie.toLowerCase().includes(J))&&!((ge=ne.subject)!=null&&ge.toLowerCase().includes(J))&&!((le=ne.invoiceNo)!=null&&le.toLowerCase().includes(J)))return!1}return!0}),j=Q.reduce((ne,V)=>{const he=V.partyName||"Unknown";return ne[he]||(ne[he]=[]),ne[he].push(V),ne},{}),P=Object.keys(j).sort();return c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsxs("div",{children:[c.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Master Sheet"}),c.jsxs("p",{style:{margin:"4px 0 0",fontSize:"14px",color:"#64748B"},children:[_e.length," campaigns  ",vn.length," parties  ",_e.filter(ne=>ne.invoiceGenerated).length," invoiced"]})]}),c.jsxs("div",{style:{display:"flex",gap:"10px"},children:[c.jsx("input",{type:"file",ref:pl,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:uF}),c.jsx(qe,{icon:js,label:"Upload Data",variant:"brand",onClick:()=>{var ne;return(ne=pl.current)==null?void 0:ne.click()}}),lr&&_e.length>0&&c.jsx(qe,{icon:Ls,label:"Clear All Data",variant:"danger",onClick:()=>bs(!0)})]})]}),c.jsxs("div",{style:{display:"flex",gap:"4px",marginBottom:"16px",backgroundColor:"#F1F5F9",padding:"4px",borderRadius:"10px",width:"fit-content"},children:[c.jsxs("button",{onClick:()=>hc("open"),style:{padding:"10px 20px",fontSize:"14px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:rn==="open"?"#FFFFFF":"transparent",color:rn==="open"?"#1E293B":"#64748B",boxShadow:rn==="open"?"0 2px 4px rgba(0,0,0,0.1)":"none"},children:[" Open Invoices (",E.length,")"]}),c.jsxs("button",{onClick:()=>hc("closed"),style:{padding:"10px 20px",fontSize:"14px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:rn==="closed"?"#FFFFFF":"transparent",color:rn==="closed"?"#1E293B":"#64748B",boxShadow:rn==="closed"?"0 2px 4px rgba(0,0,0,0.1)":"none"},children:[" Closed Invoices (",h.length,")"]})]}),_e.length>0&&kF(),P.length===0?c.jsx(Xr,{children:c.jsxs("div",{style:{padding:"60px",textAlign:"center",color:"#94A3B8"},children:[c.jsx(js,{size:48,style:{marginBottom:"16px",opacity:.5}}),c.jsx("div",{style:{fontSize:"18px",fontWeight:"600"},children:M?"No matching records":rn==="closed"?"No closed invoices yet":"No Data Yet"}),c.jsx("div",{style:{fontSize:"14px",marginTop:"4px"},children:M?"Try adjusting your filters":rn==="closed"?"Invoices will appear here once billed, mailed, and payment received":"Upload an Excel file to get started"})]})}):c.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:P.map(ne=>{const V=j[ne],he=Zf.has(ne),ie=V.filter(J=>J.toBeBilled==="Yes").length,ge=V.filter(J=>J.invoiceGenerated).length,le=V.filter(J=>J.toBeBilled==="Yes").reduce((J,be)=>J+(parseFloat(be.totalWithGst)||0),0);return c.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:[c.jsxs("div",{onClick:()=>my(ne),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",backgroundColor:rn==="closed"?"#F0FDF4":"#F8FAFC",cursor:"pointer",borderBottom:he?"3px solid #2874A6":"none"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[he?c.jsx(Gg,{size:22,color:"#2874A6"}):c.jsx(L0,{size:22,color:"#64748B"}),c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"700",fontSize:"16px",color:"#1E293B"},children:ne}),c.jsxs("div",{style:{fontSize:"13px",color:"#64748B",marginTop:"3px"},children:[V.length," campaigns  ",ie," billed  ",ge," invoiced"]})]})]}),le>0&&c.jsxs("div",{style:{textAlign:"right"},children:[c.jsx("div",{style:{fontSize:"11px",color:"#64748B",textTransform:"uppercase"},children:"Total"}),c.jsx("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:tt(le)})]})]}),he&&c.jsx("div",{style:{overflowX:"auto"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px",minWidth:"2100px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F1F5F9"},children:[c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Date"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"100px"},children:"Sender"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",minWidth:"180px"},children:"Campaign / Subject"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"160px"},children:"Email ID"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"70px"},children:"Mailer"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"80px"},children:"Bill?"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"right",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Amount"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Type"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Generate"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"110px"},children:"Invoice No."}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"90px"},children:"Inv Date"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"right",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"100px"},children:"Inv Amount"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#7C3AED",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"50px"},children:"C#"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"120px"},children:"Status/Approve"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"120px"},children:"Actions"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#059669",borderBottom:"2px solid #E2E8F0",backgroundColor:"#F0FDF4",width:"80px"},children:"Mailed?"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#059669",borderBottom:"2px solid #E2E8F0",backgroundColor:"#F0FDF4",width:"90px"},children:"Mail Date"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#7C3AED",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"100px"},children:"Receipt"})]})}),c.jsx("tbody",{children:V.map(J=>{var Te,Ve;const be=J.invoiceType==="Combined"&&d(J.combinationCode)&&J.mailingSent!=="Yes";oe(J);const se=In[J.id]&&In[J.id].length>0;return c.jsxs("tr",{style:{backgroundColor:J.toBeBilled==="Yes"?J.invoiceGenerated?"#F0FDF4":"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #F1F5F9"},children:[c.jsx("td",{style:{padding:"12px 14px",whiteSpace:"nowrap",fontSize:"13px"},children:Ft(J.date)}),c.jsx("td",{style:{padding:"12px 14px",fontWeight:"600",fontSize:"13px"},children:J.senderName}),c.jsxs("td",{style:{padding:"12px 14px"},children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",lineHeight:"1.4",color:"#1E293B"},children:((Ve=(Te=J.campaignName)==null?void 0:Te.split("--")[0])==null?void 0:Ve.trim())||J.senderName}),J.subject&&c.jsx("div",{style:{fontSize:"12px",color:"#64748B",marginTop:"4px",lineHeight:"1.3"},children:J.subject})]}),c.jsx("td",{style:{padding:"10px 14px"},children:c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[J.emailId&&c.jsx("div",{style:{fontSize:"11px",color:"#1E40AF",backgroundColor:"#EFF6FF",padding:"2px 6px",borderRadius:"4px",display:"inline-block"},children:J.emailId}),(J.additionalEmails||[]).map((Qe,rt)=>c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[c.jsx("span",{style:{fontSize:"11px",color:"#059669",backgroundColor:"#F0FDF4",padding:"2px 6px",borderRadius:"4px"},children:Qe}),c.jsx("button",{onClick:()=>$e(J.id,Qe),style:{background:"none",border:"none",cursor:"pointer",padding:"2px",color:"#DC2626"},title:"Remove",children:c.jsx(Na,{size:12})})]},rt)),c.jsxs("button",{onClick:()=>{Rr(J),Js(""),pt(!0)},style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",color:"#2874A6",background:"none",border:"none",cursor:"pointer",padding:"2px 0"},children:[c.jsx(q2,{size:12})," Add"]})]})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:se?c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[c.jsx("span",{style:{color:"#22C55E",fontWeight:"700",fontSize:"14px"},children:""}),c.jsx("button",{onClick:()=>{Rr(J),os(null),fl(!0),en(!0)},style:{fontSize:"10px",color:"#64748B",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},children:"Replace"})]}):c.jsx(qe,{icon:bj,small:!0,variant:"default",onClick:()=>{Rr(J),os(null),fl(!1),en(!0)}})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:c.jsxs("select",{value:J.toBeBilled,onChange:Qe=>fF(J.id,Qe.target.value),disabled:J.invoiceGenerated||!xn,style:{padding:"6px 8px",fontSize:"12px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:J.toBeBilled==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:J.toBeBilled==="Yes"?"#DCFCE7":"#FFFFFF",color:J.toBeBilled==="Yes"?"#166534":"#64748B",cursor:J.invoiceGenerated||!xn?"not-allowed":"pointer",width:"70px",opacity:!xn&&!J.invoiceGenerated?.6:1},children:[c.jsx("option",{value:"Not Yet",children:"Not Yet"}),c.jsx("option",{value:"Yes",children:"Yes"})]})}),c.jsx("td",{style:{padding:"10px 14px"},children:c.jsx("input",{type:"number",value:J.invoiceAmount||"",onChange:Qe=>a0(J.id,"invoiceAmount",Qe.target.value),disabled:J.invoiceGenerated,placeholder:"0",style:{width:"80px",padding:"6px 8px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #D1D5DB",borderRadius:"6px",textAlign:"right",backgroundColor:J.invoiceGenerated?"#F3F4F6":"#FFFFFF"}})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:J.invoiceGenerated?c.jsx(X0,{status:J.invoiceType,small:!0}):J.toBeBilled==="Yes"?c.jsxs("select",{value:J.invoiceType||"Individual",onChange:Qe=>a0(J.id,"invoiceType",Qe.target.value),style:{padding:"6px 6px",fontSize:"11px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:J.invoiceType==="Combined"?"#7C3AED":"#A5B4FC",backgroundColor:J.invoiceType==="Combined"?"#F3E8FF":"#E0E7FF",color:J.invoiceType==="Combined"?"#6B21A8":"#3730A3",cursor:"pointer",width:"80px"},children:[c.jsx("option",{value:"Individual",children:"Individual"}),c.jsx("option",{value:"Combined",children:"Combined"})]}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:J.toBeBilled==="Yes"&&!J.invoiceGenerated&&J.invoiceAmount&&lr?J.invoiceType==="Individual"?c.jsx(qe,{icon:wl,label:"Create",small:!0,variant:"warning",onClick:()=>hF(J)}):c.jsx(qe,{icon:Dj,label:"Combine",small:!0,variant:"purple",onClick:()=>mF(J)}):J.toBeBilled==="Yes"&&!J.invoiceGenerated&&J.invoiceAmount&&xn?c.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Finance to create"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF"},children:J.invoiceNo?c.jsx("span",{style:{fontWeight:"700",color:"#1E40AF",fontSize:"12px"},children:J.invoiceNo}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF",fontSize:"12px"},children:J.invoiceDate?Ft(J.invoiceDate):"-"}),c.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF",textAlign:"right",fontWeight:"700",color:"#1E40AF",fontSize:"13px"},children:J.invoiceTotalAmount?jt(J.invoiceTotalAmount):"-"}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:J.combinationCode&&J.combinationCode!=="NA"?c.jsx("span",{style:{fontWeight:"700",color:"#7C3AED",fontSize:"12px"},children:J.combinationCode}):"-"}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:J.invoiceGenerated?xn?c.jsx("button",{onClick:()=>Qt(J),style:{padding:"5px 10px",fontSize:"11px",fontWeight:"700",border:"1.5px solid",borderRadius:"6px",cursor:"pointer",backgroundColor:J.invoiceStatus==="Approved"?"#DCFCE7":J.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",borderColor:J.invoiceStatus==="Approved"?"#22C55E":J.invoiceStatus==="Need Edits"?"#DC2626":"#F59E0B",color:J.invoiceStatus==="Approved"?"#166534":J.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:J.invoiceStatus==="Approved"?" Approved":J.invoiceStatus==="Need Edits"?" Need Edits":" Review"}):c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px"},children:[c.jsx("span",{style:{padding:"4px 10px",fontSize:"11px",fontWeight:"700",borderRadius:"6px",backgroundColor:J.invoiceStatus==="Approved"?"#DCFCE7":J.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",color:J.invoiceStatus==="Approved"?"#166534":J.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:J.invoiceStatus==="Approved"?" Approved":J.invoiceStatus==="Need Edits"?" Need Edits":" Pending"}),(J.editComments||J.approvalRemarks)&&c.jsx("button",{onClick:()=>{Rr(J),hr(!0)},style:{fontSize:"9px",color:J.invoiceStatus==="Need Edits"?"#991B1B":"#166534",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},title:J.editComments||J.approvalRemarks,children:"View Remarks"})]}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:J.invoiceGenerated&&J.invoiceStatus==="Approved"?c.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[c.jsx(qe,{icon:j0,small:!0,onClick:()=>Ku(J),title:"View Invoice"}),lr&&c.jsx(qe,{icon:Xg,small:!0,variant:"brand",onClick:()=>{Rr(J),rs(!0)},title:"Send Email"}),lr&&c.jsx(qe,{icon:Ls,small:!0,variant:"danger",onClick:()=>yl(J),title:"Delete"})]}):J.invoiceGenerated?c.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[c.jsx(qe,{icon:j0,small:!0,onClick:()=>Ku(J),title:"View Invoice"}),lr&&c.jsx(qe,{icon:Ls,small:!0,variant:"danger",onClick:()=>yl(J),title:"Delete"})]}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#F0FDF4"},children:J.invoiceGenerated&&J.invoiceStatus==="Approved"&&lr?be?c.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Combined sent"}):c.jsxs("select",{value:J.mailingSent||"No",onChange:Qe=>a0(J.id,"mailingSent",Qe.target.value),style:{padding:"5px 8px",fontSize:"11px",fontWeight:"700",border:"2px solid",borderRadius:"6px",borderColor:J.mailingSent==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:J.mailingSent==="Yes"?"#DCFCE7":"#FFFFFF",color:J.mailingSent==="Yes"?"#166534":"#64748B",cursor:"pointer",width:"60px"},children:[c.jsx("option",{value:"No",children:"No"}),c.jsx("option",{value:"Yes",children:"Yes"})]}):J.invoiceGenerated&&J.invoiceStatus==="Approved"&&xn?c.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"11px",fontWeight:"600",backgroundColor:J.mailingSent==="Yes"?"#DCFCE7":"#FEF3C7",color:J.mailingSent==="Yes"?"#166534":"#92400E"},children:J.mailingSent==="Yes"?" Yes":" No"}):J.invoiceGenerated&&J.invoiceStatus!=="Approved"?c.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Approve first"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#F0FDF4"},children:J.mailingSent==="Yes"?lr?c.jsx("input",{type:"date",value:J.mailDate||J.invoiceDate||"",onChange:Qe=>a0(J.id,"mailDate",Qe.target.value),style:{padding:"4px 6px",fontSize:"11px",border:"1.5px solid #D1D5DB",borderRadius:"6px",width:"100%"}}):c.jsx("span",{style:{fontSize:"11px"},children:Ft(J.mailDate||J.invoiceDate)}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:J.receiptStatus==="Received"||J.receiptStatus==="Closed"?c.jsxs("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"700",backgroundColor:"#DCFCE7",color:"#166534"},children:[" ",J.receiptNo||"Received"]}):J.receiptStatus==="Cancelled"?c.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:" Cancelled"}):J.invoiceGenerated&&J.invoiceStatus==="Approved"?c.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"600",backgroundColor:"#FEF3C7",color:"#92400E"},children:" Pending"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})})]},J.id)})})]})})]},ne)})}),z.length>0&&c.jsxs("div",{style:{marginTop:"16px",padding:"16px 20px",backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsxs("div",{style:{display:"flex",gap:"24px",fontSize:"14px",color:"#475569"},children:[c.jsxs("span",{children:[" Total: ",c.jsx("strong",{children:Q.length})]}),c.jsxs("span",{children:[" To Bill: ",c.jsx("strong",{children:Q.filter(ne=>ne.toBeBilled==="Yes").length})]}),c.jsxs("span",{children:[" Invoiced: ",c.jsx("strong",{children:Q.filter(ne=>ne.invoiceGenerated).length})]}),c.jsxs("span",{children:[" Approved: ",c.jsx("strong",{children:Q.filter(ne=>ne.invoiceStatus==="Approved").length})]}),rn==="closed"&&c.jsxs("span",{children:[" Closed: ",c.jsx("strong",{children:Q.filter(ne=>ne.receiptStatus==="Received"||ne.receiptStatus==="Cancelled"||ne.receiptStatus==="Closed").length})]})]}),c.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:["Total: ",tt(Q.filter(ne=>ne.toBeBilled==="Yes").reduce((ne,V)=>ne+(parseFloat(V.totalWithGst)||0),0))]})]})]})},CF=h=>{var Q;const E=(Q=h.target.files)==null?void 0:Q[0];if(!E)return;const z=new FileReader;z.onload=j=>{const P=Cl(j.target.result,{type:"binary",cellDates:!0}),ne=P.SheetNames[0],V=P.Sheets[ne],he=Ar.sheet_to_json(V,{raw:!1}),ie=new Set(Ui.map(se=>`${se.date}|${se.time||""}|${se.campaignName||""}|${se.subject}`.toLowerCase()));let ge=0,le=0;const J=he.map((se,Te)=>{const Ve=se["CAMPAIGN NAME"]||se["Campaign Name"]||se["SERVICE TYPE"]||se["Service Type"]||"",Qe=dw(Ve);let rt=se.DATE||se.Date||new Date;typeof rt=="string"&&(rt=new Date(rt));const Be=(se["PARTY NAME"]||se["Party Name"]||"").trim(),et=se["SENDER NAME"]||se["Sender Name"]||"",De=se.SUBJECT||se.Subject||se.DESCRIPTION||se.Description||"",st=se.TIME||se.Time||"",Ct=hi[Be]||"",wt=rt instanceof Date&&!isNaN(rt)?rt.toISOString().split("T")[0]:"",at=`${wt}|${st}|${Ve}|${De}`.toLowerCase();return ie.has(at)?(ge++,null):(ie.add(at),le++,{id:Date.now()+Te+Math.random(),sno:se.SNO||se["SNO."]||se.Sno||Te+1,date:wt,month:se.Month||se.MONTH||"",time:st,statePartyDetails:se["State/Party Details"]||se["STATE/PARTY DETAILS"]||se.STATE||se.State||"",partyName:Be,senderName:et,campaignName:Ve,subject:De,emailId:Qe||se.EMAIL||se.Email||"",additionalEmails:[],toBeBilled:"Not Yet",invoiceAmount:se.AMOUNT||se.Amount||Ct||"",cgst:"",sgst:"",igst:"",totalWithGst:"",invoiceType:"Individual",combinationCode:"NA",invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",mailingSent:"No",mailerUploaded:!1,editComments:"",isService:!0})}).filter(se=>se!==null);if(J.length>0){Se(Te=>[...Te,...J]);const se=[...new Set(J.map(Te=>Te.partyName))];de(Te=>{const Ve=new Set(Te);return se.forEach(Qe=>Ve.add(Qe)),Ve})}let be=` Services Upload Complete!

`;be+=` ${le} new entries added
`,ge>0&&(be+=` ${ge} duplicate entries skipped`),le>0&&Wn("upload",` ${le} new services uploaded`,"director"),alert(be)},z.readAsBinaryString(E),h.target.value=""},vy=(h,E,z)=>{Se(Q=>Q.map(j=>j.id===h?{...j,[E]:z}:j))},FF=h=>{de(E=>{const z=new Set(E);return z.has(h)?z.delete(h):z.add(h),z})},bF=h=>{const E=Me.find(z=>z.id===h);if(E!=null&&E.invoiceGenerated&&(E==null?void 0:E.invoiceStatus)==="Approved"){alert("Cannot delete approved invoices");return}confirm("Delete this service entry?")&&Se(z=>z.filter(Q=>Q.id!==h))},IF=h=>{var ge;const E=Me.find(le=>le.id===h);if(!E)return;if(!E.invoiceAmount||parseFloat(E.invoiceAmount)<=0){alert("Please enter a valid invoice amount");return}const z=`${S.invoicePrefix}${Ke}`,Q=new Date().toISOString().split("T")[0],j=(ge=E.statePartyDetails)==null?void 0:ge.toUpperCase().includes("MAHARASHTRA"),P=parseFloat(E.invoiceAmount),ne=j?P*.09:0,V=j?P*.09:0,he=j?0:P*.18,ie=P+ne+V+he;Se(le=>le.map(J=>J.id===h?{...J,invoiceNo:z,invoiceDate:Q,invoiceTotalAmount:ie.toFixed(2),cgst:ne.toFixed(2),sgst:V.toFixed(2),igst:he.toFixed(2),totalWithGst:ie.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created"}:J)),ir(le=>le+1),Wn("invoice_created",`Service Invoice ${z} created for ${E.partyName}`,"director")},yy=(h,E,z="")=>{E==="approve"?(Se(Q=>Q.map(j=>j.id===h.id?{...j,invoiceStatus:"Approved",directorRemarks:z||null}:j)),Wn("invoice_approved",`Service Invoice ${h.invoiceNo} approved`,"finance")):E==="needsEdit"&&(Se(Q=>Q.map(j=>j.id===h.id?{...j,invoiceStatus:"Need Edits",directorRemarks:z}:j)),Wn("invoice_needs_edit",`Service Invoice ${h.invoiceNo}: ${z}`,"finance"))},_y=h=>{const E=getPartyGstinFromMaster(h.partyName,h.statePartyDetails),z=xl(h.partyName,h.statePartyDetails),Q=h.statePartyDetails,j=parseFloat(h.invoiceAmount)||0,P=parseFloat(h.cgst)||0,ne=parseFloat(h.sgst)||0,V=parseFloat(h.igst)||0,he=parseFloat(h.invoiceTotalAmount)||j+P+ne+V,ie=P>0,ge=`
<!DOCTYPE html>
<html>
<head>
  <title>Tax Invoice - ${h.invoiceNo}</title>
  <style>
    @media print { body { -webkit-print-color-adjust: exact !important; } @page { size: A4; margin: 10mm; } }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; font-size: 12px; }
    .invoice-container { max-width: 800px; margin: 0 auto; border: 2px solid #000; }
  </style>
</head>
<body>
  <div class="invoice-container">
    <div style="text-align: center; padding: 15px; border-bottom: 2px solid #000; font-size: 20px; font-weight: bold;">Tax Invoice</div>
    <div style="text-align: center; padding: 5px; border-bottom: 1px solid #000; font-style: italic; font-size: 11px; background: #f5f5f5;">(Original for Recipient)</div>
    <div style="display: flex; border-bottom: 2px solid #000;">
      <div style="flex: 1.5; padding: 12px; border-right: 2px solid #000;">
        <div style="font-size: 16px; font-weight: bold; color: #1a5276; margin-bottom: 8px;">${S.name}</div>
        <div style="font-size: 11px; line-height: 1.5;">${S.address}<br>${S.addressLine2}, ${S.city}<br><strong>GSTIN/UIN:</strong> ${S.gstin}<br><strong>State:</strong> ${S.stateName}, Code: ${S.stateCode}<br><strong>Contact:</strong> ${S.phone}<br><strong>E-Mail:</strong> ${S.email}</div>
      </div>
      <div style="flex: 1; padding: 0;">
        <div style="display: flex; border-bottom: 1px solid #000;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Invoice No.</div><div style="flex: 1; padding: 8px; color: #1a5276; font-weight: bold;">${h.invoiceNo}</div></div>
        <div style="display: flex;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Dated</div><div style="flex: 1; padding: 8px;">${Ft(h.invoiceDate)}</div></div>
      </div>
    </div>
    <div style="padding: 10px 12px; border-bottom: 2px solid #000; background: #fafafa;">
      <div style="font-size: 11px; color: #666; margin-bottom: 3px;">Buyer (Bill to)</div>
      <div style="font-size: 14px; font-weight: bold; margin-bottom: 4px; color: #1a5276;">${h.partyName}</div>
      <div style="font-size: 11px; color: #333;">${z?z+"<br>":""}${Q||""}${E?"<br><strong>GSTIN/UIN:</strong> "+E:""}<br>Place of Supply: ${Q||S.stateName}</div>
    </div>
    <table style="width: 100%; border-collapse: collapse;">
      <thead><tr style="background: #e8e8e8;"><th style="border: 1px solid #000; padding: 10px; width: 45px;">Sl No.</th><th style="border: 1px solid #000; padding: 10px;">Particulars</th><th style="border: 1px solid #000; padding: 10px; width: 80px;">HSN/SAC</th><th style="border: 1px solid #000; padding: 10px; width: 100px; text-align: right;">Amount</th></tr></thead>
      <tbody>
        <tr>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">1</td>
          <td style="border: 1px solid #000; padding: 8px;">
            <div style="font-weight: 600;">${(h.campaignName||"SERVICE").toUpperCase()}</div>
            <div style="font-style: italic; color: #555; font-size: 11px; margin-top: 2px;">${h.subject||""}</div>
            <div style="font-style: italic; color: #555; font-size: 11px;">Date: ${Ft(h.date)}</div>
          </td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${S.hsnCode}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: right;">${jt(j)}</td>
        </tr>
        ${ie?`
          <tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600;">CGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right;">${jt(P)}</td></tr>
          <tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600;">SGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right;">${jt(ne)}</td></tr>
        `:`
          <tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600;">IGST @ 18%</td><td style="border: 1px solid #000; padding: 8px; text-align: right;">${jt(V)}</td></tr>
        `}
        <tr style="background: #2874A6; color: white;"><td colspan="3" style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;">Total</td><td style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;"> ${he.toLocaleString("en-IN",{minimumFractionDigits:2})}</td></tr>
      </tbody>
    </table>
    <div style="padding: 10px 12px; border: 1px solid #000; border-top: none; background: #fafafa;"><div style="color: #666; font-size: 11px; margin-bottom: 3px;">Amount Chargeable (in words)</div><div style="font-weight: bold; font-size: 13px;">${Y0(he)}</div></div>
    <div style="display: flex; border-top: 2px solid #000;">
      <div style="flex: 1; padding: 10px 12px; border-right: 2px solid #000; font-size: 11px;"><div><strong>Company's PAN:</strong> ${S.pan}</div><div style="margin-top: 4px;"><strong>MSME Reg. No.:</strong> UDYAM-MH-19-0057219</div></div>
      <div style="flex: 1.2; padding: 10px 12px; font-size: 11px;">
        <div style="font-weight: bold; margin-bottom: 6px; color: #1a5276;">Company's Bank Details</div>
        <div style="line-height: 1.5;"><strong>A/c Holder:</strong> ${S.bank.holder}<br><strong>Bank:</strong> ${S.bank.name}<br><strong>A/c No.:</strong> ${S.bank.account}<br><strong>IFSC:</strong> ${S.bank.ifsc}</div>
        <div style="text-align: right; margin-top: 30px;"><div style="font-weight: bold;">for ${S.name}</div><div style="margin-top: 25px; border-top: 1px solid #000; display: inline-block; padding-top: 4px; font-size: 10px;">Authorised Signatory</div></div>
      </div>
    </div>
    <div style="text-align: center; padding: 8px; background: #f0f0f0; border-top: 1px solid #000; font-size: 10px; color: #666; font-style: italic;">This is a Computer Generated Invoice</div>
  </div>
</body>
</html>`,le=window.open("","_blank");le.document.write(ge),le.document.close(),le.print()},NF=ve.useMemo(()=>[...new Set(Ui.map(h=>h.partyName).filter(Boolean))].sort(),[Ui]),Ey=ve.useMemo(()=>Ui.filter(h=>!(pe.party&&h.partyName!==pe.party||pe.billStatus&&h.toBeBilled!==pe.billStatus||pe.invoiceStatus&&(pe.invoiceStatus==="Pending"&&h.invoiceGenerated||pe.invoiceStatus==="Created"&&h.invoiceStatus!=="Created"||pe.invoiceStatus==="Approved"&&h.invoiceStatus!=="Approved"||pe.invoiceStatus==="Need Edits"&&h.invoiceStatus!=="Need Edits"))),[Ui,pe]),RF=()=>{const h=r==="director",E=r==="finance",z=Ey.filter(V=>!V.invoiceGenerated||V.invoiceStatus!=="Approved"),Q=Ey.filter(V=>V.invoiceGenerated&&V.invoiceStatus==="Approved"),j=Ns==="open"?z:Q,P={};j.forEach(V=>{const he=V.partyName||"Unknown";P[he]||(P[he]=[]),P[he].push(V)});const ne=Object.keys(P).sort();return c.jsxs("div",{style:{padding:"20px"},children:[c.jsx("input",{type:"file",ref:gl,onChange:CF,accept:".xlsx,.xls,.csv",style:{display:"none"}}),c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[c.jsxs("div",{children:[c.jsx("h1",{style:{fontSize:"22px",fontWeight:"700",color:"#1E293B",marginBottom:"4px"},children:" Services Sheet"}),c.jsx("p",{style:{fontSize:"13px",color:"#64748B"},children:"Non-campaign invoices (same workflow as Master Sheet)"})]}),c.jsx("div",{style:{display:"flex",gap:"10px"},children:E&&c.jsxs(c.Fragment,{children:[c.jsx(qe,{icon:js,label:"Upload Excel",onClick:()=>{var V;return(V=gl.current)==null?void 0:V.click()}}),c.jsx(qe,{icon:sd,label:"Add Entry",variant:"primary",onClick:()=>B(!0)})]})})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsx(id,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"}),c.jsxs("select",{value:pe.party,onChange:V=>ue(he=>({...he,party:V.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"},children:[c.jsx("option",{value:"",children:"All Parties"}),NF.map(V=>c.jsx("option",{value:V,children:V},V))]}),c.jsxs("select",{value:pe.billStatus,onChange:V=>ue(he=>({...he,billStatus:V.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"},children:[c.jsx("option",{value:"",children:"All Bill Status"}),c.jsx("option",{value:"Yes",children:"To Be Billed"}),c.jsx("option",{value:"No",children:"Not Billing"}),c.jsx("option",{value:"Not Yet",children:"Not Yet"})]}),c.jsxs("select",{value:pe.invoiceStatus,onChange:V=>ue(he=>({...he,invoiceStatus:V.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"},children:[c.jsx("option",{value:"",children:"All Invoice Status"}),c.jsx("option",{value:"Pending",children:"Pending"}),c.jsx("option",{value:"Created",children:"Created"}),c.jsx("option",{value:"Approved",children:"Approved"}),c.jsx("option",{value:"Need Edits",children:"Need Edits"})]}),(pe.party||pe.billStatus||pe.invoiceStatus)&&c.jsxs("button",{onClick:()=>ue({party:"",billStatus:"",invoiceStatus:""}),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer"},children:[c.jsx(Na,{size:14})," Clear"]})]})}),c.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"20px"},children:[c.jsxs("button",{onClick:()=>b("open"),style:{padding:"10px 20px",fontSize:"13px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:Ns==="open"?"#2874A6":"#E2E8F0",color:Ns==="open"?"#FFFFFF":"#64748B"},children:["Open (",z.length,")"]}),c.jsxs("button",{onClick:()=>b("closed"),style:{padding:"10px 20px",fontSize:"13px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:Ns==="closed"?"#22C55E":"#E2E8F0",color:Ns==="closed"?"#FFFFFF":"#64748B"},children:["Closed (",Q.length,")"]})]}),c.jsx(Xr,{title:`Services - ${Ns==="open"?"Open":"Closed"}`,noPadding:!0,children:ne.length===0?c.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:[c.jsx(Yg,{size:40,style:{marginBottom:"10px",opacity:.5}}),c.jsx("p",{children:"No services in this tab"}),E&&c.jsx("p",{style:{marginTop:"10px",fontSize:"13px"},children:"Upload Excel or Add Entry to get started"})]}):ne.map(V=>{const he=P[V],ie=X.has(V),ge=he.filter(le=>le.toBeBilled==="Yes").reduce((le,J)=>le+(parseFloat(J.totalWithGst)||parseFloat(J.invoiceAmount)||0),0);return c.jsxs("div",{style:{borderBottom:"2px solid #E2E8F0"},children:[c.jsxs("div",{onClick:()=>FF(V),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",backgroundColor:Ns==="closed"?"#F0FDF4":"#F8FAFC",cursor:"pointer",borderBottom:ie?"3px solid #2874A6":"none"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[ie?c.jsx(Gg,{size:20,color:"#2874A6"}):c.jsx(L0,{size:20,color:"#64748B"}),c.jsx("span",{style:{fontWeight:"700",fontSize:"15px",color:"#1E293B"},children:V}),c.jsxs("span",{style:{padding:"4px 10px",backgroundColor:"#E0E7FF",color:"#3730A3",borderRadius:"9999px",fontSize:"12px",fontWeight:"600"},children:[he.length," items"]})]}),c.jsx("div",{style:{fontWeight:"700",color:"#059669"},children:tt(ge)})]}),ie&&c.jsx("div",{style:{overflowX:"auto"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F1F5F9"},children:[c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569"},children:"Date"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569"},children:"State"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569"},children:"Sender"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569"},children:"Campaign/Service"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569"},children:"Subject"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"To Bill"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"600",color:"#475569"},children:"Amount"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"Invoice"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"Status"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"Actions"})]})}),c.jsx("tbody",{children:he.map(le=>c.jsxs("tr",{style:{backgroundColor:le.toBeBilled==="Yes"?le.invoiceGenerated?"#F0FDF4":"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #F1F5F9"},children:[c.jsx("td",{style:{padding:"10px 8px"},children:Ft(le.date)}),c.jsx("td",{style:{padding:"10px 8px",fontSize:"11px",color:"#64748B"},children:le.statePartyDetails||"-"}),c.jsx("td",{style:{padding:"10px 8px",fontSize:"11px"},children:le.senderName||"-"}),c.jsx("td",{style:{padding:"10px 8px",fontWeight:"500",maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis"},children:le.campaignName||"-"}),c.jsx("td",{style:{padding:"10px 8px",maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis"},children:le.subject||"-"}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:c.jsx("button",{onClick:()=>h&&!le.invoiceGenerated&&vy(le.id,"toBeBilled",le.toBeBilled==="Yes"?"No":"Yes"),disabled:le.invoiceGenerated||!h,style:{padding:"6px 8px",fontSize:"12px",fontWeight:"600",border:"2px solid",borderRadius:"6px",cursor:le.invoiceGenerated||!h?"not-allowed":"pointer",borderColor:le.toBeBilled==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:le.toBeBilled==="Yes"?"#DCFCE7":"#FFFFFF",color:le.toBeBilled==="Yes"?"#166534":"#64748B",width:"70px"},children:le.toBeBilled||"Not Yet"})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"right"},children:le.invoiceGenerated?c.jsxs("span",{style:{fontWeight:"600"},children:["",parseFloat(le.invoiceAmount||0).toLocaleString("en-IN")]}):c.jsx("input",{type:"number",value:le.invoiceAmount||"",onChange:J=>vy(le.id,"invoiceAmount",J.target.value),disabled:le.invoiceGenerated,placeholder:"0",style:{width:"80px",padding:"6px",fontSize:"12px",border:"1.5px solid #E2E8F0",borderRadius:"6px",textAlign:"right"}})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:le.invoiceGenerated?c.jsx("span",{style:{fontSize:"11px",color:"#2874A6",fontWeight:"600",cursor:"pointer"},onClick:()=>_y(le),children:le.invoiceNo}):E&&le.toBeBilled==="Yes"&&le.invoiceAmount?c.jsx("button",{onClick:()=>IF(le.id),style:{padding:"6px 10px",fontSize:"11px",backgroundColor:"#2874A6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Generate"}):"-"}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:le.invoiceGenerated?c.jsx(X0,{status:le.invoiceStatus,small:!0}):"-"}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:c.jsxs("div",{style:{display:"flex",gap:"4px",justifyContent:"center"},children:[h&&le.invoiceGenerated&&le.invoiceStatus==="Created"&&c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:()=>yy(le,"approve"),style:{padding:"6px 8px",backgroundColor:"#22C55E",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},title:"Approve",children:c.jsx($g,{size:14})}),c.jsx("button",{onClick:()=>{const J=prompt("Remarks:");J&&yy(le,"needsEdit",J)},style:{padding:"6px 8px",backgroundColor:"#F59E0B",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},title:"Need Edits",children:c.jsx(Oj,{size:14})})]}),E&&!le.invoiceGenerated&&c.jsx("button",{onClick:()=>bF(le.id),style:{padding:"6px 8px",backgroundColor:"#EF4444",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},title:"Delete",children:c.jsx(Ls,{size:14})}),le.invoiceGenerated&&c.jsx("button",{onClick:()=>_y(le),style:{padding:"6px 8px",backgroundColor:"#2874A6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},title:"Print",children:c.jsx(qg,{size:14})})]})})]},le.id))})]})})]},V)})}),j.length>0&&c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"16px"},children:c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"16px 24px",borderRadius:"10px",border:"2px solid #86EFAC"},children:[c.jsx("div",{style:{fontSize:"12px",color:"#166534",fontWeight:"600",marginBottom:"4px"},children:"To Be Billed Total"}),c.jsx("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:tt(j.filter(V=>V.toBeBilled==="Yes").reduce((V,he)=>V+(parseFloat(he.totalWithGst)||parseFloat(he.invoiceAmount)||0),0))})]})}),c.jsx(wn,{isOpen:H,onClose:()=>B(!1),title:" Add Service Entry",width:"700px",children:c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"12px"},children:[c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Date *"}),c.jsx("input",{type:"date",id:"svcDate",defaultValue:new Date().toISOString().split("T")[0],style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Time"}),c.jsx("input",{type:"text",id:"svcTime",placeholder:"HH:MM",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"State"}),c.jsx("input",{type:"text",id:"svcState",placeholder:"Maharashtra",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Party Name *"}),c.jsx("input",{list:"svcPartyList",id:"svcParty",placeholder:"Party name",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}}),c.jsx("datalist",{id:"svcPartyList",children:Object.values(an).map((V,he)=>c.jsx("option",{value:V.partyName},he))})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Sender Name"}),c.jsx("input",{type:"text",id:"svcSender",placeholder:"Sender",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Campaign Name / Service Type *"}),c.jsx("input",{type:"text",id:"svcCampaign",placeholder:"e.g. Podcast Production, Video Editing",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Subject / Description *"}),c.jsx("textarea",{id:"svcSubject",rows:2,placeholder:"Description",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Email"}),c.jsx("input",{type:"email",id:"svcEmail",placeholder:"email@example.com",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Amount (without GST)"}),c.jsx("input",{type:"number",id:"svcAmount",placeholder:"0",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]})]}),c.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"8px"},children:[c.jsx(qe,{label:"Cancel",variant:"secondary",onClick:()=>B(!1)}),c.jsx(qe,{label:"Add Entry",icon:sd,onClick:()=>{var le,J,be,se,Te,Ve,Qe,rt,Be,et,De,st;const V=(J=(le=document.getElementById("svcParty"))==null?void 0:le.value)==null?void 0:J.trim(),he=(se=(be=document.getElementById("svcCampaign"))==null?void 0:be.value)==null?void 0:se.trim(),ie=(Ve=(Te=document.getElementById("svcSubject"))==null?void 0:Te.value)==null?void 0:Ve.trim();if(!V||!he||!ie){alert("Fill required fields");return}const ge={id:Date.now().toString(),sno:Ui.length+1,date:((Qe=document.getElementById("svcDate"))==null?void 0:Qe.value)||new Date().toISOString().split("T")[0],time:((rt=document.getElementById("svcTime"))==null?void 0:rt.value)||"",month:"",statePartyDetails:((Be=document.getElementById("svcState"))==null?void 0:Be.value)||"",partyName:V,senderName:((et=document.getElementById("svcSender"))==null?void 0:et.value)||"",campaignName:he,subject:ie,emailId:((De=document.getElementById("svcEmail"))==null?void 0:De.value)||"",additionalEmails:[],toBeBilled:"Not Yet",invoiceAmount:((st=document.getElementById("svcAmount"))==null?void 0:st.value)||"",cgst:"",sgst:"",igst:"",totalWithGst:"",invoiceType:"Individual",combinationCode:"NA",invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",mailingSent:"No",mailerUploaded:!1,editComments:"",isService:!0};Se(Ct=>[...Ct,ge]),de(Ct=>new Set([...Ct,V])),B(!1)}})]})]})})]})},DF=h=>{const E=[],z={};h.forEach(P=>{const ne=P.partyName||"Unknown";z[ne]||(z[ne]=[]),z[ne].push(P)}),Object.keys(z).sort().forEach(P=>{z[P].forEach(V=>{const he=V.cnMatch,ie=he?Math.abs(parseFloat(he.isSystemCN?he.totalAmount:he.credit)||0):0,ge=je.filter(Te=>Te.invoiceNo===V.invoiceNo),le=ge.reduce((Te,Ve)=>Te+(parseFloat(Ve.amount)||0),0),J=ge.reduce((Te,Ve)=>Te+(parseFloat(Ve.tdsAmount)||0),0),be=V.totalAmount-le-J-ie;let se="Pending";be<=0?ie>=V.totalAmount?se="Cancelled":se="Paid":(le>0||J>0)&&(se="Partial"),E.push({"Party Name":P,"Invoice No":V.invoiceNo,Date:Ft(V.date),Type:V.isService?"Service":V.invoiceType||"Individual",Amount:V.totalAmount,Received:le||"",TDS:J||"","CN Amount":ie||"",Balance:be,"Invoice Status":V.invoiceStatus,"Receipt Status":se,"Receipt No":ge.map(Te=>Te.receiptNo).join(", "),"CN No":he?he.isSystemCN?he.creditNoteNo:he.vchNo:""})})});const Q=Ar.json_to_sheet(E),j=Ar.book_new();Ar.book_append_sheet(j,Q,"Invoice Register"),bc(j,`Invoice_Register_${new Date().toISOString().split("T")[0]}.xlsx`)},PF=()=>{const h=Ar.book_new();let E=0;if(zi.forEach(z=>{const Q=z.partyName,j=z.normalizedState,P=fi[Q]||0,ne=[...on,...Ui].filter(Be=>Gt(Be.partyName,Q)&&Be.invoiceGenerated&&Be.invoiceStatus==="Approved"&&(!j||pi(Be.statePartyDetails)===j)),V=new Map;ne.forEach(Be=>{V.has(Be.invoiceNo)?V.get(Be.invoiceNo).campaigns.push(Be):V.set(Be.invoiceNo,{invoiceNo:Be.invoiceNo,invoiceDate:Be.invoiceDate,campaigns:[Be]})});const he=new Set(Array.from(V.keys())),ie=je.filter(Be=>Gt(Be.partyName,Q)&&(!j||he.has(Be.invoiceNo))),ge=re.filter(Be=>Gt(Be.partyName,Q)&&(!j||he.has(Be.invoiceNo))),le=j?[]:zn.filter(Be=>{var et;return Gt(Be.partyName,Q)&&Be.isHistorical&&!((et=Be.vchNo)!=null&&et.toUpperCase().startsWith("CN"))}),J=j?[]:zn.filter(Be=>{var et;return Gt(Be.partyName,Q)&&Be.isHistorical&&((et=Be.vchNo)==null?void 0:et.toUpperCase().startsWith("CN"))}),be=[];let se=P,Te=0,Ve=0,Qe=0,rt=0;if(be.push({Date:Q}),be.push({Date:"Ledger Account"}),j&&be.push({Date:`State: ${z.state}`}),z.gstin&&be.push({Date:`GSTIN: ${z.gstin}`}),be.push({}),be.push({Date:"Date",Particulars:"Particulars",VchType:"Vch Type",VchNo:"Vch No.",Debit:"Debit",Credit:"Credit",AmtReceived:"Amt Received",TDS:"TDS",Balance:"Balance"}),P!==0&&(be.push({Date:"",Particulars:"Opening Balance",VchType:"",VchNo:"",Debit:P>0?P:"",Credit:P<0?Math.abs(P):"",AmtReceived:"",TDS:"",Balance:P}),P>0?Te+=P:Ve+=Math.abs(P)),Array.from(V.values()).sort((Be,et)=>new Date(Be.invoiceDate)-new Date(et.invoiceDate)).forEach(Be=>{const et=Be.campaigns.reduce((at,_n)=>at+(parseFloat(_n.invoiceTotalAmount)||0),0),De=ie.filter(at=>at.invoiceNo===Be.invoiceNo),st=ge.filter(at=>at.invoiceNo===Be.invoiceNo),Ct=De.reduce((at,_n)=>at+(parseFloat(_n.amount)||0),0),wt=De.reduce((at,_n)=>at+(parseFloat(_n.tdsAmount)||0),0);se+=et,Te+=et,be.push({Date:Ft(Be.invoiceDate),Particulars:Q,VchType:"Sales",VchNo:Be.invoiceNo,Debit:et,Credit:"",AmtReceived:Ct||"",TDS:wt||"",Balance:se}),Be.campaigns.forEach(at=>{be.push({Date:"",Particulars:`     ${at.campaignName||at.subject||"Service"}`,VchType:"",VchNo:"",Debit:"",Credit:"",AmtReceived:"",TDS:"",Balance:""})}),(Ct>0||wt>0)&&(se-=Ct+wt,Qe+=Ct,rt+=wt,Ve+=Ct+wt),st.forEach(at=>{const _n=Math.abs(parseFloat(at.totalAmount)||0);se-=_n,Ve+=_n,be.push({Date:Ft(at.date),Particulars:`Credit Note - ${at.reason||"Adjustment"}`,VchType:"Credit Note",VchNo:at.creditNoteNo,Debit:"",Credit:_n,AmtReceived:"",TDS:"",Balance:se})})}),le.forEach(Be=>{const et=parseFloat(Be.debit)||0,De=parseFloat(Be.credit)||0;se+=et-De,Te+=et,Ve+=De,be.push({Date:Ft(Be.date),Particulars:Be.particular||Q,VchType:Be.vchType||"Sales",VchNo:Be.vchNo||"",Debit:et||"",Credit:De||"",AmtReceived:"",TDS:"",Balance:se})}),J.forEach(Be=>{const et=Math.abs(parseFloat(Be.credit)||parseFloat(Be.debit)||0);se-=et,Ve+=et,be.push({Date:Ft(Be.date),Particulars:Be.particular||"Credit Note",VchType:"Credit Note",VchNo:Be.vchNo||"",Debit:"",Credit:et,AmtReceived:"",TDS:"",Balance:se})}),be.push({}),be.push({Date:"",Particulars:"TOTAL",VchType:"",VchNo:"",Debit:Te,Credit:Ve,AmtReceived:Qe,TDS:rt,Balance:""}),be.push({Date:"",Particulars:"Closing Balance",VchType:"",VchNo:"",Debit:se>0?se:"",Credit:se<0?Math.abs(se):"",AmtReceived:"",TDS:"",Balance:se}),be.length>7){let Be=Q.substring(0,25).replace(/[\\\/\*\?\[\]:]/g,"");j&&(Be+="-"+j.substring(0,4));let et=Be,De=1;for(;h.SheetNames.includes(et);)et=Be.substring(0,27)+De++;const st=Ar.json_to_sheet(be,{skipHeader:!0});Ar.book_append_sheet(h,st,et),E++}}),E===0){alert("No ledger data");return}bc(h,`All_Ledgers_${new Date().toISOString().split("T")[0]}.xlsx`)},OF=()=>{const h=Ni.map(P=>({Type:"Receipt","Voucher No":P.receiptNo,Date:Ft(P.date),"Party Name":P.partyName,"Against Invoice":P.invoiceNo,Amount:parseFloat(P.amount)||0,TDS:parseFloat(P.tdsAmount)||0,Total:(parseFloat(P.amount)||0)+(parseFloat(P.tdsAmount)||0),"Payment Mode":P.paymentMode||"Bank Transfer",Narration:P.narration||""})),E=cs.map(P=>({Type:"Credit Note","Voucher No":P.creditNoteNo,Date:Ft(P.date),"Party Name":P.partyName,"Against Invoice":P.invoiceNo,Amount:parseFloat(P.totalAmount)||0,TDS:"",Total:parseFloat(P.totalAmount)||0,"Payment Mode":"",Narration:P.reason||""})),z=[...h,...E],Q=Ar.json_to_sheet(z),j=Ar.book_new();Ar.book_append_sheet(j,Q,"Receipt & CN Register"),bc(j,`Receipt_CN_Register_${new Date().toISOString().split("T")[0]}.xlsx`)},MF=h=>{const E=`<!DOCTYPE html><html><head><title>Receipt - ${h.receiptNo}</title><style>@media print{@page{size:A5;margin:10mm}}*{margin:0;padding:0;box-sizing:border-box}body{font-family:Arial,sans-serif;font-size:12px;padding:20px}.voucher{max-width:600px;margin:0 auto;border:2px solid #000}.header{text-align:center;padding:15px;border-bottom:2px solid #000;background:#f5f5f5}.title{font-size:18px;font-weight:bold;color:#1a5276}.company{font-size:14px;font-weight:bold;margin-top:5px}.details{padding:15px}.row{display:flex;margin-bottom:10px}.label{width:140px;font-weight:bold}.value{flex:1}.amount-box{background:#e8f4fd;padding:15px;margin:15px 0;border-radius:8px;text-align:center}.amount{font-size:24px;font-weight:bold;color:#1a5276}.footer{padding:15px;border-top:1px solid #ddd;display:flex;justify-content:space-between}.signature{text-align:center;margin-top:40px}.signature-line{border-top:1px solid #000;width:150px;margin:0 auto;padding-top:5px}</style></head><body><div class="voucher"><div class="header"><div class="title">RECEIPT VOUCHER</div><div class="company">${S.name}</div><div style="font-size:10px;color:#666;margin-top:3px">${S.address}, ${S.city}</div></div><div class="details"><div class="row"><div class="label">Receipt No:</div><div class="value" style="font-weight:bold;color:#1a5276">${h.receiptNo}</div></div><div class="row"><div class="label">Date:</div><div class="value">${Ft(h.date)}</div></div><div class="row"><div class="label">Received From:</div><div class="value" style="font-weight:bold">${h.partyName}</div></div><div class="row"><div class="label">Against Invoice:</div><div class="value">${h.invoiceNo}</div></div><div class="row"><div class="label">Payment Mode:</div><div class="value">${h.paymentMode||"Bank Transfer"}</div></div>${h.narration?`<div class="row"><div class="label">Narration:</div><div class="value">${h.narration}</div></div>`:""}<div class="amount-box"><div style="font-size:12px;color:#666">Amount Received</div><div class="amount">${(parseFloat(h.amount)||0).toLocaleString("en-IN",{minimumFractionDigits:2})}</div>${h.tdsAmount&&parseFloat(h.tdsAmount)>0?`<div style="font-size:11px;color:#666;margin-top:5px">TDS: ${parseFloat(h.tdsAmount).toLocaleString("en-IN")}</div>`:""}<div style="font-size:11px;margin-top:8px"><strong>Total:</strong> ${((parseFloat(h.amount)||0)+(parseFloat(h.tdsAmount)||0)).toLocaleString("en-IN")}</div></div><div style="font-size:11px;color:#666;margin-top:10px"><strong>Amount in words:</strong> ${Y0((parseFloat(h.amount)||0)+(parseFloat(h.tdsAmount)||0))}</div></div><div class="footer"><div class="signature"><div class="signature-line">Receiver's Signature</div></div><div class="signature"><div class="signature-line">Authorised Signatory</div></div></div></div></body></html>`,z=window.open("","_blank");z.document.write(E),z.document.close(),z.print()},BF=h=>{const E=`<!DOCTYPE html><html><head><title>CN - ${h.creditNoteNo}</title><style>@media print{@page{size:A5;margin:10mm}}*{margin:0;padding:0;box-sizing:border-box}body{font-family:Arial,sans-serif;font-size:12px;padding:20px}.voucher{max-width:600px;margin:0 auto;border:2px solid #000}.header{text-align:center;padding:15px;border-bottom:2px solid #000;background:#fef3c7}.title{font-size:18px;font-weight:bold;color:#92400e}.company{font-size:14px;font-weight:bold;margin-top:5px}.details{padding:15px}.row{display:flex;margin-bottom:10px}.label{width:140px;font-weight:bold}.value{flex:1}.amount-box{background:#fef3c7;padding:15px;margin:15px 0;border-radius:8px;text-align:center}.amount{font-size:24px;font-weight:bold;color:#92400e}.footer{padding:15px;border-top:1px solid #ddd;display:flex;justify-content:space-between}.signature{text-align:center;margin-top:40px}.signature-line{border-top:1px solid #000;width:150px;margin:0 auto;padding-top:5px}</style></head><body><div class="voucher"><div class="header"><div class="title">CREDIT NOTE</div><div class="company">${S.name}</div><div style="font-size:10px;color:#666;margin-top:3px">${S.address}, ${S.city}</div></div><div class="details"><div class="row"><div class="label">Credit Note No:</div><div class="value" style="font-weight:bold;color:#92400e">${h.creditNoteNo}</div></div><div class="row"><div class="label">Date:</div><div class="value">${Ft(h.date)}</div></div><div class="row"><div class="label">Party Name:</div><div class="value" style="font-weight:bold">${h.partyName}</div></div><div class="row"><div class="label">Against Invoice:</div><div class="value">${h.invoiceNo}</div></div><div class="row"><div class="label">Reason:</div><div class="value">${h.reason||"Adjustment"}</div></div><div class="amount-box"><div style="font-size:12px;color:#666">Credit Amount</div><div class="amount">${(parseFloat(h.totalAmount)||0).toLocaleString("en-IN")}</div><div style="font-size:10px;color:#666;margin-top:5px">Base: ${(parseFloat(h.baseAmount)||0).toLocaleString("en-IN")} | GST: ${((parseFloat(h.cgstAmount)||0)+(parseFloat(h.sgstAmount)||0)+(parseFloat(h.igstAmount)||0)).toLocaleString("en-IN")}</div></div><div style="font-size:11px;color:#666;margin-top:10px"><strong>Amount in words:</strong> ${Y0(parseFloat(h.totalAmount)||0)}</div></div><div class="footer"><div class="signature"><div class="signature-line">Party Signature</div></div><div class="signature"><div class="signature-line">Authorised Signatory</div></div></div></div></body></html>`,z=window.open("","_blank");z.document.write(E),z.document.close(),z.print()},LF=()=>{const h=new Map;on.filter(ie=>ie.invoiceGenerated).forEach(ie=>{h.has(ie.invoiceNo)?h.get(ie.invoiceNo).campaigns.push(ie):h.set(ie.invoiceNo,{invoiceNo:ie.invoiceNo,partyName:ie.partyName,date:ie.invoiceDate,invoiceType:ie.invoiceType,combinationCode:ie.combinationCode,invoiceStatus:ie.invoiceStatus,mailingSent:ie.mailingSent,receiptStatus:ie.receiptStatus||"Pending",receiptNo:ie.receiptNo,campaigns:[ie],totalAmount:parseFloat(ie.invoiceTotalAmount)||0,isFromMaster:!0,source:"Campaign"})}),Ui.filter(ie=>ie.invoiceGenerated).forEach(ie=>{h.has(ie.invoiceNo)||h.set(ie.invoiceNo,{invoiceNo:ie.invoiceNo,partyName:ie.partyName,date:ie.invoiceDate,invoiceType:"Service",combinationCode:"NA",invoiceStatus:ie.invoiceStatus,mailingSent:ie.mailingSent,receiptStatus:ie.receiptStatus||"Pending",receiptNo:ie.receiptNo,campaigns:[ie],totalAmount:parseFloat(ie.invoiceTotalAmount)||0,isFromMaster:!1,isService:!0,source:"Service",serviceType:ie.serviceType})});const E=ie=>{if(!ie)return"";const ge=ie.split("/");return ge.length>=3?ge.slice(1).join("/"):ge.length===2?ge.join("/"):ge[ge.length-1]},z=zn.filter(ie=>{var ge;return ie.isHistorical&&(ie.type==="creditnote"||((ge=ie.vchNo)==null?void 0:ge.toUpperCase().startsWith("CN")))}),Q=new Map;cs.forEach(ie=>{const ge=E(ie.invoiceNo);ge&&Q.set(ge,ie)}),z.forEach(ie=>{const ge=E(ie.vchNo);ge&&!Q.has(ge)&&Q.set(ge,ie)}),zn.filter(ie=>{var ge;return ie.isHistorical&&ie.type!=="creditnote"&&!((ge=ie.vchNo)!=null&&ge.toUpperCase().startsWith("CN"))&&ie.debit>0}).forEach(ie=>{if(!h.has(ie.vchNo)){const ge=Ni.find(rt=>rt.invoiceNo===ie.vchNo),le=E(ie.vchNo),J=Q.get(le),be=J?Math.abs(parseFloat(J.totalAmount)||parseFloat(J.credit)||parseFloat(J.debit)||0):0,se=parseFloat(ie.debit)||0;if(J&&be>=se)return;const Ve=!ge&&!(ie.amountReceived>0),Qe=J&&be>0&&be<se;if(Ve||Qe){const rt=Qe?se-be:se;h.set(ie.vchNo,{invoiceNo:ie.vchNo,partyName:ie.partyName,date:ie.date,invoiceType:"Historical",combinationCode:"",invoiceStatus:"Approved",mailingSent:"Yes",receiptStatus:Qe?"Partial CN":"Pending",receiptNo:"",campaigns:[],totalAmount:se,pendingAmount:rt,hasPartialCN:Qe,cnAmount:be,isHistorical:!0,historicalEntry:ie})}}});let j=Array.from(h.values());if(we.party&&(j=j.filter(ie=>Gt(ie.partyName,we.party))),we.invoiceStatus&&(j=j.filter(ie=>ie.invoiceStatus===we.invoiceStatus)),we.receiptStatus&&(we.receiptStatus==="Received"?j=j.filter(ie=>ie.receiptStatus==="Received"):we.receiptStatus==="Pending"&&(j=j.filter(ie=>ie.receiptStatus!=="Received"))),we.invoiceType&&(j=j.filter(ie=>ie.invoiceType===we.invoiceType)),we.searchText){const ie=we.searchText.toLowerCase();j=j.filter(ge=>{var le,J;return((le=ge.invoiceNo)==null?void 0:le.toLowerCase().includes(ie))||((J=ge.partyName)==null?void 0:J.toLowerCase().includes(ie))})}const P={};j.forEach(ie=>{P[ie.partyName]||(P[ie.partyName]=[]),P[ie.partyName].push(ie)});const ne=Object.keys(P).sort(),V=we.party||we.invoiceStatus||we.receiptStatus||we.invoiceType||we.searchText,he=Array.from(h.values());return c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Invoice & Receipt Register"}),c.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[c.jsx(qe,{icon:Eo,label:"Export Excel",variant:"secondary",onClick:()=>DF(j)}),xn&&c.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"})]})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(id,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"})]}),c.jsxs("div",{style:{position:"relative"},children:[c.jsx(z0,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",placeholder:"Search invoice...",value:we.searchText,onChange:ie=>Ue(ge=>({...ge,searchText:ie.target.value})),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"160px"}})]}),c.jsxs("select",{value:we.party,onChange:ie=>Ue(ge=>({...ge,party:ie.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Parties"}),vn.map(ie=>c.jsx("option",{value:ie,children:ie},ie))]}),c.jsxs("select",{value:we.invoiceStatus,onChange:ie=>Ue(ge=>({...ge,invoiceStatus:ie.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Status"}),c.jsx("option",{value:"Created",children:"Created"}),c.jsx("option",{value:"Approved",children:"Approved"}),c.jsx("option",{value:"Need Edits",children:"Need Edits"})]}),c.jsxs("select",{value:we.receiptStatus,onChange:ie=>Ue(ge=>({...ge,receiptStatus:ie.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Receipts"}),c.jsx("option",{value:"Received",children:"Received"}),c.jsx("option",{value:"Pending",children:"Pending"})]}),c.jsxs("select",{value:we.invoiceType,onChange:ie=>Ue(ge=>({...ge,invoiceType:ie.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Types"}),c.jsx("option",{value:"Individual",children:"Individual"}),c.jsx("option",{value:"Combined",children:"Combined"})]}),V&&c.jsxs(c.Fragment,{children:[c.jsxs("button",{onClick:()=>Ue({party:"",invoiceStatus:"",receiptStatus:"",invoiceType:"",searchText:""}),style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(Na,{size:14})," Clear"]}),c.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",j.length," of ",he.length]})]})]})}),c.jsx(Xr,{noPadding:!0,children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[c.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Date"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Type"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:"Amount"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#F0FDF4",color:"#166534"},children:"Received"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEF3C7",color:"#92400E"},children:"TDS"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:"CN Amt"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#EFF6FF",color:"#1E40AF"},children:"Balance"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Inv. Status"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Receipt No."}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"CN No."}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),c.jsx("tbody",{children:ne.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:"12",style:{padding:"50px",textAlign:"center",color:"#94A3B8"},children:V?"No matching invoices":"No invoices generated yet"})}):ne.map(ie=>{const ge=P[ie],le=Zf.has(ie);let J=0;return ge.forEach(be=>{const se=je.find(wt=>wt.invoiceNo===be.invoiceNo),Te=re.find(wt=>wt.invoiceNo===be.invoiceNo),Ve=te.find(wt=>wt.invoiceNo===be.invoiceNo&&wt.type==="tds"),Qe=te.find(wt=>wt.invoiceNo===be.invoiceNo&&wt.type==="discount"),rt=be.totalAmount||0,Be=se&&parseFloat(se.amount)||0,et=Ve?parseFloat(Ve.credit)||0:se&&parseFloat(se.tds)||0,De=Te?Math.abs(parseFloat(Te.totalAmount)||0):0,st=Qe&&parseFloat(Qe.credit)||0,Ct=Math.max(0,rt-Be-et-De-st);J+=Ct}),c.jsxs(Z0.Fragment,{children:[c.jsxs("tr",{onClick:()=>my(ie),style:{backgroundColor:"#1E3A5F",color:"white",cursor:"pointer",borderBottom:"1px solid #0F2744"},children:[c.jsx("td",{colSpan:"3",style:{padding:"10px 12px",fontWeight:"700",fontSize:"13px"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[le?c.jsx(Gg,{size:18}):c.jsx(L0,{size:18}),c.jsx(Z2,{size:16}),ie,c.jsxs("span",{style:{backgroundColor:"#2874A6",padding:"2px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600"},children:[ge.length," inv"]})]})}),c.jsx("td",{colSpan:"4",style:{padding:"10px 12px"}}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",fontSize:"13px",backgroundColor:J===0?"#22C55E":"#3B82F6"},children:J===0?" Nil":`Bal: ${tt(J)}`}),c.jsx("td",{colSpan:"4",style:{padding:"10px 12px"}})]}),le&&ge.map(be=>{const se=je.find(at=>at.invoiceNo===be.invoiceNo),Te=re.find(at=>at.invoiceNo===be.invoiceNo),Ve=te.find(at=>at.invoiceNo===be.invoiceNo&&at.type==="tds"),Qe=te.find(at=>at.invoiceNo===be.invoiceNo&&at.type==="discount"),rt=be.totalAmount||0,Be=se&&parseFloat(se.amount)||0,et=Ve?parseFloat(Ve.credit)||0:se&&parseFloat(se.tds)||0,De=Te?Math.abs(parseFloat(Te.totalAmount)||0):0,st=Qe&&parseFloat(Qe.credit)||0,Ct=Math.max(0,rt-Be-et-De-st),wt=De>=rt&&!se;return c.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:be.invoiceType==="Combined"?"#FAF5FF":Ct===0?"#F0FDF4":"transparent"},children:[c.jsx("td",{style:{padding:"10px 12px 10px 36px",fontWeight:"700",color:be.invoiceType==="Combined"?"#7C3AED":"#2874A6"},children:be.invoiceNo}),c.jsx("td",{style:{padding:"10px 12px"},children:Ft(be.date)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsx(X0,{status:be.invoiceType,small:!0})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:tt(rt)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#F0FDF4",color:Be>0?"#166534":"#94A3B8"},children:Be>0?tt(Be):"-"}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#FEF3C7",color:et>0?"#92400E":"#94A3B8"},children:et>0?tt(et):"-"}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#FEE2E2",color:De>0?"#991B1B":"#94A3B8"},children:De>0?tt(De):"-"}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#EFF6FF",color:Ct>0?"#1E40AF":"#166534"},children:Ct===0?" Nil":tt(Ct)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsx(X0,{status:be.invoiceStatus,small:!0})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:wt?c.jsx("span",{style:{padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:" Cancelled"}):se?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",justifyContent:"center"},children:[c.jsxs("button",{onClick:()=>lF(se),style:{padding:"4px 8px",borderRadius:"12px",fontSize:"10px",fontWeight:"700",backgroundColor:"#DCFCE7",color:"#166534",border:"none",cursor:"pointer",textDecoration:"underline"},title:"Click to view receipt",children:[" ",se.receiptNo]}),lr&&c.jsx("button",{onClick:()=>K4(se),style:{padding:"2px 4px",borderRadius:"4px",fontSize:"10px",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete Receipt",children:""})]}):c.jsx("span",{style:{padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600",backgroundColor:"#FEF3C7",color:"#92400E"},children:" Pending"})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:Te?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",justifyContent:"center"},children:[c.jsx("button",{onClick:()=>cF(Te),style:{padding:"4px 8px",borderRadius:"12px",fontSize:"10px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer",textDecoration:"underline"},title:"Click to view credit note",children:Te.creditNoteNo}),lr&&c.jsx("button",{onClick:()=>Y4(Te),style:{padding:"2px 4px",borderRadius:"4px",fontSize:"10px",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete Credit Note",children:""})]}):c.jsx("span",{style:{color:"#94A3B8",fontSize:"11px"},children:"-"})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsx("div",{style:{display:"flex",gap:"4px",justifyContent:"center",flexWrap:"wrap"},children:be.isHistorical?c.jsxs(c.Fragment,{children:[lr&&!se&&c.jsx(qe,{icon:wl,small:!0,variant:"success",onClick:()=>{const at={invoiceNo:be.invoiceNo,partyName:be.partyName,invoiceDate:be.date,invoiceTotalAmount:be.totalAmount,invoiceStatus:"Approved",mailingSent:"Yes",invoiceType:"Historical",isHistorical:!0};cn(at)},title:"Create Receipt"}),lr&&!Te&&c.jsx(qe,{icon:nd,small:!0,variant:"primary",onClick:()=>{const at={invoiceNo:be.invoiceNo,partyName:be.partyName,invoiceDate:be.date,invoiceTotalAmount:be.totalAmount,invoiceStatus:"Approved",isHistorical:!0};Fa(at)},title:"Credit Note"})]}):c.jsxs(c.Fragment,{children:[c.jsx(qe,{icon:j0,small:!0,variant:"brand",onClick:()=>Ku(be.campaigns[0]),title:"View Invoice"}),lr&&be.invoiceStatus==="Approved"&&be.mailingSent==="Yes"&&!se&&c.jsx(qe,{icon:wl,small:!0,variant:"success",onClick:()=>cn(be.campaigns[0]),title:"Create Receipt"}),lr&&be.invoiceStatus==="Approved"&&!Te&&c.jsx(qe,{icon:nd,small:!0,variant:"primary",onClick:()=>Fa(be.campaigns[0]),title:"Credit Note"}),lr&&c.jsx(qe,{icon:Ls,small:!0,variant:"danger",onClick:()=>yl(be.campaigns[0]),title:"Delete Invoice"})]})})})]},be.invoiceNo)})]},ie)})})]})})]})},jF=()=>{if(!Y){alert("Please select a party first");return}const h=fi[Y]||0,E=_e.filter(Z=>Gt(Z.partyName,Y)&&Z.invoiceGenerated&&Z.invoiceStatus==="Approved"&&(!Ee||pi(Z.statePartyDetails)===Ee)),z=new Map;E.forEach(Z=>{z.has(Z.invoiceNo)?z.get(Z.invoiceNo).campaigns.push(Z):z.set(Z.invoiceNo,{invoiceNo:Z.invoiceNo,invoiceDate:Z.invoiceDate,campaigns:[Z],isFromMaster:!0})});const Q=new Set(Array.from(z.keys())),j=Ee?[]:te.filter(Z=>{var ze;return Gt(Z.partyName,Y)&&Z.isHistorical&&Z.type!=="creditnote"&&!((ze=Z.vchNo)!=null&&ze.toUpperCase().startsWith("CN"))}),P=Ee?[]:te.filter(Z=>{var ze;return Gt(Z.partyName,Y)&&Z.isHistorical&&(Z.type==="creditnote"||((ze=Z.vchNo)==null?void 0:ze.toUpperCase().startsWith("CN")))}),ne=je.filter(Z=>Gt(Z.partyName,Y)&&(!Ee||Q.has(Z.invoiceNo))),V=re.filter(Z=>Gt(Z.partyName,Y)&&(!Ee||Q.has(Z.invoiceNo))),he=Z=>{if(!Z)return"";const ze=Z.split("/");return ze.length>=3?ze.slice(1).join("/"):ze.length===2?ze.join("/"):ze[ze.length-1]},ie=new Map;V.forEach(Z=>{const ze=he(Z.invoiceNo);ze&&!ie.has(ze)&&ie.set(ze,{...Z,isSystemCN:!0})}),P.forEach(Z=>{const ze=he(Z.vchNo);ze&&!ie.has(ze)&&ie.set(ze,{...Z,isHistoricalCN:!0})});let ge=[],le=0,J=0,be=0,se=0,Te=h;const Ve=new Set;h!==0&&(le+=h>0?h:0,J+=h<0?Math.abs(h):0,ge.push({date:"",particular:"Opening Balance",vchType:"",vchNo:"",debit:h>0?h:0,credit:h<0?Math.abs(h):0,receiptDate:"",amountReceived:0,tds:0,balance:h,status:"",isMain:!0,isOpening:!0}));const Qe=[];Array.from(z.values()).filter(Z=>{const ze=new Date(Z.invoiceDate);return ze>=new Date(tn.fromDate)&&ze<=new Date(tn.toDate)}).forEach(Z=>{Qe.push({...Z,entryType:"invoice",sortDate:Z.invoiceDate})}),j.filter(Z=>{if(!Z.date)return!1;const ze=new Date(Z.date);return ze>=new Date(tn.fromDate)&&ze<=new Date(tn.toDate)}).forEach(Z=>{Qe.push({...Z,entryType:"invoice",sortDate:Z.date})}),Qe.sort((Z,ze)=>new Date(Z.sortDate)-new Date(ze.sortDate)),Qe.forEach(Z=>{var ze,Hn;if(Z.isFromMaster){const Rt=Z;let jr=0;Rt.campaigns.forEach(Kn=>jr+=parseFloat(Kn.invoiceAmount)||0);const Vr=(Hn=(ze=Rt.campaigns[0])==null?void 0:ze.statePartyDetails)==null?void 0:Hn.toUpperCase().includes("MAHARASHTRA"),Jt=Vr?jr*.09:0,$n=Vr?jr*.09:0,En=Vr?0:jr*.18,un=jr+Jt+$n+En,Os=he(Rt.invoiceNo),Kt=ie.get(Os),Gn=!!Kt,Ri=ne.find(Kn=>Kn.invoiceNo===Rt.invoiceNo);Te+=un,le+=un;let ba=0,mo=0,Ia="",xo=Gn?"":"Pending";if(Ri&&(xo="Received",ba=Ri.amount||0,mo=Ri.tds||0,Ia=Ri.date,be+=ba,se+=mo,Te-=ba+mo+(Ri.discount||0)),ge.push({date:Rt.invoiceDate,particular:Y,vchType:"Sales",vchNo:Rt.invoiceNo,debit:un,credit:0,receiptDate:Ia,amountReceived:ba,tds:mo,balance:Gn?"-":xo==="Received"?0:un-ba-mo,status:xo,isMain:!0,hasCN:Gn}),ge.push({particular:"PROMOTIONAL TRADE EMAILER"+(Rt.campaigns.length>1?"S":""),credit:jr,isMain:!1,hasCN:Gn}),Vr?(ge.push({particular:"CGST",credit:Jt,isMain:!1,hasCN:Gn}),ge.push({particular:"SGST",credit:$n,isMain:!1,hasCN:Gn})):ge.push({particular:"IGST",credit:En,isMain:!1,hasCN:Gn}),Kt&&!Ve.has(Os)){Ve.add(Os);const Kn=Math.abs(Kt.totalAmount||Kt.credit||0);Te-=Kn,J+=Kn,ge.push({date:Kt.date,particular:Y,vchType:"Credit Note",vchNo:Kt.creditNoteNo||Kt.vchNo,debit:0,credit:Kn,receiptDate:"",amountReceived:0,tds:0,balance:"-",status:"",isMain:!0,isCreditNote:!0,hasCN:!0});const vo=Math.abs(Kt.amount)||Kn/1.18,_l=Math.abs(Kt.gst)||Kn-vo;ge.push({particular:"PROMOTIONAL TRADE EMAILER",credit:vo,isMain:!1,isCreditNote:!0,hasCN:!0}),ge.push({particular:Kt.gstType||(Vr?"CGST + SGST":"IGST"),credit:_l,isMain:!1,isCreditNote:!0,hasCN:!0})}}else if(Z.isHistorical){const Rt=Z.debit||0,jr=Z.credit||0,Vr=he(Z.vchNo),Jt=ie.get(Vr),$n=!!Jt;if(Te+=Rt-jr,le+=Rt,J+=jr,ge.push({date:Z.date,particular:Z.particulars||Y,vchType:Z.vchType||"Sales",vchNo:Z.vchNo,debit:Rt,credit:jr,receiptDate:Z.receiptDate||"",amountReceived:Z.amountReceived||0,tds:Z.tdsReceived||0,balance:$n?"-":Rt-(Z.amountReceived||0)-(Z.tdsReceived||0),status:$n?"":Z.paymentStatus||"",isMain:!0,isHistorical:!0,hasCN:$n}),Z.subRows&&Z.subRows.length>0&&Z.subRows.forEach(En=>{ge.push({particular:En.particular,debit:En.debit,credit:En.credit,isMain:!1,hasCN:$n})}),Jt&&!Ve.has(Vr)){Ve.add(Vr);const En=Math.abs(Jt.totalAmount||Jt.credit||0);Te-=En,J+=En,ge.push({date:Jt.date,particular:Y,vchType:"Credit Note",vchNo:Jt.creditNoteNo||Jt.vchNo,debit:0,credit:En,receiptDate:"",amountReceived:0,tds:0,balance:"-",status:"",isMain:!0,isCreditNote:!0,hasCN:!0}),Jt.subRows&&Jt.subRows.length>0&&Jt.subRows.forEach(un=>{ge.push({particular:un.particular,credit:Math.abs(un.credit||0),isMain:!1,isCreditNote:!0,hasCN:!0})})}}});const rt=ge.reduce((Z,ze)=>ze.isMain&&typeof ze.balance=="number"&&ze.balance>0?Z+ze.balance:Z,0),Be=(Y||"").trim().toUpperCase();let et={};Ee&&(et=zi.find(Z=>Z.partyNameUpper===Be&&Z.normalizedState===Ee)||{}),et.state||(et=zi.find(Z=>Z.partyNameUpper===Be)||{});const De=_e.find(Z=>{var ze;return((ze=Z.partyName)==null?void 0:ze.trim().toUpperCase())===Be}),st=et.state||(De==null?void 0:De.statePartyDetails)||"",Ct=et.address||xl(Y,st)||"",wt=et.gstin||fo(Y,st),at=`
<!DOCTYPE html>
<html>
<head>
  <title>Ledger Account - ${Y}</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; font-size: 11px; padding: 20px; }
    .header { text-align: center; margin-bottom: 15px; }
    .firm-name { font-size: 18px; font-weight: bold; color: #1E293B; }
    .firm-address { font-size: 10px; color: #666; margin-top: 2px; }
    .party-section { text-align: center; margin: 15px 0; padding: 10px; border: 1px solid #ddd; background: #f9f9f9; }
    .party-name { font-size: 14px; font-weight: bold; }
    .ledger-title { font-size: 11px; color: #666; }
    .party-address { font-size: 10px; color: #666; margin-top: 5px; }
    .party-gstin { font-size: 10px; color: #1a5276; margin-top: 3px; font-weight: 600; }
    .period { text-align: center; font-size: 11px; margin: 10px 0; font-weight: bold; }
    .totals { display: flex; justify-content: space-around; background: #e8f4fd; padding: 8px; margin-bottom: 10px; font-size: 10px; border: 1px solid #ccc; }
    .totals div { text-align: center; }
    .totals .label { color: #666; }
    .totals .value { font-weight: bold; font-size: 11px; }
    .closing-balance { text-align: center; background: #1E293B; color: white; padding: 10px; margin-bottom: 10px; font-size: 14px; font-weight: bold; }
    table { width: 100%; border-collapse: collapse; font-size: 10px; }
    th { background: #f0f0f0; border: 1px solid #ccc; padding: 6px 4px; text-align: left; font-weight: bold; }
    td { border: 1px solid #ddd; padding: 5px 4px; }
    .text-right { text-align: right; }
    .text-center { text-align: center; }
    .main-row { background: #fff; }
    .main-row-cn { background: #fffbeb; }
    .sub-row { background: #fafafa; }
    .sub-row-cn { background: #fffbeb; }
    .sub-row td { padding-left: 20px; color: #666; font-size: 9px; }
    .opening-row { background: #fef3c7; font-weight: bold; }
    .credit-note-row { background: #fffbeb; }
    .status-received { background: #dcfce7; color: #166534; padding: 2px 6px; border-radius: 3px; font-size: 9px; }
    .status-pending { background: #fef3c7; color: #92400e; padding: 2px 6px; border-radius: 3px; font-size: 9px; }
    .debit { color: #dc2626; }
    .credit { color: #059669; }
    @media print { 
      body { padding: 10px; } 
      @page { size: landscape; margin: 10mm; }
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="firm-name">${S.name}</div>
    <div class="firm-address">${S.address}</div>
    <div class="firm-address">${S.addressLine2}, ${S.city}</div>
    <div class="firm-address">E-Mail: ${S.email}</div>
  </div>
  
  <div class="party-section">
    <div class="party-name">${Y}</div>
    <div class="ledger-title">Ledger Account</div>
    ${Ct?`<div class="party-address">${Ct}</div>`:""}
    ${st?`<div class="party-address"> ${st}</div>`:""}
    ${wt?`<div class="party-gstin">GSTIN: ${wt}</div>`:""}
  </div>
  
  <div class="period">${Ft(tn.fromDate)} to ${Ft(tn.toDate)}</div>
  
  <div class="closing-balance">
    Closing Balance: ${jt(Math.abs(rt))} ${rt>0?"(Dr)":rt<0?"(Cr)":""}
  </div>
  
  <div class="totals">
    <div><div class="label">Debit</div><div class="value">${jt(le)}</div></div>
    <div><div class="label">Credit</div><div class="value">${jt(J)}</div></div>
    <div><div class="label">Amount Received</div><div class="value credit">${jt(be)}</div></div>
    <div><div class="label">TDS Received</div><div class="value">${jt(se)}</div></div>
  </div>
  
  <table>
    <thead>
      <tr>
        <th style="width:65px">Date</th>
        <th>Particular</th>
        <th style="width:70px" class="text-center">Vch Type</th>
        <th style="width:100px">Vch No.</th>
        <th style="width:80px" class="text-right">Debit</th>
        <th style="width:80px" class="text-right">Credit</th>
        <th style="width:70px" class="text-center">Date of Receipt</th>
        <th style="width:85px" class="text-right">Amount Received</th>
        <th style="width:70px" class="text-right">TDS Received</th>
        <th style="width:75px" class="text-right">Balance</th>
        <th style="width:70px" class="text-center">Payment Status</th>
      </tr>
    </thead>
    <tbody>
      ${ge.map(Z=>Z.isMain?`
        <tr class="${Z.isOpening?"opening-row":Z.hasCN||Z.isCreditNote?"main-row-cn":"main-row"}">
          <td>${Z.date?Ft(Z.date):""}</td>
          <td style="font-weight:600">${Z.particular}</td>
          <td class="text-center">${Z.vchType||""}</td>
          <td style="color:#2874A6;font-weight:600">${Z.vchNo||""}</td>
          <td class="text-right">${Z.debit>0?jt(Z.debit):""}</td>
          <td class="text-right" style="color:#DC2626">${Z.credit>0?jt(Z.credit):""}</td>
          <td class="text-center">${Z.receiptDate?Ft(Z.receiptDate):""}</td>
          <td class="text-right credit">${Z.amountReceived>0?jt(Z.amountReceived):""}</td>
          <td class="text-right">${Z.tds>0?jt(Z.tds):""}</td>
          <td class="text-right">${Z.balance==="-"?"-":Z.balance>0?jt(Z.balance):""}</td>
          <td class="text-center">${Z.status?`<span class="${Z.status==="Received"?"status-received":"status-pending"}">${Z.status}</span>`:""}</td>
        </tr>
      `:`
        <tr class="${Z.hasCN||Z.isCreditNote?"sub-row-cn":"sub-row"}">
          <td></td>
          <td style="padding-left:20px;color:#666">${Z.particular}</td>
          <td></td>
          <td></td>
          <td class="text-right">${Z.debit?jt(Z.debit):""}</td>
          <td class="text-right">${Z.credit?jt(Z.credit):""}</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
      `).join("")}
    </tbody>
  </table>
  
  <script>window.onload = function() { window.print(); }<\/script>
</body>
</html>`,_n=window.open("","_blank");_n.document.write(at),_n.document.close()},VF=ve.useMemo(()=>{const h=new Set;return Ni.forEach(E=>h.add(E.partyName)),cs.forEach(E=>h.add(E.partyName)),[...h].filter(Boolean).sort()},[Ni,cs]),UF=ve.useMemo(()=>Ni.filter(h=>{var E;return!(ae.party&&h.partyName!==ae.party||ae.invoiceNo&&!((E=h.invoiceNo)!=null&&E.toLowerCase().includes(ae.invoiceNo.toLowerCase()))||ae.dateFrom&&h.date<ae.dateFrom||ae.dateTo&&h.date>ae.dateTo)}),[Ni,ae]),zF=ve.useMemo(()=>cs.filter(h=>{var E;return!(ae.party&&h.partyName!==ae.party||ae.invoiceNo&&!((E=h.invoiceNo)!=null&&E.toLowerCase().includes(ae.invoiceNo.toLowerCase()))||ae.dateFrom&&h.date<ae.dateFrom||ae.dateTo&&h.date>ae.dateTo)}),[cs,ae]),WF=()=>{const h=[...UF].sort((P,ne)=>new Date(ne.date)-new Date(P.date)),E=[...zF].sort((P,ne)=>new Date(ne.date)-new Date(P.date)),z=h.reduce((P,ne)=>P+(parseFloat(ne.amount)||0),0),Q=h.reduce((P,ne)=>P+(parseFloat(ne.tdsAmount)||0),0),j=E.reduce((P,ne)=>P+(parseFloat(ne.totalAmount)||0),0);return c.jsxs("div",{style:{padding:"20px"},children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[c.jsxs("div",{children:[c.jsx("h1",{style:{fontSize:"22px",fontWeight:"700",color:"#1E293B",marginBottom:"4px"},children:" Receipt Register"}),c.jsx("p",{style:{fontSize:"13px",color:"#64748B"},children:"All receipts, TDS, and credit notes"})]}),c.jsx(qe,{icon:Eo,label:"Export Excel",variant:"secondary",onClick:OF})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsx(id,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"}),c.jsxs("select",{value:ae.party,onChange:P=>fe(ne=>({...ne,party:P.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"},children:[c.jsx("option",{value:"",children:"All Parties"}),VF.map(P=>c.jsx("option",{value:P,children:P},P))]}),c.jsx("input",{type:"text",placeholder:"Invoice No",value:ae.invoiceNo,onChange:P=>fe(ne=>({...ne,invoiceNo:P.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"140px"}}),c.jsx("input",{type:"date",value:ae.dateFrom,onChange:P=>fe(ne=>({...ne,dateFrom:P.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}}),c.jsx("span",{style:{color:"#64748B"},children:"to"}),c.jsx("input",{type:"date",value:ae.dateTo,onChange:P=>fe(ne=>({...ne,dateTo:P.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}}),(ae.party||ae.invoiceNo||ae.dateFrom||ae.dateTo)&&c.jsxs("button",{onClick:()=>fe({party:"",invoiceNo:"",dateFrom:"",dateTo:""}),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer"},children:[c.jsx(Na,{size:14})," Clear"]})]})}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px",marginBottom:"20px"},children:[c.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",padding:"20px",border:"1px solid #E2E8F0"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#64748B",marginBottom:"8px"},children:"Receipts"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:h.length})]}),c.jsxs("div",{style:{backgroundColor:"#F0FDF4",borderRadius:"12px",padding:"20px",border:"1px solid #BBF7D0"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#166534",marginBottom:"8px"},children:"Amount Received"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#166534"},children:tt(z)})]}),c.jsxs("div",{style:{backgroundColor:"#FEF3C7",borderRadius:"12px",padding:"20px",border:"1px solid #FDE68A"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#92400E",marginBottom:"8px"},children:"TDS Received"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#92400E"},children:tt(Q)})]}),c.jsxs("div",{style:{backgroundColor:"#FEE2E2",borderRadius:"12px",padding:"20px",border:"1px solid #FCA5A5"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#991B1B",marginBottom:"8px"},children:"Credit Notes"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#991B1B"},children:tt(j)})]})]}),c.jsx(Xr,{title:`Receipts (${h.length})`,noPadding:!0,children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Receipt No"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Date"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Party Name"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700",backgroundColor:"#F0FDF4",color:"#166534"},children:"Amount"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEF3C7",color:"#92400E"},children:"TDS"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"Total"}),c.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700"},children:"Payment Mode"}),c.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),c.jsx("tbody",{children:h.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:"9",style:{padding:"50px",textAlign:"center",color:"#94A3B8"},children:"No receipts found"})}):h.map(P=>c.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9"},children:[c.jsx("td",{style:{padding:"12px",fontWeight:"600",color:"#2874A6"},children:P.receiptNo}),c.jsx("td",{style:{padding:"12px"},children:Ft(P.date)}),c.jsx("td",{style:{padding:"12px",fontWeight:"500"},children:P.partyName}),c.jsx("td",{style:{padding:"12px",color:"#64748B"},children:P.invoiceNo}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"600",color:"#166534",backgroundColor:"#F0FDF4"},children:tt(parseFloat(P.amount)||0)}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"600",color:"#92400E",backgroundColor:"#FEF3C7"},children:tt(parseFloat(P.tdsAmount)||0)}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:tt((parseFloat(P.amount)||0)+(parseFloat(P.tdsAmount)||0))}),c.jsx("td",{style:{padding:"12px",textAlign:"center"},children:c.jsx("span",{style:{padding:"4px 8px",fontSize:"10px",fontWeight:"600",borderRadius:"9999px",backgroundColor:"#E0E7FF",color:"#3730A3"},children:P.paymentMode||"Bank Transfer"})}),c.jsx("td",{style:{padding:"12px",textAlign:"center"},children:c.jsxs("button",{onClick:()=>MF(P),style:{padding:"6px 10px",fontSize:"11px",backgroundColor:"#2874A6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:[c.jsx(qg,{size:12})," Print"]})})]},P.id||P.receiptNo))})]})}),c.jsx("div",{style:{marginTop:"30px"},children:c.jsx(Xr,{title:`Credit Notes (${E.length})`,noPadding:!0,children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#FEF3C7",borderBottom:"2px solid #FDE68A"},children:[c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"CN No"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Date"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Party Name"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Against Invoice"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"Base Amount"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"GST"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"Total"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Reason"}),c.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),c.jsx("tbody",{children:E.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:"9",style:{padding:"50px",textAlign:"center",color:"#94A3B8"},children:"No credit notes found"})}):E.map(P=>c.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:"#FFFBEB"},children:[c.jsx("td",{style:{padding:"12px",fontWeight:"600",color:"#92400E"},children:P.creditNoteNo}),c.jsx("td",{style:{padding:"12px"},children:Ft(P.date)}),c.jsx("td",{style:{padding:"12px",fontWeight:"500"},children:P.partyName}),c.jsx("td",{style:{padding:"12px",color:"#64748B"},children:P.invoiceNo}),c.jsx("td",{style:{padding:"12px",textAlign:"right"},children:tt(parseFloat(P.baseAmount)||0)}),c.jsx("td",{style:{padding:"12px",textAlign:"right"},children:tt((parseFloat(P.cgstAmount)||0)+(parseFloat(P.sgstAmount)||0)+(parseFloat(P.igstAmount)||0))}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"700",color:"#92400E"},children:tt(parseFloat(P.totalAmount)||0)}),c.jsx("td",{style:{padding:"12px",fontSize:"11px",color:"#64748B"},children:P.reason||"-"}),c.jsx("td",{style:{padding:"12px",textAlign:"center"},children:c.jsxs("button",{onClick:()=>BF(P),style:{padding:"6px 10px",fontSize:"11px",backgroundColor:"#92400E",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:[c.jsx(qg,{size:12})," Print"]})})]},P.id||P.creditNoteNo))})]})})})]})},HF=()=>{const h=(V,he)=>{const ie=fi[V]||0,ge=_e.filter(De=>Gt(De.partyName,V)&&De.invoiceGenerated&&De.invoiceStatus==="Approved"&&(!he||pi(De.statePartyDetails)===he)),le=Me.filter(De=>Gt(De.partyName,V)&&De.invoiceGenerated&&De.invoiceStatus==="Approved"&&(!he||pi(De.statePartyDetails)===he)),J=new Map;ge.forEach(De=>{J.has(De.invoiceNo)?J.get(De.invoiceNo).campaigns.push(De):J.set(De.invoiceNo,{invoiceNo:De.invoiceNo,campaigns:[De],totalAmount:parseFloat(De.invoiceTotalAmount)||0})}),le.forEach(De=>{J.has(De.invoiceNo)||J.set(De.invoiceNo,{invoiceNo:De.invoiceNo,totalAmount:parseFloat(De.invoiceTotalAmount)||0,isService:!0})});const be=new Set(Array.from(J.keys())),se=je.filter(De=>Gt(De.partyName,V)&&(!he||be.has(De.invoiceNo))),Te=re.filter(De=>Gt(De.partyName,V)&&(!he||be.has(De.invoiceNo))),Ve=he?[]:te.filter(De=>{var st;return Gt(De.partyName,V)&&De.isHistorical&&De.type!=="creditnote"&&!((st=De.vchNo)!=null&&st.toUpperCase().startsWith("CN"))}),Qe=he?[]:te.filter(De=>{var st;return Gt(De.partyName,V)&&De.isHistorical&&(De.type==="creditnote"||((st=De.vchNo)==null?void 0:st.toUpperCase().startsWith("CN")))}),rt=De=>{if(!De)return"";const st=De.split("/");return st.length>=3?st.slice(1).join("/"):st.length===2?st.join("/"):st[st.length-1]},Be=new Map;Te.forEach(De=>{const st=rt(De.invoiceNo);st&&!Be.has(st)&&Be.set(st,De)}),Qe.forEach(De=>{const st=rt(De.vchNo);st&&!Be.has(st)&&Be.set(st,De)});let et=0;return ie>0&&(et+=ie),Array.from(J.values()).forEach(De=>{const st=De.totalAmount,Ct=rt(De.invoiceNo),wt=Be.get(Ct),at=wt?Math.abs(parseFloat(wt.totalAmount)||parseFloat(wt.credit)||0):0;if(!(wt&&at>=st)){let Z=wt?st-at:st;const ze=se.find(Hn=>Hn.invoiceNo===De.invoiceNo);if(ze){const Hn=Z-(parseFloat(ze.amount)||0)-(parseFloat(ze.tds)||0)-(parseFloat(ze.discount)||0);Hn>0&&(et+=Hn)}else Z>0&&(et+=Z)}}),Ve.forEach(De=>{const st=rt(De.vchNo),Ct=Be.get(st),wt=Ct?Math.abs(parseFloat(Ct.totalAmount)||parseFloat(Ct.credit)||parseFloat(Ct.debit)||0):0,at=parseFloat(De.debit)||0;if(!(Ct&&wt>=at)){let Z=Ct?at-wt:at;const ze=parseFloat(De.amountReceived)||0,Hn=parseFloat(De.tdsReceived)||0,Rt=Z-ze-Hn;Rt>0&&(et+=Rt)}}),et},E=zi.filter(V=>V.partyName.toLowerCase().includes(Ea.toLowerCase())||V.state&&V.state.toLowerCase().includes(Ea.toLowerCase())),z=V=>{if(Ee){const le=zi.find(J=>J.partyNameUpper===(V||"").trim().toUpperCase()&&J.normalizedState===Ee);if(le!=null&&le.state)return le.state}const he=(V||"").trim().toUpperCase(),ie=_e.find(le=>{var J;return((J=le.partyName)==null?void 0:J.trim().toUpperCase())===he});if(ie!=null&&ie.statePartyDetails)return ie.statePartyDetails;const ge=zi.find(le=>le.partyNameUpper===he);return(ge==null?void 0:ge.state)||""},Q=V=>{const he=(V||"").trim().toUpperCase();if(Ee){const ge=zi.find(le=>le.partyNameUpper===he&&le.normalizedState===Ee);if(ge!=null&&ge.address)return ge.address}const ie=zi.find(ge=>ge.partyNameUpper===he);return ie!=null&&ie.address?ie.address:xl(V,z(V))},j=V=>{const he=(V||"").trim().toUpperCase();if(Ee){const le=zi.find(J=>J.partyNameUpper===he&&J.normalizedState===Ee);if(le!=null&&le.gstin)return le.gstin}const ie=zi.find(le=>le.partyNameUpper===he);if(ie!=null&&ie.gstin)return ie.gstin;const ge=_e.find(le=>{var J;return((J=le.partyName)==null?void 0:J.trim().toUpperCase())===he});return ge?fo(V,ge.statePartyDetails):""},ne=(()=>{if(!Y)return{entries:[],totals:{debit:0,credit:0,received:0,tds:0,balance:0}};const V=fi[Y]||0,he=Z=>{if(!Z)return"";const ze=Z.split("/");return ze.length>=3?ze.slice(1).join("/"):ze.length===2?ze.join("/"):ze[ze.length-1]},ie=_e.filter(Z=>Gt(Z.partyName,Y)&&Z.invoiceGenerated&&Z.invoiceStatus==="Approved"&&(!Ee||pi(Z.statePartyDetails)===Ee)),ge=Me.filter(Z=>Gt(Z.partyName,Y)&&Z.invoiceGenerated&&Z.invoiceStatus==="Approved"&&(!Ee||pi(Z.statePartyDetails)===Ee)),le=new Map;ie.forEach(Z=>{le.has(Z.invoiceNo)?le.get(Z.invoiceNo).campaigns.push(Z):le.set(Z.invoiceNo,{invoiceNo:Z.invoiceNo,invoiceDate:Z.invoiceDate,invoiceType:Z.invoiceType,combinationCode:Z.combinationCode,receiptStatus:Z.receiptStatus,receiptNo:Z.receiptNo,receiptDate:Z.receiptDate,creditNoteNo:Z.creditNoteNo,campaigns:[Z],isFromMaster:!0})}),ge.forEach(Z=>{le.has(Z.invoiceNo)||le.set(Z.invoiceNo,{invoiceNo:Z.invoiceNo,invoiceDate:Z.invoiceDate,invoiceType:"Service",combinationCode:"NA",receiptStatus:Z.receiptStatus,receiptNo:Z.receiptNo,receiptDate:Z.receiptDate,creditNoteNo:Z.creditNoteNo,campaigns:[Z],isFromMaster:!1,isService:!0,serviceType:Z.serviceType})});const J=new Set(Array.from(le.keys())),be=Ee?[]:te.filter(Z=>{var ze;return Gt(Z.partyName,Y)&&Z.isHistorical&&Z.type!=="creditnote"&&!((ze=Z.vchNo)!=null&&ze.toUpperCase().startsWith("CN"))}),se=Ee?[]:te.filter(Z=>{var ze;return Gt(Z.partyName,Y)&&Z.isHistorical&&(Z.type==="creditnote"||((ze=Z.vchNo)==null?void 0:ze.toUpperCase().startsWith("CN")))}),Te=je.filter(Z=>Gt(Z.partyName,Y)&&(!Ee||J.has(Z.invoiceNo))),Ve=re.filter(Z=>Gt(Z.partyName,Y)&&(!Ee||J.has(Z.invoiceNo))),Qe=new Map;Ve.forEach(Z=>{const ze=he(Z.invoiceNo);ze&&!Qe.has(ze)&&Qe.set(ze,{...Z,isSystemCN:!0})}),se.forEach(Z=>{const ze=he(Z.vchNo);ze&&!Qe.has(ze)&&Qe.set(ze,{...Z,isHistoricalCN:!0})});const rt=[];let Be=V,et=0,De=0,st=0,Ct=0;const wt=new Set;V!==0&&(rt.push({id:"opening",date:"",particular:"Opening Balance",vchType:"",vchNo:"",debit:V>0?V:0,credit:V<0?Math.abs(V):0,receiptDate:"",amountReceived:0,tdsReceived:0,balance:V,paymentStatus:"",isOpening:!0,subRows:[]}),et+=V>0?V:0,De+=V<0?Math.abs(V):0);const at=[];Array.from(le.values()).filter(Z=>{const ze=new Date(Z.invoiceDate),Hn=new Date(tn.fromDate),Rt=new Date(tn.toDate);return ze>=Hn&&ze<=Rt}).forEach(Z=>{at.push({...Z,entryType:"invoice",sortDate:Z.invoiceDate})}),be.filter(Z=>{if(!Z.date)return!1;const ze=new Date(Z.date),Hn=new Date(tn.fromDate),Rt=new Date(tn.toDate);return ze>=Hn&&ze<=Rt}).forEach(Z=>{at.push({...Z,entryType:Z.type||"invoice",sortDate:Z.date})}),at.sort((Z,ze)=>new Date(Z.sortDate)-new Date(ze.sortDate)),at.forEach(Z=>{var ze,Hn;if(Z.isFromMaster){const Rt=Z;let jr=0;Rt.campaigns.forEach(ra=>{jr+=parseFloat(ra.invoiceAmount)||0});const Vr=(Hn=(ze=Rt.campaigns[0])==null?void 0:ze.statePartyDetails)==null?void 0:Hn.toUpperCase().includes("MAHARASHTRA"),Jt=Vr?jr*.09:0,$n=Vr?jr*.09:0,En=Vr?0:jr*.18,un=jr+Jt+$n+En,Os=he(Rt.invoiceNo),Kt=Qe.get(Os),Gn=Kt?Math.abs(Kt.totalAmount||Kt.credit||0):0,Ri=!!Kt,ba=Ri&&Gn>=un,mo=Ri&&!ba?un-Gn:0,Ia=Te.find(ra=>ra.invoiceNo===Rt.invoiceNo);Be+=un,et+=un;const xo=[{particular:"PROMOTIONAL TRADE EMAILER"+(Rt.campaigns.length>1?"S":""),credit:jr}];Vr?(xo.push({particular:"CGST",credit:Jt}),xo.push({particular:"SGST",credit:$n})):xo.push({particular:"IGST",credit:En});let Kn="",vo=0,_l=0,Ay="",Tc=un;if(Ia?(Kn="Received",vo=Ia.amount||0,_l=Ia.tds||0,Ay=Ia.date,st+=vo,Ct+=_l,Tc=un-vo-_l-(Ia.discount||0),Be-=vo+_l+(Ia.discount||0)):Rt.receiptStatus==="Received"?(Kn="Received",Tc=0):ba?(Kn="CN Closed",Tc=0):Ri&&mo>0?(Kn="Partial CN",Tc=mo):Kn="Pending",rt.push({id:Rt.invoiceNo,date:Rt.invoiceDate,particular:Y,vchType:"Sales",vchNo:Rt.invoiceNo,debit:un,credit:0,receiptDate:Ay,amountReceived:vo,tdsReceived:_l,balance:ba?"-":Tc>0?Tc:0,paymentStatus:Kn,isInvoice:!0,hasCN:Ri,subRows:xo}),Kt&&!wt.has(Os)){wt.add(Os);const ra=Math.abs(Kt.totalAmount||Kt.credit||0);Be-=ra,De+=ra;const El=[];if(Kt.amount&&El.push({particular:"PROMOTIONAL TRADE EMAILER",credit:Math.abs(Kt.amount)}),Kt.gst&&El.push({particular:Kt.gstType||(Vr?"CGST + SGST":"IGST"),credit:Math.abs(Kt.gst)}),El.length===0&&ra>0){const ky=ra/1.18,QF=ra-ky;El.push({particular:"PROMOTIONAL TRADE EMAILER",credit:ky}),El.push({particular:Vr?"CGST + SGST":"IGST",credit:QF})}rt.push({id:Kt.id||Kt.creditNoteNo||`cn-${Os}`,date:Kt.date,particular:Y,vchType:"Credit Note",vchNo:Kt.creditNoteNo||Kt.vchNo,debit:0,credit:ra,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:Kt.isHistoricalCN&&Kt.subRows||El})}}else if(Z.isHistorical){const Rt=Z.debit||0,jr=Z.credit||0,Vr=he(Z.vchNo),Jt=Qe.get(Vr),$n=Jt?Math.abs(Jt.totalAmount||Jt.credit||0):0,En=!!Jt,un=En&&$n>=Rt,Os=En&&!un?Rt-$n:0;Be+=Rt-jr,et+=Rt,De+=jr,Z.amountReceived&&(st+=Z.amountReceived),Z.tdsReceived&&(Ct+=Z.tdsReceived);const Kt=Z.subRows||[];let Gn=Rt-(Z.amountReceived||0)-(Z.tdsReceived||0),Ri=Z.paymentStatus||"";un?(Gn=0,Ri="CN Closed"):En&&Os>0&&(Gn=Os-(Z.amountReceived||0)-(Z.tdsReceived||0),Gn>0&&(Ri="Partial CN")),rt.push({id:Z.id,date:Z.date,particular:Z.particulars||Y,vchType:Z.vchType||"Sales",vchNo:Z.vchNo,debit:Rt,credit:jr,receiptDate:Z.receiptDate||"",amountReceived:Z.amountReceived||0,tdsReceived:Z.tdsReceived||0,balance:un?"-":Gn>0?Gn:0,paymentStatus:Ri,isInvoice:!0,isHistorical:!0,hasCN:En,subRows:Kt}),Jt&&!wt.has(Vr)&&(wt.add(Vr),Be-=$n,De+=$n,rt.push({id:Jt.id||Jt.creditNoteNo||Jt.vchNo||`cn-${Vr}`,date:Jt.date,particular:Y,vchType:"Credit Note",vchNo:Jt.creditNoteNo||Jt.vchNo,debit:0,credit:$n,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:Jt.subRows||[]}))}});const _n=rt.reduce((Z,ze)=>typeof ze.balance=="number"&&ze.balance>0?Z+ze.balance:Z,0);return{entries:rt,totals:{debit:et,credit:De,received:st,tds:Ct,balance:_n}}})();return c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Party Ledgers"}),c.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[c.jsx(qe,{icon:Eo,label:"Export All",variant:"secondary",onClick:PF}),xn&&c.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"}),lr&&c.jsx(qe,{icon:js,label:"Import Historical",variant:"brand",onClick:()=>Ps(!0)}),lr&&Y&&te.some(V=>Gt(V.partyName,Y)&&V.isHistorical)&&c.jsx(qe,{icon:Ls,label:"Clear Historical",variant:"danger",onClick:q4}),lr&&c.jsx(qe,{icon:sd,label:"Opening Balance",variant:"primary",onClick:()=>qt(!0)})]})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(Fj,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Period:"})]}),c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx("input",{type:"date",value:tn.fromDate,onChange:V=>Gr(he=>({...he,fromDate:V.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}}),c.jsx("span",{style:{color:"#64748B"},children:"to"}),c.jsx("input",{type:"date",value:tn.toDate,onChange:V=>Gr(he=>({...he,toDate:V.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}})]}),c.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:"10px"},children:Y&&c.jsx(qe,{icon:Eo,label:"Download PDF",variant:"brand",onClick:jF})})]})}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr",gap:"16px"},children:[c.jsxs(Xr,{title:"Parties",noPadding:!0,children:[c.jsx("div",{style:{padding:"12px",borderBottom:"1px solid #E2E8F0"},children:c.jsxs("div",{style:{position:"relative"},children:[c.jsx(z0,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",placeholder:"Search party...",value:Ea,onChange:V=>Is(V.target.value),style:{width:"100%",padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",boxSizing:"border-box"}})]})}),c.jsx("div",{style:{maxHeight:"450px",overflowY:"auto"},children:E.length===0?c.jsx("div",{style:{padding:"30px",textAlign:"center",color:"#94A3B8",fontSize:"14px"},children:Ea?"No matching parties":"No parties yet"}):E.map((V,he)=>{const ie=h(V.partyName,V.normalizedState),ge=Gt(Y,V.partyName)&&Ee===V.normalizedState;return c.jsxs("div",{onClick:()=>{xe(V.partyName),Le(V.normalizedState||null)},style:{padding:"14px 18px",borderBottom:"1px solid #F1F5F9",cursor:"pointer",backgroundColor:ge?"#EFF6FF":"transparent",borderLeft:ge?"4px solid #2874A6":"4px solid transparent"},children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"14px",color:"#1E293B"},children:V.partyName}),V.state&&c.jsxs("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"2px"},children:[" ",V.state]}),V.gstin&&c.jsxs("div",{style:{fontSize:"10px",color:"#2874A6",marginTop:"1px"},children:["GST: ",V.gstin]}),c.jsxs("div",{style:{fontSize:"14px",color:ie>0?"#DC2626":"#059669",fontWeight:"700",marginTop:"4px"},children:[ie>0?"Dr. ":"Cr. ",tt(Math.abs(ie))]})]},`${V.partyName}-${V.state}-${he}`)})})]}),c.jsx(Xr,{title:Y?"Ledger Account":"Select a Party",noPadding:!0,children:Y?c.jsxs("div",{style:{fontSize:"12px"},children:[c.jsxs("div",{style:{textAlign:"center",padding:"16px",borderBottom:"2px solid #1E3A5F",backgroundColor:"#F8FAFC"},children:[c.jsx("div",{style:{fontSize:"16px",fontWeight:"700",color:"#1E3A5F"},children:S.name}),c.jsx("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"4px"},children:S.address}),c.jsxs("div",{style:{fontSize:"11px",color:"#64748B"},children:[S.addressLine2,", ",S.city]}),c.jsxs("div",{style:{fontSize:"11px",color:"#64748B"},children:["E-Mail: ",S.email]})]}),c.jsxs("div",{style:{textAlign:"center",padding:"12px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FFFFFF"},children:[c.jsx("div",{style:{fontSize:"14px",fontWeight:"700",color:"#1E293B"},children:Y}),c.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#64748B"},children:"Ledger Account"}),Q(Y)&&c.jsx("div",{style:{fontSize:"11px",color:"#475569",marginTop:"4px"},children:Q(Y)}),z(Y)&&c.jsxs("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"2px"},children:[" ",z(Y)]}),j(Y)&&c.jsxs("div",{style:{fontSize:"11px",color:"#2874A6",marginTop:"3px",fontWeight:"600"},children:["GSTIN: ",j(Y)]})]}),c.jsx("div",{style:{textAlign:"center",padding:"8px",backgroundColor:"#F1F5F9",borderBottom:"1px solid #E2E8F0"},children:c.jsxs("span",{style:{fontSize:"11px",fontWeight:"600",color:"#475569"},children:[Ft(tn.fromDate)," to ",Ft(tn.toDate)]})}),c.jsxs("div",{style:{backgroundColor:"#1E293B",color:"white",padding:"12px 16px",display:"flex",justifyContent:"center",alignItems:"center",gap:"12px",borderBottom:"3px solid #F59E0B"},children:[c.jsx("span",{style:{fontSize:"14px",fontWeight:"600"},children:"Closing Balance:"}),c.jsxs("span",{style:{fontSize:"18px",fontWeight:"700",color:ne.totals.balance>0?"#FCA5A5":"#86EFAC"},children:[jt(Math.abs(ne.totals.balance))," ",ne.totals.balance>0?"(Dr)":ne.totals.balance<0?"(Cr)":""]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",backgroundColor:"#EFF6FF",borderBottom:"2px solid #2874A6",fontSize:"11px"},children:[c.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[c.jsx("div",{style:{color:"#64748B"},children:"Debit"}),c.jsx("div",{style:{fontWeight:"700",color:"#1E293B"},children:jt(ne.totals.debit)})]}),c.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[c.jsx("div",{style:{color:"#64748B"},children:"Credit"}),c.jsx("div",{style:{fontWeight:"700",color:"#DC2626"},children:jt(ne.totals.credit)})]}),c.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[c.jsx("div",{style:{color:"#64748B"},children:"Amount Received"}),c.jsx("div",{style:{fontWeight:"700",color:"#059669"},children:jt(ne.totals.received)})]}),c.jsxs("div",{style:{padding:"8px",textAlign:"center"},children:[c.jsx("div",{style:{color:"#64748B"},children:"TDS Received"}),c.jsx("div",{style:{fontWeight:"700",color:"#1E293B"},children:jt(ne.totals.tds)})]})]}),c.jsx("div",{style:{overflowX:"auto"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px",minWidth:"1000px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",width:"75px",borderRight:"1px solid #E2E8F0"},children:"Date"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",minWidth:"150px",borderRight:"1px solid #E2E8F0"},children:"Particular"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"80px",borderRight:"1px solid #E2E8F0"},children:"Vch Type"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",width:"110px",borderRight:"1px solid #E2E8F0"},children:"Vch No."}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Debit"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Credit"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"85px",borderRight:"1px solid #E2E8F0"},children:"Date of Receipt"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Amount Received"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"80px",borderRight:"1px solid #E2E8F0"},children:"TDS Received"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"85px",borderRight:"1px solid #E2E8F0"},children:"Balance"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"75px",borderRight:"1px solid #E2E8F0"},children:"Payment Status"}),lr&&c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"50px"},children:"Action"})]})}),c.jsx("tbody",{children:ne.entries.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:lr?"12":"11",style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:"No entries in selected period"})}):ne.entries.map(V=>c.jsxs(Z0.Fragment,{children:[c.jsxs("tr",{style:{backgroundColor:V.isOpening?"#FEF3C7":V.hasCN||V.isCreditNote?"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #E2E8F0",borderLeft:V.hasCN||V.isCreditNote?"4px solid #F59E0B":"none"},children:[c.jsx("td",{style:{padding:"8px",borderRight:"1px solid #E2E8F0"},children:V.date?Ft(V.date):""}),c.jsx("td",{style:{padding:"8px",fontWeight:"600",color:V.isCreditNote?"#DC2626":"#1E293B",borderRight:"1px solid #E2E8F0"},children:V.particular}),c.jsx("td",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #E2E8F0"},children:V.vchType&&c.jsx("span",{style:{padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:V.vchType==="Sales"?"#DCFCE7":"#FEE2E2",color:V.vchType==="Sales"?"#166534":"#991B1B"},children:V.vchType})}),c.jsx("td",{style:{padding:"8px",borderRight:"1px solid #E2E8F0"},children:V.vchNo&&V.isInvoice&&!V.isHistorical?c.jsx("button",{onClick:()=>oF(V.vchNo),style:{background:"none",border:"none",padding:0,fontWeight:"600",color:"#2874A6",cursor:"pointer",textDecoration:"underline",fontSize:"11px"},title:"Click to view invoice",children:V.vchNo}):c.jsx("span",{style:{fontWeight:"600",color:V.isCreditNote?"#DC2626":"#2874A6"},children:V.vchNo})}),c.jsx("td",{style:{padding:"8px",textAlign:"right",fontWeight:"600",borderRight:"1px solid #E2E8F0"},children:V.debit>0?jt(V.debit):""}),c.jsx("td",{style:{padding:"8px",textAlign:"right",color:"#DC2626",borderRight:"1px solid #E2E8F0"},children:V.credit>0?jt(V.credit):""}),c.jsx("td",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #E2E8F0"},children:V.receiptDate?Ft(V.receiptDate):""}),c.jsx("td",{style:{padding:"8px",textAlign:"right",color:"#059669",fontWeight:V.amountReceived>0?"600":"400",borderRight:"1px solid #E2E8F0"},children:V.amountReceived>0?jt(V.amountReceived):""}),c.jsx("td",{style:{padding:"8px",textAlign:"right",borderRight:"1px solid #E2E8F0"},children:V.tdsReceived>0?jt(V.tdsReceived):""}),c.jsx("td",{style:{padding:"8px",textAlign:"right",fontWeight:"600",color:typeof V.balance=="number"&&V.balance>0?"#DC2626":"",borderRight:"1px solid #E2E8F0"},children:V.isOpening?V.balance>0?jt(V.balance):"":V.balance==="-"?"-":typeof V.balance=="number"&&V.balance>0?jt(V.balance):"-"}),c.jsx("td",{style:{padding:"8px",textAlign:"center"},children:V.paymentStatus&&c.jsx("span",{style:{padding:"2px 8px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:V.paymentStatus==="Received"?"#DCFCE7":"#FEF3C7",color:V.paymentStatus==="Received"?"#166534":"#92400E"},children:V.paymentStatus})}),lr&&c.jsx("td",{style:{padding:"8px",textAlign:"center"},children:V.isHistorical&&!V.isOpening&&c.jsx("button",{onClick:()=>X4(te.find(he=>he.id===V.id)),style:{padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete historical entry",children:""})})]}),V.subRows&&V.subRows.length>0&&V.subRows.map((he,ie)=>c.jsxs("tr",{style:{backgroundColor:V.isOpening?"#FEF3C7":V.hasCN||V.isCreditNote?"#FFFBEB":"#FFFFFF",borderBottom:ie===V.subRows.length-1?"2px solid #CBD5E1":"1px solid #E2E8F0",borderLeft:V.hasCN||V.isCreditNote?"4px solid #F59E0B":"none"},children:[c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px 6px 30px",color:"#475569",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:he.particular}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:he.debit?jt(he.debit):""}),c.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:he.credit?jt(he.credit):""}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),lr&&c.jsx("td",{style:{padding:"6px 8px"}})]},`${V.id}-sub-${ie}`))]},V.id))})]})})]}):c.jsx("div",{style:{padding:"60px",textAlign:"center",color:"#94A3B8"},children:"Select a party to view ledger"})})]})]})},[Sc,wy]=ve.useState(""),l0=ve.useMemo(()=>{const h=new Map,E=j=>{if(!j)return"";const P=j.split("/");return P.length>=3?P.slice(1).join("/"):P.length===2?P.join("/"):P[P.length-1]},z=zn.filter(j=>{var P;return j.isHistorical&&(j.type==="creditnote"||((P=j.vchNo)==null?void 0:P.toUpperCase().startsWith("CN")))}),Q=new Map;return cs.forEach(j=>{const P=E(j.invoiceNo);P&&Q.set(P,j)}),z.forEach(j=>{const P=E(j.vchNo);P&&!Q.has(P)&&Q.set(P,j)}),on.filter(j=>j.invoiceGenerated&&j.invoiceStatus==="Approved").forEach(j=>{if(h.has(j.invoiceNo))h.has(j.invoiceNo)&&h.get(j.invoiceNo).campaigns.push(j);else{const P=Ni.find(ge=>ge.invoiceNo===j.invoiceNo),ne=cs.find(ge=>ge.invoiceNo===j.invoiceNo),V=parseFloat(j.invoiceTotalAmount)||0,he=ne?Math.abs(parseFloat(ne.totalAmount)||parseFloat(ne.credit)||0):0,ie=ne&&he>=V;if(!P&&!ie){const ge=ne?V-he:V;h.set(j.invoiceNo,{invoiceNo:j.invoiceNo,partyName:j.partyName,invoiceDate:j.invoiceDate,invoiceTotalAmount:j.invoiceTotalAmount,pendingAmount:ge,hasPartialCN:!!ne&&!ie&&he>0,cnAmount:he,subject:j.subject,campaigns:[j],isHistorical:!1,invoiceType:j.invoiceType||"Individual"})}}}),zn.filter(j=>{var P;return j.isHistorical&&j.type!=="creditnote"&&!((P=j.vchNo)!=null&&P.toUpperCase().startsWith("CN"))&&j.debit>0}).forEach(j=>{if(!h.has(j.vchNo)){const P=Ni.find(be=>be.invoiceNo===j.vchNo),ne=E(j.vchNo),V=Q.get(ne),he=V?Math.abs(parseFloat(V.totalAmount)||parseFloat(V.credit)||parseFloat(V.debit)||0):0,ie=parseFloat(j.debit)||0,ge=V&&he>=ie;if(P||ge)return;const le=!(j.amountReceived>0),J=V&&he>0&&he<ie;if(le||J){const be=J?ie-he:ie;h.set(j.vchNo,{invoiceNo:j.vchNo,partyName:j.partyName,invoiceDate:j.date,invoiceTotalAmount:ie,pendingAmount:be,hasPartialCN:J,cnAmount:he,subject:j.particulars||j.narration,campaigns:[],isHistorical:!0})}}}),Array.from(h.values()).sort((j,P)=>j.partyName.localeCompare(P.partyName))},[on,Ni,cs,zn]),$F=ve.useMemo(()=>{const h={};return ml.forEach(E=>{h[E.invoiceNo]||(h[E.invoiceNo]=[]),h[E.invoiceNo].push(E)}),Object.keys(h).forEach(E=>{h[E].sort((z,Q)=>new Date(Q.followupDate)-new Date(z.followupDate))}),h},[ml]),Sy=ve.useMemo(()=>{const h=new Date().toISOString().split("T")[0];return ml.filter(E=>E.nextFollowupDate&&E.nextFollowupDate>=h).sort((E,z)=>new Date(E.nextFollowupDate)-new Date(z.nextFollowupDate))},[ml]),c0=ve.useMemo(()=>{let h=l0;if(Sc){const z=Sc.toLowerCase();h=l0.filter(Q=>{var j,P,ne;return((j=Q.invoiceNo)==null?void 0:j.toLowerCase().includes(z))||((P=Q.partyName)==null?void 0:P.toLowerCase().includes(z))||((ne=Q.subject)==null?void 0:ne.toLowerCase().includes(z))})}const E={};return h.forEach(z=>{E[z.partyName]||(E[z.partyName]={partyName:z.partyName,invoices:[],totalAmount:0}),E[z.partyName].invoices.push(z),E[z.partyName].totalAmount+=parseFloat(z.pendingAmount||z.invoiceTotalAmount)||0}),Object.values(E).sort((z,Q)=>z.partyName.localeCompare(Q.partyName))},[l0,Sc]),GF=()=>{const h=c0.reduce((E,z)=>E+z.invoices.length,0);return c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Followups"}),c.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[c.jsxs("span",{style:{padding:"6px 12px",backgroundColor:"#EFF6FF",borderRadius:"6px",fontSize:"12px",color:"#1E40AF",fontWeight:"600"},children:[c0.length," Parties | ",h," Invoices"]}),xn&&c.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"})]})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(id,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Search:"})]}),c.jsxs("div",{style:{position:"relative",flex:1,maxWidth:"300px"},children:[c.jsx(z0,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",placeholder:"Search party, invoice, subject...",value:Sc,onChange:E=>wy(E.target.value),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"100%"}})]}),Sc&&c.jsxs("button",{onClick:()=>wy(""),style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(Na,{size:14})," Clear"]}),Sc&&c.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",h," of ",l0.length]})]})}),Sy.length>0&&c.jsx(Xr,{title:" Upcoming Followups",style:{marginBottom:"16px"},children:c.jsx("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:Sy.slice(0,5).map(E=>c.jsxs("div",{style:{padding:"10px 14px",backgroundColor:new Date(E.nextFollowupDate).toISOString().split("T")[0]===new Date().toISOString().split("T")[0]?"#FEE2E2":"#FEF3C7",borderRadius:"8px",border:"1px solid #FCD34D"},children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#92400E"},children:E.invoiceNo}),c.jsx("div",{style:{fontSize:"11px",color:"#78716C"},children:E.partyName}),c.jsxs("div",{style:{fontSize:"12px",fontWeight:"600",color:"#DC2626",marginTop:"4px"},children:[" ",Ft(E.nextFollowupDate)]})]},E.id))})}),c0.length===0?c.jsx(Xr,{children:c.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:" No pending invoices! All payments received."})}):c0.map(E=>c.jsxs(Xr,{style:{marginBottom:"16px"},noPadding:!0,children:[c.jsxs("div",{style:{padding:"12px 16px",backgroundColor:"#1E293B",color:"white",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[c.jsxs("span",{style:{fontSize:"15px",fontWeight:"700"},children:[" ",E.partyName]}),c.jsxs("span",{style:{padding:"3px 10px",backgroundColor:"#3B82F6",borderRadius:"12px",fontSize:"11px",fontWeight:"600"},children:[E.invoices.length," Invoice",E.invoices.length>1?"s":""]})]}),c.jsxs("div",{style:{fontSize:"14px",fontWeight:"700",color:"#FCD34D"},children:["Total: ",tt(E.totalAmount)]})]}),c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[c.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Type"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Invoice Date"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:"Amount"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Days Pending"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Last Followup"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),c.jsx("tbody",{children:E.invoices.map(z=>{var V,he,ie;const Q=$F[z.invoiceNo]||[],j=Q[0],P=Math.floor((new Date-new Date(z.invoiceDate))/(1e3*60*60*24)),ne=z.isHistorical?"Historical":z.invoiceType||(((V=z.campaigns)==null?void 0:V.length)>1?"Combined":"Individual");return c.jsxs(Z0.Fragment,{children:[c.jsxs("tr",{style:{borderBottom:"1px solid #E2E8F0",backgroundColor:P>30?"#FEF2F2":P>15?"#FFFBEB":"#FFFFFF"},children:[c.jsxs("td",{style:{padding:"10px 12px",fontWeight:"600",color:"#2874A6"},children:[z.invoiceNo,z.hasPartialCN&&c.jsx("span",{style:{marginLeft:"6px",padding:"2px 6px",backgroundColor:"#FEF3C7",color:"#92400E",borderRadius:"4px",fontSize:"9px",fontWeight:"700"},children:"Partial CN"})]}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsx("span",{style:{padding:"3px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"600",backgroundColor:ne==="Historical"?"#E0E7FF":ne==="Combined"?"#F3E8FF":"#DCFCE7",color:ne==="Historical"?"#3730A3":ne==="Combined"?"#7C3AED":"#166534"},children:ne})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:Ft(z.invoiceDate)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600"},children:z.hasPartialCN?c.jsxs("div",{children:[c.jsx("div",{style:{color:"#DC2626"},children:tt(z.pendingAmount)}),c.jsx("div",{style:{fontSize:"9px",color:"#64748B",textDecoration:"line-through"},children:tt(z.invoiceTotalAmount)})]}):tt(z.invoiceTotalAmount)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsxs("span",{style:{padding:"3px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"700",backgroundColor:P>30?"#FEE2E2":P>15?"#FEF3C7":"#DCFCE7",color:P>30?"#991B1B":P>15?"#92400E":"#166534"},children:[P," days"]})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center",fontSize:"11px"},children:j?c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"600"},children:Ft(j.followupDate)}),c.jsxs("div",{style:{color:"#64748B",fontSize:"10px"},children:[(he=j.notes)==null?void 0:he.substring(0,30),((ie=j.notes)==null?void 0:ie.length)>30?"...":""]})]}):c.jsx("span",{style:{color:"#DC2626",fontWeight:"600"},children:"No followup yet"})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsxs("div",{style:{display:"flex",gap:"4px",justifyContent:"center"},children:[lr&&c.jsx(qe,{icon:sd,small:!0,variant:"primary",onClick:()=>Q4(z),title:"Add Followup"}),c.jsx(qe,{icon:Kg,small:!0,variant:"brand",onClick:()=>oy(z),title:"Copy Email Template"}),c.jsx(qe,{icon:Xg,small:!0,variant:"success",onClick:()=>ly(z),title:"Search in Gmail"})]})})]}),Q.length>0&&c.jsx("tr",{children:c.jsxs("td",{colSpan:"7",style:{padding:"8px 12px 12px 40px",backgroundColor:"#F8FAFC"},children:[c.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#64748B",marginBottom:"6px"},children:"Followup History:"}),c.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:Q.map(ge=>c.jsxs("div",{style:{padding:"6px 10px",backgroundColor:"#FFFFFF",borderRadius:"6px",border:"1px solid #E2E8F0",fontSize:"11px"},children:[c.jsx("div",{style:{fontWeight:"600",color:"#2874A6"},children:Ft(ge.followupDate)}),c.jsx("div",{style:{color:"#475569",marginTop:"2px"},children:ge.notes}),ge.nextFollowupDate&&c.jsxs("div",{style:{color:"#DC2626",marginTop:"2px",fontSize:"10px"},children:["Next: ",Ft(ge.nextFollowupDate)]}),lr&&c.jsx("button",{onClick:()=>Z4(ge.id),style:{background:"none",border:"none",color:"#DC2626",cursor:"pointer",fontSize:"10px",padding:"2px 0",marginTop:"4px"},children:" Delete"})]},ge.id))})]})})]},z.invoiceNo)})})]})]},E.partyName))]})},Ty=()=>{const h=_e.filter(j=>j.invoiceGenerated).reduce((j,P)=>j+(parseFloat(P.invoiceTotalAmount)||0),0),E=_e.filter(j=>j.invoiceStatus==="Paid").reduce((j,P)=>j+(parseFloat(P.invoiceTotalAmount)||0),0),z=_e.filter(j=>j.invoiceStatus==="Approved").reduce((j,P)=>j+(parseFloat(P.invoiceTotalAmount)||0),0),Q=_e.filter(j=>j.invoiceStatus==="Need Edits").length;return c.jsxs("div",{children:[c.jsx("h1",{style:{margin:"0 0 16px",fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Reports"}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px"},children:[c.jsxs(Xr,{children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Total Invoiced"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:tt(h)})]}),c.jsxs(Xr,{children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Approved"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669"},children:tt(z)})]}),c.jsxs(Xr,{children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Need Edits"}),c.jsxs("div",{style:{fontSize:"24px",fontWeight:"700",color:"#DC2626"},children:[Q," invoices"]})]}),c.jsxs(Xr,{children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Paid"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669"},children:tt(E)})]})]})]})},KF=()=>c.jsxs("div",{children:[c.jsx("h1",{style:{margin:"0 0 16px",fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Settings"}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[c.jsxs(Xr,{title:" Invoice Series",children:[c.jsx(Er,{label:"Invoice Prefix",value:S.invoicePrefix,onChange:h=>I(E=>({...E,invoicePrefix:h.target.value})),small:!0}),c.jsx(Er,{label:"Next Invoice Number",type:"number",value:Fe,onChange:h=>Ae(parseInt(h.target.value)||1),small:!0}),c.jsx(Er,{label:"Next Combine Code",type:"number",value:it,onChange:h=>q(parseInt(h.target.value)||1),small:!0}),c.jsxs("div",{style:{padding:"10px",backgroundColor:"#EFF6FF",borderRadius:"8px",fontSize:"14px"},children:[c.jsx("strong",{children:"Preview:"})," ",S.invoicePrefix,Fe]})]}),c.jsxs(Xr,{title:" Mailer Logo",children:[c.jsx("input",{type:"file",ref:Aa,accept:"image/*",style:{display:"none"},onChange:_F}),Lt?c.jsxs("div",{style:{textAlign:"center"},children:[c.jsx("img",{src:Lt,alt:"Logo",style:{maxWidth:"250px",maxHeight:"60px",marginBottom:"12px",border:"1px solid #E2E8F0",padding:"8px",borderRadius:"8px"}}),c.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"center"},children:[c.jsx(qe,{icon:Mj,label:"Change",small:!0,onClick:()=>{var h;return(h=Aa.current)==null?void 0:h.click()}}),c.jsx(qe,{icon:Ls,label:"Remove",variant:"danger",small:!0,onClick:()=>Ta(null)})]})]}):c.jsxs("div",{onClick:()=>{var h;return(h=Aa.current)==null?void 0:h.click()},style:{border:"2px dashed #CBD5E1",borderRadius:"10px",padding:"30px",textAlign:"center",cursor:"pointer"},children:[c.jsx(js,{size:32,color:"#94A3B8",style:{marginBottom:"8px"}}),c.jsx("p",{style:{margin:0,color:"#64748B",fontSize:"14px"},children:"Click to upload"})]})]}),c.jsxs(Xr,{title:" WhatsApp Notifications",children:[c.jsx("div",{style:{marginBottom:"16px"},children:c.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"10px",cursor:"pointer"},children:[c.jsx("input",{type:"checkbox",checked:lt.enabled,onChange:h=>Rs(E=>({...E,enabled:h.target.checked})),style:{width:"18px",height:"18px",cursor:"pointer"}}),c.jsx("span",{style:{fontSize:"14px",fontWeight:"600",color:"#1E293B"},children:"Enable WhatsApp Notifications"})]})}),lt.enabled&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{style:{padding:"12px",backgroundColor:"#DCFCE7",borderRadius:"8px",marginBottom:"16px",fontSize:"12px",color:"#166534",border:"1px solid #86EFAC"},children:[c.jsx("strong",{children:" FREE Setup using CallMeBot:"}),c.jsx("br",{}),"1. Save this number in contacts: ",c.jsx("strong",{children:"+34 644 71 81 99"}),c.jsx("br",{}),"2. Send this message to the number on WhatsApp: ",c.jsx("strong",{children:'"I allow callmebot to send me messages"'}),c.jsx("br",{}),"3. You'll receive an API key - enter it below",c.jsx("br",{}),"4. Repeat for each phone number you want to receive notifications"]}),c.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",marginBottom:"12px",border:"1px solid #E2E8F0"},children:[c.jsxs("div",{style:{fontSize:"13px",fontWeight:"700",color:"#1E293B",marginBottom:"10px",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(U0,{size:16})," Finance Team"]}),c.jsx(Er,{label:"Phone (with country code)",value:lt.financePhone,onChange:h=>Rs(E=>({...E,financePhone:h.target.value})),placeholder:"919876543210",small:!0}),c.jsx(Er,{label:"API Key (from CallMeBot)",value:lt.financeApiKey,onChange:h=>Rs(E=>({...E,financeApiKey:h.target.value})),placeholder:"123456",small:!0}),lt.financePhone&&lt.financeApiKey&&c.jsx(qe,{icon:Q2,label:"Test Finance",variant:"success",small:!0,onClick:()=>vc(lt.financePhone,lt.financeApiKey)})]}),c.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",border:"1px solid #E2E8F0"},children:[c.jsxs("div",{style:{fontSize:"13px",fontWeight:"700",color:"#1E293B",marginBottom:"10px",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(U0,{size:16})," Director"]}),c.jsx(Er,{label:"Phone (with country code)",value:lt.directorPhone,onChange:h=>Rs(E=>({...E,directorPhone:h.target.value})),placeholder:"919876543210",small:!0}),c.jsx(Er,{label:"API Key (from CallMeBot)",value:lt.directorApiKey,onChange:h=>Rs(E=>({...E,directorApiKey:h.target.value})),placeholder:"123456",small:!0}),lt.directorPhone&&lt.directorApiKey&&c.jsx(qe,{icon:Q2,label:"Test Director",variant:"success",small:!0,onClick:()=>vc(lt.directorPhone,lt.directorApiKey)})]})]}),!lt.enabled&&c.jsx("div",{style:{padding:"20px",backgroundColor:"#F8FAFC",borderRadius:"8px",textAlign:"center",color:"#64748B",fontSize:"13px"},children:"WhatsApp notifications are disabled. Enable to receive FREE alerts for invoices, approvals, and payments."})]}),c.jsxs(Xr,{title:" Default Invoice Values",children:[c.jsx("input",{type:"file",ref:uo,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:tF}),c.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[c.jsx(qe,{icon:js,label:"Upload",variant:"brand",small:!0,onClick:()=>{var h;return(h=uo.current)==null?void 0:h.click()}}),c.jsx(qe,{icon:Eo,label:"Template",small:!0,onClick:rF})]}),Object.keys(hi).length>0&&c.jsx("div",{style:{maxHeight:"180px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"8px"},children:Object.entries(hi).map(([h,E])=>c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px 14px",borderBottom:"1px solid #F1F5F9",fontSize:"13px"},children:[c.jsx("span",{children:h}),c.jsx("span",{style:{fontWeight:"700"},children:tt(E)})]},h))})]}),c.jsxs(Xr,{title:" Party Master",children:[c.jsx("input",{type:"file",ref:e0,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:nF}),c.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[c.jsx(qe,{icon:js,label:"Upload Parties",variant:"brand",small:!0,onClick:()=>{var h;return(h=e0.current)==null?void 0:h.click()}}),c.jsx(qe,{icon:Eo,label:"Template",small:!0,onClick:iF})]}),c.jsxs("div",{style:{padding:"10px",backgroundColor:"#EFF6FF",borderRadius:"8px",fontSize:"12px",color:"#1E40AF",marginBottom:"12px"},children:[c.jsx("strong",{children:"Upload Format:"})," Name of Ledger, Ledger Group, State Name, GST Registration Type, GSTIN/UIN"]}),Object.keys(an).length>0&&c.jsxs("div",{style:{maxHeight:"150px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"8px"},children:[Object.entries(an).slice(0,20).map(([h,E])=>c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 12px",borderBottom:"1px solid #F1F5F9",fontSize:"11px"},children:[c.jsx("span",{style:{fontWeight:"600"},children:h.length>30?h.substring(0,30)+"...":h}),c.jsxs("span",{style:{color:"#64748B"},children:[E.stateName||"-"," | ",E.gstin?E.gstin.substring(0,10)+"...":"-"]})]},h)),Object.keys(an).length>20&&c.jsxs("div",{style:{padding:"8px 12px",textAlign:"center",color:"#64748B",fontSize:"11px"},children:["... and ",Object.keys(an).length-20," more parties"]})]}),Object.keys(an).length===0&&c.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#94A3B8",fontSize:"13px"},children:"No party master uploaded yet"})]}),c.jsxs(Xr,{title:" Data Management",children:[c.jsxs("div",{style:{padding:"16px",backgroundColor:"#FEF2F2",borderRadius:"10px",border:"1px solid #FCA5A5",marginBottom:"16px"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"14px",marginBottom:"8px"},children:" Danger Zone"}),c.jsxs("div",{style:{fontSize:"13px",color:"#7F1D1D",marginBottom:"16px"},children:["This will permanently delete all data including:",c.jsxs("ul",{style:{margin:"8px 0 0 16px",padding:0},children:[c.jsx("li",{children:"All campaigns and master data"}),c.jsx("li",{children:"All invoices and receipts"}),c.jsx("li",{children:"All ledger entries"}),c.jsx("li",{children:"All mailer images"}),c.jsx("li",{children:"Opening balances and settings"})]})]}),c.jsx(qe,{icon:Ls,label:"Clear All Data",variant:"danger",onClick:()=>bs(!0)})]}),c.jsxs("div",{style:{fontSize:"12px",color:"#64748B"},children:[c.jsx("strong",{children:"Current Data:"}),c.jsx("br",{})," ",_e.length," campaigns",c.jsx("br",{})," ",te.length," ledger entries",c.jsx("br",{})," ",je.length," receipts",c.jsx("br",{})," ",Object.keys(In).length," mailer images"]})]})]})]}),YF=()=>c.jsxs(c.Fragment,{children:[c.jsx(wn,{isOpen:EF,onClose:()=>{fy(!1),py("")},title:" Invoice Preview",width:"950px",children:ce&&hy&&c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px",padding:"14px 18px",backgroundColor:"#DCFCE7",borderRadius:"10px",border:"2px solid #22C55E"},children:[c.jsxs("div",{children:[c.jsxs("span",{style:{fontWeight:"700",fontSize:"16px",color:"#166534"},children:["Invoice: ",ce.invoiceNo]}),ce.invoiceType==="Combined"&&c.jsxs("span",{style:{marginLeft:"12px",padding:"4px 10px",backgroundColor:"#7C3AED",color:"white",borderRadius:"6px",fontSize:"12px",fontWeight:"600"},children:["Combined - C",ce.combinationCode]})]}),c.jsxs("button",{onClick:()=>SF(ce),style:{padding:"14px 28px",fontSize:"16px",fontWeight:"bold",border:"none",borderRadius:"10px",cursor:"pointer",backgroundColor:"#22C55E",color:"white",display:"flex",alignItems:"center",gap:"10px",boxShadow:"0 2px 8px rgba(34, 197, 94, 0.4)"},children:[c.jsx(Eo,{size:20}),"Download Invoice"]})]}),c.jsx("div",{style:{border:"2px solid #E2E8F0",borderRadius:"10px",overflow:"hidden",backgroundColor:"#f5f5f5"},children:c.jsx("iframe",{id:"invoice-viewer-iframe",srcDoc:hy,style:{width:"100%",height:"480px",border:"none",backgroundColor:"white"},title:"Invoice Preview"})}),c.jsxs("div",{style:{marginTop:"12px",padding:"14px 18px",backgroundColor:"#FEF3C7",borderRadius:"10px",border:"1px solid #FCD34D"},children:[c.jsx("div",{style:{fontSize:"14px",color:"#92400E",fontWeight:"600",marginBottom:"6px"},children:" How to Save as PDF:"}),c.jsxs("ol",{style:{fontSize:"13px",color:"#92400E",margin:"0",paddingLeft:"20px",lineHeight:"1.8"},children:[c.jsxs("li",{children:["Click ",c.jsx("strong",{children:'"Download Invoice"'})," button above"]}),c.jsxs("li",{children:["Open the downloaded ",c.jsx("strong",{children:".html file"})," in Chrome/Edge browser"]}),c.jsxs("li",{children:["Print dialog will open automatically - select ",c.jsx("strong",{children:'"Save as PDF"'})]}),c.jsxs("li",{children:["Click ",c.jsx("strong",{children:"Save"})," to get your PDF!"]})]})]})]})}),c.jsx(wn,{isOpen:fr,onClose:()=>{hr(!1),ki(""),ea({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1})},title:xn?" Review & Approve Invoice":" Invoice Details",width:"550px",children:ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",ce.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",ce.partyName]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Amount:"})," ",tt(ce.invoiceTotalAmount)]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Email:"})," ",ce.emailId||"Not set"]}),c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Invoice Type:"})," ",c.jsx("span",{style:{color:ce.invoiceType==="Combined"?"#7C3AED":"#2874A6",fontWeight:"600"},children:ce.invoiceType||"Individual"})]}),ce.invoiceType==="Combined"&&c.jsxs("div",{style:{marginTop:"8px",fontSize:"13px",color:"#7C3AED"},children:[c.jsx("strong",{children:"Combined Campaigns:"})," ",v(ce).map(h=>h.senderName).join(", ")]})]}),ce.editComments&&c.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[c.jsx("div",{style:{fontWeight:"600",color:"#991B1B",fontSize:"13px",marginBottom:"4px"},children:" Need Edits - Director Remarks:"}),c.jsx("div",{style:{fontSize:"13px",color:"#7F1D1D"},children:ce.editComments})]}),ce.approvalRemarks&&ce.invoiceStatus==="Approved"&&c.jsxs("div",{style:{backgroundColor:"#DCFCE7",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[c.jsx("div",{style:{fontWeight:"600",color:"#166534",fontSize:"13px",marginBottom:"4px"},children:" Approved - Director Remarks:"}),c.jsx("div",{style:{fontSize:"13px",color:"#15803D"},children:ce.approvalRemarks})]}),xn?c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#166534",fontSize:"14px",marginBottom:"12px"},children:" Approval Confirmations"}),c.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",marginBottom:"12px",cursor:"pointer"},children:[c.jsx("input",{type:"checkbox",checked:Sa.particularsApproved,onChange:h=>ea(E=>({...E,particularsApproved:h.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"1. Particulars & Amount Approved"}),c.jsxs("div",{style:{fontSize:"12px",color:"#15803D"},children:["I confirm that the invoice particulars and amount (",tt(ce.invoiceTotalAmount),") are correct."]})]})]}),c.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",marginBottom:"12px",cursor:"pointer"},children:[c.jsx("input",{type:"checkbox",checked:Sa.emailApproved,onChange:h=>ea(E=>({...E,emailApproved:h.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"2. Email ID Approved for Mailing"}),c.jsxs("div",{style:{fontSize:"12px",color:"#15803D"},children:["I confirm that ",c.jsx("strong",{children:ce.emailId||"the specified email"})," should be used for mailing."]})]})]}),c.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",cursor:"pointer"},children:[c.jsx("input",{type:"checkbox",checked:Sa.invoiceTypeApproved,onChange:h=>ea(E=>({...E,invoiceTypeApproved:h.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"3. Invoice Type Confirmed"}),c.jsx("div",{style:{fontSize:"12px",color:"#15803D"},children:ce.invoiceType==="Combined"?`I confirm that a Combined Invoice is required for these ${v(ce).length} campaigns.`:"I confirm that an Individual Invoice is required (not combined with others)."})]})]})]}):c.jsxs("div",{style:{backgroundColor:ce.invoiceStatus==="Approved"?"#DCFCE7":ce.invoiceStatus==="Need Edits"?"#FEF3C7":"#F8FAFC",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid "+(ce.invoiceStatus==="Approved"?"#86EFAC":ce.invoiceStatus==="Need Edits"?"#FCD34D":"#E2E8F0")},children:[c.jsx("div",{style:{fontWeight:"600",color:ce.invoiceStatus==="Approved"?"#166534":ce.invoiceStatus==="Need Edits"?"#92400E":"#64748B",fontSize:"14px"},children:ce.invoiceStatus==="Approved"?" Approved by Director":ce.invoiceStatus==="Need Edits"?" Edits Required by Director":" Pending Director Approval"}),c.jsx("div",{style:{fontSize:"13px",color:ce.invoiceStatus==="Approved"?"#15803D":ce.invoiceStatus==="Need Edits"?"#A16207":"#64748B",marginTop:"6px"},children:ce.invoiceStatus==="Approved"?"This invoice has been approved and is ready for mailing.":ce.invoiceStatus==="Need Edits"?"Please make the required changes and resubmit for approval.":"This invoice is awaiting Director approval."})]}),xn&&c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:" Remarks (optional for Approve, visible to Finance)"}),c.jsx("textarea",{value:Zs,onChange:h=>ki(h.target.value),placeholder:"Enter remarks or comments...",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(qe,{label:"Close",onClick:()=>{hr(!1),ki(""),ea({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1})}}),xn&&c.jsxs(c.Fragment,{children:[c.jsx(qe,{label:"Need Edits",variant:"danger",icon:Pj,onClick:Ut}),c.jsx(qe,{label:"Approve",variant:"success",icon:Lj,onClick:ln})]})]})]})}),c.jsx(wn,{isOpen:yr,onClose:()=>di(!1),title:" Delete Invoice",width:"450px",children:ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"15px",marginBottom:"8px"},children:" Are you sure?"}),c.jsxs("div",{style:{fontSize:"14px",color:"#7F1D1D",lineHeight:"1.5"},children:["This will delete invoice ",c.jsx("strong",{children:ce.invoiceNo})," and reset the campaign(s) to allow re-generation.",ce.invoiceType==="Combined"&&c.jsxs("div",{style:{marginTop:"8px"},children:[c.jsxs("strong",{children:["All ",v(ce).length," combined campaigns"]})," will be reset to Individual type for re-selection."]})]})]}),c.jsxs("div",{style:{backgroundColor:"#F8FAFC",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"Invoice:"})," ",ce.invoiceNo]}),c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"Party:"})," ",ce.partyName]}),c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"Amount:"})," ",tt(ce.invoiceTotalAmount)]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(qe,{label:"Cancel",onClick:()=>di(!1)}),c.jsx(qe,{label:"Delete Invoice",variant:"danger",icon:Ls,onClick:G4})]})]})}),c.jsx(wn,{isOpen:ui,onClose:()=>pt(!1),title:" Add Email Address",width:"400px",children:ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"Campaign:"})," ",ce.senderName]}),c.jsxs("div",{style:{fontSize:"13px",marginTop:"4px"},children:[c.jsx("strong",{children:"Current:"})," ",ce.emailId||"None"]})]}),c.jsx(Er,{label:"Additional Email Address",type:"email",value:_a,onChange:h=>Js(h.target.value),placeholder:"email@example.com",small:!0}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:[c.jsx(qe,{label:"Cancel",onClick:()=>pt(!1)}),c.jsx(qe,{label:"Add Email",variant:"brand",icon:q2,onClick:()=>{_a&&_a.includes("@")?(me(ce.id,_a),pt(!1),Js("")):alert("Please enter a valid email address")}})]})]})}),c.jsx(wn,{isOpen:k,onClose:()=>{_(!1),G({currentPassword:"",newPassword:"",confirmPassword:""}),T("")},title:" Change Password",width:"400px",children:c.jsxs("div",{children:[c.jsx("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"User:"})," ",r==="director"?"Director":"Finance Team"]})}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Current Password"}),c.jsx("input",{type:"password",value:O.currentPassword,onChange:h=>G(E=>({...E,currentPassword:h.target.value})),placeholder:"Enter current password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"New Password"}),c.jsx("input",{type:"password",value:O.newPassword,onChange:h=>G(E=>({...E,newPassword:h.target.value})),placeholder:"Enter new password (min 6 characters)",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Confirm New Password"}),c.jsx("input",{type:"password",value:O.confirmPassword,onChange:h=>G(E=>({...E,confirmPassword:h.target.value})),placeholder:"Confirm new password",onKeyPress:h=>h.key==="Enter"&&_c(),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),U&&c.jsx("div",{style:{marginBottom:"16px",padding:"10px",backgroundColor:"#FEE2E2",borderRadius:"8px",color:"#991B1B",fontSize:"13px"},children:U}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[c.jsx(qe,{label:"Cancel",onClick:()=>{_(!1),G({currentPassword:"",newPassword:"",confirmPassword:""}),T("")}}),c.jsx(qe,{label:"Change Password",variant:"brand",icon:V0,onClick:_c})]})]})}),c.jsx(wn,{isOpen:k,onClose:()=>{_(!1),T(""),G({currentPassword:"",newPassword:"",confirmPassword:""})},title:" Change Password",width:"400px",children:c.jsxs("div",{children:[c.jsx("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:c.jsxs("div",{style:{fontSize:"13px",color:"#1E40AF"},children:["Changing password for: ",c.jsx("strong",{children:r==="director"?"Director":"Finance Team"})]})}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Current Password"}),c.jsx("input",{type:"password",value:O.currentPassword,onChange:h=>G(E=>({...E,currentPassword:h.target.value})),placeholder:"Enter current password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"New Password"}),c.jsx("input",{type:"password",value:O.newPassword,onChange:h=>G(E=>({...E,newPassword:h.target.value})),placeholder:"Enter new password (min 6 chars)",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Confirm New Password"}),c.jsx("input",{type:"password",value:O.confirmPassword,onChange:h=>G(E=>({...E,confirmPassword:h.target.value})),placeholder:"Re-enter new password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),U&&c.jsx("div",{style:{marginBottom:"16px",padding:"10px",backgroundColor:"#FEE2E2",borderRadius:"8px",color:"#991B1B",fontSize:"13px"},children:U}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[c.jsx(qe,{label:"Cancel",onClick:()=>{_(!1),T(""),G({currentPassword:"",newPassword:"",confirmPassword:""})}}),c.jsx(qe,{label:"Change Password",variant:"brand",icon:V0,onClick:_c})]})]})}),c.jsx(wn,{isOpen:Sr,onClose:()=>{dr(!1),ta(new Set),Ds(null)},title:" Combine Invoices",width:"700px",children:pc&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#F3E8FF",padding:"14px 18px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"15px",fontWeight:"700",color:"#6B21A8"},children:["Party: ",pc]}),c.jsx("div",{style:{fontSize:"13px",color:"#7C3AED",marginTop:"4px"},children:"Select 2+ campaigns to combine into a single invoice"})]}),c.jsx("div",{style:{maxHeight:"350px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"10px"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",position:"sticky",top:0},children:[c.jsx("th",{style:{padding:"12px",textAlign:"center",width:"50px"},children:""}),c.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Sender"}),c.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Subject"}),c.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Date"}),c.jsx("th",{style:{padding:"12px",textAlign:"right"},children:"Amount"})]})}),c.jsx("tbody",{children:go(pc).map(h=>{var E;return c.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:sn.has(h.id)?"#F3E8FF":"transparent",cursor:"pointer"},onClick:()=>gF(h.id),children:[c.jsx("td",{style:{padding:"12px",textAlign:"center"},children:c.jsx("input",{type:"checkbox",checked:sn.has(h.id),onChange:()=>{},style:{width:"18px",height:"18px",cursor:"pointer"}})}),c.jsx("td",{style:{padding:"12px",fontWeight:"600"},children:h.senderName}),c.jsxs("td",{style:{padding:"12px",color:"#64748B"},children:[(E=h.subject)==null?void 0:E.substring(0,35),"..."]}),c.jsx("td",{style:{padding:"12px"},children:Ft(h.date)}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:tt(h.totalWithGst)})]},h.id)})})]})}),c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px 18px",borderRadius:"10px",marginTop:"16px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsxs("div",{style:{fontSize:"14px",color:"#64748B"},children:["Selected: ",c.jsx("strong",{children:sn.size})," | Combine Code: ",c.jsxs("strong",{children:["C",it]})]}),c.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#2874A6"},children:["Total: ",tt(_e.filter(h=>sn.has(h.id)).reduce((h,E)=>h+(parseFloat(E.totalWithGst)||0),0))]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[c.jsx(qe,{label:"Cancel",onClick:()=>{dr(!1),ta(new Set)}}),c.jsx(qe,{label:"Create Combined Invoice",variant:"purple",icon:wl,disabled:sn.size<2,onClick:pF})]})]})}),c.jsxs(wn,{isOpen:bn,onClose:()=>{en(!1),os(null),fl(!1)},title:Uu?" Replace Mailer":" Upload Mailer",width:"550px",children:[c.jsx("input",{type:"file",ref:Wu,accept:"image/*",style:{display:"none"},onChange:xF}),ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"14px"},children:[c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Sender:"})," ",ce.senderName]}),c.jsxs("div",{style:{fontSize:"14px",marginTop:"4px"},children:[c.jsx("strong",{children:"Subject:"})," ",ce.subject]})]}),Uu&&In[ce.id]&&c.jsx("div",{style:{backgroundColor:"#FEF3C7",padding:"12px",borderRadius:"10px",marginBottom:"14px",border:"1px solid #FCD34D"},children:c.jsxs("div",{style:{fontWeight:"600",color:"#92400E",fontSize:"13px"},children:[" This will replace ",In[ce.id].length," existing image(s)"]})}),c.jsxs("div",{style:{backgroundColor:"#FEF3C7",padding:"14px",borderRadius:"10px",marginBottom:"14px",border:"1px solid #FCD34D"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#92400E",marginBottom:"8px",fontSize:"14px"},children:"Step 1: Find Mailer in Gmail"}),c.jsxs("button",{onClick:()=>yF(ce.subject),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 18px",backgroundColor:"#EA4335",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:[c.jsx(Rj,{size:16})," Search in Gmail"]})]}),c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"14px",borderRadius:"10px",border:"1px solid #86EFAC"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#166534",marginBottom:"8px",fontSize:"14px"},children:"Step 2: Paste Screenshot"}),c.jsx("div",{ref:Hu,tabIndex:0,onPaste:vF,onClick:()=>{var h;return(h=Hu.current)==null?void 0:h.focus()},style:{border:as?"3px solid #22C55E":"3px dashed #22C55E",borderRadius:"10px",padding:as?"8px":"30px",textAlign:"center",cursor:"pointer",backgroundColor:as?"#FFFFFF":"#ECFDF5",minHeight:"100px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",outline:"none"},children:as?c.jsxs(c.Fragment,{children:[c.jsx("img",{src:as,alt:"Pasted",style:{maxWidth:"100%",maxHeight:"200px",borderRadius:"8px",marginBottom:"10px"}}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsx(qe,{icon:$g,label:"Save",variant:"success",onClick:()=>uy(as)}),c.jsx(qe,{icon:Ls,label:"Clear",variant:"danger",onClick:()=>os(null)})]})]}):c.jsxs(c.Fragment,{children:[c.jsx(Kg,{size:36,color:"#22C55E",style:{marginBottom:"8px"}}),c.jsx("div",{style:{fontWeight:"700",fontSize:"14px",color:"#166534"},children:"Click here & Press Ctrl+V"})]})}),c.jsxs("div",{style:{textAlign:"center",marginTop:"12px"},children:[c.jsx("span",{style:{color:"#64748B",fontSize:"13px"},children:" OR "}),c.jsx("div",{style:{marginTop:"8px"},children:c.jsx(qe,{icon:js,label:"Browse Files",onClick:()=>{var h;return(h=Wu.current)==null?void 0:h.click()}})})]})]})]})]}),c.jsx(wn,{isOpen:wi,onClose:()=>rs(!1),title:" Send Invoice Email",width:"600px",children:ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",gap:"0",marginBottom:"16px",border:"2px solid #E2E8F0",borderRadius:"8px",overflow:"hidden"},children:[c.jsx("button",{onClick:()=>ns("reply"),style:{flex:1,padding:"12px",backgroundColor:Ai==="reply"?"#2874A6":"#F8FAFC",color:Ai==="reply"?"white":"#64748B",border:"none",cursor:"pointer",fontWeight:"700",fontSize:"14px"},children:" Reply to Thread"}),c.jsx("button",{onClick:()=>ns("new"),style:{flex:1,padding:"12px",backgroundColor:Ai==="new"?"#2874A6":"#F8FAFC",color:Ai==="new"?"white":"#64748B",border:"none",cursor:"pointer",fontWeight:"700",fontSize:"14px"},children:" New Email"})]}),c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",ce.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Amount:"})," ",tt(ce.invoiceTotalAmount||ce.totalWithGst)]}),ce.invoiceType==="Combined"&&c.jsxs("div",{style:{fontSize:"13px",marginTop:"8px",color:"#7C3AED"},children:[c.jsx("strong",{children:"Campaigns:"})," ",v(ce).map(h=>h.senderName).join(", ")]}),c.jsx("div",{style:{fontSize:"14px",marginTop:"8px"},children:c.jsx("strong",{children:"Recipients:"})}),c.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",marginTop:"6px"},children:[oe(ce).map((h,E)=>c.jsx("span",{style:{padding:"4px 10px",backgroundColor:"#DBEAFE",borderRadius:"6px",fontSize:"13px",color:"#1E40AF"},children:h},E)),oe(ce).length===0&&c.jsx("span",{style:{color:"#94A3B8"},children:"No email addresses"})]})]}),Ai==="reply"?c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[c.jsx("span",{style:{fontWeight:"700",fontSize:"14px"},children:"Email Body:"}),c.jsx("button",{onClick:()=>{navigator.clipboard.writeText(o0(ce)),alert(" Copied!")},style:{padding:"6px 14px",backgroundColor:"#22C55E",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"600"},children:" Copy"})]}),c.jsx("div",{style:{fontSize:"13px",backgroundColor:"#F8FAFC",padding:"14px",borderRadius:"10px",whiteSpace:"pre-wrap",maxHeight:"200px",overflowY:"auto",fontFamily:"monospace",border:"1px solid #E2E8F0",lineHeight:"1.5"},children:o0(ce)})]}):c.jsxs("div",{style:{display:"flex",gap:"10px"},children:[c.jsx("button",{onClick:()=>{const h=oe(ce),E=encodeURIComponent(h.join(",")),z=encodeURIComponent(dy(ce)),Q=encodeURIComponent(o0(ce));window.open(`https://mail.google.com/mail/?view=cm&to=${E}&su=${z}&body=${Q}`,"_blank")},style:{padding:"12px 20px",backgroundColor:"#EA4335",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"700"},children:" Open Gmail"}),c.jsx("button",{onClick:()=>{const h=oe(ce),E=encodeURIComponent(h.join(";")),z=encodeURIComponent(dy(ce)),Q=encodeURIComponent(o0(ce));window.open(`https://outlook.live.com/mail/0/deeplink/compose?to=${E}&subject=${z}&body=${Q}`,"_blank")},style:{padding:"12px 20px",backgroundColor:"#0078D4",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"700"},children:" Open Outlook"})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[c.jsx(qe,{label:"View Invoice",icon:j0,onClick:()=>{rs(!1),Ku(ce)}}),c.jsx(qe,{label:"Close",onClick:()=>rs(!1)})]})]})}),c.jsx(wn,{isOpen:Si,onClose:()=>Lr(!1),title:" Record Payment",width:"500px",children:ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Invoice:"})," ",ce.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginTop:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",ce.partyName]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsx(Er,{label:"Payment Amount",type:"number",value:_r.amount,onChange:h=>co({..._r,amount:h.target.value}),small:!0}),c.jsx(Er,{label:"Date",type:"date",value:_r.date,onChange:h=>co({..._r,date:h.target.value}),small:!0})]}),c.jsx(q0,{label:"Payment Mode",value:_r.mode,onChange:h=>co({..._r,mode:h.target.value}),options:[{value:"Bank",label:"Bank Transfer"},{value:"UPI",label:"UPI"},{value:"Cheque",label:"Cheque"},{value:"Cash",label:"Cash"}],small:!0}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsx(Er,{label:"TDS Deducted",type:"number",value:_r.tds,onChange:h=>co({..._r,tds:h.target.value}),placeholder:"0",small:!0}),c.jsx(Er,{label:"Discount",type:"number",value:_r.discount,onChange:h=>co({..._r,discount:h.target.value}),placeholder:"0",small:!0})]}),c.jsx(Er,{label:"Narration",value:_r.narration,onChange:h=>co({..._r,narration:h.target.value}),placeholder:"Reference",small:!0}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[c.jsx(qe,{label:"Cancel",onClick:()=>Lr(!1)}),c.jsx(qe,{label:"Record Payment",variant:"success",icon:Nj,onClick:TF})]})]})}),c.jsxs(wn,{isOpen:Ti,onClose:()=>qt(!1),title:" Set Opening Balance",width:"450px",children:[c.jsx(q0,{label:"Select Party",value:bi.partyName,onChange:h=>mc({...bi,partyName:h.target.value}),options:[{value:"",label:"Choose a party..."},...vn.map(h=>({value:h,label:h}))],small:!0}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"12px"},children:[c.jsx(Er,{label:"Amount",type:"number",value:bi.amount,onChange:h=>mc({...bi,amount:h.target.value}),small:!0}),c.jsx(q0,{label:"Type",value:bi.type,onChange:h=>mc({...bi,type:h.target.value}),options:[{value:"Dr",label:"Debit"},{value:"Cr",label:"Credit"}],small:!0})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[c.jsx(qe,{label:"Cancel",onClick:()=>qt(!1)}),c.jsx(qe,{label:"Save",variant:"brand",onClick:()=>{bi.partyName&&bi.amount&&(gc(h=>({...h,[bi.partyName]:bi.type==="Dr"?parseFloat(bi.amount):-parseFloat(bi.amount)})),qt(!1),mc({partyName:"",amount:"",type:"Dr"}))}})]})]}),c.jsxs(wn,{isOpen:Jf,onClose:()=>Ps(!1),title:" Import Historical Ledger",width:"600px",children:[c.jsx("input",{type:"file",ref:t0,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:sF}),c.jsxs("div",{style:{padding:"16px",backgroundColor:"#EFF6FF",borderRadius:"10px",marginBottom:"16px",border:"1px solid #BFDBFE"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#1E40AF",marginBottom:"8px",fontSize:"14px"},children:" How to Import Historical Ledger"}),c.jsxs("div",{style:{fontSize:"12px",color:"#1E3A8A",lineHeight:"1.6"},children:[c.jsx("p",{style:{margin:"0 0 8px 0"},children:"Upload your existing ledger data in the format shown in the template. This will import all historical transactions."}),c.jsxs("p",{style:{margin:0},children:[c.jsx("strong",{children:"Supported columns:"})," Date, Particular, Vch Type, Vch No., Debit, Credit, Date of Receipt, Amount Received, TDS Received, Balance, Payment Status"]})]})]}),Y&&c.jsxs("div",{style:{padding:"12px",backgroundColor:"#DCFCE7",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[c.jsxs("div",{style:{fontSize:"13px",color:"#166534"},children:[c.jsx("strong",{children:" Selected Party:"})," ",Y]}),c.jsx("div",{style:{fontSize:"11px",color:"#15803D",marginTop:"4px"},children:"All entries from the uploaded file will be imported for this party"})]}),!Y&&c.jsxs("div",{style:{padding:"12px",backgroundColor:"#FEE2E2",borderRadius:"8px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[c.jsx("div",{style:{fontSize:"13px",color:"#991B1B"},children:c.jsx("strong",{children:" No Party Selected"})}),c.jsx("div",{style:{fontSize:"12px",color:"#B91C1C",marginTop:"4px"},children:'Please close this modal and select a party from the Parties list on the left, then click "Import Historical" again.'})]}),c.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginBottom:"16px"},children:[c.jsx(qe,{icon:Eo,label:"Download Template",variant:"brand",onClick:aF}),Y?c.jsx(qe,{icon:js,label:"Upload Ledger",variant:"success",onClick:()=>{var h;return(h=t0.current)==null?void 0:h.click()}}):c.jsxs("button",{disabled:!0,style:{padding:"8px 16px",fontSize:"13px",fontWeight:"600",border:"none",borderRadius:"8px",backgroundColor:"#E2E8F0",color:"#94A3B8",cursor:"not-allowed",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(js,{size:16})," Upload Ledger"]})]}),c.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",border:"1px solid #E2E8F0"},children:[c.jsx("div",{style:{fontWeight:"600",color:"#475569",marginBottom:"8px",fontSize:"13px"},children:" Expected Format (matches your ledger export):"}),c.jsx("div",{style:{overflowX:"auto"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#E2E8F0"},children:[c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Date"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Particular"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Vch Type"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Vch No."}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Debit"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Credit"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Amt Recd"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Status"})]})}),c.jsx("tbody",{children:c.jsxs("tr",{children:[c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"02-Jun-21"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"DB Corp Ltd"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"Sales"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"MB/2020-21/0411"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0",textAlign:"right"},children:"6,000"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0",textAlign:"right"},children:"44,371"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"Received"})]})})]})})]}),c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:c.jsx(qe,{label:"Close",onClick:()=>Ps(!1)})})]}),c.jsx(wn,{isOpen:ao,onClose:()=>{oo(!1),Fi({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"})},title:" Create Receipt",width:"550px",children:ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",ce.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",ce.partyName]}),c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Invoice Amount:"})," ",tt(ce.invoiceTotalAmount)]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[c.jsx(Er,{label:"Receipt Date",type:"date",value:Bt.date,onChange:h=>Fi({...Bt,date:h.target.value}),small:!0}),c.jsx(q0,{label:"Payment Mode",value:Bt.mode,onChange:h=>Fi({...Bt,mode:h.target.value}),options:[{value:"Bank",label:"Bank Transfer"},{value:"Cash",label:"Cash"},{value:"Cheque",label:"Cheque"},{value:"UPI",label:"UPI"}],small:!0})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"12px",marginBottom:"12px"},children:[c.jsx(Er,{label:"Amount Received",type:"number",value:Bt.amount,onChange:h=>Fi({...Bt,amount:h.target.value}),placeholder:"0.00",small:!0}),c.jsx(Er,{label:"TDS Deducted",type:"number",value:Bt.tds,onChange:h=>Fi({...Bt,tds:h.target.value}),placeholder:"0.00",small:!0}),c.jsx(Er,{label:"Discount",type:"number",value:Bt.discount,onChange:h=>Fi({...Bt,discount:h.target.value}),placeholder:"0.00",small:!0})]}),c.jsx("div",{style:{backgroundColor:"#F0FDF4",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:c.jsxs("div",{style:{fontSize:"14px",fontWeight:"700",color:"#166534"},children:["Total Credit: ",tt((parseFloat(Bt.amount)||0)+(parseFloat(Bt.tds)||0)+(parseFloat(Bt.discount)||0))]})}),c.jsx(Er,{label:"Narration",value:Bt.narration,onChange:h=>Fi({...Bt,narration:h.target.value}),placeholder:"Payment reference, remarks...",small:!0}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Payment Advisory (Optional)"}),c.jsx("input",{type:"file",ref:xc,accept:"image/*,.pdf",onChange:wc,style:{display:"none"}}),Bt.paymentAdvisory?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[c.jsx("div",{style:{flex:1,padding:"10px",backgroundColor:"#F0FDF4",borderRadius:"8px",fontSize:"13px",color:"#166534"},children:" Payment advisory attached"}),c.jsx("button",{onClick:()=>Fi(h=>({...h,paymentAdvisory:null})),style:{padding:"8px",border:"none",backgroundColor:"#FEE2E2",borderRadius:"6px",cursor:"pointer",color:"#991B1B"},children:c.jsx(Na,{size:16})})]}):c.jsxs("button",{onClick:()=>{var h;return(h=xc.current)==null?void 0:h.click()},style:{padding:"10px 16px",border:"1.5px dashed #D1D5DB",borderRadius:"8px",backgroundColor:"#F9FAFB",cursor:"pointer",fontSize:"13px",color:"#6B7280",display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(js,{size:16})," Attach Payment Advisory"]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(qe,{label:"Cancel",onClick:()=>oo(!1)}),c.jsx(qe,{label:"Create Receipt",variant:"success",icon:wl,onClick:yn})]})]})}),c.jsx(wn,{isOpen:Vu,onClose:()=>{Fs(!1),wa({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]})},title:" Create Credit Note",width:"500px",children:ce&&(()=>{var P;const h=(P=ce.statePartyDetails)==null?void 0:P.toUpperCase().includes("MAHARASHTRA"),E=h?"CGST + SGST (9% + 9%)":"IGST (18%)",z=parseFloat(nn.amount)||0,Q=parseFloat(nn.gst)||0,j=z+Q;return c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",ce.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",ce.partyName]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice Amount:"})," ",tt(ce.invoiceTotalAmount)]}),c.jsxs("div",{style:{fontSize:"12px",color:"#2563EB"},children:[c.jsx("strong",{children:"GST Type:"})," ",h?"CGST + SGST (Intra-state)":"IGST (Inter-state)"]})]}),c.jsx("div",{style:{marginBottom:"12px"},children:c.jsx(Er,{label:"Credit Note Date",type:"date",value:nn.date,onChange:ne=>wa({...nn,date:ne.target.value}),small:!0})}),c.jsxs("div",{style:{backgroundColor:"#FEF2F2",padding:"14px",borderRadius:"10px",marginBottom:"12px",border:"1px solid #FECACA"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#991B1B",marginBottom:"10px",fontSize:"13px"},children:" Credit Note Breakdown"}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsx(Er,{label:"Base Amount",type:"number",value:nn.amount,onChange:ne=>wa({...nn,amount:ne.target.value}),placeholder:"0.00",small:!0}),c.jsx(Er,{label:E,type:"number",value:nn.gst,onChange:ne=>wa({...nn,gst:ne.target.value}),placeholder:"0.00",small:!0})]}),c.jsxs("div",{style:{marginTop:"10px",padding:"8px",backgroundColor:"#FEE2E2",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsx("span",{style:{fontSize:"13px",fontWeight:"600",color:"#991B1B"},children:"Total Credit:"}),c.jsx("span",{style:{fontSize:"15px",fontWeight:"700",color:"#991B1B"},children:tt(j)})]})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Reason for Credit Note *"}),c.jsx("textarea",{value:nn.reason,onChange:ne=>wa({...nn,reason:ne.target.value}),placeholder:"Enter reason for issuing credit note...",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(qe,{label:"Cancel",onClick:()=>Fs(!1)}),c.jsx(qe,{label:"Create Credit Note",variant:"danger",icon:nd,onClick:Wi})]})]})})()}),c.jsx(wn,{isOpen:cr,onClose:()=>{Ci(!1),is(null)},title:" Add Followup",width:"500px",children:sr&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",sr.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",sr.partyName]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Amount:"})," ",tt(sr.invoiceTotalAmount||sr.totalAmount)]}),c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Invoice Date:"})," ",Ft(sr.invoiceDate||sr.date)]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[c.jsx(Er,{label:"Followup Date",type:"date",value:Tr.date,onChange:h=>ss({...Tr,date:h.target.value}),small:!0}),c.jsx(Er,{label:"Next Followup Date",type:"date",value:Tr.nextFollowupDate,onChange:h=>ss({...Tr,nextFollowupDate:h.target.value}),small:!0})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Followup Notes *"}),c.jsx("textarea",{value:Tr.notes,onChange:h=>ss({...Tr,notes:h.target.value}),placeholder:"Enter followup notes (e.g., Spoke with accounts team, payment promised by next week)",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Status"}),c.jsxs("select",{value:Tr.status,onChange:h=>ss({...Tr,status:h.target.value}),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px"},children:[c.jsx("option",{value:"Pending",children:"Pending"}),c.jsx("option",{value:"Promised",children:"Promised - Payment Expected"}),c.jsx("option",{value:"Disputed",children:"Disputed"}),c.jsx("option",{value:"No Response",children:"No Response"})]})]}),c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#166534",marginBottom:"8px"},children:" Quick Actions"}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsx(qe,{icon:Kg,label:"Copy Email Template",small:!0,variant:"brand",onClick:()=>oy(sr)}),c.jsx(qe,{icon:Xg,label:"Search in Gmail",small:!0,variant:"success",onClick:()=>ly(sr)})]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(qe,{label:"Cancel",onClick:()=>Ci(!1)}),c.jsx(qe,{label:"Save Followup",variant:"primary",icon:sd,onClick:J4})]})]})}),c.jsx(wn,{isOpen:dl,onClose:()=>bs(!1),title:" Clear All Data",width:"500px",children:c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"20px",borderRadius:"12px",marginBottom:"20px",border:"2px solid #FCA5A5"},children:[c.jsxs("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"18px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx($2,{size:24})," Warning: This action cannot be undone!"]}),c.jsxs("div",{style:{fontSize:"14px",color:"#7F1D1D",lineHeight:"1.6"},children:["This will permanently delete:",c.jsxs("ul",{style:{margin:"12px 0 0 20px",padding:0},children:[c.jsxs("li",{children:[c.jsx("strong",{children:_e.length})," campaigns from Master Sheet"]}),c.jsxs("li",{children:[c.jsx("strong",{children:_e.filter(h=>h.invoiceGenerated).length})," generated invoices"]}),c.jsxs("li",{children:[c.jsx("strong",{children:je.length})," receipts"]}),c.jsxs("li",{children:[c.jsx("strong",{children:re.length})," credit notes"]}),c.jsxs("li",{children:[c.jsx("strong",{children:te.length})," ledger entries"]}),c.jsxs("li",{children:[c.jsx("strong",{children:Object.keys(In).length})," mailer images"]}),c.jsx("li",{children:"All opening balances"})]})]})]}),c.jsx("div",{style:{backgroundColor:"#FEF3C7",padding:"14px",borderRadius:"8px",marginBottom:"20px",border:"1px solid #FCD34D"},children:c.jsxs("div",{style:{fontSize:"13px",color:"#92400E"},children:[c.jsx("strong",{children:"Note:"})," Invoice series numbers will be reset to 1. Your company settings and mailer logo will be preserved."]})}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[c.jsx(qe,{label:"Cancel",onClick:()=>bs(!1)}),c.jsx(qe,{label:"Yes, Clear All Data",variant:"danger",icon:Ls,onClick:dF})]})]})}),c.jsx(wn,{isOpen:Xe,onClose:()=>dt(!1),title:" Notifications",width:"550px",children:c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B"},children:Nn>0?`${Nn} unread`:"No unread notifications"}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[Nn>0&&c.jsx("button",{onClick:yc,style:{padding:"6px 12px",fontSize:"12px",fontWeight:"600",border:"1px solid #E2E8F0",borderRadius:"6px",backgroundColor:"#F8FAFC",color:"#475569",cursor:"pointer"},children:"Mark all as read"}),Ye.length>0&&lr&&c.jsx("button",{onClick:i0,style:{padding:"6px 12px",fontSize:"12px",fontWeight:"600",border:"1px solid #FCA5A5",borderRadius:"6px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer"},children:"Clear all"})]})]}),c.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:vl.length===0?c.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:[c.jsx(K2,{size:40,style:{marginBottom:"12px",opacity:.5}}),c.jsx("div",{style:{fontSize:"16px",fontWeight:"600"},children:"No notifications"}),c.jsx("div",{style:{fontSize:"13px",marginTop:"4px"},children:"You're all caught up!"})]}):vl.map(h=>{const E=!(h.read&&h.read[r]),z=j=>{switch(j){case"upload":return"";case"invoice":return"";case"approval":return"";case"edit":return"";case"receipt":return"";default:return""}},Q=j=>{switch(j){case"upload":return"#EFF6FF";case"invoice":return"#FEF3C7";case"approval":return"#DCFCE7";case"edit":return"#FEE2E2";case"receipt":return"#F0FDF4";default:return"#F8FAFC"}};return c.jsx("div",{onClick:()=>n0(h.id),style:{padding:"14px",borderRadius:"10px",marginBottom:"8px",backgroundColor:E?Q(h.type):"#F8FAFC",border:E?"2px solid #2874A6":"1px solid #E2E8F0",cursor:"pointer",transition:"all 0.2s ease"},children:c.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[c.jsx("div",{style:{fontSize:"20px"},children:z(h.type)}),c.jsxs("div",{style:{flex:1},children:[c.jsx("div",{style:{fontSize:"14px",fontWeight:E?"600":"500",color:"#1E293B",lineHeight:"1.4"},children:h.message}),c.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"8px",fontSize:"11px",color:"#64748B"},children:[c.jsxs("span",{children:["By: ",h.createdBy==="finance"?"Finance Team":"Director"]}),c.jsx("span",{children:""}),c.jsx("span",{children:new Date(h.createdAt).toLocaleString()})]})]}),E&&c.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#DC2626",flexShrink:0}})]})},h.id)})})]})})]}),XF=()=>{switch(R){case"master":return xy();case"services":return RF();case"invoices":return LF();case"receipts":return WF();case"ledgers":return HF();case"followups":return GF();case"reports":return Ty();case"settings":return r==="finance"?KF():Ty();default:return xy()}},qF=()=>c.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 50%, #1E3A5F 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',padding:"20px"},children:c.jsxs("div",{style:{backgroundColor:"#FFFFFF",padding:"0",borderRadius:"24px",boxShadow:"0 25px 50px -12px rgba(0,0,0,0.25)",width:"420px",maxWidth:"95vw",overflow:"hidden"},children:[c.jsxs("div",{style:{background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 100%)",padding:"32px 40px",textAlign:"center"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:"8px"},children:[c.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"60px",height:"auto",borderRadius:"8px",backgroundColor:"white",padding:"4px"}}),c.jsx("span",{style:{fontSize:"36px",fontWeight:"800",color:"#FFFFFF",letterSpacing:"-1px"},children:"FinMate"})]}),c.jsx("p",{style:{margin:0,color:"rgba(255,255,255,0.8)",fontSize:"14px",fontWeight:"500"},children:"Finance Management System"})]}),c.jsxs("div",{style:{padding:"32px 40px"},children:[c.jsxs("div",{style:{marginBottom:"24px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#1E3A5F",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Username"}),c.jsxs("div",{style:{position:"relative"},children:[c.jsx(Z2,{size:18,style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",value:i.username,onChange:h=>s(E=>({...E,username:h.target.value})),placeholder:"Enter username",style:{width:"100%",padding:"14px 14px 14px 44px",borderRadius:"12px",border:"2px solid #E2E8F0",fontSize:"15px",boxSizing:"border-box",transition:"border-color 0.2s, box-shadow 0.2s",outline:"none"},onFocus:h=>{h.target.style.borderColor="#2874A6",h.target.style.boxShadow="0 0 0 3px rgba(40,116,166,0.1)"},onBlur:h=>{h.target.style.borderColor="#E2E8F0",h.target.style.boxShadow="none"}})]})]}),c.jsxs("div",{style:{marginBottom:"28px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#1E3A5F",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Password"}),c.jsxs("div",{style:{position:"relative"},children:[c.jsx(V0,{size:18,style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"password",value:i.password,onChange:h=>s(E=>({...E,password:h.target.value})),placeholder:"Enter password",onKeyPress:h=>h.key==="Enter"&&Gu(),style:{width:"100%",padding:"14px 14px 14px 44px",borderRadius:"12px",border:"2px solid #E2E8F0",fontSize:"15px",boxSizing:"border-box",transition:"border-color 0.2s, box-shadow 0.2s",outline:"none"},onFocus:h=>{h.target.style.borderColor="#2874A6",h.target.style.boxShadow="0 0 0 3px rgba(40,116,166,0.1)"},onBlur:h=>{h.target.style.borderColor="#E2E8F0",h.target.style.boxShadow="none"}})]})]}),a&&c.jsxs("div",{style:{marginBottom:"20px",padding:"14px",backgroundColor:"#FEF2F2",borderRadius:"12px",color:"#DC2626",fontSize:"14px",textAlign:"center",border:"1px solid #FECACA",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[c.jsx($2,{size:18}),a]}),c.jsx("button",{onClick:Gu,style:{width:"100%",padding:"16px",fontSize:"16px",fontWeight:"700",border:"none",borderRadius:"12px",cursor:w?"pointer":"wait",background:w?"linear-gradient(135deg, #1E3A5F 0%, #2874A6 100%)":"#94A3B8",color:"white",transition:"transform 0.2s, box-shadow 0.2s",boxShadow:w?"0 4px 14px rgba(40,116,166,0.4)":"none",opacity:w?1:.7},disabled:!w,onMouseOver:h=>{w&&(h.target.style.transform="translateY(-2px)",h.target.style.boxShadow="0 6px 20px rgba(40,116,166,0.5)")},onMouseOut:h=>{w&&(h.target.style.transform="translateY(0)",h.target.style.boxShadow="0 4px 14px rgba(40,116,166,0.4)")},children:w?"Sign In":"Loading..."}),c.jsxs("div",{style:{marginTop:"24px",textAlign:"center",color:"#94A3B8",fontSize:"12px"},children:[c.jsx("span",{children:"Powered by "}),c.jsx("span",{style:{fontWeight:"600",color:"#1E3A5F"},children:"JAC"}),c.jsx("span",{children:"  Strategy | Talent | Results"})]})]})]})});return t?l?c.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 50%, #1E3A5F 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[c.jsxs("div",{style:{textAlign:"center"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:"24px"},children:[c.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"50px",height:"auto",borderRadius:"8px",backgroundColor:"white",padding:"4px"}}),c.jsx("span",{style:{fontSize:"32px",fontWeight:"800",color:"#FFFFFF",letterSpacing:"-1px"},children:"FinMate"})]}),c.jsx(X2,{size:48,style:{animation:"spin 1s linear infinite",color:"#FFFFFF",marginBottom:"16px"}}),c.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:"#FFFFFF"},children:"Loading your data..."}),c.jsx("div",{style:{fontSize:"14px",color:"rgba(255,255,255,0.7)",marginTop:"8px"},children:"Please wait while we sync with the cloud"})]}),c.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]}):c.jsxs("div",{style:{display:"flex",height:"100vh",backgroundColor:"#F1F5F9",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[AF(),c.jsx("main",{style:{flex:1,overflow:"auto",padding:"20px"},children:XF()}),YF(),c.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]}):qF()}cm.createRoot(document.getElementById("root")).render(c.jsx(Z0.StrictMode,{children:c.jsx(kH,{})}));
