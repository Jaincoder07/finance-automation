(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function rb(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var xS={exports:{}},Ap={},vS={exports:{}},Bt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Of=Symbol.for("react.element"),nb=Symbol.for("react.portal"),ib=Symbol.for("react.fragment"),sb=Symbol.for("react.strict_mode"),ab=Symbol.for("react.profiler"),ob=Symbol.for("react.provider"),lb=Symbol.for("react.context"),cb=Symbol.for("react.forward_ref"),ub=Symbol.for("react.suspense"),db=Symbol.for("react.memo"),fb=Symbol.for("react.lazy"),Iy=Symbol.iterator;function hb(t){return t===null||typeof t!="object"?null:(t=Iy&&t[Iy]||t["@@iterator"],typeof t=="function"?t:null)}var yS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_S=Object.assign,ES={};function Iu(t,e,r){this.props=t,this.context=e,this.refs=ES,this.updater=r||yS}Iu.prototype.isReactComponent={};Iu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Iu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function SS(){}SS.prototype=Iu.prototype;function Wx(t,e,r){this.props=t,this.context=e,this.refs=ES,this.updater=r||yS}var Hx=Wx.prototype=new SS;Hx.constructor=Wx;_S(Hx,Iu.prototype);Hx.isPureReactComponent=!0;var Ny=Array.isArray,wS=Object.prototype.hasOwnProperty,$x={current:null},TS={key:!0,ref:!0,__self:!0,__source:!0};function AS(t,e,r){var n,i={},s=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)wS.call(e,n)&&!TS.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:Of,type:t,key:s,ref:a,props:i,_owner:$x.current}}function pb(t,e){return{$$typeof:Of,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Gx(t){return typeof t=="object"&&t!==null&&t.$$typeof===Of}function gb(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var Ry=/\/+/g;function pg(t,e){return typeof t=="object"&&t!==null&&t.key!=null?gb(""+t.key):e.toString(36)}function nh(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Of:case nb:a=!0}}if(a)return a=t,i=i(a),t=n===""?"."+pg(a,0):n,Ny(i)?(r="",t!=null&&(r=t.replace(Ry,"$&/")+"/"),nh(i,e,r,"",function(u){return u})):i!=null&&(Gx(i)&&(i=pb(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(Ry,"$&/")+"/")+t)),e.push(i)),1;if(a=0,n=n===""?".":n+":",Ny(t))for(var o=0;o<t.length;o++){s=t[o];var l=n+pg(s,o);a+=nh(s,e,r,l,i)}else if(l=hb(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=n+pg(s,o++),a+=nh(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function x0(t,e,r){if(t==null)return t;var n=[],i=0;return nh(t,n,"","",function(s){return e.call(r,s,i++)}),n}function mb(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Fi={current:null},ih={transition:null},xb={ReactCurrentDispatcher:Fi,ReactCurrentBatchConfig:ih,ReactCurrentOwner:$x};function CS(){throw Error("act(...) is not supported in production builds of React.")}Bt.Children={map:x0,forEach:function(t,e,r){x0(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return x0(t,function(){e++}),e},toArray:function(t){return x0(t,function(e){return e})||[]},only:function(t){if(!Gx(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Bt.Component=Iu;Bt.Fragment=ib;Bt.Profiler=ab;Bt.PureComponent=Wx;Bt.StrictMode=sb;Bt.Suspense=ub;Bt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xb;Bt.act=CS;Bt.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=_S({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=$x.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)wS.call(e,l)&&!TS.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:Of,type:t.type,key:i,ref:s,props:n,_owner:a}};Bt.createContext=function(t){return t={$$typeof:lb,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:ob,_context:t},t.Consumer=t};Bt.createElement=AS;Bt.createFactory=function(t){var e=AS.bind(null,t);return e.type=t,e};Bt.createRef=function(){return{current:null}};Bt.forwardRef=function(t){return{$$typeof:cb,render:t}};Bt.isValidElement=Gx;Bt.lazy=function(t){return{$$typeof:fb,_payload:{_status:-1,_result:t},_init:mb}};Bt.memo=function(t,e){return{$$typeof:db,type:t,compare:e===void 0?null:e}};Bt.startTransition=function(t){var e=ih.transition;ih.transition={};try{t()}finally{ih.transition=e}};Bt.unstable_act=CS;Bt.useCallback=function(t,e){return Fi.current.useCallback(t,e)};Bt.useContext=function(t){return Fi.current.useContext(t)};Bt.useDebugValue=function(){};Bt.useDeferredValue=function(t){return Fi.current.useDeferredValue(t)};Bt.useEffect=function(t,e){return Fi.current.useEffect(t,e)};Bt.useId=function(){return Fi.current.useId()};Bt.useImperativeHandle=function(t,e,r){return Fi.current.useImperativeHandle(t,e,r)};Bt.useInsertionEffect=function(t,e){return Fi.current.useInsertionEffect(t,e)};Bt.useLayoutEffect=function(t,e){return Fi.current.useLayoutEffect(t,e)};Bt.useMemo=function(t,e){return Fi.current.useMemo(t,e)};Bt.useReducer=function(t,e,r){return Fi.current.useReducer(t,e,r)};Bt.useRef=function(t){return Fi.current.useRef(t)};Bt.useState=function(t){return Fi.current.useState(t)};Bt.useSyncExternalStore=function(t,e,r){return Fi.current.useSyncExternalStore(t,e,r)};Bt.useTransition=function(){return Fi.current.useTransition()};Bt.version="18.3.1";vS.exports=Bt;var ye=vS.exports;const sh=rb(ye);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vb=ye,yb=Symbol.for("react.element"),_b=Symbol.for("react.fragment"),Eb=Object.prototype.hasOwnProperty,Sb=vb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,wb={key:!0,ref:!0,__self:!0,__source:!0};function kS(t,e,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)Eb.call(e,n)&&!wb.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:yb,type:t,key:s,ref:a,props:i,_owner:Sb.current}}Ap.Fragment=_b;Ap.jsx=kS;Ap.jsxs=kS;xS.exports=Ap;var c=xS.exports,mm={},FS={exports:{}},hs={},bS={exports:{}},IS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Ce,se){var be=Ce.length;Ce.push(se);e:for(;0<be;){var Be=be-1>>>1,G=Ce[Be];if(0<i(G,se))Ce[Be]=se,Ce[be]=G,be=Be;else break e}}function r(Ce){return Ce.length===0?null:Ce[0]}function n(Ce){if(Ce.length===0)return null;var se=Ce[0],be=Ce.pop();if(be!==se){Ce[0]=be;e:for(var Be=0,G=Ce.length,ne=G>>>1;Be<ne;){var ie=2*(Be+1)-1,X=Ce[ie],ve=ie+1,Se=Ce[ve];if(0>i(X,be))ve<G&&0>i(Se,X)?(Ce[Be]=Se,Ce[ve]=be,Be=ve):(Ce[Be]=X,Ce[ie]=be,Be=ie);else if(ve<G&&0>i(Se,be))Ce[Be]=Se,Ce[ve]=be,Be=ve;else break e}}return se}function i(Ce,se){var be=Ce.sortIndex-se.sortIndex;return be!==0?be:Ce.id-se.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],u=[],f=1,p=null,g=3,m=!1,y=!1,x=!1,S=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(Ce){for(var se=r(u);se!==null;){if(se.callback===null)n(u);else if(se.startTime<=Ce)n(u),se.sortIndex=se.expirationTime,e(l,se);else break;se=r(u)}}function P(Ce){if(x=!1,E(Ce),!y)if(r(l)!==null)y=!0,Pe(Y);else{var se=r(u);se!==null&&Ie(P,se.startTime-Ce)}}function Y(Ce,se){y=!1,x&&(x=!1,A(F),F=-1),m=!0;var be=g;try{for(E(se),p=r(l);p!==null&&(!(p.expirationTime>se)||Ce&&!R());){var Be=p.callback;if(typeof Be=="function"){p.callback=null,g=p.priorityLevel;var G=Be(p.expirationTime<=se);se=t.unstable_now(),typeof G=="function"?p.callback=G:p===r(l)&&n(l),E(se)}else n(l);p=r(l)}if(p!==null)var ne=!0;else{var ie=r(u);ie!==null&&Ie(P,ie.startTime-se),ne=!1}return ne}finally{p=null,g=be,m=!1}}var W=!1,T=null,F=-1,w=5,I=-1;function R(){return!(t.unstable_now()-I<w)}function D(){if(T!==null){var Ce=t.unstable_now();I=Ce;var se=!0;try{se=T(!0,Ce)}finally{se?N():(W=!1,T=null)}}else W=!1}var N;if(typeof k=="function")N=function(){k(D)};else if(typeof MessageChannel<"u"){var Ge=new MessageChannel,Ee=Ge.port2;Ge.port1.onmessage=D,N=function(){Ee.postMessage(null)}}else N=function(){S(D,0)};function Pe(Ce){T=Ce,W||(W=!0,N())}function Ie(Ce,se){F=S(function(){Ce(t.unstable_now())},se)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Ce){Ce.callback=null},t.unstable_continueExecution=function(){y||m||(y=!0,Pe(Y))},t.unstable_forceFrameRate=function(Ce){0>Ce||125<Ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):w=0<Ce?Math.floor(1e3/Ce):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(Ce){switch(g){case 1:case 2:case 3:var se=3;break;default:se=g}var be=g;g=se;try{return Ce()}finally{g=be}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Ce,se){switch(Ce){case 1:case 2:case 3:case 4:case 5:break;default:Ce=3}var be=g;g=Ce;try{return se()}finally{g=be}},t.unstable_scheduleCallback=function(Ce,se,be){var Be=t.unstable_now();switch(typeof be=="object"&&be!==null?(be=be.delay,be=typeof be=="number"&&0<be?Be+be:Be):be=Be,Ce){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=be+G,Ce={id:f++,callback:se,priorityLevel:Ce,startTime:be,expirationTime:G,sortIndex:-1},be>Be?(Ce.sortIndex=be,e(u,Ce),r(l)===null&&Ce===r(u)&&(x?(A(F),F=-1):x=!0,Ie(P,be-Be))):(Ce.sortIndex=G,e(l,Ce),y||m||(y=!0,Pe(Y))),Ce},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(Ce){var se=g;return function(){var be=g;g=se;try{return Ce.apply(this,arguments)}finally{g=be}}}})(IS);bS.exports=IS;var Tb=bS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ab=ye,ds=Tb;function je(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var NS=new Set,Kd={};function oc(t,e){du(t,e),du(t+"Capture",e)}function du(t,e){for(Kd[t]=e,t=0;t<e.length;t++)NS.add(e[t])}var ro=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xm=Object.prototype.hasOwnProperty,Cb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Dy={},Py={};function kb(t){return xm.call(Py,t)?!0:xm.call(Dy,t)?!1:Cb.test(t)?Py[t]=!0:(Dy[t]=!0,!1)}function Fb(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function bb(t,e,r,n){if(e===null||typeof e>"u"||Fb(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function bi(t,e,r,n,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var ri={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ri[t]=new bi(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ri[e]=new bi(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ri[t]=new bi(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ri[t]=new bi(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ri[t]=new bi(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ri[t]=new bi(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ri[t]=new bi(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ri[t]=new bi(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ri[t]=new bi(t,5,!1,t.toLowerCase(),null,!1,!1)});var Kx=/[\-:]([a-z])/g;function Yx(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Kx,Yx);ri[e]=new bi(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Kx,Yx);ri[e]=new bi(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Kx,Yx);ri[e]=new bi(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ri[t]=new bi(t,1,!1,t.toLowerCase(),null,!1,!1)});ri.xlinkHref=new bi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ri[t]=new bi(t,1,!1,t.toLowerCase(),null,!0,!0)});function Xx(t,e,r,n){var i=ri.hasOwnProperty(e)?ri[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(bb(e,r,i,n)&&(r=null),n||i===null?kb(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var ho=Ab.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,v0=Symbol.for("react.element"),Bc=Symbol.for("react.portal"),jc=Symbol.for("react.fragment"),qx=Symbol.for("react.strict_mode"),vm=Symbol.for("react.profiler"),RS=Symbol.for("react.provider"),DS=Symbol.for("react.context"),Qx=Symbol.for("react.forward_ref"),ym=Symbol.for("react.suspense"),_m=Symbol.for("react.suspense_list"),Jx=Symbol.for("react.memo"),Ro=Symbol.for("react.lazy"),PS=Symbol.for("react.offscreen"),Oy=Symbol.iterator;function ed(t){return t===null||typeof t!="object"?null:(t=Oy&&t[Oy]||t["@@iterator"],typeof t=="function"?t:null)}var $r=Object.assign,gg;function pd(t){if(gg===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);gg=e&&e[1]||""}return`
`+gg+t}var mg=!1;function xg(t,e){if(!t||mg)return"";mg=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{mg=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?pd(t):""}function Ib(t){switch(t.tag){case 5:return pd(t.type);case 16:return pd("Lazy");case 13:return pd("Suspense");case 19:return pd("SuspenseList");case 0:case 2:case 15:return t=xg(t.type,!1),t;case 11:return t=xg(t.type.render,!1),t;case 1:return t=xg(t.type,!0),t;default:return""}}function Em(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case jc:return"Fragment";case Bc:return"Portal";case vm:return"Profiler";case qx:return"StrictMode";case ym:return"Suspense";case _m:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case DS:return(t.displayName||"Context")+".Consumer";case RS:return(t._context.displayName||"Context")+".Provider";case Qx:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Jx:return e=t.displayName||null,e!==null?e:Em(t.type)||"Memo";case Ro:e=t._payload,t=t._init;try{return Em(t(e))}catch{}}return null}function Nb(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Em(e);case 8:return e===qx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function sl(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function OS(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Rb(t){var e=OS(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function y0(t){t._valueTracker||(t._valueTracker=Rb(t))}function MS(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=OS(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Ah(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Sm(t,e){var r=e.checked;return $r({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function My(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=sl(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function BS(t,e){e=e.checked,e!=null&&Xx(t,"checked",e,!1)}function wm(t,e){BS(t,e);var r=sl(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Tm(t,e.type,r):e.hasOwnProperty("defaultValue")&&Tm(t,e.type,sl(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function By(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Tm(t,e,r){(e!=="number"||Ah(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var gd=Array.isArray;function Qc(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+sl(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Am(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(je(91));return $r({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function jy(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(je(92));if(gd(r)){if(1<r.length)throw Error(je(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:sl(r)}}function jS(t,e){var r=sl(e.value),n=sl(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function Ly(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function LS(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Cm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?LS(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var _0,US=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(_0=_0||document.createElement("div"),_0.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=_0.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Yd(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Ad={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Db=["Webkit","ms","Moz","O"];Object.keys(Ad).forEach(function(t){Db.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ad[e]=Ad[t]})});function VS(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Ad.hasOwnProperty(t)&&Ad[t]?(""+e).trim():e+"px"}function zS(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=VS(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var Pb=$r({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function km(t,e){if(e){if(Pb[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(je(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(je(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(je(61))}if(e.style!=null&&typeof e.style!="object")throw Error(je(62))}}function Fm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bm=null;function Zx(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Im=null,Jc=null,Zc=null;function Uy(t){if(t=jf(t)){if(typeof Im!="function")throw Error(je(280));var e=t.stateNode;e&&(e=Ip(e),Im(t.stateNode,t.type,e))}}function WS(t){Jc?Zc?Zc.push(t):Zc=[t]:Jc=t}function HS(){if(Jc){var t=Jc,e=Zc;if(Zc=Jc=null,Uy(t),e)for(t=0;t<e.length;t++)Uy(e[t])}}function $S(t,e){return t(e)}function GS(){}var vg=!1;function KS(t,e,r){if(vg)return t(e,r);vg=!0;try{return $S(t,e,r)}finally{vg=!1,(Jc!==null||Zc!==null)&&(GS(),HS())}}function Xd(t,e){var r=t.stateNode;if(r===null)return null;var n=Ip(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(je(231,e,typeof r));return r}var Nm=!1;if(ro)try{var td={};Object.defineProperty(td,"passive",{get:function(){Nm=!0}}),window.addEventListener("test",td,td),window.removeEventListener("test",td,td)}catch{Nm=!1}function Ob(t,e,r,n,i,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(f){this.onError(f)}}var Cd=!1,Ch=null,kh=!1,Rm=null,Mb={onError:function(t){Cd=!0,Ch=t}};function Bb(t,e,r,n,i,s,a,o,l){Cd=!1,Ch=null,Ob.apply(Mb,arguments)}function jb(t,e,r,n,i,s,a,o,l){if(Bb.apply(this,arguments),Cd){if(Cd){var u=Ch;Cd=!1,Ch=null}else throw Error(je(198));kh||(kh=!0,Rm=u)}}function lc(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function YS(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Vy(t){if(lc(t)!==t)throw Error(je(188))}function Lb(t){var e=t.alternate;if(!e){if(e=lc(t),e===null)throw Error(je(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Vy(i),t;if(s===n)return Vy(i),e;s=s.sibling}throw Error(je(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(je(189))}}if(r.alternate!==n)throw Error(je(190))}if(r.tag!==3)throw Error(je(188));return r.stateNode.current===r?t:e}function XS(t){return t=Lb(t),t!==null?qS(t):null}function qS(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=qS(t);if(e!==null)return e;t=t.sibling}return null}var QS=ds.unstable_scheduleCallback,zy=ds.unstable_cancelCallback,Ub=ds.unstable_shouldYield,Vb=ds.unstable_requestPaint,on=ds.unstable_now,zb=ds.unstable_getCurrentPriorityLevel,e1=ds.unstable_ImmediatePriority,JS=ds.unstable_UserBlockingPriority,Fh=ds.unstable_NormalPriority,Wb=ds.unstable_LowPriority,ZS=ds.unstable_IdlePriority,Cp=null,Ta=null;function Hb(t){if(Ta&&typeof Ta.onCommitFiberRoot=="function")try{Ta.onCommitFiberRoot(Cp,t,void 0,(t.current.flags&128)===128)}catch{}}var ia=Math.clz32?Math.clz32:Kb,$b=Math.log,Gb=Math.LN2;function Kb(t){return t>>>=0,t===0?32:31-($b(t)/Gb|0)|0}var E0=64,S0=4194304;function md(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function bh(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=md(o):(s&=a,s!==0&&(n=md(s)))}else a=r&~i,a!==0?n=md(a):s!==0&&(n=md(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-ia(e),i=1<<r,n|=t[r],e&=~i;return n}function Yb(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Xb(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-ia(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=Yb(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function Dm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function ew(){var t=E0;return E0<<=1,!(E0&4194240)&&(E0=64),t}function yg(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Mf(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ia(e),t[e]=r}function qb(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-ia(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function t1(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-ia(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var ur=0;function tw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var rw,r1,nw,iw,sw,Pm=!1,w0=[],Go=null,Ko=null,Yo=null,qd=new Map,Qd=new Map,Po=[],Qb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Wy(t,e){switch(t){case"focusin":case"focusout":Go=null;break;case"dragenter":case"dragleave":Ko=null;break;case"mouseover":case"mouseout":Yo=null;break;case"pointerover":case"pointerout":qd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qd.delete(e.pointerId)}}function rd(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=jf(e),e!==null&&r1(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function Jb(t,e,r,n,i){switch(e){case"focusin":return Go=rd(Go,t,e,r,n,i),!0;case"dragenter":return Ko=rd(Ko,t,e,r,n,i),!0;case"mouseover":return Yo=rd(Yo,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return qd.set(s,rd(qd.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Qd.set(s,rd(Qd.get(s)||null,t,e,r,n,i)),!0}return!1}function aw(t){var e=Rl(t.target);if(e!==null){var r=lc(e);if(r!==null){if(e=r.tag,e===13){if(e=YS(r),e!==null){t.blockedOn=e,sw(t.priority,function(){nw(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ah(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=Om(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);bm=n,r.target.dispatchEvent(n),bm=null}else return e=jf(r),e!==null&&r1(e),t.blockedOn=r,!1;e.shift()}return!0}function Hy(t,e,r){ah(t)&&r.delete(e)}function Zb(){Pm=!1,Go!==null&&ah(Go)&&(Go=null),Ko!==null&&ah(Ko)&&(Ko=null),Yo!==null&&ah(Yo)&&(Yo=null),qd.forEach(Hy),Qd.forEach(Hy)}function nd(t,e){t.blockedOn===e&&(t.blockedOn=null,Pm||(Pm=!0,ds.unstable_scheduleCallback(ds.unstable_NormalPriority,Zb)))}function Jd(t){function e(i){return nd(i,t)}if(0<w0.length){nd(w0[0],t);for(var r=1;r<w0.length;r++){var n=w0[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Go!==null&&nd(Go,t),Ko!==null&&nd(Ko,t),Yo!==null&&nd(Yo,t),qd.forEach(e),Qd.forEach(e),r=0;r<Po.length;r++)n=Po[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Po.length&&(r=Po[0],r.blockedOn===null);)aw(r),r.blockedOn===null&&Po.shift()}var eu=ho.ReactCurrentBatchConfig,Ih=!0;function eI(t,e,r,n){var i=ur,s=eu.transition;eu.transition=null;try{ur=1,n1(t,e,r,n)}finally{ur=i,eu.transition=s}}function tI(t,e,r,n){var i=ur,s=eu.transition;eu.transition=null;try{ur=4,n1(t,e,r,n)}finally{ur=i,eu.transition=s}}function n1(t,e,r,n){if(Ih){var i=Om(t,e,r,n);if(i===null)bg(t,e,n,Nh,r),Wy(t,n);else if(Jb(i,t,e,r,n))n.stopPropagation();else if(Wy(t,n),e&4&&-1<Qb.indexOf(t)){for(;i!==null;){var s=jf(i);if(s!==null&&rw(s),s=Om(t,e,r,n),s===null&&bg(t,e,n,Nh,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else bg(t,e,n,null,r)}}var Nh=null;function Om(t,e,r,n){if(Nh=null,t=Zx(n),t=Rl(t),t!==null)if(e=lc(t),e===null)t=null;else if(r=e.tag,r===13){if(t=YS(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Nh=t,null}function ow(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zb()){case e1:return 1;case JS:return 4;case Fh:case Wb:return 16;case ZS:return 536870912;default:return 16}default:return 16}}var Uo=null,i1=null,oh=null;function lw(){if(oh)return oh;var t,e=i1,r=e.length,n,i="value"in Uo?Uo.value:Uo.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===i[s-n];n++);return oh=i.slice(t,1<n?1-n:void 0)}function lh(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function T0(){return!0}function $y(){return!1}function ps(t){function e(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?T0:$y,this.isPropagationStopped=$y,this}return $r(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=T0)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=T0)},persist:function(){},isPersistent:T0}),e}var Nu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},s1=ps(Nu),Bf=$r({},Nu,{view:0,detail:0}),rI=ps(Bf),_g,Eg,id,kp=$r({},Bf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:a1,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==id&&(id&&t.type==="mousemove"?(_g=t.screenX-id.screenX,Eg=t.screenY-id.screenY):Eg=_g=0,id=t),_g)},movementY:function(t){return"movementY"in t?t.movementY:Eg}}),Gy=ps(kp),nI=$r({},kp,{dataTransfer:0}),iI=ps(nI),sI=$r({},Bf,{relatedTarget:0}),Sg=ps(sI),aI=$r({},Nu,{animationName:0,elapsedTime:0,pseudoElement:0}),oI=ps(aI),lI=$r({},Nu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),cI=ps(lI),uI=$r({},Nu,{data:0}),Ky=ps(uI),dI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pI(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=hI[t])?!!e[t]:!1}function a1(){return pI}var gI=$r({},Bf,{key:function(t){if(t.key){var e=dI[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=lh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?fI[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:a1,charCode:function(t){return t.type==="keypress"?lh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?lh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),mI=ps(gI),xI=$r({},kp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Yy=ps(xI),vI=$r({},Bf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:a1}),yI=ps(vI),_I=$r({},Nu,{propertyName:0,elapsedTime:0,pseudoElement:0}),EI=ps(_I),SI=$r({},kp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),wI=ps(SI),TI=[9,13,27,32],o1=ro&&"CompositionEvent"in window,kd=null;ro&&"documentMode"in document&&(kd=document.documentMode);var AI=ro&&"TextEvent"in window&&!kd,cw=ro&&(!o1||kd&&8<kd&&11>=kd),Xy=" ",qy=!1;function uw(t,e){switch(t){case"keyup":return TI.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function dw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Lc=!1;function CI(t,e){switch(t){case"compositionend":return dw(e);case"keypress":return e.which!==32?null:(qy=!0,Xy);case"textInput":return t=e.data,t===Xy&&qy?null:t;default:return null}}function kI(t,e){if(Lc)return t==="compositionend"||!o1&&uw(t,e)?(t=lw(),oh=i1=Uo=null,Lc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return cw&&e.locale!=="ko"?null:e.data;default:return null}}var FI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Qy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!FI[t.type]:e==="textarea"}function fw(t,e,r,n){WS(n),e=Rh(e,"onChange"),0<e.length&&(r=new s1("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Fd=null,Zd=null;function bI(t){ww(t,0)}function Fp(t){var e=zc(t);if(MS(e))return t}function II(t,e){if(t==="change")return e}var hw=!1;if(ro){var wg;if(ro){var Tg="oninput"in document;if(!Tg){var Jy=document.createElement("div");Jy.setAttribute("oninput","return;"),Tg=typeof Jy.oninput=="function"}wg=Tg}else wg=!1;hw=wg&&(!document.documentMode||9<document.documentMode)}function Zy(){Fd&&(Fd.detachEvent("onpropertychange",pw),Zd=Fd=null)}function pw(t){if(t.propertyName==="value"&&Fp(Zd)){var e=[];fw(e,Zd,t,Zx(t)),KS(bI,e)}}function NI(t,e,r){t==="focusin"?(Zy(),Fd=e,Zd=r,Fd.attachEvent("onpropertychange",pw)):t==="focusout"&&Zy()}function RI(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Fp(Zd)}function DI(t,e){if(t==="click")return Fp(e)}function PI(t,e){if(t==="input"||t==="change")return Fp(e)}function OI(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var la=typeof Object.is=="function"?Object.is:OI;function ef(t,e){if(la(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!xm.call(e,i)||!la(t[i],e[i]))return!1}return!0}function e2(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function t2(t,e){var r=e2(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=e2(r)}}function gw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?gw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function mw(){for(var t=window,e=Ah();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Ah(t.document)}return e}function l1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function MI(t){var e=mw(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&gw(r.ownerDocument.documentElement,r)){if(n!==null&&l1(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=t2(r,s);var a=t2(r,n);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var BI=ro&&"documentMode"in document&&11>=document.documentMode,Uc=null,Mm=null,bd=null,Bm=!1;function r2(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Bm||Uc==null||Uc!==Ah(n)||(n=Uc,"selectionStart"in n&&l1(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),bd&&ef(bd,n)||(bd=n,n=Rh(Mm,"onSelect"),0<n.length&&(e=new s1("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Uc)))}function A0(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Vc={animationend:A0("Animation","AnimationEnd"),animationiteration:A0("Animation","AnimationIteration"),animationstart:A0("Animation","AnimationStart"),transitionend:A0("Transition","TransitionEnd")},Ag={},xw={};ro&&(xw=document.createElement("div").style,"AnimationEvent"in window||(delete Vc.animationend.animation,delete Vc.animationiteration.animation,delete Vc.animationstart.animation),"TransitionEvent"in window||delete Vc.transitionend.transition);function bp(t){if(Ag[t])return Ag[t];if(!Vc[t])return t;var e=Vc[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in xw)return Ag[t]=e[r];return t}var vw=bp("animationend"),yw=bp("animationiteration"),_w=bp("animationstart"),Ew=bp("transitionend"),Sw=new Map,n2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function pl(t,e){Sw.set(t,e),oc(e,[t])}for(var Cg=0;Cg<n2.length;Cg++){var kg=n2[Cg],jI=kg.toLowerCase(),LI=kg[0].toUpperCase()+kg.slice(1);pl(jI,"on"+LI)}pl(vw,"onAnimationEnd");pl(yw,"onAnimationIteration");pl(_w,"onAnimationStart");pl("dblclick","onDoubleClick");pl("focusin","onFocus");pl("focusout","onBlur");pl(Ew,"onTransitionEnd");du("onMouseEnter",["mouseout","mouseover"]);du("onMouseLeave",["mouseout","mouseover"]);du("onPointerEnter",["pointerout","pointerover"]);du("onPointerLeave",["pointerout","pointerover"]);oc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));oc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));oc("onBeforeInput",["compositionend","keypress","textInput","paste"]);oc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));oc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));oc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),UI=new Set("cancel close invalid load scroll toggle".split(" ").concat(xd));function i2(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,jb(n,e,void 0,t),t.currentTarget=null}function ww(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;i2(i,o,u),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;i2(i,o,u),s=l}}}if(kh)throw t=Rm,kh=!1,Rm=null,t}function Fr(t,e){var r=e[zm];r===void 0&&(r=e[zm]=new Set);var n=t+"__bubble";r.has(n)||(Tw(e,t,2,!1),r.add(n))}function Fg(t,e,r){var n=0;e&&(n|=4),Tw(r,t,n,e)}var C0="_reactListening"+Math.random().toString(36).slice(2);function tf(t){if(!t[C0]){t[C0]=!0,NS.forEach(function(r){r!=="selectionchange"&&(UI.has(r)||Fg(r,!1,t),Fg(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[C0]||(e[C0]=!0,Fg("selectionchange",!1,e))}}function Tw(t,e,r,n){switch(ow(e)){case 1:var i=eI;break;case 4:i=tI;break;default:i=n1}r=i.bind(null,e,r,t),i=void 0,!Nm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function bg(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=Rl(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}KS(function(){var u=s,f=Zx(r),p=[];e:{var g=Sw.get(t);if(g!==void 0){var m=s1,y=t;switch(t){case"keypress":if(lh(r)===0)break e;case"keydown":case"keyup":m=mI;break;case"focusin":y="focus",m=Sg;break;case"focusout":y="blur",m=Sg;break;case"beforeblur":case"afterblur":m=Sg;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Gy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=iI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=yI;break;case vw:case yw:case _w:m=oI;break;case Ew:m=EI;break;case"scroll":m=rI;break;case"wheel":m=wI;break;case"copy":case"cut":case"paste":m=cI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Yy}var x=(e&4)!==0,S=!x&&t==="scroll",A=x?g!==null?g+"Capture":null:g;x=[];for(var k=u,E;k!==null;){E=k;var P=E.stateNode;if(E.tag===5&&P!==null&&(E=P,A!==null&&(P=Xd(k,A),P!=null&&x.push(rf(k,P,E)))),S)break;k=k.return}0<x.length&&(g=new m(g,y,null,r,f),p.push({event:g,listeners:x}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",g&&r!==bm&&(y=r.relatedTarget||r.fromElement)&&(Rl(y)||y[no]))break e;if((m||g)&&(g=f.window===f?f:(g=f.ownerDocument)?g.defaultView||g.parentWindow:window,m?(y=r.relatedTarget||r.toElement,m=u,y=y?Rl(y):null,y!==null&&(S=lc(y),y!==S||y.tag!==5&&y.tag!==6)&&(y=null)):(m=null,y=u),m!==y)){if(x=Gy,P="onMouseLeave",A="onMouseEnter",k="mouse",(t==="pointerout"||t==="pointerover")&&(x=Yy,P="onPointerLeave",A="onPointerEnter",k="pointer"),S=m==null?g:zc(m),E=y==null?g:zc(y),g=new x(P,k+"leave",m,r,f),g.target=S,g.relatedTarget=E,P=null,Rl(f)===u&&(x=new x(A,k+"enter",y,r,f),x.target=E,x.relatedTarget=S,P=x),S=P,m&&y)t:{for(x=m,A=y,k=0,E=x;E;E=kc(E))k++;for(E=0,P=A;P;P=kc(P))E++;for(;0<k-E;)x=kc(x),k--;for(;0<E-k;)A=kc(A),E--;for(;k--;){if(x===A||A!==null&&x===A.alternate)break t;x=kc(x),A=kc(A)}x=null}else x=null;m!==null&&s2(p,g,m,x,!1),y!==null&&S!==null&&s2(p,S,y,x,!0)}}e:{if(g=u?zc(u):window,m=g.nodeName&&g.nodeName.toLowerCase(),m==="select"||m==="input"&&g.type==="file")var Y=II;else if(Qy(g))if(hw)Y=PI;else{Y=RI;var W=NI}else(m=g.nodeName)&&m.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(Y=DI);if(Y&&(Y=Y(t,u))){fw(p,Y,r,f);break e}W&&W(t,g,u),t==="focusout"&&(W=g._wrapperState)&&W.controlled&&g.type==="number"&&Tm(g,"number",g.value)}switch(W=u?zc(u):window,t){case"focusin":(Qy(W)||W.contentEditable==="true")&&(Uc=W,Mm=u,bd=null);break;case"focusout":bd=Mm=Uc=null;break;case"mousedown":Bm=!0;break;case"contextmenu":case"mouseup":case"dragend":Bm=!1,r2(p,r,f);break;case"selectionchange":if(BI)break;case"keydown":case"keyup":r2(p,r,f)}var T;if(o1)e:{switch(t){case"compositionstart":var F="onCompositionStart";break e;case"compositionend":F="onCompositionEnd";break e;case"compositionupdate":F="onCompositionUpdate";break e}F=void 0}else Lc?uw(t,r)&&(F="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(F="onCompositionStart");F&&(cw&&r.locale!=="ko"&&(Lc||F!=="onCompositionStart"?F==="onCompositionEnd"&&Lc&&(T=lw()):(Uo=f,i1="value"in Uo?Uo.value:Uo.textContent,Lc=!0)),W=Rh(u,F),0<W.length&&(F=new Ky(F,t,null,r,f),p.push({event:F,listeners:W}),T?F.data=T:(T=dw(r),T!==null&&(F.data=T)))),(T=AI?CI(t,r):kI(t,r))&&(u=Rh(u,"onBeforeInput"),0<u.length&&(f=new Ky("onBeforeInput","beforeinput",null,r,f),p.push({event:f,listeners:u}),f.data=T))}ww(p,e)})}function rf(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Rh(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Xd(t,r),s!=null&&n.unshift(rf(t,s,i)),s=Xd(t,e),s!=null&&n.push(rf(t,s,i))),t=t.return}return n}function kc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function s2(t,e,r,n,i){for(var s=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,i?(l=Xd(r,s),l!=null&&a.unshift(rf(r,l,o))):i||(l=Xd(r,s),l!=null&&a.push(rf(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var VI=/\r\n?/g,zI=/\u0000|\uFFFD/g;function a2(t){return(typeof t=="string"?t:""+t).replace(VI,`
`).replace(zI,"")}function k0(t,e,r){if(e=a2(e),a2(t)!==e&&r)throw Error(je(425))}function Dh(){}var jm=null,Lm=null;function Um(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Vm=typeof setTimeout=="function"?setTimeout:void 0,WI=typeof clearTimeout=="function"?clearTimeout:void 0,o2=typeof Promise=="function"?Promise:void 0,HI=typeof queueMicrotask=="function"?queueMicrotask:typeof o2<"u"?function(t){return o2.resolve(null).then(t).catch($I)}:Vm;function $I(t){setTimeout(function(){throw t})}function Ig(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),Jd(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Jd(e)}function Xo(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function l2(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Ru=Math.random().toString(36).slice(2),Sa="__reactFiber$"+Ru,nf="__reactProps$"+Ru,no="__reactContainer$"+Ru,zm="__reactEvents$"+Ru,GI="__reactListeners$"+Ru,KI="__reactHandles$"+Ru;function Rl(t){var e=t[Sa];if(e)return e;for(var r=t.parentNode;r;){if(e=r[no]||r[Sa]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=l2(t);t!==null;){if(r=t[Sa])return r;t=l2(t)}return e}t=r,r=t.parentNode}return null}function jf(t){return t=t[Sa]||t[no],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function zc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(je(33))}function Ip(t){return t[nf]||null}var Wm=[],Wc=-1;function gl(t){return{current:t}}function Ir(t){0>Wc||(t.current=Wm[Wc],Wm[Wc]=null,Wc--)}function Tr(t,e){Wc++,Wm[Wc]=t.current,t.current=e}var al={},mi=gl(al),Hi=gl(!1),$l=al;function fu(t,e){var r=t.type.contextTypes;if(!r)return al;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function $i(t){return t=t.childContextTypes,t!=null}function Ph(){Ir(Hi),Ir(mi)}function c2(t,e,r){if(mi.current!==al)throw Error(je(168));Tr(mi,e),Tr(Hi,r)}function Aw(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(je(108,Nb(t)||"Unknown",i));return $r({},r,n)}function Oh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||al,$l=mi.current,Tr(mi,t),Tr(Hi,Hi.current),!0}function u2(t,e,r){var n=t.stateNode;if(!n)throw Error(je(169));r?(t=Aw(t,e,$l),n.__reactInternalMemoizedMergedChildContext=t,Ir(Hi),Ir(mi),Tr(mi,t)):Ir(Hi),Tr(Hi,r)}var Ha=null,Np=!1,Ng=!1;function Cw(t){Ha===null?Ha=[t]:Ha.push(t)}function YI(t){Np=!0,Cw(t)}function ml(){if(!Ng&&Ha!==null){Ng=!0;var t=0,e=ur;try{var r=Ha;for(ur=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Ha=null,Np=!1}catch(i){throw Ha!==null&&(Ha=Ha.slice(t+1)),QS(e1,ml),i}finally{ur=e,Ng=!1}}return null}var Hc=[],$c=0,Mh=null,Bh=0,Ns=[],Rs=0,Gl=null,$a=1,Ga="";function kl(t,e){Hc[$c++]=Bh,Hc[$c++]=Mh,Mh=t,Bh=e}function kw(t,e,r){Ns[Rs++]=$a,Ns[Rs++]=Ga,Ns[Rs++]=Gl,Gl=t;var n=$a;t=Ga;var i=32-ia(n)-1;n&=~(1<<i),r+=1;var s=32-ia(e)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,$a=1<<32-ia(e)+i|r<<i|n,Ga=s+t}else $a=1<<s|r<<i|n,Ga=t}function c1(t){t.return!==null&&(kl(t,1),kw(t,1,0))}function u1(t){for(;t===Mh;)Mh=Hc[--$c],Hc[$c]=null,Bh=Hc[--$c],Hc[$c]=null;for(;t===Gl;)Gl=Ns[--Rs],Ns[Rs]=null,Ga=Ns[--Rs],Ns[Rs]=null,$a=Ns[--Rs],Ns[Rs]=null}var cs=null,ls=null,Mr=!1,ea=null;function Fw(t,e){var r=Ps(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function d2(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,cs=t,ls=Xo(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,cs=t,ls=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Gl!==null?{id:$a,overflow:Ga}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Ps(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,cs=t,ls=null,!0):!1;default:return!1}}function Hm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function $m(t){if(Mr){var e=ls;if(e){var r=e;if(!d2(t,e)){if(Hm(t))throw Error(je(418));e=Xo(r.nextSibling);var n=cs;e&&d2(t,e)?Fw(n,r):(t.flags=t.flags&-4097|2,Mr=!1,cs=t)}}else{if(Hm(t))throw Error(je(418));t.flags=t.flags&-4097|2,Mr=!1,cs=t}}}function f2(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;cs=t}function F0(t){if(t!==cs)return!1;if(!Mr)return f2(t),Mr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Um(t.type,t.memoizedProps)),e&&(e=ls)){if(Hm(t))throw bw(),Error(je(418));for(;e;)Fw(t,e),e=Xo(e.nextSibling)}if(f2(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(je(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){ls=Xo(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}ls=null}}else ls=cs?Xo(t.stateNode.nextSibling):null;return!0}function bw(){for(var t=ls;t;)t=Xo(t.nextSibling)}function hu(){ls=cs=null,Mr=!1}function d1(t){ea===null?ea=[t]:ea.push(t)}var XI=ho.ReactCurrentBatchConfig;function sd(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(je(309));var n=r.stateNode}if(!n)throw Error(je(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(je(284));if(!r._owner)throw Error(je(290,t))}return t}function b0(t,e){throw t=Object.prototype.toString.call(e),Error(je(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function h2(t){var e=t._init;return e(t._payload)}function Iw(t){function e(A,k){if(t){var E=A.deletions;E===null?(A.deletions=[k],A.flags|=16):E.push(k)}}function r(A,k){if(!t)return null;for(;k!==null;)e(A,k),k=k.sibling;return null}function n(A,k){for(A=new Map;k!==null;)k.key!==null?A.set(k.key,k):A.set(k.index,k),k=k.sibling;return A}function i(A,k){return A=Zo(A,k),A.index=0,A.sibling=null,A}function s(A,k,E){return A.index=E,t?(E=A.alternate,E!==null?(E=E.index,E<k?(A.flags|=2,k):E):(A.flags|=2,k)):(A.flags|=1048576,k)}function a(A){return t&&A.alternate===null&&(A.flags|=2),A}function o(A,k,E,P){return k===null||k.tag!==6?(k=jg(E,A.mode,P),k.return=A,k):(k=i(k,E),k.return=A,k)}function l(A,k,E,P){var Y=E.type;return Y===jc?f(A,k,E.props.children,P,E.key):k!==null&&(k.elementType===Y||typeof Y=="object"&&Y!==null&&Y.$$typeof===Ro&&h2(Y)===k.type)?(P=i(k,E.props),P.ref=sd(A,k,E),P.return=A,P):(P=gh(E.type,E.key,E.props,null,A.mode,P),P.ref=sd(A,k,E),P.return=A,P)}function u(A,k,E,P){return k===null||k.tag!==4||k.stateNode.containerInfo!==E.containerInfo||k.stateNode.implementation!==E.implementation?(k=Lg(E,A.mode,P),k.return=A,k):(k=i(k,E.children||[]),k.return=A,k)}function f(A,k,E,P,Y){return k===null||k.tag!==7?(k=jl(E,A.mode,P,Y),k.return=A,k):(k=i(k,E),k.return=A,k)}function p(A,k,E){if(typeof k=="string"&&k!==""||typeof k=="number")return k=jg(""+k,A.mode,E),k.return=A,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case v0:return E=gh(k.type,k.key,k.props,null,A.mode,E),E.ref=sd(A,null,k),E.return=A,E;case Bc:return k=Lg(k,A.mode,E),k.return=A,k;case Ro:var P=k._init;return p(A,P(k._payload),E)}if(gd(k)||ed(k))return k=jl(k,A.mode,E,null),k.return=A,k;b0(A,k)}return null}function g(A,k,E,P){var Y=k!==null?k.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return Y!==null?null:o(A,k,""+E,P);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case v0:return E.key===Y?l(A,k,E,P):null;case Bc:return E.key===Y?u(A,k,E,P):null;case Ro:return Y=E._init,g(A,k,Y(E._payload),P)}if(gd(E)||ed(E))return Y!==null?null:f(A,k,E,P,null);b0(A,E)}return null}function m(A,k,E,P,Y){if(typeof P=="string"&&P!==""||typeof P=="number")return A=A.get(E)||null,o(k,A,""+P,Y);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case v0:return A=A.get(P.key===null?E:P.key)||null,l(k,A,P,Y);case Bc:return A=A.get(P.key===null?E:P.key)||null,u(k,A,P,Y);case Ro:var W=P._init;return m(A,k,E,W(P._payload),Y)}if(gd(P)||ed(P))return A=A.get(E)||null,f(k,A,P,Y,null);b0(k,P)}return null}function y(A,k,E,P){for(var Y=null,W=null,T=k,F=k=0,w=null;T!==null&&F<E.length;F++){T.index>F?(w=T,T=null):w=T.sibling;var I=g(A,T,E[F],P);if(I===null){T===null&&(T=w);break}t&&T&&I.alternate===null&&e(A,T),k=s(I,k,F),W===null?Y=I:W.sibling=I,W=I,T=w}if(F===E.length)return r(A,T),Mr&&kl(A,F),Y;if(T===null){for(;F<E.length;F++)T=p(A,E[F],P),T!==null&&(k=s(T,k,F),W===null?Y=T:W.sibling=T,W=T);return Mr&&kl(A,F),Y}for(T=n(A,T);F<E.length;F++)w=m(T,A,F,E[F],P),w!==null&&(t&&w.alternate!==null&&T.delete(w.key===null?F:w.key),k=s(w,k,F),W===null?Y=w:W.sibling=w,W=w);return t&&T.forEach(function(R){return e(A,R)}),Mr&&kl(A,F),Y}function x(A,k,E,P){var Y=ed(E);if(typeof Y!="function")throw Error(je(150));if(E=Y.call(E),E==null)throw Error(je(151));for(var W=Y=null,T=k,F=k=0,w=null,I=E.next();T!==null&&!I.done;F++,I=E.next()){T.index>F?(w=T,T=null):w=T.sibling;var R=g(A,T,I.value,P);if(R===null){T===null&&(T=w);break}t&&T&&R.alternate===null&&e(A,T),k=s(R,k,F),W===null?Y=R:W.sibling=R,W=R,T=w}if(I.done)return r(A,T),Mr&&kl(A,F),Y;if(T===null){for(;!I.done;F++,I=E.next())I=p(A,I.value,P),I!==null&&(k=s(I,k,F),W===null?Y=I:W.sibling=I,W=I);return Mr&&kl(A,F),Y}for(T=n(A,T);!I.done;F++,I=E.next())I=m(T,A,F,I.value,P),I!==null&&(t&&I.alternate!==null&&T.delete(I.key===null?F:I.key),k=s(I,k,F),W===null?Y=I:W.sibling=I,W=I);return t&&T.forEach(function(D){return e(A,D)}),Mr&&kl(A,F),Y}function S(A,k,E,P){if(typeof E=="object"&&E!==null&&E.type===jc&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case v0:e:{for(var Y=E.key,W=k;W!==null;){if(W.key===Y){if(Y=E.type,Y===jc){if(W.tag===7){r(A,W.sibling),k=i(W,E.props.children),k.return=A,A=k;break e}}else if(W.elementType===Y||typeof Y=="object"&&Y!==null&&Y.$$typeof===Ro&&h2(Y)===W.type){r(A,W.sibling),k=i(W,E.props),k.ref=sd(A,W,E),k.return=A,A=k;break e}r(A,W);break}else e(A,W);W=W.sibling}E.type===jc?(k=jl(E.props.children,A.mode,P,E.key),k.return=A,A=k):(P=gh(E.type,E.key,E.props,null,A.mode,P),P.ref=sd(A,k,E),P.return=A,A=P)}return a(A);case Bc:e:{for(W=E.key;k!==null;){if(k.key===W)if(k.tag===4&&k.stateNode.containerInfo===E.containerInfo&&k.stateNode.implementation===E.implementation){r(A,k.sibling),k=i(k,E.children||[]),k.return=A,A=k;break e}else{r(A,k);break}else e(A,k);k=k.sibling}k=Lg(E,A.mode,P),k.return=A,A=k}return a(A);case Ro:return W=E._init,S(A,k,W(E._payload),P)}if(gd(E))return y(A,k,E,P);if(ed(E))return x(A,k,E,P);b0(A,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,k!==null&&k.tag===6?(r(A,k.sibling),k=i(k,E),k.return=A,A=k):(r(A,k),k=jg(E,A.mode,P),k.return=A,A=k),a(A)):r(A,k)}return S}var pu=Iw(!0),Nw=Iw(!1),jh=gl(null),Lh=null,Gc=null,f1=null;function h1(){f1=Gc=Lh=null}function p1(t){var e=jh.current;Ir(jh),t._currentValue=e}function Gm(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function tu(t,e){Lh=t,f1=Gc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Wi=!0),t.firstContext=null)}function Bs(t){var e=t._currentValue;if(f1!==t)if(t={context:t,memoizedValue:e,next:null},Gc===null){if(Lh===null)throw Error(je(308));Gc=t,Lh.dependencies={lanes:0,firstContext:t}}else Gc=Gc.next=t;return e}var Dl=null;function g1(t){Dl===null?Dl=[t]:Dl.push(t)}function Rw(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,g1(e)):(r.next=i.next,i.next=r),e.interleaved=r,io(t,n)}function io(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Do=!1;function m1(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Dw(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Qa(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function qo(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Xt&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,io(t,r)}return i=n.interleaved,i===null?(e.next=e,g1(n)):(e.next=i.next,i.next=e),n.interleaved=e,io(t,r)}function ch(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,t1(t,r)}}function p2(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Uh(t,e,r,n){var i=t.updateQueue;Do=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?s=u:a.next=u,a=l;var f=t.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==a&&(o===null?f.firstBaseUpdate=u:o.next=u,f.lastBaseUpdate=l))}if(s!==null){var p=i.baseState;a=0,f=u=l=null,o=s;do{var g=o.lane,m=o.eventTime;if((n&g)===g){f!==null&&(f=f.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=t,x=o;switch(g=e,m=r,x.tag){case 1:if(y=x.payload,typeof y=="function"){p=y.call(m,p,g);break e}p=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=x.payload,g=typeof y=="function"?y.call(m,p,g):y,g==null)break e;p=$r({},p,g);break e;case 2:Do=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,g=i.effects,g===null?i.effects=[o]:g.push(o))}else m={eventTime:m,lane:g,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(u=f=m,l=p):f=f.next=m,a|=g;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;g=o,o=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(f===null&&(l=p),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Yl|=a,t.lanes=a,t.memoizedState=p}}function g2(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(je(191,i));i.call(n)}}}var Lf={},Aa=gl(Lf),sf=gl(Lf),af=gl(Lf);function Pl(t){if(t===Lf)throw Error(je(174));return t}function x1(t,e){switch(Tr(af,e),Tr(sf,t),Tr(Aa,Lf),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Cm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Cm(e,t)}Ir(Aa),Tr(Aa,e)}function gu(){Ir(Aa),Ir(sf),Ir(af)}function Pw(t){Pl(af.current);var e=Pl(Aa.current),r=Cm(e,t.type);e!==r&&(Tr(sf,t),Tr(Aa,r))}function v1(t){sf.current===t&&(Ir(Aa),Ir(sf))}var Vr=gl(0);function Vh(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Rg=[];function y1(){for(var t=0;t<Rg.length;t++)Rg[t]._workInProgressVersionPrimary=null;Rg.length=0}var uh=ho.ReactCurrentDispatcher,Dg=ho.ReactCurrentBatchConfig,Kl=0,Hr=null,Cn=null,Ln=null,zh=!1,Id=!1,of=0,qI=0;function ii(){throw Error(je(321))}function _1(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!la(t[r],e[r]))return!1;return!0}function E1(t,e,r,n,i,s){if(Kl=s,Hr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,uh.current=t===null||t.memoizedState===null?eN:tN,t=r(n,i),Id){s=0;do{if(Id=!1,of=0,25<=s)throw Error(je(301));s+=1,Ln=Cn=null,e.updateQueue=null,uh.current=rN,t=r(n,i)}while(Id)}if(uh.current=Wh,e=Cn!==null&&Cn.next!==null,Kl=0,Ln=Cn=Hr=null,zh=!1,e)throw Error(je(300));return t}function S1(){var t=of!==0;return of=0,t}function Ea(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ln===null?Hr.memoizedState=Ln=t:Ln=Ln.next=t,Ln}function js(){if(Cn===null){var t=Hr.alternate;t=t!==null?t.memoizedState:null}else t=Cn.next;var e=Ln===null?Hr.memoizedState:Ln.next;if(e!==null)Ln=e,Cn=t;else{if(t===null)throw Error(je(310));Cn=t,t={memoizedState:Cn.memoizedState,baseState:Cn.baseState,baseQueue:Cn.baseQueue,queue:Cn.queue,next:null},Ln===null?Hr.memoizedState=Ln=t:Ln=Ln.next=t}return Ln}function lf(t,e){return typeof e=="function"?e(t):e}function Pg(t){var e=js(),r=e.queue;if(r===null)throw Error(je(311));r.lastRenderedReducer=t;var n=Cn,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,u=s;do{var f=u.lane;if((Kl&f)===f)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var p={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=p,a=n):l=l.next=p,Hr.lanes|=f,Yl|=f}u=u.next}while(u!==null&&u!==s);l===null?a=n:l.next=o,la(n,e.memoizedState)||(Wi=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,Hr.lanes|=s,Yl|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Og(t){var e=js(),r=e.queue;if(r===null)throw Error(je(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);la(s,e.memoizedState)||(Wi=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function Ow(){}function Mw(t,e){var r=Hr,n=js(),i=e(),s=!la(n.memoizedState,i);if(s&&(n.memoizedState=i,Wi=!0),n=n.queue,w1(Lw.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||Ln!==null&&Ln.memoizedState.tag&1){if(r.flags|=2048,cf(9,jw.bind(null,r,n,i,e),void 0,null),zn===null)throw Error(je(349));Kl&30||Bw(r,e,i)}return i}function Bw(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Hr.updateQueue,e===null?(e={lastEffect:null,stores:null},Hr.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function jw(t,e,r,n){e.value=r,e.getSnapshot=n,Uw(e)&&Vw(t)}function Lw(t,e,r){return r(function(){Uw(e)&&Vw(t)})}function Uw(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!la(t,r)}catch{return!0}}function Vw(t){var e=io(t,1);e!==null&&sa(e,t,1,-1)}function m2(t){var e=Ea();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:lf,lastRenderedState:t},e.queue=t,t=t.dispatch=ZI.bind(null,Hr,t),[e.memoizedState,t]}function cf(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Hr.updateQueue,e===null?(e={lastEffect:null,stores:null},Hr.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function zw(){return js().memoizedState}function dh(t,e,r,n){var i=Ea();Hr.flags|=t,i.memoizedState=cf(1|e,r,void 0,n===void 0?null:n)}function Rp(t,e,r,n){var i=js();n=n===void 0?null:n;var s=void 0;if(Cn!==null){var a=Cn.memoizedState;if(s=a.destroy,n!==null&&_1(n,a.deps)){i.memoizedState=cf(e,r,s,n);return}}Hr.flags|=t,i.memoizedState=cf(1|e,r,s,n)}function x2(t,e){return dh(8390656,8,t,e)}function w1(t,e){return Rp(2048,8,t,e)}function Ww(t,e){return Rp(4,2,t,e)}function Hw(t,e){return Rp(4,4,t,e)}function $w(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Gw(t,e,r){return r=r!=null?r.concat([t]):null,Rp(4,4,$w.bind(null,e,t),r)}function T1(){}function Kw(t,e){var r=js();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&_1(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function Yw(t,e){var r=js();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&_1(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function Xw(t,e,r){return Kl&21?(la(r,e)||(r=ew(),Hr.lanes|=r,Yl|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Wi=!0),t.memoizedState=r)}function QI(t,e){var r=ur;ur=r!==0&&4>r?r:4,t(!0);var n=Dg.transition;Dg.transition={};try{t(!1),e()}finally{ur=r,Dg.transition=n}}function qw(){return js().memoizedState}function JI(t,e,r){var n=Jo(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Qw(t))Jw(e,r);else if(r=Rw(t,e,r,n),r!==null){var i=Ci();sa(r,t,n,i),Zw(r,e,n)}}function ZI(t,e,r){var n=Jo(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Qw(t))Jw(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,la(o,a)){var l=e.interleaved;l===null?(i.next=i,g1(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=Rw(t,e,i,n),r!==null&&(i=Ci(),sa(r,t,n,i),Zw(r,e,n))}}function Qw(t){var e=t.alternate;return t===Hr||e!==null&&e===Hr}function Jw(t,e){Id=zh=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function Zw(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,t1(t,r)}}var Wh={readContext:Bs,useCallback:ii,useContext:ii,useEffect:ii,useImperativeHandle:ii,useInsertionEffect:ii,useLayoutEffect:ii,useMemo:ii,useReducer:ii,useRef:ii,useState:ii,useDebugValue:ii,useDeferredValue:ii,useTransition:ii,useMutableSource:ii,useSyncExternalStore:ii,useId:ii,unstable_isNewReconciler:!1},eN={readContext:Bs,useCallback:function(t,e){return Ea().memoizedState=[t,e===void 0?null:e],t},useContext:Bs,useEffect:x2,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,dh(4194308,4,$w.bind(null,e,t),r)},useLayoutEffect:function(t,e){return dh(4194308,4,t,e)},useInsertionEffect:function(t,e){return dh(4,2,t,e)},useMemo:function(t,e){var r=Ea();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Ea();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=JI.bind(null,Hr,t),[n.memoizedState,t]},useRef:function(t){var e=Ea();return t={current:t},e.memoizedState=t},useState:m2,useDebugValue:T1,useDeferredValue:function(t){return Ea().memoizedState=t},useTransition:function(){var t=m2(!1),e=t[0];return t=QI.bind(null,t[1]),Ea().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Hr,i=Ea();if(Mr){if(r===void 0)throw Error(je(407));r=r()}else{if(r=e(),zn===null)throw Error(je(349));Kl&30||Bw(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,x2(Lw.bind(null,n,s,t),[t]),n.flags|=2048,cf(9,jw.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=Ea(),e=zn.identifierPrefix;if(Mr){var r=Ga,n=$a;r=(n&~(1<<32-ia(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=of++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=qI++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},tN={readContext:Bs,useCallback:Kw,useContext:Bs,useEffect:w1,useImperativeHandle:Gw,useInsertionEffect:Ww,useLayoutEffect:Hw,useMemo:Yw,useReducer:Pg,useRef:zw,useState:function(){return Pg(lf)},useDebugValue:T1,useDeferredValue:function(t){var e=js();return Xw(e,Cn.memoizedState,t)},useTransition:function(){var t=Pg(lf)[0],e=js().memoizedState;return[t,e]},useMutableSource:Ow,useSyncExternalStore:Mw,useId:qw,unstable_isNewReconciler:!1},rN={readContext:Bs,useCallback:Kw,useContext:Bs,useEffect:w1,useImperativeHandle:Gw,useInsertionEffect:Ww,useLayoutEffect:Hw,useMemo:Yw,useReducer:Og,useRef:zw,useState:function(){return Og(lf)},useDebugValue:T1,useDeferredValue:function(t){var e=js();return Cn===null?e.memoizedState=t:Xw(e,Cn.memoizedState,t)},useTransition:function(){var t=Og(lf)[0],e=js().memoizedState;return[t,e]},useMutableSource:Ow,useSyncExternalStore:Mw,useId:qw,unstable_isNewReconciler:!1};function Js(t,e){if(t&&t.defaultProps){e=$r({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Km(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:$r({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Dp={isMounted:function(t){return(t=t._reactInternals)?lc(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Ci(),i=Jo(t),s=Qa(n,i);s.payload=e,r!=null&&(s.callback=r),e=qo(t,s,i),e!==null&&(sa(e,t,i,n),ch(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Ci(),i=Jo(t),s=Qa(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=qo(t,s,i),e!==null&&(sa(e,t,i,n),ch(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Ci(),n=Jo(t),i=Qa(r,n);i.tag=2,e!=null&&(i.callback=e),e=qo(t,i,n),e!==null&&(sa(e,t,n,r),ch(e,t,n))}};function v2(t,e,r,n,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,a):e.prototype&&e.prototype.isPureReactComponent?!ef(r,n)||!ef(i,s):!0}function eT(t,e,r){var n=!1,i=al,s=e.contextType;return typeof s=="object"&&s!==null?s=Bs(s):(i=$i(e)?$l:mi.current,n=e.contextTypes,s=(n=n!=null)?fu(t,i):al),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Dp,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function y2(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Dp.enqueueReplaceState(e,e.state,null)}function Ym(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},m1(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Bs(s):(s=$i(e)?$l:mi.current,i.context=fu(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Km(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Dp.enqueueReplaceState(i,i.state,null),Uh(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function mu(t,e){try{var r="",n=e;do r+=Ib(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Mg(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Xm(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var nN=typeof WeakMap=="function"?WeakMap:Map;function tT(t,e,r){r=Qa(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){$h||($h=!0,sx=n),Xm(t,e)},r}function rT(t,e,r){r=Qa(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){Xm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Xm(t,e),typeof n!="function"&&(Qo===null?Qo=new Set([this]):Qo.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function _2(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new nN;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=xN.bind(null,t,e,r),e.then(t,t))}function E2(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function S2(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Qa(-1,1),e.tag=2,qo(r,e,1))),r.lanes|=1),t)}var iN=ho.ReactCurrentOwner,Wi=!1;function wi(t,e,r,n){e.child=t===null?Nw(e,null,r,n):pu(e,t.child,r,n)}function w2(t,e,r,n,i){r=r.render;var s=e.ref;return tu(e,i),n=E1(t,e,r,n,s,i),r=S1(),t!==null&&!Wi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,so(t,e,i)):(Mr&&r&&c1(e),e.flags|=1,wi(t,e,n,i),e.child)}function T2(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!R1(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,nT(t,e,s,n,i)):(t=gh(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:ef,r(a,n)&&t.ref===e.ref)return so(t,e,i)}return e.flags|=1,t=Zo(s,n),t.ref=e.ref,t.return=e,e.child=t}function nT(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(ef(s,n)&&t.ref===e.ref)if(Wi=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(Wi=!0);else return e.lanes=t.lanes,so(t,e,i)}return qm(t,e,r,n,i)}function iT(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Tr(Yc,ns),ns|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Tr(Yc,ns),ns|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Tr(Yc,ns),ns|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,Tr(Yc,ns),ns|=n;return wi(t,e,i,r),e.child}function sT(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function qm(t,e,r,n,i){var s=$i(r)?$l:mi.current;return s=fu(e,s),tu(e,i),r=E1(t,e,r,n,s,i),n=S1(),t!==null&&!Wi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,so(t,e,i)):(Mr&&n&&c1(e),e.flags|=1,wi(t,e,r,i),e.child)}function A2(t,e,r,n,i){if($i(r)){var s=!0;Oh(e)}else s=!1;if(tu(e,i),e.stateNode===null)fh(t,e),eT(e,r,n),Ym(e,r,n,i),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,u=r.contextType;typeof u=="object"&&u!==null?u=Bs(u):(u=$i(r)?$l:mi.current,u=fu(e,u));var f=r.getDerivedStateFromProps,p=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";p||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==u)&&y2(e,a,n,u),Do=!1;var g=e.memoizedState;a.state=g,Uh(e,n,a,i),l=e.memoizedState,o!==n||g!==l||Hi.current||Do?(typeof f=="function"&&(Km(e,r,f,n),l=e.memoizedState),(o=Do||v2(e,r,o,n,g,l,u))?(p||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=u,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,Dw(t,e),o=e.memoizedProps,u=e.type===e.elementType?o:Js(e.type,o),a.props=u,p=e.pendingProps,g=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=Bs(l):(l=$i(r)?$l:mi.current,l=fu(e,l));var m=r.getDerivedStateFromProps;(f=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==p||g!==l)&&y2(e,a,n,l),Do=!1,g=e.memoizedState,a.state=g,Uh(e,n,a,i);var y=e.memoizedState;o!==p||g!==y||Hi.current||Do?(typeof m=="function"&&(Km(e,r,m,n),y=e.memoizedState),(u=Do||v2(e,r,u,n,g,y,l)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,y,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,y,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=y),a.props=n,a.state=y,a.context=l,n=u):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),n=!1)}return Qm(t,e,r,n,s,i)}function Qm(t,e,r,n,i,s){sT(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return i&&u2(e,r,!1),so(t,e,s);n=e.stateNode,iN.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=pu(e,t.child,null,s),e.child=pu(e,null,o,s)):wi(t,e,o,s),e.memoizedState=n.state,i&&u2(e,r,!0),e.child}function aT(t){var e=t.stateNode;e.pendingContext?c2(t,e.pendingContext,e.pendingContext!==e.context):e.context&&c2(t,e.context,!1),x1(t,e.containerInfo)}function C2(t,e,r,n,i){return hu(),d1(i),e.flags|=256,wi(t,e,r,n),e.child}var Jm={dehydrated:null,treeContext:null,retryLane:0};function Zm(t){return{baseLanes:t,cachePool:null,transitions:null}}function oT(t,e,r){var n=e.pendingProps,i=Vr.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Tr(Vr,i&1),t===null)return $m(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,s?(n=e.mode,s=e.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=Mp(a,n,0,null),t=jl(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Zm(r),e.memoizedState=Jm,t):A1(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return sN(t,e,a,n,o,i,r);if(s){s=n.fallback,a=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=Zo(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=Zo(o,s):(s=jl(s,a,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,a=t.child.memoizedState,a=a===null?Zm(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~r,e.memoizedState=Jm,n}return s=t.child,t=s.sibling,n=Zo(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function A1(t,e){return e=Mp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function I0(t,e,r,n){return n!==null&&d1(n),pu(e,t.child,null,r),t=A1(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function sN(t,e,r,n,i,s,a){if(r)return e.flags&256?(e.flags&=-257,n=Mg(Error(je(422))),I0(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=Mp({mode:"visible",children:n.children},i,0,null),s=jl(s,i,a,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&pu(e,t.child,null,a),e.child.memoizedState=Zm(a),e.memoizedState=Jm,s);if(!(e.mode&1))return I0(t,e,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(je(419)),n=Mg(s,n,void 0),I0(t,e,a,n)}if(o=(a&t.childLanes)!==0,Wi||o){if(n=zn,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,io(t,i),sa(n,t,i,-1))}return N1(),n=Mg(Error(je(421))),I0(t,e,a,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=vN.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,ls=Xo(i.nextSibling),cs=e,Mr=!0,ea=null,t!==null&&(Ns[Rs++]=$a,Ns[Rs++]=Ga,Ns[Rs++]=Gl,$a=t.id,Ga=t.overflow,Gl=e),e=A1(e,n.children),e.flags|=4096,e)}function k2(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Gm(t.return,e,r)}function Bg(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function lT(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(wi(t,e,n.children,r),n=Vr.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&k2(t,r,e);else if(t.tag===19)k2(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Tr(Vr,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&Vh(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),Bg(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Vh(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}Bg(e,!0,r,null,s);break;case"together":Bg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function fh(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function so(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Yl|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(je(153));if(e.child!==null){for(t=e.child,r=Zo(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Zo(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function aN(t,e,r){switch(e.tag){case 3:aT(e),hu();break;case 5:Pw(e);break;case 1:$i(e.type)&&Oh(e);break;case 4:x1(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;Tr(jh,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Tr(Vr,Vr.current&1),e.flags|=128,null):r&e.child.childLanes?oT(t,e,r):(Tr(Vr,Vr.current&1),t=so(t,e,r),t!==null?t.sibling:null);Tr(Vr,Vr.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return lT(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Tr(Vr,Vr.current),n)break;return null;case 22:case 23:return e.lanes=0,iT(t,e,r)}return so(t,e,r)}var cT,ex,uT,dT;cT=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};ex=function(){};uT=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,Pl(Aa.current);var s=null;switch(r){case"input":i=Sm(t,i),n=Sm(t,n),s=[];break;case"select":i=$r({},i,{value:void 0}),n=$r({},n,{value:void 0}),s=[];break;case"textarea":i=Am(t,i),n=Am(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Dh)}km(r,n);var a;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Kd.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var l=n[u];if(o=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Kd.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Fr("scroll",t),s||o===l||(s=[])):(s=s||[]).push(u,l))}r&&(s=s||[]).push("style",r);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};dT=function(t,e,r,n){r!==n&&(e.flags|=4)};function ad(t,e){if(!Mr)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function si(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function oN(t,e,r){var n=e.pendingProps;switch(u1(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return si(e),null;case 1:return $i(e.type)&&Ph(),si(e),null;case 3:return n=e.stateNode,gu(),Ir(Hi),Ir(mi),y1(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(F0(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ea!==null&&(lx(ea),ea=null))),ex(t,e),si(e),null;case 5:v1(e);var i=Pl(af.current);if(r=e.type,t!==null&&e.stateNode!=null)uT(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(je(166));return si(e),null}if(t=Pl(Aa.current),F0(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[Sa]=e,n[nf]=s,t=(e.mode&1)!==0,r){case"dialog":Fr("cancel",n),Fr("close",n);break;case"iframe":case"object":case"embed":Fr("load",n);break;case"video":case"audio":for(i=0;i<xd.length;i++)Fr(xd[i],n);break;case"source":Fr("error",n);break;case"img":case"image":case"link":Fr("error",n),Fr("load",n);break;case"details":Fr("toggle",n);break;case"input":My(n,s),Fr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Fr("invalid",n);break;case"textarea":jy(n,s),Fr("invalid",n)}km(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&k0(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&k0(n.textContent,o,t),i=["children",""+o]):Kd.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Fr("scroll",n)}switch(r){case"input":y0(n),By(n,s,!0);break;case"textarea":y0(n),Ly(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Dh)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=LS(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[Sa]=e,t[nf]=n,cT(t,e,!1,!1),e.stateNode=t;e:{switch(a=Fm(r,n),r){case"dialog":Fr("cancel",t),Fr("close",t),i=n;break;case"iframe":case"object":case"embed":Fr("load",t),i=n;break;case"video":case"audio":for(i=0;i<xd.length;i++)Fr(xd[i],t);i=n;break;case"source":Fr("error",t),i=n;break;case"img":case"image":case"link":Fr("error",t),Fr("load",t),i=n;break;case"details":Fr("toggle",t),i=n;break;case"input":My(t,n),i=Sm(t,n),Fr("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=$r({},n,{value:void 0}),Fr("invalid",t);break;case"textarea":jy(t,n),i=Am(t,n),Fr("invalid",t);break;default:i=n}km(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?zS(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&US(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Yd(t,l):typeof l=="number"&&Yd(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Kd.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Fr("scroll",t):l!=null&&Xx(t,s,l,a))}switch(r){case"input":y0(t),By(t,n,!1);break;case"textarea":y0(t),Ly(t);break;case"option":n.value!=null&&t.setAttribute("value",""+sl(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?Qc(t,!!n.multiple,s,!1):n.defaultValue!=null&&Qc(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Dh)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return si(e),null;case 6:if(t&&e.stateNode!=null)dT(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(je(166));if(r=Pl(af.current),Pl(Aa.current),F0(e)){if(n=e.stateNode,r=e.memoizedProps,n[Sa]=e,(s=n.nodeValue!==r)&&(t=cs,t!==null))switch(t.tag){case 3:k0(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&k0(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Sa]=e,e.stateNode=n}return si(e),null;case 13:if(Ir(Vr),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Mr&&ls!==null&&e.mode&1&&!(e.flags&128))bw(),hu(),e.flags|=98560,s=!1;else if(s=F0(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(je(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(je(317));s[Sa]=e}else hu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;si(e),s=!1}else ea!==null&&(lx(ea),ea=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Vr.current&1?bn===0&&(bn=3):N1())),e.updateQueue!==null&&(e.flags|=4),si(e),null);case 4:return gu(),ex(t,e),t===null&&tf(e.stateNode.containerInfo),si(e),null;case 10:return p1(e.type._context),si(e),null;case 17:return $i(e.type)&&Ph(),si(e),null;case 19:if(Ir(Vr),s=e.memoizedState,s===null)return si(e),null;if(n=(e.flags&128)!==0,a=s.rendering,a===null)if(n)ad(s,!1);else{if(bn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Vh(t),a!==null){for(e.flags|=128,ad(s,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Tr(Vr,Vr.current&1|2),e.child}t=t.sibling}s.tail!==null&&on()>xu&&(e.flags|=128,n=!0,ad(s,!1),e.lanes=4194304)}else{if(!n)if(t=Vh(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),ad(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Mr)return si(e),null}else 2*on()-s.renderingStartTime>xu&&r!==1073741824&&(e.flags|=128,n=!0,ad(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(r=s.last,r!==null?r.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=on(),e.sibling=null,r=Vr.current,Tr(Vr,n?r&1|2:r&1),e):(si(e),null);case 22:case 23:return I1(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?ns&1073741824&&(si(e),e.subtreeFlags&6&&(e.flags|=8192)):si(e),null;case 24:return null;case 25:return null}throw Error(je(156,e.tag))}function lN(t,e){switch(u1(e),e.tag){case 1:return $i(e.type)&&Ph(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return gu(),Ir(Hi),Ir(mi),y1(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return v1(e),null;case 13:if(Ir(Vr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(je(340));hu()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ir(Vr),null;case 4:return gu(),null;case 10:return p1(e.type._context),null;case 22:case 23:return I1(),null;case 24:return null;default:return null}}var N0=!1,di=!1,cN=typeof WeakSet=="function"?WeakSet:Set,Je=null;function Kc(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Yr(t,e,n)}else r.current=null}function tx(t,e,r){try{r()}catch(n){Yr(t,e,n)}}var F2=!1;function uN(t,e){if(jm=Ih,t=mw(),l1(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,u=0,f=0,p=t,g=null;t:for(;;){for(var m;p!==r||i!==0&&p.nodeType!==3||(o=a+i),p!==s||n!==0&&p.nodeType!==3||(l=a+n),p.nodeType===3&&(a+=p.nodeValue.length),(m=p.firstChild)!==null;)g=p,p=m;for(;;){if(p===t)break t;if(g===r&&++u===i&&(o=a),g===s&&++f===n&&(l=a),(m=p.nextSibling)!==null)break;p=g,g=p.parentNode}p=m}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Lm={focusedElem:t,selectionRange:r},Ih=!1,Je=e;Je!==null;)if(e=Je,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Je=t;else for(;Je!==null;){e=Je;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var x=y.memoizedProps,S=y.memoizedState,A=e.stateNode,k=A.getSnapshotBeforeUpdate(e.elementType===e.type?x:Js(e.type,x),S);A.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var E=e.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(je(163))}}catch(P){Yr(e,e.return,P)}if(t=e.sibling,t!==null){t.return=e.return,Je=t;break}Je=e.return}return y=F2,F2=!1,y}function Nd(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&tx(e,r,s)}i=i.next}while(i!==n)}}function Pp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function rx(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function fT(t){var e=t.alternate;e!==null&&(t.alternate=null,fT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Sa],delete e[nf],delete e[zm],delete e[GI],delete e[KI])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function hT(t){return t.tag===5||t.tag===3||t.tag===4}function b2(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||hT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function nx(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Dh));else if(n!==4&&(t=t.child,t!==null))for(nx(t,e,r),t=t.sibling;t!==null;)nx(t,e,r),t=t.sibling}function ix(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(ix(t,e,r),t=t.sibling;t!==null;)ix(t,e,r),t=t.sibling}var Xn=null,Zs=!1;function ko(t,e,r){for(r=r.child;r!==null;)pT(t,e,r),r=r.sibling}function pT(t,e,r){if(Ta&&typeof Ta.onCommitFiberUnmount=="function")try{Ta.onCommitFiberUnmount(Cp,r)}catch{}switch(r.tag){case 5:di||Kc(r,e);case 6:var n=Xn,i=Zs;Xn=null,ko(t,e,r),Xn=n,Zs=i,Xn!==null&&(Zs?(t=Xn,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Xn.removeChild(r.stateNode));break;case 18:Xn!==null&&(Zs?(t=Xn,r=r.stateNode,t.nodeType===8?Ig(t.parentNode,r):t.nodeType===1&&Ig(t,r),Jd(t)):Ig(Xn,r.stateNode));break;case 4:n=Xn,i=Zs,Xn=r.stateNode.containerInfo,Zs=!0,ko(t,e,r),Xn=n,Zs=i;break;case 0:case 11:case 14:case 15:if(!di&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&tx(r,e,a),i=i.next}while(i!==n)}ko(t,e,r);break;case 1:if(!di&&(Kc(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Yr(r,e,o)}ko(t,e,r);break;case 21:ko(t,e,r);break;case 22:r.mode&1?(di=(n=di)||r.memoizedState!==null,ko(t,e,r),di=n):ko(t,e,r);break;default:ko(t,e,r)}}function I2(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new cN),e.forEach(function(n){var i=yN.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Xs(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:Xn=o.stateNode,Zs=!1;break e;case 3:Xn=o.stateNode.containerInfo,Zs=!0;break e;case 4:Xn=o.stateNode.containerInfo,Zs=!0;break e}o=o.return}if(Xn===null)throw Error(je(160));pT(s,a,i),Xn=null,Zs=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){Yr(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)gT(e,t),e=e.sibling}function gT(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Xs(e,t),ma(t),n&4){try{Nd(3,t,t.return),Pp(3,t)}catch(x){Yr(t,t.return,x)}try{Nd(5,t,t.return)}catch(x){Yr(t,t.return,x)}}break;case 1:Xs(e,t),ma(t),n&512&&r!==null&&Kc(r,r.return);break;case 5:if(Xs(e,t),ma(t),n&512&&r!==null&&Kc(r,r.return),t.flags&32){var i=t.stateNode;try{Yd(i,"")}catch(x){Yr(t,t.return,x)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=r!==null?r.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&BS(i,s),Fm(o,a);var u=Fm(o,s);for(a=0;a<l.length;a+=2){var f=l[a],p=l[a+1];f==="style"?zS(i,p):f==="dangerouslySetInnerHTML"?US(i,p):f==="children"?Yd(i,p):Xx(i,f,p,u)}switch(o){case"input":wm(i,s);break;case"textarea":jS(i,s);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?Qc(i,!!s.multiple,m,!1):g!==!!s.multiple&&(s.defaultValue!=null?Qc(i,!!s.multiple,s.defaultValue,!0):Qc(i,!!s.multiple,s.multiple?[]:"",!1))}i[nf]=s}catch(x){Yr(t,t.return,x)}}break;case 6:if(Xs(e,t),ma(t),n&4){if(t.stateNode===null)throw Error(je(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(x){Yr(t,t.return,x)}}break;case 3:if(Xs(e,t),ma(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Jd(e.containerInfo)}catch(x){Yr(t,t.return,x)}break;case 4:Xs(e,t),ma(t);break;case 13:Xs(e,t),ma(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(F1=on())),n&4&&I2(t);break;case 22:if(f=r!==null&&r.memoizedState!==null,t.mode&1?(di=(u=di)||f,Xs(e,t),di=u):Xs(e,t),ma(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(Je=t,f=t.child;f!==null;){for(p=Je=f;Je!==null;){switch(g=Je,m=g.child,g.tag){case 0:case 11:case 14:case 15:Nd(4,g,g.return);break;case 1:Kc(g,g.return);var y=g.stateNode;if(typeof y.componentWillUnmount=="function"){n=g,r=g.return;try{e=n,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(x){Yr(n,r,x)}}break;case 5:Kc(g,g.return);break;case 22:if(g.memoizedState!==null){R2(p);continue}}m!==null?(m.return=g,Je=m):R2(p)}f=f.sibling}e:for(f=null,p=t;;){if(p.tag===5){if(f===null){f=p;try{i=p.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=p.stateNode,l=p.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=VS("display",a))}catch(x){Yr(t,t.return,x)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(x){Yr(t,t.return,x)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Xs(e,t),ma(t),n&4&&I2(t);break;case 21:break;default:Xs(e,t),ma(t)}}function ma(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(hT(r)){var n=r;break e}r=r.return}throw Error(je(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Yd(i,""),n.flags&=-33);var s=b2(t);ix(t,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=b2(t);nx(t,o,a);break;default:throw Error(je(161))}}catch(l){Yr(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function dN(t,e,r){Je=t,mT(t)}function mT(t,e,r){for(var n=(t.mode&1)!==0;Je!==null;){var i=Je,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||N0;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||di;o=N0;var u=di;if(N0=a,(di=l)&&!u)for(Je=i;Je!==null;)a=Je,l=a.child,a.tag===22&&a.memoizedState!==null?D2(i):l!==null?(l.return=a,Je=l):D2(i);for(;s!==null;)Je=s,mT(s),s=s.sibling;Je=i,N0=o,di=u}N2(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Je=s):N2(t)}}function N2(t){for(;Je!==null;){var e=Je;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:di||Pp(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!di)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:Js(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&g2(e,s,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}g2(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&Jd(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(je(163))}di||e.flags&512&&rx(e)}catch(g){Yr(e,e.return,g)}}if(e===t){Je=null;break}if(r=e.sibling,r!==null){r.return=e.return,Je=r;break}Je=e.return}}function R2(t){for(;Je!==null;){var e=Je;if(e===t){Je=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Je=r;break}Je=e.return}}function D2(t){for(;Je!==null;){var e=Je;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Pp(4,e)}catch(l){Yr(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){Yr(e,i,l)}}var s=e.return;try{rx(e)}catch(l){Yr(e,s,l)}break;case 5:var a=e.return;try{rx(e)}catch(l){Yr(e,a,l)}}}catch(l){Yr(e,e.return,l)}if(e===t){Je=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Je=o;break}Je=e.return}}var fN=Math.ceil,Hh=ho.ReactCurrentDispatcher,C1=ho.ReactCurrentOwner,Os=ho.ReactCurrentBatchConfig,Xt=0,zn=null,vn=null,ei=0,ns=0,Yc=gl(0),bn=0,uf=null,Yl=0,Op=0,k1=0,Rd=null,zi=null,F1=0,xu=1/0,Wa=null,$h=!1,sx=null,Qo=null,R0=!1,Vo=null,Gh=0,Dd=0,ax=null,hh=-1,ph=0;function Ci(){return Xt&6?on():hh!==-1?hh:hh=on()}function Jo(t){return t.mode&1?Xt&2&&ei!==0?ei&-ei:XI.transition!==null?(ph===0&&(ph=ew()),ph):(t=ur,t!==0||(t=window.event,t=t===void 0?16:ow(t.type)),t):1}function sa(t,e,r,n){if(50<Dd)throw Dd=0,ax=null,Error(je(185));Mf(t,r,n),(!(Xt&2)||t!==zn)&&(t===zn&&(!(Xt&2)&&(Op|=r),bn===4&&Oo(t,ei)),Gi(t,n),r===1&&Xt===0&&!(e.mode&1)&&(xu=on()+500,Np&&ml()))}function Gi(t,e){var r=t.callbackNode;Xb(t,e);var n=bh(t,t===zn?ei:0);if(n===0)r!==null&&zy(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&zy(r),e===1)t.tag===0?YI(P2.bind(null,t)):Cw(P2.bind(null,t)),HI(function(){!(Xt&6)&&ml()}),r=null;else{switch(tw(n)){case 1:r=e1;break;case 4:r=JS;break;case 16:r=Fh;break;case 536870912:r=ZS;break;default:r=Fh}r=TT(r,xT.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function xT(t,e){if(hh=-1,ph=0,Xt&6)throw Error(je(327));var r=t.callbackNode;if(ru()&&t.callbackNode!==r)return null;var n=bh(t,t===zn?ei:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Kh(t,n);else{e=n;var i=Xt;Xt|=2;var s=yT();(zn!==t||ei!==e)&&(Wa=null,xu=on()+500,Bl(t,e));do try{gN();break}catch(o){vT(t,o)}while(!0);h1(),Hh.current=s,Xt=i,vn!==null?e=0:(zn=null,ei=0,e=bn)}if(e!==0){if(e===2&&(i=Dm(t),i!==0&&(n=i,e=ox(t,i))),e===1)throw r=uf,Bl(t,0),Oo(t,n),Gi(t,on()),r;if(e===6)Oo(t,n);else{if(i=t.current.alternate,!(n&30)&&!hN(i)&&(e=Kh(t,n),e===2&&(s=Dm(t),s!==0&&(n=s,e=ox(t,s))),e===1))throw r=uf,Bl(t,0),Oo(t,n),Gi(t,on()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(je(345));case 2:Fl(t,zi,Wa);break;case 3:if(Oo(t,n),(n&130023424)===n&&(e=F1+500-on(),10<e)){if(bh(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){Ci(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Vm(Fl.bind(null,t,zi,Wa),e);break}Fl(t,zi,Wa);break;case 4:if(Oo(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var a=31-ia(n);s=1<<a,a=e[a],a>i&&(i=a),n&=~s}if(n=i,n=on()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*fN(n/1960))-n,10<n){t.timeoutHandle=Vm(Fl.bind(null,t,zi,Wa),n);break}Fl(t,zi,Wa);break;case 5:Fl(t,zi,Wa);break;default:throw Error(je(329))}}}return Gi(t,on()),t.callbackNode===r?xT.bind(null,t):null}function ox(t,e){var r=Rd;return t.current.memoizedState.isDehydrated&&(Bl(t,e).flags|=256),t=Kh(t,e),t!==2&&(e=zi,zi=r,e!==null&&lx(e)),t}function lx(t){zi===null?zi=t:zi.push.apply(zi,t)}function hN(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!la(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Oo(t,e){for(e&=~k1,e&=~Op,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-ia(e),n=1<<r;t[r]=-1,e&=~n}}function P2(t){if(Xt&6)throw Error(je(327));ru();var e=bh(t,0);if(!(e&1))return Gi(t,on()),null;var r=Kh(t,e);if(t.tag!==0&&r===2){var n=Dm(t);n!==0&&(e=n,r=ox(t,n))}if(r===1)throw r=uf,Bl(t,0),Oo(t,e),Gi(t,on()),r;if(r===6)throw Error(je(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Fl(t,zi,Wa),Gi(t,on()),null}function b1(t,e){var r=Xt;Xt|=1;try{return t(e)}finally{Xt=r,Xt===0&&(xu=on()+500,Np&&ml())}}function Xl(t){Vo!==null&&Vo.tag===0&&!(Xt&6)&&ru();var e=Xt;Xt|=1;var r=Os.transition,n=ur;try{if(Os.transition=null,ur=1,t)return t()}finally{ur=n,Os.transition=r,Xt=e,!(Xt&6)&&ml()}}function I1(){ns=Yc.current,Ir(Yc)}function Bl(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,WI(r)),vn!==null)for(r=vn.return;r!==null;){var n=r;switch(u1(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Ph();break;case 3:gu(),Ir(Hi),Ir(mi),y1();break;case 5:v1(n);break;case 4:gu();break;case 13:Ir(Vr);break;case 19:Ir(Vr);break;case 10:p1(n.type._context);break;case 22:case 23:I1()}r=r.return}if(zn=t,vn=t=Zo(t.current,null),ei=ns=e,bn=0,uf=null,k1=Op=Yl=0,zi=Rd=null,Dl!==null){for(e=0;e<Dl.length;e++)if(r=Dl[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}Dl=null}return t}function vT(t,e){do{var r=vn;try{if(h1(),uh.current=Wh,zh){for(var n=Hr.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}zh=!1}if(Kl=0,Ln=Cn=Hr=null,Id=!1,of=0,C1.current=null,r===null||r.return===null){bn=1,uf=e,vn=null;break}e:{var s=t,a=r.return,o=r,l=e;if(e=ei,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,f=o,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var g=f.alternate;g?(f.updateQueue=g.updateQueue,f.memoizedState=g.memoizedState,f.lanes=g.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=E2(a);if(m!==null){m.flags&=-257,S2(m,a,o,s,e),m.mode&1&&_2(s,u,e),e=m,l=u;var y=e.updateQueue;if(y===null){var x=new Set;x.add(l),e.updateQueue=x}else y.add(l);break e}else{if(!(e&1)){_2(s,u,e),N1();break e}l=Error(je(426))}}else if(Mr&&o.mode&1){var S=E2(a);if(S!==null){!(S.flags&65536)&&(S.flags|=256),S2(S,a,o,s,e),d1(mu(l,o));break e}}s=l=mu(l,o),bn!==4&&(bn=2),Rd===null?Rd=[s]:Rd.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var A=tT(s,l,e);p2(s,A);break e;case 1:o=l;var k=s.type,E=s.stateNode;if(!(s.flags&128)&&(typeof k.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Qo===null||!Qo.has(E)))){s.flags|=65536,e&=-e,s.lanes|=e;var P=rT(s,o,e);p2(s,P);break e}}s=s.return}while(s!==null)}ET(r)}catch(Y){e=Y,vn===r&&r!==null&&(vn=r=r.return);continue}break}while(!0)}function yT(){var t=Hh.current;return Hh.current=Wh,t===null?Wh:t}function N1(){(bn===0||bn===3||bn===2)&&(bn=4),zn===null||!(Yl&268435455)&&!(Op&268435455)||Oo(zn,ei)}function Kh(t,e){var r=Xt;Xt|=2;var n=yT();(zn!==t||ei!==e)&&(Wa=null,Bl(t,e));do try{pN();break}catch(i){vT(t,i)}while(!0);if(h1(),Xt=r,Hh.current=n,vn!==null)throw Error(je(261));return zn=null,ei=0,bn}function pN(){for(;vn!==null;)_T(vn)}function gN(){for(;vn!==null&&!Ub();)_T(vn)}function _T(t){var e=wT(t.alternate,t,ns);t.memoizedProps=t.pendingProps,e===null?ET(t):vn=e,C1.current=null}function ET(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=lN(r,e),r!==null){r.flags&=32767,vn=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{bn=6,vn=null;return}}else if(r=oN(r,e,ns),r!==null){vn=r;return}if(e=e.sibling,e!==null){vn=e;return}vn=e=t}while(e!==null);bn===0&&(bn=5)}function Fl(t,e,r){var n=ur,i=Os.transition;try{Os.transition=null,ur=1,mN(t,e,r,n)}finally{Os.transition=i,ur=n}return null}function mN(t,e,r,n){do ru();while(Vo!==null);if(Xt&6)throw Error(je(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(je(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(qb(t,s),t===zn&&(vn=zn=null,ei=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||R0||(R0=!0,TT(Fh,function(){return ru(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Os.transition,Os.transition=null;var a=ur;ur=1;var o=Xt;Xt|=4,C1.current=null,uN(t,r),gT(r,t),MI(Lm),Ih=!!jm,Lm=jm=null,t.current=r,dN(r),Vb(),Xt=o,ur=a,Os.transition=s}else t.current=r;if(R0&&(R0=!1,Vo=t,Gh=i),s=t.pendingLanes,s===0&&(Qo=null),Hb(r.stateNode),Gi(t,on()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if($h)throw $h=!1,t=sx,sx=null,t;return Gh&1&&t.tag!==0&&ru(),s=t.pendingLanes,s&1?t===ax?Dd++:(Dd=0,ax=t):Dd=0,ml(),null}function ru(){if(Vo!==null){var t=tw(Gh),e=Os.transition,r=ur;try{if(Os.transition=null,ur=16>t?16:t,Vo===null)var n=!1;else{if(t=Vo,Vo=null,Gh=0,Xt&6)throw Error(je(331));var i=Xt;for(Xt|=4,Je=t.current;Je!==null;){var s=Je,a=s.child;if(Je.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(Je=u;Je!==null;){var f=Je;switch(f.tag){case 0:case 11:case 15:Nd(8,f,s)}var p=f.child;if(p!==null)p.return=f,Je=p;else for(;Je!==null;){f=Je;var g=f.sibling,m=f.return;if(fT(f),f===u){Je=null;break}if(g!==null){g.return=m,Je=g;break}Je=m}}}var y=s.alternate;if(y!==null){var x=y.child;if(x!==null){y.child=null;do{var S=x.sibling;x.sibling=null,x=S}while(x!==null)}}Je=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,Je=a;else e:for(;Je!==null;){if(s=Je,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Nd(9,s,s.return)}var A=s.sibling;if(A!==null){A.return=s.return,Je=A;break e}Je=s.return}}var k=t.current;for(Je=k;Je!==null;){a=Je;var E=a.child;if(a.subtreeFlags&2064&&E!==null)E.return=a,Je=E;else e:for(a=k;Je!==null;){if(o=Je,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Pp(9,o)}}catch(Y){Yr(o,o.return,Y)}if(o===a){Je=null;break e}var P=o.sibling;if(P!==null){P.return=o.return,Je=P;break e}Je=o.return}}if(Xt=i,ml(),Ta&&typeof Ta.onPostCommitFiberRoot=="function")try{Ta.onPostCommitFiberRoot(Cp,t)}catch{}n=!0}return n}finally{ur=r,Os.transition=e}}return!1}function O2(t,e,r){e=mu(r,e),e=tT(t,e,1),t=qo(t,e,1),e=Ci(),t!==null&&(Mf(t,1,e),Gi(t,e))}function Yr(t,e,r){if(t.tag===3)O2(t,t,r);else for(;e!==null;){if(e.tag===3){O2(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Qo===null||!Qo.has(n))){t=mu(r,t),t=rT(e,t,1),e=qo(e,t,1),t=Ci(),e!==null&&(Mf(e,1,t),Gi(e,t));break}}e=e.return}}function xN(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Ci(),t.pingedLanes|=t.suspendedLanes&r,zn===t&&(ei&r)===r&&(bn===4||bn===3&&(ei&130023424)===ei&&500>on()-F1?Bl(t,0):k1|=r),Gi(t,e)}function ST(t,e){e===0&&(t.mode&1?(e=S0,S0<<=1,!(S0&130023424)&&(S0=4194304)):e=1);var r=Ci();t=io(t,e),t!==null&&(Mf(t,e,r),Gi(t,r))}function vN(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),ST(t,r)}function yN(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(je(314))}n!==null&&n.delete(e),ST(t,r)}var wT;wT=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Hi.current)Wi=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Wi=!1,aN(t,e,r);Wi=!!(t.flags&131072)}else Wi=!1,Mr&&e.flags&1048576&&kw(e,Bh,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;fh(t,e),t=e.pendingProps;var i=fu(e,mi.current);tu(e,r),i=E1(null,e,n,t,i,r);var s=S1();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,$i(n)?(s=!0,Oh(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,m1(e),i.updater=Dp,e.stateNode=i,i._reactInternals=e,Ym(e,n,t,r),e=Qm(null,e,n,!0,s,r)):(e.tag=0,Mr&&s&&c1(e),wi(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(fh(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=EN(n),t=Js(n,t),i){case 0:e=qm(null,e,n,t,r);break e;case 1:e=A2(null,e,n,t,r);break e;case 11:e=w2(null,e,n,t,r);break e;case 14:e=T2(null,e,n,Js(n.type,t),r);break e}throw Error(je(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Js(n,i),qm(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Js(n,i),A2(t,e,n,i,r);case 3:e:{if(aT(e),t===null)throw Error(je(387));n=e.pendingProps,s=e.memoizedState,i=s.element,Dw(t,e),Uh(e,n,null,r);var a=e.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=mu(Error(je(423)),e),e=C2(t,e,n,r,i);break e}else if(n!==i){i=mu(Error(je(424)),e),e=C2(t,e,n,r,i);break e}else for(ls=Xo(e.stateNode.containerInfo.firstChild),cs=e,Mr=!0,ea=null,r=Nw(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(hu(),n===i){e=so(t,e,r);break e}wi(t,e,n,r)}e=e.child}return e;case 5:return Pw(e),t===null&&$m(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,Um(n,i)?a=null:s!==null&&Um(n,s)&&(e.flags|=32),sT(t,e),wi(t,e,a,r),e.child;case 6:return t===null&&$m(e),null;case 13:return oT(t,e,r);case 4:return x1(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=pu(e,null,n,r):wi(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Js(n,i),w2(t,e,n,i,r);case 7:return wi(t,e,e.pendingProps,r),e.child;case 8:return wi(t,e,e.pendingProps.children,r),e.child;case 12:return wi(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,Tr(jh,n._currentValue),n._currentValue=a,s!==null)if(la(s.value,a)){if(s.children===i.children&&!Hi.current){e=so(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Qa(-1,r&-r),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?l.next=l:(l.next=f.next,f.next=l),u.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Gm(s.return,r,e),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(je(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Gm(a,r,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}wi(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,tu(e,r),i=Bs(i),n=n(i),e.flags|=1,wi(t,e,n,r),e.child;case 14:return n=e.type,i=Js(n,e.pendingProps),i=Js(n.type,i),T2(t,e,n,i,r);case 15:return nT(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Js(n,i),fh(t,e),e.tag=1,$i(n)?(t=!0,Oh(e)):t=!1,tu(e,r),eT(e,n,i),Ym(e,n,i,r),Qm(null,e,n,!0,t,r);case 19:return lT(t,e,r);case 22:return iT(t,e,r)}throw Error(je(156,e.tag))};function TT(t,e){return QS(t,e)}function _N(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ps(t,e,r,n){return new _N(t,e,r,n)}function R1(t){return t=t.prototype,!(!t||!t.isReactComponent)}function EN(t){if(typeof t=="function")return R1(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Qx)return 11;if(t===Jx)return 14}return 2}function Zo(t,e){var r=t.alternate;return r===null?(r=Ps(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function gh(t,e,r,n,i,s){var a=2;if(n=t,typeof t=="function")R1(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case jc:return jl(r.children,i,s,e);case qx:a=8,i|=8;break;case vm:return t=Ps(12,r,e,i|2),t.elementType=vm,t.lanes=s,t;case ym:return t=Ps(13,r,e,i),t.elementType=ym,t.lanes=s,t;case _m:return t=Ps(19,r,e,i),t.elementType=_m,t.lanes=s,t;case PS:return Mp(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case RS:a=10;break e;case DS:a=9;break e;case Qx:a=11;break e;case Jx:a=14;break e;case Ro:a=16,n=null;break e}throw Error(je(130,t==null?t:typeof t,""))}return e=Ps(a,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function jl(t,e,r,n){return t=Ps(7,t,n,e),t.lanes=r,t}function Mp(t,e,r,n){return t=Ps(22,t,n,e),t.elementType=PS,t.lanes=r,t.stateNode={isHidden:!1},t}function jg(t,e,r){return t=Ps(6,t,null,e),t.lanes=r,t}function Lg(t,e,r){return e=Ps(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function SN(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yg(0),this.expirationTimes=yg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yg(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function D1(t,e,r,n,i,s,a,o,l){return t=new SN(t,e,r,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Ps(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},m1(s),t}function wN(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Bc,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function AT(t){if(!t)return al;t=t._reactInternals;e:{if(lc(t)!==t||t.tag!==1)throw Error(je(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if($i(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(je(171))}if(t.tag===1){var r=t.type;if($i(r))return Aw(t,r,e)}return e}function CT(t,e,r,n,i,s,a,o,l){return t=D1(r,n,!0,t,i,s,a,o,l),t.context=AT(null),r=t.current,n=Ci(),i=Jo(r),s=Qa(n,i),s.callback=e??null,qo(r,s,i),t.current.lanes=i,Mf(t,i,n),Gi(t,n),t}function Bp(t,e,r,n){var i=e.current,s=Ci(),a=Jo(i);return r=AT(r),e.context===null?e.context=r:e.pendingContext=r,e=Qa(s,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=qo(i,e,a),t!==null&&(sa(t,i,a,s),ch(t,i,a)),a}function Yh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function M2(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function P1(t,e){M2(t,e),(t=t.alternate)&&M2(t,e)}function TN(){return null}var kT=typeof reportError=="function"?reportError:function(t){console.error(t)};function O1(t){this._internalRoot=t}jp.prototype.render=O1.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(je(409));Bp(t,e,null,null)};jp.prototype.unmount=O1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Xl(function(){Bp(null,t,null,null)}),e[no]=null}};function jp(t){this._internalRoot=t}jp.prototype.unstable_scheduleHydration=function(t){if(t){var e=iw();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Po.length&&e!==0&&e<Po[r].priority;r++);Po.splice(r,0,t),r===0&&aw(t)}};function M1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Lp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function B2(){}function AN(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=Yh(a);s.call(u)}}var a=CT(e,n,t,0,null,!1,!1,"",B2);return t._reactRootContainer=a,t[no]=a.current,tf(t.nodeType===8?t.parentNode:t),Xl(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var u=Yh(l);o.call(u)}}var l=D1(t,0,!1,null,null,!1,!1,"",B2);return t._reactRootContainer=l,t[no]=l.current,tf(t.nodeType===8?t.parentNode:t),Xl(function(){Bp(e,l,r,n)}),l}function Up(t,e,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=Yh(a);o.call(l)}}Bp(e,a,t,i)}else a=AN(r,e,t,i,n);return Yh(a)}rw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=md(e.pendingLanes);r!==0&&(t1(e,r|1),Gi(e,on()),!(Xt&6)&&(xu=on()+500,ml()))}break;case 13:Xl(function(){var n=io(t,1);if(n!==null){var i=Ci();sa(n,t,1,i)}}),P1(t,1)}};r1=function(t){if(t.tag===13){var e=io(t,134217728);if(e!==null){var r=Ci();sa(e,t,134217728,r)}P1(t,134217728)}};nw=function(t){if(t.tag===13){var e=Jo(t),r=io(t,e);if(r!==null){var n=Ci();sa(r,t,e,n)}P1(t,e)}};iw=function(){return ur};sw=function(t,e){var r=ur;try{return ur=t,e()}finally{ur=r}};Im=function(t,e,r){switch(e){case"input":if(wm(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=Ip(n);if(!i)throw Error(je(90));MS(n),wm(n,i)}}}break;case"textarea":jS(t,r);break;case"select":e=r.value,e!=null&&Qc(t,!!r.multiple,e,!1)}};$S=b1;GS=Xl;var CN={usingClientEntryPoint:!1,Events:[jf,zc,Ip,WS,HS,b1]},od={findFiberByHostInstance:Rl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},kN={bundleType:od.bundleType,version:od.version,rendererPackageName:od.rendererPackageName,rendererConfig:od.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ho.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=XS(t),t===null?null:t.stateNode},findFiberByHostInstance:od.findFiberByHostInstance||TN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var D0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!D0.isDisabled&&D0.supportsFiber)try{Cp=D0.inject(kN),Ta=D0}catch{}}hs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=CN;hs.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!M1(e))throw Error(je(200));return wN(t,e,null,r)};hs.createRoot=function(t,e){if(!M1(t))throw Error(je(299));var r=!1,n="",i=kT;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=D1(t,1,!1,null,null,r,!1,n,i),t[no]=e.current,tf(t.nodeType===8?t.parentNode:t),new O1(e)};hs.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(je(188)):(t=Object.keys(t).join(","),Error(je(268,t)));return t=XS(e),t=t===null?null:t.stateNode,t};hs.flushSync=function(t){return Xl(t)};hs.hydrate=function(t,e,r){if(!Lp(e))throw Error(je(200));return Up(null,t,e,!0,r)};hs.hydrateRoot=function(t,e,r){if(!M1(t))throw Error(je(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=kT;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=CT(e,null,t,1,r??null,i,!1,s,a),t[no]=e.current,tf(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new jp(e)};hs.render=function(t,e,r){if(!Lp(e))throw Error(je(200));return Up(null,t,e,!1,r)};hs.unmountComponentAtNode=function(t){if(!Lp(t))throw Error(je(40));return t._reactRootContainer?(Xl(function(){Up(null,null,t,!1,function(){t._reactRootContainer=null,t[no]=null})}),!0):!1};hs.unstable_batchedUpdates=b1;hs.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Lp(r))throw Error(je(200));if(t==null||t._reactInternals===void 0)throw Error(je(38));return Up(t,e,r,!1,n)};hs.version="18.3.1-next-f1338f8080-20240426";function FT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(FT)}catch(t){console.error(t)}}FT(),FS.exports=hs;var FN=FS.exports,j2=FN;mm.createRoot=j2.createRoot,mm.hydrateRoot=j2.hydrateRoot;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Xh={};Xh.version="0.18.5";var bT=1252,bN=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],B1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},j1=function(t){bN.indexOf(t)!=-1&&(bT=B1[0]=t)};function IN(){j1(1252)}var ta=function(t){j1(t)};function L1(){ta(1200),IN()}function L2(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function NN(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function IT(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var vd=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?NN(t.slice(2)):e==254&&r==255?IT(t.slice(2)):e==65279?t.slice(1):t},P0=function(e){return String.fromCharCode(e)},U2=function(e){return String.fromCharCode(e)},df,zo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ff(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,u=0;u<t.length;)r=t.charCodeAt(u++),s=r>>2,n=t.charCodeAt(u++),a=(r&3)<<4|n>>4,i=t.charCodeAt(u++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=zo.charAt(s)+zo.charAt(a)+zo.charAt(o)+zo.charAt(l);return e}function fs(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)s=zo.indexOf(t.charAt(u++)),a=zo.indexOf(t.charAt(u++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=zo.indexOf(t.charAt(u++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=zo.indexOf(t.charAt(u++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var It=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),po=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function ol(t){return It?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function V2(t){return It?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var as=function(e){return It?po(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Vp(t){if(typeof ArrayBuffer>"u")return as(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function xl(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function RN(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function U1(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return U1(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Un=It?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:po(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function DN(t){for(var e=[],r=0,n=t.length+250,i=ol(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=ol(65535),n=65530)}return e.push(i.slice(0,r)),Un(e)}var ki=/\u0000/g,yd=/[\u0001-\u0006]/g;function nu(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function ra(t,e){var r=""+t;return r.length>=e?r:Xr("0",e-r.length)+r}function V1(t,e){var r=""+t;return r.length>=e?r:Xr(" ",e-r.length)+r}function qh(t,e){var r=""+t;return r.length>=e?r:r+Xr(" ",e-r.length)}function PN(t,e){var r=""+Math.round(t);return r.length>=e?r:Xr("0",e-r.length)+r}function ON(t,e){var r=""+t;return r.length>=e?r:Xr("0",e-r.length)+r}var z2=Math.pow(2,32);function Fc(t,e){if(t>z2||t<-z2)return PN(t,e);var r=Math.round(t);return ON(r,e)}function Qh(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var W2=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ug=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function MN(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var ut={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},H2={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},BN={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Jh(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,l=1,u=0,f=0,p=Math.floor(i);u<e&&(p=Math.floor(i),o=p*a+s,f=p*u+l,!(i-p<5e-8));)i=1/(i-p),s=a,a=o,l=u,u=f;if(f>e&&(u>e?(f=l,o=s):(f=u,o=a)),!r)return[0,n*o,f];var g=Math.floor(n*o/f);return[g,n*o-g*f,f]}function Ol(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=WN(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var NT=new Date(1899,11,31,0,0,0),jN=NT.getTime(),LN=new Date(1900,2,1,0,0,0);function RT(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=LN&&(r+=24*60*60*1e3),(r-(jN+(t.getTimezoneOffset()-NT.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function z1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function UN(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function VN(t){var e=t<0?12:11,r=z1(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function zN(t){var e=z1(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function hf(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=VN(t):e===10?r=t.toFixed(10).substr(0,12):r=zN(t),z1(UN(r.toUpperCase()))}function ql(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):hf(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Ls(14,RT(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function WN(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function HN(t,e,r,n){var i="",s=0,a=0,o=r.y,l,u=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,u=e.length;break;case 3:return Ug[r.m-1][1];case 5:return Ug[r.m-1][0];default:return Ug[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,u=e.length;break;case 3:return W2[r.q][0];default:return W2[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?ra(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=ra(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:l=o,u=1;break}var f=u>0?ra(l,u):"";return f}function Wo(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var DT=/%/g;function $N(t,e,r){var n=e.replace(DT,""),i=e.length-n.length;return Ja(t,n,r*Math.pow(10,2*i))+Xr("%",i)}function GN(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ja(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function PT(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+PT(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var OT=/# (\?+)( ?)\/( ?)(\d+)/;function KN(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?Xr(" ",t[1].length+1+t[4].length):V1(a,t[1].length)+t[2]+"/"+t[3]+ra(o,t[4].length))}function YN(t,e,r){return r+(e===0?"":""+e)+Xr(" ",t[1].length+2+t[4].length)}var MT=/^#*0*\.([0#]+)/,BT=/\).*[0#]/,jT=/\(###\) ###\\?-####/;function Ti(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function $2(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function G2(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function XN(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function qN(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Cs(t,e,r){if(t.charCodeAt(0)===40&&!e.match(BT)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Cs("n",n,r):"("+Cs("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return GN(t,e,r);if(e.indexOf("%")!==-1)return $N(t,e,r);if(e.indexOf("E")!==-1)return PT(e,r);if(e.charCodeAt(0)===36)return"$"+Cs(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Fc(l,e.length);if(e.match(/^[#?]+$/))return i=Fc(r,0),i==="0"&&(i=""),i.length>e.length?i:Ti(e.substr(0,e.length-i.length))+i;if(s=e.match(OT))return KN(s,l,u);if(e.match(/^#+0+$/))return u+Fc(l,e.length-e.indexOf("0"));if(s=e.match(MT))return i=$2(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Ti(s[1])).replace(/\.$/,"."+Ti(s[1])).replace(/\.(\d*)$/,function(y,x){return"."+x+Xr("0",Ti(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+$2(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Wo(Fc(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Cs(t,e,-r):Wo(""+(Math.floor(r)+XN(r,s[1].length)))+"."+ra(G2(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Cs(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=nu(Cs(t,e.replace(/[\\-]/g,""),r)),a=0,nu(nu(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match(jT))return i=Cs(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Jh(l,Math.pow(10,a)-1,!1),i=""+u,f=Ja("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=qh(o[2],a),f.length<s[4].length&&(f=Ti(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Jh(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?V1(o[1],a)+s[2]+"/"+s[3]+qh(o[2],a):Xr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=Fc(r,0),e.length<=i.length?i:Ti(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var p=e.indexOf(".")-a,g=e.length-i.length-p;return Ti(e.substr(0,p)+i+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=G2(r,s[1].length),r<0?"-"+Cs(t,e,-r):Wo(qN(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?ra(0,3-y.length):"")+y})+"."+ra(a,s[1].length);switch(e){case"###,##0.00":return Cs(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Wo(Fc(l,0));return m!=="0"?u+m:"";case"###,###.00":return Cs(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Cs(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function QN(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ja(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function JN(t,e,r){var n=e.replace(DT,""),i=e.length-n.length;return Ja(t,n,r*Math.pow(10,2*i))+Xr("%",i)}function LT(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+LT(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function va(t,e,r){if(t.charCodeAt(0)===40&&!e.match(BT)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?va("n",n,r):"("+va("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return QN(t,e,r);if(e.indexOf("%")!==-1)return JN(t,e,r);if(e.indexOf("E")!==-1)return LT(e,r);if(e.charCodeAt(0)===36)return"$"+va(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+ra(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:Ti(e.substr(0,e.length-i.length))+i;if(s=e.match(OT))return YN(s,l,u);if(e.match(/^#+0+$/))return u+ra(l,e.length-e.indexOf("0"));if(s=e.match(MT))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Ti(s[1])).replace(/\.$/,"."+Ti(s[1])),i=i.replace(/\.(\d*)$/,function(y,x){return"."+x+Xr("0",Ti(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Wo(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+va(t,e,-r):Wo(""+r)+"."+Xr("0",s[1].length);if(s=e.match(/^#,#*,#0/))return va(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=nu(va(t,e.replace(/[\\-]/g,""),r)),a=0,nu(nu(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match(jT))return i=va(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Jh(l,Math.pow(10,a)-1,!1),i=""+u,f=Ja("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=qh(o[2],a),f.length<s[4].length&&(f=Ti(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Jh(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?V1(o[1],a)+s[2]+"/"+s[3]+qh(o[2],a):Xr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:Ti(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var p=e.indexOf(".")-a,g=e.length-i.length-p;return Ti(e.substr(0,p)+i+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+va(t,e,-r):Wo(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?ra(0,3-y.length):"")+y})+"."+ra(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var m=Wo(""+l);return m!=="0"?u+m:"";default:if(e.match(/\.[0#?]*$/))return va(t,e.slice(0,e.lastIndexOf(".")),r)+Ti(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Ja(t,e,r){return(r|0)===r?va(t,e,r):Cs(t,e,r)}function ZN(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var UT=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Du(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Qh(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(UT))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function eR(t,e,r,n){for(var i=[],s="",a=0,o="",l="t",u,f,p,g="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!Qh(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(p=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(p);i[i.length]={t:"t",v:s},++a;break;case"\\":var m=t.charAt(++a),y=m==="("||m===")"?m:"t";i[i.length]={t:y,v:m},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(u==null&&(u=Ol(e,r,t.charAt(a+1)==="2"),u==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=Ol(e,r),u==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=g),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var x={t:o,v:o};if(u==null&&(u=Ol(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",g="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",a+=5,g="h"):t.substr(a,5).toUpperCase()==="/"?(u!=null&&(x.v=u.H>=12?"":""),x.t="T",a+=5,g="h"):(x.t="t",++a),u==null&&x.t==="T")return"";i[i.length]=x,l=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(UT)){if(u==null&&(u=Ol(e,r),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Du(t)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var S=0,A=0,k;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=g,l="h",S<1&&(S=1);break;case"s":(k=i[a].v.match(/\.0+$/))&&(A=Math.max(A,k[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&i[a].v.match(/[Hh]/)&&(S=1),S<2&&i[a].v.match(/[Mm]/)&&(S=2),S<3&&i[a].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var E="",P;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=HN(i[a].t.charCodeAt(0),i[a].v,u,A),i[a].t="t";break;case"n":case"?":for(P=a+1;i[P]!=null&&((o=i[P].t)==="?"||o==="D"||(o===" "||o==="t")&&i[P+1]!=null&&(i[P+1].t==="?"||i[P+1].t==="t"&&i[P+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[P].v==="/"||i[P].v===" "&&i[P+1]!=null&&i[P+1].t=="?"));)i[a].v+=i[P].v,i[P]={v:"",t:";"},++P;E+=i[a].v,a=P-1;break;case"G":i[a].t="t",i[a].v=ql(e,r);break}var Y="",W,T;if(E.length>0){E.charCodeAt(0)==40?(W=e<0&&E.charCodeAt(0)===45?-e:e,T=Ja("n",E,W)):(W=e<0&&n>1?-e:e,T=Ja("n",E,W),W<0&&i[0]&&i[0].t=="t"&&(T=T.substr(1),i[0].v="-"+i[0].v)),P=T.length-1;var F=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){F=a;break}var w=i.length;if(F===i.length&&T.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(P>=i[a].v.length-1?(P-=i[a].v.length,i[a].v=T.substr(P+1,i[a].v.length)):P<0?i[a].v="":(i[a].v=T.substr(0,P+1),P=-1),i[a].t="t",w=a);P>=0&&w<i.length&&(i[w].v=T.substr(0,P+1)+i[w].v)}else if(F!==i.length&&T.indexOf("E")===-1){for(P=T.indexOf(".")-1,a=F;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(f=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")-1:i[a].v.length-1,Y=i[a].v.substr(f+1);f>=0;--f)P>=0&&(i[a].v.charAt(f)==="0"||i[a].v.charAt(f)==="#")&&(Y=T.charAt(P--)+Y);i[a].v=Y,i[a].t="t",w=a}for(P>=0&&w<i.length&&(i[w].v=T.substr(0,P+1)+i[w].v),P=T.indexOf(".")+1,a=F;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==F)){for(f=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")+1:0,Y=i[a].v.substr(0,f);f<i[a].v.length;++f)P<T.length&&(Y+=T.charAt(P++));i[a].v=Y,i[a].t="t",w=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(W=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Ja(i[a].t,i[a].v,W),i[a].t="t");var I="";for(a=0;a!==i.length;++a)i[a]!=null&&(I+=i[a].v);return I}var K2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Y2(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function tR(t,e){var r=ZN(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(K2),o=r[1].match(K2);return Y2(e,a)?[n,r[0]]:Y2(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function Ls(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ut)[t],n==null&&(n=r.table&&r.table[H2[t]]||ut[H2[t]]),n==null&&(n=BN[t]||"General");break}if(Qh(n,0))return ql(e,r);e instanceof Date&&(e=RT(e,r.date1904));var i=tR(n,e);if(Qh(i[1]))return ql(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return eR(i[1],e,r,i[0])}function Za(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(ut[r]==null){e<0&&(e=r);continue}if(ut[r]==t){e=r;break}}e<0&&(e=391)}return ut[e]=t,e}function zp(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Za(t[e],e)}function Pu(){ut=MN()}var rR={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},VT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function nR(t){var e=typeof t=="number"?ut[t]:t;return e=e.replace(VT,"(\\d+)"),new RegExp("^"+e+"$")}function iR(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(VT)||[]).forEach(function(p,g){var m=parseInt(r[g+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=m;break;case"d":s=m;break;case"h":a=m;break;case"s":l=m;break;case"m":a>=0?o=m:i=m;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?u:n==-1&&i==-1&&s==-1?f:u+"T"+f}var sR=function(){var t={};t.version="1.2.0";function e(){for(var T=0,F=new Array(256),w=0;w!=256;++w)T=w,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,F[w]=T;return typeof Int32Array<"u"?new Int32Array(F):F}var r=e();function n(T){var F=0,w=0,I=0,R=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)R[I]=T[I];for(I=0;I!=256;++I)for(w=T[I],F=256+I;F<4096;F+=256)w=R[F]=w>>>8^T[w&255];var D=[];for(I=1;I!=16;++I)D[I-1]=typeof Int32Array<"u"?R.subarray(I*256,I*256+256):R.slice(I*256,I*256+256);return D}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],u=i[4],f=i[5],p=i[6],g=i[7],m=i[8],y=i[9],x=i[10],S=i[11],A=i[12],k=i[13],E=i[14];function P(T,F){for(var w=F^-1,I=0,R=T.length;I<R;)w=w>>>8^r[(w^T.charCodeAt(I++))&255];return~w}function Y(T,F){for(var w=F^-1,I=T.length-15,R=0;R<I;)w=E[T[R++]^w&255]^k[T[R++]^w>>8&255]^A[T[R++]^w>>16&255]^S[T[R++]^w>>>24]^x[T[R++]]^y[T[R++]]^m[T[R++]]^g[T[R++]]^p[T[R++]]^f[T[R++]]^u[T[R++]]^l[T[R++]]^o[T[R++]]^a[T[R++]]^s[T[R++]]^r[T[R++]];for(I+=15;R<I;)w=w>>>8^r[(w^T[R++])&255];return~w}function W(T,F){for(var w=F^-1,I=0,R=T.length,D=0,N=0;I<R;)D=T.charCodeAt(I++),D<128?w=w>>>8^r[(w^D)&255]:D<2048?(w=w>>>8^r[(w^(192|D>>6&31))&255],w=w>>>8^r[(w^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,N=T.charCodeAt(I++)&1023,w=w>>>8^r[(w^(240|D>>8&7))&255],w=w>>>8^r[(w^(128|D>>2&63))&255],w=w>>>8^r[(w^(128|N>>6&15|(D&3)<<4))&255],w=w>>>8^r[(w^(128|N&63))&255]):(w=w>>>8^r[(w^(224|D>>12&15))&255],w=w>>>8^r[(w^(128|D>>6&63))&255],w=w>>>8^r[(w^(128|D&63))&255]);return~w}return t.table=r,t.bstr=P,t.buf=Y,t.str=W,t}(),it=function(){var e={};e.version="1.2.1";function r(b,K){for(var L=b.split("/"),U=K.split("/"),q=0,Q=0,de=Math.min(L.length,U.length);q<de;++q){if(Q=L[q].length-U[q].length)return Q;if(L[q]!=U[q])return L[q]<U[q]?-1:1}return L.length-U.length}function n(b){if(b.charAt(b.length-1)=="/")return b.slice(0,-1).indexOf("/")===-1?b:n(b.slice(0,-1));var K=b.lastIndexOf("/");return K===-1?b:b.slice(0,K+1)}function i(b){if(b.charAt(b.length-1)=="/")return i(b.slice(0,-1));var K=b.lastIndexOf("/");return K===-1?b:b.slice(K+1)}function s(b,K){typeof K=="string"&&(K=new Date(K));var L=K.getHours();L=L<<6|K.getMinutes(),L=L<<5|K.getSeconds()>>>1,b.write_shift(2,L);var U=K.getFullYear()-1980;U=U<<4|K.getMonth()+1,U=U<<5|K.getDate(),b.write_shift(2,U)}function a(b){var K=b.read_shift(2)&65535,L=b.read_shift(2)&65535,U=new Date,q=L&31;L>>>=5;var Q=L&15;L>>>=4,U.setMilliseconds(0),U.setFullYear(L+1980),U.setMonth(Q-1),U.setDate(q);var de=K&31;K>>>=5;var me=K&63;return K>>>=6,U.setHours(K),U.setMinutes(me),U.setSeconds(de<<1),U}function o(b){Qn(b,0);for(var K={},L=0;b.l<=b.length-4;){var U=b.read_shift(2),q=b.read_shift(2),Q=b.l+q,de={};switch(U){case 21589:L=b.read_shift(1),L&1&&(de.mtime=b.read_shift(4)),q>5&&(L&2&&(de.atime=b.read_shift(4)),L&4&&(de.ctime=b.read_shift(4))),de.mtime&&(de.mt=new Date(de.mtime*1e3));break}b.l=Q,K[U]=de}return K}var l;function u(){return l||(l={})}function f(b,K){if(b[0]==80&&b[1]==75)return zs(b,K);if((b[0]|32)==109&&(b[1]|32)==105)return yn(b,K);if(b.length<512)throw new Error("CFB file size "+b.length+" < 512");var L=3,U=512,q=0,Q=0,de=0,me=0,fe=0,le=[],pe=b.slice(0,512);Qn(pe,0);var we=p(pe);switch(L=we[0],L){case 3:U=512;break;case 4:U=4096;break;case 0:if(we[1]==0)return zs(b,K);default:throw new Error("Major Version: Expected 3 or 4 saw "+L)}U!==512&&(pe=b.slice(0,U),Qn(pe,28));var Ue=b.slice(0,U);g(pe,L);var Ke=pe.read_shift(4,"i");if(L===3&&Ke!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ke);pe.l+=4,de=pe.read_shift(4,"i"),pe.l+=4,pe.chk("00100000","Mini Stream Cutoff Size: "),me=pe.read_shift(4,"i"),q=pe.read_shift(4,"i"),fe=pe.read_shift(4,"i"),Q=pe.read_shift(4,"i");for(var De=-1,qe=0;qe<109&&(De=pe.read_shift(4,"i"),!(De<0));++qe)le[qe]=De;var dt=m(b,U);S(fe,Q,dt,U,le);var Pt=k(dt,de,le,U);Pt[de].name="!Directory",q>0&&me!==N&&(Pt[me].name="!MiniFAT"),Pt[le[0]].name="!FAT",Pt.fat_addrs=le,Pt.ssz=U;var Ut={},wr=[],Oi=[],pr=[];E(de,Pt,dt,wr,q,Ut,Oi,me),y(Oi,pr,wr),wr.shift();var ms={FileIndex:Oi,FullPaths:pr};return K&&K.raw&&(ms.raw={header:Ue,sectors:dt}),ms}function p(b){if(b[b.l]==80&&b[b.l+1]==75)return[0,0];b.chk(Ge,"Header Signature: "),b.l+=16;var K=b.read_shift(2,"u");return[b.read_shift(2,"u"),K]}function g(b,K){var L=9;switch(b.l+=2,L=b.read_shift(2)){case 9:if(K!=3)throw new Error("Sector Shift: Expected 9 saw "+L);break;case 12:if(K!=4)throw new Error("Sector Shift: Expected 12 saw "+L);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+L)}b.chk("0600","Mini Sector Shift: "),b.chk("000000000000","Reserved: ")}function m(b,K){for(var L=Math.ceil(b.length/K)-1,U=[],q=1;q<L;++q)U[q-1]=b.slice(q*K,(q+1)*K);return U[L-1]=b.slice(L*K),U}function y(b,K,L){for(var U=0,q=0,Q=0,de=0,me=0,fe=L.length,le=[],pe=[];U<fe;++U)le[U]=pe[U]=U,K[U]=L[U];for(;me<pe.length;++me)U=pe[me],q=b[U].L,Q=b[U].R,de=b[U].C,le[U]===U&&(q!==-1&&le[q]!==q&&(le[U]=le[q]),Q!==-1&&le[Q]!==Q&&(le[U]=le[Q])),de!==-1&&(le[de]=U),q!==-1&&U!=le[U]&&(le[q]=le[U],pe.lastIndexOf(q)<me&&pe.push(q)),Q!==-1&&U!=le[U]&&(le[Q]=le[U],pe.lastIndexOf(Q)<me&&pe.push(Q));for(U=1;U<fe;++U)le[U]===U&&(Q!==-1&&le[Q]!==Q?le[U]=le[Q]:q!==-1&&le[q]!==q&&(le[U]=le[q]));for(U=1;U<fe;++U)if(b[U].type!==0){if(me=U,me!=le[me])do me=le[me],K[U]=K[me]+"/"+K[U];while(me!==0&&le[me]!==-1&&me!=le[me]);le[U]=-1}for(K[0]+="/",U=1;U<fe;++U)b[U].type!==2&&(K[U]+="/")}function x(b,K,L){for(var U=b.start,q=b.size,Q=[],de=U;L&&q>0&&de>=0;)Q.push(K.slice(de*D,de*D+D)),q-=D,de=Il(L,de*4);return Q.length===0?_e(0):Un(Q).slice(0,b.size)}function S(b,K,L,U,q){var Q=N;if(b===N){if(K!==0)throw new Error("DIFAT chain shorter than expected")}else if(b!==-1){var de=L[b],me=(U>>>2)-1;if(!de)return;for(var fe=0;fe<me&&(Q=Il(de,fe*4))!==N;++fe)q.push(Q);S(Il(de,U-4),K-1,L,U,q)}}function A(b,K,L,U,q){var Q=[],de=[];q||(q=[]);var me=U-1,fe=0,le=0;for(fe=K;fe>=0;){q[fe]=!0,Q[Q.length]=fe,de.push(b[fe]);var pe=L[Math.floor(fe*4/U)];if(le=fe*4&me,U<4+le)throw new Error("FAT boundary crossed: "+fe+" 4 "+U);if(!b[pe])break;fe=Il(b[pe],le)}return{nodes:Q,data:a_([de])}}function k(b,K,L,U){var q=b.length,Q=[],de=[],me=[],fe=[],le=U-1,pe=0,we=0,Ue=0,Ke=0;for(pe=0;pe<q;++pe)if(me=[],Ue=pe+K,Ue>=q&&(Ue-=q),!de[Ue]){fe=[];var De=[];for(we=Ue;we>=0;){De[we]=!0,de[we]=!0,me[me.length]=we,fe.push(b[we]);var qe=L[Math.floor(we*4/U)];if(Ke=we*4&le,U<4+Ke)throw new Error("FAT boundary crossed: "+we+" 4 "+U);if(!b[qe]||(we=Il(b[qe],Ke),De[we]))break}Q[Ue]={nodes:me,data:a_([fe])}}return Q}function E(b,K,L,U,q,Q,de,me){for(var fe=0,le=U.length?2:0,pe=K[b].data,we=0,Ue=0,Ke;we<pe.length;we+=128){var De=pe.slice(we,we+128);Qn(De,64),Ue=De.read_shift(2),Ke=X1(De,0,Ue-le),U.push(Ke);var qe={name:Ke,type:De.read_shift(1),color:De.read_shift(1),L:De.read_shift(4,"i"),R:De.read_shift(4,"i"),C:De.read_shift(4,"i"),clsid:De.read_shift(16),state:De.read_shift(4,"i"),start:0,size:0},dt=De.read_shift(2)+De.read_shift(2)+De.read_shift(2)+De.read_shift(2);dt!==0&&(qe.ct=P(De,De.l-8));var Pt=De.read_shift(2)+De.read_shift(2)+De.read_shift(2)+De.read_shift(2);Pt!==0&&(qe.mt=P(De,De.l-8)),qe.start=De.read_shift(4,"i"),qe.size=De.read_shift(4,"i"),qe.size<0&&qe.start<0&&(qe.size=qe.type=0,qe.start=N,qe.name=""),qe.type===5?(fe=qe.start,q>0&&fe!==N&&(K[fe].name="!StreamData")):qe.size>=4096?(qe.storage="fat",K[qe.start]===void 0&&(K[qe.start]=A(L,qe.start,K.fat_addrs,K.ssz)),K[qe.start].name=qe.name,qe.content=K[qe.start].data.slice(0,qe.size)):(qe.storage="minifat",qe.size<0?qe.size=0:fe!==N&&qe.start!==N&&K[fe]&&(qe.content=x(qe,K[fe].data,(K[me]||{}).data))),qe.content&&Qn(qe.content,0),Q[Ke]=qe,de.push(qe)}}function P(b,K){return new Date((ss(b,K+4)/1e7*Math.pow(2,32)+ss(b,K)/1e7-11644473600)*1e3)}function Y(b,K){return u(),f(l.readFileSync(b),K)}function W(b,K){var L=K&&K.type;switch(L||It&&Buffer.isBuffer(b)&&(L="buffer"),L||"base64"){case"file":return Y(b,K);case"base64":return f(as(fs(b)),K);case"binary":return f(as(b),K)}return f(b,K)}function T(b,K){var L=K||{},U=L.root||"Root Entry";if(b.FullPaths||(b.FullPaths=[]),b.FileIndex||(b.FileIndex=[]),b.FullPaths.length!==b.FileIndex.length)throw new Error("inconsistent CFB structure");b.FullPaths.length===0&&(b.FullPaths[0]=U+"/",b.FileIndex[0]={name:U,type:5}),L.CLSID&&(b.FileIndex[0].clsid=L.CLSID),F(b)}function F(b){var K="Sh33tJ5";if(!it.find(b,"/"+K)){var L=_e(4);L[0]=55,L[1]=L[3]=50,L[2]=54,b.FileIndex.push({name:K,type:2,content:L,size:4,L:69,R:69,C:69}),b.FullPaths.push(b.FullPaths[0]+K),w(b)}}function w(b,K){T(b);for(var L=!1,U=!1,q=b.FullPaths.length-1;q>=0;--q){var Q=b.FileIndex[q];switch(Q.type){case 0:U?L=!0:(b.FileIndex.pop(),b.FullPaths.pop());break;case 1:case 2:case 5:U=!0,isNaN(Q.R*Q.L*Q.C)&&(L=!0),Q.R>-1&&Q.L>-1&&Q.R==Q.L&&(L=!0);break;default:L=!0;break}}if(!(!L&&!K)){var de=new Date(1987,1,19),me=0,fe=Object.create?Object.create(null):{},le=[];for(q=0;q<b.FullPaths.length;++q)fe[b.FullPaths[q]]=!0,b.FileIndex[q].type!==0&&le.push([b.FullPaths[q],b.FileIndex[q]]);for(q=0;q<le.length;++q){var pe=n(le[q][0]);U=fe[pe],U||(le.push([pe,{name:i(pe).replace("/",""),type:1,clsid:Pe,ct:de,mt:de,content:null}]),fe[pe]=!0)}for(le.sort(function(Ke,De){return r(Ke[0],De[0])}),b.FullPaths=[],b.FileIndex=[],q=0;q<le.length;++q)b.FullPaths[q]=le[q][0],b.FileIndex[q]=le[q][1];for(q=0;q<le.length;++q){var we=b.FileIndex[q],Ue=b.FullPaths[q];if(we.name=i(Ue).replace("/",""),we.L=we.R=we.C=-(we.color=1),we.size=we.content?we.content.length:0,we.start=0,we.clsid=we.clsid||Pe,q===0)we.C=le.length>1?1:-1,we.size=0,we.type=5;else if(Ue.slice(-1)=="/"){for(me=q+1;me<le.length&&n(b.FullPaths[me])!=Ue;++me);for(we.C=me>=le.length?-1:me,me=q+1;me<le.length&&n(b.FullPaths[me])!=n(Ue);++me);we.R=me>=le.length?-1:me,we.type=1}else n(b.FullPaths[q+1]||"")==n(Ue)&&(we.R=q+1),we.type=2}}}function I(b,K){var L=K||{};if(L.fileType=="mad")return un(b,L);switch(w(b),L.fileType){case"zip":return hr(b,L)}var U=function(Ke){for(var De=0,qe=0,dt=0;dt<Ke.FileIndex.length;++dt){var Pt=Ke.FileIndex[dt];if(Pt.content){var Ut=Pt.content.length;Ut>0&&(Ut<4096?De+=Ut+63>>6:qe+=Ut+511>>9)}}for(var wr=Ke.FullPaths.length+3>>2,Oi=De+7>>3,pr=De+127>>7,ms=Oi+qe+wr+pr,jr=ms+127>>7,xs=jr<=109?0:Math.ceil((jr-109)/127);ms+jr+xs+127>>7>jr;)xs=++jr<=109?0:Math.ceil((jr-109)/127);var st=[1,xs,jr,pr,wr,qe,De,0];return Ke.FileIndex[0].size=De<<6,st[7]=(Ke.FileIndex[0].start=st[0]+st[1]+st[2]+st[3]+st[4]+st[5])+(st[6]+7>>3),st}(b),q=_e(U[7]<<9),Q=0,de=0;{for(Q=0;Q<8;++Q)q.write_shift(1,Ee[Q]);for(Q=0;Q<8;++Q)q.write_shift(2,0);for(q.write_shift(2,62),q.write_shift(2,3),q.write_shift(2,65534),q.write_shift(2,9),q.write_shift(2,6),Q=0;Q<3;++Q)q.write_shift(2,0);for(q.write_shift(4,0),q.write_shift(4,U[2]),q.write_shift(4,U[0]+U[1]+U[2]+U[3]-1),q.write_shift(4,0),q.write_shift(4,4096),q.write_shift(4,U[3]?U[0]+U[1]+U[2]-1:N),q.write_shift(4,U[3]),q.write_shift(-4,U[1]?U[0]-1:N),q.write_shift(4,U[1]),Q=0;Q<109;++Q)q.write_shift(-4,Q<U[2]?U[1]+Q:-1)}if(U[1])for(de=0;de<U[1];++de){for(;Q<236+de*127;++Q)q.write_shift(-4,Q<U[2]?U[1]+Q:-1);q.write_shift(-4,de===U[1]-1?N:de+1)}var me=function(Ke){for(de+=Ke;Q<de-1;++Q)q.write_shift(-4,Q+1);Ke&&(++Q,q.write_shift(-4,N))};for(de=Q=0,de+=U[1];Q<de;++Q)q.write_shift(-4,Ie.DIFSECT);for(de+=U[2];Q<de;++Q)q.write_shift(-4,Ie.FATSECT);me(U[3]),me(U[4]);for(var fe=0,le=0,pe=b.FileIndex[0];fe<b.FileIndex.length;++fe)pe=b.FileIndex[fe],pe.content&&(le=pe.content.length,!(le<4096)&&(pe.start=de,me(le+511>>9)));for(me(U[6]+7>>3);q.l&511;)q.write_shift(-4,Ie.ENDOFCHAIN);for(de=Q=0,fe=0;fe<b.FileIndex.length;++fe)pe=b.FileIndex[fe],pe.content&&(le=pe.content.length,!(!le||le>=4096)&&(pe.start=de,me(le+63>>6)));for(;q.l&511;)q.write_shift(-4,Ie.ENDOFCHAIN);for(Q=0;Q<U[4]<<2;++Q){var we=b.FullPaths[Q];if(!we||we.length===0){for(fe=0;fe<17;++fe)q.write_shift(4,0);for(fe=0;fe<3;++fe)q.write_shift(4,-1);for(fe=0;fe<12;++fe)q.write_shift(4,0);continue}pe=b.FileIndex[Q],Q===0&&(pe.start=pe.size?pe.start-1:N);var Ue=Q===0&&L.root||pe.name;if(le=2*(Ue.length+1),q.write_shift(64,Ue,"utf16le"),q.write_shift(2,le),q.write_shift(1,pe.type),q.write_shift(1,pe.color),q.write_shift(-4,pe.L),q.write_shift(-4,pe.R),q.write_shift(-4,pe.C),pe.clsid)q.write_shift(16,pe.clsid,"hex");else for(fe=0;fe<4;++fe)q.write_shift(4,0);q.write_shift(4,pe.state||0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,pe.start),q.write_shift(4,pe.size),q.write_shift(4,0)}for(Q=1;Q<b.FileIndex.length;++Q)if(pe=b.FileIndex[Q],pe.size>=4096)if(q.l=pe.start+1<<9,It&&Buffer.isBuffer(pe.content))pe.content.copy(q,q.l,0,pe.size),q.l+=pe.size+511&-512;else{for(fe=0;fe<pe.size;++fe)q.write_shift(1,pe.content[fe]);for(;fe&511;++fe)q.write_shift(1,0)}for(Q=1;Q<b.FileIndex.length;++Q)if(pe=b.FileIndex[Q],pe.size>0&&pe.size<4096)if(It&&Buffer.isBuffer(pe.content))pe.content.copy(q,q.l,0,pe.size),q.l+=pe.size+63&-64;else{for(fe=0;fe<pe.size;++fe)q.write_shift(1,pe.content[fe]);for(;fe&63;++fe)q.write_shift(1,0)}if(It)q.l=q.length;else for(;q.l<q.length;)q.write_shift(1,0);return q}function R(b,K){var L=b.FullPaths.map(function(fe){return fe.toUpperCase()}),U=L.map(function(fe){var le=fe.split("/");return le[le.length-(fe.slice(-1)=="/"?2:1)]}),q=!1;K.charCodeAt(0)===47?(q=!0,K=L[0].slice(0,-1)+K):q=K.indexOf("/")!==-1;var Q=K.toUpperCase(),de=q===!0?L.indexOf(Q):U.indexOf(Q);if(de!==-1)return b.FileIndex[de];var me=!Q.match(yd);for(Q=Q.replace(ki,""),me&&(Q=Q.replace(yd,"!")),de=0;de<L.length;++de)if((me?L[de].replace(yd,"!"):L[de]).replace(ki,"")==Q||(me?U[de].replace(yd,"!"):U[de]).replace(ki,"")==Q)return b.FileIndex[de];return null}var D=64,N=-2,Ge="d0cf11e0a1b11ae1",Ee=[208,207,17,224,161,177,26,225],Pe="00000000000000000000000000000000",Ie={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:N,FREESECT:-1,HEADER_SIGNATURE:Ge,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Pe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ce(b,K,L){u();var U=I(b,L);l.writeFileSync(K,U)}function se(b){for(var K=new Array(b.length),L=0;L<b.length;++L)K[L]=String.fromCharCode(b[L]);return K.join("")}function be(b,K){var L=I(b,K);switch(K&&K.type||"buffer"){case"file":return u(),l.writeFileSync(K.filename,L),L;case"binary":return typeof L=="string"?L:se(L);case"base64":return ff(typeof L=="string"?L:se(L));case"buffer":if(It)return Buffer.isBuffer(L)?L:po(L);case"array":return typeof L=="string"?as(L):L}return L}var Be;function G(b){try{var K=b.InflateRaw,L=new K;if(L._processChunk(new Uint8Array([3,0]),L._finishFlushFlag),L.bytesRead)Be=b;else throw new Error("zlib does not expose bytesRead")}catch(U){console.error("cannot use native zlib: "+(U.message||U))}}function ne(b,K){if(!Be)return Vs(b,K);var L=Be.InflateRaw,U=new L,q=U._processChunk(b.slice(b.l),U._finishFlushFlag);return b.l+=U.bytesRead,q}function ie(b){return Be?Be.deflateRawSync(b):pt(b)}var X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ve=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Le(b){var K=(b<<1|b<<11)&139536|(b<<5|b<<15)&558144;return(K>>16|K>>8|K)&255}for(var Ne=typeof Uint8Array<"u",ke=Ne?new Uint8Array(256):[],rt=0;rt<256;++rt)ke[rt]=Le(rt);function ee(b,K){var L=ke[b&255];return K<=8?L>>>8-K:(L=L<<8|ke[b>>8&255],K<=16?L>>>16-K:(L=L<<8|ke[b>>16&255],L>>>24-K))}function Dt(b,K){var L=K&7,U=K>>>3;return(b[U]|(L<=6?0:b[U+1]<<8))>>>L&3}function Et(b,K){var L=K&7,U=K>>>3;return(b[U]|(L<=5?0:b[U+1]<<8))>>>L&7}function Nt(b,K){var L=K&7,U=K>>>3;return(b[U]|(L<=4?0:b[U+1]<<8))>>>L&15}function xt(b,K){var L=K&7,U=K>>>3;return(b[U]|(L<=3?0:b[U+1]<<8))>>>L&31}function He(b,K){var L=K&7,U=K>>>3;return(b[U]|(L<=1?0:b[U+1]<<8))>>>L&127}function fr(b,K,L){var U=K&7,q=K>>>3,Q=(1<<L)-1,de=b[q]>>>U;return L<8-U||(de|=b[q+1]<<8-U,L<16-U)||(de|=b[q+2]<<16-U,L<24-U)||(de|=b[q+3]<<24-U),de&Q}function Wn(b,K,L){var U=K&7,q=K>>>3;return U<=5?b[q]|=(L&7)<<U:(b[q]|=L<<U&255,b[q+1]=(L&7)>>8-U),K+3}function Zr(b,K,L){var U=K&7,q=K>>>3;return L=(L&1)<<U,b[q]|=L,K+1}function Ii(b,K,L){var U=K&7,q=K>>>3;return L<<=U,b[q]|=L&255,L>>>=8,b[q+1]=L,K+8}function Xi(b,K,L){var U=K&7,q=K>>>3;return L<<=U,b[q]|=L&255,L>>>=8,b[q+1]=L&255,b[q+2]=L>>>8,K+16}function Ni(b,K){var L=b.length,U=2*L>K?2*L:K+5,q=0;if(L>=K)return b;if(It){var Q=V2(U);if(b.copy)b.copy(Q);else for(;q<b.length;++q)Q[q]=b[q];return Q}else if(Ne){var de=new Uint8Array(U);if(de.set)de.set(b);else for(;q<L;++q)de[q]=b[q];return de}return b.length=U,b}function en(b){for(var K=new Array(b),L=0;L<b;++L)K[L]=0;return K}function Ri(b,K,L){var U=1,q=0,Q=0,de=0,me=0,fe=b.length,le=Ne?new Uint16Array(32):en(32);for(Q=0;Q<32;++Q)le[Q]=0;for(Q=fe;Q<L;++Q)b[Q]=0;fe=b.length;var pe=Ne?new Uint16Array(fe):en(fe);for(Q=0;Q<fe;++Q)le[q=b[Q]]++,U<q&&(U=q),pe[Q]=0;for(le[0]=0,Q=1;Q<=U;++Q)le[Q+16]=me=me+le[Q-1]<<1;for(Q=0;Q<fe;++Q)me=b[Q],me!=0&&(pe[Q]=le[me+16]++);var we=0;for(Q=0;Q<fe;++Q)if(we=b[Q],we!=0)for(me=ee(pe[Q],U)>>U-we,de=(1<<U+4-we)-1;de>=0;--de)K[me|de<<we]=we&15|Q<<4;return U}var nr=Ne?new Uint16Array(512):en(512),Br=Ne?new Uint16Array(32):en(32);if(!Ne){for(var Ar=0;Ar<512;++Ar)nr[Ar]=0;for(Ar=0;Ar<32;++Ar)Br[Ar]=0}(function(){for(var b=[],K=0;K<32;K++)b.push(5);Ri(b,Br,32);var L=[];for(K=0;K<=143;K++)L.push(8);for(;K<=255;K++)L.push(9);for(;K<=279;K++)L.push(7);for(;K<=287;K++)L.push(8);Ri(L,nr,288)})();var _i=function(){for(var K=Ne?new Uint8Array(32768):[],L=0,U=0;L<Se.length-1;++L)for(;U<Se[L+1];++U)K[U]=L;for(;U<32768;++U)K[U]=29;var q=Ne?new Uint8Array(259):[];for(L=0,U=0;L<ve.length-1;++L)for(;U<ve[L+1];++U)q[U]=L;function Q(me,fe){for(var le=0;le<me.length;){var pe=Math.min(65535,me.length-le),we=le+pe==me.length;for(fe.write_shift(1,+we),fe.write_shift(2,pe),fe.write_shift(2,~pe&65535);pe-- >0;)fe[fe.l++]=me[le++]}return fe.l}function de(me,fe){for(var le=0,pe=0,we=Ne?new Uint16Array(32768):[];pe<me.length;){var Ue=Math.min(65535,me.length-pe);if(Ue<10){for(le=Wn(fe,le,+(pe+Ue==me.length)),le&7&&(le+=8-(le&7)),fe.l=le/8|0,fe.write_shift(2,Ue),fe.write_shift(2,~Ue&65535);Ue-- >0;)fe[fe.l++]=me[pe++];le=fe.l*8;continue}le=Wn(fe,le,+(pe+Ue==me.length)+2);for(var Ke=0;Ue-- >0;){var De=me[pe];Ke=(Ke<<5^De)&32767;var qe=-1,dt=0;if((qe=we[Ke])&&(qe|=pe&-32768,qe>pe&&(qe-=32768),qe<pe))for(;me[qe+dt]==me[pe+dt]&&dt<250;)++dt;if(dt>2){De=q[dt],De<=22?le=Ii(fe,le,ke[De+1]>>1)-1:(Ii(fe,le,3),le+=5,Ii(fe,le,ke[De-23]>>5),le+=3);var Pt=De<8?0:De-4>>2;Pt>0&&(Xi(fe,le,dt-ve[De]),le+=Pt),De=K[pe-qe],le=Ii(fe,le,ke[De]>>3),le-=3;var Ut=De<4?0:De-2>>1;Ut>0&&(Xi(fe,le,pe-qe-Se[De]),le+=Ut);for(var wr=0;wr<dt;++wr)we[Ke]=pe&32767,Ke=(Ke<<5^me[pe])&32767,++pe;Ue-=dt-1}else De<=143?De=De+48:le=Zr(fe,le,1),le=Ii(fe,le,ke[De]),we[Ke]=pe&32767,++pe}le=Ii(fe,le,0)-1}return fe.l=(le+7)/8|0,fe.l}return function(fe,le){return fe.length<8?Q(fe,le):de(fe,le)}}();function pt(b){var K=_e(50+Math.floor(b.length*1.1)),L=_i(b,K);return K.slice(0,L)}var Cr=Ne?new Uint16Array(32768):en(32768),Sr=Ne?new Uint16Array(32768):en(32768),Dr=Ne?new Uint16Array(128):en(128),Ei=1,vo=1;function Pa(b,K){var L=xt(b,K)+257;K+=5;var U=xt(b,K)+1;K+=5;var q=Nt(b,K)+4;K+=4;for(var Q=0,de=Ne?new Uint8Array(19):en(19),me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],fe=1,le=Ne?new Uint8Array(8):en(8),pe=Ne?new Uint8Array(8):en(8),we=de.length,Ue=0;Ue<q;++Ue)de[X[Ue]]=Q=Et(b,K),fe<Q&&(fe=Q),le[Q]++,K+=3;var Ke=0;for(le[0]=0,Ue=1;Ue<=fe;++Ue)pe[Ue]=Ke=Ke+le[Ue-1]<<1;for(Ue=0;Ue<we;++Ue)(Ke=de[Ue])!=0&&(me[Ue]=pe[Ke]++);var De=0;for(Ue=0;Ue<we;++Ue)if(De=de[Ue],De!=0){Ke=ke[me[Ue]]>>8-De;for(var qe=(1<<7-De)-1;qe>=0;--qe)Dr[Ke|qe<<De]=De&7|Ue<<3}var dt=[];for(fe=1;dt.length<L+U;)switch(Ke=Dr[He(b,K)],K+=Ke&7,Ke>>>=3){case 16:for(Q=3+Dt(b,K),K+=2,Ke=dt[dt.length-1];Q-- >0;)dt.push(Ke);break;case 17:for(Q=3+Et(b,K),K+=3;Q-- >0;)dt.push(0);break;case 18:for(Q=11+He(b,K),K+=7;Q-- >0;)dt.push(0);break;default:dt.push(Ke),fe<Ke&&(fe=Ke);break}var Pt=dt.slice(0,L),Ut=dt.slice(L);for(Ue=L;Ue<286;++Ue)Pt[Ue]=0;for(Ue=U;Ue<30;++Ue)Ut[Ue]=0;return Ei=Ri(Pt,Cr,286),vo=Ri(Ut,Sr,30),K}function Wu(b,K){if(b[0]==3&&!(b[1]&3))return[ol(K),2];for(var L=0,U=0,q=V2(K||1<<18),Q=0,de=q.length>>>0,me=0,fe=0;!(U&1);){if(U=Et(b,L),L+=3,U>>>1)U>>1==1?(me=9,fe=5):(L=Pa(b,L),me=Ei,fe=vo);else{L&7&&(L+=8-(L&7));var le=b[L>>>3]|b[(L>>>3)+1]<<8;if(L+=32,le>0)for(!K&&de<Q+le&&(q=Ni(q,Q+le),de=q.length);le-- >0;)q[Q++]=b[L>>>3],L+=8;continue}for(;;){!K&&de<Q+32767&&(q=Ni(q,Q+32767),de=q.length);var pe=fr(b,L,me),we=U>>>1==1?nr[pe]:Cr[pe];if(L+=we&15,we>>>=4,!(we>>>8&255))q[Q++]=we;else{if(we==256)break;we-=257;var Ue=we<8?0:we-4>>2;Ue>5&&(Ue=0);var Ke=Q+ve[we];Ue>0&&(Ke+=fr(b,L,Ue),L+=Ue),pe=fr(b,L,fe),we=U>>>1==1?Br[pe]:Sr[pe],L+=we&15,we>>>=4;var De=we<4?0:we-2>>1,qe=Se[we];for(De>0&&(qe+=fr(b,L,De),L+=De),!K&&de<Ke&&(q=Ni(q,Ke+100),de=q.length);Q<Ke;)q[Q]=q[Q-qe],++Q}}}return K?[q,L+7>>>3]:[q.slice(0,Q),L+7>>>3]}function Vs(b,K){var L=b.slice(b.l||0),U=Wu(L,K);return b.l+=U[1],U[0]}function _l(b,K){if(b)typeof console<"u"&&console.error(K);else throw new Error(K)}function zs(b,K){var L=b;Qn(L,0);var U=[],q=[],Q={FileIndex:U,FullPaths:q};T(Q,{root:K.root});for(var de=L.length-4;(L[de]!=80||L[de+1]!=75||L[de+2]!=5||L[de+3]!=6)&&de>=0;)--de;L.l=de+4,L.l+=4;var me=L.read_shift(2);L.l+=6;var fe=L.read_shift(4);for(L.l=fe,de=0;de<me;++de){L.l+=20;var le=L.read_shift(4),pe=L.read_shift(4),we=L.read_shift(2),Ue=L.read_shift(2),Ke=L.read_shift(2);L.l+=8;var De=L.read_shift(4),qe=o(L.slice(L.l+we,L.l+we+Ue));L.l+=we+Ue+Ke;var dt=L.l;L.l=De+4,ce(L,le,pe,Q,qe),L.l=dt}return Q}function ce(b,K,L,U,q){b.l+=2;var Q=b.read_shift(2),de=b.read_shift(2),me=a(b);if(Q&8257)throw new Error("Unsupported ZIP encryption");for(var fe=b.read_shift(4),le=b.read_shift(4),pe=b.read_shift(4),we=b.read_shift(2),Ue=b.read_shift(2),Ke="",De=0;De<we;++De)Ke+=String.fromCharCode(b[b.l++]);if(Ue){var qe=o(b.slice(b.l,b.l+Ue));(qe[21589]||{}).mt&&(me=qe[21589].mt),((q||{})[21589]||{}).mt&&(me=q[21589].mt)}b.l+=Ue;var dt=b.slice(b.l,b.l+le);switch(de){case 8:dt=ne(b,pe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+de)}var Pt=!1;Q&8&&(fe=b.read_shift(4),fe==134695760&&(fe=b.read_shift(4),Pt=!0),le=b.read_shift(4),pe=b.read_shift(4)),le!=K&&_l(Pt,"Bad compressed size: "+K+" != "+le),pe!=L&&_l(Pt,"Bad uncompressed size: "+L+" != "+pe),Hs(U,Ke,dt,{unsafe:!0,mt:me})}function hr(b,K){var L=K||{},U=[],q=[],Q=_e(1),de=L.compression?8:0,me=0,fe=0,le=0,pe=0,we=0,Ue=b.FullPaths[0],Ke=Ue,De=b.FileIndex[0],qe=[],dt=0;for(fe=1;fe<b.FullPaths.length;++fe)if(Ke=b.FullPaths[fe].slice(Ue.length),De=b.FileIndex[fe],!(!De.size||!De.content||Ke=="Sh33tJ5")){var Pt=pe,Ut=_e(Ke.length);for(le=0;le<Ke.length;++le)Ut.write_shift(1,Ke.charCodeAt(le)&127);Ut=Ut.slice(0,Ut.l),qe[we]=sR.buf(De.content,0);var wr=De.content;de==8&&(wr=ie(wr)),Q=_e(30),Q.write_shift(4,67324752),Q.write_shift(2,20),Q.write_shift(2,me),Q.write_shift(2,de),De.mt?s(Q,De.mt):Q.write_shift(4,0),Q.write_shift(-4,qe[we]),Q.write_shift(4,wr.length),Q.write_shift(4,De.content.length),Q.write_shift(2,Ut.length),Q.write_shift(2,0),pe+=Q.length,U.push(Q),pe+=Ut.length,U.push(Ut),pe+=wr.length,U.push(wr),Q=_e(46),Q.write_shift(4,33639248),Q.write_shift(2,0),Q.write_shift(2,20),Q.write_shift(2,me),Q.write_shift(2,de),Q.write_shift(4,0),Q.write_shift(-4,qe[we]),Q.write_shift(4,wr.length),Q.write_shift(4,De.content.length),Q.write_shift(2,Ut.length),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(4,0),Q.write_shift(4,Pt),dt+=Q.l,q.push(Q),dt+=Ut.length,q.push(Ut),++we}return Q=_e(22),Q.write_shift(4,101010256),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,we),Q.write_shift(2,we),Q.write_shift(4,dt),Q.write_shift(4,pe),Q.write_shift(2,0),Un([Un(U),Un(q),Q])}var Di={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function gs(b,K){if(b.ctype)return b.ctype;var L=b.name||"",U=L.match(/\.([^\.]+)$/);return U&&Di[U[1]]||K&&(U=(L=K).match(/[\.\\]([^\.\\])+$/),U&&Di[U[1]])?Di[U[1]]:"application/octet-stream"}function Oa(b){for(var K=ff(b),L=[],U=0;U<K.length;U+=76)L.push(K.slice(U,U+76));return L.join(`\r
`)+`\r
`}function Ws(b){var K=b.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(le){var pe=le.charCodeAt(0).toString(16).toUpperCase();return"="+(pe.length==1?"0"+pe:pe)});K=K.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),K.charAt(0)==`
`&&(K="=0D"+K.slice(1)),K=K.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var L=[],U=K.split(`\r
`),q=0;q<U.length;++q){var Q=U[q];if(Q.length==0){L.push("");continue}for(var de=0;de<Q.length;){var me=76,fe=Q.slice(de,de+me);fe.charAt(me-1)=="="?me--:fe.charAt(me-2)=="="?me-=2:fe.charAt(me-3)=="="&&(me-=3),fe=Q.slice(de,de+me),de+=me,de<Q.length&&(fe+="="),L.push(fe)}}return L.join(`\r
`)}function ua(b){for(var K=[],L=0;L<b.length;++L){for(var U=b[L];L<=b.length&&U.charAt(U.length-1)=="=";)U=U.slice(0,U.length-1)+b[++L];K.push(U)}for(var q=0;q<K.length;++q)K[q]=K[q].replace(/[=][0-9A-Fa-f]{2}/g,function(Q){return String.fromCharCode(parseInt(Q.slice(1),16))});return as(K.join(`\r
`))}function Pi(b,K,L){for(var U="",q="",Q="",de,me=0;me<10;++me){var fe=K[me];if(!fe||fe.match(/^\s*$/))break;var le=fe.match(/^(.*?):\s*([^\s].*)$/);if(le)switch(le[1].toLowerCase()){case"content-location":U=le[2].trim();break;case"content-type":Q=le[2].trim();break;case"content-transfer-encoding":q=le[2].trim();break}}switch(++me,q.toLowerCase()){case"base64":de=as(fs(K.slice(me).join("")));break;case"quoted-printable":de=ua(K.slice(me));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+q)}var pe=Hs(b,U.slice(L.length),de,{unsafe:!0});Q&&(pe.ctype=Q)}function yn(b,K){if(se(b.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var L=K&&K.root||"",U=(It&&Buffer.isBuffer(b)?b.toString("binary"):se(b)).split(`\r
`),q=0,Q="";for(q=0;q<U.length;++q)if(Q=U[q],!!/^Content-Location:/i.test(Q)&&(Q=Q.slice(Q.indexOf("file")),L||(L=Q.slice(0,Q.lastIndexOf("/")+1)),Q.slice(0,L.length)!=L))for(;L.length>0&&(L=L.slice(0,L.length-1),L=L.slice(0,L.lastIndexOf("/")+1),Q.slice(0,L.length)!=L););var de=(U[1]||"").match(/boundary="(.*?)"/);if(!de)throw new Error("MAD cannot find boundary");var me="--"+(de[1]||""),fe=[],le=[],pe={FileIndex:fe,FullPaths:le};T(pe);var we,Ue=0;for(q=0;q<U.length;++q){var Ke=U[q];Ke!==me&&Ke!==me+"--"||(Ue++&&Pi(pe,U.slice(we,q),L),we=q)}return pe}function un(b,K){var L=K||{},U=L.boundary||"SheetJS";U="------="+U;for(var q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+U.slice(2)+'"',"","",""],Q=b.FullPaths[0],de=Q,me=b.FileIndex[0],fe=1;fe<b.FullPaths.length;++fe)if(de=b.FullPaths[fe].slice(Q.length),me=b.FileIndex[fe],!(!me.size||!me.content||de=="Sh33tJ5")){de=de.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(dt){return"_x"+dt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(dt){return"_u"+dt.charCodeAt(0).toString(16)+"_"});for(var le=me.content,pe=It&&Buffer.isBuffer(le)?le.toString("binary"):se(le),we=0,Ue=Math.min(1024,pe.length),Ke=0,De=0;De<=Ue;++De)(Ke=pe.charCodeAt(De))>=32&&Ke<128&&++we;var qe=we>=Ue*4/5;q.push(U),q.push("Content-Location: "+(L.root||"file:///C:/SheetJS/")+de),q.push("Content-Transfer-Encoding: "+(qe?"quoted-printable":"base64")),q.push("Content-Type: "+gs(me,de)),q.push(""),q.push(qe?Ws(pe):Oa(pe))}return q.push(U+`--\r
`),q.join(`\r
`)}function Ma(b){var K={};return T(K,b),K}function Hs(b,K,L,U){var q=U&&U.unsafe;q||T(b);var Q=!q&&it.find(b,K);if(!Q){var de=b.FullPaths[0];K.slice(0,de.length)==de?de=K:(de.slice(-1)!="/"&&(de+="/"),de=(de+K).replace("//","/")),Q={name:i(K),type:2},b.FileIndex.push(Q),b.FullPaths.push(de),q||it.utils.cfb_gc(b)}return Q.content=L,Q.size=L?L.length:0,U&&(U.CLSID&&(Q.clsid=U.CLSID),U.mt&&(Q.mt=U.mt),U.ct&&(Q.ct=U.ct)),Q}function _n(b,K){T(b);var L=it.find(b,K);if(L){for(var U=0;U<b.FileIndex.length;++U)if(b.FileIndex[U]==L)return b.FileIndex.splice(U,1),b.FullPaths.splice(U,1),!0}return!1}function xc(b,K,L){T(b);var U=it.find(b,K);if(U){for(var q=0;q<b.FileIndex.length;++q)if(b.FileIndex[q]==U)return b.FileIndex[q].name=i(L),b.FullPaths[q]=L,!0}return!1}function qi(b){w(b,!0)}return e.find=R,e.read=W,e.parse=f,e.write=be,e.writeFile=Ce,e.utils={cfb_new:Ma,cfb_add:Hs,cfb_del:_n,cfb_mov:xc,cfb_gc:qi,ReadShift:Pd,CheckField:cA,prep_blob:Qn,bconcat:Un,use_zlib:G,_deflateRaw:pt,_inflateRaw:Vs,consts:Ie},e}();function aR(t){return typeof t=="string"?Vp(t):Array.isArray(t)?RN(t):t}function Uf(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Vp(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?wa(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([aR(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=xl(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function oR(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Jr(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function X2(t,e){for(var r=[],n=Jr(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function Wp(t){for(var e=[],r=Jr(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Hp(t){for(var e=[],r=Jr(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function lR(t){for(var e=[],r=Jr(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Zh=new Date(1899,11,30,0,0,0);function Nn(t,e){var r=t.getTime(),n=Zh.getTime()+(t.getTimezoneOffset()-Zh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var zT=new Date,cR=Zh.getTime()+(zT.getTimezoneOffset()-Zh.getTimezoneOffset())*6e4,q2=zT.getTimezoneOffset();function $p(t){var e=new Date;return e.setTime(t*24*60*60*1e3+cR),e.getTimezoneOffset()!==q2&&e.setTime(e.getTime()+(e.getTimezoneOffset()-q2)*6e4),e}function uR(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[s],10)}return e}var Q2=new Date("2017-02-19T19:06:09.000Z"),WT=isNaN(Q2.getFullYear())?new Date("2/19/17"):Q2,dR=WT.getFullYear()==2017;function Nr(t,e){var r=new Date(t);if(dR)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(WT.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Ql(t,e){if(It&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return wa(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return wa(IT(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return wa(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return wa(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function Rr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Rr(t[r]));return e}function Xr(t,e){for(var r="";r.length<e;)r+=t;return r}function aa(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var fR=["january","february","march","april","may","june","july","august","september","october","november","december"];function vu(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&fR.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var hR=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function HT(t){return t?t.content&&t.type?Ql(t.content,!0):t.data?vd(t.data):t.asNodeBuffer&&It?vd(t.asNodeBuffer().toString("binary")):t.asBinary?vd(t.asBinary()):t._data&&t._data.getContent?vd(Ql(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function $T(t){if(!t)return null;if(t.data)return L2(t.data);if(t.asNodeBuffer&&It)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?L2(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function pR(t){return t&&t.name.slice(-4)===".bin"?$T(t):HT(t)}function bs(t,e){for(var r=t.FullPaths||Jr(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function W1(t,e){var r=bs(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function mn(t,e,r){if(!r)return pR(W1(t,e));if(!e)return null;try{return mn(t,e)}catch{return null}}function os(t,e,r){if(!r)return HT(W1(t,e));if(!e)return null;try{return os(t,e)}catch{return null}}function gR(t,e,r){return $T(W1(t,e))}function J2(t){for(var e=t.FullPaths||Jr(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function At(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return It?n=po(r):n=DN(r),it.utils.cfb_add(t,e,n)}it.utils.cfb_add(t,e,r)}else t.file(e,r)}function H1(){return it.utils.cfb_new()}function GT(t,e){switch(e.type){case"base64":return it.read(t,{type:"base64"});case"binary":return it.read(t,{type:"binary"});case"buffer":case"array":return it.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function _d(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var cn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,mR=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Z2=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,xR=/<[^>]*>/g,yi=cn.match(Z2)?Z2:xR,vR=/<\w*:/,yR=/<(\/?)\w+:/;function ht(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var a=t.match(mR),o=0,l="",u=0,f="",p="",g=1;if(a)for(u=0;u!=a.length;++u){for(p=a[u],s=0;s!=p.length&&p.charCodeAt(s)!==61;++s);for(f=p.slice(0,s).trim();p.charCodeAt(s+1)==32;)++s;for(g=(i=p.charCodeAt(s+1))==34||i==39?1:0,l=p.slice(s+1+g,p.length-g),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,n[f.toLowerCase()]=l;else{var m=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[m]&&f.slice(o-3,o)=="ext")continue;n[m]=l,n[m.toLowerCase()]=l}}return n}function Ra(t){return t.replace(yR,"<$1")}var KT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},$1=Wp(KT),qt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(o,l){return KT[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),G1=/[&<>'"]/g,_R=/[\u0000-\u0008\u000b-\u001f]/g;function cr(t){var e=t+"";return e.replace(G1,function(r){return $1[r]}).replace(_R,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function e_(t){return cr(t).replace(/ /g,"_x0020_")}var YT=/[\u0000-\u001f]/g;function K1(t){var e=t+"";return e.replace(G1,function(r){return $1[r]}).replace(/\n/g,"<br/>").replace(YT,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function ER(t){var e=t+"";return e.replace(G1,function(r){return $1[r]}).replace(YT,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var t_=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function SR(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function br(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Vg(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function r_(t){var e=ol(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function n_(t){return po(t,"binary").toString("utf8")}var O0="foo bar baz",vr=It&&(n_(O0)==Vg(O0)&&n_||r_(O0)==Vg(O0)&&r_)||Vg,wa=It?function(t){return po(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},pf=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),XT=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),wR=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),TR=/<\/?(?:vt:)?variant>/g,AR=/<(?:vt:)([^>]*)>([\s\S]*)</;function i_(t,e){var r=ht(t),n=t.match(wR(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(TR,"").match(AR);a&&i.push({v:vr(a[2]),t:a[1]})}),i}var qT=/(^\s|\s$|\n)/;function Jn(t,e){return"<"+t+(e.match(qT)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function gf(t){return Jr(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Ve(t,e,r){return"<"+t+(r!=null?gf(r):"")+(e!=null?(e.match(qT)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function cx(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function CR(t,e){switch(typeof t){case"string":var r=Ve("vt:lpwstr",cr(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ve((t|0)==t?"vt:i4":"vt:r8",cr(String(t)));case"boolean":return Ve("vt:bool",t?"true":"false")}if(t instanceof Date)return Ve("vt:filetime",cx(t));throw new Error("Unable to serialize "+t)}function Y1(t){if(It&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return vr(xl(U1(t)));throw new Error("Bad input format: expected Buffer or string")}var mf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,kn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},cc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],is={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function kR(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function FR(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var s_=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},a_=It?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:po(e)})):s_(t)}:s_,o_=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Ka(t,i)));return n.join("").replace(ki,"")},X1=It?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(ki,""):o_(t,e,r)}:o_,l_=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},QT=It?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):l_(t,e,r)}:l_,c_=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(Dc(t,i)));return n.join("")},Vf=It?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):c_(e,r,n)}:c_,JT=function(t,e){var r=ss(t,e);return r>0?Vf(t,e+4,e+4+r-1):""},ZT=JT,eA=function(t,e){var r=ss(t,e);return r>0?Vf(t,e+4,e+4+r-1):""},tA=eA,rA=function(t,e){var r=2*ss(t,e);return r>0?Vf(t,e+4,e+4+r-1):""},nA=rA,iA=function(e,r){var n=ss(e,r);return n>0?X1(e,r+4,r+4+n):""},sA=iA,aA=function(t,e){var r=ss(t,e);return r>0?Vf(t,e+4,e+4+r):""},oA=aA,lA=function(t,e){return kR(t,e)},ep=lA,q1=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};It&&(ZT=function(e,r){if(!Buffer.isBuffer(e))return JT(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},tA=function(e,r){if(!Buffer.isBuffer(e))return eA(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},nA=function(e,r){if(!Buffer.isBuffer(e))return rA(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},sA=function(e,r){if(!Buffer.isBuffer(e))return iA(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},oA=function(e,r){if(!Buffer.isBuffer(e))return aA(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},ep=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):lA(e,r)},q1=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Dc=function(t,e){return t[e]},Ka=function(t,e){return t[e+1]*256+t[e]},bR=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},ss=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Il=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},IR=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Pd(t,e){var r="",n,i,s=[],a,o,l,u;switch(e){case"dbcs":if(u=this.l,It&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(Ka(this,u)),u+=2;t*=2;break;case"utf8":r=Vf(this,this.l,this.l+t);break;case"utf16le":t*=2,r=X1(this,this.l,this.l+t);break;case"wstr":return Pd.call(this,t,"dbcs");case"lpstr-ansi":r=ZT(this,this.l),t=4+ss(this,this.l);break;case"lpstr-cp":r=tA(this,this.l),t=4+ss(this,this.l);break;case"lpwstr":r=nA(this,this.l),t=4+2*ss(this,this.l);break;case"lpp4":t=4+ss(this,this.l),r=sA(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+ss(this,this.l),r=oA(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=Dc(this,this.l+t++))!==0;)s.push(P0(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=Ka(this,this.l+t))!==0;)s.push(P0(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Dc(this,u),this.l=u+1,o=Pd.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(P0(Ka(this,u))),u+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Dc(this,u),this.l=u+1,o=Pd.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(P0(Dc(this,u))),u+=1}r=s.join("");break;default:switch(t){case 1:return n=Dc(this,this.l),this.l++,n;case 2:return n=(e==="i"?bR:Ka)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Il:IR)(this,this.l),this.l+=4,n):(i=ss(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=ep(this,this.l):i=ep([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=QT(this,this.l,t);break}}return this.l+=t,r}var NR=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},RR=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},DR=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function PR(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)DR(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,NR(this,e,this.l);break;case 8:if(n=8,r==="f"){FR(this,e,this.l);break}case 16:break;case-4:n=4,RR(this,e,this.l);break}return this.l+=n,this}function cA(t,e){var r=QT(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Qn(t,e){t.l=e,t.read_shift=Pd,t.chk=cA,t.write_shift=PR}function xi(t,e){t.l+=e}function _e(t){var e=ol(t);return Qn(e,0),e}function go(t,e,r){if(t){var n,i,s;Qn(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var u=Sf[o]||Sf[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;l=t.l+s;var f=u.f&&u.f(t,s,r);if(t.l=l,e(f,u,o))return}}}function Ki(){var t=[],e=It?256:2048,r=function(u){var f=_e(u);return Qn(f,0),f},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,e)))},a=function(){return i(),Un(t)},o=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function Fe(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=Sf[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&q1(r)&&t.push(r)}}function Od(t,e,r){var n=Rr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function u_(t,e,r){var n=Rr(t);return n.s=Od(n.s,e.s,r),n.e=Od(n.e,e.s,r),n}function Md(t,e){if(t.cRel&&t.c<0)for(t=Rr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Rr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=ft(t);return!t.cRel&&t.cRel!=null&&(r=BR(r)),!t.rRel&&t.rRel!=null&&(r=OR(r)),r}function zg(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+zr(t.s.c)+":"+(t.e.cRel?"":"$")+zr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+ln(t.s.r)+":"+(t.e.rRel?"":"$")+ln(t.e.r):Md(t.s,e.biff)+":"+Md(t.e,e.biff)}function Q1(t){return parseInt(MR(t),10)-1}function ln(t){return""+(t+1)}function OR(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function MR(t){return t.replace(/\$(\d+)$/,"$1")}function J1(t){for(var e=jR(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function zr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function BR(t){return t.replace(/^([A-Z])/,"$$$1")}function jR(t){return t.replace(/^\$([A-Z])/,"$1")}function LR(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Wr(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function ft(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Yi(t){var e=t.indexOf(":");return e==-1?{s:Wr(t),e:Wr(t)}:{s:Wr(t.slice(0,e)),e:Wr(t.slice(e+1))}}function Tt(t,e){return typeof e>"u"||typeof e=="number"?Tt(t.s,t.e):(typeof t!="string"&&(t=ft(t)),typeof e!="string"&&(e=ft(e)),t==e?t:t+":"+e)}function Qt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function d_(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Ls(t.z,r?Nn(e):e)}catch{}try{return t.w=Ls((t.XF||{}).numFmtId||(r?14:0),r?Nn(e):e)}catch{return""+e}}function ao(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?mo[t.v]||t.v:e==null?d_(t,t.v):d_(t,e))}function vl(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function uA(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Wr(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=Qt(s["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),a==-1&&(u.e.r=a=f.e.r+1)}for(var p=0;p!=e.length;++p)if(e[p]){if(!Array.isArray(e[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=e[p].length;++g)if(!(typeof e[p][g]>"u")){var m={v:e[p][g]},y=a+p,x=o+g;if(u.s.r>y&&(u.s.r=y),u.s.c>x&&(u.s.c=x),u.e.r<y&&(u.e.r=y),u.e.c<x&&(u.e.c=x),e[p][g]&&typeof e[p][g]=="object"&&!Array.isArray(e[p][g])&&!(e[p][g]instanceof Date))m=e[p][g];else if(Array.isArray(m.v)&&(m.f=e[p][g][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||ut[14],n.cellDates?(m.t="d",m.w=Ls(m.z,Nn(m.v))):(m.t="n",m.v=Nn(m.v),m.w=Ls(m.z,m.v))):m.t="s";if(i)s[y]||(s[y]=[]),s[y][x]&&s[y][x].z&&(m.z=s[y][x].z),s[y][x]=m;else{var S=ft({c:x,r:y});s[S]&&s[S].z&&(m.z=s[S].z),s[S]=m}}}return u.s.c<1e7&&(s["!ref"]=Tt(u)),s}function Ou(t,e){return uA(null,t,e)}function UR(t){return t.read_shift(4,"i")}function oa(t,e){return e||(e=_e(4)),e.write_shift(4,t),e}function gi(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Vn(t,e){var r=!1;return e==null&&(r=!0,e=_e(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function VR(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function zR(t,e){return e||(e=_e(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Z1(t,e){var r=t.l,n=t.read_shift(1),i=gi(t),s=[],a={t:i,h:i};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)s.push(VR(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function WR(t,e){var r=!1;return e==null&&(r=!0,e=_e(15+4*t.t.length)),e.write_shift(1,0),Vn(t.t,e),r?e.slice(0,e.l):e}var HR=Z1;function $R(t,e){var r=!1;return e==null&&(r=!0,e=_e(23+4*t.t.length)),e.write_shift(1,1),Vn(t.t,e),e.write_shift(4,1),zR({},e),r?e.slice(0,e.l):e}function Us(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function uc(t,e){return e==null&&(e=_e(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function dc(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function fc(t,e){return e==null&&(e=_e(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var GR=gi,dA=Vn;function ev(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function tp(t,e){var r=!1;return e==null&&(r=!0,e=_e(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var KR=gi,ux=ev,tv=tp;function rv(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?ep([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Il(e,0)>>2;return r?i/100:i}function fA(t,e){e==null&&(e=_e(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function hA(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function YR(t,e){return e||(e=_e(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var hc=hA,Mu=YR;function pi(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Jl(t,e){return(e||_e(8)).write_shift(8,t,"f")}function XR(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var u=Ll[i];u&&(e.rgb=vf(u));break;case 2:e.rgb=vf([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function rp(t,e){if(e||(e=_e(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function qR(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function QR(t,e){e||(e=_e(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function pA(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function JR(t){return pA(t,1)}function ZR(t){return pA(t,2)}var nv=2,Vi=3,M0=11,f_=12,np=19,B0=64,eD=65,tD=71,rD=4108,nD=4126,Bn=80,gA=81,iD=[Bn,gA],dx={1:{n:"CodePage",t:nv},2:{n:"Category",t:Bn},3:{n:"PresentationFormat",t:Bn},4:{n:"ByteCount",t:Vi},5:{n:"LineCount",t:Vi},6:{n:"ParagraphCount",t:Vi},7:{n:"SlideCount",t:Vi},8:{n:"NoteCount",t:Vi},9:{n:"HiddenCount",t:Vi},10:{n:"MultimediaClipCount",t:Vi},11:{n:"ScaleCrop",t:M0},12:{n:"HeadingPairs",t:rD},13:{n:"TitlesOfParts",t:nD},14:{n:"Manager",t:Bn},15:{n:"Company",t:Bn},16:{n:"LinksUpToDate",t:M0},17:{n:"CharacterCount",t:Vi},19:{n:"SharedDoc",t:M0},22:{n:"HyperlinksChanged",t:M0},23:{n:"AppVersion",t:Vi,p:"version"},24:{n:"DigSig",t:eD},26:{n:"ContentType",t:Bn},27:{n:"ContentStatus",t:Bn},28:{n:"Language",t:Bn},29:{n:"Version",t:Bn},255:{},2147483648:{n:"Locale",t:np},2147483651:{n:"Behavior",t:np},1919054434:{}},fx={1:{n:"CodePage",t:nv},2:{n:"Title",t:Bn},3:{n:"Subject",t:Bn},4:{n:"Author",t:Bn},5:{n:"Keywords",t:Bn},6:{n:"Comments",t:Bn},7:{n:"Template",t:Bn},8:{n:"LastAuthor",t:Bn},9:{n:"RevNumber",t:Bn},10:{n:"EditTime",t:B0},11:{n:"LastPrinted",t:B0},12:{n:"CreatedDate",t:B0},13:{n:"ModifiedDate",t:B0},14:{n:"PageCount",t:Vi},15:{n:"WordCount",t:Vi},16:{n:"CharCount",t:Vi},17:{n:"Thumbnail",t:tD},18:{n:"Application",t:Bn},19:{n:"DocSecurity",t:Vi},255:{},2147483648:{n:"Locale",t:np},2147483651:{n:"Behavior",t:np},1919054434:{}},h_={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},sD=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function aD(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var oD=aD([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ll=Rr(oD),mo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},mA={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},hx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},j0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function iv(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function lD(t){var e=iv();if(!t||!t.match)return e;var r={};if((t.match(yi)||[]).forEach(function(n){var i=ht(n);switch(i[0].replace(vR,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[hx[i.ContentType]]!==void 0&&e[hx[i.ContentType]].push(i.PartName);break}}),e.xmlns!==kn.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function xA(t,e){var r=lR(hx),n=[],i;n[n.length]=cn,n[n.length]=Ve("Types",null,{xmlns:kn.CT,"xmlns:xsd":kn.xsd,"xmlns:xsi":kn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Ve("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],n[n.length]=Ve("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:j0[l][e.bookType]||j0[l].xlsx}))},a=function(l){(t[l]||[]).forEach(function(u){n[n.length]=Ve("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:j0[l][e.bookType]||j0[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(u){n[n.length]=Ve("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Rt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function xf(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Bd(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(yi)||[]).forEach(function(i){var s=ht(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:_d(s.Target,e);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}function iu(t){var e=[cn,Ve("Relationships",null,{xmlns:kn.RELS})];return Jr(t["!id"]).forEach(function(r){e[e.length]=Ve("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function lr(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[Rt.HLINK,Rt.XPATH,Rt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var cD="application/vnd.oasis.opendocument.spreadsheet";function uD(t,e){for(var r=Y1(t),n,i;n=mf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=ht(n[0],!1),i.path=="/"&&i.type!==cD)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function dD(t){var e=[cn];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function p_(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function fD(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function hD(t){var e=[cn];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(p_(t[r][0],t[r][1])),e.push(fD("",t[r][0]));return e.push(p_("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function vA(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Xh.version+"</meta:generator></office:meta></office:document-meta>"}var Ms=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],pD=function(){for(var t=new Array(Ms.length),e=0;e<Ms.length;++e){var r=Ms[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function yA(t){var e={};t=vr(t);for(var r=0;r<Ms.length;++r){var n=Ms[r],i=t.match(pD[r]);i!=null&&i.length>0&&(e[n[1]]=qt(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Nr(e[n[1]]))}return e}function Wg(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=cr(e),n[n.length]=r?Ve(t,e,r):Jn(t,e))}function _A(t,e){var r=e||{},n=[cn,Ve("cp:coreProperties",null,{"xmlns:cp":kn.CORE_PROPS,"xmlns:dc":kn.dc,"xmlns:dcterms":kn.dcterms,"xmlns:dcmitype":kn.dcmitype,"xmlns:xsi":kn.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&Wg("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:cx(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&Wg("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:cx(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Ms.length;++s){var a=Ms[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Wg(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ul=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],EA=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function SA(t,e,r,n){var i=[];if(typeof t=="string")i=i_(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(f){return{v:f}}));var a=typeof e=="string"?i_(e,n).map(function(f){return f.v}):e,o=0,l=0;if(a.length>0)for(var u=0;u!==i.length;u+=2){switch(l=+i[u+1].v,i[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function gD(t,e,r){var n={};return e||(e={}),t=vr(t),Ul.forEach(function(i){var s=(t.match(pf(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=qt(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&SA(n.HeadingPairs,n.TitlesOfParts,e,r),e}function wA(t){var e=[],r=Ve;return t||(t={}),t.Application="SheetJS",e[e.length]=cn,e[e.length]=Ve("Properties",null,{xmlns:kn.EXT_PROPS,"xmlns:vt":kn.vt}),Ul.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=cr(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+cr(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var mD=/<[^>]+>[^<]*/g;function xD(t,e){var r={},n="",i=t.match(mD);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=ht(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=qt(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),u=l[0].slice(4),f=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=qt(f);break;case"bool":r[n]=br(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=Nr(f);break;case"cy":case"error":r[n]=qt(f);break;default:if(u.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,u,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}function TA(t){var e=[cn,Ve("Properties",null,{xmlns:kn.CUST_PROPS,"xmlns:vt":kn.vt})];if(!t)return e.join("");var r=1;return Jr(t).forEach(function(i){++r,e[e.length]=Ve("property",CR(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:cr(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var px={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Hg;function vD(t,e,r){Hg||(Hg=Wp(px)),e=Hg[e]||e,t[e]=r}function yD(t,e){var r=[];return Jr(px).map(function(n){for(var i=0;i<Ms.length;++i)if(Ms[i][1]==n)return Ms[i];for(i=0;i<Ul.length;++i)if(Ul[i][1]==n)return Ul[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Jn(px[n[1]]||n[1],i))}}),Ve("DocumentProperties",r.join(""),{xmlns:is.o})}function _D(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&Jr(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<Ms.length;++a)if(s==Ms[a][1])return;for(a=0;a<Ul.length;++a)if(s==Ul[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(Ve(e_(s),o,{"dt:dt":l}))}}),e&&Jr(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(Ve(e_(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+is.o+'">'+i.join("")+"</"+n+">"}function sv(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function ED(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=_e(8);return a.write_shift(4,n),a.write_shift(4,i),a}function AA(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function CA(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function kA(t,e,r){return e===31?CA(t):AA(t,e,r)}function gx(t,e,r){return kA(t,e,r===!1?0:4)}function SD(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return kA(t,e,0)}function wD(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(ki,""),t.l-i&2&&(t.l+=2)}return r}function TD(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(ki,"");return r}function AD(t){var e=t.l,r=ip(t,gA);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=ip(t,Vi);return[r,n]}function CD(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(AD(t));return r}function g_(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),a=t.read_shift(4);n[s]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(ki,"").replace(yd,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function FA(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function kD(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function ip(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==f_&&n!==e&&iD.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===f_?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return AA(t,n,4).replace(ki,"");case 31:return CA(t);case 64:return sv(t);case 65:return FA(t);case 71:return kD(t);case 80:return gx(t,n,!s.raw).replace(ki,"");case 81:return SD(t,n).replace(ki,"");case 4108:return CD(t);case 4126:case 4127:return n==4127?wD(t):TD(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function m_(t,e){var r=_e(4),n=_e(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=_e(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=ED(e);break;case 31:case 80:for(n=_e(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Un([r,n])}function x_(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0,o=0,l=-1,u={};for(a=0;a!=i;++a){var f=t.read_shift(4),p=t.read_shift(4);s[a]=[f,p+r]}s.sort(function(k,E){return k[1]-E[1]});var g={};for(a=0;a!=i;++a){if(t.l!==s[a][1]){var m=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:t.l+2===s[a][1]&&(t.l+=2,m=!1);break;case 80:t.l<=s[a][1]&&(t.l=s[a][1],m=!1);break;case 4108:t.l<=s[a][1]&&(t.l=s[a][1],m=!1);break}if((!e||a==0)&&t.l<=s[a][1]&&(m=!1,t.l=s[a][1]),m)throw new Error("Read Error: Expected address "+s[a][1]+" at "+t.l+" :"+a)}if(e){var y=e[s[a][0]];if(g[y.n]=ip(t,y.t,{raw:!0}),y.p==="version"&&(g[y.n]=String(g[y.n]>>16)+"."+("0000"+String(g[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(g[y.n]){case 0:g[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ta(o=g[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[y.n])}}else if(s[a][0]===1){if(o=g.CodePage=ip(t,nv),ta(o),l!==-1){var x=t.l;t.l=s[l][1],u=g_(t,o),t.l=x}}else if(s[a][0]===0){if(o===0){l=a,t.l=s[a+1][1];continue}u=g_(t,o)}else{var S=u[s[a][0]],A;switch(t[t.l]){case 65:t.l+=4,A=FA(t);break;case 30:t.l+=4,A=gx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,A=gx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,A=t.read_shift(4,"i");break;case 19:t.l+=4,A=t.read_shift(4);break;case 5:t.l+=4,A=t.read_shift(8,"f");break;case 11:t.l+=4,A=sn(t,4);break;case 64:t.l+=4,A=Nr(sv(t));break;default:throw new Error("unparsed value: "+t[t.l])}g[S]=A}}return t.l=r+n,g}var bA=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function FD(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function v_(t,e,r){var n=_e(8),i=[],s=[],a=8,o=0,l=_e(8),u=_e(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),s.push(l),i.push(u),a+=8+l.length,!e){u=_e(8),u.write_shift(4,0),i.unshift(u);var f=[_e(4)];for(f[0].write_shift(4,t.length),o=0;o<t.length;++o){var p=t[o][0];for(l=_e(8+2*(p.length+1)+(p.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,p.length+1),l.write_shift(0,p,"dbcs");l.l!=l.length;)l.write_shift(1,0);f.push(l)}l=Un(f),s.unshift(l),a+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(bA.indexOf(t[o][0])>-1||EA.indexOf(t[o][0])>-1)&&t[o][1]!=null){var g=t[o][1],m=0;if(e){m=+e[t[o][0]];var y=r[m];if(y.p=="version"&&typeof g=="string"){var x=g.split(".");g=(+x[0]<<16)+(+x[1]||0)}l=m_(y.t,g)}else{var S=FD(g);S==-1&&(S=31,g=String(g)),l=m_(S,g)}s.push(l),u=_e(8),u.write_shift(4,e?m:2+o),i.push(u),a+=8+l.length}var A=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,A),A+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),Un([n].concat(i).concat(s))}function y_(t,e,r){var n=t.content;if(!n)return{};Qn(n,0);var i,s,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),f=n.read_shift(16);if(f!==it.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),l=n.read_shift(4));var p=x_(n,e),g={SystemIdentifier:u};for(var m in p)g[m]=p[m];if(g.FMTID=s,i===1)return g;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var y;try{y=x_(n,null)}catch{}for(m in y)g[m]=y[m];return g.FMTID=[s,a],g}function __(t,e,r,n,i,s){var a=_e(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,it.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=v_(t,r,n);if(o.push(l),i){var u=v_(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(u)}return Un(o)}function Fo(t,e){return t.read_shift(e),null}function bD(t,e){e||(e=_e(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function ID(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function sn(t,e){return t.read_shift(e)===1}function Ai(t,e){return e||(e=_e(2)),e.write_shift(2,+!!t),e}function xn(t){return t.read_shift(2,"u")}function Is(t,e){return e||(e=_e(2)),e.write_shift(2,t),e}function IA(t,e){return ID(t,e,xn)}function ND(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function NA(t,e,r){return r||(r=_e(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function zf(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return a}function RD(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,s=1+(r&1),a=0,o,l={};i&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",f=e===0?"":t.read_shift(e,u);return i&&(t.l+=4*a),n&&(t.l+=o),l.t=f,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function DD(t){var e=t.t||"",r=_e(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=_e(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return Un(i)}function Zl(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Wf(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Zl(t,n,r)}function pc(t,e,r){if(r.biff>5)return Wf(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function RA(t,e,r){return r||(r=_e(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function PD(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function OD(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(ki,"");return n&&(t.l+=24),i}function MD(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(s>>1,"utf16le").replace(ki,"");return r+a}function BD(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return OD(t);case"0303000000000000c000000000000046":return MD(t);default:throw new Error("Unsupported Moniker "+r)}}function L0(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(ki,""):"";return r}function E_(t,e){e||(e=_e(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function jD(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,a,o,l,u="",f,p;i&16&&(s=L0(t,r-t.l)),i&128&&(a=L0(t,r-t.l)),(i&257)===257&&(o=L0(t,r-t.l)),(i&257)===1&&(l=BD(t,r-t.l)),i&8&&(u=L0(t,r-t.l)),i&32&&(f=t.read_shift(16)),i&64&&(p=sv(t)),t.l=r;var g=a||o||l||"";g&&u&&(g+="#"+u),g||(g="#"+u),i&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var m={Target:g};return f&&(m.guid=f),p&&(m.time=p),s&&(m.Tooltip=s),m}function LD(t){var e=_e(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),E_(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&E_(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function DA(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function PA(t,e){var r=DA(t);return r[3]=0,r}function Da(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function ec(t,e,r,n){return n||(n=_e(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function UD(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function VD(t,e,r){return e===0?"":pc(t,e,r)}function zD(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function OA(t){var e=t.read_shift(2),r=rv(t);return[e,r]}function WD(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=zf(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function Gp(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function MA(t,e){return e||(e=_e(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function BA(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var HD=BA;function jA(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function $D(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function GD(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function ai(t){t.l+=2,t.l+=t.read_shift(2)}var KD={0:ai,4:ai,5:ai,6:ai,7:GD,8:ai,9:ai,10:ai,11:ai,12:ai,13:$D,14:ai,15:ai,16:ai,17:ai,18:ai,19:ai,20:ai,21:jA};function YD(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(KD[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function U0(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function av(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=_e(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function XD(t,e){return e===0||t.read_shift(2),1200}function qD(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=pc(t,0,r);return t.read_shift(e+n-t.l),i}function QD(t,e){var r=!e||e.biff==8,n=_e(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function JD(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function ZD(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=zf(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function e3(t,e){var r=!e||e.biff>=8?2:1,n=_e(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function t3(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0;a!=i&&t.l<r;++a)s.push(RD(t));return s.Count=n,s.Unique=i,s}function r3(t,e){var r=_e(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=DD(t[i]);var s=Un([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function n3(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function i3(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function s3(t){var e=UD(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function a3(t){return t.read_shift(2),t.read_shift(4)}function S_(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function o3(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),u=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:u}}function l3(){var t=_e(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function c3(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function u3(t){var e=_e(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function d3(){}function f3(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=zf(t,0,r),n}function h3(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=_e(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function p3(t){var e=Da(t);return e.isst=t.read_shift(4),e}function g3(t,e,r,n){var i=_e(10);return ec(t,e,n,i),i.write_shift(4,r),i}function m3(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=Da(t);r.biff==2&&t.l++;var s=Wf(t,n-t.l,r);return i.val=s,i}function x3(t,e,r,n,i){var s=!i||i.biff==8,a=_e(8+ +s+(1+s)*r.length);return ec(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function v3(t,e,r){var n=t.read_shift(2),i=pc(t,0,r);return[n,i]}function y3(t,e,r,n){var i=r&&r.biff==5;n||(n=_e(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var _3=pc;function w_(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),a=t.read_shift(i),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:s,c:o},e:{r:a,c:l}}}function E3(t,e){var r=e.biff==8||!e.biff?4:2,n=_e(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function S3(t){var e=t.read_shift(2),r=t.read_shift(2),n=OA(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function w3(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(OA(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function T3(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function A3(t,e,r,n){var i={},s=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return i.patternType=sD[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function C3(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=A3(t,e,n.fStyle,r),n}function T_(t,e,r,n){var i=r&&r.biff==5;n||(n=_e(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function k3(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function F3(t){var e=_e(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function A_(t,e,r){var n=Da(t);(r.biff==2||e==9)&&++t.l;var i=ND(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function b3(t,e,r,n,i,s){var a=_e(8);return ec(t,e,n,a),NA(r,s,a),a}function I3(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Da(t),i=pi(t);return n.val=i,n}function N3(t,e,r,n){var i=_e(14);return ec(t,e,n,i),Jl(r,i),i}var C_=VD;function R3(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=Zl(t,s),o=[];n>t.l;)o.push(Wf(t));return[s,i,a,o]}function k_(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=WD(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var D3=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function F_(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var u=Zl(t,a,r);i&32&&(u=D3[u.charCodeAt(0)]);var f=n-t.l;r&&r.biff==2&&--f;var p=n==t.l||o===0||!(f>0)?[]:Y5(t,f,r,o);return{chKey:s,Name:u,itab:l,rgce:p}}function LA(t,e,r){if(r.biff<8)return P3(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(zD(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function P3(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=zf(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function O3(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=Zl(t,n,r),a=Zl(t,i,r);return[s,a]}function M3(t,e,r){var n=BA(t);t.l++;var i=t.read_shift(1);return e-=8,[X5(t,e,r),i,n]}function b_(t,e,r){var n=HD(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,G5(t,e,r)]}function B3(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function j3(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=pc(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},o,a,s]}}function L3(t,e,r){return j3(t,e,r)}function U3(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Gp(t));return r}function V3(t){var e=_e(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)MA(t[r],e);return e}function z3(t,e,r){if(r&&r.biff<8)return H3(t,e,r);var n=jA(t),i=YD(t,e-22,n[1]);return{cmo:n,ft:i}}var W3={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function H3(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((W3[n]||xi)(t,e,r)),{cmo:[i,n,s],ft:a}}function $3(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:a=PD(t,6,r);var o=t.read_shift(2);t.read_shift(2),xn(t,2);var l=t.read_shift(2);t.l+=l;for(var u=1;u<t.lens.length-1;++u){if(t.l-n!=t.lens[u])throw new Error("TxO: bad continue record");var f=t[t.l],p=Zl(t,t.lens[u+1]-t.lens[u]-1);if(i+=p,i.length>=(f?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function G3(t,e){var r=Gp(t);t.l+=16;var n=jD(t,e-24);return[r,n]}function K3(t){var e=_e(24),r=Wr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return Un([e,LD(t[1])])}function Y3(t,e){t.read_shift(2);var r=Gp(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(ki,""),[r,n]}function X3(t){var e=t[1].Tooltip,r=_e(10+2*(e.length+1));r.write_shift(2,2048);var n=Wr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function q3(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=h_[r]||r,r=t.read_shift(2),e[1]=h_[r]||r,e}function Q3(t){return t||(t=_e(4)),t.write_shift(2,1),t.write_shift(2,1),t}function J3(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(PA(t));return r}function Z3(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(PA(t));return r}function e6(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function UA(t,e,r){if(!r.cellStyles)return xi(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var u={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function t6(t,e){var r=_e(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function r6(t,e){var r={};return e<32||(t.l+=16,r.header=pi(t),r.footer=pi(t),t.l+=2),r}function n6(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}function i6(t){for(var e=_e(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var s6=Da,a6=IA,o6=Wf;function l6(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function c6(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Da(t);++t.l;var i=pc(t,e-7,r);return n.t="str",n.val=i,n}function u6(t){var e=Da(t);++t.l;var r=pi(t);return e.t="n",e.val=r,e}function d6(t,e,r){var n=_e(15);return Kf(n,t,e),n.write_shift(8,r,"f"),n}function f6(t){var e=Da(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function h6(t,e,r){var n=_e(9);return Kf(n,t,e),n.write_shift(2,r),n}function p6(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function g6(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function m6(t,e,r){var n=t.l+e,i=Da(t),s=t.read_shift(2),a=Zl(t,s,r);return t.l=n,i.t="str",i.val=a,i}var x6=[2,3,48,49,131,139,140,245],mx=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Wp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],f=ol(1);switch(l.type){case"base64":f=as(fs(o));break;case"binary":f=as(o);break;case"buffer":case"array":f=o;break}Qn(f,0);var p=f.read_shift(1),g=!!(p&136),m=!1,y=!1;switch(p){case 2:break;case 3:break;case 48:m=!0,g=!0;break;case 49:m=!0,g=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var x=0,S=521;p==2&&(x=f.read_shift(2)),f.l+=3,p!=2&&(x=f.read_shift(4)),x>1048576&&(x=1e6),p!=2&&(S=f.read_shift(2));var A=f.read_shift(2),k=l.codepage||1252;p!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(k=t[f[f.l]]),f.l+=1,f.l+=2),y&&(f.l+=36);for(var E=[],P={},Y=Math.min(f.length,p==2?521:S-10-(m?264:0)),W=y?32:11;f.l<Y&&f[f.l]!=13;)switch(P={},P.name=df.utils.decode(k,f.slice(f.l,f.l+W)).replace(/[\u0000\r\n].*$/g,""),f.l+=W,P.type=String.fromCharCode(f.read_shift(1)),p!=2&&!y&&(P.offset=f.read_shift(4)),P.len=f.read_shift(1),p==2&&(P.offset=f.read_shift(2)),P.dec=f.read_shift(1),P.name.length&&E.push(P),p!=2&&(f.l+=y?13:14),P.type){case"B":(!m||P.len!=8)&&l.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+P.type)}if(f[f.l]!==13&&(f.l=S-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=S;var T=0,F=0;for(u[0]=[],F=0;F!=E.length;++F)u[0][F]=E[F].name;for(;x-- >0;){if(f[f.l]===42){f.l+=A;continue}for(++f.l,u[++T]=[],F=0,F=0;F!=E.length;++F){var w=f.slice(f.l,f.l+E[F].len);f.l+=E[F].len,Qn(w,0);var I=df.utils.decode(k,w);switch(E[F].type){case"C":I.trim().length&&(u[T][F]=I.replace(/\s+$/,""));break;case"D":I.length===8?u[T][F]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):u[T][F]=I;break;case"F":u[T][F]=parseFloat(I.trim());break;case"+":case"I":u[T][F]=y?w.read_shift(-4,"i")^2147483648:w.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":u[T][F]=!0;break;case"N":case"F":u[T][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));u[T][F]="##MEMO##"+(y?parseInt(I.trim(),10):w.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(u[T][F]=+I||0);break;case"@":u[T][F]=new Date(w.read_shift(-8,"f")-621356832e5);break;case"T":u[T][F]=new Date((w.read_shift(4)-2440588)*864e5+w.read_shift(4));break;case"Y":u[T][F]=w.read_shift(4,"i")/1e4+w.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[T][F]=-w.read_shift(-8,"f");break;case"B":if(m&&E[F].len==8){u[T][F]=w.read_shift(8,"f");break}case"G":case"P":w.l+=E[F].len;break;case"0":if(E[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[F].type)}}}if(p!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=E,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var f=Ou(r(o,u),u);return f["!cols"]=u.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete u.DBF,f}function i(o,l){try{return vl(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var u=l||{};if(+u.codepage>=0&&ta(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=Ki(),p=op(o,{header:1,raw:!0,cellDates:!0}),g=p[0],m=p.slice(1),y=o["!cols"]||[],x=0,S=0,A=0,k=1;for(x=0;x<g.length;++x){if(((y[x]||{}).DBF||{}).name){g[x]=y[x].DBF.name,++A;continue}if(g[x]!=null){if(++A,typeof g[x]=="number"&&(g[x]=g[x].toString(10)),typeof g[x]!="string")throw new Error("DBF Invalid column name "+g[x]+" |"+typeof g[x]+"|");if(g.indexOf(g[x])!==x){for(S=0;S<1024;++S)if(g.indexOf(g[x]+"_"+S)==-1){g[x]+="_"+S;break}}}}var E=Qt(o["!ref"]),P=[],Y=[],W=[];for(x=0;x<=E.e.c-E.s.c;++x){var T="",F="",w=0,I=[];for(S=0;S<m.length;++S)m[S][x]!=null&&I.push(m[S][x]);if(I.length==0||g[x]==null){P[x]="?";continue}for(S=0;S<I.length;++S){switch(typeof I[S]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=I[S]instanceof Date?"D":"C";break;default:F="C"}w=Math.max(w,String(I[S]).length),T=T&&T!=F?"C":F}w>250&&(w=250),F=((y[x]||{}).DBF||{}).type,F=="C"&&y[x].DBF.len>w&&(w=y[x].DBF.len),T=="B"&&F=="N"&&(T="N",W[x]=y[x].DBF.dec,w=y[x].DBF.len),Y[x]=T=="C"||F=="N"?w:s[T]||0,k+=Y[x],P[x]=T}var R=f.next(32);for(R.write_shift(4,318902576),R.write_shift(4,m.length),R.write_shift(2,296+32*A),R.write_shift(2,k),x=0;x<4;++x)R.write_shift(4,0);for(R.write_shift(4,0|(+e[bT]||3)<<8),x=0,S=0;x<g.length;++x)if(g[x]!=null){var D=f.next(32),N=(g[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,N,"sbcs"),D.write_shift(1,P[x]=="?"?"C":P[x],"sbcs"),D.write_shift(4,S),D.write_shift(1,Y[x]||s[P[x]]||0),D.write_shift(1,W[x]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),S+=Y[x]||s[P[x]]||0}var Ge=f.next(264);for(Ge.write_shift(4,13),x=0;x<65;++x)Ge.write_shift(4,0);for(x=0;x<m.length;++x){var Ee=f.next(k);for(Ee.write_shift(1,0),S=0;S<g.length;++S)if(g[S]!=null)switch(P[S]){case"L":Ee.write_shift(1,m[x][S]==null?63:m[x][S]?84:70);break;case"B":Ee.write_shift(8,m[x][S]||0,"f");break;case"N":var Pe="0";for(typeof m[x][S]=="number"&&(Pe=m[x][S].toFixed(W[S]||0)),A=0;A<Y[S]-Pe.length;++A)Ee.write_shift(1,32);Ee.write_shift(1,Pe,"sbcs");break;case"D":m[x][S]?(Ee.write_shift(4,("0000"+m[x][S].getFullYear()).slice(-4),"sbcs"),Ee.write_shift(2,("00"+(m[x][S].getMonth()+1)).slice(-2),"sbcs"),Ee.write_shift(2,("00"+m[x][S].getDate()).slice(-2),"sbcs")):Ee.write_shift(8,"00000000","sbcs");break;case"C":var Ie=String(m[x][S]!=null?m[x][S]:"").slice(0,Y[S]);for(Ee.write_shift(1,Ie,"sbcs"),A=0;A<Y[S]-Ie.length;++A)Ee.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),VA=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Jr(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(g,m){var y=t[m];return typeof y=="number"?U2(y):y},n=function(g,m,y){var x=m.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return x==59?g:U2(x)};t["|"]=254;function i(g,m){switch(m.type){case"base64":return s(fs(g),m);case"binary":return s(g,m);case"buffer":return s(It&&Buffer.isBuffer(g)?g.toString("binary"):xl(g),m);case"array":return s(Ql(g),m)}throw new Error("Unrecognized type "+m.type)}function s(g,m){var y=g.split(/[\n\r]+/),x=-1,S=-1,A=0,k=0,E=[],P=[],Y=null,W={},T=[],F=[],w=[],I=0,R;for(+m.codepage>=0&&ta(+m.codepage);A!==y.length;++A){I=0;var D=y[A].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),N=D.replace(/;;/g,"\0").split(";").map(function(X){return X.replace(/\u0000/g,";")}),Ge=N[0],Ee;if(D.length>0)switch(Ge){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":N[1].charAt(0)=="P"&&P.push(D.slice(3).replace(/;;/g,";"));break;case"C":var Pe=!1,Ie=!1,Ce=!1,se=!1,be=-1,Be=-1;for(k=1;k<N.length;++k)switch(N[k].charAt(0)){case"A":break;case"X":S=parseInt(N[k].slice(1))-1,Ie=!0;break;case"Y":for(x=parseInt(N[k].slice(1))-1,Ie||(S=0),R=E.length;R<=x;++R)E[R]=[];break;case"K":Ee=N[k].slice(1),Ee.charAt(0)==='"'?Ee=Ee.slice(1,Ee.length-1):Ee==="TRUE"?Ee=!0:Ee==="FALSE"?Ee=!1:isNaN(aa(Ee))?isNaN(vu(Ee).getDate())||(Ee=Nr(Ee)):(Ee=aa(Ee),Y!==null&&Du(Y)&&(Ee=$p(Ee))),Pe=!0;break;case"E":se=!0;var G=su(N[k].slice(1),{r:x,c:S});E[x][S]=[E[x][S],G];break;case"S":Ce=!0,E[x][S]=[E[x][S],"S5S"];break;case"G":break;case"R":be=parseInt(N[k].slice(1))-1;break;case"C":Be=parseInt(N[k].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}if(Pe&&(E[x][S]&&E[x][S].length==2?E[x][S][0]=Ee:E[x][S]=Ee,Y=null),Ce){if(se)throw new Error("SYLK shared formula cannot have own formula");var ne=be>-1&&E[be][Be];if(!ne||!ne[1])throw new Error("SYLK shared formula cannot find base");E[x][S][1]=sC(ne[1],{r:x-be,c:S-Be})}break;case"F":var ie=0;for(k=1;k<N.length;++k)switch(N[k].charAt(0)){case"X":S=parseInt(N[k].slice(1))-1,++ie;break;case"Y":for(x=parseInt(N[k].slice(1))-1,R=E.length;R<=x;++R)E[R]=[];break;case"M":I=parseInt(N[k].slice(1))/20;break;case"F":break;case"G":break;case"P":Y=P[parseInt(N[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(w=N[k].slice(1).split(" "),R=parseInt(w[0],10);R<=parseInt(w[1],10);++R)I=parseInt(w[2],10),F[R-1]=I===0?{hidden:!0}:{wch:I},ll(F[R-1]);break;case"C":S=parseInt(N[k].slice(1))-1,F[S]||(F[S]={});break;case"R":x=parseInt(N[k].slice(1))-1,T[x]||(T[x]={}),I>0?(T[x].hpt=I,T[x].hpx=_u(I)):I===0&&(T[x].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}ie<1&&(Y=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}}return T.length>0&&(W["!rows"]=T),F.length>0&&(W["!cols"]=F),m&&m.sheetRows&&(E=E.slice(0,m.sheetRows)),[E,W]}function a(g,m){var y=i(g,m),x=y[0],S=y[1],A=Ou(x,m);return Jr(S).forEach(function(k){A[k]=S[k]}),A}function o(g,m){return vl(a(g,m),m)}function l(g,m,y,x){var S="C;Y"+(y+1)+";X"+(x+1)+";K";switch(g.t){case"n":S+=g.v||0,g.f&&!g.F&&(S+=";E"+fv(g.f,{r:y,c:x}));break;case"b":S+=g.v?"TRUE":"FALSE";break;case"e":S+=g.w||g.v;break;case"d":S+='"'+(g.w||g.v)+'"';break;case"s":S+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function u(g,m){m.forEach(function(y,x){var S="F;W"+(x+1)+" "+(x+1)+" ";y.hidden?S+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=yf(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=_f(y.wpx)),typeof y.wch=="number"&&(S+=Math.round(y.wch))),S.charAt(S.length-1)!=" "&&g.push(S)})}function f(g,m){m.forEach(function(y,x){var S="F;";y.hidden?S+="M0;":y.hpt?S+="M"+20*y.hpt+";":y.hpx&&(S+="M"+20*Ef(y.hpx)+";"),S.length>2&&g.push(S+"R"+(x+1))})}function p(g,m){var y=["ID;PWXL;N;E"],x=[],S=Qt(g["!ref"]),A,k=Array.isArray(g),E=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),g["!cols"]&&u(y,g["!cols"]),g["!rows"]&&f(y,g["!rows"]),y.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var P=S.s.r;P<=S.e.r;++P)for(var Y=S.s.c;Y<=S.e.c;++Y){var W=ft({r:P,c:Y});A=k?(g[P]||[])[Y]:g[W],!(!A||A.v==null&&(!A.f||A.F))&&x.push(l(A,g,P,Y))}return y.join(E)+E+x.join(E)+E+"E"+E}return{to_workbook:o,to_sheet:a,from_sheet:p}}(),zA=function(){function t(s,a){switch(a.type){case"base64":return e(fs(s),a);case"binary":return e(s,a);case"buffer":return e(It&&Buffer.isBuffer(s)?s.toString("binary"):xl(s),a);case"array":return e(Ql(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,u=-1,f=0,p=[];f!==o.length;++f){if(o[f].trim()==="BOT"){p[++l]=[],u=0;continue}if(!(l<0)){var g=o[f].trim().split(","),m=g[0],y=g[1];++f;for(var x=o[f]||"";(x.match(/["]/g)||[]).length&1&&f<o.length-1;)x+=`
`+o[++f];switch(x=x.trim(),+m){case-1:if(x==="BOT"){p[++l]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?p[l][u]=!0:x==="FALSE"?p[l][u]=!1:isNaN(aa(y))?isNaN(vu(y).getDate())?p[l][u]=y:p[l][u]=Nr(y):p[l][u]=aa(y),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),p[l][u++]=x!==""?x:null;break}if(x==="EOD")break}}return a&&a.sheetRows&&(p=p.slice(0,a.sheetRows)),p}function r(s,a){return Ou(t(s,a),a)}function n(s,a){return vl(r(s,a),a)}var i=function(){var s=function(l,u,f,p,g){l.push(u),l.push(f+","+p),l.push('"'+g.replace(/"/g,'""')+'"')},a=function(l,u,f,p){l.push(u+","+f),l.push(u==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(l){var u=[],f=Qt(l["!ref"]),p,g=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,f.e.r-f.s.r+1,""),s(u,"TUPLES",0,f.e.c-f.s.c+1,""),s(u,"DATA",0,0,"");for(var m=f.s.r;m<=f.e.r;++m){a(u,-1,0,"BOT");for(var y=f.s.c;y<=f.e.c;++y){var x=ft({r:m,c:y});if(p=g?(l[m]||[])[y]:l[x],!p){a(u,1,0,"");continue}switch(p.t){case"n":var S=p.w;!S&&p.v!=null&&(S=p.v),S==null?p.f&&!p.F?a(u,1,0,"="+p.f):a(u,1,0,""):a(u,0,S,"V");break;case"b":a(u,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":a(u,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=Ls(p.z||ut[14],Nn(Nr(p.v)))),a(u,0,p.w,"V");break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var A=`\r
`,k=u.join(A);return k}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),WA=function(){function t(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,g){for(var m=p.split(`
`),y=-1,x=-1,S=0,A=[];S!==m.length;++S){var k=m[S].trim().split(":");if(k[0]==="cell"){var E=Wr(k[1]);if(A.length<=E.r)for(y=A.length;y<=E.r;++y)A[y]||(A[y]=[]);switch(y=E.r,x=E.c,k[2]){case"t":A[y][x]=t(k[3]);break;case"v":A[y][x]=+k[3];break;case"vtf":var P=k[k.length-1];case"vtc":switch(k[3]){case"nl":A[y][x]=!!+k[4];break;default:A[y][x]=+k[4];break}k[2]=="vtf"&&(A[y][x]=[A[y][x],P])}}}return g&&g.sheetRows&&(A=A.slice(0,g.sheetRows)),A}function n(p,g){return Ou(r(p,g),g)}function i(p,g){return vl(n(p,g),g)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(p){if(!p||!p["!ref"])return"";for(var g=[],m=[],y,x="",S=Yi(p["!ref"]),A=Array.isArray(p),k=S.s.r;k<=S.e.r;++k)for(var E=S.s.c;E<=S.e.c;++E)if(x=ft({r:k,c:E}),y=A?(p[k]||[])[E]:p[x],!(!y||y.v==null||y.t==="z")){switch(m=["cell",x,"t"],y.t){case"s":case"str":m.push(e(y.v));break;case"n":y.f?(m[2]="vtf",m[3]="n",m[4]=y.v,m[5]=e(y.f)):(m[2]="v",m[3]=y.v);break;case"b":m[2]="vt"+(y.f?"f":"c"),m[3]="nl",m[4]=y.v?"1":"0",m[5]=e(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var P=Nn(Nr(y.v));m[2]="vtc",m[3]="nd",m[4]=""+P,m[5]=y.w||Ls(y.z||ut[14],P);break;case"e":continue}g.push(m.join(":"))}return g.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function f(p){return[s,a,o,a,u(p),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),yu=function(){function t(f,p,g,m,y){y.raw?p[g][m]=f:f===""||(f==="TRUE"?p[g][m]=!0:f==="FALSE"?p[g][m]=!1:isNaN(aa(f))?isNaN(vu(f).getDate())?p[g][m]=f:p[g][m]=Nr(f):p[g][m]=aa(f))}function e(f,p){var g=p||{},m=[];if(!f||f.length===0)return m;for(var y=f.split(/[\r\n]/),x=y.length-1;x>=0&&y[x].length===0;)--x;for(var S=10,A=0,k=0;k<=x;++k)A=y[k].indexOf(" "),A==-1?A=y[k].length:A++,S=Math.max(S,A);for(k=0;k<=x;++k){m[k]=[];var E=0;for(t(y[k].slice(0,S).trim(),m,k,E,g),E=1;E<=(y[k].length-S)/10+1;++E)t(y[k].slice(S+(E-1)*10,S+E*10).trim(),m,k,E,g)}return g.sheetRows&&(m=m.slice(0,g.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var p={},g=!1,m=0,y=0;m<f.length;++m)(y=f.charCodeAt(m))==34?g=!g:!g&&y in r&&(p[y]=(p[y]||0)+1);y=[];for(m in p)Object.prototype.hasOwnProperty.call(p,m)&&y.push([p[m],m]);if(!y.length){p=n;for(m in p)Object.prototype.hasOwnProperty.call(p,m)&&y.push([p[m],m])}return y.sort(function(x,S){return x[0]-S[0]||n[x[1]]-n[S[1]]}),r[y.pop()[1]]||44}function s(f,p){var g=p||{},m="",y=g.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(m=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(m=f.charAt(4),f=f.slice(6)):m=i(f.slice(0,1024)):g&&g.FS?m=g.FS:m=i(f.slice(0,1024));var S=0,A=0,k=0,E=0,P=0,Y=m.charCodeAt(0),W=!1,T=0,F=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var w=g.dateNF!=null?nR(g.dateNF):null;function I(){var R=f.slice(E,P),D={};if(R.charAt(0)=='"'&&R.charAt(R.length-1)=='"'&&(R=R.slice(1,-1).replace(/""/g,'"')),R.length===0)D.t="z";else if(g.raw)D.t="s",D.v=R;else if(R.trim().length===0)D.t="s",D.v=R;else if(R.charCodeAt(0)==61)R.charCodeAt(1)==34&&R.charCodeAt(R.length-1)==34?(D.t="s",D.v=R.slice(2,-1).replace(/""/g,'"')):R8(R)?(D.t="n",D.f=R.slice(1)):(D.t="s",D.v=R);else if(R=="TRUE")D.t="b",D.v=!0;else if(R=="FALSE")D.t="b",D.v=!1;else if(!isNaN(k=aa(R)))D.t="n",g.cellText!==!1&&(D.w=R),D.v=k;else if(!isNaN(vu(R).getDate())||w&&R.match(w)){D.z=g.dateNF||ut[14];var N=0;w&&R.match(w)&&(R=iR(R,g.dateNF,R.match(w)||[]),N=1),g.cellDates?(D.t="d",D.v=Nr(R,N)):(D.t="n",D.v=Nn(Nr(R,N))),g.cellText!==!1&&(D.w=Ls(D.z,D.v instanceof Date?Nn(D.v):D.v)),g.cellNF||delete D.z}else D.t="s",D.v=R;if(D.t=="z"||(g.dense?(y[S]||(y[S]=[]),y[S][A]=D):y[ft({c:A,r:S})]=D),E=P+1,F=f.charCodeAt(E),x.e.c<A&&(x.e.c=A),x.e.r<S&&(x.e.r=S),T==Y)++A;else if(A=0,++S,g.sheetRows&&g.sheetRows<=S)return!0}e:for(;P<f.length;++P)switch(T=f.charCodeAt(P)){case 34:F===34&&(W=!W);break;case Y:case 10:case 13:if(!W&&I())break e;break}return P-E>0&&I(),y["!ref"]=Tt(x),y}function a(f,p){return!(p&&p.PRN)||p.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,p):Ou(e(f,p),p)}function o(f,p){var g="",m=p.type=="string"?[0,0,0,0]:_v(f,p);switch(p.type){case"base64":g=fs(f);break;case"binary":g=f;break;case"buffer":p.codepage==65001?g=f.toString("utf8"):p.codepage&&typeof df<"u"||(g=It&&Buffer.isBuffer(f)?f.toString("binary"):xl(f));break;case"array":g=Ql(f);break;case"string":g=f;break;default:throw new Error("Unrecognized type "+p.type)}return m[0]==239&&m[1]==187&&m[2]==191?g=vr(g.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?g=vr(g):p.type=="binary"&&typeof df<"u",g.slice(0,19)=="socialcalc:version:"?WA.to_sheet(p.type=="string"?g:vr(g),p):a(g,p)}function l(f,p){return vl(o(f,p),p)}function u(f){for(var p=[],g=Qt(f["!ref"]),m,y=Array.isArray(f),x=g.s.r;x<=g.e.r;++x){for(var S=[],A=g.s.c;A<=g.e.c;++A){var k=ft({r:x,c:A});if(m=y?(f[x]||[])[A]:f[k],!m||m.v==null){S.push("          ");continue}for(var E=(m.w||(ao(m),m.w)||"").slice(0,10);E.length<10;)E+=" ";S.push(E+(A===0?" ":""))}p.push(S.join(""))}return p.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}();function v6(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=VA.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return yu.to_workbook(t,e)}}var Vl=function(){function t(G,ne,ie){if(G){Qn(G,G.l||0);for(var X=ie.Enum||be;G.l<G.length;){var ve=G.read_shift(2),Se=X[ve]||X[65535],Le=G.read_shift(2),Ne=G.l+Le,ke=Se.f&&Se.f(G,Le,ie);if(G.l=Ne,ne(ke,Se,ve))return}}}function e(G,ne){switch(ne.type){case"base64":return r(as(fs(G)),ne);case"binary":return r(as(G),ne);case"buffer":case"array":return r(G,ne)}throw"Unsupported type "+ne.type}function r(G,ne){if(!G)return G;var ie=ne||{},X=ie.dense?[]:{},ve="Sheet1",Se="",Le=0,Ne={},ke=[],rt=[],ee={s:{r:0,c:0},e:{r:0,c:0}},Dt=ie.sheetRows||0;if(G[2]==0&&(G[3]==8||G[3]==9)&&G.length>=16&&G[14]==5&&G[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(G[2]==2)ie.Enum=be,t(G,function(He,fr,Wn){switch(Wn){case 0:ie.vers=He,He>=4096&&(ie.qpro=!0);break;case 6:ee=He;break;case 204:He&&(Se=He);break;case 222:Se=He;break;case 15:case 51:ie.qpro||(He[1].v=He[1].v.slice(1));case 13:case 14:case 16:Wn==14&&(He[2]&112)==112&&(He[2]&15)>1&&(He[2]&15)<15&&(He[1].z=ie.dateNF||ut[14],ie.cellDates&&(He[1].t="d",He[1].v=$p(He[1].v))),ie.qpro&&He[3]>Le&&(X["!ref"]=Tt(ee),Ne[ve]=X,ke.push(ve),X=ie.dense?[]:{},ee={s:{r:0,c:0},e:{r:0,c:0}},Le=He[3],ve=Se||"Sheet"+(Le+1),Se="");var Zr=ie.dense?(X[He[0].r]||[])[He[0].c]:X[ft(He[0])];if(Zr){Zr.t=He[1].t,Zr.v=He[1].v,He[1].z!=null&&(Zr.z=He[1].z),He[1].f!=null&&(Zr.f=He[1].f);break}ie.dense?(X[He[0].r]||(X[He[0].r]=[]),X[He[0].r][He[0].c]=He[1]):X[ft(He[0])]=He[1];break}},ie);else if(G[2]==26||G[2]==14)ie.Enum=Be,G[2]==14&&(ie.qpro=!0,G.l=0),t(G,function(He,fr,Wn){switch(Wn){case 204:ve=He;break;case 22:He[1].v=He[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(He[3]>Le&&(X["!ref"]=Tt(ee),Ne[ve]=X,ke.push(ve),X=ie.dense?[]:{},ee={s:{r:0,c:0},e:{r:0,c:0}},Le=He[3],ve="Sheet"+(Le+1)),Dt>0&&He[0].r>=Dt)break;ie.dense?(X[He[0].r]||(X[He[0].r]=[]),X[He[0].r][He[0].c]=He[1]):X[ft(He[0])]=He[1],ee.e.c<He[0].c&&(ee.e.c=He[0].c),ee.e.r<He[0].r&&(ee.e.r=He[0].r);break;case 27:He[14e3]&&(rt[He[14e3][0]]=He[14e3][1]);break;case 1537:rt[He[0]]=He[1],He[0]==Le&&(ve=He[1]);break}},ie);else throw new Error("Unrecognized LOTUS BOF "+G[2]);if(X["!ref"]=Tt(ee),Ne[Se||ve]=X,ke.push(Se||ve),!rt.length)return{SheetNames:ke,Sheets:Ne};for(var Et={},Nt=[],xt=0;xt<rt.length;++xt)Ne[ke[xt]]?(Nt.push(rt[xt]||ke[xt]),Et[rt[xt]]=Ne[rt[xt]]||Ne[ke[xt]]):(Nt.push(rt[xt]),Et[rt[xt]]={"!ref":"A1"});return{SheetNames:Nt,Sheets:Et}}function n(G,ne){var ie=ne||{};if(+ie.codepage>=0&&ta(+ie.codepage),ie.type=="string")throw new Error("Cannot write WK1 to JS string");var X=Ki(),ve=Qt(G["!ref"]),Se=Array.isArray(G),Le=[];We(X,0,s(1030)),We(X,6,l(ve));for(var Ne=Math.min(ve.e.r,8191),ke=ve.s.r;ke<=Ne;++ke)for(var rt=ln(ke),ee=ve.s.c;ee<=ve.e.c;++ee){ke===ve.s.r&&(Le[ee]=zr(ee));var Dt=Le[ee]+rt,Et=Se?(G[ke]||[])[ee]:G[Dt];if(!(!Et||Et.t=="z"))if(Et.t=="n")(Et.v|0)==Et.v&&Et.v>=-32768&&Et.v<=32767?We(X,13,m(ke,ee,Et.v)):We(X,14,x(ke,ee,Et.v));else{var Nt=ao(Et);We(X,15,p(ke,ee,Nt.slice(0,239)))}}return We(X,1),X.end()}function i(G,ne){var ie=ne||{};if(+ie.codepage>=0&&ta(+ie.codepage),ie.type=="string")throw new Error("Cannot write WK3 to JS string");var X=Ki();We(X,0,a(G));for(var ve=0,Se=0;ve<G.SheetNames.length;++ve)(G.Sheets[G.SheetNames[ve]]||{})["!ref"]&&We(X,27,se(G.SheetNames[ve],Se++));var Le=0;for(ve=0;ve<G.SheetNames.length;++ve){var Ne=G.Sheets[G.SheetNames[ve]];if(!(!Ne||!Ne["!ref"])){for(var ke=Qt(Ne["!ref"]),rt=Array.isArray(Ne),ee=[],Dt=Math.min(ke.e.r,8191),Et=ke.s.r;Et<=Dt;++Et)for(var Nt=ln(Et),xt=ke.s.c;xt<=ke.e.c;++xt){Et===ke.s.r&&(ee[xt]=zr(xt));var He=ee[xt]+Nt,fr=rt?(Ne[Et]||[])[xt]:Ne[He];if(!(!fr||fr.t=="z"))if(fr.t=="n")We(X,23,I(Et,xt,Le,fr.v));else{var Wn=ao(fr);We(X,22,T(Et,xt,Le,Wn.slice(0,239)))}}++Le}}return We(X,1),X.end()}function s(G){var ne=_e(2);return ne.write_shift(2,G),ne}function a(G){var ne=_e(26);ne.write_shift(2,4096),ne.write_shift(2,4),ne.write_shift(4,0);for(var ie=0,X=0,ve=0,Se=0;Se<G.SheetNames.length;++Se){var Le=G.SheetNames[Se],Ne=G.Sheets[Le];if(!(!Ne||!Ne["!ref"])){++ve;var ke=Yi(Ne["!ref"]);ie<ke.e.r&&(ie=ke.e.r),X<ke.e.c&&(X=ke.e.c)}}return ie>8191&&(ie=8191),ne.write_shift(2,ie),ne.write_shift(1,ve),ne.write_shift(1,X),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(1,1),ne.write_shift(1,2),ne.write_shift(4,0),ne.write_shift(4,0),ne}function o(G,ne,ie){var X={s:{c:0,r:0},e:{c:0,r:0}};return ne==8&&ie.qpro?(X.s.c=G.read_shift(1),G.l++,X.s.r=G.read_shift(2),X.e.c=G.read_shift(1),G.l++,X.e.r=G.read_shift(2),X):(X.s.c=G.read_shift(2),X.s.r=G.read_shift(2),ne==12&&ie.qpro&&(G.l+=2),X.e.c=G.read_shift(2),X.e.r=G.read_shift(2),ne==12&&ie.qpro&&(G.l+=2),X.s.c==65535&&(X.s.c=X.e.c=X.s.r=X.e.r=0),X)}function l(G){var ne=_e(8);return ne.write_shift(2,G.s.c),ne.write_shift(2,G.s.r),ne.write_shift(2,G.e.c),ne.write_shift(2,G.e.r),ne}function u(G,ne,ie){var X=[{c:0,r:0},{t:"n",v:0},0,0];return ie.qpro&&ie.vers!=20768?(X[0].c=G.read_shift(1),X[3]=G.read_shift(1),X[0].r=G.read_shift(2),G.l+=2):(X[2]=G.read_shift(1),X[0].c=G.read_shift(2),X[0].r=G.read_shift(2)),X}function f(G,ne,ie){var X=G.l+ne,ve=u(G,ne,ie);if(ve[1].t="s",ie.vers==20768){G.l++;var Se=G.read_shift(1);return ve[1].v=G.read_shift(Se,"utf8"),ve}return ie.qpro&&G.l++,ve[1].v=G.read_shift(X-G.l,"cstr"),ve}function p(G,ne,ie){var X=_e(7+ie.length);X.write_shift(1,255),X.write_shift(2,ne),X.write_shift(2,G),X.write_shift(1,39);for(var ve=0;ve<X.length;++ve){var Se=ie.charCodeAt(ve);X.write_shift(1,Se>=128?95:Se)}return X.write_shift(1,0),X}function g(G,ne,ie){var X=u(G,ne,ie);return X[1].v=G.read_shift(2,"i"),X}function m(G,ne,ie){var X=_e(7);return X.write_shift(1,255),X.write_shift(2,ne),X.write_shift(2,G),X.write_shift(2,ie,"i"),X}function y(G,ne,ie){var X=u(G,ne,ie);return X[1].v=G.read_shift(8,"f"),X}function x(G,ne,ie){var X=_e(13);return X.write_shift(1,255),X.write_shift(2,ne),X.write_shift(2,G),X.write_shift(8,ie,"f"),X}function S(G,ne,ie){var X=G.l+ne,ve=u(G,ne,ie);if(ve[1].v=G.read_shift(8,"f"),ie.qpro)G.l=X;else{var Se=G.read_shift(2);P(G.slice(G.l,G.l+Se),ve),G.l+=Se}return ve}function A(G,ne,ie){var X=ne&32768;return ne&=-32769,ne=(X?G:0)+(ne>=8192?ne-16384:ne),(X?"":"$")+(ie?zr(ne):ln(ne))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function P(G,ne){Qn(G,0);for(var ie=[],X=0,ve="",Se="",Le="",Ne="";G.l<G.length;){var ke=G[G.l++];switch(ke){case 0:ie.push(G.read_shift(8,"f"));break;case 1:Se=A(ne[0].c,G.read_shift(2),!0),ve=A(ne[0].r,G.read_shift(2),!1),ie.push(Se+ve);break;case 2:{var rt=A(ne[0].c,G.read_shift(2),!0),ee=A(ne[0].r,G.read_shift(2),!1);Se=A(ne[0].c,G.read_shift(2),!0),ve=A(ne[0].r,G.read_shift(2),!1),ie.push(rt+ee+":"+Se+ve)}break;case 3:if(G.l<G.length){console.error("WK1 premature formula end");return}break;case 4:ie.push("("+ie.pop()+")");break;case 5:ie.push(G.read_shift(2));break;case 6:{for(var Dt="";ke=G[G.l++];)Dt+=String.fromCharCode(ke);ie.push('"'+Dt.replace(/"/g,'""')+'"')}break;case 8:ie.push("-"+ie.pop());break;case 23:ie.push("+"+ie.pop());break;case 22:ie.push("NOT("+ie.pop()+")");break;case 20:case 21:Ne=ie.pop(),Le=ie.pop(),ie.push(["AND","OR"][ke-20]+"("+Le+","+Ne+")");break;default:if(ke<32&&E[ke])Ne=ie.pop(),Le=ie.pop(),ie.push(Le+E[ke]+Ne);else if(k[ke]){if(X=k[ke][1],X==69&&(X=G[G.l++]),X>ie.length){console.error("WK1 bad formula parse 0x"+ke.toString(16)+":|"+ie.join("|")+"|");return}var Et=ie.slice(-X);ie.length-=X,ie.push(k[ke][0]+"("+Et.join(",")+")")}else return ke<=7?console.error("WK1 invalid opcode "+ke.toString(16)):ke<=24?console.error("WK1 unsupported op "+ke.toString(16)):ke<=30?console.error("WK1 invalid opcode "+ke.toString(16)):ke<=115?console.error("WK1 unsupported function opcode "+ke.toString(16)):console.error("WK1 unrecognized opcode "+ke.toString(16))}}ie.length==1?ne[1].f=""+ie[0]:console.error("WK1 bad formula parse |"+ie.join("|")+"|")}function Y(G){var ne=[{c:0,r:0},{t:"n",v:0},0];return ne[0].r=G.read_shift(2),ne[3]=G[G.l++],ne[0].c=G[G.l++],ne}function W(G,ne){var ie=Y(G);return ie[1].t="s",ie[1].v=G.read_shift(ne-4,"cstr"),ie}function T(G,ne,ie,X){var ve=_e(6+X.length);ve.write_shift(2,G),ve.write_shift(1,ie),ve.write_shift(1,ne),ve.write_shift(1,39);for(var Se=0;Se<X.length;++Se){var Le=X.charCodeAt(Se);ve.write_shift(1,Le>=128?95:Le)}return ve.write_shift(1,0),ve}function F(G,ne){var ie=Y(G);ie[1].v=G.read_shift(2);var X=ie[1].v>>1;if(ie[1].v&1)switch(X&7){case 0:X=(X>>3)*5e3;break;case 1:X=(X>>3)*500;break;case 2:X=(X>>3)/20;break;case 3:X=(X>>3)/200;break;case 4:X=(X>>3)/2e3;break;case 5:X=(X>>3)/2e4;break;case 6:X=(X>>3)/16;break;case 7:X=(X>>3)/64;break}return ie[1].v=X,ie}function w(G,ne){var ie=Y(G),X=G.read_shift(4),ve=G.read_shift(4),Se=G.read_shift(2);if(Se==65535)return X===0&&ve===3221225472?(ie[1].t="e",ie[1].v=15):X===0&&ve===3489660928?(ie[1].t="e",ie[1].v=42):ie[1].v=0,ie;var Le=Se&32768;return Se=(Se&32767)-16446,ie[1].v=(1-Le*2)*(ve*Math.pow(2,Se+32)+X*Math.pow(2,Se)),ie}function I(G,ne,ie,X){var ve=_e(14);if(ve.write_shift(2,G),ve.write_shift(1,ie),ve.write_shift(1,ne),X==0)return ve.write_shift(4,0),ve.write_shift(4,0),ve.write_shift(2,65535),ve;var Se=0,Le=0,Ne=0,ke=0;return X<0&&(Se=1,X=-X),Le=Math.log2(X)|0,X/=Math.pow(2,Le-31),ke=X>>>0,ke&2147483648||(X/=2,++Le,ke=X>>>0),X-=ke,ke|=2147483648,ke>>>=0,X*=Math.pow(2,32),Ne=X>>>0,ve.write_shift(4,Ne),ve.write_shift(4,ke),Le+=16383+(Se?32768:0),ve.write_shift(2,Le),ve}function R(G,ne){var ie=w(G);return G.l+=ne-14,ie}function D(G,ne){var ie=Y(G),X=G.read_shift(4);return ie[1].v=X>>6,ie}function N(G,ne){var ie=Y(G),X=G.read_shift(8,"f");return ie[1].v=X,ie}function Ge(G,ne){var ie=N(G);return G.l+=ne-10,ie}function Ee(G,ne){return G[G.l+ne-1]==0?G.read_shift(ne,"cstr"):""}function Pe(G,ne){var ie=G[G.l++];ie>ne-1&&(ie=ne-1);for(var X="";X.length<ie;)X+=String.fromCharCode(G[G.l++]);return X}function Ie(G,ne,ie){if(!(!ie.qpro||ne<21)){var X=G.read_shift(1);G.l+=17,G.l+=1,G.l+=2;var ve=G.read_shift(ne-21,"cstr");return[X,ve]}}function Ce(G,ne){for(var ie={},X=G.l+ne;G.l<X;){var ve=G.read_shift(2);if(ve==14e3){for(ie[ve]=[0,""],ie[ve][0]=G.read_shift(2);G[G.l];)ie[ve][1]+=String.fromCharCode(G[G.l]),G.l++;G.l++}}return ie}function se(G,ne){var ie=_e(5+G.length);ie.write_shift(2,14e3),ie.write_shift(2,ne);for(var X=0;X<G.length;++X){var ve=G.charCodeAt(X);ie[ie.l++]=ve>127?95:ve}return ie[ie.l++]=0,ie}var be={0:{n:"BOF",f:xn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:y},15:{n:"LABEL",f},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ee},222:{n:"SHEETNAMELP",f:Pe},65535:{n:""}},Be={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:W},23:{n:"NUMBER17",f:w},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:R},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ce},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:N},40:{n:"FORMULA28",f:Ge},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ee},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ie},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function y6(t){var e={},r=t.match(yi),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=ht(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=B1[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var _6=function(){var t=pf("t"),e=pf("rPr");function r(s){var a=s.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:qt(a[1])},l=s.match(e);return l&&(o.s=y6(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),E6=function(){var e=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),S6=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,w6=/<(?:\w+:)?r>/,T6=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ov(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=qt(vr(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=vr(t),r&&(n.h=K1(n.t))):t.match(w6)&&(n.r=vr(t),n.t=qt(vr((t.replace(T6,"").match(S6)||[]).join("").replace(yi,""))),r&&(n.h=E6(_6(n.r)))),n):{t:""}}var A6=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,C6=/<(?:\w+:)?(?:si|sstItem)>/g,k6=/<\/(?:\w+:)?(?:si|sstItem)>/;function F6(t,e){var r=[],n="";if(!t)return r;var i=t.match(A6);if(i){n=i[2].replace(C6,"").split(k6);for(var s=0;s!=n.length;++s){var a=ov(n[s].trim(),e);a!=null&&(r[r.length]=a)}i=ht(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var b6=/^\s|\s$|[\t\n\r]/;function HA(t,e){if(!e.bookSST)return"";var r=[cn];r[r.length]=Ve("sst",null,{xmlns:cc[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(b6)&&(s+=' xml:space="preserve"'),s+=">"+cr(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function I6(t){return[t.read_shift(4),t.read_shift(4)]}function N6(t,e){var r=[],n=!1;return go(t,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function R6(t,e){return e||(e=_e(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var D6=WR;function P6(t){var e=Ki();Fe(e,159,R6(t));for(var r=0;r<t.length;++r)Fe(e,19,D6(t[r]));return Fe(e,160),e.end()}function $A(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function eo(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function O6(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=eo(t,4),e.U=eo(t,4),e.W=eo(t,4),e}function M6(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function B6(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(M6(t));return e}function j6(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function L6(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=eo(t,4),e.U=eo(t,4),e.W=eo(t,4),e}function U6(t){var e=L6(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function GA(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function KA(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function V6(t){var e=eo(t);switch(e.Minor){case 2:return[e.Minor,z6(t)];case 3:return[e.Minor,W6()];case 4:return[e.Minor,H6(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function z6(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=GA(t,r),i=KA(t,t.length-t.l);return{t:"Std",h:n,v:i}}function W6(){throw new Error("File is password-protected: ECMA-376 Extensible")}function H6(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(yi,function(s){var a=ht(s);switch(Ra(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function $6(t,e){var r={},n=r.EncryptionVersionInfo=eo(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=GA(t,i),e-=i,r.EncryptionVerifier=KA(t,e),r}function G6(t){var e={},r=e.EncryptionVersionInfo=eo(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function lv(t){var e=0,r,n=$A(t),i=n.length+1,s,a,o,l,u;for(r=ol(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=e&16384?1:0,l=e<<1&32767,u=o|l,e=u^a;return e^52811}var YA=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],l=104,u=a.length-1;u>=0;--u)for(var f=a[u],p=0;p!=7;++p)f&64&&(o^=r[l]),f*=2,--l;return o};return function(a){for(var o=$A(a),l=s(o),u=o.length,f=ol(16),p=0;p!=16;++p)f[p]=0;var g,m,y;for((u&1)===1&&(g=l>>8,f[u]=i(t[0],g),--u,g=l&255,m=o[o.length-1],f[u]=i(m,g));u>0;)--u,g=l>>8,f[u]=i(o[u],g),--u,g=l&255,f[u]=i(o[u],g);for(u=15,y=15-o.length;y>0;)g=l>>8,f[u]=i(t[y],g),--u,--y,g=l&255,f[u]=i(o[u],g),--u,--y;return f}}(),K6=function(t,e,r,n,i){i||(i=e),n||(n=YA(t));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},Y6=function(t){var e=0,r=YA(t);return function(n){var i=K6("",n,e,r);return e=i[1],i[0]}};function X6(t,e,r,n){var i={key:xn(t),verificationBytes:xn(t)};return r.password&&(i.verifier=lv(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=Y6(r.password)),i}function q6(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=G6(t):n.Data=$6(t,e),n}function Q6(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?q6(t,e-2,n):X6(t,r.biff>=8?e:e-2,r,n),n}var XA=function(){function t(i,s){switch(s.type){case"base64":return e(fs(i),s);case"binary":return e(i,s);case"buffer":return e(It&&Buffer.isBuffer(i)?i.toString("binary"):xl(i),s);case"array":return e(Ql(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,p){Array.isArray(o)&&(o[p]=[]);for(var g=/\\\w+\b/g,m=0,y,x=-1;y=g.exec(f);){switch(y[0]){case"\\cell":var S=f.slice(m,g.lastIndex-y[0].length);if(S[0]==" "&&(S=S.slice(1)),++x,S.length){var A={v:S,t:"s"};Array.isArray(o)?o[p][x]=A:o[ft({r:p,c:x})]=A}break}m=g.lastIndex}x>u.e.c&&(u.e.c=x)}),o["!ref"]=Tt(u),o}function r(i,s){return vl(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=Qt(i["!ref"]),o,l=Array.isArray(i),u=a.s.r;u<=a.e.r;++u){s.push("\\trowd\\trautofit1");for(var f=a.s.c;f<=a.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=a.s.c;f<=a.e.c;++f){var p=ft({r:u,c:f});o=l?(i[u]||[])[f]:i[p],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(ao(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function J6(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function vf(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function Z6(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),a=i-s;if(a===0)return[0,0,e];var o=0,l=0,u=i+s;switch(l=a/(u>1?2-u:u),i){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,l,u/2]}function eP(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=i*o,a[0]+=i,a[1]+=l;break;case 1:l=i*(2-o),a[0]+=l,a[1]+=i;break;case 2:l=i*(o-2),a[1]+=i,a[2]+=l;break;case 3:l=i*(4-o),a[1]+=l,a[2]+=i;break;case 4:l=i*(o-4),a[2]+=i,a[0]+=l;break;case 5:l=i*(6-o),a[2]+=l,a[0]+=i;break}for(var u=0;u!=3;++u)a[u]=Math.round(a[u]*255);return a}function sp(t,e){if(e===0)return t;var r=Z6(J6(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),vf(eP(r))}var qA=6,tP=15,rP=1,fi=qA;function yf(t){return Math.floor((t+Math.round(128/fi)/256)*fi)}function _f(t){return Math.floor((t-5)/fi*100+.5)/100}function ap(t){return Math.round((t*fi+5)/fi*256)/256}function $g(t){return ap(_f(yf(t)))}function cv(t){var e=Math.abs(t-$g(t)),r=fi;if(e>.005)for(fi=rP;fi<tP;++fi)Math.abs(t-$g(t))<=e&&(e=Math.abs(t-$g(t)),r=fi);fi=r}function ll(t){t.width?(t.wpx=yf(t.width),t.wch=_f(t.wpx),t.MDW=fi):t.wpx?(t.wch=_f(t.wpx),t.width=ap(t.wch),t.MDW=fi):typeof t.wch=="number"&&(t.width=ap(t.wch),t.wpx=yf(t.width),t.MDW=fi),t.customWidth&&delete t.customWidth}var nP=96,QA=nP;function Ef(t){return t*96/QA}function _u(t){return t*QA/96}var iP={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function sP(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(yi)||[]).forEach(function(a){var o=ht(a);switch(Ra(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=br(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=br(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function aP(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(yi)||[]).forEach(function(a){var o=ht(a);switch(Ra(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function oP(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(yi)||[]).forEach(function(a){var o=ht(a);switch(Ra(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=vr(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?br(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?br(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?br(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?br(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?br(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?br(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?br(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=B1[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=br(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=Ll[i.color.index];i.color.index==81&&(l=Ll[1]),l||(l=Ll[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=sp(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function lP(t,e,r){e.NumberFmt=[];for(var n=Jr(ut),i=0;i<n.length;++i)e.NumberFmt[n[i]]=ut[n[i]];var s=t[0].match(yi);if(s)for(i=0;i<s.length;++i){var a=ht(s[i]);switch(Ra(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=qt(vr(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}Za(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function cP(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Ve("numFmt",null,{numFmtId:n,formatCode:cr(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Ve("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var V0=["numFmtId","fillId","fontId","borderId","xfId"],z0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function uP(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(yi)||[]).forEach(function(s){var a=ht(s),o=0;switch(Ra(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<V0.length;++o)n[V0[o]]&&(n[V0[o]]=parseInt(n[V0[o]],10));for(o=0;o<z0.length;++o)n[z0[o]]&&(n[z0[o]]=br(n[z0[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=br(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function dP(t){var e=[];return e[e.length]=Ve("cellXfs",null),t.forEach(function(r){e[e.length]=Ve("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Ve("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var fP=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,u){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=o.match(e))&&lP(p,f,u),(p=o.match(i))&&oP(p,f,l,u),(p=o.match(n))&&aP(p,f,l,u),(p=o.match(s))&&sP(p,f,l,u),(p=o.match(r))&&uP(p,f,u),f}}();function JA(t,e){var r=[cn,Ve("styleSheet",null,{xmlns:cc[0],"xmlns:vt":kn.vt})],n;return t.SSF&&(n=cP(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=dP(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function hP(t,e){var r=t.read_shift(2),n=gi(t);return[r,n]}function pP(t,e,r){r||(r=_e(6+4*e.length)),r.write_shift(2,t),Vn(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function gP(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=qR(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=XR(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=gi(t),n}function mP(t,e){e||(e=_e(25+4*32)),e.write_shift(2,t.sz*20),QR(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),rp(t.color,e);var n=0;return n=2,e.write_shift(1,n),Vn(t.name,e),e.length>e.l?e.slice(0,e.l):e}var xP=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Gg,vP=xi;function I_(t,e){e||(e=_e(4*3+8*7+16*1)),Gg||(Gg=Wp(xP));var r=Gg[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(rp({auto:1},e),rp({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function yP(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function ZA(t,e,r){r||(r=_e(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function ld(t,e){return e||(e=_e(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var _P=xi;function EP(t,e){return e||(e=_e(51)),e.write_shift(1,0),ld(null,e),ld(null,e),ld(null,e),ld(null,e),ld(null,e),e.length>e.l?e.slice(0,e.l):e}function SP(t,e){return e||(e=_e(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),tp(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function wP(t,e,r){var n=_e(2052);return n.write_shift(4,t),tp(e,n),tp(r,n),n.length>n.l?n.slice(0,n.l):n}function TP(t,e,r){var n={};n.NumberFmt=[];for(var i in ut)n.NumberFmt[i]=ut[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return go(t,function(l,u,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],Za(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=sp(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(f),a=!0;break;case 38:s.pop(),a=!1;break;default:if(u.T>0)s.push(f);else if(u.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function AP(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(Fe(t,615,oa(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Fe(t,44,pP(i,e[i]))}),Fe(t,616))}}function CP(t){var e=1;Fe(t,611,oa(e)),Fe(t,43,mP({sz:12,color:{theme:1},name:"Calibri",family:2})),Fe(t,612)}function kP(t){var e=2;Fe(t,603,oa(e)),Fe(t,45,I_({patternType:"none"})),Fe(t,45,I_({patternType:"gray125"})),Fe(t,604)}function FP(t){var e=1;Fe(t,613,oa(e)),Fe(t,46,EP()),Fe(t,614)}function bP(t){var e=1;Fe(t,626,oa(e)),Fe(t,47,ZA({numFmtId:0},65535)),Fe(t,627)}function IP(t,e){Fe(t,617,oa(e.length)),e.forEach(function(r){Fe(t,47,ZA(r,0))}),Fe(t,618)}function NP(t){var e=1;Fe(t,619,oa(e)),Fe(t,48,SP({xfId:0,name:"Normal"})),Fe(t,620)}function RP(t){var e=0;Fe(t,505,oa(e)),Fe(t,506)}function DP(t){var e=0;Fe(t,508,wP(e,"TableStyleMedium9","PivotStyleMedium4")),Fe(t,509)}function PP(t,e){var r=Ki();return Fe(r,278),AP(r,t.SSF),CP(r),kP(r),FP(r),bP(r),IP(r,e.cellXfs),NP(r),RP(r),DP(r),Fe(r,279),r.end()}var OP=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function MP(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(yi)||[]).forEach(function(i){var s=ht(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[OP.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function BP(){}function jP(){}var LP=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,UP=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,VP=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function zP(t,e,r){e.themeElements={};var n;[["clrScheme",LP,MP],["fontScheme",UP,BP],["fmtScheme",VP,jP]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var WP=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function eC(t,e){(!t||t.length===0)&&(t=uv());var r,n={};if(!(r=t.match(WP)))throw new Error("themeElements not found in theme");return zP(r[0],n,e),n.raw=t,n}function uv(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[cn];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function HP(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var a;try{a=GT(s,{type:"array"})}catch{return}var o=os(a,"theme/theme/theme1.xml",!0);if(o)return eC(o,r)}}function $P(t){return t.read_shift(4)}function GP(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=KP(t,4);break;case 2:e.xclrValue=DA(t);break;case 3:e.xclrValue=$P(t);break;case 4:t.l+=4;break}return t.l+=8,e}function KP(t,e){return xi(t,e)}function YP(t,e){return xi(t,e)}function XP(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=GP(t);break;case 6:n[1]=YP(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function qP(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push(XP(t,r-t.l));return{ixfe:n,ext:s}}function QP(t,e){e.forEach(function(r){switch(r[0]){}})}function JP(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:gi(t)}}function ZP(t){var e=_e(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Vn(t.name,e),e.slice(0,e.l)}function e8(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function t8(t){var e=_e(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function r8(t,e){var r=_e(8+2*e.length);return r.write_shift(4,t),Vn(e,r),r.slice(0,r.l)}function n8(t){return t.l+=4,t.read_shift(4)!=0}function i8(t,e){var r=_e(8);return r.write_shift(4,t),r.write_shift(4,1),r}function s8(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return go(t,function(l,u,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(p){o==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):o==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(f),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!u.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function a8(){var t=Ki();return Fe(t,332),Fe(t,334,oa(1)),Fe(t,335,ZP({name:"XLDAPR",version:12e4,flags:3496657072})),Fe(t,336),Fe(t,339,r8(1,"XLDAPR")),Fe(t,52),Fe(t,35,oa(514)),Fe(t,4096,oa(0)),Fe(t,4097,Is(1)),Fe(t,36),Fe(t,53),Fe(t,340),Fe(t,337,i8(1)),Fe(t,51,t8([[1,0]])),Fe(t,338),Fe(t,333),t.end()}function o8(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,a;return t.replace(yi,function(o){var l=ht(o);switch(Ra(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(a=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function tC(){var t=[cn];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function l8(t){var e=[];if(!t)return e;var r=1;return(t.match(yi)||[]).forEach(function(n){var i=ht(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function c8(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=ft(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function u8(t,e,r){var n=[];return go(t,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function d8(t,e,r,n){if(!t)return t;var i=n||{},s=!1;go(t,function(o,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},i)}function f8(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Xc=1024;function rC(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Ve("xml",null,{"xmlns:v":is.v,"xmlns:o":is.o,"xmlns:x":is.x,"xmlns:mv":is.mv}).replace(/\/>/,">"),Ve("o:shapelayout",Ve("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Ve("v:shapetype",[Ve("v:stroke",null,{joinstyle:"miter"}),Ve("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Xc<t*1e3;)Xc+=1e3;return e.forEach(function(s){var a=Wr(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?Ve("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Ve("v:fill",l,o),f={on:"t",obscured:"t"};++Xc,i=i.concat(["<v:shape"+gf({id:"_x0000_s"+Xc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Ve("v:shadow",null,f),Ve("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Jn("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Jn("x:AutoFill","False"),Jn("x:Row",String(a.r)),Jn("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function N_(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(a){var o=Wr(a.ref);if(i?(t[o.r]||(t[o.r]=[]),s=t[o.r][o.c]):s=t[a.ref],!s){s={t:"z"},i?t[o.r][o.c]=s:t[a.ref]=s;var l=Qt(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var u=Tt(l);u!==t["!ref"]&&(t["!ref"]=u)}s.c||(s.c=[]);var f={a:a.author,t:a.t,r:a.r,T:r};a.h&&(f.h=a.h);for(var p=s.c.length-1;p>=0;--p){if(!r&&s.c[p].T)return;r&&!s.c[p].T&&s.c.splice(p,1)}if(r&&n){for(p=0;p<n.length;++p)if(f.a==n[p].id){f.a=n[p].name||f.a;break}}s.c.push(f)})}function h8(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=ht(o[0]),u={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=Wr(l.ref);if(!(e.sheetRows&&e.sheetRows<=f.r)){var p=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!p&&!!p[1]&&ov(p[1])||{r:"",t:"",h:""};u.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),u.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(u.h=g.h),n.push(u)}}}}),n}function nC(t){var e=[cn,Ve("comments",null,{xmlns:cc[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=cr(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(cr(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Jn("t",cr(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(Jn("t",cr(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function p8(t,e){var r=[],n=!1,i={},s=0;return t.replace(yi,function(o,l){var u=ht(o);switch(Ra(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":i.t=t.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function g8(t,e,r){var n=[cn,Ve("ThreadedComments",null,{xmlns:kn.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(Ve("threadedComment",Jn("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function m8(t,e){var r=[],n=!1;return t.replace(yi,function(s){var a=ht(s);switch(Ra(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function x8(t){var e=[cn,Ve("personList",null,{xmlns:kn.TCMNT,"xmlns:x":cc[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Ve("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function v8(t){var e={};e.iauthor=t.read_shift(4);var r=hc(t);return e.rfx=r.s,e.ref=ft(r.s),t.l+=16,e}function y8(t,e){return e==null&&(e=_e(36)),e.write_shift(4,t[1].iauthor),Mu(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var _8=gi;function E8(t){return Vn(t.slice(0,54))}function S8(t,e){var r=[],n=[],i={},s=!1;return go(t,function(o,l,u){switch(u){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function w8(t){var e=Ki(),r=[];return Fe(e,628),Fe(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),Fe(e,632,E8(i.a)))})}),Fe(e,631),Fe(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Wr(n[0]),e:Wr(n[0])};Fe(e,635,y8([s,i])),i.t&&i.t.length>0&&Fe(e,637,$R(i)),Fe(e,636),delete i.iauthor})}),Fe(e,634),Fe(e,629),e.end()}var T8="application/vnd.ms-office.vbaProject";function A8(t){var e=it.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");it.utils.cfb_add(e,i,t.FileIndex[n].content)}}),it.write(e)}function C8(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&it.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var iC=["xlsb","xlsm","xlam","biff8","xla"];function k8(){return{"!type":"dialog"}}function F8(){return{"!type":"dialog"}}function b8(){return{"!type":"macro"}}function I8(){return{"!type":"macro"}}var su=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,f=a.length>0?parseInt(a,10)|0:0;return o?f+=e.c:--f,l?u+=e.r:--u,i+(o?"":"$")+zr(f)+(l?"":"$")+ln(u)}return function(i,s){return e=s,i.replace(t,r)}}(),dv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,fv=function(){return function(e,r){return e.replace(dv,function(n,i,s,a,o,l){var u=J1(a)-(s?0:r.c),f=Q1(l)-(o?0:r.r),p=f==0?"":o?f+1:"["+f+"]",g=u==0?"":s?u+1:"["+u+"]";return i+"R"+p+"C"+g})}}();function sC(t,e){return t.replace(dv,function(r,n,i,s,a,o){return n+(i=="$"?i+s:zr(J1(s)+e.c))+(a=="$"?a+o:ln(Q1(o)+e.r))})}function N8(t,e,r){var n=Yi(e),i=n.s,s=Wr(r),a={r:s.r-i.r,c:s.c-i.c};return sC(t,a)}function R8(t){return t.length!=1}function R_(t){return t.replace(/_xlfn\./g,"")}function hn(t){t.l+=1}function cl(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function aC(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return oC(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=cl(t),o=cl(t);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function oC(t){var e=cl(t),r=cl(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function D8(t,e,r){if(r.biff<8)return oC(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=cl(t),a=cl(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function lC(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return P8(t);var n=t.read_shift(r&&r.biff==12?4:2),i=cl(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function P8(t){var e=cl(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function O8(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function M8(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return B8(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function B8(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function j8(t,e,r){var n=(t[t.l++]&96)>>5,i=aC(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function L8(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=aC(t,s,r);return[n,i,a]}function U8(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function V8(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function z8(t,e,r){var n=(t[t.l++]&96)>>5,i=D8(t,e-1,r);return[n,i]}function W8(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function D_(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function H8(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function $8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function G8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function K8(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function Y8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function cC(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function X8(t){return t.read_shift(2),cC(t)}function q8(t){return t.read_shift(2),cC(t)}function Q8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=lC(t,0,r);return[n,i]}function J8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=M8(t,0,r);return[n,i]}function Z8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=lC(t,0,r);return[n,i,s]}function e5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[nO[i],fC[i],n]}function t5(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:r5(t);return[i,(s[0]===0?fC:rO)[s[1]]]}function r5(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function n5(t,e,r){t.l+=r&&r.biff==2?3:4}function i5(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function s5(t){return t.l++,mo[t.read_shift(1)]}function a5(t){return t.l++,t.read_shift(2)}function o5(t){return t.l++,t.read_shift(1)!==0}function l5(t){return t.l++,pi(t)}function c5(t,e,r){return t.l++,zf(t,e-1,r)}function u5(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=sn(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=mo[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=pi(t);break;case 2:r[1]=pc(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function d5(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?hc:Gp)(t));return i}function f5(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=u5(t,r.biff);return a}function h5(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function p5(t,e,r){if(r.biff==5)return g5(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function g5(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function m5(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function x5(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function v5(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function y5(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var _5=xi,E5=xi,S5=xi;function Hf(t,e,r){return t.l+=2,[O8(t)]}function hv(t){return t.l+=6,[]}var w5=Hf,T5=hv,A5=hv,C5=Hf;function uC(t){return t.l+=2,[xn(t),t.read_shift(2)&1]}var k5=Hf,F5=uC,b5=hv,I5=Hf,N5=Hf,R5=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function D5(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=R5[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function P5(t){return t.l+=2,[t.read_shift(4)]}function O5(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function M5(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function B5(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function j5(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function L5(t){return t.l+=4,[0,0]}var P_={1:{n:"PtgExp",f:i5},2:{n:"PtgTbl",f:S5},3:{n:"PtgAdd",f:hn},4:{n:"PtgSub",f:hn},5:{n:"PtgMul",f:hn},6:{n:"PtgDiv",f:hn},7:{n:"PtgPower",f:hn},8:{n:"PtgConcat",f:hn},9:{n:"PtgLt",f:hn},10:{n:"PtgLe",f:hn},11:{n:"PtgEq",f:hn},12:{n:"PtgGe",f:hn},13:{n:"PtgGt",f:hn},14:{n:"PtgNe",f:hn},15:{n:"PtgIsect",f:hn},16:{n:"PtgUnion",f:hn},17:{n:"PtgRange",f:hn},18:{n:"PtgUplus",f:hn},19:{n:"PtgUminus",f:hn},20:{n:"PtgPercent",f:hn},21:{n:"PtgParen",f:hn},22:{n:"PtgMissArg",f:hn},23:{n:"PtgStr",f:c5},26:{n:"PtgSheet",f:O5},27:{n:"PtgEndSheet",f:M5},28:{n:"PtgErr",f:s5},29:{n:"PtgBool",f:o5},30:{n:"PtgInt",f:a5},31:{n:"PtgNum",f:l5},32:{n:"PtgArray",f:W8},33:{n:"PtgFunc",f:e5},34:{n:"PtgFuncVar",f:t5},35:{n:"PtgName",f:h5},36:{n:"PtgRef",f:Q8},37:{n:"PtgArea",f:j8},38:{n:"PtgMemArea",f:m5},39:{n:"PtgMemErr",f:_5},40:{n:"PtgMemNoMem",f:E5},41:{n:"PtgMemFunc",f:x5},42:{n:"PtgRefErr",f:v5},43:{n:"PtgAreaErr",f:U8},44:{n:"PtgRefN",f:J8},45:{n:"PtgAreaN",f:z8},46:{n:"PtgMemAreaN",f:B5},47:{n:"PtgMemNoMemN",f:j5},57:{n:"PtgNameX",f:p5},58:{n:"PtgRef3d",f:Z8},59:{n:"PtgArea3d",f:L8},60:{n:"PtgRefErr3d",f:y5},61:{n:"PtgAreaErr3d",f:V8},255:{}},U5={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},V5={1:{n:"PtgElfLel",f:uC},2:{n:"PtgElfRw",f:I5},3:{n:"PtgElfCol",f:w5},6:{n:"PtgElfRwV",f:N5},7:{n:"PtgElfColV",f:C5},10:{n:"PtgElfRadical",f:k5},11:{n:"PtgElfRadicalS",f:b5},13:{n:"PtgElfColS",f:T5},15:{n:"PtgElfColSV",f:A5},16:{n:"PtgElfRadicalLel",f:F5},25:{n:"PtgList",f:D5},29:{n:"PtgSxName",f:P5},255:{}},z5={0:{n:"PtgAttrNoop",f:L5},1:{n:"PtgAttrSemi",f:Y8},2:{n:"PtgAttrIf",f:G8},4:{n:"PtgAttrChoose",f:H8},8:{n:"PtgAttrGoto",f:$8},16:{n:"PtgAttrSum",f:n5},32:{n:"PtgAttrBaxcel",f:D_},33:{n:"PtgAttrBaxcel",f:D_},64:{n:"PtgAttrSpace",f:X8},65:{n:"PtgAttrSpaceSemi",f:q8},128:{n:"PtgAttrIfError",f:K8},255:{}};function $f(t,e,r,n){if(n.biff<8)return xi(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=f5(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=d5(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(xi(t,e)),s}function Gf(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=P_[s]||P_[U5[s]],(s===24||s===25)&&(i=(s===24?V5:z5)[t[t.l+1]]),!i||!i.f?xi(t,e):a.push([i.n,i.f(t,e,r)]);return a}function W5(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var H5={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function $5(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function dC(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function O_(t,e,r){var n=dC(t,e,r);return n=="#REF"?n:$5(n,r)}function ui(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,u,f,p=0,g=0,m,y="";if(!t[0]||!t[0][0])return"";for(var x=-1,S="",A=0,k=t[0].length;A<k;++A){var E=t[0][A];switch(E[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),x>=0){switch(t[0][x][1][0]){case 0:S=Xr(" ",t[0][x][1][1]);break;case 1:S=Xr("\r",t[0][x][1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}u=u+S,x=-1}o.push(u+H5[E[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Od(E[1][1],a,i),o.push(Md(f,s));break;case"PtgRefN":f=r?Od(E[1][1],r,i):E[1][1],o.push(Md(f,s));break;case"PtgRef3d":p=E[1][1],f=Od(E[1][2],a,i),y=O_(n,p,i),o.push(y+"!"+Md(f,s));break;case"PtgFunc":case"PtgFuncVar":var P=E[1][0],Y=E[1][1];P||(P=0),P&=127;var W=P==0?[]:o.slice(-P);o.length-=P,Y==="User"&&(Y=W.shift()),o.push(Y+"("+W.join(",")+")");break;case"PtgBool":o.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(E[1]);break;case"PtgNum":o.push(String(E[1]));break;case"PtgStr":o.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(E[1]);break;case"PtgAreaN":m=u_(E[1][1],r?{s:r}:a,i),o.push(zg(m,i));break;case"PtgArea":m=u_(E[1][1],a,i),o.push(zg(m,i));break;case"PtgArea3d":p=E[1][1],m=E[1][2],y=O_(n,p,i),o.push(y+"!"+zg(m,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=E[1][2];var T=(n.names||[])[g-1]||(n[0]||[])[g],F=T?T.Name:"SH33TJSNAME"+String(g);F&&F.slice(0,6)=="_xlfn."&&!i.xlfn&&(F=F.slice(6)),o.push(F);break;case"PtgNameX":var w=E[1][1];g=E[1][2];var I;if(i.biff<=5)w<0&&(w=-w),n[w]&&(I=n[w][g]);else{var R="";if(((n[w]||[])[0]||[])[0]==14849||(((n[w]||[])[0]||[])[0]==1025?n[w][g]&&n[w][g].itab>0&&(R=n.SheetNames[n[w][g].itab-1]+"!"):R=n.SheetNames[g-1]+"!"),n[w]&&n[w][g])R+=n[w][g].Name;else if(n[0]&&n[0][g])R+=n[0][g].Name;else{var D=(dC(n,w,i)||"").split(";;");D[g-1]?R=D[g-1]:R+="SH33TJSERRX"}o.push(R);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var N="(",Ge=")";if(x>=0){switch(S="",t[0][x][1][0]){case 2:N=Xr(" ",t[0][x][1][1])+N;break;case 3:N=Xr("\r",t[0][x][1][1])+N;break;case 4:Ge=Xr(" ",t[0][x][1][1])+Ge;break;case 5:Ge=Xr("\r",t[0][x][1][1])+Ge;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}x=-1}o.push(N+o.pop()+Ge);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:E[1][1],r:E[1][0]};var Ee={c:r.c,r:r.r};if(n.sharedf[ft(f)]){var Pe=n.sharedf[ft(f)];o.push(ui(Pe,a,Ee,n,i))}else{var Ie=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){o.push(ui(u[1],a,Ee,n,i)),Ie=!0;break}Ie||o.push(E[1])}break;case"PtgArray":o.push("{"+W5(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=A;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var Ce=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&Ce.indexOf(t[0][A][0])==-1){E=t[0][x];var se=!0;switch(E[1][0]){case 4:se=!1;case 0:S=Xr(" ",E[1][1]);break;case 5:se=!1;case 1:S=Xr("\r",E[1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}o.push((se?S:"")+o.pop()+(se?"":S)),x=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function G5(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],xi(t,e-2)];var o=Gf(t,a,r);return e!==a+i&&(s=$f(t,e-a-i,o,r)),t.l=n,[o,s]}function K5(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],xi(t,e-2)];var o=Gf(t,a,r);return e!==a+i&&(s=$f(t,e-a-i,o,r)),t.l=n,[o,s]}function Y5(t,e,r,n){var i=t.l+e,s=Gf(t,n,r),a;return i!==t.l&&(a=$f(t,i-t.l,s,r)),[s,a]}function X5(t,e,r){var n=t.l+e,i,s=t.read_shift(2),a=Gf(t,s,r);return s==65535?[[],xi(t,e-2)]:(e!==s+2&&(i=$f(t,n-s-2,a,r)),[a,i])}function q5(t){var e;if(Ka(t,t.l+6)!==65535)return[pi(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function Q5(t){if(t==null){var e=_e(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Jl(t);return Jl(0)}function Kg(t,e,r){var n=t.l+e,i=Da(t);r.biff==2&&++t.l;var s=q5(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=K5(t,n-t.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function J5(t,e,r,n,i){var s=ec(e,r,i),a=Q5(t.v),o=_e(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=_e(t.bf.length),f=0;f<t.bf.length;++f)u[f]=t.bf[f];var p=Un([s,a,o,u]);return p}function Kp(t,e,r){var n=t.read_shift(4),i=Gf(t,n,r),s=t.read_shift(4),a=s>0?$f(t,s,i,r):null;return[i,a]}var Z5=Kp,Yp=Kp,eO=Kp,tO=Kp,rO={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},fC={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},nO={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function M_(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function iO(t){var e="of:="+t.replace(dv,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Yg(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function sO(t){return t.replace(/\./,"!")}var jd={},au={},Ld=typeof Map<"u";function pv(t,e,r){var n=0,i=t.length;if(r){if(Ld?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=Ld?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(Ld?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function Xp(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(fi=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=_f(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=ap(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function zl(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function yl(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Za(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function hC(t,e,r,n,i,s){try{n.cellNF&&(t.z=ut[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Nr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(ut[e]==null&&Za(rR[e]||"General",e),t.t==="e")t.w=t.w||mo[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=hf(t.v);else if(t.t==="d"){var a=Nn(t.v);(a|0)===a?t.w=a.toString(10):t.w=hf(a)}else{if(t.v===void 0)return"";t.w=ql(t.v,au)}else t.t==="d"?t.w=Ls(e,Nn(t.v),au):t.w=Ls(e,t.v,au)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=sp(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=sp(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function aO(t,e,r){if(t&&t["!ref"]){var n=Qt(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function oO(t,e){var r=Qt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Tt(r))}var lO=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,cO=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,uO=/<(?:\w:)?hyperlink [^>]*>/mg,dO=/"(\w*:\w*)"/,fO=/<(?:\w:)?col\b[^>]*[\/]?>/g,hO=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,pO=/<(?:\w:)?pageMargins[^>]*\/>/g,pC=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,gO=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,mO=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function xO(t,e,r,n,i,s,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",f="",p=t.match(cO);p?(u=t.slice(0,p.index),f=t.slice(p.index+p[0].length)):u=f=t;var g=u.match(pC);g?gv(g[0],o,i,r):(g=u.match(gO))&&yO(g[0],g[1]||"",o,i,r);var m=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var y=u.slice(m,m+50).match(dO);y&&oO(o,y[1])}var x=u.match(mO);x&&x[1]&&RO(x[1],i);var S=[];if(e.cellStyles){var A=u.match(fO);A&&kO(S,A)}p&&OO(p[1],o,e,l,s,a);var k=f.match(hO);k&&(o["!autofilter"]=bO(k[0]));var E=[],P=f.match(lO);if(P)for(m=0;m!=P.length;++m)E[m]=Qt(P[m].slice(P[m].indexOf('"')+1));var Y=f.match(uO);Y&&TO(o,Y,n);var W=f.match(pO);if(W&&(o["!margins"]=AO(ht(W[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Tt(l)),e.sheetRows>0&&o["!ref"]){var T=Qt(o["!ref"]);e.sheetRows<=+T.e.r&&(T.e.r=e.sheetRows-1,T.e.r>l.e.r&&(T.e.r=l.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>l.e.c&&(T.e.c=l.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Tt(T))}return S.length>0&&(o["!cols"]=S),E.length>0&&(o["!merges"]=E),o}function vO(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Tt(t[r])+'"/>';return e+"</mergeCells>"}function gv(t,e,r,n){var i=ht(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=qt(vr(i.codeName)))}function yO(t,e,r,n,i){gv(t.slice(0,t.indexOf(">")),r,n,i)}function _O(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=wa(cr(l))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),o=(o||"")+Ve("outlinePr",null,u)}!s&&!o||(i[i.length]=Ve("sheetPr",o,a))}var EO=["objects","scenarios","selectLockedCells","selectUnlockedCells"],SO=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function wO(t){var e={sheet:1};return EO.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),SO.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=lv(t.password).toString(16).toUpperCase()),Ve("sheetProtection",null,e)}function TO(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=ht(vr(e[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+qt(s.location))):(s.Target="#"+qt(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Qt(s.ref),l=o.s.r;l<=o.e.r;++l)for(var u=o.s.c;u<=o.e.c;++u){var f=ft({c:u,r:l});n?(t[l]||(t[l]=[]),t[l][u]||(t[l][u]={t:"z",v:void 0}),t[l][u].l=s):(t[f]||(t[f]={t:"z",v:void 0}),t[f].l=s)}}}function AO(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function CO(t){return zl(t),Ve("pageMargins",null,t)}function kO(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=ht(e[n],!0);i.hidden&&(i.hidden=br(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,cv(i.width)),ll(i);s<=a;)t[s++]=Rr(i)}}function FO(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=Ve("col",null,Xp(i,n)));return r[r.length]="</cols>",r.join("")}function bO(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function IO(t,e,r,n){var i=typeof t.ref=="string"?t.ref:Tt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=Yi(i);a.s.r==a.e.r&&(a.e.r=Yi(e["!ref"]).e.r,i=Tt(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Ve("autoFilter",null,{ref:i})}var NO=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function RO(t,e){e.Views||(e.Views=[{}]),(t.match(NO)||[]).forEach(function(r,n){var i=ht(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),br(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function DO(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ve("sheetViews",Ve("sheetView",null,i),{})}function PO(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=mo[t.v];break;case"d":n&&n.cellDates?i=Nr(t.v,-1).toISOString():(t=Rr(t),t.t="n",i=""+(t.v=Nn(Nr(t.v)))),typeof t.z>"u"&&(t.z=ut[14]);break;default:i=t.v;break}var o=Jn("v",cr(i)),l={r:e},u=yl(n.cellXfs,t,n);switch(u!==0&&(l.s=u),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Jn("v",""+pv(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=a),typeof t.f=="string"&&t.f){var f=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=Ve("f",cr(t.f),f)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),Ve("c",o,l)}var OO=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=pf("v"),a=pf("f");return function(l,u,f,p,g,m){for(var y=0,x="",S=[],A=[],k=0,E=0,P=0,Y="",W,T,F=0,w=0,I,R,D=0,N=0,Ge=Array.isArray(m.CellXf),Ee,Pe=[],Ie=[],Ce=Array.isArray(u),se=[],be={},Be=!1,G=!!f.sheetStubs,ne=l.split(e),ie=0,X=ne.length;ie!=X;++ie){x=ne[ie].trim();var ve=x.length;if(ve!==0){var Se=0;e:for(y=0;y<ve;++y)switch(x[y]){case">":if(x[y-1]!="/"){++y;break e}if(f&&f.cellStyles){if(T=ht(x.slice(Se,y),!0),F=T.r!=null?parseInt(T.r,10):F+1,w=-1,f.sheetRows&&f.sheetRows<F)continue;be={},Be=!1,T.ht&&(Be=!0,be.hpt=parseFloat(T.ht),be.hpx=_u(be.hpt)),T.hidden=="1"&&(Be=!0,be.hidden=!0),T.outlineLevel!=null&&(Be=!0,be.level=+T.outlineLevel),Be&&(se[F-1]=be)}break;case"<":Se=y;break}if(Se>=y)break;if(T=ht(x.slice(Se,y),!0),F=T.r!=null?parseInt(T.r,10):F+1,w=-1,!(f.sheetRows&&f.sheetRows<F)){p.s.r>F-1&&(p.s.r=F-1),p.e.r<F-1&&(p.e.r=F-1),f&&f.cellStyles&&(be={},Be=!1,T.ht&&(Be=!0,be.hpt=parseFloat(T.ht),be.hpx=_u(be.hpt)),T.hidden=="1"&&(Be=!0,be.hidden=!0),T.outlineLevel!=null&&(Be=!0,be.level=+T.outlineLevel),Be&&(se[F-1]=be)),S=x.slice(y).split(t);for(var Le=0;Le!=S.length&&S[Le].trim().charAt(0)=="<";++Le);for(S=S.slice(Le),y=0;y!=S.length;++y)if(x=S[y].trim(),x.length!==0){if(A=x.match(r),k=y,E=0,P=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,A!=null&&A.length===2){for(k=0,Y=A[1],E=0;E!=Y.length&&!((P=Y.charCodeAt(E)-64)<1||P>26);++E)k=26*k+P;--k,w=k}else++w;for(E=0;E!=x.length&&x.charCodeAt(E)!==62;++E);if(++E,T=ht(x.slice(0,E),!0),T.r||(T.r=ft({r:F-1,c:w})),Y=x.slice(E),W={t:""},(A=Y.match(s))!=null&&A[1]!==""&&(W.v=qt(A[1])),f.cellFormula){if((A=Y.match(a))!=null&&A[1]!==""){if(W.f=qt(vr(A[1])).replace(/\r\n/g,`
`),f.xlfn||(W.f=R_(W.f)),A[0].indexOf('t="array"')>-1)W.F=(Y.match(i)||[])[1],W.F.indexOf(":")>-1&&Pe.push([Qt(W.F),W.F]);else if(A[0].indexOf('t="shared"')>-1){R=ht(A[0]);var Ne=qt(vr(A[1]));f.xlfn||(Ne=R_(Ne)),Ie[parseInt(R.si,10)]=[R,Ne,T.r]}}else(A=Y.match(/<f[^>]*\/>/))&&(R=ht(A[0]),Ie[R.si]&&(W.f=N8(Ie[R.si][1],Ie[R.si][2],T.r)));var ke=Wr(T.r);for(E=0;E<Pe.length;++E)ke.r>=Pe[E][0].s.r&&ke.r<=Pe[E][0].e.r&&ke.c>=Pe[E][0].s.c&&ke.c<=Pe[E][0].e.c&&(W.F=Pe[E][1])}if(T.t==null&&W.v===void 0)if(W.f||W.F)W.v=0,W.t="n";else if(G)W.t="z";else continue;else W.t=T.t||"n";switch(p.s.c>w&&(p.s.c=w),p.e.c<w&&(p.e.c=w),W.t){case"n":if(W.v==""||W.v==null){if(!G)continue;W.t="z"}else W.v=parseFloat(W.v);break;case"s":if(typeof W.v>"u"){if(!G)continue;W.t="z"}else I=jd[parseInt(W.v,10)],W.v=I.t,W.r=I.r,f.cellHTML&&(W.h=I.h);break;case"str":W.t="s",W.v=W.v!=null?vr(W.v):"",f.cellHTML&&(W.h=K1(W.v));break;case"inlineStr":A=Y.match(n),W.t="s",A!=null&&(I=ov(A[1]))?(W.v=I.t,f.cellHTML&&(W.h=I.h)):W.v="";break;case"b":W.v=br(W.v);break;case"d":f.cellDates?W.v=Nr(W.v,1):(W.v=Nn(Nr(W.v,1)),W.t="n");break;case"e":(!f||f.cellText!==!1)&&(W.w=W.v),W.v=mA[W.v];break}if(D=N=0,Ee=null,Ge&&T.s!==void 0&&(Ee=m.CellXf[T.s],Ee!=null&&(Ee.numFmtId!=null&&(D=Ee.numFmtId),f.cellStyles&&Ee.fillId!=null&&(N=Ee.fillId))),hC(W,D,N,f,g,m),f.cellDates&&Ge&&W.t=="n"&&Du(ut[D])&&(W.t="d",W.v=$p(W.v)),T.cm&&f.xlmeta){var rt=(f.xlmeta.Cell||[])[+T.cm-1];rt&&rt.type=="XLDAPR"&&(W.D=!0)}if(Ce){var ee=Wr(T.r);u[ee.r]||(u[ee.r]=[]),u[ee.r][ee.c]=W}else u[T.r]=W}}}}se.length>0&&(u["!rows"]=se)}}();function MO(t,e,r,n){var i=[],s=[],a=Qt(t["!ref"]),o="",l,u="",f=[],p=0,g=0,m=t["!rows"],y=Array.isArray(t),x={r:u},S,A=-1;for(g=a.s.c;g<=a.e.c;++g)f[g]=zr(g);for(p=a.s.r;p<=a.e.r;++p){for(s=[],u=ln(p),g=a.s.c;g<=a.e.c;++g){l=f[g]+u;var k=y?(t[p]||[])[g]:t[l];k!==void 0&&(o=PO(k,l,t,e))!=null&&s.push(o)}(s.length>0||m&&m[p])&&(x={r:u},m&&m[p]&&(S=m[p],S.hidden&&(x.hidden=1),A=-1,S.hpx?A=Ef(S.hpx):S.hpt&&(A=S.hpt),A>-1&&(x.ht=A,x.customHeight=1),S.level&&(x.outlineLevel=S.level)),i[i.length]=Ve("row",s.join(""),x))}if(m)for(;p<m.length;++p)m&&m[p]&&(x={r:p+1},S=m[p],S.hidden&&(x.hidden=1),A=-1,S.hpx?A=Ef(S.hpx):S.hpt&&(A=S.hpt),A>-1&&(x.ht=A,x.customHeight=1),S.level&&(x.outlineLevel=S.level),i[i.length]=Ve("row","",x));return i.join("")}function gC(t,e,r,n){var i=[cn,Ve("worksheet",null,{xmlns:cc[0],"xmlns:r":kn.r})],s=r.SheetNames[t],a=0,o="",l=r.Sheets[s];l==null&&(l={});var u=l["!ref"]||"A1",f=Qt(u);if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),u=Tt(f)}n||(n={}),l["!comments"]=[];var p=[];_O(l,r,t,e,i),i[i.length]=Ve("dimension",null,{ref:u}),i[i.length]=DO(l,e,t,r),e.sheetFormat&&(i[i.length]=Ve("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=FO(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=MO(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=wO(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=IO(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=vO(l["!merges"]));var g=-1,m,y=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(m={ref:x[0]},x[1].Target.charAt(0)!="#"&&(y=lr(n,-1,cr(x[1].Target).replace(/#.*$/,""),Rt.HLINK),m["r:id"]="rId"+y),(g=x[1].Target.indexOf("#"))>-1&&(m.location=cr(x[1].Target.slice(g+1))),x[1].Tooltip&&(m.tooltip=cr(x[1].Tooltip)),i[i.length]=Ve("hyperlink",null,m))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=CO(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Jn("ignoredErrors",Ve("ignoredError",null,{numberStoredAsText:1,sqref:u}))),p.length>0&&(y=lr(n,-1,"../drawings/drawing"+(t+1)+".xml",Rt.DRAW),i[i.length]=Ve("drawing",null,{"r:id":"rId"+y}),l["!drawing"]=p),l["!comments"].length>0&&(y=lr(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Rt.VML),i[i.length]=Ve("legacyDrawing",null,{"r:id":"rId"+y}),l["!legacy"]=y),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function BO(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function jO(t,e,r){var n=_e(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=Ef(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var u={r:t,c:0},f=0;f<16;++f)if(!(e.s.c>f+1<<10||e.e.c<f<<10)){for(var p=-1,g=-1,m=f<<10;m<f+1<<10;++m){u.c=m;var y=Array.isArray(r)?(r[u.r]||[])[u.c]:r[ft(u)];y&&(p<0&&(p=m),g=m)}p<0||(++o,n.write_shift(4,p),n.write_shift(4,g))}var x=n.l;return n.l=l,n.write_shift(4,o),n.l=x,n.length>n.l?n.slice(0,n.l):n}function LO(t,e,r,n){var i=jO(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&Fe(t,0,i)}var UO=hc,VO=Mu;function zO(){}function WO(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=GR(t),r}function HO(t,e,r){r==null&&(r=_e(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return rp({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),dA(t,r),r.slice(0,r.l)}function $O(t){var e=Us(t);return[e]}function GO(t,e,r){return r==null&&(r=_e(8)),uc(e,r)}function KO(t){var e=dc(t);return[e]}function YO(t,e,r){return r==null&&(r=_e(4)),fc(e,r)}function XO(t){var e=Us(t),r=t.read_shift(1);return[e,r,"b"]}function qO(t,e,r){return r==null&&(r=_e(9)),uc(e,r),r.write_shift(1,t.v?1:0),r}function QO(t){var e=dc(t),r=t.read_shift(1);return[e,r,"b"]}function JO(t,e,r){return r==null&&(r=_e(5)),fc(e,r),r.write_shift(1,t.v?1:0),r}function ZO(t){var e=Us(t),r=t.read_shift(1);return[e,r,"e"]}function eM(t,e,r){return r==null&&(r=_e(9)),uc(e,r),r.write_shift(1,t.v),r}function tM(t){var e=dc(t),r=t.read_shift(1);return[e,r,"e"]}function rM(t,e,r){return r==null&&(r=_e(8)),fc(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function nM(t){var e=Us(t),r=t.read_shift(4);return[e,r,"s"]}function iM(t,e,r){return r==null&&(r=_e(12)),uc(e,r),r.write_shift(4,e.v),r}function sM(t){var e=dc(t),r=t.read_shift(4);return[e,r,"s"]}function aM(t,e,r){return r==null&&(r=_e(8)),fc(e,r),r.write_shift(4,e.v),r}function oM(t){var e=Us(t),r=pi(t);return[e,r,"n"]}function lM(t,e,r){return r==null&&(r=_e(16)),uc(e,r),Jl(t.v,r),r}function mC(t){var e=dc(t),r=pi(t);return[e,r,"n"]}function cM(t,e,r){return r==null&&(r=_e(12)),fc(e,r),Jl(t.v,r),r}function uM(t){var e=Us(t),r=rv(t);return[e,r,"n"]}function dM(t,e,r){return r==null&&(r=_e(12)),uc(e,r),fA(t.v,r),r}function fM(t){var e=dc(t),r=rv(t);return[e,r,"n"]}function hM(t,e,r){return r==null&&(r=_e(8)),fc(e,r),fA(t.v,r),r}function pM(t){var e=Us(t),r=Z1(t);return[e,r,"is"]}function gM(t){var e=Us(t),r=gi(t);return[e,r,"str"]}function mM(t,e,r){return r==null&&(r=_e(12+4*t.v.length)),uc(e,r),Vn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function xM(t){var e=dc(t),r=gi(t);return[e,r,"str"]}function vM(t,e,r){return r==null&&(r=_e(8+4*t.v.length)),fc(e,r),Vn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function yM(t,e,r){var n=t.l+e,i=Us(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=Yp(t,n-t.l,r);a[3]=ui(o,null,i,r.supbooks,r)}else t.l=n;return a}function _M(t,e,r){var n=t.l+e,i=Us(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=Yp(t,n-t.l,r);a[3]=ui(o,null,i,r.supbooks,r)}else t.l=n;return a}function EM(t,e,r){var n=t.l+e,i=Us(t);i.r=r["!row"];var s=pi(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=Yp(t,n-t.l,r);a[3]=ui(o,null,i,r.supbooks,r)}else t.l=n;return a}function SM(t,e,r){var n=t.l+e,i=Us(t);i.r=r["!row"];var s=gi(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=Yp(t,n-t.l,r);a[3]=ui(o,null,i,r.supbooks,r)}else t.l=n;return a}var wM=hc,TM=Mu;function AM(t,e){return e==null&&(e=_e(4)),e.write_shift(4,t),e}function CM(t,e){var r=t.l+e,n=hc(t),i=ev(t),s=gi(t),a=gi(t),o=gi(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function kM(t,e){var r=_e(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Mu({s:Wr(t[0]),e:Wr(t[0])},r),tv("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return Vn(i||"",r),Vn(t[1].Tooltip||"",r),Vn("",r),r.slice(0,r.l)}function FM(){}function bM(t,e,r){var n=t.l+e,i=hA(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=Z5(t,n-t.l,r);a[1]=o}else t.l=n;return a}function IM(t,e,r){var n=t.l+e,i=hc(t),s=[i];if(r.cellFormula){var a=tO(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function NM(t,e,r){r==null&&(r=_e(18));var n=Xp(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var xC=["left","right","top","bottom","header","footer"];function RM(t){var e={};return xC.forEach(function(r){e[r]=pi(t)}),e}function DM(t,e){return e==null&&(e=_e(6*8)),zl(t),xC.forEach(function(r){Jl(t[r],e)}),e}function PM(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function OM(t,e,r){r==null&&(r=_e(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function MM(t){var e=_e(24);return e.write_shift(4,4),e.write_shift(4,1),Mu(t,e),e}function BM(t,e){return e==null&&(e=_e(16*4+2)),e.write_shift(2,t.password?lv(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function jM(){}function LM(){}function UM(t,e,r,n,i,s,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},u,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,g=!1,m,y,x,S,A,k,E,P,Y,W=[];o.biff=12,o["!row"]=0;var T=0,F=!1,w=[],I={},R=o.supbooks||i.supbooks||[[]];if(R.sharedf=I,R.arrayf=w,R.SheetNames=i.SheetNames||i.Sheets.map(function(Ce){return Ce.name}),!o.supbooks&&(o.supbooks=R,i.Names))for(var D=0;D<i.Names.length;++D)R[0][D+1]=i.Names[D];var N=[],Ge=[],Ee=!1;Sf[16]={n:"BrtShortReal",f:mC};var Pe;if(go(t,function(se,be,Be){if(!g)switch(Be){case 148:u=se;break;case 0:m=se,o.sheetRows&&o.sheetRows<=m.r&&(g=!0),P=ln(S=m.r),o["!row"]=m.r,(se.hidden||se.hpt||se.level!=null)&&(se.hpt&&(se.hpx=_u(se.hpt)),Ge[se.r]=se);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:se[2]},se[2]){case"n":y.v=se[1];break;case"s":E=jd[se[1]],y.v=E.t,y.r=E.r;break;case"b":y.v=!!se[1];break;case"e":y.v=se[1],o.cellText!==!1&&(y.w=mo[y.v]);break;case"str":y.t="s",y.v=se[1];break;case"is":y.t="s",y.v=se[1].t;break}if((x=a.CellXf[se[0].iStyleRef])&&hC(y,x.numFmtId,null,o,s,a),A=se[0].c==-1?A+1:se[0].c,o.dense?(l[S]||(l[S]=[]),l[S][A]=y):l[zr(A)+P]=y,o.cellFormula){for(F=!1,T=0;T<w.length;++T){var G=w[T];m.r>=G[0].s.r&&m.r<=G[0].e.r&&A>=G[0].s.c&&A<=G[0].e.c&&(y.F=Tt(G[0]),F=!0)}!F&&se.length>3&&(y.f=se[3])}if(f.s.r>m.r&&(f.s.r=m.r),f.s.c>A&&(f.s.c=A),f.e.r<m.r&&(f.e.r=m.r),f.e.c<A&&(f.e.c=A),o.cellDates&&x&&y.t=="n"&&Du(ut[x.numFmtId])){var ne=Ol(y.v);ne&&(y.t="d",y.v=new Date(ne.y,ne.m-1,ne.d,ne.H,ne.M,ne.S,ne.u))}Pe&&(Pe.type=="XLDAPR"&&(y.D=!0),Pe=void 0);break;case 1:case 12:if(!o.sheetStubs||p)break;y={t:"z",v:void 0},A=se[0].c==-1?A+1:se[0].c,o.dense?(l[S]||(l[S]=[]),l[S][A]=y):l[zr(A)+P]=y,f.s.r>m.r&&(f.s.r=m.r),f.s.c>A&&(f.s.c=A),f.e.r<m.r&&(f.e.r=m.r),f.e.c<A&&(f.e.c=A),Pe&&(Pe.type=="XLDAPR"&&(y.D=!0),Pe=void 0);break;case 176:W.push(se);break;case 49:Pe=((o.xlmeta||{}).Cell||[])[se-1];break;case 494:var ie=n["!id"][se.relId];for(ie?(se.Target=ie.Target,se.loc&&(se.Target+="#"+se.loc),se.Rel=ie):se.relId==""&&(se.Target="#"+se.loc),S=se.rfx.s.r;S<=se.rfx.e.r;++S)for(A=se.rfx.s.c;A<=se.rfx.e.c;++A)o.dense?(l[S]||(l[S]=[]),l[S][A]||(l[S][A]={t:"z",v:void 0}),l[S][A].l=se):(k=ft({c:A,r:S}),l[k]||(l[k]={t:"z",v:void 0}),l[k].l=se);break;case 426:if(!o.cellFormula)break;w.push(se),Y=o.dense?l[S][A]:l[zr(A)+P],Y.f=ui(se[1],f,{r:m.r,c:A},R,o),Y.F=Tt(se[0]);break;case 427:if(!o.cellFormula)break;I[ft(se[0].s)]=se[1],Y=o.dense?l[S][A]:l[zr(A)+P],Y.f=ui(se[1],f,{r:m.r,c:A},R,o);break;case 60:if(!o.cellStyles)break;for(;se.e>=se.s;)N[se.e--]={width:se.w/256,hidden:!!(se.flags&1),level:se.level},Ee||(Ee=!0,cv(se.w/256)),ll(N[se.e+1]);break;case 161:l["!autofilter"]={ref:Tt(se)};break;case 476:l["!margins"]=se;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),se.name&&(i.Sheets[r].CodeName=se.name),(se.above||se.left)&&(l["!outline"]={above:se.above,left:se.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),se.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!be.T){if(!p||o.WTF)throw new Error("Unexpected record 0x"+Be.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=Tt(u||f)),o.sheetRows&&l["!ref"]){var Ie=Qt(l["!ref"]);o.sheetRows<=+Ie.e.r&&(Ie.e.r=o.sheetRows-1,Ie.e.r>f.e.r&&(Ie.e.r=f.e.r),Ie.e.r<Ie.s.r&&(Ie.s.r=Ie.e.r),Ie.e.c>f.e.c&&(Ie.e.c=f.e.c),Ie.e.c<Ie.s.c&&(Ie.s.c=Ie.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Tt(Ie))}return W.length>0&&(l["!merges"]=W),N.length>0&&(l["!cols"]=N),Ge.length>0&&(l["!rows"]=Ge),l}function VM(t,e,r,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=Rr(e),e.z=e.z||ut[14],e.v=Nn(Nr(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r,c:n};switch(l.s=yl(i.cellXfs,e,i),e.l&&s["!links"].push([ft(l),e.l]),e.c&&s["!comments"].push([ft(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=pv(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?Fe(t,18,aM(e,l)):Fe(t,7,iM(e,l))):(l.t="str",a?Fe(t,17,vM(e,l)):Fe(t,6,mM(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?Fe(t,13,hM(e,l)):Fe(t,2,dM(e,l)):a?Fe(t,16,cM(e,l)):Fe(t,5,lM(e,l)),!0;case"b":return l.t="b",a?Fe(t,15,JO(e,l)):Fe(t,4,qO(e,l)),!0;case"e":return l.t="e",a?Fe(t,14,rM(e,l)):Fe(t,3,eM(e,l)),!0}return a?Fe(t,12,YO(e,l)):Fe(t,1,GO(e,l)),!0}function zM(t,e,r,n){var i=Qt(e["!ref"]||"A1"),s,a="",o=[];Fe(t,145);var l=Array.isArray(e),u=i.e.r;e["!rows"]&&(u=Math.max(i.e.r,e["!rows"].length-1));for(var f=i.s.r;f<=u;++f){a=ln(f),LO(t,e,i,f);var p=!1;if(f<=i.e.r)for(var g=i.s.c;g<=i.e.c;++g){f===i.s.r&&(o[g]=zr(g)),s=o[g]+a;var m=l?(e[f]||[])[g]:e[s];if(!m){p=!1;continue}p=VM(t,m,f,g,n,e,p)}}Fe(t,146)}function WM(t,e){!e||!e["!merges"]||(Fe(t,177,AM(e["!merges"].length)),e["!merges"].forEach(function(r){Fe(t,176,TM(r))}),Fe(t,178))}function HM(t,e){!e||!e["!cols"]||(Fe(t,390),e["!cols"].forEach(function(r,n){r&&Fe(t,60,NM(n,r))}),Fe(t,391))}function $M(t,e){!e||!e["!ref"]||(Fe(t,648),Fe(t,649,MM(Qt(e["!ref"]))),Fe(t,650))}function GM(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=lr(r,-1,n[1].Target.replace(/#.*$/,""),Rt.HLINK);Fe(t,494,kM(n,i))}}),delete e["!links"]}function KM(t,e,r,n){if(e["!comments"].length>0){var i=lr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Rt.VML);Fe(t,551,tv("rId"+i)),e["!legacy"]=i}}function YM(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:Tt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Yi(s);o.s.r==o.e.r&&(o.e.r=Yi(e["!ref"]).e.r,s=Tt(o));for(var l=0;l<a.length;++l){var u=a[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Fe(t,161,Mu(Qt(s))),Fe(t,162)}}function XM(t,e,r){Fe(t,133),Fe(t,137,OM(e,r)),Fe(t,138),Fe(t,134)}function qM(t,e){e["!protect"]&&Fe(t,535,BM(e["!protect"]))}function QM(t,e,r,n){var i=Ki(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=Qt(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Fe(i,129),(r.vbaraw||a["!outline"])&&Fe(i,147,HO(o,a["!outline"])),Fe(i,148,VO(l)),XM(i,a,r.Workbook),HM(i,a),zM(i,a,t,e),qM(i,a),YM(i,a,r,t),WM(i,a),GM(i,a,n),a["!margins"]&&Fe(i,476,DM(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&$M(i,a),KM(i,a,t,n),Fe(i,130),i.end()}function JM(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var i=qt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function ZM(t,e,r,n,i,s){var a=s||{"!type":"chart"};if(!t)return s;var o=0,l=0,u="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var g=JM(p);f.s.r=f.s.c=0,f.e.c=o,u=zr(o),g[0].forEach(function(m,y){a[u+ln(y)]={t:"n",v:m,z:g[1]},l=y}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(a["!ref"]=Tt(f)),a}function eB(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(pC);return o&&gv(o[0],s,i,r),(a=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function tB(t,e){t.l+=10;var r=gi(t);return{name:r}}function rB(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return go(t,function(l,u,f){switch(f){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var mv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],nB=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],iB=[],sB=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function B_(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=br(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function j_(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=br(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function vC(t){j_(t.WBProps,mv),j_(t.CalcPr,sB),B_(t.WBView,nB),B_(t.Sheets,iB),au.date1904=br(t.WBProps.date1904)}function aB(t){return!t.Workbook||!t.Workbook.WBProps?"false":br(t.Workbook.WBProps.date1904)?"true":"false"}var oB="][*?/\\".split("");function yC(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return oB.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function lB(t,e,r){t.forEach(function(n,i){yC(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function cB(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];lB(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)aO(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var uB=/<\w+:workbook/;function dB(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(t.replace(yi,function(l,u){var f=ht(l);switch(Ra(f[0])){case"<?xml":break;case"<workbook":l.match(uB)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[i];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":mv.forEach(function(p){if(f[p[0]]!=null)switch(p[2]){case"bool":r.WBProps[p[0]]=br(f[p[0]]);break;case"int":r.WBProps[p[0]]=parseInt(f[p[0]],10);break;default:r.WBProps[p[0]]=f[p[0]]}}),f.codeName&&(r.WBProps.CodeName=vr(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=qt(vr(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=vr(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),br(f.hidden||"0")&&(s.Hidden=!0),a=u+l.length;break;case"</definedName>":s.Ref=qt(vr(t.slice(a,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),cc.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return vC(r),r}function _C(t){var e=[cn];e[e.length]=Ve("workbook",null,{xmlns:cc[0],"xmlns:r":kn.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(mv.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Ve("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:cr(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=Ve("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=Ve("definedName",cr(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function fB(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=ux(t),r.name=gi(t),r}function hB(t,e){return e||(e=_e(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),tv(t.strRelID,e),Vn(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function pB(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?gi(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function gB(t,e){e||(e=_e(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),dA(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function mB(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function xB(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=KR(t),a=eO(t,0,r),o=ev(t);t.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function vB(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],Sf[16]={n:"BrtFRTArchID$",f:mB},go(t,function(l,u,f){switch(f){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=ui(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([f,l]):a[0]=[f,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(f),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!u.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},e),vC(r),r.Names=s,r.supbooks=a,r}function yB(t,e){Fe(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Fe(t,156,hB(i))}Fe(t,144)}function _B(t,e){e||(e=_e(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Vn("SheetJS",e),Vn(Xh.version,e),Vn(Xh.version,e),Vn("7262",e),e.length>e.l?e.slice(0,e.l):e}function EB(t,e){e||(e=_e(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function SB(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(Fe(t,135),Fe(t,158,EB(i)),Fe(t,136))}}function wB(t,e){var r=Ki();return Fe(r,131),Fe(r,128,_B()),Fe(r,153,gB(t.Workbook&&t.Workbook.WBProps||null)),SB(r,t),yB(r,t),Fe(r,132),r.end()}function TB(t,e,r){return e.slice(-4)===".bin"?vB(t,r):dB(t,r)}function AB(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?UM(t,n,r,i,s,a,o):xO(t,n,r,i,s,a,o)}function CB(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?rB(t,n,r,i,s):eB(t,n,r,i,s)}function kB(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?b8():I8()}function FB(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?k8():F8()}function bB(t,e,r,n){return e.slice(-4)===".bin"?TP(t,r,n):fP(t,r,n)}function IB(t,e,r){return eC(t,r)}function NB(t,e,r){return e.slice(-4)===".bin"?N6(t,r):F6(t,r)}function RB(t,e,r){return e.slice(-4)===".bin"?S8(t,r):h8(t,r)}function DB(t,e,r){return e.slice(-4)===".bin"?u8(t):l8(t)}function PB(t,e,r,n){return r.slice(-4)===".bin"?d8(t,e,r,n):void 0}function OB(t,e,r){return e.slice(-4)===".bin"?s8(t,e,r):o8(t,e,r)}function MB(t,e,r){return(e.slice(-4)===".bin"?wB:_C)(t)}function BB(t,e,r,n,i){return(e.slice(-4)===".bin"?QM:gC)(t,r,n,i)}function jB(t,e,r){return(e.slice(-4)===".bin"?PP:JA)(t,r)}function LB(t,e,r){return(e.slice(-4)===".bin"?P6:HA)(t,r)}function UB(t,e,r){return(e.slice(-4)===".bin"?w8:nC)(t)}function VB(t){return(t.slice(-4)===".bin"?a8:tC)()}var EC=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,SC=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function qs(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(EC),s,a,o,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(SC),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function zB(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(EC),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(SC),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var Ud;function WB(t,e){var r=Ud[t]||qt(t);return r==="General"?ql(e):Ls(r,e)}function HB(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=br(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Nr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[qt(e)]=i}function $B(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||mo[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=hf(t.v):t.w=ql(t.v):t.w=WB(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=Ud[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Du(n)){var i=Ol(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function GB(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=iP[n.Pattern]||n.Pattern)}t[e.ID]=e}function KB(t,e,r,n,i,s,a,o,l,u){var f="General",p=n.StyleID,g={};u=u||{};var m=[],y=0;for(p===void 0&&o&&(p=o.StyleID),p===void 0&&a&&(p=a.StyleID);s[p]!==void 0&&(s[p].nf&&(f=s[p].nf),s[p].Interior&&m.push(s[p].Interior),!!s[p].Parent);)p=s[p].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=br(t);break;case"String":n.t="s",n.r=t_(qt(t)),n.v=t.indexOf("<")>-1?qt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Nr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=qt(t):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=mA[t],u.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=t_(e||t));break}if($B(n,f,u),u.cellFormula!==!1)if(n.Formula){var x=qt(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=su(x,i),delete n.Formula,n.ArrayRange=="RC"?n.F=su("RC:RC",i):n.ArrayRange&&(n.F=su(n.ArrayRange,i),l.push([Qt(n.F),n.F]))}else for(y=0;y<l.length;++y)i.r>=l[y][0].s.r&&i.r<=l[y][0].e.r&&i.c>=l[y][0].s.c&&i.c<=l[y][0].e.c&&(n.F=l[y][1]);u.cellStyles&&(m.forEach(function(S){!g.patternType&&S.patternType&&(g.patternType=S.patternType)}),n.s=g),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function YB(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Xg(t,e){var r=e||{};Pu();var n=vd(Y1(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=vr(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=Rr(r);return a.type="string",yu.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(fr){i.indexOf("<"+fr)>=0&&(s=!0)}),s)return Dj(n,r);Ud={"General Number":"General","General Date":ut[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ut[15],"Short Date":ut[14],"Long Time":ut[19],"Medium Time":ut[18],"Short Time":ut[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ut[2],Standard:ut[4],Percent:ut[10],Scientific:ut[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],u,f={},p=[],g=r.dense?[]:{},m="",y={},x={},S=qs('<Data ss:Type="String">'),A=0,k=0,E=0,P={s:{r:2e6,c:2e6},e:{r:0,c:0}},Y={},W={},T="",F=0,w=[],I={},R={},D=0,N=[],Ge=[],Ee={},Pe=[],Ie,Ce=!1,se=[],be=[],Be={},G=0,ne=0,ie={Sheets:[],WBProps:{date1904:!1}},X={};mf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ve="";o=mf.exec(n);)switch(o[3]=(ve=o[3]).toLowerCase()){case"data":if(ve=="data"){if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?KB(n.slice(A,o.index),T,S,l[l.length-1][0]=="comment"?Ee:y,{c:k,r:E},Y,Pe[k],x,se,r):(T="",S=qs(o[0]),A=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(Ge.length>0&&(y.c=Ge),(!r.sheetRows||r.sheetRows>E)&&y.v!==void 0&&(r.dense?(g[E]||(g[E]=[]),g[E][k]=y):g[zr(k)+ln(E)]=y),y.HRef&&(y.l={Target:qt(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(G=k+(parseInt(y.MergeAcross,10)|0),ne=E+(parseInt(y.MergeDown,10)|0),w.push({s:{c:k,r:E},e:{c:G,r:ne}})),!r.sheetStubs)y.MergeAcross?k=G+1:++k;else if(y.MergeAcross||y.MergeDown){for(var Se=k;Se<=G;++Se)for(var Le=E;Le<=ne;++Le)(Se>k||Le>E)&&(r.dense?(g[Le]||(g[Le]=[]),g[Le][Se]={t:"z"}):g[zr(Se)+ln(Le)]={t:"z"});k=G+1}else++k;else y=zB(o[0]),y.Index&&(k=+y.Index-1),k<P.s.c&&(P.s.c=k),k>P.e.c&&(P.e.c=k),o[0].slice(-2)==="/>"&&++k,Ge=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(E<P.s.r&&(P.s.r=E),E>P.e.r&&(P.e.r=E),o[0].slice(-2)==="/>"&&(x=qs(o[0]),x.Index&&(E=+x.Index-1)),k=0,++E):(x=qs(o[0]),x.Index&&(E=+x.Index-1),Be={},(x.AutoFitHeight=="0"||x.Height)&&(Be.hpx=parseInt(x.Height,10),Be.hpt=Ef(Be.hpx),be[E]=Be),x.Hidden=="1"&&(Be.hidden=!0,be[E]=Be));break;case"worksheet":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));p.push(m),P.s.r<=P.e.r&&P.s.c<=P.e.c&&(g["!ref"]=Tt(P),r.sheetRows&&r.sheetRows<=P.e.r&&(g["!fullref"]=g["!ref"],P.e.r=r.sheetRows-1,g["!ref"]=Tt(P))),w.length&&(g["!merges"]=w),Pe.length>0&&(g["!cols"]=Pe),be.length>0&&(g["!rows"]=be),f[m]=g}else P={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=k=0,l.push([o[3],!1]),u=qs(o[0]),m=qt(u.Name),g=r.dense?[]:{},w=[],se=[],be=[],X={name:m,Hidden:0},ie.Sheets.push(X);break;case"table":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),Pe=[],Ce=!1}break;case"style":o[1]==="/"?GB(Y,W,r):W=qs(o[0]);break;case"numberformat":W.nf=qt(qs(o[0]).Format||"General"),Ud[W.nf]&&(W.nf=Ud[W.nf]);for(var Ne=0;Ne!=392&&ut[Ne]!=W.nf;++Ne);if(Ne==392){for(Ne=57;Ne!=392;++Ne)if(ut[Ne]==null){Za(W.nf,Ne);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(Ie=qs(o[0]),Ie.Hidden&&(Ie.hidden=!0,delete Ie.Hidden),Ie.Width&&(Ie.wpx=parseInt(Ie.Width,10)),!Ce&&Ie.wpx>10){Ce=!0,fi=qA;for(var ke=0;ke<Pe.length;++ke)Pe[ke]&&ll(Pe[ke])}Ce&&ll(Ie),Pe[Ie.Index-1||Pe.length]=Ie;for(var rt=0;rt<+Ie.Span;++rt)Pe[Pe.length]=Rr(Ie);break;case"namedrange":if(o[1]==="/")break;ie.Names||(ie.Names=[]);var ee=ht(o[0]),Dt={Name:ee.Name,Ref:su(ee.RefersTo.slice(1),{r:0,c:0})};ie.Sheets.length>0&&(Dt.Sheet=ie.Sheets.length-1),ie.Names.push(Dt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?T+=n.slice(F,o.index):F=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;W.Interior=qs(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?vD(I,ve,n.slice(D,o.index)):D=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));YB(Ee),Ge.push(Ee)}else l.push([o[3],!1]),u=qs(o[0]),Ee={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Et=qs(o[0]);g["!autofilter"]={ref:su(Et.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return W_(n,r);var Nt=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Nt=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Nt=!1}break;case"excelworkbook":switch(o[3]){case"date1904":ie.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Nt=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Nt=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(D,o.index)){case"SheetHidden":X.Hidden=1;break;case"SheetVeryHidden":X.Hidden=2;break}else D=o.index+o[0].length;break;case"header":g["!margins"]||zl(g["!margins"]={},"xlml"),isNaN(+ht(o[0]).Margin)||(g["!margins"].header=+ht(o[0]).Margin);break;case"footer":g["!margins"]||zl(g["!margins"]={},"xlml"),isNaN(+ht(o[0]).Margin)||(g["!margins"].footer=+ht(o[0]).Margin);break;case"pagemargins":var xt=ht(o[0]);g["!margins"]||zl(g["!margins"]={},"xlml"),isNaN(+xt.Top)||(g["!margins"].top=+xt.Top),isNaN(+xt.Left)||(g["!margins"].left=+xt.Left),isNaN(+xt.Right)||(g["!margins"].right=+xt.Right),isNaN(+xt.Bottom)||(g["!margins"].bottom=+xt.Bottom);break;case"displayrighttoleft":ie.Views||(ie.Views=[]),ie.Views[0]||(ie.Views[0]={}),ie.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Nt=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Nt=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Nt=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Nt=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Nt=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Nt=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Nt=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Nt=!1}break;case"smarttags":break;default:Nt=!1;break}if(Nt||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?HB(R,ve,N,n.slice(D,o.index)):(N=o,D=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var He={};return!r.bookSheets&&!r.bookProps&&(He.Sheets=f),He.SheetNames=p,He.Workbook=ie,He.SSF=Rr(ut),He.Props=I,He.Custprops=R,He}function xx(t,e){switch(vv(e=e||{}),e.type||"base64"){case"base64":return Xg(fs(t),e);case"binary":case"buffer":case"file":return Xg(t,e);case"array":return Xg(xl(t),e)}}function XB(t,e){var r=[];return t.Props&&r.push(yD(t.Props,e)),t.Custprops&&r.push(_D(t.Props,t.Custprops)),r.join("")}function qB(){return""}function QB(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(Ve("NumberFormat",null,{"ss:Format":cr(ut[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(Ve("Style",s.join(""),a))}),Ve("Styles",r.join(""))}function wC(t){return Ve("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+fv(t.Ref,{r:0,c:0})})}function JB(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(wC(i)))}return Ve("Names",r.join(""))}function ZB(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(wC(o)))}return s.join("")}function ej(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(Ve("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(Ve("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(Ve("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Ve("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(Jn("ProtectContents","True")),t["!protect"].objects&&i.push(Jn("ProtectObjects","True")),t["!protect"].scenarios&&i.push(Jn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(Jn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(Jn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":Ve("WorksheetOptions",i.join(""),{xmlns:is.x})}function tj(t){return t.map(function(e){var r=SR(e.t||""),n=Ve("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ve("Comment",n,{"ss:Author":e.a})}).join("")}function rj(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+cr(fv(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var l=Wr(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=cr(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=cr(t.l.Tooltip))),r["!merges"])for(var u=r["!merges"],f=0;f!=u.length;++f)u[f].s.c!=a.c||u[f].s.r!=a.r||(u[f].e.c>u[f].s.c&&(o["ss:MergeAcross"]=u[f].e.c-u[f].s.c),u[f].e.r>u[f].s.r&&(o["ss:MergeDown"]=u[f].e.r-u[f].s.r));var p="",g="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":p="Number",g=String(t.v);break;case"b":p="Boolean",g=t.v?"1":"0";break;case"e":p="Error",g=mo[t.v];break;case"d":p="DateTime",g=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||ut[14]);break;case"s":p="String",g=ER(t.v||"");break}var m=yl(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+m),o["ss:Index"]=a.c+1;var y=t.v!=null?g:"",x=t.t=="z"?"":'<Data ss:Type="'+p+'">'+y+"</Data>";return(t.c||[]).length>0&&(x+=tj(t.c)),Ve("Cell",x,o)}function nj(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=_u(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function ij(t,e,r,n){if(!t["!ref"])return"";var i=Qt(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(S,A){ll(S);var k=!!S.width,E=Xp(A,S),P={"ss:Index":A+1};k&&(P["ss:Width"]=yf(E.width)),S.hidden&&(P["ss:Hidden"]="1"),o.push(Ve("Column",null,P))});for(var l=Array.isArray(t),u=i.s.r;u<=i.e.r;++u){for(var f=[nj(u,(t["!rows"]||[])[u])],p=i.s.c;p<=i.e.c;++p){var g=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>p)&&!(s[a].s.r>u)&&!(s[a].e.c<p)&&!(s[a].e.r<u)){(s[a].s.c!=p||s[a].s.r!=u)&&(g=!0);break}if(!g){var m={r:u,c:p},y=ft(m),x=l?(t[u]||[])[p]:t[y];f.push(rj(x,y,t,e,r,n,m))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function sj(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?ZB(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?ij(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(ej(s,e,t,r)),n.join("")}function aj(t,e){e||(e={}),t.SSF||(t.SSF=Rr(ut)),t.SSF&&(Pu(),zp(t.SSF),e.revssf=Hp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],yl(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(XB(t,e)),r.push(qB()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Ve("Worksheet",sj(n,e,t),{"ss:Name":cr(t.SheetNames[n])}));return r[2]=QB(t,e),r[3]=JB(t),cn+Ve("Workbook",r.join(""),{xmlns:is.ss,"xmlns:o":is.o,"xmlns:x":is.x,"xmlns:ss":is.ss,"xmlns:dt":is.dt,"xmlns:html":is.html})}function oj(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=JR(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=ZR(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var lj=[60,1084,2066,2165,2175];function cj(t,e,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var l=Ka(r,r.l),u=vx[l],f=0;u!=null&&lj.indexOf(l)>-1;)s=Ka(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=r.slice(f,r.l+4+s),a.push(o),r.l+=4+s,u=vx[l=Ka(r,r.l)];var p=Un(a);Qn(p,0);var g=0;p.lens=[];for(var m=0;m<a.length;++m)p.lens.push(g),g+=a[m].length;if(p.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+p.length+" < "+n;return e.f(p,p.length,i)}function xa(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=ut[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||mo[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=hf(t.v):t.w=ql(t.v):t.w=Ls(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&Du(ut[n]||String(n))){var i=Ol(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function W0(t,e,r){return{v:t,ixfe:e,t:r}}function uj(t,e){var r={opts:{}},n={},i=e.dense?[]:{},s={},a={},o=null,l=[],u="",f={},p,g="",m,y,x,S,A={},k=[],E,P,Y=[],W=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},F={},w=function(pt){return pt<8?Ll[pt]:pt<64&&W[pt-8]||Ll[pt]},I=function(pt,Cr,Sr){var Dr=Cr.XF.data;if(!(!Dr||!Dr.patternType||!Sr||!Sr.cellStyles)){Cr.s={},Cr.s.patternType=Dr.patternType;var Ei;(Ei=vf(w(Dr.icvFore)))&&(Cr.s.fgColor={rgb:Ei}),(Ei=vf(w(Dr.icvBack)))&&(Cr.s.bgColor={rgb:Ei})}},R=function(pt,Cr,Sr){if(!(Be>1)&&!(Sr.sheetRows&&pt.r>=Sr.sheetRows)){if(Sr.cellStyles&&Cr.XF&&Cr.XF.data&&I(pt,Cr,Sr),delete Cr.ixfe,delete Cr.XF,p=pt,g=ft(pt),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),pt.r<a.s.r&&(a.s.r=pt.r),pt.c<a.s.c&&(a.s.c=pt.c),pt.r+1>a.e.r&&(a.e.r=pt.r+1),pt.c+1>a.e.c&&(a.e.c=pt.c+1),Sr.cellFormula&&Cr.f){for(var Dr=0;Dr<k.length;++Dr)if(!(k[Dr][0].s.c>pt.c||k[Dr][0].s.r>pt.r)&&!(k[Dr][0].e.c<pt.c||k[Dr][0].e.r<pt.r)){Cr.F=Tt(k[Dr][0]),(k[Dr][0].s.c!=pt.c||k[Dr][0].s.r!=pt.r)&&delete Cr.f,Cr.f&&(Cr.f=""+ui(k[Dr][1],a,pt,se,D));break}}Sr.dense?(i[pt.r]||(i[pt.r]=[]),i[pt.r][pt.c]=Cr):i[g]=Cr}},D={enc:!1,sbcch:0,snames:[],sharedf:A,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(D.password=e.password);var N,Ge=[],Ee=[],Pe=[],Ie=[],Ce=!1,se=[];se.SheetNames=D.snames,se.sharedf=D.sharedf,se.arrayf=D.arrayf,se.names=[],se.XTI=[];var be=0,Be=0,G=0,ne=[],ie=[],X;D.codepage=1200,ta(1200);for(var ve=!1;t.l<t.length-1;){var Se=t.l,Le=t.read_shift(2);if(Le===0&&be===10)break;var Ne=t.l===t.length?0:t.read_shift(2),ke=vx[Le];if(ke&&ke.f){if(e.bookSheets&&be===133&&Le!==133)break;if(be=Le,ke.r===2||ke.r==12){var rt=t.read_shift(2);if(Ne-=2,!D.enc&&rt!==Le&&((rt&255)<<8|rt>>8)!==Le)throw new Error("rt mismatch: "+rt+"!="+Le);ke.r==12&&(t.l+=10,Ne-=10)}var ee={};if(Le===10?ee=ke.f(t,Ne,D):ee=cj(Le,ke,t,Ne,D),Be==0&&[9,521,1033,2057].indexOf(be)===-1)continue;switch(Le){case 34:r.opts.Date1904=T.WBProps.date1904=ee;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(t.l=0),D.enc=ee,!e.password)throw new Error("File is password-protected");if(ee.valid==null)throw new Error("Encryption scheme unsupported");if(!ee.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=ee;break;case 66:var Dt=Number(ee);switch(Dt){case 21010:Dt=1200;break;case 32768:Dt=1e4;break;case 32769:Dt=1252;break}ta(D.codepage=Dt),ve=!0;break;case 317:D.rrtabid=ee;break;case 25:D.winlocked=ee;break;case 439:r.opts.RefreshAll=ee;break;case 12:r.opts.CalcCount=ee;break;case 16:r.opts.CalcDelta=ee;break;case 17:r.opts.CalcIter=ee;break;case 13:r.opts.CalcMode=ee;break;case 14:r.opts.CalcPrecision=ee;break;case 95:r.opts.CalcSaveRecalc=ee;break;case 15:D.CalcRefMode=ee;break;case 2211:r.opts.FullCalc=ee;break;case 129:ee.fDialog&&(i["!type"]="dialog"),ee.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),ee.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:Y.push(ee);break;case 430:se.push([ee]),se[se.length-1].XTI=[];break;case 35:case 547:se[se.length-1].push(ee);break;case 24:case 536:X={Name:ee.Name,Ref:ui(ee.rgce,a,null,se,D)},ee.itab>0&&(X.Sheet=ee.itab-1),se.names.push(X),se[0]||(se[0]=[],se[0].XTI=[]),se[se.length-1].push(ee),ee.Name=="_xlnm._FilterDatabase"&&ee.itab>0&&ee.rgce&&ee.rgce[0]&&ee.rgce[0][0]&&ee.rgce[0][0][0]=="PtgArea3d"&&(ie[ee.itab-1]={ref:Tt(ee.rgce[0][0][1][2])});break;case 22:D.ExternCount=ee;break;case 23:se.length==0&&(se[0]=[],se[0].XTI=[]),se[se.length-1].XTI=se[se.length-1].XTI.concat(ee),se.XTI=se.XTI.concat(ee);break;case 2196:if(D.biff<8)break;X!=null&&(X.Comment=ee[1]);break;case 18:i["!protect"]=ee;break;case 19:ee!==0&&D.WTF&&console.error("Password verifier: "+ee);break;case 133:s[ee.pos]=ee,D.snames.push(ee.name);break;case 10:{if(--Be)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=Tt(a),e.sheetRows&&e.sheetRows<=a.e.r){var Et=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Tt(a),a.e.r=Et}a.e.r++,a.e.c++}Ge.length>0&&(i["!merges"]=Ge),Ee.length>0&&(i["!objects"]=Ee),Pe.length>0&&(i["!cols"]=Pe),Ie.length>0&&(i["!rows"]=Ie),T.Sheets.push(F)}u===""?f=i:n[u]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[Le]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ee.BIFFVer]||8),D.biffguess=ee.BIFFVer==0,ee.BIFFVer==0&&ee.dt==4096&&(D.biff=5,ve=!0,ta(D.codepage=28591)),D.biff==8&&ee.BIFFVer==0&&ee.dt==16&&(D.biff=2),Be++)break;if(i=e.dense?[]:{},D.biff<8&&!ve&&(ve=!0,ta(D.codepage=e.codepage||1252)),D.biff<5||ee.BIFFVer==0&&ee.dt==4096){u===""&&(u="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var Nt={pos:t.l-Ne,name:u};s[Nt.pos]=Nt,D.snames.push(u)}else u=(s[Se]||{name:""}).name;ee.dt==32&&(i["!type"]="chart"),ee.dt==64&&(i["!type"]="macro"),Ge=[],Ee=[],D.arrayf=k=[],Pe=[],Ie=[],Ce=!1,F={Hidden:(s[Se]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[ee.r]||[])[ee.c]:i[ft({c:ee.c,r:ee.r})])&&++ee.c,E={ixfe:ee.ixfe,XF:Y[ee.ixfe]||{},v:ee.val,t:"n"},G>0&&(E.z=ne[E.ixfe>>8&63]),xa(E,e,r.opts.Date1904),R({c:ee.c,r:ee.r},E,e);break;case 5:case 517:E={ixfe:ee.ixfe,XF:Y[ee.ixfe],v:ee.val,t:ee.t},G>0&&(E.z=ne[E.ixfe>>8&63]),xa(E,e,r.opts.Date1904),R({c:ee.c,r:ee.r},E,e);break;case 638:E={ixfe:ee.ixfe,XF:Y[ee.ixfe],v:ee.rknum,t:"n"},G>0&&(E.z=ne[E.ixfe>>8&63]),xa(E,e,r.opts.Date1904),R({c:ee.c,r:ee.r},E,e);break;case 189:for(var xt=ee.c;xt<=ee.C;++xt){var He=ee.rkrec[xt-ee.c][0];E={ixfe:He,XF:Y[He],v:ee.rkrec[xt-ee.c][1],t:"n"},G>0&&(E.z=ne[E.ixfe>>8&63]),xa(E,e,r.opts.Date1904),R({c:xt,r:ee.r},E,e)}break;case 6:case 518:case 1030:{if(ee.val=="String"){o=ee;break}if(E=W0(ee.val,ee.cell.ixfe,ee.tt),E.XF=Y[E.ixfe],e.cellFormula){var fr=ee.formula;if(fr&&fr[0]&&fr[0][0]&&fr[0][0][0]=="PtgExp"){var Wn=fr[0][0][1][0],Zr=fr[0][0][1][1],Ii=ft({r:Wn,c:Zr});A[Ii]?E.f=""+ui(ee.formula,a,ee.cell,se,D):E.F=((e.dense?(i[Wn]||[])[Zr]:i[Ii])||{}).F}else E.f=""+ui(ee.formula,a,ee.cell,se,D)}G>0&&(E.z=ne[E.ixfe>>8&63]),xa(E,e,r.opts.Date1904),R(ee.cell,E,e),o=ee}break;case 7:case 519:if(o)o.val=ee,E=W0(ee,o.cell.ixfe,"s"),E.XF=Y[E.ixfe],e.cellFormula&&(E.f=""+ui(o.formula,a,o.cell,se,D)),G>0&&(E.z=ne[E.ixfe>>8&63]),xa(E,e,r.opts.Date1904),R(o.cell,E,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(ee);var Xi=ft(ee[0].s);if(m=e.dense?(i[ee[0].s.r]||[])[ee[0].s.c]:i[Xi],e.cellFormula&&m){if(!o||!Xi||!m)break;m.f=""+ui(ee[1],a,ee[0],se,D),m.F=Tt(ee[0])}}break;case 1212:{if(!e.cellFormula)break;if(g){if(!o)break;A[ft(o.cell)]=ee[0],m=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[ft(o.cell)],(m||{}).f=""+ui(ee[0],a,p,se,D)}}break;case 253:E=W0(l[ee.isst].t,ee.ixfe,"s"),l[ee.isst].h&&(E.h=l[ee.isst].h),E.XF=Y[E.ixfe],G>0&&(E.z=ne[E.ixfe>>8&63]),xa(E,e,r.opts.Date1904),R({c:ee.c,r:ee.r},E,e);break;case 513:e.sheetStubs&&(E={ixfe:ee.ixfe,XF:Y[ee.ixfe],t:"z"},G>0&&(E.z=ne[E.ixfe>>8&63]),xa(E,e,r.opts.Date1904),R({c:ee.c,r:ee.r},E,e));break;case 190:if(e.sheetStubs)for(var Ni=ee.c;Ni<=ee.C;++Ni){var en=ee.ixfe[Ni-ee.c];E={ixfe:en,XF:Y[en],t:"z"},G>0&&(E.z=ne[E.ixfe>>8&63]),xa(E,e,r.opts.Date1904),R({c:Ni,r:ee.r},E,e)}break;case 214:case 516:case 4:E=W0(ee.val,ee.ixfe,"s"),E.XF=Y[E.ixfe],G>0&&(E.z=ne[E.ixfe>>8&63]),xa(E,e,r.opts.Date1904),R({c:ee.c,r:ee.r},E,e);break;case 0:case 512:Be===1&&(a=ee);break;case 252:l=ee;break;case 1054:if(D.biff==4){ne[G++]=ee[1];for(var Ri=0;Ri<G+163&&ut[Ri]!=ee[1];++Ri);Ri>=163&&Za(ee[1],G+163)}else Za(ee[1],ee[0]);break;case 30:{ne[G++]=ee;for(var nr=0;nr<G+163&&ut[nr]!=ee;++nr);nr>=163&&Za(ee,G+163)}break;case 229:Ge=Ge.concat(ee);break;case 93:Ee[ee.cmo[0]]=D.lastobj=ee;break;case 438:D.lastobj.TxO=ee;break;case 127:D.lastobj.ImData=ee;break;case 440:for(S=ee[0].s.r;S<=ee[0].e.r;++S)for(x=ee[0].s.c;x<=ee[0].e.c;++x)m=e.dense?(i[S]||[])[x]:i[ft({c:x,r:S})],m&&(m.l=ee[1]);break;case 2048:for(S=ee[0].s.r;S<=ee[0].e.r;++S)for(x=ee[0].s.c;x<=ee[0].e.c;++x)m=e.dense?(i[S]||[])[x]:i[ft({c:x,r:S})],m&&m.l&&(m.l.Tooltip=ee[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;m=e.dense?(i[ee[0].r]||[])[ee[0].c]:i[ft(ee[0])];var Br=Ee[ee[2]];m||(e.dense?(i[ee[0].r]||(i[ee[0].r]=[]),m=i[ee[0].r][ee[0].c]={t:"z"}):m=i[ft(ee[0])]={t:"z"},a.e.r=Math.max(a.e.r,ee[0].r),a.s.r=Math.min(a.s.r,ee[0].r),a.e.c=Math.max(a.e.c,ee[0].c),a.s.c=Math.min(a.s.c,ee[0].c)),m.c||(m.c=[]),y={a:ee[1],t:Br.TxO.t},m.c.push(y)}break;case 2173:QP(Y[ee.ixfe],ee.ext);break;case 125:{if(!D.cellStyles)break;for(;ee.e>=ee.s;)Pe[ee.e--]={width:ee.w/256,level:ee.level||0,hidden:!!(ee.flags&1)},Ce||(Ce=!0,cv(ee.w/256)),ll(Pe[ee.e+1])}break;case 520:{var Ar={};ee.level!=null&&(Ie[ee.r]=Ar,Ar.level=ee.level),ee.hidden&&(Ie[ee.r]=Ar,Ar.hidden=!0),ee.hpt&&(Ie[ee.r]=Ar,Ar.hpt=ee.hpt,Ar.hpx=_u(ee.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||zl(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Le]]=ee;break;case 161:i["!margins"]||zl(i["!margins"]={}),i["!margins"].header=ee.header,i["!margins"].footer=ee.footer;break;case 574:ee.RTL&&(T.Views[0].RTL=!0);break;case 146:W=ee;break;case 2198:N=ee;break;case 140:P=ee;break;case 442:u?F.CodeName=ee||F.name:T.WBProps.CodeName=ee||"ThisWorkbook";break}}else ke||console.error("Missing Info for XLS Record 0x"+Le.toString(16)),t.l+=Ne}return r.SheetNames=Jr(s).sort(function(_i,pt){return Number(_i)-Number(pt)}).map(function(_i){return s[_i].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&ie.forEach(function(_i,pt){r.Sheets[r.SheetNames[pt]]["!autofilter"]=_i}),r.Strings=l,r.SSF=Rr(ut),D.enc&&(r.Encryption=D.enc),N&&(r.Themes=N),r.Metadata={},P!==void 0&&(r.Metadata.Country=P),se.names.length>0&&(T.Names=se.names),r.Workbook=T,r}var Vd={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function dj(t,e,r){var n=it.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=y_(n,dx,Vd.DSI);for(var s in i)e[s]=i[s]}catch(u){if(r.WTF)throw u}var a=it.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=y_(a,fx,Vd.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(u){if(r.WTF)throw u}e.HeadingPairs&&e.TitlesOfParts&&(SA(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function fj(t,e){var r=[],n=[],i=[],s=0,a,o=X2(dx,"n"),l=X2(fx,"n");if(t.Props)for(a=Jr(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=Jr(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var u=[];for(s=0;s<i.length;++s)bA.indexOf(i[s][0])>-1||EA.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);n.length&&it.utils.cfb_add(e,"/SummaryInformation",__(n,Vd.SI,l,fx)),(r.length||u.length)&&it.utils.cfb_add(e,"/DocumentSummaryInformation",__(r,Vd.DSI,o,dx,u.length?u:null,Vd.UDI))}function TC(t,e){e||(e={}),vv(e),L1(),e.codepage&&j1(e.codepage);var r,n;if(t.FullPaths){if(it.find(t,"/encryption"))throw new Error("File is password-protected");r=it.find(t,"!CompObj"),n=it.find(t,"/Workbook")||it.find(t,"/Book")}else{switch(e.type){case"base64":t=as(fs(t));break;case"binary":t=as(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Qn(t,0),n={content:t}}var i,s;if(r&&oj(r),e.bookProps&&!e.bookSheets)i={};else{var a=It?"buffer":"array";if(n&&n.content)i=uj(n.content,e);else if((s=it.find(t,"PerfectOffice_MAIN"))&&s.content)i=Vl.to_workbook(s.content,(e.type=a,e));else if((s=it.find(t,"NativeContent_MAIN"))&&s.content)i=Vl.to_workbook(s.content,(e.type=a,e));else throw(s=it.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&it.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=A8(t))}var o={};return t.FullPaths&&dj(t,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=t),i}function hj(t,e){var r=e||{},n=it.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return it.utils.cfb_add(n,i,AC(t,r)),r.biff==8&&(t.Props||t.Custprops)&&fj(t,n),r.biff==8&&t.vbaraw&&C8(n,it.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var Sf={0:{f:BO},1:{f:$O},2:{f:uM},3:{f:ZO},4:{f:XO},5:{f:oM},6:{f:gM},7:{f:nM},8:{f:SM},9:{f:EM},10:{f:yM},11:{f:_M},12:{f:KO},13:{f:fM},14:{f:tM},15:{f:QO},16:{f:mC},17:{f:xM},18:{f:sM},19:{f:Z1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:xB},40:{},42:{},43:{f:gP},44:{f:hP},45:{f:vP},46:{f:_P},47:{f:yP},48:{},49:{f:UR},50:{},51:{f:e8},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:UA},62:{f:pM},63:{f:c8},64:{f:jM},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:xi,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:PM},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:WO},148:{f:UO,p:16},151:{f:FM},152:{},153:{f:pB},154:{},155:{},156:{f:fB},157:{},158:{},159:{T:1,f:I6},160:{T:-1},161:{T:1,f:hc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:wM},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:JP},336:{T:-1},337:{f:n8,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ux},357:{},358:{},359:{},360:{T:1},361:{},362:{f:LA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:bM},427:{f:IM},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:RM},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:zO},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:CM},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ux},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:_8},633:{T:1},634:{T:-1},635:{T:1,f:v8},636:{T:-1},637:{f:HR},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:tB},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:LM},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},vx={6:{f:Kg},10:{f:Fo},12:{f:xn},13:{f:xn},14:{f:sn},15:{f:sn},16:{f:pi},17:{f:sn},18:{f:sn},19:{f:xn},20:{f:C_},21:{f:C_},23:{f:LA},24:{f:F_},25:{f:sn},26:{},27:{},28:{f:L3},29:{},34:{f:sn},35:{f:k_},38:{f:pi},39:{f:pi},40:{f:pi},41:{f:pi},42:{f:sn},43:{f:sn},47:{f:Q6},49:{f:f3},51:{f:xn},60:{},61:{f:o3},64:{f:sn},65:{f:d3},66:{f:xn},77:{},80:{},81:{},82:{},85:{f:xn},89:{},90:{},91:{},92:{f:qD},93:{f:z3},94:{},95:{f:sn},96:{},97:{},99:{f:sn},125:{f:UA},128:{f:k3},129:{f:JD},130:{f:xn},131:{f:sn},132:{f:sn},133:{f:ZD},134:{},140:{f:q3},141:{f:xn},144:{},146:{f:Z3},151:{},152:{},153:{},154:{},155:{},156:{f:xn},157:{},158:{},160:{f:a6},161:{f:r6},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:w3},190:{f:T3},193:{f:Fo},197:{},198:{},199:{},200:{},201:{},202:{f:sn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:xn},220:{},221:{f:sn},222:{},224:{f:C3},225:{f:XD},226:{f:Fo},227:{},229:{f:U3},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:t3},253:{f:p3},255:{f:n3},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:IA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:sn},353:{f:Fo},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:R3},431:{f:sn},432:{},433:{},434:{},437:{},438:{f:$3},439:{f:sn},440:{f:G3},441:{},442:{f:Wf},443:{},444:{f:xn},445:{},446:{},448:{f:Fo},449:{f:a3,r:2},450:{f:Fo},512:{f:w_},513:{f:s6},515:{f:I3},516:{f:m3},517:{f:A_},519:{f:o6},520:{f:i3},523:{},545:{f:b_},549:{f:S_},566:{},574:{f:c3},638:{f:S3},659:{},1048:{},1054:{f:v3},1084:{},1212:{f:M3},2048:{f:Y3},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:U0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Fo},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:e6,r:12},2173:{f:qP,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:sn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:O3,r:12},2197:{},2198:{f:HP,r:12},2199:{},2200:{},2201:{},2202:{f:B3,r:12},2203:{f:Fo},2204:{},2205:{},2206:{},2207:{},2211:{f:s3},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:xn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:n6},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:J3},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:w_},1:{},2:{f:f6},3:{f:u6},4:{f:c6},5:{f:A_},7:{f:p6},8:{},9:{f:U0},11:{},22:{f:xn},30:{f:_3},31:{},32:{},33:{f:b_},36:{},37:{f:S_},50:{f:g6},62:{},52:{},67:{},68:{f:xn},69:{},86:{},126:{},127:{f:l6},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:m6},223:{},234:{},354:{},421:{},518:{f:Kg},521:{f:U0},536:{f:F_},547:{f:k_},561:{},579:{},1030:{f:Kg},1033:{f:U0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function We(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&q1(r)&&t.push(r)}}function pj(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return We(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;var f=t.next(4);for(f.write_shift(2,s),f.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u;l<i;){for(f=t.next(4),f.write_shift(2,60),u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;f.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u}}}function Kf(t,e,r){return t||(t=_e(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function gj(t,e,r,n){var i=_e(9);return Kf(i,t,e),NA(r,n||"b",i),i}function mj(t,e,r){var n=_e(8+2*r.length);return Kf(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function xj(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Nn(Nr(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?We(t,2,h6(r,n,i)):We(t,3,d6(r,n,i));return;case"b":case"e":We(t,5,gj(r,n,e.v,e.t));return;case"s":case"str":We(t,4,mj(r,n,(e.v||"").slice(0,255)));return}We(t,1,Kf(null,r,n))}function vj(t,e,r,n){var i=Array.isArray(e),s=Qt(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=Tt(s)}for(var u=s.s.r;u<=s.e.r;++u){o=ln(u);for(var f=s.s.c;f<=s.e.c;++f){u===s.s.r&&(l[f]=zr(f)),a=l[f]+o;var p=i?(e[u]||[])[f]:e[a];p&&xj(t,p,u,f)}}}function yj(t,e){for(var r=e||{},n=Ki(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return We(n,r.biff==4?1033:r.biff==3?521:9,av(t,16,r)),vj(n,t.Sheets[t.SheetNames[i]],i,r),We(n,10),n.end()}function _j(t,e,r){We(t,49,h3({sz:12,name:"Arial"},r))}function Ej(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&We(t,1054,y3(i,e[i],r))})}function Sj(t,e){var r=_e(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),We(t,2151,r),r=_e(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),MA(Qt(e["!ref"]||"A1"),r),r.write_shift(4,4),We(t,2152,r)}function wj(t,e){for(var r=0;r<16;++r)We(t,224,T_({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){We(t,224,T_(n,0,e))})}function Tj(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];We(t,440,K3(n)),n[1].Tooltip&&We(t,2048,X3(n))}delete e["!links"]}function Aj(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&We(t,125,t6(Xp(i,n),i))})}}function Cj(t,e,r,n,i){var s=16+yl(i.cellXfs,e,i);if(e.v==null&&!e.bf){We(t,513,ec(r,n,s));return}if(e.bf)We(t,6,J5(e,r,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?Nn(Nr(e.v)):e.v;We(t,515,N3(r,n,a,s));break;case"b":case"e":We(t,517,b3(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=pv(i.Strings,e.v,i.revStrings);We(t,253,g3(r,n,o,s))}else We(t,516,x3(r,n,(e.v||"").slice(0,255),s,i));break;default:We(t,513,ec(r,n,s))}}function kj(t,e,r){var n=Ki(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},l=Array.isArray(s),u=e.biff==8,f,p="",g=[],m=Qt(s["!ref"]||"A1"),y=u?65536:16384;if(m.e.c>255||m.e.r>=y){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,y-1)}We(n,2057,av(r,16,e)),We(n,13,Is(1)),We(n,12,Is(100)),We(n,15,Ai(!0)),We(n,17,Ai(!1)),We(n,16,Jl(.001)),We(n,95,Ai(!0)),We(n,42,Ai(!1)),We(n,43,Ai(!1)),We(n,130,Is(1)),We(n,128,F3()),We(n,131,Ai(!1)),We(n,132,Ai(!1)),u&&Aj(n,s["!cols"]),We(n,512,E3(m,e)),u&&(s["!links"]=[]);for(var x=m.s.r;x<=m.e.r;++x){p=ln(x);for(var S=m.s.c;S<=m.e.c;++S){x===m.s.r&&(g[S]=zr(S)),f=g[S]+p;var A=l?(s[x]||[])[S]:s[f];A&&(Cj(n,A,x,S,e),u&&A.l&&s["!links"].push([f,A.l]))}}var k=o.CodeName||o.name||i;return u&&We(n,574,u3((a.Views||[])[0])),u&&(s["!merges"]||[]).length&&We(n,229,V3(s["!merges"])),u&&Tj(n,s),We(n,442,RA(k)),u&&Sj(n,s),We(n,10),n.end()}function Fj(t,e,r){var n=Ki(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(We(n,2057,av(t,5,r)),r.bookType=="xla"&&We(n,135),We(n,225,o?Is(1200):null),We(n,193,bD(2)),l&&We(n,191),l&&We(n,192),We(n,226),We(n,92,QD("SheetJS",r)),We(n,66,Is(o?1200:1252)),o&&We(n,353,Is(0)),o&&We(n,448),We(n,317,i6(t.SheetNames.length)),o&&t.vbaraw&&We(n,211),o&&t.vbaraw){var u=a.CodeName||"ThisWorkbook";We(n,442,RA(u))}We(n,156,Is(17)),We(n,25,Ai(!1)),We(n,18,Ai(!1)),We(n,19,Is(0)),o&&We(n,431,Ai(!1)),o&&We(n,444,Is(0)),We(n,61,l3()),We(n,64,Ai(!1)),We(n,141,Is(0)),We(n,34,Ai(aB(t)=="true")),We(n,14,Ai(!0)),o&&We(n,439,Ai(!1)),We(n,218,Is(0)),_j(n,t,r),Ej(n,t.SSF,r),wj(n,r),o&&We(n,352,Ai(!1));var f=n.end(),p=Ki();o&&We(p,140,Q3()),o&&r.Strings&&pj(p,252,r3(r.Strings)),We(p,10);var g=p.end(),m=Ki(),y=0,x=0;for(x=0;x<t.SheetNames.length;++x)y+=(o?12:11)+(o?2:1)*t.SheetNames[x].length;var S=f.length+y+g.length;for(x=0;x<t.SheetNames.length;++x){var A=s[x]||{};We(m,133,e3({pos:S,hs:A.Hidden||0,dt:0,name:t.SheetNames[x]},r)),S+=e[x].length}var k=m.end();if(y!=k.length)throw new Error("BS8 "+y+" != "+k.length);var E=[];return f.length&&E.push(f),k.length&&E.push(k),g.length&&E.push(g),Un(E)}function bj(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=Rr(ut)),t&&t.SSF&&(Pu(),zp(t.SSF),r.revssf=Hp(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,yv(r),r.cellXfs=[],yl(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=kj(i,r,t);return n.unshift(Fj(t,n,r)),Un(n)}function AC(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Yi(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return bj(t,e);case 4:case 3:case 2:return yj(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function L_(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),a=i.index,o=s&&s.index||t.length,l=hR(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,f=0,p=0,g=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(a=0;a<l.length;++a){var x=l[a].trim(),S=x.slice(0,3).toLowerCase();if(S=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}f=0;continue}if(!(S!="<td"&&S!="<th")){var A=x.split(/<\/t[dh]>/i);for(o=0;o<A.length;++o){var k=A[o].trim();if(k.match(/<t[dh]/i)){for(var E=k,P=0;E.charAt(0)=="<"&&(P=E.indexOf(">"))>-1;)E=E.slice(P+1);for(var Y=0;Y<y.length;++Y){var W=y[Y];W.s.c==f&&W.s.r<u&&u<=W.e.r&&(f=W.e.c+1,Y=-1)}var T=ht(k.slice(0,k.indexOf(">")));g=T.colspan?+T.colspan:1,((p=+T.rowspan)>1||g>1)&&y.push({s:{r:u,c:f},e:{r:u+(p||1)-1,c:f+g-1}});var F=T.t||T["data-t"]||"";if(!E.length){f+=g;continue}if(E=XT(E),m.s.r>u&&(m.s.r=u),m.e.r<u&&(m.e.r=u),m.s.c>f&&(m.s.c=f),m.e.c<f&&(m.e.c=f),!E.length){f+=g;continue}var w={t:"s",v:E};r.raw||!E.trim().length||F=="s"||(E==="TRUE"?w={t:"b",v:!0}:E==="FALSE"?w={t:"b",v:!1}:isNaN(aa(E))?isNaN(vu(E).getDate())||(w={t:"d",v:Nr(E)},r.cellDates||(w={t:"n",v:Nn(w.v)}),w.z=r.dateNF||ut[14]):w={t:"n",v:aa(E)}),r.dense?(n[u]||(n[u]=[]),n[u][f]=w):n[ft({r:u,c:f})]=w,f+=g}}}}return n["!ref"]=Tt(m),y.length&&(n["!merges"]=y),n}function Ij(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>a)&&!(i[u].e.r<r||i[u].e.c<a)){if(i[u].s.r<r||i[u].s.c<a){o=-1;break}o=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(o<0)){var f=ft({r,c:a}),p=n.dense?(t[r]||[])[a]:t[f],g=p&&p.v!=null&&(p.h||K1(p.w||(ao(p),p.w)||""))||"",m={};o>1&&(m.rowspan=o),l>1&&(m.colspan=l),n.editable?g='<span contenteditable="true">'+g+"</span>":p&&(m["data-t"]=p&&p.t||"z",p.v!=null&&(m["data-v"]=p.v),p.z!=null&&(m["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+p.l.Target+'">'+g+"</a>")),m.id=(n.id||"sjs")+"-"+f,s.push(Ve("td",g,m))}}var y="<tr>";return y+s.join("")+"</tr>"}var Nj='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Rj="</body></html>";function Dj(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return vl(L_(r[0],e),e);var n=Sv();return r.forEach(function(i,s){wv(n,L_(i,e),"Sheet"+(s+1))}),n}function Pj(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function CC(t,e){var r=e||{},n=r.header!=null?r.header:Nj,i=r.footer!=null?r.footer:Rj,s=[n],a=Yi(t["!ref"]);r.dense=Array.isArray(t),s.push(Pj(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(Ij(t,a,o,r));return s.push("</table>"+i),s.join("")}function kC(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Wr(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var f=Yi(t["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),i==-1&&(u.e.r=i=f.e.r+1)}var p=[],g=0,m=t["!rows"]||(t["!rows"]=[]),y=0,x=0,S=0,A=0,k=0,E=0;for(t["!cols"]||(t["!cols"]=[]);y<o.length&&x<l;++y){var P=o[y];if(U_(P)){if(n.display)continue;m[x]={hidden:!0}}var Y=P.children;for(S=A=0;S<Y.length;++S){var W=Y[S];if(!(n.display&&U_(W))){var T=W.hasAttribute("data-v")?W.getAttribute("data-v"):W.hasAttribute("v")?W.getAttribute("v"):XT(W.innerHTML),F=W.getAttribute("data-z")||W.getAttribute("z");for(g=0;g<p.length;++g){var w=p[g];w.s.c==A+s&&w.s.r<x+i&&x+i<=w.e.r&&(A=w.e.c+1-s,g=-1)}E=+W.getAttribute("colspan")||1,((k=+W.getAttribute("rowspan")||1)>1||E>1)&&p.push({s:{r:x+i,c:A+s},e:{r:x+i+(k||1)-1,c:A+s+(E||1)-1}});var I={t:"s",v:T},R=W.getAttribute("data-t")||W.getAttribute("t")||"";T!=null&&(T.length==0?I.t=R||"z":n.raw||T.trim().length==0||R=="s"||(T==="TRUE"?I={t:"b",v:!0}:T==="FALSE"?I={t:"b",v:!1}:isNaN(aa(T))?isNaN(vu(T).getDate())||(I={t:"d",v:Nr(T)},n.cellDates||(I={t:"n",v:Nn(I.v)}),I.z=n.dateNF||ut[14]):I={t:"n",v:aa(T)})),I.z===void 0&&F!=null&&(I.z=F);var D="",N=W.getElementsByTagName("A");if(N&&N.length)for(var Ge=0;Ge<N.length&&!(N[Ge].hasAttribute("href")&&(D=N[Ge].getAttribute("href"),D.charAt(0)!="#"));++Ge);D&&D.charAt(0)!="#"&&(I.l={Target:D}),n.dense?(t[x+i]||(t[x+i]=[]),t[x+i][A+s]=I):t[ft({c:A+s,r:x+i})]=I,u.e.c<A+s&&(u.e.c=A+s),A+=E}}++x}return p.length&&(t["!merges"]=(t["!merges"]||[]).concat(p)),u.e.r=Math.max(u.e.r,x-1+i),t["!ref"]=Tt(u),x>=l&&(t["!fullref"]=Tt((u.e.r=o.length-y+x-1+i,u))),t}function FC(t,e){var r=e||{},n=r.dense?[]:{};return kC(n,t,e)}function Oj(t,e){return vl(FC(t,e),e)}function U_(t){var e="",r=Mj(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Mj(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Bj(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=qt(e.replace(/<[^>]*>/g,""));return[r]}var V_={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function bC(t,e){var r=e||{},n=Y1(t),i=[],s,a,o={name:""},l="",u=0,f,p,g={},m=[],y=r.dense?[]:{},x,S,A={value:""},k="",E=0,P=[],Y=-1,W=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}},F=0,w={},I=[],R={},D=0,N=0,Ge=[],Ee=1,Pe=1,Ie=[],Ce={Names:[]},se={},be=["",""],Be=[],G={},ne="",ie=0,X=!1,ve=!1,Se=0;for(mf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=mf.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(T.e.c>=T.s.c&&T.e.r>=T.s.r?y["!ref"]=Tt(T):y["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=T.e.r&&(y["!fullref"]=y["!ref"],T.e.r=r.sheetRows-1,y["!ref"]=Tt(T)),I.length&&(y["!merges"]=I),Ge.length&&(y["!rows"]=Ge),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),m.push(f.name),g[f.name]=y,ve=!1):x[0].charAt(x[0].length-2)!=="/"&&(f=ht(x[0],!1),Y=W=-1,T.s.r=T.s.c=1e7,T.e.r=T.e.c=0,y=r.dense?[]:{},I=[],Ge=[],ve=!0);break;case"table-row-group":x[1]==="/"?--F:++F;break;case"table-row":case"":if(x[1]==="/"){Y+=Ee,Ee=1;break}if(p=ht(x[0],!1),p.?Y=p.-1:Y==-1&&(Y=0),Ee=+p["number-rows-repeated"]||1,Ee<10)for(Se=0;Se<Ee;++Se)F>0&&(Ge[Y+Se]={level:F});W=-1;break;case"covered-table-cell":x[1]!=="/"&&++W,r.sheetStubs&&(r.dense?(y[Y]||(y[Y]=[]),y[Y][W]={t:"z"}):y[ft({r:Y,c:W})]={t:"z"}),k="",P=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++W,A=ht(x[0],!1),Pe=parseInt(A["number-columns-repeated"]||"1",10),S={t:"z",v:null},A.formula&&r.cellFormula!=!1&&(S.f=M_(qt(A.formula))),(A.||A["value-type"])=="string"&&(S.t="s",S.v=qt(A["string-value"]||""),r.dense?(y[Y]||(y[Y]=[]),y[Y][W]=S):y[ft({r:Y,c:W})]=S),W+=Pe-1;else if(x[1]!=="/"){++W,k="",E=0,P=[],Pe=1;var Le=Ee?Y+Ee-1:Y;if(W>T.e.c&&(T.e.c=W),W<T.s.c&&(T.s.c=W),Y<T.s.r&&(T.s.r=Y),Le>T.e.r&&(T.e.r=Le),A=ht(x[0],!1),Be=[],G={},S={t:A.||A["value-type"],v:null},r.cellFormula)if(A.formula&&(A.formula=qt(A.formula)),A["number-matrix-columns-spanned"]&&A["number-matrix-rows-spanned"]&&(D=parseInt(A["number-matrix-rows-spanned"],10)||0,N=parseInt(A["number-matrix-columns-spanned"],10)||0,R={s:{r:Y,c:W},e:{r:Y+D-1,c:W+N-1}},S.F=Tt(R),Ie.push([R,S.F])),A.formula)S.f=M_(A.formula);else for(Se=0;Se<Ie.length;++Se)Y>=Ie[Se][0].s.r&&Y<=Ie[Se][0].e.r&&W>=Ie[Se][0].s.c&&W<=Ie[Se][0].e.c&&(S.F=Ie[Se][1]);switch((A["number-columns-spanned"]||A["number-rows-spanned"])&&(D=parseInt(A["number-rows-spanned"],10)||0,N=parseInt(A["number-columns-spanned"],10)||0,R={s:{r:Y,c:W},e:{r:Y+D-1,c:W+N-1}},I.push(R)),A["number-columns-repeated"]&&(Pe=parseInt(A["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=br(A["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(A.value);break;case"percentage":S.t="n",S.v=parseFloat(A.value);break;case"currency":S.t="n",S.v=parseFloat(A.value);break;case"date":S.t="d",S.v=Nr(A["date-value"]),r.cellDates||(S.t="n",S.v=Nn(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=uR(A["time-value"])/86400,r.cellDates&&(S.t="d",S.v=$p(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(A.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",A["string-value"]!=null&&(k=qt(A["string-value"]),P=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(X=!1,S.t==="s"&&(S.v=k||"",P.length&&(S.R=P),X=E==0),se.Target&&(S.l=se),Be.length>0&&(S.c=Be,Be=[]),k&&r.cellText!==!1&&(S.w=k),X&&(S.t="z",delete S.v),(!X||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=Y))for(var Ne=0;Ne<Ee;++Ne){if(Pe=parseInt(A["number-columns-repeated"]||"1",10),r.dense)for(y[Y+Ne]||(y[Y+Ne]=[]),y[Y+Ne][W]=Ne==0?S:Rr(S);--Pe>0;)y[Y+Ne][W+Pe]=Rr(S);else for(y[ft({r:Y+Ne,c:W})]=S;--Pe>0;)y[ft({r:Y+Ne,c:W+Pe})]=Rr(S);T.e.c<=W&&(T.e.c=W)}Pe=parseInt(A["number-columns-repeated"]||"1",10),W+=Pe-1,Pe=0,S={},k="",P=[]}se={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s;G.t=k,P.length&&(G.R=P),G.a=ne,Be.push(G)}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);ne="",ie=0,k="",E=0,P=[];break;case"creator":x[1]==="/"?ne=n.slice(ie,x.index):ie=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);k="",E=0,P=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(w[o.name]=l,(s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&(l="",o=ht(x[0],!1),i.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=ht(x[0],!1),l+=V_[x[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=ht(x[0],!1),l+=V_[x[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,x.index);break}else u=x.index+x[0].length;break;case"named-range":a=ht(x[0],!1),be=Yg(a["cell-range-address"]);var ke={Name:a.name,Ref:be[0]+"!"+be[1]};ve&&(ke.Sheet=m.length),Ce.Names.push(ke);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(x[1]==="/"&&(!A||!A["string-value"])){var rt=Bj(n.slice(E,x.index));k=(k.length>0?k+`
`:"")+rt[0]}else ht(x[0],!1),E=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{be=Yg(ht(x[0])["target-range-address"]),g[be[0]]["!autofilter"]={ref:be[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(se=ht(x[0],!1),!se.href)break;se.Target=qt(se.href),delete se.href,se.Target.charAt(0)=="#"&&se.Target.indexOf(".")>-1?(be=Yg(se.Target.slice(1)),se.Target="#"+be[0]+"!"+be[1]):se.Target.match(/^\.\.[\\\/]/)&&(se.Target=se.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var ee={Sheets:g,SheetNames:m,Workbook:Ce};return r.bookSheets&&delete ee.Sheets,ee}function z_(t,e){e=e||{},bs(t,"META-INF/manifest.xml")&&uD(mn(t,"META-INF/manifest.xml"),e);var r=os(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=bC(vr(r),e);return bs(t,"meta.xml")&&(n.Props=yA(mn(t,"meta.xml"))),n}function W_(t,e){return bC(t,e)}var jj=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+gf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return cn+e}}(),H_=function(){var t=function(s){return cr(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+cr(a.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,f=0,p=Yi(s["!ref"]||"A1"),g=s["!merges"]||[],m=0,y=Array.isArray(s);if(s["!cols"])for(f=0;f<=p.e.c;++f)l.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var x="",S=s["!rows"]||[];for(u=0;u<p.s.r;++u)x=S[u]?' table:style-name="ro'+S[u].ods+'"':"",l.push("        <table:table-row"+x+`></table:table-row>
`);for(;u<=p.e.r;++u){for(x=S[u]?' table:style-name="ro'+S[u].ods+'"':"",l.push("        <table:table-row"+x+`>
`),f=0;f<p.s.c;++f)l.push(e);for(;f<=p.e.c;++f){var A=!1,k={},E="";for(m=0;m!=g.length;++m)if(!(g[m].s.c>f)&&!(g[m].s.r>u)&&!(g[m].e.c<f)&&!(g[m].e.r<u)){(g[m].s.c!=f||g[m].s.r!=u)&&(A=!0),k["table:number-columns-spanned"]=g[m].e.c-g[m].s.c+1,k["table:number-rows-spanned"]=g[m].e.r-g[m].s.r+1;break}if(A){l.push(r);continue}var P=ft({r:u,c:f}),Y=y?(s[u]||[])[f]:s[P];if(Y&&Y.f&&(k["table:formula"]=cr(iO(Y.f)),Y.F&&Y.F.slice(0,P.length)==P)){var W=Yi(Y.F);k["table:number-matrix-columns-spanned"]=W.e.c-W.s.c+1,k["table:number-matrix-rows-spanned"]=W.e.r-W.s.r+1}if(!Y){l.push(e);continue}switch(Y.t){case"b":E=Y.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=Y.v?"true":"false";break;case"n":E=Y.w||String(Y.v||0),k["office:value-type"]="float",k["office:value"]=Y.v||0;break;case"s":case"str":E=Y.v==null?"":Y.v,k["office:value-type"]="string";break;case"d":E=Y.w||Nr(Y.v).toISOString(),k["office:value-type"]="date",k["office:date-value"]=Nr(Y.v).toISOString(),k["table:style-name"]="ce1";break;default:l.push(e);continue}var T=t(E);if(Y.l&&Y.l.Target){var F=Y.l.Target;F=F.charAt(0)=="#"?"#"+sO(F.slice(1)):F,F.charAt(0)!="#"&&!F.match(/^\w+:/)&&(F="../"+F),T=Ve("text:a",T,{"xlink:href":F.replace(/&/g,"&amp;")})}l.push("          "+Ve("table:table-cell",Ve("text:p",T,{}),k)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var f=0;f<u["!cols"].length;++f)if(u["!cols"][f]){var p=u["!cols"][f];if(p.width==null&&p.wpx==null&&p.wch==null)continue;ll(p),p.ods=o;var g=u["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var f=0;f<u["!rows"].length;++f)if(u["!rows"][f]){u["!rows"][f].ods=l;var p=u["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[cn],u=gf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=gf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+f+`>
`),l.push(vA().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var p=0;p!=a.SheetNames.length;++p)l.push(n(a.Sheets[a.SheetNames[p]],a,p));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function IC(t,e){if(e.bookType=="fods")return H_(t,e);var r=H1(),n="",i=[],s=[];return n="mimetype",At(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",At(r,n,H_(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",At(r,n,jj(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",At(r,n,cn+vA()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",At(r,n,hD(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",At(r,n,dD(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function tc(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function yx(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):vr(xl(t))}function Lj(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):as(wa(t))}function Uj(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function ul(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function $_(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function Vj(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function zj(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function wf(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function or(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Qr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function er(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=wf(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=wf(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:o,type:s};e[i]==null?e[i]=[u]:e[i].push(u)}return e}function Yn(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(or(n*8+i.type)),i.type==2&&e.push(or(i.data.length)),e.push(i.data))})}),ul(e)}function xv(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function ks(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=wf(t,n),s=er(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:Qr(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=er(o.data),u=Qr(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=s[3])!=null&&e[0]&&(a.merge=Qr(s[3][0].data)>>>0>0),r.push(a)}return r}function bc(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:or(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:or(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:or(a.data.length)}],n[2].push({data:Yn(a.meta),type:2})});var s=Yn(n);e.push(or(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),ul(e)}function Wj(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=wf(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,u=0;if(s==1?(u=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[ul(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var f=ul(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function Fs(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(Wj(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return ul(e)}function Ic(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=or(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return ul(e)}function Hj(t,e,r,n){var i=tc(t),s=i.getUint32(4,!0),a=(n>1?12:8)+$_(s&(n>1?3470:398))*4,o=-1,l=-1,u=NaN,f=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=$_(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(a,!0),a+=4),s&32&&(u=i.getFloat64(a,!0),a+=8),s&64&&(f.setTime(f.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var p;switch(t[2]){case 0:break;case 2:p={t:"n",v:u};break;case 3:p={t:"s",v:e[l]};break;case 5:p={t:"d",v:f};break;case 6:p={t:"b",v:u>0};break;case 7:p={t:"n",v:u/86400};break;case 8:p={t:"e",v:0};break;case 9:if(o>-1)p={t:"s",v:r[o]};else if(l>-1)p={t:"s",v:e[l]};else if(!isNaN(u))p={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return p}function $j(t,e,r){var n=tc(t),i=n.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,u=NaN,f=new Date(2001,0,1);i&1&&(l=Vj(t,s),s+=16),i&2&&(u=n.getFloat64(s,!0),s+=8),i&4&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var p;switch(t[1]){case 0:break;case 2:p={t:"n",v:l};break;case 3:p={t:"s",v:e[o]};break;case 5:p={t:"d",v:f};break;case 6:p={t:"b",v:u>0};break;case 7:p={t:"n",v:u/86400};break;case 8:p={t:"e",v:0};break;case 9:if(a>-1)p={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:p={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return p}function qg(t,e){var r=new Uint8Array(32),n=tc(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,zj(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function Qg(t,e){var r=new Uint8Array(32),n=tc(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function Gj(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return Hj(t,e,r,t[0]);case 5:return $j(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function li(t){var e=er(t);return wf(e[1][0].data)}function G_(t,e){var r=er(e.data),n=Qr(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=er(a.data),l=Qr(o[1][0].data)>>>0;switch(n){case 1:s[l]=yx(o[3][0].data);break;case 8:{var u=t[li(o[9][0].data)][0],f=er(u.data),p=t[li(f[1][0].data)][0],g=Qr(p.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var m=er(p.data);s[l]=m[3].map(function(y){return yx(y.data)}).join("")}break}}),s}function Kj(t,e){var r,n,i,s,a,o,l,u,f,p,g,m,y,x,S=er(t),A=Qr(S[1][0].data)>>>0,k=Qr(S[2][0].data)>>>0,E=((n=(r=S[8])==null?void 0:r[0])==null?void 0:n.data)&&Qr(S[8][0].data)>0||!1,P,Y;if((s=(i=S[7])==null?void 0:i[0])!=null&&s.data&&e!=0)P=(o=(a=S[7])==null?void 0:a[0])==null?void 0:o.data,Y=(u=(l=S[6])==null?void 0:l[0])==null?void 0:u.data;else if((p=(f=S[4])==null?void 0:f[0])!=null&&p.data&&e!=1)P=(m=(g=S[4])==null?void 0:g[0])==null?void 0:m.data,Y=(x=(y=S[3])==null?void 0:y[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var W=E?4:1,T=tc(P),F=[],w=0;w<P.length/2;++w){var I=T.getUint16(w*2,!0);I<65535&&F.push([w,I])}if(F.length!=k)throw"Expected ".concat(k," cells, found ").concat(F.length);var R=[];for(w=0;w<F.length-1;++w)R[F[w][0]]=Y.subarray(F[w][1]*W,F[w+1][1]*W);return F.length>=1&&(R[F[F.length-1][0]]=Y.subarray(F[F.length-1][1]*W)),{R:A,cells:R}}function Yj(t,e){var r,n=er(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Qr(n[7][0].data)>>>0>0?1:0:-1,s=xv(n[5],function(a){return Kj(a,i)});return{nrows:Qr(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,u){if(a[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));a[o.R][u]=l}),a},[])}}function Xj(t,e,r){var n,i=er(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Qr(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Qr(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=Tt(s);var a=er(i[4][0].data),o=G_(t,t[li(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?G_(t,t[li(a[17][0].data)][0]):[],u=er(a[3][0].data),f=0;u[1].forEach(function(p){var g=er(p.data),m=t[li(g[2][0].data)][0],y=Qr(m.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var x=Yj(t,m);x.data.forEach(function(S,A){S.forEach(function(k,E){var P=ft({r:f+A,c:E}),Y=Gj(k,o,l);Y&&(r[P]=Y)})}),f+=x.nrows})}function qj(t,e){var r=er(e.data),n={"!ref":"A1"},i=t[li(r[2][0].data)],s=Qr(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return Xj(t,i[0],n),n}function Qj(t,e){var r,n=er(e.data),i={name:(r=n[1])!=null&&r[0]?yx(n[1][0].data):"",sheets:[]},s=xv(n[2],li);return s.forEach(function(a){t[a].forEach(function(o){var l=Qr(o.meta[1][0].data);l==6e3&&i.sheets.push(qj(t,o))})}),i}function Jj(t,e){var r=Sv(),n=er(e.data),i=xv(n[1],li);if(i.forEach(function(s){t[s].forEach(function(a){var o=Qr(a.meta[1][0].data);if(o==2){var l=Qj(t,a);l.sheets.forEach(function(u,f){wv(r,u,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Jg(t){var e,r,n,i,s={},a=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=Fs(l.content)}catch(p){return console.log("?? "+l.content.length+" "+(p.message||p))}var f;try{f=ks(u)}catch(p){return console.log("## "+(p.message||p))}f.forEach(function(p){s[p.id]=p.messages,a.push(p.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Qr(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(u){var f=Qr(u.meta[1][0].data)>>>0;if(f==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Jj(s,o)}function Zj(t,e,r){var n,i,s,a;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=t[8])==null?void 0:s[0])==null?void 0:a.data)&&Qr(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=tc(t[7][0].data),f=0,p=[],g=tc(t[4][0].data),m=0,y=[],x=0;x<e.length;++x){if(e[x]==null){u.setUint16(x*2,65535,!0),g.setUint16(x*2,65535);continue}u.setUint16(x*2,f,!0),g.setUint16(x*2,m,!0);var S,A;switch(typeof e[x]){case"string":S=qg({t:"s",v:e[x]},r),A=Qg({t:"s",v:e[x]},r);break;case"number":S=qg({t:"n",v:e[x]},r),A=Qg({t:"n",v:e[x]},r);break;case"boolean":S=qg({t:"b",v:e[x]},r),A=Qg({t:"b",v:e[x]},r);break;default:throw new Error("Unsupported value "+e[x])}p.push(S),f+=S.length,y.push(A),m+=A.length,++l}for(t[2][0].data=or(l);x<t[7][0].data.length/2;++x)u.setUint16(x*2,65535,!0),g.setUint16(x*2,65535,!0);return t[6][0].data=ul(p),t[3][0].data=ul(y),l}function eL(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Yi(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Tt(n)));var s=op(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(ne){return ne.forEach(function(ie){typeof ie=="string"&&a.push(ie)})});var o={},l=[],u=it.read(e.numbers,{type:"base64"});u.FileIndex.map(function(ne,ie){return[ne,u.FullPaths[ie]]}).forEach(function(ne){var ie=ne[0],X=ne[1];if(ie.type==2&&ie.name.match(/\.iwa/)){var ve=ie.content,Se=Fs(ve),Le=ks(Se);Le.forEach(function(Ne){l.push(Ne.id),o[Ne.id]={deps:[],location:X,type:Qr(Ne.messages[0].meta[1][0].data)}})}}),l.sort(function(ne,ie){return ne-ie});var f=l.filter(function(ne){return ne>1}).map(function(ne){return[ne,or(ne)]});u.FileIndex.map(function(ne,ie){return[ne,u.FullPaths[ie]]}).forEach(function(ne){var ie=ne[0];if(ne[1],!!ie.name.match(/\.iwa/)){var X=ks(Fs(ie.content));X.forEach(function(ve){ve.messages.forEach(function(Se){f.forEach(function(Le){ve.messages.some(function(Ne){return Qr(Ne.meta[1][0].data)!=11006&&Uj(Ne.data,Le[1])})&&o[Le[0]].deps.push(ve.id)})})})}});for(var p=it.find(u,o[1].location),g=ks(Fs(p.content)),m,y=0;y<g.length;++y){var x=g[y];x.id==1&&(m=x)}var S=li(er(m.messages[0].data)[1][0].data);for(p=it.find(u,o[S].location),g=ks(Fs(p.content)),y=0;y<g.length;++y)x=g[y],x.id==S&&(m=x);for(S=li(er(m.messages[0].data)[2][0].data),p=it.find(u,o[S].location),g=ks(Fs(p.content)),y=0;y<g.length;++y)x=g[y],x.id==S&&(m=x);for(S=li(er(m.messages[0].data)[2][0].data),p=it.find(u,o[S].location),g=ks(Fs(p.content)),y=0;y<g.length;++y)x=g[y],x.id==S&&(m=x);var A=er(m.messages[0].data);{A[6][0].data=or(n.e.r+1),A[7][0].data=or(n.e.c+1);var k=li(A[46][0].data),E=it.find(u,o[k].location),P=ks(Fs(E.content));{for(var Y=0;Y<P.length&&P[Y].id!=k;++Y);if(P[Y].id!=k)throw"Bad ColumnRowUIDMapArchive";var W=er(P[Y].messages[0].data);W[1]=[],W[2]=[],W[3]=[];for(var T=0;T<=n.e.c;++T){var F=[];F[1]=F[2]=[{type:0,data:or(T+420690)}],W[1].push({type:2,data:Yn(F)}),W[2].push({type:0,data:or(T)}),W[3].push({type:0,data:or(T)})}W[4]=[],W[5]=[],W[6]=[];for(var w=0;w<=n.e.r;++w)F=[],F[1]=F[2]=[{type:0,data:or(w+726270)}],W[4].push({type:2,data:Yn(F)}),W[5].push({type:0,data:or(w)}),W[6].push({type:0,data:or(w)});P[Y].messages[0].data=Yn(W)}E.content=Ic(bc(P)),E.size=E.content.length,delete A[46];var I=er(A[4][0].data);{I[7][0].data=or(n.e.r+1);var R=er(I[1][0].data),D=li(R[2][0].data);E=it.find(u,o[D].location),P=ks(Fs(E.content));{if(P[0].id!=D)throw"Bad HeaderStorageBucket";var N=er(P[0].messages[0].data);for(w=0;w<s.length;++w){var Ge=er(N[2][0].data);Ge[1][0].data=or(w),Ge[4][0].data=or(s[w].length),N[2][w]={type:N[2][0].type,data:Yn(Ge)}}P[0].messages[0].data=Yn(N)}E.content=Ic(bc(P)),E.size=E.content.length;var Ee=li(I[2][0].data);E=it.find(u,o[Ee].location),P=ks(Fs(E.content));{if(P[0].id!=Ee)throw"Bad HeaderStorageBucket";for(N=er(P[0].messages[0].data),T=0;T<=n.e.c;++T)Ge=er(N[2][0].data),Ge[1][0].data=or(T),Ge[4][0].data=or(n.e.r+1),N[2][T]={type:N[2][0].type,data:Yn(Ge)};P[0].messages[0].data=Yn(N)}E.content=Ic(bc(P)),E.size=E.content.length;var Pe=li(I[4][0].data);(function(){for(var ne=it.find(u,o[Pe].location),ie=ks(Fs(ne.content)),X,ve=0;ve<ie.length;++ve){var Se=ie[ve];Se.id==Pe&&(X=Se)}var Le=er(X.messages[0].data);{Le[3]=[];var Ne=[];a.forEach(function(ee,Dt){Ne[1]=[{type:0,data:or(Dt)}],Ne[2]=[{type:0,data:or(1)}],Ne[3]=[{type:2,data:Lj(ee)}],Le[3].push({type:2,data:Yn(Ne)})})}X.messages[0].data=Yn(Le);var ke=bc(ie),rt=Ic(ke);ne.content=rt,ne.size=ne.content.length})();var Ie=er(I[3][0].data);{var Ce=Ie[1][0];delete Ie[2];var se=er(Ce.data);{var be=li(se[2][0].data);(function(){for(var ne=it.find(u,o[be].location),ie=ks(Fs(ne.content)),X,ve=0;ve<ie.length;++ve){var Se=ie[ve];Se.id==be&&(X=Se)}var Le=er(X.messages[0].data);{delete Le[6],delete Ie[7];var Ne=new Uint8Array(Le[5][0].data);Le[5]=[];for(var ke=0,rt=0;rt<=n.e.r;++rt){var ee=er(Ne);ke+=Zj(ee,s[rt],a),ee[1][0].data=or(rt),Le[5].push({data:Yn(ee),type:2})}Le[1]=[{type:0,data:or(n.e.c+1)}],Le[2]=[{type:0,data:or(n.e.r+1)}],Le[3]=[{type:0,data:or(ke)}],Le[4]=[{type:0,data:or(n.e.r+1)}]}X.messages[0].data=Yn(Le);var Dt=bc(ie),Et=Ic(Dt);ne.content=Et,ne.size=ne.content.length})()}Ce.data=Yn(se)}I[3][0].data=Yn(Ie)}A[4][0].data=Yn(I)}m.messages[0].data=Yn(A);var Be=bc(g),G=Ic(Be);return p.content=G,p.size=p.content.length,u}function NC(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function vv(t){NC([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function yv(t){NC([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function tL(t){return Rt.WS.indexOf(t)>-1?"sheet":t==Rt.CS?"chart":t==Rt.DS?"dialog":t==Rt.MS?"macro":t&&t.length?t:"sheet"}function rL(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,tL(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function nL(t,e,r,n,i,s,a,o,l,u,f,p){try{s[n]=Bd(os(t,r,!0),e);var g=mn(t,e),m;switch(o){case"sheet":m=AB(g,e,i,l,s[n],u,f,p);break;case"chart":if(m=CB(g,e,i,l,s[n],u,f,p),!m||!m["!drawel"])break;var y=_d(m["!drawel"].Target,e),x=xf(y),S=f8(os(t,y,!0),Bd(os(t,x,!0),y)),A=_d(S,y),k=xf(A);m=ZM(os(t,A,!0),A,l,Bd(os(t,k,!0),A),u,m);break;case"macro":m=kB(g,e,i,l,s[n],u,f,p);break;case"dialog":m=FB(g,e,i,l,s[n],u,f,p);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=m;var E=[];s&&s[n]&&Jr(s[n]).forEach(function(P){var Y="";if(s[n][P].Type==Rt.CMNT){Y=_d(s[n][P].Target,e);var W=RB(mn(t,Y,!0),Y,l);if(!W||!W.length)return;N_(m,W,!1)}s[n][P].Type==Rt.TCMNT&&(Y=_d(s[n][P].Target,e),E=E.concat(p8(mn(t,Y,!0),l)))}),E&&E.length&&N_(m,E,!0,l.people||[])}catch(P){if(l.WTF)throw P}}function As(t){return t.charAt(0)=="/"?t.slice(1):t}function iL(t,e){if(Pu(),e=e||{},vv(e),bs(t,"META-INF/manifest.xml")||bs(t,"objectdata.xml"))return z_(t,e);if(bs(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Jg<"u"){if(t.FileIndex)return Jg(t);var r=it.utils.cfb_new();return J2(t).forEach(function(Ge){At(r,Ge,gR(t,Ge))}),Jg(r)}throw new Error("Unsupported NUMBERS file")}if(!bs(t,"[Content_Types].xml"))throw bs(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):bs(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=J2(t),i=lD(os(t,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",mn(t,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!mn(t,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},u={};if(!e.bookSheets&&!e.bookProps){if(jd=[],i.sst)try{jd=NB(mn(t,As(i.sst)),i.sst,e)}catch(Ge){if(e.WTF)throw Ge}e.cellStyles&&i.themes.length&&(l=IB(os(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(u=bB(mn(t,As(i.style)),i.style,l,e))}i.links.map(function(Ge){try{var Ee=Bd(os(t,xf(As(Ge))),Ge);return PB(mn(t,As(Ge)),Ee,Ge,e)}catch{}});var f=TB(mn(t,As(i.workbooks[0])),i.workbooks[0],e),p={},g="";i.coreprops.length&&(g=mn(t,As(i.coreprops[0]),!0),g&&(p=yA(g)),i.extprops.length!==0&&(g=mn(t,As(i.extprops[0]),!0),g&&gD(g,p,e)));var m={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(g=os(t,As(i.custprops[0]),!0),g&&(m=xD(g,e)));var y={};if((e.bookSheets||e.bookProps)&&(f.Sheets?a=f.Sheets.map(function(Ee){return Ee.name}):p.Worksheets&&p.SheetNames.length>0&&(a=p.SheetNames),e.bookProps&&(y.Props=p,y.Custprops=m),e.bookSheets&&typeof a<"u"&&(y.SheetNames=a),e.bookSheets?y.SheetNames:e.bookProps))return y;a={};var x={};e.bookDeps&&i.calcchain&&(x=DB(mn(t,As(i.calcchain)),i.calcchain));var S=0,A={},k,E;{var P=f.Sheets;p.Worksheets=P.length,p.SheetNames=[];for(var Y=0;Y!=P.length;++Y)p.SheetNames[Y]=P[Y].name}var W=s?"bin":"xml",T=i.workbooks[0].lastIndexOf("/"),F=(i.workbooks[0].slice(0,T+1)+"_rels/"+i.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");bs(t,F)||(F="xl/_rels/workbook."+W+".rels");var w=Bd(os(t,F,!0),F.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=OB(mn(t,As(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=m8(mn(t,As(i.people[0])),e)),w&&(w=rL(w,f.Sheets));var I=mn(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=p.Worksheets;++S){var R="sheet";if(w&&w[S]?(k="xl/"+w[S][1].replace(/[\/]?xl\//,""),bs(t,k)||(k=w[S][1]),bs(t,k)||(k=F.replace(/_rels\/.*$/,"")+w[S][1]),R=w[S][2]):(k="xl/worksheets/sheet"+(S+1-I)+"."+W,k=k.replace(/sheet0\./,"sheet.")),E=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(S!=e.sheets)continue e;break;case"string":if(p.SheetNames[S].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var D=!1,N=0;N!=e.sheets.length;++N)typeof e.sheets[N]=="number"&&e.sheets[N]==S&&(D=1),typeof e.sheets[N]=="string"&&e.sheets[N].toLowerCase()==p.SheetNames[S].toLowerCase()&&(D=1);if(!D)continue e}}nL(t,k,E,p.SheetNames[S],S,A,a,R,e,f,l,u)}return y={Directory:i,Workbook:f,Props:p,Custprops:m,Deps:x,Sheets:a,SheetNames:p.SheetNames,Strings:jd,Styles:u,Themes:l,SSF:Rr(ut)},e&&e.bookFiles&&(t.files?(y.keys=n,y.files=t.files):(y.keys=[],y.files={},t.FullPaths.forEach(function(Ge,Ee){Ge=Ge.replace(/^Root Entry[\/]/,""),y.keys.push(Ge),y.files[Ge]=t.FileIndex[Ee]}))),e&&e.bookVBA&&(i.vba.length>0?y.vbaraw=mn(t,As(i.vba[0]),!0):i.defaults&&i.defaults.bin===T8&&(y.vbaraw=mn(t,"xl/vbaProject.bin",!0))),y}function sL(t,e){var r=e||{},n="Workbook",i=it.find(t,n);try{if(n="/!DataSpaces/Version",i=it.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(O6(i.content),n="/!DataSpaces/DataSpaceMap",i=it.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=B6(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=it.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=j6(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=it.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);U6(i.content)}catch{}if(n="/EncryptionInfo",i=it.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=V6(i.content);if(n="/EncryptedPackage",i=it.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function aL(t,e){return e.bookType=="ods"?IC(t,e):e.bookType=="numbers"?eL(t,e):e.bookType=="xlsb"?oL(t,e):lL(t,e)}function oL(t,e){Xc=1024,t&&!t.SSF&&(t.SSF=Rr(ut)),t&&t.SSF&&(Pu(),zp(t.SSF),e.revssf=Hp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Ld?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=iC.indexOf(e.bookType)>-1,i=iv();yv(e=e||{});var s=H1(),a="",o=0;if(e.cellXfs=[],yl(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",At(s,a,_A(t.Props,e)),i.coreprops.push(a),lr(e.rels,2,a,Rt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,At(s,a,wA(t.Props)),i.extprops.push(a),lr(e.rels,3,a,Rt.EXT_PROPS),t.Custprops!==t.Props&&Jr(t.Custprops||{}).length>0&&(a="docProps/custom.xml",At(s,a,TA(t.Custprops)),i.custprops.push(a),lr(e.rels,4,a,Rt.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var f={"!id":{}},p=t.Sheets[t.SheetNames[o-1]],g=(p||{})["!type"]||"sheet";switch(g){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,At(s,a,BB(o-1,a,e,t,f)),i.sheets.push(a),lr(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Rt.WS[0])}if(p){var m=p["!comments"],y=!1,x="";m&&m.length>0&&(x="xl/comments"+o+"."+r,At(s,x,UB(m,x)),i.comments.push(x),lr(f,-1,"../comments"+o+"."+r,Rt.CMNT),y=!0),p["!legacy"]&&y&&At(s,"xl/drawings/vmlDrawing"+o+".vml",rC(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}f["!id"].rId1&&At(s,xf(a),iu(f))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,At(s,a,LB(e.Strings,a,e)),i.strs.push(a),lr(e.wbrels,-1,"sharedStrings."+r,Rt.SST)),a="xl/workbook."+r,At(s,a,MB(t,a)),i.workbooks.push(a),lr(e.rels,1,a,Rt.WB),a="xl/theme/theme1.xml",At(s,a,uv(t.Themes,e)),i.themes.push(a),lr(e.wbrels,-1,"theme/theme1.xml",Rt.THEME),a="xl/styles."+r,At(s,a,jB(t,a,e)),i.styles.push(a),lr(e.wbrels,-1,"styles."+r,Rt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",At(s,a,t.vbaraw),i.vba.push(a),lr(e.wbrels,-1,"vbaProject.bin",Rt.VBA)),a="xl/metadata."+r,At(s,a,VB(a)),i.metadata.push(a),lr(e.wbrels,-1,"metadata."+r,Rt.XLMETA),At(s,"[Content_Types].xml",xA(i,e)),At(s,"_rels/.rels",iu(e.rels)),At(s,"xl/_rels/workbook."+r+".rels",iu(e.wbrels)),delete e.revssf,delete e.ssf,s}function lL(t,e){Xc=1024,t&&!t.SSF&&(t.SSF=Rr(ut)),t&&t.SSF&&(Pu(),zp(t.SSF),e.revssf=Hp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Ld?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=iC.indexOf(e.bookType)>-1,i=iv();yv(e=e||{});var s=H1(),a="",o=0;if(e.cellXfs=[],yl(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",At(s,a,_A(t.Props,e)),i.coreprops.push(a),lr(e.rels,2,a,Rt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,At(s,a,wA(t.Props)),i.extprops.push(a),lr(e.rels,3,a,Rt.EXT_PROPS),t.Custprops!==t.Props&&Jr(t.Custprops||{}).length>0&&(a="docProps/custom.xml",At(s,a,TA(t.Custprops)),i.custprops.push(a),lr(e.rels,4,a,Rt.CUST_PROPS));var f=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var p={"!id":{}},g=t.Sheets[t.SheetNames[o-1]],m=(g||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,At(s,a,gC(o-1,e,t,p)),i.sheets.push(a),lr(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Rt.WS[0])}if(g){var y=g["!comments"],x=!1,S="";if(y&&y.length>0){var A=!1;y.forEach(function(k){k[1].forEach(function(E){E.T==!0&&(A=!0)})}),A&&(S="xl/threadedComments/threadedComment"+o+"."+r,At(s,S,g8(y,f,e)),i.threadedcomments.push(S),lr(p,-1,"../threadedComments/threadedComment"+o+"."+r,Rt.TCMNT)),S="xl/comments"+o+"."+r,At(s,S,nC(y)),i.comments.push(S),lr(p,-1,"../comments"+o+"."+r,Rt.CMNT),x=!0}g["!legacy"]&&x&&At(s,"xl/drawings/vmlDrawing"+o+".vml",rC(o,g["!comments"])),delete g["!comments"],delete g["!legacy"]}p["!id"].rId1&&At(s,xf(a),iu(p))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,At(s,a,HA(e.Strings,e)),i.strs.push(a),lr(e.wbrels,-1,"sharedStrings."+r,Rt.SST)),a="xl/workbook."+r,At(s,a,_C(t)),i.workbooks.push(a),lr(e.rels,1,a,Rt.WB),a="xl/theme/theme1.xml",At(s,a,uv(t.Themes,e)),i.themes.push(a),lr(e.wbrels,-1,"theme/theme1.xml",Rt.THEME),a="xl/styles."+r,At(s,a,JA(t,e)),i.styles.push(a),lr(e.wbrels,-1,"styles."+r,Rt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",At(s,a,t.vbaraw),i.vba.push(a),lr(e.wbrels,-1,"vbaProject.bin",Rt.VBA)),a="xl/metadata."+r,At(s,a,tC()),i.metadata.push(a),lr(e.wbrels,-1,"metadata."+r,Rt.XLMETA),f.length>1&&(a="xl/persons/person.xml",At(s,a,x8(f)),i.people.push(a),lr(e.wbrels,-1,"persons/person.xml",Rt.PEOPLE)),At(s,"[Content_Types].xml",xA(i,e)),At(s,"_rels/.rels",iu(e.rels)),At(s,"xl/_rels/workbook."+r+".rels",iu(e.wbrels)),delete e.revssf,delete e.ssf,s}function _v(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=fs(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function cL(t,e){return it.find(t,"EncryptedPackage")?sL(t,e):TC(t,e)}function uL(t,e){var r,n=t,i=e||{};return i.type||(i.type=It&&Buffer.isBuffer(t)?"buffer":"base64"),r=GT(n,i),iL(r,i)}function RC(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return xx(t.slice(r),e);default:break e}return yu.to_workbook(t,e)}function dL(t,e){var r="",n=_v(t,e);switch(e.type){case"base64":r=fs(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Ql(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=vr(r)),e.type="binary",RC(r,e)}function fL(t,e){var r=t;return e.type=="base64"&&(r=fs(r)),r=df.utils.decode(1200,r.slice(2),"str"),e.type="binary",RC(r,e)}function hL(t){return t.match(/[^\x00-\x7F]/)?wa(t):t}function Zg(t,e,r,n){return n?(r.type="string",yu.to_workbook(t,r)):yu.to_workbook(e,r)}function Nl(t,e){L1();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Nl(new Uint8Array(t),(r=Rr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),au={},r.dateNF&&(au.dateNF=r.dateNF),r.type||(r.type=It&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=It?"buffer":"binary",n=oR(t),typeof Uint8Array<"u"&&!It&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=hL(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=Rr(r),r.type="array",Nl(U1(n),r)}switch((i=_v(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return cL(it.read(n,r),r);break;case 9:if(i[1]<=8)return TC(n,r);break;case 60:return xx(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return v6(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return zA.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?uL(n,r):Zg(t,n,r,s);case 239:return i[3]===60?xx(n,r):Zg(t,n,r,s);case 255:if(i[1]===254)return fL(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Vl.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Vl.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return mx.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return XA.to_workbook(n,r);break;case 10:case 13:case 32:return dL(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return x6.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?mx.to_workbook(n,r):Zg(t,n,r,s)}function DC(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Uf(e.file,it.write(t,{type:It?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return it.write(t,e)}function pL(t,e){var r=Rr(e||{}),n=aL(t,r);return gL(n,r)}function gL(t,e){var r={},n=It?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?it.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Vp(i))}return e.password&&typeof encrypt_agile<"u"?DC(encrypt_agile(i,e.password),e):e.type==="file"?Uf(e.file,i):e.type=="string"?vr(i):i}function mL(t,e){var r=e||{},n=hj(t,r);return DC(n,r)}function ya(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return ff(wa(n));case"binary":return wa(n);case"string":return t;case"file":return Uf(e.file,n,"utf8");case"buffer":return It?po(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):ya(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function xL(t,e){switch(e.type){case"base64":return ff(t);case"binary":return t;case"string":return t;case"file":return Uf(e.file,t,"binary");case"buffer":return It?po(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function H0(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?ff(r):e.type=="string"?vr(r):r;case"file":return Uf(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function PC(t,e){L1(),cB(t);var r=Rr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=PC(t,r);return r.type="array",Vp(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ya(aj(t,r),r);case"slk":case"sylk":return ya(VA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return ya(CC(t.Sheets[t.SheetNames[i]],r),r);case"txt":return xL(OC(t.Sheets[t.SheetNames[i]],r),r);case"csv":return ya(Ev(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return ya(zA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return H0(mx.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return ya(yu.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return ya(XA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return ya(WA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return ya(IC(t,r),r);case"wk1":return H0(Vl.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return H0(Vl.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),H0(AC(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),mL(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return pL(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function vL(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function Nc(t,e,r){var n={};return n.type="file",n.file=e,vL(n),PC(t,n)}function yL(t,e,r,n,i,s,a,o){var l=ln(r),u=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),p=!0,g=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:r,enumerable:!1})}catch{g.__rowNum__=r}else g.__rowNum__=r;if(!a||t[r])for(var m=e.s.c;m<=e.e.c;++m){var y=a?t[r][m]:t[n[m]+l];if(y===void 0||y.t===void 0){if(u===void 0)continue;s[m]!=null&&(g[s[m]]=u);continue}var x=y.v;switch(y.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(s[m]!=null){if(x==null)if(y.t=="e"&&x===null)g[s[m]]=null;else if(u!==void 0)g[s[m]]=u;else if(f&&x===null)g[s[m]]=null;else continue;else g[s[m]]=f&&(y.t!=="n"||y.t==="n"&&o.rawNumbers!==!1)?x:ao(y,x,o);x!=null&&(p=!1)}}return{row:g,isempty:p}}function op(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},f=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":l=Qt(f);break;case"number":l=Qt(t["!ref"]),l.s.r=f;break;default:l=f}n>0&&(i=0);var p=ln(l.s.r),g=[],m=[],y=0,x=0,S=Array.isArray(t),A=l.s.r,k=0,E={};S&&!t[A]&&(t[A]=[]);var P=u.skipHidden&&t["!cols"]||[],Y=u.skipHidden&&t["!rows"]||[];for(k=l.s.c;k<=l.e.c;++k)if(!(P[k]||{}).hidden)switch(g[k]=zr(k),r=S?t[A][k]:t[g[k]+p],n){case 1:s[k]=k-l.s.c;break;case 2:s[k]=g[k];break;case 3:s[k]=u.header[k-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=ao(r,null,u),x=E[a]||0,!x)E[a]=1;else{do o=a+"_"+x++;while(E[o]);E[a]=x,E[o]=1}s[k]=o}for(A=l.s.r+i;A<=l.e.r;++A)if(!(Y[A]||{}).hidden){var W=yL(t,l,A,g,n,s,S,u);(W.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(m[y++]=W.row)}return m.length=y,m}var K_=/"/g;function _L(t,e,r,n,i,s,a,o){for(var l=!0,u=[],f="",p=ln(r),g=e.s.c;g<=e.e.c;++g)if(n[g]){var m=o.dense?(t[r]||[])[g]:t[n[g]+p];if(m==null)f="";else if(m.v!=null){l=!1,f=""+(o.rawNumbers&&m.t=="n"?m.v:ao(m,null,o));for(var y=0,x=0;y!==f.length;++y)if((x=f.charCodeAt(y))===i||x===s||x===34||o.forceQuotes){f='"'+f.replace(K_,'""')+'"';break}f=="ID"&&(f='"ID"')}else m.f!=null&&!m.F?(l=!1,f="="+m.f,f.indexOf(",")>=0&&(f='"'+f.replace(K_,'""')+'"')):f="";u.push(f)}return o.blankrows===!1&&l?null:u.join(a)}function Ev(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=Qt(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),f="",p=[];n.dense=Array.isArray(t);for(var g=n.skipHidden&&t["!cols"]||[],m=n.skipHidden&&t["!rows"]||[],y=i.s.c;y<=i.e.c;++y)(g[y]||{}).hidden||(p[y]=zr(y));for(var x=0,S=i.s.r;S<=i.e.r;++S)(m[S]||{}).hidden||(f=_L(t,i,S,p,a,l,s,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((x++?o:"")+f)));return delete n.dense,r.join("")}function OC(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=Ev(t,e);return r}function EL(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=Qt(t["!ref"]),s="",a=[],o,l=[],u=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=zr(o);for(var f=i.s.r;f<=i.e.r;++f)for(s=ln(f),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=u?(t[f]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function MC(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Wr(n.origin):n.origin;a=l.r,o=l.c}var u,f={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var p=Qt(s["!ref"]);f.e.c=Math.max(f.e.c,p.e.c),f.e.r=Math.max(f.e.r,p.e.r),a==-1&&(a=p.e.r+1,f.e.r=a+e.length-1+i)}else a==-1&&(a=0,f.e.r=e.length-1+i);var g=n.header||[],m=0;e.forEach(function(x,S){Jr(x).forEach(function(A){(m=g.indexOf(A))==-1&&(g[m=g.length]=A);var k=x[A],E="z",P="",Y=ft({c:o+m,r:a+S+i});u=Tf(s,Y),k&&typeof k=="object"&&!(k instanceof Date)?s[Y]=k:(typeof k=="number"?E="n":typeof k=="boolean"?E="b":typeof k=="string"?E="s":k instanceof Date?(E="d",n.cellDates||(E="n",k=Nn(k)),P=n.dateNF||ut[14]):k===null&&n.nullError&&(E="e",k=0),u?(u.t=E,u.v=k,delete u.w,delete u.R,P&&(u.z=P)):s[Y]=u={t:E,v:k},P&&(u.z=P))})}),f.e.c=Math.max(f.e.c,o+g.length-1);var y=ln(a);if(i)for(m=0;m<g.length;++m)s[zr(m+o)+y]={t:"s",v:g[m]};return s["!ref"]=Tt(f),s}function SL(t,e){return MC(null,t,e)}function Tf(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Wr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Tf(t,ft(e)):Tf(t,ft({r:e,c:r||0}))}function wL(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Sv(){return{SheetNames:[],Sheets:{}}}function wv(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(yC(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function TL(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=wL(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function AL(t,e){return t.z=e,t}function BC(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function CL(t,e,r){return BC(t,"#"+e,r)}function kL(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function FL(t,e,r,n){for(var i=typeof e!="string"?e:Qt(e),s=typeof e=="string"?e:Tt(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=Tf(t,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var Er={encode_col:zr,encode_row:ln,encode_cell:ft,encode_range:Tt,decode_col:J1,decode_row:Q1,split_cell:LR,decode_cell:Wr,decode_range:Yi,format_cell:ao,sheet_add_aoa:uA,sheet_add_json:MC,sheet_add_dom:kC,aoa_to_sheet:Ou,json_to_sheet:SL,table_to_sheet:FC,table_to_book:Oj,sheet_to_csv:Ev,sheet_to_txt:OC,sheet_to_json:op,sheet_to_html:CC,sheet_to_formulae:EL,sheet_to_row_object_array:op,sheet_get_cell:Tf,book_new:Sv,book_append_sheet:wv,book_set_sheet_visibility:TL,cell_set_number_format:AL,cell_set_hyperlink:BC,cell_set_internal_link:CL,cell_add_comment:kL,sheet_set_array_formula:FL,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var bL={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IL=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ct=(t,e)=>{const r=ye.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:l,...u},f)=>ye.createElement("svg",{ref:f,...bL,width:i,height:i,stroke:n,strokeWidth:a?Number(s)*24/Number(i):s,className:["lucide",`lucide-${IL(t)}`,o].join(" "),...u},[...e.map(([p,g])=>ye.createElement(p,g)),...Array.isArray(l)?l:[l]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y_=Ct("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X_=Ct("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NL=Ct("BellRing",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q_=Ct("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q_=Ct("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RL=Ct("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J_=Ct("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z_=Ct("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const em=Ct("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DL=Ct("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $0=Ct("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tm=Ct("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eE=Ct("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bo=Ct("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PL=Ct("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rc=Ct("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cd=Ct("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ud=Ct("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rm=Ct("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tE=Ct("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G0=Ct("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K0=Ct("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OL=Ct("Merge",[["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M12 2v10.3a4 4 0 0 1-1.172 2.872L4 22",key:"1hyw0i"}],["path",{d:"m20 22-5-5",key:"1m27yz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ML=Ct("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y0=Ct("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nm=Ct("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dd=Ct("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rE=Ct("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Io=Ct("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BL=Ct("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jL=Ct("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X0=Ct("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nE=Ct("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LL=Ct("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iE=Ct("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UL=Ct("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=Ct("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=Ct("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sE=Ct("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _a=Ct("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var aE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jC=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},VL=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[r++],a=t[r++],o=t[r++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},LC={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,o=a?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,f=s>>2,p=(s&3)<<4|o>>4;let g=(o&15)<<2|u>>6,m=u&63;l||(m=64,a||(g=64)),n.push(r[f],r[p],r[g],r[m])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(jC(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):VL(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const u=i<t.length?r[t.charAt(i)]:64;++i;const p=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||u==null||p==null)throw new zL;const g=s<<2|o>>4;if(n.push(g),u!==64){const m=o<<4&240|u>>2;if(n.push(m),p!==64){const y=u<<6&192|p;n.push(y)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class zL extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const WL=function(t){const e=jC(t);return LC.encodeByteArray(e,!0)},lp=function(t){return WL(t).replace(/\./g,"")},UC=function(t){try{return LC.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HL(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $L=()=>HL().__FIREBASE_DEFAULTS__,GL=()=>{if(typeof process>"u"||typeof aE>"u")return;const t=aE.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},KL=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&UC(t[1]);return e&&JSON.parse(e)},qp=()=>{try{return $L()||GL()||KL()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},VC=t=>{var e,r;return(r=(e=qp())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},YL=t=>{const e=VC(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},zC=()=>{var t;return(t=qp())===null||t===void 0?void 0:t.config},WC=t=>{var e;return(e=qp())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XL{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qL(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[lp(JSON.stringify(r)),lp(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function QL(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(vi())}function JL(){var t;const e=(t=qp())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ZL(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function e9(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function t9(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function r9(){const t=vi();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function n9(){return!JL()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function i9(){try{return typeof indexedDB=="object"}catch{return!1}}function s9(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a9="FirebaseError";class xo extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=a9,Object.setPrototypeOf(this,xo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Yf.prototype.create)}}class Yf{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?o9(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new xo(i,o,n)}}function o9(t,e){return t.replace(l9,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const l9=/\{\$([^}]+)}/g;function c9(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function cp(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const s=t[i],a=e[i];if(oE(s)&&oE(a)){if(!cp(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function oE(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xf(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function u9(t,e){const r=new d9(t,e);return r.subscribe.bind(r)}class d9{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");f9(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=im),i.error===void 0&&(i.error=im),i.complete===void 0&&(i.complete=im);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function f9(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function im(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ca(t){return t&&t._delegate?t._delegate:t}class rc{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h9{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new XL;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(g9(e))try{this.getOrInitializeService({instanceIdentifier:bl})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=bl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=bl){return this.instances.has(e)}getOptions(e=bl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:p9(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=bl){return this.component?this.component.multipleInstances?e:bl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function p9(t){return t===bl?void 0:t}function g9(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m9{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new h9(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(zt||(zt={}));const x9={debug:zt.DEBUG,verbose:zt.VERBOSE,info:zt.INFO,warn:zt.WARN,error:zt.ERROR,silent:zt.SILENT},v9=zt.INFO,y9={[zt.DEBUG]:"log",[zt.VERBOSE]:"log",[zt.INFO]:"info",[zt.WARN]:"warn",[zt.ERROR]:"error"},_9=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=y9[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Tv{constructor(e){this.name=e,this._logLevel=v9,this._logHandler=_9,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in zt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?x9[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,zt.DEBUG,...e),this._logHandler(this,zt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,zt.VERBOSE,...e),this._logHandler(this,zt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,zt.INFO,...e),this._logHandler(this,zt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,zt.WARN,...e),this._logHandler(this,zt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,zt.ERROR,...e),this._logHandler(this,zt.ERROR,...e)}}const E9=(t,e)=>e.some(r=>t instanceof r);let lE,cE;function S9(){return lE||(lE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function w9(){return cE||(cE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const HC=new WeakMap,_x=new WeakMap,$C=new WeakMap,sm=new WeakMap,Av=new WeakMap;function T9(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(el(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&HC.set(r,t)}).catch(()=>{}),Av.set(e,t),e}function A9(t){if(_x.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});_x.set(t,e)}let Ex={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return _x.get(t);if(e==="objectStoreNames")return t.objectStoreNames||$C.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return el(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function C9(t){Ex=t(Ex)}function k9(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(am(this),e,...r);return $C.set(n,e.sort?e.sort():[e]),el(n)}:w9().includes(t)?function(...e){return t.apply(am(this),e),el(HC.get(this))}:function(...e){return el(t.apply(am(this),e))}}function F9(t){return typeof t=="function"?k9(t):(t instanceof IDBTransaction&&A9(t),E9(t,S9())?new Proxy(t,Ex):t)}function el(t){if(t instanceof IDBRequest)return T9(t);if(sm.has(t))return sm.get(t);const e=F9(t);return e!==t&&(sm.set(t,e),Av.set(e,t)),e}const am=t=>Av.get(t);function b9(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),o=el(a);return n&&a.addEventListener("upgradeneeded",l=>{n(el(a.result),l.oldVersion,l.newVersion,el(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const I9=["get","getKey","getAll","getAllKeys","count"],N9=["put","add","delete","clear"],om=new Map;function uE(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(om.get(e))return om.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=N9.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||I9.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let u=l.store;return n&&(u=u.index(o.shift())),(await Promise.all([u[r](...o),i&&l.done]))[0]};return om.set(e,s),s}C9(t=>({...t,get:(e,r,n)=>uE(e,r)||t.get(e,r,n),has:(e,r)=>!!uE(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R9{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(D9(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function D9(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Sx="@firebase/app",dE="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oo=new Tv("@firebase/app"),P9="@firebase/app-compat",O9="@firebase/analytics-compat",M9="@firebase/analytics",B9="@firebase/app-check-compat",j9="@firebase/app-check",L9="@firebase/auth",U9="@firebase/auth-compat",V9="@firebase/database",z9="@firebase/data-connect",W9="@firebase/database-compat",H9="@firebase/functions",$9="@firebase/functions-compat",G9="@firebase/installations",K9="@firebase/installations-compat",Y9="@firebase/messaging",X9="@firebase/messaging-compat",q9="@firebase/performance",Q9="@firebase/performance-compat",J9="@firebase/remote-config",Z9="@firebase/remote-config-compat",e7="@firebase/storage",t7="@firebase/storage-compat",r7="@firebase/firestore",n7="@firebase/vertexai-preview",i7="@firebase/firestore-compat",s7="firebase",a7="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wx="[DEFAULT]",o7={[Sx]:"fire-core",[P9]:"fire-core-compat",[M9]:"fire-analytics",[O9]:"fire-analytics-compat",[j9]:"fire-app-check",[B9]:"fire-app-check-compat",[L9]:"fire-auth",[U9]:"fire-auth-compat",[V9]:"fire-rtdb",[z9]:"fire-data-connect",[W9]:"fire-rtdb-compat",[H9]:"fire-fn",[$9]:"fire-fn-compat",[G9]:"fire-iid",[K9]:"fire-iid-compat",[Y9]:"fire-fcm",[X9]:"fire-fcm-compat",[q9]:"fire-perf",[Q9]:"fire-perf-compat",[J9]:"fire-rc",[Z9]:"fire-rc-compat",[e7]:"fire-gcs",[t7]:"fire-gcs-compat",[r7]:"fire-fst",[i7]:"fire-fst-compat",[n7]:"fire-vertex","fire-js":"fire-js",[s7]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const up=new Map,l7=new Map,Tx=new Map;function fE(t,e){try{t.container.addComponent(e)}catch(r){oo.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Eu(t){const e=t.name;if(Tx.has(e))return oo.debug(`There were multiple attempts to register component ${e}.`),!1;Tx.set(e,t);for(const r of up.values())fE(r,t);for(const r of l7.values())fE(r,t);return!0}function Cv(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Ho(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c7={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},tl=new Yf("app","Firebase",c7);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u7{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new rc("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw tl.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bu=a7;function GC(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:wx,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw tl.create("bad-app-name",{appName:String(i)});if(r||(r=zC()),!r)throw tl.create("no-options");const s=up.get(i);if(s){if(cp(r,s.options)&&cp(n,s.config))return s;throw tl.create("duplicate-app",{appName:i})}const a=new m9(i);for(const l of Tx.values())a.addComponent(l);const o=new u7(r,n,a);return up.set(i,o),o}function KC(t=wx){const e=up.get(t);if(!e&&t===wx&&zC())return GC();if(!e)throw tl.create("no-app",{appName:t});return e}function rl(t,e,r){var n;let i=(n=o7[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),oo.warn(o.join(" "));return}Eu(new rc(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d7="firebase-heartbeat-database",f7=1,Af="firebase-heartbeat-store";let lm=null;function YC(){return lm||(lm=b9(d7,f7,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Af)}catch(r){console.warn(r)}}}}).catch(t=>{throw tl.create("idb-open",{originalErrorMessage:t.message})})),lm}async function h7(t){try{const r=(await YC()).transaction(Af),n=await r.objectStore(Af).get(XC(t));return await r.done,n}catch(e){if(e instanceof xo)oo.warn(e.message);else{const r=tl.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});oo.warn(r.message)}}}async function hE(t,e){try{const n=(await YC()).transaction(Af,"readwrite");await n.objectStore(Af).put(e,XC(t)),await n.done}catch(r){if(r instanceof xo)oo.warn(r.message);else{const n=tl.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});oo.warn(n.message)}}}function XC(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p7=1024,g7=30*24*60*60*1e3;class m7{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new v7(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=pE();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=g7}),this._storage.overwrite(this._heartbeatsCache))}catch(n){oo.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=pE(),{heartbeatsToSend:n,unsentEntries:i}=x7(this._heartbeatsCache.heartbeats),s=lp(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return oo.warn(r),""}}}function pE(){return new Date().toISOString().substring(0,10)}function x7(t,e=p7){const r=[];let n=t.slice();for(const i of t){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),gE(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),gE(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class v7{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return i9()?s9().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await h7(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return hE(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return hE(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function gE(t){return lp(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y7(t){Eu(new rc("platform-logger",e=>new R9(e),"PRIVATE")),Eu(new rc("heartbeat",e=>new m7(e),"PRIVATE")),rl(Sx,dE,t),rl(Sx,dE,"esm2017"),rl("fire-js","")}y7("");var _7="firebase",E7="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */rl(_7,E7,"app");var mE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Wl,qC;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,F){function w(){}w.prototype=F.prototype,T.D=F.prototype,T.prototype=new w,T.prototype.constructor=T,T.C=function(I,R,D){for(var N=Array(arguments.length-2),Ge=2;Ge<arguments.length;Ge++)N[Ge-2]=arguments[Ge];return F.prototype[R].apply(I,N)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,F,w){w||(w=0);var I=Array(16);if(typeof F=="string")for(var R=0;16>R;++R)I[R]=F.charCodeAt(w++)|F.charCodeAt(w++)<<8|F.charCodeAt(w++)<<16|F.charCodeAt(w++)<<24;else for(R=0;16>R;++R)I[R]=F[w++]|F[w++]<<8|F[w++]<<16|F[w++]<<24;F=T.g[0],w=T.g[1],R=T.g[2];var D=T.g[3],N=F+(D^w&(R^D))+I[0]+3614090360&4294967295;F=w+(N<<7&4294967295|N>>>25),N=D+(R^F&(w^R))+I[1]+3905402710&4294967295,D=F+(N<<12&4294967295|N>>>20),N=R+(w^D&(F^w))+I[2]+606105819&4294967295,R=D+(N<<17&4294967295|N>>>15),N=w+(F^R&(D^F))+I[3]+3250441966&4294967295,w=R+(N<<22&4294967295|N>>>10),N=F+(D^w&(R^D))+I[4]+4118548399&4294967295,F=w+(N<<7&4294967295|N>>>25),N=D+(R^F&(w^R))+I[5]+1200080426&4294967295,D=F+(N<<12&4294967295|N>>>20),N=R+(w^D&(F^w))+I[6]+2821735955&4294967295,R=D+(N<<17&4294967295|N>>>15),N=w+(F^R&(D^F))+I[7]+4249261313&4294967295,w=R+(N<<22&4294967295|N>>>10),N=F+(D^w&(R^D))+I[8]+1770035416&4294967295,F=w+(N<<7&4294967295|N>>>25),N=D+(R^F&(w^R))+I[9]+2336552879&4294967295,D=F+(N<<12&4294967295|N>>>20),N=R+(w^D&(F^w))+I[10]+4294925233&4294967295,R=D+(N<<17&4294967295|N>>>15),N=w+(F^R&(D^F))+I[11]+2304563134&4294967295,w=R+(N<<22&4294967295|N>>>10),N=F+(D^w&(R^D))+I[12]+1804603682&4294967295,F=w+(N<<7&4294967295|N>>>25),N=D+(R^F&(w^R))+I[13]+4254626195&4294967295,D=F+(N<<12&4294967295|N>>>20),N=R+(w^D&(F^w))+I[14]+2792965006&4294967295,R=D+(N<<17&4294967295|N>>>15),N=w+(F^R&(D^F))+I[15]+1236535329&4294967295,w=R+(N<<22&4294967295|N>>>10),N=F+(R^D&(w^R))+I[1]+4129170786&4294967295,F=w+(N<<5&4294967295|N>>>27),N=D+(w^R&(F^w))+I[6]+3225465664&4294967295,D=F+(N<<9&4294967295|N>>>23),N=R+(F^w&(D^F))+I[11]+643717713&4294967295,R=D+(N<<14&4294967295|N>>>18),N=w+(D^F&(R^D))+I[0]+3921069994&4294967295,w=R+(N<<20&4294967295|N>>>12),N=F+(R^D&(w^R))+I[5]+3593408605&4294967295,F=w+(N<<5&4294967295|N>>>27),N=D+(w^R&(F^w))+I[10]+38016083&4294967295,D=F+(N<<9&4294967295|N>>>23),N=R+(F^w&(D^F))+I[15]+3634488961&4294967295,R=D+(N<<14&4294967295|N>>>18),N=w+(D^F&(R^D))+I[4]+3889429448&4294967295,w=R+(N<<20&4294967295|N>>>12),N=F+(R^D&(w^R))+I[9]+568446438&4294967295,F=w+(N<<5&4294967295|N>>>27),N=D+(w^R&(F^w))+I[14]+3275163606&4294967295,D=F+(N<<9&4294967295|N>>>23),N=R+(F^w&(D^F))+I[3]+4107603335&4294967295,R=D+(N<<14&4294967295|N>>>18),N=w+(D^F&(R^D))+I[8]+1163531501&4294967295,w=R+(N<<20&4294967295|N>>>12),N=F+(R^D&(w^R))+I[13]+2850285829&4294967295,F=w+(N<<5&4294967295|N>>>27),N=D+(w^R&(F^w))+I[2]+4243563512&4294967295,D=F+(N<<9&4294967295|N>>>23),N=R+(F^w&(D^F))+I[7]+1735328473&4294967295,R=D+(N<<14&4294967295|N>>>18),N=w+(D^F&(R^D))+I[12]+2368359562&4294967295,w=R+(N<<20&4294967295|N>>>12),N=F+(w^R^D)+I[5]+4294588738&4294967295,F=w+(N<<4&4294967295|N>>>28),N=D+(F^w^R)+I[8]+2272392833&4294967295,D=F+(N<<11&4294967295|N>>>21),N=R+(D^F^w)+I[11]+1839030562&4294967295,R=D+(N<<16&4294967295|N>>>16),N=w+(R^D^F)+I[14]+4259657740&4294967295,w=R+(N<<23&4294967295|N>>>9),N=F+(w^R^D)+I[1]+2763975236&4294967295,F=w+(N<<4&4294967295|N>>>28),N=D+(F^w^R)+I[4]+1272893353&4294967295,D=F+(N<<11&4294967295|N>>>21),N=R+(D^F^w)+I[7]+4139469664&4294967295,R=D+(N<<16&4294967295|N>>>16),N=w+(R^D^F)+I[10]+3200236656&4294967295,w=R+(N<<23&4294967295|N>>>9),N=F+(w^R^D)+I[13]+681279174&4294967295,F=w+(N<<4&4294967295|N>>>28),N=D+(F^w^R)+I[0]+3936430074&4294967295,D=F+(N<<11&4294967295|N>>>21),N=R+(D^F^w)+I[3]+3572445317&4294967295,R=D+(N<<16&4294967295|N>>>16),N=w+(R^D^F)+I[6]+76029189&4294967295,w=R+(N<<23&4294967295|N>>>9),N=F+(w^R^D)+I[9]+3654602809&4294967295,F=w+(N<<4&4294967295|N>>>28),N=D+(F^w^R)+I[12]+3873151461&4294967295,D=F+(N<<11&4294967295|N>>>21),N=R+(D^F^w)+I[15]+530742520&4294967295,R=D+(N<<16&4294967295|N>>>16),N=w+(R^D^F)+I[2]+3299628645&4294967295,w=R+(N<<23&4294967295|N>>>9),N=F+(R^(w|~D))+I[0]+4096336452&4294967295,F=w+(N<<6&4294967295|N>>>26),N=D+(w^(F|~R))+I[7]+1126891415&4294967295,D=F+(N<<10&4294967295|N>>>22),N=R+(F^(D|~w))+I[14]+2878612391&4294967295,R=D+(N<<15&4294967295|N>>>17),N=w+(D^(R|~F))+I[5]+4237533241&4294967295,w=R+(N<<21&4294967295|N>>>11),N=F+(R^(w|~D))+I[12]+1700485571&4294967295,F=w+(N<<6&4294967295|N>>>26),N=D+(w^(F|~R))+I[3]+2399980690&4294967295,D=F+(N<<10&4294967295|N>>>22),N=R+(F^(D|~w))+I[10]+4293915773&4294967295,R=D+(N<<15&4294967295|N>>>17),N=w+(D^(R|~F))+I[1]+2240044497&4294967295,w=R+(N<<21&4294967295|N>>>11),N=F+(R^(w|~D))+I[8]+1873313359&4294967295,F=w+(N<<6&4294967295|N>>>26),N=D+(w^(F|~R))+I[15]+4264355552&4294967295,D=F+(N<<10&4294967295|N>>>22),N=R+(F^(D|~w))+I[6]+2734768916&4294967295,R=D+(N<<15&4294967295|N>>>17),N=w+(D^(R|~F))+I[13]+1309151649&4294967295,w=R+(N<<21&4294967295|N>>>11),N=F+(R^(w|~D))+I[4]+4149444226&4294967295,F=w+(N<<6&4294967295|N>>>26),N=D+(w^(F|~R))+I[11]+3174756917&4294967295,D=F+(N<<10&4294967295|N>>>22),N=R+(F^(D|~w))+I[2]+718787259&4294967295,R=D+(N<<15&4294967295|N>>>17),N=w+(D^(R|~F))+I[9]+3951481745&4294967295,T.g[0]=T.g[0]+F&4294967295,T.g[1]=T.g[1]+(R+(N<<21&4294967295|N>>>11))&4294967295,T.g[2]=T.g[2]+R&4294967295,T.g[3]=T.g[3]+D&4294967295}n.prototype.u=function(T,F){F===void 0&&(F=T.length);for(var w=F-this.blockSize,I=this.B,R=this.h,D=0;D<F;){if(R==0)for(;D<=w;)i(this,T,D),D+=this.blockSize;if(typeof T=="string"){for(;D<F;)if(I[R++]=T.charCodeAt(D++),R==this.blockSize){i(this,I),R=0;break}}else for(;D<F;)if(I[R++]=T[D++],R==this.blockSize){i(this,I),R=0;break}}this.h=R,this.o+=F},n.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var F=1;F<T.length-8;++F)T[F]=0;var w=8*this.o;for(F=T.length-8;F<T.length;++F)T[F]=w&255,w/=256;for(this.u(T),T=Array(16),F=w=0;4>F;++F)for(var I=0;32>I;I+=8)T[w++]=this.g[F]>>>I&255;return T};function s(T,F){var w=o;return Object.prototype.hasOwnProperty.call(w,T)?w[T]:w[T]=F(T)}function a(T,F){this.h=F;for(var w=[],I=!0,R=T.length-1;0<=R;R--){var D=T[R]|0;I&&D==F||(w[R]=D,I=!1)}this.g=w}var o={};function l(T){return-128<=T&&128>T?s(T,function(F){return new a([F|0],0>F?-1:0)}):new a([T|0],0>T?-1:0)}function u(T){if(isNaN(T)||!isFinite(T))return p;if(0>T)return S(u(-T));for(var F=[],w=1,I=0;T>=w;I++)F[I]=T/w|0,w*=4294967296;return new a(F,0)}function f(T,F){if(T.length==0)throw Error("number format error: empty string");if(F=F||10,2>F||36<F)throw Error("radix out of range: "+F);if(T.charAt(0)=="-")return S(f(T.substring(1),F));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var w=u(Math.pow(F,8)),I=p,R=0;R<T.length;R+=8){var D=Math.min(8,T.length-R),N=parseInt(T.substring(R,R+D),F);8>D?(D=u(Math.pow(F,D)),I=I.j(D).add(u(N))):(I=I.j(w),I=I.add(u(N)))}return I}var p=l(0),g=l(1),m=l(16777216);t=a.prototype,t.m=function(){if(x(this))return-S(this).m();for(var T=0,F=1,w=0;w<this.g.length;w++){var I=this.i(w);T+=(0<=I?I:4294967296+I)*F,F*=4294967296}return T},t.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(y(this))return"0";if(x(this))return"-"+S(this).toString(T);for(var F=u(Math.pow(T,6)),w=this,I="";;){var R=P(w,F).g;w=A(w,R.j(F));var D=((0<w.g.length?w.g[0]:w.h)>>>0).toString(T);if(w=R,y(w))return D+I;for(;6>D.length;)D="0"+D;I=D+I}},t.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function y(T){if(T.h!=0)return!1;for(var F=0;F<T.g.length;F++)if(T.g[F]!=0)return!1;return!0}function x(T){return T.h==-1}t.l=function(T){return T=A(this,T),x(T)?-1:y(T)?0:1};function S(T){for(var F=T.g.length,w=[],I=0;I<F;I++)w[I]=~T.g[I];return new a(w,~T.h).add(g)}t.abs=function(){return x(this)?S(this):this},t.add=function(T){for(var F=Math.max(this.g.length,T.g.length),w=[],I=0,R=0;R<=F;R++){var D=I+(this.i(R)&65535)+(T.i(R)&65535),N=(D>>>16)+(this.i(R)>>>16)+(T.i(R)>>>16);I=N>>>16,D&=65535,N&=65535,w[R]=N<<16|D}return new a(w,w[w.length-1]&-2147483648?-1:0)};function A(T,F){return T.add(S(F))}t.j=function(T){if(y(this)||y(T))return p;if(x(this))return x(T)?S(this).j(S(T)):S(S(this).j(T));if(x(T))return S(this.j(S(T)));if(0>this.l(m)&&0>T.l(m))return u(this.m()*T.m());for(var F=this.g.length+T.g.length,w=[],I=0;I<2*F;I++)w[I]=0;for(I=0;I<this.g.length;I++)for(var R=0;R<T.g.length;R++){var D=this.i(I)>>>16,N=this.i(I)&65535,Ge=T.i(R)>>>16,Ee=T.i(R)&65535;w[2*I+2*R]+=N*Ee,k(w,2*I+2*R),w[2*I+2*R+1]+=D*Ee,k(w,2*I+2*R+1),w[2*I+2*R+1]+=N*Ge,k(w,2*I+2*R+1),w[2*I+2*R+2]+=D*Ge,k(w,2*I+2*R+2)}for(I=0;I<F;I++)w[I]=w[2*I+1]<<16|w[2*I];for(I=F;I<2*F;I++)w[I]=0;return new a(w,0)};function k(T,F){for(;(T[F]&65535)!=T[F];)T[F+1]+=T[F]>>>16,T[F]&=65535,F++}function E(T,F){this.g=T,this.h=F}function P(T,F){if(y(F))throw Error("division by zero");if(y(T))return new E(p,p);if(x(T))return F=P(S(T),F),new E(S(F.g),S(F.h));if(x(F))return F=P(T,S(F)),new E(S(F.g),F.h);if(30<T.g.length){if(x(T)||x(F))throw Error("slowDivide_ only works with positive integers.");for(var w=g,I=F;0>=I.l(T);)w=Y(w),I=Y(I);var R=W(w,1),D=W(I,1);for(I=W(I,2),w=W(w,2);!y(I);){var N=D.add(I);0>=N.l(T)&&(R=R.add(w),D=N),I=W(I,1),w=W(w,1)}return F=A(T,R.j(F)),new E(R,F)}for(R=p;0<=T.l(F);){for(w=Math.max(1,Math.floor(T.m()/F.m())),I=Math.ceil(Math.log(w)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),D=u(w),N=D.j(F);x(N)||0<N.l(T);)w-=I,D=u(w),N=D.j(F);y(D)&&(D=g),R=R.add(D),T=A(T,N)}return new E(R,T)}t.A=function(T){return P(this,T).h},t.and=function(T){for(var F=Math.max(this.g.length,T.g.length),w=[],I=0;I<F;I++)w[I]=this.i(I)&T.i(I);return new a(w,this.h&T.h)},t.or=function(T){for(var F=Math.max(this.g.length,T.g.length),w=[],I=0;I<F;I++)w[I]=this.i(I)|T.i(I);return new a(w,this.h|T.h)},t.xor=function(T){for(var F=Math.max(this.g.length,T.g.length),w=[],I=0;I<F;I++)w[I]=this.i(I)^T.i(I);return new a(w,this.h^T.h)};function Y(T){for(var F=T.g.length+1,w=[],I=0;I<F;I++)w[I]=T.i(I)<<1|T.i(I-1)>>>31;return new a(w,T.h)}function W(T,F){var w=F>>5;F%=32;for(var I=T.g.length-w,R=[],D=0;D<I;D++)R[D]=0<F?T.i(D+w)>>>F|T.i(D+w+1)<<32-F:T.i(D+w);return new a(R,T.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,qC=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=f,Wl=a}).apply(typeof mE<"u"?mE:typeof self<"u"?self:typeof window<"u"?window:{});var q0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var QC,Ed,JC,mh,Ax,ZC,ek,tk;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,v,C){return d==Array.prototype||d==Object.prototype||(d[v]=C.value),d};function r(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof q0=="object"&&q0];for(var v=0;v<d.length;++v){var C=d[v];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var n=r(this);function i(d,v){if(v)e:{var C=n;d=d.split(".");for(var j=0;j<d.length-1;j++){var ue=d[j];if(!(ue in C))break e;C=C[ue]}d=d[d.length-1],j=C[d],v=v(j),v!=j&&v!=null&&e(C,d,{configurable:!0,writable:!0,value:v})}}function s(d,v){d instanceof String&&(d+="");var C=0,j=!1,ue={next:function(){if(!j&&C<d.length){var xe=C++;return{value:v(xe,d[xe]),done:!1}}return j=!0,{done:!0,value:void 0}}};return ue[Symbol.iterator]=function(){return ue},ue}i("Array.prototype.values",function(d){return d||function(){return s(this,function(v,C){return C})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(d){var v=typeof d;return v=v!="object"?v:d?Array.isArray(d)?"array":v:"null",v=="array"||v=="object"&&typeof d.length=="number"}function u(d){var v=typeof d;return v=="object"&&d!=null||v=="function"}function f(d,v,C){return d.call.apply(d.bind,arguments)}function p(d,v,C){if(!d)throw Error();if(2<arguments.length){var j=Array.prototype.slice.call(arguments,2);return function(){var ue=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ue,j),d.apply(v,ue)}}return function(){return d.apply(v,arguments)}}function g(d,v,C){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,g.apply(null,arguments)}function m(d,v){var C=Array.prototype.slice.call(arguments,1);return function(){var j=C.slice();return j.push.apply(j,arguments),d.apply(this,j)}}function y(d,v){function C(){}C.prototype=v.prototype,d.aa=v.prototype,d.prototype=new C,d.prototype.constructor=d,d.Qb=function(j,ue,xe){for(var $e=Array(arguments.length-2),ar=2;ar<arguments.length;ar++)$e[ar-2]=arguments[ar];return v.prototype[ue].apply(j,$e)}}function x(d){const v=d.length;if(0<v){const C=Array(v);for(let j=0;j<v;j++)C[j]=d[j];return C}return[]}function S(d,v){for(let C=1;C<arguments.length;C++){const j=arguments[C];if(l(j)){const ue=d.length||0,xe=j.length||0;d.length=ue+xe;for(let $e=0;$e<xe;$e++)d[ue+$e]=j[$e]}else d.push(j)}}class A{constructor(v,C){this.i=v,this.j=C,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function k(d){return/^[\s\xa0]*$/.test(d)}function E(){var d=o.navigator;return d&&(d=d.userAgent)?d:""}function P(d){return P[" "](d),d}P[" "]=function(){};var Y=E().indexOf("Gecko")!=-1&&!(E().toLowerCase().indexOf("webkit")!=-1&&E().indexOf("Edge")==-1)&&!(E().indexOf("Trident")!=-1||E().indexOf("MSIE")!=-1)&&E().indexOf("Edge")==-1;function W(d,v,C){for(const j in d)v.call(C,d[j],j,d)}function T(d,v){for(const C in d)v.call(void 0,d[C],C,d)}function F(d){const v={};for(const C in d)v[C]=d[C];return v}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(d,v){let C,j;for(let ue=1;ue<arguments.length;ue++){j=arguments[ue];for(C in j)d[C]=j[C];for(let xe=0;xe<w.length;xe++)C=w[xe],Object.prototype.hasOwnProperty.call(j,C)&&(d[C]=j[C])}}function R(d){var v=1;d=d.split(":");const C=[];for(;0<v&&d.length;)C.push(d.shift()),v--;return d.length&&C.push(d.join(":")),C}function D(d){o.setTimeout(()=>{throw d},0)}function N(){var d=se;let v=null;return d.g&&(v=d.g,d.g=d.g.next,d.g||(d.h=null),v.next=null),v}class Ge{constructor(){this.h=this.g=null}add(v,C){const j=Ee.get();j.set(v,C),this.h?this.h.next=j:this.g=j,this.h=j}}var Ee=new A(()=>new Pe,d=>d.reset());class Pe{constructor(){this.next=this.g=this.h=null}set(v,C){this.h=v,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let Ie,Ce=!1,se=new Ge,be=()=>{const d=o.Promise.resolve(void 0);Ie=()=>{d.then(Be)}};var Be=()=>{for(var d;d=N();){try{d.h.call(d.g)}catch(C){D(C)}var v=Ee;v.j(d),100>v.h&&(v.h++,d.next=v.g,v.g=d)}Ce=!1};function G(){this.s=this.s,this.C=this.C}G.prototype.s=!1,G.prototype.ma=function(){this.s||(this.s=!0,this.N())},G.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ne(d,v){this.type=d,this.g=this.target=v,this.defaultPrevented=!1}ne.prototype.h=function(){this.defaultPrevented=!0};var ie=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var d=!1,v=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const C=()=>{};o.addEventListener("test",C,v),o.removeEventListener("test",C,v)}catch{}return d}();function X(d,v){if(ne.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var C=this.type=d.type,j=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=v,v=d.relatedTarget){if(Y){e:{try{P(v.nodeName);var ue=!0;break e}catch{}ue=!1}ue||(v=null)}}else C=="mouseover"?v=d.fromElement:C=="mouseout"&&(v=d.toElement);this.relatedTarget=v,j?(this.clientX=j.clientX!==void 0?j.clientX:j.pageX,this.clientY=j.clientY!==void 0?j.clientY:j.pageY,this.screenX=j.screenX||0,this.screenY=j.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:ve[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&X.aa.h.call(this)}}y(X,ne);var ve={2:"touch",3:"pen",4:"mouse"};X.prototype.h=function(){X.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var Se="closure_listenable_"+(1e6*Math.random()|0),Le=0;function Ne(d,v,C,j,ue){this.listener=d,this.proxy=null,this.src=v,this.type=C,this.capture=!!j,this.ha=ue,this.key=++Le,this.da=this.fa=!1}function ke(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function rt(d){this.src=d,this.g={},this.h=0}rt.prototype.add=function(d,v,C,j,ue){var xe=d.toString();d=this.g[xe],d||(d=this.g[xe]=[],this.h++);var $e=Dt(d,v,j,ue);return-1<$e?(v=d[$e],C||(v.fa=!1)):(v=new Ne(v,this.src,xe,!!j,ue),v.fa=C,d.push(v)),v};function ee(d,v){var C=v.type;if(C in d.g){var j=d.g[C],ue=Array.prototype.indexOf.call(j,v,void 0),xe;(xe=0<=ue)&&Array.prototype.splice.call(j,ue,1),xe&&(ke(v),d.g[C].length==0&&(delete d.g[C],d.h--))}}function Dt(d,v,C,j){for(var ue=0;ue<d.length;++ue){var xe=d[ue];if(!xe.da&&xe.listener==v&&xe.capture==!!C&&xe.ha==j)return ue}return-1}var Et="closure_lm_"+(1e6*Math.random()|0),Nt={};function xt(d,v,C,j,ue){if(Array.isArray(v)){for(var xe=0;xe<v.length;xe++)xt(d,v[xe],C,j,ue);return null}return C=Ri(C),d&&d[Se]?d.K(v,C,u(j)?!!j.capture:!1,ue):He(d,v,C,!1,j,ue)}function He(d,v,C,j,ue,xe){if(!v)throw Error("Invalid event type");var $e=u(ue)?!!ue.capture:!!ue,ar=Ni(d);if(ar||(d[Et]=ar=new rt(d)),C=ar.add(v,C,j,$e,xe),C.proxy)return C;if(j=fr(),C.proxy=j,j.src=d,j.listener=C,d.addEventListener)ie||(ue=$e),ue===void 0&&(ue=!1),d.addEventListener(v.toString(),j,ue);else if(d.attachEvent)d.attachEvent(Ii(v.toString()),j);else if(d.addListener&&d.removeListener)d.addListener(j);else throw Error("addEventListener and attachEvent are unavailable.");return C}function fr(){function d(C){return v.call(d.src,d.listener,C)}const v=Xi;return d}function Wn(d,v,C,j,ue){if(Array.isArray(v))for(var xe=0;xe<v.length;xe++)Wn(d,v[xe],C,j,ue);else j=u(j)?!!j.capture:!!j,C=Ri(C),d&&d[Se]?(d=d.i,v=String(v).toString(),v in d.g&&(xe=d.g[v],C=Dt(xe,C,j,ue),-1<C&&(ke(xe[C]),Array.prototype.splice.call(xe,C,1),xe.length==0&&(delete d.g[v],d.h--)))):d&&(d=Ni(d))&&(v=d.g[v.toString()],d=-1,v&&(d=Dt(v,C,j,ue)),(C=-1<d?v[d]:null)&&Zr(C))}function Zr(d){if(typeof d!="number"&&d&&!d.da){var v=d.src;if(v&&v[Se])ee(v.i,d);else{var C=d.type,j=d.proxy;v.removeEventListener?v.removeEventListener(C,j,d.capture):v.detachEvent?v.detachEvent(Ii(C),j):v.addListener&&v.removeListener&&v.removeListener(j),(C=Ni(v))?(ee(C,d),C.h==0&&(C.src=null,v[Et]=null)):ke(d)}}}function Ii(d){return d in Nt?Nt[d]:Nt[d]="on"+d}function Xi(d,v){if(d.da)d=!0;else{v=new X(v,this);var C=d.listener,j=d.ha||d.src;d.fa&&Zr(d),d=C.call(j,v)}return d}function Ni(d){return d=d[Et],d instanceof rt?d:null}var en="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ri(d){return typeof d=="function"?d:(d[en]||(d[en]=function(v){return d.handleEvent(v)}),d[en])}function nr(){G.call(this),this.i=new rt(this),this.M=this,this.F=null}y(nr,G),nr.prototype[Se]=!0,nr.prototype.removeEventListener=function(d,v,C,j){Wn(this,d,v,C,j)};function Br(d,v){var C,j=d.F;if(j)for(C=[];j;j=j.F)C.push(j);if(d=d.M,j=v.type||v,typeof v=="string")v=new ne(v,d);else if(v instanceof ne)v.target=v.target||d;else{var ue=v;v=new ne(j,d),I(v,ue)}if(ue=!0,C)for(var xe=C.length-1;0<=xe;xe--){var $e=v.g=C[xe];ue=Ar($e,j,!0,v)&&ue}if($e=v.g=d,ue=Ar($e,j,!0,v)&&ue,ue=Ar($e,j,!1,v)&&ue,C)for(xe=0;xe<C.length;xe++)$e=v.g=C[xe],ue=Ar($e,j,!1,v)&&ue}nr.prototype.N=function(){if(nr.aa.N.call(this),this.i){var d=this.i,v;for(v in d.g){for(var C=d.g[v],j=0;j<C.length;j++)ke(C[j]);delete d.g[v],d.h--}}this.F=null},nr.prototype.K=function(d,v,C,j){return this.i.add(String(d),v,!1,C,j)},nr.prototype.L=function(d,v,C,j){return this.i.add(String(d),v,!0,C,j)};function Ar(d,v,C,j){if(v=d.i.g[String(v)],!v)return!0;v=v.concat();for(var ue=!0,xe=0;xe<v.length;++xe){var $e=v[xe];if($e&&!$e.da&&$e.capture==C){var ar=$e.listener,dn=$e.ha||$e.src;$e.fa&&ee(d.i,$e),ue=ar.call(dn,j)!==!1&&ue}}return ue&&!j.defaultPrevented}function _i(d,v,C){if(typeof d=="function")C&&(d=g(d,C));else if(d&&typeof d.handleEvent=="function")d=g(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:o.setTimeout(d,v||0)}function pt(d){d.g=_i(()=>{d.g=null,d.i&&(d.i=!1,pt(d))},d.l);const v=d.h;d.h=null,d.m.apply(null,v)}class Cr extends G{constructor(v,C){super(),this.m=v,this.l=C,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:pt(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Sr(d){G.call(this),this.h=d,this.g={}}y(Sr,G);var Dr=[];function Ei(d){W(d.g,function(v,C){this.g.hasOwnProperty(C)&&Zr(v)},d),d.g={}}Sr.prototype.N=function(){Sr.aa.N.call(this),Ei(this)},Sr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var vo=o.JSON.stringify,Pa=o.JSON.parse,Wu=class{stringify(d){return o.JSON.stringify(d,void 0)}parse(d){return o.JSON.parse(d,void 0)}};function Vs(){}Vs.prototype.h=null;function _l(d){return d.h||(d.h=d.i())}function zs(){}var ce={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function hr(){ne.call(this,"d")}y(hr,ne);function Di(){ne.call(this,"c")}y(Di,ne);var gs={},Oa=null;function Ws(){return Oa=Oa||new nr}gs.La="serverreachability";function ua(d){ne.call(this,gs.La,d)}y(ua,ne);function Pi(d){const v=Ws();Br(v,new ua(v))}gs.STAT_EVENT="statevent";function yn(d,v){ne.call(this,gs.STAT_EVENT,d),this.stat=v}y(yn,ne);function un(d){const v=Ws();Br(v,new yn(v,d))}gs.Ma="timingevent";function Ma(d,v){ne.call(this,gs.Ma,d),this.size=v}y(Ma,ne);function Hs(d,v){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){d()},v)}function _n(){this.g=!0}_n.prototype.xa=function(){this.g=!1};function xc(d,v,C,j,ue,xe){d.info(function(){if(d.g)if(xe)for(var $e="",ar=xe.split("&"),dn=0;dn<ar.length;dn++){var Ht=ar[dn].split("=");if(1<Ht.length){var Pn=Ht[0];Ht=Ht[1];var Tn=Pn.split("_");$e=2<=Tn.length&&Tn[1]=="type"?$e+(Pn+"="+Ht+"&"):$e+(Pn+"=redacted&")}}else $e=null;else $e=xe;return"XMLHTTP REQ ("+j+") [attempt "+ue+"]: "+v+`
`+C+`
`+$e})}function qi(d,v,C,j,ue,xe,$e){d.info(function(){return"XMLHTTP RESP ("+j+") [ attempt "+ue+"]: "+v+`
`+C+`
`+xe+" "+$e})}function b(d,v,C,j){d.info(function(){return"XMLHTTP TEXT ("+v+"): "+L(d,C)+(j?" "+j:"")})}function K(d,v){d.info(function(){return"TIMEOUT: "+v})}_n.prototype.info=function(){};function L(d,v){if(!d.g)return v;if(!v)return null;try{var C=JSON.parse(v);if(C){for(d=0;d<C.length;d++)if(Array.isArray(C[d])){var j=C[d];if(!(2>j.length)){var ue=j[1];if(Array.isArray(ue)&&!(1>ue.length)){var xe=ue[0];if(xe!="noop"&&xe!="stop"&&xe!="close")for(var $e=1;$e<ue.length;$e++)ue[$e]=""}}}}return vo(C)}catch{return v}}var U={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},q={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Q;function de(){}y(de,Vs),de.prototype.g=function(){return new XMLHttpRequest},de.prototype.i=function(){return{}},Q=new de;function me(d,v,C,j){this.j=d,this.i=v,this.l=C,this.R=j||1,this.U=new Sr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new fe}function fe(){this.i=null,this.g="",this.h=!1}var le={},pe={};function we(d,v,C){d.L=1,d.v=La(Sn(v)),d.m=C,d.P=!0,Ue(d,null)}function Ue(d,v){d.F=Date.now(),qe(d),d.A=Sn(d.v);var C=d.A,j=d.R;Array.isArray(j)||(j=[String(j)]),s0(C.i,"t",j),d.C=0,C=d.j.J,d.h=new fe,d.g=Tc(d.j,C?v:null,!d.m),0<d.O&&(d.M=new Cr(g(d.Y,d,d.g),d.O)),v=d.U,C=d.g,j=d.ca;var ue="readystatechange";Array.isArray(ue)||(ue&&(Dr[0]=ue.toString()),ue=Dr);for(var xe=0;xe<ue.length;xe++){var $e=xt(C,ue[xe],j||v.handleEvent,!1,v.h||v);if(!$e)break;v.g[$e.key]=$e}v=d.H?F(d.H):{},d.m?(d.u||(d.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,v)):(d.u="GET",d.g.ea(d.A,d.u,null,v)),Pi(),xc(d.i,d.u,d.A,d.l,d.R,d.m)}me.prototype.ca=function(d){d=d.target;const v=this.M;v&&_s(d)==3?v.j():this.Y(d)},me.prototype.Y=function(d){try{if(d==this.g)e:{const Tn=_s(this.g);var v=this.g.Ba();const Ao=this.g.Z();if(!(3>Tn)&&(Tn!=3||this.g&&(this.h.h||this.g.oa()||Tl(this.g)))){this.J||Tn!=4||v==7||(v==8||0>=Ao?Pi(3):Pi(2)),Pt(this);var C=this.g.Z();this.X=C;t:if(Ke(this)){var j=Tl(this.g);d="";var ue=j.length,xe=_s(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){wr(this),Ut(this);var $e="";break t}this.h.i=new o.TextDecoder}for(v=0;v<ue;v++)this.h.h=!0,d+=this.h.i.decode(j[v],{stream:!(xe&&v==ue-1)});j.length=0,this.h.g+=d,this.C=0,$e=this.h.g}else $e=this.g.oa();if(this.o=C==200,qi(this.i,this.u,this.A,this.l,this.R,Tn,C),this.o){if(this.T&&!this.K){t:{if(this.g){var ar,dn=this.g;if((ar=dn.g?dn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(ar)){var Ht=ar;break t}}Ht=null}if(C=Ht)b(this.i,this.l,C,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Oi(this,C);else{this.o=!1,this.s=3,un(12),wr(this),Ut(this);break e}}if(this.P){C=!0;let Ui;for(;!this.J&&this.C<$e.length;)if(Ui=De(this,$e),Ui==pe){Tn==4&&(this.s=4,un(14),C=!1),b(this.i,this.l,null,"[Incomplete Response]");break}else if(Ui==le){this.s=4,un(15),b(this.i,this.l,$e,"[Invalid Chunk]"),C=!1;break}else b(this.i,this.l,Ui,null),Oi(this,Ui);if(Ke(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Tn!=4||$e.length!=0||this.h.h||(this.s=1,un(16),C=!1),this.o=this.o&&C,!C)b(this.i,this.l,$e,"[Invalid Chunked Response]"),wr(this),Ut(this);else if(0<$e.length&&!this.W){this.W=!0;var Pn=this.j;Pn.g==this&&Pn.ba&&!Pn.M&&(Pn.j.info("Great, no buffering proxy detected. Bytes received: "+$e.length),Sc(Pn),Pn.M=!0,un(11))}}else b(this.i,this.l,$e,null),Oi(this,$e);Tn==4&&wr(this),this.o&&!this.J&&(Tn==4?u0(this.j,this):(this.o=!1,qe(this)))}else Wt(this.g),C==400&&0<$e.indexOf("Unknown SID")?(this.s=3,un(12)):(this.s=0,un(13)),wr(this),Ut(this)}}}catch{}finally{}};function Ke(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function De(d,v){var C=d.C,j=v.indexOf(`
`,C);return j==-1?pe:(C=Number(v.substring(C,j)),isNaN(C)?le:(j+=1,j+C>v.length?pe:(v=v.slice(j,j+C),d.C=j+C,v)))}me.prototype.cancel=function(){this.J=!0,wr(this)};function qe(d){d.S=Date.now()+d.I,dt(d,d.I)}function dt(d,v){if(d.B!=null)throw Error("WatchDog timer not null");d.B=Hs(g(d.ba,d),v)}function Pt(d){d.B&&(o.clearTimeout(d.B),d.B=null)}me.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(K(this.i,this.A),this.L!=2&&(Pi(),un(17)),wr(this),this.s=2,Ut(this)):dt(this,this.S-d)};function Ut(d){d.j.G==0||d.J||u0(d.j,d)}function wr(d){Pt(d);var v=d.M;v&&typeof v.ma=="function"&&v.ma(),d.M=null,Ei(d.U),d.g&&(v=d.g,d.g=null,v.abort(),v.ma())}function Oi(d,v){try{var C=d.j;if(C.G!=0&&(C.g==d||st(C.h,d))){if(!d.K&&st(C.h,d)&&C.G==3){try{var j=C.Da.g.parse(v)}catch{j=null}if(Array.isArray(j)&&j.length==3){var ue=j;if(ue[0]==0){e:if(!C.u){if(C.g)if(C.g.F+3e3<d.F)wc(C),So(C);else break e;za(C),un(18)}}else C.za=ue[1],0<C.za-C.T&&37500>ue[2]&&C.F&&C.v==0&&!C.C&&(C.C=Hs(g(C.Za,C),6e3));if(1>=xs(C.h)&&C.ca){try{C.ca()}catch{}C.ca=void 0}}else Ss(C,11)}else if((d.K||C.g==d)&&wc(C),!k(v))for(ue=C.Da.g.parse(v),v=0;v<ue.length;v++){let Ht=ue[v];if(C.T=Ht[0],Ht=Ht[1],C.G==2)if(Ht[0]=="c"){C.K=Ht[1],C.ia=Ht[2];const Pn=Ht[3];Pn!=null&&(C.la=Pn,C.j.info("VER="+C.la));const Tn=Ht[4];Tn!=null&&(C.Aa=Tn,C.j.info("SVER="+C.Aa));const Ao=Ht[5];Ao!=null&&typeof Ao=="number"&&0<Ao&&(j=1.5*Ao,C.L=j,C.j.info("backChannelRequestTimeoutMs_="+j)),j=C;const Ui=d.g;if(Ui){const Ac=Ui.g?Ui.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ac){var xe=j.h;xe.g||Ac.indexOf("spdy")==-1&&Ac.indexOf("quic")==-1&&Ac.indexOf("h2")==-1||(xe.j=xe.l,xe.g=new Set,xe.h&&($s(xe,xe.h),xe.h=null))}if(j.D){const qu=Ui.g?Ui.g.getResponseHeader("X-HTTP-Session-Id"):null;qu&&(j.ya=qu,Ot(j.I,j.D,qu))}}C.G=3,C.l&&C.l.ua(),C.ba&&(C.R=Date.now()-d.F,C.j.info("Handshake RTT: "+C.R+"ms")),j=C;var $e=d;if(j.qa=Xu(j,j.J?j.ia:null,j.W),$e.K){Vt(j.h,$e);var ar=$e,dn=j.L;dn&&(ar.I=dn),ar.B&&(Pt(ar),qe(ar)),j.g=$e}else c0(j);0<C.i.length&&Dn(C)}else Ht[0]!="stop"&&Ht[0]!="close"||Ss(C,7);else C.G==3&&(Ht[0]=="stop"||Ht[0]=="close"?Ht[0]=="stop"?Ss(C,7):Kn(C):Ht[0]!="noop"&&C.l&&C.l.ta(Ht),C.v=0)}}Pi(4)}catch{}}var pr=class{constructor(d,v){this.g=d,this.map=v}};function ms(d){this.l=d||10,o.PerformanceNavigationTiming?(d=o.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function jr(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function xs(d){return d.h?1:d.g?d.g.size:0}function st(d,v){return d.h?d.h==v:d.g?d.g.has(v):!1}function $s(d,v){d.g?d.g.add(v):d.h=v}function Vt(d,v){d.h&&d.h==v?d.h=null:d.g&&d.g.has(v)&&d.g.delete(v)}ms.prototype.cancel=function(){if(this.i=Mi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function Mi(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let v=d.i;for(const C of d.g.values())v=v.concat(C.D);return v}return x(d.i)}function En(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(l(d)){for(var v=[],C=d.length,j=0;j<C;j++)v.push(d[j]);return v}v=[],C=0;for(j in d)v[C++]=d[j];return v}function Ba(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(l(d)||typeof d=="string"){var v=[];d=d.length;for(var C=0;C<d;C++)v.push(C);return v}v=[],C=0;for(const j in d)v[C++]=j;return v}}}function ja(d,v){if(d.forEach&&typeof d.forEach=="function")d.forEach(v,void 0);else if(l(d)||typeof d=="string")Array.prototype.forEach.call(d,v,void 0);else for(var C=Ba(d),j=En(d),ue=j.length,xe=0;xe<ue;xe++)v.call(void 0,j[xe],C&&C[xe],d)}var da=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function vc(d,v){if(d){d=d.split("&");for(var C=0;C<d.length;C++){var j=d[C].indexOf("="),ue=null;if(0<=j){var xe=d[C].substring(0,j);ue=d[C].substring(j+1)}else xe=d[C];v(xe,ue?decodeURIComponent(ue.replace(/\+/g," ")):"")}}}function Gs(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof Gs){this.h=d.h,fa(this,d.j),this.o=d.o,this.g=d.g,tn(this,d.s),this.l=d.l;var v=d.i,C=new $n;C.i=v.i,v.g&&(C.g=new Map(v.g),C.h=v.h),yo(this,C),this.m=d.m}else d&&(v=String(d).match(da))?(this.h=!1,fa(this,v[1]||"",!0),this.o=vs(v[2]||""),this.g=vs(v[3]||"",!0),tn(this,v[4]),this.l=vs(v[5]||"",!0),yo(this,v[6]||"",!0),this.m=vs(v[7]||"")):(this.h=!1,this.i=new $n(null,this.h))}Gs.prototype.toString=function(){var d=[],v=this.j;v&&d.push(Bi(v,Ua,!0),":");var C=this.g;return(C||v=="file")&&(d.push("//"),(v=this.o)&&d.push(Bi(v,Ua,!0),"@"),d.push(encodeURIComponent(String(C)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.s,C!=null&&d.push(":",String(C))),(C=this.l)&&(this.g&&C.charAt(0)!="/"&&d.push("/"),d.push(Bi(C,C.charAt(0)=="/"?yc:Hn,!0))),(C=this.i.toString())&&d.push("?",C),(C=this.m)&&d.push("#",Bi(C,_c)),d.join("")};function Sn(d){return new Gs(d)}function fa(d,v,C){d.j=C?vs(v,!0):v,d.j&&(d.j=d.j.replace(/:$/,""))}function tn(d,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);d.s=v}else d.s=null}function yo(d,v,C){v instanceof $n?(d.i=v,a0(d.i,d.h)):(C||(v=Bi(v,ji)),d.i=new $n(v,d.h))}function Ot(d,v,C){d.i.set(v,C)}function La(d){return Ot(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function vs(d,v){return d?v?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function Bi(d,v,C){return typeof d=="string"?(d=encodeURI(d).replace(v,Hu),C&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function Hu(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var Ua=/[#\/\?@]/g,Hn=/[#\?:]/g,yc=/[#\?]/g,ji=/[#\?@]/g,_c=/#/g;function $n(d,v){this.h=this.g=null,this.i=d||null,this.j=!!v}function ys(d){d.g||(d.g=new Map,d.h=0,d.i&&vc(d.i,function(v,C){d.add(decodeURIComponent(v.replace(/\+/g," ")),C)}))}t=$n.prototype,t.add=function(d,v){ys(this),this.i=null,d=Ks(this,d);var C=this.g.get(d);return C||this.g.set(d,C=[]),C.push(v),this.h+=1,this};function rn(d,v){ys(d),v=Ks(d,v),d.g.has(v)&&(d.i=null,d.h-=d.g.get(v).length,d.g.delete(v))}function El(d,v){return ys(d),v=Ks(d,v),d.g.has(v)}t.forEach=function(d,v){ys(this),this.g.forEach(function(C,j){C.forEach(function(ue){d.call(v,ue,j,this)},this)},this)},t.na=function(){ys(this);const d=Array.from(this.g.values()),v=Array.from(this.g.keys()),C=[];for(let j=0;j<v.length;j++){const ue=d[j];for(let xe=0;xe<ue.length;xe++)C.push(v[j])}return C},t.V=function(d){ys(this);let v=[];if(typeof d=="string")El(this,d)&&(v=v.concat(this.g.get(Ks(this,d))));else{d=Array.from(this.g.values());for(let C=0;C<d.length;C++)v=v.concat(d[C])}return v},t.set=function(d,v){return ys(this),this.i=null,d=Ks(this,d),El(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[v]),this.h+=1,this},t.get=function(d,v){return d?(d=this.V(d),0<d.length?String(d[0]):v):v};function s0(d,v,C){rn(d,v),0<C.length&&(d.i=null,d.g.set(Ks(d,v),x(C)),d.h+=C.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],v=Array.from(this.g.keys());for(var C=0;C<v.length;C++){var j=v[C];const xe=encodeURIComponent(String(j)),$e=this.V(j);for(j=0;j<$e.length;j++){var ue=xe;$e[j]!==""&&(ue+="="+encodeURIComponent(String($e[j]))),d.push(ue)}}return this.i=d.join("&")};function Ks(d,v){return v=String(v),d.j&&(v=v.toLowerCase()),v}function a0(d,v){v&&!d.j&&(ys(d),d.i=null,d.g.forEach(function(C,j){var ue=j.toLowerCase();j!=ue&&(rn(this,j),s0(this,ue,C))},d)),d.j=v}function $u(d,v){const C=new _n;if(o.Image){const j=new Image;j.onload=m(Li,C,"TestLoadImage: loaded",!0,v,j),j.onerror=m(Li,C,"TestLoadImage: error",!1,v,j),j.onabort=m(Li,C,"TestLoadImage: abort",!1,v,j),j.ontimeout=m(Li,C,"TestLoadImage: timeout",!1,v,j),o.setTimeout(function(){j.ontimeout&&j.ontimeout()},1e4),j.src=d}else v(!1)}function vt(d,v){const C=new _n,j=new AbortController,ue=setTimeout(()=>{j.abort(),Li(C,"TestPingServer: timeout",!1,v)},1e4);fetch(d,{signal:j.signal}).then(xe=>{clearTimeout(ue),xe.ok?Li(C,"TestPingServer: ok",!0,v):Li(C,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(ue),Li(C,"TestPingServer: error",!1,v)})}function Li(d,v,C,j,ue){try{ue&&(ue.onload=null,ue.onerror=null,ue.onabort=null,ue.ontimeout=null),j(C)}catch{}}function Pr(){this.g=new Wu}function _o(d,v,C){const j=C||"";try{ja(d,function(ue,xe){let $e=ue;u(ue)&&($e=vo(ue)),v.push(j+xe+"="+encodeURIComponent($e))})}catch(ue){throw v.push(j+"type="+encodeURIComponent("_badmap")),ue}}function Sl(d){this.l=d.Ub||null,this.j=d.eb||!1}y(Sl,Vs),Sl.prototype.g=function(){return new wl(this.l,this.j)},Sl.prototype.i=function(d){return function(){return d}}({});function wl(d,v){nr.call(this),this.D=d,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(wl,nr),t=wl.prototype,t.open=function(d,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=v,this.readyState=1,Eo(this)},t.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(v.body=d),(this.D||o).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Va(this)),this.readyState=0},t.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Eo(this)),this.g&&(this.readyState=3,Eo(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Gu(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function Gu(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}t.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var v=d.value?d.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!d.done}))&&(this.response=this.responseText+=v)}d.done?Va(this):Eo(this),this.readyState==3&&Gu(this)}},t.Ra=function(d){this.g&&(this.response=this.responseText=d,Va(this))},t.Qa=function(d){this.g&&(this.response=d,Va(this))},t.ga=function(){this.g&&Va(this)};function Va(d){d.readyState=4,d.l=null,d.j=null,d.v=null,Eo(d)}t.setRequestHeader=function(d,v){this.u.append(d,v)},t.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],v=this.h.entries();for(var C=v.next();!C.done;)C=C.value,d.push(C[0]+": "+C[1]),C=v.next();return d.join(`\r
`)};function Eo(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(wl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function Ku(d){let v="";return W(d,function(C,j){v+=j,v+=":",v+=C,v+=`\r
`}),v}function Ec(d,v,C){e:{for(j in C){var j=!1;break e}j=!0}j||(C=Ku(C),typeof d=="string"?C!=null&&encodeURIComponent(String(C)):Ot(d,v,C))}function gr(d){nr.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(gr,nr);var o0=/^https?$/i,l0=["POST","PUT"];t=gr.prototype,t.Ha=function(d){this.J=d},t.ea=function(d,v,C,j){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);v=v?v.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Q.g(),this.v=this.o?_l(this.o):_l(Q),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(v,String(d),!0),this.B=!1}catch(xe){wn(this,xe);return}if(d=C||"",C=new Map(this.headers),j)if(Object.getPrototypeOf(j)===Object.prototype)for(var ue in j)C.set(ue,j[ue]);else if(typeof j.keys=="function"&&typeof j.get=="function")for(const xe of j.keys())C.set(xe,j.get(xe));else throw Error("Unknown input type for opt_headers: "+String(j));j=Array.from(C.keys()).find(xe=>xe.toLowerCase()=="content-type"),ue=o.FormData&&d instanceof o.FormData,!(0<=Array.prototype.indexOf.call(l0,v,void 0))||j||ue||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[xe,$e]of C)this.g.setRequestHeader(xe,$e);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Si(this),this.u=!0,this.g.send(d),this.u=!1}catch(xe){wn(this,xe)}};function wn(d,v){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=v,d.m=5,nn(d),Rn(d)}function nn(d){d.A||(d.A=!0,Br(d,"complete"),Br(d,"error"))}t.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,Br(this,"complete"),Br(this,"abort"),Rn(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Rn(this,!0)),gr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Gn(this):this.bb())},t.bb=function(){Gn(this)};function Gn(d){if(d.h&&typeof a<"u"&&(!d.v[1]||_s(d)!=4||d.Z()!=2)){if(d.u&&_s(d)==4)_i(d.Ea,0,d);else if(Br(d,"readystatechange"),_s(d)==4){d.h=!1;try{const $e=d.Z();e:switch($e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var C;if(!(C=v)){var j;if(j=$e===0){var ue=String(d.D).match(da)[1]||null;!ue&&o.self&&o.self.location&&(ue=o.self.location.protocol.slice(0,-1)),j=!o0.test(ue?ue.toLowerCase():"")}C=j}if(C)Br(d,"complete"),Br(d,"success");else{d.m=6;try{var xe=2<_s(d)?d.g.statusText:""}catch{xe=""}d.l=xe+" ["+d.Z()+"]",nn(d)}}finally{Rn(d)}}}}function Rn(d,v){if(d.g){Si(d);const C=d.g,j=d.v[0]?()=>{}:null;d.g=null,d.v=null,v||Br(d,"ready");try{C.onreadystatechange=j}catch{}}}function Si(d){d.I&&(o.clearTimeout(d.I),d.I=null)}t.isActive=function(){return!!this.g};function _s(d){return d.g?d.g.readyState:0}t.Z=function(){try{return 2<_s(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(d){if(this.g){var v=this.g.responseText;return d&&v.indexOf(d)==0&&(v=v.substring(d.length)),Pa(v)}};function Tl(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function Wt(d){const v={};d=(d.g&&2<=_s(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let j=0;j<d.length;j++){if(k(d[j]))continue;var C=R(d[j]);const ue=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const xe=v[ue]||[];v[ue]=xe,xe.push(C)}T(v,function(j){return j.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Es(d,v,C){return C&&C.internalChannelParams&&C.internalChannelParams[d]||v}function Jt(d){this.Aa=0,this.i=[],this.j=new _n,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Es("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Es("baseRetryDelayMs",5e3,d),this.cb=Es("retryDelaySeedMs",1e4,d),this.Wa=Es("forwardChannelMaxRetries",2,d),this.wa=Es("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new ms(d&&d.concurrentRequestLimit),this.Da=new Pr,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Jt.prototype,t.la=8,t.G=1,t.connect=function(d,v,C,j){un(0),this.W=d,this.H=v||{},C&&j!==void 0&&(this.H.OSID=C,this.H.OAID=j),this.F=this.X,this.I=Xu(this,null,this.W),Dn(this)};function Kn(d){if(Al(d),d.G==3){var v=d.U++,C=Sn(d.I);if(Ot(C,"SID",d.K),Ot(C,"RID",v),Ot(C,"TYPE","terminate"),To(d,C),v=new me(d,d.j,v),v.L=2,v.v=La(Sn(C)),C=!1,o.navigator&&o.navigator.sendBeacon)try{C=o.navigator.sendBeacon(v.v.toString(),"")}catch{}!C&&o.Image&&(new Image().src=v.v,C=!0),C||(v.g=Tc(v.j,null),v.g.ea(v.v)),v.F=Date.now(),qe(v)}ws(d)}function So(d){d.g&&(Sc(d),d.g.cancel(),d.g=null)}function Al(d){So(d),d.u&&(o.clearTimeout(d.u),d.u=null),wc(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&o.clearTimeout(d.s),d.s=null)}function Dn(d){if(!jr(d.h)&&!d.s){d.s=!0;var v=d.Ga;Ie||be(),Ce||(Ie(),Ce=!0),se.add(v,d),d.B=0}}function wo(d,v){return xs(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=v.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=Hs(g(d.Ga,d,v),d0(d,d.B)),d.B++,!0)}t.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const ue=new me(this,this.j,d);let xe=this.o;if(this.S&&(xe?(xe=F(xe),I(xe,this.S)):xe=this.S),this.m!==null||this.O||(ue.H=xe,xe=null),this.P)e:{for(var v=0,C=0;C<this.i.length;C++){t:{var j=this.i[C];if("__data__"in j.map&&(j=j.map.__data__,typeof j=="string")){j=j.length;break t}j=void 0}if(j===void 0)break;if(v+=j,4096<v){v=C;break e}if(v===4096||C===this.i.length-1){v=C+1;break e}}v=1e3}else v=1e3;v=Yu(this,ue,v),C=Sn(this.I),Ot(C,"RID",d),Ot(C,"CVER",22),this.D&&Ot(C,"X-HTTP-Session-Id",this.D),To(this,C),xe&&(this.O?v="headers="+encodeURIComponent(String(Ku(xe)))+"&"+v:this.m&&Ec(C,this.m,xe)),$s(this.h,ue),this.Ua&&Ot(C,"TYPE","init"),this.P?(Ot(C,"$req",v),Ot(C,"SID","null"),ue.T=!0,we(ue,C,null)):we(ue,C,v),this.G=2}}else this.G==3&&(d?ha(this,d):this.i.length==0||jr(this.h)||ha(this))};function ha(d,v){var C;v?C=v.l:C=d.U++;const j=Sn(d.I);Ot(j,"SID",d.K),Ot(j,"RID",C),Ot(j,"AID",d.T),To(d,j),d.m&&d.o&&Ec(j,d.m,d.o),C=new me(d,d.j,C,d.B+1),d.m===null&&(C.H=d.o),v&&(d.i=v.D.concat(d.i)),v=Yu(d,C,1e3),C.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),$s(d.h,C),we(C,j,v)}function To(d,v){d.H&&W(d.H,function(C,j){Ot(v,j,C)}),d.l&&ja({},function(C,j){Ot(v,j,C)})}function Yu(d,v,C){C=Math.min(d.i.length,C);var j=d.l?g(d.l.Na,d.l,d):null;e:{var ue=d.i;let xe=-1;for(;;){const $e=["count="+C];xe==-1?0<C?(xe=ue[0].g,$e.push("ofs="+xe)):xe=0:$e.push("ofs="+xe);let ar=!0;for(let dn=0;dn<C;dn++){let Ht=ue[dn].g;const Pn=ue[dn].map;if(Ht-=xe,0>Ht)xe=Math.max(0,ue[dn].g-100),ar=!1;else try{_o(Pn,$e,"req"+Ht+"_")}catch{j&&j(Pn)}}if(ar){j=$e.join("&");break e}}}return d=d.i.splice(0,C),v.D=d,j}function c0(d){if(!d.g&&!d.u){d.Y=1;var v=d.Fa;Ie||be(),Ce||(Ie(),Ce=!0),se.add(v,d),d.v=0}}function za(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=Hs(g(d.Fa,d),d0(d,d.v)),d.v++,!0)}t.Fa=function(){if(this.u=null,Qi(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=Hs(g(this.ab,this),d)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,un(10),So(this),Qi(this))};function Sc(d){d.A!=null&&(o.clearTimeout(d.A),d.A=null)}function Qi(d){d.g=new me(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var v=Sn(d.qa);Ot(v,"RID","rpc"),Ot(v,"SID",d.K),Ot(v,"AID",d.T),Ot(v,"CI",d.F?"0":"1"),!d.F&&d.ja&&Ot(v,"TO",d.ja),Ot(v,"TYPE","xmlhttp"),To(d,v),d.m&&d.o&&Ec(v,d.m,d.o),d.L&&(d.g.I=d.L);var C=d.g;d=d.ia,C.L=1,C.v=La(Sn(v)),C.m=null,C.P=!0,Ue(C,d)}t.Za=function(){this.C!=null&&(this.C=null,So(this),za(this),un(19))};function wc(d){d.C!=null&&(o.clearTimeout(d.C),d.C=null)}function u0(d,v){var C=null;if(d.g==v){wc(d),Sc(d),d.g=null;var j=2}else if(st(d.h,v))C=v.D,Vt(d.h,v),j=1;else return;if(d.G!=0){if(v.o)if(j==1){C=v.m?v.m.length:0,v=Date.now()-v.F;var ue=d.B;j=Ws(),Br(j,new Ma(j,C)),Dn(d)}else c0(d);else if(ue=v.s,ue==3||ue==0&&0<v.X||!(j==1&&wo(d,v)||j==2&&za(d)))switch(C&&0<C.length&&(v=d.h,v.i=v.i.concat(C)),ue){case 1:Ss(d,5);break;case 4:Ss(d,10);break;case 3:Ss(d,6);break;default:Ss(d,2)}}}function d0(d,v){let C=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(C*=2),C*v}function Ss(d,v){if(d.j.info("Error code "+v),v==2){var C=g(d.fb,d),j=d.Xa;const ue=!j;j=new Gs(j||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||fa(j,"https"),La(j),ue?$u(j.toString(),C):vt(j.toString(),C)}else un(2);d.G=0,d.l&&d.l.sa(v),ws(d),Al(d)}t.fb=function(d){d?(this.j.info("Successfully pinged google.com"),un(2)):(this.j.info("Failed to ping google.com"),un(1))};function ws(d){if(d.G=0,d.ka=[],d.l){const v=Mi(d.h);(v.length!=0||d.i.length!=0)&&(S(d.ka,v),S(d.ka,d.i),d.h.i.length=0,x(d.i),d.i.length=0),d.l.ra()}}function Xu(d,v,C){var j=C instanceof Gs?Sn(C):new Gs(C);if(j.g!="")v&&(j.g=v+"."+j.g),tn(j,j.s);else{var ue=o.location;j=ue.protocol,v=v?v+"."+ue.hostname:ue.hostname,ue=+ue.port;var xe=new Gs(null);j&&fa(xe,j),v&&(xe.g=v),ue&&tn(xe,ue),C&&(xe.l=C),j=xe}return C=d.D,v=d.ya,C&&v&&Ot(j,C,v),Ot(j,"VER",d.la),To(d,j),j}function Tc(d,v,C){if(v&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=d.Ca&&!d.pa?new gr(new Sl({eb:C})):new gr(d.pa),v.Ha(d.J),v}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function f0(){}t=f0.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function sr(){}sr.prototype.g=function(d,v){return new yr(d,v)};function yr(d,v){nr.call(this),this.g=new Jt(v),this.l=d,this.h=v&&v.messageUrlParams||null,d=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(d?d["X-WebChannel-Content-Type"]=v.messageContentType:d={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(d?d["X-WebChannel-Client-Profile"]=v.va:d={"X-WebChannel-Client-Profile":v.va}),this.g.S=d,(d=v&&v.Sb)&&!k(d)&&(this.g.m=d),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!k(v)&&(this.g.D=v,d=this.h,d!==null&&v in d&&(d=this.h,v in d&&delete d[v])),this.j=new pa(this)}y(yr,nr),yr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},yr.prototype.close=function(){Kn(this.g)},yr.prototype.o=function(d){var v=this.g;if(typeof d=="string"){var C={};C.__data__=d,d=C}else this.u&&(C={},C.__data__=vo(d),d=C);v.i.push(new pr(v.Ya++,d)),v.G==3&&Dn(v)},yr.prototype.N=function(){this.g.l=null,delete this.j,Kn(this.g),delete this.g,yr.aa.N.call(this)};function Cl(d){hr.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var v=d.__sm__;if(v){e:{for(const C in v){d=C;break e}d=void 0}(this.i=d)&&(d=this.i,v=v!==null&&d in v?v[d]:void 0),this.data=v}else this.data=d}y(Cl,hr);function Ji(){Di.call(this),this.status=1}y(Ji,Di);function pa(d){this.g=d}y(pa,f0),pa.prototype.ua=function(){Br(this.g,"a")},pa.prototype.ta=function(d){Br(this.g,new Cl(d))},pa.prototype.sa=function(d){Br(this.g,new Ji)},pa.prototype.ra=function(){Br(this.g,"b")},sr.prototype.createWebChannel=sr.prototype.g,yr.prototype.send=yr.prototype.o,yr.prototype.open=yr.prototype.m,yr.prototype.close=yr.prototype.close,tk=function(){return new sr},ek=function(){return Ws()},ZC=gs,Ax={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},U.NO_ERROR=0,U.TIMEOUT=8,U.HTTP_ERROR=6,mh=U,q.COMPLETE="complete",JC=q,zs.EventType=ce,ce.OPEN="a",ce.CLOSE="b",ce.ERROR="c",ce.MESSAGE="d",nr.prototype.listen=nr.prototype.K,Ed=zs,gr.prototype.listenOnce=gr.prototype.L,gr.prototype.getLastError=gr.prototype.Ka,gr.prototype.getLastErrorCode=gr.prototype.Ba,gr.prototype.getStatus=gr.prototype.Z,gr.prototype.getResponseJson=gr.prototype.Oa,gr.prototype.getResponseText=gr.prototype.oa,gr.prototype.send=gr.prototype.ea,gr.prototype.setWithCredentials=gr.prototype.Ha,QC=gr}).apply(typeof q0<"u"?q0:typeof self<"u"?self:typeof window<"u"?window:{});const xE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ci.UNAUTHENTICATED=new ci(null),ci.GOOGLE_CREDENTIALS=new ci("google-credentials-uid"),ci.FIRST_PARTY=new ci("first-party-uid"),ci.MOCK_USER=new ci("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ju="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nc=new Tv("@firebase/firestore");function fd(){return nc.logLevel}function Ze(t,...e){if(nc.logLevel<=zt.DEBUG){const r=e.map(kv);nc.debug(`Firestore (${ju}): ${t}`,...r)}}function lo(t,...e){if(nc.logLevel<=zt.ERROR){const r=e.map(kv);nc.error(`Firestore (${ju}): ${t}`,...r)}}function Su(t,...e){if(nc.logLevel<=zt.WARN){const r=e.map(kv);nc.warn(`Firestore (${ju}): ${t}`,...r)}}function kv(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mt(t="Unexpected state"){const e=`FIRESTORE (${ju}) INTERNAL ASSERTION FAILED: `+t;throw lo(e),new Error(e)}function dr(t,e){t||mt()}function _t(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ot extends xo{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class S7{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(ci.UNAUTHENTICATED))}shutdown(){}}class w7{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class T7{constructor(e){this.t=e,this.currentUser=ci.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){dr(this.o===void 0);let n=this.i;const i=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let s=new nl;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new nl,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{Ze("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Ze("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new nl)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Ze("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(dr(typeof n.accessToken=="string"),new rk(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return dr(e===null||typeof e=="string"),new ci(e)}}class A7{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=ci.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class C7{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new A7(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(ci.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class k7{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class F7{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){dr(this.o===void 0);const n=s=>{s.error!=null&&Ze("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,Ze("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{Ze("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Ze("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(dr(typeof r.token=="string"),this.R=r.token,new k7(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b7(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=b7(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=e.charAt(i[s]%e.length))}return n}}function tr(t,e){return t<e?-1:t>e?1:0}function wu(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new ot(Oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new ot(Oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new ot(Oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ot(Oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return In.fromMillis(Date.now())}static fromDate(e){return In.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new In(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?tr(this.nanoseconds,e.nanoseconds):tr(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new yt(e)}static min(){return new yt(new In(0,0))}static max(){return new yt(new In(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cf{constructor(e,r,n){r===void 0?r=0:r>e.length&&mt(),n===void 0?n=e.length-r:n>e.length-r&&mt(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Cf.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Cf?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const s=e.get(i),a=r.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class qr extends Cf{construct(e,r,n){return new qr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new ot(Oe.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new qr(r)}static emptyPath(){return new qr([])}}const I7=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Zn extends Cf{construct(e,r,n){return new Zn(e,r,n)}static isValidIdentifier(e){return I7.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Zn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Zn(["__name__"])}static fromServerFormat(e){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new ot(Oe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new ot(Oe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ot(Oe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new ot(Oe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Zn(r)}static emptyPath(){return new Zn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{constructor(e){this.path=e}static fromPath(e){return new ct(qr.fromString(e))}static fromName(e){return new ct(qr.fromString(e).popFirst(5))}static empty(){return new ct(qr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&qr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return qr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ct(new qr(e.slice()))}}function N7(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=yt.fromTimestamp(n===1e9?new In(r+1,0):new In(r,n));return new dl(i,ct.empty(),e)}function R7(t){return new dl(t.readTime,t.key,-1)}class dl{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new dl(yt.min(),ct.empty(),-1)}static max(){return new dl(yt.max(),ct.empty(),-1)}}function D7(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=ct.comparator(t.documentKey,e.documentKey),r!==0?r:tr(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P7="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class O7{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qf(t){if(t.code!==Oe.FAILED_PRECONDITION||t.message!==P7)throw t;Ze("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&mt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Re((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Re?r:Re.resolve(r)}catch(r){return Re.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Re.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Re.reject(r)}static resolve(e){return new Re((r,n)=>{r(e)})}static reject(e){return new Re((r,n)=>{n(e)})}static waitFor(e){return new Re((r,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},l=>n(l))}),a=!0,s===i&&r()})}static or(e){let r=Re.resolve(!1);for(const n of e)r=r.next(i=>i?Re.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(e,r){return new Re((n,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const u=l;r(e[u]).next(f=>{a[u]=f,++o,o===s&&n(a)},f=>i(f))}})}static doWhile(e,r){return new Re((n,i)=>{const s=()=>{e()===!0?r().next(()=>{s()},i):n()};s()})}}function M7(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Qf(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Fv.oe=-1;function Qp(t){return t==null}function dp(t){return t===0&&1/t==-1/0}function B7(t){return typeof t=="number"&&Number.isInteger(t)&&!dp(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vE(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Lu(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function ik(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr{constructor(e,r){this.comparator=e,this.root=r||qn.EMPTY}insert(e,r){return new Gr(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,qn.BLACK,null,null))}remove(e){return new Gr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,qn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Q0(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Q0(this.root,e,this.comparator,!1)}getReverseIterator(){return new Q0(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Q0(this.root,e,this.comparator,!0)}}class Q0{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class qn{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n??qn.RED,this.left=i??qn.EMPTY,this.right=s??qn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,s){return new qn(e??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return qn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return qn.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,qn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,qn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw mt();const e=this.left.check();if(e!==this.right.check())throw mt();return e+(this.isRed()?0:1)}}qn.EMPTY=null,qn.RED=!0,qn.BLACK=!1;qn.EMPTY=new class{constructor(){this.size=0}get key(){throw mt()}get value(){throw mt()}get color(){throw mt()}get left(){throw mt()}get right(){throw mt()}copy(e,r,n,i,s){return this}insert(e,r,n){return new qn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e){this.comparator=e,this.data=new Gr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new yE(this.data.getIterator())}getIteratorFrom(e){return new yE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof ti)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new ti(this.comparator);return r.data=e,r}}class yE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class na{constructor(e){this.fields=e,e.sort(Zn.comparator)}static empty(){return new na([])}unionWith(e){let r=new ti(Zn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new na(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return wu(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new sk("Invalid base64 string: "+s):s}}(e);return new ni(r)}static fromUint8Array(e){const r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new ni(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return tr(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ni.EMPTY_BYTE_STRING=new ni("");const j7=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function fl(t){if(dr(!!t),typeof t=="string"){let e=0;const r=j7.exec(t);if(dr(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:an(t.seconds),nanos:an(t.nanos)}}function an(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ic(t){return typeof t=="string"?ni.fromBase64String(t):ni.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bv(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function Iv(t){const e=t.mapValue.fields.__previous_value__;return bv(e)?Iv(e):e}function kf(t){const e=fl(t.mapValue.fields.__local_write_time__.timestampValue);return new In(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L7{constructor(e,r,n,i,s,a,o,l,u){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=u}}class Ff{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new Ff("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Ff&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J0={mapValue:{}};function sc(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?bv(t)?4:V7(t)?9007199254740991:U7(t)?10:11:mt()}function Ia(t,e){if(t===e)return!0;const r=sc(t);if(r!==sc(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return kf(t).isEqual(kf(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=fl(i.timestampValue),o=fl(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return ic(i.bytesValue).isEqual(ic(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return an(i.geoPointValue.latitude)===an(s.geoPointValue.latitude)&&an(i.geoPointValue.longitude)===an(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return an(i.integerValue)===an(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=an(i.doubleValue),o=an(s.doubleValue);return a===o?dp(a)===dp(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return wu(t.arrayValue.values||[],e.arrayValue.values||[],Ia);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(vE(a)!==vE(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!Ia(a[l],o[l])))return!1;return!0}(t,e);default:return mt()}}function bf(t,e){return(t.values||[]).find(r=>Ia(r,e))!==void 0}function Tu(t,e){if(t===e)return 0;const r=sc(t),n=sc(e);if(r!==n)return tr(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return tr(t.booleanValue,e.booleanValue);case 2:return function(s,a){const o=an(s.integerValue||s.doubleValue),l=an(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return _E(t.timestampValue,e.timestampValue);case 4:return _E(kf(t),kf(e));case 5:return tr(t.stringValue,e.stringValue);case 6:return function(s,a){const o=ic(s),l=ic(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let u=0;u<o.length&&u<l.length;u++){const f=tr(o[u],l[u]);if(f!==0)return f}return tr(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const o=tr(an(s.latitude),an(a.latitude));return o!==0?o:tr(an(s.longitude),an(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return EE(t.arrayValue,e.arrayValue);case 10:return function(s,a){var o,l,u,f;const p=s.fields||{},g=a.fields||{},m=(o=p.value)===null||o===void 0?void 0:o.arrayValue,y=(l=g.value)===null||l===void 0?void 0:l.arrayValue,x=tr(((u=m==null?void 0:m.values)===null||u===void 0?void 0:u.length)||0,((f=y==null?void 0:y.values)===null||f===void 0?void 0:f.length)||0);return x!==0?x:EE(m,y)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===J0.mapValue&&a===J0.mapValue)return 0;if(s===J0.mapValue)return 1;if(a===J0.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),u=a.fields||{},f=Object.keys(u);l.sort(),f.sort();for(let p=0;p<l.length&&p<f.length;++p){const g=tr(l[p],f[p]);if(g!==0)return g;const m=Tu(o[l[p]],u[f[p]]);if(m!==0)return m}return tr(l.length,f.length)}(t.mapValue,e.mapValue);default:throw mt()}}function _E(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return tr(t,e);const r=fl(t),n=fl(e),i=tr(r.seconds,n.seconds);return i!==0?i:tr(r.nanos,n.nanos)}function EE(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const s=Tu(r[i],n[i]);if(s)return s}return tr(r.length,n.length)}function Au(t){return Cx(t)}function Cx(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=fl(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return ic(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return ct.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=Cx(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${Cx(r.fields[a])}`;return i+"}"}(t.mapValue):mt()}function kx(t){return!!t&&"integerValue"in t}function Nv(t){return!!t&&"arrayValue"in t}function SE(t){return!!t&&"nullValue"in t}function wE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function xh(t){return!!t&&"mapValue"in t}function U7(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function zd(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Lu(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=zd(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=zd(t.arrayValue.values[r]);return e}return Object.assign({},t)}function V7(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(e){this.value=e}static empty(){return new Ds({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!xh(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=zd(r)}setAll(e){let r=Zn.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=zd(a):i.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(e){const r=this.field(e.popLast());xh(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Ia(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];xh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Lu(r,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new Ds(zd(this.value))}}function ak(t){const e=[];return Lu(t.fields,(r,n)=>{const i=new Zn([r]);if(xh(n)){const s=ak(n.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new na(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e,r,n,i,s,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new hi(e,0,yt.min(),yt.min(),yt.min(),Ds.empty(),0)}static newFoundDocument(e,r,n,i){return new hi(e,1,r,yt.min(),n,i,0)}static newNoDocument(e,r){return new hi(e,2,r,yt.min(),yt.min(),Ds.empty(),0)}static newUnknownDocument(e,r){return new hi(e,3,r,yt.min(),yt.min(),Ds.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(yt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ds.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ds.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=yt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof hi&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new hi(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fp{constructor(e,r){this.position=e,this.inclusive=r}}function TE(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?n=ct.comparator(ct.fromName(a.referenceValue),r.key):n=Tu(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function AE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Ia(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(e,r="asc"){this.field=e,this.dir=r}}function z7(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{}class Fn extends ok{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new H7(e,r,n):r==="array-contains"?new K7(e,n):r==="in"?new Y7(e,n):r==="not-in"?new X7(e,n):r==="array-contains-any"?new q7(e,n):new Fn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new $7(e,n):new G7(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(Tu(r,this.value)):r!==null&&sc(this.value)===sc(r)&&this.matchesComparison(Tu(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return mt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Na extends ok{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new Na(e,r)}matches(e){return lk(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function lk(t){return t.op==="and"}function ck(t){return W7(t)&&lk(t)}function W7(t){for(const e of t.filters)if(e instanceof Na)return!1;return!0}function Fx(t){if(t instanceof Fn)return t.field.canonicalString()+t.op.toString()+Au(t.value);if(ck(t))return t.filters.map(e=>Fx(e)).join(",");{const e=t.filters.map(r=>Fx(r)).join(",");return`${t.op}(${e})`}}function uk(t,e){return t instanceof Fn?function(n,i){return i instanceof Fn&&n.op===i.op&&n.field.isEqual(i.field)&&Ia(n.value,i.value)}(t,e):t instanceof Na?function(n,i){return i instanceof Na&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&uk(a,i.filters[o]),!0):!1}(t,e):void mt()}function dk(t){return t instanceof Fn?function(r){return`${r.field.canonicalString()} ${r.op} ${Au(r.value)}`}(t):t instanceof Na?function(r){return r.op.toString()+" {"+r.getFilters().map(dk).join(" ,")+"}"}(t):"Filter"}class H7 extends Fn{constructor(e,r,n){super(e,r,n),this.key=ct.fromName(n.referenceValue)}matches(e){const r=ct.comparator(e.key,this.key);return this.matchesComparison(r)}}class $7 extends Fn{constructor(e,r){super(e,"in",r),this.keys=fk("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class G7 extends Fn{constructor(e,r){super(e,"not-in",r),this.keys=fk("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function fk(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>ct.fromName(n.referenceValue))}class K7 extends Fn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Nv(r)&&bf(r.arrayValue,this.value)}}class Y7 extends Fn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&bf(this.value.arrayValue,r)}}class X7 extends Fn{constructor(e,r){super(e,"not-in",r)}matches(e){if(bf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!bf(this.value.arrayValue,r)}}class q7 extends Fn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Nv(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>bf(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q7{constructor(e,r=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ue=null}}function CE(t,e=null,r=[],n=[],i=null,s=null,a=null){return new Q7(t,e,r,n,i,s,a)}function Rv(t){const e=_t(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Fx(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),Qp(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Au(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Au(n)).join(",")),e.ue=r}return e.ue}function Dv(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!z7(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!uk(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!AE(t.startAt,e.startAt)&&AE(t.endAt,e.endAt)}function bx(t){return ct.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jp{constructor(e,r=null,n=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function J7(t,e,r,n,i,s,a,o){return new Jp(t,e,r,n,i,s,a,o)}function Zp(t){return new Jp(t)}function kE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Z7(t){return t.collectionGroup!==null}function Wd(t){const e=_t(t);if(e.ce===null){e.ce=[];const r=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new ti(Zn.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(o=o.add(u.field))})}),o})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new hp(s,n))}),r.has(Zn.keyField().canonicalString())||e.ce.push(new hp(Zn.keyField(),n))}return e.ce}function Ca(t){const e=_t(t);return e.le||(e.le=eU(e,Wd(t))),e.le}function eU(t,e){if(t.limitType==="F")return CE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new hp(i.field,s)});const r=t.endAt?new fp(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new fp(t.startAt.position,t.startAt.inclusive):null;return CE(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Ix(t,e,r){return new Jp(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function eg(t,e){return Dv(Ca(t),Ca(e))&&t.limitType===e.limitType}function hk(t){return`${Rv(Ca(t))}|lt:${t.limitType}`}function Pc(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>dk(i)).join(", ")}]`),Qp(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>Au(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>Au(i)).join(",")),`Target(${n})`}(Ca(t))}; limitType=${t.limitType})`}function tg(t,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):ct.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,i){for(const s of Wd(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,o,l){const u=TE(a,o,l);return a.inclusive?u<=0:u<0}(n.startAt,Wd(n),i)||n.endAt&&!function(a,o,l){const u=TE(a,o,l);return a.inclusive?u>=0:u>0}(n.endAt,Wd(n),i))}(t,e)}function tU(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function pk(t){return(e,r)=>{let n=!1;for(const i of Wd(t)){const s=rU(i,e,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function rU(t,e,r){const n=t.field.isKeyField()?ct.comparator(e.key,r.key):function(s,a,o){const l=a.data.field(s),u=o.data.field(s);return l!==null&&u!==null?Tu(l,u):mt()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return mt()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uu{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Lu(this.inner,(r,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return ik(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nU=new Gr(ct.comparator);function co(){return nU}const gk=new Gr(ct.comparator);function Sd(...t){let e=gk;for(const r of t)e=e.insert(r.key,r);return e}function mk(t){let e=gk;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Ml(){return Hd()}function xk(){return Hd()}function Hd(){return new Uu(t=>t.toString(),(t,e)=>t.isEqual(e))}const iU=new Gr(ct.comparator),sU=new ti(ct.comparator);function Lt(...t){let e=sU;for(const r of t)e=e.add(r);return e}const aU=new ti(tr);function oU(){return aU}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:dp(e)?"-0":e}}function vk(t){return{integerValue:""+t}}function lU(t,e){return B7(e)?vk(e):Pv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg{constructor(){this._=void 0}}function cU(t,e,r){return t instanceof pp?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&bv(s)&&(s=Iv(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(r,e):t instanceof If?_k(t,e):t instanceof Nf?Ek(t,e):function(i,s){const a=yk(i,s),o=FE(a)+FE(i.Pe);return kx(a)&&kx(i.Pe)?vk(o):Pv(i.serializer,o)}(t,e)}function uU(t,e,r){return t instanceof If?_k(t,e):t instanceof Nf?Ek(t,e):r}function yk(t,e){return t instanceof gp?function(n){return kx(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class pp extends rg{}class If extends rg{constructor(e){super(),this.elements=e}}function _k(t,e){const r=Sk(e);for(const n of t.elements)r.some(i=>Ia(i,n))||r.push(n);return{arrayValue:{values:r}}}class Nf extends rg{constructor(e){super(),this.elements=e}}function Ek(t,e){let r=Sk(e);for(const n of t.elements)r=r.filter(i=>!Ia(i,n));return{arrayValue:{values:r}}}class gp extends rg{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function FE(t){return an(t.integerValue||t.doubleValue)}function Sk(t){return Nv(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function dU(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof If&&i instanceof If||n instanceof Nf&&i instanceof Nf?wu(n.elements,i.elements,Ia):n instanceof gp&&i instanceof gp?Ia(n.Pe,i.Pe):n instanceof pp&&i instanceof pp}(t.transform,e.transform)}class fU{constructor(e,r){this.version=e,this.transformResults=r}}class to{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new to}static exists(e){return new to(void 0,e)}static updateTime(e){return new to(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function vh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ng{}function wk(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ak(t.key,to.none()):new Jf(t.key,t.data,to.none());{const r=t.data,n=Ds.empty();let i=new ti(Zn.comparator);for(let s of e.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new gc(t.key,n,new na(i.toArray()),to.none())}}function hU(t,e,r){t instanceof Jf?function(i,s,a){const o=i.value.clone(),l=IE(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof gc?function(i,s,a){if(!vh(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=IE(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(Tk(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function $d(t,e,r,n){return t instanceof Jf?function(s,a,o,l){if(!vh(s.precondition,a))return o;const u=s.value.clone(),f=NE(s.fieldTransforms,l,a);return u.setAll(f),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null}(t,e,r,n):t instanceof gc?function(s,a,o,l){if(!vh(s.precondition,a))return o;const u=NE(s.fieldTransforms,l,a),f=a.data;return f.setAll(Tk(s)),f.setAll(u),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(t,e,r,n):function(s,a,o){return vh(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function pU(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),s=yk(n.transform,i||null);s!=null&&(r===null&&(r=Ds.empty()),r.set(n.field,s))}return r||null}function bE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&wu(n,i,(s,a)=>dU(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Jf extends ng{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class gc extends ng{constructor(e,r,n,i,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Tk(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function IE(t,e,r){const n=new Map;dr(t.length===r.length);for(let i=0;i<r.length;i++){const s=t[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,uU(a,o,r[i]))}return n}function NE(t,e,r){const n=new Map;for(const i of t){const s=i.transform,a=r.data.field(i.field);n.set(i.field,cU(s,a,e))}return n}class Ak extends ng{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class gU extends ng{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mU{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&hU(s,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=$d(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=$d(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=xk();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;const l=wk(a,o);l!==null&&n.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(yt.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Lt())}isEqual(e){return this.batchId===e.batchId&&wu(this.mutations,e.mutations,(r,n)=>bE(r,n))&&wu(this.baseMutations,e.baseMutations,(r,n)=>bE(r,n))}}class Ov{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){dr(e.mutations.length===n.length);let i=function(){return iU}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new Ov(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xU{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vU{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gn,Kt;function yU(t){switch(t){default:return mt();case Oe.CANCELLED:case Oe.UNKNOWN:case Oe.DEADLINE_EXCEEDED:case Oe.RESOURCE_EXHAUSTED:case Oe.INTERNAL:case Oe.UNAVAILABLE:case Oe.UNAUTHENTICATED:return!1;case Oe.INVALID_ARGUMENT:case Oe.NOT_FOUND:case Oe.ALREADY_EXISTS:case Oe.PERMISSION_DENIED:case Oe.FAILED_PRECONDITION:case Oe.ABORTED:case Oe.OUT_OF_RANGE:case Oe.UNIMPLEMENTED:case Oe.DATA_LOSS:return!0}}function Ck(t){if(t===void 0)return lo("GRPC error has no .code"),Oe.UNKNOWN;switch(t){case gn.OK:return Oe.OK;case gn.CANCELLED:return Oe.CANCELLED;case gn.UNKNOWN:return Oe.UNKNOWN;case gn.DEADLINE_EXCEEDED:return Oe.DEADLINE_EXCEEDED;case gn.RESOURCE_EXHAUSTED:return Oe.RESOURCE_EXHAUSTED;case gn.INTERNAL:return Oe.INTERNAL;case gn.UNAVAILABLE:return Oe.UNAVAILABLE;case gn.UNAUTHENTICATED:return Oe.UNAUTHENTICATED;case gn.INVALID_ARGUMENT:return Oe.INVALID_ARGUMENT;case gn.NOT_FOUND:return Oe.NOT_FOUND;case gn.ALREADY_EXISTS:return Oe.ALREADY_EXISTS;case gn.PERMISSION_DENIED:return Oe.PERMISSION_DENIED;case gn.FAILED_PRECONDITION:return Oe.FAILED_PRECONDITION;case gn.ABORTED:return Oe.ABORTED;case gn.OUT_OF_RANGE:return Oe.OUT_OF_RANGE;case gn.UNIMPLEMENTED:return Oe.UNIMPLEMENTED;case gn.DATA_LOSS:return Oe.DATA_LOSS;default:return mt()}}(Kt=gn||(gn={}))[Kt.OK=0]="OK",Kt[Kt.CANCELLED=1]="CANCELLED",Kt[Kt.UNKNOWN=2]="UNKNOWN",Kt[Kt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Kt[Kt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Kt[Kt.NOT_FOUND=5]="NOT_FOUND",Kt[Kt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Kt[Kt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Kt[Kt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Kt[Kt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Kt[Kt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Kt[Kt.ABORTED=10]="ABORTED",Kt[Kt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Kt[Kt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Kt[Kt.INTERNAL=13]="INTERNAL",Kt[Kt.UNAVAILABLE=14]="UNAVAILABLE",Kt[Kt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _U(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EU=new Wl([4294967295,4294967295],0);function RE(t){const e=_U().encode(t),r=new qC;return r.update(e),new Uint8Array(r.digest())}function DE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Wl([r,n],0),new Wl([i,s],0)]}class Mv{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new wd(`Invalid padding: ${r}`);if(n<0)throw new wd(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new wd(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new wd(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=Wl.fromNumber(this.Ie)}Ee(e,r,n){let i=e.add(r.multiply(Wl.fromNumber(n)));return i.compare(EU)===1&&(i=new Wl([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=RE(e),[n,i]=DE(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);if(!this.de(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new Mv(s,i,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const r=RE(e),[n,i]=DE(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);this.Ae(a)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class wd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ig{constructor(e,r,n,i,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,Zf.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new ig(yt.min(),i,new Gr(tr),co(),Lt())}}class Zf{constructor(e,r,n,i,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Zf(n,r,Lt(),Lt(),Lt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yh{constructor(e,r,n,i){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=i}}class kk{constructor(e,r){this.targetId=e,this.me=r}}class Fk{constructor(e,r,n=ni.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class PE{constructor(){this.fe=0,this.ge=ME(),this.pe=ni.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Lt(),r=Lt(),n=Lt();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:mt()}}),new Zf(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=ME()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,dr(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class SU{constructor(e){this.Le=e,this.Be=new Map,this.ke=co(),this.qe=OE(),this.Qe=new Gr(tr)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:mt()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,i)=>{this.ze(i)&&r(i)})}He(e){const r=e.targetId,n=e.me.count,i=this.Je(r);if(i){const s=i.target;if(bx(s))if(n===0){const a=new ct(s.path);this.Ue(r,a,hi.newNoDocument(a,yt.min()))}else dr(n===1);else{const a=this.Ye(r);if(a!==n){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(r);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,u)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let a,o;try{a=ic(n).toUint8Array()}catch(l){if(l instanceof sk)return Su("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new Mv(a,i,s)}catch(l){return Su(l instanceof wd?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,s,null),i++)}),i}rt(e){const r=new Map;this.Be.forEach((s,a)=>{const o=this.Je(a);if(o){if(s.current&&bx(o.target)){const l=new ct(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,hi.newNoDocument(l,e))}s.be&&(r.set(a,s.ve()),s.Ce())}});let n=Lt();this.qe.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const u=this.Je(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));const i=new ig(e,r,this.Qe,this.ke,n);return this.ke=co(),this.qe=OE(),this.Qe=new Gr(tr),i}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,r)?i.Fe(r,1):i.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new PE,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new ti(tr),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||Ze("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new PE),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function OE(){return new Gr(ct.comparator)}function ME(){return new Gr(ct.comparator)}const wU={asc:"ASCENDING",desc:"DESCENDING"},TU={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},AU={and:"AND",or:"OR"};class CU{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Nx(t,e){return t.useProto3Json||Qp(e)?e:{value:e}}function mp(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function bk(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function kU(t,e){return mp(t,e.toTimestamp())}function ka(t){return dr(!!t),yt.fromTimestamp(function(r){const n=fl(r);return new In(n.seconds,n.nanos)}(t))}function Bv(t,e){return Rx(t,e).canonicalString()}function Rx(t,e){const r=function(i){return new qr(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function Ik(t){const e=qr.fromString(t);return dr(Ok(e)),e}function Dx(t,e){return Bv(t.databaseId,e.path)}function cm(t,e){const r=Ik(e);if(r.get(1)!==t.databaseId.projectId)throw new ot(Oe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new ot(Oe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new ct(Rk(r))}function Nk(t,e){return Bv(t.databaseId,e)}function FU(t){const e=Ik(t);return e.length===4?qr.emptyPath():Rk(e)}function Px(t){return new qr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Rk(t){return dr(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function BE(t,e,r){return{name:Dx(t,e),fields:r.value.mapValue.fields}}function bU(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:mt()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,f){return u.useProto3Json?(dr(f===void 0||typeof f=="string"),ni.fromBase64String(f||"")):(dr(f===void 0||f instanceof Buffer||f instanceof Uint8Array),ni.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(u){const f=u.code===void 0?Oe.UNKNOWN:Ck(u.code);return new ot(f,u.message||"")}(a);r=new Fk(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=cm(t,n.document.name),s=ka(n.document.updateTime),a=n.document.createTime?ka(n.document.createTime):yt.min(),o=new Ds({mapValue:{fields:n.document.fields}}),l=hi.newFoundDocument(i,s,a,o),u=n.targetIds||[],f=n.removedTargetIds||[];r=new yh(u,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=cm(t,n.document),s=n.readTime?ka(n.readTime):yt.min(),a=hi.newNoDocument(i,s),o=n.removedTargetIds||[];r=new yh([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=cm(t,n.document),s=n.removedTargetIds||[];r=new yh([],s,i,null)}else{if(!("filter"in e))return mt();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new vU(i,s),o=n.targetId;r=new kk(o,a)}}return r}function IU(t,e){let r;if(e instanceof Jf)r={update:BE(t,e.key,e.value)};else if(e instanceof Ak)r={delete:Dx(t,e.key)};else if(e instanceof gc)r={update:BE(t,e.key,e.data),updateMask:LU(e.fieldMask)};else{if(!(e instanceof gU))return mt();r={verify:Dx(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof pp)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof If)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Nf)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof gp)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw mt()}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:kU(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:mt()}(t,e.precondition)),r}function NU(t,e){return t&&t.length>0?(dr(e!==void 0),t.map(r=>function(i,s){let a=i.updateTime?ka(i.updateTime):ka(s);return a.isEqual(yt.min())&&(a=ka(s)),new fU(a,i.transformResults||[])}(r,e))):[]}function RU(t,e){return{documents:[Nk(t,e.path)]}}function DU(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=Nk(t,i);const s=function(u){if(u.length!==0)return Pk(Na.create(u,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const a=function(u){if(u.length!==0)return u.map(f=>function(g){return{field:Oc(g.field),direction:MU(g.dir)}}(f))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=Nx(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:r,parent:i}}function PU(t){let e=FU(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){dr(n===1);const f=r.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];r.where&&(s=function(p){const g=Dk(p);return g instanceof Na&&ck(g)?g.getFilters():[g]}(r.where));let a=[];r.orderBy&&(a=function(p){return p.map(g=>function(y){return new hp(Mc(y.field),function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(g))}(r.orderBy));let o=null;r.limit&&(o=function(p){let g;return g=typeof p=="object"?p.value:p,Qp(g)?null:g}(r.limit));let l=null;r.startAt&&(l=function(p){const g=!!p.before,m=p.values||[];return new fp(m,g)}(r.startAt));let u=null;return r.endAt&&(u=function(p){const g=!p.before,m=p.values||[];return new fp(m,g)}(r.endAt)),J7(e,i,a,s,o,"F",l,u)}function OU(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return mt()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function Dk(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Mc(r.unaryFilter.field);return Fn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Mc(r.unaryFilter.field);return Fn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Mc(r.unaryFilter.field);return Fn.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Mc(r.unaryFilter.field);return Fn.create(a,"!=",{nullValue:"NULL_VALUE"});default:return mt()}}(t):t.fieldFilter!==void 0?function(r){return Fn.create(Mc(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return mt()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Na.create(r.compositeFilter.filters.map(n=>Dk(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return mt()}}(r.compositeFilter.op))}(t):mt()}function MU(t){return wU[t]}function BU(t){return TU[t]}function jU(t){return AU[t]}function Oc(t){return{fieldPath:t.canonicalString()}}function Mc(t){return Zn.fromServerFormat(t.fieldPath)}function Pk(t){return t instanceof Fn?function(r){if(r.op==="=="){if(wE(r.value))return{unaryFilter:{field:Oc(r.field),op:"IS_NAN"}};if(SE(r.value))return{unaryFilter:{field:Oc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(wE(r.value))return{unaryFilter:{field:Oc(r.field),op:"IS_NOT_NAN"}};if(SE(r.value))return{unaryFilter:{field:Oc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Oc(r.field),op:BU(r.op),value:r.value}}}(t):t instanceof Na?function(r){const n=r.getFilters().map(i=>Pk(i));return n.length===1?n[0]:{compositeFilter:{op:jU(r.op),filters:n}}}(t):mt()}function LU(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function Ok(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $o{constructor(e,r,n,i,s=yt.min(),a=yt.min(),o=ni.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new $o(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new $o(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new $o(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new $o(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UU{constructor(e){this.ct=e}}function VU(t){const e=PU({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Ix(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zU{constructor(){this.un=new WU}addToCollectionParentIndex(e,r){return this.un.add(r),Re.resolve()}getCollectionParents(e,r){return Re.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return Re.resolve()}deleteFieldIndex(e,r){return Re.resolve()}deleteAllFieldIndexes(e){return Re.resolve()}createTargetIndexes(e,r){return Re.resolve()}getDocumentsMatchingTarget(e,r){return Re.resolve(null)}getIndexType(e,r){return Re.resolve(0)}getFieldIndexes(e,r){return Re.resolve([])}getNextCollectionGroupToUpdate(e){return Re.resolve(null)}getMinOffset(e,r){return Re.resolve(dl.min())}getMinOffsetFromCollectionGroup(e,r){return Re.resolve(dl.min())}updateCollectionGroup(e,r,n){return Re.resolve()}updateIndexEntries(e,r){return Re.resolve()}}class WU{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new ti(qr.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new ti(qr.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Cu(0)}static kn(){return new Cu(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HU{constructor(){this.changes=new Uu(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,hi.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Re.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $U{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GU{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&$d(n.mutation,i,na.empty(),In.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Lt()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Lt()){const i=Ml();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(s=>{let a=Sd();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=Ml();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Lt()))}populateOverlays(e,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,i){let s=co();const a=Hd(),o=function(){return Hd()}();return r.forEach((l,u)=>{const f=n.get(u.key);i.has(u.key)&&(f===void 0||f.mutation instanceof gc)?s=s.insert(u.key,u):f!==void 0?(a.set(u.key,f.mutation.getFieldMask()),$d(f.mutation,u,f.mutation.getFieldMask(),In.now())):a.set(u.key,na.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,f)=>a.set(u,f)),r.forEach((u,f)=>{var p;return o.set(u,new $U(f,(p=a.get(u))!==null&&p!==void 0?p:null))}),o))}recalculateAndSaveOverlays(e,r){const n=Hd();let i=new Gr((a,o)=>a-o),s=Lt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const u=r.get(l);if(u===null)return;let f=n.get(l)||na.empty();f=o.applyToLocalView(u,f),n.set(l,f);const p=(i.get(o.batchId)||Lt()).add(l);i=i.insert(o.batchId,p)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),u=l.key,f=l.value,p=xk();f.forEach(g=>{if(!s.has(g)){const m=wk(r.get(g),n.get(g));m!==null&&p.set(g,m),s=s.add(g)}}),a.push(this.documentOverlayCache.saveOverlays(e,u,p))}return Re.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return ct.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):Z7(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-s.size):Re.resolve(Ml());let o=-1,l=s;return a.next(u=>Re.forEach(u,(f,p)=>(o<p.largestBatchId&&(o=p.largestBatchId),s.get(f)?Re.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{l=l.insert(f,g)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,Lt())).next(f=>({batchId:o,changes:mk(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new ct(r)).next(n=>{let i=Sd();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const s=r.collectionGroup;let a=Sd();return this.indexManager.getCollectionParents(e,s).next(o=>Re.forEach(o,l=>{const u=function(p,g){return new Jp(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(r,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,n,i).next(f=>{f.forEach((p,g)=>{a=a.insert(p,g)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,i))).next(a=>{s.forEach((l,u)=>{const f=u.getKey();a.get(f)===null&&(a=a.insert(f,hi.newInvalidDocument(f)))});let o=Sd();return a.forEach((l,u)=>{const f=s.get(l);f!==void 0&&$d(f.mutation,u,na.empty(),In.now()),tg(r,u)&&(o=o.insert(l,u))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KU{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return Re.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:ka(i.createTime)}}(r)),Re.resolve()}getNamedQuery(e,r){return Re.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(i){return{name:i.name,query:VU(i.bundledQuery),readTime:ka(i.readTime)}}(r)),Re.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YU{constructor(){this.overlays=new Gr(ct.comparator),this.Ir=new Map}getOverlay(e,r){return Re.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Ml();return Re.forEach(r,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,s)=>{this.ht(e,r,s)}),Re.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.Ir.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),Re.resolve()}getOverlaysForCollection(e,r,n){const i=Ml(),s=r.length+1,a=new ct(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,u=l.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>n&&i.set(l.getKey(),l)}return Re.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let s=new Gr((u,f)=>u-f);const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let f=s.get(u.largestBatchId);f===null&&(f=Ml(),s=s.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const o=Ml(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,f)=>o.set(u,f)),!(o.size()>=i)););return Re.resolve(o)}ht(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new xU(r,n));let s=this.Ir.get(r);s===void 0&&(s=Lt(),this.Ir.set(r,s)),this.Ir.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XU{constructor(){this.sessionToken=ni.EMPTY_BYTE_STRING}getSessionToken(e){return Re.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Re.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jv{constructor(){this.Tr=new ti(jn.Er),this.dr=new ti(jn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new jn(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new jn(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new ct(new qr([])),n=new jn(r,e),i=new jn(r,e+1),s=[];return this.dr.forEachInRange([n,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new ct(new qr([])),n=new jn(r,e),i=new jn(r,e+1);let s=Lt();return this.dr.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const r=new jn(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class jn{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return ct.comparator(e.key,r.key)||tr(e.wr,r.wr)}static Ar(e,r){return tr(e.wr,r.wr)||ct.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qU{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new ti(jn.Er)}checkEmpty(e){return Re.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new mU(s,r,n,i);this.mutationQueue.push(a);for(const o of i)this.br=this.br.add(new jn(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Re.resolve(a)}lookupMutationBatch(e,r){return Re.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.vr(n),s=i<0?0:i;return Re.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Re.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Re.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new jn(r,0),i=new jn(r,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,i],a=>{const o=this.Dr(a.wr);s.push(o)}),Re.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new ti(tr);return r.forEach(i=>{const s=new jn(i,0),a=new jn(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],o=>{n=n.add(o.wr)})}),Re.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let s=n;ct.isDocumentKey(s)||(s=s.child(""));const a=new jn(new ct(s),0);let o=new ti(tr);return this.br.forEachWhile(l=>{const u=l.key.path;return!!n.isPrefixOf(u)&&(u.length===i&&(o=o.add(l.wr)),!0)},a),Re.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const i=this.Dr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){dr(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return Re.forEach(r.mutations,i=>{const s=new jn(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new jn(r,0),i=this.br.firstAfterOrEqual(n);return Re.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Re.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QU{constructor(e){this.Mr=e,this.docs=function(){return new Gr(ct.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Re.resolve(n?n.document.mutableCopy():hi.newInvalidDocument(r))}getEntries(e,r){let n=co();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():hi.newInvalidDocument(i))}),Re.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let s=co();const a=r.path,o=new ct(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:u,value:{document:f}}=l.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||D7(R7(f),n)<=0||(i.has(f.key)||tg(r,f))&&(s=s.insert(f.key,f.mutableCopy()))}return Re.resolve(s)}getAllFromCollectionGroup(e,r,n,i){mt()}Or(e,r){return Re.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new JU(this)}getSize(e){return Re.resolve(this.size)}}class JU extends HU{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)}),Re.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZU{constructor(e){this.persistence=e,this.Nr=new Uu(r=>Rv(r),Dv),this.lastRemoteSnapshotVersion=yt.min(),this.highestTargetId=0,this.Lr=0,this.Br=new jv,this.targetCount=0,this.kr=Cu.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,i)=>r(i)),Re.resolve()}getLastRemoteSnapshotVersion(e){return Re.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Re.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Re.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),Re.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new Cu(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,Re.resolve()}updateTargetData(e,r){return this.Kn(r),Re.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,Re.resolve()}removeTargets(e,r,n){let i=0;const s=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),Re.waitFor(s).next(()=>i)}getTargetCount(e){return Re.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return Re.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),Re.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),Re.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),Re.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return Re.resolve(n)}containsKey(e,r){return Re.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eV{constructor(e,r){this.qr={},this.overlays={},this.Qr=new Fv(0),this.Kr=!1,this.Kr=!0,this.$r=new XU,this.referenceDelegate=e(this),this.Ur=new ZU(this),this.indexManager=new zU,this.remoteDocumentCache=function(i){return new QU(i)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new UU(r),this.Gr=new KU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new YU,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new qU(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){Ze("MemoryPersistence","Starting transaction:",e);const i=new tV(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,r){return Re.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class tV extends O7{constructor(e){super(),this.currentSequenceNumber=e}}class Lv{constructor(e){this.persistence=e,this.Jr=new jv,this.Yr=null}static Zr(e){return new Lv(e)}get Xr(){if(this.Yr)return this.Yr;throw mt()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),Re.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),Re.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),Re.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(i=>this.Xr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Re.forEach(this.Xr,n=>{const i=ct.fromPath(n);return this.ei(e,i).next(s=>{s||r.removeEntry(i,yt.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return Re.or([()=>Re.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uv{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=i}static Wi(e,r){let n=Lt(),i=Lt();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Uv(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rV{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nV{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return n9()?8:M7(vi())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,i){const s={result:null};return this.Yi(e,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new rV;return this.Xi(e,r,a).next(o=>{if(s.result=o,this.zi)return this.es(e,r,a,o.size)})}).next(()=>s.result)}es(e,r,n,i){return n.documentReadCount<this.ji?(fd()<=zt.DEBUG&&Ze("QueryEngine","SDK will not create cache indexes for query:",Pc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Re.resolve()):(fd()<=zt.DEBUG&&Ze("QueryEngine","Query:",Pc(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(fd()<=zt.DEBUG&&Ze("QueryEngine","The SDK decides to create cache indexes for query:",Pc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ca(r))):Re.resolve())}Yi(e,r){if(kE(r))return Re.resolve(null);let n=Ca(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=Ix(r,null,"F"),n=Ca(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=Lt(...s);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const u=this.ts(r,o);return this.ns(r,u,a,l.readTime)?this.Yi(e,Ix(r,null,"F")):this.rs(e,u,r,l)}))})))}Zi(e,r,n,i){return kE(r)||i.isEqual(yt.min())?Re.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const a=this.ts(r,s);return this.ns(r,a,n,i)?Re.resolve(null):(fd()<=zt.DEBUG&&Ze("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Pc(r)),this.rs(e,a,r,N7(i,-1)).next(o=>o))})}ts(e,r){let n=new ti(pk(e));return r.forEach((i,s)=>{tg(e,s)&&(n=n.add(s))}),n}ns(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,r,n){return fd()<=zt.DEBUG&&Ze("QueryEngine","Using full collection scan to execute query:",Pc(r)),this.Ji.getDocumentsMatchingQuery(e,r,dl.min(),n)}rs(e,r,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iV{constructor(e,r,n,i){this.persistence=e,this.ss=r,this.serializer=i,this.os=new Gr(tr),this._s=new Uu(s=>Rv(s),Dv),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new GU(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function sV(t,e,r,n){return new iV(t,e,r,n)}async function Mk(t,e){const r=_t(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let l=Lt();for(const u of i){a.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}for(const u of s){o.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}return r.localDocuments.getDocuments(n,l).next(u=>({hs:u,removedBatchIds:a,addedBatchIds:o}))})})}function aV(t,e){const r=_t(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,u,f){const p=u.batch,g=p.keys();let m=Re.resolve();return g.forEach(y=>{m=m.next(()=>f.getEntry(l,y)).next(x=>{const S=u.docVersions.get(y);dr(S!==null),x.version.compareTo(S)<0&&(p.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),f.addEntry(x)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(l,p))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=Lt();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(l=l.add(o.batch.mutations[u].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function Bk(t){const e=_t(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function oV(t,e){const r=_t(t),n=e.snapshotVersion;let i=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.cs.newChangeBuffer({trackRemovals:!0});i=r.os;const o=[];e.targetChanges.forEach((f,p)=>{const g=i.get(p);if(!g)return;o.push(r.Ur.removeMatchingKeys(s,f.removedDocuments,p).next(()=>r.Ur.addMatchingKeys(s,f.addedDocuments,p)));let m=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?m=m.withResumeToken(ni.EMPTY_BYTE_STRING,yt.min()).withLastLimboFreeSnapshotVersion(yt.min()):f.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(f.resumeToken,n)),i=i.insert(p,m),function(x,S,A){return x.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0}(g,m,f)&&o.push(r.Ur.updateTargetData(s,m))});let l=co(),u=Lt();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,f))}),o.push(lV(s,a,e.documentUpdates).next(f=>{l=f.Ps,u=f.Is})),!n.isEqual(yt.min())){const f=r.Ur.getLastRemoteSnapshotVersion(s).next(p=>r.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(f)}return Re.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(r.os=i,s))}function lV(t,e,r){let n=Lt(),i=Lt();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let a=co();return r.forEach((o,l)=>{const u=s.get(o);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(yt.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):Ze("LocalStore","Ignoring outdated watch update for ",o,". Current version:",u.version," Watch version:",l.version)}),{Ps:a,Is:i}})}function cV(t,e){const r=_t(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function uV(t,e){const r=_t(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Ur.getTargetData(n,e).next(s=>s?(i=s,Re.resolve(i)):r.Ur.allocateTargetId(n).next(a=>(i=new $o(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.os.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function Ox(t,e,r){const n=_t(t),i=n.os.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!Qf(a))throw a;Ze("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(i.target)}function jE(t,e,r){const n=_t(t);let i=yt.min(),s=Lt();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,u,f){const p=_t(l),g=p._s.get(f);return g!==void 0?Re.resolve(p.os.get(g)):p.Ur.getTargetData(u,f)}(n,a,Ca(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,r?i:yt.min(),r?s:Lt())).next(o=>(dV(n,tU(e),o),{documents:o,Ts:s})))}function dV(t,e,r){let n=t.us.get(e)||yt.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.us.set(e,n)}class LE{constructor(){this.activeTargetIds=oU()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class fV{constructor(){this.so=new LE,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new LE,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hV{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UE{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Ze("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Ze("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Z0=null;function um(){return Z0===null?Z0=function(){return 268435456+Math.round(2147483648*Math.random())}():Z0++,"0x"+Z0.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pV={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gV{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oi="WebChannelConnection";class mV extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(r,n,i,s,a){const o=um(),l=this.xo(r,n.toUriEncodedString());Ze("RestConnection",`Sending RPC '${r}' ${o}:`,l,i);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,s,a),this.No(r,l,u,i).then(f=>(Ze("RestConnection",`Received RPC '${r}' ${o}: `,f),f),f=>{throw Su("RestConnection",`RPC '${r}' ${o} failed with error: `,f,"url: ",l,"request:",i),f})}Lo(r,n,i,s,a,o){return this.Mo(r,n,i,s,a)}Oo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ju}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>r[a]=s),i&&i.headers.forEach((s,a)=>r[a]=s)}xo(r,n){const i=pV[r];return`${this.Do}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,i){const s=um();return new Promise((a,o)=>{const l=new QC;l.setWithCredentials(!0),l.listenOnce(JC.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case mh.NO_ERROR:const f=l.getResponseJson();Ze(oi,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),a(f);break;case mh.TIMEOUT:Ze(oi,`RPC '${e}' ${s} timed out`),o(new ot(Oe.DEADLINE_EXCEEDED,"Request time out"));break;case mh.HTTP_ERROR:const p=l.getStatus();if(Ze(oi,`RPC '${e}' ${s} failed with status:`,p,"response text:",l.getResponseText()),p>0){let g=l.getResponseJson();Array.isArray(g)&&(g=g[0]);const m=g==null?void 0:g.error;if(m&&m.status&&m.message){const y=function(S){const A=S.toLowerCase().replace(/_/g,"-");return Object.values(Oe).indexOf(A)>=0?A:Oe.UNKNOWN}(m.status);o(new ot(y,m.message))}else o(new ot(Oe.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new ot(Oe.UNAVAILABLE,"Connection failed."));break;default:mt()}}finally{Ze(oi,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);Ze(oi,`RPC '${e}' ${s} sending request:`,i),l.send(r,"POST",u,n,15)})}Bo(e,r,n){const i=um(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=tk(),o=ek(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const f=s.join("");Ze(oi,`Creating RPC '${e}' stream ${i}: ${f}`,l);const p=a.createWebChannel(f,l);let g=!1,m=!1;const y=new gV({Io:S=>{m?Ze(oi,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(g||(Ze(oi,`Opening RPC '${e}' stream ${i} transport.`),p.open(),g=!0),Ze(oi,`RPC '${e}' stream ${i} sending:`,S),p.send(S))},To:()=>p.close()}),x=(S,A,k)=>{S.listen(A,E=>{try{k(E)}catch(P){setTimeout(()=>{throw P},0)}})};return x(p,Ed.EventType.OPEN,()=>{m||(Ze(oi,`RPC '${e}' stream ${i} transport opened.`),y.yo())}),x(p,Ed.EventType.CLOSE,()=>{m||(m=!0,Ze(oi,`RPC '${e}' stream ${i} transport closed`),y.So())}),x(p,Ed.EventType.ERROR,S=>{m||(m=!0,Su(oi,`RPC '${e}' stream ${i} transport errored:`,S),y.So(new ot(Oe.UNAVAILABLE,"The operation could not be completed")))}),x(p,Ed.EventType.MESSAGE,S=>{var A;if(!m){const k=S.data[0];dr(!!k);const E=k,P=E.error||((A=E[0])===null||A===void 0?void 0:A.error);if(P){Ze(oi,`RPC '${e}' stream ${i} received error:`,P);const Y=P.status;let W=function(w){const I=gn[w];if(I!==void 0)return Ck(I)}(Y),T=P.message;W===void 0&&(W=Oe.INTERNAL,T="Unknown error status: "+Y+" with message "+P.message),m=!0,y.So(new ot(W,T)),p.close()}else Ze(oi,`RPC '${e}' stream ${i} received:`,k),y.bo(k)}}),x(o,ZC.STAT_EVENT,S=>{S.stat===Ax.PROXY?Ze(oi,`RPC '${e}' stream ${i} detected buffering proxy`):S.stat===Ax.NOPROXY&&Ze(oi,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{y.wo()},0),y}}function dm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sg(t){return new CU(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jk{constructor(e,r,n=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,r-n);i>0&&Ze("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{constructor(e,r,n,i,s,a,o,l){this.ui=e,this.Ho=n,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new jk(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===Oe.RESOURCE_EXHAUSTED?(lo(r.toString()),lo("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===Oe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Yo===r&&this.P_(n,i)},n=>{e(()=>{const i=new ot(Oe.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(i)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{n(()=>this.I_(i))}),this.stream.onMessage(i=>{n(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Ze("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(Ze("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class xV extends Lk{constructor(e,r,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=bU(this.serializer,e),n=function(s){if(!("targetChange"in s))return yt.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?yt.min():a.readTime?ka(a.readTime):yt.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=Px(this.serializer),r.addTarget=function(s,a){let o;const l=a.target;if(o=bx(l)?{documents:RU(s,l)}:{query:DU(s,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=bk(s,a.resumeToken);const u=Nx(s,a.expectedCount);u!==null&&(o.expectedCount=u)}else if(a.snapshotVersion.compareTo(yt.min())>0){o.readTime=mp(s,a.snapshotVersion.toTimestamp());const u=Nx(s,a.expectedCount);u!==null&&(o.expectedCount=u)}return o}(this.serializer,e);const n=OU(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=Px(this.serializer),r.removeTarget=e,this.a_(r)}}class vV extends Lk{constructor(e,r,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return dr(!!e.streamToken),this.lastStreamToken=e.streamToken,dr(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){dr(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=NU(e.writeResults,e.commitTime),n=ka(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=Px(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>IU(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yV extends class{}{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new ot(Oe.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,Rx(r,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ot(Oe.UNKNOWN,s.toString())})}Lo(e,r,n,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,Rx(r,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ot(Oe.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class _V{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(lo(r),this.D_=!1):Ze("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EV{constructor(e,r,n,i,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{n.enqueueAndForget(async()=>{mc(this)&&(Ze("RemoteStore","Restarting streams for network reachability change."),await async function(l){const u=_t(l);u.L_.add(4),await e0(u),u.q_.set("Unknown"),u.L_.delete(4),await ag(u)}(this))})}),this.q_=new _V(n,i)}}async function ag(t){if(mc(t))for(const e of t.B_)await e(!0)}async function e0(t){for(const e of t.B_)await e(!1)}function Uk(t,e){const r=_t(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),Hv(r)?Wv(r):Vu(r).r_()&&zv(r,e))}function Vv(t,e){const r=_t(t),n=Vu(r);r.N_.delete(e),n.r_()&&Vk(r,e),r.N_.size===0&&(n.r_()?n.o_():mc(r)&&r.q_.set("Unknown"))}function zv(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(yt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Vu(t).A_(e)}function Vk(t,e){t.Q_.xe(e),Vu(t).R_(e)}function Wv(t){t.Q_=new SU({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Vu(t).start(),t.q_.v_()}function Hv(t){return mc(t)&&!Vu(t).n_()&&t.N_.size>0}function mc(t){return _t(t).L_.size===0}function zk(t){t.Q_=void 0}async function SV(t){t.q_.set("Online")}async function wV(t){t.N_.forEach((e,r)=>{zv(t,e)})}async function TV(t,e){zk(t),Hv(t)?(t.q_.M_(e),Wv(t)):t.q_.set("Unknown")}async function AV(t,e,r){if(t.q_.set("Online"),e instanceof Fk&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.N_.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.N_.delete(o),i.Q_.removeTarget(o))}(t,e)}catch(n){Ze("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await xp(t,n)}else if(e instanceof yh?t.Q_.Ke(e):e instanceof kk?t.Q_.He(e):t.Q_.We(e),!r.isEqual(yt.min()))try{const n=await Bk(t.localStore);r.compareTo(n)>=0&&await function(s,a){const o=s.Q_.rt(a);return o.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const f=s.N_.get(u);f&&s.N_.set(u,f.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,u)=>{const f=s.N_.get(l);if(!f)return;s.N_.set(l,f.withResumeToken(ni.EMPTY_BYTE_STRING,f.snapshotVersion)),Vk(s,l);const p=new $o(f.target,l,u,f.sequenceNumber);zv(s,p)}),s.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Ze("RemoteStore","Failed to raise snapshot:",n),await xp(t,n)}}async function xp(t,e,r){if(!Qf(e))throw e;t.L_.add(1),await e0(t),t.q_.set("Offline"),r||(r=()=>Bk(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ze("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await ag(t)})}function Wk(t,e){return e().catch(r=>xp(t,r,e))}async function og(t){const e=_t(t),r=hl(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;CV(e);)try{const i=await cV(e.localStore,n);if(i===null){e.O_.length===0&&r.o_();break}n=i.batchId,kV(e,i)}catch(i){await xp(e,i)}Hk(e)&&$k(e)}function CV(t){return mc(t)&&t.O_.length<10}function kV(t,e){t.O_.push(e);const r=hl(t);r.r_()&&r.V_&&r.m_(e.mutations)}function Hk(t){return mc(t)&&!hl(t).n_()&&t.O_.length>0}function $k(t){hl(t).start()}async function FV(t){hl(t).p_()}async function bV(t){const e=hl(t);for(const r of t.O_)e.m_(r.mutations)}async function IV(t,e,r){const n=t.O_.shift(),i=Ov.from(n,e,r);await Wk(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await og(t)}async function NV(t,e){e&&hl(t).V_&&await async function(n,i){if(function(a){return yU(a)&&a!==Oe.ABORTED}(i.code)){const s=n.O_.shift();hl(n).s_(),await Wk(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await og(n)}}(t,e),Hk(t)&&$k(t)}async function VE(t,e){const r=_t(t);r.asyncQueue.verifyOperationInProgress(),Ze("RemoteStore","RemoteStore received new credentials");const n=mc(r);r.L_.add(3),await e0(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await ag(r)}async function RV(t,e){const r=_t(t);e?(r.L_.delete(2),await ag(r)):e||(r.L_.add(2),await e0(r),r.q_.set("Unknown"))}function Vu(t){return t.K_||(t.K_=function(r,n,i){const s=_t(r);return s.w_(),new xV(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:SV.bind(null,t),Ro:wV.bind(null,t),mo:TV.bind(null,t),d_:AV.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Hv(t)?Wv(t):t.q_.set("Unknown")):(await t.K_.stop(),zk(t))})),t.K_}function hl(t){return t.U_||(t.U_=function(r,n,i){const s=_t(r);return s.w_(),new vV(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:FV.bind(null,t),mo:NV.bind(null,t),f_:bV.bind(null,t),g_:IV.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await og(t)):(await t.U_.stop(),t.O_.length>0&&(Ze("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $v{constructor(e,r,n,i,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new nl,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,s){const a=Date.now()+n,o=new $v(e,r,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ot(Oe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Gv(t,e){if(lo("AsyncQueue",`${e}: ${t}`),Qf(t))return new ot(Oe.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou{constructor(e){this.comparator=e?(r,n)=>e(r,n)||ct.comparator(r.key,n.key):(r,n)=>ct.comparator(r.key,n.key),this.keyedMap=Sd(),this.sortedSet=new Gr(this.comparator)}static emptySet(e){return new ou(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof ou)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new ou;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zE{constructor(){this.W_=new Gr(ct.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):mt():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class ku{constructor(e,r,n,i,s,a,o,l,u){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,r,n,i,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new ku(e,r,ou.emptySet(r),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&eg(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DV{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class PV{constructor(){this.queries=WE(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const i=_t(r),s=i.queries;i.queries=WE(),s.forEach((a,o)=>{for(const l of o.j_)l.onError(n)})})(this,new ot(Oe.ABORTED,"Firestore shutting down"))}}function WE(){return new Uu(t=>hk(t),eg)}async function Gk(t,e){const r=_t(t);let n=3;const i=e.query;let s=r.queries.get(i);s?!s.H_()&&e.J_()&&(n=2):(s=new DV,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(i,!0);break;case 1:s.z_=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const o=Gv(a,`Initialization of query '${Pc(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,s),s.j_.push(e),e.Z_(r.onlineState),s.z_&&e.X_(s.z_)&&Kv(r)}async function Kk(t,e){const r=_t(t),n=e.query;let i=3;const s=r.queries.get(n);if(s){const a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function OV(t,e){const r=_t(t);let n=!1;for(const i of e){const s=i.query,a=r.queries.get(s);if(a){for(const o of a.j_)o.X_(i)&&(n=!0);a.z_=i}}n&&Kv(r)}function MV(t,e,r){const n=_t(t),i=n.queries.get(e);if(i)for(const s of i.j_)s.onError(r);n.queries.delete(e)}function Kv(t){t.Y_.forEach(e=>{e.next()})}var Mx,HE;(HE=Mx||(Mx={})).ea="default",HE.Cache="cache";class Yk{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new ku(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=ku.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Mx.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xk{constructor(e){this.key=e}}class qk{constructor(e){this.key=e}}class BV{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Lt(),this.mutatedKeys=Lt(),this.Aa=pk(e),this.Ra=new ou(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new zE,i=r?r.Ra:this.Ra;let s=r?r.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,p)=>{const g=i.get(f),m=tg(this.query,p)?p:null,y=!!g&&this.mutatedKeys.has(g.key),x=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let S=!1;g&&m?g.data.isEqual(m.data)?y!==x&&(n.track({type:3,doc:m}),S=!0):this.ga(g,m)||(n.track({type:2,doc:m}),S=!0,(l&&this.Aa(m,l)>0||u&&this.Aa(m,u)<0)&&(o=!0)):!g&&m?(n.track({type:0,doc:m}),S=!0):g&&!m&&(n.track({type:1,doc:g}),S=!0,(l||u)&&(o=!0)),S&&(m?(a=a.add(m),s=x?s.add(f):s.delete(f)):(a=a.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),s=s.delete(f.key),n.track({type:1,doc:f})}return{Ra:a,fa:n,ns:o,mutatedKeys:s}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((f,p)=>function(m,y){const x=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return mt()}};return x(m)-x(y)}(f.type,p.type)||this.Aa(f.doc,p.doc)),this.pa(n),i=i!=null&&i;const o=r&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,u=l!==this.Ea;return this.Ea=l,a.length!==0||u?{snapshot:new ku(this.query,e.Ra,s,a,e.mutatedKeys,l===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new zE,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Lt(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new qk(n))}),this.da.forEach(n=>{e.has(n)||r.push(new Xk(n))}),r}ba(e){this.Ta=e.Ts,this.da=Lt();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return ku.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class jV{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class LV{constructor(e){this.key=e,this.va=!1}}class UV{constructor(e,r,n,i,s,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Uu(o=>hk(o),eg),this.Ma=new Map,this.xa=new Set,this.Oa=new Gr(ct.comparator),this.Na=new Map,this.La=new jv,this.Ba={},this.ka=new Map,this.qa=Cu.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function VV(t,e,r=!0){const n=rF(t);let i;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await Qk(n,e,r,!0),i}async function zV(t,e){const r=rF(t);await Qk(r,e,!0,!1)}async function Qk(t,e,r,n){const i=await uV(t.localStore,Ca(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,r);let o;return n&&(o=await WV(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&Uk(t.remoteStore,i),o}async function WV(t,e,r,n,i){t.Ka=(p,g,m)=>async function(x,S,A,k){let E=S.view.ma(A);E.ns&&(E=await jE(x.localStore,S.query,!1).then(({documents:T})=>S.view.ma(T,E)));const P=k&&k.targetChanges.get(S.targetId),Y=k&&k.targetMismatches.get(S.targetId)!=null,W=S.view.applyChanges(E,x.isPrimaryClient,P,Y);return GE(x,S.targetId,W.wa),W.snapshot}(t,p,g,m);const s=await jE(t.localStore,e,!0),a=new BV(e,s.Ts),o=a.ma(s.documents),l=Zf.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),u=a.applyChanges(o,t.isPrimaryClient,l);GE(t,r,u.wa);const f=new jV(e,r,a);return t.Fa.set(e,f),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),u.snapshot}async function HV(t,e,r){const n=_t(t),i=n.Fa.get(e),s=n.Ma.get(i.targetId);if(s.length>1)return n.Ma.set(i.targetId,s.filter(a=>!eg(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Ox(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Vv(n.remoteStore,i.targetId),Bx(n,i.targetId)}).catch(qf)):(Bx(n,i.targetId),await Ox(n.localStore,i.targetId,!0))}async function $V(t,e){const r=_t(t),n=r.Fa.get(e),i=r.Ma.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Vv(r.remoteStore,n.targetId))}async function GV(t,e,r){const n=ZV(t);try{const i=await function(a,o){const l=_t(a),u=In.now(),f=o.reduce((m,y)=>m.add(y.key),Lt());let p,g;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let y=co(),x=Lt();return l.cs.getEntries(m,f).next(S=>{y=S,y.forEach((A,k)=>{k.isValidDocument()||(x=x.add(A))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,y)).next(S=>{p=S;const A=[];for(const k of o){const E=pU(k,p.get(k.key).overlayedDocument);E!=null&&A.push(new gc(k.key,E,ak(E.value.mapValue),to.exists(!0)))}return l.mutationQueue.addMutationBatch(m,u,A,o)}).next(S=>{g=S;const A=S.applyToLocalDocumentSet(p,x);return l.documentOverlayCache.saveOverlays(m,S.batchId,A)})}).then(()=>({batchId:g.batchId,changes:mk(p)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,l){let u=a.Ba[a.currentUser.toKey()];u||(u=new Gr(tr)),u=u.insert(o,l),a.Ba[a.currentUser.toKey()]=u}(n,i.batchId,r),await t0(n,i.changes),await og(n.remoteStore)}catch(i){const s=Gv(i,"Failed to persist write");r.reject(s)}}async function Jk(t,e){const r=_t(t);try{const n=await oV(r.localStore,e);e.targetChanges.forEach((i,s)=>{const a=r.Na.get(s);a&&(dr(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?dr(a.va):i.removedDocuments.size>0&&(dr(a.va),a.va=!1))}),await t0(r,n,e)}catch(n){await qf(n)}}function $E(t,e,r){const n=_t(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Fa.forEach((s,a)=>{const o=a.view.Z_(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const l=_t(a);l.onlineState=o;let u=!1;l.queries.forEach((f,p)=>{for(const g of p.j_)g.Z_(o)&&(u=!0)}),u&&Kv(l)}(n.eventManager,e),i.length&&n.Ca.d_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function KV(t,e,r){const n=_t(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Na.get(e),s=i&&i.key;if(s){let a=new Gr(ct.comparator);a=a.insert(s,hi.newNoDocument(s,yt.min()));const o=Lt().add(s),l=new ig(yt.min(),new Map,new Gr(tr),a,o);await Jk(n,l),n.Oa=n.Oa.remove(s),n.Na.delete(e),Yv(n)}else await Ox(n.localStore,e,!1).then(()=>Bx(n,e,r)).catch(qf)}async function YV(t,e){const r=_t(t),n=e.batch.batchId;try{const i=await aV(r.localStore,e);eF(r,n,null),Zk(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await t0(r,i)}catch(i){await qf(i)}}async function XV(t,e,r){const n=_t(t);try{const i=await function(a,o){const l=_t(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return l.mutationQueue.lookupMutationBatch(u,o).next(p=>(dr(p!==null),f=p.keys(),l.mutationQueue.removeMutationBatch(u,p))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,f,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>l.localDocuments.getDocuments(u,f))})}(n.localStore,e);eF(n,e,r),Zk(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await t0(n,i)}catch(i){await qf(i)}}function Zk(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function eF(t,e,r){const n=_t(t);let i=n.Ba[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(r?s.reject(r):s.resolve(),i=i.remove(e)),n.Ba[n.currentUser.toKey()]=i}}function Bx(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||tF(t,n)})}function tF(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(Vv(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),Yv(t))}function GE(t,e,r){for(const n of r)n instanceof Xk?(t.La.addReference(n.key,e),qV(t,n)):n instanceof qk?(Ze("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||tF(t,n.key)):mt()}function qV(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(Ze("SyncEngine","New document in limbo: "+r),t.xa.add(n),Yv(t))}function Yv(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new ct(qr.fromString(e)),n=t.qa.next();t.Na.set(n,new LV(r)),t.Oa=t.Oa.insert(r,n),Uk(t.remoteStore,new $o(Ca(Zp(r.path)),n,"TargetPurposeLimboResolution",Fv.oe))}}async function t0(t,e,r){const n=_t(t),i=[],s=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{a.push(n.Ka(l,e,r).then(u=>{var f;if((u||r)&&n.isPrimaryClient){const p=u?!u.fromCache:(f=r==null?void 0:r.targetChanges.get(l.targetId))===null||f===void 0?void 0:f.current;n.sharedClientState.updateQueryState(l.targetId,p?"current":"not-current")}if(u){i.push(u);const p=Uv.Wi(l.targetId,u);s.push(p)}}))}),await Promise.all(a),n.Ca.d_(i),await async function(l,u){const f=_t(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>Re.forEach(u,g=>Re.forEach(g.$i,m=>f.persistence.referenceDelegate.addReference(p,g.targetId,m)).next(()=>Re.forEach(g.Ui,m=>f.persistence.referenceDelegate.removeReference(p,g.targetId,m)))))}catch(p){if(!Qf(p))throw p;Ze("LocalStore","Failed to update sequence numbers: "+p)}for(const p of u){const g=p.targetId;if(!p.fromCache){const m=f.os.get(g),y=m.snapshotVersion,x=m.withLastLimboFreeSnapshotVersion(y);f.os=f.os.insert(g,x)}}}(n.localStore,s))}async function QV(t,e){const r=_t(t);if(!r.currentUser.isEqual(e)){Ze("SyncEngine","User change. New user:",e.toKey());const n=await Mk(r.localStore,e);r.currentUser=e,function(s,a){s.ka.forEach(o=>{o.forEach(l=>{l.reject(new ot(Oe.CANCELLED,a))})}),s.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await t0(r,n.hs)}}function JV(t,e){const r=_t(t),n=r.Na.get(e);if(n&&n.va)return Lt().add(n.key);{let i=Lt();const s=r.Ma.get(e);if(!s)return i;for(const a of s){const o=r.Fa.get(a);i=i.unionWith(o.view.Va)}return i}}function rF(t){const e=_t(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Jk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=JV.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=KV.bind(null,e),e.Ca.d_=OV.bind(null,e.eventManager),e.Ca.$a=MV.bind(null,e.eventManager),e}function ZV(t){const e=_t(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=YV.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=XV.bind(null,e),e}class vp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=sg(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return sV(this.persistence,new nV,e.initialUser,this.serializer)}Ga(e){return new eV(Lv.Zr,this.serializer)}Wa(e){return new fV}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}vp.provider={build:()=>new vp};class jx{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>$E(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=QV.bind(null,this.syncEngine),await RV(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new PV}()}createDatastore(e){const r=sg(e.databaseInfo.databaseId),n=function(s){return new mV(s)}(e.databaseInfo);return function(s,a,o,l){return new yV(s,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,s,a,o){return new EV(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>$E(this.syncEngine,r,0),function(){return UE.D()?new UE:new hV}())}createSyncEngine(e,r){return function(i,s,a,o,l,u,f){const p=new UV(i,s,a,o,l,u);return f&&(p.Qa=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const s=_t(i);Ze("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await e0(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}jx.provider={build:()=>new jx};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nF{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):lo("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ez{constructor(e,r,n,i,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=ci.UNAUTHENTICATED,this.clientId=nk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{Ze("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(Ze("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new nl;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Gv(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function fm(t,e){t.asyncQueue.verifyOperationInProgress(),Ze("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await Mk(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function KE(t,e){t.asyncQueue.verifyOperationInProgress();const r=await tz(t);Ze("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>VE(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>VE(e.remoteStore,i)),t._onlineComponents=e}async function tz(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ze("FirestoreClient","Using user provided OfflineComponentProvider");try{await fm(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===Oe.FAILED_PRECONDITION||i.code===Oe.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Su("Error using user provided cache. Falling back to memory cache: "+r),await fm(t,new vp)}}else Ze("FirestoreClient","Using default OfflineComponentProvider"),await fm(t,new vp);return t._offlineComponents}async function iF(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ze("FirestoreClient","Using user provided OnlineComponentProvider"),await KE(t,t._uninitializedComponentsProvider._online)):(Ze("FirestoreClient","Using default OnlineComponentProvider"),await KE(t,new jx))),t._onlineComponents}function rz(t){return iF(t).then(e=>e.syncEngine)}async function Lx(t){const e=await iF(t),r=e.eventManager;return r.onListen=VV.bind(null,e.syncEngine),r.onUnlisten=HV.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=zV.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=$V.bind(null,e.syncEngine),r}function nz(t,e,r={}){const n=new nl;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,u){const f=new nF({next:g=>{f.Za(),a.enqueueAndForget(()=>Kk(s,p));const m=g.docs.has(o);!m&&g.fromCache?u.reject(new ot(Oe.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&g.fromCache&&l&&l.source==="server"?u.reject(new ot(Oe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),p=new Yk(Zp(o.path),f,{includeMetadataChanges:!0,_a:!0});return Gk(s,p)}(await Lx(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sF(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YE=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iz(t,e,r){if(!r)throw new ot(Oe.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function sz(t,e,r,n){if(e===!0&&n===!0)throw new ot(Oe.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function XE(t){if(!ct.isDocumentKey(t))throw new ot(Oe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Xv(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":mt()}function il(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ot(Oe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Xv(t);throw new ot(Oe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qE{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new ot(Oe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ot(Oe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}sz("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=sF((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ot(Oe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ot(Oe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ot(Oe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class qv{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new qE({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ot(Oe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ot(Oe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new qE(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new S7;switch(n.type){case"firstParty":return new C7(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new ot(Oe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=YE.get(r);n&&(Ze("ComponentProvider","Removing Datastore"),YE.delete(r),n.terminate())}(this),Promise.resolve()}}function az(t,e,r,n={}){var i;const s=(t=il(t,qv))._getSettings(),a=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&Su("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=ci.MOCK_USER;else{o=qL(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const u=n.mockUserToken.sub||n.mockUserToken.user_id;if(!u)throw new ot(Oe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new ci(u)}t._authCredentials=new w7(new rk(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lg{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new lg(this.firestore,e,this._query)}}class us{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Rf(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new us(this.firestore,e,this._key)}}class Rf extends lg{constructor(e,r,n){super(e,r,Zp(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new us(this.firestore,null,new ct(e))}withConverter(e){return new Rf(this.firestore,e,this._path)}}function Qv(t,e,...r){if(t=ca(t),arguments.length===1&&(e=nk.newId()),iz("doc","path",e),t instanceof qv){const n=qr.fromString(e,...r);return XE(n),new us(t,null,new ct(n))}{if(!(t instanceof us||t instanceof Rf))throw new ot(Oe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(qr.fromString(e,...r));return XE(n),new us(t.firestore,t instanceof Rf?t.converter:null,new ct(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QE{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new jk(this,"async_queue_retry"),this.Vu=()=>{const n=dm();n&&Ze("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=dm();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=dm();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new nl;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Qf(e))throw e;Ze("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw lo("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const i=$v.createAndSchedule(this,e,r,n,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&mt()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function JE(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const i=r;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class Df extends qv{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new QE,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new QE(e),this._firestoreClient=void 0,await e}}}function oz(t,e){const r=typeof t=="object"?t:KC(),n=typeof t=="string"?t:"(default)",i=Cv(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=YL("firestore");s&&az(i,...s)}return i}function Jv(t){if(t._terminated)throw new ot(Oe.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||lz(t),t._firestoreClient}function lz(t){var e,r,n;const i=t._freezeSettings(),s=function(o,l,u,f){return new L7(o,l,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,sF(f.experimentalLongPollingOptions),f.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new ez(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Fu(ni.fromBase64String(e))}catch(r){throw new ot(Oe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Fu(ni.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zv{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new ot(Oe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Zn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aF{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ey{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new ot(Oe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new ot(Oe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return tr(this._lat,e._lat)||tr(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ty{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cz=/^__.*__$/;class uz{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new gc(e,this.data,this.fieldMask,r,this.fieldTransforms):new Jf(e,this.data,r,this.fieldTransforms)}}function oF(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw mt()}}class ry{constructor(e,r,n,i,s,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new ry(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return yp(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(oF(this.Cu)&&cz.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class dz{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||sg(e)}Qu(e,r,n,i=!1){return new ry({Cu:e,methodName:r,qu:n,path:Zn.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function fz(t){const e=t._freezeSettings(),r=sg(t._databaseId);return new dz(t._databaseId,!!e.ignoreUndefinedProperties,r)}function hz(t,e,r,n,i,s={}){const a=t.Qu(s.merge||s.mergeFields?2:0,e,r,i);dF("Data must be an object, but it was:",a,n);const o=cF(n,a);let l,u;if(s.merge)l=new na(a.fieldMask),u=a.fieldTransforms;else if(s.mergeFields){const f=[];for(const p of s.mergeFields){const g=pz(e,p,r);if(!a.contains(g))throw new ot(Oe.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);mz(f,g)||f.push(g)}l=new na(f),u=a.fieldTransforms.filter(p=>l.covers(p.field))}else l=null,u=a.fieldTransforms;return new uz(new Ds(o),l,u)}function lF(t,e){if(uF(t=ca(t)))return dF("Unsupported field value:",e,t),cF(t,e);if(t instanceof aF)return function(n,i){if(!oF(i.Cu))throw i.Bu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let l=lF(o,i.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(t,e)}return function(n,i){if((n=ca(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return lU(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=In.fromDate(n);return{timestampValue:mp(i.serializer,s)}}if(n instanceof In){const s=new In(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:mp(i.serializer,s)}}if(n instanceof ey)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Fu)return{bytesValue:bk(i.serializer,n._byteString)};if(n instanceof us){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Bv(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof ty)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return Pv(o.serializer,l)})}}}}}}(n,i);throw i.Bu(`Unsupported field value: ${Xv(n)}`)}(t,e)}function cF(t,e){const r={};return ik(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Lu(t,(n,i)=>{const s=lF(i,e.Mu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function uF(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof In||t instanceof ey||t instanceof Fu||t instanceof us||t instanceof aF||t instanceof ty)}function dF(t,e,r){if(!uF(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=Xv(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function pz(t,e,r){if((e=ca(e))instanceof Zv)return e._internalPath;if(typeof e=="string")return fF(t,e);throw yp("Field path arguments must be of type string or ",t,!1,void 0,r)}const gz=new RegExp("[~\\*/\\[\\]]");function fF(t,e,r){if(e.search(gz)>=0)throw yp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Zv(...e.split("."))._internalPath}catch{throw yp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function yp(t,e,r,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${i}`),l+=")"),new ot(Oe.INVALID_ARGUMENT,o+t+l)}function mz(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hF{constructor(e,r,n,i,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new us(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new xz(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(pF("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class xz extends hF{data(){return super.data()}}function pF(t,e){return typeof e=="string"?fF(t,e):e instanceof Zv?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vz(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ot(Oe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class yz{convertValue(e,r="none"){switch(sc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return an(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(ic(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw mt()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Lu(e,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,i;const s=(i=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(a=>an(a.doubleValue));return new ty(s)}convertGeoPoint(e){return new ey(an(e.latitude),an(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Iv(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(kf(e));default:return null}}convertTimestamp(e){const r=fl(e);return new In(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=qr.fromString(e);dr(Ok(n));const i=new Ff(n.get(1),n.get(3)),s=new ct(n.popFirst(5));return i.isEqual(r)||lo(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _z(t,e,r){let n;return n=t?t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Td{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class gF extends hF{constructor(e,r,n,i,s,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new _h(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(pF("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class _h extends gF{data(e={}){return super.data(e)}}class Ez{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new Td(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new _h(this._firestore,this._userDataWriter,n.key,n,new Td(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new ot(Oe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const l=new _h(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Td(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new _h(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Td(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,f=-1;return o.type!==0&&(u=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),f=a.indexOf(o.doc.key)),{type:Sz(o.type),doc:l,oldIndex:u,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function Sz(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return mt()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wz(t){t=il(t,us);const e=il(t.firestore,Df);return nz(Jv(e),t._key).then(r=>xF(e,t,r))}class mF extends yz{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fu(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new us(this.firestore,null,r)}}function Tz(t,e,r){t=il(t,us);const n=il(t.firestore,Df),i=_z(t.converter,e);return Cz(n,[hz(fz(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,to.none())])}function Az(t,...e){var r,n,i;t=ca(t);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||JE(e[a])||(s=e[a],a++);const o={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(JE(e[a])){const p=e[a];e[a]=(r=p.next)===null||r===void 0?void 0:r.bind(p),e[a+1]=(n=p.error)===null||n===void 0?void 0:n.bind(p),e[a+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let l,u,f;if(t instanceof us)u=il(t.firestore,Df),f=Zp(t._key.path),l={next:p=>{e[a]&&e[a](xF(u,t,p))},error:e[a+1],complete:e[a+2]};else{const p=il(t,lg);u=il(p.firestore,Df),f=p._query;const g=new mF(u);l={next:m=>{e[a]&&e[a](new Ez(u,g,p,m))},error:e[a+1],complete:e[a+2]},vz(t._query)}return function(g,m,y,x){const S=new nF(x),A=new Yk(m,S,y);return g.asyncQueue.enqueueAndForget(async()=>Gk(await Lx(g),A)),()=>{S.Za(),g.asyncQueue.enqueueAndForget(async()=>Kk(await Lx(g),A))}}(Jv(u),f,o,l)}function Cz(t,e){return function(n,i){const s=new nl;return n.asyncQueue.enqueueAndForget(async()=>GV(await rz(n),i,s)),s.promise}(Jv(t),e)}function xF(t,e,r){const n=r.docs.get(e._key),i=new mF(t);return new gF(t,i,e._key,n,new Td(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){ju=i})(Bu),Eu(new rc("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new Df(new T7(n.getProvider("auth-internal")),new F7(n.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new ot(Oe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ff(u.options.projectId,f)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),rl(xE,"4.7.3",e),rl(xE,"4.7.3","esm2017")})();function ny(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function vF(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const kz=vF,yF=new Yf("auth","Firebase",vF());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _p=new Tv("@firebase/auth");function Fz(t,...e){_p.logLevel<=zt.WARN&&_p.warn(`Auth (${Bu}): ${t}`,...e)}function Eh(t,...e){_p.logLevel<=zt.ERROR&&_p.error(`Auth (${Bu}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uo(t,...e){throw iy(t,...e)}function Fa(t,...e){return iy(t,...e)}function _F(t,e,r){const n=Object.assign(Object.assign({},kz()),{[e]:r});return new Yf("auth","Firebase",n).create(e,{appName:t.name})}function Hl(t){return _F(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function iy(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return yF.create(t,...e)}function gt(t,e,...r){if(!t)throw iy(e,...r)}function Ya(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Eh(e),new Error(e)}function fo(t,e){t||Ya(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ux(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function bz(){return ZE()==="http:"||ZE()==="https:"}function ZE(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iz(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(bz()||e9()||"connection"in navigator)?navigator.onLine:!0}function Nz(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r0{constructor(e,r){this.shortDelay=e,this.longDelay=r,fo(r>e,"Short delay should be less than long delay!"),this.isMobile=QL()||t9()}get(){return Iz()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sy(t,e){fo(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EF{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ya("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ya("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ya("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rz={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dz=new r0(3e4,6e4);function ay(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function zu(t,e,r,n,i={}){return SF(t,i,async()=>{let s={},a={};n&&(e==="GET"?a=n:s={body:JSON.stringify(n)});const o=Xf(Object.assign({key:t.config.apiKey},a)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:l},s);return ZL()||(u.referrerPolicy="no-referrer"),EF.fetch()(wF(t,t.config.apiHost,r,o),u)})}async function SF(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},Rz),e);try{const i=new Oz(t),s=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw eh(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,u]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw eh(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw eh(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw eh(t,"user-disabled",a);const f=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw _F(t,f,u);uo(t,f)}}catch(i){if(i instanceof xo)throw i;uo(t,"network-request-failed",{message:String(i)})}}async function Pz(t,e,r,n,i={}){const s=await zu(t,e,r,n,i);return"mfaPendingCredential"in s&&uo(t,"multi-factor-auth-required",{_serverResponse:s}),s}function wF(t,e,r,n){const i=`${e}${r}?${n}`;return t.config.emulator?sy(t.config,i):`${t.config.apiScheme}://${i}`}class Oz{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Fa(this.auth,"network-request-failed")),Dz.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function eh(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Fa(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mz(t,e){return zu(t,"POST","/v1/accounts:delete",e)}async function TF(t,e){return zu(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gd(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Bz(t,e=!1){const r=ca(t),n=await r.getIdToken(e),i=oy(n);gt(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:Gd(hm(i.auth_time)),issuedAtTime:Gd(hm(i.iat)),expirationTime:Gd(hm(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function hm(t){return Number(t)*1e3}function oy(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Eh("JWT malformed, contained fewer than 3 sections"),null;try{const i=UC(r);return i?JSON.parse(i):(Eh("Failed to decode base64 JWT payload"),null)}catch(i){return Eh("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function eS(t){const e=oy(t);return gt(e,"internal-error"),gt(typeof e.exp<"u","internal-error"),gt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pf(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof xo&&jz(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function jz({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lz{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vx{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Gd(this.lastLoginAt),this.creationTime=Gd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ep(t){var e;const r=t.auth,n=await t.getIdToken(),i=await Pf(t,TF(r,{idToken:n}));gt(i==null?void 0:i.users.length,r,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?AF(s.providerUserInfo):[],o=Vz(t.providerData,a),l=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),f=l?u:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Vx(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(t,p)}async function Uz(t){const e=ca(t);await Ep(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Vz(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function AF(t){return t.map(e=>{var{providerId:r}=e,n=ny(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zz(t,e){const r=await SF(t,{},async()=>{const n=Xf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=wF(t,i,"/v1/token",`key=${s}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",EF.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function Wz(t,e){return zu(t,"POST","/v2/accounts:revokeToken",ay(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){gt(e.idToken,"internal-error"),gt(typeof e.idToken<"u","internal-error"),gt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):eS(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){gt(e.length!==0,"internal-error");const r=eS(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(gt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:s}=await zz(e,r);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new lu;return n&&(gt(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(gt(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(gt(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new lu,this.toJSON())}_performRefresh(){return Ya("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function No(t,e){gt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Xa{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,s=ny(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Lz(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Vx(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await Pf(this,this.stsTokenManager.getToken(this.auth,e));return gt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return Bz(this,e)}reload(){return Uz(this)}_assign(e){this!==e&&(gt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Xa(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){gt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Ep(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ho(this.auth.app))return Promise.reject(Hl(this.auth));const e=await this.getIdToken();return await Pf(this,Mz(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,s,a,o,l,u,f;const p=(n=r.displayName)!==null&&n!==void 0?n:void 0,g=(i=r.email)!==null&&i!==void 0?i:void 0,m=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,y=(a=r.photoURL)!==null&&a!==void 0?a:void 0,x=(o=r.tenantId)!==null&&o!==void 0?o:void 0,S=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,A=(u=r.createdAt)!==null&&u!==void 0?u:void 0,k=(f=r.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:E,emailVerified:P,isAnonymous:Y,providerData:W,stsTokenManager:T}=r;gt(E&&T,e,"internal-error");const F=lu.fromJSON(this.name,T);gt(typeof E=="string",e,"internal-error"),No(p,e.name),No(g,e.name),gt(typeof P=="boolean",e,"internal-error"),gt(typeof Y=="boolean",e,"internal-error"),No(m,e.name),No(y,e.name),No(x,e.name),No(S,e.name),No(A,e.name),No(k,e.name);const w=new Xa({uid:E,auth:e,email:g,emailVerified:P,displayName:p,isAnonymous:Y,photoURL:y,phoneNumber:m,tenantId:x,stsTokenManager:F,createdAt:A,lastLoginAt:k});return W&&Array.isArray(W)&&(w.providerData=W.map(I=>Object.assign({},I))),S&&(w._redirectEventId=S),w}static async _fromIdTokenResponse(e,r,n=!1){const i=new lu;i.updateFromServerResponse(r);const s=new Xa({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await Ep(s),s}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];gt(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?AF(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),o=new lu;o.updateFromIdToken(n);const l=new Xa({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Vx(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tS=new Map;function qa(t){fo(t instanceof Function,"Expected a class definition");let e=tS.get(t);return e?(fo(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,tS.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CF{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}CF.type="NONE";const rS=CF;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sh(t,e,r){return`firebase:${t}:${e}:${r}`}class cu{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=Sh(this.userKey,i.apiKey,s),this.fullPersistenceKey=Sh("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Xa._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new cu(qa(rS),e,n);const i=(await Promise.all(r.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||qa(rS);const a=Sh(n,e.config.apiKey,e.name);let o=null;for(const u of r)try{const f=await u._get(a);if(f){const p=Xa._fromJSON(e,f);u!==s&&(o=p),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new cu(s,e,n):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async u=>{if(u!==s)try{await u._remove(a)}catch{}})),new cu(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nS(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(IF(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(kF(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(RF(e))return"Blackberry";if(DF(e))return"Webos";if(FF(e))return"Safari";if((e.includes("chrome/")||bF(e))&&!e.includes("edge/"))return"Chrome";if(NF(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function kF(t=vi()){return/firefox\//i.test(t)}function FF(t=vi()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function bF(t=vi()){return/crios\//i.test(t)}function IF(t=vi()){return/iemobile/i.test(t)}function NF(t=vi()){return/android/i.test(t)}function RF(t=vi()){return/blackberry/i.test(t)}function DF(t=vi()){return/webos/i.test(t)}function ly(t=vi()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Hz(t=vi()){var e;return ly(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function $z(){return r9()&&document.documentMode===10}function PF(t=vi()){return ly(t)||NF(t)||DF(t)||RF(t)||/windows phone/i.test(t)||IF(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OF(t,e=[]){let r;switch(t){case"Browser":r=nS(vi());break;case"Worker":r=`${nS(vi())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Bu}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gz{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kz(t,e={}){return zu(t,"GET","/v2/passwordPolicy",ay(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yz=6;class Xz{constructor(e){var r,n,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:Yz,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qz{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new iS(this),this.idTokenSubscription=new iS(this),this.beforeStateQueue=new Gz(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=yF,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=qa(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await cu.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await TF(this,{idToken:e}),n=await Xa._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Ho(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return gt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Ep(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Nz()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ho(this.app))return Promise.reject(Hl(this));const r=e?ca(e):null;return r&&gt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&gt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ho(this.app)?Promise.reject(Hl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ho(this.app)?Promise.reject(Hl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(qa(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Kz(this),r=new Xz(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Yf("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await Wz(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&qa(e)||this._popupRedirectResolver;gt(r,this,"argument-error"),this.redirectPersistenceManager=await cu.create(this,[qa(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(gt(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,i);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return gt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=OF(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&Fz(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function cy(t){return ca(t)}class iS{constructor(e){this.auth=e,this.observer=null,this.addObserver=u9(r=>this.observer=r)}get next(){return gt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uy={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Qz(t){uy=t}function Jz(t){return uy.loadJS(t)}function Zz(){return uy.gapiScript}function eW(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tW(t,e){const r=Cv(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),s=r.getOptions();if(cp(s,e??{}))return i;uo(i,"already-initialized")}return r.initialize({options:e})}function rW(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(qa);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function nW(t,e,r){const n=cy(t);gt(n._canInitEmulator,n,"emulator-config-failed"),gt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,s=MF(e),{host:a,port:o}=iW(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${s}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),sW()}function MF(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function iW(t){const e=MF(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:sS(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:sS(a)}}}function sS(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function sW(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BF{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Ya("not implemented")}_getIdTokenResponse(e){return Ya("not implemented")}_linkToIdToken(e,r){return Ya("not implemented")}_getReauthenticationResolver(e){return Ya("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uu(t,e){return Pz(t,"POST","/v1/accounts:signInWithIdp",ay(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aW="http://localhost";class ac extends BF{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new ac(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):uo("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,s=ny(r,["providerId","signInMethod"]);if(!n||!i)return null;const a=new ac(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return uu(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,uu(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,uu(e,r)}buildRequest(){const e={requestUri:aW,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Xf(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jF{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n0 extends jF{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo extends n0{constructor(){super("facebook.com")}static credential(e){return ac._fromParams({providerId:Mo.PROVIDER_ID,signInMethod:Mo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Mo.credentialFromTaggedObject(e)}static credentialFromError(e){return Mo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Mo.credential(e.oauthAccessToken)}catch{return null}}}Mo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Mo.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo extends n0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return ac._fromParams({providerId:Bo.PROVIDER_ID,signInMethod:Bo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Bo.credentialFromTaggedObject(e)}static credentialFromError(e){return Bo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Bo.credential(r,n)}catch{return null}}}Bo.GOOGLE_SIGN_IN_METHOD="google.com";Bo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo extends n0{constructor(){super("github.com")}static credential(e){return ac._fromParams({providerId:jo.PROVIDER_ID,signInMethod:jo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return jo.credentialFromTaggedObject(e)}static credentialFromError(e){return jo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return jo.credential(e.oauthAccessToken)}catch{return null}}}jo.GITHUB_SIGN_IN_METHOD="github.com";jo.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo extends n0{constructor(){super("twitter.com")}static credential(e,r){return ac._fromParams({providerId:Lo.PROVIDER_ID,signInMethod:Lo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Lo.credentialFromTaggedObject(e)}static credentialFromError(e){return Lo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Lo.credential(r,n)}catch{return null}}}Lo.TWITTER_SIGN_IN_METHOD="twitter.com";Lo.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const s=await Xa._fromIdTokenResponse(e,n,i),a=aS(n);return new bu({user:s,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=aS(n);return new bu({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function aS(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp extends xo{constructor(e,r,n,i){var s;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Sp.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new Sp(e,r,n,i)}}function LF(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Sp._fromErrorAndOperation(t,s,e,n):s})}async function oW(t,e,r=!1){const n=await Pf(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return bu._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lW(t,e,r=!1){const{auth:n}=t;if(Ho(n.app))return Promise.reject(Hl(n));const i="reauthenticate";try{const s=await Pf(t,LF(n,i,e,t),r);gt(s.idToken,n,"internal-error");const a=oy(s.idToken);gt(a,n,"internal-error");const{sub:o}=a;return gt(t.uid===o,n,"user-mismatch"),bu._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&uo(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cW(t,e,r=!1){if(Ho(t.app))return Promise.reject(Hl(t));const n="signIn",i=await LF(t,n,e),s=await bu._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(s.user),s}function uW(t,e,r,n){return ca(t).onIdTokenChanged(e,r,n)}function dW(t,e,r){return ca(t).beforeAuthStateChanged(e,r)}const wp="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UF{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(wp,"1"),this.storage.removeItem(wp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fW=1e3,hW=10;class VF extends UF{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=PF(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);$z()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,hW):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},fW)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}VF.type="LOCAL";const pW=VF;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zF extends UF{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}zF.type="SESSION";const WF=zF;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gW(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cg{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new cg(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:s}=r.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async u=>u(r.origin,s)),l=await gW(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}cg.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dy(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mW{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const u=dy("",20);i.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(p){const g=p;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(g.data.response);break;default:clearTimeout(f),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ba(){return window}function xW(t){ba().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HF(){return typeof ba().WorkerGlobalScope<"u"&&typeof ba().importScripts=="function"}async function vW(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function yW(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function _W(){return HF()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $F="firebaseLocalStorageDb",EW=1,Tp="firebaseLocalStorage",GF="fbase_key";class i0{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function ug(t,e){return t.transaction([Tp],e?"readwrite":"readonly").objectStore(Tp)}function SW(){const t=indexedDB.deleteDatabase($F);return new i0(t).toPromise()}function zx(){const t=indexedDB.open($F,EW);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Tp,{keyPath:GF})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Tp)?e(n):(n.close(),await SW(),e(await zx()))})})}async function oS(t,e,r){const n=ug(t,!0).put({[GF]:e,value:r});return new i0(n).toPromise()}async function wW(t,e){const r=ug(t,!1).get(e),n=await new i0(r).toPromise();return n===void 0?null:n.value}function lS(t,e){const r=ug(t,!0).delete(e);return new i0(r).toPromise()}const TW=800,AW=3;class KF{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await zx(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>AW)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return HF()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=cg._getInstance(_W()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await vW(),!this.activeServiceWorker)return;this.sender=new mW(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||yW()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await zx();return await oS(e,wp,"1"),await lS(e,wp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>oS(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>wW(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>lS(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=ug(i,!1).getAll();return new i0(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),TW)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}KF.type="LOCAL";const CW=KF;new r0(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kW(t,e){return e?qa(e):(gt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fy extends BF{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return uu(e,this._buildIdpRequest())}_linkToIdToken(e,r){return uu(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return uu(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function FW(t){return cW(t.auth,new fy(t),t.bypassAuthState)}function bW(t){const{auth:e,user:r}=t;return gt(r,e,"internal-error"),lW(r,new fy(t),t.bypassAuthState)}async function IW(t){const{auth:e,user:r}=t;return gt(r,e,"internal-error"),oW(r,new fy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YF{constructor(e,r,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return FW;case"linkViaPopup":case"linkViaRedirect":return IW;case"reauthViaPopup":case"reauthViaRedirect":return bW;default:uo(this.auth,"internal-error")}}resolve(e){fo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){fo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NW=new r0(2e3,1e4);class qc extends YF{constructor(e,r,n,i,s){super(e,r,i,s),this.provider=n,this.authWindow=null,this.pollId=null,qc.currentPopupAction&&qc.currentPopupAction.cancel(),qc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return gt(e,this.auth,"internal-error"),e}async onExecution(){fo(this.filter.length===1,"Popup operations only handle one event");const e=dy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Fa(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Fa(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,qc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Fa(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,NW.get())};e()}}qc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RW="pendingRedirect",wh=new Map;class DW extends YF{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=wh.get(this.auth._key());if(!e){try{const n=await PW(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}wh.set(this.auth._key(),e)}return this.bypassAuthState||wh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function PW(t,e){const r=BW(e),n=MW(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function OW(t,e){wh.set(t._key(),e)}function MW(t){return qa(t._redirectPersistence)}function BW(t){return Sh(RW,t.config.apiKey,t.name)}async function jW(t,e,r=!1){if(Ho(t.app))return Promise.reject(Hl(t));const n=cy(t),i=kW(n,e),a=await new DW(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LW=10*60*1e3;class UW{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!VW(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!XF(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(Fa(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=LW&&this.cachedEventUids.clear(),this.cachedEventUids.has(cS(e))}saveEventToCache(e){this.cachedEventUids.add(cS(e)),this.lastProcessedEventTime=Date.now()}}function cS(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function XF({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function VW(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return XF(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zW(t,e={}){return zu(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WW=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,HW=/^https?/;async function $W(t){if(t.config.emulator)return;const{authorizedDomains:e}=await zW(t);for(const r of e)try{if(GW(r))return}catch{}uo(t,"unauthorized-domain")}function GW(t){const e=Ux(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!HW.test(r))return!1;if(WW.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KW=new r0(3e4,6e4);function uS(){const t=ba().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function YW(t){return new Promise((e,r)=>{var n,i,s;function a(){uS(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{uS(),r(Fa(t,"network-request-failed"))},timeout:KW.get()})}if(!((i=(n=ba().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=ba().gapi)===null||s===void 0)&&s.load)a();else{const o=eW("iframefcb");return ba()[o]=()=>{gapi.load?a():r(Fa(t,"network-request-failed"))},Jz(`${Zz()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw Th=null,e})}let Th=null;function XW(t){return Th=Th||YW(t),Th}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qW=new r0(5e3,15e3),QW="__/auth/iframe",JW="emulator/auth/iframe",ZW={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},eH=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function tH(t){const e=t.config;gt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?sy(e,JW):`https://${t.config.authDomain}/${QW}`,n={apiKey:e.apiKey,appName:t.name,v:Bu},i=eH.get(t.config.apiHost);i&&(n.eid=i);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${Xf(n).slice(1)}`}async function rH(t){const e=await XW(t),r=ba().gapi;return gt(r,t,"internal-error"),e.open({where:document.body,url:tH(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ZW,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const a=Fa(t,"network-request-failed"),o=ba().setTimeout(()=>{s(a)},qW.get());function l(){ba().clearTimeout(o),i(n)}n.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nH={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},iH=500,sH=600,aH="_blank",oH="http://localhost";class dS{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function lH(t,e,r,n=iH,i=sH){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},nH),{width:n.toString(),height:i.toString(),top:s,left:a}),u=vi().toLowerCase();r&&(o=bF(u)?aH:r),kF(u)&&(e=e||oH,l.scrollbars="yes");const f=Object.entries(l).reduce((g,[m,y])=>`${g}${m}=${y},`,"");if(Hz(u)&&o!=="_self")return cH(e||"",o),new dS(null);const p=window.open(e||"",o,f);gt(p,t,"popup-blocked");try{p.focus()}catch{}return new dS(p)}function cH(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uH="__/auth/handler",dH="emulator/auth/handler",fH=encodeURIComponent("fac");async function fS(t,e,r,n,i,s){gt(t.config.authDomain,t,"auth-domain-config-required"),gt(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Bu,eventId:i};if(e instanceof jF){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",c9(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))a[f]=p}if(e instanceof n0){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const f of Object.keys(o))o[f]===void 0&&delete o[f];const l=await t._getAppCheckToken(),u=l?`#${fH}=${encodeURIComponent(l)}`:"";return`${hH(t)}?${Xf(o).slice(1)}${u}`}function hH({config:t}){return t.emulator?sy(t,dH):`https://${t.authDomain}/${uH}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pm="webStorageSupport";class pH{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=WF,this._completeRedirectFn=jW,this._overrideRedirectResult=OW}async _openPopup(e,r,n,i){var s;fo((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await fS(e,r,n,Ux(),i);return lH(e,a,dy())}async _openRedirect(e,r,n,i){await this._originValidation(e);const s=await fS(e,r,n,Ux(),i);return xW(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:s}=this.eventManagers[r];return i?Promise.resolve(i):(fo(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await rH(e),n=new UW(e);return r.register("authEvent",i=>(gt(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(pm,{type:pm},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[pm];a!==void 0&&r(!!a),uo(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=$W(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return PF()||FF()||ly()}}const gH=pH;var hS="@firebase/auth",pS="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mH{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){gt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xH(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function vH(t){Eu(new rc("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;gt(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:OF(t)},u=new qz(n,i,s,l);return rW(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Eu(new rc("auth-internal",e=>{const r=cy(e.getProvider("auth").getImmediate());return(n=>new mH(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),rl(hS,pS,xH(t)),rl(hS,pS,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yH=5*60,_H=WC("authIdTokenMaxAge")||yH;let gS=null;const EH=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>_H)return;const i=r==null?void 0:r.token;gS!==i&&(gS=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function SH(t=KC()){const e=Cv(t,"auth");if(e.isInitialized())return e.getImmediate();const r=tW(t,{popupRedirectResolver:gH,persistence:[CW,pW,WF]}),n=WC("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const a=EH(s.toString());dW(r,a,()=>a(r.currentUser)),uW(r,o=>a(o))}}const i=VC("auth");return i&&nW(r,`http://${i}`),r}function wH(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}Qz({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const s=Fa("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",wH().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});vH("Browser");const TH={apiKey:"AIzaSyAZZ0804o11q-hS6p7XJZNK_FPGJgXpmPc",authDomain:"finance-automation-b28e8.firebaseapp.com",projectId:"finance-automation-b28e8",storageBucket:"finance-automation-b28e8.firebasestorage.app",messagingSenderId:"832501526859",appId:"1:832501526859:web:3a64f40f9db732af1b78ce"},qF=GC(TH),hy=oz(qF);SH(qF);const hd=async(t,e)=>{try{return await Tz(Qv(hy,"appState",t),{masterData:e.masterData||[],servicesData:e.servicesData||[],ledgerEntries:e.ledgerEntries||[],receipts:e.receipts||[],creditNotes:e.creditNotes||[],openingBalances:e.openingBalances||{},mailerImages:e.mailerImages||{},mailerLogo:e.mailerLogo||null,companyConfig:e.companyConfig||{},nextInvoiceNo:e.nextInvoiceNo||1,nextCombineNo:e.nextCombineNo||1,nextReceiptNo:e.nextReceiptNo||1,nextCreditNoteNo:e.nextCreditNoteNo||1,nextServiceInvoiceNo:e.nextServiceInvoiceNo||1,invoiceValues:e.invoiceValues||{},notifications:e.notifications||[],whatsappSettings:e.whatsappSettings||{},partyMaster:e.partyMaster||[],followups:e.followups||[],userPasswords:e.userPasswords||{},updatedAt:new Date().toISOString()}),!0}catch(r){return console.error("Error saving app state:",r),!1}},mS=async t=>{try{const e=await wz(Qv(hy,"appState",t));return e.exists()?e.data():null}catch(e){return console.error("Error loading app state:",e),null}},AH=(t,e)=>{const r=Qv(hy,"appState",t);return Az(r,n=>{n.exists()&&e(n.data())},n=>{console.error("Error in real-time listener:",n)})},et=t=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2,maximumFractionDigits:2}).format(t||0),bt=t=>""+new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t||0),wt=t=>{if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return t;const r=e.getDate().toString().padStart(2,"0"),n=e.toLocaleString("en-US",{month:"short"}),i=e.getFullYear();return`${r}-${n}-${i}`},CH=t=>{if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return t;const r=e.getDate(),n=e.toLocaleString("en-US",{month:"short"}),i=e.getFullYear();return`${r}${(a=>{if(a>3&&a<21)return"th";switch(a%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}})(r)} ${n}, ${i}`},th=t=>{const e=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],r=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];if(t===0)return"Zero";const n=l=>l<20?e[l]:l<100?r[Math.floor(l/10)]+(l%10?" "+e[l%10]:""):e[Math.floor(l/100)]+" Hundred"+(l%100?" "+n(l%100):""),i=l=>l<1e3?n(l):l<1e5?n(Math.floor(l/1e3))+" Thousand"+(l%1e3?" "+n(l%1e3):""):l<1e7?n(Math.floor(l/1e5))+" Lakh"+(l%1e5?" "+i(l%1e5):""):n(Math.floor(l/1e7))+" Crore"+(l%1e7?" "+i(l%1e7):""),s=Math.floor(t),a=Math.round((t-s)*100);let o="INR "+i(s);return a>0&&(o+=" and "+i(a)+" Paise"),o+" Only"},kH=t=>{if(!t)return"";const e=/[\w.-]+@[\w.-]+\.\w+/g,r=t.match(e);return r?r[0]:""},FH=t=>({Approved:{bg:"#DCFCE7",text:"#166534",border:"#86EFAC"},Created:{bg:"#DBEAFE",text:"#1E40AF",border:"#93C5FD"},"Need Edits":{bg:"#FEE2E2",text:"#991B1B",border:"#FCA5A5"},Paid:{bg:"#D1FAE5",text:"#065F46",border:"#6EE7B7"},Individual:{bg:"#E0E7FF",text:"#3730A3",border:"#A5B4FC"},Combined:{bg:"#F3E8FF",text:"#6B21A8",border:"#DDD6FE"},Yes:{bg:"#DCFCE7",text:"#166534",border:"#86EFAC"},No:{bg:"#FEF3C7",text:"#92400E",border:"#FCD34D"},"Not Yet":{bg:"#F1F5F9",text:"#475569",border:"#CBD5E1"},Pending:{bg:"#FEF3C7",text:"#92400E",border:"#FCD34D"},Sent:{bg:"#D1FAE5",text:"#065F46",border:"#6EE7B7"}})[t]||{bg:"#F1F5F9",text:"#475569",border:"#CBD5E1"},gm=({status:t,small:e=!1})=>{const r=FH(t);return c.jsx("span",{style:{display:"inline-flex",alignItems:"center",padding:e?"2px 8px":"4px 12px",borderRadius:"6px",fontSize:e?"11px":"12px",fontWeight:"600",backgroundColor:r.bg,color:r.text,border:`1px solid ${r.border}`},children:t})},ze=({icon:t,label:e,onClick:r,variant:n="default",disabled:i=!1,small:s=!1})=>{const a={default:{bg:"#F8FAFC",hoverBg:"#E2E8F0",text:"#475569",border:"#CBD5E1"},primary:{bg:"#2874A6",hoverBg:"#1a5276",text:"#FFFFFF",border:"#2874A6"},success:{bg:"#059669",hoverBg:"#047857",text:"#FFFFFF",border:"#059669"},warning:{bg:"#D97706",hoverBg:"#B45309",text:"#FFFFFF",border:"#D97706"},danger:{bg:"#DC2626",hoverBg:"#B91C1C",text:"#FFFFFF",border:"#DC2626"},brand:{bg:"#2874A6",hoverBg:"#1a5276",text:"#FFFFFF",border:"#2874A6"},purple:{bg:"#7C3AED",hoverBg:"#6D28D9",text:"#FFFFFF",border:"#7C3AED"},secondary:{bg:"#F1F5F9",hoverBg:"#E2E8F0",text:"#475569",border:"#CBD5E1"}},o=a[n]||a.default;return c.jsxs("button",{onClick:r,disabled:i,title:e,style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:s?"5px 10px":"8px 14px",borderRadius:"6px",fontSize:s?"11px":"13px",fontWeight:"600",backgroundColor:i?"#F1F5F9":o.bg,color:i?"#94A3B8":o.text,border:`1px solid ${i?"#E2E8F0":o.border}`,cursor:i?"not-allowed":"pointer",transition:"all 0.15s ease",whiteSpace:"nowrap",opacity:i?.6:1},onMouseEnter:l=>!i&&(l.target.style.backgroundColor=o.hoverBg),onMouseLeave:l=>!i&&(l.target.style.backgroundColor=o.bg),children:[t&&c.jsx(t,{size:s?14:16}),e&&c.jsx("span",{children:e})]})},Or=({label:t,type:e="text",value:r,onChange:n,placeholder:i,disabled:s,small:a})=>c.jsxs("div",{style:{marginBottom:a?"12px":"16px"},children:[t&&c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:t}),c.jsx("input",{type:e,value:r,onChange:n,placeholder:i,disabled:s,style:{width:"100%",padding:a?"8px 12px":"10px 14px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:a?"13px":"14px",backgroundColor:s?"#F9FAFB":"#FFFFFF",boxSizing:"border-box"}})]}),rh=({label:t,value:e,onChange:r,options:n,small:i})=>c.jsxs("div",{style:{marginBottom:i?"12px":"16px"},children:[t&&c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:t}),c.jsx("select",{value:e,onChange:r,style:{width:"100%",padding:i?"8px 12px":"10px 14px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:i?"13px":"14px",backgroundColor:"#FFFFFF",boxSizing:"border-box"},children:n.map(s=>c.jsx("option",{value:s.value,children:s.label},s.value))})]}),pn=({title:t,children:e,actions:r,noPadding:n=!1})=>c.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",boxShadow:"0 2px 8px rgba(0,0,0,0.06)",overflow:"hidden"},children:[t&&c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"14px 20px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FAFBFC"},children:[c.jsx("h3",{style:{margin:0,fontSize:"15px",fontWeight:"700",color:"#1E293B"},children:t}),r&&c.jsx("div",{style:{display:"flex",gap:"10px"},children:r})]}),c.jsx("div",{style:{padding:n?0:"20px"},children:e})]}),Mn=({isOpen:t,onClose:e,title:r,children:n,width:i="500px"})=>t?c.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(15, 23, 42, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(4px)"},onClick:e,children:c.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"16px",width:i,maxWidth:"95vw",maxHeight:"90vh",overflow:"hidden",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},onClick:s=>s.stopPropagation(),children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FAFBFC"},children:[c.jsx("h2",{style:{margin:0,fontSize:"16px",fontWeight:"700",color:"#1E293B"},children:r}),c.jsx("button",{onClick:e,style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748B"},children:c.jsx(_a,{size:20})})]}),c.jsx("div",{style:{padding:"20px",maxHeight:"calc(90vh - 100px)",overflowY:"auto"},children:n})]})}):null;function bH(){const[t,e]=ye.useState(()=>{const h=localStorage.getItem("financeAppLogin");return h?JSON.parse(h).isLoggedIn:!1}),[r,n]=ye.useState(()=>{const h=localStorage.getItem("financeAppLogin");return h?JSON.parse(h).userRole:null}),[i,s]=ye.useState({username:"",password:""}),[a,o]=ye.useState(""),[l,u]=ye.useState(!1),[f,p]=ye.useState(!1),[g,m]=ye.useState(null),[y,x]=ye.useState({finance:"finance123",director:"director123"}),[S,A]=ye.useState(!1),[k,E]=ye.useState(!1),[P,Y]=ye.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[W,T]=ye.useState(""),F={finance:{role:"finance",name:"Finance Team"},director:{role:"director",name:"Director"}};ye.useEffect(()=>{(async()=>{try{const _=await mS("indreesh-media");_&&_.userPasswords&&(x(_.userPasswords),console.log("Passwords loaded from Firebase"))}catch(_){console.error("Error loading passwords:",_)}A(!0)})()},[]);const[w,I]=ye.useState({name:"Indreesh Media LLP",brand:"JAC",address:"A-1701 Sweet Home CHS LTD, SVP, Plot No: 24",addressLine2:"Andheri West, Nr Last Bus St",city:"Mumbai-400053",gstin:"27AAIFI6351A1ZM",stateCode:"27",stateName:"Maharashtra",email:"alliances@mediabrief.com",phone:"+91 7021911036",website:"www.mediabrief.com",pan:"AAIFI6351A",bank:{name:"Axis Bank",account:"921020009075531",branch:"Andheri",ifsc:"UTIB0000020",holder:"Indreesh Media LLP"},invoicePrefix:"MB/2025-26/",hsnCode:"998365",gstRate:18}),[R,D]=ye.useState("master"),[N,Ge]=ye.useState(!1),[Ee,Pe]=ye.useState([]),[Ie,Ce]=ye.useState([]),[se,be]=ye.useState([]),[Be,G]=ye.useState([]),[ne,ie]=ye.useState([]),[X,ve]=ye.useState(null),[Se,Le]=ye.useState(null),[Ne,ke]=ye.useState(1),[rt,ee]=ye.useState(1),[Dt,Et]=ye.useState(1),[Nt,xt]=ye.useState(1),[He,fr]=ye.useState(1),[Wn,Zr]=ye.useState(!1),[Ii,Xi]=ye.useState(!1),[Ni,en]=ye.useState(!1),[Ri,nr]=ye.useState(!1),[Br,Ar]=ye.useState(!1),[_i,pt]=ye.useState(!1),[Cr,Sr]=ye.useState(!1),[Dr,Ei]=ye.useState(!1),[vo,Pa]=ye.useState(!1),[Wu,Vs]=ye.useState(!1),[_l,zs]=ye.useState(!1),[ce,hr]=ye.useState(null),[Di,gs]=ye.useState("reply"),[Oa,Ws]=ye.useState(""),[ua,Pi]=ye.useState(""),[yn,un]=ye.useState({fromDate:"2020-01-01",toDate:new Date().toISOString().split("T")[0]}),[Ma,Hs]=ye.useState(""),[_n,xc]=ye.useState("open"),[qi,b]=ye.useState("open"),[K,L]=ye.useState(!1),[U,q]=ye.useState(null),[Q,de]=ye.useState(new Set),[me,fe]=ye.useState({party:"",billStatus:"",invoiceStatus:""}),[le,pe]=ye.useState({party:"",invoiceNo:"",dateFrom:"",dateTo:""}),[we,Ue]=ye.useState({party:"",invoiceStatus:"",receiptStatus:"",invoiceType:"",searchText:""}),[Ke,De]=ye.useState([]),[qe,dt]=ye.useState(!1),[Pt,Ut]=ye.useState([]),[wr,Oi]=ye.useState(!1),[pr,ms]=ye.useState(null),[jr,xs]=ye.useState({date:new Date().toISOString().split("T")[0],notes:"",nextFollowupDate:"",status:"Pending"}),[st,$s]=ye.useState({enabled:!1,financePhone:"",financeApiKey:"",directorPhone:"",directorApiKey:""}),[Vt,Mi]=ye.useState({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),[En,Ba]=ye.useState({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]}),[ja,da]=ye.useState({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1}),[vc,Gs]=ye.useState(null),[Sn,fa]=ye.useState(new Set),[tn,yo]=ye.useState({}),[Ot,La]=ye.useState(null),[vs,Bi]=ye.useState(null),[Hu,Ua]=ye.useState(!1),[Hn,yc]=ye.useState({}),[ji,_c]=ye.useState({partyName:"",amount:"",type:"Dr"}),[$n,ys]=ye.useState({}),[rn,El]=ye.useState({}),[s0,Ks]=ye.useState(!1),[a0,$u]=ye.useState(new Set),[vt,Li]=ye.useState({party:"",billStatus:"",invoiceStatus:"",mailingStatus:"",invoiceType:"",combinationCode:"",searchText:""}),[Pr,_o]=ye.useState({amount:"",date:new Date().toISOString().split("T")[0],mode:"Bank",tds:"",discount:"",narration:""}),Sl=ye.useRef(null),wl=ye.useRef(null),Gu=ye.useRef(null),Va=ye.useRef(null),Eo=ye.useRef(null),Ku=ye.useRef(null),Ec=ye.useRef(null),gr=ye.useRef(null),o0=ye.useRef(null),l0=ye.useRef(null),wn=ye.useMemo(()=>Array.isArray(Ee)?Ee:[],[Ee]),nn=ye.useMemo(()=>Array.isArray(Ie)?Ie:[],[Ie]),Gn=ye.useMemo(()=>Array.isArray(se)?se:[],[se]),Rn=ye.useMemo(()=>Array.isArray(Be)?Be:[],[Be]),Si=ye.useMemo(()=>Array.isArray(ne)?ne:[],[ne]),_s=ye.useMemo(()=>Array.isArray(Ke)?Ke:[],[Ke]),Tl=ye.useMemo(()=>Array.isArray(Pt)?Pt:[],[Pt]),Wt=ye.useMemo(()=>rn&&typeof rn=="object"&&!Array.isArray(rn)?rn:{},[rn]),Es=ye.useMemo(()=>Hn&&typeof Hn=="object"&&!Array.isArray(Hn)?Hn:{},[Hn]),Jt=(h,_)=>!h||!_?!1:h.trim().toUpperCase()===_.trim().toUpperCase(),Kn=ye.useCallback(h=>{if(!h)return"";const _=h.toUpperCase().trim();return _.includes("MAHARASHTRA")||_==="MH"?"MAHARASHTRA":_.includes("DELHI")||_==="DL"||_.includes("NEW DELHI")?"DELHI":_.includes("KARNATAKA")||_==="KA"||_.includes("BANGALORE")||_.includes("BENGALURU")?"KARNATAKA":_.includes("TAMIL")||_==="TN"||_.includes("CHENNAI")?"TAMIL NADU":_.includes("TELANGANA")||_==="TG"||_==="TS"||_.includes("HYDERABAD")?"TELANGANA":_.includes("UTTAR PRADESH")||_==="UP"||_.includes("NOIDA")||_.includes("LUCKNOW")?"UTTAR PRADESH":_.includes("WEST BENGAL")||_==="WB"||_.includes("KOLKATA")?"WEST BENGAL":_.includes("GUJARAT")||_==="GJ"||_.includes("AHMEDABAD")?"GUJARAT":_.includes("RAJASTHAN")||_==="RJ"||_.includes("JAIPUR")?"RAJASTHAN":_.includes("PUNJAB")||_==="PB"?"PUNJAB":_.includes("HARYANA")||_==="HR"||_.includes("GURGAON")||_.includes("GURUGRAM")?"HARYANA":_.includes("MADHYA PRADESH")||_==="MP"||_.includes("BHOPAL")?"MADHYA PRADESH":_.includes("ANDHRA")||_==="AP"?"ANDHRA PRADESH":_.includes("KERALA")||_==="KL"?"KERALA":_.includes("ODISHA")||_.includes("ORISSA")||_==="OR"||_==="OD"?"ODISHA":_.includes("BIHAR")||_==="BR"?"BIHAR":_.includes("JHARKHAND")||_==="JH"?"JHARKHAND":_.includes("ASSAM")||_==="AS"?"ASSAM":_.includes("CHHATTISGARH")||_==="CG"?"CHHATTISGARH":_.includes("GOA")||_==="GA"?"GOA":_.includes("HIMACHAL")||_==="HP"?"HIMACHAL PRADESH":_.includes("JAMMU")||_==="JK"?"JAMMU AND KASHMIR":_.includes("UTTARAKHAND")||_.includes("UTTARANCHAL")||_==="UK"?"UTTARAKHAND":_.includes("MUMBAI")?"MAHARASHTRA":_.includes("CHANDIGARH")?"CHANDIGARH":_},[]),So=ye.useCallback((h,_)=>{var H;if(!h)return"";const V=Kn(_),Z=h.trim().toUpperCase(),B=`${Z}|${V}`;if((H=Wt[B])!=null&&H.gstin)return Wt[B].gstin;for(const M in Wt){const O=Wt[M];if((O.partyName||"").trim().toUpperCase()===Z&&O.normalizedState===V)return O.gstin||""}for(const M in Wt){const O=Wt[M];if((O.partyName||"").trim().toUpperCase()===Z&&O.gstin)return O.gstin}return""},[Wt,Kn]),Al=ye.useCallback((h,_)=>{var H;if(!h)return"";const V=Kn(_),Z=h.trim().toUpperCase(),B=`${Z}|${V}`;if((H=Wt[B])!=null&&H.address)return Wt[B].address;for(const M in Wt){const O=Wt[M];if((O.partyName||"").trim().toUpperCase()===Z&&O.normalizedState===V)return O.address||""}for(const M in Wt){const O=Wt[M];if((O.partyName||"").trim().toUpperCase()===Z&&O.address)return O.address}return""},[Wt,Kn]),Dn=ye.useCallback((h,_,V="")=>{var M,O;if(V&&((M=Wt[V])!=null&&M.clientCode))return Wt[V].clientCode;if(!h)return"";const Z=Kn(_),B=h.trim().toUpperCase(),H=`${B}|${Z}`;if((O=Wt[H])!=null&&O.clientCode)return Wt[H].clientCode;for(const ae in Wt){const te=Wt[ae];if((te.partyName||"").trim().toUpperCase()===B&&te.normalizedState===Z)return te.clientCode||""}for(const ae in Wt){const te=Wt[ae];if((te.partyName||"").trim().toUpperCase()===B&&te.clientCode)return te.clientCode}return""},[Wt,Kn]);ye.useCallback(h=>{if(!h)return null;if(Wt[h])return Wt[h];for(const _ in Wt){const V=Wt[_];if(V.clientCode===h)return V}return null},[Wt]);const wo=ye.useRef(!1),ha=ye.useRef(null),To=async()=>{u(!0);try{const h=await mS("indreesh-media");h&&(Array.isArray(h.masterData)&&Pe(h.masterData),Array.isArray(h.servicesData)&&Ce(h.servicesData),Array.isArray(h.ledgerEntries)&&be(h.ledgerEntries),Array.isArray(h.receipts)&&G(h.receipts),Array.isArray(h.creditNotes)&&ie(h.creditNotes),Array.isArray(h.notifications)&&De(h.notifications),Array.isArray(h.followups)&&Ut(h.followups),h.openingBalances&&typeof h.openingBalances=="object"&&!Array.isArray(h.openingBalances)&&yc(h.openingBalances),h.mailerImages&&typeof h.mailerImages=="object"&&!Array.isArray(h.mailerImages)&&yo(h.mailerImages),h.partyMaster&&typeof h.partyMaster=="object"&&!Array.isArray(h.partyMaster)&&El(h.partyMaster),h.userPasswords&&typeof h.userPasswords=="object"&&!Array.isArray(h.userPasswords)&&x(h.userPasswords),h.mailerLogo&&La(h.mailerLogo),h.companyConfig&&I(_=>({..._,...h.companyConfig,name:"Indreesh Media LLP",bank:{...h.companyConfig.bank||_.bank,holder:"Indreesh Media LLP"}})),h.nextInvoiceNo&&ke(h.nextInvoiceNo),h.nextCombineNo&&ee(h.nextCombineNo),h.nextReceiptNo&&Et(h.nextReceiptNo),h.nextCreditNoteNo&&xt(h.nextCreditNoteNo),h.nextServiceInvoiceNo&&fr(h.nextServiceInvoiceNo),h.invoiceValues&&ys(h.invoiceValues),h.whatsappSettings&&$s(_=>({..._,...h.whatsappSettings})),console.log("Data loaded from Firebase"))}catch(h){console.error("Error loading data:",h)}u(!1)},Yu=ye.useCallback(async()=>{p(!0);try{console.log("Saving to Firebase:",{masterDataCount:Ee==null?void 0:Ee.length,servicesDataCount:Ie==null?void 0:Ie.length,servicesDataSample:Ie==null?void 0:Ie.slice(0,1),receiptsCount:Be==null?void 0:Be.length,creditNotesCount:ne==null?void 0:ne.length}),await hd("indreesh-media",{masterData:Ee,servicesData:Ie,ledgerEntries:se,receipts:Be,creditNotes:ne,openingBalances:Hn,mailerImages:tn,mailerLogo:Ot,companyConfig:w,nextInvoiceNo:Ne,nextCombineNo:rt,nextReceiptNo:Dt,nextCreditNoteNo:Nt,nextServiceInvoiceNo:He,invoiceValues:$n,notifications:Ke,whatsappSettings:st,partyMaster:rn,followups:Pt,userPasswords:y}),m(new Date),console.log("Data saved to Firebase successfully")}catch(h){console.error("Error saving data:",h)}p(!1)},[Ee,Ie,se,Be,ne,Hn,tn,Ot,w,Ne,rt,Dt,Nt,He,$n,Ke,st,rn,Pt,y]);ye.useEffect(()=>{if(t&&!wo.current)return gr.current&&clearTimeout(gr.current),gr.current=setTimeout(()=>{wo.current||Yu()},1e3),()=>{gr.current&&clearTimeout(gr.current)}},[Ee,Ie,se,Be,ne,Hn,tn,Ot,w,Ne,rt,Dt,Nt,He,$n,Ke,st,rn,Pt,y,t]);const c0=async(h,_,V)=>{if(!st.enabled){console.log("WhatsApp notifications not enabled");return}V==="finance"&&st.financePhone&&st.financeApiKey?za(st.financePhone,st.financeApiKey,h,_):V==="director"&&st.directorPhone&&st.directorApiKey?za(st.directorPhone,st.directorApiKey,h,_):V==="all"&&(st.financePhone&&st.financeApiKey&&za(st.financePhone,st.financeApiKey,h,_),st.directorPhone&&st.directorApiKey&&za(st.directorPhone,st.directorApiKey,h,_))},za=async(h,_,V,Z)=>{try{const H=`*${{upload:" DATA UPLOAD",invoice:" INVOICE",approval:" APPROVED",edit:" EDIT REQUIRED",receipt:" PAYMENT",info:" UPDATE"}[V]||" NOTIFICATION"}*

${Z}

_${w.name}_
_${new Date().toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})}_`,M=`https://api.callmebot.com/whatsapp.php?phone=${h}&text=${encodeURIComponent(H)}&apikey=${_}`;fetch(M,{mode:"no-cors"}).then(()=>console.log("WhatsApp notification sent to:",h)).catch(O=>console.log("WhatsApp send attempted:",h))}catch(B){console.error("Failed to send WhatsApp notification:",B)}},Sc=(h,_)=>{if(!h||!_){alert("Please enter phone number and API key first");return}za(h,_,"info","Test notification from Indreesh Media LLP. WhatsApp notifications are working!"),alert("Test message sent! Check your WhatsApp.")},Qi=(h,_,V="all")=>{const Z={id:Date.now()+Math.random(),type:h,message:_,forRole:V,createdAt:new Date().toISOString(),createdBy:r,read:{finance:!1,director:!1}};De(B=>[Z,...B].slice(0,50)),c0(h,_,V)},wc=h=>{De(_=>(Array.isArray(_)?_:[]).map(Z=>Z.id===h?{...Z,read:{...Z.read,[r]:!0}}:Z))},u0=()=>{De(h=>(Array.isArray(h)?h:[]).map(V=>({...V,read:{...V.read,[r]:!0}})))},d0=()=>{De([])},Ss=ye.useMemo(()=>_s.filter(h=>h.forRole==="all"||h.forRole===r||h.createdBy!==r).map(h=>({...h,read:h.read||{finance:!1,director:!1}})),[_s,r]),ws=ye.useMemo(()=>r?Ss.filter(h=>!(h.read&&h.read[r])).length:0,[Ss,r]),Xu=async()=>{const h=F[i.username.toLowerCase()],_=y[i.username.toLowerCase()];h&&_===i.password?(e(!0),n(h.role),localStorage.setItem("financeAppLogin",JSON.stringify({isLoggedIn:!0,userRole:h.role})),o(""),s({username:"",password:""}),await To()):o("Invalid username or password")},Tc=async()=>{if(!P.currentPassword||!P.newPassword||!P.confirmPassword){T("Please fill all fields");return}const h=r==="director"?"director":"finance";if(y[h]!==P.currentPassword){T("Current password is incorrect");return}if(P.newPassword!==P.confirmPassword){T("New passwords do not match");return}if(P.newPassword.length<6){T("Password must be at least 6 characters");return}const _={...y,[h]:P.newPassword};x(_);try{await hd("indreesh-media",{masterData:Ee,ledgerEntries:se,receipts:Be,creditNotes:ne,openingBalances:Hn,mailerImages:tn,mailerLogo:Ot,companyConfig:w,nextInvoiceNo:Ne,nextCombineNo:rt,nextReceiptNo:Dt,nextCreditNoteNo:Nt,invoiceValues:$n,notifications:Ke,whatsappSettings:st,partyMaster:rn,followups:Pt,userPasswords:_}),console.log("Password saved to Firebase")}catch(V){console.error("Error saving password:",V),T("Failed to save password. Please try again.");return}E(!1),Y({currentPassword:"",newPassword:"",confirmPassword:""}),T(""),alert(" Password changed successfully!")},f0=()=>{Yu(),e(!1),n(null),D("master"),localStorage.removeItem("financeAppLogin")};ye.useEffect(()=>{const h=localStorage.getItem("financeAppLogin");if(h){const{isLoggedIn:_}=JSON.parse(h);_&&To()}},[]),ye.useEffect(()=>{if(!t){ha.current&&(ha.current(),ha.current=null);return}return ha.current=AH("indreesh-media",h=>{h&&(console.log("Firebase data received:",{hasMasterData:Array.isArray(h.masterData)?h.masterData.length:"not array",hasServicesData:Array.isArray(h.servicesData)?h.servicesData.length:"not array",servicesDataRaw:h.servicesData,hasReceipts:Array.isArray(h.receipts)?h.receipts.length:"not array",hasCreditNotes:Array.isArray(h.creditNotes)?h.creditNotes.length:"not array"}),wo.current=!0,Array.isArray(h.masterData)&&Pe(h.masterData),Array.isArray(h.servicesData)&&Ce(h.servicesData),Array.isArray(h.ledgerEntries)&&be(h.ledgerEntries),Array.isArray(h.receipts)&&G(h.receipts),Array.isArray(h.creditNotes)&&ie(h.creditNotes),Array.isArray(h.notifications)&&De(h.notifications),Array.isArray(h.followups)&&Ut(h.followups),h.openingBalances&&typeof h.openingBalances=="object"&&!Array.isArray(h.openingBalances)&&yc(h.openingBalances),h.mailerImages&&typeof h.mailerImages=="object"&&!Array.isArray(h.mailerImages)&&yo(h.mailerImages),h.partyMaster&&typeof h.partyMaster=="object"&&!Array.isArray(h.partyMaster)&&El(h.partyMaster),h.userPasswords&&typeof h.userPasswords=="object"&&!Array.isArray(h.userPasswords)&&x(h.userPasswords),h.mailerLogo&&La(h.mailerLogo),h.companyConfig&&I(_=>({..._,...h.companyConfig,name:"Indreesh Media LLP",bank:{...h.companyConfig.bank||_.bank,holder:"Indreesh Media LLP"}})),h.nextInvoiceNo&&ke(h.nextInvoiceNo),h.nextCombineNo&&ee(h.nextCombineNo),h.nextReceiptNo&&Et(h.nextReceiptNo),h.nextCreditNoteNo&&xt(h.nextCreditNoteNo),h.nextServiceInvoiceNo&&fr(h.nextServiceInvoiceNo),h.invoiceValues&&ys(h.invoiceValues),h.whatsappSettings&&$s(_=>({..._,...h.whatsappSettings})),setTimeout(()=>{wo.current=!1},500),console.log("Real-time sync: Data updated from Firebase"))}),()=>{ha.current&&(ha.current(),ha.current=null)}},[t]),ye.useEffect(()=>{if(nn.length>0){const h=new Set(nn.map(_=>_.partyName).filter(Boolean));de(_=>_.size===0||_.size!==h.size?h:_)}},[nn]);const sr=r==="finance",yr=r==="director",Cl=ye.useMemo(()=>{const h=new Set;return wn.forEach(_=>{_.partyName&&h.add(_.partyName)}),Object.values(Wt).forEach(_=>{_.partyName&&h.add(_.partyName)}),Gn.forEach(_=>{_.partyName&&h.add(_.partyName)}),Object.keys(Es).forEach(_=>{_&&h.add(_)}),Array.from(h).filter(Boolean).sort()},[wn,Wt,Gn,Es]),Ji=ye.useMemo(()=>{const h=[],_=new Set,V=new Set,Z=B=>{if(!B)return"";const H=B.toUpperCase().trim();return H.includes("MAHARASHTRA")||H==="MH"||H.includes("MUMBAI")?"MAHARASHTRA":H.includes("DELHI")||H==="DL"||H.includes("NEW DELHI")?"DELHI":H.includes("KARNATAKA")||H==="KA"||H.includes("BANGALORE")||H.includes("BENGALURU")?"KARNATAKA":H.includes("TAMIL")||H==="TN"||H.includes("CHENNAI")?"TAMIL NADU":H.includes("TELANGANA")||H==="TG"||H==="TS"||H.includes("HYDERABAD")?"TELANGANA":H.includes("UTTAR PRADESH")||H==="UP"||H.includes("NOIDA")||H.includes("LUCKNOW")?"UTTAR PRADESH":H.includes("WEST BENGAL")||H==="WB"||H.includes("KOLKATA")?"WEST BENGAL":H.includes("GUJARAT")||H==="GJ"||H.includes("AHMEDABAD")?"GUJARAT":H.includes("RAJASTHAN")||H==="RJ"||H.includes("JAIPUR")?"RAJASTHAN":H.includes("PUNJAB")||H==="PB"?"PUNJAB":H.includes("HARYANA")||H==="HR"||H.includes("GURGAON")||H.includes("GURUGRAM")?"HARYANA":H.includes("MADHYA PRADESH")||H==="MP"||H.includes("BHOPAL")?"MADHYA PRADESH":H.includes("ANDHRA")||H==="AP"?"ANDHRA PRADESH":H.includes("KERALA")||H==="KL"?"KERALA":H.includes("ODISHA")||H.includes("ORISSA")||H==="OR"||H==="OD"?"ODISHA":H.includes("BIHAR")||H==="BR"?"BIHAR":H.includes("JHARKHAND")||H==="JH"?"JHARKHAND":H.includes("ASSAM")||H==="AS"?"ASSAM":H.includes("CHHATTISGARH")||H==="CG"?"CHHATTISGARH":H.includes("GOA")||H==="GA"?"GOA":H.includes("HIMACHAL")||H==="HP"?"HIMACHAL PRADESH":H.includes("JAMMU")||H==="JK"?"JAMMU AND KASHMIR":H.includes("UTTARAKHAND")||H.includes("UTTARANCHAL")||H==="UK"?"UTTARAKHAND":H.includes("CHANDIGARH")?"CHANDIGARH":H};return Object.entries(Wt).forEach(([B,H])=>{if(H.partyName){const M=H.normalizedState||Z(H.stateName),O=H.partyName.trim().toUpperCase(),ae=`${O}|${M}`;_.has(ae)||(_.add(ae),V.add(O),h.push({partyName:H.partyName,partyNameUpper:O,state:H.stateName||"",normalizedState:M,gstin:H.gstin||"",address:H.address||"",fromPartyMaster:!0}))}}),wn.forEach(B=>{if(B.partyName){const H=B.partyName.trim().toUpperCase(),M=Z(B.statePartyDetails),O=`${H}|${M}`;_.has(O)||(_.add(O),V.add(H),h.push({partyName:B.partyName,partyNameUpper:H,state:B.statePartyDetails||"",normalizedState:M,gstin:"",address:"",fromPartyMaster:!1}))}}),Gn.forEach(B=>{if(B.partyName){const H=B.partyName.trim().toUpperCase(),M=Z(B.state||B.statePartyDetails||""),O=`${H}|${M}`;_.has(O)||(_.add(O),V.add(H),h.push({partyName:B.partyName,partyNameUpper:H,state:B.state||B.statePartyDetails||"",normalizedState:M,gstin:"",address:"",fromPartyMaster:!1}))}}),Object.keys(Es).forEach(B=>{const H=B.trim().toUpperCase();B&&!V.has(H)&&(V.add(H),h.push({partyName:B,partyNameUpper:H,state:"",normalizedState:"",gstin:"",address:"",fromPartyMaster:!1}))}),nn.forEach(B=>{if(B.partyName){const H=B.partyName.trim().toUpperCase(),M=Z(B.statePartyDetails),O=`${H}|${M}`;_.has(O)||(_.add(O),V.add(H),h.push({partyName:B.partyName,partyNameUpper:H,state:B.statePartyDetails||"",normalizedState:M,gstin:B.gstin||"",address:B.address||"",fromPartyMaster:!1}))}}),h.sort((B,H)=>B.partyName.localeCompare(H.partyName))},[wn,nn,Wt,Gn,Es]);ye.useMemo(()=>[...new Set(wn.filter(_=>_.combinationCode&&_.combinationCode!=="NA").map(_=>_.combinationCode))].sort((_,V)=>parseInt(_)-parseInt(V)),[wn]);const pa=ye.useMemo(()=>wn.filter(h=>{var _,V,Z,B,H,M;if(vt.party&&h.partyName!==vt.party||vt.billStatus&&h.toBeBilled!==vt.billStatus||vt.invoiceStatus&&(vt.invoiceStatus==="Generated"&&!h.invoiceGenerated||vt.invoiceStatus==="Not Generated"&&h.invoiceGenerated||vt.invoiceStatus==="Paid"&&h.invoiceStatus!=="Paid")||vt.mailingStatus&&h.mailingSent!==vt.mailingStatus||vt.invoiceType&&h.invoiceType!==vt.invoiceType||vt.combinationCode&&h.combinationCode!==vt.combinationCode)return!1;if(vt.searchText){const O=vt.searchText.toLowerCase();if(!(((_=h.senderName)==null?void 0:_.toLowerCase().includes(O))||((V=h.subject)==null?void 0:V.toLowerCase().includes(O))||((Z=h.campaignName)==null?void 0:Z.toLowerCase().includes(O))||((B=h.invoiceNo)==null?void 0:B.toLowerCase().includes(O))||((H=h.partyName)==null?void 0:H.toLowerCase().includes(O))||((M=h.emailId)==null?void 0:M.toLowerCase().includes(O))))return!1}return!0}),[wn,vt]);ye.useMemo(()=>{const h={};return pa.forEach(_=>{h[_.partyName]||(h[_.partyName]=[]),h[_.partyName].push(_)}),Object.keys(h).forEach(_=>{h[_].sort((V,Z)=>V.toBeBilled==="Yes"&&Z.toBeBilled!=="Yes"?-1:V.toBeBilled!=="Yes"&&Z.toBeBilled==="Yes"?1:0)}),h},[pa]),ye.useMemo(()=>{if(!X)return[];const h=Es[X]||0;let _=h;const V=Gn.filter(Z=>Jt(Z.partyName,X)).sort((Z,B)=>new Date(Z.date)-new Date(B.date)).map(Z=>(_=_+Z.debit-Z.credit,{...Z,balance:_}));return h!==0?[{id:"opening",date:"",particulars:"Opening Balance",debit:h>0?h:0,credit:h<0?Math.abs(h):0,balance:h,isOpening:!0},...V]:V},[X,Gn,Es]);const d=h=>wn.filter(_=>Jt(_.partyName,h)&&_.toBeBilled==="Yes"&&!_.invoiceGenerated&&_.invoiceAmount),v=h=>!h||h==="NA"?!1:wn.some(_=>_.combinationCode===h&&_.mailingSent==="Yes"),C=h=>h.invoiceType==="Combined"&&h.combinationCode!=="NA"?wn.filter(_=>_.combinationCode===h.combinationCode):[h],j=()=>{Li({party:"",billStatus:"",invoiceStatus:"",mailingStatus:"",invoiceType:"",combinationCode:"",searchText:""})},ue=Object.values(vt).some(h=>h!==""),xe=h=>{const _=[];return h.emailId&&_.push(h.emailId),h.additionalEmails&&h.additionalEmails.length>0&&_.push(...h.additionalEmails),_},$e=(h,_)=>{!_||!_.includes("@")||Pe(V=>V.map(Z=>{if(Z.id===h){const B=Z.additionalEmails||[];if(!B.includes(_)&&_!==Z.emailId)return{...Z,additionalEmails:[...B,_]}}return Z}))},ar=(h,_)=>{Pe(V=>V.map(Z=>Z.id===h?{...Z,additionalEmails:(Z.additionalEmails||[]).filter(B=>B!==_)}:Z))},dn=h=>{hr(h),Pi(h.editComments||h.approvalRemarks||""),da({particularsApproved:h.particularsApproved||!1,emailApproved:h.emailApproved||!1,invoiceTypeApproved:h.invoiceTypeApproved||!1}),Sr(!0)},Ht=()=>{if(!ce)return;if(!ja.particularsApproved||!ja.emailApproved||!ja.invoiceTypeApproved){alert("Please confirm all approval checkboxes before approving.");return}const h={invoiceStatus:"Approved",approvalRemarks:ua.trim()||"",editComments:"",particularsApproved:!0,emailApproved:!0,invoiceTypeApproved:!0,approvedBy:r,approvedDate:new Date().toISOString()};if(ce.isService){Ce(B=>B.map(H=>H.id===ce.id?{...H,...h}:H));const V=parseFloat(ce.invoiceTotalAmount)||0,Z=`${ce.invoiceNo} - ${ce.serviceType||"Service"}`;be(B=>[...B,{id:Date.now(),partyName:ce.partyName,date:ce.invoiceDate,particulars:ce.serviceType||"Service",narration:Z,debit:V,credit:0,type:"invoice",invoiceNo:ce.invoiceNo}])}else{let V=[];ce.invoiceType==="Combined"&&ce.combinationCode!=="NA"?(V=Ee.filter(M=>M.combinationCode===ce.combinationCode),Pe(M=>M.map(O=>O.combinationCode===ce.combinationCode?{...O,...h}:O))):(V=[ce],Pe(M=>M.map(O=>O.id===ce.id?{...O,...h}:O)));const Z=parseFloat(ce.invoiceTotalAmount)||0,B=V.map(M=>{var O,ae;return M.senderName||((ae=(O=M.campaignName)==null?void 0:O.split("--")[0])==null?void 0:ae.trim())}).join(", "),H=`${ce.invoiceNo} - ${B}`;be(M=>[...M,{id:Date.now(),partyName:ce.partyName,date:ce.invoiceDate,particulars:"Promotional Trade Mailer",narration:H,debit:Z,credit:0,type:"invoice",invoiceNo:ce.invoiceNo,combinationCode:ce.combinationCode}])}const _=ua.trim()?` | Remarks: "${ua.trim()}"`:"";Qi("approval",` Invoice ${ce.invoiceNo} has been APPROVED by Director${_} - ready for mailing`,"finance"),Sr(!1),hr(null),da({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1}),Pi(""),alert(` Invoice Approved!

The invoice is now ready for mailing.`)},Pn=()=>{if(!ce)return;const h=ua.trim();ce.isService?Ce(V=>V.map(Z=>Z.id===ce.id?{...Z,invoiceStatus:"Need Edits",editComments:h,approvalRemarks:""}:Z)):ce.invoiceType==="Combined"&&ce.combinationCode!=="NA"?Pe(V=>V.map(Z=>Z.combinationCode===ce.combinationCode?{...Z,invoiceStatus:"Need Edits",editComments:h,approvalRemarks:""}:Z)):Pe(V=>V.map(Z=>Z.id===ce.id?{...Z,invoiceStatus:"Need Edits",editComments:h,approvalRemarks:""}:Z));const _=h?`: "${h}"`:"";Qi("edit",` Invoice ${ce.invoiceNo} marked as NEED EDITS by Director${_}`,"finance"),Sr(!1),hr(null),Pi("")},Tn=h=>{hr(h);const _=parseFloat(h.invoiceTotalAmount)||0;Mi({amount:_.toFixed(2),tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),Pa(!0)},Ao=()=>{if(!ce||!Vt.amount){alert("Please enter receipt amount");return}if(ce.invoiceStatus!=="Approved"){alert("Receipt cannot be posted. Invoice must be approved first.");return}if(!ce.isHistorical&&ce.mailingSent!=="Yes"){alert("Receipt cannot be posted. Invoice must be mailed first.");return}const h=`RCP/${new Date().getFullYear()}-${String(new Date().getFullYear()+1).slice(-2)}/${Dt}`,_=parseFloat(Vt.amount)||0,V=parseFloat(Vt.tds)||0,Z=parseFloat(Vt.discount)||0,B=_+V+Z,H=C(ce),M=H.map(ge=>ge.subject||ge.senderName).join(", "),O=M.length>50?M.substring(0,47)+"...":M,ae={id:Date.now(),receiptNo:h,invoiceNo:ce.invoiceNo,partyName:ce.partyName,date:Vt.date,amount:_,tds:V,discount:Z,totalCredit:B,narration:Vt.narration,paymentAdvisory:Vt.paymentAdvisory,mode:Vt.mode,campaigns:H.map(ge=>({senderName:ge.senderName,subject:ge.subject}))};G(ge=>[...ge,ae]);const te=Vt.narration||O;_>0&&be(ge=>[...ge,{id:Date.now(),partyName:ce.partyName,date:Vt.date,particulars:`Payment Received - ${te}`,narration:`${ce.invoiceNo} | ${Vt.mode}`,debit:0,credit:_,type:"receipt",receiptNo:h,invoiceNo:ce.invoiceNo,paymentAdvisory:Vt.paymentAdvisory}]),V>0&&be(ge=>[...ge,{id:Date.now()+1,partyName:ce.partyName,date:Vt.date,particulars:"TDS Deducted",narration:`Against ${ce.invoiceNo}`,debit:0,credit:V,type:"tds",receiptNo:h,invoiceNo:ce.invoiceNo}]),Z>0&&be(ge=>[...ge,{id:Date.now()+2,partyName:ce.partyName,date:Vt.date,particulars:"Discount Given",narration:`Against ${ce.invoiceNo}`,debit:0,credit:Z,type:"discount",receiptNo:h,invoiceNo:ce.invoiceNo}]);const he=parseFloat(ce.invoiceTotalAmount)||0,J=ne.find(ge=>ge.invoiceNo===ce.invoiceNo),re=J?Math.abs(parseFloat(J.totalAmount)||0):0,oe=he-B-re<=0;ce.invoiceType==="Combined"&&ce.combinationCode!=="NA"?Pe(ge=>ge.map(Ae=>Ae.combinationCode===ce.combinationCode?{...Ae,receiptStatus:oe?"Closed":"Received",receiptNo:h,receiptDate:Vt.date}:Ae)):ce.isHistorical||Pe(ge=>ge.map(Ae=>Ae.id===ce.id?{...Ae,receiptStatus:oe?"Closed":"Received",receiptNo:h,receiptDate:Vt.date}:Ae)),Et(ge=>ge+1),Qi("receipt",` Payment received for ${ce.partyName} - Receipt ${h} - ${et(B)}`,"director"),Pa(!1),hr(null),Mi({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),alert(` Receipt Created!

Receipt No: ${h}
Amount: ${et(B)}`)},Ui=h=>{hr(h),Ba({amount:"",tds:"",discount:"",reason:"",date:new Date().toISOString().split("T")[0]}),Vs(!0)},Ac=()=>{var ge;if(!ce||!En.amount&&!En.gst||!En.reason){alert("Please enter Amount and/or GST and reason");return}const h=ce.invoiceNo.match(/(\d{4}-\d{2})/),_=h?h[1]:`${new Date().getFullYear()}-${String(new Date().getFullYear()+1).slice(-2)}`,V=ce.invoiceNo.split("/").pop(),Z=`CN/${_}/${V}`,B=parseFloat(En.amount)||0,H=parseFloat(En.gst)||0,M=B+H,ae=((ge=ce.statePartyDetails)==null?void 0:ge.toUpperCase().includes("MAHARASHTRA"))?"CGST/SGST":"IGST",te={id:Date.now(),creditNoteNo:Z,invoiceNo:ce.invoiceNo,partyName:ce.partyName,date:En.date,amount:B,gst:H,gstType:ae,totalAmount:M,reason:En.reason};ie(Ae=>[...Ae,te]);const he=parseFloat(ce.invoiceTotalAmount)||0,J=Be.find(Ae=>Ae.invoiceNo===ce.invoiceNo),re=J?parseFloat(J.amount)+parseFloat(J.tds||0)+parseFloat(J.discount||0):0,nt=M>=he-re;ce.isHistorical||Pe(Ae=>Ae.map(Ye=>Ye.invoiceNo===ce.invoiceNo?{...Ye,creditNoteNo:Z,receiptStatus:nt?"Cancelled":Ye.receiptStatus}:Ye)),xt(Ae=>Ae+1),Vs(!1),hr(null),Ba({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]});let oe=` Credit Note Created!

Credit Note No: ${Z}`;B>0&&(oe+=`
Base Amount: ${et(B)}`),H>0&&(oe+=`
${ae}: ${et(H)}`),oe+=`
Total: ${et(M)}`,nt&&(oe+=`

 Invoice fully covered by CN - marked as Cancelled`),alert(oe)},qu=h=>{var Z;const _=(Z=h.target.files)==null?void 0:Z[0];if(!_)return;const V=new FileReader;V.onload=B=>{Mi(H=>({...H,paymentAdvisory:B.target.result}))},V.readAsDataURL(_),h.target.value=""},dg=h=>{hr(h),Ei(!0)},QF=()=>{if(!ce)return;const h=ce.invoiceNo;ce.invoiceType==="Combined"&&ce.combinationCode!=="NA"?Pe(Z=>Z.map(B=>B.combinationCode===ce.combinationCode?{...B,invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",invoiceType:"Individual",combinationCode:"NA",mailingSent:"No",mailDate:"",editComments:"",receiptStatus:"",receiptNo:"",receiptDate:""}:B)):Pe(Z=>Z.map(B=>B.id===ce.id?{...B,invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",invoiceType:"Individual",combinationCode:"NA",mailingSent:"No",mailDate:"",editComments:"",receiptStatus:"",receiptNo:"",receiptDate:""}:B)),be(Z=>Z.filter(B=>B.invoiceNo!==h));const _=Be.filter(Z=>Z.invoiceNo===h);_.length>0&&G(Z=>Z.filter(B=>B.invoiceNo!==h)),Ei(!1),hr(null);const V=_.length>0?`
${_.length} receipt(s) also deleted.`:"";alert(` Invoice ${h} deleted.${V}

You can now regenerate the invoice.`)},JF=h=>{confirm(`Delete Receipt ${h.receiptNo}?

This will also update the invoice status back to Pending.`)&&(G(_=>_.filter(V=>V.id!==h.id)),Pe(_=>_.map(V=>V.invoiceNo===h.invoiceNo?{...V,receiptStatus:"",receiptNo:"",receiptDate:""}:V)),alert(` Receipt ${h.receiptNo} deleted.`))},ZF=h=>{confirm(`Delete Credit Note ${h.creditNoteNo}?

This will remove the CN association from the invoice.`)&&(ie(_=>_.filter(V=>V.id!==h.id)),Pe(_=>_.map(V=>V.invoiceNo===h.invoiceNo?{...V,creditNoteNo:""}:V)),alert(` Credit Note ${h.creditNoteNo} deleted.`))},e4=h=>{confirm(`Delete historical entry?

Vch No: ${h.vchNo||"N/A"}
Amount: ${h.debit||h.credit}

This action cannot be undone.`)&&(be(_=>_.filter(V=>V.id!==h.id)),alert(" Historical entry deleted."))},t4=()=>{if(!X||!confirm(`Delete ALL historical entries for "${X}"?

This will remove all imported historical data for this party.`))return;const h=se.filter(_=>Jt(_.partyName,X)&&_.isHistorical).length;be(_=>_.filter(V=>!(Jt(V.partyName,X)&&V.isHistorical))),alert(` ${h} historical entries deleted for ${X}.`)},r4=h=>{ms(h),xs({date:new Date().toISOString().split("T")[0],notes:"",nextFollowupDate:"",status:"Pending"}),Oi(!0)},n4=()=>{var _,V;if(!pr)return;const h={id:Date.now(),invoiceNo:pr.invoiceNo,partyName:pr.partyName,invoiceDate:pr.invoiceDate||pr.date,invoiceAmount:pr.invoiceTotalAmount||pr.totalAmount,subject:((V=(_=pr.campaigns)==null?void 0:_[0])==null?void 0:V.subject)||pr.subject||"",followupDate:jr.date,notes:jr.notes,nextFollowupDate:jr.nextFollowupDate,status:jr.status};Ut(Z=>[...Z,h]),Oi(!1),ms(null),Qi("followup",`Followup added for ${pr.invoiceNo}`,"all"),alert(` Followup recorded for ${pr.invoiceNo}`)},i4=h=>{confirm("Delete this followup entry?")&&Ut(_=>_.filter(V=>V.id!==h))},s4=h=>{var O,ae;const _=h.subject||((ae=(O=h.campaigns)==null?void 0:O[0])==null?void 0:ae.subject)||"",V=h.partyName,Z=h.invoiceNo,B=et(h.invoiceTotalAmount||h.totalAmount||0),H=wt(h.invoiceDate||h.date);return`Subject: RE: ${_} - Payment Followup for Invoice ${Z}

Dear Sir/Madam,

Greetings from ${w.name}!

This is a gentle reminder regarding the outstanding payment for:

Invoice No: ${Z}
Invoice Date: ${H}
Amount: ${B}
Party: ${V}

We kindly request you to process the payment at the earliest. If the payment has already been made, please share the payment details for our records.

For any queries, please feel free to reach out.

Thanks & Regards,
Finance Team
${w.name}
Email: ${w.email}
Phone: ${w.phone}`},py=h=>{const _=s4(h);navigator.clipboard.writeText(_),alert(" Followup email template copied to clipboard!")},gy=h=>{var Z,B;const _=h.subject||((B=(Z=h.campaigns)==null?void 0:Z[0])==null?void 0:B.subject)||"",V=encodeURIComponent(_);window.open(`https://mail.google.com/mail/u/0/#search/${V}`,"_blank")},a4=h=>{var Z;const _=(Z=h.target.files)==null?void 0:Z[0];if(!_)return;const V=new FileReader;V.onload=B=>{const H=Nl(B.target.result,{type:"binary"}),M=H.SheetNames[0],O=H.Sheets[M],ae=Er.sheet_to_json(O),te={};ae.forEach(he=>{const J=he["Party Name"]||he["PARTY NAME"]||he.PartyName||"",re=parseFloat(he.Amount||he.AMOUNT||he["Invoice Amount"]||0);J&&re>0&&(te[J.trim()]=re)}),ys(he=>({...he,...te})),alert(` Loaded ${Object.keys(te).length} party invoice values!`)},V.readAsBinaryString(_),h.target.value=""},o4=()=>{const h=Er.json_to_sheet([{"Party Name":"ABC Group Private Limited",Amount:5500},{"Party Name":"XYZ Media Pvt Ltd",Amount:7500}]),_=Er.book_new();Er.book_append_sheet(_,h,"Invoice Values"),Nc(_,"Invoice_Values_Template.xlsx")},l4=h=>{var Z;const _=(Z=h.target.files)==null?void 0:Z[0];if(!_)return;const V=new FileReader;V.onload=B=>{const H=Nl(B.target.result,{type:"binary"}),M=H.SheetNames[0],O=H.Sheets[M],ae=Er.sheet_to_json(O),te={...rn};let he=0;ae.forEach(J=>{const re=(J["Name of Ledger"]||J["Party Name"]||J["NAME OF LEDGER"]||J["PARTY NAME"]||"").trim(),nt=(J["State Name"]||J["STATE NAME"]||J.State||J.STATE||"").trim(),oe=(J.Address||J.ADDRESS||J["Party Address"]||J["PARTY ADDRESS"]||"").trim(),ge=(J["Client Code"]||J["CLIENT CODE"]||J.Code||J.CODE||"").toString().trim();if(re){const Ae=Kn(nt),Ye=ge||`${re.toUpperCase()}|${Ae}`;te[Ye]={clientCode:ge,partyName:re,partyNameUpper:re.toUpperCase(),ledgerGroup:J["Ledger Group"]||J["LEDGER GROUP"]||"Sundry Debtors",stateName:nt,normalizedState:Ae,gstRegType:J["GST Registration Type"]||J["GST REGISTRATION TYPE"]||"Regular",gstin:(J["GSTIN/UIN"]||J.GSTIN||J.GST||"").trim(),address:oe},he++}}),El(te),alert(` Party Master Updated!

${he} party-state combinations loaded.`)},V.readAsBinaryString(_),h.target.value=""},c4=()=>{const h=Er.json_to_sheet([{"Sl. No.":1,"Client Code":"1.01","Name of Ledger":"ABC PRIVATE LIMITED",Address:"123 Business Park, Andheri East","Ledger Group":"Sundry Debtors","State Name":"Maharashtra","GST Registration Type":"Regular","GSTIN/UIN":"27AAACA1234A1ZQ"},{"Sl. No.":2,"Client Code":"1.02","Name of Ledger":"ABC PRIVATE LIMITED",Address:"456 Tech Hub, Noida","Ledger Group":"Sundry Debtors","State Name":"Uttar Pradesh","GST Registration Type":"Regular","GSTIN/UIN":"09AAACA1234A1ZS"},{"Sl. No.":3,"Client Code":"2.01","Name of Ledger":"XYZ MEDIA PVT LTD",Address:"789 Media Tower, Connaught Place","Ledger Group":"Sundry Debtors","State Name":"Delhi","GST Registration Type":"Regular","GSTIN/UIN":"07AAACX5678B1ZR"}]),_=Er.book_new();Er.book_append_sheet(_,h,"Party Master"),Nc(_,"Party_Master_Template.xlsx")},u4=h=>{var Z;const _=(Z=h.target.files)==null?void 0:Z[0];if(!_)return;if(!X){alert(" Please select a party first from the list, then import their historical ledger."),h.target.value="";return}const V=new FileReader;V.onload=B=>{const H=Nl(B.target.result,{type:"binary",cellDates:!0}),M=H.SheetNames[0],O=H.Sheets[M],ae=Er.sheet_to_json(O,{raw:!1}),te=[];let he=0,J=null;const re=oe=>{if(!oe)return 0;const ge=String(oe).replace(/,/g,"").replace(/[^\d.-]/g,"");return parseFloat(ge)||0},nt=oe=>{if(!oe||typeof oe!="string")return"";const ge=oe.trim(),Ae=ge.split(/[-\/]/);if(Ae.length===3){const Ye={jan:"01",feb:"02",mar:"03",apr:"04",may:"05",jun:"06",jul:"07",aug:"08",sep:"09",oct:"10",nov:"11",dec:"12"},Xe=Ae[1].toLowerCase().substring(0,3);if(Ye[Xe]){const Qe=Ae[0].padStart(2,"0");return`${Ae[2].length===2?parseInt(Ae[2])>50?"19"+Ae[2]:"20"+Ae[2]:Ae[2]}-${Ye[Xe]}-${Qe}`}}return ge};ae.forEach((oe,ge)=>{const Ae=nt(oe.Date||oe.DATE||oe.date||""),Ye=(oe.Particular||oe.PARTICULAR||oe.Particulars||oe.PARTICULARS||"").trim(),Xe=(oe["Vch Type"]||oe["VCH TYPE"]||oe["Voucher Type"]||oe["vch type"]||"").trim(),Qe=(oe["Vch No."]||oe["VCH NO."]||oe["Voucher No"]||oe["Invoice No"]||oe["Vch No"]||oe["vch no."]||"").trim(),at=re(oe.Debit||oe.DEBIT||oe.debit),Me=re(oe.Credit||oe.CREDIT||oe.credit),tt=oe["Date of Receipt"]||oe["DATE OF RECEIPT"]||oe["Receipt Date"]||"",$t=re(oe["Amount Received"]||oe["AMOUNT RECEIVED"]||oe["amount received"]),Zt=re(oe["TDS amount Received"]||oe["TDS Received"]||oe.TDS||oe.tds),ir=re(oe.Balance||oe.BALANCE||oe.balance),_r=(oe["Payment Status"]||oe["PAYMENT STATUS"]||oe.Status||oe.status||"").trim();if(!Ae&&(Ye.toUpperCase().includes("PROMOTIONAL")||Ye.toUpperCase().includes("IGST")||Ye.toUpperCase().includes("CGST")||Ye.toUpperCase().includes("SGST")||Ye.toUpperCase().includes("TRADE EMAILER"))&&J)J.subRows||(J.subRows=[]),J.subRows.push({particular:Ye,debit:at,credit:Me});else if(Ae&&(Qe||at>0||Me>0)){J&&(te.push(J),he++);let Te="invoice";Xe.toLowerCase().includes("credit note")||Qe.toUpperCase().startsWith("CN")?Te="creditnote":Xe.toLowerCase().includes("receipt")?Te="receipt":(Xe.toLowerCase().includes("sale")||at>0)&&(Te="invoice"),J={id:Date.now()+ge,partyName:X,date:Ae,particulars:Ye||X,narration:Qe,vchType:Xe||"Sales",vchNo:Qe,debit:at,credit:Me,receiptDate:tt,amountReceived:$t,tdsReceived:Zt,balance:ir,paymentStatus:_r,type:Te,isHistorical:!0,subRows:[]}}}),J&&(te.push(J),he++),console.log("Parsed entries with sub-rows:",te),he>0?(be(oe=>[...oe,...te]),alert(` Historical Ledger Uploaded!

${he} entries added for "${X}".`)):alert(` No valid ledger entries found in the file.

Make sure your file has these columns:
 Date (e.g., 02-Jun-21)
 Vch Type (e.g., Sales, Credit Note)
 Vch No. (e.g., MB/2022-23/128)
 Debit or Credit amount`)},V.readAsBinaryString(_),h.target.value="",Ks(!1)},d4=()=>{const h=Er.json_to_sheet([{Date:"02-Jun-21",Particular:"ABC Corp Ltd.","Vch Type":"Sales","Vch No.":"MB/2020-21/0411",Debit:6e3,Credit:"","Date of Receipt":"","Amount Received":44371,"TDS amount Received":5880,Balance:"","Payment Status":"Received"},{Date:"",Particular:"PROMOTIONAL TRADE EMAILERS","Vch Type":"","Vch No.":"",Debit:"",Credit:22500,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""},{Date:"",Particular:"IGST","Vch Type":"","Vch No.":"",Debit:"",Credit:4050,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""},{Date:"26-Mar-25",Particular:"ABC Corp Ltd.","Vch Type":"Credit Note","Vch No.":"CN/2022-23/128",Debit:"",Credit:26550,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""}]),_=Er.book_new();Er.book_append_sheet(_,h,"Historical Ledger"),Nc(_,"Historical_Ledger_Template.xlsx")},f4=h=>{const _=Ee.find(V=>V.invoiceNo===h);_?Qu(_):alert("Invoice not found in system. This may be a historical entry.")},h4=h=>{Ee.find(V=>V.invoiceNo===h.invoiceNo);let _=` RECEIPT DETAILS

`;_+=`Receipt No: ${h.receiptNo}
`,_+=`Date: ${wt(h.date)}
`,_+=`Party: ${h.partyName}
`,_+=`Invoice: ${h.invoiceNo}

`,_+=`
`,_+=`Amount Received: ${et(h.amount||0)}
`,_+=`TDS: ${et(h.tds||0)}
`,_+=`Discount: ${et(h.discount||0)}
`,_+=`
`,_+=`Total: ${et((h.amount||0)+(h.tds||0)+(h.discount||0))}
`,h.remarks&&(_+=`
Remarks: ${h.remarks}`),alert(_)},p4=h=>{let _=` CREDIT NOTE DETAILS

`;_+=`Credit Note No: ${h.creditNoteNo}
`,_+=`Date: ${wt(h.date)}
`,_+=`Party: ${h.partyName}
`,_+=`Against Invoice: ${h.invoiceNo}

`,_+=`
`,_+=`Base Amount: ${et(h.amount||0)}
`,_+=`${h.gstType||"GST"}: ${et(h.gst||0)}
`,_+=`
`,_+=`Total Credit: ${et(h.totalAmount||(h.amount||0)+(h.gst||0))}
`,h.reason&&(_+=`
Reason: ${h.reason}`),alert(_)},g4=h=>{var Z;const _=(Z=h.target.files)==null?void 0:Z[0];if(!_)return;const V=new FileReader;V.onload=B=>{const H=Nl(B.target.result,{type:"binary",cellDates:!0}),M=H.SheetNames[0],O=H.Sheets[M],ae=Er.sheet_to_json(O,{raw:!1}),te=new Set(wn.map(oe=>`${oe.date}|${oe.time||""}|${oe.campaignName||""}|${oe.subject}`.toLowerCase()));let he=0,J=0;const re=ae.map((oe,ge)=>{const Ae=oe["CAMPAIGN NAME"]||oe["Campaign Name"]||"",Ye=kH(Ae);let Xe=oe.DATE||oe.Date||new Date;typeof Xe=="string"&&(Xe=new Date(Xe));const Qe=(oe["PARTY NAME"]||oe["Party Name"]||"").trim(),at=oe["SENDER NAME"]||oe["Sender Name"]||"",Me=oe.SUBJECT||oe.Subject||"",tt=oe.TIME||oe.Time||"",$t=oe["State/Party Details"]||oe["STATE/PARTY DETAILS"]||oe.STATE||oe.State||"",Zt=$n[Qe]||"",ir=Xe instanceof Date&&!isNaN(Xe)?Xe.toISOString().split("T")[0]:"",z=(oe["Client Code"]||oe["CLIENT CODE"]||oe.Code||"").toString().trim()||Dn(Qe,$t),Te=oe["PO?"]||oe.PO||oe["WITH PO"]||"",St=Te.toLowerCase().includes("with po")||Te.toLowerCase()==="yes",Gt=oe["PO Number"]||oe["PO NUMBER"]||oe["PO No"]||oe["PO NO"]||"";let lt=oe["PO Date"]||oe["PO DATE"]||"";typeof lt=="object"&&lt instanceof Date&&(lt=lt.toISOString().split("T")[0]);const kt=`${ir}|${tt}|${Ae}|${Me}`.toLowerCase();return te.has(kt)?(he++,null):(te.add(kt),J++,{id:Date.now()+ge+Math.random(),sno:oe.SNO||oe["SNO."]||oe.Sno||ge+1,date:ir,month:oe.Month||oe.MONTH||"",time:tt,statePartyDetails:$t,partyName:Qe,clientCode:z,senderName:at,campaignName:Ae,subject:Me,emailId:Ye,additionalEmails:[],toBeBilled:"Not Yet",invoiceAmount:Zt,cgst:"",sgst:"",igst:"",totalWithGst:"",invoiceType:"Individual",combinationCode:"NA",invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",mailingSent:"No",mailerUploaded:!1,editComments:"",poStatus:St?"With PO":"Without PO",poNumber:St?Gt:"",poDate:St?lt:""})}).filter(oe=>oe!==null);if(re.length>0){Pe(ge=>[...ge,...re]);const oe=[...new Set(re.map(ge=>ge.partyName))];$u(ge=>{const Ae=new Set(ge);return oe.forEach(Ye=>Ae.add(Ye)),Ae})}let nt=` Upload Complete!

`;nt+=` ${J} new campaigns added
`,he>0&&(nt+=` ${he} duplicate entries skipped`),J>0&&Qi("upload",` ${J} new campaigns uploaded to Master Sheet`,"director"),alert(nt)},V.readAsBinaryString(_),h.target.value=""},m4=async()=>{Pe([]),Ce([]),be([]),G([]),ie([]),yo({}),yc({}),ke(1),ee(1),Et(1),xt(1),fr(1),ve(null),Le(null),$u(new Set),Ut([]),El({}),De([]);try{await hd("indreesh-media",{masterData:[],servicesData:[],ledgerEntries:[],receipts:[],creditNotes:[],openingBalances:{},mailerImages:{},mailerLogo:Ot,companyConfig:w,nextInvoiceNo:1,nextCombineNo:1,nextReceiptNo:1,nextCreditNoteNo:1,nextServiceInvoiceNo:1,invoiceValues:$n,notifications:[],whatsappSettings:st,partyMaster:{},followups:[],userPasswords:y}),console.log("Data cleared and saved to Firebase")}catch(h){console.error("Error clearing data:",h)}zs(!1),alert(" All master data, invoices, receipts, and ledger entries have been cleared!")},my=h=>{var Z;const _=parseFloat(h.invoiceAmount)||0;if((Z=h.statePartyDetails)==null?void 0:Z.toUpperCase().includes("MAHARASHTRA")){const B=_*.09,H=_*.09;return{cgst:B,sgst:H,igst:0,total:_+B+H}}else{const B=_*.18;return{cgst:0,sgst:0,igst:B,total:_+B}}},x4=(h,_)=>{const V=Ee.find(Z=>Z.id===h);Pe(Z=>Z.map(B=>{if(B.id===h){if(_==="Yes"&&B.invoiceAmount){const H=my(B);return{...B,toBeBilled:_,cgst:H.cgst.toFixed(2),sgst:H.sgst.toFixed(2),igst:H.igst.toFixed(2),totalWithGst:H.total.toFixed(2)}}return{...B,toBeBilled:_}}return B})),_==="Yes"&&V&&Qi("info",` Campaign marked for billing: ${V.partyName} - ${V.senderName}`,"finance")},h0=(h,_,V)=>{Pe(Z=>Z.map(B=>{if(B.id===h){const H={...B,[_]:V};if(_==="invoiceAmount"&&B.toBeBilled==="Yes"){const M=my(H);return{...H,cgst:M.cgst.toFixed(2),sgst:M.sgst.toFixed(2),igst:M.igst.toFixed(2),totalWithGst:M.total.toFixed(2)}}return H}return B}))},v4=h=>{const _=`${w.invoicePrefix}${Ne}`,V=new Date().toISOString().split("T")[0],Z=parseFloat(h.totalWithGst)||parseFloat(h.invoiceAmount)*1.18;Pe(B=>B.map(H=>H.id===h.id?{...H,invoiceNo:_,invoiceDate:V,invoiceTotalAmount:Z.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created",invoiceType:"Individual",combinationCode:"NA"}:H)),ke(B=>B+1),Qi("invoice",` New Invoice ${_} created for ${h.partyName} - ${et(Z)}`,"director"),alert(` Invoice Generated!

Invoice No: ${_}
Amount: ${et(Z)}

Please review and Approve or mark as Need Edits.`)},y4=()=>{if(Sn.size<2){alert("Please select at least 2 campaigns to combine");return}const h=`${w.invoicePrefix}${Ne}`,_=new Date().toISOString().split("T")[0],V=String(rt);let Z=0;const B=Ee.filter(H=>Sn.has(H.id));B.forEach(H=>{Z+=parseFloat(H.totalWithGst)||parseFloat(H.invoiceAmount)*1.18}),Pe(H=>H.map(M=>Sn.has(M.id)?{...M,invoiceNo:h,invoiceDate:_,invoiceTotalAmount:Z.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created",invoiceType:"Combined",combinationCode:V,mailingSent:"No"}:M)),ke(H=>H+1),ee(H=>H+1),Ar(!1),fa(new Set),Qi("invoice",` Combined Invoice ${h} created for ${vc} (${B.length} campaigns) - ${et(Z)}`,"director"),Gs(null),alert(` Combined Invoice Generated!

Invoice No: ${h}
Campaigns: ${Sn.size}
Total: ${et(Z)}

Please review and Approve or mark as Need Edits.`)},_4=h=>{fa(_=>{const V=new Set(_);return V.has(h)?V.delete(h):V.add(h),V})},E4=h=>{Gs(h.partyName),fa(new Set([h.id])),Ar(!0)},S4=h=>{var Z;const _=(Z=h.target.files)==null?void 0:Z[0];if(!_||!ce)return;const V=new FileReader;V.onload=B=>xy(B.target.result),V.readAsDataURL(_),h.target.value=""},xy=h=>{if(!ce)return;const _=ce.id;yo(Hu?V=>({...V,[_]:[h]}):V=>({...V,[_]:[...V[_]||[],h]})),Pe(V=>V.map(Z=>Z.id===ce.id?{...Z,mailerUploaded:!0}:Z)),Bi(null),Ua(!1),Zr(!1),alert(" Mailer image saved!")},w4=h=>{var V;const _=(V=h.clipboardData)==null?void 0:V.items;if(_){for(let Z=0;Z<_.length;Z++)if(_[Z].type.indexOf("image")!==-1){const B=_[Z].getAsFile(),H=new FileReader;H.onload=M=>Bi(M.target.result),H.readAsDataURL(B),h.preventDefault();break}}},T4=h=>{const _=encodeURIComponent(h||"campaign");window.open(`https://mail.google.com/mail/u/0/#search/${_}`,"_blank")},A4=h=>{var Z;const _=(Z=h.target.files)==null?void 0:Z[0];if(!_)return;const V=new FileReader;V.onload=B=>La(B.target.result),V.readAsDataURL(_),h.target.value=""},vy=h=>{const _=C(h);if(_.length>1){const V=_.map(Z=>Z.senderName).join(", ");return`Invoice ${h.invoiceNo||""} - ${V}`}return`Invoice ${h.invoiceNo||""} - ${h.senderName} - ${h.subject}`},p0=h=>{const _=C(h),V=parseFloat(h.invoiceTotalAmount)||parseFloat(h.totalWithGst)||parseFloat(h.invoiceAmount)*1.18;let Z="";return _.length>1?(Z=`Campaigns included in this invoice:
`,_.forEach((B,H)=>{Z+=`${H+1}. ${B.senderName} - ${B.subject}
`})):Z=`Campaign: ${h.senderName}
Subject: ${h.subject}`,`Dear Sir/Madam,

Please find attached the invoice for the following:

${Z}

Invoice No: ${h.invoiceNo||"To be generated"}
Invoice Amount: ${et(V)}

Kindly process the payment at your earliest convenience.

Bank Details:
Bank: ${w.bank.name}
A/C No: ${w.bank.account}
IFSC: ${w.bank.ifsc}
Branch: ${w.bank.branch}

Thank you for your business.

Best Regards,
${w.name}
${w.email}`},[C4,yy]=ye.useState(!1),[_y,Ey]=ye.useState(""),Sy=h=>{var oe;let _=[h],V=parseFloat(h.invoiceAmount)||0;h.invoiceType==="Combined"&&h.combinationCode!=="NA"&&(_=Ee.filter(ge=>ge.combinationCode===h.combinationCode),V=_.reduce((ge,Ae)=>ge+(parseFloat(Ae.invoiceAmount)||0),0));const Z=So(h.partyName,h.statePartyDetails),B=Al(h.partyName,h.statePartyDetails),H=(oe=h.statePartyDetails)==null?void 0:oe.toUpperCase().includes("MAHARASHTRA"),M=H?V*.09:0,O=H?V*.09:0,ae=H?0:V*.18,te=M+O+ae,he=V+te,J=_.map((ge,Ae)=>`
      <tr>
        <td style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px;">${Ae+1}</td>
        <td style="border: 1px solid #000; padding: 8px; font-size: 12px;">
          <div style="font-weight: 600;">PROMOTIONAL TRADE EMAILER</div>
          <div style="font-style: italic; color: #555; font-size: 11px; margin-top: 2px;">${ge.senderName||""} - ${wt(ge.date)}</div>
          <div style="font-style: italic; color: #555; font-size: 11px;">Subject: ${ge.subject||""}</div>
        </td>
        <td style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px;">${w.hsnCode}</td>
        <td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${bt(parseFloat(ge.invoiceAmount)||0)}</td>
      </tr>
    `).join("");let re=[];h.invoiceType==="Combined"&&h.combinationCode!=="NA"?_.forEach(ge=>{(tn[ge.id]||[]).forEach(Ye=>re.push({img:Ye,campaign:ge}))}):(tn[h.id]||[]).forEach(Ae=>re.push({img:Ae,campaign:h}));const nt=re.map(({img:ge,campaign:Ae})=>`
      <div class="page-break-before" style="page-break-before: always; padding: 40px; text-align: center; background: white;">
        ${Ot?`<div style="margin-bottom: 20px;"><img src="${Ot}" alt="Logo" style="max-height: 70px;" /></div>`:`
          <div style="text-align: center; margin-bottom: 25px;">
            <span style="font-size: 22px; font-weight: bold; color: #2874A6;">${w.name}</span>
          </div>
        `}
        <h2 style="font-size: 20px; text-decoration: underline; margin: 25px 0;">MAILER SUPPORTING</h2>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>MAILER DATE:</strong> ${CH(Ae.date)}</p>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>CAMPAIGN:</strong> ${Ae.senderName}</p>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>SUBJECT:</strong> ${Ae.subject||"Campaign"}</p>
        <div style="margin-top: 25px;"><img src="${ge}" alt="Mailer" style="max-width: 100%; max-height: 550px; border: 1px solid #ddd;" /></div>
      </div>
    `).join("");return`
  <div style="max-width: 900px; margin: 0 auto; padding: 15px; background: white; font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4;">
    <style>
      @media print {
        @page { size: A4; margin: 8mm; }
        body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        .page-break-before { page-break-before: always; }
      }
    </style>
    <div style="border: 2px solid #000; background: white;">
      <div style="text-align: center; padding: 12px; font-size: 18px; font-weight: bold; border-bottom: 2px solid #000; background: #f8f8f8;">Tax Invoice</div>
      <div style="text-align: center; font-size: 11px; font-style: italic; padding: 5px; border-bottom: 1px solid #000; background: #fafafa;">(Original for Recipient)</div>
      <div style="display: flex; border-bottom: 2px solid #000;">
        <div style="flex: 1.5; padding: 12px; border-right: 2px solid #000;">
          <div style="font-size: 16px; font-weight: bold; margin-bottom: 8px; color: #1a5276;">${w.name}</div>
          <div style="font-size: 11px; line-height: 1.5; color: #333;">${w.address}<br>${w.addressLine2}<br>${w.city}<br><strong>GSTIN/UIN:</strong> ${w.gstin}<br><strong>State:</strong> ${w.stateName}, Code: ${w.stateCode}<br><strong>Contact:</strong> ${w.phone}<br><strong>E-Mail:</strong> ${w.email}</div>
        </div>
        <div style="flex: 1; font-size: 12px;">
          <div style="display: flex; border-bottom: 1px solid #000;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Invoice No.</div><div style="flex: 1; padding: 8px; font-weight: 600; color: #1a5276;">${h.invoiceNo||""}</div></div>
          <div style="display: flex;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Dated</div><div style="flex: 1; padding: 8px;">${wt(h.invoiceDate||h.date)}</div></div>
        </div>
      </div>
      <div style="padding: 10px 12px; border-bottom: 2px solid #000; background: #fafafa;">
        <div style="font-size: 11px; color: #666; margin-bottom: 3px;">Buyer (Bill to)</div>
        <div style="font-size: 14px; font-weight: bold; margin-bottom: 4px; color: #1a5276;">${h.partyName}</div>
        <div style="font-size: 11px; color: #333;">${B?B+"<br>":""}${h.statePartyDetails||""}${Z?"<br><strong>GSTIN/UIN:</strong> "+Z:""}<br>Place of Supply: ${h.statePartyDetails||w.stateName}</div>
      </div>
      <table style="width: 100%; border-collapse: collapse;">
        <thead><tr style="background: #e8e8e8;"><th style="border: 1px solid #000; padding: 10px; width: 45px; font-size: 12px;">Sl No.</th><th style="border: 1px solid #000; padding: 10px; font-size: 12px;">Particulars</th><th style="border: 1px solid #000; padding: 10px; width: 80px; font-size: 12px;">HSN/SAC</th><th style="border: 1px solid #000; padding: 10px; width: 100px; text-align: right; font-size: 12px;">Amount</th></tr></thead>
        <tbody>
          ${J}
          ${_.length>1?'<tr style="background: #f5f5f5;"><td colspan="3" style="border: 1px solid #000; padding: 10px; text-align: right; font-weight: bold; font-size: 13px;">Sub Total</td><td style="border: 1px solid #000; padding: 10px; text-align: right; font-weight: bold; font-size: 13px;">'+bt(V)+"</td></tr>":""}
          ${H?`<tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">CGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${bt(M)}</td></tr><tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">SGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${bt(O)}</td></tr>`:`<tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">IGST @ 18%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${bt(ae)}</td></tr>`}
          <tr style="background: #2874A6; color: white;"><td colspan="3" style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;">Total</td><td style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;"> ${he.toLocaleString("en-IN",{minimumFractionDigits:2})}</td></tr>
        </tbody>
      </table>
      <div style="padding: 10px 12px; border: 1px solid #000; border-top: none; background: #fafafa;"><div style="color: #666; font-size: 11px; margin-bottom: 3px;">Amount Chargeable (in words)</div><div style="font-weight: bold; font-size: 13px;">${th(he)}</div></div>
      <div style="display: flex; border-top: 2px solid #000;">
        <div style="flex: 1; padding: 10px 12px; border-right: 2px solid #000; font-size: 11px;"><div><strong>Company's PAN:</strong> ${w.pan}</div><div style="margin-top: 4px;"><strong>MSME Reg. No.:</strong> UDYAM-MH-19-0057219</div></div>
        <div style="flex: 1.2; padding: 10px 12px; font-size: 11px;">
          <div style="font-weight: bold; margin-bottom: 6px; color: #1a5276;">Company's Bank Details</div>
          <div style="line-height: 1.5;"><strong>A/c Holder:</strong> ${w.bank.holder}<br><strong>Bank:</strong> ${w.bank.name}<br><strong>A/c No.:</strong> ${w.bank.account}<br><strong>IFSC:</strong> ${w.bank.ifsc}</div>
          <div style="text-align: right; margin-top: 30px;"><div style="font-weight: bold;">for ${w.name}</div><div style="margin-top: 25px; border-top: 1px solid #000; display: inline-block; padding-top: 4px; font-size: 10px;">Authorised Signatory</div></div>
        </div>
      </div>
      <div style="text-align: center; padding: 8px; background: #f0f0f0; border-top: 1px solid #000; font-size: 10px; color: #666; font-style: italic;">This is a Computer Generated Invoice</div>
    </div>
  </div>
  ${nt}
`},k4=h=>{const _=Sy(h);Ey(_),hr(h),yy(!0)},F4=h=>{const _=`<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Invoice ${h.invoiceNo||""}</title>
  <style>
    @page { size: A4; margin: 10mm; }
    @media print { body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } }
    body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }
  </style>
</head>
<body>
${Sy(h)}
<script>
  // Auto-open print dialog when file is opened
  window.onload = function() { 
    setTimeout(function() { window.print(); }, 500); 
  };
<\/script>
</body>
</html>`,V=new Blob([_],{type:"text/html"}),Z=URL.createObjectURL(V),B=document.createElement("a");B.href=Z,B.download=`Invoice_${(h.invoiceNo||"draft").replace(/\//g,"-")}.html`,document.body.appendChild(B),B.click(),document.body.removeChild(B),URL.revokeObjectURL(Z)},Qu=h=>{k4(h)},b4=()=>{const h=parseFloat(Pr.amount)||0,_=parseFloat(Pr.tds)||0,V=parseFloat(Pr.discount)||0,Z=h+_+V;let B=parseFloat(ce.invoiceTotalAmount)||parseFloat(ce.totalWithGst)||parseFloat(ce.invoiceAmount)*1.18;const H=Z>=B?"Paid":"Partially Paid";ce.invoiceType==="Combined"&&ce.combinationCode!=="NA"?Pe(O=>O.map(ae=>ae.combinationCode===ce.combinationCode?{...ae,invoiceStatus:H}:ae)):Pe(O=>O.map(ae=>ae.id===ce.id?{...ae,invoiceStatus:H}:ae));const M=[];h>0&&M.push({id:Date.now(),partyName:ce.partyName,date:Pr.date,particulars:Pr.narration?`Payment Received - ${Pr.mode} (${Pr.narration})`:`Payment Received - ${Pr.mode}`,debit:0,credit:h,type:"payment"}),_>0&&M.push({id:Date.now()+1,partyName:ce.partyName,date:Pr.date,particulars:`TDS Deducted - Inv: ${ce.invoiceNo}`,debit:0,credit:_,type:"tds"}),V>0&&M.push({id:Date.now()+2,partyName:ce.partyName,date:Pr.date,particulars:`Discount Allowed - Inv: ${ce.invoiceNo}`,debit:0,credit:V,type:"discount"}),be(O=>[...O,...M]),en(!1),hr(null)},wy=h=>{$u(_=>{const V=new Set(_);return V.has(h)?V.delete(h):V.add(h),V})},I4=()=>{const V=r==="director"?[{id:"master",icon:iE,label:"Master Sheet"},{id:"services",icon:rm,label:"Services Sheet"},{id:"invoices",icon:cd,label:"Invoice Register"},{id:"receipts",icon:Io,label:"Receipt Register"},{id:"ledgers",icon:Q_,label:"Party Ledgers"},{id:"followups",icon:Y0,label:"Followups"},{id:"reports",icon:X_,label:"Reports"}]:[{id:"master",icon:iE,label:"Master Sheet"},{id:"services",icon:rm,label:"Services Sheet"},{id:"invoices",icon:cd,label:"Invoice Register"},{id:"receipts",icon:Io,label:"Receipt Register"},{id:"ledgers",icon:Q_,label:"Party Ledgers"},{id:"followups",icon:Y0,label:"Followups"},{id:"reports",icon:X_,label:"Reports"},{id:"settings",icon:LL,label:"Settings"}];return c.jsxs("div",{style:{width:N?"60px":"220px",backgroundColor:"#1E293B",color:"#FFFFFF",display:"flex",flexDirection:"column",transition:"width 0.2s ease",flexShrink:0},children:[c.jsxs("div",{style:{padding:N?"12px":"16px",borderBottom:"1px solid #334155",display:"flex",alignItems:"center",justifyContent:N?"center":"space-between"},children:[!N&&c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[c.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"32px",height:"auto",borderRadius:"4px",backgroundColor:"white",padding:"2px"}}),c.jsxs("div",{children:[c.jsx("div",{style:{fontSize:"16px",fontWeight:"700"},children:"FinMate"}),c.jsx("div",{style:{fontSize:"10px",color:"#94A3B8"},children:r==="director"?"Director View":"Finance Team"})]})]}),c.jsx("button",{onClick:()=>Ge(!N),style:{background:"none",border:"none",color:"#94A3B8",cursor:"pointer",padding:"4px"},children:N?c.jsx($0,{size:18}):c.jsx(DL,{size:18})})]}),!N&&c.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #334155",fontSize:"11px"},children:f?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#FCD34D"},children:[c.jsx(tE,{size:12,style:{animation:"spin 1s linear infinite"}}),c.jsx("span",{children:"Saving..."})]}):g?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#86EFAC"},children:[c.jsx(Z_,{size:12}),c.jsxs("span",{children:["Saved ",g.toLocaleTimeString()]})]}):c.jsx("div",{style:{color:"#94A3B8"},children:"Cloud Sync Active"})}),c.jsx("div",{style:{padding:"8px",borderBottom:"1px solid #334155"},children:c.jsxs("button",{onClick:()=>dt(!0),style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:N?"12px":"11px 14px",borderRadius:"8px",border:"none",backgroundColor:ws>0?"#FEF3C7":"#334155",color:ws>0?"#92400E":"#94A3B8",cursor:"pointer",fontSize:"14px",fontWeight:ws>0?"700":"500",justifyContent:N?"center":"flex-start",position:"relative"},title:"Notifications",children:[ws>0?c.jsx(NL,{size:18}):c.jsx(q_,{size:18}),!N&&c.jsx("span",{children:"Notifications"}),ws>0&&c.jsx("span",{style:{position:N?"absolute":"static",top:N?"4px":"auto",right:N?"4px":"auto",marginLeft:N?"0":"auto",backgroundColor:"#DC2626",color:"#FFFFFF",padding:"2px 6px",borderRadius:"10px",fontSize:"11px",fontWeight:"700",minWidth:"18px",textAlign:"center"},children:ws})]})}),c.jsx("nav",{style:{flex:1,padding:"8px"},children:V.map(Z=>c.jsxs("button",{onClick:()=>D(Z.id),style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:N?"12px":"11px 14px",marginBottom:"4px",borderRadius:"8px",border:"none",backgroundColor:R===Z.id?"#2874A6":"transparent",color:R===Z.id?"#FFFFFF":"#94A3B8",cursor:"pointer",fontSize:"14px",fontWeight:R===Z.id?"600":"500",justifyContent:N?"center":"flex-start"},title:Z.label,children:[c.jsx(Z.icon,{size:18}),!N&&c.jsx("span",{children:Z.label})]},Z.id))}),c.jsxs("div",{style:{padding:"8px",borderTop:"1px solid #334155"},children:[c.jsxs("button",{onClick:()=>{E(!0),Y({currentPassword:"",newPassword:"",confirmPassword:""}),T("")},style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:N?"12px":"11px 14px",marginBottom:"8px",borderRadius:"8px",border:"none",backgroundColor:"#475569",color:"#FFFFFF",cursor:"pointer",fontSize:"14px",fontWeight:"500",justifyContent:N?"center":"flex-start"},title:"Change Password",children:[c.jsx(G0,{size:18}),!N&&c.jsx("span",{children:"Change Password"})]}),c.jsxs("button",{onClick:f0,style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:N?"12px":"11px 14px",borderRadius:"8px",border:"none",backgroundColor:"#DC2626",color:"#FFFFFF",cursor:"pointer",fontSize:"14px",fontWeight:"600",justifyContent:N?"center":"flex-start"},title:"Logout",children:[c.jsx(_a,{size:18}),!N&&c.jsx("span",{children:"Logout"})]})]})]})},N4=()=>c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(ud,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"})]}),c.jsxs("div",{style:{position:"relative"},children:[c.jsx(X0,{size:15,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",placeholder:"Search...",value:vt.searchText,onChange:h=>Li(_=>({..._,searchText:h.target.value})),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"160px"}})]}),c.jsxs("select",{value:vt.party,onChange:h=>Li(_=>({..._,party:h.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:vt.party?"#EFF6FF":"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Parties"}),Cl.map(h=>c.jsx("option",{value:h,children:h},h))]}),c.jsxs("select",{value:vt.billStatus,onChange:h=>Li(_=>({..._,billStatus:h.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:vt.billStatus?"#EFF6FF":"#FFFFFF"},children:[c.jsx("option",{value:"",children:"Bill Status"}),c.jsx("option",{value:"Yes",children:"Yes"}),c.jsx("option",{value:"Not Yet",children:"Not Yet"})]}),c.jsxs("select",{value:vt.invoiceStatus,onChange:h=>Li(_=>({..._,invoiceStatus:h.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:vt.invoiceStatus?"#EFF6FF":"#FFFFFF"},children:[c.jsx("option",{value:"",children:"Invoice Status"}),c.jsx("option",{value:"Generated",children:"Generated"}),c.jsx("option",{value:"Not Generated",children:"Not Generated"}),c.jsx("option",{value:"Paid",children:"Paid"})]}),ue&&c.jsxs(c.Fragment,{children:[c.jsxs("button",{onClick:j,style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(_a,{size:14})," Clear"]}),c.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",pa.length," of ",Ee.length]})]})]})}),Ty=()=>{const h=Ee.filter(M=>M.toBeBilled==="Yes"&&M.invoiceGenerated&&M.mailingSent==="Yes"&&(M.receiptStatus==="Received"||M.receiptStatus==="Cancelled"||M.receiptStatus==="Closed")),_=Ee.filter(M=>!(M.toBeBilled==="Yes"&&M.invoiceGenerated&&M.mailingSent==="Yes"&&(M.receiptStatus==="Received"||M.receiptStatus==="Cancelled"||M.receiptStatus==="Closed"))),V=_n==="open"?_:h,Z=V.filter(M=>{var O,ae,te,he,J;if(vt.party&&M.partyName!==vt.party||vt.billStatus&&M.toBeBilled!==vt.billStatus||vt.invoiceType&&M.invoiceType!==vt.invoiceType||vt.mailingStatus&&(vt.mailingStatus==="Sent"&&M.mailingSent!=="Yes"||vt.mailingStatus==="Not Sent"&&M.mailingSent==="Yes")||vt.invoiceStatus&&(vt.invoiceStatus==="Generated"&&!M.invoiceGenerated||vt.invoiceStatus==="Not Generated"&&M.invoiceGenerated||vt.invoiceStatus==="Approved"&&M.invoiceStatus!=="Approved"||vt.invoiceStatus==="Need Edits"&&M.invoiceStatus!=="Need Edits"||vt.invoiceStatus==="Paid"&&M.invoiceStatus!=="Paid"))return!1;if(vt.searchText){const re=vt.searchText.toLowerCase();if(!((O=M.partyName)!=null&&O.toLowerCase().includes(re))&&!((ae=M.senderName)!=null&&ae.toLowerCase().includes(re))&&!((te=M.campaignName)!=null&&te.toLowerCase().includes(re))&&!((he=M.subject)!=null&&he.toLowerCase().includes(re))&&!((J=M.invoiceNo)!=null&&J.toLowerCase().includes(re)))return!1}return!0}),B=Z.reduce((M,O)=>{const ae=O.partyName||"Unknown";return M[ae]||(M[ae]=[]),M[ae].push(O),M},{}),H=Object.keys(B).sort();return c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsxs("div",{children:[c.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Master Sheet"}),c.jsxs("p",{style:{margin:"4px 0 0",fontSize:"14px",color:"#64748B"},children:[Ee.length," campaigns  ",Cl.length," parties  ",Ee.filter(M=>M.invoiceGenerated).length," invoiced"]})]}),c.jsxs("div",{style:{display:"flex",gap:"10px"},children:[c.jsx("input",{type:"file",ref:Sl,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:g4}),c.jsx(ze,{icon:Qs,label:"Upload Data",variant:"brand",onClick:()=>{var M;return(M=Sl.current)==null?void 0:M.click()}}),sr&&Ee.length>0&&c.jsx(ze,{icon:rs,label:"Clear All Data",variant:"danger",onClick:()=>zs(!0)})]})]}),c.jsxs("div",{style:{display:"flex",gap:"4px",marginBottom:"16px",backgroundColor:"#F1F5F9",padding:"4px",borderRadius:"10px",width:"fit-content"},children:[c.jsxs("button",{onClick:()=>xc("open"),style:{padding:"10px 20px",fontSize:"14px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:_n==="open"?"#FFFFFF":"transparent",color:_n==="open"?"#1E293B":"#64748B",boxShadow:_n==="open"?"0 2px 4px rgba(0,0,0,0.1)":"none"},children:[" Open Invoices (",_.length,")"]}),c.jsxs("button",{onClick:()=>xc("closed"),style:{padding:"10px 20px",fontSize:"14px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:_n==="closed"?"#FFFFFF":"transparent",color:_n==="closed"?"#1E293B":"#64748B",boxShadow:_n==="closed"?"0 2px 4px rgba(0,0,0,0.1)":"none"},children:[" Closed Invoices (",h.length,")"]})]}),Ee.length>0&&N4(),H.length===0?c.jsx(pn,{children:c.jsxs("div",{style:{padding:"60px",textAlign:"center",color:"#94A3B8"},children:[c.jsx(Qs,{size:48,style:{marginBottom:"16px",opacity:.5}}),c.jsx("div",{style:{fontSize:"18px",fontWeight:"600"},children:ue?"No matching records":_n==="closed"?"No closed invoices yet":"No Data Yet"}),c.jsx("div",{style:{fontSize:"14px",marginTop:"4px"},children:ue?"Try adjusting your filters":_n==="closed"?"Invoices will appear here once billed, mailed, and payment received":"Upload an Excel file to get started"})]})}):c.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:H.map(M=>{const O=B[M],ae=a0.has(M),te=O.filter(re=>re.toBeBilled==="Yes").length,he=O.filter(re=>re.invoiceGenerated).length,J=O.filter(re=>re.toBeBilled==="Yes").reduce((re,nt)=>re+(parseFloat(nt.totalWithGst)||0),0);return c.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:[c.jsxs("div",{onClick:()=>wy(M),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",backgroundColor:_n==="closed"?"#F0FDF4":"#F8FAFC",cursor:"pointer",borderBottom:ae?"3px solid #2874A6":"none"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[ae?c.jsx(em,{size:22,color:"#2874A6"}):c.jsx($0,{size:22,color:"#64748B"}),c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"700",fontSize:"16px",color:"#1E293B"},children:M}),c.jsxs("div",{style:{fontSize:"13px",color:"#64748B",marginTop:"3px"},children:[O.length," campaigns  ",te," billed  ",he," invoiced"]})]})]}),J>0&&c.jsxs("div",{style:{textAlign:"right"},children:[c.jsx("div",{style:{fontSize:"11px",color:"#64748B",textTransform:"uppercase"},children:"Total"}),c.jsx("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:et(J)})]})]}),ae&&c.jsx("div",{style:{overflowX:"auto"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px",minWidth:"2200px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F1F5F9"},children:[c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Date"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#6B21A8",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"60px"},children:"Code"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"100px"},children:"Sender"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",minWidth:"180px"},children:"Campaign / Subject"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"160px"},children:"Email ID"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"70px"},children:"Mailer"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"70px"},children:"PO?"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"80px"},children:"Bill?"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"right",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Amount"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Type"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Generate"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"110px"},children:"Invoice No."}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"90px"},children:"Inv Date"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"right",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"100px"},children:"Inv Amount"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#7C3AED",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"50px"},children:"C#"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"120px"},children:"Status/Approve"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"120px"},children:"Actions"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#059669",borderBottom:"2px solid #E2E8F0",backgroundColor:"#F0FDF4",width:"80px"},children:"Mailed?"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#059669",borderBottom:"2px solid #E2E8F0",backgroundColor:"#F0FDF4",width:"90px"},children:"Mail Date"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#7C3AED",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"100px"},children:"Receipt"})]})}),c.jsx("tbody",{children:O.map(re=>{var Ae,Ye;const nt=re.invoiceType==="Combined"&&v(re.combinationCode)&&re.mailingSent!=="Yes";xe(re);const oe=tn[re.id]&&tn[re.id].length>0,ge=re.clientCode||Dn(re.partyName,re.statePartyDetails);return c.jsxs("tr",{style:{backgroundColor:re.toBeBilled==="Yes"?re.invoiceGenerated?"#F0FDF4":"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #F1F5F9"},children:[c.jsx("td",{style:{padding:"12px 14px",whiteSpace:"nowrap",fontSize:"13px"},children:wt(re.date)}),c.jsx("td",{style:{padding:"12px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:c.jsx("span",{style:{fontWeight:"700",color:"#6B21A8",fontSize:"12px"},children:ge||"-"})}),c.jsx("td",{style:{padding:"12px 14px",fontWeight:"600",fontSize:"13px"},children:re.senderName}),c.jsxs("td",{style:{padding:"12px 14px"},children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",lineHeight:"1.4",color:"#1E293B"},children:((Ye=(Ae=re.campaignName)==null?void 0:Ae.split("--")[0])==null?void 0:Ye.trim())||re.senderName}),re.subject&&c.jsx("div",{style:{fontSize:"12px",color:"#64748B",marginTop:"4px",lineHeight:"1.3"},children:re.subject})]}),c.jsx("td",{style:{padding:"10px 14px"},children:c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[re.emailId&&c.jsx("div",{style:{fontSize:"11px",color:"#1E40AF",backgroundColor:"#EFF6FF",padding:"2px 6px",borderRadius:"4px",display:"inline-block"},children:re.emailId}),(re.additionalEmails||[]).map((Xe,Qe)=>c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[c.jsx("span",{style:{fontSize:"11px",color:"#059669",backgroundColor:"#F0FDF4",padding:"2px 6px",borderRadius:"4px"},children:Xe}),c.jsx("button",{onClick:()=>ar(re.id,Xe),style:{background:"none",border:"none",cursor:"pointer",padding:"2px",color:"#DC2626"},title:"Remove",children:c.jsx(_a,{size:12})})]},Qe)),c.jsxs("button",{onClick:()=>{hr(re),Ws(""),pt(!0)},style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",color:"#2874A6",background:"none",border:"none",cursor:"pointer",padding:"2px 0"},children:[c.jsx(nm,{size:12})," Add"]})]})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:oe?c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[c.jsx("span",{style:{color:"#22C55E",fontWeight:"700",fontSize:"14px"},children:""}),c.jsx("button",{onClick:()=>{hr(re),Bi(null),Ua(!0),Zr(!0)},style:{fontSize:"10px",color:"#64748B",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},children:"Replace"})]}):c.jsx(ze,{icon:J_,small:!0,variant:"default",onClick:()=>{hr(re),Bi(null),Ua(!1),Zr(!0)}})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:re.poStatus==="With PO"?c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[c.jsx("span",{style:{color:"#22C55E",fontWeight:"600",fontSize:"10px"},children:" PO"}),c.jsx("span",{style:{fontSize:"9px",color:"#64748B"},children:re.poNumber})]}):c.jsx("span",{style:{color:"#CBD5E1",fontSize:"10px"},children:"No PO"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:c.jsxs("select",{value:re.toBeBilled,onChange:Xe=>x4(re.id,Xe.target.value),disabled:re.invoiceGenerated||!yr,style:{padding:"6px 8px",fontSize:"12px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:re.toBeBilled==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:re.toBeBilled==="Yes"?"#DCFCE7":"#FFFFFF",color:re.toBeBilled==="Yes"?"#166534":"#64748B",cursor:re.invoiceGenerated||!yr?"not-allowed":"pointer",width:"70px",opacity:!yr&&!re.invoiceGenerated?.6:1},children:[c.jsx("option",{value:"Not Yet",children:"Not Yet"}),c.jsx("option",{value:"Yes",children:"Yes"})]})}),c.jsx("td",{style:{padding:"10px 14px"},children:c.jsx("input",{type:"number",value:re.invoiceAmount||"",onChange:Xe=>h0(re.id,"invoiceAmount",Xe.target.value),disabled:re.invoiceGenerated,placeholder:"0",style:{width:"80px",padding:"6px 8px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #D1D5DB",borderRadius:"6px",textAlign:"right",backgroundColor:re.invoiceGenerated?"#F3F4F6":"#FFFFFF"}})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:re.invoiceGenerated?c.jsx(gm,{status:re.invoiceType,small:!0}):re.toBeBilled==="Yes"?c.jsxs("select",{value:re.invoiceType||"Individual",onChange:Xe=>h0(re.id,"invoiceType",Xe.target.value),style:{padding:"6px 6px",fontSize:"11px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:re.invoiceType==="Combined"?"#7C3AED":"#A5B4FC",backgroundColor:re.invoiceType==="Combined"?"#F3E8FF":"#E0E7FF",color:re.invoiceType==="Combined"?"#6B21A8":"#3730A3",cursor:"pointer",width:"80px"},children:[c.jsx("option",{value:"Individual",children:"Individual"}),c.jsx("option",{value:"Combined",children:"Combined"})]}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:re.toBeBilled==="Yes"&&!re.invoiceGenerated&&re.invoiceAmount&&sr?re.invoiceType==="Individual"?c.jsx(ze,{icon:Io,label:"Create",small:!0,variant:"warning",onClick:()=>v4(re)}):c.jsx(ze,{icon:OL,label:"Combine",small:!0,variant:"purple",onClick:()=>E4(re)}):re.toBeBilled==="Yes"&&!re.invoiceGenerated&&re.invoiceAmount&&yr?c.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Finance to create"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF"},children:re.invoiceNo?c.jsx("span",{style:{fontWeight:"700",color:"#1E40AF",fontSize:"12px"},children:re.invoiceNo}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF",fontSize:"12px"},children:re.invoiceDate?wt(re.invoiceDate):"-"}),c.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF",textAlign:"right",fontWeight:"700",color:"#1E40AF",fontSize:"13px"},children:re.invoiceTotalAmount?bt(re.invoiceTotalAmount):"-"}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:re.combinationCode&&re.combinationCode!=="NA"?c.jsx("span",{style:{fontWeight:"700",color:"#7C3AED",fontSize:"12px"},children:re.combinationCode}):"-"}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:re.invoiceGenerated?yr?c.jsx("button",{onClick:()=>dn(re),style:{padding:"5px 10px",fontSize:"11px",fontWeight:"700",border:"1.5px solid",borderRadius:"6px",cursor:"pointer",backgroundColor:re.invoiceStatus==="Approved"?"#DCFCE7":re.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",borderColor:re.invoiceStatus==="Approved"?"#22C55E":re.invoiceStatus==="Need Edits"?"#DC2626":"#F59E0B",color:re.invoiceStatus==="Approved"?"#166534":re.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:re.invoiceStatus==="Approved"?" Approved":re.invoiceStatus==="Need Edits"?" Need Edits":" Review"}):c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px"},children:[c.jsx("span",{style:{padding:"4px 10px",fontSize:"11px",fontWeight:"700",borderRadius:"6px",backgroundColor:re.invoiceStatus==="Approved"?"#DCFCE7":re.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",color:re.invoiceStatus==="Approved"?"#166534":re.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:re.invoiceStatus==="Approved"?" Approved":re.invoiceStatus==="Need Edits"?" Need Edits":" Pending"}),(re.editComments||re.approvalRemarks)&&c.jsx("button",{onClick:()=>{hr(re),Sr(!0)},style:{fontSize:"9px",color:re.invoiceStatus==="Need Edits"?"#991B1B":"#166534",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},title:re.editComments||re.approvalRemarks,children:"View Remarks"})]}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:re.invoiceGenerated&&re.invoiceStatus==="Approved"?c.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[c.jsx(ze,{icon:Rc,small:!0,onClick:()=>Qu(re),title:"View Invoice"}),sr&&c.jsx(ze,{icon:K0,small:!0,variant:"brand",onClick:()=>{hr(re),Xi(!0)},title:"Send Email"}),sr&&c.jsx(ze,{icon:rs,small:!0,variant:"danger",onClick:()=>dg(re),title:"Delete"})]}):re.invoiceGenerated?c.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[c.jsx(ze,{icon:Rc,small:!0,onClick:()=>Qu(re),title:"View Invoice"}),sr&&c.jsx(ze,{icon:rs,small:!0,variant:"danger",onClick:()=>dg(re),title:"Delete"})]}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#F0FDF4"},children:re.invoiceGenerated&&re.invoiceStatus==="Approved"&&sr?nt?c.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Combined sent"}):c.jsxs("select",{value:re.mailingSent||"No",onChange:Xe=>h0(re.id,"mailingSent",Xe.target.value),style:{padding:"5px 8px",fontSize:"11px",fontWeight:"700",border:"2px solid",borderRadius:"6px",borderColor:re.mailingSent==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:re.mailingSent==="Yes"?"#DCFCE7":"#FFFFFF",color:re.mailingSent==="Yes"?"#166534":"#64748B",cursor:"pointer",width:"60px"},children:[c.jsx("option",{value:"No",children:"No"}),c.jsx("option",{value:"Yes",children:"Yes"})]}):re.invoiceGenerated&&re.invoiceStatus==="Approved"&&yr?c.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"11px",fontWeight:"600",backgroundColor:re.mailingSent==="Yes"?"#DCFCE7":"#FEF3C7",color:re.mailingSent==="Yes"?"#166534":"#92400E"},children:re.mailingSent==="Yes"?" Yes":" No"}):re.invoiceGenerated&&re.invoiceStatus!=="Approved"?c.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Approve first"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#F0FDF4"},children:re.mailingSent==="Yes"?sr?c.jsx("input",{type:"date",value:re.mailDate||re.invoiceDate||"",onChange:Xe=>h0(re.id,"mailDate",Xe.target.value),style:{padding:"4px 6px",fontSize:"11px",border:"1.5px solid #D1D5DB",borderRadius:"6px",width:"100%"}}):c.jsx("span",{style:{fontSize:"11px"},children:wt(re.mailDate||re.invoiceDate)}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:re.receiptStatus==="Received"||re.receiptStatus==="Closed"?c.jsxs("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"700",backgroundColor:"#DCFCE7",color:"#166534"},children:[" ",re.receiptNo||"Received"]}):re.receiptStatus==="Cancelled"?c.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:" Cancelled"}):re.invoiceGenerated&&re.invoiceStatus==="Approved"?c.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"600",backgroundColor:"#FEF3C7",color:"#92400E"},children:" Pending"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})})]},re.id)})})]})})]},M)})}),V.length>0&&c.jsxs("div",{style:{marginTop:"16px",padding:"16px 20px",backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsxs("div",{style:{display:"flex",gap:"24px",fontSize:"14px",color:"#475569"},children:[c.jsxs("span",{children:[" Total: ",c.jsx("strong",{children:Z.length})]}),c.jsxs("span",{children:[" To Bill: ",c.jsx("strong",{children:Z.filter(M=>M.toBeBilled==="Yes").length})]}),c.jsxs("span",{children:[" Invoiced: ",c.jsx("strong",{children:Z.filter(M=>M.invoiceGenerated).length})]}),c.jsxs("span",{children:[" Approved: ",c.jsx("strong",{children:Z.filter(M=>M.invoiceStatus==="Approved").length})]}),_n==="closed"&&c.jsxs("span",{children:[" Closed: ",c.jsx("strong",{children:Z.filter(M=>M.receiptStatus==="Received"||M.receiptStatus==="Cancelled"||M.receiptStatus==="Closed").length})]})]}),c.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:["Total: ",et(Z.filter(M=>M.toBeBilled==="Yes").reduce((M,O)=>M+(parseFloat(O.totalWithGst)||0),0))]})]})]})},R4=h=>{var Z;const _=(Z=h.target.files)==null?void 0:Z[0];if(!_)return;const V=new FileReader;V.onload=B=>{const H=Nl(B.target.result,{type:"binary",cellDates:!0}),M=H.SheetNames[0],O=H.Sheets[M],ae=Er.sheet_to_json(O,{raw:!1}),te=new Set(nn.map(oe=>`${oe.date}|${oe.partyName}|${oe.serviceType||oe.campaignName}`.toLowerCase()));let he=0,J=0;const re=ae.map((oe,ge)=>{const Ae=(oe["TYPE OF SERVICE"]||oe["Type of Service"]||oe["SERVICE TYPE"]||oe["Service Type"]||oe["CAMPAIGN NAME"]||oe["Campaign Name"]||"").trim().toUpperCase();let Ye=oe.DATE||oe.Date||new Date;typeof Ye=="string"&&(Ye=new Date(Ye));const Xe=(oe["PARTY NAME"]||oe["Party Name"]||"").trim(),Qe=oe.EMAIL||oe.Email||"",at=oe.STATE||oe.State||oe["State/Party Details"]||oe["STATE/PARTY DETAILS"]||"",Me=oe.AMOUNT||oe.Amount||$n[Xe]||"",tt=Ye instanceof Date&&!isNaN(Ye)?Ye.toISOString().split("T")[0]:"",Zt=(oe["Client Code"]||oe["CLIENT CODE"]||oe.Code||"").toString().trim()||Dn(Xe,at),ir=oe["PO?"]||oe.PO||oe["WITH PO"]||"",_r=ir.toLowerCase().includes("with po")||ir.toLowerCase()==="yes",z=oe["PO Number"]||oe["PO NUMBER"]||oe["PO No"]||oe["PO NO"]||"";let Te=oe["PO Date"]||oe["PO DATE"]||"";typeof Te=="object"&&Te instanceof Date&&(Te=Te.toISOString().split("T")[0]);const St=`${tt}|${Xe}|${Ae}`.toLowerCase();return te.has(St)?(he++,null):(te.add(St),J++,{id:Date.now()+ge+Math.random(),sno:oe.SNO||oe["SNO."]||oe.Sno||ge+1,date:tt,statePartyDetails:at,partyName:Xe,clientCode:Zt,serviceType:Ae,emailId:Qe,additionalEmails:[],toBeBilled:"Not Yet",invoiceAmount:Me,cgst:"",sgst:"",igst:"",totalWithGst:"",invoiceType:"Individual",invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",mailingSent:"No",mailDate:"",mailerUploaded:!1,editComments:"",approvalRemarks:"",isService:!0,poStatus:_r?"With PO":"Without PO",poNumber:_r?z:"",poDate:_r?Te:""})}).filter(oe=>oe!==null);if(re.length>0){const oe=[...nn,...re];console.log("Setting services data:",oe.length,"entries"),Ce(oe);const ge=[...new Set(re.map(Ae=>Ae.partyName))];de(Ae=>{const Ye=new Set(Ae);return ge.forEach(Xe=>Ye.add(Xe)),Ye}),setTimeout(async()=>{console.log("Triggering immediate save for services data..."),wo.current=!1;try{await hd("indreesh-media",{masterData:Ee,servicesData:oe,ledgerEntries:se,receipts:Be,creditNotes:ne,openingBalances:Hn,mailerImages:tn,mailerLogo:Ot,companyConfig:w,nextInvoiceNo:Ne,nextCombineNo:rt,nextReceiptNo:Dt,nextCreditNoteNo:Nt,nextServiceInvoiceNo:He,invoiceValues:$n,notifications:Ke,whatsappSettings:st,partyMaster:rn,followups:Pt,userPasswords:y}),console.log("Services data saved successfully!"),m(new Date)}catch(Ae){console.error("Error saving services data:",Ae)}},100)}let nt=` Services Upload Complete!

`;nt+=` ${J} new entries added
`,he>0&&(nt+=` ${he} duplicate entries skipped`),J>0&&Qi("upload",` ${J} new services uploaded`,"director"),alert(nt)},V.readAsBinaryString(_),h.target.value=""},Ju=(h,_,V)=>{Ce(Z=>Z.map(B=>B.id===h?{...B,[_]:V}:B))},D4=h=>{de(_=>{const V=new Set(_);return V.has(h)?V.delete(h):V.add(h),V})},fg=h=>{const _=Ie.find(V=>V.id===h);if(_!=null&&_.invoiceGenerated&&(_==null?void 0:_.invoiceStatus)==="Approved"){alert("Cannot delete approved invoices");return}confirm("Delete this service entry?")&&Ce(V=>V.filter(Z=>Z.id!==h))},P4=h=>{var he;const _=Ie.find(J=>J.id===h);if(!_)return;if(!_.invoiceAmount||parseFloat(_.invoiceAmount)<=0){alert("Please enter a valid invoice amount");return}const V=`${w.invoicePrefix}${He}`,Z=new Date().toISOString().split("T")[0],B=(he=_.statePartyDetails)==null?void 0:he.toUpperCase().includes("MAHARASHTRA"),H=parseFloat(_.invoiceAmount),M=B?H*.09:0,O=B?H*.09:0,ae=B?0:H*.18,te=H+M+O+ae;Ce(J=>J.map(re=>re.id===h?{...re,invoiceNo:V,invoiceDate:Z,invoiceTotalAmount:te.toFixed(2),cgst:M.toFixed(2),sgst:O.toFixed(2),igst:ae.toFixed(2),totalWithGst:te.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created"}:re)),fr(J=>J+1),Qi("invoice_created",`Service Invoice ${V} created for ${_.partyName}`,"director")},Ay=h=>{const _=getPartyGstinFromMaster(h.partyName,h.statePartyDetails),V=Al(h.partyName,h.statePartyDetails),Z=h.statePartyDetails,B=parseFloat(h.invoiceAmount)||0,H=parseFloat(h.cgst)||0,M=parseFloat(h.sgst)||0,O=parseFloat(h.igst)||0,ae=parseFloat(h.invoiceTotalAmount)||B+H+M+O,te=H>0,he=`
<!DOCTYPE html>
<html>
<head>
  <title>Tax Invoice - ${h.invoiceNo}</title>
  <style>
    @media print { body { -webkit-print-color-adjust: exact !important; } @page { size: A4; margin: 10mm; } }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; font-size: 12px; }
    .invoice-container { max-width: 800px; margin: 0 auto; border: 2px solid #000; }
  </style>
</head>
<body>
  <div class="invoice-container">
    <div style="text-align: center; padding: 15px; border-bottom: 2px solid #000; font-size: 20px; font-weight: bold;">Tax Invoice</div>
    <div style="text-align: center; padding: 5px; border-bottom: 1px solid #000; font-style: italic; font-size: 11px; background: #f5f5f5;">(Original for Recipient)</div>
    <div style="display: flex; border-bottom: 2px solid #000;">
      <div style="flex: 1.5; padding: 12px; border-right: 2px solid #000;">
        <div style="font-size: 16px; font-weight: bold; color: #1a5276; margin-bottom: 8px;">${w.name}</div>
        <div style="font-size: 11px; line-height: 1.5;">${w.address}<br>${w.addressLine2}, ${w.city}<br><strong>GSTIN/UIN:</strong> ${w.gstin}<br><strong>State:</strong> ${w.stateName}, Code: ${w.stateCode}<br><strong>Contact:</strong> ${w.phone}<br><strong>E-Mail:</strong> ${w.email}</div>
      </div>
      <div style="flex: 1; padding: 0;">
        <div style="display: flex; border-bottom: 1px solid #000;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Invoice No.</div><div style="flex: 1; padding: 8px; color: #1a5276; font-weight: bold;">${h.invoiceNo}</div></div>
        <div style="display: flex;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Dated</div><div style="flex: 1; padding: 8px;">${wt(h.invoiceDate)}</div></div>
      </div>
    </div>
    <div style="padding: 10px 12px; border-bottom: 2px solid #000; background: #fafafa;">
      <div style="font-size: 11px; color: #666; margin-bottom: 3px;">Buyer (Bill to)</div>
      <div style="font-size: 14px; font-weight: bold; margin-bottom: 4px; color: #1a5276;">${h.partyName}</div>
      <div style="font-size: 11px; color: #333;">${V?V+"<br>":""}${Z||""}${_?"<br><strong>GSTIN/UIN:</strong> "+_:""}<br>Place of Supply: ${Z||w.stateName}</div>
    </div>
    <table style="width: 100%; border-collapse: collapse;">
      <thead><tr style="background: #e8e8e8;"><th style="border: 1px solid #000; padding: 10px; width: 45px;">Sl No.</th><th style="border: 1px solid #000; padding: 10px;">Particulars</th><th style="border: 1px solid #000; padding: 10px; width: 80px;">HSN/SAC</th><th style="border: 1px solid #000; padding: 10px; width: 100px; text-align: right;">Amount</th></tr></thead>
      <tbody>
        <tr>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">1</td>
          <td style="border: 1px solid #000; padding: 8px;">
            <div style="font-weight: 600;">${(h.serviceType||h.campaignName||"SERVICE").toUpperCase()}</div>
            <div style="font-style: italic; color: #555; font-size: 11px;">Date: ${wt(h.date)}</div>
          </td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${w.hsnCode}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: right;">${bt(B)}</td>
        </tr>
        ${te?`
          <tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600;">CGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right;">${bt(H)}</td></tr>
          <tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600;">SGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right;">${bt(M)}</td></tr>
        `:`
          <tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600;">IGST @ 18%</td><td style="border: 1px solid #000; padding: 8px; text-align: right;">${bt(O)}</td></tr>
        `}
        <tr style="background: #2874A6; color: white;"><td colspan="3" style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;">Total</td><td style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;"> ${ae.toLocaleString("en-IN",{minimumFractionDigits:2})}</td></tr>
      </tbody>
    </table>
    <div style="padding: 10px 12px; border: 1px solid #000; border-top: none; background: #fafafa;"><div style="color: #666; font-size: 11px; margin-bottom: 3px;">Amount Chargeable (in words)</div><div style="font-weight: bold; font-size: 13px;">${th(ae)}</div></div>
    <div style="display: flex; border-top: 2px solid #000;">
      <div style="flex: 1; padding: 10px 12px; border-right: 2px solid #000; font-size: 11px;"><div><strong>Company's PAN:</strong> ${w.pan}</div><div style="margin-top: 4px;"><strong>MSME Reg. No.:</strong> UDYAM-MH-19-0057219</div></div>
      <div style="flex: 1.2; padding: 10px 12px; font-size: 11px;">
        <div style="font-weight: bold; margin-bottom: 6px; color: #1a5276;">Company's Bank Details</div>
        <div style="line-height: 1.5;"><strong>A/c Holder:</strong> ${w.bank.holder}<br><strong>Bank:</strong> ${w.bank.name}<br><strong>A/c No.:</strong> ${w.bank.account}<br><strong>IFSC:</strong> ${w.bank.ifsc}</div>
        <div style="text-align: right; margin-top: 30px;"><div style="font-weight: bold;">for ${w.name}</div><div style="margin-top: 25px; border-top: 1px solid #000; display: inline-block; padding-top: 4px; font-size: 10px;">Authorised Signatory</div></div>
      </div>
    </div>
    <div style="text-align: center; padding: 8px; background: #f0f0f0; border-top: 1px solid #000; font-size: 10px; color: #666; font-style: italic;">This is a Computer Generated Invoice</div>
  </div>
</body>
</html>`,J=window.open("","_blank");J.document.write(he),J.document.close(),J.print()},O4=ye.useMemo(()=>[...new Set(nn.map(h=>h.partyName).filter(Boolean))].sort(),[nn]),hg=ye.useMemo(()=>nn.filter(h=>!(me.party&&h.partyName!==me.party||me.billStatus&&h.toBeBilled!==me.billStatus||me.invoiceStatus&&(me.invoiceStatus==="Pending"&&h.invoiceGenerated||me.invoiceStatus==="Created"&&h.invoiceStatus!=="Created"||me.invoiceStatus==="Approved"&&h.invoiceStatus!=="Approved"||me.invoiceStatus==="Need Edits"&&h.invoiceStatus!=="Need Edits"))),[nn,me]),M4=()=>{const h=r==="director",_=r==="finance";console.log("Services Render Debug:",{servicesDataType:typeof Ie,servicesDataIsArray:Array.isArray(Ie),servicesDataLength:Ie==null?void 0:Ie.length,safeServicesDataLength:nn.length,filteredServicesDataLength:hg.length,role:r,serviceFilters:me,servicesSheetTab:qi,rawServicesData:Ie});const V=hg.filter(O=>!O.invoiceGenerated||O.invoiceStatus!=="Approved"),Z=hg.filter(O=>O.invoiceGenerated&&O.invoiceStatus==="Approved"),B=qi==="open"?V:Z;console.log("Services Tab Data:",{openCount:V.length,closedCount:Z.length,currentTab:qi});const H={};B.forEach(O=>{const ae=O.partyName||"Unknown";H[ae]||(H[ae]=[]),H[ae].push(O)});const M=Object.keys(H).sort();if(h&&M.length>0&&Q.size===0){const O=new Set(M);de(O)}return c.jsxs("div",{style:{padding:"20px"},children:[c.jsx("input",{type:"file",ref:wl,onChange:R4,accept:".xlsx,.xls,.csv",style:{display:"none"}}),c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[c.jsxs("div",{children:[c.jsx("h1",{style:{fontSize:"22px",fontWeight:"700",color:"#1E293B",marginBottom:"4px"},children:" Services Sheet"}),c.jsxs("p",{style:{fontSize:"13px",color:"#64748B"},children:["Non-campaign invoices  Total: ",nn.length," entries"]})]}),c.jsx("div",{style:{display:"flex",gap:"10px"},children:_&&c.jsxs(c.Fragment,{children:[c.jsx(ze,{icon:Qs,label:"Upload Excel",onClick:()=>{var O;return(O=wl.current)==null?void 0:O.click()}}),c.jsx(ze,{icon:jL,label:"Force Save",variant:"secondary",onClick:async()=>{try{wo.current=!1,await hd("indreesh-media",{masterData:Ee,servicesData:Ie,ledgerEntries:se,receipts:Be,creditNotes:ne,openingBalances:Hn,mailerImages:tn,mailerLogo:Ot,companyConfig:w,nextInvoiceNo:Ne,nextCombineNo:rt,nextReceiptNo:Dt,nextCreditNoteNo:Nt,nextServiceInvoiceNo:He,invoiceValues:$n,notifications:Ke,whatsappSettings:st,partyMaster:rn,followups:Pt,userPasswords:y}),m(new Date),alert("Data saved successfully!")}catch(O){console.error("Save error:",O),alert("Error saving: "+O.message)}}}),c.jsx(ze,{icon:dd,label:"Add Entry",variant:"primary",onClick:()=>L(!0)})]})})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsx(ud,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"}),c.jsxs("select",{value:me.party,onChange:O=>fe(ae=>({...ae,party:O.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"},children:[c.jsx("option",{value:"",children:"All Parties"}),O4.map(O=>c.jsx("option",{value:O,children:O},O))]}),c.jsxs("select",{value:me.billStatus,onChange:O=>fe(ae=>({...ae,billStatus:O.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"},children:[c.jsx("option",{value:"",children:"All Bill Status"}),c.jsx("option",{value:"Yes",children:"To Be Billed"}),c.jsx("option",{value:"No",children:"Not Billing"}),c.jsx("option",{value:"Not Yet",children:"Not Yet"})]}),c.jsxs("select",{value:me.invoiceStatus,onChange:O=>fe(ae=>({...ae,invoiceStatus:O.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"},children:[c.jsx("option",{value:"",children:"All Invoice Status"}),c.jsx("option",{value:"Pending",children:"Pending"}),c.jsx("option",{value:"Created",children:"Created"}),c.jsx("option",{value:"Approved",children:"Approved"}),c.jsx("option",{value:"Need Edits",children:"Need Edits"})]}),(me.party||me.billStatus||me.invoiceStatus)&&c.jsxs("button",{onClick:()=>fe({party:"",billStatus:"",invoiceStatus:""}),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer"},children:[c.jsx(_a,{size:14})," Clear"]})]})}),c.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"20px",justifyContent:"space-between",alignItems:"center"},children:[c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsxs("button",{onClick:()=>b("open"),style:{padding:"10px 20px",fontSize:"13px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:qi==="open"?"#2874A6":"#E2E8F0",color:qi==="open"?"#FFFFFF":"#64748B"},children:["Open (",V.length,")"]}),c.jsxs("button",{onClick:()=>b("closed"),style:{padding:"10px 20px",fontSize:"13px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:qi==="closed"?"#22C55E":"#E2E8F0",color:qi==="closed"?"#FFFFFF":"#64748B"},children:["Closed (",Z.length,")"]})]}),c.jsx("button",{onClick:()=>{Q.size===M.length?de(new Set):de(new Set(M))},style:{padding:"8px 16px",fontSize:"12px",fontWeight:"600",border:"1px solid #CBD5E1",borderRadius:"6px",cursor:"pointer",backgroundColor:"#F8FAFC",color:"#475569"},children:Q.size===M.length?"Collapse All":"Expand All"})]}),c.jsx(pn,{title:`Services - ${qi==="open"?"Open":"Closed"}`,noPadding:!0,children:M.length===0?c.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:[c.jsx(rm,{size:40,style:{marginBottom:"10px",opacity:.5}}),c.jsx("p",{children:"No services in this tab"}),_&&c.jsx("p",{style:{marginTop:"10px",fontSize:"13px"},children:"Upload Excel or Add Entry to get started"})]}):M.map(O=>{const ae=H[O],te=Q.has(O),he=ae.filter(J=>J.toBeBilled==="Yes").reduce((J,re)=>J+(parseFloat(re.totalWithGst)||parseFloat(re.invoiceAmount)||0),0);return c.jsxs("div",{style:{borderBottom:"2px solid #E2E8F0"},children:[c.jsxs("div",{onClick:()=>D4(O),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",backgroundColor:qi==="closed"?"#F0FDF4":"#F8FAFC",cursor:"pointer",borderBottom:te?"3px solid #2874A6":"none"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[te?c.jsx(em,{size:20,color:"#2874A6"}):c.jsx($0,{size:20,color:"#64748B"}),c.jsx("span",{style:{fontWeight:"700",fontSize:"15px",color:"#1E293B"},children:O}),c.jsxs("span",{style:{padding:"4px 10px",backgroundColor:"#E0E7FF",color:"#3730A3",borderRadius:"9999px",fontSize:"12px",fontWeight:"600"},children:[ae.length," items"]})]}),c.jsx("div",{style:{fontWeight:"700",color:"#059669"},children:et(he)})]}),te&&c.jsx("div",{style:{overflowX:"auto"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F1F5F9"},children:[c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569"},children:"Date"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#6B21A8",backgroundColor:"#FAF5FF"},children:"Code"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569"},children:"State"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569"},children:"Type of Service"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569"},children:"Emails"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"Mailer"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"PO?"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"To Bill"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"600",color:"#475569"},children:"Amount"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"Create"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569",backgroundColor:"#EFF6FF"},children:"Invoice No"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569",backgroundColor:"#EFF6FF"},children:"Inv Date"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"600",color:"#475569",backgroundColor:"#EFF6FF"},children:"Inv Amt"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"Approval"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"Actions"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569",backgroundColor:"#F0FDF4"},children:"Mailed"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569",backgroundColor:"#F0FDF4"},children:"Mail Date"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569",backgroundColor:"#FEF3C7"},children:"Receipt"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"600",color:"#475569",backgroundColor:"#FEF3C7"},children:"Received"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"600",color:"#475569",backgroundColor:"#FEF3C7"},children:"TDS"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"600",color:"#475569",backgroundColor:"#FEF3C7"},children:"Balance"})]})}),c.jsx("tbody",{children:ae.map(J=>{const re=tn[J.id]&&tn[J.id].length>0;[J.emailId,...J.additionalEmails||[]].filter(Boolean);const nt=J.clientCode||Dn(J.partyName,J.statePartyDetails),oe=Rn.filter(Qe=>Qe.invoiceNo===J.invoiceNo),ge=oe.reduce((Qe,at)=>Qe+(parseFloat(at.amount)||0),0),Ae=oe.reduce((Qe,at)=>Qe+(parseFloat(at.tds)||parseFloat(at.tdsAmount)||0),0),Xe=(parseFloat(J.invoiceTotalAmount)||0)-ge-Ae;return c.jsxs("tr",{style:{backgroundColor:J.toBeBilled==="Yes"?J.invoiceGenerated?"#F0FDF4":"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #F1F5F9"},children:[c.jsx("td",{style:{padding:"10px 8px",whiteSpace:"nowrap"},children:wt(J.date)}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center",backgroundColor:"#FAF5FF"},children:c.jsx("span",{style:{fontWeight:"700",color:"#6B21A8",fontSize:"11px"},children:nt||"-"})}),c.jsx("td",{style:{padding:"10px 8px",fontSize:"11px",color:"#64748B"},children:J.statePartyDetails||"-"}),c.jsx("td",{style:{padding:"10px 8px",fontWeight:"600",maxWidth:"180px"},children:c.jsx("div",{style:{color:"#1E293B"},children:J.serviceType||J.campaignName||"-"})}),c.jsx("td",{style:{padding:"10px 8px"},children:c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[J.emailId&&c.jsx("div",{style:{fontSize:"11px",color:"#1E40AF",backgroundColor:"#EFF6FF",padding:"2px 6px",borderRadius:"4px",display:"inline-block"},children:J.emailId}),(J.additionalEmails||[]).map((Qe,at)=>c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[c.jsx("span",{style:{fontSize:"11px",color:"#059669",backgroundColor:"#F0FDF4",padding:"2px 6px",borderRadius:"4px"},children:Qe}),_&&c.jsx("button",{onClick:()=>Ju(J.id,"additionalEmails",(J.additionalEmails||[]).filter(Me=>Me!==Qe)),style:{background:"none",border:"none",cursor:"pointer",padding:"2px",color:"#DC2626"},title:"Remove",children:c.jsx(_a,{size:12})})]},at)),_&&c.jsxs("button",{onClick:()=>{hr(J),Ws(""),pt(!0)},style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",color:"#2874A6",background:"none",border:"none",cursor:"pointer",padding:"2px 0"},children:[c.jsx(nm,{size:12})," Add"]})]})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:re?c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[c.jsx("span",{style:{color:"#22C55E",fontWeight:"700",fontSize:"14px"},children:""}),_&&c.jsx("button",{onClick:()=>{hr(J),Bi(null),Ua(!0),Zr(!0)},style:{fontSize:"10px",color:"#64748B",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},children:"Replace"})]}):_&&c.jsx(ze,{icon:J_,small:!0,variant:"default",onClick:()=>{hr(J),Bi(null),Ua(!1),Zr(!0)}})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:J.poStatus==="With PO"?c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[c.jsx("span",{style:{color:"#22C55E",fontWeight:"600",fontSize:"10px"},children:" PO"}),c.jsx("span",{style:{fontSize:"9px",color:"#64748B"},children:J.poNumber})]}):c.jsx("span",{style:{color:"#CBD5E1",fontSize:"10px"},children:"No PO"})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:c.jsxs("select",{value:J.toBeBilled,onChange:Qe=>Ju(J.id,"toBeBilled",Qe.target.value),disabled:J.invoiceGenerated||!h,style:{padding:"6px 8px",fontSize:"12px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:J.toBeBilled==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:J.toBeBilled==="Yes"?"#DCFCE7":"#FFFFFF",color:J.toBeBilled==="Yes"?"#166534":"#64748B",cursor:J.invoiceGenerated||!h?"not-allowed":"pointer",width:"70px",opacity:!h&&!J.invoiceGenerated?.6:1},children:[c.jsx("option",{value:"Not Yet",children:"Not Yet"}),c.jsx("option",{value:"Yes",children:"Yes"})]})}),c.jsx("td",{style:{padding:"10px 8px"},children:c.jsx("input",{type:"number",value:J.invoiceAmount||"",onChange:Qe=>Ju(J.id,"invoiceAmount",Qe.target.value),disabled:J.invoiceGenerated,placeholder:"0",style:{width:"80px",padding:"6px 8px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #D1D5DB",borderRadius:"6px",textAlign:"right",backgroundColor:J.invoiceGenerated?"#F3F4F6":"#FFFFFF"}})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:J.toBeBilled==="Yes"&&!J.invoiceGenerated&&J.invoiceAmount&&_?c.jsx(ze,{icon:Io,label:"Create",small:!0,variant:"warning",onClick:()=>P4(J.id)}):J.toBeBilled==="Yes"&&!J.invoiceGenerated&&J.invoiceAmount&&h?c.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Finance to create"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 8px",backgroundColor:"#EFF6FF"},children:J.invoiceNo?c.jsx("span",{style:{fontWeight:"700",color:"#1E40AF",fontSize:"12px"},children:J.invoiceNo}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 8px",backgroundColor:"#EFF6FF",fontSize:"12px"},children:J.invoiceDate?wt(J.invoiceDate):"-"}),c.jsx("td",{style:{padding:"10px 8px",backgroundColor:"#EFF6FF",textAlign:"right",fontWeight:"700",color:"#1E40AF",fontSize:"13px"},children:J.invoiceTotalAmount?bt(J.invoiceTotalAmount):"-"}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:J.invoiceGenerated?h?c.jsx("button",{onClick:()=>dn(J),style:{padding:"5px 10px",fontSize:"11px",fontWeight:"700",border:"1.5px solid",borderRadius:"6px",cursor:"pointer",backgroundColor:J.invoiceStatus==="Approved"?"#DCFCE7":J.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",borderColor:J.invoiceStatus==="Approved"?"#22C55E":J.invoiceStatus==="Need Edits"?"#DC2626":"#F59E0B",color:J.invoiceStatus==="Approved"?"#166534":J.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:J.invoiceStatus==="Approved"?" Approved":J.invoiceStatus==="Need Edits"?" Need Edits":" Review"}):c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px"},children:[c.jsx("span",{style:{padding:"4px 10px",fontSize:"11px",fontWeight:"700",borderRadius:"6px",backgroundColor:J.invoiceStatus==="Approved"?"#DCFCE7":J.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",color:J.invoiceStatus==="Approved"?"#166534":J.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:J.invoiceStatus==="Approved"?" Approved":J.invoiceStatus==="Need Edits"?" Need Edits":" Pending"}),(J.editComments||J.approvalRemarks)&&c.jsx("button",{onClick:()=>{hr(J),Sr(!0)},style:{fontSize:"9px",color:J.invoiceStatus==="Need Edits"?"#991B1B":"#166534",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},title:J.editComments||J.approvalRemarks,children:"View Remarks"})]}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:J.invoiceGenerated&&J.invoiceStatus==="Approved"?c.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[c.jsx(ze,{icon:Rc,small:!0,onClick:()=>Ay(J),title:"View Invoice"}),_&&c.jsx(ze,{icon:K0,small:!0,variant:"brand",onClick:()=>{hr(J),Xi(!0)},title:"Send Email"}),_&&c.jsx(ze,{icon:rs,small:!0,variant:"danger",onClick:()=>fg(J.id),title:"Delete"})]}):J.invoiceGenerated?c.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[c.jsx(ze,{icon:Rc,small:!0,onClick:()=>Ay(J),title:"View Invoice"}),_&&c.jsx(ze,{icon:rs,small:!0,variant:"danger",onClick:()=>fg(J.id),title:"Delete"})]}):_?c.jsx(ze,{icon:rs,small:!0,variant:"danger",onClick:()=>fg(J.id),title:"Delete"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center",backgroundColor:"#F0FDF4"},children:J.invoiceGenerated&&J.invoiceStatus==="Approved"&&_?c.jsxs("select",{value:J.mailingSent||"No",onChange:Qe=>Ju(J.id,"mailingSent",Qe.target.value),style:{padding:"5px 8px",fontSize:"11px",fontWeight:"700",border:"2px solid",borderRadius:"6px",borderColor:J.mailingSent==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:J.mailingSent==="Yes"?"#DCFCE7":"#FFFFFF",color:J.mailingSent==="Yes"?"#166534":"#64748B",cursor:"pointer",width:"60px"},children:[c.jsx("option",{value:"No",children:"No"}),c.jsx("option",{value:"Yes",children:"Yes"})]}):J.invoiceGenerated&&J.invoiceStatus==="Approved"&&h?c.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"11px",fontWeight:"600",backgroundColor:J.mailingSent==="Yes"?"#DCFCE7":"#FEF3C7",color:J.mailingSent==="Yes"?"#166534":"#92400E"},children:J.mailingSent==="Yes"?" Yes":" No"}):J.invoiceGenerated&&J.invoiceStatus!=="Approved"?c.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Approve first"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center",backgroundColor:"#F0FDF4"},children:J.mailingSent==="Yes"?_?c.jsx("input",{type:"date",value:J.mailDate||"",onChange:Qe=>Ju(J.id,"mailDate",Qe.target.value),style:{padding:"4px 6px",fontSize:"11px",border:"1px solid #D1D5DB",borderRadius:"4px",width:"110px"}}):c.jsx("span",{style:{fontSize:"11px"},children:J.mailDate?wt(J.mailDate):"-"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center",backgroundColor:"#FEF3C7"},children:J.invoiceGenerated&&J.invoiceStatus==="Approved"?oe.length>0?c.jsx("span",{style:{fontSize:"11px",color:"#166534",fontWeight:"600"},children:oe.map(Qe=>Qe.receiptNo).join(", ")}):_?c.jsx(ze,{icon:eE,small:!0,variant:"warning",onClick:()=>{hr(J),setReceiptData({date:new Date().toISOString().split("T")[0],amount:"",tds:"",paymentMode:"Bank Transfer",narration:""}),Pa(!0)},title:"Post Receipt"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"right",backgroundColor:"#FEF3C7",fontWeight:"600",color:ge>0?"#166534":"#CBD5E1"},children:ge>0?bt(ge):"-"}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"right",backgroundColor:"#FEF3C7",fontWeight:"600",color:Ae>0?"#1E40AF":"#CBD5E1"},children:Ae>0?bt(Ae):"-"}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"right",backgroundColor:"#FEF3C7",fontWeight:"700",color:Xe>0?"#DC2626":"#166534"},children:J.invoiceGenerated?Xe>0?bt(Xe):" Paid":"-"})]},J.id)})})]})})]},O)})}),B.length>0&&c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"16px"},children:c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"16px 24px",borderRadius:"10px",border:"2px solid #86EFAC"},children:[c.jsx("div",{style:{fontSize:"12px",color:"#166534",fontWeight:"600",marginBottom:"4px"},children:"To Be Billed Total"}),c.jsx("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:et(B.filter(O=>O.toBeBilled==="Yes").reduce((O,ae)=>O+(parseFloat(ae.totalWithGst)||parseFloat(ae.invoiceAmount)||0),0))})]})}),c.jsx(Mn,{isOpen:K,onClose:()=>L(!1),title:" Add Service Entry",width:"600px",children:c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Date *"}),c.jsx("input",{type:"date",id:"svcDate",defaultValue:new Date().toISOString().split("T")[0],style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"State *"}),c.jsx("input",{type:"text",id:"svcState",placeholder:"Maharashtra",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Party Name *"}),c.jsx("input",{list:"svcPartyList",id:"svcParty",placeholder:"Party name",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}}),c.jsx("datalist",{id:"svcPartyList",children:Object.values(rn).map((O,ae)=>c.jsx("option",{value:O.partyName},ae))})]}),c.jsxs("div",{children:[c.jsxs("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:["Type of Service * ",c.jsx("span",{style:{color:"#64748B",fontWeight:"400"},children:"(This will appear as narration in invoice)"})]}),c.jsx("input",{type:"text",id:"svcType",placeholder:"e.g. PODCAST PRODUCTION, VIDEO EDITING, SOCIAL MEDIA MANAGEMENT",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px",textTransform:"uppercase"}})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Email"}),c.jsx("input",{type:"email",id:"svcEmail",placeholder:"email@example.com",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Amount (without GST)"}),c.jsx("input",{type:"number",id:"svcAmount",placeholder:"0",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]})]}),c.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"8px"},children:[c.jsx(ze,{label:"Cancel",variant:"secondary",onClick:()=>L(!1)}),c.jsx(ze,{label:"Add Entry",icon:dd,onClick:()=>{var he,J,re,nt,oe,ge,Ae,Ye,Xe;const O=(J=(he=document.getElementById("svcParty"))==null?void 0:he.value)==null?void 0:J.trim(),ae=(oe=(nt=(re=document.getElementById("svcType"))==null?void 0:re.value)==null?void 0:nt.trim())==null?void 0:oe.toUpperCase();if(!O||!ae){alert("Fill required fields (Party Name and Type of Service)");return}const te={id:Date.now().toString(),sno:nn.length+1,date:((ge=document.getElementById("svcDate"))==null?void 0:ge.value)||new Date().toISOString().split("T")[0],statePartyDetails:((Ae=document.getElementById("svcState"))==null?void 0:Ae.value)||"",partyName:O,serviceType:ae,emailId:((Ye=document.getElementById("svcEmail"))==null?void 0:Ye.value)||"",additionalEmails:[],toBeBilled:"Not Yet",invoiceAmount:((Xe=document.getElementById("svcAmount"))==null?void 0:Xe.value)||"",cgst:"",sgst:"",igst:"",totalWithGst:"",invoiceType:"Individual",invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",mailingSent:"No",mailDate:"",mailerUploaded:!1,editComments:"",approvalRemarks:"",isService:!0};Ce(Qe=>[...Qe,te]),de(Qe=>new Set([...Qe,O])),L(!1)}})]})]})})]})},B4=h=>{const _=[],V=ae=>{if(!ae)return"";const te=ae.split("/");return te.length>=3?te.slice(1).join("/"):te.length===2?te.join("/"):te[te.length-1]},Z=Gn.filter(ae=>{var te;return ae.isHistorical&&(ae.type==="creditnote"||((te=ae.vchNo)==null?void 0:te.toUpperCase().startsWith("CN")))}),B=new Map;Si.forEach(ae=>{const te=V(ae.invoiceNo);te&&B.set(te,{...ae,isSystemCN:!0})}),Z.forEach(ae=>{const te=V(ae.vchNo);te&&!B.has(te)&&B.set(te,{...ae,isHistoricalCN:!0})});const H={};h.forEach(ae=>{const te=ae.partyName||"Unknown";H[te]||(H[te]=[]),H[te].push(ae)}),Object.keys(H).sort().forEach(ae=>{H[ae].forEach(he=>{const J=V(he.invoiceNo),re=B.get(J),nt=re?Math.abs(parseFloat(re.totalAmount||re.credit||re.debit)||0):0,oe=Rn.filter(at=>at.invoiceNo===he.invoiceNo),ge=oe.reduce((at,Me)=>at+(parseFloat(Me.amount)||0),0),Ae=oe.reduce((at,Me)=>at+(parseFloat(Me.tds||Me.tdsAmount)||0),0),Ye=he.totalAmount-ge-Ae-nt;let Xe="Pending";nt>=he.totalAmount?Xe="Cancelled":Ye<=0?Xe="Paid":(ge>0||Ae>0||nt>0)&&(Xe="Partial");let Qe=he.poStatus==="With PO"?`${he.poNumber||""}${he.poDate?`
`+wt(he.poDate):""}`:"Without PO";_.push({"Client Code":he.clientCode||"","Party Name":ae,"Invoice No":he.invoiceNo,Date:wt(he.date),Type:he.isService?"Service":he.invoiceType||"Individual","PO?":Qe,Amount:he.totalAmount,Received:ge||"",TDS:Ae||"","CN Amount":nt||"",Balance:Ye>0?Ye:0,"Invoice Status":he.invoiceStatus,"Receipt Status":Xe,"Receipt No":oe.map(at=>at.receiptNo).join(", "),"CN No":re?re.isSystemCN?re.creditNoteNo:re.vchNo:""})})});const M=Er.json_to_sheet(_),O=Er.book_new();Er.book_append_sheet(O,M,"Invoice Register"),Nc(O,`Invoice_Register_${new Date().toISOString().split("T")[0]}.xlsx`)},j4=()=>{const h=Er.book_new();let _=0;const V=Z=>{if(!Z)return"";const B=Z.split("/");return B.length>=3?B.slice(1).join("/"):B.length===2?B.join("/"):B[B.length-1]};if(Ji.forEach(Z=>{const B=Z.partyName,H=Z.normalizedState,M=Hn[B]||0,O=[...wn,...nn].filter(z=>Jt(z.partyName,B)&&z.invoiceGenerated&&z.invoiceStatus==="Approved"&&(!H||Kn(z.statePartyDetails)===H)),ae=new Map;O.forEach(z=>{ae.has(z.invoiceNo)?ae.get(z.invoiceNo).campaigns.push(z):ae.set(z.invoiceNo,{invoiceNo:z.invoiceNo,invoiceDate:z.invoiceDate,campaigns:[z],statePartyDetails:z.statePartyDetails})});const te=new Set(Array.from(ae.keys())),he=Rn.filter(z=>Jt(z.partyName,B)&&(!H||te.has(z.invoiceNo))),J=Si.filter(z=>Jt(z.partyName,B)&&(!H||te.has(z.invoiceNo))),re=H?[]:Gn.filter(z=>{var Te;return Jt(z.partyName,B)&&z.isHistorical&&!((Te=z.vchNo)!=null&&Te.toUpperCase().startsWith("CN"))}),nt=H?[]:Gn.filter(z=>{var Te;return Jt(z.partyName,B)&&z.isHistorical&&((Te=z.vchNo)==null?void 0:Te.toUpperCase().startsWith("CN"))}),oe=new Map;J.forEach(z=>{const Te=V(z.invoiceNo);Te&&oe.set(Te,{...z,isSystemCN:!0})}),nt.forEach(z=>{const Te=V(z.vchNo);Te&&!oe.has(Te)&&oe.set(Te,z)});const ge=[];let Ae=M,Ye=0,Xe=0,Qe=0,at=0;const Me=new Set;ge.push([B]),ge.push(["Ledger Account"]),Z.address&&ge.push([Z.address]),Z.state&&ge.push([Z.state]),Z.gstin&&ge.push(["GSTIN: "+Z.gstin]),ge.push([]),ge.push(["Date","Particular","Vch Type","Vch No.","Debit","Credit","Date of Receipt","Amount Received","TDS Received","Balance","Payment Status"]),M!==0&&(ge.push(["","Opening Balance","","",M>0?M:"",M<0?Math.abs(M):"","","","",M,""]),M>0?Ye+=M:Xe+=Math.abs(M));const tt=[];if(Array.from(ae.values()).forEach(z=>{tt.push({...z,entryType:"invoice",sortDate:z.invoiceDate})}),re.forEach(z=>{tt.push({...z,entryType:"historical",sortDate:z.date})}),tt.sort((z,Te)=>new Date(z.sortDate)-new Date(Te.sortDate)),tt.forEach(z=>{var Te;if(z.entryType==="invoice"){const St=z,Gt=St.campaigns.reduce((xr,Kr)=>xr+(parseFloat(Kr.invoiceAmount)||0),0),lt=(Te=St.statePartyDetails)==null?void 0:Te.toUpperCase().includes("MAHARASHTRA"),kt=lt?Gt*.09:0,Mt=lt?Gt*.09:0,Yt=lt?0:Gt*.18,rr=Gt+kt+Mt+Yt,Lr=he.filter(xr=>xr.invoiceNo===St.invoiceNo),kr=Lr.reduce((xr,Kr)=>xr+(parseFloat(Kr.amount)||0),0),mr=Lr.reduce((xr,Kr)=>xr+(parseFloat(Kr.tds||Kr.tdsAmount)||0),0),Ft=Lr.length>0?wt(Lr[0].date):"",Ur=V(St.invoiceNo),jt=oe.get(Ur),An=jt?Math.abs(parseFloat(jt.totalAmount||jt.credit)||0):0,Zi=!!jt;let On="Pending",fn=rr-kr-mr;if(Zi&&An>=rr?(On="CN Closed",fn=0):(kr>0||mr>0)&&(On="Received"),Ae+=rr,Ye+=rr,ge.push([wt(St.invoiceDate),B,"Sales",St.invoiceNo,rr,"",Ft,kr||"",mr||"",Zi?"-":fn,On]),ge.push(["","    PROMOTIONAL TRADE EMAILER"+(St.campaigns.length>1?"S":""),"","","",Gt,"","","","",""]),lt?(ge.push(["","    CGST","","","",kt,"","","","",""]),ge.push(["","    SGST","","","",Mt,"","","","",""])):ge.push(["","    IGST","","","",Yt,"","","","",""]),(kr>0||mr>0)&&(Ae-=kr+mr,Qe+=kr,at+=mr),jt&&!Me.has(Ur)){Me.add(Ur),Ae-=An,Xe+=An,ge.push([wt(jt.date),B,"Credit Note",jt.creditNoteNo||jt.vchNo,"",An,"","","","-",""]);const xr=An/1.18,Kr=An-xr;ge.push(["","    PROMOTIONAL TRADE EMAILER","","","",xr,"","","","",""]),lt?ge.push(["","    CGST/SGST","","","",Kr,"","","","",""]):ge.push(["","    IGST","","","",Kr,"","","","",""])}}else if(z.entryType==="historical"){const St=z,Gt=parseFloat(St.debit)||0,lt=V(St.vchNo),kt=oe.get(lt),Mt=!!kt;if(Ae+=Gt,Ye+=Gt,ge.push([wt(St.date),St.particular||B,St.vchType||"Sales",St.vchNo||"",Gt,"",St.receiptDate?wt(St.receiptDate):"",St.amountReceived||"",St.tdsReceived||"",Mt?"-":Ae,Mt?"CN Closed":St.paymentStatus||""]),kt&&!Me.has(lt)){Me.add(lt);const Yt=Math.abs(parseFloat(kt.totalAmount||kt.credit||kt.debit)||0);Ae-=Yt,Xe+=Yt,ge.push([wt(kt.date),B,"Credit Note",kt.creditNoteNo||kt.vchNo,"",Yt,"","","","-",""])}}}),ge.length<=7)return;ge.push([]),ge.push(["","TOTAL","","",Ye,Xe,"",Qe,at,"",""]),ge.push(["","Closing Balance","","",Ae>0?Ae:"",Ae<0?Math.abs(Ae):"","","","",Ae,""]);let $t=B.substring(0,25).replace(/[\\\/\*\?\[\]:]/g,"");H&&($t+="-"+H.substring(0,4));let Zt=$t,ir=1;for(;h.SheetNames.includes(Zt);)Zt=$t.substring(0,27)+ir++;const _r=Er.aoa_to_sheet(ge);Er.book_append_sheet(h,_r,Zt),_++}),_===0){alert("No ledger data to export");return}Nc(h,`All_Ledgers_${new Date().toISOString().split("T")[0]}.xlsx`)},L4=()=>{const h=M=>{const O=parseFloat(M.totalAmount)||0;let ae=parseFloat(M.baseAmount)||parseFloat(M.amount)||0,te=parseFloat(M.gst)||(parseFloat(M.cgstAmount)||0)+(parseFloat(M.sgstAmount)||0)+(parseFloat(M.igstAmount)||0);return ae===0&&O>0&&(ae=O/1.18,te=O-ae),{base:ae,gst:te,total:O}},_=Rn.map(M=>{const O=parseFloat(M.amount)||0,ae=parseFloat(M.tds)||parseFloat(M.tdsAmount)||0;return{Type:"Receipt","Voucher No":M.receiptNo,Date:wt(M.date),"Party Name":M.partyName,"Against Invoice":M.invoiceNo,Amount:O,TDS:ae,Total:O+ae,"Payment Mode":M.paymentMode||M.mode||"Bank Transfer",Narration:M.narration||""}}),V=Si.map(M=>{const O=h(M);return{Type:"Credit Note","Voucher No":M.creditNoteNo,Date:wt(M.date),"Party Name":M.partyName,"Against Invoice":M.invoiceNo,"Base Amount":O.base,GST:O.gst,Total:O.total,Reason:M.reason||""}}),Z=Er.book_new();if(_.length>0){const M=Er.json_to_sheet(_);Er.book_append_sheet(Z,M,"Receipts")}if(V.length>0){const M=Er.json_to_sheet(V);Er.book_append_sheet(Z,M,"Credit Notes")}const B=[..._.map(M=>({...M,"Base Amount":"",GST:"",Reason:""})),...V.map(M=>({Type:M.Type,"Voucher No":M["Voucher No"],Date:M.Date,"Party Name":M["Party Name"],"Against Invoice":M["Against Invoice"],Amount:M["Base Amount"],TDS:M.GST,Total:M.Total,"Payment Mode":"",Narration:M.Reason}))],H=Er.json_to_sheet(B);Er.book_append_sheet(Z,H,"Combined"),Nc(Z,`Receipt_CN_Register_${new Date().toISOString().split("T")[0]}.xlsx`)},U4=h=>{const _=parseFloat(h.amount)||0,V=parseFloat(h.tds)||parseFloat(h.tdsAmount)||0,Z=_+V,B=h.clientCode||Dn(h.partyName,h.statePartyDetails||""),H=`<!DOCTYPE html><html><head><title>Receipt - ${h.receiptNo}</title><style>@media print{@page{size:A5;margin:10mm}}*{margin:0;padding:0;box-sizing:border-box}body{font-family:Arial,sans-serif;font-size:12px;padding:20px}.voucher{max-width:600px;margin:0 auto;border:2px solid #000}.header{text-align:center;padding:15px;border-bottom:2px solid #000;background:#f5f5f5}.title{font-size:18px;font-weight:bold;color:#1a5276}.company{font-size:14px;font-weight:bold;margin-top:5px}.details{padding:15px}.row{display:flex;margin-bottom:10px}.label{width:140px;font-weight:bold}.value{flex:1}.amount-box{background:#e8f4fd;padding:15px;margin:15px 0;border-radius:8px;text-align:center}.amount{font-size:24px;font-weight:bold;color:#1a5276}.footer{padding:15px;border-top:1px solid #ddd;display:flex;justify-content:space-between}.signature{text-align:center;margin-top:40px}.signature-line{border-top:1px solid #000;width:150px;margin:0 auto;padding-top:5px}.client-code{background:#f3e8ff;color:#6b21a8;padding:3px 8px;border-radius:4px;font-weight:bold;font-size:11px}</style></head><body><div class="voucher"><div class="header"><div class="title">RECEIPT VOUCHER</div><div class="company">${w.name}</div><div style="font-size:10px;color:#666;margin-top:3px">${w.address}, ${w.city}</div></div><div class="details"><div class="row"><div class="label">Receipt No:</div><div class="value" style="font-weight:bold;color:#1a5276">${h.receiptNo}</div></div><div class="row"><div class="label">Date:</div><div class="value">${wt(h.date)}</div></div>${B?`<div class="row"><div class="label">Client Code:</div><div class="value"><span class="client-code">${B}</span></div></div>`:""}<div class="row"><div class="label">Received From:</div><div class="value" style="font-weight:bold">${h.partyName}</div></div><div class="row"><div class="label">Against Invoice:</div><div class="value">${h.invoiceNo}</div></div><div class="row"><div class="label">Payment Mode:</div><div class="value">${h.paymentMode||h.mode||"Bank Transfer"}</div></div>${h.narration?`<div class="row"><div class="label">Narration:</div><div class="value">${h.narration}</div></div>`:""}<div class="amount-box"><div style="font-size:12px;color:#666">Amount Received</div><div class="amount">${_.toLocaleString("en-IN",{minimumFractionDigits:2})}</div>${V>0?`<div style="font-size:11px;color:#666;margin-top:5px">TDS: ${V.toLocaleString("en-IN",{minimumFractionDigits:2})}</div>`:""}<div style="font-size:11px;margin-top:8px"><strong>Total:</strong> ${Z.toLocaleString("en-IN",{minimumFractionDigits:2})}</div></div><div style="font-size:11px;color:#666;margin-top:10px"><strong>Amount in words:</strong> ${th(Z)}</div></div><div class="footer"><div class="signature"><div class="signature-line">Receiver's Signature</div></div><div class="signature"><div class="signature-line">Authorised Signatory</div></div></div></div></body></html>`,M=window.open("","_blank");M.document.write(H),M.document.close(),M.print()},V4=h=>{const _=parseFloat(h.totalAmount)||0;let V=parseFloat(h.baseAmount)||parseFloat(h.amount)||0,Z=parseFloat(h.gst)||(parseFloat(h.cgstAmount)||0)+(parseFloat(h.sgstAmount)||0)+(parseFloat(h.igstAmount)||0);V===0&&_>0&&(V=_/1.18,Z=_-V);const B=h.clientCode||Dn(h.partyName,h.statePartyDetails||""),H=`<!DOCTYPE html><html><head><title>CN - ${h.creditNoteNo}</title><style>@media print{@page{size:A5;margin:10mm}}*{margin:0;padding:0;box-sizing:border-box}body{font-family:Arial,sans-serif;font-size:12px;padding:20px}.voucher{max-width:600px;margin:0 auto;border:2px solid #000}.header{text-align:center;padding:15px;border-bottom:2px solid #000;background:#fef3c7}.title{font-size:18px;font-weight:bold;color:#92400e}.company{font-size:14px;font-weight:bold;margin-top:5px}.details{padding:15px}.row{display:flex;margin-bottom:10px}.label{width:140px;font-weight:bold}.value{flex:1}.amount-box{background:#fef3c7;padding:15px;margin:15px 0;border-radius:8px;text-align:center}.amount{font-size:24px;font-weight:bold;color:#92400e}.footer{padding:15px;border-top:1px solid #ddd;display:flex;justify-content:space-between}.signature{text-align:center;margin-top:40px}.signature-line{border-top:1px solid #000;width:150px;margin:0 auto;padding-top:5px}.client-code{background:#f3e8ff;color:#6b21a8;padding:3px 8px;border-radius:4px;font-weight:bold;font-size:11px}</style></head><body><div class="voucher"><div class="header"><div class="title">CREDIT NOTE</div><div class="company">${w.name}</div><div style="font-size:10px;color:#666;margin-top:3px">${w.address}, ${w.city}</div></div><div class="details"><div class="row"><div class="label">Credit Note No:</div><div class="value" style="font-weight:bold;color:#92400e">${h.creditNoteNo}</div></div><div class="row"><div class="label">Date:</div><div class="value">${wt(h.date)}</div></div>${B?`<div class="row"><div class="label">Client Code:</div><div class="value"><span class="client-code">${B}</span></div></div>`:""}<div class="row"><div class="label">Party Name:</div><div class="value" style="font-weight:bold">${h.partyName}</div></div><div class="row"><div class="label">Against Invoice:</div><div class="value">${h.invoiceNo}</div></div><div class="row"><div class="label">Reason:</div><div class="value">${h.reason||"Adjustment"}</div></div><div class="amount-box"><div style="font-size:12px;color:#666">Credit Amount</div><div class="amount">${_.toLocaleString("en-IN",{minimumFractionDigits:2})}</div><div style="font-size:10px;color:#666;margin-top:5px">Base: ${V.toLocaleString("en-IN",{minimumFractionDigits:2})} | GST: ${Z.toLocaleString("en-IN",{minimumFractionDigits:2})}</div></div><div style="font-size:11px;color:#666;margin-top:10px"><strong>Amount in words:</strong> ${th(_)}</div></div><div class="footer"><div class="signature"><div class="signature-line">Party Signature</div></div><div class="signature"><div class="signature-line">Authorised Signatory</div></div></div></div></body></html>`,M=window.open("","_blank");M.document.write(H),M.document.close(),M.print()},z4=()=>{const h=new Map;wn.filter(te=>te.invoiceGenerated).forEach(te=>{if(h.has(te.invoiceNo))h.get(te.invoiceNo).campaigns.push(te);else{const he=te.clientCode||Dn(te.partyName,te.statePartyDetails);h.set(te.invoiceNo,{invoiceNo:te.invoiceNo,partyName:te.partyName,clientCode:he,statePartyDetails:te.statePartyDetails,date:te.invoiceDate,invoiceType:te.invoiceType,combinationCode:te.combinationCode,invoiceStatus:te.invoiceStatus,mailingSent:te.mailingSent,receiptStatus:te.receiptStatus||"Pending",receiptNo:te.receiptNo,campaigns:[te],totalAmount:parseFloat(te.invoiceTotalAmount)||0,isFromMaster:!0,source:"Campaign",poStatus:te.poStatus,poNumber:te.poNumber,poDate:te.poDate})}}),nn.filter(te=>te.invoiceGenerated).forEach(te=>{if(!h.has(te.invoiceNo)){const he=te.clientCode||Dn(te.partyName,te.statePartyDetails);h.set(te.invoiceNo,{invoiceNo:te.invoiceNo,partyName:te.partyName,clientCode:he,statePartyDetails:te.statePartyDetails,date:te.invoiceDate,invoiceType:"Service",combinationCode:"NA",invoiceStatus:te.invoiceStatus,mailingSent:te.mailingSent,receiptStatus:te.receiptStatus||"Pending",receiptNo:te.receiptNo,campaigns:[te],totalAmount:parseFloat(te.invoiceTotalAmount)||0,isFromMaster:!1,isService:!0,source:"Service",serviceType:te.serviceType,poStatus:te.poStatus,poNumber:te.poNumber,poDate:te.poDate})}});const _=te=>{if(!te)return"";const he=te.split("/");return he.length>=3?he.slice(1).join("/"):he.length===2?he.join("/"):he[he.length-1]},V=Gn.filter(te=>{var he;return te.isHistorical&&(te.type==="creditnote"||((he=te.vchNo)==null?void 0:he.toUpperCase().startsWith("CN")))}),Z=new Map;Si.forEach(te=>{const he=_(te.invoiceNo);he&&Z.set(he,te)}),V.forEach(te=>{const he=_(te.vchNo);he&&!Z.has(he)&&Z.set(he,te)}),Gn.filter(te=>{var he;return te.isHistorical&&te.type!=="creditnote"&&!((he=te.vchNo)!=null&&he.toUpperCase().startsWith("CN"))&&te.debit>0}).forEach(te=>{if(!h.has(te.vchNo)){const he=Rn.find(Xe=>Xe.invoiceNo===te.vchNo),J=_(te.vchNo),re=Z.get(J),nt=re?Math.abs(parseFloat(re.totalAmount)||parseFloat(re.credit)||parseFloat(re.debit)||0):0,oe=parseFloat(te.debit)||0;if(re&&nt>=oe)return;const Ae=!he&&!(te.amountReceived>0),Ye=re&&nt>0&&nt<oe;if(Ae||Ye){const Xe=Ye?oe-nt:oe;h.set(te.vchNo,{invoiceNo:te.vchNo,partyName:te.partyName,date:te.date,invoiceType:"Historical",combinationCode:"",invoiceStatus:"Approved",mailingSent:"Yes",receiptStatus:Ye?"Partial CN":"Pending",receiptNo:"",campaigns:[],totalAmount:oe,pendingAmount:Xe,hasPartialCN:Ye,cnAmount:nt,isHistorical:!0,historicalEntry:te})}}});let B=Array.from(h.values());if(we.party&&(B=B.filter(te=>Jt(te.partyName,we.party))),we.invoiceStatus&&(B=B.filter(te=>te.invoiceStatus===we.invoiceStatus)),we.receiptStatus&&(we.receiptStatus==="Received"?B=B.filter(te=>te.receiptStatus==="Received"):we.receiptStatus==="Pending"&&(B=B.filter(te=>te.receiptStatus!=="Received"))),we.invoiceType&&(B=B.filter(te=>te.invoiceType===we.invoiceType)),we.searchText){const te=we.searchText.toLowerCase();B=B.filter(he=>{var J,re;return((J=he.invoiceNo)==null?void 0:J.toLowerCase().includes(te))||((re=he.partyName)==null?void 0:re.toLowerCase().includes(te))})}const H={};B.forEach(te=>{H[te.partyName]||(H[te.partyName]=[]),H[te.partyName].push(te)});const M=Object.keys(H).sort(),O=we.party||we.invoiceStatus||we.receiptStatus||we.invoiceType||we.searchText,ae=Array.from(h.values());return c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Invoice & Receipt Register"}),c.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[c.jsx(ze,{icon:bo,label:"Export Excel",variant:"secondary",onClick:()=>B4(B)}),yr&&c.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"})]})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(ud,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"})]}),c.jsxs("div",{style:{position:"relative"},children:[c.jsx(X0,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",placeholder:"Search invoice...",value:we.searchText,onChange:te=>Ue(he=>({...he,searchText:te.target.value})),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"160px"}})]}),c.jsxs("select",{value:we.party,onChange:te=>Ue(he=>({...he,party:te.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Parties"}),Cl.map(te=>c.jsx("option",{value:te,children:te},te))]}),c.jsxs("select",{value:we.invoiceStatus,onChange:te=>Ue(he=>({...he,invoiceStatus:te.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Status"}),c.jsx("option",{value:"Created",children:"Created"}),c.jsx("option",{value:"Approved",children:"Approved"}),c.jsx("option",{value:"Need Edits",children:"Need Edits"})]}),c.jsxs("select",{value:we.receiptStatus,onChange:te=>Ue(he=>({...he,receiptStatus:te.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Receipts"}),c.jsx("option",{value:"Received",children:"Received"}),c.jsx("option",{value:"Pending",children:"Pending"})]}),c.jsxs("select",{value:we.invoiceType,onChange:te=>Ue(he=>({...he,invoiceType:te.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Types"}),c.jsx("option",{value:"Individual",children:"Individual"}),c.jsx("option",{value:"Combined",children:"Combined"})]}),O&&c.jsxs(c.Fragment,{children:[c.jsxs("button",{onClick:()=>Ue({party:"",invoiceStatus:"",receiptStatus:"",invoiceType:"",searchText:""}),style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(_a,{size:14})," Clear"]}),c.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",B.length," of ",ae.length]})]})]})}),c.jsx(pn,{noPadding:!0,children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[c.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700",color:"#6B21A8",backgroundColor:"#FAF5FF"},children:"Code"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Date"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Type"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:"Amount"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#F0FDF4",color:"#166534"},children:"Received"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEF3C7",color:"#92400E"},children:"TDS"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:"CN Amt"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#EFF6FF",color:"#1E40AF"},children:"Balance"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Inv. Status"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Receipt No."}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"CN No."}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),c.jsx("tbody",{children:M.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:"13",style:{padding:"50px",textAlign:"center",color:"#94A3B8"},children:O?"No matching invoices":"No invoices generated yet"})}):M.map(te=>{var oe;const he=H[te],J=a0.has(te);let re=0;he.forEach(ge=>{const Ae=Be.find(_r=>_r.invoiceNo===ge.invoiceNo),Ye=ne.find(_r=>_r.invoiceNo===ge.invoiceNo),Xe=se.find(_r=>_r.invoiceNo===ge.invoiceNo&&_r.type==="tds"),Qe=se.find(_r=>_r.invoiceNo===ge.invoiceNo&&_r.type==="discount"),at=ge.totalAmount||0,Me=Ae&&parseFloat(Ae.amount)||0,tt=Xe?parseFloat(Xe.credit)||0:Ae&&parseFloat(Ae.tds)||0,$t=Ye?Math.abs(parseFloat(Ye.totalAmount)||0):0,Zt=Qe&&parseFloat(Qe.credit)||0,ir=Math.max(0,at-Me-tt-$t-Zt);re+=ir});const nt=((oe=he[0])==null?void 0:oe.clientCode)||"";return c.jsxs(sh.Fragment,{children:[c.jsxs("tr",{onClick:()=>wy(te),style:{backgroundColor:"#1E3A5F",color:"white",cursor:"pointer",borderBottom:"1px solid #0F2744"},children:[c.jsx("td",{colSpan:"4",style:{padding:"10px 12px",fontWeight:"700",fontSize:"13px"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[J?c.jsx(em,{size:18}):c.jsx($0,{size:18}),c.jsx(sE,{size:16}),nt&&c.jsx("span",{style:{backgroundColor:"#9333EA",padding:"2px 8px",borderRadius:"6px",fontSize:"11px"},children:nt}),te,c.jsxs("span",{style:{backgroundColor:"#2874A6",padding:"2px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600"},children:[he.length," inv"]})]})}),c.jsx("td",{colSpan:"4",style:{padding:"10px 12px"}}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",fontSize:"13px",backgroundColor:re===0?"#22C55E":"#3B82F6"},children:re===0?" Nil":`Bal: ${et(re)}`}),c.jsx("td",{colSpan:"4",style:{padding:"10px 12px"}})]}),J&&he.map(ge=>{const Ae=Be.find(z=>z.invoiceNo===ge.invoiceNo),Ye=ne.find(z=>z.invoiceNo===ge.invoiceNo),Xe=se.find(z=>z.invoiceNo===ge.invoiceNo&&z.type==="tds"),Qe=se.find(z=>z.invoiceNo===ge.invoiceNo&&z.type==="discount"),at=ge.totalAmount||0,Me=Ae&&parseFloat(Ae.amount)||0,tt=Xe?parseFloat(Xe.credit)||0:Ae&&parseFloat(Ae.tds)||0,$t=Ye?Math.abs(parseFloat(Ye.totalAmount)||0):0,Zt=Qe&&parseFloat(Qe.credit)||0,ir=Math.max(0,at-Me-tt-$t-Zt),_r=$t>=at&&!Ae;return c.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:ge.invoiceType==="Combined"?"#FAF5FF":ir===0?"#F0FDF4":"transparent"},children:[c.jsx("td",{style:{padding:"10px 12px 10px 36px",fontWeight:"700",color:ge.invoiceType==="Combined"?"#7C3AED":"#2874A6"},children:ge.invoiceNo}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center",backgroundColor:"#FAF5FF"},children:c.jsx("span",{style:{fontWeight:"700",color:"#6B21A8",fontSize:"11px"},children:ge.clientCode||"-"})}),c.jsx("td",{style:{padding:"10px 12px"},children:wt(ge.date)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsx(gm,{status:ge.invoiceType,small:!0})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:et(at)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#F0FDF4",color:Me>0?"#166534":"#94A3B8"},children:Me>0?et(Me):"-"}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#FEF3C7",color:tt>0?"#92400E":"#94A3B8"},children:tt>0?et(tt):"-"}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#FEE2E2",color:$t>0?"#991B1B":"#94A3B8"},children:$t>0?et($t):"-"}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#EFF6FF",color:ir>0?"#1E40AF":"#166534"},children:ir===0?" Nil":et(ir)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsx(gm,{status:ge.invoiceStatus,small:!0})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:_r?c.jsx("span",{style:{padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:" Cancelled"}):Ae?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",justifyContent:"center"},children:[c.jsxs("button",{onClick:()=>h4(Ae),style:{padding:"4px 8px",borderRadius:"12px",fontSize:"10px",fontWeight:"700",backgroundColor:"#DCFCE7",color:"#166534",border:"none",cursor:"pointer",textDecoration:"underline"},title:"Click to view receipt",children:[" ",Ae.receiptNo]}),sr&&c.jsx("button",{onClick:()=>JF(Ae),style:{padding:"2px 4px",borderRadius:"4px",fontSize:"10px",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete Receipt",children:""})]}):c.jsx("span",{style:{padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600",backgroundColor:"#FEF3C7",color:"#92400E"},children:" Pending"})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:Ye?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",justifyContent:"center"},children:[c.jsx("button",{onClick:()=>p4(Ye),style:{padding:"4px 8px",borderRadius:"12px",fontSize:"10px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer",textDecoration:"underline"},title:"Click to view credit note",children:Ye.creditNoteNo}),sr&&c.jsx("button",{onClick:()=>ZF(Ye),style:{padding:"2px 4px",borderRadius:"4px",fontSize:"10px",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete Credit Note",children:""})]}):c.jsx("span",{style:{color:"#94A3B8",fontSize:"11px"},children:"-"})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsx("div",{style:{display:"flex",gap:"4px",justifyContent:"center",flexWrap:"wrap"},children:ge.isHistorical?c.jsxs(c.Fragment,{children:[sr&&!Ae&&c.jsx(ze,{icon:Io,small:!0,variant:"success",onClick:()=>{const z={invoiceNo:ge.invoiceNo,partyName:ge.partyName,invoiceDate:ge.date,invoiceTotalAmount:ge.totalAmount,invoiceStatus:"Approved",mailingSent:"Yes",invoiceType:"Historical",isHistorical:!0};Tn(z)},title:"Create Receipt"}),sr&&!Ye&&c.jsx(ze,{icon:cd,small:!0,variant:"primary",onClick:()=>{const z={invoiceNo:ge.invoiceNo,partyName:ge.partyName,invoiceDate:ge.date,invoiceTotalAmount:ge.totalAmount,invoiceStatus:"Approved",isHistorical:!0};Ui(z)},title:"Credit Note"})]}):c.jsxs(c.Fragment,{children:[c.jsx(ze,{icon:Rc,small:!0,variant:"brand",onClick:()=>Qu(ge.campaigns[0]),title:"View Invoice"}),sr&&ge.invoiceStatus==="Approved"&&ge.mailingSent==="Yes"&&!Ae&&c.jsx(ze,{icon:Io,small:!0,variant:"success",onClick:()=>Tn(ge.campaigns[0]),title:"Create Receipt"}),sr&&ge.invoiceStatus==="Approved"&&!Ye&&c.jsx(ze,{icon:cd,small:!0,variant:"primary",onClick:()=>Ui(ge.campaigns[0]),title:"Credit Note"}),sr&&c.jsx(ze,{icon:rs,small:!0,variant:"danger",onClick:()=>dg(ge.campaigns[0]),title:"Delete Invoice"})]})})})]},ge.invoiceNo)})]},te)})})]})})]})},W4=()=>{if(!X){alert("Please select a party first");return}const h=Hn[X]||0,_=Ee.filter(z=>Jt(z.partyName,X)&&z.invoiceGenerated&&z.invoiceStatus==="Approved"&&(!Se||Kn(z.statePartyDetails)===Se)),V=new Map;_.forEach(z=>{V.has(z.invoiceNo)?V.get(z.invoiceNo).campaigns.push(z):V.set(z.invoiceNo,{invoiceNo:z.invoiceNo,invoiceDate:z.invoiceDate,campaigns:[z],isFromMaster:!0})});const Z=new Set(Array.from(V.keys())),B=Se?[]:se.filter(z=>{var Te;return Jt(z.partyName,X)&&z.isHistorical&&z.type!=="creditnote"&&!((Te=z.vchNo)!=null&&Te.toUpperCase().startsWith("CN"))}),H=Se?[]:se.filter(z=>{var Te;return Jt(z.partyName,X)&&z.isHistorical&&(z.type==="creditnote"||((Te=z.vchNo)==null?void 0:Te.toUpperCase().startsWith("CN")))}),M=Be.filter(z=>Jt(z.partyName,X)&&(!Se||Z.has(z.invoiceNo))),O=ne.filter(z=>Jt(z.partyName,X)&&(!Se||Z.has(z.invoiceNo))),ae=z=>{if(!z)return"";const Te=z.split("/");return Te.length>=3?Te.slice(1).join("/"):Te.length===2?Te.join("/"):Te[Te.length-1]},te=new Map;O.forEach(z=>{const Te=ae(z.invoiceNo);Te&&!te.has(Te)&&te.set(Te,{...z,isSystemCN:!0})}),H.forEach(z=>{const Te=ae(z.vchNo);Te&&!te.has(Te)&&te.set(Te,{...z,isHistoricalCN:!0})});let he=[],J=0,re=0,nt=0,oe=0,ge=h;const Ae=new Set;h!==0&&(J+=h>0?h:0,re+=h<0?Math.abs(h):0,he.push({date:"",particular:"Opening Balance",vchType:"",vchNo:"",debit:h>0?h:0,credit:h<0?Math.abs(h):0,receiptDate:"",amountReceived:0,tds:0,balance:h,status:"",isMain:!0,isOpening:!0}));const Ye=[];Array.from(V.values()).filter(z=>{const Te=new Date(z.invoiceDate);return Te>=new Date(yn.fromDate)&&Te<=new Date(yn.toDate)}).forEach(z=>{Ye.push({...z,entryType:"invoice",sortDate:z.invoiceDate})}),B.filter(z=>{if(!z.date)return!1;const Te=new Date(z.date);return Te>=new Date(yn.fromDate)&&Te<=new Date(yn.toDate)}).forEach(z=>{Ye.push({...z,entryType:"invoice",sortDate:z.date})}),Ye.sort((z,Te)=>new Date(z.sortDate)-new Date(Te.sortDate)),Ye.forEach(z=>{var Te,St;if(z.isFromMaster){const Gt=z;let lt=0;Gt.campaigns.forEach(fn=>lt+=parseFloat(fn.invoiceAmount)||0);const kt=(St=(Te=Gt.campaigns[0])==null?void 0:Te.statePartyDetails)==null?void 0:St.toUpperCase().includes("MAHARASHTRA"),Mt=kt?lt*.09:0,Yt=kt?lt*.09:0,rr=kt?0:lt*.18,Lr=lt+Mt+Yt+rr,kr=ae(Gt.invoiceNo),mr=te.get(kr),Ft=!!mr,Ur=M.find(fn=>fn.invoiceNo===Gt.invoiceNo);ge+=Lr,J+=Lr;let jt=0,An=0,Zi="",On=Ft?"":"Pending";if(Ur&&(On="Received",jt=Ur.amount||0,An=Ur.tds||0,Zi=Ur.date,nt+=jt,oe+=An,ge-=jt+An+(Ur.discount||0)),he.push({date:Gt.invoiceDate,particular:X,vchType:"Sales",vchNo:Gt.invoiceNo,debit:Lr,credit:0,receiptDate:Zi,amountReceived:jt,tds:An,balance:Ft?"-":On==="Received"?0:Lr-jt-An,status:On,isMain:!0,hasCN:Ft}),he.push({particular:"PROMOTIONAL TRADE EMAILER"+(Gt.campaigns.length>1?"S":""),credit:lt,isMain:!1,hasCN:Ft}),kt?(he.push({particular:"CGST",credit:Mt,isMain:!1,hasCN:Ft}),he.push({particular:"SGST",credit:Yt,isMain:!1,hasCN:Ft})):he.push({particular:"IGST",credit:rr,isMain:!1,hasCN:Ft}),mr&&!Ae.has(kr)){Ae.add(kr);const fn=Math.abs(mr.totalAmount||mr.credit||0);ge-=fn,re+=fn,he.push({date:mr.date,particular:X,vchType:"Credit Note",vchNo:mr.creditNoteNo||mr.vchNo,debit:0,credit:fn,receiptDate:"",amountReceived:0,tds:0,balance:"-",status:"",isMain:!0,isCreditNote:!0,hasCN:!0});const xr=Math.abs(mr.amount)||fn/1.18,Kr=Math.abs(mr.gst)||fn-xr;he.push({particular:"PROMOTIONAL TRADE EMAILER",credit:xr,isMain:!1,isCreditNote:!0,hasCN:!0}),he.push({particular:mr.gstType||(kt?"CGST + SGST":"IGST"),credit:Kr,isMain:!1,isCreditNote:!0,hasCN:!0})}}else if(z.isHistorical){const Gt=z.debit||0,lt=z.credit||0,kt=ae(z.vchNo),Mt=te.get(kt),Yt=!!Mt;if(ge+=Gt-lt,J+=Gt,re+=lt,he.push({date:z.date,particular:z.particulars||X,vchType:z.vchType||"Sales",vchNo:z.vchNo,debit:Gt,credit:lt,receiptDate:z.receiptDate||"",amountReceived:z.amountReceived||0,tds:z.tdsReceived||0,balance:Yt?"-":Gt-(z.amountReceived||0)-(z.tdsReceived||0),status:Yt?"":z.paymentStatus||"",isMain:!0,isHistorical:!0,hasCN:Yt}),z.subRows&&z.subRows.length>0&&z.subRows.forEach(rr=>{he.push({particular:rr.particular,debit:rr.debit,credit:rr.credit,isMain:!1,hasCN:Yt})}),Mt&&!Ae.has(kt)){Ae.add(kt);const rr=Math.abs(Mt.totalAmount||Mt.credit||0);ge-=rr,re+=rr,he.push({date:Mt.date,particular:X,vchType:"Credit Note",vchNo:Mt.creditNoteNo||Mt.vchNo,debit:0,credit:rr,receiptDate:"",amountReceived:0,tds:0,balance:"-",status:"",isMain:!0,isCreditNote:!0,hasCN:!0}),Mt.subRows&&Mt.subRows.length>0&&Mt.subRows.forEach(Lr=>{he.push({particular:Lr.particular,credit:Math.abs(Lr.credit||0),isMain:!1,isCreditNote:!0,hasCN:!0})})}}});const Xe=he.reduce((z,Te)=>Te.isMain&&typeof Te.balance=="number"&&Te.balance>0?z+Te.balance:z,0),Qe=(X||"").trim().toUpperCase();let at={};Se&&(at=Ji.find(z=>z.partyNameUpper===Qe&&z.normalizedState===Se)||{}),at.state||(at=Ji.find(z=>z.partyNameUpper===Qe)||{});const Me=Ee.find(z=>{var Te;return((Te=z.partyName)==null?void 0:Te.trim().toUpperCase())===Qe}),tt=at.state||(Me==null?void 0:Me.statePartyDetails)||"",$t=at.address||Al(X,tt)||"",Zt=at.gstin||So(X,tt),ir=`
<!DOCTYPE html>
<html>
<head>
  <title>Ledger Account - ${X}</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; font-size: 11px; padding: 20px; }
    .header { text-align: center; margin-bottom: 15px; }
    .firm-name { font-size: 18px; font-weight: bold; color: #1E293B; }
    .firm-address { font-size: 10px; color: #666; margin-top: 2px; }
    .party-section { text-align: center; margin: 15px 0; padding: 10px; border: 1px solid #ddd; background: #f9f9f9; }
    .party-name { font-size: 14px; font-weight: bold; }
    .ledger-title { font-size: 11px; color: #666; }
    .party-address { font-size: 10px; color: #666; margin-top: 5px; }
    .party-gstin { font-size: 10px; color: #1a5276; margin-top: 3px; font-weight: 600; }
    .period { text-align: center; font-size: 11px; margin: 10px 0; font-weight: bold; }
    .totals { display: flex; justify-content: space-around; background: #e8f4fd; padding: 8px; margin-bottom: 10px; font-size: 10px; border: 1px solid #ccc; }
    .totals div { text-align: center; }
    .totals .label { color: #666; }
    .totals .value { font-weight: bold; font-size: 11px; }
    .closing-balance { text-align: center; background: #1E293B; color: white; padding: 10px; margin-bottom: 10px; font-size: 14px; font-weight: bold; }
    table { width: 100%; border-collapse: collapse; font-size: 10px; }
    th { background: #f0f0f0; border: 1px solid #ccc; padding: 6px 4px; text-align: left; font-weight: bold; }
    td { border: 1px solid #ddd; padding: 5px 4px; }
    .text-right { text-align: right; }
    .text-center { text-align: center; }
    .main-row { background: #fff; }
    .main-row-cn { background: #fffbeb; }
    .sub-row { background: #fafafa; }
    .sub-row-cn { background: #fffbeb; }
    .sub-row td { padding-left: 20px; color: #666; font-size: 9px; }
    .opening-row { background: #fef3c7; font-weight: bold; }
    .credit-note-row { background: #fffbeb; }
    .status-received { background: #dcfce7; color: #166534; padding: 2px 6px; border-radius: 3px; font-size: 9px; }
    .status-pending { background: #fef3c7; color: #92400e; padding: 2px 6px; border-radius: 3px; font-size: 9px; }
    .debit { color: #dc2626; }
    .credit { color: #059669; }
    @media print { 
      body { padding: 10px; } 
      @page { size: landscape; margin: 10mm; }
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="firm-name">${w.name}</div>
    <div class="firm-address">${w.address}</div>
    <div class="firm-address">${w.addressLine2}, ${w.city}</div>
    <div class="firm-address">E-Mail: ${w.email}</div>
  </div>
  
  <div class="party-section">
    <div class="party-name">${X}</div>
    <div class="ledger-title">Ledger Account</div>
    ${$t?`<div class="party-address">${$t}</div>`:""}
    ${tt?`<div class="party-address"> ${tt}</div>`:""}
    ${Zt?`<div class="party-gstin">GSTIN: ${Zt}</div>`:""}
  </div>
  
  <div class="period">${wt(yn.fromDate)} to ${wt(yn.toDate)}</div>
  
  <div class="closing-balance">
    Closing Balance: ${bt(Math.abs(Xe))} ${Xe>0?"(Dr)":Xe<0?"(Cr)":""}
  </div>
  
  <div class="totals">
    <div><div class="label">Debit</div><div class="value">${bt(J)}</div></div>
    <div><div class="label">Credit</div><div class="value">${bt(re)}</div></div>
    <div><div class="label">Amount Received</div><div class="value credit">${bt(nt)}</div></div>
    <div><div class="label">TDS Received</div><div class="value">${bt(oe)}</div></div>
  </div>
  
  <table>
    <thead>
      <tr>
        <th style="width:65px">Date</th>
        <th>Particular</th>
        <th style="width:70px" class="text-center">Vch Type</th>
        <th style="width:100px">Vch No.</th>
        <th style="width:80px" class="text-right">Debit</th>
        <th style="width:80px" class="text-right">Credit</th>
        <th style="width:70px" class="text-center">Date of Receipt</th>
        <th style="width:85px" class="text-right">Amount Received</th>
        <th style="width:70px" class="text-right">TDS Received</th>
        <th style="width:75px" class="text-right">Balance</th>
        <th style="width:70px" class="text-center">Payment Status</th>
      </tr>
    </thead>
    <tbody>
      ${he.map(z=>z.isMain?`
        <tr class="${z.isOpening?"opening-row":z.hasCN||z.isCreditNote?"main-row-cn":"main-row"}">
          <td>${z.date?wt(z.date):""}</td>
          <td style="font-weight:600">${z.particular}</td>
          <td class="text-center">${z.vchType||""}</td>
          <td style="color:#2874A6;font-weight:600">${z.vchNo||""}</td>
          <td class="text-right">${z.debit>0?bt(z.debit):""}</td>
          <td class="text-right" style="color:#DC2626">${z.credit>0?bt(z.credit):""}</td>
          <td class="text-center">${z.receiptDate?wt(z.receiptDate):""}</td>
          <td class="text-right credit">${z.amountReceived>0?bt(z.amountReceived):""}</td>
          <td class="text-right">${z.tds>0?bt(z.tds):""}</td>
          <td class="text-right">${z.balance==="-"?"-":z.balance>0?bt(z.balance):""}</td>
          <td class="text-center">${z.status?`<span class="${z.status==="Received"?"status-received":"status-pending"}">${z.status}</span>`:""}</td>
        </tr>
      `:`
        <tr class="${z.hasCN||z.isCreditNote?"sub-row-cn":"sub-row"}">
          <td></td>
          <td style="padding-left:20px;color:#666">${z.particular}</td>
          <td></td>
          <td></td>
          <td class="text-right">${z.debit?bt(z.debit):""}</td>
          <td class="text-right">${z.credit?bt(z.credit):""}</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
      `).join("")}
    </tbody>
  </table>
  
  <script>window.onload = function() { window.print(); }<\/script>
</body>
</html>`,_r=window.open("","_blank");_r.document.write(ir),_r.document.close()},H4=ye.useMemo(()=>{const h=new Set;return Rn.forEach(_=>h.add(_.partyName)),Si.forEach(_=>h.add(_.partyName)),[...h].filter(Boolean).sort()},[Rn,Si]),$4=ye.useMemo(()=>Rn.filter(h=>{var _;return!(le.party&&h.partyName!==le.party||le.invoiceNo&&!((_=h.invoiceNo)!=null&&_.toLowerCase().includes(le.invoiceNo.toLowerCase()))||le.dateFrom&&h.date<le.dateFrom||le.dateTo&&h.date>le.dateTo)}),[Rn,le]),G4=ye.useMemo(()=>Si.filter(h=>{var _;return!(le.party&&h.partyName!==le.party||le.invoiceNo&&!((_=h.invoiceNo)!=null&&_.toLowerCase().includes(le.invoiceNo.toLowerCase()))||le.dateFrom&&h.date<le.dateFrom||le.dateTo&&h.date>le.dateTo)}),[Si,le]),K4=()=>{const h=[...$4].sort((M,O)=>new Date(O.date)-new Date(M.date)),_=[...G4].sort((M,O)=>new Date(O.date)-new Date(M.date)),V=h.reduce((M,O)=>M+(parseFloat(O.amount)||0),0),Z=h.reduce((M,O)=>M+(parseFloat(O.tds)||parseFloat(O.tds||O.tdsAmount)||0),0),B=_.reduce((M,O)=>M+(parseFloat(O.totalAmount)||0),0),H=M=>{const O=parseFloat(M.totalAmount)||0;let ae=parseFloat(M.baseAmount)||parseFloat(M.amount)||0,te=parseFloat(M.gst)||(parseFloat(M.cgstAmount)||0)+(parseFloat(M.sgstAmount)||0)+(parseFloat(M.igstAmount)||0);return ae===0&&O>0&&(ae=O/1.18,te=O-ae),{base:ae,gst:te,total:O}};return c.jsxs("div",{style:{padding:"20px"},children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[c.jsxs("div",{children:[c.jsx("h1",{style:{fontSize:"22px",fontWeight:"700",color:"#1E293B",marginBottom:"4px"},children:" Receipt Register"}),c.jsx("p",{style:{fontSize:"13px",color:"#64748B"},children:"All receipts, TDS, and credit notes"})]}),c.jsx(ze,{icon:bo,label:"Export Excel",variant:"secondary",onClick:L4})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsx(ud,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"}),c.jsxs("select",{value:le.party,onChange:M=>pe(O=>({...O,party:M.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"},children:[c.jsx("option",{value:"",children:"All Parties"}),H4.map(M=>c.jsx("option",{value:M,children:M},M))]}),c.jsx("input",{type:"text",placeholder:"Invoice No",value:le.invoiceNo,onChange:M=>pe(O=>({...O,invoiceNo:M.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"140px"}}),c.jsx("input",{type:"date",value:le.dateFrom,onChange:M=>pe(O=>({...O,dateFrom:M.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}}),c.jsx("span",{style:{color:"#64748B"},children:"to"}),c.jsx("input",{type:"date",value:le.dateTo,onChange:M=>pe(O=>({...O,dateTo:M.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}}),(le.party||le.invoiceNo||le.dateFrom||le.dateTo)&&c.jsxs("button",{onClick:()=>pe({party:"",invoiceNo:"",dateFrom:"",dateTo:""}),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer"},children:[c.jsx(_a,{size:14})," Clear"]})]})}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px",marginBottom:"20px"},children:[c.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",padding:"20px",border:"1px solid #E2E8F0"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#64748B",marginBottom:"8px"},children:"Receipts"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:h.length})]}),c.jsxs("div",{style:{backgroundColor:"#F0FDF4",borderRadius:"12px",padding:"20px",border:"1px solid #BBF7D0"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#166534",marginBottom:"8px"},children:"Amount Received"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#166534"},children:et(V)})]}),c.jsxs("div",{style:{backgroundColor:"#FEF3C7",borderRadius:"12px",padding:"20px",border:"1px solid #FDE68A"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#92400E",marginBottom:"8px"},children:"TDS Received"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#92400E"},children:et(Z)})]}),c.jsxs("div",{style:{backgroundColor:"#FEE2E2",borderRadius:"12px",padding:"20px",border:"1px solid #FCA5A5"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#991B1B",marginBottom:"8px"},children:"Credit Notes"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#991B1B"},children:et(B)})]})]}),c.jsx(pn,{title:`Receipts (${h.length})`,noPadding:!0,children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Receipt No"}),c.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700",color:"#6B21A8",backgroundColor:"#FAF5FF"},children:"Code"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Date"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Party Name"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700",backgroundColor:"#F0FDF4",color:"#166534"},children:"Amount"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEF3C7",color:"#92400E"},children:"TDS"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"Total"}),c.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700"},children:"Payment Mode"}),c.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),c.jsx("tbody",{children:h.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:"10",style:{padding:"50px",textAlign:"center",color:"#94A3B8"},children:"No receipts found"})}):h.map(M=>{const O=parseFloat(M.amount)||0,ae=parseFloat(M.tds)||parseFloat(M.tdsAmount)||0,te=M.clientCode||Dn(M.partyName,M.statePartyDetails||"");return c.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9"},children:[c.jsx("td",{style:{padding:"12px",fontWeight:"600",color:"#2874A6"},children:M.receiptNo}),c.jsx("td",{style:{padding:"12px",textAlign:"center",backgroundColor:"#FAF5FF"},children:c.jsx("span",{style:{fontWeight:"700",color:"#6B21A8",fontSize:"11px"},children:te||"-"})}),c.jsx("td",{style:{padding:"12px"},children:wt(M.date)}),c.jsx("td",{style:{padding:"12px",fontWeight:"500"},children:M.partyName}),c.jsx("td",{style:{padding:"12px",color:"#64748B"},children:M.invoiceNo}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"600",color:"#166534",backgroundColor:"#F0FDF4"},children:et(O)}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"600",color:"#92400E",backgroundColor:"#FEF3C7"},children:et(ae)}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:et(O+ae)}),c.jsx("td",{style:{padding:"12px",textAlign:"center"},children:c.jsx("span",{style:{padding:"4px 8px",fontSize:"10px",fontWeight:"600",borderRadius:"9999px",backgroundColor:"#E0E7FF",color:"#3730A3"},children:M.paymentMode||M.mode||"Bank Transfer"})}),c.jsx("td",{style:{padding:"12px",textAlign:"center"},children:c.jsxs("button",{onClick:()=>U4(M),style:{padding:"6px 10px",fontSize:"11px",backgroundColor:"#2874A6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:[c.jsx(rE,{size:12})," Print"]})})]},M.id||M.receiptNo)})})]})}),c.jsx("div",{style:{marginTop:"30px"},children:c.jsx(pn,{title:`Credit Notes (${_.length})`,noPadding:!0,children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#FEF3C7",borderBottom:"2px solid #FDE68A"},children:[c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"CN No"}),c.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700",color:"#6B21A8",backgroundColor:"#FAF5FF"},children:"Code"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Date"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Party Name"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Against Invoice"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"Base Amount"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"GST"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"Total"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Reason"}),c.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),c.jsx("tbody",{children:_.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:"10",style:{padding:"50px",textAlign:"center",color:"#94A3B8"},children:"No credit notes found"})}):_.map(M=>{const O=H(M),ae=M.clientCode||Dn(M.partyName,M.statePartyDetails||"");return c.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:"#FFFBEB"},children:[c.jsx("td",{style:{padding:"12px",fontWeight:"600",color:"#92400E"},children:M.creditNoteNo}),c.jsx("td",{style:{padding:"12px",textAlign:"center",backgroundColor:"#FAF5FF"},children:c.jsx("span",{style:{fontWeight:"700",color:"#6B21A8",fontSize:"11px"},children:ae||"-"})}),c.jsx("td",{style:{padding:"12px"},children:wt(M.date)}),c.jsx("td",{style:{padding:"12px",fontWeight:"500"},children:M.partyName}),c.jsx("td",{style:{padding:"12px",color:"#64748B"},children:M.invoiceNo}),c.jsx("td",{style:{padding:"12px",textAlign:"right"},children:et(O.base)}),c.jsx("td",{style:{padding:"12px",textAlign:"right"},children:et(O.gst)}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"700",color:"#92400E"},children:et(O.total)}),c.jsx("td",{style:{padding:"12px",fontSize:"11px",color:"#64748B"},children:M.reason||"-"}),c.jsx("td",{style:{padding:"12px",textAlign:"center"},children:c.jsxs("button",{onClick:()=>V4(M),style:{padding:"6px 10px",fontSize:"11px",backgroundColor:"#92400E",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:[c.jsx(rE,{size:12})," Print"]})})]},M.id||M.creditNoteNo)})})]})})})]})},Y4=()=>{const h=(O,ae)=>{const te=Hn[O]||0,he=Ee.filter(Me=>Jt(Me.partyName,O)&&Me.invoiceGenerated&&Me.invoiceStatus==="Approved"&&(!ae||Kn(Me.statePartyDetails)===ae)),J=Ie.filter(Me=>Jt(Me.partyName,O)&&Me.invoiceGenerated&&Me.invoiceStatus==="Approved"&&(!ae||Kn(Me.statePartyDetails)===ae)),re=new Map;he.forEach(Me=>{re.has(Me.invoiceNo)?re.get(Me.invoiceNo).campaigns.push(Me):re.set(Me.invoiceNo,{invoiceNo:Me.invoiceNo,campaigns:[Me],totalAmount:parseFloat(Me.invoiceTotalAmount)||0})}),J.forEach(Me=>{re.has(Me.invoiceNo)||re.set(Me.invoiceNo,{invoiceNo:Me.invoiceNo,totalAmount:parseFloat(Me.invoiceTotalAmount)||0,isService:!0})});const nt=new Set(Array.from(re.keys())),oe=Be.filter(Me=>Jt(Me.partyName,O)&&(!ae||nt.has(Me.invoiceNo))),ge=ne.filter(Me=>Jt(Me.partyName,O)&&(!ae||nt.has(Me.invoiceNo))),Ae=ae?[]:se.filter(Me=>{var tt;return Jt(Me.partyName,O)&&Me.isHistorical&&Me.type!=="creditnote"&&!((tt=Me.vchNo)!=null&&tt.toUpperCase().startsWith("CN"))}),Ye=ae?[]:se.filter(Me=>{var tt;return Jt(Me.partyName,O)&&Me.isHistorical&&(Me.type==="creditnote"||((tt=Me.vchNo)==null?void 0:tt.toUpperCase().startsWith("CN")))}),Xe=Me=>{if(!Me)return"";const tt=Me.split("/");return tt.length>=3?tt.slice(1).join("/"):tt.length===2?tt.join("/"):tt[tt.length-1]},Qe=new Map;ge.forEach(Me=>{const tt=Xe(Me.invoiceNo);tt&&!Qe.has(tt)&&Qe.set(tt,Me)}),Ye.forEach(Me=>{const tt=Xe(Me.vchNo);tt&&!Qe.has(tt)&&Qe.set(tt,Me)});let at=0;return te>0&&(at+=te),Array.from(re.values()).forEach(Me=>{const tt=Me.totalAmount,$t=Xe(Me.invoiceNo),Zt=Qe.get($t),ir=Zt?Math.abs(parseFloat(Zt.totalAmount)||parseFloat(Zt.credit)||0):0;if(!(Zt&&ir>=tt)){let z=Zt?tt-ir:tt;const Te=oe.find(St=>St.invoiceNo===Me.invoiceNo);if(Te){const St=z-(parseFloat(Te.amount)||0)-(parseFloat(Te.tds)||0)-(parseFloat(Te.discount)||0);St>0&&(at+=St)}else z>0&&(at+=z)}}),Ae.forEach(Me=>{const tt=Xe(Me.vchNo),$t=Qe.get(tt),Zt=$t?Math.abs(parseFloat($t.totalAmount)||parseFloat($t.credit)||parseFloat($t.debit)||0):0,ir=parseFloat(Me.debit)||0;if(!($t&&Zt>=ir)){let z=$t?ir-Zt:ir;const Te=parseFloat(Me.amountReceived)||0,St=parseFloat(Me.tdsReceived)||0,Gt=z-Te-St;Gt>0&&(at+=Gt)}}),at},_=Ji.filter(O=>O.partyName.toLowerCase().includes(Ma.toLowerCase())||O.state&&O.state.toLowerCase().includes(Ma.toLowerCase())),V=O=>{if(Se){const J=Ji.find(re=>re.partyNameUpper===(O||"").trim().toUpperCase()&&re.normalizedState===Se);if(J!=null&&J.state)return J.state}const ae=(O||"").trim().toUpperCase(),te=Ee.find(J=>{var re;return((re=J.partyName)==null?void 0:re.trim().toUpperCase())===ae});if(te!=null&&te.statePartyDetails)return te.statePartyDetails;const he=Ji.find(J=>J.partyNameUpper===ae);return(he==null?void 0:he.state)||""},Z=O=>{const ae=(O||"").trim().toUpperCase();if(Se){const he=Ji.find(J=>J.partyNameUpper===ae&&J.normalizedState===Se);if(he!=null&&he.address)return he.address}const te=Ji.find(he=>he.partyNameUpper===ae);return te!=null&&te.address?te.address:Al(O,V(O))},B=O=>{const ae=(O||"").trim().toUpperCase();if(Se){const J=Ji.find(re=>re.partyNameUpper===ae&&re.normalizedState===Se);if(J!=null&&J.gstin)return J.gstin}const te=Ji.find(J=>J.partyNameUpper===ae);if(te!=null&&te.gstin)return te.gstin;const he=Ee.find(J=>{var re;return((re=J.partyName)==null?void 0:re.trim().toUpperCase())===ae});return he?So(O,he.statePartyDetails):""},M=(()=>{if(!X)return{entries:[],totals:{debit:0,credit:0,received:0,tds:0,balance:0}};const O=Hn[X]||0,ae=z=>{if(!z)return"";const Te=z.split("/");return Te.length>=3?Te.slice(1).join("/"):Te.length===2?Te.join("/"):Te[Te.length-1]},te=Ee.filter(z=>Jt(z.partyName,X)&&z.invoiceGenerated&&z.invoiceStatus==="Approved"&&(!Se||Kn(z.statePartyDetails)===Se)),he=Ie.filter(z=>Jt(z.partyName,X)&&z.invoiceGenerated&&z.invoiceStatus==="Approved"&&(!Se||Kn(z.statePartyDetails)===Se)),J=new Map;te.forEach(z=>{J.has(z.invoiceNo)?J.get(z.invoiceNo).campaigns.push(z):J.set(z.invoiceNo,{invoiceNo:z.invoiceNo,invoiceDate:z.invoiceDate,invoiceType:z.invoiceType,combinationCode:z.combinationCode,receiptStatus:z.receiptStatus,receiptNo:z.receiptNo,receiptDate:z.receiptDate,creditNoteNo:z.creditNoteNo,campaigns:[z],isFromMaster:!0})}),he.forEach(z=>{J.has(z.invoiceNo)||J.set(z.invoiceNo,{invoiceNo:z.invoiceNo,invoiceDate:z.invoiceDate,invoiceType:"Service",combinationCode:"NA",receiptStatus:z.receiptStatus,receiptNo:z.receiptNo,receiptDate:z.receiptDate,creditNoteNo:z.creditNoteNo,campaigns:[z],isFromMaster:!1,isService:!0,serviceType:z.serviceType})});const re=new Set(Array.from(J.keys())),nt=Se?[]:se.filter(z=>{var Te;return Jt(z.partyName,X)&&z.isHistorical&&z.type!=="creditnote"&&!((Te=z.vchNo)!=null&&Te.toUpperCase().startsWith("CN"))}),oe=Se?[]:se.filter(z=>{var Te;return Jt(z.partyName,X)&&z.isHistorical&&(z.type==="creditnote"||((Te=z.vchNo)==null?void 0:Te.toUpperCase().startsWith("CN")))}),ge=Be.filter(z=>Jt(z.partyName,X)&&(!Se||re.has(z.invoiceNo))),Ae=ne.filter(z=>Jt(z.partyName,X)&&(!Se||re.has(z.invoiceNo))),Ye=new Map;Ae.forEach(z=>{const Te=ae(z.invoiceNo);Te&&!Ye.has(Te)&&Ye.set(Te,{...z,isSystemCN:!0})}),oe.forEach(z=>{const Te=ae(z.vchNo);Te&&!Ye.has(Te)&&Ye.set(Te,{...z,isHistoricalCN:!0})});const Xe=[];let Qe=O,at=0,Me=0,tt=0,$t=0;const Zt=new Set;O!==0&&(Xe.push({id:"opening",date:"",particular:"Opening Balance",vchType:"",vchNo:"",debit:O>0?O:0,credit:O<0?Math.abs(O):0,receiptDate:"",amountReceived:0,tdsReceived:0,balance:O,paymentStatus:"",isOpening:!0,subRows:[]}),at+=O>0?O:0,Me+=O<0?Math.abs(O):0);const ir=[];Array.from(J.values()).filter(z=>{const Te=new Date(z.invoiceDate),St=new Date(yn.fromDate),Gt=new Date(yn.toDate);return Te>=St&&Te<=Gt}).forEach(z=>{ir.push({...z,entryType:"invoice",sortDate:z.invoiceDate})}),nt.filter(z=>{if(!z.date)return!1;const Te=new Date(z.date),St=new Date(yn.fromDate),Gt=new Date(yn.toDate);return Te>=St&&Te<=Gt}).forEach(z=>{ir.push({...z,entryType:z.type||"invoice",sortDate:z.date})}),ir.sort((z,Te)=>new Date(z.sortDate)-new Date(Te.sortDate)),ir.forEach(z=>{var Te,St,Gt;if(z.isFromMaster){const lt=z;let kt=0;lt.campaigns.forEach(es=>{kt+=parseFloat(es.invoiceAmount)||0});const Mt=(St=(Te=lt.campaigns[0])==null?void 0:Te.statePartyDetails)==null?void 0:St.toUpperCase().includes("MAHARASHTRA"),Yt=Mt?kt*.09:0,rr=Mt?kt*.09:0,Lr=Mt?0:kt*.18,kr=kt+Yt+rr+Lr,mr=ae(lt.invoiceNo),Ft=Ye.get(mr),Ur=Ft?Math.abs(Ft.totalAmount||Ft.credit||0):0,jt=!!Ft,An=jt&&Ur>=kr,Zi=jt&&!An?kr-Ur:0,On=ge.find(es=>es.invoiceNo===lt.invoiceNo);Qe+=kr,at+=kr;const fn=[{particular:"PROMOTIONAL TRADE EMAILER"+(lt.campaigns.length>1?"S":""),credit:kt}];Mt?(fn.push({particular:"CGST",credit:Yt}),fn.push({particular:"SGST",credit:rr})):fn.push({particular:"IGST",credit:Lr});let xr="",Kr=0,Ys=0,Co="",Ts=kr;if(On?(xr="Received",Kr=On.amount||0,Ys=On.tds||0,Co=On.date,tt+=Kr,$t+=Ys,Ts=kr-Kr-Ys-(On.discount||0),Qe-=Kr+Ys+(On.discount||0)):lt.receiptStatus==="Received"?(xr="Received",Ts=0):An?(xr="CN Closed",Ts=0):jt&&Zi>0?(xr="Partial CN",Ts=Zi):xr="Pending",Xe.push({id:lt.invoiceNo,date:lt.invoiceDate,particular:X,vchType:"Sales",vchNo:lt.invoiceNo,debit:kr,credit:0,receiptDate:Co,amountReceived:Kr,tdsReceived:Ys,balance:An?"-":Ts>0?Ts:0,paymentStatus:xr,isInvoice:!0,hasCN:jt,subRows:fn}),Ft&&!Zt.has(mr)){Zt.add(mr);const es=Math.abs(Ft.totalAmount||Ft.credit||0);Qe-=es,Me+=es;const ts=[];if(Ft.amount&&ts.push({particular:"PROMOTIONAL TRADE EMAILER",credit:Math.abs(Ft.amount)}),Ft.gst&&ts.push({particular:Ft.gstType||(Mt?"CGST + SGST":"IGST"),credit:Math.abs(Ft.gst)}),ts.length===0&&es>0){const ga=es/1.18,Zu=es-ga;ts.push({particular:"PROMOTIONAL TRADE EMAILER",credit:ga}),ts.push({particular:Mt?"CGST + SGST":"IGST",credit:Zu})}Xe.push({id:Ft.id||Ft.creditNoteNo||`cn-${mr}`,date:Ft.date,particular:X,vchType:"Credit Note",vchNo:Ft.creditNoteNo||Ft.vchNo,debit:0,credit:es,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:Ft.isHistoricalCN&&Ft.subRows||ts})}}else if(z.isService){const lt=z,kt=lt.campaigns[0]||{},Mt=parseFloat(kt.invoiceAmount)||0,Yt=lt.serviceType||kt.serviceType||"SERVICE",rr=(Gt=kt.statePartyDetails)==null?void 0:Gt.toUpperCase().includes("MAHARASHTRA"),Lr=rr?Mt*.09:0,kr=rr?Mt*.09:0,mr=rr?0:Mt*.18,Ft=Mt+Lr+kr+mr,Ur=ae(lt.invoiceNo),jt=Ye.get(Ur),An=jt?Math.abs(jt.totalAmount||jt.credit||0):0,Zi=!!jt,On=Zi&&An>=Ft,fn=Zi&&!On?Ft-An:0,xr=ge.find(ga=>ga.invoiceNo===lt.invoiceNo);Qe+=Ft,at+=Ft;const Kr=[{particular:Yt.toUpperCase(),credit:Mt}];rr?(Kr.push({particular:"CGST",credit:Lr}),Kr.push({particular:"SGST",credit:kr})):Kr.push({particular:"IGST",credit:mr});let Ys="",Co=0,Ts=0,es="",ts=Ft;if(xr?(Ys="Received",Co=xr.amount||0,Ts=xr.tds||xr.tdsAmount||0,es=xr.date,tt+=Co,$t+=Ts,ts=Ft-Co-Ts-(xr.discount||0),Qe-=Co+Ts+(xr.discount||0)):On?(Ys="CN Closed",ts=0):Zi&&fn>0?(Ys="Partial CN",ts=fn):Ys="Pending",Xe.push({id:lt.invoiceNo,date:lt.invoiceDate,particular:X,vchType:"Sales",vchNo:lt.invoiceNo,debit:Ft,credit:0,receiptDate:es,amountReceived:Co,tdsReceived:Ts,balance:On?"-":ts>0?ts:0,paymentStatus:Ys,isInvoice:!0,isService:!0,hasCN:Zi,subRows:Kr}),jt&&!Zt.has(Ur)){Zt.add(Ur);const ga=Math.abs(jt.totalAmount||jt.credit||0);Qe-=ga,Me+=ga;const Zu=[],by=ga/1.18,tb=ga-by;Zu.push({particular:Yt.toUpperCase(),credit:by}),Zu.push({particular:rr?"CGST + SGST":"IGST",credit:tb}),Xe.push({id:jt.id||jt.creditNoteNo||`cn-${Ur}`,date:jt.date,particular:X,vchType:"Credit Note",vchNo:jt.creditNoteNo||jt.vchNo,debit:0,credit:ga,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:Zu})}}else if(z.isHistorical){const lt=z.debit||0,kt=z.credit||0,Mt=ae(z.vchNo),Yt=Ye.get(Mt),rr=Yt?Math.abs(Yt.totalAmount||Yt.credit||0):0,Lr=!!Yt,kr=Lr&&rr>=lt,mr=Lr&&!kr?lt-rr:0;Qe+=lt-kt,at+=lt,Me+=kt,z.amountReceived&&(tt+=z.amountReceived),z.tdsReceived&&($t+=z.tdsReceived);const Ft=z.subRows||[];let Ur=lt-(z.amountReceived||0)-(z.tdsReceived||0),jt=z.paymentStatus||"";kr?(Ur=0,jt="CN Closed"):Lr&&mr>0&&(Ur=mr-(z.amountReceived||0)-(z.tdsReceived||0),Ur>0&&(jt="Partial CN")),Xe.push({id:z.id,date:z.date,particular:z.particulars||X,vchType:z.vchType||"Sales",vchNo:z.vchNo,debit:lt,credit:kt,receiptDate:z.receiptDate||"",amountReceived:z.amountReceived||0,tdsReceived:z.tdsReceived||0,balance:kr?"-":Ur>0?Ur:0,paymentStatus:jt,isInvoice:!0,isHistorical:!0,hasCN:Lr,subRows:Ft}),Yt&&!Zt.has(Mt)&&(Zt.add(Mt),Qe-=rr,Me+=rr,Xe.push({id:Yt.id||Yt.creditNoteNo||Yt.vchNo||`cn-${Mt}`,date:Yt.date,particular:X,vchType:"Credit Note",vchNo:Yt.creditNoteNo||Yt.vchNo,debit:0,credit:rr,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:Yt.subRows||[]}))}});const _r=Xe.reduce((z,Te)=>typeof Te.balance=="number"&&Te.balance>0?z+Te.balance:z,0);return{entries:Xe,totals:{debit:at,credit:Me,received:tt,tds:$t,balance:_r}}})();return c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Party Ledgers"}),c.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[c.jsx(ze,{icon:bo,label:"Export All",variant:"secondary",onClick:j4}),yr&&c.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"}),sr&&c.jsx(ze,{icon:Qs,label:"Import Historical",variant:"brand",onClick:()=>Ks(!0)}),sr&&X&&se.some(O=>Jt(O.partyName,X)&&O.isHistorical)&&c.jsx(ze,{icon:rs,label:"Clear Historical",variant:"danger",onClick:t4}),sr&&c.jsx(ze,{icon:dd,label:"Opening Balance",variant:"primary",onClick:()=>nr(!0)})]})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(RL,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Period:"})]}),c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx("input",{type:"date",value:yn.fromDate,onChange:O=>un(ae=>({...ae,fromDate:O.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}}),c.jsx("span",{style:{color:"#64748B"},children:"to"}),c.jsx("input",{type:"date",value:yn.toDate,onChange:O=>un(ae=>({...ae,toDate:O.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}})]}),c.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:"10px"},children:X&&c.jsx(ze,{icon:bo,label:"Download PDF",variant:"brand",onClick:W4})})]})}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr",gap:"16px"},children:[c.jsxs(pn,{title:"Parties",noPadding:!0,children:[c.jsx("div",{style:{padding:"12px",borderBottom:"1px solid #E2E8F0"},children:c.jsxs("div",{style:{position:"relative"},children:[c.jsx(X0,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",placeholder:"Search party...",value:Ma,onChange:O=>Hs(O.target.value),style:{width:"100%",padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",boxSizing:"border-box"}})]})}),c.jsx("div",{style:{maxHeight:"450px",overflowY:"auto"},children:_.length===0?c.jsx("div",{style:{padding:"30px",textAlign:"center",color:"#94A3B8",fontSize:"14px"},children:Ma?"No matching parties":"No parties yet"}):_.map((O,ae)=>{const te=h(O.partyName,O.normalizedState),he=Jt(X,O.partyName)&&Se===O.normalizedState;return c.jsxs("div",{onClick:()=>{ve(O.partyName),Le(O.normalizedState||null)},style:{padding:"14px 18px",borderBottom:"1px solid #F1F5F9",cursor:"pointer",backgroundColor:he?"#EFF6FF":"transparent",borderLeft:he?"4px solid #2874A6":"4px solid transparent"},children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"14px",color:"#1E293B"},children:O.partyName}),O.state&&c.jsxs("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"2px"},children:[" ",O.state]}),O.gstin&&c.jsxs("div",{style:{fontSize:"10px",color:"#2874A6",marginTop:"1px"},children:["GST: ",O.gstin]}),c.jsxs("div",{style:{fontSize:"14px",color:te>0?"#DC2626":"#059669",fontWeight:"700",marginTop:"4px"},children:[te>0?"Dr. ":"Cr. ",et(Math.abs(te))]})]},`${O.partyName}-${O.state}-${ae}`)})})]}),c.jsx(pn,{title:X?"Ledger Account":"Select a Party",noPadding:!0,children:X?c.jsxs("div",{style:{fontSize:"12px"},children:[c.jsxs("div",{style:{textAlign:"center",padding:"16px",borderBottom:"2px solid #1E3A5F",backgroundColor:"#F8FAFC"},children:[c.jsx("div",{style:{fontSize:"16px",fontWeight:"700",color:"#1E3A5F"},children:w.name}),c.jsx("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"4px"},children:w.address}),c.jsxs("div",{style:{fontSize:"11px",color:"#64748B"},children:[w.addressLine2,", ",w.city]}),c.jsxs("div",{style:{fontSize:"11px",color:"#64748B"},children:["E-Mail: ",w.email]})]}),c.jsxs("div",{style:{textAlign:"center",padding:"12px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FFFFFF"},children:[c.jsx("div",{style:{fontSize:"14px",fontWeight:"700",color:"#1E293B"},children:X}),c.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#64748B"},children:"Ledger Account"}),Z(X)&&c.jsx("div",{style:{fontSize:"11px",color:"#475569",marginTop:"4px"},children:Z(X)}),V(X)&&c.jsxs("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"2px"},children:[" ",V(X)]}),B(X)&&c.jsxs("div",{style:{fontSize:"11px",color:"#2874A6",marginTop:"3px",fontWeight:"600"},children:["GSTIN: ",B(X)]})]}),c.jsx("div",{style:{textAlign:"center",padding:"8px",backgroundColor:"#F1F5F9",borderBottom:"1px solid #E2E8F0"},children:c.jsxs("span",{style:{fontSize:"11px",fontWeight:"600",color:"#475569"},children:[wt(yn.fromDate)," to ",wt(yn.toDate)]})}),c.jsxs("div",{style:{backgroundColor:"#1E293B",color:"white",padding:"12px 16px",display:"flex",justifyContent:"center",alignItems:"center",gap:"12px",borderBottom:"3px solid #F59E0B"},children:[c.jsx("span",{style:{fontSize:"14px",fontWeight:"600"},children:"Closing Balance:"}),c.jsxs("span",{style:{fontSize:"18px",fontWeight:"700",color:M.totals.balance>0?"#FCA5A5":"#86EFAC"},children:[bt(Math.abs(M.totals.balance))," ",M.totals.balance>0?"(Dr)":M.totals.balance<0?"(Cr)":""]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",backgroundColor:"#EFF6FF",borderBottom:"2px solid #2874A6",fontSize:"11px"},children:[c.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[c.jsx("div",{style:{color:"#64748B"},children:"Debit"}),c.jsx("div",{style:{fontWeight:"700",color:"#1E293B"},children:bt(M.totals.debit)})]}),c.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[c.jsx("div",{style:{color:"#64748B"},children:"Credit"}),c.jsx("div",{style:{fontWeight:"700",color:"#DC2626"},children:bt(M.totals.credit)})]}),c.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[c.jsx("div",{style:{color:"#64748B"},children:"Amount Received"}),c.jsx("div",{style:{fontWeight:"700",color:"#059669"},children:bt(M.totals.received)})]}),c.jsxs("div",{style:{padding:"8px",textAlign:"center"},children:[c.jsx("div",{style:{color:"#64748B"},children:"TDS Received"}),c.jsx("div",{style:{fontWeight:"700",color:"#1E293B"},children:bt(M.totals.tds)})]})]}),c.jsx("div",{style:{overflowX:"auto"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px",minWidth:"1000px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",width:"75px",borderRight:"1px solid #E2E8F0"},children:"Date"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",minWidth:"150px",borderRight:"1px solid #E2E8F0"},children:"Particular"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"80px",borderRight:"1px solid #E2E8F0"},children:"Vch Type"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",width:"110px",borderRight:"1px solid #E2E8F0"},children:"Vch No."}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Debit"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Credit"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"85px",borderRight:"1px solid #E2E8F0"},children:"Date of Receipt"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Amount Received"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"80px",borderRight:"1px solid #E2E8F0"},children:"TDS Received"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"85px",borderRight:"1px solid #E2E8F0"},children:"Balance"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"75px",borderRight:"1px solid #E2E8F0"},children:"Payment Status"}),sr&&c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"50px"},children:"Action"})]})}),c.jsx("tbody",{children:M.entries.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:sr?"12":"11",style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:"No entries in selected period"})}):M.entries.map(O=>c.jsxs(sh.Fragment,{children:[c.jsxs("tr",{style:{backgroundColor:O.isOpening?"#FEF3C7":O.hasCN||O.isCreditNote?"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #E2E8F0",borderLeft:O.hasCN||O.isCreditNote?"4px solid #F59E0B":"none"},children:[c.jsx("td",{style:{padding:"8px",borderRight:"1px solid #E2E8F0"},children:O.date?wt(O.date):""}),c.jsx("td",{style:{padding:"8px",fontWeight:"600",color:O.isCreditNote?"#DC2626":"#1E293B",borderRight:"1px solid #E2E8F0"},children:O.particular}),c.jsx("td",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #E2E8F0"},children:O.vchType&&c.jsx("span",{style:{padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:O.vchType==="Sales"?"#DCFCE7":"#FEE2E2",color:O.vchType==="Sales"?"#166534":"#991B1B"},children:O.vchType})}),c.jsx("td",{style:{padding:"8px",borderRight:"1px solid #E2E8F0"},children:O.vchNo&&O.isInvoice&&!O.isHistorical?c.jsx("button",{onClick:()=>f4(O.vchNo),style:{background:"none",border:"none",padding:0,fontWeight:"600",color:"#2874A6",cursor:"pointer",textDecoration:"underline",fontSize:"11px"},title:"Click to view invoice",children:O.vchNo}):c.jsx("span",{style:{fontWeight:"600",color:O.isCreditNote?"#DC2626":"#2874A6"},children:O.vchNo})}),c.jsx("td",{style:{padding:"8px",textAlign:"right",fontWeight:"600",borderRight:"1px solid #E2E8F0"},children:O.debit>0?bt(O.debit):""}),c.jsx("td",{style:{padding:"8px",textAlign:"right",color:"#DC2626",borderRight:"1px solid #E2E8F0"},children:O.credit>0?bt(O.credit):""}),c.jsx("td",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #E2E8F0"},children:O.receiptDate?wt(O.receiptDate):""}),c.jsx("td",{style:{padding:"8px",textAlign:"right",color:"#059669",fontWeight:O.amountReceived>0?"600":"400",borderRight:"1px solid #E2E8F0"},children:O.amountReceived>0?bt(O.amountReceived):""}),c.jsx("td",{style:{padding:"8px",textAlign:"right",borderRight:"1px solid #E2E8F0"},children:O.tdsReceived>0?bt(O.tdsReceived):""}),c.jsx("td",{style:{padding:"8px",textAlign:"right",fontWeight:"600",color:typeof O.balance=="number"&&O.balance>0?"#DC2626":"",borderRight:"1px solid #E2E8F0"},children:O.isOpening?O.balance>0?bt(O.balance):"":O.balance==="-"?"-":typeof O.balance=="number"&&O.balance>0?bt(O.balance):"-"}),c.jsx("td",{style:{padding:"8px",textAlign:"center"},children:O.paymentStatus&&c.jsx("span",{style:{padding:"2px 8px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:O.paymentStatus==="Received"?"#DCFCE7":"#FEF3C7",color:O.paymentStatus==="Received"?"#166534":"#92400E"},children:O.paymentStatus})}),sr&&c.jsx("td",{style:{padding:"8px",textAlign:"center"},children:O.isHistorical&&!O.isOpening&&c.jsx("button",{onClick:()=>e4(se.find(ae=>ae.id===O.id)),style:{padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete historical entry",children:""})})]}),O.subRows&&O.subRows.length>0&&O.subRows.map((ae,te)=>c.jsxs("tr",{style:{backgroundColor:O.isOpening?"#FEF3C7":O.hasCN||O.isCreditNote?"#FFFBEB":"#FFFFFF",borderBottom:te===O.subRows.length-1?"2px solid #CBD5E1":"1px solid #E2E8F0",borderLeft:O.hasCN||O.isCreditNote?"4px solid #F59E0B":"none"},children:[c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px 6px 30px",color:"#475569",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:ae.particular}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:ae.debit?bt(ae.debit):""}),c.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:ae.credit?bt(ae.credit):""}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),sr&&c.jsx("td",{style:{padding:"6px 8px"}})]},`${O.id}-sub-${te}`))]},O.id))})]})})]}):c.jsx("div",{style:{padding:"60px",textAlign:"center",color:"#94A3B8"},children:"Select a party to view ledger"})})]})]})},[Cc,Cy]=ye.useState(""),g0=ye.useMemo(()=>{const h=new Map,_=B=>{if(!B)return"";const H=B.split("/");return H.length>=3?H.slice(1).join("/"):H.length===2?H.join("/"):H[H.length-1]},V=Gn.filter(B=>{var H;return B.isHistorical&&(B.type==="creditnote"||((H=B.vchNo)==null?void 0:H.toUpperCase().startsWith("CN")))}),Z=new Map;return Si.forEach(B=>{const H=_(B.invoiceNo);H&&Z.set(H,B)}),V.forEach(B=>{const H=_(B.vchNo);H&&!Z.has(H)&&Z.set(H,B)}),wn.filter(B=>B.invoiceGenerated&&B.invoiceStatus==="Approved").forEach(B=>{if(h.has(B.invoiceNo))h.has(B.invoiceNo)&&h.get(B.invoiceNo).campaigns.push(B);else{const H=Rn.find(J=>J.invoiceNo===B.invoiceNo),M=Si.find(J=>J.invoiceNo===B.invoiceNo),O=parseFloat(B.invoiceTotalAmount)||0,ae=M?Math.abs(parseFloat(M.totalAmount)||parseFloat(M.credit)||0):0,te=M&&ae>=O,he=B.clientCode||Dn(B.partyName,B.statePartyDetails);if(!H&&!te){const J=M?O-ae:O;h.set(B.invoiceNo,{invoiceNo:B.invoiceNo,partyName:B.partyName,clientCode:he,invoiceDate:B.invoiceDate,invoiceTotalAmount:B.invoiceTotalAmount,pendingAmount:J,hasPartialCN:!!M&&!te&&ae>0,cnAmount:ae,subject:B.subject,campaigns:[B],isHistorical:!1,invoiceType:B.invoiceType||"Individual",source:"Campaign"})}}}),nn.filter(B=>B.invoiceGenerated&&B.invoiceStatus==="Approved").forEach(B=>{if(!h.has(B.invoiceNo)){const H=Rn.find(J=>J.invoiceNo===B.invoiceNo),M=Si.find(J=>J.invoiceNo===B.invoiceNo),O=parseFloat(B.invoiceTotalAmount)||0,ae=M?Math.abs(parseFloat(M.totalAmount)||parseFloat(M.credit)||0):0,te=M&&ae>=O,he=B.clientCode||Dn(B.partyName,B.statePartyDetails);if(!H&&!te){const J=M?O-ae:O;h.set(B.invoiceNo,{invoiceNo:B.invoiceNo,partyName:B.partyName,clientCode:he,invoiceDate:B.invoiceDate,invoiceTotalAmount:B.invoiceTotalAmount,pendingAmount:J,hasPartialCN:!!M&&!te&&ae>0,cnAmount:ae,subject:B.serviceType||"",campaigns:[],isHistorical:!1,invoiceType:"Service",isService:!0,source:"Service"})}}}),Gn.filter(B=>{var H;return B.isHistorical&&B.type!=="creditnote"&&!((H=B.vchNo)!=null&&H.toUpperCase().startsWith("CN"))&&B.debit>0}).forEach(B=>{if(!h.has(B.vchNo)){const H=Rn.find(nt=>nt.invoiceNo===B.vchNo),M=_(B.vchNo),O=Z.get(M),ae=O?Math.abs(parseFloat(O.totalAmount)||parseFloat(O.credit)||parseFloat(O.debit)||0):0,te=parseFloat(B.debit)||0,he=O&&ae>=te;if(H||he)return;const J=!(B.amountReceived>0),re=O&&ae>0&&ae<te;if(J||re){const nt=re?te-ae:te;h.set(B.vchNo,{invoiceNo:B.vchNo,partyName:B.partyName,invoiceDate:B.date,invoiceTotalAmount:te,pendingAmount:nt,hasPartialCN:re,cnAmount:ae,subject:B.particulars||B.narration,campaigns:[],isHistorical:!0,invoiceType:"Historical",source:"Historical"})}}}),Array.from(h.values()).sort((B,H)=>B.partyName.localeCompare(H.partyName))},[wn,nn,Rn,Si,Gn]),X4=ye.useMemo(()=>{const h={};return Tl.forEach(_=>{h[_.invoiceNo]||(h[_.invoiceNo]=[]),h[_.invoiceNo].push(_)}),Object.keys(h).forEach(_=>{h[_].sort((V,Z)=>new Date(Z.followupDate)-new Date(V.followupDate))}),h},[Tl]),ky=ye.useMemo(()=>{const h=new Date().toISOString().split("T")[0];return Tl.filter(_=>_.nextFollowupDate&&_.nextFollowupDate>=h).sort((_,V)=>new Date(_.nextFollowupDate)-new Date(V.nextFollowupDate))},[Tl]),m0=ye.useMemo(()=>{let h=g0;if(Cc){const V=Cc.toLowerCase();h=g0.filter(Z=>{var B,H,M;return((B=Z.invoiceNo)==null?void 0:B.toLowerCase().includes(V))||((H=Z.partyName)==null?void 0:H.toLowerCase().includes(V))||((M=Z.subject)==null?void 0:M.toLowerCase().includes(V))})}const _={};return h.forEach(V=>{_[V.partyName]||(_[V.partyName]={partyName:V.partyName,invoices:[],totalAmount:0}),_[V.partyName].invoices.push(V),_[V.partyName].totalAmount+=parseFloat(V.pendingAmount||V.invoiceTotalAmount)||0}),Object.values(_).sort((V,Z)=>V.partyName.localeCompare(Z.partyName))},[g0,Cc]),q4=()=>{const h=m0.reduce((_,V)=>_+V.invoices.length,0);return c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Followups"}),c.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[c.jsxs("span",{style:{padding:"6px 12px",backgroundColor:"#EFF6FF",borderRadius:"6px",fontSize:"12px",color:"#1E40AF",fontWeight:"600"},children:[m0.length," Parties | ",h," Invoices"]}),yr&&c.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"})]})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(ud,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Search:"})]}),c.jsxs("div",{style:{position:"relative",flex:1,maxWidth:"300px"},children:[c.jsx(X0,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",placeholder:"Search party, invoice, subject...",value:Cc,onChange:_=>Cy(_.target.value),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"100%"}})]}),Cc&&c.jsxs("button",{onClick:()=>Cy(""),style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(_a,{size:14})," Clear"]}),Cc&&c.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",h," of ",g0.length]})]})}),ky.length>0&&c.jsx(pn,{title:" Upcoming Followups",style:{marginBottom:"16px"},children:c.jsx("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:ky.slice(0,5).map(_=>c.jsxs("div",{style:{padding:"10px 14px",backgroundColor:new Date(_.nextFollowupDate).toISOString().split("T")[0]===new Date().toISOString().split("T")[0]?"#FEE2E2":"#FEF3C7",borderRadius:"8px",border:"1px solid #FCD34D"},children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#92400E"},children:_.invoiceNo}),c.jsx("div",{style:{fontSize:"11px",color:"#78716C"},children:_.partyName}),c.jsxs("div",{style:{fontSize:"12px",fontWeight:"600",color:"#DC2626",marginTop:"4px"},children:[" ",wt(_.nextFollowupDate)]})]},_.id))})}),m0.length===0?c.jsx(pn,{children:c.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:" No pending invoices! All payments received."})}):m0.map(_=>c.jsxs(pn,{style:{marginBottom:"16px"},noPadding:!0,children:[c.jsxs("div",{style:{padding:"12px 16px",backgroundColor:"#1E293B",color:"white",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[c.jsxs("span",{style:{fontSize:"15px",fontWeight:"700"},children:[" ",_.partyName]}),c.jsxs("span",{style:{padding:"3px 10px",backgroundColor:"#3B82F6",borderRadius:"12px",fontSize:"11px",fontWeight:"600"},children:[_.invoices.length," Invoice",_.invoices.length>1?"s":""]})]}),c.jsxs("div",{style:{fontSize:"14px",fontWeight:"700",color:"#FCD34D"},children:["Total: ",et(_.totalAmount)]})]}),c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[c.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700",color:"#6B21A8",backgroundColor:"#FAF5FF"},children:"Code"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Type"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Invoice Date"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:"Amount"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Days Pending"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Last Followup"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),c.jsx("tbody",{children:_.invoices.map(V=>{var ae,te,he;const Z=X4[V.invoiceNo]||[],B=Z[0],H=Math.floor((new Date-new Date(V.invoiceDate))/(1e3*60*60*24)),M=V.isHistorical?"Historical":V.isService?"Service":V.invoiceType||(((ae=V.campaigns)==null?void 0:ae.length)>1?"Combined":"Individual"),O=V.clientCode||(V.campaigns&&V.campaigns[0]?Dn(V.campaigns[0].partyName,V.campaigns[0].statePartyDetails):"");return c.jsxs(sh.Fragment,{children:[c.jsxs("tr",{style:{borderBottom:"1px solid #E2E8F0",backgroundColor:H>30?"#FEF2F2":H>15?"#FFFBEB":"#FFFFFF"},children:[c.jsxs("td",{style:{padding:"10px 12px",fontWeight:"600",color:"#2874A6"},children:[V.invoiceNo,V.hasPartialCN&&c.jsx("span",{style:{marginLeft:"6px",padding:"2px 6px",backgroundColor:"#FEF3C7",color:"#92400E",borderRadius:"4px",fontSize:"9px",fontWeight:"700"},children:"Partial CN"})]}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center",backgroundColor:"#FAF5FF"},children:c.jsx("span",{style:{fontWeight:"700",color:"#6B21A8",fontSize:"11px"},children:O||"-"})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsx("span",{style:{padding:"3px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"600",backgroundColor:M==="Historical"?"#E0E7FF":M==="Service"?"#FEF3C7":M==="Combined"?"#F3E8FF":"#DCFCE7",color:M==="Historical"?"#3730A3":M==="Service"?"#92400E":M==="Combined"?"#7C3AED":"#166534"},children:M})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:wt(V.invoiceDate)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600"},children:V.hasPartialCN?c.jsxs("div",{children:[c.jsx("div",{style:{color:"#DC2626"},children:et(V.pendingAmount)}),c.jsx("div",{style:{fontSize:"9px",color:"#64748B",textDecoration:"line-through"},children:et(V.invoiceTotalAmount)})]}):et(V.invoiceTotalAmount)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsxs("span",{style:{padding:"3px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"700",backgroundColor:H>30?"#FEE2E2":H>15?"#FEF3C7":"#DCFCE7",color:H>30?"#991B1B":H>15?"#92400E":"#166534"},children:[H," days"]})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center",fontSize:"11px"},children:B?c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"600"},children:wt(B.followupDate)}),c.jsxs("div",{style:{color:"#64748B",fontSize:"10px"},children:[(te=B.notes)==null?void 0:te.substring(0,30),((he=B.notes)==null?void 0:he.length)>30?"...":""]})]}):c.jsx("span",{style:{color:"#DC2626",fontWeight:"600"},children:"No followup yet"})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsxs("div",{style:{display:"flex",gap:"4px",justifyContent:"center"},children:[sr&&c.jsx(ze,{icon:dd,small:!0,variant:"primary",onClick:()=>r4(V),title:"Add Followup"}),c.jsx(ze,{icon:tm,small:!0,variant:"brand",onClick:()=>py(V),title:"Copy Email Template"}),c.jsx(ze,{icon:K0,small:!0,variant:"success",onClick:()=>gy(V),title:"Search in Gmail"})]})})]}),Z.length>0&&c.jsx("tr",{children:c.jsxs("td",{colSpan:"8",style:{padding:"8px 12px 12px 40px",backgroundColor:"#F8FAFC"},children:[c.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#64748B",marginBottom:"6px"},children:"Followup History:"}),c.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:Z.map(J=>c.jsxs("div",{style:{padding:"6px 10px",backgroundColor:"#FFFFFF",borderRadius:"6px",border:"1px solid #E2E8F0",fontSize:"11px"},children:[c.jsx("div",{style:{fontWeight:"600",color:"#2874A6"},children:wt(J.followupDate)}),c.jsx("div",{style:{color:"#475569",marginTop:"2px"},children:J.notes}),J.nextFollowupDate&&c.jsxs("div",{style:{color:"#DC2626",marginTop:"2px",fontSize:"10px"},children:["Next: ",wt(J.nextFollowupDate)]}),sr&&c.jsx("button",{onClick:()=>i4(J.id),style:{background:"none",border:"none",color:"#DC2626",cursor:"pointer",fontSize:"10px",padding:"2px 0",marginTop:"4px"},children:" Delete"})]},J.id))})]})})]},V.invoiceNo)})})]})]},_.partyName))]})},Fy=()=>{const h=Ee.filter(B=>B.invoiceGenerated).reduce((B,H)=>B+(parseFloat(H.invoiceTotalAmount)||0),0),_=Ee.filter(B=>B.invoiceStatus==="Paid").reduce((B,H)=>B+(parseFloat(H.invoiceTotalAmount)||0),0),V=Ee.filter(B=>B.invoiceStatus==="Approved").reduce((B,H)=>B+(parseFloat(H.invoiceTotalAmount)||0),0),Z=Ee.filter(B=>B.invoiceStatus==="Need Edits").length;return c.jsxs("div",{children:[c.jsx("h1",{style:{margin:"0 0 16px",fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Reports"}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px"},children:[c.jsxs(pn,{children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Total Invoiced"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:et(h)})]}),c.jsxs(pn,{children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Approved"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669"},children:et(V)})]}),c.jsxs(pn,{children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Need Edits"}),c.jsxs("div",{style:{fontSize:"24px",fontWeight:"700",color:"#DC2626"},children:[Z," invoices"]})]}),c.jsxs(pn,{children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Paid"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669"},children:et(_)})]})]})]})},Q4=()=>c.jsxs("div",{children:[c.jsx("h1",{style:{margin:"0 0 16px",fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Settings"}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[c.jsxs(pn,{title:" Invoice Series",children:[c.jsx(Or,{label:"Invoice Prefix",value:w.invoicePrefix,onChange:h=>I(_=>({..._,invoicePrefix:h.target.value})),small:!0}),c.jsx(Or,{label:"Next Invoice Number",type:"number",value:Ne,onChange:h=>ke(parseInt(h.target.value)||1),small:!0}),c.jsx(Or,{label:"Next Combine Code",type:"number",value:rt,onChange:h=>ee(parseInt(h.target.value)||1),small:!0}),c.jsxs("div",{style:{padding:"10px",backgroundColor:"#EFF6FF",borderRadius:"8px",fontSize:"14px"},children:[c.jsx("strong",{children:"Preview:"})," ",w.invoicePrefix,Ne]})]}),c.jsxs(pn,{title:" Mailer Logo",children:[c.jsx("input",{type:"file",ref:Va,accept:"image/*",style:{display:"none"},onChange:A4}),Ot?c.jsxs("div",{style:{textAlign:"center"},children:[c.jsx("img",{src:Ot,alt:"Logo",style:{maxWidth:"250px",maxHeight:"60px",marginBottom:"12px",border:"1px solid #E2E8F0",padding:"8px",borderRadius:"8px"}}),c.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"center"},children:[c.jsx(ze,{icon:BL,label:"Change",small:!0,onClick:()=>{var h;return(h=Va.current)==null?void 0:h.click()}}),c.jsx(ze,{icon:rs,label:"Remove",variant:"danger",small:!0,onClick:()=>La(null)})]})]}):c.jsxs("div",{onClick:()=>{var h;return(h=Va.current)==null?void 0:h.click()},style:{border:"2px dashed #CBD5E1",borderRadius:"10px",padding:"30px",textAlign:"center",cursor:"pointer"},children:[c.jsx(Qs,{size:32,color:"#94A3B8",style:{marginBottom:"8px"}}),c.jsx("p",{style:{margin:0,color:"#64748B",fontSize:"14px"},children:"Click to upload"})]})]}),c.jsxs(pn,{title:" WhatsApp Notifications",children:[c.jsx("div",{style:{marginBottom:"16px"},children:c.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"10px",cursor:"pointer"},children:[c.jsx("input",{type:"checkbox",checked:st.enabled,onChange:h=>$s(_=>({..._,enabled:h.target.checked})),style:{width:"18px",height:"18px",cursor:"pointer"}}),c.jsx("span",{style:{fontSize:"14px",fontWeight:"600",color:"#1E293B"},children:"Enable WhatsApp Notifications"})]})}),st.enabled&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{style:{padding:"12px",backgroundColor:"#DCFCE7",borderRadius:"8px",marginBottom:"16px",fontSize:"12px",color:"#166534",border:"1px solid #86EFAC"},children:[c.jsx("strong",{children:" FREE Setup using CallMeBot:"}),c.jsx("br",{}),"1. Save this number in contacts: ",c.jsx("strong",{children:"+34 644 71 81 99"}),c.jsx("br",{}),"2. Send this message to the number on WhatsApp: ",c.jsx("strong",{children:'"I allow callmebot to send me messages"'}),c.jsx("br",{}),"3. You'll receive an API key - enter it below",c.jsx("br",{}),"4. Repeat for each phone number you want to receive notifications"]}),c.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",marginBottom:"12px",border:"1px solid #E2E8F0"},children:[c.jsxs("div",{style:{fontSize:"13px",fontWeight:"700",color:"#1E293B",marginBottom:"10px",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(Y0,{size:16})," Finance Team"]}),c.jsx(Or,{label:"Phone (with country code)",value:st.financePhone,onChange:h=>$s(_=>({..._,financePhone:h.target.value})),placeholder:"919876543210",small:!0}),c.jsx(Or,{label:"API Key (from CallMeBot)",value:st.financeApiKey,onChange:h=>$s(_=>({..._,financeApiKey:h.target.value})),placeholder:"123456",small:!0}),st.financePhone&&st.financeApiKey&&c.jsx(ze,{icon:nE,label:"Test Finance",variant:"success",small:!0,onClick:()=>Sc(st.financePhone,st.financeApiKey)})]}),c.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",border:"1px solid #E2E8F0"},children:[c.jsxs("div",{style:{fontSize:"13px",fontWeight:"700",color:"#1E293B",marginBottom:"10px",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(Y0,{size:16})," Director"]}),c.jsx(Or,{label:"Phone (with country code)",value:st.directorPhone,onChange:h=>$s(_=>({..._,directorPhone:h.target.value})),placeholder:"919876543210",small:!0}),c.jsx(Or,{label:"API Key (from CallMeBot)",value:st.directorApiKey,onChange:h=>$s(_=>({..._,directorApiKey:h.target.value})),placeholder:"123456",small:!0}),st.directorPhone&&st.directorApiKey&&c.jsx(ze,{icon:nE,label:"Test Director",variant:"success",small:!0,onClick:()=>Sc(st.directorPhone,st.directorApiKey)})]})]}),!st.enabled&&c.jsx("div",{style:{padding:"20px",backgroundColor:"#F8FAFC",borderRadius:"8px",textAlign:"center",color:"#64748B",fontSize:"13px"},children:"WhatsApp notifications are disabled. Enable to receive FREE alerts for invoices, approvals, and payments."})]}),c.jsxs(pn,{title:" Default Invoice Values",children:[c.jsx("input",{type:"file",ref:Eo,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:a4}),c.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[c.jsx(ze,{icon:Qs,label:"Upload",variant:"brand",small:!0,onClick:()=>{var h;return(h=Eo.current)==null?void 0:h.click()}}),c.jsx(ze,{icon:bo,label:"Template",small:!0,onClick:o4})]}),Object.keys($n).length>0&&c.jsx("div",{style:{maxHeight:"180px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"8px"},children:Object.entries($n).map(([h,_])=>c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px 14px",borderBottom:"1px solid #F1F5F9",fontSize:"13px"},children:[c.jsx("span",{children:h}),c.jsx("span",{style:{fontWeight:"700"},children:et(_)})]},h))})]}),c.jsxs(pn,{title:" Party Master",children:[c.jsx("input",{type:"file",ref:o0,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:l4}),c.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[c.jsx(ze,{icon:Qs,label:"Upload Parties",variant:"brand",small:!0,onClick:()=>{var h;return(h=o0.current)==null?void 0:h.click()}}),c.jsx(ze,{icon:bo,label:"Template",small:!0,onClick:c4})]}),c.jsxs("div",{style:{padding:"10px",backgroundColor:"#EFF6FF",borderRadius:"8px",fontSize:"12px",color:"#1E40AF",marginBottom:"12px"},children:[c.jsx("strong",{children:"Upload Format:"})," Name of Ledger, Ledger Group, State Name, GST Registration Type, GSTIN/UIN"]}),Object.keys(rn).length>0&&c.jsxs("div",{style:{maxHeight:"150px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"8px"},children:[Object.entries(rn).slice(0,20).map(([h,_])=>c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 12px",borderBottom:"1px solid #F1F5F9",fontSize:"11px"},children:[c.jsx("span",{style:{fontWeight:"600"},children:h.length>30?h.substring(0,30)+"...":h}),c.jsxs("span",{style:{color:"#64748B"},children:[_.stateName||"-"," | ",_.gstin?_.gstin.substring(0,10)+"...":"-"]})]},h)),Object.keys(rn).length>20&&c.jsxs("div",{style:{padding:"8px 12px",textAlign:"center",color:"#64748B",fontSize:"11px"},children:["... and ",Object.keys(rn).length-20," more parties"]})]}),Object.keys(rn).length===0&&c.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#94A3B8",fontSize:"13px"},children:"No party master uploaded yet"})]}),c.jsxs(pn,{title:" Data Management",children:[c.jsxs("div",{style:{padding:"16px",backgroundColor:"#FEF2F2",borderRadius:"10px",border:"1px solid #FCA5A5",marginBottom:"16px"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"14px",marginBottom:"8px"},children:" Danger Zone"}),c.jsxs("div",{style:{fontSize:"13px",color:"#7F1D1D",marginBottom:"16px"},children:["This will permanently delete all data including:",c.jsxs("ul",{style:{margin:"8px 0 0 16px",padding:0},children:[c.jsx("li",{children:"All campaigns and master data"}),c.jsx("li",{children:"All invoices and receipts"}),c.jsx("li",{children:"All ledger entries"}),c.jsx("li",{children:"All mailer images"}),c.jsx("li",{children:"Opening balances and settings"})]})]}),c.jsx(ze,{icon:rs,label:"Clear All Data",variant:"danger",onClick:()=>zs(!0)})]}),c.jsxs("div",{style:{fontSize:"12px",color:"#64748B"},children:[c.jsx("strong",{children:"Current Data:"}),c.jsx("br",{})," ",Ee.length," campaigns",c.jsx("br",{})," ",se.length," ledger entries",c.jsx("br",{})," ",Be.length," receipts",c.jsx("br",{})," ",Object.keys(tn).length," mailer images"]})]})]})]}),J4=()=>c.jsxs(c.Fragment,{children:[c.jsx(Mn,{isOpen:C4,onClose:()=>{yy(!1),Ey("")},title:" Invoice Preview",width:"950px",children:ce&&_y&&c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px",padding:"14px 18px",backgroundColor:"#DCFCE7",borderRadius:"10px",border:"2px solid #22C55E"},children:[c.jsxs("div",{children:[c.jsxs("span",{style:{fontWeight:"700",fontSize:"16px",color:"#166534"},children:["Invoice: ",ce.invoiceNo]}),ce.invoiceType==="Combined"&&c.jsxs("span",{style:{marginLeft:"12px",padding:"4px 10px",backgroundColor:"#7C3AED",color:"white",borderRadius:"6px",fontSize:"12px",fontWeight:"600"},children:["Combined - C",ce.combinationCode]})]}),c.jsxs("button",{onClick:()=>F4(ce),style:{padding:"14px 28px",fontSize:"16px",fontWeight:"bold",border:"none",borderRadius:"10px",cursor:"pointer",backgroundColor:"#22C55E",color:"white",display:"flex",alignItems:"center",gap:"10px",boxShadow:"0 2px 8px rgba(34, 197, 94, 0.4)"},children:[c.jsx(bo,{size:20}),"Download Invoice"]})]}),c.jsx("div",{style:{border:"2px solid #E2E8F0",borderRadius:"10px",overflow:"hidden",backgroundColor:"#f5f5f5"},children:c.jsx("iframe",{id:"invoice-viewer-iframe",srcDoc:_y,style:{width:"100%",height:"480px",border:"none",backgroundColor:"white"},title:"Invoice Preview"})}),c.jsxs("div",{style:{marginTop:"12px",padding:"14px 18px",backgroundColor:"#FEF3C7",borderRadius:"10px",border:"1px solid #FCD34D"},children:[c.jsx("div",{style:{fontSize:"14px",color:"#92400E",fontWeight:"600",marginBottom:"6px"},children:" How to Save as PDF:"}),c.jsxs("ol",{style:{fontSize:"13px",color:"#92400E",margin:"0",paddingLeft:"20px",lineHeight:"1.8"},children:[c.jsxs("li",{children:["Click ",c.jsx("strong",{children:'"Download Invoice"'})," button above"]}),c.jsxs("li",{children:["Open the downloaded ",c.jsx("strong",{children:".html file"})," in Chrome/Edge browser"]}),c.jsxs("li",{children:["Print dialog will open automatically - select ",c.jsx("strong",{children:'"Save as PDF"'})]}),c.jsxs("li",{children:["Click ",c.jsx("strong",{children:"Save"})," to get your PDF!"]})]})]})]})}),c.jsx(Mn,{isOpen:Cr,onClose:()=>{Sr(!1),Pi(""),da({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1})},title:yr?" Review & Approve Invoice":" Invoice Details",width:"550px",children:ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",ce.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",ce.partyName]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Amount:"})," ",et(ce.invoiceTotalAmount)]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Email:"})," ",ce.emailId||"Not set"]}),c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Invoice Type:"})," ",c.jsx("span",{style:{color:ce.invoiceType==="Combined"?"#7C3AED":"#2874A6",fontWeight:"600"},children:ce.invoiceType||"Individual"})]}),ce.invoiceType==="Combined"&&c.jsxs("div",{style:{marginTop:"8px",fontSize:"13px",color:"#7C3AED"},children:[c.jsx("strong",{children:"Combined Campaigns:"})," ",C(ce).map(h=>h.senderName).join(", ")]})]}),ce.editComments&&c.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[c.jsx("div",{style:{fontWeight:"600",color:"#991B1B",fontSize:"13px",marginBottom:"4px"},children:" Need Edits - Director Remarks:"}),c.jsx("div",{style:{fontSize:"13px",color:"#7F1D1D"},children:ce.editComments})]}),ce.approvalRemarks&&ce.invoiceStatus==="Approved"&&c.jsxs("div",{style:{backgroundColor:"#DCFCE7",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[c.jsx("div",{style:{fontWeight:"600",color:"#166534",fontSize:"13px",marginBottom:"4px"},children:" Approved - Director Remarks:"}),c.jsx("div",{style:{fontSize:"13px",color:"#15803D"},children:ce.approvalRemarks})]}),yr?c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#166534",fontSize:"14px",marginBottom:"12px"},children:" Approval Confirmations"}),c.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",marginBottom:"12px",cursor:"pointer"},children:[c.jsx("input",{type:"checkbox",checked:ja.particularsApproved,onChange:h=>da(_=>({..._,particularsApproved:h.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"1. Particulars & Amount Approved"}),c.jsxs("div",{style:{fontSize:"12px",color:"#15803D"},children:["I confirm that the invoice particulars and amount (",et(ce.invoiceTotalAmount),") are correct."]})]})]}),c.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",marginBottom:"12px",cursor:"pointer"},children:[c.jsx("input",{type:"checkbox",checked:ja.emailApproved,onChange:h=>da(_=>({..._,emailApproved:h.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"2. Email ID Approved for Mailing"}),c.jsxs("div",{style:{fontSize:"12px",color:"#15803D"},children:["I confirm that ",c.jsx("strong",{children:ce.emailId||"the specified email"})," should be used for mailing."]})]})]}),c.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",cursor:"pointer"},children:[c.jsx("input",{type:"checkbox",checked:ja.invoiceTypeApproved,onChange:h=>da(_=>({..._,invoiceTypeApproved:h.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"3. Invoice Type Confirmed"}),c.jsx("div",{style:{fontSize:"12px",color:"#15803D"},children:ce.invoiceType==="Combined"?`I confirm that a Combined Invoice is required for these ${C(ce).length} campaigns.`:"I confirm that an Individual Invoice is required (not combined with others)."})]})]})]}):c.jsxs("div",{style:{backgroundColor:ce.invoiceStatus==="Approved"?"#DCFCE7":ce.invoiceStatus==="Need Edits"?"#FEF3C7":"#F8FAFC",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid "+(ce.invoiceStatus==="Approved"?"#86EFAC":ce.invoiceStatus==="Need Edits"?"#FCD34D":"#E2E8F0")},children:[c.jsx("div",{style:{fontWeight:"600",color:ce.invoiceStatus==="Approved"?"#166534":ce.invoiceStatus==="Need Edits"?"#92400E":"#64748B",fontSize:"14px"},children:ce.invoiceStatus==="Approved"?" Approved by Director":ce.invoiceStatus==="Need Edits"?" Edits Required by Director":" Pending Director Approval"}),c.jsx("div",{style:{fontSize:"13px",color:ce.invoiceStatus==="Approved"?"#15803D":ce.invoiceStatus==="Need Edits"?"#A16207":"#64748B",marginTop:"6px"},children:ce.invoiceStatus==="Approved"?"This invoice has been approved and is ready for mailing.":ce.invoiceStatus==="Need Edits"?"Please make the required changes and resubmit for approval.":"This invoice is awaiting Director approval."})]}),yr&&c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:" Remarks (optional for Approve, visible to Finance)"}),c.jsx("textarea",{value:ua,onChange:h=>Pi(h.target.value),placeholder:"Enter remarks or comments...",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(ze,{label:"Close",onClick:()=>{Sr(!1),Pi(""),da({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1})}}),yr&&c.jsxs(c.Fragment,{children:[c.jsx(ze,{label:"Need Edits",variant:"danger",icon:ML,onClick:Pn}),c.jsx(ze,{label:"Approve",variant:"success",icon:UL,onClick:Ht})]})]})]})}),c.jsx(Mn,{isOpen:Dr,onClose:()=>Ei(!1),title:" Delete Invoice",width:"450px",children:ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"15px",marginBottom:"8px"},children:" Are you sure?"}),c.jsxs("div",{style:{fontSize:"14px",color:"#7F1D1D",lineHeight:"1.5"},children:["This will delete invoice ",c.jsx("strong",{children:ce.invoiceNo})," and reset the campaign(s) to allow re-generation.",ce.invoiceType==="Combined"&&c.jsxs("div",{style:{marginTop:"8px"},children:[c.jsxs("strong",{children:["All ",C(ce).length," combined campaigns"]})," will be reset to Individual type for re-selection."]})]})]}),c.jsxs("div",{style:{backgroundColor:"#F8FAFC",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"Invoice:"})," ",ce.invoiceNo]}),c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"Party:"})," ",ce.partyName]}),c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"Amount:"})," ",et(ce.invoiceTotalAmount)]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(ze,{label:"Cancel",onClick:()=>Ei(!1)}),c.jsx(ze,{label:"Delete Invoice",variant:"danger",icon:rs,onClick:QF})]})]})}),c.jsx(Mn,{isOpen:_i,onClose:()=>pt(!1),title:" Add Email Address",width:"400px",children:ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"Campaign:"})," ",ce.senderName]}),c.jsxs("div",{style:{fontSize:"13px",marginTop:"4px"},children:[c.jsx("strong",{children:"Current:"})," ",ce.emailId||"None"]})]}),c.jsx(Or,{label:"Additional Email Address",type:"email",value:Oa,onChange:h=>Ws(h.target.value),placeholder:"email@example.com",small:!0}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:[c.jsx(ze,{label:"Cancel",onClick:()=>pt(!1)}),c.jsx(ze,{label:"Add Email",variant:"brand",icon:nm,onClick:()=>{Oa&&Oa.includes("@")?($e(ce.id,Oa),pt(!1),Ws("")):alert("Please enter a valid email address")}})]})]})}),c.jsx(Mn,{isOpen:k,onClose:()=>{E(!1),Y({currentPassword:"",newPassword:"",confirmPassword:""}),T("")},title:" Change Password",width:"400px",children:c.jsxs("div",{children:[c.jsx("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"User:"})," ",r==="director"?"Director":"Finance Team"]})}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Current Password"}),c.jsx("input",{type:"password",value:P.currentPassword,onChange:h=>Y(_=>({..._,currentPassword:h.target.value})),placeholder:"Enter current password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"New Password"}),c.jsx("input",{type:"password",value:P.newPassword,onChange:h=>Y(_=>({..._,newPassword:h.target.value})),placeholder:"Enter new password (min 6 characters)",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Confirm New Password"}),c.jsx("input",{type:"password",value:P.confirmPassword,onChange:h=>Y(_=>({..._,confirmPassword:h.target.value})),placeholder:"Confirm new password",onKeyPress:h=>h.key==="Enter"&&Tc(),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),W&&c.jsx("div",{style:{marginBottom:"16px",padding:"10px",backgroundColor:"#FEE2E2",borderRadius:"8px",color:"#991B1B",fontSize:"13px"},children:W}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[c.jsx(ze,{label:"Cancel",onClick:()=>{E(!1),Y({currentPassword:"",newPassword:"",confirmPassword:""}),T("")}}),c.jsx(ze,{label:"Change Password",variant:"brand",icon:G0,onClick:Tc})]})]})}),c.jsx(Mn,{isOpen:k,onClose:()=>{E(!1),T(""),Y({currentPassword:"",newPassword:"",confirmPassword:""})},title:" Change Password",width:"400px",children:c.jsxs("div",{children:[c.jsx("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:c.jsxs("div",{style:{fontSize:"13px",color:"#1E40AF"},children:["Changing password for: ",c.jsx("strong",{children:r==="director"?"Director":"Finance Team"})]})}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Current Password"}),c.jsx("input",{type:"password",value:P.currentPassword,onChange:h=>Y(_=>({..._,currentPassword:h.target.value})),placeholder:"Enter current password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"New Password"}),c.jsx("input",{type:"password",value:P.newPassword,onChange:h=>Y(_=>({..._,newPassword:h.target.value})),placeholder:"Enter new password (min 6 chars)",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Confirm New Password"}),c.jsx("input",{type:"password",value:P.confirmPassword,onChange:h=>Y(_=>({..._,confirmPassword:h.target.value})),placeholder:"Re-enter new password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),W&&c.jsx("div",{style:{marginBottom:"16px",padding:"10px",backgroundColor:"#FEE2E2",borderRadius:"8px",color:"#991B1B",fontSize:"13px"},children:W}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[c.jsx(ze,{label:"Cancel",onClick:()=>{E(!1),T(""),Y({currentPassword:"",newPassword:"",confirmPassword:""})}}),c.jsx(ze,{label:"Change Password",variant:"brand",icon:G0,onClick:Tc})]})]})}),c.jsx(Mn,{isOpen:Br,onClose:()=>{Ar(!1),fa(new Set),Gs(null)},title:" Combine Invoices",width:"700px",children:vc&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#F3E8FF",padding:"14px 18px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"15px",fontWeight:"700",color:"#6B21A8"},children:["Party: ",vc]}),c.jsx("div",{style:{fontSize:"13px",color:"#7C3AED",marginTop:"4px"},children:"Select 2+ campaigns to combine into a single invoice"})]}),c.jsx("div",{style:{maxHeight:"350px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"10px"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",position:"sticky",top:0},children:[c.jsx("th",{style:{padding:"12px",textAlign:"center",width:"50px"},children:""}),c.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Sender"}),c.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Subject"}),c.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Date"}),c.jsx("th",{style:{padding:"12px",textAlign:"right"},children:"Amount"})]})}),c.jsx("tbody",{children:d(vc).map(h=>{var _;return c.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:Sn.has(h.id)?"#F3E8FF":"transparent",cursor:"pointer"},onClick:()=>_4(h.id),children:[c.jsx("td",{style:{padding:"12px",textAlign:"center"},children:c.jsx("input",{type:"checkbox",checked:Sn.has(h.id),onChange:()=>{},style:{width:"18px",height:"18px",cursor:"pointer"}})}),c.jsx("td",{style:{padding:"12px",fontWeight:"600"},children:h.senderName}),c.jsxs("td",{style:{padding:"12px",color:"#64748B"},children:[(_=h.subject)==null?void 0:_.substring(0,35),"..."]}),c.jsx("td",{style:{padding:"12px"},children:wt(h.date)}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:et(h.totalWithGst)})]},h.id)})})]})}),c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px 18px",borderRadius:"10px",marginTop:"16px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsxs("div",{style:{fontSize:"14px",color:"#64748B"},children:["Selected: ",c.jsx("strong",{children:Sn.size})," | Combine Code: ",c.jsxs("strong",{children:["C",rt]})]}),c.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#2874A6"},children:["Total: ",et(Ee.filter(h=>Sn.has(h.id)).reduce((h,_)=>h+(parseFloat(_.totalWithGst)||0),0))]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[c.jsx(ze,{label:"Cancel",onClick:()=>{Ar(!1),fa(new Set)}}),c.jsx(ze,{label:"Create Combined Invoice",variant:"purple",icon:Io,disabled:Sn.size<2,onClick:y4})]})]})}),c.jsxs(Mn,{isOpen:Wn,onClose:()=>{Zr(!1),Bi(null),Ua(!1)},title:Hu?" Replace Mailer":" Upload Mailer",width:"550px",children:[c.jsx("input",{type:"file",ref:Gu,accept:"image/*",style:{display:"none"},onChange:S4}),ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"14px"},children:[c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Sender:"})," ",ce.senderName]}),c.jsxs("div",{style:{fontSize:"14px",marginTop:"4px"},children:[c.jsx("strong",{children:"Subject:"})," ",ce.subject]})]}),Hu&&tn[ce.id]&&c.jsx("div",{style:{backgroundColor:"#FEF3C7",padding:"12px",borderRadius:"10px",marginBottom:"14px",border:"1px solid #FCD34D"},children:c.jsxs("div",{style:{fontWeight:"600",color:"#92400E",fontSize:"13px"},children:[" This will replace ",tn[ce.id].length," existing image(s)"]})}),c.jsxs("div",{style:{backgroundColor:"#FEF3C7",padding:"14px",borderRadius:"10px",marginBottom:"14px",border:"1px solid #FCD34D"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#92400E",marginBottom:"8px",fontSize:"14px"},children:"Step 1: Find Mailer in Gmail"}),c.jsxs("button",{onClick:()=>T4(ce.subject),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 18px",backgroundColor:"#EA4335",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:[c.jsx(PL,{size:16})," Search in Gmail"]})]}),c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"14px",borderRadius:"10px",border:"1px solid #86EFAC"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#166534",marginBottom:"8px",fontSize:"14px"},children:"Step 2: Paste Screenshot"}),c.jsx("div",{ref:Ku,tabIndex:0,onPaste:w4,onClick:()=>{var h;return(h=Ku.current)==null?void 0:h.focus()},style:{border:vs?"3px solid #22C55E":"3px dashed #22C55E",borderRadius:"10px",padding:vs?"8px":"30px",textAlign:"center",cursor:"pointer",backgroundColor:vs?"#FFFFFF":"#ECFDF5",minHeight:"100px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",outline:"none"},children:vs?c.jsxs(c.Fragment,{children:[c.jsx("img",{src:vs,alt:"Pasted",style:{maxWidth:"100%",maxHeight:"200px",borderRadius:"8px",marginBottom:"10px"}}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsx(ze,{icon:Z_,label:"Save",variant:"success",onClick:()=>xy(vs)}),c.jsx(ze,{icon:rs,label:"Clear",variant:"danger",onClick:()=>Bi(null)})]})]}):c.jsxs(c.Fragment,{children:[c.jsx(tm,{size:36,color:"#22C55E",style:{marginBottom:"8px"}}),c.jsx("div",{style:{fontWeight:"700",fontSize:"14px",color:"#166534"},children:"Click here & Press Ctrl+V"})]})}),c.jsxs("div",{style:{textAlign:"center",marginTop:"12px"},children:[c.jsx("span",{style:{color:"#64748B",fontSize:"13px"},children:" OR "}),c.jsx("div",{style:{marginTop:"8px"},children:c.jsx(ze,{icon:Qs,label:"Browse Files",onClick:()=>{var h;return(h=Gu.current)==null?void 0:h.click()}})})]})]})]})]}),c.jsx(Mn,{isOpen:Ii,onClose:()=>Xi(!1),title:" Send Invoice Email",width:"600px",children:ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",gap:"0",marginBottom:"16px",border:"2px solid #E2E8F0",borderRadius:"8px",overflow:"hidden"},children:[c.jsx("button",{onClick:()=>gs("reply"),style:{flex:1,padding:"12px",backgroundColor:Di==="reply"?"#2874A6":"#F8FAFC",color:Di==="reply"?"white":"#64748B",border:"none",cursor:"pointer",fontWeight:"700",fontSize:"14px"},children:" Reply to Thread"}),c.jsx("button",{onClick:()=>gs("new"),style:{flex:1,padding:"12px",backgroundColor:Di==="new"?"#2874A6":"#F8FAFC",color:Di==="new"?"white":"#64748B",border:"none",cursor:"pointer",fontWeight:"700",fontSize:"14px"},children:" New Email"})]}),c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",ce.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Amount:"})," ",et(ce.invoiceTotalAmount||ce.totalWithGst)]}),ce.invoiceType==="Combined"&&c.jsxs("div",{style:{fontSize:"13px",marginTop:"8px",color:"#7C3AED"},children:[c.jsx("strong",{children:"Campaigns:"})," ",C(ce).map(h=>h.senderName).join(", ")]}),c.jsx("div",{style:{fontSize:"14px",marginTop:"8px"},children:c.jsx("strong",{children:"Recipients:"})}),c.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",marginTop:"6px"},children:[xe(ce).map((h,_)=>c.jsx("span",{style:{padding:"4px 10px",backgroundColor:"#DBEAFE",borderRadius:"6px",fontSize:"13px",color:"#1E40AF"},children:h},_)),xe(ce).length===0&&c.jsx("span",{style:{color:"#94A3B8"},children:"No email addresses"})]})]}),Di==="reply"?c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[c.jsx("span",{style:{fontWeight:"700",fontSize:"14px"},children:"Email Body:"}),c.jsx("button",{onClick:()=>{navigator.clipboard.writeText(p0(ce)),alert(" Copied!")},style:{padding:"6px 14px",backgroundColor:"#22C55E",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"600"},children:" Copy"})]}),c.jsx("div",{style:{fontSize:"13px",backgroundColor:"#F8FAFC",padding:"14px",borderRadius:"10px",whiteSpace:"pre-wrap",maxHeight:"200px",overflowY:"auto",fontFamily:"monospace",border:"1px solid #E2E8F0",lineHeight:"1.5"},children:p0(ce)})]}):c.jsxs("div",{style:{display:"flex",gap:"10px"},children:[c.jsx("button",{onClick:()=>{const h=xe(ce),_=encodeURIComponent(h.join(",")),V=encodeURIComponent(vy(ce)),Z=encodeURIComponent(p0(ce));window.open(`https://mail.google.com/mail/?view=cm&to=${_}&su=${V}&body=${Z}`,"_blank")},style:{padding:"12px 20px",backgroundColor:"#EA4335",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"700"},children:" Open Gmail"}),c.jsx("button",{onClick:()=>{const h=xe(ce),_=encodeURIComponent(h.join(";")),V=encodeURIComponent(vy(ce)),Z=encodeURIComponent(p0(ce));window.open(`https://outlook.live.com/mail/0/deeplink/compose?to=${_}&subject=${V}&body=${Z}`,"_blank")},style:{padding:"12px 20px",backgroundColor:"#0078D4",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"700"},children:" Open Outlook"})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[c.jsx(ze,{label:"View Invoice",icon:Rc,onClick:()=>{Xi(!1),Qu(ce)}}),c.jsx(ze,{label:"Close",onClick:()=>Xi(!1)})]})]})}),c.jsx(Mn,{isOpen:Ni,onClose:()=>en(!1),title:" Record Payment",width:"500px",children:ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Invoice:"})," ",ce.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginTop:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",ce.partyName]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsx(Or,{label:"Payment Amount",type:"number",value:Pr.amount,onChange:h=>_o({...Pr,amount:h.target.value}),small:!0}),c.jsx(Or,{label:"Date",type:"date",value:Pr.date,onChange:h=>_o({...Pr,date:h.target.value}),small:!0})]}),c.jsx(rh,{label:"Payment Mode",value:Pr.mode,onChange:h=>_o({...Pr,mode:h.target.value}),options:[{value:"Bank",label:"Bank Transfer"},{value:"UPI",label:"UPI"},{value:"Cheque",label:"Cheque"},{value:"Cash",label:"Cash"}],small:!0}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsx(Or,{label:"TDS Deducted",type:"number",value:Pr.tds,onChange:h=>_o({...Pr,tds:h.target.value}),placeholder:"0",small:!0}),c.jsx(Or,{label:"Discount",type:"number",value:Pr.discount,onChange:h=>_o({...Pr,discount:h.target.value}),placeholder:"0",small:!0})]}),c.jsx(Or,{label:"Narration",value:Pr.narration,onChange:h=>_o({...Pr,narration:h.target.value}),placeholder:"Reference",small:!0}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[c.jsx(ze,{label:"Cancel",onClick:()=>en(!1)}),c.jsx(ze,{label:"Record Payment",variant:"success",icon:eE,onClick:b4})]})]})}),c.jsxs(Mn,{isOpen:Ri,onClose:()=>nr(!1),title:" Set Opening Balance",width:"450px",children:[c.jsx(rh,{label:"Select Party",value:ji.partyName,onChange:h=>_c({...ji,partyName:h.target.value}),options:[{value:"",label:"Choose a party..."},...Cl.map(h=>({value:h,label:h}))],small:!0}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"12px"},children:[c.jsx(Or,{label:"Amount",type:"number",value:ji.amount,onChange:h=>_c({...ji,amount:h.target.value}),small:!0}),c.jsx(rh,{label:"Type",value:ji.type,onChange:h=>_c({...ji,type:h.target.value}),options:[{value:"Dr",label:"Debit"},{value:"Cr",label:"Credit"}],small:!0})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[c.jsx(ze,{label:"Cancel",onClick:()=>nr(!1)}),c.jsx(ze,{label:"Save",variant:"brand",onClick:()=>{ji.partyName&&ji.amount&&(yc(h=>({...h,[ji.partyName]:ji.type==="Dr"?parseFloat(ji.amount):-parseFloat(ji.amount)})),nr(!1),_c({partyName:"",amount:"",type:"Dr"}))}})]})]}),c.jsxs(Mn,{isOpen:s0,onClose:()=>Ks(!1),title:" Import Historical Ledger",width:"600px",children:[c.jsx("input",{type:"file",ref:l0,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:u4}),c.jsxs("div",{style:{padding:"16px",backgroundColor:"#EFF6FF",borderRadius:"10px",marginBottom:"16px",border:"1px solid #BFDBFE"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#1E40AF",marginBottom:"8px",fontSize:"14px"},children:" How to Import Historical Ledger"}),c.jsxs("div",{style:{fontSize:"12px",color:"#1E3A8A",lineHeight:"1.6"},children:[c.jsx("p",{style:{margin:"0 0 8px 0"},children:"Upload your existing ledger data in the format shown in the template. This will import all historical transactions."}),c.jsxs("p",{style:{margin:0},children:[c.jsx("strong",{children:"Supported columns:"})," Date, Particular, Vch Type, Vch No., Debit, Credit, Date of Receipt, Amount Received, TDS Received, Balance, Payment Status"]})]})]}),X&&c.jsxs("div",{style:{padding:"12px",backgroundColor:"#DCFCE7",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[c.jsxs("div",{style:{fontSize:"13px",color:"#166534"},children:[c.jsx("strong",{children:" Selected Party:"})," ",X]}),c.jsx("div",{style:{fontSize:"11px",color:"#15803D",marginTop:"4px"},children:"All entries from the uploaded file will be imported for this party"})]}),!X&&c.jsxs("div",{style:{padding:"12px",backgroundColor:"#FEE2E2",borderRadius:"8px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[c.jsx("div",{style:{fontSize:"13px",color:"#991B1B"},children:c.jsx("strong",{children:" No Party Selected"})}),c.jsx("div",{style:{fontSize:"12px",color:"#B91C1C",marginTop:"4px"},children:'Please close this modal and select a party from the Parties list on the left, then click "Import Historical" again.'})]}),c.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginBottom:"16px"},children:[c.jsx(ze,{icon:bo,label:"Download Template",variant:"brand",onClick:d4}),X?c.jsx(ze,{icon:Qs,label:"Upload Ledger",variant:"success",onClick:()=>{var h;return(h=l0.current)==null?void 0:h.click()}}):c.jsxs("button",{disabled:!0,style:{padding:"8px 16px",fontSize:"13px",fontWeight:"600",border:"none",borderRadius:"8px",backgroundColor:"#E2E8F0",color:"#94A3B8",cursor:"not-allowed",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(Qs,{size:16})," Upload Ledger"]})]}),c.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",border:"1px solid #E2E8F0"},children:[c.jsx("div",{style:{fontWeight:"600",color:"#475569",marginBottom:"8px",fontSize:"13px"},children:" Expected Format (matches your ledger export):"}),c.jsx("div",{style:{overflowX:"auto"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#E2E8F0"},children:[c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Date"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Particular"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Vch Type"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Vch No."}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Debit"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Credit"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Amt Recd"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Status"})]})}),c.jsx("tbody",{children:c.jsxs("tr",{children:[c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"02-Jun-21"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"DB Corp Ltd"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"Sales"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"MB/2020-21/0411"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0",textAlign:"right"},children:"6,000"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0",textAlign:"right"},children:"44,371"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"Received"})]})})]})})]}),c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:c.jsx(ze,{label:"Close",onClick:()=>Ks(!1)})})]}),c.jsx(Mn,{isOpen:vo,onClose:()=>{Pa(!1),Mi({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"})},title:" Create Receipt",width:"550px",children:ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",ce.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",ce.partyName]}),c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Invoice Amount:"})," ",et(ce.invoiceTotalAmount)]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[c.jsx(Or,{label:"Receipt Date",type:"date",value:Vt.date,onChange:h=>Mi({...Vt,date:h.target.value}),small:!0}),c.jsx(rh,{label:"Payment Mode",value:Vt.mode,onChange:h=>Mi({...Vt,mode:h.target.value}),options:[{value:"Bank",label:"Bank Transfer"},{value:"Cash",label:"Cash"},{value:"Cheque",label:"Cheque"},{value:"UPI",label:"UPI"}],small:!0})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"12px",marginBottom:"12px"},children:[c.jsx(Or,{label:"Amount Received",type:"number",value:Vt.amount,onChange:h=>Mi({...Vt,amount:h.target.value}),placeholder:"0.00",small:!0}),c.jsx(Or,{label:"TDS Deducted",type:"number",value:Vt.tds,onChange:h=>Mi({...Vt,tds:h.target.value}),placeholder:"0.00",small:!0}),c.jsx(Or,{label:"Discount",type:"number",value:Vt.discount,onChange:h=>Mi({...Vt,discount:h.target.value}),placeholder:"0.00",small:!0})]}),c.jsx("div",{style:{backgroundColor:"#F0FDF4",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:c.jsxs("div",{style:{fontSize:"14px",fontWeight:"700",color:"#166534"},children:["Total Credit: ",et((parseFloat(Vt.amount)||0)+(parseFloat(Vt.tds)||0)+(parseFloat(Vt.discount)||0))]})}),c.jsx(Or,{label:"Narration",value:Vt.narration,onChange:h=>Mi({...Vt,narration:h.target.value}),placeholder:"Payment reference, remarks...",small:!0}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Payment Advisory (Optional)"}),c.jsx("input",{type:"file",ref:Ec,accept:"image/*,.pdf",onChange:qu,style:{display:"none"}}),Vt.paymentAdvisory?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[c.jsx("div",{style:{flex:1,padding:"10px",backgroundColor:"#F0FDF4",borderRadius:"8px",fontSize:"13px",color:"#166534"},children:" Payment advisory attached"}),c.jsx("button",{onClick:()=>Mi(h=>({...h,paymentAdvisory:null})),style:{padding:"8px",border:"none",backgroundColor:"#FEE2E2",borderRadius:"6px",cursor:"pointer",color:"#991B1B"},children:c.jsx(_a,{size:16})})]}):c.jsxs("button",{onClick:()=>{var h;return(h=Ec.current)==null?void 0:h.click()},style:{padding:"10px 16px",border:"1.5px dashed #D1D5DB",borderRadius:"8px",backgroundColor:"#F9FAFB",cursor:"pointer",fontSize:"13px",color:"#6B7280",display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(Qs,{size:16})," Attach Payment Advisory"]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(ze,{label:"Cancel",onClick:()=>Pa(!1)}),c.jsx(ze,{label:"Create Receipt",variant:"success",icon:Io,onClick:Ao})]})]})}),c.jsx(Mn,{isOpen:Wu,onClose:()=>{Vs(!1),Ba({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]})},title:" Create Credit Note",width:"500px",children:ce&&(()=>{var H;const h=(H=ce.statePartyDetails)==null?void 0:H.toUpperCase().includes("MAHARASHTRA"),_=h?"CGST + SGST (9% + 9%)":"IGST (18%)",V=parseFloat(En.amount)||0,Z=parseFloat(En.gst)||0,B=V+Z;return c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",ce.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",ce.partyName]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice Amount:"})," ",et(ce.invoiceTotalAmount)]}),c.jsxs("div",{style:{fontSize:"12px",color:"#2563EB"},children:[c.jsx("strong",{children:"GST Type:"})," ",h?"CGST + SGST (Intra-state)":"IGST (Inter-state)"]})]}),c.jsx("div",{style:{marginBottom:"12px"},children:c.jsx(Or,{label:"Credit Note Date",type:"date",value:En.date,onChange:M=>Ba({...En,date:M.target.value}),small:!0})}),c.jsxs("div",{style:{backgroundColor:"#FEF2F2",padding:"14px",borderRadius:"10px",marginBottom:"12px",border:"1px solid #FECACA"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#991B1B",marginBottom:"10px",fontSize:"13px"},children:" Credit Note Breakdown"}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsx(Or,{label:"Base Amount",type:"number",value:En.amount,onChange:M=>Ba({...En,amount:M.target.value}),placeholder:"0.00",small:!0}),c.jsx(Or,{label:_,type:"number",value:En.gst,onChange:M=>Ba({...En,gst:M.target.value}),placeholder:"0.00",small:!0})]}),c.jsxs("div",{style:{marginTop:"10px",padding:"8px",backgroundColor:"#FEE2E2",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsx("span",{style:{fontSize:"13px",fontWeight:"600",color:"#991B1B"},children:"Total Credit:"}),c.jsx("span",{style:{fontSize:"15px",fontWeight:"700",color:"#991B1B"},children:et(B)})]})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Reason for Credit Note *"}),c.jsx("textarea",{value:En.reason,onChange:M=>Ba({...En,reason:M.target.value}),placeholder:"Enter reason for issuing credit note...",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(ze,{label:"Cancel",onClick:()=>Vs(!1)}),c.jsx(ze,{label:"Create Credit Note",variant:"danger",icon:cd,onClick:Ac})]})]})})()}),c.jsx(Mn,{isOpen:wr,onClose:()=>{Oi(!1),ms(null)},title:" Add Followup",width:"500px",children:pr&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",pr.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",pr.partyName]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Amount:"})," ",et(pr.invoiceTotalAmount||pr.totalAmount)]}),c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Invoice Date:"})," ",wt(pr.invoiceDate||pr.date)]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[c.jsx(Or,{label:"Followup Date",type:"date",value:jr.date,onChange:h=>xs({...jr,date:h.target.value}),small:!0}),c.jsx(Or,{label:"Next Followup Date",type:"date",value:jr.nextFollowupDate,onChange:h=>xs({...jr,nextFollowupDate:h.target.value}),small:!0})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Followup Notes *"}),c.jsx("textarea",{value:jr.notes,onChange:h=>xs({...jr,notes:h.target.value}),placeholder:"Enter followup notes (e.g., Spoke with accounts team, payment promised by next week)",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Status"}),c.jsxs("select",{value:jr.status,onChange:h=>xs({...jr,status:h.target.value}),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px"},children:[c.jsx("option",{value:"Pending",children:"Pending"}),c.jsx("option",{value:"Promised",children:"Promised - Payment Expected"}),c.jsx("option",{value:"Disputed",children:"Disputed"}),c.jsx("option",{value:"No Response",children:"No Response"})]})]}),c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#166534",marginBottom:"8px"},children:" Quick Actions"}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsx(ze,{icon:tm,label:"Copy Email Template",small:!0,variant:"brand",onClick:()=>py(pr)}),c.jsx(ze,{icon:K0,label:"Search in Gmail",small:!0,variant:"success",onClick:()=>gy(pr)})]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(ze,{label:"Cancel",onClick:()=>Oi(!1)}),c.jsx(ze,{label:"Save Followup",variant:"primary",icon:dd,onClick:n4})]})]})}),c.jsx(Mn,{isOpen:_l,onClose:()=>zs(!1),title:" Clear All Data",width:"500px",children:c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"20px",borderRadius:"12px",marginBottom:"20px",border:"2px solid #FCA5A5"},children:[c.jsxs("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"18px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(Y_,{size:24})," Warning: This action cannot be undone!"]}),c.jsxs("div",{style:{fontSize:"14px",color:"#7F1D1D",lineHeight:"1.6"},children:["This will permanently delete:",c.jsxs("ul",{style:{margin:"12px 0 0 20px",padding:0},children:[c.jsxs("li",{children:[c.jsx("strong",{children:Ee.length})," campaigns from Master Sheet"]}),c.jsxs("li",{children:[c.jsx("strong",{children:Ee.filter(h=>h.invoiceGenerated).length})," generated invoices"]}),c.jsxs("li",{children:[c.jsx("strong",{children:Be.length})," receipts"]}),c.jsxs("li",{children:[c.jsx("strong",{children:ne.length})," credit notes"]}),c.jsxs("li",{children:[c.jsx("strong",{children:se.length})," ledger entries"]}),c.jsxs("li",{children:[c.jsx("strong",{children:Object.keys(tn).length})," mailer images"]}),c.jsx("li",{children:"All opening balances"})]})]})]}),c.jsx("div",{style:{backgroundColor:"#FEF3C7",padding:"14px",borderRadius:"8px",marginBottom:"20px",border:"1px solid #FCD34D"},children:c.jsxs("div",{style:{fontSize:"13px",color:"#92400E"},children:[c.jsx("strong",{children:"Note:"})," Invoice series numbers will be reset to 1. Your company settings and mailer logo will be preserved."]})}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[c.jsx(ze,{label:"Cancel",onClick:()=>zs(!1)}),c.jsx(ze,{label:"Yes, Clear All Data",variant:"danger",icon:rs,onClick:m4})]})]})}),c.jsx(Mn,{isOpen:qe,onClose:()=>dt(!1),title:" Notifications",width:"550px",children:c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B"},children:ws>0?`${ws} unread`:"No unread notifications"}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[ws>0&&c.jsx("button",{onClick:u0,style:{padding:"6px 12px",fontSize:"12px",fontWeight:"600",border:"1px solid #E2E8F0",borderRadius:"6px",backgroundColor:"#F8FAFC",color:"#475569",cursor:"pointer"},children:"Mark all as read"}),Ke.length>0&&sr&&c.jsx("button",{onClick:d0,style:{padding:"6px 12px",fontSize:"12px",fontWeight:"600",border:"1px solid #FCA5A5",borderRadius:"6px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer"},children:"Clear all"})]})]}),c.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:Ss.length===0?c.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:[c.jsx(q_,{size:40,style:{marginBottom:"12px",opacity:.5}}),c.jsx("div",{style:{fontSize:"16px",fontWeight:"600"},children:"No notifications"}),c.jsx("div",{style:{fontSize:"13px",marginTop:"4px"},children:"You're all caught up!"})]}):Ss.map(h=>{const _=!(h.read&&h.read[r]),V=B=>{switch(B){case"upload":return"";case"invoice":return"";case"approval":return"";case"edit":return"";case"receipt":return"";default:return""}},Z=B=>{switch(B){case"upload":return"#EFF6FF";case"invoice":return"#FEF3C7";case"approval":return"#DCFCE7";case"edit":return"#FEE2E2";case"receipt":return"#F0FDF4";default:return"#F8FAFC"}};return c.jsx("div",{onClick:()=>wc(h.id),style:{padding:"14px",borderRadius:"10px",marginBottom:"8px",backgroundColor:_?Z(h.type):"#F8FAFC",border:_?"2px solid #2874A6":"1px solid #E2E8F0",cursor:"pointer",transition:"all 0.2s ease"},children:c.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[c.jsx("div",{style:{fontSize:"20px"},children:V(h.type)}),c.jsxs("div",{style:{flex:1},children:[c.jsx("div",{style:{fontSize:"14px",fontWeight:_?"600":"500",color:"#1E293B",lineHeight:"1.4"},children:h.message}),c.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"8px",fontSize:"11px",color:"#64748B"},children:[c.jsxs("span",{children:["By: ",h.createdBy==="finance"?"Finance Team":"Director"]}),c.jsx("span",{children:""}),c.jsx("span",{children:new Date(h.createdAt).toLocaleString()})]})]}),_&&c.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#DC2626",flexShrink:0}})]})},h.id)})})]})})]}),Z4=()=>{switch(R){case"master":return Ty();case"services":return M4();case"invoices":return z4();case"receipts":return K4();case"ledgers":return Y4();case"followups":return q4();case"reports":return Fy();case"settings":return r==="finance"?Q4():Fy();default:return Ty()}},eb=()=>c.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 50%, #1E3A5F 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',padding:"20px"},children:c.jsxs("div",{style:{backgroundColor:"#FFFFFF",padding:"0",borderRadius:"24px",boxShadow:"0 25px 50px -12px rgba(0,0,0,0.25)",width:"420px",maxWidth:"95vw",overflow:"hidden"},children:[c.jsxs("div",{style:{background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 100%)",padding:"32px 40px",textAlign:"center"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:"8px"},children:[c.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"60px",height:"auto",borderRadius:"8px",backgroundColor:"white",padding:"4px"}}),c.jsx("span",{style:{fontSize:"36px",fontWeight:"800",color:"#FFFFFF",letterSpacing:"-1px"},children:"FinMate"})]}),c.jsx("p",{style:{margin:0,color:"rgba(255,255,255,0.8)",fontSize:"14px",fontWeight:"500"},children:"Finance Management System"})]}),c.jsxs("div",{style:{padding:"32px 40px"},children:[c.jsxs("div",{style:{marginBottom:"24px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#1E3A5F",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Username"}),c.jsxs("div",{style:{position:"relative"},children:[c.jsx(sE,{size:18,style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",value:i.username,onChange:h=>s(_=>({..._,username:h.target.value})),placeholder:"Enter username",style:{width:"100%",padding:"14px 14px 14px 44px",borderRadius:"12px",border:"2px solid #E2E8F0",fontSize:"15px",boxSizing:"border-box",transition:"border-color 0.2s, box-shadow 0.2s",outline:"none"},onFocus:h=>{h.target.style.borderColor="#2874A6",h.target.style.boxShadow="0 0 0 3px rgba(40,116,166,0.1)"},onBlur:h=>{h.target.style.borderColor="#E2E8F0",h.target.style.boxShadow="none"}})]})]}),c.jsxs("div",{style:{marginBottom:"28px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#1E3A5F",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Password"}),c.jsxs("div",{style:{position:"relative"},children:[c.jsx(G0,{size:18,style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"password",value:i.password,onChange:h=>s(_=>({..._,password:h.target.value})),placeholder:"Enter password",onKeyPress:h=>h.key==="Enter"&&Xu(),style:{width:"100%",padding:"14px 14px 14px 44px",borderRadius:"12px",border:"2px solid #E2E8F0",fontSize:"15px",boxSizing:"border-box",transition:"border-color 0.2s, box-shadow 0.2s",outline:"none"},onFocus:h=>{h.target.style.borderColor="#2874A6",h.target.style.boxShadow="0 0 0 3px rgba(40,116,166,0.1)"},onBlur:h=>{h.target.style.borderColor="#E2E8F0",h.target.style.boxShadow="none"}})]})]}),a&&c.jsxs("div",{style:{marginBottom:"20px",padding:"14px",backgroundColor:"#FEF2F2",borderRadius:"12px",color:"#DC2626",fontSize:"14px",textAlign:"center",border:"1px solid #FECACA",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[c.jsx(Y_,{size:18}),a]}),c.jsx("button",{onClick:Xu,style:{width:"100%",padding:"16px",fontSize:"16px",fontWeight:"700",border:"none",borderRadius:"12px",cursor:S?"pointer":"wait",background:S?"linear-gradient(135deg, #1E3A5F 0%, #2874A6 100%)":"#94A3B8",color:"white",transition:"transform 0.2s, box-shadow 0.2s",boxShadow:S?"0 4px 14px rgba(40,116,166,0.4)":"none",opacity:S?1:.7},disabled:!S,onMouseOver:h=>{S&&(h.target.style.transform="translateY(-2px)",h.target.style.boxShadow="0 6px 20px rgba(40,116,166,0.5)")},onMouseOut:h=>{S&&(h.target.style.transform="translateY(0)",h.target.style.boxShadow="0 4px 14px rgba(40,116,166,0.4)")},children:S?"Sign In":"Loading..."}),c.jsxs("div",{style:{marginTop:"24px",textAlign:"center",color:"#94A3B8",fontSize:"12px"},children:[c.jsx("span",{children:"Powered by "}),c.jsx("span",{style:{fontWeight:"600",color:"#1E3A5F"},children:"JAC"}),c.jsx("span",{children:"  Strategy | Talent | Results"})]})]})]})});return t?l?c.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 50%, #1E3A5F 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[c.jsxs("div",{style:{textAlign:"center"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:"24px"},children:[c.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"50px",height:"auto",borderRadius:"8px",backgroundColor:"white",padding:"4px"}}),c.jsx("span",{style:{fontSize:"32px",fontWeight:"800",color:"#FFFFFF",letterSpacing:"-1px"},children:"FinMate"})]}),c.jsx(tE,{size:48,style:{animation:"spin 1s linear infinite",color:"#FFFFFF",marginBottom:"16px"}}),c.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:"#FFFFFF"},children:"Loading your data..."}),c.jsx("div",{style:{fontSize:"14px",color:"rgba(255,255,255,0.7)",marginTop:"8px"},children:"Please wait while we sync with the cloud"})]}),c.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]}):c.jsxs("div",{style:{display:"flex",height:"100vh",backgroundColor:"#F1F5F9",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[I4(),c.jsx("main",{style:{flex:1,overflow:"auto",padding:"20px"},children:Z4()}),J4(),c.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]}):eb()}mm.createRoot(document.getElementById("root")).render(c.jsx(sh.StrictMode,{children:c.jsx(bH,{})}));
