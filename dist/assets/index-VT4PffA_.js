(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function uF(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var tw={exports:{}},dp={},rw={exports:{}},Tt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _d=Symbol.for("react.element"),fF=Symbol.for("react.portal"),dF=Symbol.for("react.fragment"),hF=Symbol.for("react.strict_mode"),pF=Symbol.for("react.profiler"),mF=Symbol.for("react.provider"),gF=Symbol.for("react.context"),xF=Symbol.for("react.forward_ref"),vF=Symbol.for("react.suspense"),yF=Symbol.for("react.memo"),_F=Symbol.for("react.lazy"),my=Symbol.iterator;function EF(t){return t===null||typeof t!="object"?null:(t=my&&t[my]||t["@@iterator"],typeof t=="function"?t:null)}var nw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},iw=Object.assign,sw={};function gu(t,e,r){this.props=t,this.context=e,this.refs=sw,this.updater=r||nw}gu.prototype.isReactComponent={};gu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};gu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function aw(){}aw.prototype=gu.prototype;function Rx(t,e,r){this.props=t,this.context=e,this.refs=sw,this.updater=r||nw}var Nx=Rx.prototype=new aw;Nx.constructor=Rx;iw(Nx,gu.prototype);Nx.isPureReactComponent=!0;var gy=Array.isArray,ow=Object.prototype.hasOwnProperty,Dx={current:null},lw={key:!0,ref:!0,__self:!0,__source:!0};function cw(t,e,r){var n,i={},s=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)ow.call(e,n)&&!lw.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:_d,type:t,key:s,ref:a,props:i,_owner:Dx.current}}function wF(t,e){return{$$typeof:_d,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Px(t){return typeof t=="object"&&t!==null&&t.$$typeof===_d}function TF(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var xy=/\/+/g;function Zp(t,e){return typeof t=="object"&&t!==null&&t.key!=null?TF(""+t.key):e.toString(36)}function H0(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case _d:case fF:a=!0}}if(a)return a=t,i=i(a),t=n===""?"."+Zp(a,0):n,gy(i)?(r="",t!=null&&(r=t.replace(xy,"$&/")+"/"),H0(i,e,r,"",function(c){return c})):i!=null&&(Px(i)&&(i=wF(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(xy,"$&/")+"/")+t)),e.push(i)),1;if(a=0,n=n===""?".":n+":",gy(t))for(var o=0;o<t.length;o++){s=t[o];var l=n+Zp(s,o);a+=H0(s,e,r,l,i)}else if(l=EF(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=n+Zp(s,o++),a+=H0(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function a0(t,e,r){if(t==null)return t;var n=[],i=0;return H0(t,n,"","",function(s){return e.call(r,s,i++)}),n}function SF(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var gi={current:null},$0={transition:null},AF={ReactCurrentDispatcher:gi,ReactCurrentBatchConfig:$0,ReactCurrentOwner:Dx};function uw(){throw Error("act(...) is not supported in production builds of React.")}Tt.Children={map:a0,forEach:function(t,e,r){a0(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return a0(t,function(){e++}),e},toArray:function(t){return a0(t,function(e){return e})||[]},only:function(t){if(!Px(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Tt.Component=gu;Tt.Fragment=dF;Tt.Profiler=pF;Tt.PureComponent=Rx;Tt.StrictMode=hF;Tt.Suspense=vF;Tt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=AF;Tt.act=uw;Tt.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=iw({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=Dx.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)ow.call(e,l)&&!lw.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:_d,type:t.type,key:i,ref:s,props:n,_owner:a}};Tt.createContext=function(t){return t={$$typeof:gF,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:mF,_context:t},t.Consumer=t};Tt.createElement=cw;Tt.createFactory=function(t){var e=cw.bind(null,t);return e.type=t,e};Tt.createRef=function(){return{current:null}};Tt.forwardRef=function(t){return{$$typeof:xF,render:t}};Tt.isValidElement=Px;Tt.lazy=function(t){return{$$typeof:_F,_payload:{_status:-1,_result:t},_init:SF}};Tt.memo=function(t,e){return{$$typeof:yF,type:t,compare:e===void 0?null:e}};Tt.startTransition=function(t){var e=$0.transition;$0.transition={};try{t()}finally{$0.transition=e}};Tt.unstable_act=uw;Tt.useCallback=function(t,e){return gi.current.useCallback(t,e)};Tt.useContext=function(t){return gi.current.useContext(t)};Tt.useDebugValue=function(){};Tt.useDeferredValue=function(t){return gi.current.useDeferredValue(t)};Tt.useEffect=function(t,e){return gi.current.useEffect(t,e)};Tt.useId=function(){return gi.current.useId()};Tt.useImperativeHandle=function(t,e,r){return gi.current.useImperativeHandle(t,e,r)};Tt.useInsertionEffect=function(t,e){return gi.current.useInsertionEffect(t,e)};Tt.useLayoutEffect=function(t,e){return gi.current.useLayoutEffect(t,e)};Tt.useMemo=function(t,e){return gi.current.useMemo(t,e)};Tt.useReducer=function(t,e,r){return gi.current.useReducer(t,e,r)};Tt.useRef=function(t){return gi.current.useRef(t)};Tt.useState=function(t){return gi.current.useState(t)};Tt.useSyncExternalStore=function(t,e,r){return gi.current.useSyncExternalStore(t,e,r)};Tt.useTransition=function(){return gi.current.useTransition()};Tt.version="18.3.1";rw.exports=Tt;var ye=rw.exports;const G0=uF(ye);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kF=ye,CF=Symbol.for("react.element"),FF=Symbol.for("react.fragment"),IF=Object.prototype.hasOwnProperty,bF=kF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,RF={key:!0,ref:!0,__self:!0,__source:!0};function fw(t,e,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)IF.call(e,n)&&!RF.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:CF,type:t,key:s,ref:a,props:i,_owner:bF.current}}dp.Fragment=FF;dp.jsx=fw;dp.jsxs=fw;tw.exports=dp;var f=tw.exports,ig={},dw={exports:{}},$i={},hw={exports:{}},pw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(_e,Z){var Ce=_e.length;_e.push(Z);e:for(;0<Ce;){var Be=Ce-1>>>1,U=_e[Be];if(0<i(U,Z))_e[Be]=Z,_e[Ce]=U,Ce=Be;else break e}}function r(_e){return _e.length===0?null:_e[0]}function n(_e){if(_e.length===0)return null;var Z=_e[0],Ce=_e.pop();if(Ce!==Z){_e[0]=Ce;e:for(var Be=0,U=_e.length,H=U>>>1;Be<H;){var Q=2*(Be+1)-1,X=_e[Q],he=Q+1,Te=_e[he];if(0>i(X,Ce))he<U&&0>i(Te,X)?(_e[Be]=Te,_e[he]=Ce,Be=he):(_e[Be]=X,_e[Q]=Ce,Be=Q);else if(he<U&&0>i(Te,Ce))_e[Be]=Te,_e[he]=Ce,Be=he;else break e}}return Z}function i(_e,Z){var Ce=_e.sortIndex-Z.sortIndex;return Ce!==0?Ce:_e.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],c=[],d=1,h=null,p=3,g=!1,y=!1,x=!1,E=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(_e){for(var Z=r(c);Z!==null;){if(Z.callback===null)n(c);else if(Z.startTime<=_e)n(c),Z.sortIndex=Z.expirationTime,e(l,Z);else break;Z=r(c)}}function P(_e){if(x=!1,_(_e),!y)if(r(l)!==null)y=!0,Re(W);else{var Z=r(c);Z!==null&&Ae(P,Z.startTime-_e)}}function W(_e,Z){y=!1,x&&(x=!1,T(F),F=-1),g=!0;var Ce=p;try{for(_(Z),h=r(l);h!==null&&(!(h.expirationTime>Z)||_e&&!N());){var Be=h.callback;if(typeof Be=="function"){h.callback=null,p=h.priorityLevel;var U=Be(h.expirationTime<=Z);Z=t.unstable_now(),typeof U=="function"?h.callback=U:h===r(l)&&n(l),_(Z)}else n(l);h=r(l)}if(h!==null)var H=!0;else{var Q=r(c);Q!==null&&Ae(P,Q.startTime-Z),H=!1}return H}finally{h=null,p=Ce,g=!1}}var j=!1,w=null,F=-1,S=5,b=-1;function N(){return!(t.unstable_now()-b<S)}function D(){if(w!==null){var _e=t.unstable_now();b=_e;var Z=!0;try{Z=w(!0,_e)}finally{Z?R():(j=!1,w=null)}}else j=!1}var R;if(typeof A=="function")R=function(){A(D)};else if(typeof MessageChannel<"u"){var He=new MessageChannel,ve=He.port2;He.port1.onmessage=D,R=function(){ve.postMessage(null)}}else R=function(){E(D,0)};function Re(_e){w=_e,j||(j=!0,R())}function Ae(_e,Z){F=E(function(){_e(t.unstable_now())},Z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(_e){_e.callback=null},t.unstable_continueExecution=function(){y||g||(y=!0,Re(W))},t.unstable_forceFrameRate=function(_e){0>_e||125<_e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<_e?Math.floor(1e3/_e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(_e){switch(p){case 1:case 2:case 3:var Z=3;break;default:Z=p}var Ce=p;p=Z;try{return _e()}finally{p=Ce}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(_e,Z){switch(_e){case 1:case 2:case 3:case 4:case 5:break;default:_e=3}var Ce=p;p=_e;try{return Z()}finally{p=Ce}},t.unstable_scheduleCallback=function(_e,Z,Ce){var Be=t.unstable_now();switch(typeof Ce=="object"&&Ce!==null?(Ce=Ce.delay,Ce=typeof Ce=="number"&&0<Ce?Be+Ce:Be):Ce=Be,_e){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=Ce+U,_e={id:d++,callback:Z,priorityLevel:_e,startTime:Ce,expirationTime:U,sortIndex:-1},Ce>Be?(_e.sortIndex=Ce,e(c,_e),r(l)===null&&_e===r(c)&&(x?(T(F),F=-1):x=!0,Ae(P,Ce-Be))):(_e.sortIndex=U,e(l,_e),y||g||(y=!0,Re(W))),_e},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(_e){var Z=p;return function(){var Ce=p;p=Z;try{return _e.apply(this,arguments)}finally{p=Ce}}}})(pw);hw.exports=pw;var NF=hw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DF=ye,Wi=NF;function Me(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var mw=new Set,Df={};function Wl(t,e){Qc(t,e),Qc(t+"Capture",e)}function Qc(t,e){for(Df[t]=e,t=0;t<e.length;t++)mw.add(e[t])}var Oa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),sg=Object.prototype.hasOwnProperty,PF=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,vy={},yy={};function OF(t){return sg.call(yy,t)?!0:sg.call(vy,t)?!1:PF.test(t)?yy[t]=!0:(vy[t]=!0,!1)}function MF(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function LF(t,e,r,n){if(e===null||typeof e>"u"||MF(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function xi(t,e,r,n,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var Dn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Dn[t]=new xi(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Dn[e]=new xi(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Dn[t]=new xi(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Dn[t]=new xi(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Dn[t]=new xi(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Dn[t]=new xi(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Dn[t]=new xi(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Dn[t]=new xi(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Dn[t]=new xi(t,5,!1,t.toLowerCase(),null,!1,!1)});var Ox=/[\-:]([a-z])/g;function Mx(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Ox,Mx);Dn[e]=new xi(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Ox,Mx);Dn[e]=new xi(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Ox,Mx);Dn[e]=new xi(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Dn[t]=new xi(t,1,!1,t.toLowerCase(),null,!1,!1)});Dn.xlinkHref=new xi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Dn[t]=new xi(t,1,!1,t.toLowerCase(),null,!0,!0)});function Lx(t,e,r,n){var i=Dn.hasOwnProperty(e)?Dn[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(LF(e,r,i,n)&&(r=null),n||i===null?OF(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var $a=DF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,o0=Symbol.for("react.element"),wc=Symbol.for("react.portal"),Tc=Symbol.for("react.fragment"),Bx=Symbol.for("react.strict_mode"),ag=Symbol.for("react.profiler"),gw=Symbol.for("react.provider"),xw=Symbol.for("react.context"),jx=Symbol.for("react.forward_ref"),og=Symbol.for("react.suspense"),lg=Symbol.for("react.suspense_list"),Vx=Symbol.for("react.memo"),fo=Symbol.for("react.lazy"),vw=Symbol.for("react.offscreen"),_y=Symbol.iterator;function Vu(t){return t===null||typeof t!="object"?null:(t=_y&&t[_y]||t["@@iterator"],typeof t=="function"?t:null)}var br=Object.assign,em;function Zu(t){if(em===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);em=e&&e[1]||""}return`
`+em+t}var tm=!1;function rm(t,e){if(!t||tm)return"";tm=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{tm=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Zu(t):""}function BF(t){switch(t.tag){case 5:return Zu(t.type);case 16:return Zu("Lazy");case 13:return Zu("Suspense");case 19:return Zu("SuspenseList");case 0:case 2:case 15:return t=rm(t.type,!1),t;case 11:return t=rm(t.type.render,!1),t;case 1:return t=rm(t.type,!0),t;default:return""}}function cg(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Tc:return"Fragment";case wc:return"Portal";case ag:return"Profiler";case Bx:return"StrictMode";case og:return"Suspense";case lg:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case xw:return(t.displayName||"Context")+".Consumer";case gw:return(t._context.displayName||"Context")+".Provider";case jx:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Vx:return e=t.displayName||null,e!==null?e:cg(t.type)||"Memo";case fo:e=t._payload,t=t._init;try{return cg(t(e))}catch{}}return null}function jF(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return cg(e);case 8:return e===Bx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function jo(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function yw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function VF(t){var e=yw(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function l0(t){t._valueTracker||(t._valueTracker=VF(t))}function _w(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=yw(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function dh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ug(t,e){var r=e.checked;return br({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function Ey(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=jo(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Ew(t,e){e=e.checked,e!=null&&Lx(t,"checked",e,!1)}function fg(t,e){Ew(t,e);var r=jo(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?dg(t,e.type,r):e.hasOwnProperty("defaultValue")&&dg(t,e.type,jo(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function wy(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function dg(t,e,r){(e!=="number"||dh(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var ef=Array.isArray;function Lc(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+jo(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function hg(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Me(91));return br({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ty(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Me(92));if(ef(r)){if(1<r.length)throw Error(Me(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:jo(r)}}function ww(t,e){var r=jo(e.value),n=jo(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function Sy(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Tw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pg(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Tw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var c0,Sw=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(c0=c0||document.createElement("div"),c0.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=c0.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Pf(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var ff={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},UF=["Webkit","ms","Moz","O"];Object.keys(ff).forEach(function(t){UF.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ff[e]=ff[t]})});function Aw(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||ff.hasOwnProperty(t)&&ff[t]?(""+e).trim():e+"px"}function kw(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Aw(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var zF=br({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function mg(t,e){if(e){if(zF[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Me(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Me(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Me(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Me(62))}}function gg(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xg=null;function Ux(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var vg=null,Bc=null,jc=null;function Ay(t){if(t=Td(t)){if(typeof vg!="function")throw Error(Me(280));var e=t.stateNode;e&&(e=xp(e),vg(t.stateNode,t.type,e))}}function Cw(t){Bc?jc?jc.push(t):jc=[t]:Bc=t}function Fw(){if(Bc){var t=Bc,e=jc;if(jc=Bc=null,Ay(t),e)for(t=0;t<e.length;t++)Ay(e[t])}}function Iw(t,e){return t(e)}function bw(){}var nm=!1;function Rw(t,e,r){if(nm)return t(e,r);nm=!0;try{return Iw(t,e,r)}finally{nm=!1,(Bc!==null||jc!==null)&&(bw(),Fw())}}function Of(t,e){var r=t.stateNode;if(r===null)return null;var n=xp(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Me(231,e,typeof r));return r}var yg=!1;if(Oa)try{var Uu={};Object.defineProperty(Uu,"passive",{get:function(){yg=!0}}),window.addEventListener("test",Uu,Uu),window.removeEventListener("test",Uu,Uu)}catch{yg=!1}function WF(t,e,r,n,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(d){this.onError(d)}}var df=!1,hh=null,ph=!1,_g=null,HF={onError:function(t){df=!0,hh=t}};function $F(t,e,r,n,i,s,a,o,l){df=!1,hh=null,WF.apply(HF,arguments)}function GF(t,e,r,n,i,s,a,o,l){if($F.apply(this,arguments),df){if(df){var c=hh;df=!1,hh=null}else throw Error(Me(198));ph||(ph=!0,_g=c)}}function Hl(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function Nw(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function ky(t){if(Hl(t)!==t)throw Error(Me(188))}function KF(t){var e=t.alternate;if(!e){if(e=Hl(t),e===null)throw Error(Me(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return ky(i),t;if(s===n)return ky(i),e;s=s.sibling}throw Error(Me(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(Me(189))}}if(r.alternate!==n)throw Error(Me(190))}if(r.tag!==3)throw Error(Me(188));return r.stateNode.current===r?t:e}function Dw(t){return t=KF(t),t!==null?Pw(t):null}function Pw(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Pw(t);if(e!==null)return e;t=t.sibling}return null}var Ow=Wi.unstable_scheduleCallback,Cy=Wi.unstable_cancelCallback,XF=Wi.unstable_shouldYield,YF=Wi.unstable_requestPaint,Hr=Wi.unstable_now,qF=Wi.unstable_getCurrentPriorityLevel,zx=Wi.unstable_ImmediatePriority,Mw=Wi.unstable_UserBlockingPriority,mh=Wi.unstable_NormalPriority,QF=Wi.unstable_LowPriority,Lw=Wi.unstable_IdlePriority,hp=null,ea=null;function JF(t){if(ea&&typeof ea.onCommitFiberRoot=="function")try{ea.onCommitFiberRoot(hp,t,void 0,(t.current.flags&128)===128)}catch{}}var Ps=Math.clz32?Math.clz32:tI,ZF=Math.log,eI=Math.LN2;function tI(t){return t>>>=0,t===0?32:31-(ZF(t)/eI|0)|0}var u0=64,f0=4194304;function tf(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function gh(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=tf(o):(s&=a,s!==0&&(n=tf(s)))}else a=r&~i,a!==0?n=tf(a):s!==0&&(n=tf(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Ps(e),i=1<<r,n|=t[r],e&=~i;return n}function rI(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nI(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-Ps(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=rI(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function Eg(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Bw(){var t=u0;return u0<<=1,!(u0&4194240)&&(u0=64),t}function im(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Ed(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ps(e),t[e]=r}function iI(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-Ps(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function Wx(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Ps(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var Xt=0;function jw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Vw,Hx,Uw,zw,Ww,wg=!1,d0=[],ko=null,Co=null,Fo=null,Mf=new Map,Lf=new Map,po=[],sI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Fy(t,e){switch(t){case"focusin":case"focusout":ko=null;break;case"dragenter":case"dragleave":Co=null;break;case"mouseover":case"mouseout":Fo=null;break;case"pointerover":case"pointerout":Mf.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lf.delete(e.pointerId)}}function zu(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Td(e),e!==null&&Hx(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function aI(t,e,r,n,i){switch(e){case"focusin":return ko=zu(ko,t,e,r,n,i),!0;case"dragenter":return Co=zu(Co,t,e,r,n,i),!0;case"mouseover":return Fo=zu(Fo,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return Mf.set(s,zu(Mf.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Lf.set(s,zu(Lf.get(s)||null,t,e,r,n,i)),!0}return!1}function Hw(t){var e=pl(t.target);if(e!==null){var r=Hl(e);if(r!==null){if(e=r.tag,e===13){if(e=Nw(r),e!==null){t.blockedOn=e,Ww(t.priority,function(){Uw(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function K0(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=Tg(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);xg=n,r.target.dispatchEvent(n),xg=null}else return e=Td(r),e!==null&&Hx(e),t.blockedOn=r,!1;e.shift()}return!0}function Iy(t,e,r){K0(t)&&r.delete(e)}function oI(){wg=!1,ko!==null&&K0(ko)&&(ko=null),Co!==null&&K0(Co)&&(Co=null),Fo!==null&&K0(Fo)&&(Fo=null),Mf.forEach(Iy),Lf.forEach(Iy)}function Wu(t,e){t.blockedOn===e&&(t.blockedOn=null,wg||(wg=!0,Wi.unstable_scheduleCallback(Wi.unstable_NormalPriority,oI)))}function Bf(t){function e(i){return Wu(i,t)}if(0<d0.length){Wu(d0[0],t);for(var r=1;r<d0.length;r++){var n=d0[r];n.blockedOn===t&&(n.blockedOn=null)}}for(ko!==null&&Wu(ko,t),Co!==null&&Wu(Co,t),Fo!==null&&Wu(Fo,t),Mf.forEach(e),Lf.forEach(e),r=0;r<po.length;r++)n=po[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<po.length&&(r=po[0],r.blockedOn===null);)Hw(r),r.blockedOn===null&&po.shift()}var Vc=$a.ReactCurrentBatchConfig,xh=!0;function lI(t,e,r,n){var i=Xt,s=Vc.transition;Vc.transition=null;try{Xt=1,$x(t,e,r,n)}finally{Xt=i,Vc.transition=s}}function cI(t,e,r,n){var i=Xt,s=Vc.transition;Vc.transition=null;try{Xt=4,$x(t,e,r,n)}finally{Xt=i,Vc.transition=s}}function $x(t,e,r,n){if(xh){var i=Tg(t,e,r,n);if(i===null)pm(t,e,n,vh,r),Fy(t,n);else if(aI(i,t,e,r,n))n.stopPropagation();else if(Fy(t,n),e&4&&-1<sI.indexOf(t)){for(;i!==null;){var s=Td(i);if(s!==null&&Vw(s),s=Tg(t,e,r,n),s===null&&pm(t,e,n,vh,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else pm(t,e,n,null,r)}}var vh=null;function Tg(t,e,r,n){if(vh=null,t=Ux(n),t=pl(t),t!==null)if(e=Hl(t),e===null)t=null;else if(r=e.tag,r===13){if(t=Nw(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return vh=t,null}function $w(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qF()){case zx:return 1;case Mw:return 4;case mh:case QF:return 16;case Lw:return 536870912;default:return 16}default:return 16}}var _o=null,Gx=null,X0=null;function Gw(){if(X0)return X0;var t,e=Gx,r=e.length,n,i="value"in _o?_o.value:_o.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===i[s-n];n++);return X0=i.slice(t,1<n?1-n:void 0)}function Y0(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function h0(){return!0}function by(){return!1}function Gi(t){function e(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?h0:by,this.isPropagationStopped=by,this}return br(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=h0)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=h0)},persist:function(){},isPersistent:h0}),e}var xu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Kx=Gi(xu),wd=br({},xu,{view:0,detail:0}),uI=Gi(wd),sm,am,Hu,pp=br({},wd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xx,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Hu&&(Hu&&t.type==="mousemove"?(sm=t.screenX-Hu.screenX,am=t.screenY-Hu.screenY):am=sm=0,Hu=t),sm)},movementY:function(t){return"movementY"in t?t.movementY:am}}),Ry=Gi(pp),fI=br({},pp,{dataTransfer:0}),dI=Gi(fI),hI=br({},wd,{relatedTarget:0}),om=Gi(hI),pI=br({},xu,{animationName:0,elapsedTime:0,pseudoElement:0}),mI=Gi(pI),gI=br({},xu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),xI=Gi(gI),vI=br({},xu,{data:0}),Ny=Gi(vI),yI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_I={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},EI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wI(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=EI[t])?!!e[t]:!1}function Xx(){return wI}var TI=br({},wd,{key:function(t){if(t.key){var e=yI[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Y0(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?_I[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xx,charCode:function(t){return t.type==="keypress"?Y0(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Y0(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),SI=Gi(TI),AI=br({},pp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Dy=Gi(AI),kI=br({},wd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xx}),CI=Gi(kI),FI=br({},xu,{propertyName:0,elapsedTime:0,pseudoElement:0}),II=Gi(FI),bI=br({},pp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),RI=Gi(bI),NI=[9,13,27,32],Yx=Oa&&"CompositionEvent"in window,hf=null;Oa&&"documentMode"in document&&(hf=document.documentMode);var DI=Oa&&"TextEvent"in window&&!hf,Kw=Oa&&(!Yx||hf&&8<hf&&11>=hf),Py=" ",Oy=!1;function Xw(t,e){switch(t){case"keyup":return NI.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Yw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Sc=!1;function PI(t,e){switch(t){case"compositionend":return Yw(e);case"keypress":return e.which!==32?null:(Oy=!0,Py);case"textInput":return t=e.data,t===Py&&Oy?null:t;default:return null}}function OI(t,e){if(Sc)return t==="compositionend"||!Yx&&Xw(t,e)?(t=Gw(),X0=Gx=_o=null,Sc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Kw&&e.locale!=="ko"?null:e.data;default:return null}}var MI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function My(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!MI[t.type]:e==="textarea"}function qw(t,e,r,n){Cw(n),e=yh(e,"onChange"),0<e.length&&(r=new Kx("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var pf=null,jf=null;function LI(t){oT(t,0)}function mp(t){var e=Cc(t);if(_w(e))return t}function BI(t,e){if(t==="change")return e}var Qw=!1;if(Oa){var lm;if(Oa){var cm="oninput"in document;if(!cm){var Ly=document.createElement("div");Ly.setAttribute("oninput","return;"),cm=typeof Ly.oninput=="function"}lm=cm}else lm=!1;Qw=lm&&(!document.documentMode||9<document.documentMode)}function By(){pf&&(pf.detachEvent("onpropertychange",Jw),jf=pf=null)}function Jw(t){if(t.propertyName==="value"&&mp(jf)){var e=[];qw(e,jf,t,Ux(t)),Rw(LI,e)}}function jI(t,e,r){t==="focusin"?(By(),pf=e,jf=r,pf.attachEvent("onpropertychange",Jw)):t==="focusout"&&By()}function VI(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return mp(jf)}function UI(t,e){if(t==="click")return mp(e)}function zI(t,e){if(t==="input"||t==="change")return mp(e)}function WI(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Bs=typeof Object.is=="function"?Object.is:WI;function Vf(t,e){if(Bs(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!sg.call(e,i)||!Bs(t[i],e[i]))return!1}return!0}function jy(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Vy(t,e){var r=jy(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=jy(r)}}function Zw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Zw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function eT(){for(var t=window,e=dh();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=dh(t.document)}return e}function qx(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function HI(t){var e=eT(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&Zw(r.ownerDocument.documentElement,r)){if(n!==null&&qx(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=Vy(r,s);var a=Vy(r,n);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var $I=Oa&&"documentMode"in document&&11>=document.documentMode,Ac=null,Sg=null,mf=null,Ag=!1;function Uy(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Ag||Ac==null||Ac!==dh(n)||(n=Ac,"selectionStart"in n&&qx(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),mf&&Vf(mf,n)||(mf=n,n=yh(Sg,"onSelect"),0<n.length&&(e=new Kx("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Ac)))}function p0(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var kc={animationend:p0("Animation","AnimationEnd"),animationiteration:p0("Animation","AnimationIteration"),animationstart:p0("Animation","AnimationStart"),transitionend:p0("Transition","TransitionEnd")},um={},tT={};Oa&&(tT=document.createElement("div").style,"AnimationEvent"in window||(delete kc.animationend.animation,delete kc.animationiteration.animation,delete kc.animationstart.animation),"TransitionEvent"in window||delete kc.transitionend.transition);function gp(t){if(um[t])return um[t];if(!kc[t])return t;var e=kc[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in tT)return um[t]=e[r];return t}var rT=gp("animationend"),nT=gp("animationiteration"),iT=gp("animationstart"),sT=gp("transitionend"),aT=new Map,zy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xo(t,e){aT.set(t,e),Wl(e,[t])}for(var fm=0;fm<zy.length;fm++){var dm=zy[fm],GI=dm.toLowerCase(),KI=dm[0].toUpperCase()+dm.slice(1);Xo(GI,"on"+KI)}Xo(rT,"onAnimationEnd");Xo(nT,"onAnimationIteration");Xo(iT,"onAnimationStart");Xo("dblclick","onDoubleClick");Xo("focusin","onFocus");Xo("focusout","onBlur");Xo(sT,"onTransitionEnd");Qc("onMouseEnter",["mouseout","mouseover"]);Qc("onMouseLeave",["mouseout","mouseover"]);Qc("onPointerEnter",["pointerout","pointerover"]);Qc("onPointerLeave",["pointerout","pointerover"]);Wl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Wl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Wl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Wl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Wl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Wl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var rf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),XI=new Set("cancel close invalid load scroll toggle".split(" ").concat(rf));function Wy(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,GF(n,e,void 0,t),t.currentTarget=null}function oT(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;Wy(i,o,c),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;Wy(i,o,c),s=l}}}if(ph)throw t=_g,ph=!1,_g=null,t}function fr(t,e){var r=e[bg];r===void 0&&(r=e[bg]=new Set);var n=t+"__bubble";r.has(n)||(lT(e,t,2,!1),r.add(n))}function hm(t,e,r){var n=0;e&&(n|=4),lT(r,t,n,e)}var m0="_reactListening"+Math.random().toString(36).slice(2);function Uf(t){if(!t[m0]){t[m0]=!0,mw.forEach(function(r){r!=="selectionchange"&&(XI.has(r)||hm(r,!1,t),hm(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[m0]||(e[m0]=!0,hm("selectionchange",!1,e))}}function lT(t,e,r,n){switch($w(e)){case 1:var i=lI;break;case 4:i=cI;break;default:i=$x}r=i.bind(null,e,r,t),i=void 0,!yg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function pm(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=pl(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}Rw(function(){var c=s,d=Ux(r),h=[];e:{var p=aT.get(t);if(p!==void 0){var g=Kx,y=t;switch(t){case"keypress":if(Y0(r)===0)break e;case"keydown":case"keyup":g=SI;break;case"focusin":y="focus",g=om;break;case"focusout":y="blur",g=om;break;case"beforeblur":case"afterblur":g=om;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=Ry;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=dI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=CI;break;case rT:case nT:case iT:g=mI;break;case sT:g=II;break;case"scroll":g=uI;break;case"wheel":g=RI;break;case"copy":case"cut":case"paste":g=xI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=Dy}var x=(e&4)!==0,E=!x&&t==="scroll",T=x?p!==null?p+"Capture":null:p;x=[];for(var A=c,_;A!==null;){_=A;var P=_.stateNode;if(_.tag===5&&P!==null&&(_=P,T!==null&&(P=Of(A,T),P!=null&&x.push(zf(A,P,_)))),E)break;A=A.return}0<x.length&&(p=new g(p,y,null,r,d),h.push({event:p,listeners:x}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",p&&r!==xg&&(y=r.relatedTarget||r.fromElement)&&(pl(y)||y[Ma]))break e;if((g||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,g?(y=r.relatedTarget||r.toElement,g=c,y=y?pl(y):null,y!==null&&(E=Hl(y),y!==E||y.tag!==5&&y.tag!==6)&&(y=null)):(g=null,y=c),g!==y)){if(x=Ry,P="onMouseLeave",T="onMouseEnter",A="mouse",(t==="pointerout"||t==="pointerover")&&(x=Dy,P="onPointerLeave",T="onPointerEnter",A="pointer"),E=g==null?p:Cc(g),_=y==null?p:Cc(y),p=new x(P,A+"leave",g,r,d),p.target=E,p.relatedTarget=_,P=null,pl(d)===c&&(x=new x(T,A+"enter",y,r,d),x.target=_,x.relatedTarget=E,P=x),E=P,g&&y)t:{for(x=g,T=y,A=0,_=x;_;_=pc(_))A++;for(_=0,P=T;P;P=pc(P))_++;for(;0<A-_;)x=pc(x),A--;for(;0<_-A;)T=pc(T),_--;for(;A--;){if(x===T||T!==null&&x===T.alternate)break t;x=pc(x),T=pc(T)}x=null}else x=null;g!==null&&Hy(h,p,g,x,!1),y!==null&&E!==null&&Hy(h,E,y,x,!0)}}e:{if(p=c?Cc(c):window,g=p.nodeName&&p.nodeName.toLowerCase(),g==="select"||g==="input"&&p.type==="file")var W=BI;else if(My(p))if(Qw)W=zI;else{W=VI;var j=jI}else(g=p.nodeName)&&g.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(W=UI);if(W&&(W=W(t,c))){qw(h,W,r,d);break e}j&&j(t,p,c),t==="focusout"&&(j=p._wrapperState)&&j.controlled&&p.type==="number"&&dg(p,"number",p.value)}switch(j=c?Cc(c):window,t){case"focusin":(My(j)||j.contentEditable==="true")&&(Ac=j,Sg=c,mf=null);break;case"focusout":mf=Sg=Ac=null;break;case"mousedown":Ag=!0;break;case"contextmenu":case"mouseup":case"dragend":Ag=!1,Uy(h,r,d);break;case"selectionchange":if($I)break;case"keydown":case"keyup":Uy(h,r,d)}var w;if(Yx)e:{switch(t){case"compositionstart":var F="onCompositionStart";break e;case"compositionend":F="onCompositionEnd";break e;case"compositionupdate":F="onCompositionUpdate";break e}F=void 0}else Sc?Xw(t,r)&&(F="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(F="onCompositionStart");F&&(Kw&&r.locale!=="ko"&&(Sc||F!=="onCompositionStart"?F==="onCompositionEnd"&&Sc&&(w=Gw()):(_o=d,Gx="value"in _o?_o.value:_o.textContent,Sc=!0)),j=yh(c,F),0<j.length&&(F=new Ny(F,t,null,r,d),h.push({event:F,listeners:j}),w?F.data=w:(w=Yw(r),w!==null&&(F.data=w)))),(w=DI?PI(t,r):OI(t,r))&&(c=yh(c,"onBeforeInput"),0<c.length&&(d=new Ny("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:c}),d.data=w))}oT(h,e)})}function zf(t,e,r){return{instance:t,listener:e,currentTarget:r}}function yh(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Of(t,r),s!=null&&n.unshift(zf(t,s,i)),s=Of(t,e),s!=null&&n.push(zf(t,s,i))),t=t.return}return n}function pc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Hy(t,e,r,n,i){for(var s=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,i?(l=Of(r,s),l!=null&&a.unshift(zf(r,l,o))):i||(l=Of(r,s),l!=null&&a.push(zf(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var YI=/\r\n?/g,qI=/\u0000|\uFFFD/g;function $y(t){return(typeof t=="string"?t:""+t).replace(YI,`
`).replace(qI,"")}function g0(t,e,r){if(e=$y(e),$y(t)!==e&&r)throw Error(Me(425))}function _h(){}var kg=null,Cg=null;function Fg(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ig=typeof setTimeout=="function"?setTimeout:void 0,QI=typeof clearTimeout=="function"?clearTimeout:void 0,Gy=typeof Promise=="function"?Promise:void 0,JI=typeof queueMicrotask=="function"?queueMicrotask:typeof Gy<"u"?function(t){return Gy.resolve(null).then(t).catch(ZI)}:Ig;function ZI(t){setTimeout(function(){throw t})}function mm(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),Bf(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Bf(e)}function Io(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Ky(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var vu=Math.random().toString(36).slice(2),Js="__reactFiber$"+vu,Wf="__reactProps$"+vu,Ma="__reactContainer$"+vu,bg="__reactEvents$"+vu,eb="__reactListeners$"+vu,tb="__reactHandles$"+vu;function pl(t){var e=t[Js];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Ma]||r[Js]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Ky(t);t!==null;){if(r=t[Js])return r;t=Ky(t)}return e}t=r,r=t.parentNode}return null}function Td(t){return t=t[Js]||t[Ma],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Cc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Me(33))}function xp(t){return t[Wf]||null}var Rg=[],Fc=-1;function Yo(t){return{current:t}}function hr(t){0>Fc||(t.current=Rg[Fc],Rg[Fc]=null,Fc--)}function ir(t,e){Fc++,Rg[Fc]=t.current,t.current=e}var Vo={},Zn=Yo(Vo),Ci=Yo(!1),Cl=Vo;function Jc(t,e){var r=t.type.contextTypes;if(!r)return Vo;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Fi(t){return t=t.childContextTypes,t!=null}function Eh(){hr(Ci),hr(Zn)}function Xy(t,e,r){if(Zn.current!==Vo)throw Error(Me(168));ir(Zn,e),ir(Ci,r)}function cT(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(Me(108,jF(t)||"Unknown",i));return br({},r,n)}function wh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Vo,Cl=Zn.current,ir(Zn,t),ir(Ci,Ci.current),!0}function Yy(t,e,r){var n=t.stateNode;if(!n)throw Error(Me(169));r?(t=cT(t,e,Cl),n.__reactInternalMemoizedMergedChildContext=t,hr(Ci),hr(Zn),ir(Zn,t)):hr(Ci),ir(Ci,r)}var Ta=null,vp=!1,gm=!1;function uT(t){Ta===null?Ta=[t]:Ta.push(t)}function rb(t){vp=!0,uT(t)}function qo(){if(!gm&&Ta!==null){gm=!0;var t=0,e=Xt;try{var r=Ta;for(Xt=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Ta=null,vp=!1}catch(i){throw Ta!==null&&(Ta=Ta.slice(t+1)),Ow(zx,qo),i}finally{Xt=e,gm=!1}}return null}var Ic=[],bc=0,Th=null,Sh=0,rs=[],ns=0,Fl=null,Sa=1,Aa="";function cl(t,e){Ic[bc++]=Sh,Ic[bc++]=Th,Th=t,Sh=e}function fT(t,e,r){rs[ns++]=Sa,rs[ns++]=Aa,rs[ns++]=Fl,Fl=t;var n=Sa;t=Aa;var i=32-Ps(n)-1;n&=~(1<<i),r+=1;var s=32-Ps(e)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,Sa=1<<32-Ps(e)+i|r<<i|n,Aa=s+t}else Sa=1<<s|r<<i|n,Aa=t}function Qx(t){t.return!==null&&(cl(t,1),fT(t,1,0))}function Jx(t){for(;t===Th;)Th=Ic[--bc],Ic[bc]=null,Sh=Ic[--bc],Ic[bc]=null;for(;t===Fl;)Fl=rs[--ns],rs[ns]=null,Aa=rs[--ns],rs[ns]=null,Sa=rs[--ns],rs[ns]=null}var Ui=null,Vi=null,Er=!1,bs=null;function dT(t,e){var r=ss(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function qy(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ui=t,Vi=Io(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ui=t,Vi=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Fl!==null?{id:Sa,overflow:Aa}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=ss(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Ui=t,Vi=null,!0):!1;default:return!1}}function Ng(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Dg(t){if(Er){var e=Vi;if(e){var r=e;if(!qy(t,e)){if(Ng(t))throw Error(Me(418));e=Io(r.nextSibling);var n=Ui;e&&qy(t,e)?dT(n,r):(t.flags=t.flags&-4097|2,Er=!1,Ui=t)}}else{if(Ng(t))throw Error(Me(418));t.flags=t.flags&-4097|2,Er=!1,Ui=t}}}function Qy(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ui=t}function x0(t){if(t!==Ui)return!1;if(!Er)return Qy(t),Er=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Fg(t.type,t.memoizedProps)),e&&(e=Vi)){if(Ng(t))throw hT(),Error(Me(418));for(;e;)dT(t,e),e=Io(e.nextSibling)}if(Qy(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Me(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Vi=Io(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Vi=null}}else Vi=Ui?Io(t.stateNode.nextSibling):null;return!0}function hT(){for(var t=Vi;t;)t=Io(t.nextSibling)}function Zc(){Vi=Ui=null,Er=!1}function Zx(t){bs===null?bs=[t]:bs.push(t)}var nb=$a.ReactCurrentBatchConfig;function $u(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Me(309));var n=r.stateNode}if(!n)throw Error(Me(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(Me(284));if(!r._owner)throw Error(Me(290,t))}return t}function v0(t,e){throw t=Object.prototype.toString.call(e),Error(Me(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Jy(t){var e=t._init;return e(t._payload)}function pT(t){function e(T,A){if(t){var _=T.deletions;_===null?(T.deletions=[A],T.flags|=16):_.push(A)}}function r(T,A){if(!t)return null;for(;A!==null;)e(T,A),A=A.sibling;return null}function n(T,A){for(T=new Map;A!==null;)A.key!==null?T.set(A.key,A):T.set(A.index,A),A=A.sibling;return T}function i(T,A){return T=Do(T,A),T.index=0,T.sibling=null,T}function s(T,A,_){return T.index=_,t?(_=T.alternate,_!==null?(_=_.index,_<A?(T.flags|=2,A):_):(T.flags|=2,A)):(T.flags|=1048576,A)}function a(T){return t&&T.alternate===null&&(T.flags|=2),T}function o(T,A,_,P){return A===null||A.tag!==6?(A=Tm(_,T.mode,P),A.return=T,A):(A=i(A,_),A.return=T,A)}function l(T,A,_,P){var W=_.type;return W===Tc?d(T,A,_.props.children,P,_.key):A!==null&&(A.elementType===W||typeof W=="object"&&W!==null&&W.$$typeof===fo&&Jy(W)===A.type)?(P=i(A,_.props),P.ref=$u(T,A,_),P.return=T,P):(P=rh(_.type,_.key,_.props,null,T.mode,P),P.ref=$u(T,A,_),P.return=T,P)}function c(T,A,_,P){return A===null||A.tag!==4||A.stateNode.containerInfo!==_.containerInfo||A.stateNode.implementation!==_.implementation?(A=Sm(_,T.mode,P),A.return=T,A):(A=i(A,_.children||[]),A.return=T,A)}function d(T,A,_,P,W){return A===null||A.tag!==7?(A=_l(_,T.mode,P,W),A.return=T,A):(A=i(A,_),A.return=T,A)}function h(T,A,_){if(typeof A=="string"&&A!==""||typeof A=="number")return A=Tm(""+A,T.mode,_),A.return=T,A;if(typeof A=="object"&&A!==null){switch(A.$$typeof){case o0:return _=rh(A.type,A.key,A.props,null,T.mode,_),_.ref=$u(T,null,A),_.return=T,_;case wc:return A=Sm(A,T.mode,_),A.return=T,A;case fo:var P=A._init;return h(T,P(A._payload),_)}if(ef(A)||Vu(A))return A=_l(A,T.mode,_,null),A.return=T,A;v0(T,A)}return null}function p(T,A,_,P){var W=A!==null?A.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return W!==null?null:o(T,A,""+_,P);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case o0:return _.key===W?l(T,A,_,P):null;case wc:return _.key===W?c(T,A,_,P):null;case fo:return W=_._init,p(T,A,W(_._payload),P)}if(ef(_)||Vu(_))return W!==null?null:d(T,A,_,P,null);v0(T,_)}return null}function g(T,A,_,P,W){if(typeof P=="string"&&P!==""||typeof P=="number")return T=T.get(_)||null,o(A,T,""+P,W);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case o0:return T=T.get(P.key===null?_:P.key)||null,l(A,T,P,W);case wc:return T=T.get(P.key===null?_:P.key)||null,c(A,T,P,W);case fo:var j=P._init;return g(T,A,_,j(P._payload),W)}if(ef(P)||Vu(P))return T=T.get(_)||null,d(A,T,P,W,null);v0(A,P)}return null}function y(T,A,_,P){for(var W=null,j=null,w=A,F=A=0,S=null;w!==null&&F<_.length;F++){w.index>F?(S=w,w=null):S=w.sibling;var b=p(T,w,_[F],P);if(b===null){w===null&&(w=S);break}t&&w&&b.alternate===null&&e(T,w),A=s(b,A,F),j===null?W=b:j.sibling=b,j=b,w=S}if(F===_.length)return r(T,w),Er&&cl(T,F),W;if(w===null){for(;F<_.length;F++)w=h(T,_[F],P),w!==null&&(A=s(w,A,F),j===null?W=w:j.sibling=w,j=w);return Er&&cl(T,F),W}for(w=n(T,w);F<_.length;F++)S=g(w,T,F,_[F],P),S!==null&&(t&&S.alternate!==null&&w.delete(S.key===null?F:S.key),A=s(S,A,F),j===null?W=S:j.sibling=S,j=S);return t&&w.forEach(function(N){return e(T,N)}),Er&&cl(T,F),W}function x(T,A,_,P){var W=Vu(_);if(typeof W!="function")throw Error(Me(150));if(_=W.call(_),_==null)throw Error(Me(151));for(var j=W=null,w=A,F=A=0,S=null,b=_.next();w!==null&&!b.done;F++,b=_.next()){w.index>F?(S=w,w=null):S=w.sibling;var N=p(T,w,b.value,P);if(N===null){w===null&&(w=S);break}t&&w&&N.alternate===null&&e(T,w),A=s(N,A,F),j===null?W=N:j.sibling=N,j=N,w=S}if(b.done)return r(T,w),Er&&cl(T,F),W;if(w===null){for(;!b.done;F++,b=_.next())b=h(T,b.value,P),b!==null&&(A=s(b,A,F),j===null?W=b:j.sibling=b,j=b);return Er&&cl(T,F),W}for(w=n(T,w);!b.done;F++,b=_.next())b=g(w,T,F,b.value,P),b!==null&&(t&&b.alternate!==null&&w.delete(b.key===null?F:b.key),A=s(b,A,F),j===null?W=b:j.sibling=b,j=b);return t&&w.forEach(function(D){return e(T,D)}),Er&&cl(T,F),W}function E(T,A,_,P){if(typeof _=="object"&&_!==null&&_.type===Tc&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case o0:e:{for(var W=_.key,j=A;j!==null;){if(j.key===W){if(W=_.type,W===Tc){if(j.tag===7){r(T,j.sibling),A=i(j,_.props.children),A.return=T,T=A;break e}}else if(j.elementType===W||typeof W=="object"&&W!==null&&W.$$typeof===fo&&Jy(W)===j.type){r(T,j.sibling),A=i(j,_.props),A.ref=$u(T,j,_),A.return=T,T=A;break e}r(T,j);break}else e(T,j);j=j.sibling}_.type===Tc?(A=_l(_.props.children,T.mode,P,_.key),A.return=T,T=A):(P=rh(_.type,_.key,_.props,null,T.mode,P),P.ref=$u(T,A,_),P.return=T,T=P)}return a(T);case wc:e:{for(j=_.key;A!==null;){if(A.key===j)if(A.tag===4&&A.stateNode.containerInfo===_.containerInfo&&A.stateNode.implementation===_.implementation){r(T,A.sibling),A=i(A,_.children||[]),A.return=T,T=A;break e}else{r(T,A);break}else e(T,A);A=A.sibling}A=Sm(_,T.mode,P),A.return=T,T=A}return a(T);case fo:return j=_._init,E(T,A,j(_._payload),P)}if(ef(_))return y(T,A,_,P);if(Vu(_))return x(T,A,_,P);v0(T,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,A!==null&&A.tag===6?(r(T,A.sibling),A=i(A,_),A.return=T,T=A):(r(T,A),A=Tm(_,T.mode,P),A.return=T,T=A),a(T)):r(T,A)}return E}var eu=pT(!0),mT=pT(!1),Ah=Yo(null),kh=null,Rc=null,e1=null;function t1(){e1=Rc=kh=null}function r1(t){var e=Ah.current;hr(Ah),t._currentValue=e}function Pg(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Uc(t,e){kh=t,e1=Rc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ki=!0),t.firstContext=null)}function ls(t){var e=t._currentValue;if(e1!==t)if(t={context:t,memoizedValue:e,next:null},Rc===null){if(kh===null)throw Error(Me(308));Rc=t,kh.dependencies={lanes:0,firstContext:t}}else Rc=Rc.next=t;return e}var ml=null;function n1(t){ml===null?ml=[t]:ml.push(t)}function gT(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,n1(e)):(r.next=i.next,i.next=r),e.interleaved=r,La(t,n)}function La(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var ho=!1;function i1(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function xT(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ba(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function bo(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Dt&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,La(t,r)}return i=n.interleaved,i===null?(e.next=e,n1(n)):(e.next=i.next,i.next=e),n.interleaved=e,La(t,r)}function q0(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Wx(t,r)}}function Zy(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Ch(t,e,r,n){var i=t.updateQueue;ho=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var d=t.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==a&&(o===null?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;a=0,d=c=l=null,o=s;do{var p=o.lane,g=o.eventTime;if((n&p)===p){d!==null&&(d=d.next={eventTime:g,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=t,x=o;switch(p=e,g=r,x.tag){case 1:if(y=x.payload,typeof y=="function"){h=y.call(g,h,p);break e}h=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=x.payload,p=typeof y=="function"?y.call(g,h,p):y,p==null)break e;h=br({},h,p);break e;case 2:ho=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,p=i.effects,p===null?i.effects=[o]:p.push(o))}else g={eventTime:g,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(c=d=g,l=h):d=d.next=g,a|=p;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;p=o,o=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(d===null&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);bl|=a,t.lanes=a,t.memoizedState=h}}function e_(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Me(191,i));i.call(n)}}}var Sd={},ta=Yo(Sd),Hf=Yo(Sd),$f=Yo(Sd);function gl(t){if(t===Sd)throw Error(Me(174));return t}function s1(t,e){switch(ir($f,e),ir(Hf,t),ir(ta,Sd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:pg(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=pg(e,t)}hr(ta),ir(ta,e)}function tu(){hr(ta),hr(Hf),hr($f)}function vT(t){gl($f.current);var e=gl(ta.current),r=pg(e,t.type);e!==r&&(ir(Hf,t),ir(ta,r))}function a1(t){Hf.current===t&&(hr(ta),hr(Hf))}var kr=Yo(0);function Fh(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var xm=[];function o1(){for(var t=0;t<xm.length;t++)xm[t]._workInProgressVersionPrimary=null;xm.length=0}var Q0=$a.ReactCurrentDispatcher,vm=$a.ReactCurrentBatchConfig,Il=0,Ir=null,on=null,vn=null,Ih=!1,gf=!1,Gf=0,ib=0;function Un(){throw Error(Me(321))}function l1(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Bs(t[r],e[r]))return!1;return!0}function c1(t,e,r,n,i,s){if(Il=s,Ir=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Q0.current=t===null||t.memoizedState===null?lb:cb,t=r(n,i),gf){s=0;do{if(gf=!1,Gf=0,25<=s)throw Error(Me(301));s+=1,vn=on=null,e.updateQueue=null,Q0.current=ub,t=r(n,i)}while(gf)}if(Q0.current=bh,e=on!==null&&on.next!==null,Il=0,vn=on=Ir=null,Ih=!1,e)throw Error(Me(300));return t}function u1(){var t=Gf!==0;return Gf=0,t}function Qs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vn===null?Ir.memoizedState=vn=t:vn=vn.next=t,vn}function cs(){if(on===null){var t=Ir.alternate;t=t!==null?t.memoizedState:null}else t=on.next;var e=vn===null?Ir.memoizedState:vn.next;if(e!==null)vn=e,on=t;else{if(t===null)throw Error(Me(310));on=t,t={memoizedState:on.memoizedState,baseState:on.baseState,baseQueue:on.baseQueue,queue:on.queue,next:null},vn===null?Ir.memoizedState=vn=t:vn=vn.next=t}return vn}function Kf(t,e){return typeof e=="function"?e(t):e}function ym(t){var e=cs(),r=e.queue;if(r===null)throw Error(Me(311));r.lastRenderedReducer=t;var n=on,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,c=s;do{var d=c.lane;if((Il&d)===d)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,a=n):l=l.next=h,Ir.lanes|=d,bl|=d}c=c.next}while(c!==null&&c!==s);l===null?a=n:l.next=o,Bs(n,e.memoizedState)||(ki=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,Ir.lanes|=s,bl|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function _m(t){var e=cs(),r=e.queue;if(r===null)throw Error(Me(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);Bs(s,e.memoizedState)||(ki=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function yT(){}function _T(t,e){var r=Ir,n=cs(),i=e(),s=!Bs(n.memoizedState,i);if(s&&(n.memoizedState=i,ki=!0),n=n.queue,f1(TT.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||vn!==null&&vn.memoizedState.tag&1){if(r.flags|=2048,Xf(9,wT.bind(null,r,n,i,e),void 0,null),En===null)throw Error(Me(349));Il&30||ET(r,e,i)}return i}function ET(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Ir.updateQueue,e===null?(e={lastEffect:null,stores:null},Ir.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function wT(t,e,r,n){e.value=r,e.getSnapshot=n,ST(e)&&AT(t)}function TT(t,e,r){return r(function(){ST(e)&&AT(t)})}function ST(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Bs(t,r)}catch{return!0}}function AT(t){var e=La(t,1);e!==null&&Os(e,t,1,-1)}function t_(t){var e=Qs();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Kf,lastRenderedState:t},e.queue=t,t=t.dispatch=ob.bind(null,Ir,t),[e.memoizedState,t]}function Xf(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Ir.updateQueue,e===null?(e={lastEffect:null,stores:null},Ir.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function kT(){return cs().memoizedState}function J0(t,e,r,n){var i=Qs();Ir.flags|=t,i.memoizedState=Xf(1|e,r,void 0,n===void 0?null:n)}function yp(t,e,r,n){var i=cs();n=n===void 0?null:n;var s=void 0;if(on!==null){var a=on.memoizedState;if(s=a.destroy,n!==null&&l1(n,a.deps)){i.memoizedState=Xf(e,r,s,n);return}}Ir.flags|=t,i.memoizedState=Xf(1|e,r,s,n)}function r_(t,e){return J0(8390656,8,t,e)}function f1(t,e){return yp(2048,8,t,e)}function CT(t,e){return yp(4,2,t,e)}function FT(t,e){return yp(4,4,t,e)}function IT(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function bT(t,e,r){return r=r!=null?r.concat([t]):null,yp(4,4,IT.bind(null,e,t),r)}function d1(){}function RT(t,e){var r=cs();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&l1(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function NT(t,e){var r=cs();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&l1(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function DT(t,e,r){return Il&21?(Bs(r,e)||(r=Bw(),Ir.lanes|=r,bl|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ki=!0),t.memoizedState=r)}function sb(t,e){var r=Xt;Xt=r!==0&&4>r?r:4,t(!0);var n=vm.transition;vm.transition={};try{t(!1),e()}finally{Xt=r,vm.transition=n}}function PT(){return cs().memoizedState}function ab(t,e,r){var n=No(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},OT(t))MT(e,r);else if(r=gT(t,e,r,n),r!==null){var i=pi();Os(r,t,n,i),LT(r,e,n)}}function ob(t,e,r){var n=No(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(OT(t))MT(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,Bs(o,a)){var l=e.interleaved;l===null?(i.next=i,n1(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=gT(t,e,i,n),r!==null&&(i=pi(),Os(r,t,n,i),LT(r,e,n))}}function OT(t){var e=t.alternate;return t===Ir||e!==null&&e===Ir}function MT(t,e){gf=Ih=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function LT(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Wx(t,r)}}var bh={readContext:ls,useCallback:Un,useContext:Un,useEffect:Un,useImperativeHandle:Un,useInsertionEffect:Un,useLayoutEffect:Un,useMemo:Un,useReducer:Un,useRef:Un,useState:Un,useDebugValue:Un,useDeferredValue:Un,useTransition:Un,useMutableSource:Un,useSyncExternalStore:Un,useId:Un,unstable_isNewReconciler:!1},lb={readContext:ls,useCallback:function(t,e){return Qs().memoizedState=[t,e===void 0?null:e],t},useContext:ls,useEffect:r_,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,J0(4194308,4,IT.bind(null,e,t),r)},useLayoutEffect:function(t,e){return J0(4194308,4,t,e)},useInsertionEffect:function(t,e){return J0(4,2,t,e)},useMemo:function(t,e){var r=Qs();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Qs();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=ab.bind(null,Ir,t),[n.memoizedState,t]},useRef:function(t){var e=Qs();return t={current:t},e.memoizedState=t},useState:t_,useDebugValue:d1,useDeferredValue:function(t){return Qs().memoizedState=t},useTransition:function(){var t=t_(!1),e=t[0];return t=sb.bind(null,t[1]),Qs().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Ir,i=Qs();if(Er){if(r===void 0)throw Error(Me(407));r=r()}else{if(r=e(),En===null)throw Error(Me(349));Il&30||ET(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,r_(TT.bind(null,n,s,t),[t]),n.flags|=2048,Xf(9,wT.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=Qs(),e=En.identifierPrefix;if(Er){var r=Aa,n=Sa;r=(n&~(1<<32-Ps(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Gf++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=ib++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},cb={readContext:ls,useCallback:RT,useContext:ls,useEffect:f1,useImperativeHandle:bT,useInsertionEffect:CT,useLayoutEffect:FT,useMemo:NT,useReducer:ym,useRef:kT,useState:function(){return ym(Kf)},useDebugValue:d1,useDeferredValue:function(t){var e=cs();return DT(e,on.memoizedState,t)},useTransition:function(){var t=ym(Kf)[0],e=cs().memoizedState;return[t,e]},useMutableSource:yT,useSyncExternalStore:_T,useId:PT,unstable_isNewReconciler:!1},ub={readContext:ls,useCallback:RT,useContext:ls,useEffect:f1,useImperativeHandle:bT,useInsertionEffect:CT,useLayoutEffect:FT,useMemo:NT,useReducer:_m,useRef:kT,useState:function(){return _m(Kf)},useDebugValue:d1,useDeferredValue:function(t){var e=cs();return on===null?e.memoizedState=t:DT(e,on.memoizedState,t)},useTransition:function(){var t=_m(Kf)[0],e=cs().memoizedState;return[t,e]},useMutableSource:yT,useSyncExternalStore:_T,useId:PT,unstable_isNewReconciler:!1};function Fs(t,e){if(t&&t.defaultProps){e=br({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Og(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:br({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var _p={isMounted:function(t){return(t=t._reactInternals)?Hl(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=pi(),i=No(t),s=ba(n,i);s.payload=e,r!=null&&(s.callback=r),e=bo(t,s,i),e!==null&&(Os(e,t,i,n),q0(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=pi(),i=No(t),s=ba(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=bo(t,s,i),e!==null&&(Os(e,t,i,n),q0(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=pi(),n=No(t),i=ba(r,n);i.tag=2,e!=null&&(i.callback=e),e=bo(t,i,n),e!==null&&(Os(e,t,n,r),q0(e,t,n))}};function n_(t,e,r,n,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,a):e.prototype&&e.prototype.isPureReactComponent?!Vf(r,n)||!Vf(i,s):!0}function BT(t,e,r){var n=!1,i=Vo,s=e.contextType;return typeof s=="object"&&s!==null?s=ls(s):(i=Fi(e)?Cl:Zn.current,n=e.contextTypes,s=(n=n!=null)?Jc(t,i):Vo),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=_p,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function i_(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&_p.enqueueReplaceState(e,e.state,null)}function Mg(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},i1(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=ls(s):(s=Fi(e)?Cl:Zn.current,i.context=Jc(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Og(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&_p.enqueueReplaceState(i,i.state,null),Ch(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function ru(t,e){try{var r="",n=e;do r+=BF(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Em(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Lg(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var fb=typeof WeakMap=="function"?WeakMap:Map;function jT(t,e,r){r=ba(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Nh||(Nh=!0,Kg=n),Lg(t,e)},r}function VT(t,e,r){r=ba(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){Lg(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Lg(t,e),typeof n!="function"&&(Ro===null?Ro=new Set([this]):Ro.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function s_(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new fb;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=Ab.bind(null,t,e,r),e.then(t,t))}function a_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function o_(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=ba(-1,1),e.tag=2,bo(r,e,1))),r.lanes|=1),t)}var db=$a.ReactCurrentOwner,ki=!1;function fi(t,e,r,n){e.child=t===null?mT(e,null,r,n):eu(e,t.child,r,n)}function l_(t,e,r,n,i){r=r.render;var s=e.ref;return Uc(e,i),n=c1(t,e,r,n,s,i),r=u1(),t!==null&&!ki?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ba(t,e,i)):(Er&&r&&Qx(e),e.flags|=1,fi(t,e,n,i),e.child)}function c_(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!_1(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,UT(t,e,s,n,i)):(t=rh(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:Vf,r(a,n)&&t.ref===e.ref)return Ba(t,e,i)}return e.flags|=1,t=Do(s,n),t.ref=e.ref,t.return=e,e.child=t}function UT(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(Vf(s,n)&&t.ref===e.ref)if(ki=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(ki=!0);else return e.lanes=t.lanes,Ba(t,e,i)}return Bg(t,e,r,n,i)}function zT(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ir(Dc,Oi),Oi|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ir(Dc,Oi),Oi|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,ir(Dc,Oi),Oi|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,ir(Dc,Oi),Oi|=n;return fi(t,e,i,r),e.child}function WT(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Bg(t,e,r,n,i){var s=Fi(r)?Cl:Zn.current;return s=Jc(e,s),Uc(e,i),r=c1(t,e,r,n,s,i),n=u1(),t!==null&&!ki?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ba(t,e,i)):(Er&&n&&Qx(e),e.flags|=1,fi(t,e,r,i),e.child)}function u_(t,e,r,n,i){if(Fi(r)){var s=!0;wh(e)}else s=!1;if(Uc(e,i),e.stateNode===null)Z0(t,e),BT(e,r,n),Mg(e,r,n,i),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=ls(c):(c=Fi(r)?Cl:Zn.current,c=Jc(e,c));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&i_(e,a,n,c),ho=!1;var p=e.memoizedState;a.state=p,Ch(e,n,a,i),l=e.memoizedState,o!==n||p!==l||Ci.current||ho?(typeof d=="function"&&(Og(e,r,d,n),l=e.memoizedState),(o=ho||n_(e,r,o,n,p,l,c))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,xT(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:Fs(e.type,o),a.props=c,h=e.pendingProps,p=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=ls(l):(l=Fi(r)?Cl:Zn.current,l=Jc(e,l));var g=r.getDerivedStateFromProps;(d=typeof g=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||p!==l)&&i_(e,a,n,l),ho=!1,p=e.memoizedState,a.state=p,Ch(e,n,a,i);var y=e.memoizedState;o!==h||p!==y||Ci.current||ho?(typeof g=="function"&&(Og(e,r,g,n),y=e.memoizedState),(c=ho||n_(e,r,c,n,p,y,l)||!1)?(d||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,y,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,y,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=y),a.props=n,a.state=y,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),n=!1)}return jg(t,e,r,n,s,i)}function jg(t,e,r,n,i,s){WT(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return i&&Yy(e,r,!1),Ba(t,e,s);n=e.stateNode,db.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=eu(e,t.child,null,s),e.child=eu(e,null,o,s)):fi(t,e,o,s),e.memoizedState=n.state,i&&Yy(e,r,!0),e.child}function HT(t){var e=t.stateNode;e.pendingContext?Xy(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Xy(t,e.context,!1),s1(t,e.containerInfo)}function f_(t,e,r,n,i){return Zc(),Zx(i),e.flags|=256,fi(t,e,r,n),e.child}var Vg={dehydrated:null,treeContext:null,retryLane:0};function Ug(t){return{baseLanes:t,cachePool:null,transitions:null}}function $T(t,e,r){var n=e.pendingProps,i=kr.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ir(kr,i&1),t===null)return Dg(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,s?(n=e.mode,s=e.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=Tp(a,n,0,null),t=_l(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Ug(r),e.memoizedState=Vg,t):h1(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return hb(t,e,a,n,o,i,r);if(s){s=n.fallback,a=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=Do(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=Do(o,s):(s=_l(s,a,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,a=t.child.memoizedState,a=a===null?Ug(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~r,e.memoizedState=Vg,n}return s=t.child,t=s.sibling,n=Do(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function h1(t,e){return e=Tp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function y0(t,e,r,n){return n!==null&&Zx(n),eu(e,t.child,null,r),t=h1(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function hb(t,e,r,n,i,s,a){if(r)return e.flags&256?(e.flags&=-257,n=Em(Error(Me(422))),y0(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=Tp({mode:"visible",children:n.children},i,0,null),s=_l(s,i,a,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&eu(e,t.child,null,a),e.child.memoizedState=Ug(a),e.memoizedState=Vg,s);if(!(e.mode&1))return y0(t,e,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(Me(419)),n=Em(s,n,void 0),y0(t,e,a,n)}if(o=(a&t.childLanes)!==0,ki||o){if(n=En,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,La(t,i),Os(n,t,i,-1))}return y1(),n=Em(Error(Me(421))),y0(t,e,a,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=kb.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Vi=Io(i.nextSibling),Ui=e,Er=!0,bs=null,t!==null&&(rs[ns++]=Sa,rs[ns++]=Aa,rs[ns++]=Fl,Sa=t.id,Aa=t.overflow,Fl=e),e=h1(e,n.children),e.flags|=4096,e)}function d_(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Pg(t.return,e,r)}function wm(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function GT(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(fi(t,e,n.children,r),n=kr.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&d_(t,r,e);else if(t.tag===19)d_(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(ir(kr,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&Fh(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),wm(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Fh(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}wm(e,!0,r,null,s);break;case"together":wm(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Z0(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ba(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),bl|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Me(153));if(e.child!==null){for(t=e.child,r=Do(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Do(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function pb(t,e,r){switch(e.tag){case 3:HT(e),Zc();break;case 5:vT(e);break;case 1:Fi(e.type)&&wh(e);break;case 4:s1(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;ir(Ah,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(ir(kr,kr.current&1),e.flags|=128,null):r&e.child.childLanes?$T(t,e,r):(ir(kr,kr.current&1),t=Ba(t,e,r),t!==null?t.sibling:null);ir(kr,kr.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return GT(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ir(kr,kr.current),n)break;return null;case 22:case 23:return e.lanes=0,zT(t,e,r)}return Ba(t,e,r)}var KT,zg,XT,YT;KT=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};zg=function(){};XT=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,gl(ta.current);var s=null;switch(r){case"input":i=ug(t,i),n=ug(t,n),s=[];break;case"select":i=br({},i,{value:void 0}),n=br({},n,{value:void 0}),s=[];break;case"textarea":i=hg(t,i),n=hg(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=_h)}mg(r,n);var a;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Df.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Df.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&fr("scroll",t),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};YT=function(t,e,r,n){r!==n&&(e.flags|=4)};function Gu(t,e){if(!Er)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function zn(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function mb(t,e,r){var n=e.pendingProps;switch(Jx(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zn(e),null;case 1:return Fi(e.type)&&Eh(),zn(e),null;case 3:return n=e.stateNode,tu(),hr(Ci),hr(Zn),o1(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(x0(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,bs!==null&&(qg(bs),bs=null))),zg(t,e),zn(e),null;case 5:a1(e);var i=gl($f.current);if(r=e.type,t!==null&&e.stateNode!=null)XT(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Me(166));return zn(e),null}if(t=gl(ta.current),x0(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[Js]=e,n[Wf]=s,t=(e.mode&1)!==0,r){case"dialog":fr("cancel",n),fr("close",n);break;case"iframe":case"object":case"embed":fr("load",n);break;case"video":case"audio":for(i=0;i<rf.length;i++)fr(rf[i],n);break;case"source":fr("error",n);break;case"img":case"image":case"link":fr("error",n),fr("load",n);break;case"details":fr("toggle",n);break;case"input":Ey(n,s),fr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},fr("invalid",n);break;case"textarea":Ty(n,s),fr("invalid",n)}mg(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&g0(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&g0(n.textContent,o,t),i=["children",""+o]):Df.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&fr("scroll",n)}switch(r){case"input":l0(n),wy(n,s,!0);break;case"textarea":l0(n),Sy(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=_h)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Tw(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[Js]=e,t[Wf]=n,KT(t,e,!1,!1),e.stateNode=t;e:{switch(a=gg(r,n),r){case"dialog":fr("cancel",t),fr("close",t),i=n;break;case"iframe":case"object":case"embed":fr("load",t),i=n;break;case"video":case"audio":for(i=0;i<rf.length;i++)fr(rf[i],t);i=n;break;case"source":fr("error",t),i=n;break;case"img":case"image":case"link":fr("error",t),fr("load",t),i=n;break;case"details":fr("toggle",t),i=n;break;case"input":Ey(t,n),i=ug(t,n),fr("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=br({},n,{value:void 0}),fr("invalid",t);break;case"textarea":Ty(t,n),i=hg(t,n),fr("invalid",t);break;default:i=n}mg(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?kw(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Sw(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Pf(t,l):typeof l=="number"&&Pf(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Df.hasOwnProperty(s)?l!=null&&s==="onScroll"&&fr("scroll",t):l!=null&&Lx(t,s,l,a))}switch(r){case"input":l0(t),wy(t,n,!1);break;case"textarea":l0(t),Sy(t);break;case"option":n.value!=null&&t.setAttribute("value",""+jo(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?Lc(t,!!n.multiple,s,!1):n.defaultValue!=null&&Lc(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=_h)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return zn(e),null;case 6:if(t&&e.stateNode!=null)YT(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Me(166));if(r=gl($f.current),gl(ta.current),x0(e)){if(n=e.stateNode,r=e.memoizedProps,n[Js]=e,(s=n.nodeValue!==r)&&(t=Ui,t!==null))switch(t.tag){case 3:g0(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&g0(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Js]=e,e.stateNode=n}return zn(e),null;case 13:if(hr(kr),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Er&&Vi!==null&&e.mode&1&&!(e.flags&128))hT(),Zc(),e.flags|=98560,s=!1;else if(s=x0(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(Me(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Me(317));s[Js]=e}else Zc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;zn(e),s=!1}else bs!==null&&(qg(bs),bs=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||kr.current&1?un===0&&(un=3):y1())),e.updateQueue!==null&&(e.flags|=4),zn(e),null);case 4:return tu(),zg(t,e),t===null&&Uf(e.stateNode.containerInfo),zn(e),null;case 10:return r1(e.type._context),zn(e),null;case 17:return Fi(e.type)&&Eh(),zn(e),null;case 19:if(hr(kr),s=e.memoizedState,s===null)return zn(e),null;if(n=(e.flags&128)!==0,a=s.rendering,a===null)if(n)Gu(s,!1);else{if(un!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Fh(t),a!==null){for(e.flags|=128,Gu(s,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return ir(kr,kr.current&1|2),e.child}t=t.sibling}s.tail!==null&&Hr()>nu&&(e.flags|=128,n=!0,Gu(s,!1),e.lanes=4194304)}else{if(!n)if(t=Fh(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Gu(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Er)return zn(e),null}else 2*Hr()-s.renderingStartTime>nu&&r!==1073741824&&(e.flags|=128,n=!0,Gu(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(r=s.last,r!==null?r.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Hr(),e.sibling=null,r=kr.current,ir(kr,n?r&1|2:r&1),e):(zn(e),null);case 22:case 23:return v1(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Oi&1073741824&&(zn(e),e.subtreeFlags&6&&(e.flags|=8192)):zn(e),null;case 24:return null;case 25:return null}throw Error(Me(156,e.tag))}function gb(t,e){switch(Jx(e),e.tag){case 1:return Fi(e.type)&&Eh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return tu(),hr(Ci),hr(Zn),o1(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return a1(e),null;case 13:if(hr(kr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Me(340));Zc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return hr(kr),null;case 4:return tu(),null;case 10:return r1(e.type._context),null;case 22:case 23:return v1(),null;case 24:return null;default:return null}}var _0=!1,Xn=!1,xb=typeof WeakSet=="function"?WeakSet:Set,qe=null;function Nc(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Lr(t,e,n)}else r.current=null}function Wg(t,e,r){try{r()}catch(n){Lr(t,e,n)}}var h_=!1;function vb(t,e){if(kg=xh,t=eT(),qx(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,d=0,h=t,p=null;t:for(;;){for(var g;h!==r||i!==0&&h.nodeType!==3||(o=a+i),h!==s||n!==0&&h.nodeType!==3||(l=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(g=h.firstChild)!==null;)p=h,h=g;for(;;){if(h===t)break t;if(p===r&&++c===i&&(o=a),p===s&&++d===n&&(l=a),(g=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=g}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Cg={focusedElem:t,selectionRange:r},xh=!1,qe=e;qe!==null;)if(e=qe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,qe=t;else for(;qe!==null;){e=qe;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var x=y.memoizedProps,E=y.memoizedState,T=e.stateNode,A=T.getSnapshotBeforeUpdate(e.elementType===e.type?x:Fs(e.type,x),E);T.__reactInternalSnapshotBeforeUpdate=A}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Me(163))}}catch(P){Lr(e,e.return,P)}if(t=e.sibling,t!==null){t.return=e.return,qe=t;break}qe=e.return}return y=h_,h_=!1,y}function xf(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Wg(e,r,s)}i=i.next}while(i!==n)}}function Ep(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Hg(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function qT(t){var e=t.alternate;e!==null&&(t.alternate=null,qT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Js],delete e[Wf],delete e[bg],delete e[eb],delete e[tb])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function QT(t){return t.tag===5||t.tag===3||t.tag===4}function p_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||QT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function $g(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=_h));else if(n!==4&&(t=t.child,t!==null))for($g(t,e,r),t=t.sibling;t!==null;)$g(t,e,r),t=t.sibling}function Gg(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Gg(t,e,r),t=t.sibling;t!==null;)Gg(t,e,r),t=t.sibling}var kn=null,Is=!1;function lo(t,e,r){for(r=r.child;r!==null;)JT(t,e,r),r=r.sibling}function JT(t,e,r){if(ea&&typeof ea.onCommitFiberUnmount=="function")try{ea.onCommitFiberUnmount(hp,r)}catch{}switch(r.tag){case 5:Xn||Nc(r,e);case 6:var n=kn,i=Is;kn=null,lo(t,e,r),kn=n,Is=i,kn!==null&&(Is?(t=kn,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):kn.removeChild(r.stateNode));break;case 18:kn!==null&&(Is?(t=kn,r=r.stateNode,t.nodeType===8?mm(t.parentNode,r):t.nodeType===1&&mm(t,r),Bf(t)):mm(kn,r.stateNode));break;case 4:n=kn,i=Is,kn=r.stateNode.containerInfo,Is=!0,lo(t,e,r),kn=n,Is=i;break;case 0:case 11:case 14:case 15:if(!Xn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&Wg(r,e,a),i=i.next}while(i!==n)}lo(t,e,r);break;case 1:if(!Xn&&(Nc(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Lr(r,e,o)}lo(t,e,r);break;case 21:lo(t,e,r);break;case 22:r.mode&1?(Xn=(n=Xn)||r.memoizedState!==null,lo(t,e,r),Xn=n):lo(t,e,r);break;default:lo(t,e,r)}}function m_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new xb),e.forEach(function(n){var i=Cb.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function ks(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:kn=o.stateNode,Is=!1;break e;case 3:kn=o.stateNode.containerInfo,Is=!0;break e;case 4:kn=o.stateNode.containerInfo,Is=!0;break e}o=o.return}if(kn===null)throw Error(Me(160));JT(s,a,i),kn=null,Is=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Lr(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ZT(e,t),e=e.sibling}function ZT(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ks(e,t),$s(t),n&4){try{xf(3,t,t.return),Ep(3,t)}catch(x){Lr(t,t.return,x)}try{xf(5,t,t.return)}catch(x){Lr(t,t.return,x)}}break;case 1:ks(e,t),$s(t),n&512&&r!==null&&Nc(r,r.return);break;case 5:if(ks(e,t),$s(t),n&512&&r!==null&&Nc(r,r.return),t.flags&32){var i=t.stateNode;try{Pf(i,"")}catch(x){Lr(t,t.return,x)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=r!==null?r.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&Ew(i,s),gg(o,a);var c=gg(o,s);for(a=0;a<l.length;a+=2){var d=l[a],h=l[a+1];d==="style"?kw(i,h):d==="dangerouslySetInnerHTML"?Sw(i,h):d==="children"?Pf(i,h):Lx(i,d,h,c)}switch(o){case"input":fg(i,s);break;case"textarea":ww(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var g=s.value;g!=null?Lc(i,!!s.multiple,g,!1):p!==!!s.multiple&&(s.defaultValue!=null?Lc(i,!!s.multiple,s.defaultValue,!0):Lc(i,!!s.multiple,s.multiple?[]:"",!1))}i[Wf]=s}catch(x){Lr(t,t.return,x)}}break;case 6:if(ks(e,t),$s(t),n&4){if(t.stateNode===null)throw Error(Me(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(x){Lr(t,t.return,x)}}break;case 3:if(ks(e,t),$s(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Bf(e.containerInfo)}catch(x){Lr(t,t.return,x)}break;case 4:ks(e,t),$s(t);break;case 13:ks(e,t),$s(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(g1=Hr())),n&4&&m_(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(Xn=(c=Xn)||d,ks(e,t),Xn=c):ks(e,t),$s(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(qe=t,d=t.child;d!==null;){for(h=qe=d;qe!==null;){switch(p=qe,g=p.child,p.tag){case 0:case 11:case 14:case 15:xf(4,p,p.return);break;case 1:Nc(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){n=p,r=p.return;try{e=n,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(x){Lr(n,r,x)}}break;case 5:Nc(p,p.return);break;case 22:if(p.memoizedState!==null){x_(h);continue}}g!==null?(g.return=p,qe=g):x_(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{i=h.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Aw("display",a))}catch(x){Lr(t,t.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(x){Lr(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ks(e,t),$s(t),n&4&&m_(t);break;case 21:break;default:ks(e,t),$s(t)}}function $s(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(QT(r)){var n=r;break e}r=r.return}throw Error(Me(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Pf(i,""),n.flags&=-33);var s=p_(t);Gg(t,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=p_(t);$g(t,o,a);break;default:throw Error(Me(161))}}catch(l){Lr(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function yb(t,e,r){qe=t,eS(t)}function eS(t,e,r){for(var n=(t.mode&1)!==0;qe!==null;){var i=qe,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||_0;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||Xn;o=_0;var c=Xn;if(_0=a,(Xn=l)&&!c)for(qe=i;qe!==null;)a=qe,l=a.child,a.tag===22&&a.memoizedState!==null?v_(i):l!==null?(l.return=a,qe=l):v_(i);for(;s!==null;)qe=s,eS(s),s=s.sibling;qe=i,_0=o,Xn=c}g_(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,qe=s):g_(t)}}function g_(t){for(;qe!==null;){var e=qe;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Xn||Ep(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Xn)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:Fs(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&e_(e,s,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}e_(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Bf(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Me(163))}Xn||e.flags&512&&Hg(e)}catch(p){Lr(e,e.return,p)}}if(e===t){qe=null;break}if(r=e.sibling,r!==null){r.return=e.return,qe=r;break}qe=e.return}}function x_(t){for(;qe!==null;){var e=qe;if(e===t){qe=null;break}var r=e.sibling;if(r!==null){r.return=e.return,qe=r;break}qe=e.return}}function v_(t){for(;qe!==null;){var e=qe;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Ep(4,e)}catch(l){Lr(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){Lr(e,i,l)}}var s=e.return;try{Hg(e)}catch(l){Lr(e,s,l)}break;case 5:var a=e.return;try{Hg(e)}catch(l){Lr(e,a,l)}}}catch(l){Lr(e,e.return,l)}if(e===t){qe=null;break}var o=e.sibling;if(o!==null){o.return=e.return,qe=o;break}qe=e.return}}var _b=Math.ceil,Rh=$a.ReactCurrentDispatcher,p1=$a.ReactCurrentOwner,as=$a.ReactCurrentBatchConfig,Dt=0,En=null,nn=null,Rn=0,Oi=0,Dc=Yo(0),un=0,Yf=null,bl=0,wp=0,m1=0,vf=null,Ai=null,g1=0,nu=1/0,wa=null,Nh=!1,Kg=null,Ro=null,E0=!1,Eo=null,Dh=0,yf=0,Xg=null,eh=-1,th=0;function pi(){return Dt&6?Hr():eh!==-1?eh:eh=Hr()}function No(t){return t.mode&1?Dt&2&&Rn!==0?Rn&-Rn:nb.transition!==null?(th===0&&(th=Bw()),th):(t=Xt,t!==0||(t=window.event,t=t===void 0?16:$w(t.type)),t):1}function Os(t,e,r,n){if(50<yf)throw yf=0,Xg=null,Error(Me(185));Ed(t,r,n),(!(Dt&2)||t!==En)&&(t===En&&(!(Dt&2)&&(wp|=r),un===4&&mo(t,Rn)),Ii(t,n),r===1&&Dt===0&&!(e.mode&1)&&(nu=Hr()+500,vp&&qo()))}function Ii(t,e){var r=t.callbackNode;nI(t,e);var n=gh(t,t===En?Rn:0);if(n===0)r!==null&&Cy(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&Cy(r),e===1)t.tag===0?rb(y_.bind(null,t)):uT(y_.bind(null,t)),JI(function(){!(Dt&6)&&qo()}),r=null;else{switch(jw(n)){case 1:r=zx;break;case 4:r=Mw;break;case 16:r=mh;break;case 536870912:r=Lw;break;default:r=mh}r=lS(r,tS.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function tS(t,e){if(eh=-1,th=0,Dt&6)throw Error(Me(327));var r=t.callbackNode;if(zc()&&t.callbackNode!==r)return null;var n=gh(t,t===En?Rn:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Ph(t,n);else{e=n;var i=Dt;Dt|=2;var s=nS();(En!==t||Rn!==e)&&(wa=null,nu=Hr()+500,yl(t,e));do try{Tb();break}catch(o){rS(t,o)}while(!0);t1(),Rh.current=s,Dt=i,nn!==null?e=0:(En=null,Rn=0,e=un)}if(e!==0){if(e===2&&(i=Eg(t),i!==0&&(n=i,e=Yg(t,i))),e===1)throw r=Yf,yl(t,0),mo(t,n),Ii(t,Hr()),r;if(e===6)mo(t,n);else{if(i=t.current.alternate,!(n&30)&&!Eb(i)&&(e=Ph(t,n),e===2&&(s=Eg(t),s!==0&&(n=s,e=Yg(t,s))),e===1))throw r=Yf,yl(t,0),mo(t,n),Ii(t,Hr()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(Me(345));case 2:ul(t,Ai,wa);break;case 3:if(mo(t,n),(n&130023424)===n&&(e=g1+500-Hr(),10<e)){if(gh(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){pi(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Ig(ul.bind(null,t,Ai,wa),e);break}ul(t,Ai,wa);break;case 4:if(mo(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var a=31-Ps(n);s=1<<a,a=e[a],a>i&&(i=a),n&=~s}if(n=i,n=Hr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*_b(n/1960))-n,10<n){t.timeoutHandle=Ig(ul.bind(null,t,Ai,wa),n);break}ul(t,Ai,wa);break;case 5:ul(t,Ai,wa);break;default:throw Error(Me(329))}}}return Ii(t,Hr()),t.callbackNode===r?tS.bind(null,t):null}function Yg(t,e){var r=vf;return t.current.memoizedState.isDehydrated&&(yl(t,e).flags|=256),t=Ph(t,e),t!==2&&(e=Ai,Ai=r,e!==null&&qg(e)),t}function qg(t){Ai===null?Ai=t:Ai.push.apply(Ai,t)}function Eb(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Bs(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function mo(t,e){for(e&=~m1,e&=~wp,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Ps(e),n=1<<r;t[r]=-1,e&=~n}}function y_(t){if(Dt&6)throw Error(Me(327));zc();var e=gh(t,0);if(!(e&1))return Ii(t,Hr()),null;var r=Ph(t,e);if(t.tag!==0&&r===2){var n=Eg(t);n!==0&&(e=n,r=Yg(t,n))}if(r===1)throw r=Yf,yl(t,0),mo(t,e),Ii(t,Hr()),r;if(r===6)throw Error(Me(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ul(t,Ai,wa),Ii(t,Hr()),null}function x1(t,e){var r=Dt;Dt|=1;try{return t(e)}finally{Dt=r,Dt===0&&(nu=Hr()+500,vp&&qo())}}function Rl(t){Eo!==null&&Eo.tag===0&&!(Dt&6)&&zc();var e=Dt;Dt|=1;var r=as.transition,n=Xt;try{if(as.transition=null,Xt=1,t)return t()}finally{Xt=n,as.transition=r,Dt=e,!(Dt&6)&&qo()}}function v1(){Oi=Dc.current,hr(Dc)}function yl(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,QI(r)),nn!==null)for(r=nn.return;r!==null;){var n=r;switch(Jx(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Eh();break;case 3:tu(),hr(Ci),hr(Zn),o1();break;case 5:a1(n);break;case 4:tu();break;case 13:hr(kr);break;case 19:hr(kr);break;case 10:r1(n.type._context);break;case 22:case 23:v1()}r=r.return}if(En=t,nn=t=Do(t.current,null),Rn=Oi=e,un=0,Yf=null,m1=wp=bl=0,Ai=vf=null,ml!==null){for(e=0;e<ml.length;e++)if(r=ml[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}ml=null}return t}function rS(t,e){do{var r=nn;try{if(t1(),Q0.current=bh,Ih){for(var n=Ir.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Ih=!1}if(Il=0,vn=on=Ir=null,gf=!1,Gf=0,p1.current=null,r===null||r.return===null){un=1,Yf=e,nn=null;break}e:{var s=t,a=r.return,o=r,l=e;if(e=Rn,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,d=o,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var g=a_(a);if(g!==null){g.flags&=-257,o_(g,a,o,s,e),g.mode&1&&s_(s,c,e),e=g,l=c;var y=e.updateQueue;if(y===null){var x=new Set;x.add(l),e.updateQueue=x}else y.add(l);break e}else{if(!(e&1)){s_(s,c,e),y1();break e}l=Error(Me(426))}}else if(Er&&o.mode&1){var E=a_(a);if(E!==null){!(E.flags&65536)&&(E.flags|=256),o_(E,a,o,s,e),Zx(ru(l,o));break e}}s=l=ru(l,o),un!==4&&(un=2),vf===null?vf=[s]:vf.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var T=jT(s,l,e);Zy(s,T);break e;case 1:o=l;var A=s.type,_=s.stateNode;if(!(s.flags&128)&&(typeof A.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(Ro===null||!Ro.has(_)))){s.flags|=65536,e&=-e,s.lanes|=e;var P=VT(s,o,e);Zy(s,P);break e}}s=s.return}while(s!==null)}sS(r)}catch(W){e=W,nn===r&&r!==null&&(nn=r=r.return);continue}break}while(!0)}function nS(){var t=Rh.current;return Rh.current=bh,t===null?bh:t}function y1(){(un===0||un===3||un===2)&&(un=4),En===null||!(bl&268435455)&&!(wp&268435455)||mo(En,Rn)}function Ph(t,e){var r=Dt;Dt|=2;var n=nS();(En!==t||Rn!==e)&&(wa=null,yl(t,e));do try{wb();break}catch(i){rS(t,i)}while(!0);if(t1(),Dt=r,Rh.current=n,nn!==null)throw Error(Me(261));return En=null,Rn=0,un}function wb(){for(;nn!==null;)iS(nn)}function Tb(){for(;nn!==null&&!XF();)iS(nn)}function iS(t){var e=oS(t.alternate,t,Oi);t.memoizedProps=t.pendingProps,e===null?sS(t):nn=e,p1.current=null}function sS(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=gb(r,e),r!==null){r.flags&=32767,nn=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{un=6,nn=null;return}}else if(r=mb(r,e,Oi),r!==null){nn=r;return}if(e=e.sibling,e!==null){nn=e;return}nn=e=t}while(e!==null);un===0&&(un=5)}function ul(t,e,r){var n=Xt,i=as.transition;try{as.transition=null,Xt=1,Sb(t,e,r,n)}finally{as.transition=i,Xt=n}return null}function Sb(t,e,r,n){do zc();while(Eo!==null);if(Dt&6)throw Error(Me(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Me(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(iI(t,s),t===En&&(nn=En=null,Rn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||E0||(E0=!0,lS(mh,function(){return zc(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=as.transition,as.transition=null;var a=Xt;Xt=1;var o=Dt;Dt|=4,p1.current=null,vb(t,r),ZT(r,t),HI(Cg),xh=!!kg,Cg=kg=null,t.current=r,yb(r),YF(),Dt=o,Xt=a,as.transition=s}else t.current=r;if(E0&&(E0=!1,Eo=t,Dh=i),s=t.pendingLanes,s===0&&(Ro=null),JF(r.stateNode),Ii(t,Hr()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Nh)throw Nh=!1,t=Kg,Kg=null,t;return Dh&1&&t.tag!==0&&zc(),s=t.pendingLanes,s&1?t===Xg?yf++:(yf=0,Xg=t):yf=0,qo(),null}function zc(){if(Eo!==null){var t=jw(Dh),e=as.transition,r=Xt;try{if(as.transition=null,Xt=16>t?16:t,Eo===null)var n=!1;else{if(t=Eo,Eo=null,Dh=0,Dt&6)throw Error(Me(331));var i=Dt;for(Dt|=4,qe=t.current;qe!==null;){var s=qe,a=s.child;if(qe.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(qe=c;qe!==null;){var d=qe;switch(d.tag){case 0:case 11:case 15:xf(8,d,s)}var h=d.child;if(h!==null)h.return=d,qe=h;else for(;qe!==null;){d=qe;var p=d.sibling,g=d.return;if(qT(d),d===c){qe=null;break}if(p!==null){p.return=g,qe=p;break}qe=g}}}var y=s.alternate;if(y!==null){var x=y.child;if(x!==null){y.child=null;do{var E=x.sibling;x.sibling=null,x=E}while(x!==null)}}qe=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,qe=a;else e:for(;qe!==null;){if(s=qe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:xf(9,s,s.return)}var T=s.sibling;if(T!==null){T.return=s.return,qe=T;break e}qe=s.return}}var A=t.current;for(qe=A;qe!==null;){a=qe;var _=a.child;if(a.subtreeFlags&2064&&_!==null)_.return=a,qe=_;else e:for(a=A;qe!==null;){if(o=qe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Ep(9,o)}}catch(W){Lr(o,o.return,W)}if(o===a){qe=null;break e}var P=o.sibling;if(P!==null){P.return=o.return,qe=P;break e}qe=o.return}}if(Dt=i,qo(),ea&&typeof ea.onPostCommitFiberRoot=="function")try{ea.onPostCommitFiberRoot(hp,t)}catch{}n=!0}return n}finally{Xt=r,as.transition=e}}return!1}function __(t,e,r){e=ru(r,e),e=jT(t,e,1),t=bo(t,e,1),e=pi(),t!==null&&(Ed(t,1,e),Ii(t,e))}function Lr(t,e,r){if(t.tag===3)__(t,t,r);else for(;e!==null;){if(e.tag===3){__(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ro===null||!Ro.has(n))){t=ru(r,t),t=VT(e,t,1),e=bo(e,t,1),t=pi(),e!==null&&(Ed(e,1,t),Ii(e,t));break}}e=e.return}}function Ab(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=pi(),t.pingedLanes|=t.suspendedLanes&r,En===t&&(Rn&r)===r&&(un===4||un===3&&(Rn&130023424)===Rn&&500>Hr()-g1?yl(t,0):m1|=r),Ii(t,e)}function aS(t,e){e===0&&(t.mode&1?(e=f0,f0<<=1,!(f0&130023424)&&(f0=4194304)):e=1);var r=pi();t=La(t,e),t!==null&&(Ed(t,e,r),Ii(t,r))}function kb(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),aS(t,r)}function Cb(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Me(314))}n!==null&&n.delete(e),aS(t,r)}var oS;oS=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ci.current)ki=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return ki=!1,pb(t,e,r);ki=!!(t.flags&131072)}else ki=!1,Er&&e.flags&1048576&&fT(e,Sh,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Z0(t,e),t=e.pendingProps;var i=Jc(e,Zn.current);Uc(e,r),i=c1(null,e,n,t,i,r);var s=u1();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Fi(n)?(s=!0,wh(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i1(e),i.updater=_p,e.stateNode=i,i._reactInternals=e,Mg(e,n,t,r),e=jg(null,e,n,!0,s,r)):(e.tag=0,Er&&s&&Qx(e),fi(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Z0(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=Ib(n),t=Fs(n,t),i){case 0:e=Bg(null,e,n,t,r);break e;case 1:e=u_(null,e,n,t,r);break e;case 11:e=l_(null,e,n,t,r);break e;case 14:e=c_(null,e,n,Fs(n.type,t),r);break e}throw Error(Me(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Fs(n,i),Bg(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Fs(n,i),u_(t,e,n,i,r);case 3:e:{if(HT(e),t===null)throw Error(Me(387));n=e.pendingProps,s=e.memoizedState,i=s.element,xT(t,e),Ch(e,n,null,r);var a=e.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=ru(Error(Me(423)),e),e=f_(t,e,n,r,i);break e}else if(n!==i){i=ru(Error(Me(424)),e),e=f_(t,e,n,r,i);break e}else for(Vi=Io(e.stateNode.containerInfo.firstChild),Ui=e,Er=!0,bs=null,r=mT(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Zc(),n===i){e=Ba(t,e,r);break e}fi(t,e,n,r)}e=e.child}return e;case 5:return vT(e),t===null&&Dg(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,Fg(n,i)?a=null:s!==null&&Fg(n,s)&&(e.flags|=32),WT(t,e),fi(t,e,a,r),e.child;case 6:return t===null&&Dg(e),null;case 13:return $T(t,e,r);case 4:return s1(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=eu(e,null,n,r):fi(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Fs(n,i),l_(t,e,n,i,r);case 7:return fi(t,e,e.pendingProps,r),e.child;case 8:return fi(t,e,e.pendingProps.children,r),e.child;case 12:return fi(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,ir(Ah,n._currentValue),n._currentValue=a,s!==null)if(Bs(s.value,a)){if(s.children===i.children&&!Ci.current){e=Ba(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=ba(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Pg(s.return,r,e),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(Me(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Pg(a,r,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}fi(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,Uc(e,r),i=ls(i),n=n(i),e.flags|=1,fi(t,e,n,r),e.child;case 14:return n=e.type,i=Fs(n,e.pendingProps),i=Fs(n.type,i),c_(t,e,n,i,r);case 15:return UT(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Fs(n,i),Z0(t,e),e.tag=1,Fi(n)?(t=!0,wh(e)):t=!1,Uc(e,r),BT(e,n,i),Mg(e,n,i,r),jg(null,e,n,!0,t,r);case 19:return GT(t,e,r);case 22:return zT(t,e,r)}throw Error(Me(156,e.tag))};function lS(t,e){return Ow(t,e)}function Fb(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ss(t,e,r,n){return new Fb(t,e,r,n)}function _1(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Ib(t){if(typeof t=="function")return _1(t)?1:0;if(t!=null){if(t=t.$$typeof,t===jx)return 11;if(t===Vx)return 14}return 2}function Do(t,e){var r=t.alternate;return r===null?(r=ss(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function rh(t,e,r,n,i,s){var a=2;if(n=t,typeof t=="function")_1(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Tc:return _l(r.children,i,s,e);case Bx:a=8,i|=8;break;case ag:return t=ss(12,r,e,i|2),t.elementType=ag,t.lanes=s,t;case og:return t=ss(13,r,e,i),t.elementType=og,t.lanes=s,t;case lg:return t=ss(19,r,e,i),t.elementType=lg,t.lanes=s,t;case vw:return Tp(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case gw:a=10;break e;case xw:a=9;break e;case jx:a=11;break e;case Vx:a=14;break e;case fo:a=16,n=null;break e}throw Error(Me(130,t==null?t:typeof t,""))}return e=ss(a,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function _l(t,e,r,n){return t=ss(7,t,n,e),t.lanes=r,t}function Tp(t,e,r,n){return t=ss(22,t,n,e),t.elementType=vw,t.lanes=r,t.stateNode={isHidden:!1},t}function Tm(t,e,r){return t=ss(6,t,null,e),t.lanes=r,t}function Sm(t,e,r){return e=ss(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function bb(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=im(0),this.expirationTimes=im(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=im(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function E1(t,e,r,n,i,s,a,o,l){return t=new bb(t,e,r,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=ss(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},i1(s),t}function Rb(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wc,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function cS(t){if(!t)return Vo;t=t._reactInternals;e:{if(Hl(t)!==t||t.tag!==1)throw Error(Me(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Fi(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Me(171))}if(t.tag===1){var r=t.type;if(Fi(r))return cT(t,r,e)}return e}function uS(t,e,r,n,i,s,a,o,l){return t=E1(r,n,!0,t,i,s,a,o,l),t.context=cS(null),r=t.current,n=pi(),i=No(r),s=ba(n,i),s.callback=e??null,bo(r,s,i),t.current.lanes=i,Ed(t,i,n),Ii(t,n),t}function Sp(t,e,r,n){var i=e.current,s=pi(),a=No(i);return r=cS(r),e.context===null?e.context=r:e.pendingContext=r,e=ba(s,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=bo(i,e,a),t!==null&&(Os(t,i,a,s),q0(t,i,a)),a}function Oh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function E_(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function w1(t,e){E_(t,e),(t=t.alternate)&&E_(t,e)}function Nb(){return null}var fS=typeof reportError=="function"?reportError:function(t){console.error(t)};function T1(t){this._internalRoot=t}Ap.prototype.render=T1.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Me(409));Sp(t,e,null,null)};Ap.prototype.unmount=T1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Rl(function(){Sp(null,t,null,null)}),e[Ma]=null}};function Ap(t){this._internalRoot=t}Ap.prototype.unstable_scheduleHydration=function(t){if(t){var e=zw();t={blockedOn:null,target:t,priority:e};for(var r=0;r<po.length&&e!==0&&e<po[r].priority;r++);po.splice(r,0,t),r===0&&Hw(t)}};function S1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function kp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function w_(){}function Db(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=Oh(a);s.call(c)}}var a=uS(e,n,t,0,null,!1,!1,"",w_);return t._reactRootContainer=a,t[Ma]=a.current,Uf(t.nodeType===8?t.parentNode:t),Rl(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=Oh(l);o.call(c)}}var l=E1(t,0,!1,null,null,!1,!1,"",w_);return t._reactRootContainer=l,t[Ma]=l.current,Uf(t.nodeType===8?t.parentNode:t),Rl(function(){Sp(e,l,r,n)}),l}function Cp(t,e,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=Oh(a);o.call(l)}}Sp(e,a,t,i)}else a=Db(r,e,t,i,n);return Oh(a)}Vw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=tf(e.pendingLanes);r!==0&&(Wx(e,r|1),Ii(e,Hr()),!(Dt&6)&&(nu=Hr()+500,qo()))}break;case 13:Rl(function(){var n=La(t,1);if(n!==null){var i=pi();Os(n,t,1,i)}}),w1(t,1)}};Hx=function(t){if(t.tag===13){var e=La(t,134217728);if(e!==null){var r=pi();Os(e,t,134217728,r)}w1(t,134217728)}};Uw=function(t){if(t.tag===13){var e=No(t),r=La(t,e);if(r!==null){var n=pi();Os(r,t,e,n)}w1(t,e)}};zw=function(){return Xt};Ww=function(t,e){var r=Xt;try{return Xt=t,e()}finally{Xt=r}};vg=function(t,e,r){switch(e){case"input":if(fg(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=xp(n);if(!i)throw Error(Me(90));_w(n),fg(n,i)}}}break;case"textarea":ww(t,r);break;case"select":e=r.value,e!=null&&Lc(t,!!r.multiple,e,!1)}};Iw=x1;bw=Rl;var Pb={usingClientEntryPoint:!1,Events:[Td,Cc,xp,Cw,Fw,x1]},Ku={findFiberByHostInstance:pl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Ob={bundleType:Ku.bundleType,version:Ku.version,rendererPackageName:Ku.rendererPackageName,rendererConfig:Ku.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:$a.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Dw(t),t===null?null:t.stateNode},findFiberByHostInstance:Ku.findFiberByHostInstance||Nb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var w0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!w0.isDisabled&&w0.supportsFiber)try{hp=w0.inject(Ob),ea=w0}catch{}}$i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Pb;$i.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!S1(e))throw Error(Me(200));return Rb(t,e,null,r)};$i.createRoot=function(t,e){if(!S1(t))throw Error(Me(299));var r=!1,n="",i=fS;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=E1(t,1,!1,null,null,r,!1,n,i),t[Ma]=e.current,Uf(t.nodeType===8?t.parentNode:t),new T1(e)};$i.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Me(188)):(t=Object.keys(t).join(","),Error(Me(268,t)));return t=Dw(e),t=t===null?null:t.stateNode,t};$i.flushSync=function(t){return Rl(t)};$i.hydrate=function(t,e,r){if(!kp(e))throw Error(Me(200));return Cp(null,t,e,!0,r)};$i.hydrateRoot=function(t,e,r){if(!S1(t))throw Error(Me(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=fS;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=uS(e,null,t,1,r??null,i,!1,s,a),t[Ma]=e.current,Uf(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new Ap(e)};$i.render=function(t,e,r){if(!kp(e))throw Error(Me(200));return Cp(null,t,e,!1,r)};$i.unmountComponentAtNode=function(t){if(!kp(t))throw Error(Me(40));return t._reactRootContainer?(Rl(function(){Cp(null,null,t,!1,function(){t._reactRootContainer=null,t[Ma]=null})}),!0):!1};$i.unstable_batchedUpdates=x1;$i.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!kp(r))throw Error(Me(200));if(t==null||t._reactInternals===void 0)throw Error(Me(38));return Cp(t,e,r,!1,n)};$i.version="18.3.1-next-f1338f8080-20240426";function dS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(dS)}catch(t){console.error(t)}}dS(),dw.exports=$i;var Mb=dw.exports,T_=Mb;ig.createRoot=T_.createRoot,ig.hydrateRoot=T_.hydrateRoot;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Mh={};Mh.version="0.18.5";var hS=1252,Lb=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],A1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},k1=function(t){Lb.indexOf(t)!=-1&&(hS=A1[0]=t)};function Bb(){k1(1252)}var Rs=function(t){k1(t)};function C1(){Rs(1200),Bb()}function S_(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function jb(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function pS(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var nf=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?jb(t.slice(2)):e==254&&r==255?pS(t.slice(2)):e==65279?t.slice(1):t},T0=function(e){return String.fromCharCode(e)},A_=function(e){return String.fromCharCode(e)},qf,wo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Qf(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),s=r>>2,n=t.charCodeAt(c++),a=(r&3)<<4|n>>4,i=t.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=wo.charAt(s)+wo.charAt(a)+wo.charAt(o)+wo.charAt(l);return e}function Hi(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)s=wo.indexOf(t.charAt(c++)),a=wo.indexOf(t.charAt(c++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=wo.indexOf(t.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=wo.indexOf(t.charAt(c++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Et=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ga=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Uo(t){return Et?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function k_(t){return Et?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Bi=function(e){return Et?Ga(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Fp(t){if(typeof ArrayBuffer>"u")return Bi(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Qo(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function Vb(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function F1(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return F1(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var yn=Et?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Ga(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Ub(t){for(var e=[],r=0,n=t.length+250,i=Uo(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Uo(65535),n=65530)}return e.push(i.slice(0,r)),yn(e)}var mi=/\u0000/g,sf=/[\u0001-\u0006]/g;function Wc(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Ns(t,e){var r=""+t;return r.length>=e?r:Br("0",e-r.length)+r}function I1(t,e){var r=""+t;return r.length>=e?r:Br(" ",e-r.length)+r}function Lh(t,e){var r=""+t;return r.length>=e?r:r+Br(" ",e-r.length)}function zb(t,e){var r=""+Math.round(t);return r.length>=e?r:Br("0",e-r.length)+r}function Wb(t,e){var r=""+t;return r.length>=e?r:Br("0",e-r.length)+r}var C_=Math.pow(2,32);function mc(t,e){if(t>C_||t<-C_)return zb(t,e);var r=Math.round(t);return Wb(r,e)}function Bh(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var F_=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Am=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Hb(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var st={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},I_={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},$b={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function jh(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,l=1,c=0,d=0,h=Math.floor(i);c<e&&(h=Math.floor(i),o=h*a+s,d=h*c+l,!(i-h<5e-8));)i=1/(i-h),s=a,a=o,l=c,c=d;if(d>e&&(c>e?(d=l,o=s):(d=c,o=a)),!r)return[0,n*o,d];var p=Math.floor(n*o/d);return[p,n*o-p*d,d]}function xl(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=Qb(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var mS=new Date(1899,11,31,0,0,0),Gb=mS.getTime(),Kb=new Date(1900,2,1,0,0,0);function gS(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=Kb&&(r+=24*60*60*1e3),(r-(Gb+(t.getTimezoneOffset()-mS.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function b1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Xb(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Yb(t){var e=t<0?12:11,r=b1(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function qb(t){var e=b1(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Jf(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=Yb(t):e===10?r=t.toFixed(10).substr(0,12):r=qb(t),b1(Xb(r.toUpperCase()))}function Nl(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Jf(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return us(14,gS(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function Qb(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function Jb(t,e,r,n){var i="",s=0,a=0,o=r.y,l,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return Am[r.m-1][1];case 5:return Am[r.m-1][0];default:return Am[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return F_[r.q][0];default:return F_[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Ns(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=Ns(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var d=c>0?Ns(l,c):"";return d}function To(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var xS=/%/g;function Zb(t,e,r){var n=e.replace(xS,""),i=e.length-n.length;return Ra(t,n,r*Math.pow(10,2*i))+Br("%",i)}function eR(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ra(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function vS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+vS(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,d){return l+c+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var yS=/# (\?+)( ?)\/( ?)(\d+)/;function tR(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?Br(" ",t[1].length+1+t[4].length):I1(a,t[1].length)+t[2]+"/"+t[3]+Ns(o,t[4].length))}function rR(t,e,r){return r+(e===0?"":""+e)+Br(" ",t[1].length+2+t[4].length)}var _S=/^#*0*\.([0#]+)/,ES=/\).*[0#]/,wS=/\(###\) ###\\?-####/;function di(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function b_(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function R_(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function nR(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function iR(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Qi(t,e,r){if(t.charCodeAt(0)===40&&!e.match(ES)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Qi("n",n,r):"("+Qi("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return eR(t,e,r);if(e.indexOf("%")!==-1)return Zb(t,e,r);if(e.indexOf("E")!==-1)return vS(e,r);if(e.charCodeAt(0)===36)return"$"+Qi(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+mc(l,e.length);if(e.match(/^[#?]+$/))return i=mc(r,0),i==="0"&&(i=""),i.length>e.length?i:di(e.substr(0,e.length-i.length))+i;if(s=e.match(yS))return tR(s,l,c);if(e.match(/^#+0+$/))return c+mc(l,e.length-e.indexOf("0"));if(s=e.match(_S))return i=b_(r,s[1].length).replace(/^([^\.]+)$/,"$1."+di(s[1])).replace(/\.$/,"."+di(s[1])).replace(/\.(\d*)$/,function(y,x){return"."+x+Br("0",di(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+b_(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+To(mc(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Qi(t,e,-r):To(""+(Math.floor(r)+nR(r,s[1].length)))+"."+Ns(R_(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Qi(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Wc(Qi(t,e.replace(/[\\-]/g,""),r)),a=0,Wc(Wc(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match(wS))return i=Qi(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=jh(l,Math.pow(10,a)-1,!1),i=""+c,d=Ra("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=Lh(o[2],a),d.length<s[4].length&&(d=di(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=jh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?I1(o[1],a)+s[2]+"/"+s[3]+Lh(o[2],a):Br(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=mc(r,0),e.length<=i.length?i:di(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,p=e.length-i.length-h;return di(e.substr(0,h)+i+e.substr(e.length-p))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=R_(r,s[1].length),r<0?"-"+Qi(t,e,-r):To(iR(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Ns(0,3-y.length):"")+y})+"."+Ns(a,s[1].length);switch(e){case"###,##0.00":return Qi(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=To(mc(l,0));return g!=="0"?c+g:"";case"###,###.00":return Qi(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Qi(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function sR(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ra(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function aR(t,e,r){var n=e.replace(xS,""),i=e.length-n.length;return Ra(t,n,r*Math.pow(10,2*i))+Br("%",i)}function TS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+TS(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,d){return l+c+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ys(t,e,r){if(t.charCodeAt(0)===40&&!e.match(ES)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ys("n",n,r):"("+Ys("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return sR(t,e,r);if(e.indexOf("%")!==-1)return aR(t,e,r);if(e.indexOf("E")!==-1)return TS(e,r);if(e.charCodeAt(0)===36)return"$"+Ys(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+Ns(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:di(e.substr(0,e.length-i.length))+i;if(s=e.match(yS))return rR(s,l,c);if(e.match(/^#+0+$/))return c+Ns(l,e.length-e.indexOf("0"));if(s=e.match(_S))return i=(""+r).replace(/^([^\.]+)$/,"$1."+di(s[1])).replace(/\.$/,"."+di(s[1])),i=i.replace(/\.(\d*)$/,function(y,x){return"."+x+Br("0",di(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+To(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ys(t,e,-r):To(""+r)+"."+Br("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Ys(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Wc(Ys(t,e.replace(/[\\-]/g,""),r)),a=0,Wc(Wc(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match(wS))return i=Ys(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=jh(l,Math.pow(10,a)-1,!1),i=""+c,d=Ra("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=Lh(o[2],a),d.length<s[4].length&&(d=di(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=jh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?I1(o[1],a)+s[2]+"/"+s[3]+Lh(o[2],a):Br(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:di(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,p=e.length-i.length-h;return di(e.substr(0,h)+i+e.substr(e.length-p))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ys(t,e,-r):To(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Ns(0,3-y.length):"")+y})+"."+Ns(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var g=To(""+l);return g!=="0"?c+g:"";default:if(e.match(/\.[0#?]*$/))return Ys(t,e.slice(0,e.lastIndexOf(".")),r)+di(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Ra(t,e,r){return(r|0)===r?Ys(t,e,r):Qi(t,e,r)}function oR(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var SS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function yu(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Bh(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(SS))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function lR(t,e,r,n){for(var i=[],s="",a=0,o="",l="t",c,d,h,p="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!Bh(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(h=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++a;break;case"\\":var g=t.charAt(++a),y=g==="("||g===")"?g:"t";i[i.length]={t:y,v:g},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(c==null&&(c=xl(e,r,t.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=xl(e,r),c==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var x={t:o,v:o};if(c==null&&(c=xl(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(x.v=c.H>=12?"P":"A"),x.t="T",p="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(x.v=c.H>=12?"PM":"AM"),x.t="T",a+=5,p="h"):t.substr(a,5).toUpperCase()==="/"?(c!=null&&(x.v=c.H>=12?"":""),x.t="T",a+=5,p="h"):(x.t="t",++a),c==null&&x.t==="T")return"";i[i.length]=x,l=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(SS)){if(c==null&&(c=xl(e,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",yu(t)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var E=0,T=0,A;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=p,l="h",E<1&&(E=1);break;case"s":(A=i[a].v.match(/\.0+$/))&&(T=Math.max(T,A[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&i[a].v.match(/[Hh]/)&&(E=1),E<2&&i[a].v.match(/[Mm]/)&&(E=2),E<3&&i[a].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var _="",P;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=Jb(i[a].t.charCodeAt(0),i[a].v,c,T),i[a].t="t";break;case"n":case"?":for(P=a+1;i[P]!=null&&((o=i[P].t)==="?"||o==="D"||(o===" "||o==="t")&&i[P+1]!=null&&(i[P+1].t==="?"||i[P+1].t==="t"&&i[P+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[P].v==="/"||i[P].v===" "&&i[P+1]!=null&&i[P+1].t=="?"));)i[a].v+=i[P].v,i[P]={v:"",t:";"},++P;_+=i[a].v,a=P-1;break;case"G":i[a].t="t",i[a].v=Nl(e,r);break}var W="",j,w;if(_.length>0){_.charCodeAt(0)==40?(j=e<0&&_.charCodeAt(0)===45?-e:e,w=Ra("n",_,j)):(j=e<0&&n>1?-e:e,w=Ra("n",_,j),j<0&&i[0]&&i[0].t=="t"&&(w=w.substr(1),i[0].v="-"+i[0].v)),P=w.length-1;var F=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){F=a;break}var S=i.length;if(F===i.length&&w.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(P>=i[a].v.length-1?(P-=i[a].v.length,i[a].v=w.substr(P+1,i[a].v.length)):P<0?i[a].v="":(i[a].v=w.substr(0,P+1),P=-1),i[a].t="t",S=a);P>=0&&S<i.length&&(i[S].v=w.substr(0,P+1)+i[S].v)}else if(F!==i.length&&w.indexOf("E")===-1){for(P=w.indexOf(".")-1,a=F;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(d=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")-1:i[a].v.length-1,W=i[a].v.substr(d+1);d>=0;--d)P>=0&&(i[a].v.charAt(d)==="0"||i[a].v.charAt(d)==="#")&&(W=w.charAt(P--)+W);i[a].v=W,i[a].t="t",S=a}for(P>=0&&S<i.length&&(i[S].v=w.substr(0,P+1)+i[S].v),P=w.indexOf(".")+1,a=F;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==F)){for(d=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")+1:0,W=i[a].v.substr(0,d);d<i[a].v.length;++d)P<w.length&&(W+=w.charAt(P++));i[a].v=W,i[a].t="t",S=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(j=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Ra(i[a].t,i[a].v,j),i[a].t="t");var b="";for(a=0;a!==i.length;++a)i[a]!=null&&(b+=i[a].v);return b}var N_=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function D_(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function cR(t,e){var r=oR(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(N_),o=r[1].match(N_);return D_(e,a)?[n,r[0]]:D_(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function us(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:st)[t],n==null&&(n=r.table&&r.table[I_[t]]||st[I_[t]]),n==null&&(n=$b[t]||"General");break}if(Bh(n,0))return Nl(e,r);e instanceof Date&&(e=gS(e,r.date1904));var i=cR(n,e);if(Bh(i[1]))return Nl(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return lR(i[1],e,r,i[0])}function Na(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(st[r]==null){e<0&&(e=r);continue}if(st[r]==t){e=r;break}}e<0&&(e=391)}return st[e]=t,e}function Ip(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Na(t[e],e)}function _u(){st=Hb()}var uR={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},AS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function fR(t){var e=typeof t=="number"?st[t]:t;return e=e.replace(AS,"(\\d+)"),new RegExp("^"+e+"$")}function dR(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(AS)||[]).forEach(function(h,p){var g=parseInt(r[p+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=g;break;case"d":s=g;break;case"h":a=g;break;case"s":l=g;break;case"m":a>=0?o=g:i=g;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var d=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&s==-1?d:c+"T"+d}var hR=function(){var t={};t.version="1.2.0";function e(){for(var w=0,F=new Array(256),S=0;S!=256;++S)w=S,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,F[S]=w;return typeof Int32Array<"u"?new Int32Array(F):F}var r=e();function n(w){var F=0,S=0,b=0,N=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(b=0;b!=256;++b)N[b]=w[b];for(b=0;b!=256;++b)for(S=w[b],F=256+b;F<4096;F+=256)S=N[F]=S>>>8^w[S&255];var D=[];for(b=1;b!=16;++b)D[b-1]=typeof Int32Array<"u"?N.subarray(b*256,b*256+256):N.slice(b*256,b*256+256);return D}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],d=i[5],h=i[6],p=i[7],g=i[8],y=i[9],x=i[10],E=i[11],T=i[12],A=i[13],_=i[14];function P(w,F){for(var S=F^-1,b=0,N=w.length;b<N;)S=S>>>8^r[(S^w.charCodeAt(b++))&255];return~S}function W(w,F){for(var S=F^-1,b=w.length-15,N=0;N<b;)S=_[w[N++]^S&255]^A[w[N++]^S>>8&255]^T[w[N++]^S>>16&255]^E[w[N++]^S>>>24]^x[w[N++]]^y[w[N++]]^g[w[N++]]^p[w[N++]]^h[w[N++]]^d[w[N++]]^c[w[N++]]^l[w[N++]]^o[w[N++]]^a[w[N++]]^s[w[N++]]^r[w[N++]];for(b+=15;N<b;)S=S>>>8^r[(S^w[N++])&255];return~S}function j(w,F){for(var S=F^-1,b=0,N=w.length,D=0,R=0;b<N;)D=w.charCodeAt(b++),D<128?S=S>>>8^r[(S^D)&255]:D<2048?(S=S>>>8^r[(S^(192|D>>6&31))&255],S=S>>>8^r[(S^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,R=w.charCodeAt(b++)&1023,S=S>>>8^r[(S^(240|D>>8&7))&255],S=S>>>8^r[(S^(128|D>>2&63))&255],S=S>>>8^r[(S^(128|R>>6&15|(D&3)<<4))&255],S=S>>>8^r[(S^(128|R&63))&255]):(S=S>>>8^r[(S^(224|D>>12&15))&255],S=S>>>8^r[(S^(128|D>>6&63))&255],S=S>>>8^r[(S^(128|D&63))&255]);return~S}return t.table=r,t.bstr=P,t.buf=W,t.str=j,t}(),et=function(){var e={};e.version="1.2.1";function r(I,V){for(var M=I.split("/"),L=V.split("/"),z=0,B=0,oe=Math.min(M.length,L.length);z<oe;++z){if(B=M[z].length-L[z].length)return B;if(M[z]!=L[z])return M[z]<L[z]?-1:1}return M.length-L.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var V=I.lastIndexOf("/");return V===-1?I:I.slice(0,V+1)}function i(I){if(I.charAt(I.length-1)=="/")return i(I.slice(0,-1));var V=I.lastIndexOf("/");return V===-1?I:I.slice(V+1)}function s(I,V){typeof V=="string"&&(V=new Date(V));var M=V.getHours();M=M<<6|V.getMinutes(),M=M<<5|V.getSeconds()>>>1,I.write_shift(2,M);var L=V.getFullYear()-1980;L=L<<4|V.getMonth()+1,L=L<<5|V.getDate(),I.write_shift(2,L)}function a(I){var V=I.read_shift(2)&65535,M=I.read_shift(2)&65535,L=new Date,z=M&31;M>>>=5;var B=M&15;M>>>=4,L.setMilliseconds(0),L.setFullYear(M+1980),L.setMonth(B-1),L.setDate(z);var oe=V&31;V>>>=5;var fe=V&63;return V>>>=6,L.setHours(V),L.setMinutes(fe),L.setSeconds(oe<<1),L}function o(I){Fn(I,0);for(var V={},M=0;I.l<=I.length-4;){var L=I.read_shift(2),z=I.read_shift(2),B=I.l+z,oe={};switch(L){case 21589:M=I.read_shift(1),M&1&&(oe.mtime=I.read_shift(4)),z>5&&(M&2&&(oe.atime=I.read_shift(4)),M&4&&(oe.ctime=I.read_shift(4))),oe.mtime&&(oe.mt=new Date(oe.mtime*1e3));break}I.l=B,V[L]=oe}return V}var l;function c(){return l||(l={})}function d(I,V){if(I[0]==80&&I[1]==75)return Qa(I,V);if((I[0]|32)==109&&(I[1]|32)==105)return Mn(I,V);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var M=3,L=512,z=0,B=0,oe=0,fe=0,se=0,re=[],le=I.slice(0,512);Fn(le,0);var pe=h(le);switch(M=pe[0],M){case 3:L=512;break;case 4:L=4096;break;case 0:if(pe[1]==0)return Qa(I,V);default:throw new Error("Major Version: Expected 3 or 4 saw "+M)}L!==512&&(le=I.slice(0,L),Fn(le,28));var Oe=I.slice(0,L);p(le,M);var Le=le.read_shift(4,"i");if(M===3&&Le!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Le);le.l+=4,oe=le.read_shift(4,"i"),le.l+=4,le.chk("00100000","Mini Stream Cutoff Size: "),fe=le.read_shift(4,"i"),z=le.read_shift(4,"i"),se=le.read_shift(4,"i"),B=le.read_shift(4,"i");for(var be=-1,ze=0;ze<109&&(be=le.read_shift(4,"i"),!(be<0));++ze)re[ze]=be;var tt=g(I,L);E(se,B,tt,L,re);var Mt=A(tt,oe,re,L);Mt[oe].name="!Directory",z>0&&fe!==R&&(Mt[fe].name="!MiniFAT"),Mt[re[0]].name="!FAT",Mt.fat_addrs=re,Mt.ssz=L;var Nt={},Ft=[],si=[],Xr=[];_(oe,Mt,tt,Ft,z,Nt,si,fe),y(si,Xr,Ft),Ft.shift();var wi={FileIndex:si,FullPaths:Xr};return V&&V.raw&&(wi.raw={header:Oe,sectors:tt}),wi}function h(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(He,"Header Signature: "),I.l+=16;var V=I.read_shift(2,"u");return[I.read_shift(2,"u"),V]}function p(I,V){var M=9;switch(I.l+=2,M=I.read_shift(2)){case 9:if(V!=3)throw new Error("Sector Shift: Expected 9 saw "+M);break;case 12:if(V!=4)throw new Error("Sector Shift: Expected 12 saw "+M);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+M)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function g(I,V){for(var M=Math.ceil(I.length/V)-1,L=[],z=1;z<M;++z)L[z-1]=I.slice(z*V,(z+1)*V);return L[M-1]=I.slice(M*V),L}function y(I,V,M){for(var L=0,z=0,B=0,oe=0,fe=0,se=M.length,re=[],le=[];L<se;++L)re[L]=le[L]=L,V[L]=M[L];for(;fe<le.length;++fe)L=le[fe],z=I[L].L,B=I[L].R,oe=I[L].C,re[L]===L&&(z!==-1&&re[z]!==z&&(re[L]=re[z]),B!==-1&&re[B]!==B&&(re[L]=re[B])),oe!==-1&&(re[oe]=L),z!==-1&&L!=re[L]&&(re[z]=re[L],le.lastIndexOf(z)<fe&&le.push(z)),B!==-1&&L!=re[L]&&(re[B]=re[L],le.lastIndexOf(B)<fe&&le.push(B));for(L=1;L<se;++L)re[L]===L&&(B!==-1&&re[B]!==B?re[L]=re[B]:z!==-1&&re[z]!==z&&(re[L]=re[z]));for(L=1;L<se;++L)if(I[L].type!==0){if(fe=L,fe!=re[fe])do fe=re[fe],V[L]=V[fe]+"/"+V[L];while(fe!==0&&re[fe]!==-1&&fe!=re[fe]);re[L]=-1}for(V[0]+="/",L=1;L<se;++L)I[L].type!==2&&(V[L]+="/")}function x(I,V,M){for(var L=I.start,z=I.size,B=[],oe=L;M&&z>0&&oe>=0;)B.push(V.slice(oe*D,oe*D+D)),z-=D,oe=hl(M,oe*4);return B.length===0?me(0):yn(B).slice(0,I.size)}function E(I,V,M,L,z){var B=R;if(I===R){if(V!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var oe=M[I],fe=(L>>>2)-1;if(!oe)return;for(var se=0;se<fe&&(B=hl(oe,se*4))!==R;++se)z.push(B);E(hl(oe,L-4),V-1,M,L,z)}}function T(I,V,M,L,z){var B=[],oe=[];z||(z=[]);var fe=L-1,se=0,re=0;for(se=V;se>=0;){z[se]=!0,B[B.length]=se,oe.push(I[se]);var le=M[Math.floor(se*4/L)];if(re=se*4&fe,L<4+re)throw new Error("FAT boundary crossed: "+se+" 4 "+L);if(!I[le])break;se=hl(I[le],re)}return{nodes:B,data:$_([oe])}}function A(I,V,M,L){var z=I.length,B=[],oe=[],fe=[],se=[],re=L-1,le=0,pe=0,Oe=0,Le=0;for(le=0;le<z;++le)if(fe=[],Oe=le+V,Oe>=z&&(Oe-=z),!oe[Oe]){se=[];var be=[];for(pe=Oe;pe>=0;){be[pe]=!0,oe[pe]=!0,fe[fe.length]=pe,se.push(I[pe]);var ze=M[Math.floor(pe*4/L)];if(Le=pe*4&re,L<4+Le)throw new Error("FAT boundary crossed: "+pe+" 4 "+L);if(!I[ze]||(pe=hl(I[ze],Le),be[pe]))break}B[Oe]={nodes:fe,data:$_([se])}}return B}function _(I,V,M,L,z,B,oe,fe){for(var se=0,re=L.length?2:0,le=V[I].data,pe=0,Oe=0,Le;pe<le.length;pe+=128){var be=le.slice(pe,pe+128);Fn(be,64),Oe=be.read_shift(2),Le=L1(be,0,Oe-re),L.push(Le);var ze={name:Le,type:be.read_shift(1),color:be.read_shift(1),L:be.read_shift(4,"i"),R:be.read_shift(4,"i"),C:be.read_shift(4,"i"),clsid:be.read_shift(16),state:be.read_shift(4,"i"),start:0,size:0},tt=be.read_shift(2)+be.read_shift(2)+be.read_shift(2)+be.read_shift(2);tt!==0&&(ze.ct=P(be,be.l-8));var Mt=be.read_shift(2)+be.read_shift(2)+be.read_shift(2)+be.read_shift(2);Mt!==0&&(ze.mt=P(be,be.l-8)),ze.start=be.read_shift(4,"i"),ze.size=be.read_shift(4,"i"),ze.size<0&&ze.start<0&&(ze.size=ze.type=0,ze.start=R,ze.name=""),ze.type===5?(se=ze.start,z>0&&se!==R&&(V[se].name="!StreamData")):ze.size>=4096?(ze.storage="fat",V[ze.start]===void 0&&(V[ze.start]=T(M,ze.start,V.fat_addrs,V.ssz)),V[ze.start].name=ze.name,ze.content=V[ze.start].data.slice(0,ze.size)):(ze.storage="minifat",ze.size<0?ze.size=0:se!==R&&ze.start!==R&&V[se]&&(ze.content=x(ze,V[se].data,(V[fe]||{}).data))),ze.content&&Fn(ze.content,0),B[Le]=ze,oe.push(ze)}}function P(I,V){return new Date((Li(I,V+4)/1e7*Math.pow(2,32)+Li(I,V)/1e7-11644473600)*1e3)}function W(I,V){return c(),d(l.readFileSync(I),V)}function j(I,V){var M=V&&V.type;switch(M||Et&&Buffer.isBuffer(I)&&(M="buffer"),M||"base64"){case"file":return W(I,V);case"base64":return d(Bi(Hi(I)),V);case"binary":return d(Bi(I),V)}return d(I,V)}function w(I,V){var M=V||{},L=M.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=L+"/",I.FileIndex[0]={name:L,type:5}),M.CLSID&&(I.FileIndex[0].clsid=M.CLSID),F(I)}function F(I){var V="Sh33tJ5";if(!et.find(I,"/"+V)){var M=me(4);M[0]=55,M[1]=M[3]=50,M[2]=54,I.FileIndex.push({name:V,type:2,content:M,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+V),S(I)}}function S(I,V){w(I);for(var M=!1,L=!1,z=I.FullPaths.length-1;z>=0;--z){var B=I.FileIndex[z];switch(B.type){case 0:L?M=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:L=!0,isNaN(B.R*B.L*B.C)&&(M=!0),B.R>-1&&B.L>-1&&B.R==B.L&&(M=!0);break;default:M=!0;break}}if(!(!M&&!V)){var oe=new Date(1987,1,19),fe=0,se=Object.create?Object.create(null):{},re=[];for(z=0;z<I.FullPaths.length;++z)se[I.FullPaths[z]]=!0,I.FileIndex[z].type!==0&&re.push([I.FullPaths[z],I.FileIndex[z]]);for(z=0;z<re.length;++z){var le=n(re[z][0]);L=se[le],L||(re.push([le,{name:i(le).replace("/",""),type:1,clsid:Re,ct:oe,mt:oe,content:null}]),se[le]=!0)}for(re.sort(function(Le,be){return r(Le[0],be[0])}),I.FullPaths=[],I.FileIndex=[],z=0;z<re.length;++z)I.FullPaths[z]=re[z][0],I.FileIndex[z]=re[z][1];for(z=0;z<re.length;++z){var pe=I.FileIndex[z],Oe=I.FullPaths[z];if(pe.name=i(Oe).replace("/",""),pe.L=pe.R=pe.C=-(pe.color=1),pe.size=pe.content?pe.content.length:0,pe.start=0,pe.clsid=pe.clsid||Re,z===0)pe.C=re.length>1?1:-1,pe.size=0,pe.type=5;else if(Oe.slice(-1)=="/"){for(fe=z+1;fe<re.length&&n(I.FullPaths[fe])!=Oe;++fe);for(pe.C=fe>=re.length?-1:fe,fe=z+1;fe<re.length&&n(I.FullPaths[fe])!=n(Oe);++fe);pe.R=fe>=re.length?-1:fe,pe.type=1}else n(I.FullPaths[z+1]||"")==n(Oe)&&(pe.R=z+1),pe.type=2}}}function b(I,V){var M=V||{};if(M.fileType=="mad")return Kr(I,M);switch(S(I),M.fileType){case"zip":return fa(I,M)}var L=function(Le){for(var be=0,ze=0,tt=0;tt<Le.FileIndex.length;++tt){var Mt=Le.FileIndex[tt];if(Mt.content){var Nt=Mt.content.length;Nt>0&&(Nt<4096?be+=Nt+63>>6:ze+=Nt+511>>9)}}for(var Ft=Le.FullPaths.length+3>>2,si=be+7>>3,Xr=be+127>>7,wi=si+ze+Ft+Xr,Yr=wi+127>>7,ps=Yr<=109?0:Math.ceil((Yr-109)/127);wi+Yr+ps+127>>7>Yr;)ps=++Yr<=109?0:Math.ceil((Yr-109)/127);var qr=[1,ps,Yr,Xr,Ft,ze,be,0];return Le.FileIndex[0].size=be<<6,qr[7]=(Le.FileIndex[0].start=qr[0]+qr[1]+qr[2]+qr[3]+qr[4]+qr[5])+(qr[6]+7>>3),qr}(I),z=me(L[7]<<9),B=0,oe=0;{for(B=0;B<8;++B)z.write_shift(1,ve[B]);for(B=0;B<8;++B)z.write_shift(2,0);for(z.write_shift(2,62),z.write_shift(2,3),z.write_shift(2,65534),z.write_shift(2,9),z.write_shift(2,6),B=0;B<3;++B)z.write_shift(2,0);for(z.write_shift(4,0),z.write_shift(4,L[2]),z.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),z.write_shift(4,0),z.write_shift(4,4096),z.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:R),z.write_shift(4,L[3]),z.write_shift(-4,L[1]?L[0]-1:R),z.write_shift(4,L[1]),B=0;B<109;++B)z.write_shift(-4,B<L[2]?L[1]+B:-1)}if(L[1])for(oe=0;oe<L[1];++oe){for(;B<236+oe*127;++B)z.write_shift(-4,B<L[2]?L[1]+B:-1);z.write_shift(-4,oe===L[1]-1?R:oe+1)}var fe=function(Le){for(oe+=Le;B<oe-1;++B)z.write_shift(-4,B+1);Le&&(++B,z.write_shift(-4,R))};for(oe=B=0,oe+=L[1];B<oe;++B)z.write_shift(-4,Ae.DIFSECT);for(oe+=L[2];B<oe;++B)z.write_shift(-4,Ae.FATSECT);fe(L[3]),fe(L[4]);for(var se=0,re=0,le=I.FileIndex[0];se<I.FileIndex.length;++se)le=I.FileIndex[se],le.content&&(re=le.content.length,!(re<4096)&&(le.start=oe,fe(re+511>>9)));for(fe(L[6]+7>>3);z.l&511;)z.write_shift(-4,Ae.ENDOFCHAIN);for(oe=B=0,se=0;se<I.FileIndex.length;++se)le=I.FileIndex[se],le.content&&(re=le.content.length,!(!re||re>=4096)&&(le.start=oe,fe(re+63>>6)));for(;z.l&511;)z.write_shift(-4,Ae.ENDOFCHAIN);for(B=0;B<L[4]<<2;++B){var pe=I.FullPaths[B];if(!pe||pe.length===0){for(se=0;se<17;++se)z.write_shift(4,0);for(se=0;se<3;++se)z.write_shift(4,-1);for(se=0;se<12;++se)z.write_shift(4,0);continue}le=I.FileIndex[B],B===0&&(le.start=le.size?le.start-1:R);var Oe=B===0&&M.root||le.name;if(re=2*(Oe.length+1),z.write_shift(64,Oe,"utf16le"),z.write_shift(2,re),z.write_shift(1,le.type),z.write_shift(1,le.color),z.write_shift(-4,le.L),z.write_shift(-4,le.R),z.write_shift(-4,le.C),le.clsid)z.write_shift(16,le.clsid,"hex");else for(se=0;se<4;++se)z.write_shift(4,0);z.write_shift(4,le.state||0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,le.start),z.write_shift(4,le.size),z.write_shift(4,0)}for(B=1;B<I.FileIndex.length;++B)if(le=I.FileIndex[B],le.size>=4096)if(z.l=le.start+1<<9,Et&&Buffer.isBuffer(le.content))le.content.copy(z,z.l,0,le.size),z.l+=le.size+511&-512;else{for(se=0;se<le.size;++se)z.write_shift(1,le.content[se]);for(;se&511;++se)z.write_shift(1,0)}for(B=1;B<I.FileIndex.length;++B)if(le=I.FileIndex[B],le.size>0&&le.size<4096)if(Et&&Buffer.isBuffer(le.content))le.content.copy(z,z.l,0,le.size),z.l+=le.size+63&-64;else{for(se=0;se<le.size;++se)z.write_shift(1,le.content[se]);for(;se&63;++se)z.write_shift(1,0)}if(Et)z.l=z.length;else for(;z.l<z.length;)z.write_shift(1,0);return z}function N(I,V){var M=I.FullPaths.map(function(se){return se.toUpperCase()}),L=M.map(function(se){var re=se.split("/");return re[re.length-(se.slice(-1)=="/"?2:1)]}),z=!1;V.charCodeAt(0)===47?(z=!0,V=M[0].slice(0,-1)+V):z=V.indexOf("/")!==-1;var B=V.toUpperCase(),oe=z===!0?M.indexOf(B):L.indexOf(B);if(oe!==-1)return I.FileIndex[oe];var fe=!B.match(sf);for(B=B.replace(mi,""),fe&&(B=B.replace(sf,"!")),oe=0;oe<M.length;++oe)if((fe?M[oe].replace(sf,"!"):M[oe]).replace(mi,"")==B||(fe?L[oe].replace(sf,"!"):L[oe]).replace(mi,"")==B)return I.FileIndex[oe];return null}var D=64,R=-2,He="d0cf11e0a1b11ae1",ve=[208,207,17,224,161,177,26,225],Re="00000000000000000000000000000000",Ae={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:R,FREESECT:-1,HEADER_SIGNATURE:He,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Re,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function _e(I,V,M){c();var L=b(I,M);l.writeFileSync(V,L)}function Z(I){for(var V=new Array(I.length),M=0;M<I.length;++M)V[M]=String.fromCharCode(I[M]);return V.join("")}function Ce(I,V){var M=b(I,V);switch(V&&V.type||"buffer"){case"file":return c(),l.writeFileSync(V.filename,M),M;case"binary":return typeof M=="string"?M:Z(M);case"base64":return Qf(typeof M=="string"?M:Z(M));case"buffer":if(Et)return Buffer.isBuffer(M)?M:Ga(M);case"array":return typeof M=="string"?Bi(M):M}return M}var Be;function U(I){try{var V=I.InflateRaw,M=new V;if(M._processChunk(new Uint8Array([3,0]),M._finishFlushFlag),M.bytesRead)Be=I;else throw new Error("zlib does not expose bytesRead")}catch(L){console.error("cannot use native zlib: "+(L.message||L))}}function H(I,V){if(!Be)return Sr(I,V);var M=Be.InflateRaw,L=new M,z=L._processChunk(I.slice(I.l),L._finishFlushFlag);return I.l+=L.bytesRead,z}function Q(I){return Be?Be.deflateRawSync(I):ut(I)}var X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],he=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Te=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Pe(I){var V=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(V>>16|V>>8|V)&255}for(var ke=typeof Uint8Array<"u",we=ke?new Uint8Array(256):[],nt=0;nt<256;++nt)we[nt]=Pe(nt);function G(I,V){var M=we[I&255];return V<=8?M>>>8-V:(M=M<<8|we[I>>8&255],V<=16?M>>>16-V:(M=M<<8|we[I>>16&255],M>>>24-V))}function Ct(I,V){var M=V&7,L=V>>>3;return(I[L]|(M<=6?0:I[L+1]<<8))>>>M&3}function xt(I,V){var M=V&7,L=V>>>3;return(I[L]|(M<=5?0:I[L+1]<<8))>>>M&7}function Rt(I,V){var M=V&7,L=V>>>3;return(I[L]|(M<=4?0:I[L+1]<<8))>>>M&15}function pt(I,V){var M=V&7,L=V>>>3;return(I[L]|(M<=3?0:I[L+1]<<8))>>>M&31}function $e(I,V){var M=V&7,L=V>>>3;return(I[L]|(M<=1?0:I[L+1]<<8))>>>M&127}function qt(I,V,M){var L=V&7,z=V>>>3,B=(1<<M)-1,oe=I[z]>>>L;return M<8-L||(oe|=I[z+1]<<8-L,M<16-L)||(oe|=I[z+2]<<16-L,M<24-L)||(oe|=I[z+3]<<24-L),oe&B}function wn(I,V,M){var L=V&7,z=V>>>3;return L<=5?I[z]|=(M&7)<<L:(I[z]|=M<<L&255,I[z+1]=(M&7)>>8-L),V+3}function hn(I,V,M){var L=V&7,z=V>>>3;return M=(M&1)<<L,I[z]|=M,V+1}function vi(I,V,M){var L=V&7,z=V>>>3;return M<<=L,I[z]|=M&255,M>>>=8,I[z+1]=M,V+8}function Ki(I,V,M){var L=V&7,z=V>>>3;return M<<=L,I[z]|=M&255,M>>>=8,I[z+1]=M&255,I[z+2]=M>>>8,V+16}function yi(I,V){var M=I.length,L=2*M>V?2*M:V+5,z=0;if(M>=V)return I;if(Et){var B=k_(L);if(I.copy)I.copy(B);else for(;z<I.length;++z)B[z]=I[z];return B}else if(ke){var oe=new Uint8Array(L);if(oe.set)oe.set(I);else for(;z<M;++z)oe[z]=I[z];return oe}return I.length=L,I}function Nr(I){for(var V=new Array(I),M=0;M<I;++M)V[M]=0;return V}function _i(I,V,M){var L=1,z=0,B=0,oe=0,fe=0,se=I.length,re=ke?new Uint16Array(32):Nr(32);for(B=0;B<32;++B)re[B]=0;for(B=se;B<M;++B)I[B]=0;se=I.length;var le=ke?new Uint16Array(se):Nr(se);for(B=0;B<se;++B)re[z=I[B]]++,L<z&&(L=z),le[B]=0;for(re[0]=0,B=1;B<=L;++B)re[B+16]=fe=fe+re[B-1]<<1;for(B=0;B<se;++B)fe=I[B],fe!=0&&(le[B]=re[fe+16]++);var pe=0;for(B=0;B<se;++B)if(pe=I[B],pe!=0)for(fe=G(le[B],L)>>L-pe,oe=(1<<L+4-pe)-1;oe>=0;--oe)V[fe|oe<<pe]=pe&15|B<<4;return L}var zt=ke?new Uint16Array(512):Nr(512),wr=ke?new Uint16Array(32):Nr(32);if(!ke){for(var Zt=0;Zt<512;++Zt)zt[Zt]=0;for(Zt=0;Zt<32;++Zt)wr[Zt]=0}(function(){for(var I=[],V=0;V<32;V++)I.push(5);_i(I,wr,32);var M=[];for(V=0;V<=143;V++)M.push(8);for(;V<=255;V++)M.push(9);for(;V<=279;V++)M.push(7);for(;V<=287;V++)M.push(8);_i(M,zt,288)})();var ni=function(){for(var V=ke?new Uint8Array(32768):[],M=0,L=0;M<Te.length-1;++M)for(;L<Te[M+1];++L)V[L]=M;for(;L<32768;++L)V[L]=29;var z=ke?new Uint8Array(259):[];for(M=0,L=0;M<he.length-1;++M)for(;L<he[M+1];++L)z[L]=M;function B(fe,se){for(var re=0;re<fe.length;){var le=Math.min(65535,fe.length-re),pe=re+le==fe.length;for(se.write_shift(1,+pe),se.write_shift(2,le),se.write_shift(2,~le&65535);le-- >0;)se[se.l++]=fe[re++]}return se.l}function oe(fe,se){for(var re=0,le=0,pe=ke?new Uint16Array(32768):[];le<fe.length;){var Oe=Math.min(65535,fe.length-le);if(Oe<10){for(re=wn(se,re,+(le+Oe==fe.length)),re&7&&(re+=8-(re&7)),se.l=re/8|0,se.write_shift(2,Oe),se.write_shift(2,~Oe&65535);Oe-- >0;)se[se.l++]=fe[le++];re=se.l*8;continue}re=wn(se,re,+(le+Oe==fe.length)+2);for(var Le=0;Oe-- >0;){var be=fe[le];Le=(Le<<5^be)&32767;var ze=-1,tt=0;if((ze=pe[Le])&&(ze|=le&-32768,ze>le&&(ze-=32768),ze<le))for(;fe[ze+tt]==fe[le+tt]&&tt<250;)++tt;if(tt>2){be=z[tt],be<=22?re=vi(se,re,we[be+1]>>1)-1:(vi(se,re,3),re+=5,vi(se,re,we[be-23]>>5),re+=3);var Mt=be<8?0:be-4>>2;Mt>0&&(Ki(se,re,tt-he[be]),re+=Mt),be=V[le-ze],re=vi(se,re,we[be]>>3),re-=3;var Nt=be<4?0:be-2>>1;Nt>0&&(Ki(se,re,le-ze-Te[be]),re+=Nt);for(var Ft=0;Ft<tt;++Ft)pe[Le]=le&32767,Le=(Le<<5^fe[le])&32767,++le;Oe-=tt-1}else be<=143?be=be+48:re=hn(se,re,1),re=vi(se,re,we[be]),pe[Le]=le&32767,++le}re=vi(se,re,0)-1}return se.l=(re+7)/8|0,se.l}return function(se,re){return se.length<8?B(se,re):oe(se,re)}}();function ut(I){var V=me(50+Math.floor(I.length*1.1)),M=ni(I,V);return V.slice(0,M)}var sr=ke?new Uint16Array(32768):Nr(32768),Tr=ke?new Uint16Array(32768):Nr(32768),gr=ke?new Uint16Array(128):Nr(128),ii=1,qa=1;function ua(I,V){var M=pt(I,V)+257;V+=5;var L=pt(I,V)+1;V+=5;var z=Rt(I,V)+4;V+=4;for(var B=0,oe=ke?new Uint8Array(19):Nr(19),fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],se=1,re=ke?new Uint8Array(8):Nr(8),le=ke?new Uint8Array(8):Nr(8),pe=oe.length,Oe=0;Oe<z;++Oe)oe[X[Oe]]=B=xt(I,V),se<B&&(se=B),re[B]++,V+=3;var Le=0;for(re[0]=0,Oe=1;Oe<=se;++Oe)le[Oe]=Le=Le+re[Oe-1]<<1;for(Oe=0;Oe<pe;++Oe)(Le=oe[Oe])!=0&&(fe[Oe]=le[Le]++);var be=0;for(Oe=0;Oe<pe;++Oe)if(be=oe[Oe],be!=0){Le=we[fe[Oe]]>>8-be;for(var ze=(1<<7-be)-1;ze>=0;--ze)gr[Le|ze<<be]=be&7|Oe<<3}var tt=[];for(se=1;tt.length<M+L;)switch(Le=gr[$e(I,V)],V+=Le&7,Le>>>=3){case 16:for(B=3+Ct(I,V),V+=2,Le=tt[tt.length-1];B-- >0;)tt.push(Le);break;case 17:for(B=3+xt(I,V),V+=3;B-- >0;)tt.push(0);break;case 18:for(B=11+$e(I,V),V+=7;B-- >0;)tt.push(0);break;default:tt.push(Le),se<Le&&(se=Le);break}var Mt=tt.slice(0,M),Nt=tt.slice(M);for(Oe=M;Oe<286;++Oe)Mt[Oe]=0;for(Oe=L;Oe<30;++Oe)Nt[Oe]=0;return ii=_i(Mt,sr,286),qa=_i(Nt,Tr,30),V}function ae(I,V){if(I[0]==3&&!(I[1]&3))return[Uo(V),2];for(var M=0,L=0,z=k_(V||1<<18),B=0,oe=z.length>>>0,fe=0,se=0;!(L&1);){if(L=xt(I,M),M+=3,L>>>1)L>>1==1?(fe=9,se=5):(M=ua(I,M),fe=ii,se=qa);else{M&7&&(M+=8-(M&7));var re=I[M>>>3]|I[(M>>>3)+1]<<8;if(M+=32,re>0)for(!V&&oe<B+re&&(z=yi(z,B+re),oe=z.length);re-- >0;)z[B++]=I[M>>>3],M+=8;continue}for(;;){!V&&oe<B+32767&&(z=yi(z,B+32767),oe=z.length);var le=qt(I,M,fe),pe=L>>>1==1?zt[le]:sr[le];if(M+=pe&15,pe>>>=4,!(pe>>>8&255))z[B++]=pe;else{if(pe==256)break;pe-=257;var Oe=pe<8?0:pe-4>>2;Oe>5&&(Oe=0);var Le=B+he[pe];Oe>0&&(Le+=qt(I,M,Oe),M+=Oe),le=qt(I,M,se),pe=L>>>1==1?wr[le]:Tr[le],M+=pe&15,pe>>>=4;var be=pe<4?0:pe-2>>1,ze=Te[pe];for(be>0&&(ze+=qt(I,M,be),M+=be),!V&&oe<Le&&(z=yi(z,Le+100),oe=z.length);B<Le;)z[B]=z[B-ze],++B}}}return V?[z,M+7>>>3]:[z.slice(0,B),M+7>>>3]}function Sr(I,V){var M=I.slice(I.l||0),L=ae(M,V);return I.l+=L[1],L[0]}function ds(I,V){if(I)typeof console<"u"&&console.error(V);else throw new Error(V)}function Qa(I,V){var M=I;Fn(M,0);var L=[],z=[],B={FileIndex:L,FullPaths:z};w(B,{root:V.root});for(var oe=M.length-4;(M[oe]!=80||M[oe+1]!=75||M[oe+2]!=5||M[oe+3]!=6)&&oe>=0;)--oe;M.l=oe+4,M.l+=4;var fe=M.read_shift(2);M.l+=6;var se=M.read_shift(4);for(M.l=se,oe=0;oe<fe;++oe){M.l+=20;var re=M.read_shift(4),le=M.read_shift(4),pe=M.read_shift(2),Oe=M.read_shift(2),Le=M.read_shift(2);M.l+=8;var be=M.read_shift(4),ze=o(M.slice(M.l+pe,M.l+pe+Oe));M.l+=pe+Oe+Le;var tt=M.l;M.l=be+4,Xi(M,re,le,B,ze),M.l=tt}return B}function Xi(I,V,M,L,z){I.l+=2;var B=I.read_shift(2),oe=I.read_shift(2),fe=a(I);if(B&8257)throw new Error("Unsupported ZIP encryption");for(var se=I.read_shift(4),re=I.read_shift(4),le=I.read_shift(4),pe=I.read_shift(2),Oe=I.read_shift(2),Le="",be=0;be<pe;++be)Le+=String.fromCharCode(I[I.l++]);if(Oe){var ze=o(I.slice(I.l,I.l+Oe));(ze[21589]||{}).mt&&(fe=ze[21589].mt),((z||{})[21589]||{}).mt&&(fe=z[21589].mt)}I.l+=Oe;var tt=I.slice(I.l,I.l+re);switch(oe){case 8:tt=H(I,le);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+oe)}var Mt=!1;B&8&&(se=I.read_shift(4),se==134695760&&(se=I.read_shift(4),Mt=!0),re=I.read_shift(4),le=I.read_shift(4)),re!=V&&ds(Mt,"Bad compressed size: "+V+" != "+re),le!=M&&ds(Mt,"Bad uncompressed size: "+M+" != "+le),Ln(L,Le,tt,{unsafe:!0,mt:fe})}function fa(I,V){var M=V||{},L=[],z=[],B=me(1),oe=M.compression?8:0,fe=0,se=0,re=0,le=0,pe=0,Oe=I.FullPaths[0],Le=Oe,be=I.FileIndex[0],ze=[],tt=0;for(se=1;se<I.FullPaths.length;++se)if(Le=I.FullPaths[se].slice(Oe.length),be=I.FileIndex[se],!(!be.size||!be.content||Le=="Sh33tJ5")){var Mt=le,Nt=me(Le.length);for(re=0;re<Le.length;++re)Nt.write_shift(1,Le.charCodeAt(re)&127);Nt=Nt.slice(0,Nt.l),ze[pe]=hR.buf(be.content,0);var Ft=be.content;oe==8&&(Ft=Q(Ft)),B=me(30),B.write_shift(4,67324752),B.write_shift(2,20),B.write_shift(2,fe),B.write_shift(2,oe),be.mt?s(B,be.mt):B.write_shift(4,0),B.write_shift(-4,ze[pe]),B.write_shift(4,Ft.length),B.write_shift(4,be.content.length),B.write_shift(2,Nt.length),B.write_shift(2,0),le+=B.length,L.push(B),le+=Nt.length,L.push(Nt),le+=Ft.length,L.push(Ft),B=me(46),B.write_shift(4,33639248),B.write_shift(2,0),B.write_shift(2,20),B.write_shift(2,fe),B.write_shift(2,oe),B.write_shift(4,0),B.write_shift(-4,ze[pe]),B.write_shift(4,Ft.length),B.write_shift(4,be.content.length),B.write_shift(2,Nt.length),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(4,0),B.write_shift(4,Mt),tt+=B.l,z.push(B),tt+=Nt.length,z.push(Nt),++pe}return B=me(22),B.write_shift(4,101010256),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,pe),B.write_shift(2,pe),B.write_shift(4,tt),B.write_shift(4,le),B.write_shift(2,0),yn([yn(L),yn(z),B])}var Ei={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function On(I,V){if(I.ctype)return I.ctype;var M=I.name||"",L=M.match(/\.([^\.]+)$/);return L&&Ei[L[1]]||V&&(L=(M=V).match(/[\.\\]([^\.\\])+$/),L&&Ei[L[1]])?Ei[L[1]]:"application/octet-stream"}function sn(I){for(var V=Qf(I),M=[],L=0;L<V.length;L+=76)M.push(V.slice(L,L+76));return M.join(`\r
`)+`\r
`}function da(I){var V=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(re){var le=re.charCodeAt(0).toString(16).toUpperCase();return"="+(le.length==1?"0"+le:le)});V=V.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),V.charAt(0)==`
`&&(V="=0D"+V.slice(1)),V=V.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var M=[],L=V.split(`\r
`),z=0;z<L.length;++z){var B=L[z];if(B.length==0){M.push("");continue}for(var oe=0;oe<B.length;){var fe=76,se=B.slice(oe,oe+fe);se.charAt(fe-1)=="="?fe--:se.charAt(fe-2)=="="?fe-=2:se.charAt(fe-3)=="="&&(fe-=3),se=B.slice(oe,oe+fe),oe+=fe,oe<B.length&&(se+="="),M.push(se)}}return M.join(`\r
`)}function ha(I){for(var V=[],M=0;M<I.length;++M){for(var L=I[M];M<=I.length&&L.charAt(L.length-1)=="=";)L=L.slice(0,L.length-1)+I[++M];V.push(L)}for(var z=0;z<V.length;++z)V[z]=V[z].replace(/[=][0-9A-Fa-f]{2}/g,function(B){return String.fromCharCode(parseInt(B.slice(1),16))});return Bi(V.join(`\r
`))}function pa(I,V,M){for(var L="",z="",B="",oe,fe=0;fe<10;++fe){var se=V[fe];if(!se||se.match(/^\s*$/))break;var re=se.match(/^(.*?):\s*([^\s].*)$/);if(re)switch(re[1].toLowerCase()){case"content-location":L=re[2].trim();break;case"content-type":B=re[2].trim();break;case"content-transfer-encoding":z=re[2].trim();break}}switch(++fe,z.toLowerCase()){case"base64":oe=Bi(Hi(V.slice(fe).join("")));break;case"quoted-printable":oe=ha(V.slice(fe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+z)}var le=Ln(I,L.slice(M.length),oe,{unsafe:!0});B&&(le.ctype=B)}function Mn(I,V){if(Z(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var M=V&&V.root||"",L=(Et&&Buffer.isBuffer(I)?I.toString("binary"):Z(I)).split(`\r
`),z=0,B="";for(z=0;z<L.length;++z)if(B=L[z],!!/^Content-Location:/i.test(B)&&(B=B.slice(B.indexOf("file")),M||(M=B.slice(0,B.lastIndexOf("/")+1)),B.slice(0,M.length)!=M))for(;M.length>0&&(M=M.slice(0,M.length-1),M=M.slice(0,M.lastIndexOf("/")+1),B.slice(0,M.length)!=M););var oe=(L[1]||"").match(/boundary="(.*?)"/);if(!oe)throw new Error("MAD cannot find boundary");var fe="--"+(oe[1]||""),se=[],re=[],le={FileIndex:se,FullPaths:re};w(le);var pe,Oe=0;for(z=0;z<L.length;++z){var Le=L[z];Le!==fe&&Le!==fe+"--"||(Oe++&&pa(le,L.slice(pe,z),M),pe=z)}return le}function Kr(I,V){var M=V||{},L=M.boundary||"SheetJS";L="------="+L;for(var z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+L.slice(2)+'"',"","",""],B=I.FullPaths[0],oe=B,fe=I.FileIndex[0],se=1;se<I.FullPaths.length;++se)if(oe=I.FullPaths[se].slice(B.length),fe=I.FileIndex[se],!(!fe.size||!fe.content||oe=="Sh33tJ5")){oe=oe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(tt){return"_x"+tt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(tt){return"_u"+tt.charCodeAt(0).toString(16)+"_"});for(var re=fe.content,le=Et&&Buffer.isBuffer(re)?re.toString("binary"):Z(re),pe=0,Oe=Math.min(1024,le.length),Le=0,be=0;be<=Oe;++be)(Le=le.charCodeAt(be))>=32&&Le<128&&++pe;var ze=pe>=Oe*4/5;z.push(L),z.push("Content-Location: "+(M.root||"file:///C:/SheetJS/")+oe),z.push("Content-Transfer-Encoding: "+(ze?"quoted-printable":"base64")),z.push("Content-Type: "+On(fe,oe)),z.push(""),z.push(ze?da(le):sn(le))}return z.push(L+`--\r
`),z.join(`\r
`)}function rr(I){var V={};return w(V,I),V}function Ln(I,V,M,L){var z=L&&L.unsafe;z||w(I);var B=!z&&et.find(I,V);if(!B){var oe=I.FullPaths[0];V.slice(0,oe.length)==oe?oe=V:(oe.slice(-1)!="/"&&(oe+="/"),oe=(oe+V).replace("//","/")),B={name:i(V),type:2},I.FileIndex.push(B),I.FullPaths.push(oe),z||et.utils.cfb_gc(I)}return B.content=M,B.size=M?M.length:0,L&&(L.CLSID&&(B.clsid=L.CLSID),L.mt&&(B.mt=L.mt),L.ct&&(B.ct=L.ct)),B}function Bn(I,V){w(I);var M=et.find(I,V);if(M){for(var L=0;L<I.FileIndex.length;++L)if(I.FileIndex[L]==M)return I.FileIndex.splice(L,1),I.FullPaths.splice(L,1),!0}return!1}function hs(I,V,M){w(I);var L=et.find(I,V);if(L){for(var z=0;z<I.FileIndex.length;++z)if(I.FileIndex[z]==L)return I.FileIndex[z].name=i(M),I.FullPaths[z]=M,!0}return!1}function Iu(I){S(I,!0)}return e.find=N,e.read=j,e.parse=d,e.write=Ce,e.writeFile=_e,e.utils={cfb_new:rr,cfb_add:Ln,cfb_del:Bn,cfb_mov:hs,cfb_gc:Iu,ReadShift:_f,CheckField:KS,prep_blob:Fn,bconcat:yn,use_zlib:U,_deflateRaw:ut,_inflateRaw:Sr,consts:Ae},e}();function pR(t){return typeof t=="string"?Fp(t):Array.isArray(t)?Vb(t):t}function Ad(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Fp(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Zs(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([pR(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=Qo(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function mR(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Ur(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function P_(t,e){for(var r=[],n=Ur(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function bp(t){for(var e=[],r=Ur(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Rp(t){for(var e=[],r=Ur(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function gR(t){for(var e=[],r=Ur(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Vh=new Date(1899,11,30,0,0,0);function dn(t,e){var r=t.getTime(),n=Vh.getTime()+(t.getTimezoneOffset()-Vh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var kS=new Date,xR=Vh.getTime()+(kS.getTimezoneOffset()-Vh.getTimezoneOffset())*6e4,O_=kS.getTimezoneOffset();function Np(t){var e=new Date;return e.setTime(t*24*60*60*1e3+xR),e.getTimezoneOffset()!==O_&&e.setTime(e.getTime()+(e.getTimezoneOffset()-O_)*6e4),e}function vR(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[s],10)}return e}var M_=new Date("2017-02-19T19:06:09.000Z"),CS=isNaN(M_.getFullYear())?new Date("2/19/17"):M_,yR=CS.getFullYear()==2017;function pr(t,e){var r=new Date(t);if(yR)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(CS.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Dl(t,e){if(Et&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Zs(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Zs(pS(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Zs(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Zs(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function mr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=mr(t[r]));return e}function Br(t,e){for(var r="";r.length<e;)r+=t;return r}function Ms(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var _R=["january","february","march","april","may","june","july","august","september","october","november","december"];function iu(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&_R.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var ER=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function FS(t){return t?t.content&&t.type?Dl(t.content,!0):t.data?nf(t.data):t.asNodeBuffer&&Et?nf(t.asNodeBuffer().toString("binary")):t.asBinary?nf(t.asBinary()):t._data&&t._data.getContent?nf(Dl(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function IS(t){if(!t)return null;if(t.data)return S_(t.data);if(t.asNodeBuffer&&Et)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?S_(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function wR(t){return t&&t.name.slice(-4)===".bin"?IS(t):FS(t)}function es(t,e){for(var r=t.FullPaths||Ur(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function R1(t,e){var r=es(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function tn(t,e,r){if(!r)return wR(R1(t,e));if(!e)return null;try{return tn(t,e)}catch{return null}}function ji(t,e,r){if(!r)return FS(R1(t,e));if(!e)return null;try{return ji(t,e)}catch{return null}}function TR(t,e,r){return IS(R1(t,e))}function L_(t){for(var e=t.FullPaths||Ur(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function _t(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Et?n=Ga(r):n=Ub(r),et.utils.cfb_add(t,e,n)}et.utils.cfb_add(t,e,r)}else t.file(e,r)}function N1(){return et.utils.cfb_new()}function bS(t,e){switch(e.type){case"base64":return et.read(t,{type:"base64"});case"binary":return et.read(t,{type:"binary"});case"buffer":case"array":return et.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function af(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var Gr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,SR=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,B_=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,AR=/<[^>]*>/g,ri=Gr.match(B_)?B_:AR,kR=/<\w*:/,CR=/<(\/?)\w+:/;function ct(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var a=t.match(SR),o=0,l="",c=0,d="",h="",p=1;if(a)for(c=0;c!=a.length;++c){for(h=a[c],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(d=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(p=(i=h.charCodeAt(s+1))==34||i==39?1:0,l=h.slice(s+1+p,h.length-p),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=l,n[d.toLowerCase()]=l;else{var g=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[g]&&d.slice(o-3,o)=="ext")continue;n[g]=l,n[g.toLowerCase()]=l}}return n}function la(t){return t.replace(CR,"<$1")}var RS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},D1=bp(RS),Pt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(o,l){return RS[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),P1=/[&<>'"]/g,FR=/[\u0000-\u0008\u000b-\u001f]/g;function Kt(t){var e=t+"";return e.replace(P1,function(r){return D1[r]}).replace(FR,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function j_(t){return Kt(t).replace(/ /g,"_x0020_")}var NS=/[\u0000-\u001f]/g;function O1(t){var e=t+"";return e.replace(P1,function(r){return D1[r]}).replace(/\n/g,"<br/>").replace(NS,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function IR(t){var e=t+"";return e.replace(P1,function(r){return D1[r]}).replace(NS,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var V_=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function bR(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function dr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function km(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function U_(t){var e=Uo(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function z_(t){return Ga(t,"binary").toString("utf8")}var S0="foo bar baz",Jt=Et&&(z_(S0)==km(S0)&&z_||U_(S0)==km(S0)&&U_)||km,Zs=Et?function(t){return Ga(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Zf=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),DS=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),RR=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),NR=/<\/?(?:vt:)?variant>/g,DR=/<(?:vt:)([^>]*)>([\s\S]*)</;function W_(t,e){var r=ct(t),n=t.match(RR(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(NR,"").match(DR);a&&i.push({v:Jt(a[2]),t:a[1]})}),i}var PS=/(^\s|\s$|\n)/;function In(t,e){return"<"+t+(e.match(PS)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function ed(t){return Ur(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function je(t,e,r){return"<"+t+(r!=null?ed(r):"")+(e!=null?(e.match(PS)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Qg(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function PR(t,e){switch(typeof t){case"string":var r=je("vt:lpwstr",Kt(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return je((t|0)==t?"vt:i4":"vt:r8",Kt(String(t)));case"boolean":return je("vt:bool",t?"true":"false")}if(t instanceof Date)return je("vt:filetime",Qg(t));throw new Error("Unable to serialize "+t)}function M1(t){if(Et&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Jt(Qo(F1(t)));throw new Error("Bad input format: expected Buffer or string")}var td=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,ln={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},$l=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Mi={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function OR(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function MR(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var H_=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},$_=Et?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Ga(e)})):H_(t)}:H_,G_=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(ka(t,i)));return n.join("").replace(mi,"")},L1=Et?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(mi,""):G_(t,e,r)}:G_,K_=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},OS=Et?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):K_(t,e,r)}:K_,X_=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(vc(t,i)));return n.join("")},kd=Et?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):X_(e,r,n)}:X_,MS=function(t,e){var r=Li(t,e);return r>0?kd(t,e+4,e+4+r-1):""},LS=MS,BS=function(t,e){var r=Li(t,e);return r>0?kd(t,e+4,e+4+r-1):""},jS=BS,VS=function(t,e){var r=2*Li(t,e);return r>0?kd(t,e+4,e+4+r-1):""},US=VS,zS=function(e,r){var n=Li(e,r);return n>0?L1(e,r+4,r+4+n):""},WS=zS,HS=function(t,e){var r=Li(t,e);return r>0?kd(t,e+4,e+4+r):""},$S=HS,GS=function(t,e){return OR(t,e)},Uh=GS,B1=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Et&&(LS=function(e,r){if(!Buffer.isBuffer(e))return MS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},jS=function(e,r){if(!Buffer.isBuffer(e))return BS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},US=function(e,r){if(!Buffer.isBuffer(e))return VS(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},WS=function(e,r){if(!Buffer.isBuffer(e))return zS(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},$S=function(e,r){if(!Buffer.isBuffer(e))return HS(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Uh=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):GS(e,r)},B1=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var vc=function(t,e){return t[e]},ka=function(t,e){return t[e+1]*256+t[e]},LR=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Li=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},hl=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},BR=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function _f(t,e){var r="",n,i,s=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,Et&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(ka(this,c)),c+=2;t*=2;break;case"utf8":r=kd(this,this.l,this.l+t);break;case"utf16le":t*=2,r=L1(this,this.l,this.l+t);break;case"wstr":return _f.call(this,t,"dbcs");case"lpstr-ansi":r=LS(this,this.l),t=4+Li(this,this.l);break;case"lpstr-cp":r=jS(this,this.l),t=4+Li(this,this.l);break;case"lpwstr":r=US(this,this.l),t=4+2*Li(this,this.l);break;case"lpp4":t=4+Li(this,this.l),r=WS(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Li(this,this.l),r=$S(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=vc(this,this.l+t++))!==0;)s.push(T0(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=ka(this,this.l+t))!==0;)s.push(T0(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=vc(this,c),this.l=c+1,o=_f.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(T0(ka(this,c))),c+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=vc(this,c),this.l=c+1,o=_f.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(T0(vc(this,c))),c+=1}r=s.join("");break;default:switch(t){case 1:return n=vc(this,this.l),this.l++,n;case 2:return n=(e==="i"?LR:ka)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?hl:BR)(this,this.l),this.l+=4,n):(i=Li(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=Uh(this,this.l):i=Uh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=OS(this,this.l,t);break}}return this.l+=t,r}var jR=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},VR=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},UR=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function zR(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)UR(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,jR(this,e,this.l);break;case 8:if(n=8,r==="f"){MR(this,e,this.l);break}case 16:break;case-4:n=4,VR(this,e,this.l);break}return this.l+=n,this}function KS(t,e){var r=OS(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Fn(t,e){t.l=e,t.read_shift=_f,t.chk=KS,t.write_shift=zR}function ei(t,e){t.l+=e}function me(t){var e=Uo(t);return Fn(e,0),e}function Ka(t,e,r){if(t){var n,i,s;Fn(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=od[o]||od[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;l=t.l+s;var d=c.f&&c.f(t,s,r);if(t.l=l,e(d,c,o))return}}}function bi(){var t=[],e=Et?256:2048,r=function(c){var d=me(c);return Fn(d,0),d},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,e)))},a=function(){return i(),yn(t)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function Ee(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=od[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&B1(r)&&t.push(r)}}function Ef(t,e,r){var n=mr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Y_(t,e,r){var n=mr(t);return n.s=Ef(n.s,e.s,r),n.e=Ef(n.e,e.s,r),n}function wf(t,e){if(t.cRel&&t.c<0)for(t=mr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=mr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=ot(t);return!t.cRel&&t.cRel!=null&&(r=$R(r)),!t.rRel&&t.rRel!=null&&(r=WR(r)),r}function Cm(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Cr(t.s.c)+":"+(t.e.cRel?"":"$")+Cr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+$r(t.s.r)+":"+(t.e.rRel?"":"$")+$r(t.e.r):wf(t.s,e.biff)+":"+wf(t.e,e.biff)}function j1(t){return parseInt(HR(t),10)-1}function $r(t){return""+(t+1)}function WR(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function HR(t){return t.replace(/\$(\d+)$/,"$1")}function V1(t){for(var e=GR(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Cr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function $R(t){return t.replace(/^([A-Z])/,"$$$1")}function GR(t){return t.replace(/^\$([A-Z])/,"$1")}function KR(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Fr(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function ot(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Ri(t){var e=t.indexOf(":");return e==-1?{s:Fr(t),e:Fr(t)}:{s:Fr(t.slice(0,e)),e:Fr(t.slice(e+1))}}function yt(t,e){return typeof e>"u"||typeof e=="number"?yt(t.s,t.e):(typeof t!="string"&&(t=ot(t)),typeof e!="string"&&(e=ot(e)),t==e?t:t+":"+e)}function Ot(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function q_(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=us(t.z,r?dn(e):e)}catch{}try{return t.w=us((t.XF||{}).numFmtId||(r?14:0),r?dn(e):e)}catch{return""+e}}function ja(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Xa[t.v]||t.v:e==null?q_(t,t.v):q_(t,e))}function Jo(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function XS(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Fr(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=Ot(s["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),a==-1&&(c.e.r=a=d.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=e[h].length;++p)if(!(typeof e[h][p]>"u")){var g={v:e[h][p]},y=a+h,x=o+p;if(c.s.r>y&&(c.s.r=y),c.s.c>x&&(c.s.c=x),c.e.r<y&&(c.e.r=y),c.e.c<x&&(c.e.c=x),e[h][p]&&typeof e[h][p]=="object"&&!Array.isArray(e[h][p])&&!(e[h][p]instanceof Date))g=e[h][p];else if(Array.isArray(g.v)&&(g.f=e[h][p][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(n.nullError)g.t="e",g.v=0;else if(n.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=n.dateNF||st[14],n.cellDates?(g.t="d",g.w=us(g.z,dn(g.v))):(g.t="n",g.v=dn(g.v),g.w=us(g.z,g.v))):g.t="s";if(i)s[y]||(s[y]=[]),s[y][x]&&s[y][x].z&&(g.z=s[y][x].z),s[y][x]=g;else{var E=ot({c:x,r:y});s[E]&&s[E].z&&(g.z=s[E].z),s[E]=g}}}return c.s.c<1e7&&(s["!ref"]=yt(c)),s}function Eu(t,e){return XS(null,t,e)}function XR(t){return t.read_shift(4,"i")}function Ls(t,e){return e||(e=me(4)),e.write_shift(4,t),e}function Jn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function _n(t,e){var r=!1;return e==null&&(r=!0,e=me(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function YR(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function qR(t,e){return e||(e=me(4)),e.write_shift(2,0),e.write_shift(2,0),e}function U1(t,e){var r=t.l,n=t.read_shift(1),i=Jn(t),s=[],a={t:i,h:i};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)s.push(YR(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function QR(t,e){var r=!1;return e==null&&(r=!0,e=me(15+4*t.t.length)),e.write_shift(1,0),_n(t.t,e),r?e.slice(0,e.l):e}var JR=U1;function ZR(t,e){var r=!1;return e==null&&(r=!0,e=me(23+4*t.t.length)),e.write_shift(1,1),_n(t.t,e),e.write_shift(4,1),qR({},e),r?e.slice(0,e.l):e}function fs(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Gl(t,e){return e==null&&(e=me(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Kl(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Xl(t,e){return e==null&&(e=me(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var eN=Jn,YS=_n;function z1(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function zh(t,e){var r=!1;return e==null&&(r=!0,e=me(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var tN=Jn,Jg=z1,W1=zh;function H1(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?Uh([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):hl(e,0)>>2;return r?i/100:i}function qS(t,e){e==null&&(e=me(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function QS(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function rN(t,e){return e||(e=me(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Yl=QS,wu=rN;function Qn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Pl(t,e){return(e||me(8)).write_shift(8,t,"f")}function nN(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var c=El[i];c&&(e.rgb=nd(c));break;case 2:e.rgb=nd([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function Wh(t,e){if(e||(e=me(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function iN(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function sN(t,e){e||(e=me(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function JS(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function aN(t){return JS(t,1)}function oN(t){return JS(t,2)}var $1=2,Si=3,A0=11,Q_=12,Hh=19,k0=64,lN=65,cN=71,uN=4108,fN=4126,gn=80,ZS=81,dN=[gn,ZS],Zg={1:{n:"CodePage",t:$1},2:{n:"Category",t:gn},3:{n:"PresentationFormat",t:gn},4:{n:"ByteCount",t:Si},5:{n:"LineCount",t:Si},6:{n:"ParagraphCount",t:Si},7:{n:"SlideCount",t:Si},8:{n:"NoteCount",t:Si},9:{n:"HiddenCount",t:Si},10:{n:"MultimediaClipCount",t:Si},11:{n:"ScaleCrop",t:A0},12:{n:"HeadingPairs",t:uN},13:{n:"TitlesOfParts",t:fN},14:{n:"Manager",t:gn},15:{n:"Company",t:gn},16:{n:"LinksUpToDate",t:A0},17:{n:"CharacterCount",t:Si},19:{n:"SharedDoc",t:A0},22:{n:"HyperlinksChanged",t:A0},23:{n:"AppVersion",t:Si,p:"version"},24:{n:"DigSig",t:lN},26:{n:"ContentType",t:gn},27:{n:"ContentStatus",t:gn},28:{n:"Language",t:gn},29:{n:"Version",t:gn},255:{},2147483648:{n:"Locale",t:Hh},2147483651:{n:"Behavior",t:Hh},1919054434:{}},ex={1:{n:"CodePage",t:$1},2:{n:"Title",t:gn},3:{n:"Subject",t:gn},4:{n:"Author",t:gn},5:{n:"Keywords",t:gn},6:{n:"Comments",t:gn},7:{n:"Template",t:gn},8:{n:"LastAuthor",t:gn},9:{n:"RevNumber",t:gn},10:{n:"EditTime",t:k0},11:{n:"LastPrinted",t:k0},12:{n:"CreatedDate",t:k0},13:{n:"ModifiedDate",t:k0},14:{n:"PageCount",t:Si},15:{n:"WordCount",t:Si},16:{n:"CharCount",t:Si},17:{n:"Thumbnail",t:cN},18:{n:"Application",t:gn},19:{n:"DocSecurity",t:Si},255:{},2147483648:{n:"Locale",t:Hh},2147483651:{n:"Behavior",t:Hh},1919054434:{}},J_={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},hN=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function pN(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var mN=pN([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),El=mr(mN),Xa={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},eA={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},tx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},C0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function G1(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function gN(t){var e=G1();if(!t||!t.match)return e;var r={};if((t.match(ri)||[]).forEach(function(n){var i=ct(n);switch(i[0].replace(kR,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[tx[i.ContentType]]!==void 0&&e[tx[i.ContentType]].push(i.PartName);break}}),e.xmlns!==ln.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function tA(t,e){var r=gR(tx),n=[],i;n[n.length]=Gr,n[n.length]=je("Types",null,{xmlns:ln.CT,"xmlns:xsd":ln.xsd,"xmlns:xsi":ln.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return je("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],n[n.length]=je("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:C0[l][e.bookType]||C0[l].xlsx}))},a=function(l){(t[l]||[]).forEach(function(c){n[n.length]=je("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:C0[l][e.bookType]||C0[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(c){n[n.length]=je("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var wt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function rd(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Tf(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(ri)||[]).forEach(function(i){var s=ct(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:af(s.Target,e);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}function Hc(t){var e=[Gr,je("Relationships",null,{xmlns:ln.RELS})];return Ur(t["!id"]).forEach(function(r){e[e.length]=je("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Gt(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[wt.HLINK,wt.XPATH,wt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var xN="application/vnd.oasis.opendocument.spreadsheet";function vN(t,e){for(var r=M1(t),n,i;n=td.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=ct(n[0],!1),i.path=="/"&&i.type!==xN)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function yN(t){var e=[Gr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function Z_(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function _N(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function EN(t){var e=[Gr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(Z_(t[r][0],t[r][1])),e.push(_N("",t[r][0]));return e.push(Z_("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function rA(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Mh.version+"</meta:generator></office:meta></office:document-meta>"}var os=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],wN=function(){for(var t=new Array(os.length),e=0;e<os.length;++e){var r=os[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function nA(t){var e={};t=Jt(t);for(var r=0;r<os.length;++r){var n=os[r],i=t.match(wN[r]);i!=null&&i.length>0&&(e[n[1]]=Pt(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=pr(e[n[1]]))}return e}function Fm(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=Kt(e),n[n.length]=r?je(t,e,r):In(t,e))}function iA(t,e){var r=e||{},n=[Gr,je("cp:coreProperties",null,{"xmlns:cp":ln.CORE_PROPS,"xmlns:dc":ln.dc,"xmlns:dcterms":ln.dcterms,"xmlns:dcmitype":ln.dcmitype,"xmlns:xsi":ln.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&Fm("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Qg(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&Fm("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Qg(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=os.length;++s){var a=os[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Fm(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var wl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],sA=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function aA(t,e,r,n){var i=[];if(typeof t=="string")i=W_(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(d){return{v:d}}));var a=typeof e=="string"?W_(e,n).map(function(d){return d.v}):e,o=0,l=0;if(a.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function TN(t,e,r){var n={};return e||(e={}),t=Jt(t),wl.forEach(function(i){var s=(t.match(Zf(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=Pt(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&aA(n.HeadingPairs,n.TitlesOfParts,e,r),e}function oA(t){var e=[],r=je;return t||(t={}),t.Application="SheetJS",e[e.length]=Gr,e[e.length]=je("Properties",null,{xmlns:ln.EXT_PROPS,"xmlns:vt":ln.vt}),wl.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Kt(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Kt(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var SN=/<[^>]+>[^<]*/g;function AN(t,e){var r={},n="",i=t.match(SN);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=ct(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Pt(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),c=l[0].slice(4),d=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=Pt(d);break;case"bool":r[n]=dr(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=pr(d);break;case"cy":case"error":r[n]=Pt(d);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}function lA(t){var e=[Gr,je("Properties",null,{xmlns:ln.CUST_PROPS,"xmlns:vt":ln.vt})];if(!t)return e.join("");var r=1;return Ur(t).forEach(function(i){++r,e[e.length]=je("property",PR(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Kt(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var rx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Im;function kN(t,e,r){Im||(Im=bp(rx)),e=Im[e]||e,t[e]=r}function CN(t,e){var r=[];return Ur(rx).map(function(n){for(var i=0;i<os.length;++i)if(os[i][1]==n)return os[i];for(i=0;i<wl.length;++i)if(wl[i][1]==n)return wl[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(In(rx[n[1]]||n[1],i))}}),je("DocumentProperties",r.join(""),{xmlns:Mi.o})}function FN(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&Ur(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<os.length;++a)if(s==os[a][1])return;for(a=0;a<wl.length;++a)if(s==wl[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(je(j_(s),o,{"dt:dt":l}))}}),e&&Ur(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(je(j_(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Mi.o+'">'+i.join("")+"</"+n+">"}function K1(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function IN(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=me(8);return a.write_shift(4,n),a.write_shift(4,i),a}function cA(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function uA(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function fA(t,e,r){return e===31?uA(t):cA(t,e,r)}function nx(t,e,r){return fA(t,e,r===!1?0:4)}function bN(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return fA(t,e,0)}function RN(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(mi,""),t.l-i&2&&(t.l+=2)}return r}function NN(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(mi,"");return r}function DN(t){var e=t.l,r=$h(t,ZS);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=$h(t,Si);return[r,n]}function PN(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(DN(t));return r}function e2(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),a=t.read_shift(4);n[s]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(mi,"").replace(sf,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function dA(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function ON(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function $h(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==Q_&&n!==e&&dN.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===Q_?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return cA(t,n,4).replace(mi,"");case 31:return uA(t);case 64:return K1(t);case 65:return dA(t);case 71:return ON(t);case 80:return nx(t,n,!s.raw).replace(mi,"");case 81:return bN(t,n).replace(mi,"");case 4108:return PN(t);case 4126:case 4127:return n==4127?RN(t):NN(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function t2(t,e){var r=me(4),n=me(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=me(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=IN(e);break;case 31:case 80:for(n=me(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return yn([r,n])}function r2(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0,o=0,l=-1,c={};for(a=0;a!=i;++a){var d=t.read_shift(4),h=t.read_shift(4);s[a]=[d,h+r]}s.sort(function(A,_){return A[1]-_[1]});var p={};for(a=0;a!=i;++a){if(t.l!==s[a][1]){var g=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:t.l+2===s[a][1]&&(t.l+=2,g=!1);break;case 80:t.l<=s[a][1]&&(t.l=s[a][1],g=!1);break;case 4108:t.l<=s[a][1]&&(t.l=s[a][1],g=!1);break}if((!e||a==0)&&t.l<=s[a][1]&&(g=!1,t.l=s[a][1]),g)throw new Error("Read Error: Expected address "+s[a][1]+" at "+t.l+" :"+a)}if(e){var y=e[s[a][0]];if(p[y.n]=$h(t,y.t,{raw:!0}),y.p==="version"&&(p[y.n]=String(p[y.n]>>16)+"."+("0000"+String(p[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(p[y.n]){case 0:p[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Rs(o=p[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[y.n])}}else if(s[a][0]===1){if(o=p.CodePage=$h(t,$1),Rs(o),l!==-1){var x=t.l;t.l=s[l][1],c=e2(t,o),t.l=x}}else if(s[a][0]===0){if(o===0){l=a,t.l=s[a+1][1];continue}c=e2(t,o)}else{var E=c[s[a][0]],T;switch(t[t.l]){case 65:t.l+=4,T=dA(t);break;case 30:t.l+=4,T=nx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,T=nx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,T=t.read_shift(4,"i");break;case 19:t.l+=4,T=t.read_shift(4);break;case 5:t.l+=4,T=t.read_shift(8,"f");break;case 11:t.l+=4,T=zr(t,4);break;case 64:t.l+=4,T=pr(K1(t));break;default:throw new Error("unparsed value: "+t[t.l])}p[E]=T}}return t.l=r+n,p}var hA=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function MN(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function n2(t,e,r){var n=me(8),i=[],s=[],a=8,o=0,l=me(8),c=me(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),a+=8+l.length,!e){c=me(8),c.write_shift(4,0),i.unshift(c);var d=[me(4)];for(d[0].write_shift(4,t.length),o=0;o<t.length;++o){var h=t[o][0];for(l=me(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);d.push(l)}l=yn(d),s.unshift(l),a+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(hA.indexOf(t[o][0])>-1||sA.indexOf(t[o][0])>-1)&&t[o][1]!=null){var p=t[o][1],g=0;if(e){g=+e[t[o][0]];var y=r[g];if(y.p=="version"&&typeof p=="string"){var x=p.split(".");p=(+x[0]<<16)+(+x[1]||0)}l=t2(y.t,p)}else{var E=MN(p);E==-1&&(E=31,p=String(p)),l=t2(E,p)}s.push(l),c=me(8),c.write_shift(4,e?g:2+o),i.push(c),a+=8+l.length}var T=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,T),T+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),yn([n].concat(i).concat(s))}function i2(t,e,r){var n=t.content;if(!n)return{};Fn(n,0);var i,s,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),d=n.read_shift(16);if(d!==et.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),l=n.read_shift(4));var h=r2(n,e),p={SystemIdentifier:c};for(var g in h)p[g]=h[g];if(p.FMTID=s,i===1)return p;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var y;try{y=r2(n,null)}catch{}for(g in y)p[g]=y[g];return p.FMTID=[s,a],p}function s2(t,e,r,n,i,s){var a=me(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,et.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=n2(t,r,n);if(o.push(l),i){var c=n2(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(c)}return yn(o)}function co(t,e){return t.read_shift(e),null}function LN(t,e){e||(e=me(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function BN(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function zr(t,e){return t.read_shift(e)===1}function hi(t,e){return e||(e=me(2)),e.write_shift(2,+!!t),e}function rn(t){return t.read_shift(2,"u")}function ts(t,e){return e||(e=me(2)),e.write_shift(2,t),e}function pA(t,e){return BN(t,e,rn)}function jN(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function mA(t,e,r){return r||(r=me(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Cd(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return a}function VN(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,s=1+(r&1),a=0,o,l={};i&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",d=e===0?"":t.read_shift(e,c);return i&&(t.l+=4*a),n&&(t.l+=o),l.t=d,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function UN(t){var e=t.t||"",r=me(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=me(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return yn(i)}function Ol(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Fd(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Ol(t,n,r)}function ql(t,e,r){if(r.biff>5)return Fd(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function gA(t,e,r){return r||(r=me(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function zN(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function WN(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(mi,"");return n&&(t.l+=24),i}function HN(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(s>>1,"utf16le").replace(mi,"");return r+a}function $N(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return WN(t);case"0303000000000000c000000000000046":return HN(t);default:throw new Error("Unsupported Moniker "+r)}}function F0(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(mi,""):"";return r}function a2(t,e){e||(e=me(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function GN(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,a,o,l,c="",d,h;i&16&&(s=F0(t,r-t.l)),i&128&&(a=F0(t,r-t.l)),(i&257)===257&&(o=F0(t,r-t.l)),(i&257)===1&&(l=$N(t,r-t.l)),i&8&&(c=F0(t,r-t.l)),i&32&&(d=t.read_shift(16)),i&64&&(h=K1(t)),t.l=r;var p=a||o||l||"";p&&c&&(p+="#"+c),p||(p="#"+c),i&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var g={Target:p};return d&&(g.guid=d),h&&(g.time=h),s&&(g.Tooltip=s),g}function KN(t){var e=me(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),a2(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&a2(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function xA(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function vA(t,e){var r=xA(t);return r[3]=0,r}function ca(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Ml(t,e,r,n){return n||(n=me(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function XN(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function YN(t,e,r){return e===0?"":ql(t,e,r)}function qN(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function yA(t){var e=t.read_shift(2),r=H1(t);return[e,r]}function QN(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=Cd(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function Dp(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function _A(t,e){return e||(e=me(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function EA(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var JN=EA;function wA(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function ZN(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function e3(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Wn(t){t.l+=2,t.l+=t.read_shift(2)}var t3={0:Wn,4:Wn,5:Wn,6:Wn,7:e3,8:Wn,9:Wn,10:Wn,11:Wn,12:Wn,13:ZN,14:Wn,15:Wn,16:Wn,17:Wn,18:Wn,19:Wn,20:Wn,21:wA};function r3(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(t3[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function I0(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function X1(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=me(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function n3(t,e){return e===0||t.read_shift(2),1200}function i3(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=ql(t,0,r);return t.read_shift(e+n-t.l),i}function s3(t,e){var r=!e||e.biff==8,n=me(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function a3(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function o3(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=Cd(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function l3(t,e){var r=!e||e.biff>=8?2:1,n=me(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function c3(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0;a!=i&&t.l<r;++a)s.push(VN(t));return s.Count=n,s.Unique=i,s}function u3(t,e){var r=me(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=UN(t[i]);var s=yn([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function f3(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function d3(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function h3(t){var e=XN(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function p3(t){return t.read_shift(2),t.read_shift(4)}function o2(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function m3(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:c}}function g3(){var t=me(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function x3(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function v3(t){var e=me(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function y3(){}function _3(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Cd(t,0,r),n}function E3(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=me(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function w3(t){var e=ca(t);return e.isst=t.read_shift(4),e}function T3(t,e,r,n){var i=me(10);return Ml(t,e,n,i),i.write_shift(4,r),i}function S3(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=ca(t);r.biff==2&&t.l++;var s=Fd(t,n-t.l,r);return i.val=s,i}function A3(t,e,r,n,i){var s=!i||i.biff==8,a=me(8+ +s+(1+s)*r.length);return Ml(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function k3(t,e,r){var n=t.read_shift(2),i=ql(t,0,r);return[n,i]}function C3(t,e,r,n){var i=r&&r.biff==5;n||(n=me(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var F3=ql;function l2(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),a=t.read_shift(i),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:s,c:o},e:{r:a,c:l}}}function I3(t,e){var r=e.biff==8||!e.biff?4:2,n=me(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function b3(t){var e=t.read_shift(2),r=t.read_shift(2),n=yA(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function R3(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(yA(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function N3(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function D3(t,e,r,n){var i={},s=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return i.patternType=hN[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function P3(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=D3(t,e,n.fStyle,r),n}function c2(t,e,r,n){var i=r&&r.biff==5;n||(n=me(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function O3(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function M3(t){var e=me(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function u2(t,e,r){var n=ca(t);(r.biff==2||e==9)&&++t.l;var i=jN(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function L3(t,e,r,n,i,s){var a=me(8);return Ml(t,e,n,a),mA(r,s,a),a}function B3(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ca(t),i=Qn(t);return n.val=i,n}function j3(t,e,r,n){var i=me(14);return Ml(t,e,n,i),Pl(r,i),i}var f2=YN;function V3(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=Ol(t,s),o=[];n>t.l;)o.push(Fd(t));return[s,i,a,o]}function d2(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=QN(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var U3=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function h2(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=Ol(t,a,r);i&32&&(c=U3[c.charCodeAt(0)]);var d=n-t.l;r&&r.biff==2&&--d;var h=n==t.l||o===0||!(d>0)?[]:r5(t,d,r,o);return{chKey:s,Name:c,itab:l,rgce:h}}function TA(t,e,r){if(r.biff<8)return z3(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(qN(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function z3(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Cd(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function W3(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=Ol(t,n,r),a=Ol(t,i,r);return[s,a]}function H3(t,e,r){var n=EA(t);t.l++;var i=t.read_shift(1);return e-=8,[n5(t,e,r),i,n]}function p2(t,e,r){var n=JN(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,e5(t,e,r)]}function $3(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function G3(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=ql(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},o,a,s]}}function K3(t,e,r){return G3(t,e,r)}function X3(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Dp(t));return r}function Y3(t){var e=me(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)_A(t[r],e);return e}function q3(t,e,r){if(r&&r.biff<8)return J3(t,e,r);var n=wA(t),i=r3(t,e-22,n[1]);return{cmo:n,ft:i}}var Q3={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function J3(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((Q3[n]||ei)(t,e,r)),{cmo:[i,n,s],ft:a}}function Z3(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:a=zN(t,6,r);var o=t.read_shift(2);t.read_shift(2),rn(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var d=t[t.l],h=Ol(t,t.lens[c+1]-t.lens[c]-1);if(i+=h,i.length>=(d?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function eD(t,e){var r=Dp(t);t.l+=16;var n=GN(t,e-24);return[r,n]}function tD(t){var e=me(24),r=Fr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return yn([e,KN(t[1])])}function rD(t,e){t.read_shift(2);var r=Dp(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(mi,""),[r,n]}function nD(t){var e=t[1].Tooltip,r=me(10+2*(e.length+1));r.write_shift(2,2048);var n=Fr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function iD(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=J_[r]||r,r=t.read_shift(2),e[1]=J_[r]||r,e}function sD(t){return t||(t=me(4)),t.write_shift(2,1),t.write_shift(2,1),t}function aD(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(vA(t));return r}function oD(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(vA(t));return r}function lD(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function SA(t,e,r){if(!r.cellStyles)return ei(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function cD(t,e){var r=me(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function uD(t,e){var r={};return e<32||(t.l+=16,r.header=Qn(t),r.footer=Qn(t),t.l+=2),r}function fD(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}function dD(t){for(var e=me(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var hD=ca,pD=pA,mD=Fd;function gD(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function xD(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ca(t);++t.l;var i=ql(t,e-7,r);return n.t="str",n.val=i,n}function vD(t){var e=ca(t);++t.l;var r=Qn(t);return e.t="n",e.val=r,e}function yD(t,e,r){var n=me(15);return Nd(n,t,e),n.write_shift(8,r,"f"),n}function _D(t){var e=ca(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function ED(t,e,r){var n=me(9);return Nd(n,t,e),n.write_shift(2,r),n}function wD(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function TD(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function SD(t,e,r){var n=t.l+e,i=ca(t),s=t.read_shift(2),a=Ol(t,s,r);return t.l=n,i.t="str",i.val=a,i}var AD=[2,3,48,49,131,139,140,245],ix=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=bp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],d=Uo(1);switch(l.type){case"base64":d=Bi(Hi(o));break;case"binary":d=Bi(o);break;case"buffer":case"array":d=o;break}Fn(d,0);var h=d.read_shift(1),p=!!(h&136),g=!1,y=!1;switch(h){case 2:break;case 3:break;case 48:g=!0,p=!0;break;case 49:g=!0,p=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var x=0,E=521;h==2&&(x=d.read_shift(2)),d.l+=3,h!=2&&(x=d.read_shift(4)),x>1048576&&(x=1e6),h!=2&&(E=d.read_shift(2));var T=d.read_shift(2),A=l.codepage||1252;h!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(A=t[d[d.l]]),d.l+=1,d.l+=2),y&&(d.l+=36);for(var _=[],P={},W=Math.min(d.length,h==2?521:E-10-(g?264:0)),j=y?32:11;d.l<W&&d[d.l]!=13;)switch(P={},P.name=qf.utils.decode(A,d.slice(d.l,d.l+j)).replace(/[\u0000\r\n].*$/g,""),d.l+=j,P.type=String.fromCharCode(d.read_shift(1)),h!=2&&!y&&(P.offset=d.read_shift(4)),P.len=d.read_shift(1),h==2&&(P.offset=d.read_shift(2)),P.dec=d.read_shift(1),P.name.length&&_.push(P),h!=2&&(d.l+=y?13:14),P.type){case"B":(!g||P.len!=8)&&l.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+P.type)}if(d[d.l]!==13&&(d.l=E-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=E;var w=0,F=0;for(c[0]=[],F=0;F!=_.length;++F)c[0][F]=_[F].name;for(;x-- >0;){if(d[d.l]===42){d.l+=T;continue}for(++d.l,c[++w]=[],F=0,F=0;F!=_.length;++F){var S=d.slice(d.l,d.l+_[F].len);d.l+=_[F].len,Fn(S,0);var b=qf.utils.decode(A,S);switch(_[F].type){case"C":b.trim().length&&(c[w][F]=b.replace(/\s+$/,""));break;case"D":b.length===8?c[w][F]=new Date(+b.slice(0,4),+b.slice(4,6)-1,+b.slice(6,8)):c[w][F]=b;break;case"F":c[w][F]=parseFloat(b.trim());break;case"+":case"I":c[w][F]=y?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(b.trim().toUpperCase()){case"Y":case"T":c[w][F]=!0;break;case"N":case"F":c[w][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+b+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[w][F]="##MEMO##"+(y?parseInt(b.trim(),10):S.read_shift(4));break;case"N":b=b.replace(/\u0000/g,"").trim(),b&&b!="."&&(c[w][F]=+b||0);break;case"@":c[w][F]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":c[w][F]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":c[w][F]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[w][F]=-S.read_shift(-8,"f");break;case"B":if(g&&_[F].len==8){c[w][F]=S.read_shift(8,"f");break}case"G":case"P":S.l+=_[F].len;break;case"0":if(_[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[F].type)}}}if(h!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=_,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var d=Eu(r(o,c),c);return d["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,d}function i(o,l){try{return Jo(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&Rs(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var d=bi(),h=Xh(o,{header:1,raw:!0,cellDates:!0}),p=h[0],g=h.slice(1),y=o["!cols"]||[],x=0,E=0,T=0,A=1;for(x=0;x<p.length;++x){if(((y[x]||{}).DBF||{}).name){p[x]=y[x].DBF.name,++T;continue}if(p[x]!=null){if(++T,typeof p[x]=="number"&&(p[x]=p[x].toString(10)),typeof p[x]!="string")throw new Error("DBF Invalid column name "+p[x]+" |"+typeof p[x]+"|");if(p.indexOf(p[x])!==x){for(E=0;E<1024;++E)if(p.indexOf(p[x]+"_"+E)==-1){p[x]+="_"+E;break}}}}var _=Ot(o["!ref"]),P=[],W=[],j=[];for(x=0;x<=_.e.c-_.s.c;++x){var w="",F="",S=0,b=[];for(E=0;E<g.length;++E)g[E][x]!=null&&b.push(g[E][x]);if(b.length==0||p[x]==null){P[x]="?";continue}for(E=0;E<b.length;++E){switch(typeof b[E]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=b[E]instanceof Date?"D":"C";break;default:F="C"}S=Math.max(S,String(b[E]).length),w=w&&w!=F?"C":F}S>250&&(S=250),F=((y[x]||{}).DBF||{}).type,F=="C"&&y[x].DBF.len>S&&(S=y[x].DBF.len),w=="B"&&F=="N"&&(w="N",j[x]=y[x].DBF.dec,S=y[x].DBF.len),W[x]=w=="C"||F=="N"?S:s[w]||0,A+=W[x],P[x]=w}var N=d.next(32);for(N.write_shift(4,318902576),N.write_shift(4,g.length),N.write_shift(2,296+32*T),N.write_shift(2,A),x=0;x<4;++x)N.write_shift(4,0);for(N.write_shift(4,0|(+e[hS]||3)<<8),x=0,E=0;x<p.length;++x)if(p[x]!=null){var D=d.next(32),R=(p[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,R,"sbcs"),D.write_shift(1,P[x]=="?"?"C":P[x],"sbcs"),D.write_shift(4,E),D.write_shift(1,W[x]||s[P[x]]||0),D.write_shift(1,j[x]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),E+=W[x]||s[P[x]]||0}var He=d.next(264);for(He.write_shift(4,13),x=0;x<65;++x)He.write_shift(4,0);for(x=0;x<g.length;++x){var ve=d.next(A);for(ve.write_shift(1,0),E=0;E<p.length;++E)if(p[E]!=null)switch(P[E]){case"L":ve.write_shift(1,g[x][E]==null?63:g[x][E]?84:70);break;case"B":ve.write_shift(8,g[x][E]||0,"f");break;case"N":var Re="0";for(typeof g[x][E]=="number"&&(Re=g[x][E].toFixed(j[E]||0)),T=0;T<W[E]-Re.length;++T)ve.write_shift(1,32);ve.write_shift(1,Re,"sbcs");break;case"D":g[x][E]?(ve.write_shift(4,("0000"+g[x][E].getFullYear()).slice(-4),"sbcs"),ve.write_shift(2,("00"+(g[x][E].getMonth()+1)).slice(-2),"sbcs"),ve.write_shift(2,("00"+g[x][E].getDate()).slice(-2),"sbcs")):ve.write_shift(8,"00000000","sbcs");break;case"C":var Ae=String(g[x][E]!=null?g[x][E]:"").slice(0,W[E]);for(ve.write_shift(1,Ae,"sbcs"),T=0;T<W[E]-Ae.length;++T)ve.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),AA=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Ur(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,g){var y=t[g];return typeof y=="number"?A_(y):y},n=function(p,g,y){var x=g.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return x==59?p:A_(x)};t["|"]=254;function i(p,g){switch(g.type){case"base64":return s(Hi(p),g);case"binary":return s(p,g);case"buffer":return s(Et&&Buffer.isBuffer(p)?p.toString("binary"):Qo(p),g);case"array":return s(Dl(p),g)}throw new Error("Unrecognized type "+g.type)}function s(p,g){var y=p.split(/[\n\r]+/),x=-1,E=-1,T=0,A=0,_=[],P=[],W=null,j={},w=[],F=[],S=[],b=0,N;for(+g.codepage>=0&&Rs(+g.codepage);T!==y.length;++T){b=0;var D=y[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),R=D.replace(/;;/g,"\0").split(";").map(function(X){return X.replace(/\u0000/g,";")}),He=R[0],ve;if(D.length>0)switch(He){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":R[1].charAt(0)=="P"&&P.push(D.slice(3).replace(/;;/g,";"));break;case"C":var Re=!1,Ae=!1,_e=!1,Z=!1,Ce=-1,Be=-1;for(A=1;A<R.length;++A)switch(R[A].charAt(0)){case"A":break;case"X":E=parseInt(R[A].slice(1))-1,Ae=!0;break;case"Y":for(x=parseInt(R[A].slice(1))-1,Ae||(E=0),N=_.length;N<=x;++N)_[N]=[];break;case"K":ve=R[A].slice(1),ve.charAt(0)==='"'?ve=ve.slice(1,ve.length-1):ve==="TRUE"?ve=!0:ve==="FALSE"?ve=!1:isNaN(Ms(ve))?isNaN(iu(ve).getDate())||(ve=pr(ve)):(ve=Ms(ve),W!==null&&yu(W)&&(ve=Np(ve))),Re=!0;break;case"E":Z=!0;var U=$c(R[A].slice(1),{r:x,c:E});_[x][E]=[_[x][E],U];break;case"S":_e=!0,_[x][E]=[_[x][E],"S5S"];break;case"G":break;case"R":Ce=parseInt(R[A].slice(1))-1;break;case"C":Be=parseInt(R[A].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+D)}if(Re&&(_[x][E]&&_[x][E].length==2?_[x][E][0]=ve:_[x][E]=ve,W=null),_e){if(Z)throw new Error("SYLK shared formula cannot have own formula");var H=Ce>-1&&_[Ce][Be];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");_[x][E][1]=WA(H[1],{r:x-Ce,c:E-Be})}break;case"F":var Q=0;for(A=1;A<R.length;++A)switch(R[A].charAt(0)){case"X":E=parseInt(R[A].slice(1))-1,++Q;break;case"Y":for(x=parseInt(R[A].slice(1))-1,N=_.length;N<=x;++N)_[N]=[];break;case"M":b=parseInt(R[A].slice(1))/20;break;case"F":break;case"G":break;case"P":W=P[parseInt(R[A].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=R[A].slice(1).split(" "),N=parseInt(S[0],10);N<=parseInt(S[1],10);++N)b=parseInt(S[2],10),F[N-1]=b===0?{hidden:!0}:{wch:b},zo(F[N-1]);break;case"C":E=parseInt(R[A].slice(1))-1,F[E]||(F[E]={});break;case"R":x=parseInt(R[A].slice(1))-1,w[x]||(w[x]={}),b>0?(w[x].hpt=b,w[x].hpx=au(b)):b===0&&(w[x].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+D)}Q<1&&(W=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+D)}}return w.length>0&&(j["!rows"]=w),F.length>0&&(j["!cols"]=F),g&&g.sheetRows&&(_=_.slice(0,g.sheetRows)),[_,j]}function a(p,g){var y=i(p,g),x=y[0],E=y[1],T=Eu(x,g);return Ur(E).forEach(function(A){T[A]=E[A]}),T}function o(p,g){return Jo(a(p,g),g)}function l(p,g,y,x){var E="C;Y"+(y+1)+";X"+(x+1)+";K";switch(p.t){case"n":E+=p.v||0,p.f&&!p.F&&(E+=";E"+ev(p.f,{r:y,c:x}));break;case"b":E+=p.v?"TRUE":"FALSE";break;case"e":E+=p.w||p.v;break;case"d":E+='"'+(p.w||p.v)+'"';break;case"s":E+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function c(p,g){g.forEach(function(y,x){var E="F;W"+(x+1)+" "+(x+1)+" ";y.hidden?E+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=id(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=sd(y.wpx)),typeof y.wch=="number"&&(E+=Math.round(y.wch))),E.charAt(E.length-1)!=" "&&p.push(E)})}function d(p,g){g.forEach(function(y,x){var E="F;";y.hidden?E+="M0;":y.hpt?E+="M"+20*y.hpt+";":y.hpx&&(E+="M"+20*ad(y.hpx)+";"),E.length>2&&p.push(E+"R"+(x+1))})}function h(p,g){var y=["ID;PWXL;N;E"],x=[],E=Ot(p["!ref"]),T,A=Array.isArray(p),_=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),p["!cols"]&&c(y,p["!cols"]),p["!rows"]&&d(y,p["!rows"]),y.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var P=E.s.r;P<=E.e.r;++P)for(var W=E.s.c;W<=E.e.c;++W){var j=ot({r:P,c:W});T=A?(p[P]||[])[W]:p[j],!(!T||T.v==null&&(!T.f||T.F))&&x.push(l(T,p,P,W))}return y.join(_)+_+x.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),kA=function(){function t(s,a){switch(a.type){case"base64":return e(Hi(s),a);case"binary":return e(s,a);case"buffer":return e(Et&&Buffer.isBuffer(s)?s.toString("binary"):Qo(s),a);case"array":return e(Dl(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,c=-1,d=0,h=[];d!==o.length;++d){if(o[d].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var p=o[d].trim().split(","),g=p[0],y=p[1];++d;for(var x=o[d]||"";(x.match(/["]/g)||[]).length&1&&d<o.length-1;)x+=`
`+o[++d];switch(x=x.trim(),+g){case-1:if(x==="BOT"){h[++l]=[],c=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?h[l][c]=!0:x==="FALSE"?h[l][c]=!1:isNaN(Ms(y))?isNaN(iu(y).getDate())?h[l][c]=y:h[l][c]=pr(y):h[l][c]=Ms(y),++c;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),h[l][c++]=x!==""?x:null;break}if(x==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(s,a){return Eu(t(s,a),a)}function n(s,a){return Jo(r(s,a),a)}var i=function(){var s=function(l,c,d,h,p){l.push(c),l.push(d+","+h),l.push('"'+p.replace(/"/g,'""')+'"')},a=function(l,c,d,h){l.push(c+","+d),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],d=Ot(l["!ref"]),h,p=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,d.e.r-d.s.r+1,""),s(c,"TUPLES",0,d.e.c-d.s.c+1,""),s(c,"DATA",0,0,"");for(var g=d.s.r;g<=d.e.r;++g){a(c,-1,0,"BOT");for(var y=d.s.c;y<=d.e.c;++y){var x=ot({r:g,c:y});if(h=p?(l[g]||[])[y]:l[x],!h){a(c,1,0,"");continue}switch(h.t){case"n":var E=h.w;!E&&h.v!=null&&(E=h.v),E==null?h.f&&!h.F?a(c,1,0,"="+h.f):a(c,1,0,""):a(c,0,E,"V");break;case"b":a(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=us(h.z||st[14],dn(pr(h.v)))),a(c,0,h.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var T=`\r
`,A=c.join(T);return A}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),CA=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,p){for(var g=h.split(`
`),y=-1,x=-1,E=0,T=[];E!==g.length;++E){var A=g[E].trim().split(":");if(A[0]==="cell"){var _=Fr(A[1]);if(T.length<=_.r)for(y=T.length;y<=_.r;++y)T[y]||(T[y]=[]);switch(y=_.r,x=_.c,A[2]){case"t":T[y][x]=t(A[3]);break;case"v":T[y][x]=+A[3];break;case"vtf":var P=A[A.length-1];case"vtc":switch(A[3]){case"nl":T[y][x]=!!+A[4];break;default:T[y][x]=+A[4];break}A[2]=="vtf"&&(T[y][x]=[T[y][x],P])}}}return p&&p.sheetRows&&(T=T.slice(0,p.sheetRows)),T}function n(h,p){return Eu(r(h,p),p)}function i(h,p){return Jo(n(h,p),p)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var p=[],g=[],y,x="",E=Ri(h["!ref"]),T=Array.isArray(h),A=E.s.r;A<=E.e.r;++A)for(var _=E.s.c;_<=E.e.c;++_)if(x=ot({r:A,c:_}),y=T?(h[A]||[])[_]:h[x],!(!y||y.v==null||y.t==="z")){switch(g=["cell",x,"t"],y.t){case"s":case"str":g.push(e(y.v));break;case"n":y.f?(g[2]="vtf",g[3]="n",g[4]=y.v,g[5]=e(y.f)):(g[2]="v",g[3]=y.v);break;case"b":g[2]="vt"+(y.f?"f":"c"),g[3]="nl",g[4]=y.v?"1":"0",g[5]=e(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var P=dn(pr(y.v));g[2]="vtc",g[3]="nd",g[4]=""+P,g[5]=y.w||us(y.z||st[14],P);break;case"e":continue}p.push(g.join(":"))}return p.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function d(h){return[s,a,o,a,c(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),su=function(){function t(d,h,p,g,y){y.raw?h[p][g]=d:d===""||(d==="TRUE"?h[p][g]=!0:d==="FALSE"?h[p][g]=!1:isNaN(Ms(d))?isNaN(iu(d).getDate())?h[p][g]=d:h[p][g]=pr(d):h[p][g]=Ms(d))}function e(d,h){var p=h||{},g=[];if(!d||d.length===0)return g;for(var y=d.split(/[\r\n]/),x=y.length-1;x>=0&&y[x].length===0;)--x;for(var E=10,T=0,A=0;A<=x;++A)T=y[A].indexOf(" "),T==-1?T=y[A].length:T++,E=Math.max(E,T);for(A=0;A<=x;++A){g[A]=[];var _=0;for(t(y[A].slice(0,E).trim(),g,A,_,p),_=1;_<=(y[A].length-E)/10+1;++_)t(y[A].slice(E+(_-1)*10,E+_*10).trim(),g,A,_,p)}return p.sheetRows&&(g=g.slice(0,p.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var h={},p=!1,g=0,y=0;g<d.length;++g)(y=d.charCodeAt(g))==34?p=!p:!p&&y in r&&(h[y]=(h[y]||0)+1);y=[];for(g in h)Object.prototype.hasOwnProperty.call(h,g)&&y.push([h[g],g]);if(!y.length){h=n;for(g in h)Object.prototype.hasOwnProperty.call(h,g)&&y.push([h[g],g])}return y.sort(function(x,E){return x[0]-E[0]||n[x[1]]-n[E[1]]}),r[y.pop()[1]]||44}function s(d,h){var p=h||{},g="",y=p.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(g=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(g=d.charAt(4),d=d.slice(6)):g=i(d.slice(0,1024)):p&&p.FS?g=p.FS:g=i(d.slice(0,1024));var E=0,T=0,A=0,_=0,P=0,W=g.charCodeAt(0),j=!1,w=0,F=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var S=p.dateNF!=null?fR(p.dateNF):null;function b(){var N=d.slice(_,P),D={};if(N.charAt(0)=='"'&&N.charAt(N.length-1)=='"'&&(N=N.slice(1,-1).replace(/""/g,'"')),N.length===0)D.t="z";else if(p.raw)D.t="s",D.v=N;else if(N.trim().length===0)D.t="s",D.v=N;else if(N.charCodeAt(0)==61)N.charCodeAt(1)==34&&N.charCodeAt(N.length-1)==34?(D.t="s",D.v=N.slice(2,-1).replace(/""/g,'"')):V6(N)?(D.t="n",D.f=N.slice(1)):(D.t="s",D.v=N);else if(N=="TRUE")D.t="b",D.v=!0;else if(N=="FALSE")D.t="b",D.v=!1;else if(!isNaN(A=Ms(N)))D.t="n",p.cellText!==!1&&(D.w=N),D.v=A;else if(!isNaN(iu(N).getDate())||S&&N.match(S)){D.z=p.dateNF||st[14];var R=0;S&&N.match(S)&&(N=dR(N,p.dateNF,N.match(S)||[]),R=1),p.cellDates?(D.t="d",D.v=pr(N,R)):(D.t="n",D.v=dn(pr(N,R))),p.cellText!==!1&&(D.w=us(D.z,D.v instanceof Date?dn(D.v):D.v)),p.cellNF||delete D.z}else D.t="s",D.v=N;if(D.t=="z"||(p.dense?(y[E]||(y[E]=[]),y[E][T]=D):y[ot({c:T,r:E})]=D),_=P+1,F=d.charCodeAt(_),x.e.c<T&&(x.e.c=T),x.e.r<E&&(x.e.r=E),w==W)++T;else if(T=0,++E,p.sheetRows&&p.sheetRows<=E)return!0}e:for(;P<d.length;++P)switch(w=d.charCodeAt(P)){case 34:F===34&&(j=!j);break;case W:case 10:case 13:if(!j&&b())break e;break}return P-_>0&&b(),y["!ref"]=yt(x),y}function a(d,h){return!(h&&h.PRN)||h.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,h):Eu(e(d,h),h)}function o(d,h){var p="",g=h.type=="string"?[0,0,0,0]:lv(d,h);switch(h.type){case"base64":p=Hi(d);break;case"binary":p=d;break;case"buffer":h.codepage==65001?p=d.toString("utf8"):h.codepage&&typeof qf<"u"||(p=Et&&Buffer.isBuffer(d)?d.toString("binary"):Qo(d));break;case"array":p=Dl(d);break;case"string":p=d;break;default:throw new Error("Unrecognized type "+h.type)}return g[0]==239&&g[1]==187&&g[2]==191?p=Jt(p.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?p=Jt(p):h.type=="binary"&&typeof qf<"u",p.slice(0,19)=="socialcalc:version:"?CA.to_sheet(h.type=="string"?p:Jt(p),h):a(p,h)}function l(d,h){return Jo(o(d,h),h)}function c(d){for(var h=[],p=Ot(d["!ref"]),g,y=Array.isArray(d),x=p.s.r;x<=p.e.r;++x){for(var E=[],T=p.s.c;T<=p.e.c;++T){var A=ot({r:x,c:T});if(g=y?(d[x]||[])[T]:d[A],!g||g.v==null){E.push("          ");continue}for(var _=(g.w||(ja(g),g.w)||"").slice(0,10);_.length<10;)_+=" ";E.push(_+(T===0?" ":""))}h.push(E.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function kD(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=AA.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return su.to_workbook(t,e)}}var Tl=function(){function t(U,H,Q){if(U){Fn(U,U.l||0);for(var X=Q.Enum||Ce;U.l<U.length;){var he=U.read_shift(2),Te=X[he]||X[65535],Pe=U.read_shift(2),ke=U.l+Pe,we=Te.f&&Te.f(U,Pe,Q);if(U.l=ke,H(we,Te,he))return}}}function e(U,H){switch(H.type){case"base64":return r(Bi(Hi(U)),H);case"binary":return r(Bi(U),H);case"buffer":case"array":return r(U,H)}throw"Unsupported type "+H.type}function r(U,H){if(!U)return U;var Q=H||{},X=Q.dense?[]:{},he="Sheet1",Te="",Pe=0,ke={},we=[],nt=[],G={s:{r:0,c:0},e:{r:0,c:0}},Ct=Q.sheetRows||0;if(U[2]==0&&(U[3]==8||U[3]==9)&&U.length>=16&&U[14]==5&&U[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(U[2]==2)Q.Enum=Ce,t(U,function($e,qt,wn){switch(wn){case 0:Q.vers=$e,$e>=4096&&(Q.qpro=!0);break;case 6:G=$e;break;case 204:$e&&(Te=$e);break;case 222:Te=$e;break;case 15:case 51:Q.qpro||($e[1].v=$e[1].v.slice(1));case 13:case 14:case 16:wn==14&&($e[2]&112)==112&&($e[2]&15)>1&&($e[2]&15)<15&&($e[1].z=Q.dateNF||st[14],Q.cellDates&&($e[1].t="d",$e[1].v=Np($e[1].v))),Q.qpro&&$e[3]>Pe&&(X["!ref"]=yt(G),ke[he]=X,we.push(he),X=Q.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},Pe=$e[3],he=Te||"Sheet"+(Pe+1),Te="");var hn=Q.dense?(X[$e[0].r]||[])[$e[0].c]:X[ot($e[0])];if(hn){hn.t=$e[1].t,hn.v=$e[1].v,$e[1].z!=null&&(hn.z=$e[1].z),$e[1].f!=null&&(hn.f=$e[1].f);break}Q.dense?(X[$e[0].r]||(X[$e[0].r]=[]),X[$e[0].r][$e[0].c]=$e[1]):X[ot($e[0])]=$e[1];break}},Q);else if(U[2]==26||U[2]==14)Q.Enum=Be,U[2]==14&&(Q.qpro=!0,U.l=0),t(U,function($e,qt,wn){switch(wn){case 204:he=$e;break;case 22:$e[1].v=$e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if($e[3]>Pe&&(X["!ref"]=yt(G),ke[he]=X,we.push(he),X=Q.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},Pe=$e[3],he="Sheet"+(Pe+1)),Ct>0&&$e[0].r>=Ct)break;Q.dense?(X[$e[0].r]||(X[$e[0].r]=[]),X[$e[0].r][$e[0].c]=$e[1]):X[ot($e[0])]=$e[1],G.e.c<$e[0].c&&(G.e.c=$e[0].c),G.e.r<$e[0].r&&(G.e.r=$e[0].r);break;case 27:$e[14e3]&&(nt[$e[14e3][0]]=$e[14e3][1]);break;case 1537:nt[$e[0]]=$e[1],$e[0]==Pe&&(he=$e[1]);break}},Q);else throw new Error("Unrecognized LOTUS BOF "+U[2]);if(X["!ref"]=yt(G),ke[Te||he]=X,we.push(Te||he),!nt.length)return{SheetNames:we,Sheets:ke};for(var xt={},Rt=[],pt=0;pt<nt.length;++pt)ke[we[pt]]?(Rt.push(nt[pt]||we[pt]),xt[nt[pt]]=ke[nt[pt]]||ke[we[pt]]):(Rt.push(nt[pt]),xt[nt[pt]]={"!ref":"A1"});return{SheetNames:Rt,Sheets:xt}}function n(U,H){var Q=H||{};if(+Q.codepage>=0&&Rs(+Q.codepage),Q.type=="string")throw new Error("Cannot write WK1 to JS string");var X=bi(),he=Ot(U["!ref"]),Te=Array.isArray(U),Pe=[];Ue(X,0,s(1030)),Ue(X,6,l(he));for(var ke=Math.min(he.e.r,8191),we=he.s.r;we<=ke;++we)for(var nt=$r(we),G=he.s.c;G<=he.e.c;++G){we===he.s.r&&(Pe[G]=Cr(G));var Ct=Pe[G]+nt,xt=Te?(U[we]||[])[G]:U[Ct];if(!(!xt||xt.t=="z"))if(xt.t=="n")(xt.v|0)==xt.v&&xt.v>=-32768&&xt.v<=32767?Ue(X,13,g(we,G,xt.v)):Ue(X,14,x(we,G,xt.v));else{var Rt=ja(xt);Ue(X,15,h(we,G,Rt.slice(0,239)))}}return Ue(X,1),X.end()}function i(U,H){var Q=H||{};if(+Q.codepage>=0&&Rs(+Q.codepage),Q.type=="string")throw new Error("Cannot write WK3 to JS string");var X=bi();Ue(X,0,a(U));for(var he=0,Te=0;he<U.SheetNames.length;++he)(U.Sheets[U.SheetNames[he]]||{})["!ref"]&&Ue(X,27,Z(U.SheetNames[he],Te++));var Pe=0;for(he=0;he<U.SheetNames.length;++he){var ke=U.Sheets[U.SheetNames[he]];if(!(!ke||!ke["!ref"])){for(var we=Ot(ke["!ref"]),nt=Array.isArray(ke),G=[],Ct=Math.min(we.e.r,8191),xt=we.s.r;xt<=Ct;++xt)for(var Rt=$r(xt),pt=we.s.c;pt<=we.e.c;++pt){xt===we.s.r&&(G[pt]=Cr(pt));var $e=G[pt]+Rt,qt=nt?(ke[xt]||[])[pt]:ke[$e];if(!(!qt||qt.t=="z"))if(qt.t=="n")Ue(X,23,b(xt,pt,Pe,qt.v));else{var wn=ja(qt);Ue(X,22,w(xt,pt,Pe,wn.slice(0,239)))}}++Pe}}return Ue(X,1),X.end()}function s(U){var H=me(2);return H.write_shift(2,U),H}function a(U){var H=me(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var Q=0,X=0,he=0,Te=0;Te<U.SheetNames.length;++Te){var Pe=U.SheetNames[Te],ke=U.Sheets[Pe];if(!(!ke||!ke["!ref"])){++he;var we=Ri(ke["!ref"]);Q<we.e.r&&(Q=we.e.r),X<we.e.c&&(X=we.e.c)}}return Q>8191&&(Q=8191),H.write_shift(2,Q),H.write_shift(1,he),H.write_shift(1,X),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function o(U,H,Q){var X={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&Q.qpro?(X.s.c=U.read_shift(1),U.l++,X.s.r=U.read_shift(2),X.e.c=U.read_shift(1),U.l++,X.e.r=U.read_shift(2),X):(X.s.c=U.read_shift(2),X.s.r=U.read_shift(2),H==12&&Q.qpro&&(U.l+=2),X.e.c=U.read_shift(2),X.e.r=U.read_shift(2),H==12&&Q.qpro&&(U.l+=2),X.s.c==65535&&(X.s.c=X.e.c=X.s.r=X.e.r=0),X)}function l(U){var H=me(8);return H.write_shift(2,U.s.c),H.write_shift(2,U.s.r),H.write_shift(2,U.e.c),H.write_shift(2,U.e.r),H}function c(U,H,Q){var X=[{c:0,r:0},{t:"n",v:0},0,0];return Q.qpro&&Q.vers!=20768?(X[0].c=U.read_shift(1),X[3]=U.read_shift(1),X[0].r=U.read_shift(2),U.l+=2):(X[2]=U.read_shift(1),X[0].c=U.read_shift(2),X[0].r=U.read_shift(2)),X}function d(U,H,Q){var X=U.l+H,he=c(U,H,Q);if(he[1].t="s",Q.vers==20768){U.l++;var Te=U.read_shift(1);return he[1].v=U.read_shift(Te,"utf8"),he}return Q.qpro&&U.l++,he[1].v=U.read_shift(X-U.l,"cstr"),he}function h(U,H,Q){var X=me(7+Q.length);X.write_shift(1,255),X.write_shift(2,H),X.write_shift(2,U),X.write_shift(1,39);for(var he=0;he<X.length;++he){var Te=Q.charCodeAt(he);X.write_shift(1,Te>=128?95:Te)}return X.write_shift(1,0),X}function p(U,H,Q){var X=c(U,H,Q);return X[1].v=U.read_shift(2,"i"),X}function g(U,H,Q){var X=me(7);return X.write_shift(1,255),X.write_shift(2,H),X.write_shift(2,U),X.write_shift(2,Q,"i"),X}function y(U,H,Q){var X=c(U,H,Q);return X[1].v=U.read_shift(8,"f"),X}function x(U,H,Q){var X=me(13);return X.write_shift(1,255),X.write_shift(2,H),X.write_shift(2,U),X.write_shift(8,Q,"f"),X}function E(U,H,Q){var X=U.l+H,he=c(U,H,Q);if(he[1].v=U.read_shift(8,"f"),Q.qpro)U.l=X;else{var Te=U.read_shift(2);P(U.slice(U.l,U.l+Te),he),U.l+=Te}return he}function T(U,H,Q){var X=H&32768;return H&=-32769,H=(X?U:0)+(H>=8192?H-16384:H),(X?"":"$")+(Q?Cr(H):$r(H))}var A={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function P(U,H){Fn(U,0);for(var Q=[],X=0,he="",Te="",Pe="",ke="";U.l<U.length;){var we=U[U.l++];switch(we){case 0:Q.push(U.read_shift(8,"f"));break;case 1:Te=T(H[0].c,U.read_shift(2),!0),he=T(H[0].r,U.read_shift(2),!1),Q.push(Te+he);break;case 2:{var nt=T(H[0].c,U.read_shift(2),!0),G=T(H[0].r,U.read_shift(2),!1);Te=T(H[0].c,U.read_shift(2),!0),he=T(H[0].r,U.read_shift(2),!1),Q.push(nt+G+":"+Te+he)}break;case 3:if(U.l<U.length){console.error("WK1 premature formula end");return}break;case 4:Q.push("("+Q.pop()+")");break;case 5:Q.push(U.read_shift(2));break;case 6:{for(var Ct="";we=U[U.l++];)Ct+=String.fromCharCode(we);Q.push('"'+Ct.replace(/"/g,'""')+'"')}break;case 8:Q.push("-"+Q.pop());break;case 23:Q.push("+"+Q.pop());break;case 22:Q.push("NOT("+Q.pop()+")");break;case 20:case 21:ke=Q.pop(),Pe=Q.pop(),Q.push(["AND","OR"][we-20]+"("+Pe+","+ke+")");break;default:if(we<32&&_[we])ke=Q.pop(),Pe=Q.pop(),Q.push(Pe+_[we]+ke);else if(A[we]){if(X=A[we][1],X==69&&(X=U[U.l++]),X>Q.length){console.error("WK1 bad formula parse 0x"+we.toString(16)+":|"+Q.join("|")+"|");return}var xt=Q.slice(-X);Q.length-=X,Q.push(A[we][0]+"("+xt.join(",")+")")}else return we<=7?console.error("WK1 invalid opcode "+we.toString(16)):we<=24?console.error("WK1 unsupported op "+we.toString(16)):we<=30?console.error("WK1 invalid opcode "+we.toString(16)):we<=115?console.error("WK1 unsupported function opcode "+we.toString(16)):console.error("WK1 unrecognized opcode "+we.toString(16))}}Q.length==1?H[1].f=""+Q[0]:console.error("WK1 bad formula parse |"+Q.join("|")+"|")}function W(U){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=U.read_shift(2),H[3]=U[U.l++],H[0].c=U[U.l++],H}function j(U,H){var Q=W(U);return Q[1].t="s",Q[1].v=U.read_shift(H-4,"cstr"),Q}function w(U,H,Q,X){var he=me(6+X.length);he.write_shift(2,U),he.write_shift(1,Q),he.write_shift(1,H),he.write_shift(1,39);for(var Te=0;Te<X.length;++Te){var Pe=X.charCodeAt(Te);he.write_shift(1,Pe>=128?95:Pe)}return he.write_shift(1,0),he}function F(U,H){var Q=W(U);Q[1].v=U.read_shift(2);var X=Q[1].v>>1;if(Q[1].v&1)switch(X&7){case 0:X=(X>>3)*5e3;break;case 1:X=(X>>3)*500;break;case 2:X=(X>>3)/20;break;case 3:X=(X>>3)/200;break;case 4:X=(X>>3)/2e3;break;case 5:X=(X>>3)/2e4;break;case 6:X=(X>>3)/16;break;case 7:X=(X>>3)/64;break}return Q[1].v=X,Q}function S(U,H){var Q=W(U),X=U.read_shift(4),he=U.read_shift(4),Te=U.read_shift(2);if(Te==65535)return X===0&&he===3221225472?(Q[1].t="e",Q[1].v=15):X===0&&he===3489660928?(Q[1].t="e",Q[1].v=42):Q[1].v=0,Q;var Pe=Te&32768;return Te=(Te&32767)-16446,Q[1].v=(1-Pe*2)*(he*Math.pow(2,Te+32)+X*Math.pow(2,Te)),Q}function b(U,H,Q,X){var he=me(14);if(he.write_shift(2,U),he.write_shift(1,Q),he.write_shift(1,H),X==0)return he.write_shift(4,0),he.write_shift(4,0),he.write_shift(2,65535),he;var Te=0,Pe=0,ke=0,we=0;return X<0&&(Te=1,X=-X),Pe=Math.log2(X)|0,X/=Math.pow(2,Pe-31),we=X>>>0,we&2147483648||(X/=2,++Pe,we=X>>>0),X-=we,we|=2147483648,we>>>=0,X*=Math.pow(2,32),ke=X>>>0,he.write_shift(4,ke),he.write_shift(4,we),Pe+=16383+(Te?32768:0),he.write_shift(2,Pe),he}function N(U,H){var Q=S(U);return U.l+=H-14,Q}function D(U,H){var Q=W(U),X=U.read_shift(4);return Q[1].v=X>>6,Q}function R(U,H){var Q=W(U),X=U.read_shift(8,"f");return Q[1].v=X,Q}function He(U,H){var Q=R(U);return U.l+=H-10,Q}function ve(U,H){return U[U.l+H-1]==0?U.read_shift(H,"cstr"):""}function Re(U,H){var Q=U[U.l++];Q>H-1&&(Q=H-1);for(var X="";X.length<Q;)X+=String.fromCharCode(U[U.l++]);return X}function Ae(U,H,Q){if(!(!Q.qpro||H<21)){var X=U.read_shift(1);U.l+=17,U.l+=1,U.l+=2;var he=U.read_shift(H-21,"cstr");return[X,he]}}function _e(U,H){for(var Q={},X=U.l+H;U.l<X;){var he=U.read_shift(2);if(he==14e3){for(Q[he]=[0,""],Q[he][0]=U.read_shift(2);U[U.l];)Q[he][1]+=String.fromCharCode(U[U.l]),U.l++;U.l++}}return Q}function Z(U,H){var Q=me(5+U.length);Q.write_shift(2,14e3),Q.write_shift(2,H);for(var X=0;X<U.length;++X){var he=U.charCodeAt(X);Q[Q.l++]=he>127?95:he}return Q[Q.l++]=0,Q}var Ce={0:{n:"BOF",f:rn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ve},222:{n:"SHEETNAMELP",f:Re},65535:{n:""}},Be={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:j},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:N},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:_e},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:R},40:{n:"FORMULA28",f:He},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ve},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ae},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function CD(t){var e={},r=t.match(ri),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=ct(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=A1[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var FD=function(){var t=Zf("t"),e=Zf("rPr");function r(s){var a=s.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:Pt(a[1])},l=s.match(e);return l&&(o.s=CD(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),ID=function(){var e=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),bD=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,RD=/<(?:\w+:)?r>/,ND=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Y1(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Pt(Jt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Jt(t),r&&(n.h=O1(n.t))):t.match(RD)&&(n.r=Jt(t),n.t=Pt(Jt((t.replace(ND,"").match(bD)||[]).join("").replace(ri,""))),r&&(n.h=ID(FD(n.r)))),n):{t:""}}var DD=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,PD=/<(?:\w+:)?(?:si|sstItem)>/g,OD=/<\/(?:\w+:)?(?:si|sstItem)>/;function MD(t,e){var r=[],n="";if(!t)return r;var i=t.match(DD);if(i){n=i[2].replace(PD,"").split(OD);for(var s=0;s!=n.length;++s){var a=Y1(n[s].trim(),e);a!=null&&(r[r.length]=a)}i=ct(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var LD=/^\s|\s$|[\t\n\r]/;function FA(t,e){if(!e.bookSST)return"";var r=[Gr];r[r.length]=je("sst",null,{xmlns:$l[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(LD)&&(s+=' xml:space="preserve"'),s+=">"+Kt(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function BD(t){return[t.read_shift(4),t.read_shift(4)]}function jD(t,e){var r=[],n=!1;return Ka(t,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function VD(t,e){return e||(e=me(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var UD=QR;function zD(t){var e=bi();Ee(e,159,VD(t));for(var r=0;r<t.length;++r)Ee(e,19,UD(t[r]));return Ee(e,160),e.end()}function IA(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Da(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function WD(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Da(t,4),e.U=Da(t,4),e.W=Da(t,4),e}function HD(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function $D(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(HD(t));return e}function GD(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function KD(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Da(t,4),e.U=Da(t,4),e.W=Da(t,4),e}function XD(t){var e=KD(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function bA(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function RA(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function YD(t){var e=Da(t);switch(e.Minor){case 2:return[e.Minor,qD(t)];case 3:return[e.Minor,QD()];case 4:return[e.Minor,JD(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function qD(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=bA(t,r),i=RA(t,t.length-t.l);return{t:"Std",h:n,v:i}}function QD(){throw new Error("File is password-protected: ECMA-376 Extensible")}function JD(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(ri,function(s){var a=ct(s);switch(la(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function ZD(t,e){var r={},n=r.EncryptionVersionInfo=Da(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=bA(t,i),e-=i,r.EncryptionVerifier=RA(t,e),r}function eP(t){var e={},r=e.EncryptionVersionInfo=Da(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function q1(t){var e=0,r,n=IA(t),i=n.length+1,s,a,o,l,c;for(r=Uo(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var NA=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],l=104,c=a.length-1;c>=0;--c)for(var d=a[c],h=0;h!=7;++h)d&64&&(o^=r[l]),d*=2,--l;return o};return function(a){for(var o=IA(a),l=s(o),c=o.length,d=Uo(16),h=0;h!=16;++h)d[h]=0;var p,g,y;for((c&1)===1&&(p=l>>8,d[c]=i(t[0],p),--c,p=l&255,g=o[o.length-1],d[c]=i(g,p));c>0;)--c,p=l>>8,d[c]=i(o[c],p),--c,p=l&255,d[c]=i(o[c],p);for(c=15,y=15-o.length;y>0;)p=l>>8,d[c]=i(t[y],p),--c,--y,p=l&255,d[c]=i(o[c],p),--c,--y;return d}}(),tP=function(t,e,r,n,i){i||(i=e),n||(n=NA(t));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},rP=function(t){var e=0,r=NA(t);return function(n){var i=tP("",n,e,r);return e=i[1],i[0]}};function nP(t,e,r,n){var i={key:rn(t),verificationBytes:rn(t)};return r.password&&(i.verifier=q1(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=rP(r.password)),i}function iP(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=eP(t):n.Data=ZD(t,e),n}function sP(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?iP(t,e-2,n):nP(t,r.biff>=8?e:e-2,r,n),n}var DA=function(){function t(i,s){switch(s.type){case"base64":return e(Hi(i),s);case"binary":return e(i,s);case"buffer":return e(Et&&Buffer.isBuffer(i)?i.toString("binary"):Qo(i),s);case"array":return e(Dl(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(d,h){Array.isArray(o)&&(o[h]=[]);for(var p=/\\\w+\b/g,g=0,y,x=-1;y=p.exec(d);){switch(y[0]){case"\\cell":var E=d.slice(g,p.lastIndex-y[0].length);if(E[0]==" "&&(E=E.slice(1)),++x,E.length){var T={v:E,t:"s"};Array.isArray(o)?o[h][x]=T:o[ot({r:h,c:x})]=T}break}g=p.lastIndex}x>c.e.c&&(c.e.c=x)}),o["!ref"]=yt(c),o}function r(i,s){return Jo(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=Ot(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var d=a.s.c;d<=a.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=a.s.c;d<=a.e.c;++d){var h=ot({r:c,c:d});o=l?(i[c]||[])[d]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(ja(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function aP(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function nd(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function oP(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),a=i-s;if(a===0)return[0,0,e];var o=0,l=0,c=i+s;switch(l=a/(c>1?2-c:c),i){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,l,c/2]}function lP(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=i*o,a[0]+=i,a[1]+=l;break;case 1:l=i*(2-o),a[0]+=l,a[1]+=i;break;case 2:l=i*(o-2),a[1]+=i,a[2]+=l;break;case 3:l=i*(4-o),a[1]+=l,a[2]+=i;break;case 4:l=i*(o-4),a[2]+=i,a[0]+=l;break;case 5:l=i*(6-o),a[2]+=l,a[0]+=i;break}for(var c=0;c!=3;++c)a[c]=Math.round(a[c]*255);return a}function Gh(t,e){if(e===0)return t;var r=oP(aP(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),nd(lP(r))}var PA=6,cP=15,uP=1,Yn=PA;function id(t){return Math.floor((t+Math.round(128/Yn)/256)*Yn)}function sd(t){return Math.floor((t-5)/Yn*100+.5)/100}function Kh(t){return Math.round((t*Yn+5)/Yn*256)/256}function bm(t){return Kh(sd(id(t)))}function Q1(t){var e=Math.abs(t-bm(t)),r=Yn;if(e>.005)for(Yn=uP;Yn<cP;++Yn)Math.abs(t-bm(t))<=e&&(e=Math.abs(t-bm(t)),r=Yn);Yn=r}function zo(t){t.width?(t.wpx=id(t.width),t.wch=sd(t.wpx),t.MDW=Yn):t.wpx?(t.wch=sd(t.wpx),t.width=Kh(t.wch),t.MDW=Yn):typeof t.wch=="number"&&(t.width=Kh(t.wch),t.wpx=id(t.width),t.MDW=Yn),t.customWidth&&delete t.customWidth}var fP=96,OA=fP;function ad(t){return t*96/OA}function au(t){return t*OA/96}var dP={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function hP(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(ri)||[]).forEach(function(a){var o=ct(a);switch(la(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=dr(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=dr(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function pP(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(ri)||[]).forEach(function(a){var o=ct(a);switch(la(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function mP(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(ri)||[]).forEach(function(a){var o=ct(a);switch(la(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=Jt(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?dr(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?dr(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?dr(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?dr(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?dr(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?dr(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?dr(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=A1[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=dr(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=El[i.color.index];i.color.index==81&&(l=El[1]),l||(l=El[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=Gh(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function gP(t,e,r){e.NumberFmt=[];for(var n=Ur(st),i=0;i<n.length;++i)e.NumberFmt[n[i]]=st[n[i]];var s=t[0].match(ri);if(s)for(i=0;i<s.length;++i){var a=ct(s[i]);switch(la(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Pt(Jt(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}Na(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function xP(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=je("numFmt",null,{numFmtId:n,formatCode:Kt(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=je("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var b0=["numFmtId","fillId","fontId","borderId","xfId"],R0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function vP(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(ri)||[]).forEach(function(s){var a=ct(s),o=0;switch(la(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<b0.length;++o)n[b0[o]]&&(n[b0[o]]=parseInt(n[b0[o]],10));for(o=0;o<R0.length;++o)n[R0[o]]&&(n[R0[o]]=dr(n[R0[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=dr(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function yP(t){var e=[];return e[e.length]=je("cellXfs",null),t.forEach(function(r){e[e.length]=je("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=je("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var _P=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&gP(h,d,c),(h=o.match(i))&&mP(h,d,l,c),(h=o.match(n))&&pP(h,d,l,c),(h=o.match(s))&&hP(h,d,l,c),(h=o.match(r))&&vP(h,d,c),d}}();function MA(t,e){var r=[Gr,je("styleSheet",null,{xmlns:$l[0],"xmlns:vt":ln.vt})],n;return t.SSF&&(n=xP(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=yP(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function EP(t,e){var r=t.read_shift(2),n=Jn(t);return[r,n]}function wP(t,e,r){r||(r=me(6+4*e.length)),r.write_shift(2,t),_n(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function TP(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=iN(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=nN(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Jn(t),n}function SP(t,e){e||(e=me(25+4*32)),e.write_shift(2,t.sz*20),sN(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Wh(t.color,e);var n=0;return n=2,e.write_shift(1,n),_n(t.name,e),e.length>e.l?e.slice(0,e.l):e}var AP=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Rm,kP=ei;function m2(t,e){e||(e=me(4*3+8*7+16*1)),Rm||(Rm=bp(AP));var r=Rm[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(Wh({auto:1},e),Wh({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function CP(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function LA(t,e,r){r||(r=me(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Xu(t,e){return e||(e=me(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var FP=ei;function IP(t,e){return e||(e=me(51)),e.write_shift(1,0),Xu(null,e),Xu(null,e),Xu(null,e),Xu(null,e),Xu(null,e),e.length>e.l?e.slice(0,e.l):e}function bP(t,e){return e||(e=me(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),zh(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function RP(t,e,r){var n=me(2052);return n.write_shift(4,t),zh(e,n),zh(r,n),n.length>n.l?n.slice(0,n.l):n}function NP(t,e,r){var n={};n.NumberFmt=[];for(var i in st)n.NumberFmt[i]=st[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return Ka(t,function(l,c,d){switch(d){case 44:n.NumberFmt[l[0]]=l[1],Na(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=Gh(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(d),a=!0;break;case 38:s.pop(),a=!1;break;default:if(c.T>0)s.push(d);else if(c.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function DP(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(Ee(t,615,Ls(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Ee(t,44,wP(i,e[i]))}),Ee(t,616))}}function PP(t){var e=1;Ee(t,611,Ls(e)),Ee(t,43,SP({sz:12,color:{theme:1},name:"Calibri",family:2})),Ee(t,612)}function OP(t){var e=2;Ee(t,603,Ls(e)),Ee(t,45,m2({patternType:"none"})),Ee(t,45,m2({patternType:"gray125"})),Ee(t,604)}function MP(t){var e=1;Ee(t,613,Ls(e)),Ee(t,46,IP()),Ee(t,614)}function LP(t){var e=1;Ee(t,626,Ls(e)),Ee(t,47,LA({numFmtId:0},65535)),Ee(t,627)}function BP(t,e){Ee(t,617,Ls(e.length)),e.forEach(function(r){Ee(t,47,LA(r,0))}),Ee(t,618)}function jP(t){var e=1;Ee(t,619,Ls(e)),Ee(t,48,bP({xfId:0,name:"Normal"})),Ee(t,620)}function VP(t){var e=0;Ee(t,505,Ls(e)),Ee(t,506)}function UP(t){var e=0;Ee(t,508,RP(e,"TableStyleMedium9","PivotStyleMedium4")),Ee(t,509)}function zP(t,e){var r=bi();return Ee(r,278),DP(r,t.SSF),PP(r),OP(r),MP(r),LP(r),BP(r,e.cellXfs),jP(r),VP(r),UP(r),Ee(r,279),r.end()}var WP=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function HP(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(ri)||[]).forEach(function(i){var s=ct(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[WP.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function $P(){}function GP(){}var KP=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,XP=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,YP=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function qP(t,e,r){e.themeElements={};var n;[["clrScheme",KP,HP],["fontScheme",XP,$P],["fmtScheme",YP,GP]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var QP=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function BA(t,e){(!t||t.length===0)&&(t=J1());var r,n={};if(!(r=t.match(QP)))throw new Error("themeElements not found in theme");return qP(r[0],n,e),n.raw=t,n}function J1(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Gr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function JP(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var a;try{a=bS(s,{type:"array"})}catch{return}var o=ji(a,"theme/theme/theme1.xml",!0);if(o)return BA(o,r)}}function ZP(t){return t.read_shift(4)}function e6(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=t6(t,4);break;case 2:e.xclrValue=xA(t);break;case 3:e.xclrValue=ZP(t);break;case 4:t.l+=4;break}return t.l+=8,e}function t6(t,e){return ei(t,e)}function r6(t,e){return ei(t,e)}function n6(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=e6(t);break;case 6:n[1]=r6(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function i6(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push(n6(t,r-t.l));return{ixfe:n,ext:s}}function s6(t,e){e.forEach(function(r){switch(r[0]){}})}function a6(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Jn(t)}}function o6(t){var e=me(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),_n(t.name,e),e.slice(0,e.l)}function l6(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function c6(t){var e=me(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function u6(t,e){var r=me(8+2*e.length);return r.write_shift(4,t),_n(e,r),r.slice(0,r.l)}function f6(t){return t.l+=4,t.read_shift(4)!=0}function d6(t,e){var r=me(8);return r.write_shift(4,t),r.write_shift(4,1),r}function h6(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return Ka(t,function(l,c,d){switch(d){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(d),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!c.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function p6(){var t=bi();return Ee(t,332),Ee(t,334,Ls(1)),Ee(t,335,o6({name:"XLDAPR",version:12e4,flags:3496657072})),Ee(t,336),Ee(t,339,u6(1,"XLDAPR")),Ee(t,52),Ee(t,35,Ls(514)),Ee(t,4096,Ls(0)),Ee(t,4097,ts(1)),Ee(t,36),Ee(t,53),Ee(t,340),Ee(t,337,d6(1)),Ee(t,51,c6([[1,0]])),Ee(t,338),Ee(t,333),t.end()}function m6(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,a;return t.replace(ri,function(o){var l=ct(o);switch(la(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(a=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function jA(){var t=[Gr];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function g6(t){var e=[];if(!t)return e;var r=1;return(t.match(ri)||[]).forEach(function(n){var i=ct(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function x6(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=ot(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function v6(t,e,r){var n=[];return Ka(t,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function y6(t,e,r,n){if(!t)return t;var i=n||{},s=!1;Ka(t,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function _6(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Pc=1024;function VA(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[je("xml",null,{"xmlns:v":Mi.v,"xmlns:o":Mi.o,"xmlns:x":Mi.x,"xmlns:mv":Mi.mv}).replace(/\/>/,">"),je("o:shapelayout",je("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),je("v:shapetype",[je("v:stroke",null,{joinstyle:"miter"}),je("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Pc<t*1e3;)Pc+=1e3;return e.forEach(function(s){var a=Fr(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?je("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=je("v:fill",l,o),d={on:"t",obscured:"t"};++Pc,i=i.concat(["<v:shape"+ed({id:"_x0000_s"+Pc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,je("v:shadow",null,d),je("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",In("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),In("x:AutoFill","False"),In("x:Row",String(a.r)),In("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function g2(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(a){var o=Fr(a.ref);if(i?(t[o.r]||(t[o.r]=[]),s=t[o.r][o.c]):s=t[a.ref],!s){s={t:"z"},i?t[o.r][o.c]=s:t[a.ref]=s;var l=Ot(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=yt(l);c!==t["!ref"]&&(t["!ref"]=c)}s.c||(s.c=[]);var d={a:a.author,t:a.t,r:a.r,T:r};a.h&&(d.h=a.h);for(var h=s.c.length-1;h>=0;--h){if(!r&&s.c[h].T)return;r&&!s.c[h].T&&s.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(d.a==n[h].id){d.a=n[h].name||d.a;break}}s.c.push(d)})}function E6(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=ct(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},d=Fr(l.ref);if(!(e.sheetRows&&e.sheetRows<=d.r)){var h=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!h&&!!h[1]&&Y1(h[1])||{r:"",t:"",h:""};c.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),c.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=p.h),n.push(c)}}}}),n}function UA(t){var e=[Gr,je("comments",null,{xmlns:$l[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=Kt(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(Kt(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(In("t",Kt(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(In("t",Kt(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function w6(t,e){var r=[],n=!1,i={},s=0;return t.replace(ri,function(o,l){var c=ct(o);switch(la(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":i.t=t.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function T6(t,e,r){var n=[Gr,je("ThreadedComments",null,{xmlns:ln.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(je("threadedComment",In("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function S6(t,e){var r=[],n=!1;return t.replace(ri,function(s){var a=ct(s);switch(la(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function A6(t){var e=[Gr,je("personList",null,{xmlns:ln.TCMNT,"xmlns:x":$l[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(je("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function k6(t){var e={};e.iauthor=t.read_shift(4);var r=Yl(t);return e.rfx=r.s,e.ref=ot(r.s),t.l+=16,e}function C6(t,e){return e==null&&(e=me(36)),e.write_shift(4,t[1].iauthor),wu(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var F6=Jn;function I6(t){return _n(t.slice(0,54))}function b6(t,e){var r=[],n=[],i={},s=!1;return Ka(t,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function R6(t){var e=bi(),r=[];return Ee(e,628),Ee(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),Ee(e,632,I6(i.a)))})}),Ee(e,631),Ee(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Fr(n[0]),e:Fr(n[0])};Ee(e,635,C6([s,i])),i.t&&i.t.length>0&&Ee(e,637,ZR(i)),Ee(e,636),delete i.iauthor})}),Ee(e,634),Ee(e,629),e.end()}var N6="application/vnd.ms-office.vbaProject";function D6(t){var e=et.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");et.utils.cfb_add(e,i,t.FileIndex[n].content)}}),et.write(e)}function P6(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&et.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var zA=["xlsb","xlsm","xlam","biff8","xla"];function O6(){return{"!type":"dialog"}}function M6(){return{"!type":"dialog"}}function L6(){return{"!type":"macro"}}function B6(){return{"!type":"macro"}}var $c=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,d=a.length>0?parseInt(a,10)|0:0;return o?d+=e.c:--d,l?c+=e.r:--c,i+(o?"":"$")+Cr(d)+(l?"":"$")+$r(c)}return function(i,s){return e=s,i.replace(t,r)}}(),Z1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ev=function(){return function(e,r){return e.replace(Z1,function(n,i,s,a,o,l){var c=V1(a)-(s?0:r.c),d=j1(l)-(o?0:r.r),h=d==0?"":o?d+1:"["+d+"]",p=c==0?"":s?c+1:"["+c+"]";return i+"R"+h+"C"+p})}}();function WA(t,e){return t.replace(Z1,function(r,n,i,s,a,o){return n+(i=="$"?i+s:Cr(V1(s)+e.c))+(a=="$"?a+o:$r(j1(o)+e.r))})}function j6(t,e,r){var n=Ri(e),i=n.s,s=Fr(r),a={r:s.r-i.r,c:s.c-i.c};return WA(t,a)}function V6(t){return t.length!=1}function x2(t){return t.replace(/_xlfn\./g,"")}function Zr(t){t.l+=1}function Wo(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function HA(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return $A(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=Wo(t),o=Wo(t);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function $A(t){var e=Wo(t),r=Wo(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function U6(t,e,r){if(r.biff<8)return $A(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=Wo(t),a=Wo(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function GA(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return z6(t);var n=t.read_shift(r&&r.biff==12?4:2),i=Wo(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function z6(t){var e=Wo(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function W6(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function H6(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return $6(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function $6(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function G6(t,e,r){var n=(t[t.l++]&96)>>5,i=HA(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function K6(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=HA(t,s,r);return[n,i,a]}function X6(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Y6(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function q6(t,e,r){var n=(t[t.l++]&96)>>5,i=U6(t,e-1,r);return[n,i]}function Q6(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function v2(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function J6(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function Z6(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function e8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function t8(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function r8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function KA(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function n8(t){return t.read_shift(2),KA(t)}function i8(t){return t.read_shift(2),KA(t)}function s8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=GA(t,0,r);return[n,i]}function a8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=H6(t,0,r);return[n,i]}function o8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=GA(t,0,r);return[n,i,s]}function l8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[f5[i],qA[i],n]}function c8(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:u8(t);return[i,(s[0]===0?qA:u5)[s[1]]]}function u8(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function f8(t,e,r){t.l+=r&&r.biff==2?3:4}function d8(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function h8(t){return t.l++,Xa[t.read_shift(1)]}function p8(t){return t.l++,t.read_shift(2)}function m8(t){return t.l++,t.read_shift(1)!==0}function g8(t){return t.l++,Qn(t)}function x8(t,e,r){return t.l++,Cd(t,e-1,r)}function v8(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=zr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Xa[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Qn(t);break;case 2:r[1]=ql(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function y8(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Yl:Dp)(t));return i}function _8(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=v8(t,r.biff);return a}function E8(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function w8(t,e,r){if(r.biff==5)return T8(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function T8(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function S8(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function A8(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function k8(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function C8(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var F8=ei,I8=ei,b8=ei;function Id(t,e,r){return t.l+=2,[W6(t)]}function tv(t){return t.l+=6,[]}var R8=Id,N8=tv,D8=tv,P8=Id;function XA(t){return t.l+=2,[rn(t),t.read_shift(2)&1]}var O8=Id,M8=XA,L8=tv,B8=Id,j8=Id,V8=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function U8(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=V8[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function z8(t){return t.l+=2,[t.read_shift(4)]}function W8(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function H8(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function $8(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function G8(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function K8(t){return t.l+=4,[0,0]}var y2={1:{n:"PtgExp",f:d8},2:{n:"PtgTbl",f:b8},3:{n:"PtgAdd",f:Zr},4:{n:"PtgSub",f:Zr},5:{n:"PtgMul",f:Zr},6:{n:"PtgDiv",f:Zr},7:{n:"PtgPower",f:Zr},8:{n:"PtgConcat",f:Zr},9:{n:"PtgLt",f:Zr},10:{n:"PtgLe",f:Zr},11:{n:"PtgEq",f:Zr},12:{n:"PtgGe",f:Zr},13:{n:"PtgGt",f:Zr},14:{n:"PtgNe",f:Zr},15:{n:"PtgIsect",f:Zr},16:{n:"PtgUnion",f:Zr},17:{n:"PtgRange",f:Zr},18:{n:"PtgUplus",f:Zr},19:{n:"PtgUminus",f:Zr},20:{n:"PtgPercent",f:Zr},21:{n:"PtgParen",f:Zr},22:{n:"PtgMissArg",f:Zr},23:{n:"PtgStr",f:x8},26:{n:"PtgSheet",f:W8},27:{n:"PtgEndSheet",f:H8},28:{n:"PtgErr",f:h8},29:{n:"PtgBool",f:m8},30:{n:"PtgInt",f:p8},31:{n:"PtgNum",f:g8},32:{n:"PtgArray",f:Q6},33:{n:"PtgFunc",f:l8},34:{n:"PtgFuncVar",f:c8},35:{n:"PtgName",f:E8},36:{n:"PtgRef",f:s8},37:{n:"PtgArea",f:G6},38:{n:"PtgMemArea",f:S8},39:{n:"PtgMemErr",f:F8},40:{n:"PtgMemNoMem",f:I8},41:{n:"PtgMemFunc",f:A8},42:{n:"PtgRefErr",f:k8},43:{n:"PtgAreaErr",f:X6},44:{n:"PtgRefN",f:a8},45:{n:"PtgAreaN",f:q6},46:{n:"PtgMemAreaN",f:$8},47:{n:"PtgMemNoMemN",f:G8},57:{n:"PtgNameX",f:w8},58:{n:"PtgRef3d",f:o8},59:{n:"PtgArea3d",f:K6},60:{n:"PtgRefErr3d",f:C8},61:{n:"PtgAreaErr3d",f:Y6},255:{}},X8={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Y8={1:{n:"PtgElfLel",f:XA},2:{n:"PtgElfRw",f:B8},3:{n:"PtgElfCol",f:R8},6:{n:"PtgElfRwV",f:j8},7:{n:"PtgElfColV",f:P8},10:{n:"PtgElfRadical",f:O8},11:{n:"PtgElfRadicalS",f:L8},13:{n:"PtgElfColS",f:N8},15:{n:"PtgElfColSV",f:D8},16:{n:"PtgElfRadicalLel",f:M8},25:{n:"PtgList",f:U8},29:{n:"PtgSxName",f:z8},255:{}},q8={0:{n:"PtgAttrNoop",f:K8},1:{n:"PtgAttrSemi",f:r8},2:{n:"PtgAttrIf",f:e8},4:{n:"PtgAttrChoose",f:J6},8:{n:"PtgAttrGoto",f:Z6},16:{n:"PtgAttrSum",f:f8},32:{n:"PtgAttrBaxcel",f:v2},33:{n:"PtgAttrBaxcel",f:v2},64:{n:"PtgAttrSpace",f:n8},65:{n:"PtgAttrSpaceSemi",f:i8},128:{n:"PtgAttrIfError",f:t8},255:{}};function bd(t,e,r,n){if(n.biff<8)return ei(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=_8(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=y8(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(ei(t,e)),s}function Rd(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=y2[s]||y2[X8[s]],(s===24||s===25)&&(i=(s===24?Y8:q8)[t[t.l+1]]),!i||!i.f?ei(t,e):a.push([i.n,i.f(t,e,r)]);return a}function Q8(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var J8={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Z8(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function YA(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function _2(t,e,r){var n=YA(t,e,r);return n=="#REF"?n:Z8(n,r)}function Kn(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,c,d,h=0,p=0,g,y="";if(!t[0]||!t[0][0])return"";for(var x=-1,E="",T=0,A=t[0].length;T<A;++T){var _=t[0][T];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),x>=0){switch(t[0][x][1][0]){case 0:E=Br(" ",t[0][x][1][1]);break;case 1:E=Br("\r",t[0][x][1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}c=c+E,x=-1}o.push(c+J8[_[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Ef(_[1][1],a,i),o.push(wf(d,s));break;case"PtgRefN":d=r?Ef(_[1][1],r,i):_[1][1],o.push(wf(d,s));break;case"PtgRef3d":h=_[1][1],d=Ef(_[1][2],a,i),y=_2(n,h,i),o.push(y+"!"+wf(d,s));break;case"PtgFunc":case"PtgFuncVar":var P=_[1][0],W=_[1][1];P||(P=0),P&=127;var j=P==0?[]:o.slice(-P);o.length-=P,W==="User"&&(W=j.shift()),o.push(W+"("+j.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":g=Y_(_[1][1],r?{s:r}:a,i),o.push(Cm(g,i));break;case"PtgArea":g=Y_(_[1][1],a,i),o.push(Cm(g,i));break;case"PtgArea3d":h=_[1][1],g=_[1][2],y=_2(n,h,i),o.push(y+"!"+Cm(g,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=_[1][2];var w=(n.names||[])[p-1]||(n[0]||[])[p],F=w?w.Name:"SH33TJSNAME"+String(p);F&&F.slice(0,6)=="_xlfn."&&!i.xlfn&&(F=F.slice(6)),o.push(F);break;case"PtgNameX":var S=_[1][1];p=_[1][2];var b;if(i.biff<=5)S<0&&(S=-S),n[S]&&(b=n[S][p]);else{var N="";if(((n[S]||[])[0]||[])[0]==14849||(((n[S]||[])[0]||[])[0]==1025?n[S][p]&&n[S][p].itab>0&&(N=n.SheetNames[n[S][p].itab-1]+"!"):N=n.SheetNames[p-1]+"!"),n[S]&&n[S][p])N+=n[S][p].Name;else if(n[0]&&n[0][p])N+=n[0][p].Name;else{var D=(YA(n,S,i)||"").split(";;");D[p-1]?N=D[p-1]:N+="SH33TJSERRX"}o.push(N);break}b||(b={Name:"SH33TJSERRY"}),o.push(b.Name);break;case"PtgParen":var R="(",He=")";if(x>=0){switch(E="",t[0][x][1][0]){case 2:R=Br(" ",t[0][x][1][1])+R;break;case 3:R=Br("\r",t[0][x][1][1])+R;break;case 4:He=Br(" ",t[0][x][1][1])+He;break;case 5:He=Br("\r",t[0][x][1][1])+He;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}x=-1}o.push(R+o.pop()+He);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:_[1][1],r:_[1][0]};var ve={c:r.c,r:r.r};if(n.sharedf[ot(d)]){var Re=n.sharedf[ot(d)];o.push(Kn(Re,a,ve,n,i))}else{var Ae=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(d.c<c[0].s.c||d.c>c[0].e.c)&&!(d.r<c[0].s.r||d.r>c[0].e.r)){o.push(Kn(c[1],a,ve,n,i)),Ae=!0;break}Ae||o.push(_[1])}break;case"PtgArray":o.push("{"+Q8(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var _e=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&_e.indexOf(t[0][T][0])==-1){_=t[0][x];var Z=!0;switch(_[1][0]){case 4:Z=!1;case 0:E=Br(" ",_[1][1]);break;case 5:Z=!1;case 1:E=Br("\r",_[1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((Z?E:"")+o.pop()+(Z?"":E)),x=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function e5(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],ei(t,e-2)];var o=Rd(t,a,r);return e!==a+i&&(s=bd(t,e-a-i,o,r)),t.l=n,[o,s]}function t5(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],ei(t,e-2)];var o=Rd(t,a,r);return e!==a+i&&(s=bd(t,e-a-i,o,r)),t.l=n,[o,s]}function r5(t,e,r,n){var i=t.l+e,s=Rd(t,n,r),a;return i!==t.l&&(a=bd(t,i-t.l,s,r)),[s,a]}function n5(t,e,r){var n=t.l+e,i,s=t.read_shift(2),a=Rd(t,s,r);return s==65535?[[],ei(t,e-2)]:(e!==s+2&&(i=bd(t,n-s-2,a,r)),[a,i])}function i5(t){var e;if(ka(t,t.l+6)!==65535)return[Qn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function s5(t){if(t==null){var e=me(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Pl(t);return Pl(0)}function Nm(t,e,r){var n=t.l+e,i=ca(t);r.biff==2&&++t.l;var s=i5(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=t5(t,n-t.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function a5(t,e,r,n,i){var s=Ml(e,r,i),a=s5(t.v),o=me(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=me(t.bf.length),d=0;d<t.bf.length;++d)c[d]=t.bf[d];var h=yn([s,a,o,c]);return h}function Pp(t,e,r){var n=t.read_shift(4),i=Rd(t,n,r),s=t.read_shift(4),a=s>0?bd(t,s,i,r):null;return[i,a]}var o5=Pp,Op=Pp,l5=Pp,c5=Pp,u5={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},qA={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},f5={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function E2(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function d5(t){var e="of:="+t.replace(Z1,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Dm(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function h5(t){return t.replace(/\./,"!")}var Sf={},Gc={},Af=typeof Map<"u";function rv(t,e,r){var n=0,i=t.length;if(r){if(Af?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=Af?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(Af?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function Mp(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Yn=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=sd(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=Kh(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Sl(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Zo(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Na(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function QA(t,e,r,n,i,s){try{n.cellNF&&(t.z=st[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=pr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(st[e]==null&&Na(uR[e]||"General",e),t.t==="e")t.w=t.w||Xa[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Jf(t.v);else if(t.t==="d"){var a=dn(t.v);(a|0)===a?t.w=a.toString(10):t.w=Jf(a)}else{if(t.v===void 0)return"";t.w=Nl(t.v,Gc)}else t.t==="d"?t.w=us(e,dn(t.v),Gc):t.w=us(e,t.v,Gc)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Gh(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Gh(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function p5(t,e,r){if(t&&t["!ref"]){var n=Ot(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function m5(t,e){var r=Ot(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=yt(r))}var g5=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,x5=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,v5=/<(?:\w:)?hyperlink [^>]*>/mg,y5=/"(\w*:\w*)"/,_5=/<(?:\w:)?col\b[^>]*[\/]?>/g,E5=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,w5=/<(?:\w:)?pageMargins[^>]*\/>/g,JA=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,T5=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,S5=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function A5(t,e,r,n,i,s,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",d="",h=t.match(x5);h?(c=t.slice(0,h.index),d=t.slice(h.index+h[0].length)):c=d=t;var p=c.match(JA);p?nv(p[0],o,i,r):(p=c.match(T5))&&C5(p[0],p[1]||"",o,i,r);var g=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(g>0){var y=c.slice(g,g+50).match(y5);y&&m5(o,y[1])}var x=c.match(S5);x&&x[1]&&V5(x[1],i);var E=[];if(e.cellStyles){var T=c.match(_5);T&&O5(E,T)}h&&W5(h[1],o,e,l,s,a);var A=d.match(E5);A&&(o["!autofilter"]=L5(A[0]));var _=[],P=d.match(g5);if(P)for(g=0;g!=P.length;++g)_[g]=Ot(P[g].slice(P[g].indexOf('"')+1));var W=d.match(v5);W&&N5(o,W,n);var j=d.match(w5);if(j&&(o["!margins"]=D5(ct(j[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=yt(l)),e.sheetRows>0&&o["!ref"]){var w=Ot(o["!ref"]);e.sheetRows<=+w.e.r&&(w.e.r=e.sheetRows-1,w.e.r>l.e.r&&(w.e.r=l.e.r),w.e.r<w.s.r&&(w.s.r=w.e.r),w.e.c>l.e.c&&(w.e.c=l.e.c),w.e.c<w.s.c&&(w.s.c=w.e.c),o["!fullref"]=o["!ref"],o["!ref"]=yt(w))}return E.length>0&&(o["!cols"]=E),_.length>0&&(o["!merges"]=_),o}function k5(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+yt(t[r])+'"/>';return e+"</mergeCells>"}function nv(t,e,r,n){var i=ct(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Pt(Jt(i.codeName)))}function C5(t,e,r,n,i){nv(t.slice(0,t.indexOf(">")),r,n,i)}function F5(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=Zs(Kt(l))}if(t&&t["!outline"]){var c={summaryBelow:1,summaryRight:1};t["!outline"].above&&(c.summaryBelow=0),t["!outline"].left&&(c.summaryRight=0),o=(o||"")+je("outlinePr",null,c)}!s&&!o||(i[i.length]=je("sheetPr",o,a))}var I5=["objects","scenarios","selectLockedCells","selectUnlockedCells"],b5=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function R5(t){var e={sheet:1};return I5.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),b5.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=q1(t.password).toString(16).toUpperCase()),je("sheetProtection",null,e)}function N5(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=ct(Jt(e[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+Pt(s.location))):(s.Target="#"+Pt(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Ot(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var d=ot({c,r:l});n?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=s):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=s)}}}function D5(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function P5(t){return Sl(t),je("pageMargins",null,t)}function O5(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=ct(e[n],!0);i.hidden&&(i.hidden=dr(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,Q1(i.width)),zo(i);s<=a;)t[s++]=mr(i)}}function M5(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=je("col",null,Mp(i,n)));return r[r.length]="</cols>",r.join("")}function L5(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function B5(t,e,r,n){var i=typeof t.ref=="string"?t.ref:yt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=Ri(i);a.s.r==a.e.r&&(a.e.r=Ri(e["!ref"]).e.r,i=yt(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),je("autoFilter",null,{ref:i})}var j5=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function V5(t,e){e.Views||(e.Views=[{}]),(t.match(j5)||[]).forEach(function(r,n){var i=ct(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),dr(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function U5(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),je("sheetViews",je("sheetView",null,i),{})}function z5(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=Xa[t.v];break;case"d":n&&n.cellDates?i=pr(t.v,-1).toISOString():(t=mr(t),t.t="n",i=""+(t.v=dn(pr(t.v)))),typeof t.z>"u"&&(t.z=st[14]);break;default:i=t.v;break}var o=In("v",Kt(i)),l={r:e},c=Zo(n.cellXfs,t,n);switch(c!==0&&(l.s=c),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=In("v",""+rv(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=a),typeof t.f=="string"&&t.f){var d=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=je("f",Kt(t.f),d)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),je("c",o,l)}var W5=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=Zf("v"),a=Zf("f");return function(l,c,d,h,p,g){for(var y=0,x="",E=[],T=[],A=0,_=0,P=0,W="",j,w,F=0,S=0,b,N,D=0,R=0,He=Array.isArray(g.CellXf),ve,Re=[],Ae=[],_e=Array.isArray(c),Z=[],Ce={},Be=!1,U=!!d.sheetStubs,H=l.split(e),Q=0,X=H.length;Q!=X;++Q){x=H[Q].trim();var he=x.length;if(he!==0){var Te=0;e:for(y=0;y<he;++y)switch(x[y]){case">":if(x[y-1]!="/"){++y;break e}if(d&&d.cellStyles){if(w=ct(x.slice(Te,y),!0),F=w.r!=null?parseInt(w.r,10):F+1,S=-1,d.sheetRows&&d.sheetRows<F)continue;Ce={},Be=!1,w.ht&&(Be=!0,Ce.hpt=parseFloat(w.ht),Ce.hpx=au(Ce.hpt)),w.hidden=="1"&&(Be=!0,Ce.hidden=!0),w.outlineLevel!=null&&(Be=!0,Ce.level=+w.outlineLevel),Be&&(Z[F-1]=Ce)}break;case"<":Te=y;break}if(Te>=y)break;if(w=ct(x.slice(Te,y),!0),F=w.r!=null?parseInt(w.r,10):F+1,S=-1,!(d.sheetRows&&d.sheetRows<F)){h.s.r>F-1&&(h.s.r=F-1),h.e.r<F-1&&(h.e.r=F-1),d&&d.cellStyles&&(Ce={},Be=!1,w.ht&&(Be=!0,Ce.hpt=parseFloat(w.ht),Ce.hpx=au(Ce.hpt)),w.hidden=="1"&&(Be=!0,Ce.hidden=!0),w.outlineLevel!=null&&(Be=!0,Ce.level=+w.outlineLevel),Be&&(Z[F-1]=Ce)),E=x.slice(y).split(t);for(var Pe=0;Pe!=E.length&&E[Pe].trim().charAt(0)=="<";++Pe);for(E=E.slice(Pe),y=0;y!=E.length;++y)if(x=E[y].trim(),x.length!==0){if(T=x.match(r),A=y,_=0,P=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,T!=null&&T.length===2){for(A=0,W=T[1],_=0;_!=W.length&&!((P=W.charCodeAt(_)-64)<1||P>26);++_)A=26*A+P;--A,S=A}else++S;for(_=0;_!=x.length&&x.charCodeAt(_)!==62;++_);if(++_,w=ct(x.slice(0,_),!0),w.r||(w.r=ot({r:F-1,c:S})),W=x.slice(_),j={t:""},(T=W.match(s))!=null&&T[1]!==""&&(j.v=Pt(T[1])),d.cellFormula){if((T=W.match(a))!=null&&T[1]!==""){if(j.f=Pt(Jt(T[1])).replace(/\r\n/g,`
`),d.xlfn||(j.f=x2(j.f)),T[0].indexOf('t="array"')>-1)j.F=(W.match(i)||[])[1],j.F.indexOf(":")>-1&&Re.push([Ot(j.F),j.F]);else if(T[0].indexOf('t="shared"')>-1){N=ct(T[0]);var ke=Pt(Jt(T[1]));d.xlfn||(ke=x2(ke)),Ae[parseInt(N.si,10)]=[N,ke,w.r]}}else(T=W.match(/<f[^>]*\/>/))&&(N=ct(T[0]),Ae[N.si]&&(j.f=j6(Ae[N.si][1],Ae[N.si][2],w.r)));var we=Fr(w.r);for(_=0;_<Re.length;++_)we.r>=Re[_][0].s.r&&we.r<=Re[_][0].e.r&&we.c>=Re[_][0].s.c&&we.c<=Re[_][0].e.c&&(j.F=Re[_][1])}if(w.t==null&&j.v===void 0)if(j.f||j.F)j.v=0,j.t="n";else if(U)j.t="z";else continue;else j.t=w.t||"n";switch(h.s.c>S&&(h.s.c=S),h.e.c<S&&(h.e.c=S),j.t){case"n":if(j.v==""||j.v==null){if(!U)continue;j.t="z"}else j.v=parseFloat(j.v);break;case"s":if(typeof j.v>"u"){if(!U)continue;j.t="z"}else b=Sf[parseInt(j.v,10)],j.v=b.t,j.r=b.r,d.cellHTML&&(j.h=b.h);break;case"str":j.t="s",j.v=j.v!=null?Jt(j.v):"",d.cellHTML&&(j.h=O1(j.v));break;case"inlineStr":T=W.match(n),j.t="s",T!=null&&(b=Y1(T[1]))?(j.v=b.t,d.cellHTML&&(j.h=b.h)):j.v="";break;case"b":j.v=dr(j.v);break;case"d":d.cellDates?j.v=pr(j.v,1):(j.v=dn(pr(j.v,1)),j.t="n");break;case"e":(!d||d.cellText!==!1)&&(j.w=j.v),j.v=eA[j.v];break}if(D=R=0,ve=null,He&&w.s!==void 0&&(ve=g.CellXf[w.s],ve!=null&&(ve.numFmtId!=null&&(D=ve.numFmtId),d.cellStyles&&ve.fillId!=null&&(R=ve.fillId))),QA(j,D,R,d,p,g),d.cellDates&&He&&j.t=="n"&&yu(st[D])&&(j.t="d",j.v=Np(j.v)),w.cm&&d.xlmeta){var nt=(d.xlmeta.Cell||[])[+w.cm-1];nt&&nt.type=="XLDAPR"&&(j.D=!0)}if(_e){var G=Fr(w.r);c[G.r]||(c[G.r]=[]),c[G.r][G.c]=j}else c[w.r]=j}}}}Z.length>0&&(c["!rows"]=Z)}}();function H5(t,e,r,n){var i=[],s=[],a=Ot(t["!ref"]),o="",l,c="",d=[],h=0,p=0,g=t["!rows"],y=Array.isArray(t),x={r:c},E,T=-1;for(p=a.s.c;p<=a.e.c;++p)d[p]=Cr(p);for(h=a.s.r;h<=a.e.r;++h){for(s=[],c=$r(h),p=a.s.c;p<=a.e.c;++p){l=d[p]+c;var A=y?(t[h]||[])[p]:t[l];A!==void 0&&(o=z5(A,l,t,e))!=null&&s.push(o)}(s.length>0||g&&g[h])&&(x={r:c},g&&g[h]&&(E=g[h],E.hidden&&(x.hidden=1),T=-1,E.hpx?T=ad(E.hpx):E.hpt&&(T=E.hpt),T>-1&&(x.ht=T,x.customHeight=1),E.level&&(x.outlineLevel=E.level)),i[i.length]=je("row",s.join(""),x))}if(g)for(;h<g.length;++h)g&&g[h]&&(x={r:h+1},E=g[h],E.hidden&&(x.hidden=1),T=-1,E.hpx?T=ad(E.hpx):E.hpt&&(T=E.hpt),T>-1&&(x.ht=T,x.customHeight=1),E.level&&(x.outlineLevel=E.level),i[i.length]=je("row","",x));return i.join("")}function ZA(t,e,r,n){var i=[Gr,je("worksheet",null,{xmlns:$l[0],"xmlns:r":ln.r})],s=r.SheetNames[t],a=0,o="",l=r.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",d=Ot(c);if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),c=yt(d)}n||(n={}),l["!comments"]=[];var h=[];F5(l,r,t,e,i),i[i.length]=je("dimension",null,{ref:c}),i[i.length]=U5(l,e,t,r),e.sheetFormat&&(i[i.length]=je("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=M5(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=H5(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=R5(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=B5(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=k5(l["!merges"]));var p=-1,g,y=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(g={ref:x[0]},x[1].Target.charAt(0)!="#"&&(y=Gt(n,-1,Kt(x[1].Target).replace(/#.*$/,""),wt.HLINK),g["r:id"]="rId"+y),(p=x[1].Target.indexOf("#"))>-1&&(g.location=Kt(x[1].Target.slice(p+1))),x[1].Tooltip&&(g.tooltip=Kt(x[1].Tooltip)),i[i.length]=je("hyperlink",null,g))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=P5(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=In("ignoredErrors",je("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(y=Gt(n,-1,"../drawings/drawing"+(t+1)+".xml",wt.DRAW),i[i.length]=je("drawing",null,{"r:id":"rId"+y}),l["!drawing"]=h),l["!comments"].length>0&&(y=Gt(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",wt.VML),i[i.length]=je("legacyDrawing",null,{"r:id":"rId"+y}),l["!legacy"]=y),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function $5(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function G5(t,e,r){var n=me(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=ad(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:t,c:0},d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var h=-1,p=-1,g=d<<10;g<d+1<<10;++g){c.c=g;var y=Array.isArray(r)?(r[c.r]||[])[c.c]:r[ot(c)];y&&(h<0&&(h=g),p=g)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,p))}var x=n.l;return n.l=l,n.write_shift(4,o),n.l=x,n.length>n.l?n.slice(0,n.l):n}function K5(t,e,r,n){var i=G5(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&Ee(t,0,i)}var X5=Yl,Y5=wu;function q5(){}function Q5(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=eN(t),r}function J5(t,e,r){r==null&&(r=me(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Wh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),YS(t,r),r.slice(0,r.l)}function Z5(t){var e=fs(t);return[e]}function eO(t,e,r){return r==null&&(r=me(8)),Gl(e,r)}function tO(t){var e=Kl(t);return[e]}function rO(t,e,r){return r==null&&(r=me(4)),Xl(e,r)}function nO(t){var e=fs(t),r=t.read_shift(1);return[e,r,"b"]}function iO(t,e,r){return r==null&&(r=me(9)),Gl(e,r),r.write_shift(1,t.v?1:0),r}function sO(t){var e=Kl(t),r=t.read_shift(1);return[e,r,"b"]}function aO(t,e,r){return r==null&&(r=me(5)),Xl(e,r),r.write_shift(1,t.v?1:0),r}function oO(t){var e=fs(t),r=t.read_shift(1);return[e,r,"e"]}function lO(t,e,r){return r==null&&(r=me(9)),Gl(e,r),r.write_shift(1,t.v),r}function cO(t){var e=Kl(t),r=t.read_shift(1);return[e,r,"e"]}function uO(t,e,r){return r==null&&(r=me(8)),Xl(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function fO(t){var e=fs(t),r=t.read_shift(4);return[e,r,"s"]}function dO(t,e,r){return r==null&&(r=me(12)),Gl(e,r),r.write_shift(4,e.v),r}function hO(t){var e=Kl(t),r=t.read_shift(4);return[e,r,"s"]}function pO(t,e,r){return r==null&&(r=me(8)),Xl(e,r),r.write_shift(4,e.v),r}function mO(t){var e=fs(t),r=Qn(t);return[e,r,"n"]}function gO(t,e,r){return r==null&&(r=me(16)),Gl(e,r),Pl(t.v,r),r}function ek(t){var e=Kl(t),r=Qn(t);return[e,r,"n"]}function xO(t,e,r){return r==null&&(r=me(12)),Xl(e,r),Pl(t.v,r),r}function vO(t){var e=fs(t),r=H1(t);return[e,r,"n"]}function yO(t,e,r){return r==null&&(r=me(12)),Gl(e,r),qS(t.v,r),r}function _O(t){var e=Kl(t),r=H1(t);return[e,r,"n"]}function EO(t,e,r){return r==null&&(r=me(8)),Xl(e,r),qS(t.v,r),r}function wO(t){var e=fs(t),r=U1(t);return[e,r,"is"]}function TO(t){var e=fs(t),r=Jn(t);return[e,r,"str"]}function SO(t,e,r){return r==null&&(r=me(12+4*t.v.length)),Gl(e,r),_n(t.v,r),r.length>r.l?r.slice(0,r.l):r}function AO(t){var e=Kl(t),r=Jn(t);return[e,r,"str"]}function kO(t,e,r){return r==null&&(r=me(8+4*t.v.length)),Xl(e,r),_n(t.v,r),r.length>r.l?r.slice(0,r.l):r}function CO(t,e,r){var n=t.l+e,i=fs(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=Op(t,n-t.l,r);a[3]=Kn(o,null,i,r.supbooks,r)}else t.l=n;return a}function FO(t,e,r){var n=t.l+e,i=fs(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=Op(t,n-t.l,r);a[3]=Kn(o,null,i,r.supbooks,r)}else t.l=n;return a}function IO(t,e,r){var n=t.l+e,i=fs(t);i.r=r["!row"];var s=Qn(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=Op(t,n-t.l,r);a[3]=Kn(o,null,i,r.supbooks,r)}else t.l=n;return a}function bO(t,e,r){var n=t.l+e,i=fs(t);i.r=r["!row"];var s=Jn(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=Op(t,n-t.l,r);a[3]=Kn(o,null,i,r.supbooks,r)}else t.l=n;return a}var RO=Yl,NO=wu;function DO(t,e){return e==null&&(e=me(4)),e.write_shift(4,t),e}function PO(t,e){var r=t.l+e,n=Yl(t),i=z1(t),s=Jn(t),a=Jn(t),o=Jn(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function OO(t,e){var r=me(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));wu({s:Fr(t[0]),e:Fr(t[0])},r),W1("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return _n(i||"",r),_n(t[1].Tooltip||"",r),_n("",r),r.slice(0,r.l)}function MO(){}function LO(t,e,r){var n=t.l+e,i=QS(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=o5(t,n-t.l,r);a[1]=o}else t.l=n;return a}function BO(t,e,r){var n=t.l+e,i=Yl(t),s=[i];if(r.cellFormula){var a=c5(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function jO(t,e,r){r==null&&(r=me(18));var n=Mp(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var tk=["left","right","top","bottom","header","footer"];function VO(t){var e={};return tk.forEach(function(r){e[r]=Qn(t)}),e}function UO(t,e){return e==null&&(e=me(6*8)),Sl(t),tk.forEach(function(r){Pl(t[r],e)}),e}function zO(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function WO(t,e,r){r==null&&(r=me(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function HO(t){var e=me(24);return e.write_shift(4,4),e.write_shift(4,1),wu(t,e),e}function $O(t,e){return e==null&&(e=me(16*4+2)),e.write_shift(2,t.password?q1(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function GO(){}function KO(){}function XO(t,e,r,n,i,s,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,p=!1,g,y,x,E,T,A,_,P,W,j=[];o.biff=12,o["!row"]=0;var w=0,F=!1,S=[],b={},N=o.supbooks||i.supbooks||[[]];if(N.sharedf=b,N.arrayf=S,N.SheetNames=i.SheetNames||i.Sheets.map(function(_e){return _e.name}),!o.supbooks&&(o.supbooks=N,i.Names))for(var D=0;D<i.Names.length;++D)N[0][D+1]=i.Names[D];var R=[],He=[],ve=!1;od[16]={n:"BrtShortReal",f:ek};var Re;if(Ka(t,function(Z,Ce,Be){if(!p)switch(Be){case 148:c=Z;break;case 0:g=Z,o.sheetRows&&o.sheetRows<=g.r&&(p=!0),P=$r(E=g.r),o["!row"]=g.r,(Z.hidden||Z.hpt||Z.level!=null)&&(Z.hpt&&(Z.hpx=au(Z.hpt)),He[Z.r]=Z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:Z[2]},Z[2]){case"n":y.v=Z[1];break;case"s":_=Sf[Z[1]],y.v=_.t,y.r=_.r;break;case"b":y.v=!!Z[1];break;case"e":y.v=Z[1],o.cellText!==!1&&(y.w=Xa[y.v]);break;case"str":y.t="s",y.v=Z[1];break;case"is":y.t="s",y.v=Z[1].t;break}if((x=a.CellXf[Z[0].iStyleRef])&&QA(y,x.numFmtId,null,o,s,a),T=Z[0].c==-1?T+1:Z[0].c,o.dense?(l[E]||(l[E]=[]),l[E][T]=y):l[Cr(T)+P]=y,o.cellFormula){for(F=!1,w=0;w<S.length;++w){var U=S[w];g.r>=U[0].s.r&&g.r<=U[0].e.r&&T>=U[0].s.c&&T<=U[0].e.c&&(y.F=yt(U[0]),F=!0)}!F&&Z.length>3&&(y.f=Z[3])}if(d.s.r>g.r&&(d.s.r=g.r),d.s.c>T&&(d.s.c=T),d.e.r<g.r&&(d.e.r=g.r),d.e.c<T&&(d.e.c=T),o.cellDates&&x&&y.t=="n"&&yu(st[x.numFmtId])){var H=xl(y.v);H&&(y.t="d",y.v=new Date(H.y,H.m-1,H.d,H.H,H.M,H.S,H.u))}Re&&(Re.type=="XLDAPR"&&(y.D=!0),Re=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;y={t:"z",v:void 0},T=Z[0].c==-1?T+1:Z[0].c,o.dense?(l[E]||(l[E]=[]),l[E][T]=y):l[Cr(T)+P]=y,d.s.r>g.r&&(d.s.r=g.r),d.s.c>T&&(d.s.c=T),d.e.r<g.r&&(d.e.r=g.r),d.e.c<T&&(d.e.c=T),Re&&(Re.type=="XLDAPR"&&(y.D=!0),Re=void 0);break;case 176:j.push(Z);break;case 49:Re=((o.xlmeta||{}).Cell||[])[Z-1];break;case 494:var Q=n["!id"][Z.relId];for(Q?(Z.Target=Q.Target,Z.loc&&(Z.Target+="#"+Z.loc),Z.Rel=Q):Z.relId==""&&(Z.Target="#"+Z.loc),E=Z.rfx.s.r;E<=Z.rfx.e.r;++E)for(T=Z.rfx.s.c;T<=Z.rfx.e.c;++T)o.dense?(l[E]||(l[E]=[]),l[E][T]||(l[E][T]={t:"z",v:void 0}),l[E][T].l=Z):(A=ot({c:T,r:E}),l[A]||(l[A]={t:"z",v:void 0}),l[A].l=Z);break;case 426:if(!o.cellFormula)break;S.push(Z),W=o.dense?l[E][T]:l[Cr(T)+P],W.f=Kn(Z[1],d,{r:g.r,c:T},N,o),W.F=yt(Z[0]);break;case 427:if(!o.cellFormula)break;b[ot(Z[0].s)]=Z[1],W=o.dense?l[E][T]:l[Cr(T)+P],W.f=Kn(Z[1],d,{r:g.r,c:T},N,o);break;case 60:if(!o.cellStyles)break;for(;Z.e>=Z.s;)R[Z.e--]={width:Z.w/256,hidden:!!(Z.flags&1),level:Z.level},ve||(ve=!0,Q1(Z.w/256)),zo(R[Z.e+1]);break;case 161:l["!autofilter"]={ref:yt(Z)};break;case 476:l["!margins"]=Z;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),Z.name&&(i.Sheets[r].CodeName=Z.name),(Z.above||Z.left)&&(l["!outline"]={above:Z.above,left:Z.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),Z.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!Ce.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+Be.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(d.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=yt(c||d)),o.sheetRows&&l["!ref"]){var Ae=Ot(l["!ref"]);o.sheetRows<=+Ae.e.r&&(Ae.e.r=o.sheetRows-1,Ae.e.r>d.e.r&&(Ae.e.r=d.e.r),Ae.e.r<Ae.s.r&&(Ae.s.r=Ae.e.r),Ae.e.c>d.e.c&&(Ae.e.c=d.e.c),Ae.e.c<Ae.s.c&&(Ae.s.c=Ae.e.c),l["!fullref"]=l["!ref"],l["!ref"]=yt(Ae))}return j.length>0&&(l["!merges"]=j),R.length>0&&(l["!cols"]=R),He.length>0&&(l["!rows"]=He),l}function YO(t,e,r,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=mr(e),e.z=e.z||st[14],e.v=dn(pr(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r,c:n};switch(l.s=Zo(i.cellXfs,e,i),e.l&&s["!links"].push([ot(l),e.l]),e.c&&s["!comments"].push([ot(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=rv(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?Ee(t,18,pO(e,l)):Ee(t,7,dO(e,l))):(l.t="str",a?Ee(t,17,kO(e,l)):Ee(t,6,SO(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?Ee(t,13,EO(e,l)):Ee(t,2,yO(e,l)):a?Ee(t,16,xO(e,l)):Ee(t,5,gO(e,l)),!0;case"b":return l.t="b",a?Ee(t,15,aO(e,l)):Ee(t,4,iO(e,l)),!0;case"e":return l.t="e",a?Ee(t,14,uO(e,l)):Ee(t,3,lO(e,l)),!0}return a?Ee(t,12,rO(e,l)):Ee(t,1,eO(e,l)),!0}function qO(t,e,r,n){var i=Ot(e["!ref"]||"A1"),s,a="",o=[];Ee(t,145);var l=Array.isArray(e),c=i.e.r;e["!rows"]&&(c=Math.max(i.e.r,e["!rows"].length-1));for(var d=i.s.r;d<=c;++d){a=$r(d),K5(t,e,i,d);var h=!1;if(d<=i.e.r)for(var p=i.s.c;p<=i.e.c;++p){d===i.s.r&&(o[p]=Cr(p)),s=o[p]+a;var g=l?(e[d]||[])[p]:e[s];if(!g){h=!1;continue}h=YO(t,g,d,p,n,e,h)}}Ee(t,146)}function QO(t,e){!e||!e["!merges"]||(Ee(t,177,DO(e["!merges"].length)),e["!merges"].forEach(function(r){Ee(t,176,NO(r))}),Ee(t,178))}function JO(t,e){!e||!e["!cols"]||(Ee(t,390),e["!cols"].forEach(function(r,n){r&&Ee(t,60,jO(n,r))}),Ee(t,391))}function ZO(t,e){!e||!e["!ref"]||(Ee(t,648),Ee(t,649,HO(Ot(e["!ref"]))),Ee(t,650))}function eM(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=Gt(r,-1,n[1].Target.replace(/#.*$/,""),wt.HLINK);Ee(t,494,OO(n,i))}}),delete e["!links"]}function tM(t,e,r,n){if(e["!comments"].length>0){var i=Gt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",wt.VML);Ee(t,551,W1("rId"+i)),e["!legacy"]=i}}function rM(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:yt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Ri(s);o.s.r==o.e.r&&(o.e.r=Ri(e["!ref"]).e.r,s=yt(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Ee(t,161,wu(Ot(s))),Ee(t,162)}}function nM(t,e,r){Ee(t,133),Ee(t,137,WO(e,r)),Ee(t,138),Ee(t,134)}function iM(t,e){e["!protect"]&&Ee(t,535,$O(e["!protect"]))}function sM(t,e,r,n){var i=bi(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=Ot(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Ee(i,129),(r.vbaraw||a["!outline"])&&Ee(i,147,J5(o,a["!outline"])),Ee(i,148,Y5(l)),nM(i,a,r.Workbook),JO(i,a),qO(i,a,t,e),iM(i,a),rM(i,a,r,t),QO(i,a),eM(i,a,n),a["!margins"]&&Ee(i,476,UO(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&ZO(i,a),tM(i,a,t,n),Ee(i,130),i.end()}function aM(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var i=Pt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function oM(t,e,r,n,i,s){var a=s||{"!type":"chart"};if(!t)return s;var o=0,l=0,c="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var p=aM(h);d.s.r=d.s.c=0,d.e.c=o,c=Cr(o),p[0].forEach(function(g,y){a[c+$r(y)]={t:"n",v:g,z:p[1]},l=y}),d.e.r<l&&(d.e.r=l),++o}),o>0&&(a["!ref"]=yt(d)),a}function lM(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(JA);return o&&nv(o[0],s,i,r),(a=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function cM(t,e){t.l+=10;var r=Jn(t);return{name:r}}function uM(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return Ka(t,function(l,c,d){switch(d){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var iv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],fM=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],dM=[],hM=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function w2(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=dr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function T2(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=dr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function rk(t){T2(t.WBProps,iv),T2(t.CalcPr,hM),w2(t.WBView,fM),w2(t.Sheets,dM),Gc.date1904=dr(t.WBProps.date1904)}function pM(t){return!t.Workbook||!t.Workbook.WBProps?"false":dr(t.Workbook.WBProps.date1904)?"true":"false"}var mM="][*?/\\".split("");function nk(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return mM.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function gM(t,e,r){t.forEach(function(n,i){nk(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function xM(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];gM(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)p5(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var vM=/<\w+:workbook/;function yM(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(t.replace(ri,function(l,c){var d=ct(l);switch(la(d[0])){case"<?xml":break;case"<workbook":l.match(vM)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=d[i];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":iv.forEach(function(h){if(d[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=dr(d[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(d[h[0]],10);break;default:r.WBProps[h[0]]=d[h[0]]}}),d.codeName&&(r.WBProps.CodeName=Jt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Pt(Jt(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Jt(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),dr(d.hidden||"0")&&(s.Hidden=!0),a=c+l.length;break;case"</definedName>":s.Ref=Pt(Jt(t.slice(a,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return l}),$l.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return rk(r),r}function ik(t){var e=[Gr];e[e.length]=je("workbook",null,{xmlns:$l[0],"xmlns:r":ln.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(iv.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=je("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:Kt(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=je("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=je("definedName",Kt(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function _M(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Jg(t),r.name=Jn(t),r}function EM(t,e){return e||(e=me(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),W1(t.strRelID,e),_n(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function wM(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?Jn(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function TM(t,e){e||(e=me(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),YS(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function SM(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function AM(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=tN(t),a=l5(t,0,r),o=z1(t);t.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function kM(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],od[16]={n:"BrtFRTArchID$",f:SM},Ka(t,function(l,c,d){switch(d){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=Kn(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([d,l]):a[0]=[d,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(d),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},e),rk(r),r.Names=s,r.supbooks=a,r}function CM(t,e){Ee(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Ee(t,156,EM(i))}Ee(t,144)}function FM(t,e){e||(e=me(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return _n("SheetJS",e),_n(Mh.version,e),_n(Mh.version,e),_n("7262",e),e.length>e.l?e.slice(0,e.l):e}function IM(t,e){e||(e=me(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function bM(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(Ee(t,135),Ee(t,158,IM(i)),Ee(t,136))}}function RM(t,e){var r=bi();return Ee(r,131),Ee(r,128,FM()),Ee(r,153,TM(t.Workbook&&t.Workbook.WBProps||null)),bM(r,t),CM(r,t),Ee(r,132),r.end()}function NM(t,e,r){return e.slice(-4)===".bin"?kM(t,r):yM(t,r)}function DM(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?XO(t,n,r,i,s,a,o):A5(t,n,r,i,s,a,o)}function PM(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?uM(t,n,r,i,s):lM(t,n,r,i,s)}function OM(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?L6():B6()}function MM(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?O6():M6()}function LM(t,e,r,n){return e.slice(-4)===".bin"?NP(t,r,n):_P(t,r,n)}function BM(t,e,r){return BA(t,r)}function jM(t,e,r){return e.slice(-4)===".bin"?jD(t,r):MD(t,r)}function VM(t,e,r){return e.slice(-4)===".bin"?b6(t,r):E6(t,r)}function UM(t,e,r){return e.slice(-4)===".bin"?v6(t):g6(t)}function zM(t,e,r,n){return r.slice(-4)===".bin"?y6(t,e,r,n):void 0}function WM(t,e,r){return e.slice(-4)===".bin"?h6(t,e,r):m6(t,e,r)}function HM(t,e,r){return(e.slice(-4)===".bin"?RM:ik)(t)}function $M(t,e,r,n,i){return(e.slice(-4)===".bin"?sM:ZA)(t,r,n,i)}function GM(t,e,r){return(e.slice(-4)===".bin"?zP:MA)(t,r)}function KM(t,e,r){return(e.slice(-4)===".bin"?zD:FA)(t,r)}function XM(t,e,r){return(e.slice(-4)===".bin"?R6:UA)(t)}function YM(t){return(t.slice(-4)===".bin"?p6:jA)()}var sk=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,ak=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Cs(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(sk),s,a,o,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(ak),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function qM(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(sk),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(ak),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var kf;function QM(t,e){var r=kf[t]||Pt(t);return r==="General"?Nl(e):us(r,e)}function JM(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=dr(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=pr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Pt(e)]=i}function ZM(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Xa[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Jf(t.v):t.w=Nl(t.v):t.w=QM(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=kf[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&yu(n)){var i=xl(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function eL(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=dP[n.Pattern]||n.Pattern)}t[e.ID]=e}function tL(t,e,r,n,i,s,a,o,l,c){var d="General",h=n.StyleID,p={};c=c||{};var g=[],y=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&a&&(h=a.StyleID);s[h]!==void 0&&(s[h].nf&&(d=s[h].nf),s[h].Interior&&g.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=dr(t);break;case"String":n.t="s",n.r=V_(Pt(t)),n.v=t.indexOf("<")>-1?Pt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(pr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Pt(t):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=eA[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=V_(e||t));break}if(ZM(n,d,c),c.cellFormula!==!1)if(n.Formula){var x=Pt(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=$c(x,i),delete n.Formula,n.ArrayRange=="RC"?n.F=$c("RC:RC",i):n.ArrayRange&&(n.F=$c(n.ArrayRange,i),l.push([Ot(n.F),n.F]))}else for(y=0;y<l.length;++y)i.r>=l[y][0].s.r&&i.r<=l[y][0].e.r&&i.c>=l[y][0].s.c&&i.c<=l[y][0].e.c&&(n.F=l[y][1]);c.cellStyles&&(g.forEach(function(E){!p.patternType&&E.patternType&&(p.patternType=E.patternType)}),n.s=p),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function rL(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Pm(t,e){var r=e||{};_u();var n=nf(M1(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Jt(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=mr(r);return a.type="string",su.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(qt){i.indexOf("<"+qt)>=0&&(s=!0)}),s)return UL(n,r);kf={"General Number":"General","General Date":st[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":st[15],"Short Date":st[14],"Long Time":st[19],"Medium Time":st[18],"Short Time":st[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:st[2],Standard:st[4],Percent:st[10],Scientific:st[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,d={},h=[],p=r.dense?[]:{},g="",y={},x={},E=Cs('<Data ss:Type="String">'),T=0,A=0,_=0,P={s:{r:2e6,c:2e6},e:{r:0,c:0}},W={},j={},w="",F=0,S=[],b={},N={},D=0,R=[],He=[],ve={},Re=[],Ae,_e=!1,Z=[],Ce=[],Be={},U=0,H=0,Q={Sheets:[],WBProps:{date1904:!1}},X={};td.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var he="";o=td.exec(n);)switch(o[3]=(he=o[3]).toLowerCase()){case"data":if(he=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?tL(n.slice(T,o.index),w,E,l[l.length-1][0]=="comment"?ve:y,{c:A,r:_},W,Re[A],x,Z,r):(w="",E=Cs(o[0]),T=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(He.length>0&&(y.c=He),(!r.sheetRows||r.sheetRows>_)&&y.v!==void 0&&(r.dense?(p[_]||(p[_]=[]),p[_][A]=y):p[Cr(A)+$r(_)]=y),y.HRef&&(y.l={Target:Pt(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(U=A+(parseInt(y.MergeAcross,10)|0),H=_+(parseInt(y.MergeDown,10)|0),S.push({s:{c:A,r:_},e:{c:U,r:H}})),!r.sheetStubs)y.MergeAcross?A=U+1:++A;else if(y.MergeAcross||y.MergeDown){for(var Te=A;Te<=U;++Te)for(var Pe=_;Pe<=H;++Pe)(Te>A||Pe>_)&&(r.dense?(p[Pe]||(p[Pe]=[]),p[Pe][Te]={t:"z"}):p[Cr(Te)+$r(Pe)]={t:"z"});A=U+1}else++A;else y=qM(o[0]),y.Index&&(A=+y.Index-1),A<P.s.c&&(P.s.c=A),A>P.e.c&&(P.e.c=A),o[0].slice(-2)==="/>"&&++A,He=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(_<P.s.r&&(P.s.r=_),_>P.e.r&&(P.e.r=_),o[0].slice(-2)==="/>"&&(x=Cs(o[0]),x.Index&&(_=+x.Index-1)),A=0,++_):(x=Cs(o[0]),x.Index&&(_=+x.Index-1),Be={},(x.AutoFitHeight=="0"||x.Height)&&(Be.hpx=parseInt(x.Height,10),Be.hpt=ad(Be.hpx),Ce[_]=Be),x.Hidden=="1"&&(Be.hidden=!0,Ce[_]=Be));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(g),P.s.r<=P.e.r&&P.s.c<=P.e.c&&(p["!ref"]=yt(P),r.sheetRows&&r.sheetRows<=P.e.r&&(p["!fullref"]=p["!ref"],P.e.r=r.sheetRows-1,p["!ref"]=yt(P))),S.length&&(p["!merges"]=S),Re.length>0&&(p["!cols"]=Re),Ce.length>0&&(p["!rows"]=Ce),d[g]=p}else P={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=A=0,l.push([o[3],!1]),c=Cs(o[0]),g=Pt(c.Name),p=r.dense?[]:{},S=[],Z=[],Ce=[],X={name:g,Hidden:0},Q.Sheets.push(X);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),Re=[],_e=!1}break;case"style":o[1]==="/"?eL(W,j,r):j=Cs(o[0]);break;case"numberformat":j.nf=Pt(Cs(o[0]).Format||"General"),kf[j.nf]&&(j.nf=kf[j.nf]);for(var ke=0;ke!=392&&st[ke]!=j.nf;++ke);if(ke==392){for(ke=57;ke!=392;++ke)if(st[ke]==null){Na(j.nf,ke);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(Ae=Cs(o[0]),Ae.Hidden&&(Ae.hidden=!0,delete Ae.Hidden),Ae.Width&&(Ae.wpx=parseInt(Ae.Width,10)),!_e&&Ae.wpx>10){_e=!0,Yn=PA;for(var we=0;we<Re.length;++we)Re[we]&&zo(Re[we])}_e&&zo(Ae),Re[Ae.Index-1||Re.length]=Ae;for(var nt=0;nt<+Ae.Span;++nt)Re[Re.length]=mr(Ae);break;case"namedrange":if(o[1]==="/")break;Q.Names||(Q.Names=[]);var G=ct(o[0]),Ct={Name:G.Name,Ref:$c(G.RefersTo.slice(1),{r:0,c:0})};Q.Sheets.length>0&&(Ct.Sheet=Q.Sheets.length-1),Q.Names.push(Ct);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?w+=n.slice(F,o.index):F=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;j.Interior=Cs(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?kN(b,he,n.slice(D,o.index)):D=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));rL(ve),He.push(ve)}else l.push([o[3],!1]),c=Cs(o[0]),ve={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var xt=Cs(o[0]);p["!autofilter"]={ref:$c(xt.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return F2(n,r);var Rt=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Rt=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Rt=!1}break;case"excelworkbook":switch(o[3]){case"date1904":Q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Rt=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Rt=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(D,o.index)){case"SheetHidden":X.Hidden=1;break;case"SheetVeryHidden":X.Hidden=2;break}else D=o.index+o[0].length;break;case"header":p["!margins"]||Sl(p["!margins"]={},"xlml"),isNaN(+ct(o[0]).Margin)||(p["!margins"].header=+ct(o[0]).Margin);break;case"footer":p["!margins"]||Sl(p["!margins"]={},"xlml"),isNaN(+ct(o[0]).Margin)||(p["!margins"].footer=+ct(o[0]).Margin);break;case"pagemargins":var pt=ct(o[0]);p["!margins"]||Sl(p["!margins"]={},"xlml"),isNaN(+pt.Top)||(p["!margins"].top=+pt.Top),isNaN(+pt.Left)||(p["!margins"].left=+pt.Left),isNaN(+pt.Right)||(p["!margins"].right=+pt.Right),isNaN(+pt.Bottom)||(p["!margins"].bottom=+pt.Bottom);break;case"displayrighttoleft":Q.Views||(Q.Views=[]),Q.Views[0]||(Q.Views[0]={}),Q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Rt=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Rt=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Rt=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Rt=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Rt=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Rt=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Rt=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Rt=!1}break;case"smarttags":break;default:Rt=!1;break}if(Rt||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?JM(N,he,R,n.slice(D,o.index)):(R=o,D=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var $e={};return!r.bookSheets&&!r.bookProps&&($e.Sheets=d),$e.SheetNames=h,$e.Workbook=Q,$e.SSF=mr(st),$e.Props=b,$e.Custprops=N,$e}function sx(t,e){switch(av(e=e||{}),e.type||"base64"){case"base64":return Pm(Hi(t),e);case"binary":case"buffer":case"file":return Pm(t,e);case"array":return Pm(Qo(t),e)}}function nL(t,e){var r=[];return t.Props&&r.push(CN(t.Props,e)),t.Custprops&&r.push(FN(t.Props,t.Custprops)),r.join("")}function iL(){return""}function sL(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(je("NumberFormat",null,{"ss:Format":Kt(st[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(je("Style",s.join(""),a))}),je("Styles",r.join(""))}function ok(t){return je("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+ev(t.Ref,{r:0,c:0})})}function aL(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(ok(i)))}return je("Names",r.join(""))}function oL(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(ok(o)))}return s.join("")}function lL(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(je("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(je("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(je("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(je("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(In("ProtectContents","True")),t["!protect"].objects&&i.push(In("ProtectObjects","True")),t["!protect"].scenarios&&i.push(In("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(In("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(In("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":je("WorksheetOptions",i.join(""),{xmlns:Mi.x})}function cL(t){return t.map(function(e){var r=bR(e.t||""),n=je("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return je("Comment",n,{"ss:Author":e.a})}).join("")}function uL(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+Kt(ev(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var l=Fr(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=Kt(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=Kt(t.l.Tooltip))),r["!merges"])for(var c=r["!merges"],d=0;d!=c.length;++d)c[d].s.c!=a.c||c[d].s.r!=a.r||(c[d].e.c>c[d].s.c&&(o["ss:MergeAcross"]=c[d].e.c-c[d].s.c),c[d].e.r>c[d].s.r&&(o["ss:MergeDown"]=c[d].e.r-c[d].s.r));var h="",p="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",p=String(t.v);break;case"b":h="Boolean",p=t.v?"1":"0";break;case"e":h="Error",p=Xa[t.v];break;case"d":h="DateTime",p=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||st[14]);break;case"s":h="String",p=IR(t.v||"");break}var g=Zo(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+g),o["ss:Index"]=a.c+1;var y=t.v!=null?p:"",x=t.t=="z"?"":'<Data ss:Type="'+h+'">'+y+"</Data>";return(t.c||[]).length>0&&(x+=cL(t.c)),je("Cell",x,o)}function fL(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=au(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function dL(t,e,r,n){if(!t["!ref"])return"";var i=Ot(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(E,T){zo(E);var A=!!E.width,_=Mp(T,E),P={"ss:Index":T+1};A&&(P["ss:Width"]=id(_.width)),E.hidden&&(P["ss:Hidden"]="1"),o.push(je("Column",null,P))});for(var l=Array.isArray(t),c=i.s.r;c<=i.e.r;++c){for(var d=[fL(c,(t["!rows"]||[])[c])],h=i.s.c;h<=i.e.c;++h){var p=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>h)&&!(s[a].s.r>c)&&!(s[a].e.c<h)&&!(s[a].e.r<c)){(s[a].s.c!=h||s[a].s.r!=c)&&(p=!0);break}if(!p){var g={r:c,c:h},y=ot(g),x=l?(t[c]||[])[h]:t[y];d.push(uL(x,y,t,e,r,n,g))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function hL(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?oL(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?dL(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(lL(s,e,t,r)),n.join("")}function pL(t,e){e||(e={}),t.SSF||(t.SSF=mr(st)),t.SSF&&(_u(),Ip(t.SSF),e.revssf=Rp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Zo(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(nL(t,e)),r.push(iL()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(je("Worksheet",hL(n,e,t),{"ss:Name":Kt(t.SheetNames[n])}));return r[2]=sL(t,e),r[3]=aL(t),Gr+je("Workbook",r.join(""),{xmlns:Mi.ss,"xmlns:o":Mi.o,"xmlns:x":Mi.x,"xmlns:ss":Mi.ss,"xmlns:dt":Mi.dt,"xmlns:html":Mi.html})}function mL(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=aN(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=oN(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var gL=[60,1084,2066,2165,2175];function xL(t,e,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var l=ka(r,r.l),c=ax[l],d=0;c!=null&&gL.indexOf(l)>-1;)s=ka(r,r.l+2),d=r.l+4,l==2066?d+=4:(l==2165||l==2175)&&(d+=12),o=r.slice(d,r.l+4+s),a.push(o),r.l+=4+s,c=ax[l=ka(r,r.l)];var h=yn(a);Fn(h,0);var p=0;h.lens=[];for(var g=0;g<a.length;++g)h.lens.push(p),p+=a[g].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,i)}function Gs(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=st[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Xa[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Jf(t.v):t.w=Nl(t.v):t.w=us(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&yu(st[n]||String(n))){var i=xl(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function N0(t,e,r){return{v:t,ixfe:e,t:r}}function vL(t,e){var r={opts:{}},n={},i=e.dense?[]:{},s={},a={},o=null,l=[],c="",d={},h,p="",g,y,x,E,T={},A=[],_,P,W=[],j=[],w={Sheets:[],WBProps:{date1904:!1},Views:[{}]},F={},S=function(ut){return ut<8?El[ut]:ut<64&&j[ut-8]||El[ut]},b=function(ut,sr,Tr){var gr=sr.XF.data;if(!(!gr||!gr.patternType||!Tr||!Tr.cellStyles)){sr.s={},sr.s.patternType=gr.patternType;var ii;(ii=nd(S(gr.icvFore)))&&(sr.s.fgColor={rgb:ii}),(ii=nd(S(gr.icvBack)))&&(sr.s.bgColor={rgb:ii})}},N=function(ut,sr,Tr){if(!(Be>1)&&!(Tr.sheetRows&&ut.r>=Tr.sheetRows)){if(Tr.cellStyles&&sr.XF&&sr.XF.data&&b(ut,sr,Tr),delete sr.ixfe,delete sr.XF,h=ut,p=ot(ut),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),ut.r<a.s.r&&(a.s.r=ut.r),ut.c<a.s.c&&(a.s.c=ut.c),ut.r+1>a.e.r&&(a.e.r=ut.r+1),ut.c+1>a.e.c&&(a.e.c=ut.c+1),Tr.cellFormula&&sr.f){for(var gr=0;gr<A.length;++gr)if(!(A[gr][0].s.c>ut.c||A[gr][0].s.r>ut.r)&&!(A[gr][0].e.c<ut.c||A[gr][0].e.r<ut.r)){sr.F=yt(A[gr][0]),(A[gr][0].s.c!=ut.c||A[gr][0].s.r!=ut.r)&&delete sr.f,sr.f&&(sr.f=""+Kn(A[gr][1],a,ut,Z,D));break}}Tr.dense?(i[ut.r]||(i[ut.r]=[]),i[ut.r][ut.c]=sr):i[p]=sr}},D={enc:!1,sbcch:0,snames:[],sharedf:T,arrayf:A,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(D.password=e.password);var R,He=[],ve=[],Re=[],Ae=[],_e=!1,Z=[];Z.SheetNames=D.snames,Z.sharedf=D.sharedf,Z.arrayf=D.arrayf,Z.names=[],Z.XTI=[];var Ce=0,Be=0,U=0,H=[],Q=[],X;D.codepage=1200,Rs(1200);for(var he=!1;t.l<t.length-1;){var Te=t.l,Pe=t.read_shift(2);if(Pe===0&&Ce===10)break;var ke=t.l===t.length?0:t.read_shift(2),we=ax[Pe];if(we&&we.f){if(e.bookSheets&&Ce===133&&Pe!==133)break;if(Ce=Pe,we.r===2||we.r==12){var nt=t.read_shift(2);if(ke-=2,!D.enc&&nt!==Pe&&((nt&255)<<8|nt>>8)!==Pe)throw new Error("rt mismatch: "+nt+"!="+Pe);we.r==12&&(t.l+=10,ke-=10)}var G={};if(Pe===10?G=we.f(t,ke,D):G=xL(Pe,we,t,ke,D),Be==0&&[9,521,1033,2057].indexOf(Ce)===-1)continue;switch(Pe){case 34:r.opts.Date1904=w.WBProps.date1904=G;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(t.l=0),D.enc=G,!e.password)throw new Error("File is password-protected");if(G.valid==null)throw new Error("Encryption scheme unsupported");if(!G.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=G;break;case 66:var Ct=Number(G);switch(Ct){case 21010:Ct=1200;break;case 32768:Ct=1e4;break;case 32769:Ct=1252;break}Rs(D.codepage=Ct),he=!0;break;case 317:D.rrtabid=G;break;case 25:D.winlocked=G;break;case 439:r.opts.RefreshAll=G;break;case 12:r.opts.CalcCount=G;break;case 16:r.opts.CalcDelta=G;break;case 17:r.opts.CalcIter=G;break;case 13:r.opts.CalcMode=G;break;case 14:r.opts.CalcPrecision=G;break;case 95:r.opts.CalcSaveRecalc=G;break;case 15:D.CalcRefMode=G;break;case 2211:r.opts.FullCalc=G;break;case 129:G.fDialog&&(i["!type"]="dialog"),G.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),G.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:W.push(G);break;case 430:Z.push([G]),Z[Z.length-1].XTI=[];break;case 35:case 547:Z[Z.length-1].push(G);break;case 24:case 536:X={Name:G.Name,Ref:Kn(G.rgce,a,null,Z,D)},G.itab>0&&(X.Sheet=G.itab-1),Z.names.push(X),Z[0]||(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].push(G),G.Name=="_xlnm._FilterDatabase"&&G.itab>0&&G.rgce&&G.rgce[0]&&G.rgce[0][0]&&G.rgce[0][0][0]=="PtgArea3d"&&(Q[G.itab-1]={ref:yt(G.rgce[0][0][1][2])});break;case 22:D.ExternCount=G;break;case 23:Z.length==0&&(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].XTI=Z[Z.length-1].XTI.concat(G),Z.XTI=Z.XTI.concat(G);break;case 2196:if(D.biff<8)break;X!=null&&(X.Comment=G[1]);break;case 18:i["!protect"]=G;break;case 19:G!==0&&D.WTF&&console.error("Password verifier: "+G);break;case 133:s[G.pos]=G,D.snames.push(G.name);break;case 10:{if(--Be)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=yt(a),e.sheetRows&&e.sheetRows<=a.e.r){var xt=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=yt(a),a.e.r=xt}a.e.r++,a.e.c++}He.length>0&&(i["!merges"]=He),ve.length>0&&(i["!objects"]=ve),Re.length>0&&(i["!cols"]=Re),Ae.length>0&&(i["!rows"]=Ae),w.Sheets.push(F)}c===""?d=i:n[c]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[Pe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[G.BIFFVer]||8),D.biffguess=G.BIFFVer==0,G.BIFFVer==0&&G.dt==4096&&(D.biff=5,he=!0,Rs(D.codepage=28591)),D.biff==8&&G.BIFFVer==0&&G.dt==16&&(D.biff=2),Be++)break;if(i=e.dense?[]:{},D.biff<8&&!he&&(he=!0,Rs(D.codepage=e.codepage||1252)),D.biff<5||G.BIFFVer==0&&G.dt==4096){c===""&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var Rt={pos:t.l-ke,name:c};s[Rt.pos]=Rt,D.snames.push(c)}else c=(s[Te]||{name:""}).name;G.dt==32&&(i["!type"]="chart"),G.dt==64&&(i["!type"]="macro"),He=[],ve=[],D.arrayf=A=[],Re=[],Ae=[],_e=!1,F={Hidden:(s[Te]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[G.r]||[])[G.c]:i[ot({c:G.c,r:G.r})])&&++G.c,_={ixfe:G.ixfe,XF:W[G.ixfe]||{},v:G.val,t:"n"},U>0&&(_.z=H[_.ixfe>>8&63]),Gs(_,e,r.opts.Date1904),N({c:G.c,r:G.r},_,e);break;case 5:case 517:_={ixfe:G.ixfe,XF:W[G.ixfe],v:G.val,t:G.t},U>0&&(_.z=H[_.ixfe>>8&63]),Gs(_,e,r.opts.Date1904),N({c:G.c,r:G.r},_,e);break;case 638:_={ixfe:G.ixfe,XF:W[G.ixfe],v:G.rknum,t:"n"},U>0&&(_.z=H[_.ixfe>>8&63]),Gs(_,e,r.opts.Date1904),N({c:G.c,r:G.r},_,e);break;case 189:for(var pt=G.c;pt<=G.C;++pt){var $e=G.rkrec[pt-G.c][0];_={ixfe:$e,XF:W[$e],v:G.rkrec[pt-G.c][1],t:"n"},U>0&&(_.z=H[_.ixfe>>8&63]),Gs(_,e,r.opts.Date1904),N({c:pt,r:G.r},_,e)}break;case 6:case 518:case 1030:{if(G.val=="String"){o=G;break}if(_=N0(G.val,G.cell.ixfe,G.tt),_.XF=W[_.ixfe],e.cellFormula){var qt=G.formula;if(qt&&qt[0]&&qt[0][0]&&qt[0][0][0]=="PtgExp"){var wn=qt[0][0][1][0],hn=qt[0][0][1][1],vi=ot({r:wn,c:hn});T[vi]?_.f=""+Kn(G.formula,a,G.cell,Z,D):_.F=((e.dense?(i[wn]||[])[hn]:i[vi])||{}).F}else _.f=""+Kn(G.formula,a,G.cell,Z,D)}U>0&&(_.z=H[_.ixfe>>8&63]),Gs(_,e,r.opts.Date1904),N(G.cell,_,e),o=G}break;case 7:case 519:if(o)o.val=G,_=N0(G,o.cell.ixfe,"s"),_.XF=W[_.ixfe],e.cellFormula&&(_.f=""+Kn(o.formula,a,o.cell,Z,D)),U>0&&(_.z=H[_.ixfe>>8&63]),Gs(_,e,r.opts.Date1904),N(o.cell,_,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{A.push(G);var Ki=ot(G[0].s);if(g=e.dense?(i[G[0].s.r]||[])[G[0].s.c]:i[Ki],e.cellFormula&&g){if(!o||!Ki||!g)break;g.f=""+Kn(G[1],a,G[0],Z,D),g.F=yt(G[0])}}break;case 1212:{if(!e.cellFormula)break;if(p){if(!o)break;T[ot(o.cell)]=G[0],g=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[ot(o.cell)],(g||{}).f=""+Kn(G[0],a,h,Z,D)}}break;case 253:_=N0(l[G.isst].t,G.ixfe,"s"),l[G.isst].h&&(_.h=l[G.isst].h),_.XF=W[_.ixfe],U>0&&(_.z=H[_.ixfe>>8&63]),Gs(_,e,r.opts.Date1904),N({c:G.c,r:G.r},_,e);break;case 513:e.sheetStubs&&(_={ixfe:G.ixfe,XF:W[G.ixfe],t:"z"},U>0&&(_.z=H[_.ixfe>>8&63]),Gs(_,e,r.opts.Date1904),N({c:G.c,r:G.r},_,e));break;case 190:if(e.sheetStubs)for(var yi=G.c;yi<=G.C;++yi){var Nr=G.ixfe[yi-G.c];_={ixfe:Nr,XF:W[Nr],t:"z"},U>0&&(_.z=H[_.ixfe>>8&63]),Gs(_,e,r.opts.Date1904),N({c:yi,r:G.r},_,e)}break;case 214:case 516:case 4:_=N0(G.val,G.ixfe,"s"),_.XF=W[_.ixfe],U>0&&(_.z=H[_.ixfe>>8&63]),Gs(_,e,r.opts.Date1904),N({c:G.c,r:G.r},_,e);break;case 0:case 512:Be===1&&(a=G);break;case 252:l=G;break;case 1054:if(D.biff==4){H[U++]=G[1];for(var _i=0;_i<U+163&&st[_i]!=G[1];++_i);_i>=163&&Na(G[1],U+163)}else Na(G[1],G[0]);break;case 30:{H[U++]=G;for(var zt=0;zt<U+163&&st[zt]!=G;++zt);zt>=163&&Na(G,U+163)}break;case 229:He=He.concat(G);break;case 93:ve[G.cmo[0]]=D.lastobj=G;break;case 438:D.lastobj.TxO=G;break;case 127:D.lastobj.ImData=G;break;case 440:for(E=G[0].s.r;E<=G[0].e.r;++E)for(x=G[0].s.c;x<=G[0].e.c;++x)g=e.dense?(i[E]||[])[x]:i[ot({c:x,r:E})],g&&(g.l=G[1]);break;case 2048:for(E=G[0].s.r;E<=G[0].e.r;++E)for(x=G[0].s.c;x<=G[0].e.c;++x)g=e.dense?(i[E]||[])[x]:i[ot({c:x,r:E})],g&&g.l&&(g.l.Tooltip=G[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;g=e.dense?(i[G[0].r]||[])[G[0].c]:i[ot(G[0])];var wr=ve[G[2]];g||(e.dense?(i[G[0].r]||(i[G[0].r]=[]),g=i[G[0].r][G[0].c]={t:"z"}):g=i[ot(G[0])]={t:"z"},a.e.r=Math.max(a.e.r,G[0].r),a.s.r=Math.min(a.s.r,G[0].r),a.e.c=Math.max(a.e.c,G[0].c),a.s.c=Math.min(a.s.c,G[0].c)),g.c||(g.c=[]),y={a:G[1],t:wr.TxO.t},g.c.push(y)}break;case 2173:s6(W[G.ixfe],G.ext);break;case 125:{if(!D.cellStyles)break;for(;G.e>=G.s;)Re[G.e--]={width:G.w/256,level:G.level||0,hidden:!!(G.flags&1)},_e||(_e=!0,Q1(G.w/256)),zo(Re[G.e+1])}break;case 520:{var Zt={};G.level!=null&&(Ae[G.r]=Zt,Zt.level=G.level),G.hidden&&(Ae[G.r]=Zt,Zt.hidden=!0),G.hpt&&(Ae[G.r]=Zt,Zt.hpt=G.hpt,Zt.hpx=au(G.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Sl(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Pe]]=G;break;case 161:i["!margins"]||Sl(i["!margins"]={}),i["!margins"].header=G.header,i["!margins"].footer=G.footer;break;case 574:G.RTL&&(w.Views[0].RTL=!0);break;case 146:j=G;break;case 2198:R=G;break;case 140:P=G;break;case 442:c?F.CodeName=G||F.name:w.WBProps.CodeName=G||"ThisWorkbook";break}}else we||console.error("Missing Info for XLS Record 0x"+Pe.toString(16)),t.l+=ke}return r.SheetNames=Ur(s).sort(function(ni,ut){return Number(ni)-Number(ut)}).map(function(ni){return s[ni].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&Q.forEach(function(ni,ut){r.Sheets[r.SheetNames[ut]]["!autofilter"]=ni}),r.Strings=l,r.SSF=mr(st),D.enc&&(r.Encryption=D.enc),R&&(r.Themes=R),r.Metadata={},P!==void 0&&(r.Metadata.Country=P),Z.names.length>0&&(w.Names=Z.names),r.Workbook=w,r}var Cf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function yL(t,e,r){var n=et.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=i2(n,Zg,Cf.DSI);for(var s in i)e[s]=i[s]}catch(c){if(r.WTF)throw c}var a=et.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=i2(a,ex,Cf.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(aA(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function _L(t,e){var r=[],n=[],i=[],s=0,a,o=P_(Zg,"n"),l=P_(ex,"n");if(t.Props)for(a=Ur(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=Ur(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var c=[];for(s=0;s<i.length;++s)hA.indexOf(i[s][0])>-1||sA.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&et.utils.cfb_add(e,"/SummaryInformation",s2(n,Cf.SI,l,ex)),(r.length||c.length)&&et.utils.cfb_add(e,"/DocumentSummaryInformation",s2(r,Cf.DSI,o,Zg,c.length?c:null,Cf.UDI))}function lk(t,e){e||(e={}),av(e),C1(),e.codepage&&k1(e.codepage);var r,n;if(t.FullPaths){if(et.find(t,"/encryption"))throw new Error("File is password-protected");r=et.find(t,"!CompObj"),n=et.find(t,"/Workbook")||et.find(t,"/Book")}else{switch(e.type){case"base64":t=Bi(Hi(t));break;case"binary":t=Bi(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Fn(t,0),n={content:t}}var i,s;if(r&&mL(r),e.bookProps&&!e.bookSheets)i={};else{var a=Et?"buffer":"array";if(n&&n.content)i=vL(n.content,e);else if((s=et.find(t,"PerfectOffice_MAIN"))&&s.content)i=Tl.to_workbook(s.content,(e.type=a,e));else if((s=et.find(t,"NativeContent_MAIN"))&&s.content)i=Tl.to_workbook(s.content,(e.type=a,e));else throw(s=et.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&et.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=D6(t))}var o={};return t.FullPaths&&yL(t,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=t),i}function EL(t,e){var r=e||{},n=et.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return et.utils.cfb_add(n,i,ck(t,r)),r.biff==8&&(t.Props||t.Custprops)&&_L(t,n),r.biff==8&&t.vbaraw&&P6(n,et.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var od={0:{f:$5},1:{f:Z5},2:{f:vO},3:{f:oO},4:{f:nO},5:{f:mO},6:{f:TO},7:{f:fO},8:{f:bO},9:{f:IO},10:{f:CO},11:{f:FO},12:{f:tO},13:{f:_O},14:{f:cO},15:{f:sO},16:{f:ek},17:{f:AO},18:{f:hO},19:{f:U1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:AM},40:{},42:{},43:{f:TP},44:{f:EP},45:{f:kP},46:{f:FP},47:{f:CP},48:{},49:{f:XR},50:{},51:{f:l6},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:SA},62:{f:wO},63:{f:x6},64:{f:GO},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ei,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:zO},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Q5},148:{f:X5,p:16},151:{f:MO},152:{},153:{f:wM},154:{},155:{},156:{f:_M},157:{},158:{},159:{T:1,f:BD},160:{T:-1},161:{T:1,f:Yl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:RO},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:a6},336:{T:-1},337:{f:f6,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Jg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:TA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:LO},427:{f:BO},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:VO},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:q5},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:PO},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Jg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:F6},633:{T:1},634:{T:-1},635:{T:1,f:k6},636:{T:-1},637:{f:JR},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:cM},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:KO},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},ax={6:{f:Nm},10:{f:co},12:{f:rn},13:{f:rn},14:{f:zr},15:{f:zr},16:{f:Qn},17:{f:zr},18:{f:zr},19:{f:rn},20:{f:f2},21:{f:f2},23:{f:TA},24:{f:h2},25:{f:zr},26:{},27:{},28:{f:K3},29:{},34:{f:zr},35:{f:d2},38:{f:Qn},39:{f:Qn},40:{f:Qn},41:{f:Qn},42:{f:zr},43:{f:zr},47:{f:sP},49:{f:_3},51:{f:rn},60:{},61:{f:m3},64:{f:zr},65:{f:y3},66:{f:rn},77:{},80:{},81:{},82:{},85:{f:rn},89:{},90:{},91:{},92:{f:i3},93:{f:q3},94:{},95:{f:zr},96:{},97:{},99:{f:zr},125:{f:SA},128:{f:O3},129:{f:a3},130:{f:rn},131:{f:zr},132:{f:zr},133:{f:o3},134:{},140:{f:iD},141:{f:rn},144:{},146:{f:oD},151:{},152:{},153:{},154:{},155:{},156:{f:rn},157:{},158:{},160:{f:pD},161:{f:uD},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:R3},190:{f:N3},193:{f:co},197:{},198:{},199:{},200:{},201:{},202:{f:zr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:rn},220:{},221:{f:zr},222:{},224:{f:P3},225:{f:n3},226:{f:co},227:{},229:{f:X3},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:c3},253:{f:w3},255:{f:f3},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:pA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:zr},353:{f:co},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:V3},431:{f:zr},432:{},433:{},434:{},437:{},438:{f:Z3},439:{f:zr},440:{f:eD},441:{},442:{f:Fd},443:{},444:{f:rn},445:{},446:{},448:{f:co},449:{f:p3,r:2},450:{f:co},512:{f:l2},513:{f:hD},515:{f:B3},516:{f:S3},517:{f:u2},519:{f:mD},520:{f:d3},523:{},545:{f:p2},549:{f:o2},566:{},574:{f:x3},638:{f:b3},659:{},1048:{},1054:{f:k3},1084:{},1212:{f:H3},2048:{f:rD},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:I0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:co},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:lD,r:12},2173:{f:i6,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:zr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:W3,r:12},2197:{},2198:{f:JP,r:12},2199:{},2200:{},2201:{},2202:{f:$3,r:12},2203:{f:co},2204:{},2205:{},2206:{},2207:{},2211:{f:h3},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:rn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:fD},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:aD},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:l2},1:{},2:{f:_D},3:{f:vD},4:{f:xD},5:{f:u2},7:{f:wD},8:{},9:{f:I0},11:{},22:{f:rn},30:{f:F3},31:{},32:{},33:{f:p2},36:{},37:{f:o2},50:{f:TD},62:{},52:{},67:{},68:{f:rn},69:{},86:{},126:{},127:{f:gD},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:SD},223:{},234:{},354:{},421:{},518:{f:Nm},521:{f:I0},536:{f:h2},547:{f:d2},561:{},579:{},1030:{f:Nm},1033:{f:I0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ue(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&B1(r)&&t.push(r)}}function wL(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return Ue(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var d=t.next(4);for(d.write_shift(2,s),d.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c;l<i;){for(d=t.next(4),d.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;d.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c}}}function Nd(t,e,r){return t||(t=me(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function TL(t,e,r,n){var i=me(9);return Nd(i,t,e),mA(r,n||"b",i),i}function SL(t,e,r){var n=me(8+2*r.length);return Nd(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function AL(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?dn(pr(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?Ue(t,2,ED(r,n,i)):Ue(t,3,yD(r,n,i));return;case"b":case"e":Ue(t,5,TL(r,n,e.v,e.t));return;case"s":case"str":Ue(t,4,SL(r,n,(e.v||"").slice(0,255)));return}Ue(t,1,Nd(null,r,n))}function kL(t,e,r,n){var i=Array.isArray(e),s=Ot(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=yt(s)}for(var c=s.s.r;c<=s.e.r;++c){o=$r(c);for(var d=s.s.c;d<=s.e.c;++d){c===s.s.r&&(l[d]=Cr(d)),a=l[d]+o;var h=i?(e[c]||[])[d]:e[a];h&&AL(t,h,c,d)}}}function CL(t,e){for(var r=e||{},n=bi(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ue(n,r.biff==4?1033:r.biff==3?521:9,X1(t,16,r)),kL(n,t.Sheets[t.SheetNames[i]],i,r),Ue(n,10),n.end()}function FL(t,e,r){Ue(t,49,E3({sz:12,name:"Arial"},r))}function IL(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Ue(t,1054,C3(i,e[i],r))})}function bL(t,e){var r=me(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ue(t,2151,r),r=me(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),_A(Ot(e["!ref"]||"A1"),r),r.write_shift(4,4),Ue(t,2152,r)}function RL(t,e){for(var r=0;r<16;++r)Ue(t,224,c2({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Ue(t,224,c2(n,0,e))})}function NL(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Ue(t,440,tD(n)),n[1].Tooltip&&Ue(t,2048,nD(n))}delete e["!links"]}function DL(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&Ue(t,125,cD(Mp(i,n),i))})}}function PL(t,e,r,n,i){var s=16+Zo(i.cellXfs,e,i);if(e.v==null&&!e.bf){Ue(t,513,Ml(r,n,s));return}if(e.bf)Ue(t,6,a5(e,r,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?dn(pr(e.v)):e.v;Ue(t,515,j3(r,n,a,s));break;case"b":case"e":Ue(t,517,L3(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=rv(i.Strings,e.v,i.revStrings);Ue(t,253,T3(r,n,o,s))}else Ue(t,516,A3(r,n,(e.v||"").slice(0,255),s,i));break;default:Ue(t,513,Ml(r,n,s))}}function OL(t,e,r){var n=bi(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},l=Array.isArray(s),c=e.biff==8,d,h="",p=[],g=Ot(s["!ref"]||"A1"),y=c?65536:16384;if(g.e.c>255||g.e.r>=y){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,y-1)}Ue(n,2057,X1(r,16,e)),Ue(n,13,ts(1)),Ue(n,12,ts(100)),Ue(n,15,hi(!0)),Ue(n,17,hi(!1)),Ue(n,16,Pl(.001)),Ue(n,95,hi(!0)),Ue(n,42,hi(!1)),Ue(n,43,hi(!1)),Ue(n,130,ts(1)),Ue(n,128,M3()),Ue(n,131,hi(!1)),Ue(n,132,hi(!1)),c&&DL(n,s["!cols"]),Ue(n,512,I3(g,e)),c&&(s["!links"]=[]);for(var x=g.s.r;x<=g.e.r;++x){h=$r(x);for(var E=g.s.c;E<=g.e.c;++E){x===g.s.r&&(p[E]=Cr(E)),d=p[E]+h;var T=l?(s[x]||[])[E]:s[d];T&&(PL(n,T,x,E,e),c&&T.l&&s["!links"].push([d,T.l]))}}var A=o.CodeName||o.name||i;return c&&Ue(n,574,v3((a.Views||[])[0])),c&&(s["!merges"]||[]).length&&Ue(n,229,Y3(s["!merges"])),c&&NL(n,s),Ue(n,442,gA(A)),c&&bL(n,s),Ue(n,10),n.end()}function ML(t,e,r){var n=bi(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(Ue(n,2057,X1(t,5,r)),r.bookType=="xla"&&Ue(n,135),Ue(n,225,o?ts(1200):null),Ue(n,193,LN(2)),l&&Ue(n,191),l&&Ue(n,192),Ue(n,226),Ue(n,92,s3("SheetJS",r)),Ue(n,66,ts(o?1200:1252)),o&&Ue(n,353,ts(0)),o&&Ue(n,448),Ue(n,317,dD(t.SheetNames.length)),o&&t.vbaraw&&Ue(n,211),o&&t.vbaraw){var c=a.CodeName||"ThisWorkbook";Ue(n,442,gA(c))}Ue(n,156,ts(17)),Ue(n,25,hi(!1)),Ue(n,18,hi(!1)),Ue(n,19,ts(0)),o&&Ue(n,431,hi(!1)),o&&Ue(n,444,ts(0)),Ue(n,61,g3()),Ue(n,64,hi(!1)),Ue(n,141,ts(0)),Ue(n,34,hi(pM(t)=="true")),Ue(n,14,hi(!0)),o&&Ue(n,439,hi(!1)),Ue(n,218,ts(0)),FL(n,t,r),IL(n,t.SSF,r),RL(n,r),o&&Ue(n,352,hi(!1));var d=n.end(),h=bi();o&&Ue(h,140,sD()),o&&r.Strings&&wL(h,252,u3(r.Strings)),Ue(h,10);var p=h.end(),g=bi(),y=0,x=0;for(x=0;x<t.SheetNames.length;++x)y+=(o?12:11)+(o?2:1)*t.SheetNames[x].length;var E=d.length+y+p.length;for(x=0;x<t.SheetNames.length;++x){var T=s[x]||{};Ue(g,133,l3({pos:E,hs:T.Hidden||0,dt:0,name:t.SheetNames[x]},r)),E+=e[x].length}var A=g.end();if(y!=A.length)throw new Error("BS8 "+y+" != "+A.length);var _=[];return d.length&&_.push(d),A.length&&_.push(A),p.length&&_.push(p),yn(_)}function LL(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=mr(st)),t&&t.SSF&&(_u(),Ip(t.SSF),r.revssf=Rp(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,ov(r),r.cellXfs=[],Zo(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=OL(i,r,t);return n.unshift(ML(t,n,r)),yn(n)}function ck(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Ri(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return LL(t,e);case 4:case 3:case 2:return CL(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function S2(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),a=i.index,o=s&&s.index||t.length,l=ER(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,d=0,h=0,p=0,g={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(a=0;a<l.length;++a){var x=l[a].trim(),E=x.slice(0,3).toLowerCase();if(E=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}d=0;continue}if(!(E!="<td"&&E!="<th")){var T=x.split(/<\/t[dh]>/i);for(o=0;o<T.length;++o){var A=T[o].trim();if(A.match(/<t[dh]/i)){for(var _=A,P=0;_.charAt(0)=="<"&&(P=_.indexOf(">"))>-1;)_=_.slice(P+1);for(var W=0;W<y.length;++W){var j=y[W];j.s.c==d&&j.s.r<c&&c<=j.e.r&&(d=j.e.c+1,W=-1)}var w=ct(A.slice(0,A.indexOf(">")));p=w.colspan?+w.colspan:1,((h=+w.rowspan)>1||p>1)&&y.push({s:{r:c,c:d},e:{r:c+(h||1)-1,c:d+p-1}});var F=w.t||w["data-t"]||"";if(!_.length){d+=p;continue}if(_=DS(_),g.s.r>c&&(g.s.r=c),g.e.r<c&&(g.e.r=c),g.s.c>d&&(g.s.c=d),g.e.c<d&&(g.e.c=d),!_.length){d+=p;continue}var S={t:"s",v:_};r.raw||!_.trim().length||F=="s"||(_==="TRUE"?S={t:"b",v:!0}:_==="FALSE"?S={t:"b",v:!1}:isNaN(Ms(_))?isNaN(iu(_).getDate())||(S={t:"d",v:pr(_)},r.cellDates||(S={t:"n",v:dn(S.v)}),S.z=r.dateNF||st[14]):S={t:"n",v:Ms(_)}),r.dense?(n[c]||(n[c]=[]),n[c][d]=S):n[ot({r:c,c:d})]=S,d+=p}}}}return n["!ref"]=yt(g),y.length&&(n["!merges"]=y),n}function BL(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>a)&&!(i[c].e.r<r||i[c].e.c<a)){if(i[c].s.r<r||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var d=ot({r,c:a}),h=n.dense?(t[r]||[])[a]:t[d],p=h&&h.v!=null&&(h.h||O1(h.w||(ja(h),h.w)||""))||"",g={};o>1&&(g.rowspan=o),l>1&&(g.colspan=l),n.editable?p='<span contenteditable="true">'+p+"</span>":h&&(g["data-t"]=h&&h.t||"z",h.v!=null&&(g["data-v"]=h.v),h.z!=null&&(g["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+h.l.Target+'">'+p+"</a>")),g.id=(n.id||"sjs")+"-"+d,s.push(je("td",p,g))}}var y="<tr>";return y+s.join("")+"</tr>"}var jL='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',VL="</body></html>";function UL(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Jo(S2(r[0],e),e);var n=uv();return r.forEach(function(i,s){fv(n,S2(i,e),"Sheet"+(s+1))}),n}function zL(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function uk(t,e){var r=e||{},n=r.header!=null?r.header:jL,i=r.footer!=null?r.footer:VL,s=[n],a=Ri(t["!ref"]);r.dense=Array.isArray(t),s.push(zL(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(BL(t,a,o,r));return s.push("</table>"+i),s.join("")}function fk(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Fr(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var d=Ri(t["!ref"]);c.s.r=Math.min(c.s.r,d.s.r),c.s.c=Math.min(c.s.c,d.s.c),c.e.r=Math.max(c.e.r,d.e.r),c.e.c=Math.max(c.e.c,d.e.c),i==-1&&(c.e.r=i=d.e.r+1)}var h=[],p=0,g=t["!rows"]||(t["!rows"]=[]),y=0,x=0,E=0,T=0,A=0,_=0;for(t["!cols"]||(t["!cols"]=[]);y<o.length&&x<l;++y){var P=o[y];if(A2(P)){if(n.display)continue;g[x]={hidden:!0}}var W=P.children;for(E=T=0;E<W.length;++E){var j=W[E];if(!(n.display&&A2(j))){var w=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):DS(j.innerHTML),F=j.getAttribute("data-z")||j.getAttribute("z");for(p=0;p<h.length;++p){var S=h[p];S.s.c==T+s&&S.s.r<x+i&&x+i<=S.e.r&&(T=S.e.c+1-s,p=-1)}_=+j.getAttribute("colspan")||1,((A=+j.getAttribute("rowspan")||1)>1||_>1)&&h.push({s:{r:x+i,c:T+s},e:{r:x+i+(A||1)-1,c:T+s+(_||1)-1}});var b={t:"s",v:w},N=j.getAttribute("data-t")||j.getAttribute("t")||"";w!=null&&(w.length==0?b.t=N||"z":n.raw||w.trim().length==0||N=="s"||(w==="TRUE"?b={t:"b",v:!0}:w==="FALSE"?b={t:"b",v:!1}:isNaN(Ms(w))?isNaN(iu(w).getDate())||(b={t:"d",v:pr(w)},n.cellDates||(b={t:"n",v:dn(b.v)}),b.z=n.dateNF||st[14]):b={t:"n",v:Ms(w)})),b.z===void 0&&F!=null&&(b.z=F);var D="",R=j.getElementsByTagName("A");if(R&&R.length)for(var He=0;He<R.length&&!(R[He].hasAttribute("href")&&(D=R[He].getAttribute("href"),D.charAt(0)!="#"));++He);D&&D.charAt(0)!="#"&&(b.l={Target:D}),n.dense?(t[x+i]||(t[x+i]=[]),t[x+i][T+s]=b):t[ot({c:T+s,r:x+i})]=b,c.e.c<T+s&&(c.e.c=T+s),T+=_}}++x}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,x-1+i),t["!ref"]=yt(c),x>=l&&(t["!fullref"]=yt((c.e.r=o.length-y+x-1+i,c))),t}function dk(t,e){var r=e||{},n=r.dense?[]:{};return fk(n,t,e)}function WL(t,e){return Jo(dk(t,e),e)}function A2(t){var e="",r=HL(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function HL(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function $L(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Pt(e.replace(/<[^>]*>/g,""));return[r]}var k2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function hk(t,e){var r=e||{},n=M1(t),i=[],s,a,o={name:""},l="",c=0,d,h,p={},g=[],y=r.dense?[]:{},x,E,T={value:""},A="",_=0,P=[],W=-1,j=-1,w={s:{r:1e6,c:1e7},e:{r:0,c:0}},F=0,S={},b=[],N={},D=0,R=0,He=[],ve=1,Re=1,Ae=[],_e={Names:[]},Z={},Ce=["",""],Be=[],U={},H="",Q=0,X=!1,he=!1,Te=0;for(td.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=td.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(w.e.c>=w.s.c&&w.e.r>=w.s.r?y["!ref"]=yt(w):y["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=w.e.r&&(y["!fullref"]=y["!ref"],w.e.r=r.sheetRows-1,y["!ref"]=yt(w)),b.length&&(y["!merges"]=b),He.length&&(y["!rows"]=He),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),g.push(d.name),p[d.name]=y,he=!1):x[0].charAt(x[0].length-2)!=="/"&&(d=ct(x[0],!1),W=j=-1,w.s.r=w.s.c=1e7,w.e.r=w.e.c=0,y=r.dense?[]:{},b=[],He=[],he=!0);break;case"table-row-group":x[1]==="/"?--F:++F;break;case"table-row":case"":if(x[1]==="/"){W+=ve,ve=1;break}if(h=ct(x[0],!1),h.?W=h.-1:W==-1&&(W=0),ve=+h["number-rows-repeated"]||1,ve<10)for(Te=0;Te<ve;++Te)F>0&&(He[W+Te]={level:F});j=-1;break;case"covered-table-cell":x[1]!=="/"&&++j,r.sheetStubs&&(r.dense?(y[W]||(y[W]=[]),y[W][j]={t:"z"}):y[ot({r:W,c:j})]={t:"z"}),A="",P=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++j,T=ct(x[0],!1),Re=parseInt(T["number-columns-repeated"]||"1",10),E={t:"z",v:null},T.formula&&r.cellFormula!=!1&&(E.f=E2(Pt(T.formula))),(T.||T["value-type"])=="string"&&(E.t="s",E.v=Pt(T["string-value"]||""),r.dense?(y[W]||(y[W]=[]),y[W][j]=E):y[ot({r:W,c:j})]=E),j+=Re-1;else if(x[1]!=="/"){++j,A="",_=0,P=[],Re=1;var Pe=ve?W+ve-1:W;if(j>w.e.c&&(w.e.c=j),j<w.s.c&&(w.s.c=j),W<w.s.r&&(w.s.r=W),Pe>w.e.r&&(w.e.r=Pe),T=ct(x[0],!1),Be=[],U={},E={t:T.||T["value-type"],v:null},r.cellFormula)if(T.formula&&(T.formula=Pt(T.formula)),T["number-matrix-columns-spanned"]&&T["number-matrix-rows-spanned"]&&(D=parseInt(T["number-matrix-rows-spanned"],10)||0,R=parseInt(T["number-matrix-columns-spanned"],10)||0,N={s:{r:W,c:j},e:{r:W+D-1,c:j+R-1}},E.F=yt(N),Ae.push([N,E.F])),T.formula)E.f=E2(T.formula);else for(Te=0;Te<Ae.length;++Te)W>=Ae[Te][0].s.r&&W<=Ae[Te][0].e.r&&j>=Ae[Te][0].s.c&&j<=Ae[Te][0].e.c&&(E.F=Ae[Te][1]);switch((T["number-columns-spanned"]||T["number-rows-spanned"])&&(D=parseInt(T["number-rows-spanned"],10)||0,R=parseInt(T["number-columns-spanned"],10)||0,N={s:{r:W,c:j},e:{r:W+D-1,c:j+R-1}},b.push(N)),T["number-columns-repeated"]&&(Re=parseInt(T["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=dr(T["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(T.value);break;case"percentage":E.t="n",E.v=parseFloat(T.value);break;case"currency":E.t="n",E.v=parseFloat(T.value);break;case"date":E.t="d",E.v=pr(T["date-value"]),r.cellDates||(E.t="n",E.v=dn(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=vR(T["time-value"])/86400,r.cellDates&&(E.t="d",E.v=Np(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(T.);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",T["string-value"]!=null&&(A=Pt(T["string-value"]),P=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(X=!1,E.t==="s"&&(E.v=A||"",P.length&&(E.R=P),X=_==0),Z.Target&&(E.l=Z),Be.length>0&&(E.c=Be,Be=[]),A&&r.cellText!==!1&&(E.w=A),X&&(E.t="z",delete E.v),(!X||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=W))for(var ke=0;ke<ve;++ke){if(Re=parseInt(T["number-columns-repeated"]||"1",10),r.dense)for(y[W+ke]||(y[W+ke]=[]),y[W+ke][j]=ke==0?E:mr(E);--Re>0;)y[W+ke][j+Re]=mr(E);else for(y[ot({r:W+ke,c:j})]=E;--Re>0;)y[ot({r:W+ke,c:j+Re})]=mr(E);w.e.c<=j&&(w.e.c=j)}Re=parseInt(T["number-columns-repeated"]||"1",10),j+=Re-1,Re=0,E={},A="",P=[]}Z={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s;U.t=A,P.length&&(U.R=P),U.a=H,Be.push(U)}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);H="",Q=0,A="",_=0,P=[];break;case"creator":x[1]==="/"?H=n.slice(Q,x.index):Q=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);A="",_=0,P=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(S[o.name]=l,(s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&(l="",o=ct(x[0],!1),i.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=ct(x[0],!1),l+=k2[x[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=ct(x[0],!1),l+=k2[x[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,x.index);break}else c=x.index+x[0].length;break;case"named-range":a=ct(x[0],!1),Ce=Dm(a["cell-range-address"]);var we={Name:a.name,Ref:Ce[0]+"!"+Ce[1]};he&&(we.Sheet=g.length),_e.Names.push(we);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(x[1]==="/"&&(!T||!T["string-value"])){var nt=$L(n.slice(_,x.index));A=(A.length>0?A+`
`:"")+nt[0]}else ct(x[0],!1),_=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{Ce=Dm(ct(x[0])["target-range-address"]),p[Ce[0]]["!autofilter"]={ref:Ce[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(Z=ct(x[0],!1),!Z.href)break;Z.Target=Pt(Z.href),delete Z.href,Z.Target.charAt(0)=="#"&&Z.Target.indexOf(".")>-1?(Ce=Dm(Z.Target.slice(1)),Z.Target="#"+Ce[0]+"!"+Ce[1]):Z.Target.match(/^\.\.[\\\/]/)&&(Z.Target=Z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var G={Sheets:p,SheetNames:g,Workbook:_e};return r.bookSheets&&delete G.Sheets,G}function C2(t,e){e=e||{},es(t,"META-INF/manifest.xml")&&vN(tn(t,"META-INF/manifest.xml"),e);var r=ji(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=hk(Jt(r),e);return es(t,"meta.xml")&&(n.Props=nA(tn(t,"meta.xml"))),n}function F2(t,e){return hk(t,e)}var GL=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+ed({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Gr+e}}(),I2=function(){var t=function(s){return Kt(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+Kt(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,d=0,h=Ri(s["!ref"]||"A1"),p=s["!merges"]||[],g=0,y=Array.isArray(s);if(s["!cols"])for(d=0;d<=h.e.c;++d)l.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var x="",E=s["!rows"]||[];for(c=0;c<h.s.r;++c)x=E[c]?' table:style-name="ro'+E[c].ods+'"':"",l.push("        <table:table-row"+x+`></table:table-row>
`);for(;c<=h.e.r;++c){for(x=E[c]?' table:style-name="ro'+E[c].ods+'"':"",l.push("        <table:table-row"+x+`>
`),d=0;d<h.s.c;++d)l.push(e);for(;d<=h.e.c;++d){var T=!1,A={},_="";for(g=0;g!=p.length;++g)if(!(p[g].s.c>d)&&!(p[g].s.r>c)&&!(p[g].e.c<d)&&!(p[g].e.r<c)){(p[g].s.c!=d||p[g].s.r!=c)&&(T=!0),A["table:number-columns-spanned"]=p[g].e.c-p[g].s.c+1,A["table:number-rows-spanned"]=p[g].e.r-p[g].s.r+1;break}if(T){l.push(r);continue}var P=ot({r:c,c:d}),W=y?(s[c]||[])[d]:s[P];if(W&&W.f&&(A["table:formula"]=Kt(d5(W.f)),W.F&&W.F.slice(0,P.length)==P)){var j=Ri(W.F);A["table:number-matrix-columns-spanned"]=j.e.c-j.s.c+1,A["table:number-matrix-rows-spanned"]=j.e.r-j.s.r+1}if(!W){l.push(e);continue}switch(W.t){case"b":_=W.v?"TRUE":"FALSE",A["office:value-type"]="boolean",A["office:boolean-value"]=W.v?"true":"false";break;case"n":_=W.w||String(W.v||0),A["office:value-type"]="float",A["office:value"]=W.v||0;break;case"s":case"str":_=W.v==null?"":W.v,A["office:value-type"]="string";break;case"d":_=W.w||pr(W.v).toISOString(),A["office:value-type"]="date",A["office:date-value"]=pr(W.v).toISOString(),A["table:style-name"]="ce1";break;default:l.push(e);continue}var w=t(_);if(W.l&&W.l.Target){var F=W.l.Target;F=F.charAt(0)=="#"?"#"+h5(F.slice(1)):F,F.charAt(0)!="#"&&!F.match(/^\w+:/)&&(F="../"+F),w=je("text:a",w,{"xlink:href":F.replace(/&/g,"&amp;")})}l.push("          "+je("table:table-cell",je("text:p",w,{}),A)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var d=0;d<c["!cols"].length;++d)if(c["!cols"][d]){var h=c["!cols"][d];if(h.width==null&&h.wpx==null&&h.wch==null)continue;zo(h),h.ods=o;var p=c["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var d=0;d<c["!rows"].length;++d)if(c["!rows"][d]){c["!rows"][d].ods=l;var h=c["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[Gr],c=ed({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=ed({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+d+`>
`),l.push(rA().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=a.SheetNames.length;++h)l.push(n(a.Sheets[a.SheetNames[h]],a,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function pk(t,e){if(e.bookType=="fods")return I2(t,e);var r=N1(),n="",i=[],s=[];return n="mimetype",_t(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",_t(r,n,I2(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",_t(r,n,GL(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",_t(r,n,Gr+rA()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",_t(r,n,EN(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",_t(r,n,yN(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ll(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function ox(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Jt(Qo(t))}function KL(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Bi(Zs(t))}function XL(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Ho(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function b2(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function YL(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function qL(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function ld(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function $t(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Vr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Lt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=ld(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=ld(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function An(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push($t(n*8+i.type)),i.type==2&&e.push($t(i.data.length)),e.push(i.data))})}),Ho(e)}function sv(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function Ji(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=ld(t,n),s=Lt(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:Vr(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=Lt(o.data),c=Vr(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=s[3])!=null&&e[0]&&(a.merge=Vr(s[3][0].data)>>>0>0),r.push(a)}return r}function gc(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:$t(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:$t(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:$t(a.data.length)}],n[2].push({data:An(a.meta),type:2})});var s=An(n);e.push($t(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),Ho(e)}function QL(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=ld(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Ho(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var d=Ho(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Zi(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(QL(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Ho(e)}function xc(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=$t(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return Ho(e)}function JL(t,e,r,n){var i=Ll(t),s=i.getUint32(4,!0),a=(n>1?12:8)+b2(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,d=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=b2(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(a,!0),a+=4),s&32&&(c=i.getFloat64(a,!0),a+=8),s&64&&(d.setTime(d.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function ZL(t,e,r){var n=Ll(t),i=n.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,c=NaN,d=new Date(2001,0,1);i&1&&(l=YL(t,s),s+=16),i&2&&(c=n.getFloat64(s,!0),s+=8),i&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return h}function Om(t,e){var r=new Uint8Array(32),n=Ll(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,qL(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function Mm(t,e){var r=new Uint8Array(32),n=Ll(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function eB(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return JL(t,e,r,t[0]);case 5:return ZL(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function $n(t){var e=Lt(t);return ld(e[1][0].data)}function R2(t,e){var r=Lt(e.data),n=Vr(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=Lt(a.data),l=Vr(o[1][0].data)>>>0;switch(n){case 1:s[l]=ox(o[3][0].data);break;case 8:{var c=t[$n(o[9][0].data)][0],d=Lt(c.data),h=t[$n(d[1][0].data)][0],p=Vr(h.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var g=Lt(h.data);s[l]=g[3].map(function(y){return ox(y.data)}).join("")}break}}),s}function tB(t,e){var r,n,i,s,a,o,l,c,d,h,p,g,y,x,E=Lt(t),T=Vr(E[1][0].data)>>>0,A=Vr(E[2][0].data)>>>0,_=((n=(r=E[8])==null?void 0:r[0])==null?void 0:n.data)&&Vr(E[8][0].data)>0||!1,P,W;if((s=(i=E[7])==null?void 0:i[0])!=null&&s.data&&e!=0)P=(o=(a=E[7])==null?void 0:a[0])==null?void 0:o.data,W=(c=(l=E[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(d=E[4])==null?void 0:d[0])!=null&&h.data&&e!=1)P=(g=(p=E[4])==null?void 0:p[0])==null?void 0:g.data,W=(x=(y=E[3])==null?void 0:y[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var j=_?4:1,w=Ll(P),F=[],S=0;S<P.length/2;++S){var b=w.getUint16(S*2,!0);b<65535&&F.push([S,b])}if(F.length!=A)throw"Expected ".concat(A," cells, found ").concat(F.length);var N=[];for(S=0;S<F.length-1;++S)N[F[S][0]]=W.subarray(F[S][1]*j,F[S+1][1]*j);return F.length>=1&&(N[F[F.length-1][0]]=W.subarray(F[F.length-1][1]*j)),{R:T,cells:N}}function rB(t,e){var r,n=Lt(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Vr(n[7][0].data)>>>0>0?1:0:-1,s=sv(n[5],function(a){return tB(a,i)});return{nrows:Vr(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,c){if(a[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));a[o.R][c]=l}),a},[])}}function nB(t,e,r){var n,i=Lt(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Vr(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Vr(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=yt(s);var a=Lt(i[4][0].data),o=R2(t,t[$n(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?R2(t,t[$n(a[17][0].data)][0]):[],c=Lt(a[3][0].data),d=0;c[1].forEach(function(h){var p=Lt(h.data),g=t[$n(p[2][0].data)][0],y=Vr(g.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var x=rB(t,g);x.data.forEach(function(E,T){E.forEach(function(A,_){var P=ot({r:d+T,c:_}),W=eB(A,o,l);W&&(r[P]=W)})}),d+=x.nrows})}function iB(t,e){var r=Lt(e.data),n={"!ref":"A1"},i=t[$n(r[2][0].data)],s=Vr(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return nB(t,i[0],n),n}function sB(t,e){var r,n=Lt(e.data),i={name:(r=n[1])!=null&&r[0]?ox(n[1][0].data):"",sheets:[]},s=sv(n[2],$n);return s.forEach(function(a){t[a].forEach(function(o){var l=Vr(o.meta[1][0].data);l==6e3&&i.sheets.push(iB(t,o))})}),i}function aB(t,e){var r=uv(),n=Lt(e.data),i=sv(n[1],$n);if(i.forEach(function(s){t[s].forEach(function(a){var o=Vr(a.meta[1][0].data);if(o==2){var l=sB(t,a);l.sheets.forEach(function(c,d){fv(r,c,d==0?l.name:l.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Lm(t){var e,r,n,i,s={},a=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=Zi(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var d;try{d=Ji(c)}catch(h){return console.log("## "+(h.message||h))}d.forEach(function(h){s[h.id]=h.messages,a.push(h.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Vr(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(c){var d=Vr(c.meta[1][0].data)>>>0;if(d==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return aB(s,o)}function oB(t,e,r){var n,i,s,a;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=t[8])==null?void 0:s[0])==null?void 0:a.data)&&Vr(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=Ll(t[7][0].data),d=0,h=[],p=Ll(t[4][0].data),g=0,y=[],x=0;x<e.length;++x){if(e[x]==null){c.setUint16(x*2,65535,!0),p.setUint16(x*2,65535);continue}c.setUint16(x*2,d,!0),p.setUint16(x*2,g,!0);var E,T;switch(typeof e[x]){case"string":E=Om({t:"s",v:e[x]},r),T=Mm({t:"s",v:e[x]},r);break;case"number":E=Om({t:"n",v:e[x]},r),T=Mm({t:"n",v:e[x]},r);break;case"boolean":E=Om({t:"b",v:e[x]},r),T=Mm({t:"b",v:e[x]},r);break;default:throw new Error("Unsupported value "+e[x])}h.push(E),d+=E.length,y.push(T),g+=T.length,++l}for(t[2][0].data=$t(l);x<t[7][0].data.length/2;++x)c.setUint16(x*2,65535,!0),p.setUint16(x*2,65535,!0);return t[6][0].data=Ho(h),t[3][0].data=Ho(y),l}function lB(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ri(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(yt(n)));var s=Xh(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(H){return H.forEach(function(Q){typeof Q=="string"&&a.push(Q)})});var o={},l=[],c=et.read(e.numbers,{type:"base64"});c.FileIndex.map(function(H,Q){return[H,c.FullPaths[Q]]}).forEach(function(H){var Q=H[0],X=H[1];if(Q.type==2&&Q.name.match(/\.iwa/)){var he=Q.content,Te=Zi(he),Pe=Ji(Te);Pe.forEach(function(ke){l.push(ke.id),o[ke.id]={deps:[],location:X,type:Vr(ke.messages[0].meta[1][0].data)}})}}),l.sort(function(H,Q){return H-Q});var d=l.filter(function(H){return H>1}).map(function(H){return[H,$t(H)]});c.FileIndex.map(function(H,Q){return[H,c.FullPaths[Q]]}).forEach(function(H){var Q=H[0];if(H[1],!!Q.name.match(/\.iwa/)){var X=Ji(Zi(Q.content));X.forEach(function(he){he.messages.forEach(function(Te){d.forEach(function(Pe){he.messages.some(function(ke){return Vr(ke.meta[1][0].data)!=11006&&XL(ke.data,Pe[1])})&&o[Pe[0]].deps.push(he.id)})})})}});for(var h=et.find(c,o[1].location),p=Ji(Zi(h.content)),g,y=0;y<p.length;++y){var x=p[y];x.id==1&&(g=x)}var E=$n(Lt(g.messages[0].data)[1][0].data);for(h=et.find(c,o[E].location),p=Ji(Zi(h.content)),y=0;y<p.length;++y)x=p[y],x.id==E&&(g=x);for(E=$n(Lt(g.messages[0].data)[2][0].data),h=et.find(c,o[E].location),p=Ji(Zi(h.content)),y=0;y<p.length;++y)x=p[y],x.id==E&&(g=x);for(E=$n(Lt(g.messages[0].data)[2][0].data),h=et.find(c,o[E].location),p=Ji(Zi(h.content)),y=0;y<p.length;++y)x=p[y],x.id==E&&(g=x);var T=Lt(g.messages[0].data);{T[6][0].data=$t(n.e.r+1),T[7][0].data=$t(n.e.c+1);var A=$n(T[46][0].data),_=et.find(c,o[A].location),P=Ji(Zi(_.content));{for(var W=0;W<P.length&&P[W].id!=A;++W);if(P[W].id!=A)throw"Bad ColumnRowUIDMapArchive";var j=Lt(P[W].messages[0].data);j[1]=[],j[2]=[],j[3]=[];for(var w=0;w<=n.e.c;++w){var F=[];F[1]=F[2]=[{type:0,data:$t(w+420690)}],j[1].push({type:2,data:An(F)}),j[2].push({type:0,data:$t(w)}),j[3].push({type:0,data:$t(w)})}j[4]=[],j[5]=[],j[6]=[];for(var S=0;S<=n.e.r;++S)F=[],F[1]=F[2]=[{type:0,data:$t(S+726270)}],j[4].push({type:2,data:An(F)}),j[5].push({type:0,data:$t(S)}),j[6].push({type:0,data:$t(S)});P[W].messages[0].data=An(j)}_.content=xc(gc(P)),_.size=_.content.length,delete T[46];var b=Lt(T[4][0].data);{b[7][0].data=$t(n.e.r+1);var N=Lt(b[1][0].data),D=$n(N[2][0].data);_=et.find(c,o[D].location),P=Ji(Zi(_.content));{if(P[0].id!=D)throw"Bad HeaderStorageBucket";var R=Lt(P[0].messages[0].data);for(S=0;S<s.length;++S){var He=Lt(R[2][0].data);He[1][0].data=$t(S),He[4][0].data=$t(s[S].length),R[2][S]={type:R[2][0].type,data:An(He)}}P[0].messages[0].data=An(R)}_.content=xc(gc(P)),_.size=_.content.length;var ve=$n(b[2][0].data);_=et.find(c,o[ve].location),P=Ji(Zi(_.content));{if(P[0].id!=ve)throw"Bad HeaderStorageBucket";for(R=Lt(P[0].messages[0].data),w=0;w<=n.e.c;++w)He=Lt(R[2][0].data),He[1][0].data=$t(w),He[4][0].data=$t(n.e.r+1),R[2][w]={type:R[2][0].type,data:An(He)};P[0].messages[0].data=An(R)}_.content=xc(gc(P)),_.size=_.content.length;var Re=$n(b[4][0].data);(function(){for(var H=et.find(c,o[Re].location),Q=Ji(Zi(H.content)),X,he=0;he<Q.length;++he){var Te=Q[he];Te.id==Re&&(X=Te)}var Pe=Lt(X.messages[0].data);{Pe[3]=[];var ke=[];a.forEach(function(G,Ct){ke[1]=[{type:0,data:$t(Ct)}],ke[2]=[{type:0,data:$t(1)}],ke[3]=[{type:2,data:KL(G)}],Pe[3].push({type:2,data:An(ke)})})}X.messages[0].data=An(Pe);var we=gc(Q),nt=xc(we);H.content=nt,H.size=H.content.length})();var Ae=Lt(b[3][0].data);{var _e=Ae[1][0];delete Ae[2];var Z=Lt(_e.data);{var Ce=$n(Z[2][0].data);(function(){for(var H=et.find(c,o[Ce].location),Q=Ji(Zi(H.content)),X,he=0;he<Q.length;++he){var Te=Q[he];Te.id==Ce&&(X=Te)}var Pe=Lt(X.messages[0].data);{delete Pe[6],delete Ae[7];var ke=new Uint8Array(Pe[5][0].data);Pe[5]=[];for(var we=0,nt=0;nt<=n.e.r;++nt){var G=Lt(ke);we+=oB(G,s[nt],a),G[1][0].data=$t(nt),Pe[5].push({data:An(G),type:2})}Pe[1]=[{type:0,data:$t(n.e.c+1)}],Pe[2]=[{type:0,data:$t(n.e.r+1)}],Pe[3]=[{type:0,data:$t(we)}],Pe[4]=[{type:0,data:$t(n.e.r+1)}]}X.messages[0].data=An(Pe);var Ct=gc(Q),xt=xc(Ct);H.content=xt,H.size=H.content.length})()}_e.data=An(Z)}b[3][0].data=An(Ae)}T[4][0].data=An(b)}g.messages[0].data=An(T);var Be=gc(p),U=xc(Be);return h.content=U,h.size=h.content.length,c}function mk(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function av(t){mk([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function ov(t){mk([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function cB(t){return wt.WS.indexOf(t)>-1?"sheet":t==wt.CS?"chart":t==wt.DS?"dialog":t==wt.MS?"macro":t&&t.length?t:"sheet"}function uB(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,cB(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function fB(t,e,r,n,i,s,a,o,l,c,d,h){try{s[n]=Tf(ji(t,r,!0),e);var p=tn(t,e),g;switch(o){case"sheet":g=DM(p,e,i,l,s[n],c,d,h);break;case"chart":if(g=PM(p,e,i,l,s[n],c,d,h),!g||!g["!drawel"])break;var y=af(g["!drawel"].Target,e),x=rd(y),E=_6(ji(t,y,!0),Tf(ji(t,x,!0),y)),T=af(E,y),A=rd(T);g=oM(ji(t,T,!0),T,l,Tf(ji(t,A,!0),T),c,g);break;case"macro":g=OM(p,e,i,l,s[n],c,d,h);break;case"dialog":g=MM(p,e,i,l,s[n],c,d,h);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=g;var _=[];s&&s[n]&&Ur(s[n]).forEach(function(P){var W="";if(s[n][P].Type==wt.CMNT){W=af(s[n][P].Target,e);var j=VM(tn(t,W,!0),W,l);if(!j||!j.length)return;g2(g,j,!1)}s[n][P].Type==wt.TCMNT&&(W=af(s[n][P].Target,e),_=_.concat(w6(tn(t,W,!0),l)))}),_&&_.length&&g2(g,_,!0,l.people||[])}catch(P){if(l.WTF)throw P}}function qi(t){return t.charAt(0)=="/"?t.slice(1):t}function dB(t,e){if(_u(),e=e||{},av(e),es(t,"META-INF/manifest.xml")||es(t,"objectdata.xml"))return C2(t,e);if(es(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Lm<"u"){if(t.FileIndex)return Lm(t);var r=et.utils.cfb_new();return L_(t).forEach(function(He){_t(r,He,TR(t,He))}),Lm(r)}throw new Error("Unsupported NUMBERS file")}if(!es(t,"[Content_Types].xml"))throw es(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):es(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=L_(t),i=gN(ji(t,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",tn(t,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!tn(t,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(Sf=[],i.sst)try{Sf=jM(tn(t,qi(i.sst)),i.sst,e)}catch(He){if(e.WTF)throw He}e.cellStyles&&i.themes.length&&(l=BM(ji(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(c=LM(tn(t,qi(i.style)),i.style,l,e))}i.links.map(function(He){try{var ve=Tf(ji(t,rd(qi(He))),He);return zM(tn(t,qi(He)),ve,He,e)}catch{}});var d=NM(tn(t,qi(i.workbooks[0])),i.workbooks[0],e),h={},p="";i.coreprops.length&&(p=tn(t,qi(i.coreprops[0]),!0),p&&(h=nA(p)),i.extprops.length!==0&&(p=tn(t,qi(i.extprops[0]),!0),p&&TN(p,h,e)));var g={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(p=ji(t,qi(i.custprops[0]),!0),p&&(g=AN(p,e)));var y={};if((e.bookSheets||e.bookProps)&&(d.Sheets?a=d.Sheets.map(function(ve){return ve.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),e.bookProps&&(y.Props=h,y.Custprops=g),e.bookSheets&&typeof a<"u"&&(y.SheetNames=a),e.bookSheets?y.SheetNames:e.bookProps))return y;a={};var x={};e.bookDeps&&i.calcchain&&(x=UM(tn(t,qi(i.calcchain)),i.calcchain));var E=0,T={},A,_;{var P=d.Sheets;h.Worksheets=P.length,h.SheetNames=[];for(var W=0;W!=P.length;++W)h.SheetNames[W]=P[W].name}var j=s?"bin":"xml",w=i.workbooks[0].lastIndexOf("/"),F=(i.workbooks[0].slice(0,w+1)+"_rels/"+i.workbooks[0].slice(w+1)+".rels").replace(/^\//,"");es(t,F)||(F="xl/_rels/workbook."+j+".rels");var S=Tf(ji(t,F,!0),F.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=WM(tn(t,qi(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=S6(tn(t,qi(i.people[0])),e)),S&&(S=uB(S,d.Sheets));var b=tn(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=h.Worksheets;++E){var N="sheet";if(S&&S[E]?(A="xl/"+S[E][1].replace(/[\/]?xl\//,""),es(t,A)||(A=S[E][1]),es(t,A)||(A=F.replace(/_rels\/.*$/,"")+S[E][1]),N=S[E][2]):(A="xl/worksheets/sheet"+(E+1-b)+"."+j,A=A.replace(/sheet0\./,"sheet.")),_=A.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(E!=e.sheets)continue e;break;case"string":if(h.SheetNames[E].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var D=!1,R=0;R!=e.sheets.length;++R)typeof e.sheets[R]=="number"&&e.sheets[R]==E&&(D=1),typeof e.sheets[R]=="string"&&e.sheets[R].toLowerCase()==h.SheetNames[E].toLowerCase()&&(D=1);if(!D)continue e}}fB(t,A,_,h.SheetNames[E],E,T,a,N,e,d,l,c)}return y={Directory:i,Workbook:d,Props:h,Custprops:g,Deps:x,Sheets:a,SheetNames:h.SheetNames,Strings:Sf,Styles:c,Themes:l,SSF:mr(st)},e&&e.bookFiles&&(t.files?(y.keys=n,y.files=t.files):(y.keys=[],y.files={},t.FullPaths.forEach(function(He,ve){He=He.replace(/^Root Entry[\/]/,""),y.keys.push(He),y.files[He]=t.FileIndex[ve]}))),e&&e.bookVBA&&(i.vba.length>0?y.vbaraw=tn(t,qi(i.vba[0]),!0):i.defaults&&i.defaults.bin===N6&&(y.vbaraw=tn(t,"xl/vbaProject.bin",!0))),y}function hB(t,e){var r=e||{},n="Workbook",i=et.find(t,n);try{if(n="/!DataSpaces/Version",i=et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(WD(i.content),n="/!DataSpaces/DataSpaceMap",i=et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=$D(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=GD(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);XD(i.content)}catch{}if(n="/EncryptionInfo",i=et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=YD(i.content);if(n="/EncryptedPackage",i=et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function pB(t,e){return e.bookType=="ods"?pk(t,e):e.bookType=="numbers"?lB(t,e):e.bookType=="xlsb"?mB(t,e):gB(t,e)}function mB(t,e){Pc=1024,t&&!t.SSF&&(t.SSF=mr(st)),t&&t.SSF&&(_u(),Ip(t.SSF),e.revssf=Rp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Af?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=zA.indexOf(e.bookType)>-1,i=G1();ov(e=e||{});var s=N1(),a="",o=0;if(e.cellXfs=[],Zo(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",_t(s,a,iA(t.Props,e)),i.coreprops.push(a),Gt(e.rels,2,a,wt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,_t(s,a,oA(t.Props)),i.extprops.push(a),Gt(e.rels,3,a,wt.EXT_PROPS),t.Custprops!==t.Props&&Ur(t.Custprops||{}).length>0&&(a="docProps/custom.xml",_t(s,a,lA(t.Custprops)),i.custprops.push(a),Gt(e.rels,4,a,wt.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var d={"!id":{}},h=t.Sheets[t.SheetNames[o-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,_t(s,a,$M(o-1,a,e,t,d)),i.sheets.push(a),Gt(e.wbrels,-1,"worksheets/sheet"+o+"."+r,wt.WS[0])}if(h){var g=h["!comments"],y=!1,x="";g&&g.length>0&&(x="xl/comments"+o+"."+r,_t(s,x,XM(g,x)),i.comments.push(x),Gt(d,-1,"../comments"+o+"."+r,wt.CMNT),y=!0),h["!legacy"]&&y&&_t(s,"xl/drawings/vmlDrawing"+o+".vml",VA(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&_t(s,rd(a),Hc(d))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,_t(s,a,KM(e.Strings,a,e)),i.strs.push(a),Gt(e.wbrels,-1,"sharedStrings."+r,wt.SST)),a="xl/workbook."+r,_t(s,a,HM(t,a)),i.workbooks.push(a),Gt(e.rels,1,a,wt.WB),a="xl/theme/theme1.xml",_t(s,a,J1(t.Themes,e)),i.themes.push(a),Gt(e.wbrels,-1,"theme/theme1.xml",wt.THEME),a="xl/styles."+r,_t(s,a,GM(t,a,e)),i.styles.push(a),Gt(e.wbrels,-1,"styles."+r,wt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",_t(s,a,t.vbaraw),i.vba.push(a),Gt(e.wbrels,-1,"vbaProject.bin",wt.VBA)),a="xl/metadata."+r,_t(s,a,YM(a)),i.metadata.push(a),Gt(e.wbrels,-1,"metadata."+r,wt.XLMETA),_t(s,"[Content_Types].xml",tA(i,e)),_t(s,"_rels/.rels",Hc(e.rels)),_t(s,"xl/_rels/workbook."+r+".rels",Hc(e.wbrels)),delete e.revssf,delete e.ssf,s}function gB(t,e){Pc=1024,t&&!t.SSF&&(t.SSF=mr(st)),t&&t.SSF&&(_u(),Ip(t.SSF),e.revssf=Rp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Af?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=zA.indexOf(e.bookType)>-1,i=G1();ov(e=e||{});var s=N1(),a="",o=0;if(e.cellXfs=[],Zo(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",_t(s,a,iA(t.Props,e)),i.coreprops.push(a),Gt(e.rels,2,a,wt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,_t(s,a,oA(t.Props)),i.extprops.push(a),Gt(e.rels,3,a,wt.EXT_PROPS),t.Custprops!==t.Props&&Ur(t.Custprops||{}).length>0&&(a="docProps/custom.xml",_t(s,a,lA(t.Custprops)),i.custprops.push(a),Gt(e.rels,4,a,wt.CUST_PROPS));var d=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var h={"!id":{}},p=t.Sheets[t.SheetNames[o-1]],g=(p||{})["!type"]||"sheet";switch(g){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,_t(s,a,ZA(o-1,e,t,h)),i.sheets.push(a),Gt(e.wbrels,-1,"worksheets/sheet"+o+"."+r,wt.WS[0])}if(p){var y=p["!comments"],x=!1,E="";if(y&&y.length>0){var T=!1;y.forEach(function(A){A[1].forEach(function(_){_.T==!0&&(T=!0)})}),T&&(E="xl/threadedComments/threadedComment"+o+"."+r,_t(s,E,T6(y,d,e)),i.threadedcomments.push(E),Gt(h,-1,"../threadedComments/threadedComment"+o+"."+r,wt.TCMNT)),E="xl/comments"+o+"."+r,_t(s,E,UA(y)),i.comments.push(E),Gt(h,-1,"../comments"+o+"."+r,wt.CMNT),x=!0}p["!legacy"]&&x&&_t(s,"xl/drawings/vmlDrawing"+o+".vml",VA(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}h["!id"].rId1&&_t(s,rd(a),Hc(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,_t(s,a,FA(e.Strings,e)),i.strs.push(a),Gt(e.wbrels,-1,"sharedStrings."+r,wt.SST)),a="xl/workbook."+r,_t(s,a,ik(t)),i.workbooks.push(a),Gt(e.rels,1,a,wt.WB),a="xl/theme/theme1.xml",_t(s,a,J1(t.Themes,e)),i.themes.push(a),Gt(e.wbrels,-1,"theme/theme1.xml",wt.THEME),a="xl/styles."+r,_t(s,a,MA(t,e)),i.styles.push(a),Gt(e.wbrels,-1,"styles."+r,wt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",_t(s,a,t.vbaraw),i.vba.push(a),Gt(e.wbrels,-1,"vbaProject.bin",wt.VBA)),a="xl/metadata."+r,_t(s,a,jA()),i.metadata.push(a),Gt(e.wbrels,-1,"metadata."+r,wt.XLMETA),d.length>1&&(a="xl/persons/person.xml",_t(s,a,A6(d)),i.people.push(a),Gt(e.wbrels,-1,"persons/person.xml",wt.PEOPLE)),_t(s,"[Content_Types].xml",tA(i,e)),_t(s,"_rels/.rels",Hc(e.rels)),_t(s,"xl/_rels/workbook."+r+".rels",Hc(e.wbrels)),delete e.revssf,delete e.ssf,s}function lv(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Hi(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function xB(t,e){return et.find(t,"EncryptedPackage")?hB(t,e):lk(t,e)}function vB(t,e){var r,n=t,i=e||{};return i.type||(i.type=Et&&Buffer.isBuffer(t)?"buffer":"base64"),r=bS(n,i),dB(r,i)}function gk(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return sx(t.slice(r),e);default:break e}return su.to_workbook(t,e)}function yB(t,e){var r="",n=lv(t,e);switch(e.type){case"base64":r=Hi(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Dl(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Jt(r)),e.type="binary",gk(r,e)}function _B(t,e){var r=t;return e.type=="base64"&&(r=Hi(r)),r=qf.utils.decode(1200,r.slice(2),"str"),e.type="binary",gk(r,e)}function EB(t){return t.match(/[^\x00-\x7F]/)?Zs(t):t}function Bm(t,e,r,n){return n?(r.type="string",su.to_workbook(t,r)):su.to_workbook(e,r)}function Oc(t,e){C1();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Oc(new Uint8Array(t),(r=mr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Gc={},r.dateNF&&(Gc.dateNF=r.dateNF),r.type||(r.type=Et&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Et?"buffer":"binary",n=mR(t),typeof Uint8Array<"u"&&!Et&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=EB(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=mr(r),r.type="array",Oc(F1(n),r)}switch((i=lv(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return xB(et.read(n,r),r);break;case 9:if(i[1]<=8)return lk(n,r);break;case 60:return sx(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return kD(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return kA.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?vB(n,r):Bm(t,n,r,s);case 239:return i[3]===60?sx(n,r):Bm(t,n,r,s);case 255:if(i[1]===254)return _B(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Tl.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Tl.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return ix.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return DA.to_workbook(n,r);break;case 10:case 13:case 32:return yB(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return AD.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?ix.to_workbook(n,r):Bm(t,n,r,s)}function xk(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Ad(e.file,et.write(t,{type:Et?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return et.write(t,e)}function wB(t,e){var r=mr(e||{}),n=pB(t,r);return TB(n,r)}function TB(t,e){var r={},n=Et?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?et.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Fp(i))}return e.password&&typeof encrypt_agile<"u"?xk(encrypt_agile(i,e.password),e):e.type==="file"?Ad(e.file,i):e.type=="string"?Jt(i):i}function SB(t,e){var r=e||{},n=EL(t,r);return xk(n,r)}function qs(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Qf(Zs(n));case"binary":return Zs(n);case"string":return t;case"file":return Ad(e.file,n,"utf8");case"buffer":return Et?Ga(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):qs(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function AB(t,e){switch(e.type){case"base64":return Qf(t);case"binary":return t;case"string":return t;case"file":return Ad(e.file,t,"binary");case"buffer":return Et?Ga(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function D0(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Qf(r):e.type=="string"?Jt(r):r;case"file":return Ad(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function vk(t,e){C1(),xM(t);var r=mr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=vk(t,r);return r.type="array",Fp(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return qs(pL(t,r),r);case"slk":case"sylk":return qs(AA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return qs(uk(t.Sheets[t.SheetNames[i]],r),r);case"txt":return AB(yk(t.Sheets[t.SheetNames[i]],r),r);case"csv":return qs(cv(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return qs(kA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return D0(ix.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return qs(su.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return qs(DA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return qs(CA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return qs(pk(t,r),r);case"wk1":return D0(Tl.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return D0(Tl.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),D0(ck(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),SB(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return wB(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function kB(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function jm(t,e,r){var n={};return n.type="file",n.file=e,kB(n),vk(t,n)}function CB(t,e,r,n,i,s,a,o){var l=$r(r),c=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,p=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!a||t[r])for(var g=e.s.c;g<=e.e.c;++g){var y=a?t[r][g]:t[n[g]+l];if(y===void 0||y.t===void 0){if(c===void 0)continue;s[g]!=null&&(p[s[g]]=c);continue}var x=y.v;switch(y.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(s[g]!=null){if(x==null)if(y.t=="e"&&x===null)p[s[g]]=null;else if(c!==void 0)p[s[g]]=c;else if(d&&x===null)p[s[g]]=null;else continue;else p[s[g]]=d&&(y.t!=="n"||y.t==="n"&&o.rawNumbers!==!1)?x:ja(y,x,o);x!=null&&(h=!1)}}return{row:p,isempty:h}}function Xh(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},d=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof d){case"string":l=Ot(d);break;case"number":l=Ot(t["!ref"]),l.s.r=d;break;default:l=d}n>0&&(i=0);var h=$r(l.s.r),p=[],g=[],y=0,x=0,E=Array.isArray(t),T=l.s.r,A=0,_={};E&&!t[T]&&(t[T]=[]);var P=c.skipHidden&&t["!cols"]||[],W=c.skipHidden&&t["!rows"]||[];for(A=l.s.c;A<=l.e.c;++A)if(!(P[A]||{}).hidden)switch(p[A]=Cr(A),r=E?t[T][A]:t[p[A]+h],n){case 1:s[A]=A-l.s.c;break;case 2:s[A]=p[A];break;case 3:s[A]=c.header[A-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=ja(r,null,c),x=_[a]||0,!x)_[a]=1;else{do o=a+"_"+x++;while(_[o]);_[a]=x,_[o]=1}s[A]=o}for(T=l.s.r+i;T<=l.e.r;++T)if(!(W[T]||{}).hidden){var j=CB(t,l,T,p,n,s,E,c);(j.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(g[y++]=j.row)}return g.length=y,g}var N2=/"/g;function FB(t,e,r,n,i,s,a,o){for(var l=!0,c=[],d="",h=$r(r),p=e.s.c;p<=e.e.c;++p)if(n[p]){var g=o.dense?(t[r]||[])[p]:t[n[p]+h];if(g==null)d="";else if(g.v!=null){l=!1,d=""+(o.rawNumbers&&g.t=="n"?g.v:ja(g,null,o));for(var y=0,x=0;y!==d.length;++y)if((x=d.charCodeAt(y))===i||x===s||x===34||o.forceQuotes){d='"'+d.replace(N2,'""')+'"';break}d=="ID"&&(d='"ID"')}else g.f!=null&&!g.F?(l=!1,d="="+g.f,d.indexOf(",")>=0&&(d='"'+d.replace(N2,'""')+'"')):d="";c.push(d)}return o.blankrows===!1&&l?null:c.join(a)}function cv(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=Ot(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),d="",h=[];n.dense=Array.isArray(t);for(var p=n.skipHidden&&t["!cols"]||[],g=n.skipHidden&&t["!rows"]||[],y=i.s.c;y<=i.e.c;++y)(p[y]||{}).hidden||(h[y]=Cr(y));for(var x=0,E=i.s.r;E<=i.e.r;++E)(g[E]||{}).hidden||(d=FB(t,i,E,h,a,l,s,n),d!=null&&(n.strip&&(d=d.replace(c,"")),(d||n.blankrows!==!1)&&r.push((x++?o:"")+d)));return delete n.dense,r.join("")}function yk(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=cv(t,e);return r}function IB(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=Ot(t["!ref"]),s="",a=[],o,l=[],c=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=Cr(o);for(var d=i.s.r;d<=i.e.r;++d)for(s=$r(d),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=c?(t[d]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function _k(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Fr(n.origin):n.origin;a=l.r,o=l.c}var c,d={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var h=Ot(s["!ref"]);d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),a==-1&&(a=h.e.r+1,d.e.r=a+e.length-1+i)}else a==-1&&(a=0,d.e.r=e.length-1+i);var p=n.header||[],g=0;e.forEach(function(x,E){Ur(x).forEach(function(T){(g=p.indexOf(T))==-1&&(p[g=p.length]=T);var A=x[T],_="z",P="",W=ot({c:o+g,r:a+E+i});c=cd(s,W),A&&typeof A=="object"&&!(A instanceof Date)?s[W]=A:(typeof A=="number"?_="n":typeof A=="boolean"?_="b":typeof A=="string"?_="s":A instanceof Date?(_="d",n.cellDates||(_="n",A=dn(A)),P=n.dateNF||st[14]):A===null&&n.nullError&&(_="e",A=0),c?(c.t=_,c.v=A,delete c.w,delete c.R,P&&(c.z=P)):s[W]=c={t:_,v:A},P&&(c.z=P))})}),d.e.c=Math.max(d.e.c,o+p.length-1);var y=$r(a);if(i)for(g=0;g<p.length;++g)s[Cr(g+o)+y]={t:"s",v:p[g]};return s["!ref"]=yt(d),s}function bB(t,e){return _k(null,t,e)}function cd(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Fr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?cd(t,ot(e)):cd(t,ot({r:e,c:r||0}))}function RB(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function uv(){return{SheetNames:[],Sheets:{}}}function fv(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(nk(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function NB(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=RB(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function DB(t,e){return t.z=e,t}function Ek(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function PB(t,e,r){return Ek(t,"#"+e,r)}function OB(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function MB(t,e,r,n){for(var i=typeof e!="string"?e:Ot(e),s=typeof e=="string"?e:yt(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=cd(t,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var Pi={encode_col:Cr,encode_row:$r,encode_cell:ot,encode_range:yt,decode_col:V1,decode_row:j1,split_cell:KR,decode_cell:Fr,decode_range:Ri,format_cell:ja,sheet_add_aoa:XS,sheet_add_json:_k,sheet_add_dom:fk,aoa_to_sheet:Eu,json_to_sheet:bB,table_to_sheet:dk,table_to_book:WL,sheet_to_csv:cv,sheet_to_txt:yk,sheet_to_json:Xh,sheet_to_html:uk,sheet_to_formulae:IB,sheet_to_row_object_array:Xh,sheet_get_cell:cd,book_new:uv,book_append_sheet:fv,book_set_sheet_visibility:NB,cell_set_number_format:DB,cell_set_hyperlink:Ek,cell_set_internal_link:PB,cell_add_comment:OB,sheet_set_array_formula:MB,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var LB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BB=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),St=(t,e)=>{const r=ye.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:l,...c},d)=>ye.createElement("svg",{ref:d,...LB,width:i,height:i,stroke:n,strokeWidth:a?Number(s)*24/Number(i):s,className:["lucide",`lucide-${BB(t)}`,o].join(" "),...c},[...e.map(([h,p])=>ye.createElement(h,p)),...Array.isArray(l)?l:[l]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D2=St("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P2=St("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jB=St("BellRing",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O2=St("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M2=St("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VB=St("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UB=St("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L2=St("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B2=St("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zB=St("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vm=St("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Um=St("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WB=St("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yu=St("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HB=St("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P0=St("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qu=St("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zm=St("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j2=St("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O0=St("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wm=St("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $B=St("Merge",[["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M12 2v10.3a4 4 0 0 1-1.172 2.872L4 22",key:"1hyw0i"}],["path",{d:"m20 22-5-5",key:"1m27yz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GB=St("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M0=St("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V2=St("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hm=St("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qu=St("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KB=St("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L0=St("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U2=St("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XB=St("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z2=St("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YB=St("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=St("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=St("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W2=St("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fl=St("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var H2={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wk=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},qB=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[r++],a=t[r++],o=t[r++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},Tk={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,o=a?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,d=s>>2,h=(s&3)<<4|o>>4;let p=(o&15)<<2|c>>6,g=c&63;l||(g=64,a||(p=64)),n.push(r[d],r[h],r[p],r[g])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(wk(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):qB(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const c=i<t.length?r[t.charAt(i)]:64;++i;const h=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||c==null||h==null)throw new QB;const p=s<<2|o>>4;if(n.push(p),c!==64){const g=o<<4&240|c>>2;if(n.push(g),h!==64){const y=c<<6&192|h;n.push(y)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class QB extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const JB=function(t){const e=wk(t);return Tk.encodeByteArray(e,!0)},Yh=function(t){return JB(t).replace(/\./g,"")},Sk=function(t){try{return Tk.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZB(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e9=()=>ZB().__FIREBASE_DEFAULTS__,t9=()=>{if(typeof process>"u"||typeof H2>"u")return;const t=H2.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},r9=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Sk(t[1]);return e&&JSON.parse(e)},Lp=()=>{try{return e9()||t9()||r9()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Ak=t=>{var e,r;return(r=(e=Lp())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},n9=t=>{const e=Ak(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},kk=()=>{var t;return(t=Lp())===null||t===void 0?void 0:t.config},Ck=t=>{var e;return(e=Lp())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i9{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s9(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Yh(JSON.stringify(r)),Yh(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ti(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function a9(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ti())}function o9(){var t;const e=(t=Lp())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function l9(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function c9(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function u9(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function f9(){const t=ti();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function d9(){return!o9()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function h9(){try{return typeof indexedDB=="object"}catch{return!1}}function p9(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m9="FirebaseError";class Ya extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=m9,Object.setPrototypeOf(this,Ya.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Dd.prototype.create)}}class Dd{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?g9(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new Ya(i,o,n)}}function g9(t,e){return t.replace(x9,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const x9=/\{\$([^}]+)}/g;function v9(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function qh(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const s=t[i],a=e[i];if($2(s)&&$2(a)){if(!qh(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function $2(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pd(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function y9(t,e){const r=new _9(t,e);return r.subscribe.bind(r)}class _9{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");E9(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=$m),i.error===void 0&&(i.error=$m),i.complete===void 0&&(i.complete=$m);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function E9(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function $m(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function js(t){return t&&t._delegate?t._delegate:t}class Bl{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w9{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new i9;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(S9(e))try{this.getOrInitializeService({instanceIdentifier:dl})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=dl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=dl){return this.instances.has(e)}getOptions(e=dl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:T9(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=dl){return this.component?this.component.multipleInstances?e:dl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function T9(t){return t===dl?void 0:t}function S9(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A9{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new w9(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var kt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(kt||(kt={}));const k9={debug:kt.DEBUG,verbose:kt.VERBOSE,info:kt.INFO,warn:kt.WARN,error:kt.ERROR,silent:kt.SILENT},C9=kt.INFO,F9={[kt.DEBUG]:"log",[kt.VERBOSE]:"log",[kt.INFO]:"info",[kt.WARN]:"warn",[kt.ERROR]:"error"},I9=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=F9[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class dv{constructor(e){this.name=e,this._logLevel=C9,this._logHandler=I9,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in kt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?k9[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,kt.DEBUG,...e),this._logHandler(this,kt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,kt.VERBOSE,...e),this._logHandler(this,kt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,kt.INFO,...e),this._logHandler(this,kt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,kt.WARN,...e),this._logHandler(this,kt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,kt.ERROR,...e),this._logHandler(this,kt.ERROR,...e)}}const b9=(t,e)=>e.some(r=>t instanceof r);let G2,K2;function R9(){return G2||(G2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function N9(){return K2||(K2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Fk=new WeakMap,lx=new WeakMap,Ik=new WeakMap,Gm=new WeakMap,hv=new WeakMap;function D9(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(Po(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&Fk.set(r,t)}).catch(()=>{}),hv.set(e,t),e}function P9(t){if(lx.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});lx.set(t,e)}let cx={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return lx.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Ik.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Po(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function O9(t){cx=t(cx)}function M9(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Km(this),e,...r);return Ik.set(n,e.sort?e.sort():[e]),Po(n)}:N9().includes(t)?function(...e){return t.apply(Km(this),e),Po(Fk.get(this))}:function(...e){return Po(t.apply(Km(this),e))}}function L9(t){return typeof t=="function"?M9(t):(t instanceof IDBTransaction&&P9(t),b9(t,R9())?new Proxy(t,cx):t)}function Po(t){if(t instanceof IDBRequest)return D9(t);if(Gm.has(t))return Gm.get(t);const e=L9(t);return e!==t&&(Gm.set(t,e),hv.set(e,t)),e}const Km=t=>hv.get(t);function B9(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),o=Po(a);return n&&a.addEventListener("upgradeneeded",l=>{n(Po(a.result),l.oldVersion,l.newVersion,Po(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const j9=["get","getKey","getAll","getAllKeys","count"],V9=["put","add","delete","clear"],Xm=new Map;function X2(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Xm.get(e))return Xm.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=V9.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||j9.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),i&&l.done]))[0]};return Xm.set(e,s),s}O9(t=>({...t,get:(e,r,n)=>X2(e,r)||t.get(e,r,n),has:(e,r)=>!!X2(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U9{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(z9(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function z9(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const ux="@firebase/app",Y2="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Va=new dv("@firebase/app"),W9="@firebase/app-compat",H9="@firebase/analytics-compat",$9="@firebase/analytics",G9="@firebase/app-check-compat",K9="@firebase/app-check",X9="@firebase/auth",Y9="@firebase/auth-compat",q9="@firebase/database",Q9="@firebase/data-connect",J9="@firebase/database-compat",Z9="@firebase/functions",ej="@firebase/functions-compat",tj="@firebase/installations",rj="@firebase/installations-compat",nj="@firebase/messaging",ij="@firebase/messaging-compat",sj="@firebase/performance",aj="@firebase/performance-compat",oj="@firebase/remote-config",lj="@firebase/remote-config-compat",cj="@firebase/storage",uj="@firebase/storage-compat",fj="@firebase/firestore",dj="@firebase/vertexai-preview",hj="@firebase/firestore-compat",pj="firebase",mj="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fx="[DEFAULT]",gj={[ux]:"fire-core",[W9]:"fire-core-compat",[$9]:"fire-analytics",[H9]:"fire-analytics-compat",[K9]:"fire-app-check",[G9]:"fire-app-check-compat",[X9]:"fire-auth",[Y9]:"fire-auth-compat",[q9]:"fire-rtdb",[Q9]:"fire-data-connect",[J9]:"fire-rtdb-compat",[Z9]:"fire-fn",[ej]:"fire-fn-compat",[tj]:"fire-iid",[rj]:"fire-iid-compat",[nj]:"fire-fcm",[ij]:"fire-fcm-compat",[sj]:"fire-perf",[aj]:"fire-perf-compat",[oj]:"fire-rc",[lj]:"fire-rc-compat",[cj]:"fire-gcs",[uj]:"fire-gcs-compat",[fj]:"fire-fst",[hj]:"fire-fst-compat",[dj]:"fire-vertex","fire-js":"fire-js",[pj]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qh=new Map,xj=new Map,dx=new Map;function q2(t,e){try{t.container.addComponent(e)}catch(r){Va.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function ou(t){const e=t.name;if(dx.has(e))return Va.debug(`There were multiple attempts to register component ${e}.`),!1;dx.set(e,t);for(const r of Qh.values())q2(r,t);for(const r of xj.values())q2(r,t);return!0}function pv(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function So(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Oo=new Dd("app","Firebase",vj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yj{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Bl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Oo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tu=mj;function bk(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:fx,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw Oo.create("bad-app-name",{appName:String(i)});if(r||(r=kk()),!r)throw Oo.create("no-options");const s=Qh.get(i);if(s){if(qh(r,s.options)&&qh(n,s.config))return s;throw Oo.create("duplicate-app",{appName:i})}const a=new A9(i);for(const l of dx.values())a.addComponent(l);const o=new yj(r,n,a);return Qh.set(i,o),o}function Rk(t=fx){const e=Qh.get(t);if(!e&&t===fx&&kk())return bk();if(!e)throw Oo.create("no-app",{appName:t});return e}function Mo(t,e,r){var n;let i=(n=gj[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Va.warn(o.join(" "));return}ou(new Bl(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _j="firebase-heartbeat-database",Ej=1,ud="firebase-heartbeat-store";let Ym=null;function Nk(){return Ym||(Ym=B9(_j,Ej,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ud)}catch(r){console.warn(r)}}}}).catch(t=>{throw Oo.create("idb-open",{originalErrorMessage:t.message})})),Ym}async function wj(t){try{const r=(await Nk()).transaction(ud),n=await r.objectStore(ud).get(Dk(t));return await r.done,n}catch(e){if(e instanceof Ya)Va.warn(e.message);else{const r=Oo.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Va.warn(r.message)}}}async function Q2(t,e){try{const n=(await Nk()).transaction(ud,"readwrite");await n.objectStore(ud).put(e,Dk(t)),await n.done}catch(r){if(r instanceof Ya)Va.warn(r.message);else{const n=Oo.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Va.warn(n.message)}}}function Dk(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tj=1024,Sj=30*24*60*60*1e3;class Aj{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new Cj(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=J2();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=Sj}),this._storage.overwrite(this._heartbeatsCache))}catch(n){Va.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=J2(),{heartbeatsToSend:n,unsentEntries:i}=kj(this._heartbeatsCache.heartbeats),s=Yh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return Va.warn(r),""}}}function J2(){return new Date().toISOString().substring(0,10)}function kj(t,e=Tj){const r=[];let n=t.slice();for(const i of t){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),Z2(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),Z2(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class Cj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return h9()?p9().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await wj(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return Q2(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return Q2(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Z2(t){return Yh(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fj(t){ou(new Bl("platform-logger",e=>new U9(e),"PRIVATE")),ou(new Bl("heartbeat",e=>new Aj(e),"PRIVATE")),Mo(ux,Y2,t),Mo(ux,Y2,"esm2017"),Mo("fire-js","")}Fj("");var Ij="firebase",bj="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Mo(Ij,bj,"app");var eE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Al,Pk;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,F){function S(){}S.prototype=F.prototype,w.D=F.prototype,w.prototype=new S,w.prototype.constructor=w,w.C=function(b,N,D){for(var R=Array(arguments.length-2),He=2;He<arguments.length;He++)R[He-2]=arguments[He];return F.prototype[N].apply(b,R)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,F,S){S||(S=0);var b=Array(16);if(typeof F=="string")for(var N=0;16>N;++N)b[N]=F.charCodeAt(S++)|F.charCodeAt(S++)<<8|F.charCodeAt(S++)<<16|F.charCodeAt(S++)<<24;else for(N=0;16>N;++N)b[N]=F[S++]|F[S++]<<8|F[S++]<<16|F[S++]<<24;F=w.g[0],S=w.g[1],N=w.g[2];var D=w.g[3],R=F+(D^S&(N^D))+b[0]+3614090360&4294967295;F=S+(R<<7&4294967295|R>>>25),R=D+(N^F&(S^N))+b[1]+3905402710&4294967295,D=F+(R<<12&4294967295|R>>>20),R=N+(S^D&(F^S))+b[2]+606105819&4294967295,N=D+(R<<17&4294967295|R>>>15),R=S+(F^N&(D^F))+b[3]+3250441966&4294967295,S=N+(R<<22&4294967295|R>>>10),R=F+(D^S&(N^D))+b[4]+4118548399&4294967295,F=S+(R<<7&4294967295|R>>>25),R=D+(N^F&(S^N))+b[5]+1200080426&4294967295,D=F+(R<<12&4294967295|R>>>20),R=N+(S^D&(F^S))+b[6]+2821735955&4294967295,N=D+(R<<17&4294967295|R>>>15),R=S+(F^N&(D^F))+b[7]+4249261313&4294967295,S=N+(R<<22&4294967295|R>>>10),R=F+(D^S&(N^D))+b[8]+1770035416&4294967295,F=S+(R<<7&4294967295|R>>>25),R=D+(N^F&(S^N))+b[9]+2336552879&4294967295,D=F+(R<<12&4294967295|R>>>20),R=N+(S^D&(F^S))+b[10]+4294925233&4294967295,N=D+(R<<17&4294967295|R>>>15),R=S+(F^N&(D^F))+b[11]+2304563134&4294967295,S=N+(R<<22&4294967295|R>>>10),R=F+(D^S&(N^D))+b[12]+1804603682&4294967295,F=S+(R<<7&4294967295|R>>>25),R=D+(N^F&(S^N))+b[13]+4254626195&4294967295,D=F+(R<<12&4294967295|R>>>20),R=N+(S^D&(F^S))+b[14]+2792965006&4294967295,N=D+(R<<17&4294967295|R>>>15),R=S+(F^N&(D^F))+b[15]+1236535329&4294967295,S=N+(R<<22&4294967295|R>>>10),R=F+(N^D&(S^N))+b[1]+4129170786&4294967295,F=S+(R<<5&4294967295|R>>>27),R=D+(S^N&(F^S))+b[6]+3225465664&4294967295,D=F+(R<<9&4294967295|R>>>23),R=N+(F^S&(D^F))+b[11]+643717713&4294967295,N=D+(R<<14&4294967295|R>>>18),R=S+(D^F&(N^D))+b[0]+3921069994&4294967295,S=N+(R<<20&4294967295|R>>>12),R=F+(N^D&(S^N))+b[5]+3593408605&4294967295,F=S+(R<<5&4294967295|R>>>27),R=D+(S^N&(F^S))+b[10]+38016083&4294967295,D=F+(R<<9&4294967295|R>>>23),R=N+(F^S&(D^F))+b[15]+3634488961&4294967295,N=D+(R<<14&4294967295|R>>>18),R=S+(D^F&(N^D))+b[4]+3889429448&4294967295,S=N+(R<<20&4294967295|R>>>12),R=F+(N^D&(S^N))+b[9]+568446438&4294967295,F=S+(R<<5&4294967295|R>>>27),R=D+(S^N&(F^S))+b[14]+3275163606&4294967295,D=F+(R<<9&4294967295|R>>>23),R=N+(F^S&(D^F))+b[3]+4107603335&4294967295,N=D+(R<<14&4294967295|R>>>18),R=S+(D^F&(N^D))+b[8]+1163531501&4294967295,S=N+(R<<20&4294967295|R>>>12),R=F+(N^D&(S^N))+b[13]+2850285829&4294967295,F=S+(R<<5&4294967295|R>>>27),R=D+(S^N&(F^S))+b[2]+4243563512&4294967295,D=F+(R<<9&4294967295|R>>>23),R=N+(F^S&(D^F))+b[7]+1735328473&4294967295,N=D+(R<<14&4294967295|R>>>18),R=S+(D^F&(N^D))+b[12]+2368359562&4294967295,S=N+(R<<20&4294967295|R>>>12),R=F+(S^N^D)+b[5]+4294588738&4294967295,F=S+(R<<4&4294967295|R>>>28),R=D+(F^S^N)+b[8]+2272392833&4294967295,D=F+(R<<11&4294967295|R>>>21),R=N+(D^F^S)+b[11]+1839030562&4294967295,N=D+(R<<16&4294967295|R>>>16),R=S+(N^D^F)+b[14]+4259657740&4294967295,S=N+(R<<23&4294967295|R>>>9),R=F+(S^N^D)+b[1]+2763975236&4294967295,F=S+(R<<4&4294967295|R>>>28),R=D+(F^S^N)+b[4]+1272893353&4294967295,D=F+(R<<11&4294967295|R>>>21),R=N+(D^F^S)+b[7]+4139469664&4294967295,N=D+(R<<16&4294967295|R>>>16),R=S+(N^D^F)+b[10]+3200236656&4294967295,S=N+(R<<23&4294967295|R>>>9),R=F+(S^N^D)+b[13]+681279174&4294967295,F=S+(R<<4&4294967295|R>>>28),R=D+(F^S^N)+b[0]+3936430074&4294967295,D=F+(R<<11&4294967295|R>>>21),R=N+(D^F^S)+b[3]+3572445317&4294967295,N=D+(R<<16&4294967295|R>>>16),R=S+(N^D^F)+b[6]+76029189&4294967295,S=N+(R<<23&4294967295|R>>>9),R=F+(S^N^D)+b[9]+3654602809&4294967295,F=S+(R<<4&4294967295|R>>>28),R=D+(F^S^N)+b[12]+3873151461&4294967295,D=F+(R<<11&4294967295|R>>>21),R=N+(D^F^S)+b[15]+530742520&4294967295,N=D+(R<<16&4294967295|R>>>16),R=S+(N^D^F)+b[2]+3299628645&4294967295,S=N+(R<<23&4294967295|R>>>9),R=F+(N^(S|~D))+b[0]+4096336452&4294967295,F=S+(R<<6&4294967295|R>>>26),R=D+(S^(F|~N))+b[7]+1126891415&4294967295,D=F+(R<<10&4294967295|R>>>22),R=N+(F^(D|~S))+b[14]+2878612391&4294967295,N=D+(R<<15&4294967295|R>>>17),R=S+(D^(N|~F))+b[5]+4237533241&4294967295,S=N+(R<<21&4294967295|R>>>11),R=F+(N^(S|~D))+b[12]+1700485571&4294967295,F=S+(R<<6&4294967295|R>>>26),R=D+(S^(F|~N))+b[3]+2399980690&4294967295,D=F+(R<<10&4294967295|R>>>22),R=N+(F^(D|~S))+b[10]+4293915773&4294967295,N=D+(R<<15&4294967295|R>>>17),R=S+(D^(N|~F))+b[1]+2240044497&4294967295,S=N+(R<<21&4294967295|R>>>11),R=F+(N^(S|~D))+b[8]+1873313359&4294967295,F=S+(R<<6&4294967295|R>>>26),R=D+(S^(F|~N))+b[15]+4264355552&4294967295,D=F+(R<<10&4294967295|R>>>22),R=N+(F^(D|~S))+b[6]+2734768916&4294967295,N=D+(R<<15&4294967295|R>>>17),R=S+(D^(N|~F))+b[13]+1309151649&4294967295,S=N+(R<<21&4294967295|R>>>11),R=F+(N^(S|~D))+b[4]+4149444226&4294967295,F=S+(R<<6&4294967295|R>>>26),R=D+(S^(F|~N))+b[11]+3174756917&4294967295,D=F+(R<<10&4294967295|R>>>22),R=N+(F^(D|~S))+b[2]+718787259&4294967295,N=D+(R<<15&4294967295|R>>>17),R=S+(D^(N|~F))+b[9]+3951481745&4294967295,w.g[0]=w.g[0]+F&4294967295,w.g[1]=w.g[1]+(N+(R<<21&4294967295|R>>>11))&4294967295,w.g[2]=w.g[2]+N&4294967295,w.g[3]=w.g[3]+D&4294967295}n.prototype.u=function(w,F){F===void 0&&(F=w.length);for(var S=F-this.blockSize,b=this.B,N=this.h,D=0;D<F;){if(N==0)for(;D<=S;)i(this,w,D),D+=this.blockSize;if(typeof w=="string"){for(;D<F;)if(b[N++]=w.charCodeAt(D++),N==this.blockSize){i(this,b),N=0;break}}else for(;D<F;)if(b[N++]=w[D++],N==this.blockSize){i(this,b),N=0;break}}this.h=N,this.o+=F},n.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var F=1;F<w.length-8;++F)w[F]=0;var S=8*this.o;for(F=w.length-8;F<w.length;++F)w[F]=S&255,S/=256;for(this.u(w),w=Array(16),F=S=0;4>F;++F)for(var b=0;32>b;b+=8)w[S++]=this.g[F]>>>b&255;return w};function s(w,F){var S=o;return Object.prototype.hasOwnProperty.call(S,w)?S[w]:S[w]=F(w)}function a(w,F){this.h=F;for(var S=[],b=!0,N=w.length-1;0<=N;N--){var D=w[N]|0;b&&D==F||(S[N]=D,b=!1)}this.g=S}var o={};function l(w){return-128<=w&&128>w?s(w,function(F){return new a([F|0],0>F?-1:0)}):new a([w|0],0>w?-1:0)}function c(w){if(isNaN(w)||!isFinite(w))return h;if(0>w)return E(c(-w));for(var F=[],S=1,b=0;w>=S;b++)F[b]=w/S|0,S*=4294967296;return new a(F,0)}function d(w,F){if(w.length==0)throw Error("number format error: empty string");if(F=F||10,2>F||36<F)throw Error("radix out of range: "+F);if(w.charAt(0)=="-")return E(d(w.substring(1),F));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=c(Math.pow(F,8)),b=h,N=0;N<w.length;N+=8){var D=Math.min(8,w.length-N),R=parseInt(w.substring(N,N+D),F);8>D?(D=c(Math.pow(F,D)),b=b.j(D).add(c(R))):(b=b.j(S),b=b.add(c(R)))}return b}var h=l(0),p=l(1),g=l(16777216);t=a.prototype,t.m=function(){if(x(this))return-E(this).m();for(var w=0,F=1,S=0;S<this.g.length;S++){var b=this.i(S);w+=(0<=b?b:4294967296+b)*F,F*=4294967296}return w},t.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(y(this))return"0";if(x(this))return"-"+E(this).toString(w);for(var F=c(Math.pow(w,6)),S=this,b="";;){var N=P(S,F).g;S=T(S,N.j(F));var D=((0<S.g.length?S.g[0]:S.h)>>>0).toString(w);if(S=N,y(S))return D+b;for(;6>D.length;)D="0"+D;b=D+b}},t.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function y(w){if(w.h!=0)return!1;for(var F=0;F<w.g.length;F++)if(w.g[F]!=0)return!1;return!0}function x(w){return w.h==-1}t.l=function(w){return w=T(this,w),x(w)?-1:y(w)?0:1};function E(w){for(var F=w.g.length,S=[],b=0;b<F;b++)S[b]=~w.g[b];return new a(S,~w.h).add(p)}t.abs=function(){return x(this)?E(this):this},t.add=function(w){for(var F=Math.max(this.g.length,w.g.length),S=[],b=0,N=0;N<=F;N++){var D=b+(this.i(N)&65535)+(w.i(N)&65535),R=(D>>>16)+(this.i(N)>>>16)+(w.i(N)>>>16);b=R>>>16,D&=65535,R&=65535,S[N]=R<<16|D}return new a(S,S[S.length-1]&-2147483648?-1:0)};function T(w,F){return w.add(E(F))}t.j=function(w){if(y(this)||y(w))return h;if(x(this))return x(w)?E(this).j(E(w)):E(E(this).j(w));if(x(w))return E(this.j(E(w)));if(0>this.l(g)&&0>w.l(g))return c(this.m()*w.m());for(var F=this.g.length+w.g.length,S=[],b=0;b<2*F;b++)S[b]=0;for(b=0;b<this.g.length;b++)for(var N=0;N<w.g.length;N++){var D=this.i(b)>>>16,R=this.i(b)&65535,He=w.i(N)>>>16,ve=w.i(N)&65535;S[2*b+2*N]+=R*ve,A(S,2*b+2*N),S[2*b+2*N+1]+=D*ve,A(S,2*b+2*N+1),S[2*b+2*N+1]+=R*He,A(S,2*b+2*N+1),S[2*b+2*N+2]+=D*He,A(S,2*b+2*N+2)}for(b=0;b<F;b++)S[b]=S[2*b+1]<<16|S[2*b];for(b=F;b<2*F;b++)S[b]=0;return new a(S,0)};function A(w,F){for(;(w[F]&65535)!=w[F];)w[F+1]+=w[F]>>>16,w[F]&=65535,F++}function _(w,F){this.g=w,this.h=F}function P(w,F){if(y(F))throw Error("division by zero");if(y(w))return new _(h,h);if(x(w))return F=P(E(w),F),new _(E(F.g),E(F.h));if(x(F))return F=P(w,E(F)),new _(E(F.g),F.h);if(30<w.g.length){if(x(w)||x(F))throw Error("slowDivide_ only works with positive integers.");for(var S=p,b=F;0>=b.l(w);)S=W(S),b=W(b);var N=j(S,1),D=j(b,1);for(b=j(b,2),S=j(S,2);!y(b);){var R=D.add(b);0>=R.l(w)&&(N=N.add(S),D=R),b=j(b,1),S=j(S,1)}return F=T(w,N.j(F)),new _(N,F)}for(N=h;0<=w.l(F);){for(S=Math.max(1,Math.floor(w.m()/F.m())),b=Math.ceil(Math.log(S)/Math.LN2),b=48>=b?1:Math.pow(2,b-48),D=c(S),R=D.j(F);x(R)||0<R.l(w);)S-=b,D=c(S),R=D.j(F);y(D)&&(D=p),N=N.add(D),w=T(w,R)}return new _(N,w)}t.A=function(w){return P(this,w).h},t.and=function(w){for(var F=Math.max(this.g.length,w.g.length),S=[],b=0;b<F;b++)S[b]=this.i(b)&w.i(b);return new a(S,this.h&w.h)},t.or=function(w){for(var F=Math.max(this.g.length,w.g.length),S=[],b=0;b<F;b++)S[b]=this.i(b)|w.i(b);return new a(S,this.h|w.h)},t.xor=function(w){for(var F=Math.max(this.g.length,w.g.length),S=[],b=0;b<F;b++)S[b]=this.i(b)^w.i(b);return new a(S,this.h^w.h)};function W(w){for(var F=w.g.length+1,S=[],b=0;b<F;b++)S[b]=w.i(b)<<1|w.i(b-1)>>>31;return new a(S,w.h)}function j(w,F){var S=F>>5;F%=32;for(var b=w.g.length-S,N=[],D=0;D<b;D++)N[D]=0<F?w.i(D+S)>>>F|w.i(D+S+1)<<32-F:w.i(D+S);return new a(N,w.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Pk=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=d,Al=a}).apply(typeof eE<"u"?eE:typeof self<"u"?self:typeof window<"u"?window:{});var B0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ok,of,Mk,nh,hx,Lk,Bk,jk;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,v,k){return u==Array.prototype||u==Object.prototype||(u[v]=k.value),u};function r(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof B0=="object"&&B0];for(var v=0;v<u.length;++v){var k=u[v];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var n=r(this);function i(u,v){if(v)e:{var k=n;u=u.split(".");for(var O=0;O<u.length-1;O++){var ie=u[O];if(!(ie in k))break e;k=k[ie]}u=u[u.length-1],O=k[u],v=v(O),v!=O&&v!=null&&e(k,u,{configurable:!0,writable:!0,value:v})}}function s(u,v){u instanceof String&&(u+="");var k=0,O=!1,ie={next:function(){if(!O&&k<u.length){var de=k++;return{value:v(de,u[de]),done:!1}}return O=!0,{done:!0,value:void 0}}};return ie[Symbol.iterator]=function(){return ie},ie}i("Array.prototype.values",function(u){return u||function(){return s(this,function(v,k){return k})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(u){var v=typeof u;return v=v!="object"?v:u?Array.isArray(u)?"array":v:"null",v=="array"||v=="object"&&typeof u.length=="number"}function c(u){var v=typeof u;return v=="object"&&u!=null||v=="function"}function d(u,v,k){return u.call.apply(u.bind,arguments)}function h(u,v,k){if(!u)throw Error();if(2<arguments.length){var O=Array.prototype.slice.call(arguments,2);return function(){var ie=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ie,O),u.apply(v,ie)}}return function(){return u.apply(v,arguments)}}function p(u,v,k){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,p.apply(null,arguments)}function g(u,v){var k=Array.prototype.slice.call(arguments,1);return function(){var O=k.slice();return O.push.apply(O,arguments),u.apply(this,O)}}function y(u,v){function k(){}k.prototype=v.prototype,u.aa=v.prototype,u.prototype=new k,u.prototype.constructor=u,u.Qb=function(O,ie,de){for(var We=Array(arguments.length-2),Wt=2;Wt<arguments.length;Wt++)We[Wt-2]=arguments[Wt];return v.prototype[ie].apply(O,We)}}function x(u){const v=u.length;if(0<v){const k=Array(v);for(let O=0;O<v;O++)k[O]=u[O];return k}return[]}function E(u,v){for(let k=1;k<arguments.length;k++){const O=arguments[k];if(l(O)){const ie=u.length||0,de=O.length||0;u.length=ie+de;for(let We=0;We<de;We++)u[ie+We]=O[We]}else u.push(O)}}class T{constructor(v,k){this.i=v,this.j=k,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function A(u){return/^[\s\xa0]*$/.test(u)}function _(){var u=o.navigator;return u&&(u=u.userAgent)?u:""}function P(u){return P[" "](u),u}P[" "]=function(){};var W=_().indexOf("Gecko")!=-1&&!(_().toLowerCase().indexOf("webkit")!=-1&&_().indexOf("Edge")==-1)&&!(_().indexOf("Trident")!=-1||_().indexOf("MSIE")!=-1)&&_().indexOf("Edge")==-1;function j(u,v,k){for(const O in u)v.call(k,u[O],O,u)}function w(u,v){for(const k in u)v.call(void 0,u[k],k,u)}function F(u){const v={};for(const k in u)v[k]=u[k];return v}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(u,v){let k,O;for(let ie=1;ie<arguments.length;ie++){O=arguments[ie];for(k in O)u[k]=O[k];for(let de=0;de<S.length;de++)k=S[de],Object.prototype.hasOwnProperty.call(O,k)&&(u[k]=O[k])}}function N(u){var v=1;u=u.split(":");const k=[];for(;0<v&&u.length;)k.push(u.shift()),v--;return u.length&&k.push(u.join(":")),k}function D(u){o.setTimeout(()=>{throw u},0)}function R(){var u=Z;let v=null;return u.g&&(v=u.g,u.g=u.g.next,u.g||(u.h=null),v.next=null),v}class He{constructor(){this.h=this.g=null}add(v,k){const O=ve.get();O.set(v,k),this.h?this.h.next=O:this.g=O,this.h=O}}var ve=new T(()=>new Re,u=>u.reset());class Re{constructor(){this.next=this.g=this.h=null}set(v,k){this.h=v,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let Ae,_e=!1,Z=new He,Ce=()=>{const u=o.Promise.resolve(void 0);Ae=()=>{u.then(Be)}};var Be=()=>{for(var u;u=R();){try{u.h.call(u.g)}catch(k){D(k)}var v=ve;v.j(u),100>v.h&&(v.h++,u.next=v.g,v.g=u)}_e=!1};function U(){this.s=this.s,this.C=this.C}U.prototype.s=!1,U.prototype.ma=function(){this.s||(this.s=!0,this.N())},U.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function H(u,v){this.type=u,this.g=this.target=v,this.defaultPrevented=!1}H.prototype.h=function(){this.defaultPrevented=!0};var Q=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var u=!1,v=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const k=()=>{};o.addEventListener("test",k,v),o.removeEventListener("test",k,v)}catch{}return u}();function X(u,v){if(H.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var k=this.type=u.type,O=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=v,v=u.relatedTarget){if(W){e:{try{P(v.nodeName);var ie=!0;break e}catch{}ie=!1}ie||(v=null)}}else k=="mouseover"?v=u.fromElement:k=="mouseout"&&(v=u.toElement);this.relatedTarget=v,O?(this.clientX=O.clientX!==void 0?O.clientX:O.pageX,this.clientY=O.clientY!==void 0?O.clientY:O.pageY,this.screenX=O.screenX||0,this.screenY=O.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:he[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&X.aa.h.call(this)}}y(X,H);var he={2:"touch",3:"pen",4:"mouse"};X.prototype.h=function(){X.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Te="closure_listenable_"+(1e6*Math.random()|0),Pe=0;function ke(u,v,k,O,ie){this.listener=u,this.proxy=null,this.src=v,this.type=k,this.capture=!!O,this.ha=ie,this.key=++Pe,this.da=this.fa=!1}function we(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function nt(u){this.src=u,this.g={},this.h=0}nt.prototype.add=function(u,v,k,O,ie){var de=u.toString();u=this.g[de],u||(u=this.g[de]=[],this.h++);var We=Ct(u,v,O,ie);return-1<We?(v=u[We],k||(v.fa=!1)):(v=new ke(v,this.src,de,!!O,ie),v.fa=k,u.push(v)),v};function G(u,v){var k=v.type;if(k in u.g){var O=u.g[k],ie=Array.prototype.indexOf.call(O,v,void 0),de;(de=0<=ie)&&Array.prototype.splice.call(O,ie,1),de&&(we(v),u.g[k].length==0&&(delete u.g[k],u.h--))}}function Ct(u,v,k,O){for(var ie=0;ie<u.length;++ie){var de=u[ie];if(!de.da&&de.listener==v&&de.capture==!!k&&de.ha==O)return ie}return-1}var xt="closure_lm_"+(1e6*Math.random()|0),Rt={};function pt(u,v,k,O,ie){if(Array.isArray(v)){for(var de=0;de<v.length;de++)pt(u,v[de],k,O,ie);return null}return k=_i(k),u&&u[Te]?u.K(v,k,c(O)?!!O.capture:!1,ie):$e(u,v,k,!1,O,ie)}function $e(u,v,k,O,ie,de){if(!v)throw Error("Invalid event type");var We=c(ie)?!!ie.capture:!!ie,Wt=yi(u);if(Wt||(u[xt]=Wt=new nt(u)),k=Wt.add(v,k,O,We,de),k.proxy)return k;if(O=qt(),k.proxy=O,O.src=u,O.listener=k,u.addEventListener)Q||(ie=We),ie===void 0&&(ie=!1),u.addEventListener(v.toString(),O,ie);else if(u.attachEvent)u.attachEvent(vi(v.toString()),O);else if(u.addListener&&u.removeListener)u.addListener(O);else throw Error("addEventListener and attachEvent are unavailable.");return k}function qt(){function u(k){return v.call(u.src,u.listener,k)}const v=Ki;return u}function wn(u,v,k,O,ie){if(Array.isArray(v))for(var de=0;de<v.length;de++)wn(u,v[de],k,O,ie);else O=c(O)?!!O.capture:!!O,k=_i(k),u&&u[Te]?(u=u.i,v=String(v).toString(),v in u.g&&(de=u.g[v],k=Ct(de,k,O,ie),-1<k&&(we(de[k]),Array.prototype.splice.call(de,k,1),de.length==0&&(delete u.g[v],u.h--)))):u&&(u=yi(u))&&(v=u.g[v.toString()],u=-1,v&&(u=Ct(v,k,O,ie)),(k=-1<u?v[u]:null)&&hn(k))}function hn(u){if(typeof u!="number"&&u&&!u.da){var v=u.src;if(v&&v[Te])G(v.i,u);else{var k=u.type,O=u.proxy;v.removeEventListener?v.removeEventListener(k,O,u.capture):v.detachEvent?v.detachEvent(vi(k),O):v.addListener&&v.removeListener&&v.removeListener(O),(k=yi(v))?(G(k,u),k.h==0&&(k.src=null,v[xt]=null)):we(u)}}}function vi(u){return u in Rt?Rt[u]:Rt[u]="on"+u}function Ki(u,v){if(u.da)u=!0;else{v=new X(v,this);var k=u.listener,O=u.ha||u.src;u.fa&&hn(u),u=k.call(O,v)}return u}function yi(u){return u=u[xt],u instanceof nt?u:null}var Nr="__closure_events_fn_"+(1e9*Math.random()>>>0);function _i(u){return typeof u=="function"?u:(u[Nr]||(u[Nr]=function(v){return u.handleEvent(v)}),u[Nr])}function zt(){U.call(this),this.i=new nt(this),this.M=this,this.F=null}y(zt,U),zt.prototype[Te]=!0,zt.prototype.removeEventListener=function(u,v,k,O){wn(this,u,v,k,O)};function wr(u,v){var k,O=u.F;if(O)for(k=[];O;O=O.F)k.push(O);if(u=u.M,O=v.type||v,typeof v=="string")v=new H(v,u);else if(v instanceof H)v.target=v.target||u;else{var ie=v;v=new H(O,u),b(v,ie)}if(ie=!0,k)for(var de=k.length-1;0<=de;de--){var We=v.g=k[de];ie=Zt(We,O,!0,v)&&ie}if(We=v.g=u,ie=Zt(We,O,!0,v)&&ie,ie=Zt(We,O,!1,v)&&ie,k)for(de=0;de<k.length;de++)We=v.g=k[de],ie=Zt(We,O,!1,v)&&ie}zt.prototype.N=function(){if(zt.aa.N.call(this),this.i){var u=this.i,v;for(v in u.g){for(var k=u.g[v],O=0;O<k.length;O++)we(k[O]);delete u.g[v],u.h--}}this.F=null},zt.prototype.K=function(u,v,k,O){return this.i.add(String(u),v,!1,k,O)},zt.prototype.L=function(u,v,k,O){return this.i.add(String(u),v,!0,k,O)};function Zt(u,v,k,O){if(v=u.i.g[String(v)],!v)return!0;v=v.concat();for(var ie=!0,de=0;de<v.length;++de){var We=v[de];if(We&&!We.da&&We.capture==k){var Wt=We.listener,Jr=We.ha||We.src;We.fa&&G(u.i,We),ie=Wt.call(Jr,O)!==!1&&ie}}return ie&&!O.defaultPrevented}function ni(u,v,k){if(typeof u=="function")k&&(u=p(u,k));else if(u&&typeof u.handleEvent=="function")u=p(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:o.setTimeout(u,v||0)}function ut(u){u.g=ni(()=>{u.g=null,u.i&&(u.i=!1,ut(u))},u.l);const v=u.h;u.h=null,u.m.apply(null,v)}class sr extends U{constructor(v,k){super(),this.m=v,this.l=k,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:ut(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Tr(u){U.call(this),this.h=u,this.g={}}y(Tr,U);var gr=[];function ii(u){j(u.g,function(v,k){this.g.hasOwnProperty(k)&&hn(v)},u),u.g={}}Tr.prototype.N=function(){Tr.aa.N.call(this),ii(this)},Tr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var qa=o.JSON.stringify,ua=o.JSON.parse,ae=class{stringify(u){return o.JSON.stringify(u,void 0)}parse(u){return o.JSON.parse(u,void 0)}};function Sr(){}Sr.prototype.h=null;function ds(u){return u.h||(u.h=u.i())}function Qa(){}var Xi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function fa(){H.call(this,"d")}y(fa,H);function Ei(){H.call(this,"c")}y(Ei,H);var On={},sn=null;function da(){return sn=sn||new zt}On.La="serverreachability";function ha(u){H.call(this,On.La,u)}y(ha,H);function pa(u){const v=da();wr(v,new ha(v))}On.STAT_EVENT="statevent";function Mn(u,v){H.call(this,On.STAT_EVENT,u),this.stat=v}y(Mn,H);function Kr(u){const v=da();wr(v,new Mn(v,u))}On.Ma="timingevent";function rr(u,v){H.call(this,On.Ma,u),this.size=v}y(rr,H);function Ln(u,v){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){u()},v)}function Bn(){this.g=!0}Bn.prototype.xa=function(){this.g=!1};function hs(u,v,k,O,ie,de){u.info(function(){if(u.g)if(de)for(var We="",Wt=de.split("&"),Jr=0;Jr<Wt.length;Jr++){var It=Wt[Jr].split("=");if(1<It.length){var pn=It[0];It=It[1];var mn=pn.split("_");We=2<=mn.length&&mn[1]=="type"?We+(pn+"="+It+"&"):We+(pn+"=redacted&")}}else We=null;else We=de;return"XMLHTTP REQ ("+O+") [attempt "+ie+"]: "+v+`
`+k+`
`+We})}function Iu(u,v,k,O,ie,de,We){u.info(function(){return"XMLHTTP RESP ("+O+") [ attempt "+ie+"]: "+v+`
`+k+`
`+de+" "+We})}function I(u,v,k,O){u.info(function(){return"XMLHTTP TEXT ("+v+"): "+M(u,k)+(O?" "+O:"")})}function V(u,v){u.info(function(){return"TIMEOUT: "+v})}Bn.prototype.info=function(){};function M(u,v){if(!u.g)return v;if(!v)return null;try{var k=JSON.parse(v);if(k){for(u=0;u<k.length;u++)if(Array.isArray(k[u])){var O=k[u];if(!(2>O.length)){var ie=O[1];if(Array.isArray(ie)&&!(1>ie.length)){var de=ie[0];if(de!="noop"&&de!="stop"&&de!="close")for(var We=1;We<ie.length;We++)ie[We]=""}}}}return qa(k)}catch{return v}}var L={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},z={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},B;function oe(){}y(oe,Sr),oe.prototype.g=function(){return new XMLHttpRequest},oe.prototype.i=function(){return{}},B=new oe;function fe(u,v,k,O){this.j=u,this.i=v,this.l=k,this.R=O||1,this.U=new Tr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new se}function se(){this.i=null,this.g="",this.h=!1}var re={},le={};function pe(u,v,k){u.L=1,u.v=Ja(ar(v)),u.m=k,u.P=!0,Oe(u,null)}function Oe(u,v){u.F=Date.now(),ze(u),u.A=ar(u.v);var k=u.A,O=u.R;Array.isArray(O)||(O=[String(O)]),Nu(k.i,"t",O),u.C=0,k=u.j.J,u.h=new se,u.g=Zd(u.j,k?v:null,!u.m),0<u.O&&(u.M=new sr(p(u.Y,u,u.g),u.O)),v=u.U,k=u.g,O=u.ca;var ie="readystatechange";Array.isArray(ie)||(ie&&(gr[0]=ie.toString()),ie=gr);for(var de=0;de<ie.length;de++){var We=pt(k,ie[de],O||v.handleEvent,!1,v.h||v);if(!We)break;v.g[We.key]=We}v=u.H?F(u.H):{},u.m?(u.u||(u.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,v)):(u.u="GET",u.g.ea(u.A,u.u,null,v)),pa(),hs(u.i,u.u,u.A,u.l,u.R,u.m)}fe.prototype.ca=function(u){u=u.target;const v=this.M;v&&Ts(u)==3?v.j():this.Y(u)},fe.prototype.Y=function(u){try{if(u==this.g)e:{const mn=Ts(this.g);var v=this.g.Ba();const so=this.g.Z();if(!(3>mn)&&(mn!=3||this.g&&(this.h.h||this.g.oa()||il(this.g)))){this.J||mn!=4||v==7||(v==8||0>=so?pa(3):pa(2)),Mt(this);var k=this.g.Z();this.X=k;t:if(Le(this)){var O=il(this.g);u="";var ie=O.length,de=Ts(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ft(this),Nt(this);var We="";break t}this.h.i=new o.TextDecoder}for(v=0;v<ie;v++)this.h.h=!0,u+=this.h.i.decode(O[v],{stream:!(de&&v==ie-1)});O.length=0,this.h.g+=u,this.C=0,We=this.h.g}else We=this.g.oa();if(this.o=k==200,Iu(this.i,this.u,this.A,this.l,this.R,mn,k),this.o){if(this.T&&!this.K){t:{if(this.g){var Wt,Jr=this.g;if((Wt=Jr.g?Jr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(Wt)){var It=Wt;break t}}It=null}if(k=It)I(this.i,this.l,k,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,si(this,k);else{this.o=!1,this.s=3,Kr(12),Ft(this),Nt(this);break e}}if(this.P){k=!0;let Di;for(;!this.J&&this.C<We.length;)if(Di=be(this,We),Di==le){mn==4&&(this.s=4,Kr(14),k=!1),I(this.i,this.l,null,"[Incomplete Response]");break}else if(Di==re){this.s=4,Kr(15),I(this.i,this.l,We,"[Invalid Chunk]"),k=!1;break}else I(this.i,this.l,Di,null),si(this,Di);if(Le(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),mn!=4||We.length!=0||this.h.h||(this.s=1,Kr(16),k=!1),this.o=this.o&&k,!k)I(this.i,this.l,We,"[Invalid Chunked Response]"),Ft(this),Nt(this);else if(0<We.length&&!this.W){this.W=!0;var pn=this.j;pn.g==this&&pn.ba&&!pn.M&&(pn.j.info("Great, no buffering proxy detected. Bytes received: "+We.length),al(pn),pn.M=!0,Kr(11))}}else I(this.i,this.l,We,null),si(this,We);mn==4&&Ft(this),this.o&&!this.J&&(mn==4?qd(this.j,this):(this.o=!1,ze(this)))}else Ss(this.g),k==400&&0<We.indexOf("Unknown SID")?(this.s=3,Kr(12)):(this.s=0,Kr(13)),Ft(this),Nt(this)}}}catch{}finally{}};function Le(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function be(u,v){var k=u.C,O=v.indexOf(`
`,k);return O==-1?le:(k=Number(v.substring(k,O)),isNaN(k)?re:(O+=1,O+k>v.length?le:(v=v.slice(O,O+k),u.C=O+k,v)))}fe.prototype.cancel=function(){this.J=!0,Ft(this)};function ze(u){u.S=Date.now()+u.I,tt(u,u.I)}function tt(u,v){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Ln(p(u.ba,u),v)}function Mt(u){u.B&&(o.clearTimeout(u.B),u.B=null)}fe.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(V(this.i,this.A),this.L!=2&&(pa(),Kr(17)),Ft(this),this.s=2,Nt(this)):tt(this,this.S-u)};function Nt(u){u.j.G==0||u.J||qd(u.j,u)}function Ft(u){Mt(u);var v=u.M;v&&typeof v.ma=="function"&&v.ma(),u.M=null,ii(u.U),u.g&&(v=u.g,u.g=null,v.abort(),v.ma())}function si(u,v){try{var k=u.j;if(k.G!=0&&(k.g==u||qr(k.h,u))){if(!u.K&&qr(k.h,u)&&k.G==3){try{var O=k.Da.g.parse(v)}catch{O=null}if(Array.isArray(O)&&O.length==3){var ie=O;if(ie[0]==0){e:if(!k.u){if(k.g)if(k.g.F+3e3<u.F)lc(k),Ht(k);else break e;Ou(k),Kr(18)}}else k.za=ie[1],0<k.za-k.T&&37500>ie[2]&&k.F&&k.v==0&&!k.C&&(k.C=Ln(p(k.Za,k),6e3));if(1>=ps(k.h)&&k.ca){try{k.ca()}catch{}k.ca=void 0}}else _a(k,11)}else if((u.K||k.g==u)&&lc(k),!A(v))for(ie=k.Da.g.parse(v),v=0;v<ie.length;v++){let It=ie[v];if(k.T=It[0],It=It[1],k.G==2)if(It[0]=="c"){k.K=It[1],k.ia=It[2];const pn=It[3];pn!=null&&(k.la=pn,k.j.info("VER="+k.la));const mn=It[4];mn!=null&&(k.Aa=mn,k.j.info("SVER="+k.Aa));const so=It[5];so!=null&&typeof so=="number"&&0<so&&(O=1.5*so,k.L=O,k.j.info("backChannelRequestTimeoutMs_="+O)),O=k;const Di=u.g;if(Di){const fc=Di.g?Di.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(fc){var de=O.h;de.g||fc.indexOf("spdy")==-1&&fc.indexOf("quic")==-1&&fc.indexOf("h2")==-1||(de.j=de.l,de.g=new Set,de.h&&(Vs(de,de.h),de.h=null))}if(O.D){const Bu=Di.g?Di.g.getResponseHeader("X-HTTP-Session-Id"):null;Bu&&(O.ya=Bu,Qt(O.I,O.D,Bu))}}k.G=3,k.l&&k.l.ua(),k.ba&&(k.R=Date.now()-u.F,k.j.info("Handshake RTT: "+k.R+"ms")),O=k;var We=u;if(O.qa=Mu(O,O.J?O.ia:null,O.W),We.K){Zl(O.h,We);var Wt=We,Jr=O.L;Jr&&(Wt.I=Jr),Wt.B&&(Mt(Wt),ze(Wt)),O.g=We}else zs(O);0<k.i.length&&ya(k)}else It[0]!="stop"&&It[0]!="close"||_a(k,7);else k.G==3&&(It[0]=="stop"||It[0]=="close"?It[0]=="stop"?_a(k,7):Pu(k):It[0]!="noop"&&k.l&&k.l.ta(It),k.v=0)}}pa(4)}catch{}}var Xr=class{constructor(u,v){this.g=u,this.map=v}};function wi(u){this.l=u||10,o.PerformanceNavigationTiming?(u=o.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Yr(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function ps(u){return u.h?1:u.g?u.g.size:0}function qr(u,v){return u.h?u.h==v:u.g?u.g.has(v):!1}function Vs(u,v){u.g?u.g.add(v):u.h=v}function Zl(u,v){u.h&&u.h==v?u.h=null:u.g&&u.g.has(v)&&u.g.delete(v)}wi.prototype.cancel=function(){if(this.i=el(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function el(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let v=u.i;for(const k of u.g.values())v=v.concat(k.D);return v}return x(u.i)}function Ti(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var v=[],k=u.length,O=0;O<k;O++)v.push(u[O]);return v}v=[],k=0;for(O in u)v[k++]=u[O];return v}function ec(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var v=[];u=u.length;for(var k=0;k<u;k++)v.push(k);return v}v=[],k=0;for(const O in u)v[k++]=O;return v}}}function ai(u,v){if(u.forEach&&typeof u.forEach=="function")u.forEach(v,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,v,void 0);else for(var k=ec(u),O=Ti(u),ie=O.length,de=0;de<ie;de++)v.call(void 0,O[de],k&&k[de],u)}var tl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Us(u,v){if(u){u=u.split("&");for(var k=0;k<u.length;k++){var O=u[k].indexOf("="),ie=null;if(0<=O){var de=u[k].substring(0,O);ie=u[k].substring(O+1)}else de=u[k];v(de,ie?decodeURIComponent(ie.replace(/\+/g," ")):"")}}}function ms(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof ms){this.h=u.h,ma(this,u.j),this.o=u.o,this.g=u.g,tc(this,u.s),this.l=u.l;var v=u.i,k=new Za;k.i=v.i,v.g&&(k.g=new Map(v.g),k.h=v.h),rl(this,k),this.m=u.m}else u&&(v=String(u).match(tl))?(this.h=!1,ma(this,v[1]||"",!0),this.o=lt(v[2]||""),this.g=lt(v[3]||"",!0),tc(this,v[4]),this.l=lt(v[5]||"",!0),rl(this,v[6]||"",!0),this.m=lt(v[7]||"")):(this.h=!1,this.i=new Za(null,this.h))}ms.prototype.toString=function(){var u=[],v=this.j;v&&u.push(gs(v,ga,!0),":");var k=this.g;return(k||v=="file")&&(u.push("//"),(v=this.o)&&u.push(gs(v,ga,!0),"@"),u.push(encodeURIComponent(String(k)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.s,k!=null&&u.push(":",String(k))),(k=this.l)&&(this.g&&k.charAt(0)!="/"&&u.push("/"),u.push(gs(k,k.charAt(0)=="/"?$d:Hd,!0))),(k=this.i.toString())&&u.push("?",k),(k=this.m)&&u.push("#",gs(k,Gd)),u.join("")};function ar(u){return new ms(u)}function ma(u,v,k){u.j=k?lt(v,!0):v,u.j&&(u.j=u.j.replace(/:$/,""))}function tc(u,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);u.s=v}else u.s=null}function rl(u,v,k){v instanceof Za?(u.i=v,Ni(u.i,u.h)):(k||(v=gs(v,bu)),u.i=new Za(v,u.h))}function Qt(u,v,k){u.i.set(v,k)}function Ja(u){return Qt(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function lt(u,v){return u?v?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function gs(u,v,k){return typeof u=="string"?(u=encodeURI(u).replace(v,xr),k&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function xr(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var ga=/[#\/\?@]/g,Hd=/[#\?:]/g,$d=/[#\?]/g,bu=/[#\?@]/g,Gd=/#/g;function Za(u,v){this.h=this.g=null,this.i=u||null,this.j=!!v}function xs(u){u.g||(u.g=new Map,u.h=0,u.i&&Us(u.i,function(v,k){u.add(decodeURIComponent(v.replace(/\+/g," ")),k)}))}t=Za.prototype,t.add=function(u,v){xs(this),this.i=null,u=Dr(this,u);var k=this.g.get(u);return k||this.g.set(u,k=[]),k.push(v),this.h+=1,this};function eo(u,v){xs(u),v=Dr(u,v),u.g.has(v)&&(u.i=null,u.h-=u.g.get(v).length,u.g.delete(v))}function Ru(u,v){return xs(u),v=Dr(u,v),u.g.has(v)}t.forEach=function(u,v){xs(this),this.g.forEach(function(k,O){k.forEach(function(ie){u.call(v,ie,O,this)},this)},this)},t.na=function(){xs(this);const u=Array.from(this.g.values()),v=Array.from(this.g.keys()),k=[];for(let O=0;O<v.length;O++){const ie=u[O];for(let de=0;de<ie.length;de++)k.push(v[O])}return k},t.V=function(u){xs(this);let v=[];if(typeof u=="string")Ru(this,u)&&(v=v.concat(this.g.get(Dr(this,u))));else{u=Array.from(this.g.values());for(let k=0;k<u.length;k++)v=v.concat(u[k])}return v},t.set=function(u,v){return xs(this),this.i=null,u=Dr(this,u),Ru(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[v]),this.h+=1,this},t.get=function(u,v){return u?(u=this.V(u),0<u.length?String(u[0]):v):v};function Nu(u,v,k){eo(u,v),0<k.length&&(u.i=null,u.g.set(Dr(u,v),x(k)),u.h+=k.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],v=Array.from(this.g.keys());for(var k=0;k<v.length;k++){var O=v[k];const de=encodeURIComponent(String(O)),We=this.V(O);for(O=0;O<We.length;O++){var ie=de;We[O]!==""&&(ie+="="+encodeURIComponent(String(We[O]))),u.push(ie)}}return this.i=u.join("&")};function Dr(u,v){return v=String(v),u.j&&(v=v.toLowerCase()),v}function Ni(u,v){v&&!u.j&&(xs(u),u.i=null,u.g.forEach(function(k,O){var ie=O.toLowerCase();O!=ie&&(eo(this,O),Nu(this,ie,k))},u)),u.j=v}function rc(u,v){const k=new Bn;if(o.Image){const O=new Image;O.onload=g(vs,k,"TestLoadImage: loaded",!0,v,O),O.onerror=g(vs,k,"TestLoadImage: error",!1,v,O),O.onabort=g(vs,k,"TestLoadImage: abort",!1,v,O),O.ontimeout=g(vs,k,"TestLoadImage: timeout",!1,v,O),o.setTimeout(function(){O.ontimeout&&O.ontimeout()},1e4),O.src=u}else v(!1)}function nc(u,v){const k=new Bn,O=new AbortController,ie=setTimeout(()=>{O.abort(),vs(k,"TestPingServer: timeout",!1,v)},1e4);fetch(u,{signal:O.signal}).then(de=>{clearTimeout(ie),de.ok?vs(k,"TestPingServer: ok",!0,v):vs(k,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(ie),vs(k,"TestPingServer: error",!1,v)})}function vs(u,v,k,O,ie){try{ie&&(ie.onload=null,ie.onerror=null,ie.onabort=null,ie.ontimeout=null),O(k)}catch{}}function ic(){this.g=new ae}function Qr(u,v,k){const O=k||"";try{ai(u,function(ie,de){let We=ie;c(ie)&&(We=qa(ie)),v.push(O+de+"="+encodeURIComponent(We))})}catch(ie){throw v.push(O+"type="+encodeURIComponent("_badmap")),ie}}function ys(u){this.l=u.Ub||null,this.j=u.eb||!1}y(ys,Sr),ys.prototype.g=function(){return new er(this.l,this.j)},ys.prototype.i=function(u){return function(){return u}}({});function er(u,v){zt.call(this),this.D=u,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(er,zt),t=er.prototype,t.open=function(u,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=v,this.readyState=1,va(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(v.body=u),(this.D||o).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,xa(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,va(this)),this.g&&(this.readyState=3,va(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;_s(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function _s(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var v=u.value?u.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!u.done}))&&(this.response=this.responseText+=v)}u.done?xa(this):va(this),this.readyState==3&&_s(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,xa(this))},t.Qa=function(u){this.g&&(this.response=u,xa(this))},t.ga=function(){this.g&&xa(this)};function xa(u){u.readyState=4,u.l=null,u.j=null,u.v=null,va(u)}t.setRequestHeader=function(u,v){this.u.append(u,v)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],v=this.h.entries();for(var k=v.next();!k.done;)k=k.value,u.push(k[0]+": "+k[1]),k=v.next();return u.join(`\r
`)};function va(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(er.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function nl(u){let v="";return j(u,function(k,O){v+=O,v+=":",v+=k,v+=`\r
`}),v}function Es(u,v,k){e:{for(O in k){var O=!1;break e}O=!0}O||(k=nl(k),typeof u=="string"?k!=null&&encodeURIComponent(String(k)):Qt(u,v,k))}function or(u){zt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(or,zt);var Kd=/^https?$/i,Jp=["POST","PUT"];t=or.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,v,k,O){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);v=v?v.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():B.g(),this.v=this.o?ds(this.o):ds(B),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(v,String(u),!0),this.B=!1}catch(de){to(this,de);return}if(u=k||"",k=new Map(this.headers),O)if(Object.getPrototypeOf(O)===Object.prototype)for(var ie in O)k.set(ie,O[ie]);else if(typeof O.keys=="function"&&typeof O.get=="function")for(const de of O.keys())k.set(de,O.get(de));else throw Error("Unknown input type for opt_headers: "+String(O));O=Array.from(k.keys()).find(de=>de.toLowerCase()=="content-type"),ie=o.FormData&&u instanceof o.FormData,!(0<=Array.prototype.indexOf.call(Jp,v,void 0))||O||ie||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[de,We]of k)this.g.setRequestHeader(de,We);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Xd(this),this.u=!0,this.g.send(u),this.u=!1}catch(de){to(this,de)}};function to(u,v){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=v,u.m=5,Du(u),sc(u)}function Du(u){u.A||(u.A=!0,wr(u,"complete"),wr(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,wr(this,"complete"),wr(this,"abort"),sc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),sc(this,!0)),or.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?ws(this):this.bb())},t.bb=function(){ws(this)};function ws(u){if(u.h&&typeof a<"u"&&(!u.v[1]||Ts(u)!=4||u.Z()!=2)){if(u.u&&Ts(u)==4)ni(u.Ea,0,u);else if(wr(u,"readystatechange"),Ts(u)==4){u.h=!1;try{const We=u.Z();e:switch(We){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var k;if(!(k=v)){var O;if(O=We===0){var ie=String(u.D).match(tl)[1]||null;!ie&&o.self&&o.self.location&&(ie=o.self.location.protocol.slice(0,-1)),O=!Kd.test(ie?ie.toLowerCase():"")}k=O}if(k)wr(u,"complete"),wr(u,"success");else{u.m=6;try{var de=2<Ts(u)?u.g.statusText:""}catch{de=""}u.l=de+" ["+u.Z()+"]",Du(u)}}finally{sc(u)}}}}function sc(u,v){if(u.g){Xd(u);const k=u.g,O=u.v[0]?()=>{}:null;u.g=null,u.v=null,v||wr(u,"ready");try{k.onreadystatechange=O}catch{}}}function Xd(u){u.I&&(o.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function Ts(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<Ts(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var v=this.g.responseText;return u&&v.indexOf(u)==0&&(v=v.substring(u.length)),ua(v)}};function il(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Ss(u){const v={};u=(u.g&&2<=Ts(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let O=0;O<u.length;O++){if(A(u[O]))continue;var k=N(u[O]);const ie=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const de=v[ie]||[];v[ie]=de,de.push(k)}w(v,function(O){return O.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ro(u,v,k){return k&&k.internalChannelParams&&k.internalChannelParams[u]||v}function ac(u){this.Aa=0,this.i=[],this.j=new Bn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ro("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ro("baseRetryDelayMs",5e3,u),this.cb=ro("retryDelaySeedMs",1e4,u),this.Wa=ro("forwardChannelMaxRetries",2,u),this.wa=ro("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new wi(u&&u.concurrentRequestLimit),this.Da=new ic,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=ac.prototype,t.la=8,t.G=1,t.connect=function(u,v,k,O){Kr(0),this.W=u,this.H=v||{},k&&O!==void 0&&(this.H.OSID=k,this.H.OAID=O),this.F=this.X,this.I=Mu(this,null,this.W),ya(this)};function Pu(u){if(jn(u),u.G==3){var v=u.U++,k=ar(u.I);if(Qt(k,"SID",u.K),Qt(k,"RID",v),Qt(k,"TYPE","terminate"),sl(u,k),v=new fe(u,u.j,v),v.L=2,v.v=Ja(ar(k)),k=!1,o.navigator&&o.navigator.sendBeacon)try{k=o.navigator.sendBeacon(v.v.toString(),"")}catch{}!k&&o.Image&&(new Image().src=v.v,k=!0),k||(v.g=Zd(v.j,null),v.g.ea(v.v)),v.F=Date.now(),ze(v)}Jd(u)}function Ht(u){u.g&&(al(u),u.g.cancel(),u.g=null)}function jn(u){Ht(u),u.u&&(o.clearTimeout(u.u),u.u=null),lc(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&o.clearTimeout(u.s),u.s=null)}function ya(u){if(!Yr(u.h)&&!u.s){u.s=!0;var v=u.Ga;Ae||Ce(),_e||(Ae(),_e=!0),Z.add(v,u),u.B=0}}function As(u,v){return ps(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=v.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Ln(p(u.Ga,u,v),Qd(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const ie=new fe(this,this.j,u);let de=this.o;if(this.S&&(de?(de=F(de),b(de,this.S)):de=this.S),this.m!==null||this.O||(ie.H=de,de=null),this.P)e:{for(var v=0,k=0;k<this.i.length;k++){t:{var O=this.i[k];if("__data__"in O.map&&(O=O.map.__data__,typeof O=="string")){O=O.length;break t}O=void 0}if(O===void 0)break;if(v+=O,4096<v){v=k;break e}if(v===4096||k===this.i.length-1){v=k+1;break e}}v=1e3}else v=1e3;v=Yd(this,ie,v),k=ar(this.I),Qt(k,"RID",u),Qt(k,"CVER",22),this.D&&Qt(k,"X-HTTP-Session-Id",this.D),sl(this,k),de&&(this.O?v="headers="+encodeURIComponent(String(nl(de)))+"&"+v:this.m&&Es(k,this.m,de)),Vs(this.h,ie),this.Ua&&Qt(k,"TYPE","init"),this.P?(Qt(k,"$req",v),Qt(k,"SID","null"),ie.T=!0,pe(ie,k,null)):pe(ie,k,v),this.G=2}}else this.G==3&&(u?oc(this,u):this.i.length==0||Yr(this.h)||oc(this))};function oc(u,v){var k;v?k=v.l:k=u.U++;const O=ar(u.I);Qt(O,"SID",u.K),Qt(O,"RID",k),Qt(O,"AID",u.T),sl(u,O),u.m&&u.o&&Es(O,u.m,u.o),k=new fe(u,u.j,k,u.B+1),u.m===null&&(k.H=u.o),v&&(u.i=v.D.concat(u.i)),v=Yd(u,k,1e3),k.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Vs(u.h,k),pe(k,O,v)}function sl(u,v){u.H&&j(u.H,function(k,O){Qt(v,O,k)}),u.l&&ai({},function(k,O){Qt(v,O,k)})}function Yd(u,v,k){k=Math.min(u.i.length,k);var O=u.l?p(u.l.Na,u.l,u):null;e:{var ie=u.i;let de=-1;for(;;){const We=["count="+k];de==-1?0<k?(de=ie[0].g,We.push("ofs="+de)):de=0:We.push("ofs="+de);let Wt=!0;for(let Jr=0;Jr<k;Jr++){let It=ie[Jr].g;const pn=ie[Jr].map;if(It-=de,0>It)de=Math.max(0,ie[Jr].g-100),Wt=!1;else try{Qr(pn,We,"req"+It+"_")}catch{O&&O(pn)}}if(Wt){O=We.join("&");break e}}}return u=u.i.splice(0,k),v.D=u,O}function zs(u){if(!u.g&&!u.u){u.Y=1;var v=u.Fa;Ae||Ce(),_e||(Ae(),_e=!0),Z.add(v,u),u.v=0}}function Ou(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Ln(p(u.Fa,u),Qd(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,no(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Ln(p(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Kr(10),Ht(this),no(this))};function al(u){u.A!=null&&(o.clearTimeout(u.A),u.A=null)}function no(u){u.g=new fe(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var v=ar(u.qa);Qt(v,"RID","rpc"),Qt(v,"SID",u.K),Qt(v,"AID",u.T),Qt(v,"CI",u.F?"0":"1"),!u.F&&u.ja&&Qt(v,"TO",u.ja),Qt(v,"TYPE","xmlhttp"),sl(u,v),u.m&&u.o&&Es(v,u.m,u.o),u.L&&(u.g.I=u.L);var k=u.g;u=u.ia,k.L=1,k.v=Ja(ar(v)),k.m=null,k.P=!0,Oe(k,u)}t.Za=function(){this.C!=null&&(this.C=null,Ht(this),Ou(this),Kr(19))};function lc(u){u.C!=null&&(o.clearTimeout(u.C),u.C=null)}function qd(u,v){var k=null;if(u.g==v){lc(u),al(u),u.g=null;var O=2}else if(qr(u.h,v))k=v.D,Zl(u.h,v),O=1;else return;if(u.G!=0){if(v.o)if(O==1){k=v.m?v.m.length:0,v=Date.now()-v.F;var ie=u.B;O=da(),wr(O,new rr(O,k)),ya(u)}else zs(u);else if(ie=v.s,ie==3||ie==0&&0<v.X||!(O==1&&As(u,v)||O==2&&Ou(u)))switch(k&&0<k.length&&(v=u.h,v.i=v.i.concat(k)),ie){case 1:_a(u,5);break;case 4:_a(u,10);break;case 3:_a(u,6);break;default:_a(u,2)}}}function Qd(u,v){let k=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(k*=2),k*v}function _a(u,v){if(u.j.info("Error code "+v),v==2){var k=p(u.fb,u),O=u.Xa;const ie=!O;O=new ms(O||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ma(O,"https"),Ja(O),ie?rc(O.toString(),k):nc(O.toString(),k)}else Kr(2);u.G=0,u.l&&u.l.sa(v),Jd(u),jn(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),Kr(2)):(this.j.info("Failed to ping google.com"),Kr(1))};function Jd(u){if(u.G=0,u.ka=[],u.l){const v=el(u.h);(v.length!=0||u.i.length!=0)&&(E(u.ka,v),E(u.ka,u.i),u.h.i.length=0,x(u.i),u.i.length=0),u.l.ra()}}function Mu(u,v,k){var O=k instanceof ms?ar(k):new ms(k);if(O.g!="")v&&(O.g=v+"."+O.g),tc(O,O.s);else{var ie=o.location;O=ie.protocol,v=v?v+"."+ie.hostname:ie.hostname,ie=+ie.port;var de=new ms(null);O&&ma(de,O),v&&(de.g=v),ie&&tc(de,ie),k&&(de.l=k),O=de}return k=u.D,v=u.ya,k&&v&&Qt(O,k,v),Qt(O,"VER",u.la),sl(u,O),O}function Zd(u,v,k){if(v&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=u.Ca&&!u.pa?new or(new ys({eb:k})):new or(u.pa),v.Ha(u.J),v}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Lu(){}t=Lu.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function cc(){}cc.prototype.g=function(u,v){return new oi(u,v)};function oi(u,v){zt.call(this),this.g=new ac(v),this.l=u,this.h=v&&v.messageUrlParams||null,u=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(u?u["X-WebChannel-Content-Type"]=v.messageContentType:u={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(u?u["X-WebChannel-Client-Profile"]=v.va:u={"X-WebChannel-Client-Profile":v.va}),this.g.S=u,(u=v&&v.Sb)&&!A(u)&&(this.g.m=u),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!A(v)&&(this.g.D=v,u=this.h,u!==null&&v in u&&(u=this.h,v in u&&delete u[v])),this.j=new io(this)}y(oi,zt),oi.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},oi.prototype.close=function(){Pu(this.g)},oi.prototype.o=function(u){var v=this.g;if(typeof u=="string"){var k={};k.__data__=u,u=k}else this.u&&(k={},k.__data__=qa(u),u=k);v.i.push(new Xr(v.Ya++,u)),v.G==3&&ya(v)},oi.prototype.N=function(){this.g.l=null,delete this.j,Pu(this.g),delete this.g,oi.aa.N.call(this)};function uc(u){fa.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var v=u.__sm__;if(v){e:{for(const k in v){u=k;break e}u=void 0}(this.i=u)&&(u=this.i,v=v!==null&&u in v?v[u]:void 0),this.data=v}else this.data=u}y(uc,fa);function e0(){Ei.call(this),this.status=1}y(e0,Ei);function io(u){this.g=u}y(io,Lu),io.prototype.ua=function(){wr(this.g,"a")},io.prototype.ta=function(u){wr(this.g,new uc(u))},io.prototype.sa=function(u){wr(this.g,new e0)},io.prototype.ra=function(){wr(this.g,"b")},cc.prototype.createWebChannel=cc.prototype.g,oi.prototype.send=oi.prototype.o,oi.prototype.open=oi.prototype.m,oi.prototype.close=oi.prototype.close,jk=function(){return new cc},Bk=function(){return da()},Lk=On,hx={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},L.NO_ERROR=0,L.TIMEOUT=8,L.HTTP_ERROR=6,nh=L,z.COMPLETE="complete",Mk=z,Qa.EventType=Xi,Xi.OPEN="a",Xi.CLOSE="b",Xi.ERROR="c",Xi.MESSAGE="d",zt.prototype.listen=zt.prototype.K,of=Qa,or.prototype.listenOnce=or.prototype.L,or.prototype.getLastError=or.prototype.Ka,or.prototype.getLastErrorCode=or.prototype.Ba,or.prototype.getStatus=or.prototype.Z,or.prototype.getResponseJson=or.prototype.Oa,or.prototype.getResponseText=or.prototype.oa,or.prototype.send=or.prototype.ea,or.prototype.setWithCredentials=or.prototype.Ha,Ok=or}).apply(typeof B0<"u"?B0:typeof self<"u"?self:typeof window<"u"?window:{});const tE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Gn.UNAUTHENTICATED=new Gn(null),Gn.GOOGLE_CREDENTIALS=new Gn("google-credentials-uid"),Gn.FIRST_PARTY=new Gn("first-party-uid"),Gn.MOCK_USER=new Gn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Su="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jl=new dv("@firebase/firestore");function Ju(){return jl.logLevel}function Je(t,...e){if(jl.logLevel<=kt.DEBUG){const r=e.map(mv);jl.debug(`Firestore (${Su}): ${t}`,...r)}}function Ua(t,...e){if(jl.logLevel<=kt.ERROR){const r=e.map(mv);jl.error(`Firestore (${Su}): ${t}`,...r)}}function lu(t,...e){if(jl.logLevel<=kt.WARN){const r=e.map(mv);jl.warn(`Firestore (${Su}): ${t}`,...r)}}function mv(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ht(t="Unexpected state"){const e=`FIRESTORE (${Su}) INTERNAL ASSERTION FAILED: `+t;throw Ua(e),new Error(e)}function Yt(t,e){t||ht()}function gt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const De={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class rt extends Ya{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vk{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Rj{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Gn.UNAUTHENTICATED))}shutdown(){}}class Nj{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class Dj{constructor(e){this.t=e,this.currentUser=Gn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Yt(this.o===void 0);let n=this.i;const i=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let s=new Lo;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Lo,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{Je("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Je("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Lo)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Je("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Yt(typeof n.accessToken=="string"),new Vk(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Yt(e===null||typeof e=="string"),new Gn(e)}}class Pj{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Gn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Oj{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new Pj(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Gn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Mj{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Lj{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){Yt(this.o===void 0);const n=s=>{s.error!=null&&Je("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,Je("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{Je("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Je("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Yt(typeof r.token=="string"),this.R=r.token,new Mj(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bj(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=Bj(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=e.charAt(i[s]%e.length))}return n}}function Bt(t,e){return t<e?-1:t>e?1:0}function cu(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new rt(De.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new rt(De.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new rt(De.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new rt(De.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return fn.fromMillis(Date.now())}static fromDate(e){return fn.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new fn(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Bt(this.nanoseconds,e.nanoseconds):Bt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new mt(e)}static min(){return new mt(new fn(0,0))}static max(){return new mt(new fn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(e,r,n){r===void 0?r=0:r>e.length&&ht(),n===void 0?n=e.length-r:n>e.length-r&&ht(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return fd.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof fd?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const s=e.get(i),a=r.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class jr extends fd{construct(e,r,n){return new jr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new rt(De.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new jr(r)}static emptyPath(){return new jr([])}}const jj=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class bn extends fd{construct(e,r,n){return new bn(e,r,n)}static isValidIdentifier(e){return jj.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),bn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new bn(["__name__"])}static fromServerFormat(e){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new rt(De.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new rt(De.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new rt(De.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new rt(De.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new bn(r)}static emptyPath(){return new bn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it{constructor(e){this.path=e}static fromPath(e){return new it(jr.fromString(e))}static fromName(e){return new it(jr.fromString(e).popFirst(5))}static empty(){return new it(jr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&jr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return jr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new it(new jr(e.slice()))}}function Vj(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=mt.fromTimestamp(n===1e9?new fn(r+1,0):new fn(r,n));return new $o(i,it.empty(),e)}function Uj(t){return new $o(t.readTime,t.key,-1)}class $o{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new $o(mt.min(),it.empty(),-1)}static max(){return new $o(mt.max(),it.empty(),-1)}}function zj(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=it.comparator(t.documentKey,e.documentKey),r!==0?r:Bt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wj="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Hj{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Od(t){if(t.code!==De.FAILED_PRECONDITION||t.message!==Wj)throw t;Je("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&ht(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Fe((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Fe?r:Fe.resolve(r)}catch(r){return Fe.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Fe.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Fe.reject(r)}static resolve(e){return new Fe((r,n)=>{r(e)})}static reject(e){return new Fe((r,n)=>{n(e)})}static waitFor(e){return new Fe((r,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},l=>n(l))}),a=!0,s===i&&r()})}static or(e){let r=Fe.resolve(!1);for(const n of e)r=r.next(i=>i?Fe.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(e,r){return new Fe((n,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const c=l;r(e[c]).next(d=>{a[c]=d,++o,o===s&&n(a)},d=>i(d))}})}static doWhile(e,r){return new Fe((n,i)=>{const s=()=>{e()===!0?r().next(()=>{s()},i):n()};s()})}}function $j(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Md(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gv{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}gv.oe=-1;function Bp(t){return t==null}function Jh(t){return t===0&&1/t==-1/0}function Gj(t){return typeof t=="number"&&Number.isInteger(t)&&!Jh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rE(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Au(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function zk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(e,r){this.comparator=e,this.root=r||Cn.EMPTY}insert(e,r){return new Rr(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Cn.BLACK,null,null))}remove(e){return new Rr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Cn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new j0(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new j0(this.root,e,this.comparator,!1)}getReverseIterator(){return new j0(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new j0(this.root,e,this.comparator,!0)}}class j0{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Cn{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n??Cn.RED,this.left=i??Cn.EMPTY,this.right=s??Cn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,s){return new Cn(e??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Cn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return Cn.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Cn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Cn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ht();const e=this.left.check();if(e!==this.right.check())throw ht();return e+(this.isRed()?0:1)}}Cn.EMPTY=null,Cn.RED=!0,Cn.BLACK=!1;Cn.EMPTY=new class{constructor(){this.size=0}get key(){throw ht()}get value(){throw ht()}get color(){throw ht()}get left(){throw ht()}get right(){throw ht()}copy(e,r,n,i,s){return this}insert(e,r,n){return new Cn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e){this.comparator=e,this.data=new Rr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new nE(this.data.getIterator())}getIteratorFrom(e){return new nE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Nn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Nn(this.comparator);return r.data=e,r}}class nE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(e){this.fields=e,e.sort(bn.comparator)}static empty(){return new Ds([])}unionWith(e){let r=new Nn(bn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Ds(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return cu(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wk extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Wk("Invalid base64 string: "+s):s}}(e);return new Pn(r)}static fromUint8Array(e){const r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new Pn(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Bt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Pn.EMPTY_BYTE_STRING=new Pn("");const Kj=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Go(t){if(Yt(!!t),typeof t=="string"){let e=0;const r=Kj.exec(t);if(Yt(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Wr(t.seconds),nanos:Wr(t.nanos)}}function Wr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Vl(t){return typeof t=="string"?Pn.fromBase64String(t):Pn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xv(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function vv(t){const e=t.mapValue.fields.__previous_value__;return xv(e)?vv(e):e}function dd(t){const e=Go(t.mapValue.fields.__local_write_time__.timestampValue);return new fn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xj{constructor(e,r,n,i,s,a,o,l,c){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class hd{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new hd("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof hd&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V0={mapValue:{}};function Ul(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?xv(t)?4:qj(t)?9007199254740991:Yj(t)?10:11:ht()}function aa(t,e){if(t===e)return!0;const r=Ul(t);if(r!==Ul(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return dd(t).isEqual(dd(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=Go(i.timestampValue),o=Go(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Vl(i.bytesValue).isEqual(Vl(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Wr(i.geoPointValue.latitude)===Wr(s.geoPointValue.latitude)&&Wr(i.geoPointValue.longitude)===Wr(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Wr(i.integerValue)===Wr(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=Wr(i.doubleValue),o=Wr(s.doubleValue);return a===o?Jh(a)===Jh(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return cu(t.arrayValue.values||[],e.arrayValue.values||[],aa);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(rE(a)!==rE(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!aa(a[l],o[l])))return!1;return!0}(t,e);default:return ht()}}function pd(t,e){return(t.values||[]).find(r=>aa(r,e))!==void 0}function uu(t,e){if(t===e)return 0;const r=Ul(t),n=Ul(e);if(r!==n)return Bt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Bt(t.booleanValue,e.booleanValue);case 2:return function(s,a){const o=Wr(s.integerValue||s.doubleValue),l=Wr(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return iE(t.timestampValue,e.timestampValue);case 4:return iE(dd(t),dd(e));case 5:return Bt(t.stringValue,e.stringValue);case 6:return function(s,a){const o=Vl(s),l=Vl(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const d=Bt(o[c],l[c]);if(d!==0)return d}return Bt(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const o=Bt(Wr(s.latitude),Wr(a.latitude));return o!==0?o:Bt(Wr(s.longitude),Wr(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return sE(t.arrayValue,e.arrayValue);case 10:return function(s,a){var o,l,c,d;const h=s.fields||{},p=a.fields||{},g=(o=h.value)===null||o===void 0?void 0:o.arrayValue,y=(l=p.value)===null||l===void 0?void 0:l.arrayValue,x=Bt(((c=g==null?void 0:g.values)===null||c===void 0?void 0:c.length)||0,((d=y==null?void 0:y.values)===null||d===void 0?void 0:d.length)||0);return x!==0?x:sE(g,y)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===V0.mapValue&&a===V0.mapValue)return 0;if(s===V0.mapValue)return 1;if(a===V0.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),c=a.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let h=0;h<l.length&&h<d.length;++h){const p=Bt(l[h],d[h]);if(p!==0)return p;const g=uu(o[l[h]],c[d[h]]);if(g!==0)return g}return Bt(l.length,d.length)}(t.mapValue,e.mapValue);default:throw ht()}}function iE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Bt(t,e);const r=Go(t),n=Go(e),i=Bt(r.seconds,n.seconds);return i!==0?i:Bt(r.nanos,n.nanos)}function sE(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const s=uu(r[i],n[i]);if(s)return s}return Bt(r.length,n.length)}function fu(t){return px(t)}function px(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Go(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Vl(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return it.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=px(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${px(r.fields[a])}`;return i+"}"}(t.mapValue):ht()}function mx(t){return!!t&&"integerValue"in t}function yv(t){return!!t&&"arrayValue"in t}function aE(t){return!!t&&"nullValue"in t}function oE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ih(t){return!!t&&"mapValue"in t}function Yj(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function Ff(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Au(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Ff(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Ff(t.arrayValue.values[r]);return e}return Object.assign({},t)}function qj(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(e){this.value=e}static empty(){return new is({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!ih(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ff(r)}setAll(e){let r=bn.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=Ff(a):i.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(e){const r=this.field(e.popLast());ih(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return aa(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];ih(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Au(r,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new is(Ff(this.value))}}function Hk(t){const e=[];return Au(t.fields,(r,n)=>{const i=new bn([r]);if(ih(n)){const s=Hk(n.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new Ds(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e,r,n,i,s,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new qn(e,0,mt.min(),mt.min(),mt.min(),is.empty(),0)}static newFoundDocument(e,r,n,i){return new qn(e,1,r,mt.min(),n,i,0)}static newNoDocument(e,r){return new qn(e,2,r,mt.min(),mt.min(),is.empty(),0)}static newUnknownDocument(e,r){return new qn(e,3,r,mt.min(),mt.min(),is.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(mt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=is.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=is.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=mt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof qn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new qn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zh{constructor(e,r){this.position=e,this.inclusive=r}}function lE(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?n=it.comparator(it.fromName(a.referenceValue),r.key):n=uu(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function cE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!aa(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ep{constructor(e,r="asc"){this.field=e,this.dir=r}}function Qj(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $k{}class cn extends $k{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new Zj(e,r,n):r==="array-contains"?new r7(e,n):r==="in"?new n7(e,n):r==="not-in"?new i7(e,n):r==="array-contains-any"?new s7(e,n):new cn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new e7(e,n):new t7(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(uu(r,this.value)):r!==null&&Ul(this.value)===Ul(r)&&this.matchesComparison(uu(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ht()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class oa extends $k{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new oa(e,r)}matches(e){return Gk(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Gk(t){return t.op==="and"}function Kk(t){return Jj(t)&&Gk(t)}function Jj(t){for(const e of t.filters)if(e instanceof oa)return!1;return!0}function gx(t){if(t instanceof cn)return t.field.canonicalString()+t.op.toString()+fu(t.value);if(Kk(t))return t.filters.map(e=>gx(e)).join(",");{const e=t.filters.map(r=>gx(r)).join(",");return`${t.op}(${e})`}}function Xk(t,e){return t instanceof cn?function(n,i){return i instanceof cn&&n.op===i.op&&n.field.isEqual(i.field)&&aa(n.value,i.value)}(t,e):t instanceof oa?function(n,i){return i instanceof oa&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&Xk(a,i.filters[o]),!0):!1}(t,e):void ht()}function Yk(t){return t instanceof cn?function(r){return`${r.field.canonicalString()} ${r.op} ${fu(r.value)}`}(t):t instanceof oa?function(r){return r.op.toString()+" {"+r.getFilters().map(Yk).join(" ,")+"}"}(t):"Filter"}class Zj extends cn{constructor(e,r,n){super(e,r,n),this.key=it.fromName(n.referenceValue)}matches(e){const r=it.comparator(e.key,this.key);return this.matchesComparison(r)}}class e7 extends cn{constructor(e,r){super(e,"in",r),this.keys=qk("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class t7 extends cn{constructor(e,r){super(e,"not-in",r),this.keys=qk("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function qk(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>it.fromName(n.referenceValue))}class r7 extends cn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return yv(r)&&pd(r.arrayValue,this.value)}}class n7 extends cn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&pd(this.value.arrayValue,r)}}class i7 extends cn{constructor(e,r){super(e,"not-in",r)}matches(e){if(pd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!pd(this.value.arrayValue,r)}}class s7 extends cn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!yv(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>pd(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a7{constructor(e,r=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ue=null}}function uE(t,e=null,r=[],n=[],i=null,s=null,a=null){return new a7(t,e,r,n,i,s,a)}function _v(t){const e=gt(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>gx(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),Bp(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>fu(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>fu(n)).join(",")),e.ue=r}return e.ue}function Ev(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!Qj(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!Xk(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!cE(t.startAt,e.startAt)&&cE(t.endAt,e.endAt)}function xx(t){return it.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jp{constructor(e,r=null,n=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function o7(t,e,r,n,i,s,a,o){return new jp(t,e,r,n,i,s,a,o)}function Vp(t){return new jp(t)}function fE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function l7(t){return t.collectionGroup!==null}function If(t){const e=gt(t);if(e.ce===null){e.ce=[];const r=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Nn(bn.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new ep(s,n))}),r.has(bn.keyField().canonicalString())||e.ce.push(new ep(bn.keyField(),n))}return e.ce}function ra(t){const e=gt(t);return e.le||(e.le=c7(e,If(t))),e.le}function c7(t,e){if(t.limitType==="F")return uE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new ep(i.field,s)});const r=t.endAt?new Zh(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Zh(t.startAt.position,t.startAt.inclusive):null;return uE(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function vx(t,e,r){return new jp(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Up(t,e){return Ev(ra(t),ra(e))&&t.limitType===e.limitType}function Qk(t){return`${_v(ra(t))}|lt:${t.limitType}`}function yc(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>Yk(i)).join(", ")}]`),Bp(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>fu(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>fu(i)).join(",")),`Target(${n})`}(ra(t))}; limitType=${t.limitType})`}function zp(t,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):it.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,i){for(const s of If(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,o,l){const c=lE(a,o,l);return a.inclusive?c<=0:c<0}(n.startAt,If(n),i)||n.endAt&&!function(a,o,l){const c=lE(a,o,l);return a.inclusive?c>=0:c>0}(n.endAt,If(n),i))}(t,e)}function u7(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Jk(t){return(e,r)=>{let n=!1;for(const i of If(t)){const s=f7(i,e,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function f7(t,e,r){const n=t.field.isKeyField()?it.comparator(e.key,r.key):function(s,a,o){const l=a.data.field(s),c=o.data.field(s);return l!==null&&c!==null?uu(l,c):ht()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return ht()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Au(this.inner,(r,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return zk(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d7=new Rr(it.comparator);function za(){return d7}const Zk=new Rr(it.comparator);function lf(...t){let e=Zk;for(const r of t)e=e.insert(r.key,r);return e}function eC(t){let e=Zk;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function vl(){return bf()}function tC(){return bf()}function bf(){return new ku(t=>t.toString(),(t,e)=>t.isEqual(e))}const h7=new Rr(it.comparator),p7=new Nn(it.comparator);function At(...t){let e=p7;for(const r of t)e=e.add(r);return e}const m7=new Nn(Bt);function g7(){return m7}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Jh(e)?"-0":e}}function rC(t){return{integerValue:""+t}}function x7(t,e){return Gj(e)?rC(e):wv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wp{constructor(){this._=void 0}}function v7(t,e,r){return t instanceof tp?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&xv(s)&&(s=vv(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(r,e):t instanceof md?iC(t,e):t instanceof gd?sC(t,e):function(i,s){const a=nC(i,s),o=dE(a)+dE(i.Pe);return mx(a)&&mx(i.Pe)?rC(o):wv(i.serializer,o)}(t,e)}function y7(t,e,r){return t instanceof md?iC(t,e):t instanceof gd?sC(t,e):r}function nC(t,e){return t instanceof rp?function(n){return mx(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class tp extends Wp{}class md extends Wp{constructor(e){super(),this.elements=e}}function iC(t,e){const r=aC(e);for(const n of t.elements)r.some(i=>aa(i,n))||r.push(n);return{arrayValue:{values:r}}}class gd extends Wp{constructor(e){super(),this.elements=e}}function sC(t,e){let r=aC(e);for(const n of t.elements)r=r.filter(i=>!aa(i,n));return{arrayValue:{values:r}}}class rp extends Wp{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function dE(t){return Wr(t.integerValue||t.doubleValue)}function aC(t){return yv(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function _7(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof md&&i instanceof md||n instanceof gd&&i instanceof gd?cu(n.elements,i.elements,aa):n instanceof rp&&i instanceof rp?aa(n.Pe,i.Pe):n instanceof tp&&i instanceof tp}(t.transform,e.transform)}class E7{constructor(e,r){this.version=e,this.transformResults=r}}class Pa{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Pa}static exists(e){return new Pa(void 0,e)}static updateTime(e){return new Pa(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function sh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Hp{}function oC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new cC(t.key,Pa.none()):new Ld(t.key,t.data,Pa.none());{const r=t.data,n=is.empty();let i=new Nn(bn.comparator);for(let s of e.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new Ql(t.key,n,new Ds(i.toArray()),Pa.none())}}function w7(t,e,r){t instanceof Ld?function(i,s,a){const o=i.value.clone(),l=pE(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof Ql?function(i,s,a){if(!sh(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=pE(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(lC(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function Rf(t,e,r,n){return t instanceof Ld?function(s,a,o,l){if(!sh(s.precondition,a))return o;const c=s.value.clone(),d=mE(s.fieldTransforms,l,a);return c.setAll(d),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof Ql?function(s,a,o,l){if(!sh(s.precondition,a))return o;const c=mE(s.fieldTransforms,l,a),d=a.data;return d.setAll(lC(s)),d.setAll(c),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(s,a,o){return sh(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function T7(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),s=nC(n.transform,i||null);s!=null&&(r===null&&(r=is.empty()),r.set(n.field,s))}return r||null}function hE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&cu(n,i,(s,a)=>_7(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ld extends Hp{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ql extends Hp{constructor(e,r,n,i,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function lC(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function pE(t,e,r){const n=new Map;Yt(t.length===r.length);for(let i=0;i<r.length;i++){const s=t[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,y7(a,o,r[i]))}return n}function mE(t,e,r){const n=new Map;for(const i of t){const s=i.transform,a=r.data.field(i.field);n.set(i.field,v7(s,a,e))}return n}class cC extends Hp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class S7 extends Hp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A7{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&w7(s,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Rf(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Rf(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=tC();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;const l=oC(a,o);l!==null&&n.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(mt.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),At())}isEqual(e){return this.batchId===e.batchId&&cu(this.mutations,e.mutations,(r,n)=>hE(r,n))&&cu(this.baseMutations,e.baseMutations,(r,n)=>hE(r,n))}}class Tv{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){Yt(e.mutations.length===n.length);let i=function(){return h7}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new Tv(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k7{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C7{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var en,bt;function F7(t){switch(t){default:return ht();case De.CANCELLED:case De.UNKNOWN:case De.DEADLINE_EXCEEDED:case De.RESOURCE_EXHAUSTED:case De.INTERNAL:case De.UNAVAILABLE:case De.UNAUTHENTICATED:return!1;case De.INVALID_ARGUMENT:case De.NOT_FOUND:case De.ALREADY_EXISTS:case De.PERMISSION_DENIED:case De.FAILED_PRECONDITION:case De.ABORTED:case De.OUT_OF_RANGE:case De.UNIMPLEMENTED:case De.DATA_LOSS:return!0}}function uC(t){if(t===void 0)return Ua("GRPC error has no .code"),De.UNKNOWN;switch(t){case en.OK:return De.OK;case en.CANCELLED:return De.CANCELLED;case en.UNKNOWN:return De.UNKNOWN;case en.DEADLINE_EXCEEDED:return De.DEADLINE_EXCEEDED;case en.RESOURCE_EXHAUSTED:return De.RESOURCE_EXHAUSTED;case en.INTERNAL:return De.INTERNAL;case en.UNAVAILABLE:return De.UNAVAILABLE;case en.UNAUTHENTICATED:return De.UNAUTHENTICATED;case en.INVALID_ARGUMENT:return De.INVALID_ARGUMENT;case en.NOT_FOUND:return De.NOT_FOUND;case en.ALREADY_EXISTS:return De.ALREADY_EXISTS;case en.PERMISSION_DENIED:return De.PERMISSION_DENIED;case en.FAILED_PRECONDITION:return De.FAILED_PRECONDITION;case en.ABORTED:return De.ABORTED;case en.OUT_OF_RANGE:return De.OUT_OF_RANGE;case en.UNIMPLEMENTED:return De.UNIMPLEMENTED;case en.DATA_LOSS:return De.DATA_LOSS;default:return ht()}}(bt=en||(en={}))[bt.OK=0]="OK",bt[bt.CANCELLED=1]="CANCELLED",bt[bt.UNKNOWN=2]="UNKNOWN",bt[bt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",bt[bt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",bt[bt.NOT_FOUND=5]="NOT_FOUND",bt[bt.ALREADY_EXISTS=6]="ALREADY_EXISTS",bt[bt.PERMISSION_DENIED=7]="PERMISSION_DENIED",bt[bt.UNAUTHENTICATED=16]="UNAUTHENTICATED",bt[bt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",bt[bt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",bt[bt.ABORTED=10]="ABORTED",bt[bt.OUT_OF_RANGE=11]="OUT_OF_RANGE",bt[bt.UNIMPLEMENTED=12]="UNIMPLEMENTED",bt[bt.INTERNAL=13]="INTERNAL",bt[bt.UNAVAILABLE=14]="UNAVAILABLE",bt[bt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I7(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b7=new Al([4294967295,4294967295],0);function gE(t){const e=I7().encode(t),r=new Pk;return r.update(e),new Uint8Array(r.digest())}function xE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Al([r,n],0),new Al([i,s],0)]}class Sv{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new cf(`Invalid padding: ${r}`);if(n<0)throw new cf(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new cf(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new cf(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=Al.fromNumber(this.Ie)}Ee(e,r,n){let i=e.add(r.multiply(Al.fromNumber(n)));return i.compare(b7)===1&&(i=new Al([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=gE(e),[n,i]=xE(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);if(!this.de(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new Sv(s,i,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const r=gE(e),[n,i]=xE(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);this.Ae(a)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class cf extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $p{constructor(e,r,n,i,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,Bd.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new $p(mt.min(),i,new Rr(Bt),za(),At())}}class Bd{constructor(e,r,n,i,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Bd(n,r,At(),At(),At())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ah{constructor(e,r,n,i){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=i}}class fC{constructor(e,r){this.targetId=e,this.me=r}}class dC{constructor(e,r,n=Pn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class vE{constructor(){this.fe=0,this.ge=_E(),this.pe=Pn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=At(),r=At(),n=At();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:ht()}}),new Bd(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=_E()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Yt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class R7{constructor(e){this.Le=e,this.Be=new Map,this.ke=za(),this.qe=yE(),this.Qe=new Rr(Bt)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:ht()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,i)=>{this.ze(i)&&r(i)})}He(e){const r=e.targetId,n=e.me.count,i=this.Je(r);if(i){const s=i.target;if(xx(s))if(n===0){const a=new it(s.path);this.Ue(r,a,qn.newNoDocument(a,mt.min()))}else Yt(n===1);else{const a=this.Ye(r);if(a!==n){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,c)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let a,o;try{a=Vl(n).toUint8Array()}catch(l){if(l instanceof Wk)return lu("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new Sv(a,i,s)}catch(l){return lu(l instanceof cf?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,s,null),i++)}),i}rt(e){const r=new Map;this.Be.forEach((s,a)=>{const o=this.Je(a);if(o){if(s.current&&xx(o.target)){const l=new it(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,qn.newNoDocument(l,e))}s.be&&(r.set(a,s.ve()),s.Ce())}});let n=At();this.qe.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));const i=new $p(e,r,this.Qe,this.ke,n);return this.ke=za(),this.qe=yE(),this.Qe=new Rr(Bt),i}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,r)?i.Fe(r,1):i.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new vE,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new Nn(Bt),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||Je("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new vE),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function yE(){return new Rr(it.comparator)}function _E(){return new Rr(it.comparator)}const N7={asc:"ASCENDING",desc:"DESCENDING"},D7={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},P7={and:"AND",or:"OR"};class O7{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function yx(t,e){return t.useProto3Json||Bp(e)?e:{value:e}}function np(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function hC(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function M7(t,e){return np(t,e.toTimestamp())}function na(t){return Yt(!!t),mt.fromTimestamp(function(r){const n=Go(r);return new fn(n.seconds,n.nanos)}(t))}function Av(t,e){return _x(t,e).canonicalString()}function _x(t,e){const r=function(i){return new jr(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function pC(t){const e=jr.fromString(t);return Yt(yC(e)),e}function Ex(t,e){return Av(t.databaseId,e.path)}function qm(t,e){const r=pC(e);if(r.get(1)!==t.databaseId.projectId)throw new rt(De.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new rt(De.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new it(gC(r))}function mC(t,e){return Av(t.databaseId,e)}function L7(t){const e=pC(t);return e.length===4?jr.emptyPath():gC(e)}function wx(t){return new jr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function gC(t){return Yt(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function EE(t,e,r){return{name:Ex(t,e),fields:r.value.mapValue.fields}}function B7(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:ht()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,d){return c.useProto3Json?(Yt(d===void 0||typeof d=="string"),Pn.fromBase64String(d||"")):(Yt(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Pn.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(c){const d=c.code===void 0?De.UNKNOWN:uC(c.code);return new rt(d,c.message||"")}(a);r=new dC(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=qm(t,n.document.name),s=na(n.document.updateTime),a=n.document.createTime?na(n.document.createTime):mt.min(),o=new is({mapValue:{fields:n.document.fields}}),l=qn.newFoundDocument(i,s,a,o),c=n.targetIds||[],d=n.removedTargetIds||[];r=new ah(c,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=qm(t,n.document),s=n.readTime?na(n.readTime):mt.min(),a=qn.newNoDocument(i,s),o=n.removedTargetIds||[];r=new ah([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=qm(t,n.document),s=n.removedTargetIds||[];r=new ah([],s,i,null)}else{if(!("filter"in e))return ht();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new C7(i,s),o=n.targetId;r=new fC(o,a)}}return r}function j7(t,e){let r;if(e instanceof Ld)r={update:EE(t,e.key,e.value)};else if(e instanceof cC)r={delete:Ex(t,e.key)};else if(e instanceof Ql)r={update:EE(t,e.key,e.data),updateMask:X7(e.fieldMask)};else{if(!(e instanceof S7))return ht();r={verify:Ex(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof tp)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof md)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof gd)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof rp)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw ht()}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:M7(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ht()}(t,e.precondition)),r}function V7(t,e){return t&&t.length>0?(Yt(e!==void 0),t.map(r=>function(i,s){let a=i.updateTime?na(i.updateTime):na(s);return a.isEqual(mt.min())&&(a=na(s)),new E7(a,i.transformResults||[])}(r,e))):[]}function U7(t,e){return{documents:[mC(t,e.path)]}}function z7(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=mC(t,i);const s=function(c){if(c.length!==0)return vC(oa.create(c,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const a=function(c){if(c.length!==0)return c.map(d=>function(p){return{field:_c(p.field),direction:$7(p.dir)}}(d))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=yx(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:r,parent:i}}function W7(t){let e=L7(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Yt(n===1);const d=r.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];r.where&&(s=function(h){const p=xC(h);return p instanceof oa&&Kk(p)?p.getFilters():[p]}(r.where));let a=[];r.orderBy&&(a=function(h){return h.map(p=>function(y){return new ep(Ec(y.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(p))}(r.orderBy));let o=null;r.limit&&(o=function(h){let p;return p=typeof h=="object"?h.value:h,Bp(p)?null:p}(r.limit));let l=null;r.startAt&&(l=function(h){const p=!!h.before,g=h.values||[];return new Zh(g,p)}(r.startAt));let c=null;return r.endAt&&(c=function(h){const p=!h.before,g=h.values||[];return new Zh(g,p)}(r.endAt)),o7(e,i,a,s,o,"F",l,c)}function H7(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ht()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function xC(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Ec(r.unaryFilter.field);return cn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Ec(r.unaryFilter.field);return cn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Ec(r.unaryFilter.field);return cn.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Ec(r.unaryFilter.field);return cn.create(a,"!=",{nullValue:"NULL_VALUE"});default:return ht()}}(t):t.fieldFilter!==void 0?function(r){return cn.create(Ec(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ht()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return oa.create(r.compositeFilter.filters.map(n=>xC(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ht()}}(r.compositeFilter.op))}(t):ht()}function $7(t){return N7[t]}function G7(t){return D7[t]}function K7(t){return P7[t]}function _c(t){return{fieldPath:t.canonicalString()}}function Ec(t){return bn.fromServerFormat(t.fieldPath)}function vC(t){return t instanceof cn?function(r){if(r.op==="=="){if(oE(r.value))return{unaryFilter:{field:_c(r.field),op:"IS_NAN"}};if(aE(r.value))return{unaryFilter:{field:_c(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(oE(r.value))return{unaryFilter:{field:_c(r.field),op:"IS_NOT_NAN"}};if(aE(r.value))return{unaryFilter:{field:_c(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:_c(r.field),op:G7(r.op),value:r.value}}}(t):t instanceof oa?function(r){const n=r.getFilters().map(i=>vC(i));return n.length===1?n[0]:{compositeFilter:{op:K7(r.op),filters:n}}}(t):ht()}function X7(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function yC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(e,r,n,i,s=mt.min(),a=mt.min(),o=Pn.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Ao(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Ao(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ao(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ao(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y7{constructor(e){this.ct=e}}function q7(t){const e=W7({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?vx(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q7{constructor(){this.un=new J7}addToCollectionParentIndex(e,r){return this.un.add(r),Fe.resolve()}getCollectionParents(e,r){return Fe.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return Fe.resolve()}deleteFieldIndex(e,r){return Fe.resolve()}deleteAllFieldIndexes(e){return Fe.resolve()}createTargetIndexes(e,r){return Fe.resolve()}getDocumentsMatchingTarget(e,r){return Fe.resolve(null)}getIndexType(e,r){return Fe.resolve(0)}getFieldIndexes(e,r){return Fe.resolve([])}getNextCollectionGroupToUpdate(e){return Fe.resolve(null)}getMinOffset(e,r){return Fe.resolve($o.min())}getMinOffsetFromCollectionGroup(e,r){return Fe.resolve($o.min())}updateCollectionGroup(e,r,n){return Fe.resolve()}updateIndexEntries(e,r){return Fe.resolve()}}class J7{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new Nn(jr.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Nn(jr.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new du(0)}static kn(){return new du(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z7{constructor(){this.changes=new ku(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,qn.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Fe.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eV{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tV{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Rf(n.mutation,i,Ds.empty(),fn.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,At()).next(()=>n))}getLocalViewOfDocuments(e,r,n=At()){const i=vl();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(s=>{let a=lf();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=vl();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,At()))}populateOverlays(e,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,i){let s=za();const a=bf(),o=function(){return bf()}();return r.forEach((l,c)=>{const d=n.get(c.key);i.has(c.key)&&(d===void 0||d.mutation instanceof Ql)?s=s.insert(c.key,c):d!==void 0?(a.set(c.key,d.mutation.getFieldMask()),Rf(d.mutation,c,d.mutation.getFieldMask(),fn.now())):a.set(c.key,Ds.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,d)=>a.set(c,d)),r.forEach((c,d)=>{var h;return o.set(c,new eV(d,(h=a.get(c))!==null&&h!==void 0?h:null))}),o))}recalculateAndSaveOverlays(e,r){const n=bf();let i=new Rr((a,o)=>a-o),s=At();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let d=n.get(l)||Ds.empty();d=o.applyToLocalView(c,d),n.set(l,d);const h=(i.get(o.batchId)||At()).add(l);i=i.insert(o.batchId,h)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,d=l.value,h=tC();d.forEach(p=>{if(!s.has(p)){const g=oC(r.get(p),n.get(p));g!==null&&h.set(p,g),s=s.add(p)}}),a.push(this.documentOverlayCache.saveOverlays(e,c,h))}return Fe.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return it.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):l7(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-s.size):Fe.resolve(vl());let o=-1,l=s;return a.next(c=>Fe.forEach(c,(d,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),s.get(d)?Fe.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{l=l.insert(d,p)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,At())).next(d=>({batchId:o,changes:eC(d)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new it(r)).next(n=>{let i=lf();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const s=r.collectionGroup;let a=lf();return this.indexManager.getCollectionParents(e,s).next(o=>Fe.forEach(o,l=>{const c=function(h,p){return new jp(p,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,n,i).next(d=>{d.forEach((h,p)=>{a=a.insert(h,p)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,i))).next(a=>{s.forEach((l,c)=>{const d=c.getKey();a.get(d)===null&&(a=a.insert(d,qn.newInvalidDocument(d)))});let o=lf();return a.forEach((l,c)=>{const d=s.get(l);d!==void 0&&Rf(d.mutation,c,Ds.empty(),fn.now()),zp(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rV{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return Fe.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:na(i.createTime)}}(r)),Fe.resolve()}getNamedQuery(e,r){return Fe.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(i){return{name:i.name,query:q7(i.bundledQuery),readTime:na(i.readTime)}}(r)),Fe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nV{constructor(){this.overlays=new Rr(it.comparator),this.Ir=new Map}getOverlay(e,r){return Fe.resolve(this.overlays.get(r))}getOverlays(e,r){const n=vl();return Fe.forEach(r,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,s)=>{this.ht(e,r,s)}),Fe.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.Ir.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),Fe.resolve()}getOverlaysForCollection(e,r,n){const i=vl(),s=r.length+1,a=new it(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>n&&i.set(l.getKey(),l)}return Fe.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let s=new Rr((c,d)=>c-d);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let d=s.get(c.largestBatchId);d===null&&(d=vl(),s=s.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const o=vl(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>o.set(c,d)),!(o.size()>=i)););return Fe.resolve(o)}ht(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new k7(r,n));let s=this.Ir.get(r);s===void 0&&(s=At(),this.Ir.set(r,s)),this.Ir.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iV{constructor(){this.sessionToken=Pn.EMPTY_BYTE_STRING}getSessionToken(e){return Fe.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Fe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kv{constructor(){this.Tr=new Nn(xn.Er),this.dr=new Nn(xn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new xn(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new xn(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new it(new jr([])),n=new xn(r,e),i=new xn(r,e+1),s=[];return this.dr.forEachInRange([n,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new it(new jr([])),n=new xn(r,e),i=new xn(r,e+1);let s=At();return this.dr.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const r=new xn(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class xn{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return it.comparator(e.key,r.key)||Bt(e.wr,r.wr)}static Ar(e,r){return Bt(e.wr,r.wr)||it.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sV{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new Nn(xn.Er)}checkEmpty(e){return Fe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new A7(s,r,n,i);this.mutationQueue.push(a);for(const o of i)this.br=this.br.add(new xn(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Fe.resolve(a)}lookupMutationBatch(e,r){return Fe.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.vr(n),s=i<0?0:i;return Fe.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Fe.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Fe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new xn(r,0),i=new xn(r,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,i],a=>{const o=this.Dr(a.wr);s.push(o)}),Fe.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Nn(Bt);return r.forEach(i=>{const s=new xn(i,0),a=new xn(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],o=>{n=n.add(o.wr)})}),Fe.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let s=n;it.isDocumentKey(s)||(s=s.child(""));const a=new xn(new it(s),0);let o=new Nn(Bt);return this.br.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===i&&(o=o.add(l.wr)),!0)},a),Fe.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const i=this.Dr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){Yt(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return Fe.forEach(r.mutations,i=>{const s=new xn(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new xn(r,0),i=this.br.firstAfterOrEqual(n);return Fe.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Fe.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aV{constructor(e){this.Mr=e,this.docs=function(){return new Rr(it.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Fe.resolve(n?n.document.mutableCopy():qn.newInvalidDocument(r))}getEntries(e,r){let n=za();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():qn.newInvalidDocument(i))}),Fe.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let s=za();const a=r.path,o=new it(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:d}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||zj(Uj(d),n)<=0||(i.has(d.key)||zp(r,d))&&(s=s.insert(d.key,d.mutableCopy()))}return Fe.resolve(s)}getAllFromCollectionGroup(e,r,n,i){ht()}Or(e,r){return Fe.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new oV(this)}getSize(e){return Fe.resolve(this.size)}}class oV extends Z7{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)}),Fe.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lV{constructor(e){this.persistence=e,this.Nr=new ku(r=>_v(r),Ev),this.lastRemoteSnapshotVersion=mt.min(),this.highestTargetId=0,this.Lr=0,this.Br=new kv,this.targetCount=0,this.kr=du.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,i)=>r(i)),Fe.resolve()}getLastRemoteSnapshotVersion(e){return Fe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Fe.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Fe.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),Fe.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new du(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,Fe.resolve()}updateTargetData(e,r){return this.Kn(r),Fe.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,Fe.resolve()}removeTargets(e,r,n){let i=0;const s=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),Fe.waitFor(s).next(()=>i)}getTargetCount(e){return Fe.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return Fe.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),Fe.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),Fe.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),Fe.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return Fe.resolve(n)}containsKey(e,r){return Fe.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cV{constructor(e,r){this.qr={},this.overlays={},this.Qr=new gv(0),this.Kr=!1,this.Kr=!0,this.$r=new iV,this.referenceDelegate=e(this),this.Ur=new lV(this),this.indexManager=new Q7,this.remoteDocumentCache=function(i){return new aV(i)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new Y7(r),this.Gr=new rV(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new nV,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new sV(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){Je("MemoryPersistence","Starting transaction:",e);const i=new uV(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,r){return Fe.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class uV extends Hj{constructor(e){super(),this.currentSequenceNumber=e}}class Cv{constructor(e){this.persistence=e,this.Jr=new kv,this.Yr=null}static Zr(e){return new Cv(e)}get Xr(){if(this.Yr)return this.Yr;throw ht()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),Fe.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),Fe.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),Fe.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(i=>this.Xr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Fe.forEach(this.Xr,n=>{const i=it.fromPath(n);return this.ei(e,i).next(s=>{s||r.removeEntry(i,mt.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return Fe.or([()=>Fe.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=i}static Wi(e,r){let n=At(),i=At();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Fv(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fV{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dV{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return d9()?8:$j(ti())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,i){const s={result:null};return this.Yi(e,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new fV;return this.Xi(e,r,a).next(o=>{if(s.result=o,this.zi)return this.es(e,r,a,o.size)})}).next(()=>s.result)}es(e,r,n,i){return n.documentReadCount<this.ji?(Ju()<=kt.DEBUG&&Je("QueryEngine","SDK will not create cache indexes for query:",yc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Fe.resolve()):(Ju()<=kt.DEBUG&&Je("QueryEngine","Query:",yc(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(Ju()<=kt.DEBUG&&Je("QueryEngine","The SDK decides to create cache indexes for query:",yc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ra(r))):Fe.resolve())}Yi(e,r){if(fE(r))return Fe.resolve(null);let n=ra(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=vx(r,null,"F"),n=ra(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=At(...s);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.ts(r,o);return this.ns(r,c,a,l.readTime)?this.Yi(e,vx(r,null,"F")):this.rs(e,c,r,l)}))})))}Zi(e,r,n,i){return fE(r)||i.isEqual(mt.min())?Fe.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const a=this.ts(r,s);return this.ns(r,a,n,i)?Fe.resolve(null):(Ju()<=kt.DEBUG&&Je("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),yc(r)),this.rs(e,a,r,Vj(i,-1)).next(o=>o))})}ts(e,r){let n=new Nn(Jk(e));return r.forEach((i,s)=>{zp(e,s)&&(n=n.add(s))}),n}ns(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,r,n){return Ju()<=kt.DEBUG&&Je("QueryEngine","Using full collection scan to execute query:",yc(r)),this.Ji.getDocumentsMatchingQuery(e,r,$o.min(),n)}rs(e,r,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hV{constructor(e,r,n,i){this.persistence=e,this.ss=r,this.serializer=i,this.os=new Rr(Bt),this._s=new ku(s=>_v(s),Ev),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new tV(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function pV(t,e,r,n){return new hV(t,e,r,n)}async function _C(t,e){const r=gt(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let l=At();for(const c of i){a.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}for(const c of s){o.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}return r.localDocuments.getDocuments(n,l).next(c=>({hs:c,removedBatchIds:a,addedBatchIds:o}))})})}function mV(t,e){const r=gt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,c,d){const h=c.batch,p=h.keys();let g=Fe.resolve();return p.forEach(y=>{g=g.next(()=>d.getEntry(l,y)).next(x=>{const E=c.docVersions.get(y);Yt(E!==null),x.version.compareTo(E)<0&&(h.applyToRemoteDocument(x,c),x.isValidDocument()&&(x.setReadTime(c.commitVersion),d.addEntry(x)))})}),g.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=At();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function EC(t){const e=gt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function gV(t,e){const r=gt(t),n=e.snapshotVersion;let i=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.cs.newChangeBuffer({trackRemovals:!0});i=r.os;const o=[];e.targetChanges.forEach((d,h)=>{const p=i.get(h);if(!p)return;o.push(r.Ur.removeMatchingKeys(s,d.removedDocuments,h).next(()=>r.Ur.addMatchingKeys(s,d.addedDocuments,h)));let g=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?g=g.withResumeToken(Pn.EMPTY_BYTE_STRING,mt.min()).withLastLimboFreeSnapshotVersion(mt.min()):d.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(d.resumeToken,n)),i=i.insert(h,g),function(x,E,T){return x.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(p,g,d)&&o.push(r.Ur.updateTargetData(s,g))});let l=za(),c=At();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,d))}),o.push(xV(s,a,e.documentUpdates).next(d=>{l=d.Ps,c=d.Is})),!n.isEqual(mt.min())){const d=r.Ur.getLastRemoteSnapshotVersion(s).next(h=>r.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(d)}return Fe.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(r.os=i,s))}function xV(t,e,r){let n=At(),i=At();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let a=za();return r.forEach((o,l)=>{const c=s.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(mt.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):Je("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{Ps:a,Is:i}})}function vV(t,e){const r=gt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function yV(t,e){const r=gt(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Ur.getTargetData(n,e).next(s=>s?(i=s,Fe.resolve(i)):r.Ur.allocateTargetId(n).next(a=>(i=new Ao(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.os.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function Tx(t,e,r){const n=gt(t),i=n.os.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!Md(a))throw a;Je("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(i.target)}function wE(t,e,r){const n=gt(t);let i=mt.min(),s=At();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,c,d){const h=gt(l),p=h._s.get(d);return p!==void 0?Fe.resolve(h.os.get(p)):h.Ur.getTargetData(c,d)}(n,a,ra(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,r?i:mt.min(),r?s:At())).next(o=>(_V(n,u7(e),o),{documents:o,Ts:s})))}function _V(t,e,r){let n=t.us.get(e)||mt.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.us.set(e,n)}class TE{constructor(){this.activeTargetIds=g7()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class EV{constructor(){this.so=new TE,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new TE,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wV{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SE{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Je("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Je("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let U0=null;function Qm(){return U0===null?U0=function(){return 268435456+Math.round(2147483648*Math.random())}():U0++,"0x"+U0.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TV={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SV{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hn="WebChannelConnection";class AV extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(r,n,i,s,a){const o=Qm(),l=this.xo(r,n.toUriEncodedString());Je("RestConnection",`Sending RPC '${r}' ${o}:`,l,i);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,s,a),this.No(r,l,c,i).then(d=>(Je("RestConnection",`Received RPC '${r}' ${o}: `,d),d),d=>{throw lu("RestConnection",`RPC '${r}' ${o} failed with error: `,d,"url: ",l,"request:",i),d})}Lo(r,n,i,s,a,o){return this.Mo(r,n,i,s,a)}Oo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Su}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>r[a]=s),i&&i.headers.forEach((s,a)=>r[a]=s)}xo(r,n){const i=TV[r];return`${this.Do}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,i){const s=Qm();return new Promise((a,o)=>{const l=new Ok;l.setWithCredentials(!0),l.listenOnce(Mk.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case nh.NO_ERROR:const d=l.getResponseJson();Je(Hn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),a(d);break;case nh.TIMEOUT:Je(Hn,`RPC '${e}' ${s} timed out`),o(new rt(De.DEADLINE_EXCEEDED,"Request time out"));break;case nh.HTTP_ERROR:const h=l.getStatus();if(Je(Hn,`RPC '${e}' ${s} failed with status:`,h,"response text:",l.getResponseText()),h>0){let p=l.getResponseJson();Array.isArray(p)&&(p=p[0]);const g=p==null?void 0:p.error;if(g&&g.status&&g.message){const y=function(E){const T=E.toLowerCase().replace(/_/g,"-");return Object.values(De).indexOf(T)>=0?T:De.UNKNOWN}(g.status);o(new rt(y,g.message))}else o(new rt(De.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new rt(De.UNAVAILABLE,"Connection failed."));break;default:ht()}}finally{Je(Hn,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);Je(Hn,`RPC '${e}' ${s} sending request:`,i),l.send(r,"POST",c,n,15)})}Bo(e,r,n){const i=Qm(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=jk(),o=Bk(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const d=s.join("");Je(Hn,`Creating RPC '${e}' stream ${i}: ${d}`,l);const h=a.createWebChannel(d,l);let p=!1,g=!1;const y=new SV({Io:E=>{g?Je(Hn,`Not sending because RPC '${e}' stream ${i} is closed:`,E):(p||(Je(Hn,`Opening RPC '${e}' stream ${i} transport.`),h.open(),p=!0),Je(Hn,`RPC '${e}' stream ${i} sending:`,E),h.send(E))},To:()=>h.close()}),x=(E,T,A)=>{E.listen(T,_=>{try{A(_)}catch(P){setTimeout(()=>{throw P},0)}})};return x(h,of.EventType.OPEN,()=>{g||(Je(Hn,`RPC '${e}' stream ${i} transport opened.`),y.yo())}),x(h,of.EventType.CLOSE,()=>{g||(g=!0,Je(Hn,`RPC '${e}' stream ${i} transport closed`),y.So())}),x(h,of.EventType.ERROR,E=>{g||(g=!0,lu(Hn,`RPC '${e}' stream ${i} transport errored:`,E),y.So(new rt(De.UNAVAILABLE,"The operation could not be completed")))}),x(h,of.EventType.MESSAGE,E=>{var T;if(!g){const A=E.data[0];Yt(!!A);const _=A,P=_.error||((T=_[0])===null||T===void 0?void 0:T.error);if(P){Je(Hn,`RPC '${e}' stream ${i} received error:`,P);const W=P.status;let j=function(S){const b=en[S];if(b!==void 0)return uC(b)}(W),w=P.message;j===void 0&&(j=De.INTERNAL,w="Unknown error status: "+W+" with message "+P.message),g=!0,y.So(new rt(j,w)),h.close()}else Je(Hn,`RPC '${e}' stream ${i} received:`,A),y.bo(A)}}),x(o,Lk.STAT_EVENT,E=>{E.stat===hx.PROXY?Je(Hn,`RPC '${e}' stream ${i} detected buffering proxy`):E.stat===hx.NOPROXY&&Je(Hn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{y.wo()},0),y}}function Jm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gp(t){return new O7(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{constructor(e,r,n=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,r-n);i>0&&Je("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TC{constructor(e,r,n,i,s,a,o,l){this.ui=e,this.Ho=n,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new wC(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===De.RESOURCE_EXHAUSTED?(Ua(r.toString()),Ua("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===De.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Yo===r&&this.P_(n,i)},n=>{e(()=>{const i=new rt(De.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(i)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{n(()=>this.I_(i))}),this.stream.onMessage(i=>{n(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Je("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(Je("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class kV extends TC{constructor(e,r,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=B7(this.serializer,e),n=function(s){if(!("targetChange"in s))return mt.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?mt.min():a.readTime?na(a.readTime):mt.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=wx(this.serializer),r.addTarget=function(s,a){let o;const l=a.target;if(o=xx(l)?{documents:U7(s,l)}:{query:z7(s,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=hC(s,a.resumeToken);const c=yx(s,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(mt.min())>0){o.readTime=np(s,a.snapshotVersion.toTimestamp());const c=yx(s,a.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const n=H7(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=wx(this.serializer),r.removeTarget=e,this.a_(r)}}class CV extends TC{constructor(e,r,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return Yt(!!e.streamToken),this.lastStreamToken=e.streamToken,Yt(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Yt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=V7(e.writeResults,e.commitTime),n=na(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=wx(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>j7(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FV extends class{}{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new rt(De.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,_x(r,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===De.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new rt(De.UNKNOWN,s.toString())})}Lo(e,r,n,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,_x(r,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===De.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new rt(De.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class IV{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ua(r),this.D_=!1):Je("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bV{constructor(e,r,n,i,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{n.enqueueAndForget(async()=>{Jl(this)&&(Je("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=gt(l);c.L_.add(4),await jd(c),c.q_.set("Unknown"),c.L_.delete(4),await Kp(c)}(this))})}),this.q_=new IV(n,i)}}async function Kp(t){if(Jl(t))for(const e of t.B_)await e(!0)}async function jd(t){for(const e of t.B_)await e(!1)}function SC(t,e){const r=gt(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),Nv(r)?Rv(r):Cu(r).r_()&&bv(r,e))}function Iv(t,e){const r=gt(t),n=Cu(r);r.N_.delete(e),n.r_()&&AC(r,e),r.N_.size===0&&(n.r_()?n.o_():Jl(r)&&r.q_.set("Unknown"))}function bv(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(mt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Cu(t).A_(e)}function AC(t,e){t.Q_.xe(e),Cu(t).R_(e)}function Rv(t){t.Q_=new R7({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Cu(t).start(),t.q_.v_()}function Nv(t){return Jl(t)&&!Cu(t).n_()&&t.N_.size>0}function Jl(t){return gt(t).L_.size===0}function kC(t){t.Q_=void 0}async function RV(t){t.q_.set("Online")}async function NV(t){t.N_.forEach((e,r)=>{bv(t,e)})}async function DV(t,e){kC(t),Nv(t)?(t.q_.M_(e),Rv(t)):t.q_.set("Unknown")}async function PV(t,e,r){if(t.q_.set("Online"),e instanceof dC&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.N_.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.N_.delete(o),i.Q_.removeTarget(o))}(t,e)}catch(n){Je("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await ip(t,n)}else if(e instanceof ah?t.Q_.Ke(e):e instanceof fC?t.Q_.He(e):t.Q_.We(e),!r.isEqual(mt.min()))try{const n=await EC(t.localStore);r.compareTo(n)>=0&&await function(s,a){const o=s.Q_.rt(a);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const d=s.N_.get(c);d&&s.N_.set(c,d.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,c)=>{const d=s.N_.get(l);if(!d)return;s.N_.set(l,d.withResumeToken(Pn.EMPTY_BYTE_STRING,d.snapshotVersion)),AC(s,l);const h=new Ao(d.target,l,c,d.sequenceNumber);bv(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Je("RemoteStore","Failed to raise snapshot:",n),await ip(t,n)}}async function ip(t,e,r){if(!Md(e))throw e;t.L_.add(1),await jd(t),t.q_.set("Offline"),r||(r=()=>EC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Je("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await Kp(t)})}function CC(t,e){return e().catch(r=>ip(t,r,e))}async function Xp(t){const e=gt(t),r=Ko(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;OV(e);)try{const i=await vV(e.localStore,n);if(i===null){e.O_.length===0&&r.o_();break}n=i.batchId,MV(e,i)}catch(i){await ip(e,i)}FC(e)&&IC(e)}function OV(t){return Jl(t)&&t.O_.length<10}function MV(t,e){t.O_.push(e);const r=Ko(t);r.r_()&&r.V_&&r.m_(e.mutations)}function FC(t){return Jl(t)&&!Ko(t).n_()&&t.O_.length>0}function IC(t){Ko(t).start()}async function LV(t){Ko(t).p_()}async function BV(t){const e=Ko(t);for(const r of t.O_)e.m_(r.mutations)}async function jV(t,e,r){const n=t.O_.shift(),i=Tv.from(n,e,r);await CC(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Xp(t)}async function VV(t,e){e&&Ko(t).V_&&await async function(n,i){if(function(a){return F7(a)&&a!==De.ABORTED}(i.code)){const s=n.O_.shift();Ko(n).s_(),await CC(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Xp(n)}}(t,e),FC(t)&&IC(t)}async function AE(t,e){const r=gt(t);r.asyncQueue.verifyOperationInProgress(),Je("RemoteStore","RemoteStore received new credentials");const n=Jl(r);r.L_.add(3),await jd(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await Kp(r)}async function UV(t,e){const r=gt(t);e?(r.L_.delete(2),await Kp(r)):e||(r.L_.add(2),await jd(r),r.q_.set("Unknown"))}function Cu(t){return t.K_||(t.K_=function(r,n,i){const s=gt(r);return s.w_(),new kV(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:RV.bind(null,t),Ro:NV.bind(null,t),mo:DV.bind(null,t),d_:PV.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Nv(t)?Rv(t):t.q_.set("Unknown")):(await t.K_.stop(),kC(t))})),t.K_}function Ko(t){return t.U_||(t.U_=function(r,n,i){const s=gt(r);return s.w_(),new CV(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:LV.bind(null,t),mo:VV.bind(null,t),f_:BV.bind(null,t),g_:jV.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Xp(t)):(await t.U_.stop(),t.O_.length>0&&(Je("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dv{constructor(e,r,n,i,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Lo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,s){const a=Date.now()+n,o=new Dv(e,r,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new rt(De.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Pv(t,e){if(Ua("AsyncQueue",`${e}: ${t}`),Md(t))return new rt(De.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kc{constructor(e){this.comparator=e?(r,n)=>e(r,n)||it.comparator(r.key,n.key):(r,n)=>it.comparator(r.key,n.key),this.keyedMap=lf(),this.sortedSet=new Rr(this.comparator)}static emptySet(e){return new Kc(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Kc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Kc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kE{constructor(){this.W_=new Rr(it.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):ht():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class hu{constructor(e,r,n,i,s,a,o,l,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,i,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new hu(e,r,Kc.emptySet(r),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Up(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zV{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class WV{constructor(){this.queries=CE(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const i=gt(r),s=i.queries;i.queries=CE(),s.forEach((a,o)=>{for(const l of o.j_)l.onError(n)})})(this,new rt(De.ABORTED,"Firestore shutting down"))}}function CE(){return new ku(t=>Qk(t),Up)}async function bC(t,e){const r=gt(t);let n=3;const i=e.query;let s=r.queries.get(i);s?!s.H_()&&e.J_()&&(n=2):(s=new zV,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(i,!0);break;case 1:s.z_=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const o=Pv(a,`Initialization of query '${yc(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,s),s.j_.push(e),e.Z_(r.onlineState),s.z_&&e.X_(s.z_)&&Ov(r)}async function RC(t,e){const r=gt(t),n=e.query;let i=3;const s=r.queries.get(n);if(s){const a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function HV(t,e){const r=gt(t);let n=!1;for(const i of e){const s=i.query,a=r.queries.get(s);if(a){for(const o of a.j_)o.X_(i)&&(n=!0);a.z_=i}}n&&Ov(r)}function $V(t,e,r){const n=gt(t),i=n.queries.get(e);if(i)for(const s of i.j_)s.onError(r);n.queries.delete(e)}function Ov(t){t.Y_.forEach(e=>{e.next()})}var Sx,FE;(FE=Sx||(Sx={})).ea="default",FE.Cache="cache";class NC{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new hu(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=hu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Sx.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(e){this.key=e}}class PC{constructor(e){this.key=e}}class GV{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=At(),this.mutatedKeys=At(),this.Aa=Jk(e),this.Ra=new Kc(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new kE,i=r?r.Ra:this.Ra;let s=r?r.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{const p=i.get(d),g=zp(this.query,h)?h:null,y=!!p&&this.mutatedKeys.has(p.key),x=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let E=!1;p&&g?p.data.isEqual(g.data)?y!==x&&(n.track({type:3,doc:g}),E=!0):this.ga(p,g)||(n.track({type:2,doc:g}),E=!0,(l&&this.Aa(g,l)>0||c&&this.Aa(g,c)<0)&&(o=!0)):!p&&g?(n.track({type:0,doc:g}),E=!0):p&&!g&&(n.track({type:1,doc:p}),E=!0,(l||c)&&(o=!0)),E&&(g?(a=a.add(g),s=x?s.add(d):s.delete(d)):(a=a.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const d=this.query.limitType==="F"?a.last():a.first();a=a.delete(d.key),s=s.delete(d.key),n.track({type:1,doc:d})}return{Ra:a,fa:n,ns:o,mutatedKeys:s}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((d,h)=>function(g,y){const x=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ht()}};return x(g)-x(y)}(d.type,h.type)||this.Aa(d.doc,h.doc)),this.pa(n),i=i!=null&&i;const o=r&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,c=l!==this.Ea;return this.Ea=l,a.length!==0||c?{snapshot:new hu(this.query,e.Ra,s,a,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new kE,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=At(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new PC(n))}),this.da.forEach(n=>{e.has(n)||r.push(new DC(n))}),r}ba(e){this.Ta=e.Ts,this.da=At();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return hu.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class KV{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class XV{constructor(e){this.key=e,this.va=!1}}class YV{constructor(e,r,n,i,s,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new ku(o=>Qk(o),Up),this.Ma=new Map,this.xa=new Set,this.Oa=new Rr(it.comparator),this.Na=new Map,this.La=new kv,this.Ba={},this.ka=new Map,this.qa=du.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function qV(t,e,r=!0){const n=VC(t);let i;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await OC(n,e,r,!0),i}async function QV(t,e){const r=VC(t);await OC(r,e,!0,!1)}async function OC(t,e,r,n){const i=await yV(t.localStore,ra(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,r);let o;return n&&(o=await JV(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&SC(t.remoteStore,i),o}async function JV(t,e,r,n,i){t.Ka=(h,p,g)=>async function(x,E,T,A){let _=E.view.ma(T);_.ns&&(_=await wE(x.localStore,E.query,!1).then(({documents:w})=>E.view.ma(w,_)));const P=A&&A.targetChanges.get(E.targetId),W=A&&A.targetMismatches.get(E.targetId)!=null,j=E.view.applyChanges(_,x.isPrimaryClient,P,W);return bE(x,E.targetId,j.wa),j.snapshot}(t,h,p,g);const s=await wE(t.localStore,e,!0),a=new GV(e,s.Ts),o=a.ma(s.documents),l=Bd.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),c=a.applyChanges(o,t.isPrimaryClient,l);bE(t,r,c.wa);const d=new KV(e,r,a);return t.Fa.set(e,d),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),c.snapshot}async function ZV(t,e,r){const n=gt(t),i=n.Fa.get(e),s=n.Ma.get(i.targetId);if(s.length>1)return n.Ma.set(i.targetId,s.filter(a=>!Up(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Tx(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Iv(n.remoteStore,i.targetId),Ax(n,i.targetId)}).catch(Od)):(Ax(n,i.targetId),await Tx(n.localStore,i.targetId,!0))}async function eU(t,e){const r=gt(t),n=r.Fa.get(e),i=r.Ma.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Iv(r.remoteStore,n.targetId))}async function tU(t,e,r){const n=lU(t);try{const i=await function(a,o){const l=gt(a),c=fn.now(),d=o.reduce((g,y)=>g.add(y.key),At());let h,p;return l.persistence.runTransaction("Locally write mutations","readwrite",g=>{let y=za(),x=At();return l.cs.getEntries(g,d).next(E=>{y=E,y.forEach((T,A)=>{A.isValidDocument()||(x=x.add(T))})}).next(()=>l.localDocuments.getOverlayedDocuments(g,y)).next(E=>{h=E;const T=[];for(const A of o){const _=T7(A,h.get(A.key).overlayedDocument);_!=null&&T.push(new Ql(A.key,_,Hk(_.value.mapValue),Pa.exists(!0)))}return l.mutationQueue.addMutationBatch(g,c,T,o)}).next(E=>{p=E;const T=E.applyToLocalDocumentSet(h,x);return l.documentOverlayCache.saveOverlays(g,E.batchId,T)})}).then(()=>({batchId:p.batchId,changes:eC(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,l){let c=a.Ba[a.currentUser.toKey()];c||(c=new Rr(Bt)),c=c.insert(o,l),a.Ba[a.currentUser.toKey()]=c}(n,i.batchId,r),await Vd(n,i.changes),await Xp(n.remoteStore)}catch(i){const s=Pv(i,"Failed to persist write");r.reject(s)}}async function MC(t,e){const r=gt(t);try{const n=await gV(r.localStore,e);e.targetChanges.forEach((i,s)=>{const a=r.Na.get(s);a&&(Yt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?Yt(a.va):i.removedDocuments.size>0&&(Yt(a.va),a.va=!1))}),await Vd(r,n,e)}catch(n){await Od(n)}}function IE(t,e,r){const n=gt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Fa.forEach((s,a)=>{const o=a.view.Z_(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const l=gt(a);l.onlineState=o;let c=!1;l.queries.forEach((d,h)=>{for(const p of h.j_)p.Z_(o)&&(c=!0)}),c&&Ov(l)}(n.eventManager,e),i.length&&n.Ca.d_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function rU(t,e,r){const n=gt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Na.get(e),s=i&&i.key;if(s){let a=new Rr(it.comparator);a=a.insert(s,qn.newNoDocument(s,mt.min()));const o=At().add(s),l=new $p(mt.min(),new Map,new Rr(Bt),a,o);await MC(n,l),n.Oa=n.Oa.remove(s),n.Na.delete(e),Mv(n)}else await Tx(n.localStore,e,!1).then(()=>Ax(n,e,r)).catch(Od)}async function nU(t,e){const r=gt(t),n=e.batch.batchId;try{const i=await mV(r.localStore,e);BC(r,n,null),LC(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Vd(r,i)}catch(i){await Od(i)}}async function iU(t,e,r){const n=gt(t);try{const i=await function(a,o){const l=gt(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return l.mutationQueue.lookupMutationBatch(c,o).next(h=>(Yt(h!==null),d=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,d,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>l.localDocuments.getDocuments(c,d))})}(n.localStore,e);BC(n,e,r),LC(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Vd(n,i)}catch(i){await Od(i)}}function LC(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function BC(t,e,r){const n=gt(t);let i=n.Ba[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(r?s.reject(r):s.resolve(),i=i.remove(e)),n.Ba[n.currentUser.toKey()]=i}}function Ax(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||jC(t,n)})}function jC(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(Iv(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),Mv(t))}function bE(t,e,r){for(const n of r)n instanceof DC?(t.La.addReference(n.key,e),sU(t,n)):n instanceof PC?(Je("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||jC(t,n.key)):ht()}function sU(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(Je("SyncEngine","New document in limbo: "+r),t.xa.add(n),Mv(t))}function Mv(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new it(jr.fromString(e)),n=t.qa.next();t.Na.set(n,new XV(r)),t.Oa=t.Oa.insert(r,n),SC(t.remoteStore,new Ao(ra(Vp(r.path)),n,"TargetPurposeLimboResolution",gv.oe))}}async function Vd(t,e,r){const n=gt(t),i=[],s=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{a.push(n.Ka(l,e,r).then(c=>{var d;if((c||r)&&n.isPrimaryClient){const h=c?!c.fromCache:(d=r==null?void 0:r.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;n.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){i.push(c);const h=Fv.Wi(l.targetId,c);s.push(h)}}))}),await Promise.all(a),n.Ca.d_(i),await async function(l,c){const d=gt(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>Fe.forEach(c,p=>Fe.forEach(p.$i,g=>d.persistence.referenceDelegate.addReference(h,p.targetId,g)).next(()=>Fe.forEach(p.Ui,g=>d.persistence.referenceDelegate.removeReference(h,p.targetId,g)))))}catch(h){if(!Md(h))throw h;Je("LocalStore","Failed to update sequence numbers: "+h)}for(const h of c){const p=h.targetId;if(!h.fromCache){const g=d.os.get(p),y=g.snapshotVersion,x=g.withLastLimboFreeSnapshotVersion(y);d.os=d.os.insert(p,x)}}}(n.localStore,s))}async function aU(t,e){const r=gt(t);if(!r.currentUser.isEqual(e)){Je("SyncEngine","User change. New user:",e.toKey());const n=await _C(r.localStore,e);r.currentUser=e,function(s,a){s.ka.forEach(o=>{o.forEach(l=>{l.reject(new rt(De.CANCELLED,a))})}),s.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Vd(r,n.hs)}}function oU(t,e){const r=gt(t),n=r.Na.get(e);if(n&&n.va)return At().add(n.key);{let i=At();const s=r.Ma.get(e);if(!s)return i;for(const a of s){const o=r.Fa.get(a);i=i.unionWith(o.view.Va)}return i}}function VC(t){const e=gt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=MC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=oU.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=rU.bind(null,e),e.Ca.d_=HV.bind(null,e.eventManager),e.Ca.$a=$V.bind(null,e.eventManager),e}function lU(t){const e=gt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=nU.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=iU.bind(null,e),e}class sp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Gp(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return pV(this.persistence,new dV,e.initialUser,this.serializer)}Ga(e){return new cV(Cv.Zr,this.serializer)}Wa(e){return new EV}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}sp.provider={build:()=>new sp};class kx{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>IE(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=aU.bind(null,this.syncEngine),await UV(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new WV}()}createDatastore(e){const r=Gp(e.databaseInfo.databaseId),n=function(s){return new AV(s)}(e.databaseInfo);return function(s,a,o,l){return new FV(s,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,s,a,o){return new bV(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>IE(this.syncEngine,r,0),function(){return SE.D()?new SE:new wV}())}createSyncEngine(e,r){return function(i,s,a,o,l,c,d){const h=new YV(i,s,a,o,l,c);return d&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const s=gt(i);Je("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await jd(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}kx.provider={build:()=>new kx};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UC{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Ua("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cU{constructor(e,r,n,i,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=Gn.UNAUTHENTICATED,this.clientId=Uk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{Je("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(Je("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Lo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Pv(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Zm(t,e){t.asyncQueue.verifyOperationInProgress(),Je("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await _C(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function RE(t,e){t.asyncQueue.verifyOperationInProgress();const r=await uU(t);Je("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>AE(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>AE(e.remoteStore,i)),t._onlineComponents=e}async function uU(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Je("FirestoreClient","Using user provided OfflineComponentProvider");try{await Zm(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===De.FAILED_PRECONDITION||i.code===De.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;lu("Error using user provided cache. Falling back to memory cache: "+r),await Zm(t,new sp)}}else Je("FirestoreClient","Using default OfflineComponentProvider"),await Zm(t,new sp);return t._offlineComponents}async function zC(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Je("FirestoreClient","Using user provided OnlineComponentProvider"),await RE(t,t._uninitializedComponentsProvider._online)):(Je("FirestoreClient","Using default OnlineComponentProvider"),await RE(t,new kx))),t._onlineComponents}function fU(t){return zC(t).then(e=>e.syncEngine)}async function Cx(t){const e=await zC(t),r=e.eventManager;return r.onListen=qV.bind(null,e.syncEngine),r.onUnlisten=ZV.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=QV.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=eU.bind(null,e.syncEngine),r}function dU(t,e,r={}){const n=new Lo;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,c){const d=new UC({next:p=>{d.Za(),a.enqueueAndForget(()=>RC(s,h));const g=p.docs.has(o);!g&&p.fromCache?c.reject(new rt(De.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&p.fromCache&&l&&l.source==="server"?c.reject(new rt(De.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(p)},error:p=>c.reject(p)}),h=new NC(Vp(o.path),d,{includeMetadataChanges:!0,_a:!0});return bC(s,h)}(await Cx(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WC(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NE=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hU(t,e,r){if(!r)throw new rt(De.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function pU(t,e,r,n){if(e===!0&&n===!0)throw new rt(De.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function DE(t){if(!it.isDocumentKey(t))throw new rt(De.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Lv(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ht()}function Bo(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new rt(De.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Lv(t);throw new rt(De.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PE{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new rt(De.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new rt(De.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}pU("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=WC((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new rt(De.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new rt(De.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new rt(De.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Bv{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new PE({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new rt(De.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new rt(De.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new PE(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new Rj;switch(n.type){case"firstParty":return new Oj(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new rt(De.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=NE.get(r);n&&(Je("ComponentProvider","Removing Datastore"),NE.delete(r),n.terminate())}(this),Promise.resolve()}}function mU(t,e,r,n={}){var i;const s=(t=Bo(t,Bv))._getSettings(),a=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&lu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=Gn.MOCK_USER;else{o=s9(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new rt(De.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Gn(c)}t._authCredentials=new Nj(new Vk(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yp{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Yp(this.firestore,e,this._query)}}class zi{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xd(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new zi(this.firestore,e,this._key)}}class xd extends Yp{constructor(e,r,n){super(e,r,Vp(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new zi(this.firestore,null,new it(e))}withConverter(e){return new xd(this.firestore,e,this._path)}}function jv(t,e,...r){if(t=js(t),arguments.length===1&&(e=Uk.newId()),hU("doc","path",e),t instanceof Bv){const n=jr.fromString(e,...r);return DE(n),new zi(t,null,new it(n))}{if(!(t instanceof zi||t instanceof xd))throw new rt(De.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(jr.fromString(e,...r));return DE(n),new zi(t.firestore,t instanceof xd?t.converter:null,new it(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OE{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new wC(this,"async_queue_retry"),this.Vu=()=>{const n=Jm();n&&Je("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=Jm();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=Jm();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new Lo;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Md(e))throw e;Je("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw Ua("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const i=Dv.createAndSchedule(this,e,r,n,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&ht()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function ME(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const i=r;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class vd extends Bv{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new OE,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new OE(e),this._firestoreClient=void 0,await e}}}function gU(t,e){const r=typeof t=="object"?t:Rk(),n=typeof t=="string"?t:"(default)",i=pv(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=n9("firestore");s&&mU(i,...s)}return i}function Vv(t){if(t._terminated)throw new rt(De.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||xU(t),t._firestoreClient}function xU(t){var e,r,n;const i=t._freezeSettings(),s=function(o,l,c,d){return new Xj(o,l,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,WC(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new cU(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new pu(Pn.fromBase64String(e))}catch(r){throw new rt(De.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new pu(Pn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uv{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new rt(De.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zv{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new rt(De.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new rt(De.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Bt(this._lat,e._lat)||Bt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wv{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vU=/^__.*__$/;class yU{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Ql(e,this.data,this.fieldMask,r,this.fieldTransforms):new Ld(e,this.data,r,this.fieldTransforms)}}function $C(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ht()}}class Hv{constructor(e,r,n,i,s,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Hv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return ap(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if($C(this.Cu)&&vU.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class _U{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Gp(e)}Qu(e,r,n,i=!1){return new Hv({Cu:e,methodName:r,qu:n,path:bn.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function EU(t){const e=t._freezeSettings(),r=Gp(t._databaseId);return new _U(t._databaseId,!!e.ignoreUndefinedProperties,r)}function wU(t,e,r,n,i,s={}){const a=t.Qu(s.merge||s.mergeFields?2:0,e,r,i);YC("Data must be an object, but it was:",a,n);const o=KC(n,a);let l,c;if(s.merge)l=new Ds(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const d=[];for(const h of s.mergeFields){const p=TU(e,h,r);if(!a.contains(p))throw new rt(De.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);AU(d,p)||d.push(p)}l=new Ds(d),c=a.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=a.fieldTransforms;return new yU(new is(o),l,c)}function GC(t,e){if(XC(t=js(t)))return YC("Unsupported field value:",e,t),KC(t,e);if(t instanceof HC)return function(n,i){if(!$C(i.Cu))throw i.Bu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let l=GC(o,i.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(t,e)}return function(n,i){if((n=js(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return x7(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=fn.fromDate(n);return{timestampValue:np(i.serializer,s)}}if(n instanceof fn){const s=new fn(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:np(i.serializer,s)}}if(n instanceof zv)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof pu)return{bytesValue:hC(i.serializer,n._byteString)};if(n instanceof zi){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Av(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof Wv)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return wv(o.serializer,l)})}}}}}}(n,i);throw i.Bu(`Unsupported field value: ${Lv(n)}`)}(t,e)}function KC(t,e){const r={};return zk(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Au(t,(n,i)=>{const s=GC(i,e.Mu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function XC(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof fn||t instanceof zv||t instanceof pu||t instanceof zi||t instanceof HC||t instanceof Wv)}function YC(t,e,r){if(!XC(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=Lv(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function TU(t,e,r){if((e=js(e))instanceof Uv)return e._internalPath;if(typeof e=="string")return qC(t,e);throw ap("Field path arguments must be of type string or ",t,!1,void 0,r)}const SU=new RegExp("[~\\*/\\[\\]]");function qC(t,e,r){if(e.search(SU)>=0)throw ap(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Uv(...e.split("."))._internalPath}catch{throw ap(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function ap(t,e,r,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${i}`),l+=")"),new rt(De.INVALID_ARGUMENT,o+t+l)}function AU(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QC{constructor(e,r,n,i,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new zi(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new kU(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(JC("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class kU extends QC{data(){return super.data()}}function JC(t,e){return typeof e=="string"?qC(t,e):e instanceof Uv?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CU(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new rt(De.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class FU{convertValue(e,r="none"){switch(Ul(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Wr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Vl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw ht()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Au(e,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,i;const s=(i=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(a=>Wr(a.doubleValue));return new Wv(s)}convertGeoPoint(e){return new zv(Wr(e.latitude),Wr(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=vv(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(dd(e));default:return null}}convertTimestamp(e){const r=Go(e);return new fn(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=jr.fromString(e);Yt(yC(n));const i=new hd(n.get(1),n.get(3)),s=new it(n.popFirst(5));return i.isEqual(r)||Ua(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IU(t,e,r){let n;return n=t?t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ZC extends QC{constructor(e,r,n,i,s,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new oh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(JC("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class oh extends ZC{data(e={}){return super.data(e)}}class bU{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new uf(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new oh(this._firestore,this._userDataWriter,n.key,n,new uf(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new rt(De.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const l=new oh(i._firestore,i._userDataWriter,o.doc.key,o.doc,new uf(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new oh(i._firestore,i._userDataWriter,o.doc.key,o.doc,new uf(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,d=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),d=a.indexOf(o.doc.key)),{type:RU(o.type),doc:l,oldIndex:c,newIndex:d}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function RU(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ht()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NU(t){t=Bo(t,zi);const e=Bo(t.firestore,vd);return dU(Vv(e),t._key).then(r=>t4(e,t,r))}class e4 extends FU{constructor(e){super(),this.firestore=e}convertBytes(e){return new pu(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new zi(this.firestore,null,r)}}function DU(t,e,r){t=Bo(t,zi);const n=Bo(t.firestore,vd),i=IU(t.converter,e);return OU(n,[wU(EU(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,Pa.none())])}function PU(t,...e){var r,n,i;t=js(t);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||ME(e[a])||(s=e[a],a++);const o={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(ME(e[a])){const h=e[a];e[a]=(r=h.next)===null||r===void 0?void 0:r.bind(h),e[a+1]=(n=h.error)===null||n===void 0?void 0:n.bind(h),e[a+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let l,c,d;if(t instanceof zi)c=Bo(t.firestore,vd),d=Vp(t._key.path),l={next:h=>{e[a]&&e[a](t4(c,t,h))},error:e[a+1],complete:e[a+2]};else{const h=Bo(t,Yp);c=Bo(h.firestore,vd),d=h._query;const p=new e4(c);l={next:g=>{e[a]&&e[a](new bU(c,p,h,g))},error:e[a+1],complete:e[a+2]},CU(t._query)}return function(p,g,y,x){const E=new UC(x),T=new NC(g,E,y);return p.asyncQueue.enqueueAndForget(async()=>bC(await Cx(p),T)),()=>{E.Za(),p.asyncQueue.enqueueAndForget(async()=>RC(await Cx(p),T))}}(Vv(c),d,o,l)}function OU(t,e){return function(n,i){const s=new Lo;return n.asyncQueue.enqueueAndForget(async()=>tU(await fU(n),i,s)),s.promise}(Vv(t),e)}function t4(t,e,r){const n=r.docs.get(e._key),i=new e4(t);return new ZC(t,i,e._key,n,new uf(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){Su=i})(Tu),ou(new Bl("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new vd(new Dj(n.getProvider("auth-internal")),new Lj(n.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new rt(De.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new hd(c.options.projectId,d)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),Mo(tE,"4.7.3",e),Mo(tE,"4.7.3","esm2017")})();function $v(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function r4(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const MU=r4,n4=new Dd("auth","Firebase",r4());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const op=new dv("@firebase/auth");function LU(t,...e){op.logLevel<=kt.WARN&&op.warn(`Auth (${Tu}): ${t}`,...e)}function lh(t,...e){op.logLevel<=kt.ERROR&&op.error(`Auth (${Tu}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wa(t,...e){throw Gv(t,...e)}function ia(t,...e){return Gv(t,...e)}function i4(t,e,r){const n=Object.assign(Object.assign({},MU()),{[e]:r});return new Dd("auth","Firebase",n).create(e,{appName:t.name})}function kl(t){return i4(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Gv(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return n4.create(t,...e)}function dt(t,e,...r){if(!t)throw Gv(e,...r)}function Ca(t){const e="INTERNAL ASSERTION FAILED: "+t;throw lh(e),new Error(e)}function Ha(t,e){t||Ca(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fx(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function BU(){return LE()==="http:"||LE()==="https:"}function LE(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jU(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(BU()||c9()||"connection"in navigator)?navigator.onLine:!0}function VU(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ud{constructor(e,r){this.shortDelay=e,this.longDelay=r,Ha(r>e,"Short delay should be less than long delay!"),this.isMobile=a9()||u9()}get(){return jU()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kv(t,e){Ha(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s4{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ca("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ca("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ca("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UU={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zU=new Ud(3e4,6e4);function Xv(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Fu(t,e,r,n,i={}){return a4(t,i,async()=>{let s={},a={};n&&(e==="GET"?a=n:s={body:JSON.stringify(n)});const o=Pd(Object.assign({key:t.config.apiKey},a)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},s);return l9()||(c.referrerPolicy="no-referrer"),s4.fetch()(o4(t,t.config.apiHost,r,o),c)})}async function a4(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},UU),e);try{const i=new HU(t),s=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw z0(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw z0(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw z0(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw z0(t,"user-disabled",a);const d=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw i4(t,d,c);Wa(t,d)}}catch(i){if(i instanceof Ya)throw i;Wa(t,"network-request-failed",{message:String(i)})}}async function WU(t,e,r,n,i={}){const s=await Fu(t,e,r,n,i);return"mfaPendingCredential"in s&&Wa(t,"multi-factor-auth-required",{_serverResponse:s}),s}function o4(t,e,r,n){const i=`${e}${r}?${n}`;return t.config.emulator?Kv(t.config,i):`${t.config.apiScheme}://${i}`}class HU{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(ia(this.auth,"network-request-failed")),zU.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function z0(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=ia(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $U(t,e){return Fu(t,"POST","/v1/accounts:delete",e)}async function l4(t,e){return Fu(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nf(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function GU(t,e=!1){const r=js(t),n=await r.getIdToken(e),i=Yv(n);dt(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:Nf(eg(i.auth_time)),issuedAtTime:Nf(eg(i.iat)),expirationTime:Nf(eg(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function eg(t){return Number(t)*1e3}function Yv(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return lh("JWT malformed, contained fewer than 3 sections"),null;try{const i=Sk(r);return i?JSON.parse(i):(lh("Failed to decode base64 JWT payload"),null)}catch(i){return lh("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function BE(t){const e=Yv(t);return dt(e,"internal-error"),dt(typeof e.exp<"u","internal-error"),dt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yd(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Ya&&KU(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function KU({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XU{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ix{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Nf(this.lastLoginAt),this.creationTime=Nf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lp(t){var e;const r=t.auth,n=await t.getIdToken(),i=await yd(t,l4(r,{idToken:n}));dt(i==null?void 0:i.users.length,r,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?c4(s.providerUserInfo):[],o=qU(t.providerData,a),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=l?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Ix(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function YU(t){const e=js(t);await lp(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function qU(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function c4(t){return t.map(e=>{var{providerId:r}=e,n=$v(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QU(t,e){const r=await a4(t,{},async()=>{const n=Pd({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=o4(t,i,"/v1/token",`key=${s}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",s4.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function JU(t,e){return Fu(t,"POST","/v2/accounts:revokeToken",Xv(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){dt(e.idToken,"internal-error"),dt(typeof e.idToken<"u","internal-error"),dt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):BE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){dt(e.length!==0,"internal-error");const r=BE(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(dt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:s}=await QU(e,r);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new Xc;return n&&(dt(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(dt(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(dt(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Xc,this.toJSON())}_performRefresh(){return Ca("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uo(t,e){dt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Fa{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,s=$v(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new XU(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Ix(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await yd(this,this.stsTokenManager.getToken(this.auth,e));return dt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return GU(this,e)}reload(){return YU(this)}_assign(e){this!==e&&(dt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Fa(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){dt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await lp(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(So(this.auth.app))return Promise.reject(kl(this.auth));const e=await this.getIdToken();return await yd(this,$U(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,s,a,o,l,c,d;const h=(n=r.displayName)!==null&&n!==void 0?n:void 0,p=(i=r.email)!==null&&i!==void 0?i:void 0,g=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,y=(a=r.photoURL)!==null&&a!==void 0?a:void 0,x=(o=r.tenantId)!==null&&o!==void 0?o:void 0,E=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,T=(c=r.createdAt)!==null&&c!==void 0?c:void 0,A=(d=r.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:_,emailVerified:P,isAnonymous:W,providerData:j,stsTokenManager:w}=r;dt(_&&w,e,"internal-error");const F=Xc.fromJSON(this.name,w);dt(typeof _=="string",e,"internal-error"),uo(h,e.name),uo(p,e.name),dt(typeof P=="boolean",e,"internal-error"),dt(typeof W=="boolean",e,"internal-error"),uo(g,e.name),uo(y,e.name),uo(x,e.name),uo(E,e.name),uo(T,e.name),uo(A,e.name);const S=new Fa({uid:_,auth:e,email:p,emailVerified:P,displayName:h,isAnonymous:W,photoURL:y,phoneNumber:g,tenantId:x,stsTokenManager:F,createdAt:T,lastLoginAt:A});return j&&Array.isArray(j)&&(S.providerData=j.map(b=>Object.assign({},b))),E&&(S._redirectEventId=E),S}static async _fromIdTokenResponse(e,r,n=!1){const i=new Xc;i.updateFromServerResponse(r);const s=new Fa({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await lp(s),s}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];dt(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?c4(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),o=new Xc;o.updateFromIdToken(n);const l=new Fa({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Ix(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jE=new Map;function Ia(t){Ha(t instanceof Function,"Expected a class definition");let e=jE.get(t);return e?(Ha(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,jE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u4{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}u4.type="NONE";const VE=u4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ch(t,e,r){return`firebase:${t}:${e}:${r}`}class Yc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=ch(this.userKey,i.apiKey,s),this.fullPersistenceKey=ch("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Fa._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Yc(Ia(VE),e,n);const i=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||Ia(VE);const a=ch(n,e.config.apiKey,e.name);let o=null;for(const c of r)try{const d=await c._get(a);if(d){const h=Fa._fromJSON(e,d);c!==s&&(o=h),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Yc(s,e,n):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==s)try{await c._remove(a)}catch{}})),new Yc(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(p4(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(f4(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(g4(e))return"Blackberry";if(x4(e))return"Webos";if(d4(e))return"Safari";if((e.includes("chrome/")||h4(e))&&!e.includes("edge/"))return"Chrome";if(m4(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function f4(t=ti()){return/firefox\//i.test(t)}function d4(t=ti()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function h4(t=ti()){return/crios\//i.test(t)}function p4(t=ti()){return/iemobile/i.test(t)}function m4(t=ti()){return/android/i.test(t)}function g4(t=ti()){return/blackberry/i.test(t)}function x4(t=ti()){return/webos/i.test(t)}function qv(t=ti()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function ZU(t=ti()){var e;return qv(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function ez(){return f9()&&document.documentMode===10}function v4(t=ti()){return qv(t)||m4(t)||x4(t)||g4(t)||/windows phone/i.test(t)||p4(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y4(t,e=[]){let r;switch(t){case"Browser":r=UE(ti());break;case"Worker":r=`${UE(ti())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Tu}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tz{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rz(t,e={}){return Fu(t,"GET","/v2/passwordPolicy",Xv(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nz=6;class iz{constructor(e){var r,n,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:nz,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sz{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new zE(this),this.idTokenSubscription=new zE(this),this.beforeStateQueue=new tz(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=n4,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Ia(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Yc.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await l4(this,{idToken:e}),n=await Fa._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(So(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return dt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await lp(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=VU()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(So(this.app))return Promise.reject(kl(this));const r=e?js(e):null;return r&&dt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&dt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return So(this.app)?Promise.reject(kl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return So(this.app)?Promise.reject(kl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ia(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await rz(this),r=new iz(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Dd("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await JU(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Ia(e)||this._popupRedirectResolver;dt(r,this,"argument-error"),this.redirectPersistenceManager=await Yc.create(this,[Ia(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(dt(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,i);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return dt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=y4(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&LU(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Qv(t){return js(t)}class zE{constructor(e){this.auth=e,this.observer=null,this.addObserver=y9(r=>this.observer=r)}get next(){return dt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function az(t){Jv=t}function oz(t){return Jv.loadJS(t)}function lz(){return Jv.gapiScript}function cz(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uz(t,e){const r=pv(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),s=r.getOptions();if(qh(s,e??{}))return i;Wa(i,"already-initialized")}return r.initialize({options:e})}function fz(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Ia);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function dz(t,e,r){const n=Qv(t);dt(n._canInitEmulator,n,"emulator-config-failed"),dt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,s=_4(e),{host:a,port:o}=hz(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${s}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),pz()}function _4(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function hz(t){const e=_4(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:WE(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:WE(a)}}}function WE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function pz(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E4{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Ca("not implemented")}_getIdTokenResponse(e){return Ca("not implemented")}_linkToIdToken(e,r){return Ca("not implemented")}_getReauthenticationResolver(e){return Ca("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qc(t,e){return WU(t,"POST","/v1/accounts:signInWithIdp",Xv(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mz="http://localhost";class zl extends E4{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new zl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Wa("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,s=$v(r,["providerId","signInMethod"]);if(!n||!i)return null;const a=new zl(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return qc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,qc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,qc(e,r)}buildRequest(){const e={requestUri:mz,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Pd(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w4{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zd extends w4{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go extends zd{constructor(){super("facebook.com")}static credential(e){return zl._fromParams({providerId:go.PROVIDER_ID,signInMethod:go.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return go.credentialFromTaggedObject(e)}static credentialFromError(e){return go.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return go.credential(e.oauthAccessToken)}catch{return null}}}go.FACEBOOK_SIGN_IN_METHOD="facebook.com";go.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo extends zd{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return zl._fromParams({providerId:xo.PROVIDER_ID,signInMethod:xo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return xo.credentialFromTaggedObject(e)}static credentialFromError(e){return xo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return xo.credential(r,n)}catch{return null}}}xo.GOOGLE_SIGN_IN_METHOD="google.com";xo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo extends zd{constructor(){super("github.com")}static credential(e){return zl._fromParams({providerId:vo.PROVIDER_ID,signInMethod:vo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return vo.credentialFromTaggedObject(e)}static credentialFromError(e){return vo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return vo.credential(e.oauthAccessToken)}catch{return null}}}vo.GITHUB_SIGN_IN_METHOD="github.com";vo.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo extends zd{constructor(){super("twitter.com")}static credential(e,r){return zl._fromParams({providerId:yo.PROVIDER_ID,signInMethod:yo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return yo.credentialFromTaggedObject(e)}static credentialFromError(e){return yo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return yo.credential(r,n)}catch{return null}}}yo.TWITTER_SIGN_IN_METHOD="twitter.com";yo.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const s=await Fa._fromIdTokenResponse(e,n,i),a=HE(n);return new mu({user:s,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=HE(n);return new mu({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function HE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cp extends Ya{constructor(e,r,n,i){var s;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,cp.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new cp(e,r,n,i)}}function T4(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?cp._fromErrorAndOperation(t,s,e,n):s})}async function gz(t,e,r=!1){const n=await yd(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return mu._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xz(t,e,r=!1){const{auth:n}=t;if(So(n.app))return Promise.reject(kl(n));const i="reauthenticate";try{const s=await yd(t,T4(n,i,e,t),r);dt(s.idToken,n,"internal-error");const a=Yv(s.idToken);dt(a,n,"internal-error");const{sub:o}=a;return dt(t.uid===o,n,"user-mismatch"),mu._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Wa(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vz(t,e,r=!1){if(So(t.app))return Promise.reject(kl(t));const n="signIn",i=await T4(t,n,e),s=await mu._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(s.user),s}function yz(t,e,r,n){return js(t).onIdTokenChanged(e,r,n)}function _z(t,e,r){return js(t).beforeAuthStateChanged(e,r)}const up="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S4{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(up,"1"),this.storage.removeItem(up),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ez=1e3,wz=10;class A4 extends S4{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=v4(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);ez()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,wz):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},Ez)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}A4.type="LOCAL";const Tz=A4;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k4 extends S4{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}k4.type="SESSION";const C4=k4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sz(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new qp(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:s}=r.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async c=>c(r.origin,s)),l=await Sz(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}qp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zv(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Az{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const c=Zv("",20);i.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(h){const p=h;if(p.data.eventId===c)switch(p.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(p.data.response);break;default:clearTimeout(d),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sa(){return window}function kz(t){sa().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F4(){return typeof sa().WorkerGlobalScope<"u"&&typeof sa().importScripts=="function"}async function Cz(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Fz(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function Iz(){return F4()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I4="firebaseLocalStorageDb",bz=1,fp="firebaseLocalStorage",b4="fbase_key";class Wd{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Qp(t,e){return t.transaction([fp],e?"readwrite":"readonly").objectStore(fp)}function Rz(){const t=indexedDB.deleteDatabase(I4);return new Wd(t).toPromise()}function bx(){const t=indexedDB.open(I4,bz);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(fp,{keyPath:b4})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(fp)?e(n):(n.close(),await Rz(),e(await bx()))})})}async function $E(t,e,r){const n=Qp(t,!0).put({[b4]:e,value:r});return new Wd(n).toPromise()}async function Nz(t,e){const r=Qp(t,!1).get(e),n=await new Wd(r).toPromise();return n===void 0?null:n.value}function GE(t,e){const r=Qp(t,!0).delete(e);return new Wd(r).toPromise()}const Dz=800,Pz=3;class R4{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await bx(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>Pz)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return F4()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=qp._getInstance(Iz()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await Cz(),!this.activeServiceWorker)return;this.sender=new Az(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Fz()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await bx();return await $E(e,up,"1"),await GE(e,up),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>$E(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>Nz(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>GE(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Qp(i,!1).getAll();return new Wd(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Dz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}R4.type="LOCAL";const Oz=R4;new Ud(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mz(t,e){return e?Ia(e):(dt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ey extends E4{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return qc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return qc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return qc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function Lz(t){return vz(t.auth,new ey(t),t.bypassAuthState)}function Bz(t){const{auth:e,user:r}=t;return dt(r,e,"internal-error"),xz(r,new ey(t),t.bypassAuthState)}async function jz(t){const{auth:e,user:r}=t;return dt(r,e,"internal-error"),gz(r,new ey(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N4{constructor(e,r,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Lz;case"linkViaPopup":case"linkViaRedirect":return jz;case"reauthViaPopup":case"reauthViaRedirect":return Bz;default:Wa(this.auth,"internal-error")}}resolve(e){Ha(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ha(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vz=new Ud(2e3,1e4);class Mc extends N4{constructor(e,r,n,i,s){super(e,r,i,s),this.provider=n,this.authWindow=null,this.pollId=null,Mc.currentPopupAction&&Mc.currentPopupAction.cancel(),Mc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return dt(e,this.auth,"internal-error"),e}async onExecution(){Ha(this.filter.length===1,"Popup operations only handle one event");const e=Zv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(ia(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ia(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Mc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ia(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Vz.get())};e()}}Mc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uz="pendingRedirect",uh=new Map;class zz extends N4{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=uh.get(this.auth._key());if(!e){try{const n=await Wz(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}uh.set(this.auth._key(),e)}return this.bypassAuthState||uh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Wz(t,e){const r=Gz(e),n=$z(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function Hz(t,e){uh.set(t._key(),e)}function $z(t){return Ia(t._redirectPersistence)}function Gz(t){return ch(Uz,t.config.apiKey,t.name)}async function Kz(t,e,r=!1){if(So(t.app))return Promise.reject(kl(t));const n=Qv(t),i=Mz(n,e),a=await new zz(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xz=10*60*1e3;class Yz{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!qz(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!D4(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(ia(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Xz&&this.cachedEventUids.clear(),this.cachedEventUids.has(KE(e))}saveEventToCache(e){this.cachedEventUids.add(KE(e)),this.lastProcessedEventTime=Date.now()}}function KE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function D4({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function qz(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return D4(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qz(t,e={}){return Fu(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jz=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Zz=/^https?/;async function eW(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Qz(t);for(const r of e)try{if(tW(r))return}catch{}Wa(t,"unauthorized-domain")}function tW(t){const e=Fx(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!Zz.test(r))return!1;if(Jz.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rW=new Ud(3e4,6e4);function XE(){const t=sa().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function nW(t){return new Promise((e,r)=>{var n,i,s;function a(){XE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{XE(),r(ia(t,"network-request-failed"))},timeout:rW.get()})}if(!((i=(n=sa().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=sa().gapi)===null||s===void 0)&&s.load)a();else{const o=cz("iframefcb");return sa()[o]=()=>{gapi.load?a():r(ia(t,"network-request-failed"))},oz(`${lz()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw fh=null,e})}let fh=null;function iW(t){return fh=fh||nW(t),fh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sW=new Ud(5e3,15e3),aW="__/auth/iframe",oW="emulator/auth/iframe",lW={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},cW=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function uW(t){const e=t.config;dt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Kv(e,oW):`https://${t.config.authDomain}/${aW}`,n={apiKey:e.apiKey,appName:t.name,v:Tu},i=cW.get(t.config.apiHost);i&&(n.eid=i);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${Pd(n).slice(1)}`}async function fW(t){const e=await iW(t),r=sa().gapi;return dt(r,t,"internal-error"),e.open({where:document.body,url:uW(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:lW,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const a=ia(t,"network-request-failed"),o=sa().setTimeout(()=>{s(a)},sW.get());function l(){sa().clearTimeout(o),i(n)}n.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dW={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},hW=500,pW=600,mW="_blank",gW="http://localhost";class YE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function xW(t,e,r,n=hW,i=pW){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},dW),{width:n.toString(),height:i.toString(),top:s,left:a}),c=ti().toLowerCase();r&&(o=h4(c)?mW:r),f4(c)&&(e=e||gW,l.scrollbars="yes");const d=Object.entries(l).reduce((p,[g,y])=>`${p}${g}=${y},`,"");if(ZU(c)&&o!=="_self")return vW(e||"",o),new YE(null);const h=window.open(e||"",o,d);dt(h,t,"popup-blocked");try{h.focus()}catch{}return new YE(h)}function vW(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yW="__/auth/handler",_W="emulator/auth/handler",EW=encodeURIComponent("fac");async function qE(t,e,r,n,i,s){dt(t.config.authDomain,t,"auth-domain-config-required"),dt(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Tu,eventId:i};if(e instanceof w4){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",v9(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries({}))a[d]=h}if(e instanceof zd){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(a.scopes=d.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const d of Object.keys(o))o[d]===void 0&&delete o[d];const l=await t._getAppCheckToken(),c=l?`#${EW}=${encodeURIComponent(l)}`:"";return`${wW(t)}?${Pd(o).slice(1)}${c}`}function wW({config:t}){return t.emulator?Kv(t,_W):`https://${t.authDomain}/${yW}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tg="webStorageSupport";class TW{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=C4,this._completeRedirectFn=Kz,this._overrideRedirectResult=Hz}async _openPopup(e,r,n,i){var s;Ha((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await qE(e,r,n,Fx(),i);return xW(e,a,Zv())}async _openRedirect(e,r,n,i){await this._originValidation(e);const s=await qE(e,r,n,Fx(),i);return kz(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:s}=this.eventManagers[r];return i?Promise.resolve(i):(Ha(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await fW(e),n=new Yz(e);return r.register("authEvent",i=>(dt(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(tg,{type:tg},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[tg];a!==void 0&&r(!!a),Wa(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=eW(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return v4()||d4()||qv()}}const SW=TW;var QE="@firebase/auth",JE="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AW{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){dt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kW(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function CW(t){ou(new Bl("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;dt(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:y4(t)},c=new sz(n,i,s,l);return fz(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),ou(new Bl("auth-internal",e=>{const r=Qv(e.getProvider("auth").getImmediate());return(n=>new AW(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Mo(QE,JE,kW(t)),Mo(QE,JE,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FW=5*60,IW=Ck("authIdTokenMaxAge")||FW;let ZE=null;const bW=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>IW)return;const i=r==null?void 0:r.token;ZE!==i&&(ZE=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function RW(t=Rk()){const e=pv(t,"auth");if(e.isInitialized())return e.getImmediate();const r=uz(t,{popupRedirectResolver:SW,persistence:[Oz,Tz,C4]}),n=Ck("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const a=bW(s.toString());_z(r,a,()=>a(r.currentUser)),yz(r,o=>a(o))}}const i=Ak("auth");return i&&dz(r,`http://${i}`),r}function NW(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}az({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const s=ia("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",NW().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});CW("Browser");const DW={apiKey:"AIzaSyAZZ0804o11q-hS6p7XJZNK_FPGJgXpmPc",authDomain:"finance-automation-b28e8.firebaseapp.com",projectId:"finance-automation-b28e8",storageBucket:"finance-automation-b28e8.firebasestorage.app",messagingSenderId:"832501526859",appId:"1:832501526859:web:3a64f40f9db732af1b78ce"},P4=bk(DW),ty=gU(P4);RW(P4);const rg=async(t,e)=>{try{return await DU(jv(ty,"appState",t),{masterData:e.masterData||[],ledgerEntries:e.ledgerEntries||[],receipts:e.receipts||[],creditNotes:e.creditNotes||[],openingBalances:e.openingBalances||{},mailerImages:e.mailerImages||{},mailerLogo:e.mailerLogo||null,companyConfig:e.companyConfig||{},nextInvoiceNo:e.nextInvoiceNo||1,nextCombineNo:e.nextCombineNo||1,nextReceiptNo:e.nextReceiptNo||1,nextCreditNoteNo:e.nextCreditNoteNo||1,invoiceValues:e.invoiceValues||{},notifications:e.notifications||[],whatsappSettings:e.whatsappSettings||{},partyMaster:e.partyMaster||[],followups:e.followups||[],updatedAt:new Date().toISOString()}),!0}catch(r){return console.error("Error saving app state:",r),!1}},ew=async t=>{try{const e=await NU(jv(ty,"appState",t));return e.exists()?e.data():null}catch(e){return console.error("Error loading app state:",e),null}},PW=(t,e)=>{const r=jv(ty,"appState",t);return PU(r,n=>{n.exists()&&e(n.data())},n=>{console.error("Error in real-time listener:",n)})},ft=t=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2,maximumFractionDigits:2}).format(t||0),Ut=t=>""+new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t||0),yr=t=>{if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return t;const r=e.getDate().toString().padStart(2,"0"),n=e.toLocaleString("en-US",{month:"short"}),i=e.getFullYear();return`${r}-${n}-${i}`},OW=t=>{if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return t;const r=e.getDate(),n=e.toLocaleString("en-US",{month:"short"}),i=e.getFullYear();return`${r}${(a=>{if(a>3&&a<21)return"th";switch(a%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}})(r)} ${n}, ${i}`},MW=t=>{const e=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],r=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];if(t===0)return"Zero";const n=l=>l<20?e[l]:l<100?r[Math.floor(l/10)]+(l%10?" "+e[l%10]:""):e[Math.floor(l/100)]+" Hundred"+(l%100?" "+n(l%100):""),i=l=>l<1e3?n(l):l<1e5?n(Math.floor(l/1e3))+" Thousand"+(l%1e3?" "+n(l%1e3):""):l<1e7?n(Math.floor(l/1e5))+" Lakh"+(l%1e5?" "+i(l%1e5):""):n(Math.floor(l/1e7))+" Crore"+(l%1e7?" "+i(l%1e7):""),s=Math.floor(t),a=Math.round((t-s)*100);let o="INR "+i(s);return a>0&&(o+=" and "+i(a)+" Paise"),o+" Only"},LW=t=>{if(!t)return"";const e=/[\w.-]+@[\w.-]+\.\w+/g,r=t.match(e);return r?r[0]:""},BW=t=>({Approved:{bg:"#DCFCE7",text:"#166534",border:"#86EFAC"},Created:{bg:"#DBEAFE",text:"#1E40AF",border:"#93C5FD"},"Need Edits":{bg:"#FEE2E2",text:"#991B1B",border:"#FCA5A5"},Paid:{bg:"#D1FAE5",text:"#065F46",border:"#6EE7B7"},Individual:{bg:"#E0E7FF",text:"#3730A3",border:"#A5B4FC"},Combined:{bg:"#F3E8FF",text:"#6B21A8",border:"#DDD6FE"},Yes:{bg:"#DCFCE7",text:"#166534",border:"#86EFAC"},No:{bg:"#FEF3C7",text:"#92400E",border:"#FCD34D"},"Not Yet":{bg:"#F1F5F9",text:"#475569",border:"#CBD5E1"},Pending:{bg:"#FEF3C7",text:"#92400E",border:"#FCD34D"},Sent:{bg:"#D1FAE5",text:"#065F46",border:"#6EE7B7"}})[t]||{bg:"#F1F5F9",text:"#475569",border:"#CBD5E1"},ng=({status:t,small:e=!1})=>{const r=BW(t);return f.jsx("span",{style:{display:"inline-flex",alignItems:"center",padding:e?"2px 8px":"4px 12px",borderRadius:"6px",fontSize:e?"11px":"12px",fontWeight:"600",backgroundColor:r.bg,color:r.text,border:`1px solid ${r.border}`},children:t})},Ye=({icon:t,label:e,onClick:r,variant:n="default",disabled:i=!1,small:s=!1})=>{const o={default:{bg:"#F8FAFC",hoverBg:"#E2E8F0",text:"#475569",border:"#CBD5E1"},primary:{bg:"#2874A6",hoverBg:"#1a5276",text:"#FFFFFF",border:"#2874A6"},success:{bg:"#059669",hoverBg:"#047857",text:"#FFFFFF",border:"#059669"},warning:{bg:"#D97706",hoverBg:"#B45309",text:"#FFFFFF",border:"#D97706"},danger:{bg:"#DC2626",hoverBg:"#B91C1C",text:"#FFFFFF",border:"#DC2626"},brand:{bg:"#2874A6",hoverBg:"#1a5276",text:"#FFFFFF",border:"#2874A6"},purple:{bg:"#7C3AED",hoverBg:"#6D28D9",text:"#FFFFFF",border:"#7C3AED"}}[n];return f.jsxs("button",{onClick:r,disabled:i,title:e,style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:s?"5px 10px":"8px 14px",borderRadius:"6px",fontSize:s?"11px":"13px",fontWeight:"600",backgroundColor:i?"#F1F5F9":o.bg,color:i?"#94A3B8":o.text,border:`1px solid ${i?"#E2E8F0":o.border}`,cursor:i?"not-allowed":"pointer",transition:"all 0.15s ease",whiteSpace:"nowrap",opacity:i?.6:1},onMouseEnter:l=>!i&&(l.target.style.backgroundColor=o.hoverBg),onMouseLeave:l=>!i&&(l.target.style.backgroundColor=o.bg),children:[t&&f.jsx(t,{size:s?14:16}),e&&f.jsx("span",{children:e})]})},_r=({label:t,type:e="text",value:r,onChange:n,placeholder:i,disabled:s,small:a})=>f.jsxs("div",{style:{marginBottom:a?"12px":"16px"},children:[t&&f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:t}),f.jsx("input",{type:e,value:r,onChange:n,placeholder:i,disabled:s,style:{width:"100%",padding:a?"8px 12px":"10px 14px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:a?"13px":"14px",backgroundColor:s?"#F9FAFB":"#FFFFFF",boxSizing:"border-box"}})]}),W0=({label:t,value:e,onChange:r,options:n,small:i})=>f.jsxs("div",{style:{marginBottom:i?"12px":"16px"},children:[t&&f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:t}),f.jsx("select",{value:e,onChange:r,style:{width:"100%",padding:i?"8px 12px":"10px 14px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:i?"13px":"14px",backgroundColor:"#FFFFFF",boxSizing:"border-box"},children:n.map(s=>f.jsx("option",{value:s.value,children:s.label},s.value))})]}),Tn=({title:t,children:e,actions:r,noPadding:n=!1})=>f.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",boxShadow:"0 2px 8px rgba(0,0,0,0.06)",overflow:"hidden"},children:[t&&f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"14px 20px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FAFBFC"},children:[f.jsx("h3",{style:{margin:0,fontSize:"15px",fontWeight:"700",color:"#1E293B"},children:t}),r&&f.jsx("div",{style:{display:"flex",gap:"10px"},children:r})]}),f.jsx("div",{style:{padding:n?0:"20px"},children:e})]}),Sn=({isOpen:t,onClose:e,title:r,children:n,width:i="500px"})=>t?f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(15, 23, 42, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(4px)"},onClick:e,children:f.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"16px",width:i,maxWidth:"95vw",maxHeight:"90vh",overflow:"hidden",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},onClick:s=>s.stopPropagation(),children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FAFBFC"},children:[f.jsx("h2",{style:{margin:0,fontSize:"16px",fontWeight:"700",color:"#1E293B"},children:r}),f.jsx("button",{onClick:e,style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748B"},children:f.jsx(fl,{size:20})})]}),f.jsx("div",{style:{padding:"20px",maxHeight:"calc(90vh - 100px)",overflowY:"auto"},children:n})]})}):null;function jW(){const[t,e]=ye.useState(()=>{const m=localStorage.getItem("financeAppLogin");return m?JSON.parse(m).isLoggedIn:!1}),[r,n]=ye.useState(()=>{const m=localStorage.getItem("financeAppLogin");return m?JSON.parse(m).userRole:null}),[i,s]=ye.useState({username:"",password:""}),[a,o]=ye.useState(""),[l,c]=ye.useState(!1),[d,h]=ye.useState(!1),[p,g]=ye.useState(null),[y,x]=ye.useState({finance:"finance123",director:"director123"}),[E,T]=ye.useState(!1),[A,_]=ye.useState(!1),[P,W]=ye.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[j,w]=ye.useState(""),F={finance:{role:"finance",name:"Finance Team"},director:{role:"director",name:"Director"}};ye.useEffect(()=>{(async()=>{try{const C=await ew("indreesh-media");C&&C.userPasswords&&(x(C.userPasswords),console.log("Passwords loaded from Firebase"))}catch(C){console.error("Error loading passwords:",C)}T(!0)})()},[]);const[S,b]=ye.useState({name:"Indreesh Media LLP",brand:"JAC",address:"A-1701 Sweet Home CHS LTD, SVP, Plot No: 24",addressLine2:"Andheri West, Nr Last Bus St",city:"Mumbai-400053",gstin:"27AAIFI6351A1ZM",stateCode:"27",stateName:"Maharashtra",email:"alliances@mediabrief.com",phone:"+91 7021911036",website:"www.mediabrief.com",pan:"AAIFI6351A",bank:{name:"Axis Bank",account:"921020009075531",branch:"Andheri",ifsc:"UTIB0000020",holder:"Indreesh Media LLP"},invoicePrefix:"MB/2025-26/",hsnCode:"998365",gstRate:18}),[N,D]=ye.useState("master"),[R,He]=ye.useState(!1),[ve,Re]=ye.useState([]),[Ae,_e]=ye.useState([]),[Z,Ce]=ye.useState([]),[Be,U]=ye.useState([]),[H,Q]=ye.useState(null),[X,he]=ye.useState(null),[Te,Pe]=ye.useState(1),[ke,we]=ye.useState(1),[nt,G]=ye.useState(1),[Ct,xt]=ye.useState(1),[Rt,pt]=ye.useState(!1),[$e,qt]=ye.useState(!1),[wn,hn]=ye.useState(!1),[vi,Ki]=ye.useState(!1),[yi,Nr]=ye.useState(!1),[_i,zt]=ye.useState(!1),[wr,Zt]=ye.useState(!1),[ni,ut]=ye.useState(!1),[sr,Tr]=ye.useState(!1),[gr,ii]=ye.useState(!1),[qa,ua]=ye.useState(!1),[ae,Sr]=ye.useState(null),[ds,Qa]=ye.useState("reply"),[Xi,fa]=ye.useState(""),[Ei,On]=ye.useState(""),[sn,da]=ye.useState({fromDate:"2020-01-01",toDate:new Date().toISOString().split("T")[0]}),[ha,pa]=ye.useState(""),[Mn,Kr]=ye.useState("open"),[rr,Ln]=ye.useState({party:"",invoiceStatus:"",receiptStatus:"",invoiceType:"",searchText:""}),[Bn,hs]=ye.useState([]),[Iu,I]=ye.useState(!1),[V,M]=ye.useState([]),[L,z]=ye.useState(!1),[B,oe]=ye.useState(null),[fe,se]=ye.useState({date:new Date().toISOString().split("T")[0],notes:"",nextFollowupDate:"",status:"Pending"}),[re,le]=ye.useState({enabled:!1,financePhone:"",financeApiKey:"",directorPhone:"",directorApiKey:""}),[pe,Oe]=ye.useState({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),[Le,be]=ye.useState({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]}),[ze,tt]=ye.useState({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1}),[Mt,Nt]=ye.useState(null),[Ft,si]=ye.useState(new Set),[Xr,wi]=ye.useState({}),[Yr,ps]=ye.useState(null),[qr,Vs]=ye.useState(null),[Zl,el]=ye.useState(!1),[Ti,ec]=ye.useState({}),[ai,tl]=ye.useState({partyName:"",amount:"",type:"Dr"}),[Us,ms]=ye.useState({}),[ar,ma]=ye.useState({}),[tc,rl]=ye.useState(!1),[Qt,Ja]=ye.useState(new Set),[lt,gs]=ye.useState({party:"",billStatus:"",invoiceStatus:"",mailingStatus:"",invoiceType:"",combinationCode:"",searchText:""}),[xr,ga]=ye.useState({amount:"",date:new Date().toISOString().split("T")[0],mode:"Bank",tds:"",discount:"",narration:""}),Hd=ye.useRef(null),$d=ye.useRef(null),bu=ye.useRef(null),Gd=ye.useRef(null),Za=ye.useRef(null),xs=ye.useRef(null),eo=ye.useRef(null),Ru=ye.useRef(null),Nu=ye.useRef(null),Dr=ye.useMemo(()=>Array.isArray(ve)?ve:[],[ve]),Ni=ye.useMemo(()=>Array.isArray(Ae)?Ae:[],[Ae]),rc=ye.useMemo(()=>Array.isArray(Z)?Z:[],[Z]),nc=ye.useMemo(()=>Array.isArray(Be)?Be:[],[Be]),vs=ye.useMemo(()=>Array.isArray(Bn)?Bn:[],[Bn]),ic=ye.useMemo(()=>Array.isArray(V)?V:[],[V]),Qr=ye.useMemo(()=>ar&&typeof ar=="object"&&!Array.isArray(ar)?ar:{},[ar]),ys=ye.useMemo(()=>Ti&&typeof Ti=="object"&&!Array.isArray(Ti)?Ti:{},[Ti]),er=(m,C)=>!m||!C?!1:m.trim().toUpperCase()===C.trim().toUpperCase(),_s=ye.useCallback(m=>{if(!m)return"";const C=m.toUpperCase().trim();return C.includes("MAHARASHTRA")||C==="MH"?"MAHARASHTRA":C.includes("DELHI")||C==="DL"||C.includes("NEW DELHI")?"DELHI":C.includes("KARNATAKA")||C==="KA"||C.includes("BANGALORE")||C.includes("BENGALURU")?"KARNATAKA":C.includes("TAMIL")||C==="TN"||C.includes("CHENNAI")?"TAMIL NADU":C.includes("TELANGANA")||C==="TG"||C==="TS"||C.includes("HYDERABAD")?"TELANGANA":C.includes("UTTAR PRADESH")||C==="UP"||C.includes("NOIDA")||C.includes("LUCKNOW")?"UTTAR PRADESH":C.includes("WEST BENGAL")||C==="WB"||C.includes("KOLKATA")?"WEST BENGAL":C.includes("GUJARAT")||C==="GJ"||C.includes("AHMEDABAD")?"GUJARAT":C.includes("RAJASTHAN")||C==="RJ"||C.includes("JAIPUR")?"RAJASTHAN":C.includes("PUNJAB")||C==="PB"?"PUNJAB":C.includes("HARYANA")||C==="HR"||C.includes("GURGAON")||C.includes("GURUGRAM")?"HARYANA":C.includes("MADHYA PRADESH")||C==="MP"||C.includes("BHOPAL")?"MADHYA PRADESH":C.includes("ANDHRA")||C==="AP"?"ANDHRA PRADESH":C.includes("KERALA")||C==="KL"?"KERALA":C.includes("ODISHA")||C.includes("ORISSA")||C==="OR"||C==="OD"?"ODISHA":C.includes("BIHAR")||C==="BR"?"BIHAR":C.includes("JHARKHAND")||C==="JH"?"JHARKHAND":C.includes("ASSAM")||C==="AS"?"ASSAM":C.includes("CHHATTISGARH")||C==="CG"?"CHHATTISGARH":C.includes("GOA")||C==="GA"?"GOA":C.includes("HIMACHAL")||C==="HP"?"HIMACHAL PRADESH":C.includes("JAMMU")||C==="JK"?"JAMMU AND KASHMIR":C.includes("UTTARAKHAND")||C.includes("UTTARANCHAL")||C==="UK"?"UTTARAKHAND":C.includes("MUMBAI")?"MAHARASHTRA":C.includes("CHANDIGARH")?"CHANDIGARH":C},[]),xa=ye.useCallback((m,C)=>{var q;if(!m)return"";const Y=_s(C),ee=m.trim().toUpperCase(),K=`${ee}|${Y}`;if((q=Qr[K])!=null&&q.gstin)return Qr[K].gstin;for(const ne in Qr){const J=Qr[ne];if((J.partyName||"").trim().toUpperCase()===ee&&J.normalizedState===Y)return J.gstin||""}for(const ne in Qr){const J=Qr[ne];if((J.partyName||"").trim().toUpperCase()===ee&&J.gstin)return J.gstin}return""},[Qr,_s]),va=ye.useCallback((m,C)=>{var q;if(!m)return"";const Y=_s(C),ee=m.trim().toUpperCase(),K=`${ee}|${Y}`;if((q=Qr[K])!=null&&q.address)return Qr[K].address;for(const ne in Qr){const J=Qr[ne];if((J.partyName||"").trim().toUpperCase()===ee&&J.normalizedState===Y)return J.address||""}for(const ne in Qr){const J=Qr[ne];if((J.partyName||"").trim().toUpperCase()===ee&&J.address)return J.address}return""},[Qr,_s]),nl=ye.useRef(!1),Es=ye.useRef(null),or=async()=>{c(!0);try{const m=await ew("indreesh-media");m&&(Array.isArray(m.masterData)&&Re(m.masterData),Array.isArray(m.ledgerEntries)&&_e(m.ledgerEntries),Array.isArray(m.receipts)&&Ce(m.receipts),Array.isArray(m.creditNotes)&&U(m.creditNotes),Array.isArray(m.notifications)&&hs(m.notifications),Array.isArray(m.followups)&&M(m.followups),m.openingBalances&&typeof m.openingBalances=="object"&&!Array.isArray(m.openingBalances)&&ec(m.openingBalances),m.mailerImages&&typeof m.mailerImages=="object"&&!Array.isArray(m.mailerImages)&&wi(m.mailerImages),m.partyMaster&&typeof m.partyMaster=="object"&&!Array.isArray(m.partyMaster)&&ma(m.partyMaster),m.userPasswords&&typeof m.userPasswords=="object"&&!Array.isArray(m.userPasswords)&&x(m.userPasswords),m.mailerLogo&&ps(m.mailerLogo),m.companyConfig&&b(C=>({...C,...m.companyConfig,name:"Indreesh Media LLP",bank:{...m.companyConfig.bank||C.bank,holder:"Indreesh Media LLP"}})),m.nextInvoiceNo&&Pe(m.nextInvoiceNo),m.nextCombineNo&&we(m.nextCombineNo),m.nextReceiptNo&&G(m.nextReceiptNo),m.nextCreditNoteNo&&xt(m.nextCreditNoteNo),m.invoiceValues&&ms(m.invoiceValues),m.whatsappSettings&&le(C=>({...C,...m.whatsappSettings})),console.log("Data loaded from Firebase"))}catch(m){console.error("Error loading data:",m)}c(!1)},Kd=ye.useCallback(async()=>{h(!0);try{await rg("indreesh-media",{masterData:ve,ledgerEntries:Ae,receipts:Z,creditNotes:Be,openingBalances:Ti,mailerImages:Xr,mailerLogo:Yr,companyConfig:S,nextInvoiceNo:Te,nextCombineNo:ke,nextReceiptNo:nt,nextCreditNoteNo:Ct,invoiceValues:Us,notifications:Bn,whatsappSettings:re,partyMaster:ar,followups:V,userPasswords:y}),g(new Date),console.log("Data saved to Firebase")}catch(m){console.error("Error saving data:",m)}h(!1)},[ve,Ae,Z,Be,Ti,Xr,Yr,S,Te,ke,nt,Ct,Us,Bn,re,ar,V,y]);ye.useEffect(()=>{if(t&&!nl.current)return eo.current&&clearTimeout(eo.current),eo.current=setTimeout(()=>{nl.current||Kd()},1e3),()=>{eo.current&&clearTimeout(eo.current)}},[ve,Ae,Z,Be,Ti,Xr,Yr,S,Te,ke,nt,Ct,Us,Bn,re,ar,V,y,t]);const Jp=async(m,C,Y)=>{if(!re.enabled){console.log("WhatsApp notifications not enabled");return}Y==="finance"&&re.financePhone&&re.financeApiKey?to(re.financePhone,re.financeApiKey,m,C):Y==="director"&&re.directorPhone&&re.directorApiKey?to(re.directorPhone,re.directorApiKey,m,C):Y==="all"&&(re.financePhone&&re.financeApiKey&&to(re.financePhone,re.financeApiKey,m,C),re.directorPhone&&re.directorApiKey&&to(re.directorPhone,re.directorApiKey,m,C))},to=async(m,C,Y,ee)=>{try{const q=`*${{upload:" DATA UPLOAD",invoice:" INVOICE",approval:" APPROVED",edit:" EDIT REQUIRED",receipt:" PAYMENT",info:" UPDATE"}[Y]||" NOTIFICATION"}*

${ee}

_${S.name}_
_${new Date().toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})}_`,ne=`https://api.callmebot.com/whatsapp.php?phone=${m}&text=${encodeURIComponent(q)}&apikey=${C}`;fetch(ne,{mode:"no-cors"}).then(()=>console.log("WhatsApp notification sent to:",m)).catch(J=>console.log("WhatsApp send attempted:",m))}catch(K){console.error("Failed to send WhatsApp notification:",K)}},Du=(m,C)=>{if(!m||!C){alert("Please enter phone number and API key first");return}to(m,C,"info","Test notification from Indreesh Media LLP. WhatsApp notifications are working!"),alert("Test message sent! Check your WhatsApp.")},ws=(m,C,Y="all")=>{const ee={id:Date.now()+Math.random(),type:m,message:C,forRole:Y,createdAt:new Date().toISOString(),createdBy:r,read:{finance:!1,director:!1}};hs(K=>[ee,...K].slice(0,50)),Jp(m,C,Y)},sc=m=>{hs(C=>(Array.isArray(C)?C:[]).map(ee=>ee.id===m?{...ee,read:{...ee.read,[r]:!0}}:ee))},Xd=()=>{hs(m=>(Array.isArray(m)?m:[]).map(Y=>({...Y,read:{...Y.read,[r]:!0}})))},Ts=()=>{hs([])},il=ye.useMemo(()=>vs.filter(m=>m.forRole==="all"||m.forRole===r||m.createdBy!==r).map(m=>({...m,read:m.read||{finance:!1,director:!1}})),[vs,r]),Ss=ye.useMemo(()=>r?il.filter(m=>!(m.read&&m.read[r])).length:0,[il,r]),ro=async()=>{const m=F[i.username.toLowerCase()],C=y[i.username.toLowerCase()];m&&C===i.password?(e(!0),n(m.role),localStorage.setItem("financeAppLogin",JSON.stringify({isLoggedIn:!0,userRole:m.role})),o(""),s({username:"",password:""}),await or()):o("Invalid username or password")},ac=async()=>{if(!P.currentPassword||!P.newPassword||!P.confirmPassword){w("Please fill all fields");return}const m=r==="director"?"director":"finance";if(y[m]!==P.currentPassword){w("Current password is incorrect");return}if(P.newPassword!==P.confirmPassword){w("New passwords do not match");return}if(P.newPassword.length<6){w("Password must be at least 6 characters");return}const C={...y,[m]:P.newPassword};x(C);try{await rg("indreesh-media",{masterData:ve,ledgerEntries:Ae,receipts:Z,creditNotes:Be,openingBalances:Ti,mailerImages:Xr,mailerLogo:Yr,companyConfig:S,nextInvoiceNo:Te,nextCombineNo:ke,nextReceiptNo:nt,nextCreditNoteNo:Ct,invoiceValues:Us,notifications:Bn,whatsappSettings:re,partyMaster:ar,followups:V,userPasswords:C}),console.log("Password saved to Firebase")}catch(Y){console.error("Error saving password:",Y),w("Failed to save password. Please try again.");return}_(!1),W({currentPassword:"",newPassword:"",confirmPassword:""}),w(""),alert(" Password changed successfully!")},Pu=()=>{Kd(),e(!1),n(null),D("master"),localStorage.removeItem("financeAppLogin")};ye.useEffect(()=>{const m=localStorage.getItem("financeAppLogin");if(m){const{isLoggedIn:C}=JSON.parse(m);C&&or()}},[]),ye.useEffect(()=>{if(!t){Es.current&&(Es.current(),Es.current=null);return}return Es.current=PW("indreesh-media",m=>{m&&(nl.current=!0,Array.isArray(m.masterData)&&Re(m.masterData),Array.isArray(m.ledgerEntries)&&_e(m.ledgerEntries),Array.isArray(m.receipts)&&Ce(m.receipts),Array.isArray(m.creditNotes)&&U(m.creditNotes),Array.isArray(m.notifications)&&hs(m.notifications),Array.isArray(m.followups)&&M(m.followups),m.openingBalances&&typeof m.openingBalances=="object"&&!Array.isArray(m.openingBalances)&&ec(m.openingBalances),m.mailerImages&&typeof m.mailerImages=="object"&&!Array.isArray(m.mailerImages)&&wi(m.mailerImages),m.partyMaster&&typeof m.partyMaster=="object"&&!Array.isArray(m.partyMaster)&&ma(m.partyMaster),m.userPasswords&&typeof m.userPasswords=="object"&&!Array.isArray(m.userPasswords)&&x(m.userPasswords),m.mailerLogo&&ps(m.mailerLogo),m.companyConfig&&b(C=>({...C,...m.companyConfig,name:"Indreesh Media LLP",bank:{...m.companyConfig.bank||C.bank,holder:"Indreesh Media LLP"}})),m.nextInvoiceNo&&Pe(m.nextInvoiceNo),m.nextCombineNo&&we(m.nextCombineNo),m.nextReceiptNo&&G(m.nextReceiptNo),m.nextCreditNoteNo&&xt(m.nextCreditNoteNo),m.invoiceValues&&ms(m.invoiceValues),m.whatsappSettings&&le(C=>({...C,...m.whatsappSettings})),setTimeout(()=>{nl.current=!1},500),console.log("Real-time sync: Data updated from Firebase"))}),()=>{Es.current&&(Es.current(),Es.current=null)}},[t]);const Ht=r==="finance",jn=r==="director",ya=ye.useMemo(()=>{const m=new Set;return Dr.forEach(C=>{C.partyName&&m.add(C.partyName)}),Object.values(Qr).forEach(C=>{C.partyName&&m.add(C.partyName)}),Ni.forEach(C=>{C.partyName&&m.add(C.partyName)}),Object.keys(ys).forEach(C=>{C&&m.add(C)}),Array.from(m).filter(Boolean).sort()},[Dr,Qr,Ni,ys]),As=ye.useMemo(()=>{const m=[],C=new Set,Y=new Set,ee=K=>{if(!K)return"";const q=K.toUpperCase().trim();return q.includes("MAHARASHTRA")||q==="MH"||q.includes("MUMBAI")?"MAHARASHTRA":q.includes("DELHI")||q==="DL"||q.includes("NEW DELHI")?"DELHI":q.includes("KARNATAKA")||q==="KA"||q.includes("BANGALORE")||q.includes("BENGALURU")?"KARNATAKA":q.includes("TAMIL")||q==="TN"||q.includes("CHENNAI")?"TAMIL NADU":q.includes("TELANGANA")||q==="TG"||q==="TS"||q.includes("HYDERABAD")?"TELANGANA":q.includes("UTTAR PRADESH")||q==="UP"||q.includes("NOIDA")||q.includes("LUCKNOW")?"UTTAR PRADESH":q.includes("WEST BENGAL")||q==="WB"||q.includes("KOLKATA")?"WEST BENGAL":q.includes("GUJARAT")||q==="GJ"||q.includes("AHMEDABAD")?"GUJARAT":q.includes("RAJASTHAN")||q==="RJ"||q.includes("JAIPUR")?"RAJASTHAN":q.includes("PUNJAB")||q==="PB"?"PUNJAB":q.includes("HARYANA")||q==="HR"||q.includes("GURGAON")||q.includes("GURUGRAM")?"HARYANA":q.includes("MADHYA PRADESH")||q==="MP"||q.includes("BHOPAL")?"MADHYA PRADESH":q.includes("ANDHRA")||q==="AP"?"ANDHRA PRADESH":q.includes("KERALA")||q==="KL"?"KERALA":q.includes("ODISHA")||q.includes("ORISSA")||q==="OR"||q==="OD"?"ODISHA":q.includes("BIHAR")||q==="BR"?"BIHAR":q.includes("JHARKHAND")||q==="JH"?"JHARKHAND":q.includes("ASSAM")||q==="AS"?"ASSAM":q.includes("CHHATTISGARH")||q==="CG"?"CHHATTISGARH":q.includes("GOA")||q==="GA"?"GOA":q.includes("HIMACHAL")||q==="HP"?"HIMACHAL PRADESH":q.includes("JAMMU")||q==="JK"?"JAMMU AND KASHMIR":q.includes("UTTARAKHAND")||q.includes("UTTARANCHAL")||q==="UK"?"UTTARAKHAND":q.includes("CHANDIGARH")?"CHANDIGARH":q};return Object.entries(Qr).forEach(([K,q])=>{if(q.partyName){const ne=q.normalizedState||ee(q.stateName),J=q.partyName.trim().toUpperCase(),Se=`${J}|${ne}`;C.has(Se)||(C.add(Se),Y.add(J),m.push({partyName:q.partyName,partyNameUpper:J,state:q.stateName||"",normalizedState:ne,gstin:q.gstin||"",address:q.address||"",fromPartyMaster:!0}))}}),Dr.forEach(K=>{if(K.partyName){const q=K.partyName.trim().toUpperCase();if(!Y.has(q)){Y.add(q);const ne=ee(K.statePartyDetails);m.push({partyName:K.partyName,partyNameUpper:q,state:K.statePartyDetails||"",normalizedState:ne,gstin:"",address:"",fromPartyMaster:!1})}}}),Ni.forEach(K=>{if(K.partyName){const q=K.partyName.trim().toUpperCase();if(!Y.has(q)){Y.add(q);const ne=ee(K.state||K.statePartyDetails||"");m.push({partyName:K.partyName,partyNameUpper:q,state:K.state||K.statePartyDetails||"",normalizedState:ne,gstin:"",address:"",fromPartyMaster:!1})}}}),Object.keys(ys).forEach(K=>{const q=K.trim().toUpperCase();K&&!Y.has(q)&&(Y.add(q),m.push({partyName:K,partyNameUpper:q,state:"",normalizedState:"",gstin:"",address:"",fromPartyMaster:!1}))}),m.sort((K,q)=>K.partyName.localeCompare(q.partyName))},[Dr,Qr,Ni,ys]);ye.useMemo(()=>[...new Set(Dr.filter(C=>C.combinationCode&&C.combinationCode!=="NA").map(C=>C.combinationCode))].sort((C,Y)=>parseInt(C)-parseInt(Y)),[Dr]);const oc=ye.useMemo(()=>Dr.filter(m=>{var C,Y,ee,K,q,ne;if(lt.party&&m.partyName!==lt.party||lt.billStatus&&m.toBeBilled!==lt.billStatus||lt.invoiceStatus&&(lt.invoiceStatus==="Generated"&&!m.invoiceGenerated||lt.invoiceStatus==="Not Generated"&&m.invoiceGenerated||lt.invoiceStatus==="Paid"&&m.invoiceStatus!=="Paid")||lt.mailingStatus&&m.mailingSent!==lt.mailingStatus||lt.invoiceType&&m.invoiceType!==lt.invoiceType||lt.combinationCode&&m.combinationCode!==lt.combinationCode)return!1;if(lt.searchText){const J=lt.searchText.toLowerCase();if(!(((C=m.senderName)==null?void 0:C.toLowerCase().includes(J))||((Y=m.subject)==null?void 0:Y.toLowerCase().includes(J))||((ee=m.campaignName)==null?void 0:ee.toLowerCase().includes(J))||((K=m.invoiceNo)==null?void 0:K.toLowerCase().includes(J))||((q=m.partyName)==null?void 0:q.toLowerCase().includes(J))||((ne=m.emailId)==null?void 0:ne.toLowerCase().includes(J))))return!1}return!0}),[Dr,lt]);ye.useMemo(()=>{const m={};return oc.forEach(C=>{m[C.partyName]||(m[C.partyName]=[]),m[C.partyName].push(C)}),Object.keys(m).forEach(C=>{m[C].sort((Y,ee)=>Y.toBeBilled==="Yes"&&ee.toBeBilled!=="Yes"?-1:Y.toBeBilled!=="Yes"&&ee.toBeBilled==="Yes"?1:0)}),m},[oc]),ye.useMemo(()=>{if(!H)return[];const m=ys[H]||0;let C=m;const Y=Ni.filter(ee=>er(ee.partyName,H)).sort((ee,K)=>new Date(ee.date)-new Date(K.date)).map(ee=>(C=C+ee.debit-ee.credit,{...ee,balance:C}));return m!==0?[{id:"opening",date:"",particulars:"Opening Balance",debit:m>0?m:0,credit:m<0?Math.abs(m):0,balance:m,isOpening:!0},...Y]:Y},[H,Ni,ys]);const sl=m=>Dr.filter(C=>er(C.partyName,m)&&C.toBeBilled==="Yes"&&!C.invoiceGenerated&&C.invoiceAmount),Yd=m=>!m||m==="NA"?!1:Dr.some(C=>C.combinationCode===m&&C.mailingSent==="Yes"),zs=m=>m.invoiceType==="Combined"&&m.combinationCode!=="NA"?Dr.filter(C=>C.combinationCode===m.combinationCode):[m],Ou=()=>{gs({party:"",billStatus:"",invoiceStatus:"",mailingStatus:"",invoiceType:"",combinationCode:"",searchText:""})},al=Object.values(lt).some(m=>m!==""),no=m=>{const C=[];return m.emailId&&C.push(m.emailId),m.additionalEmails&&m.additionalEmails.length>0&&C.push(...m.additionalEmails),C},lc=(m,C)=>{!C||!C.includes("@")||Re(Y=>Y.map(ee=>{if(ee.id===m){const K=ee.additionalEmails||[];if(!K.includes(C)&&C!==ee.emailId)return{...ee,additionalEmails:[...K,C]}}return ee}))},qd=(m,C)=>{Re(Y=>Y.map(ee=>ee.id===m?{...ee,additionalEmails:(ee.additionalEmails||[]).filter(K=>K!==C)}:ee))},Qd=m=>{Sr(m),On(m.editComments||m.approvalRemarks||""),tt({particularsApproved:m.particularsApproved||!1,emailApproved:m.emailApproved||!1,invoiceTypeApproved:m.invoiceTypeApproved||!1}),Zt(!0)},_a=()=>{if(!ae)return;if(!ze.particularsApproved||!ze.emailApproved||!ze.invoiceTypeApproved){alert("Please confirm all approval checkboxes before approving.");return}const m={invoiceStatus:"Approved",approvalRemarks:Ei.trim()||"",editComments:"",particularsApproved:!0,emailApproved:!0,invoiceTypeApproved:!0,approvedBy:r,approvedDate:new Date().toISOString()};let C=[];ae.invoiceType==="Combined"&&ae.combinationCode!=="NA"?(C=ve.filter(ne=>ne.combinationCode===ae.combinationCode),Re(ne=>ne.map(J=>J.combinationCode===ae.combinationCode?{...J,...m}:J))):(C=[ae],Re(ne=>ne.map(J=>J.id===ae.id?{...J,...m}:J)));const Y=parseFloat(ae.invoiceTotalAmount)||0,ee=C.map(ne=>{var J,Se;return ne.senderName||((Se=(J=ne.campaignName)==null?void 0:J.split("--")[0])==null?void 0:Se.trim())}).join(", "),K=`${ae.invoiceNo} - ${ee}`;_e(ne=>[...ne,{id:Date.now(),partyName:ae.partyName,date:ae.invoiceDate,particulars:"Promotional Trade Mailer",narration:K,debit:Y,credit:0,type:"invoice",invoiceNo:ae.invoiceNo,combinationCode:ae.combinationCode}]);const q=Ei.trim()?` | Remarks: "${Ei.trim()}"`:"";ws("approval",` Invoice ${ae.invoiceNo} has been APPROVED by Director${q} - ready for mailing`,"finance"),Zt(!1),Sr(null),tt({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1}),On(""),alert(` Invoice Approved!

The invoice is now ready for mailing.`)},Jd=()=>{if(!ae)return;const m=Ei.trim();ae.invoiceType==="Combined"&&ae.combinationCode!=="NA"?Re(Y=>Y.map(ee=>ee.combinationCode===ae.combinationCode?{...ee,invoiceStatus:"Need Edits",editComments:m,approvalRemarks:""}:ee)):Re(Y=>Y.map(ee=>ee.id===ae.id?{...ee,invoiceStatus:"Need Edits",editComments:m,approvalRemarks:""}:ee));const C=m?`: "${m}"`:"";ws("edit",` Invoice ${ae.invoiceNo} marked as NEED EDITS by Director${C}`,"finance"),Zt(!1),Sr(null),On("")},Mu=m=>{Sr(m);const C=parseFloat(m.invoiceTotalAmount)||0;Oe({amount:C.toFixed(2),tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),Tr(!0)},Zd=()=>{if(!ae||!pe.amount){alert("Please enter receipt amount");return}if(ae.invoiceStatus!=="Approved"){alert("Receipt cannot be posted. Invoice must be approved first.");return}if(!ae.isHistorical&&ae.mailingSent!=="Yes"){alert("Receipt cannot be posted. Invoice must be mailed first.");return}const m=`RCP/${new Date().getFullYear()}-${String(new Date().getFullYear()+1).slice(-2)}/${nt}`,C=parseFloat(pe.amount)||0,Y=parseFloat(pe.tds)||0,ee=parseFloat(pe.discount)||0,K=C+Y+ee,q=zs(ae),ne=q.map(Ve=>Ve.subject||Ve.senderName).join(", "),J=ne.length>50?ne.substring(0,47)+"...":ne,Se={id:Date.now(),receiptNo:m,invoiceNo:ae.invoiceNo,partyName:ae.partyName,date:pe.date,amount:C,tds:Y,discount:ee,totalCredit:K,narration:pe.narration,paymentAdvisory:pe.paymentAdvisory,mode:pe.mode,campaigns:q.map(Ve=>({senderName:Ve.senderName,subject:Ve.subject}))};Ce(Ve=>[...Ve,Se]);const ue=pe.narration||J;C>0&&_e(Ve=>[...Ve,{id:Date.now(),partyName:ae.partyName,date:pe.date,particulars:`Payment Received - ${ue}`,narration:`${ae.invoiceNo} | ${pe.mode}`,debit:0,credit:C,type:"receipt",receiptNo:m,invoiceNo:ae.invoiceNo,paymentAdvisory:pe.paymentAdvisory}]),Y>0&&_e(Ve=>[...Ve,{id:Date.now()+1,partyName:ae.partyName,date:pe.date,particulars:"TDS Deducted",narration:`Against ${ae.invoiceNo}`,debit:0,credit:Y,type:"tds",receiptNo:m,invoiceNo:ae.invoiceNo}]),ee>0&&_e(Ve=>[...Ve,{id:Date.now()+2,partyName:ae.partyName,date:pe.date,particulars:"Discount Given",narration:`Against ${ae.invoiceNo}`,debit:0,credit:ee,type:"discount",receiptNo:m,invoiceNo:ae.invoiceNo}]);const ge=parseFloat(ae.invoiceTotalAmount)||0,Ie=Be.find(Ve=>Ve.invoiceNo===ae.invoiceNo),te=Ie?Math.abs(parseFloat(Ie.totalAmount)||0):0,xe=ge-K-te<=0;ae.invoiceType==="Combined"&&ae.combinationCode!=="NA"?Re(Ve=>Ve.map(Ke=>Ke.combinationCode===ae.combinationCode?{...Ke,receiptStatus:xe?"Closed":"Received",receiptNo:m,receiptDate:pe.date}:Ke)):ae.isHistorical||Re(Ve=>Ve.map(Ke=>Ke.id===ae.id?{...Ke,receiptStatus:xe?"Closed":"Received",receiptNo:m,receiptDate:pe.date}:Ke)),G(Ve=>Ve+1),ws("receipt",` Payment received for ${ae.partyName} - Receipt ${m} - ${ft(K)}`,"director"),Tr(!1),Sr(null),Oe({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),alert(` Receipt Created!

Receipt No: ${m}
Amount: ${ft(K)}`)},Lu=m=>{Sr(m),be({amount:"",tds:"",discount:"",reason:"",date:new Date().toISOString().split("T")[0]}),ii(!0)},cc=()=>{var Ve;if(!ae||!Le.amount&&!Le.gst||!Le.reason){alert("Please enter Amount and/or GST and reason");return}const m=ae.invoiceNo.match(/(\d{4}-\d{2})/),C=m?m[1]:`${new Date().getFullYear()}-${String(new Date().getFullYear()+1).slice(-2)}`,Y=ae.invoiceNo.split("/").pop(),ee=`CN/${C}/${Y}`,K=parseFloat(Le.amount)||0,q=parseFloat(Le.gst)||0,ne=K+q,Se=((Ve=ae.statePartyDetails)==null?void 0:Ve.toUpperCase().includes("MAHARASHTRA"))?"CGST/SGST":"IGST",ue={id:Date.now(),creditNoteNo:ee,invoiceNo:ae.invoiceNo,partyName:ae.partyName,date:Le.date,amount:K,gst:q,gstType:Se,totalAmount:ne,reason:Le.reason};U(Ke=>[...Ke,ue]);const ge=parseFloat(ae.invoiceTotalAmount)||0,Ie=Z.find(Ke=>Ke.invoiceNo===ae.invoiceNo),te=Ie?parseFloat(Ie.amount)+parseFloat(Ie.tds||0)+parseFloat(Ie.discount||0):0,Xe=ne>=ge-te;ae.isHistorical||Re(Ke=>Ke.map(Qe=>Qe.invoiceNo===ae.invoiceNo?{...Qe,creditNoteNo:ee,receiptStatus:Xe?"Cancelled":Qe.receiptStatus}:Qe)),xt(Ke=>Ke+1),ii(!1),Sr(null),be({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]});let xe=` Credit Note Created!

Credit Note No: ${ee}`;K>0&&(xe+=`
Base Amount: ${ft(K)}`),q>0&&(xe+=`
${Se}: ${ft(q)}`),xe+=`
Total: ${ft(ne)}`,Xe&&(xe+=`

 Invoice fully covered by CN - marked as Cancelled`),alert(xe)},oi=m=>{var ee;const C=(ee=m.target.files)==null?void 0:ee[0];if(!C)return;const Y=new FileReader;Y.onload=K=>{Oe(q=>({...q,paymentAdvisory:K.target.result}))},Y.readAsDataURL(C),m.target.value=""},uc=m=>{Sr(m),ut(!0)},e0=()=>{if(!ae)return;const m=ae.invoiceNo;ae.invoiceType==="Combined"&&ae.combinationCode!=="NA"?Re(ee=>ee.map(K=>K.combinationCode===ae.combinationCode?{...K,invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",invoiceType:"Individual",combinationCode:"NA",mailingSent:"No",mailDate:"",editComments:"",receiptStatus:"",receiptNo:"",receiptDate:""}:K)):Re(ee=>ee.map(K=>K.id===ae.id?{...K,invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",invoiceType:"Individual",combinationCode:"NA",mailingSent:"No",mailDate:"",editComments:"",receiptStatus:"",receiptNo:"",receiptDate:""}:K)),_e(ee=>ee.filter(K=>K.invoiceNo!==m));const C=Z.filter(ee=>ee.invoiceNo===m);C.length>0&&Ce(ee=>ee.filter(K=>K.invoiceNo!==m)),ut(!1),Sr(null);const Y=C.length>0?`
${C.length} receipt(s) also deleted.`:"";alert(` Invoice ${m} deleted.${Y}

You can now regenerate the invoice.`)},io=m=>{confirm(`Delete Receipt ${m.receiptNo}?

This will also update the invoice status back to Pending.`)&&(Ce(C=>C.filter(Y=>Y.id!==m.id)),Re(C=>C.map(Y=>Y.invoiceNo===m.invoiceNo?{...Y,receiptStatus:"",receiptNo:"",receiptDate:""}:Y)),alert(` Receipt ${m.receiptNo} deleted.`))},u=m=>{confirm(`Delete Credit Note ${m.creditNoteNo}?

This will remove the CN association from the invoice.`)&&(U(C=>C.filter(Y=>Y.id!==m.id)),Re(C=>C.map(Y=>Y.invoiceNo===m.invoiceNo?{...Y,creditNoteNo:""}:Y)),alert(` Credit Note ${m.creditNoteNo} deleted.`))},v=m=>{confirm(`Delete historical entry?

Vch No: ${m.vchNo||"N/A"}
Amount: ${m.debit||m.credit}

This action cannot be undone.`)&&(_e(C=>C.filter(Y=>Y.id!==m.id)),alert(" Historical entry deleted."))},k=()=>{if(!H||!confirm(`Delete ALL historical entries for "${H}"?

This will remove all imported historical data for this party.`))return;const m=Ae.filter(C=>er(C.partyName,H)&&C.isHistorical).length;_e(C=>C.filter(Y=>!(er(Y.partyName,H)&&Y.isHistorical))),alert(` ${m} historical entries deleted for ${H}.`)},O=m=>{oe(m),se({date:new Date().toISOString().split("T")[0],notes:"",nextFollowupDate:"",status:"Pending"}),z(!0)},ie=()=>{var C,Y;if(!B)return;const m={id:Date.now(),invoiceNo:B.invoiceNo,partyName:B.partyName,invoiceDate:B.invoiceDate||B.date,invoiceAmount:B.invoiceTotalAmount||B.totalAmount,subject:((Y=(C=B.campaigns)==null?void 0:C[0])==null?void 0:Y.subject)||B.subject||"",followupDate:fe.date,notes:fe.notes,nextFollowupDate:fe.nextFollowupDate,status:fe.status};M(ee=>[...ee,m]),z(!1),oe(null),ws("followup",`Followup added for ${B.invoiceNo}`,"all"),alert(` Followup recorded for ${B.invoiceNo}`)},de=m=>{confirm("Delete this followup entry?")&&M(C=>C.filter(Y=>Y.id!==m))},We=m=>{var J,Se;const C=m.subject||((Se=(J=m.campaigns)==null?void 0:J[0])==null?void 0:Se.subject)||"",Y=m.partyName,ee=m.invoiceNo,K=ft(m.invoiceTotalAmount||m.totalAmount||0),q=yr(m.invoiceDate||m.date);return`Subject: RE: ${C} - Payment Followup for Invoice ${ee}

Dear Sir/Madam,

Greetings from ${S.name}!

This is a gentle reminder regarding the outstanding payment for:

Invoice No: ${ee}
Invoice Date: ${q}
Amount: ${K}
Party: ${Y}

We kindly request you to process the payment at the earliest. If the payment has already been made, please share the payment details for our records.

For any queries, please feel free to reach out.

Thanks & Regards,
Finance Team
${S.name}
Email: ${S.email}
Phone: ${S.phone}`},Wt=m=>{const C=We(m);navigator.clipboard.writeText(C),alert(" Followup email template copied to clipboard!")},Jr=m=>{var ee,K;const C=m.subject||((K=(ee=m.campaigns)==null?void 0:ee[0])==null?void 0:K.subject)||"",Y=encodeURIComponent(C);window.open(`https://mail.google.com/mail/u/0/#search/${Y}`,"_blank")},It=m=>{var ee;const C=(ee=m.target.files)==null?void 0:ee[0];if(!C)return;const Y=new FileReader;Y.onload=K=>{const q=Oc(K.target.result,{type:"binary"}),ne=q.SheetNames[0],J=q.Sheets[ne],Se=Pi.sheet_to_json(J),ue={};Se.forEach(ge=>{const Ie=ge["Party Name"]||ge["PARTY NAME"]||ge.PartyName||"",te=parseFloat(ge.Amount||ge.AMOUNT||ge["Invoice Amount"]||0);Ie&&te>0&&(ue[Ie.trim()]=te)}),ms(ge=>({...ge,...ue})),alert(` Loaded ${Object.keys(ue).length} party invoice values!`)},Y.readAsBinaryString(C),m.target.value=""},pn=()=>{const m=Pi.json_to_sheet([{"Party Name":"ABC Group Private Limited",Amount:5500},{"Party Name":"XYZ Media Pvt Ltd",Amount:7500}]),C=Pi.book_new();Pi.book_append_sheet(C,m,"Invoice Values"),jm(C,"Invoice_Values_Template.xlsx")},mn=m=>{var ee;const C=(ee=m.target.files)==null?void 0:ee[0];if(!C)return;const Y=new FileReader;Y.onload=K=>{const q=Oc(K.target.result,{type:"binary"}),ne=q.SheetNames[0],J=q.Sheets[ne],Se=Pi.sheet_to_json(J),ue={...ar};let ge=0;Se.forEach(Ie=>{const te=(Ie["Name of Ledger"]||Ie["Party Name"]||Ie["NAME OF LEDGER"]||Ie["PARTY NAME"]||"").trim(),Xe=(Ie["State Name"]||Ie["STATE NAME"]||Ie.State||Ie.STATE||"").trim(),xe=(Ie.Address||Ie.ADDRESS||Ie["Party Address"]||Ie["PARTY ADDRESS"]||"").trim();if(te){const Ve=_s(Xe),Ke=`${te.toUpperCase()}|${Ve}`;ue[Ke]={partyName:te,partyNameUpper:te.toUpperCase(),ledgerGroup:Ie["Ledger Group"]||Ie["LEDGER GROUP"]||"Sundry Debtors",stateName:Xe,normalizedState:Ve,gstRegType:Ie["GST Registration Type"]||Ie["GST REGISTRATION TYPE"]||"Regular",gstin:(Ie["GSTIN/UIN"]||Ie.GSTIN||Ie.GST||"").trim(),address:xe},ge++}}),ma(ue),alert(` Party Master Updated!

${ge} party-state combinations loaded.`)},Y.readAsBinaryString(C),m.target.value=""},so=()=>{const m=Pi.json_to_sheet([{"Sl. No.":1,"Name of Ledger":"ABC PRIVATE LIMITED",Address:"123 Business Park, Andheri East","Ledger Group":"Sundry Debtors","State Name":"Maharashtra","GST Registration Type":"Regular","GSTIN/UIN":"27AAACA1234A1ZQ"},{"Sl. No.":2,"Name of Ledger":"XYZ MEDIA PVT LTD",Address:"456 Media Tower, Connaught Place","Ledger Group":"Sundry Debtors","State Name":"Delhi","GST Registration Type":"Regular","GSTIN/UIN":"07AAACX5678B1ZR"}]),C=Pi.book_new();Pi.book_append_sheet(C,m,"Party Master"),jm(C,"Party_Master_Template.xlsx")},Di=m=>{var ee;const C=(ee=m.target.files)==null?void 0:ee[0];if(!C)return;if(!H){alert(" Please select a party first from the list, then import their historical ledger."),m.target.value="";return}const Y=new FileReader;Y.onload=K=>{const q=Oc(K.target.result,{type:"binary",cellDates:!0}),ne=q.SheetNames[0],J=q.Sheets[ne],Se=Pi.sheet_to_json(J,{raw:!1}),ue=[];let ge=0,Ie=null;const te=xe=>{if(!xe)return 0;const Ve=String(xe).replace(/,/g,"").replace(/[^\d.-]/g,"");return parseFloat(Ve)||0},Xe=xe=>{if(!xe||typeof xe!="string")return"";const Ve=xe.trim(),Ke=Ve.split(/[-\/]/);if(Ke.length===3){const Qe={jan:"01",feb:"02",mar:"03",apr:"04",may:"05",jun:"06",jul:"07",aug:"08",sep:"09",oct:"10",nov:"11",dec:"12"},vt=Ke[1].toLowerCase().substring(0,3);if(Qe[vt]){const jt=Ke[0].padStart(2,"0");return`${Ke[2].length===2?parseInt(Ke[2])>50?"19"+Ke[2]:"20"+Ke[2]:Ke[2]}-${Qe[vt]}-${jt}`}}return Ve};Se.forEach((xe,Ve)=>{const Ke=Xe(xe.Date||xe.DATE||xe.date||""),Qe=(xe.Particular||xe.PARTICULAR||xe.Particulars||xe.PARTICULARS||"").trim(),vt=(xe["Vch Type"]||xe["VCH TYPE"]||xe["Voucher Type"]||xe["vch type"]||"").trim(),jt=(xe["Vch No."]||xe["VCH NO."]||xe["Voucher No"]||xe["Invoice No"]||xe["Vch No"]||xe["vch no."]||"").trim(),Ge=te(xe.Debit||xe.DEBIT||xe.debit),at=te(xe.Credit||xe.CREDIT||xe.credit),lr=xe["Date of Receipt"]||xe["DATE OF RECEIPT"]||xe["Receipt Date"]||"",tr=te(xe["Amount Received"]||xe["AMOUNT RECEIVED"]||xe["amount received"]),Vt=te(xe["TDS amount Received"]||xe["TDS Received"]||xe.TDS||xe.tds),vr=te(xe.Balance||xe.BALANCE||xe.balance),Ne=(xe["Payment Status"]||xe["PAYMENT STATUS"]||xe.Status||xe.status||"").trim();if(!Ke&&(Qe.toUpperCase().includes("PROMOTIONAL")||Qe.toUpperCase().includes("IGST")||Qe.toUpperCase().includes("CGST")||Qe.toUpperCase().includes("SGST")||Qe.toUpperCase().includes("TRADE EMAILER"))&&Ie)Ie.subRows||(Ie.subRows=[]),Ie.subRows.push({particular:Qe,debit:Ge,credit:at});else if(Ke&&(jt||Ge>0||at>0)){Ie&&(ue.push(Ie),ge++);let Ze="invoice";vt.toLowerCase().includes("credit note")||jt.toUpperCase().startsWith("CN")?Ze="creditnote":vt.toLowerCase().includes("receipt")?Ze="receipt":(vt.toLowerCase().includes("sale")||Ge>0)&&(Ze="invoice"),Ie={id:Date.now()+Ve,partyName:H,date:Ke,particulars:Qe||H,narration:jt,vchType:vt||"Sales",vchNo:jt,debit:Ge,credit:at,receiptDate:lr,amountReceived:tr,tdsReceived:Vt,balance:vr,paymentStatus:Ne,type:Ze,isHistorical:!0,subRows:[]}}}),Ie&&(ue.push(Ie),ge++),console.log("Parsed entries with sub-rows:",ue),ge>0?(_e(xe=>[...xe,...ue]),alert(` Historical Ledger Uploaded!

${ge} entries added for "${H}".`)):alert(` No valid ledger entries found in the file.

Make sure your file has these columns:
 Date (e.g., 02-Jun-21)
 Vch Type (e.g., Sales, Credit Note)
 Vch No. (e.g., MB/2022-23/128)
 Debit or Credit amount`)},Y.readAsBinaryString(C),m.target.value="",rl(!1)},fc=()=>{const m=Pi.json_to_sheet([{Date:"02-Jun-21",Particular:"ABC Corp Ltd.","Vch Type":"Sales","Vch No.":"MB/2020-21/0411",Debit:6e3,Credit:"","Date of Receipt":"","Amount Received":44371,"TDS amount Received":5880,Balance:"","Payment Status":"Received"},{Date:"",Particular:"PROMOTIONAL TRADE EMAILERS","Vch Type":"","Vch No.":"",Debit:"",Credit:22500,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""},{Date:"",Particular:"IGST","Vch Type":"","Vch No.":"",Debit:"",Credit:4050,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""},{Date:"26-Mar-25",Particular:"ABC Corp Ltd.","Vch Type":"Credit Note","Vch No.":"CN/2022-23/128",Debit:"",Credit:26550,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""}]),C=Pi.book_new();Pi.book_append_sheet(C,m,"Historical Ledger"),jm(C,"Historical_Ledger_Template.xlsx")},Bu=m=>{const C=ve.find(Y=>Y.invoiceNo===m);C?ju(C):alert("Invoice not found in system. This may be a historical entry.")},O4=m=>{ve.find(Y=>Y.invoiceNo===m.invoiceNo);let C=` RECEIPT DETAILS

`;C+=`Receipt No: ${m.receiptNo}
`,C+=`Date: ${yr(m.date)}
`,C+=`Party: ${m.partyName}
`,C+=`Invoice: ${m.invoiceNo}

`,C+=`
`,C+=`Amount Received: ${ft(m.amount||0)}
`,C+=`TDS: ${ft(m.tds||0)}
`,C+=`Discount: ${ft(m.discount||0)}
`,C+=`
`,C+=`Total: ${ft((m.amount||0)+(m.tds||0)+(m.discount||0))}
`,m.remarks&&(C+=`
Remarks: ${m.remarks}`),alert(C)},M4=m=>{let C=` CREDIT NOTE DETAILS

`;C+=`Credit Note No: ${m.creditNoteNo}
`,C+=`Date: ${yr(m.date)}
`,C+=`Party: ${m.partyName}
`,C+=`Against Invoice: ${m.invoiceNo}

`,C+=`
`,C+=`Base Amount: ${ft(m.amount||0)}
`,C+=`${m.gstType||"GST"}: ${ft(m.gst||0)}
`,C+=`
`,C+=`Total Credit: ${ft(m.totalAmount||(m.amount||0)+(m.gst||0))}
`,m.reason&&(C+=`
Reason: ${m.reason}`),alert(C)},L4=m=>{var ee;const C=(ee=m.target.files)==null?void 0:ee[0];if(!C)return;const Y=new FileReader;Y.onload=K=>{const q=Oc(K.target.result,{type:"binary",cellDates:!0}),ne=q.SheetNames[0],J=q.Sheets[ne],Se=Pi.sheet_to_json(J,{raw:!1}),ue=new Set(Dr.map(xe=>`${xe.date}|${xe.time||""}|${xe.campaignName||""}|${xe.subject}`.toLowerCase()));let ge=0,Ie=0;const te=Se.map((xe,Ve)=>{const Ke=xe["CAMPAIGN NAME"]||xe["Campaign Name"]||"",Qe=LW(Ke);let vt=xe.DATE||xe.Date||new Date;typeof vt=="string"&&(vt=new Date(vt));const jt=(xe["PARTY NAME"]||xe["Party Name"]||"").trim(),Ge=xe["SENDER NAME"]||xe["Sender Name"]||"",at=xe.SUBJECT||xe.Subject||"",lr=xe.TIME||xe.Time||"",tr=Us[jt]||"",Vt=vt instanceof Date&&!isNaN(vt)?vt.toISOString().split("T")[0]:"",vr=`${Vt}|${lr}|${Ke}|${at}`.toLowerCase();return ue.has(vr)?(ge++,null):(ue.add(vr),Ie++,{id:Date.now()+Ve+Math.random(),sno:xe.SNO||xe["SNO."]||xe.Sno||Ve+1,date:Vt,month:xe.Month||xe.MONTH||"",statePartyDetails:xe["State/Party Details"]||xe["STATE/PARTY DETAILS"]||"",partyName:jt,senderName:Ge,campaignName:Ke,subject:at,emailId:Qe,additionalEmails:[],toBeBilled:"Not Yet",invoiceAmount:tr,cgst:"",sgst:"",igst:"",totalWithGst:"",invoiceType:"Individual",combinationCode:"NA",invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",mailingSent:"No",mailerUploaded:!1,editComments:""})}).filter(xe=>xe!==null);if(te.length>0){Re(Ve=>[...Ve,...te]);const xe=[...new Set(te.map(Ve=>Ve.partyName))];Ja(Ve=>{const Ke=new Set(Ve);return xe.forEach(Qe=>Ke.add(Qe)),Ke})}let Xe=` Upload Complete!

`;Xe+=` ${Ie} new campaigns added
`,ge>0&&(Xe+=` ${ge} duplicate entries skipped`),Ie>0&&ws("upload",` ${Ie} new campaigns uploaded to Master Sheet`,"director"),alert(Xe)},Y.readAsBinaryString(C),m.target.value=""},B4=async()=>{Re([]),_e([]),Ce([]),U([]),wi({}),ec({}),Pe(1),we(1),G(1),xt(1),Q(null),he(null),Ja(new Set),M([]),ma({}),hs([]);try{await rg("indreesh-media",{masterData:[],ledgerEntries:[],receipts:[],creditNotes:[],openingBalances:{},mailerImages:{},mailerLogo:Yr,companyConfig:S,nextInvoiceNo:1,nextCombineNo:1,nextReceiptNo:1,nextCreditNoteNo:1,invoiceValues:Us,notifications:[],whatsappSettings:re,partyMaster:{},followups:[],userPasswords:y}),console.log("Data cleared and saved to Firebase")}catch(m){console.error("Error clearing data:",m)}ua(!1),alert(" All master data, invoices, receipts, and ledger entries have been cleared!")},ry=m=>{var ee;const C=parseFloat(m.invoiceAmount)||0;if((ee=m.statePartyDetails)==null?void 0:ee.toUpperCase().includes("MAHARASHTRA")){const K=C*.09,q=C*.09;return{cgst:K,sgst:q,igst:0,total:C+K+q}}else{const K=C*.18;return{cgst:0,sgst:0,igst:K,total:C+K}}},j4=(m,C)=>{const Y=ve.find(ee=>ee.id===m);Re(ee=>ee.map(K=>{if(K.id===m){if(C==="Yes"&&K.invoiceAmount){const q=ry(K);return{...K,toBeBilled:C,cgst:q.cgst.toFixed(2),sgst:q.sgst.toFixed(2),igst:q.igst.toFixed(2),totalWithGst:q.total.toFixed(2)}}return{...K,toBeBilled:C}}return K})),C==="Yes"&&Y&&ws("info",` Campaign marked for billing: ${Y.partyName} - ${Y.senderName}`,"finance")},t0=(m,C,Y)=>{Re(ee=>ee.map(K=>{if(K.id===m){const q={...K,[C]:Y};if(C==="invoiceAmount"&&K.toBeBilled==="Yes"){const ne=ry(q);return{...q,cgst:ne.cgst.toFixed(2),sgst:ne.sgst.toFixed(2),igst:ne.igst.toFixed(2),totalWithGst:ne.total.toFixed(2)}}return q}return K}))},V4=m=>{const C=`${S.invoicePrefix}${Te}`,Y=new Date().toISOString().split("T")[0],ee=parseFloat(m.totalWithGst)||parseFloat(m.invoiceAmount)*1.18;Re(K=>K.map(q=>q.id===m.id?{...q,invoiceNo:C,invoiceDate:Y,invoiceTotalAmount:ee.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created",invoiceType:"Individual",combinationCode:"NA"}:q)),Pe(K=>K+1),ws("invoice",` New Invoice ${C} created for ${m.partyName} - ${ft(ee)}`,"director"),alert(` Invoice Generated!

Invoice No: ${C}
Amount: ${ft(ee)}

Please review and Approve or mark as Need Edits.`)},U4=()=>{if(Ft.size<2){alert("Please select at least 2 campaigns to combine");return}const m=`${S.invoicePrefix}${Te}`,C=new Date().toISOString().split("T")[0],Y=String(ke);let ee=0;const K=ve.filter(q=>Ft.has(q.id));K.forEach(q=>{ee+=parseFloat(q.totalWithGst)||parseFloat(q.invoiceAmount)*1.18}),Re(q=>q.map(ne=>Ft.has(ne.id)?{...ne,invoiceNo:m,invoiceDate:C,invoiceTotalAmount:ee.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created",invoiceType:"Combined",combinationCode:Y,mailingSent:"No"}:ne)),Pe(q=>q+1),we(q=>q+1),Nr(!1),si(new Set),ws("invoice",` Combined Invoice ${m} created for ${Mt} (${K.length} campaigns) - ${ft(ee)}`,"director"),Nt(null),alert(` Combined Invoice Generated!

Invoice No: ${m}
Campaigns: ${Ft.size}
Total: ${ft(ee)}

Please review and Approve or mark as Need Edits.`)},z4=m=>{si(C=>{const Y=new Set(C);return Y.has(m)?Y.delete(m):Y.add(m),Y})},W4=m=>{Nt(m.partyName),si(new Set([m.id])),Nr(!0)},H4=m=>{var ee;const C=(ee=m.target.files)==null?void 0:ee[0];if(!C||!ae)return;const Y=new FileReader;Y.onload=K=>ny(K.target.result),Y.readAsDataURL(C),m.target.value=""},ny=m=>{if(!ae)return;const C=ae.id;wi(Zl?Y=>({...Y,[C]:[m]}):Y=>({...Y,[C]:[...Y[C]||[],m]})),Re(Y=>Y.map(ee=>ee.id===ae.id?{...ee,mailerUploaded:!0}:ee)),Vs(null),el(!1),pt(!1),alert(" Mailer image saved!")},$4=m=>{var Y;const C=(Y=m.clipboardData)==null?void 0:Y.items;if(C){for(let ee=0;ee<C.length;ee++)if(C[ee].type.indexOf("image")!==-1){const K=C[ee].getAsFile(),q=new FileReader;q.onload=ne=>Vs(ne.target.result),q.readAsDataURL(K),m.preventDefault();break}}},G4=m=>{const C=encodeURIComponent(m||"campaign");window.open(`https://mail.google.com/mail/u/0/#search/${C}`,"_blank")},K4=m=>{var ee;const C=(ee=m.target.files)==null?void 0:ee[0];if(!C)return;const Y=new FileReader;Y.onload=K=>ps(K.target.result),Y.readAsDataURL(C),m.target.value=""},iy=m=>{const C=zs(m);if(C.length>1){const Y=C.map(ee=>ee.senderName).join(", ");return`Invoice ${m.invoiceNo||""} - ${Y}`}return`Invoice ${m.invoiceNo||""} - ${m.senderName} - ${m.subject}`},r0=m=>{const C=zs(m),Y=parseFloat(m.invoiceTotalAmount)||parseFloat(m.totalWithGst)||parseFloat(m.invoiceAmount)*1.18;let ee="";return C.length>1?(ee=`Campaigns included in this invoice:
`,C.forEach((K,q)=>{ee+=`${q+1}. ${K.senderName} - ${K.subject}
`})):ee=`Campaign: ${m.senderName}
Subject: ${m.subject}`,`Dear Sir/Madam,

Please find attached the invoice for the following:

${ee}

Invoice No: ${m.invoiceNo||"To be generated"}
Invoice Amount: ${ft(Y)}

Kindly process the payment at your earliest convenience.

Bank Details:
Bank: ${S.bank.name}
A/C No: ${S.bank.account}
IFSC: ${S.bank.ifsc}
Branch: ${S.bank.branch}

Thank you for your business.

Best Regards,
${S.name}
${S.email}`},[X4,sy]=ye.useState(!1),[ay,oy]=ye.useState(""),ly=m=>{var xe;let C=[m],Y=parseFloat(m.invoiceAmount)||0;m.invoiceType==="Combined"&&m.combinationCode!=="NA"&&(C=ve.filter(Ve=>Ve.combinationCode===m.combinationCode),Y=C.reduce((Ve,Ke)=>Ve+(parseFloat(Ke.invoiceAmount)||0),0));const ee=xa(m.partyName,m.statePartyDetails),K=va(m.partyName,m.statePartyDetails),q=(xe=m.statePartyDetails)==null?void 0:xe.toUpperCase().includes("MAHARASHTRA"),ne=q?Y*.09:0,J=q?Y*.09:0,Se=q?0:Y*.18,ue=ne+J+Se,ge=Y+ue,Ie=C.map((Ve,Ke)=>`
      <tr>
        <td style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px;">${Ke+1}</td>
        <td style="border: 1px solid #000; padding: 8px; font-size: 12px;">
          <div style="font-weight: 600;">PROMOTIONAL TRADE EMAILER</div>
          <div style="font-style: italic; color: #555; font-size: 11px; margin-top: 2px;">${Ve.senderName||""} - ${yr(Ve.date)}</div>
          <div style="font-style: italic; color: #555; font-size: 11px;">Subject: ${Ve.subject||""}</div>
        </td>
        <td style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px;">${S.hsnCode}</td>
        <td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${Ut(parseFloat(Ve.invoiceAmount)||0)}</td>
      </tr>
    `).join("");let te=[];m.invoiceType==="Combined"&&m.combinationCode!=="NA"?C.forEach(Ve=>{(Xr[Ve.id]||[]).forEach(Qe=>te.push({img:Qe,campaign:Ve}))}):(Xr[m.id]||[]).forEach(Ke=>te.push({img:Ke,campaign:m}));const Xe=te.map(({img:Ve,campaign:Ke})=>`
      <div class="page-break-before" style="page-break-before: always; padding: 40px; text-align: center; background: white;">
        ${Yr?`<div style="margin-bottom: 20px;"><img src="${Yr}" alt="Logo" style="max-height: 70px;" /></div>`:`
          <div style="text-align: center; margin-bottom: 25px;">
            <span style="font-size: 22px; font-weight: bold; color: #2874A6;">${S.name}</span>
          </div>
        `}
        <h2 style="font-size: 20px; text-decoration: underline; margin: 25px 0;">MAILER SUPPORTING</h2>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>MAILER DATE:</strong> ${OW(Ke.date)}</p>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>CAMPAIGN:</strong> ${Ke.senderName}</p>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>SUBJECT:</strong> ${Ke.subject||"Campaign"}</p>
        <div style="margin-top: 25px;"><img src="${Ve}" alt="Mailer" style="max-width: 100%; max-height: 550px; border: 1px solid #ddd;" /></div>
      </div>
    `).join("");return`
  <div style="max-width: 900px; margin: 0 auto; padding: 15px; background: white; font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4;">
    <style>
      @media print {
        @page { size: A4; margin: 8mm; }
        body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        .page-break-before { page-break-before: always; }
      }
    </style>
    <div style="border: 2px solid #000; background: white;">
      <div style="text-align: center; padding: 12px; font-size: 18px; font-weight: bold; border-bottom: 2px solid #000; background: #f8f8f8;">Tax Invoice</div>
      <div style="text-align: center; font-size: 11px; font-style: italic; padding: 5px; border-bottom: 1px solid #000; background: #fafafa;">(Original for Recipient)</div>
      <div style="display: flex; border-bottom: 2px solid #000;">
        <div style="flex: 1.5; padding: 12px; border-right: 2px solid #000;">
          <div style="font-size: 16px; font-weight: bold; margin-bottom: 8px; color: #1a5276;">${S.name}</div>
          <div style="font-size: 11px; line-height: 1.5; color: #333;">${S.address}<br>${S.addressLine2}<br>${S.city}<br><strong>GSTIN/UIN:</strong> ${S.gstin}<br><strong>State:</strong> ${S.stateName}, Code: ${S.stateCode}<br><strong>Contact:</strong> ${S.phone}<br><strong>E-Mail:</strong> ${S.email}</div>
        </div>
        <div style="flex: 1; font-size: 12px;">
          <div style="display: flex; border-bottom: 1px solid #000;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Invoice No.</div><div style="flex: 1; padding: 8px; font-weight: 600; color: #1a5276;">${m.invoiceNo||""}</div></div>
          <div style="display: flex;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Dated</div><div style="flex: 1; padding: 8px;">${yr(m.invoiceDate||m.date)}</div></div>
        </div>
      </div>
      <div style="padding: 10px 12px; border-bottom: 2px solid #000; background: #fafafa;">
        <div style="font-size: 11px; color: #666; margin-bottom: 3px;">Buyer (Bill to)</div>
        <div style="font-size: 14px; font-weight: bold; margin-bottom: 4px; color: #1a5276;">${m.partyName}</div>
        <div style="font-size: 11px; color: #333;">${K?K+"<br>":""}${m.statePartyDetails||""}${ee?"<br><strong>GSTIN/UIN:</strong> "+ee:""}<br>Place of Supply: ${m.statePartyDetails||S.stateName}</div>
      </div>
      <table style="width: 100%; border-collapse: collapse;">
        <thead><tr style="background: #e8e8e8;"><th style="border: 1px solid #000; padding: 10px; width: 45px; font-size: 12px;">Sl No.</th><th style="border: 1px solid #000; padding: 10px; font-size: 12px;">Particulars</th><th style="border: 1px solid #000; padding: 10px; width: 80px; font-size: 12px;">HSN/SAC</th><th style="border: 1px solid #000; padding: 10px; width: 100px; text-align: right; font-size: 12px;">Amount</th></tr></thead>
        <tbody>
          ${Ie}
          ${C.length>1?'<tr style="background: #f5f5f5;"><td colspan="3" style="border: 1px solid #000; padding: 10px; text-align: right; font-weight: bold; font-size: 13px;">Sub Total</td><td style="border: 1px solid #000; padding: 10px; text-align: right; font-weight: bold; font-size: 13px;">'+Ut(Y)+"</td></tr>":""}
          ${q?`<tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">CGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${Ut(ne)}</td></tr><tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">SGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${Ut(J)}</td></tr>`:`<tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">IGST @ 18%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${Ut(Se)}</td></tr>`}
          <tr style="background: #2874A6; color: white;"><td colspan="3" style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;">Total</td><td style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;"> ${ge.toLocaleString("en-IN",{minimumFractionDigits:2})}</td></tr>
        </tbody>
      </table>
      <div style="padding: 10px 12px; border: 1px solid #000; border-top: none; background: #fafafa;"><div style="color: #666; font-size: 11px; margin-bottom: 3px;">Amount Chargeable (in words)</div><div style="font-weight: bold; font-size: 13px;">${MW(ge)}</div></div>
      <div style="display: flex; border-top: 2px solid #000;">
        <div style="flex: 1; padding: 10px 12px; border-right: 2px solid #000; font-size: 11px;"><div><strong>Company's PAN:</strong> ${S.pan}</div><div style="margin-top: 4px;"><strong>MSME Reg. No.:</strong> UDYAM-MH-19-0057219</div></div>
        <div style="flex: 1.2; padding: 10px 12px; font-size: 11px;">
          <div style="font-weight: bold; margin-bottom: 6px; color: #1a5276;">Company's Bank Details</div>
          <div style="line-height: 1.5;"><strong>A/c Holder:</strong> ${S.bank.holder}<br><strong>Bank:</strong> ${S.bank.name}<br><strong>A/c No.:</strong> ${S.bank.account}<br><strong>IFSC:</strong> ${S.bank.ifsc}</div>
          <div style="text-align: right; margin-top: 30px;"><div style="font-weight: bold;">for ${S.name}</div><div style="margin-top: 25px; border-top: 1px solid #000; display: inline-block; padding-top: 4px; font-size: 10px;">Authorised Signatory</div></div>
        </div>
      </div>
      <div style="text-align: center; padding: 8px; background: #f0f0f0; border-top: 1px solid #000; font-size: 10px; color: #666; font-style: italic;">This is a Computer Generated Invoice</div>
    </div>
  </div>
  ${Xe}
`},Y4=m=>{const C=ly(m);oy(C),Sr(m),sy(!0)},q4=m=>{const C=`<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Invoice ${m.invoiceNo||""}</title>
  <style>
    @page { size: A4; margin: 10mm; }
    @media print { body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } }
    body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }
  </style>
</head>
<body>
${ly(m)}
<script>
  // Auto-open print dialog when file is opened
  window.onload = function() { 
    setTimeout(function() { window.print(); }, 500); 
  };
<\/script>
</body>
</html>`,Y=new Blob([C],{type:"text/html"}),ee=URL.createObjectURL(Y),K=document.createElement("a");K.href=ee,K.download=`Invoice_${(m.invoiceNo||"draft").replace(/\//g,"-")}.html`,document.body.appendChild(K),K.click(),document.body.removeChild(K),URL.revokeObjectURL(ee)},ju=m=>{Y4(m)},Q4=()=>{const m=parseFloat(xr.amount)||0,C=parseFloat(xr.tds)||0,Y=parseFloat(xr.discount)||0,ee=m+C+Y;let K=parseFloat(ae.invoiceTotalAmount)||parseFloat(ae.totalWithGst)||parseFloat(ae.invoiceAmount)*1.18;const q=ee>=K?"Paid":"Partially Paid";ae.invoiceType==="Combined"&&ae.combinationCode!=="NA"?Re(J=>J.map(Se=>Se.combinationCode===ae.combinationCode?{...Se,invoiceStatus:q}:Se)):Re(J=>J.map(Se=>Se.id===ae.id?{...Se,invoiceStatus:q}:Se));const ne=[];m>0&&ne.push({id:Date.now(),partyName:ae.partyName,date:xr.date,particulars:xr.narration?`Payment Received - ${xr.mode} (${xr.narration})`:`Payment Received - ${xr.mode}`,debit:0,credit:m,type:"payment"}),C>0&&ne.push({id:Date.now()+1,partyName:ae.partyName,date:xr.date,particulars:`TDS Deducted - Inv: ${ae.invoiceNo}`,debit:0,credit:C,type:"tds"}),Y>0&&ne.push({id:Date.now()+2,partyName:ae.partyName,date:xr.date,particulars:`Discount Allowed - Inv: ${ae.invoiceNo}`,debit:0,credit:Y,type:"discount"}),_e(J=>[...J,...ne]),hn(!1),Sr(null)},cy=m=>{Ja(C=>{const Y=new Set(C);return Y.has(m)?Y.delete(m):Y.add(m),Y})},J4=()=>{const Y=r==="director"?[{id:"master",icon:z2,label:"Master Sheet"},{id:"invoices",icon:qu,label:"Invoice Register"},{id:"ledgers",icon:M2,label:"Party Ledgers"},{id:"followups",icon:M0,label:"Followups"},{id:"reports",icon:P2,label:"Reports"}]:[{id:"master",icon:z2,label:"Master Sheet"},{id:"invoices",icon:qu,label:"Invoice Register"},{id:"ledgers",icon:M2,label:"Party Ledgers"},{id:"followups",icon:M0,label:"Followups"},{id:"reports",icon:P2,label:"Reports"},{id:"settings",icon:XB,label:"Settings"}];return f.jsxs("div",{style:{width:R?"60px":"220px",backgroundColor:"#1E293B",color:"#FFFFFF",display:"flex",flexDirection:"column",transition:"width 0.2s ease",flexShrink:0},children:[f.jsxs("div",{style:{padding:R?"12px":"16px",borderBottom:"1px solid #334155",display:"flex",alignItems:"center",justifyContent:R?"center":"space-between"},children:[!R&&f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[f.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"32px",height:"auto",borderRadius:"4px",backgroundColor:"white",padding:"2px"}}),f.jsxs("div",{children:[f.jsx("div",{style:{fontSize:"16px",fontWeight:"700"},children:"FinMate"}),f.jsx("div",{style:{fontSize:"10px",color:"#94A3B8"},children:r==="director"?"Director View":"Finance Team"})]})]}),f.jsx("button",{onClick:()=>He(!R),style:{background:"none",border:"none",color:"#94A3B8",cursor:"pointer",padding:"4px"},children:R?f.jsx(Vm,{size:18}):f.jsx(zB,{size:18})})]}),!R&&f.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #334155",fontSize:"11px"},children:d?f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#FCD34D"},children:[f.jsx(j2,{size:12,style:{animation:"spin 1s linear infinite"}}),f.jsx("span",{children:"Saving..."})]}):p?f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#86EFAC"},children:[f.jsx(L2,{size:12}),f.jsxs("span",{children:["Saved ",p.toLocaleTimeString()]})]}):f.jsx("div",{style:{color:"#94A3B8"},children:"Cloud Sync Active"})}),f.jsx("div",{style:{padding:"8px",borderBottom:"1px solid #334155"},children:f.jsxs("button",{onClick:()=>I(!0),style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",borderRadius:"8px",border:"none",backgroundColor:Ss>0?"#FEF3C7":"#334155",color:Ss>0?"#92400E":"#94A3B8",cursor:"pointer",fontSize:"14px",fontWeight:Ss>0?"700":"500",justifyContent:R?"center":"flex-start",position:"relative"},title:"Notifications",children:[Ss>0?f.jsx(jB,{size:18}):f.jsx(O2,{size:18}),!R&&f.jsx("span",{children:"Notifications"}),Ss>0&&f.jsx("span",{style:{position:R?"absolute":"static",top:R?"4px":"auto",right:R?"4px":"auto",marginLeft:R?"0":"auto",backgroundColor:"#DC2626",color:"#FFFFFF",padding:"2px 6px",borderRadius:"10px",fontSize:"11px",fontWeight:"700",minWidth:"18px",textAlign:"center"},children:Ss})]})}),f.jsx("nav",{style:{flex:1,padding:"8px"},children:Y.map(ee=>f.jsxs("button",{onClick:()=>D(ee.id),style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",marginBottom:"4px",borderRadius:"8px",border:"none",backgroundColor:N===ee.id?"#2874A6":"transparent",color:N===ee.id?"#FFFFFF":"#94A3B8",cursor:"pointer",fontSize:"14px",fontWeight:N===ee.id?"600":"500",justifyContent:R?"center":"flex-start"},title:ee.label,children:[f.jsx(ee.icon,{size:18}),!R&&f.jsx("span",{children:ee.label})]},ee.id))}),f.jsxs("div",{style:{padding:"8px",borderTop:"1px solid #334155"},children:[f.jsxs("button",{onClick:()=>{_(!0),W({currentPassword:"",newPassword:"",confirmPassword:""}),w("")},style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",marginBottom:"8px",borderRadius:"8px",border:"none",backgroundColor:"#475569",color:"#FFFFFF",cursor:"pointer",fontSize:"14px",fontWeight:"500",justifyContent:R?"center":"flex-start"},title:"Change Password",children:[f.jsx(O0,{size:18}),!R&&f.jsx("span",{children:"Change Password"})]}),f.jsxs("button",{onClick:Pu,style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",borderRadius:"8px",border:"none",backgroundColor:"#DC2626",color:"#FFFFFF",cursor:"pointer",fontSize:"14px",fontWeight:"600",justifyContent:R?"center":"flex-start"},title:"Logout",children:[f.jsx(fl,{size:18}),!R&&f.jsx("span",{children:"Logout"})]})]})]})},Z4=()=>f.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(zm,{size:18,color:"#64748B"}),f.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"})]}),f.jsxs("div",{style:{position:"relative"},children:[f.jsx(L0,{size:15,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"text",placeholder:"Search...",value:lt.searchText,onChange:m=>gs(C=>({...C,searchText:m.target.value})),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"160px"}})]}),f.jsxs("select",{value:lt.party,onChange:m=>gs(C=>({...C,party:m.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:lt.party?"#EFF6FF":"#FFFFFF"},children:[f.jsx("option",{value:"",children:"All Parties"}),ya.map(m=>f.jsx("option",{value:m,children:m},m))]}),f.jsxs("select",{value:lt.billStatus,onChange:m=>gs(C=>({...C,billStatus:m.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:lt.billStatus?"#EFF6FF":"#FFFFFF"},children:[f.jsx("option",{value:"",children:"Bill Status"}),f.jsx("option",{value:"Yes",children:"Yes"}),f.jsx("option",{value:"Not Yet",children:"Not Yet"})]}),f.jsxs("select",{value:lt.invoiceStatus,onChange:m=>gs(C=>({...C,invoiceStatus:m.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:lt.invoiceStatus?"#EFF6FF":"#FFFFFF"},children:[f.jsx("option",{value:"",children:"Invoice Status"}),f.jsx("option",{value:"Generated",children:"Generated"}),f.jsx("option",{value:"Not Generated",children:"Not Generated"}),f.jsx("option",{value:"Paid",children:"Paid"})]}),al&&f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:Ou,style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(fl,{size:14})," Clear"]}),f.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",oc.length," of ",ve.length]})]})]})}),uy=()=>{const m=ve.filter(ne=>ne.toBeBilled==="Yes"&&ne.invoiceGenerated&&ne.mailingSent==="Yes"&&(ne.receiptStatus==="Received"||ne.receiptStatus==="Cancelled"||ne.receiptStatus==="Closed")),C=ve.filter(ne=>!(ne.toBeBilled==="Yes"&&ne.invoiceGenerated&&ne.mailingSent==="Yes"&&(ne.receiptStatus==="Received"||ne.receiptStatus==="Cancelled"||ne.receiptStatus==="Closed"))),Y=Mn==="open"?C:m,ee=Y.filter(ne=>{var J,Se,ue,ge,Ie;if(lt.party&&ne.partyName!==lt.party||lt.billStatus&&ne.toBeBilled!==lt.billStatus||lt.invoiceType&&ne.invoiceType!==lt.invoiceType||lt.mailingStatus&&(lt.mailingStatus==="Sent"&&ne.mailingSent!=="Yes"||lt.mailingStatus==="Not Sent"&&ne.mailingSent==="Yes")||lt.invoiceStatus&&(lt.invoiceStatus==="Generated"&&!ne.invoiceGenerated||lt.invoiceStatus==="Not Generated"&&ne.invoiceGenerated||lt.invoiceStatus==="Approved"&&ne.invoiceStatus!=="Approved"||lt.invoiceStatus==="Need Edits"&&ne.invoiceStatus!=="Need Edits"||lt.invoiceStatus==="Paid"&&ne.invoiceStatus!=="Paid"))return!1;if(lt.searchText){const te=lt.searchText.toLowerCase();if(!((J=ne.partyName)!=null&&J.toLowerCase().includes(te))&&!((Se=ne.senderName)!=null&&Se.toLowerCase().includes(te))&&!((ue=ne.campaignName)!=null&&ue.toLowerCase().includes(te))&&!((ge=ne.subject)!=null&&ge.toLowerCase().includes(te))&&!((Ie=ne.invoiceNo)!=null&&Ie.toLowerCase().includes(te)))return!1}return!0}),K=ee.reduce((ne,J)=>{const Se=J.partyName||"Unknown";return ne[Se]||(ne[Se]=[]),ne[Se].push(J),ne},{}),q=Object.keys(K).sort();return f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[f.jsxs("div",{children:[f.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Master Sheet"}),f.jsxs("p",{style:{margin:"4px 0 0",fontSize:"14px",color:"#64748B"},children:[ve.length," campaigns  ",ya.length," parties  ",ve.filter(ne=>ne.invoiceGenerated).length," invoiced"]})]}),f.jsxs("div",{style:{display:"flex",gap:"10px"},children:[f.jsx("input",{type:"file",ref:Hd,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:L4}),f.jsx(Ye,{icon:Xs,label:"Upload Data",variant:"brand",onClick:()=>{var ne;return(ne=Hd.current)==null?void 0:ne.click()}}),Ht&&ve.length>0&&f.jsx(Ye,{icon:Ks,label:"Clear All Data",variant:"danger",onClick:()=>ua(!0)})]})]}),f.jsxs("div",{style:{display:"flex",gap:"4px",marginBottom:"16px",backgroundColor:"#F1F5F9",padding:"4px",borderRadius:"10px",width:"fit-content"},children:[f.jsxs("button",{onClick:()=>Kr("open"),style:{padding:"10px 20px",fontSize:"14px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:Mn==="open"?"#FFFFFF":"transparent",color:Mn==="open"?"#1E293B":"#64748B",boxShadow:Mn==="open"?"0 2px 4px rgba(0,0,0,0.1)":"none"},children:[" Open Invoices (",C.length,")"]}),f.jsxs("button",{onClick:()=>Kr("closed"),style:{padding:"10px 20px",fontSize:"14px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:Mn==="closed"?"#FFFFFF":"transparent",color:Mn==="closed"?"#1E293B":"#64748B",boxShadow:Mn==="closed"?"0 2px 4px rgba(0,0,0,0.1)":"none"},children:[" Closed Invoices (",m.length,")"]})]}),ve.length>0&&Z4(),q.length===0?f.jsx(Tn,{children:f.jsxs("div",{style:{padding:"60px",textAlign:"center",color:"#94A3B8"},children:[f.jsx(Xs,{size:48,style:{marginBottom:"16px",opacity:.5}}),f.jsx("div",{style:{fontSize:"18px",fontWeight:"600"},children:al?"No matching records":Mn==="closed"?"No closed invoices yet":"No Data Yet"}),f.jsx("div",{style:{fontSize:"14px",marginTop:"4px"},children:al?"Try adjusting your filters":Mn==="closed"?"Invoices will appear here once billed, mailed, and payment received":"Upload an Excel file to get started"})]})}):f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:q.map(ne=>{const J=K[ne],Se=Qt.has(ne),ue=J.filter(te=>te.toBeBilled==="Yes").length,ge=J.filter(te=>te.invoiceGenerated).length,Ie=J.filter(te=>te.toBeBilled==="Yes").reduce((te,Xe)=>te+(parseFloat(Xe.totalWithGst)||0),0);return f.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:[f.jsxs("div",{onClick:()=>cy(ne),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",backgroundColor:Mn==="closed"?"#F0FDF4":"#F8FAFC",cursor:"pointer",borderBottom:Se?"3px solid #2874A6":"none"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[Se?f.jsx(B2,{size:22,color:"#2874A6"}):f.jsx(Vm,{size:22,color:"#64748B"}),f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:"700",fontSize:"16px",color:"#1E293B"},children:ne}),f.jsxs("div",{style:{fontSize:"13px",color:"#64748B",marginTop:"3px"},children:[J.length," campaigns  ",ue," billed  ",ge," invoiced"]})]})]}),Ie>0&&f.jsxs("div",{style:{textAlign:"right"},children:[f.jsx("div",{style:{fontSize:"11px",color:"#64748B",textTransform:"uppercase"},children:"Total"}),f.jsx("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:ft(Ie)})]})]}),Se&&f.jsx("div",{style:{overflowX:"auto"},children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px",minWidth:"2100px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#F1F5F9"},children:[f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Date"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"100px"},children:"Sender"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",minWidth:"180px"},children:"Campaign / Subject"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"160px"},children:"Email ID"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"70px"},children:"Mailer"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"80px"},children:"Bill?"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"right",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Amount"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Type"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Generate"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"110px"},children:"Invoice No."}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"90px"},children:"Inv Date"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"right",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"100px"},children:"Inv Amount"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#7C3AED",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"50px"},children:"C#"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"120px"},children:"Status/Approve"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"120px"},children:"Actions"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#059669",borderBottom:"2px solid #E2E8F0",backgroundColor:"#F0FDF4",width:"80px"},children:"Mailed?"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#059669",borderBottom:"2px solid #E2E8F0",backgroundColor:"#F0FDF4",width:"90px"},children:"Mail Date"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#7C3AED",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"100px"},children:"Receipt"})]})}),f.jsx("tbody",{children:J.map(te=>{var Ve,Ke;const Xe=te.invoiceType==="Combined"&&Yd(te.combinationCode)&&te.mailingSent!=="Yes";no(te);const xe=Xr[te.id]&&Xr[te.id].length>0;return f.jsxs("tr",{style:{backgroundColor:te.toBeBilled==="Yes"?te.invoiceGenerated?"#F0FDF4":"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #F1F5F9"},children:[f.jsx("td",{style:{padding:"12px 14px",whiteSpace:"nowrap",fontSize:"13px"},children:yr(te.date)}),f.jsx("td",{style:{padding:"12px 14px",fontWeight:"600",fontSize:"13px"},children:te.senderName}),f.jsxs("td",{style:{padding:"12px 14px"},children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"13px",lineHeight:"1.4",color:"#1E293B"},children:((Ke=(Ve=te.campaignName)==null?void 0:Ve.split("--")[0])==null?void 0:Ke.trim())||te.senderName}),te.subject&&f.jsx("div",{style:{fontSize:"12px",color:"#64748B",marginTop:"4px",lineHeight:"1.3"},children:te.subject})]}),f.jsx("td",{style:{padding:"10px 14px"},children:f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[te.emailId&&f.jsx("div",{style:{fontSize:"11px",color:"#1E40AF",backgroundColor:"#EFF6FF",padding:"2px 6px",borderRadius:"4px",display:"inline-block"},children:te.emailId}),(te.additionalEmails||[]).map((Qe,vt)=>f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[f.jsx("span",{style:{fontSize:"11px",color:"#059669",backgroundColor:"#F0FDF4",padding:"2px 6px",borderRadius:"4px"},children:Qe}),f.jsx("button",{onClick:()=>qd(te.id,Qe),style:{background:"none",border:"none",cursor:"pointer",padding:"2px",color:"#DC2626"},title:"Remove",children:f.jsx(fl,{size:12})})]},vt)),f.jsxs("button",{onClick:()=>{Sr(te),fa(""),zt(!0)},style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",color:"#2874A6",background:"none",border:"none",cursor:"pointer",padding:"2px 0"},children:[f.jsx(V2,{size:12})," Add"]})]})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:xe?f.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[f.jsx("span",{style:{color:"#22C55E",fontWeight:"700",fontSize:"14px"},children:""}),f.jsx("button",{onClick:()=>{Sr(te),Vs(null),el(!0),pt(!0)},style:{fontSize:"10px",color:"#64748B",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},children:"Replace"})]}):f.jsx(Ye,{icon:UB,small:!0,variant:"default",onClick:()=>{Sr(te),Vs(null),el(!1),pt(!0)}})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:f.jsxs("select",{value:te.toBeBilled,onChange:Qe=>j4(te.id,Qe.target.value),disabled:te.invoiceGenerated||!jn,style:{padding:"6px 8px",fontSize:"12px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:te.toBeBilled==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:te.toBeBilled==="Yes"?"#DCFCE7":"#FFFFFF",color:te.toBeBilled==="Yes"?"#166534":"#64748B",cursor:te.invoiceGenerated||!jn?"not-allowed":"pointer",width:"70px",opacity:!jn&&!te.invoiceGenerated?.6:1},children:[f.jsx("option",{value:"Not Yet",children:"Not Yet"}),f.jsx("option",{value:"Yes",children:"Yes"})]})}),f.jsx("td",{style:{padding:"10px 14px"},children:f.jsx("input",{type:"number",value:te.invoiceAmount||"",onChange:Qe=>t0(te.id,"invoiceAmount",Qe.target.value),disabled:te.invoiceGenerated,placeholder:"0",style:{width:"80px",padding:"6px 8px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #D1D5DB",borderRadius:"6px",textAlign:"right",backgroundColor:te.invoiceGenerated?"#F3F4F6":"#FFFFFF"}})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:te.invoiceGenerated?f.jsx(ng,{status:te.invoiceType,small:!0}):te.toBeBilled==="Yes"?f.jsxs("select",{value:te.invoiceType||"Individual",onChange:Qe=>t0(te.id,"invoiceType",Qe.target.value),style:{padding:"6px 6px",fontSize:"11px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:te.invoiceType==="Combined"?"#7C3AED":"#A5B4FC",backgroundColor:te.invoiceType==="Combined"?"#F3E8FF":"#E0E7FF",color:te.invoiceType==="Combined"?"#6B21A8":"#3730A3",cursor:"pointer",width:"80px"},children:[f.jsx("option",{value:"Individual",children:"Individual"}),f.jsx("option",{value:"Combined",children:"Combined"})]}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:te.toBeBilled==="Yes"&&!te.invoiceGenerated&&te.invoiceAmount&&Ht?te.invoiceType==="Individual"?f.jsx(Ye,{icon:Qu,label:"Create",small:!0,variant:"warning",onClick:()=>V4(te)}):f.jsx(Ye,{icon:$B,label:"Combine",small:!0,variant:"purple",onClick:()=>W4(te)}):te.toBeBilled==="Yes"&&!te.invoiceGenerated&&te.invoiceAmount&&jn?f.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Finance to create"}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF"},children:te.invoiceNo?f.jsx("span",{style:{fontWeight:"700",color:"#1E40AF",fontSize:"12px"},children:te.invoiceNo}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF",fontSize:"12px"},children:te.invoiceDate?yr(te.invoiceDate):"-"}),f.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF",textAlign:"right",fontWeight:"700",color:"#1E40AF",fontSize:"13px"},children:te.invoiceTotalAmount?Ut(te.invoiceTotalAmount):"-"}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:te.combinationCode&&te.combinationCode!=="NA"?f.jsx("span",{style:{fontWeight:"700",color:"#7C3AED",fontSize:"12px"},children:te.combinationCode}):"-"}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:te.invoiceGenerated?jn?f.jsx("button",{onClick:()=>Qd(te),style:{padding:"5px 10px",fontSize:"11px",fontWeight:"700",border:"1.5px solid",borderRadius:"6px",cursor:"pointer",backgroundColor:te.invoiceStatus==="Approved"?"#DCFCE7":te.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",borderColor:te.invoiceStatus==="Approved"?"#22C55E":te.invoiceStatus==="Need Edits"?"#DC2626":"#F59E0B",color:te.invoiceStatus==="Approved"?"#166534":te.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:te.invoiceStatus==="Approved"?" Approved":te.invoiceStatus==="Need Edits"?" Need Edits":" Review"}):f.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px"},children:[f.jsx("span",{style:{padding:"4px 10px",fontSize:"11px",fontWeight:"700",borderRadius:"6px",backgroundColor:te.invoiceStatus==="Approved"?"#DCFCE7":te.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",color:te.invoiceStatus==="Approved"?"#166534":te.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:te.invoiceStatus==="Approved"?" Approved":te.invoiceStatus==="Need Edits"?" Need Edits":" Pending"}),(te.editComments||te.approvalRemarks)&&f.jsx("button",{onClick:()=>{Sr(te),Zt(!0)},style:{fontSize:"9px",color:te.invoiceStatus==="Need Edits"?"#991B1B":"#166534",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},title:te.editComments||te.approvalRemarks,children:"View Remarks"})]}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:te.invoiceGenerated&&te.invoiceStatus==="Approved"?f.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[f.jsx(Ye,{icon:P0,small:!0,onClick:()=>ju(te),title:"View Invoice"}),Ht&&f.jsx(Ye,{icon:Wm,small:!0,variant:"brand",onClick:()=>{Sr(te),qt(!0)},title:"Send Email"}),Ht&&f.jsx(Ye,{icon:Ks,small:!0,variant:"danger",onClick:()=>uc(te),title:"Delete"})]}):te.invoiceGenerated?f.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[f.jsx(Ye,{icon:P0,small:!0,onClick:()=>ju(te),title:"View Invoice"}),Ht&&f.jsx(Ye,{icon:Ks,small:!0,variant:"danger",onClick:()=>uc(te),title:"Delete"})]}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#F0FDF4"},children:te.invoiceGenerated&&te.invoiceStatus==="Approved"&&Ht?Xe?f.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Combined sent"}):f.jsxs("select",{value:te.mailingSent||"No",onChange:Qe=>t0(te.id,"mailingSent",Qe.target.value),style:{padding:"5px 8px",fontSize:"11px",fontWeight:"700",border:"2px solid",borderRadius:"6px",borderColor:te.mailingSent==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:te.mailingSent==="Yes"?"#DCFCE7":"#FFFFFF",color:te.mailingSent==="Yes"?"#166534":"#64748B",cursor:"pointer",width:"60px"},children:[f.jsx("option",{value:"No",children:"No"}),f.jsx("option",{value:"Yes",children:"Yes"})]}):te.invoiceGenerated&&te.invoiceStatus==="Approved"&&jn?f.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"11px",fontWeight:"600",backgroundColor:te.mailingSent==="Yes"?"#DCFCE7":"#FEF3C7",color:te.mailingSent==="Yes"?"#166534":"#92400E"},children:te.mailingSent==="Yes"?" Yes":" No"}):te.invoiceGenerated&&te.invoiceStatus!=="Approved"?f.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Approve first"}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#F0FDF4"},children:te.mailingSent==="Yes"?Ht?f.jsx("input",{type:"date",value:te.mailDate||te.invoiceDate||"",onChange:Qe=>t0(te.id,"mailDate",Qe.target.value),style:{padding:"4px 6px",fontSize:"11px",border:"1.5px solid #D1D5DB",borderRadius:"6px",width:"100%"}}):f.jsx("span",{style:{fontSize:"11px"},children:yr(te.mailDate||te.invoiceDate)}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:te.receiptStatus==="Received"||te.receiptStatus==="Closed"?f.jsxs("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"700",backgroundColor:"#DCFCE7",color:"#166534"},children:[" ",te.receiptNo||"Received"]}):te.receiptStatus==="Cancelled"?f.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:" Cancelled"}):te.invoiceGenerated&&te.invoiceStatus==="Approved"?f.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"600",backgroundColor:"#FEF3C7",color:"#92400E"},children:" Pending"}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})})]},te.id)})})]})})]},ne)})}),Y.length>0&&f.jsxs("div",{style:{marginTop:"16px",padding:"16px 20px",backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsxs("div",{style:{display:"flex",gap:"24px",fontSize:"14px",color:"#475569"},children:[f.jsxs("span",{children:[" Total: ",f.jsx("strong",{children:ee.length})]}),f.jsxs("span",{children:[" To Bill: ",f.jsx("strong",{children:ee.filter(ne=>ne.toBeBilled==="Yes").length})]}),f.jsxs("span",{children:[" Invoiced: ",f.jsx("strong",{children:ee.filter(ne=>ne.invoiceGenerated).length})]}),f.jsxs("span",{children:[" Approved: ",f.jsx("strong",{children:ee.filter(ne=>ne.invoiceStatus==="Approved").length})]}),Mn==="closed"&&f.jsxs("span",{children:[" Closed: ",f.jsx("strong",{children:ee.filter(ne=>ne.receiptStatus==="Received"||ne.receiptStatus==="Cancelled"||ne.receiptStatus==="Closed").length})]})]}),f.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:["Total: ",ft(ee.filter(ne=>ne.toBeBilled==="Yes").reduce((ne,J)=>ne+(parseFloat(J.totalWithGst)||0),0))]})]})]})},eF=()=>{const m=new Map;Dr.filter(ue=>ue.invoiceGenerated).forEach(ue=>{m.has(ue.invoiceNo)?m.get(ue.invoiceNo).campaigns.push(ue):m.set(ue.invoiceNo,{invoiceNo:ue.invoiceNo,partyName:ue.partyName,date:ue.invoiceDate,invoiceType:ue.invoiceType,combinationCode:ue.combinationCode,invoiceStatus:ue.invoiceStatus,mailingSent:ue.mailingSent,receiptStatus:ue.receiptStatus||"Pending",receiptNo:ue.receiptNo,campaigns:[ue],totalAmount:parseFloat(ue.invoiceTotalAmount)||0,isFromMaster:!0})});const C=ue=>{if(!ue)return"";const ge=ue.split("/");return ge.length>=3?ge.slice(1).join("/"):ge.length===2?ge.join("/"):ge[ge.length-1]},Y=Ni.filter(ue=>{var ge;return ue.isHistorical&&(ue.type==="creditnote"||((ge=ue.vchNo)==null?void 0:ge.toUpperCase().startsWith("CN")))}),ee=new Map;nc.forEach(ue=>{const ge=C(ue.invoiceNo);ge&&ee.set(ge,ue)}),Y.forEach(ue=>{const ge=C(ue.vchNo);ge&&!ee.has(ge)&&ee.set(ge,ue)}),Ni.filter(ue=>{var ge;return ue.isHistorical&&ue.type!=="creditnote"&&!((ge=ue.vchNo)!=null&&ge.toUpperCase().startsWith("CN"))&&ue.debit>0}).forEach(ue=>{if(!m.has(ue.vchNo)){const ge=rc.find(vt=>vt.invoiceNo===ue.vchNo),Ie=C(ue.vchNo),te=ee.get(Ie),Xe=te?Math.abs(parseFloat(te.totalAmount)||parseFloat(te.credit)||parseFloat(te.debit)||0):0,xe=parseFloat(ue.debit)||0;if(te&&Xe>=xe)return;const Ke=!ge&&!(ue.amountReceived>0),Qe=te&&Xe>0&&Xe<xe;if(Ke||Qe){const vt=Qe?xe-Xe:xe;m.set(ue.vchNo,{invoiceNo:ue.vchNo,partyName:ue.partyName,date:ue.date,invoiceType:"Historical",combinationCode:"",invoiceStatus:"Approved",mailingSent:"Yes",receiptStatus:Qe?"Partial CN":"Pending",receiptNo:"",campaigns:[],totalAmount:xe,pendingAmount:vt,hasPartialCN:Qe,cnAmount:Xe,isHistorical:!0,historicalEntry:ue})}}});let K=Array.from(m.values());if(rr.party&&(K=K.filter(ue=>er(ue.partyName,rr.party))),rr.invoiceStatus&&(K=K.filter(ue=>ue.invoiceStatus===rr.invoiceStatus)),rr.receiptStatus&&(rr.receiptStatus==="Received"?K=K.filter(ue=>ue.receiptStatus==="Received"):rr.receiptStatus==="Pending"&&(K=K.filter(ue=>ue.receiptStatus!=="Received"))),rr.invoiceType&&(K=K.filter(ue=>ue.invoiceType===rr.invoiceType)),rr.searchText){const ue=rr.searchText.toLowerCase();K=K.filter(ge=>{var Ie,te;return((Ie=ge.invoiceNo)==null?void 0:Ie.toLowerCase().includes(ue))||((te=ge.partyName)==null?void 0:te.toLowerCase().includes(ue))})}const q={};K.forEach(ue=>{q[ue.partyName]||(q[ue.partyName]=[]),q[ue.partyName].push(ue)});const ne=Object.keys(q).sort(),J=rr.party||rr.invoiceStatus||rr.receiptStatus||rr.invoiceType||rr.searchText,Se=Array.from(m.values());return f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[f.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Invoice & Receipt Register"}),jn&&f.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"})]}),f.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(zm,{size:18,color:"#64748B"}),f.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"})]}),f.jsxs("div",{style:{position:"relative"},children:[f.jsx(L0,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"text",placeholder:"Search invoice...",value:rr.searchText,onChange:ue=>Ln(ge=>({...ge,searchText:ue.target.value})),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"160px"}})]}),f.jsxs("select",{value:rr.party,onChange:ue=>Ln(ge=>({...ge,party:ue.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[f.jsx("option",{value:"",children:"All Parties"}),ya.map(ue=>f.jsx("option",{value:ue,children:ue},ue))]}),f.jsxs("select",{value:rr.invoiceStatus,onChange:ue=>Ln(ge=>({...ge,invoiceStatus:ue.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[f.jsx("option",{value:"",children:"All Status"}),f.jsx("option",{value:"Created",children:"Created"}),f.jsx("option",{value:"Approved",children:"Approved"}),f.jsx("option",{value:"Need Edits",children:"Need Edits"})]}),f.jsxs("select",{value:rr.receiptStatus,onChange:ue=>Ln(ge=>({...ge,receiptStatus:ue.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[f.jsx("option",{value:"",children:"All Receipts"}),f.jsx("option",{value:"Received",children:"Received"}),f.jsx("option",{value:"Pending",children:"Pending"})]}),f.jsxs("select",{value:rr.invoiceType,onChange:ue=>Ln(ge=>({...ge,invoiceType:ue.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[f.jsx("option",{value:"",children:"All Types"}),f.jsx("option",{value:"Individual",children:"Individual"}),f.jsx("option",{value:"Combined",children:"Combined"})]}),J&&f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:()=>Ln({party:"",invoiceStatus:"",receiptStatus:"",invoiceType:"",searchText:""}),style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(fl,{size:14})," Clear"]}),f.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",K.length," of ",Se.length]})]})]})}),f.jsx(Tn,{noPadding:!0,children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[f.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Date"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Type"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:"Amount"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#F0FDF4",color:"#166534"},children:"Received"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEF3C7",color:"#92400E"},children:"TDS"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:"CN Amt"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#EFF6FF",color:"#1E40AF"},children:"Balance"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Inv. Status"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Receipt No."}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"CN No."}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),f.jsx("tbody",{children:ne.length===0?f.jsx("tr",{children:f.jsx("td",{colSpan:"12",style:{padding:"50px",textAlign:"center",color:"#94A3B8"},children:J?"No matching invoices":"No invoices generated yet"})}):ne.map(ue=>{const ge=q[ue],Ie=Qt.has(ue);let te=0;return ge.forEach(Xe=>{const xe=Z.find(Vt=>Vt.invoiceNo===Xe.invoiceNo),Ve=Be.find(Vt=>Vt.invoiceNo===Xe.invoiceNo),Ke=Ae.find(Vt=>Vt.invoiceNo===Xe.invoiceNo&&Vt.type==="tds"),Qe=Ae.find(Vt=>Vt.invoiceNo===Xe.invoiceNo&&Vt.type==="discount"),vt=Xe.totalAmount||0,jt=xe&&parseFloat(xe.amount)||0,Ge=Ke?parseFloat(Ke.credit)||0:xe&&parseFloat(xe.tds)||0,at=Ve?Math.abs(parseFloat(Ve.totalAmount)||0):0,lr=Qe&&parseFloat(Qe.credit)||0,tr=Math.max(0,vt-jt-Ge-at-lr);te+=tr}),f.jsxs(G0.Fragment,{children:[f.jsxs("tr",{onClick:()=>cy(ue),style:{backgroundColor:"#1E3A5F",color:"white",cursor:"pointer",borderBottom:"1px solid #0F2744"},children:[f.jsx("td",{colSpan:"3",style:{padding:"10px 12px",fontWeight:"700",fontSize:"13px"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[Ie?f.jsx(B2,{size:18}):f.jsx(Vm,{size:18}),f.jsx(W2,{size:16}),ue,f.jsxs("span",{style:{backgroundColor:"#2874A6",padding:"2px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600"},children:[ge.length," inv"]})]})}),f.jsx("td",{colSpan:"4",style:{padding:"10px 12px"}}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",fontSize:"13px",backgroundColor:te===0?"#22C55E":"#3B82F6"},children:te===0?" Nil":`Bal: ${ft(te)}`}),f.jsx("td",{colSpan:"4",style:{padding:"10px 12px"}})]}),Ie&&ge.map(Xe=>{const xe=Z.find(vr=>vr.invoiceNo===Xe.invoiceNo),Ve=Be.find(vr=>vr.invoiceNo===Xe.invoiceNo),Ke=Ae.find(vr=>vr.invoiceNo===Xe.invoiceNo&&vr.type==="tds"),Qe=Ae.find(vr=>vr.invoiceNo===Xe.invoiceNo&&vr.type==="discount"),vt=Xe.totalAmount||0,jt=xe&&parseFloat(xe.amount)||0,Ge=Ke?parseFloat(Ke.credit)||0:xe&&parseFloat(xe.tds)||0,at=Ve?Math.abs(parseFloat(Ve.totalAmount)||0):0,lr=Qe&&parseFloat(Qe.credit)||0,tr=Math.max(0,vt-jt-Ge-at-lr),Vt=at>=vt&&!xe;return f.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:Xe.invoiceType==="Combined"?"#FAF5FF":tr===0?"#F0FDF4":"transparent"},children:[f.jsx("td",{style:{padding:"10px 12px 10px 36px",fontWeight:"700",color:Xe.invoiceType==="Combined"?"#7C3AED":"#2874A6"},children:Xe.invoiceNo}),f.jsx("td",{style:{padding:"10px 12px"},children:yr(Xe.date)}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsx(ng,{status:Xe.invoiceType,small:!0})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:ft(vt)}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#F0FDF4",color:jt>0?"#166534":"#94A3B8"},children:jt>0?ft(jt):"-"}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#FEF3C7",color:Ge>0?"#92400E":"#94A3B8"},children:Ge>0?ft(Ge):"-"}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#FEE2E2",color:at>0?"#991B1B":"#94A3B8"},children:at>0?ft(at):"-"}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#EFF6FF",color:tr>0?"#1E40AF":"#166534"},children:tr===0?" Nil":ft(tr)}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsx(ng,{status:Xe.invoiceStatus,small:!0})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:Vt?f.jsx("span",{style:{padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:" Cancelled"}):xe?f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",justifyContent:"center"},children:[f.jsxs("button",{onClick:()=>O4(xe),style:{padding:"4px 8px",borderRadius:"12px",fontSize:"10px",fontWeight:"700",backgroundColor:"#DCFCE7",color:"#166534",border:"none",cursor:"pointer",textDecoration:"underline"},title:"Click to view receipt",children:[" ",xe.receiptNo]}),Ht&&f.jsx("button",{onClick:()=>io(xe),style:{padding:"2px 4px",borderRadius:"4px",fontSize:"10px",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete Receipt",children:""})]}):f.jsx("span",{style:{padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600",backgroundColor:"#FEF3C7",color:"#92400E"},children:" Pending"})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:Ve?f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",justifyContent:"center"},children:[f.jsx("button",{onClick:()=>M4(Ve),style:{padding:"4px 8px",borderRadius:"12px",fontSize:"10px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer",textDecoration:"underline"},title:"Click to view credit note",children:Ve.creditNoteNo}),Ht&&f.jsx("button",{onClick:()=>u(Ve),style:{padding:"2px 4px",borderRadius:"4px",fontSize:"10px",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete Credit Note",children:""})]}):f.jsx("span",{style:{color:"#94A3B8",fontSize:"11px"},children:"-"})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsx("div",{style:{display:"flex",gap:"4px",justifyContent:"center",flexWrap:"wrap"},children:Xe.isHistorical?f.jsxs(f.Fragment,{children:[Ht&&!xe&&f.jsx(Ye,{icon:Qu,small:!0,variant:"success",onClick:()=>{const vr={invoiceNo:Xe.invoiceNo,partyName:Xe.partyName,invoiceDate:Xe.date,invoiceTotalAmount:Xe.totalAmount,invoiceStatus:"Approved",mailingSent:"Yes",invoiceType:"Historical",isHistorical:!0};Mu(vr)},title:"Create Receipt"}),Ht&&!Ve&&f.jsx(Ye,{icon:qu,small:!0,variant:"primary",onClick:()=>{const vr={invoiceNo:Xe.invoiceNo,partyName:Xe.partyName,invoiceDate:Xe.date,invoiceTotalAmount:Xe.totalAmount,invoiceStatus:"Approved",isHistorical:!0};Lu(vr)},title:"Credit Note"})]}):f.jsxs(f.Fragment,{children:[f.jsx(Ye,{icon:P0,small:!0,variant:"brand",onClick:()=>ju(Xe.campaigns[0]),title:"View Invoice"}),Ht&&Xe.invoiceStatus==="Approved"&&Xe.mailingSent==="Yes"&&!xe&&f.jsx(Ye,{icon:Qu,small:!0,variant:"success",onClick:()=>Mu(Xe.campaigns[0]),title:"Create Receipt"}),Ht&&Xe.invoiceStatus==="Approved"&&!Ve&&f.jsx(Ye,{icon:qu,small:!0,variant:"primary",onClick:()=>Lu(Xe.campaigns[0]),title:"Credit Note"}),Ht&&f.jsx(Ye,{icon:Ks,small:!0,variant:"danger",onClick:()=>uc(Xe.campaigns[0]),title:"Delete Invoice"})]})})})]},Xe.invoiceNo)})]},ue)})})]})})]})},tF=()=>{if(!H){alert("Please select a party first");return}const m=Ti[H]||0,C=ve.filter(ce=>er(ce.partyName,H)&&ce.invoiceGenerated&&ce.invoiceStatus==="Approved"&&(!X||_s(ce.statePartyDetails)===X)),Y=new Map;C.forEach(ce=>{Y.has(ce.invoiceNo)?Y.get(ce.invoiceNo).campaigns.push(ce):Y.set(ce.invoiceNo,{invoiceNo:ce.invoiceNo,invoiceDate:ce.invoiceDate,campaigns:[ce],isFromMaster:!0})});const ee=new Set(Array.from(Y.keys())),K=X?[]:Ae.filter(ce=>{var Ze;return er(ce.partyName,H)&&ce.isHistorical&&ce.type!=="creditnote"&&!((Ze=ce.vchNo)!=null&&Ze.toUpperCase().startsWith("CN"))}),q=X?[]:Ae.filter(ce=>{var Ze;return er(ce.partyName,H)&&ce.isHistorical&&(ce.type==="creditnote"||((Ze=ce.vchNo)==null?void 0:Ze.toUpperCase().startsWith("CN")))}),ne=Z.filter(ce=>er(ce.partyName,H)&&(!X||ee.has(ce.invoiceNo))),J=Be.filter(ce=>er(ce.partyName,H)&&(!X||ee.has(ce.invoiceNo))),Se=ce=>{if(!ce)return"";const Ze=ce.split("/");return Ze.length>=3?Ze.slice(1).join("/"):Ze.length===2?Ze.join("/"):Ze[Ze.length-1]},ue=new Map;J.forEach(ce=>{const Ze=Se(ce.invoiceNo);Ze&&!ue.has(Ze)&&ue.set(Ze,{...ce,isSystemCN:!0})}),q.forEach(ce=>{const Ze=Se(ce.vchNo);Ze&&!ue.has(Ze)&&ue.set(Ze,{...ce,isHistoricalCN:!0})});let ge=[],Ie=0,te=0,Xe=0,xe=0,Ve=m;const Ke=new Set;m!==0&&(Ie+=m>0?m:0,te+=m<0?Math.abs(m):0,ge.push({date:"",particular:"Opening Balance",vchType:"",vchNo:"",debit:m>0?m:0,credit:m<0?Math.abs(m):0,receiptDate:"",amountReceived:0,tds:0,balance:m,status:"",isMain:!0,isOpening:!0}));const Qe=[];Array.from(Y.values()).filter(ce=>{const Ze=new Date(ce.invoiceDate);return Ze>=new Date(sn.fromDate)&&Ze<=new Date(sn.toDate)}).forEach(ce=>{Qe.push({...ce,entryType:"invoice",sortDate:ce.invoiceDate})}),K.filter(ce=>{if(!ce.date)return!1;const Ze=new Date(ce.date);return Ze>=new Date(sn.fromDate)&&Ze<=new Date(sn.toDate)}).forEach(ce=>{Qe.push({...ce,entryType:"invoice",sortDate:ce.date})}),Qe.sort((ce,Ze)=>new Date(ce.sortDate)-new Date(Ze.sortDate)),Qe.forEach(ce=>{var Ze,nr;if(ce.isFromMaster){const Ar=ce;let Pr=0;Ar.campaigns.forEach(ui=>Pr+=parseFloat(ui.invoiceAmount)||0);const cr=(nr=(Ze=Ar.campaigns[0])==null?void 0:Ze.statePartyDetails)==null?void 0:nr.toUpperCase().includes("MAHARASHTRA"),Or=cr?Pr*.09:0,li=cr?Pr*.09:0,Mr=cr?0:Pr*.18,ci=Pr+Or+li+Mr,ur=Se(Ar.invoiceNo),an=ue.get(ur),Vn=!!an,Ea=ne.find(ui=>ui.invoiceNo===Ar.invoiceNo);Ve+=ci,Ie+=ci;let ao=0,Yi=0,ol="",Ws=Vn?"":"Pending";if(Ea&&(Ws="Received",ao=Ea.amount||0,Yi=Ea.tds||0,ol=Ea.date,Xe+=ao,xe+=Yi,Ve-=ao+Yi+(Ea.discount||0)),ge.push({date:Ar.invoiceDate,particular:H,vchType:"Sales",vchNo:Ar.invoiceNo,debit:ci,credit:0,receiptDate:ol,amountReceived:ao,tds:Yi,balance:Vn?"-":Ws==="Received"?0:ci-ao-Yi,status:Ws,isMain:!0,hasCN:Vn}),ge.push({particular:"PROMOTIONAL TRADE EMAILER"+(Ar.campaigns.length>1?"S":""),credit:Pr,isMain:!1,hasCN:Vn}),cr?(ge.push({particular:"CGST",credit:Or,isMain:!1,hasCN:Vn}),ge.push({particular:"SGST",credit:li,isMain:!1,hasCN:Vn})):ge.push({particular:"IGST",credit:Mr,isMain:!1,hasCN:Vn}),an&&!Ke.has(ur)){Ke.add(ur);const ui=Math.abs(an.totalAmount||an.credit||0);Ve-=ui,te+=ui,ge.push({date:an.date,particular:H,vchType:"Credit Note",vchNo:an.creditNoteNo||an.vchNo,debit:0,credit:ui,receiptDate:"",amountReceived:0,tds:0,balance:"-",status:"",isMain:!0,isCreditNote:!0,hasCN:!0});const oo=Math.abs(an.amount)||ui/1.18,s0=Math.abs(an.gst)||ui-oo;ge.push({particular:"PROMOTIONAL TRADE EMAILER",credit:oo,isMain:!1,isCreditNote:!0,hasCN:!0}),ge.push({particular:an.gstType||(cr?"CGST + SGST":"IGST"),credit:s0,isMain:!1,isCreditNote:!0,hasCN:!0})}}else if(ce.isHistorical){const Ar=ce.debit||0,Pr=ce.credit||0,cr=Se(ce.vchNo),Or=ue.get(cr),li=!!Or;if(Ve+=Ar-Pr,Ie+=Ar,te+=Pr,ge.push({date:ce.date,particular:ce.particulars||H,vchType:ce.vchType||"Sales",vchNo:ce.vchNo,debit:Ar,credit:Pr,receiptDate:ce.receiptDate||"",amountReceived:ce.amountReceived||0,tds:ce.tdsReceived||0,balance:li?"-":Ar-(ce.amountReceived||0)-(ce.tdsReceived||0),status:li?"":ce.paymentStatus||"",isMain:!0,isHistorical:!0,hasCN:li}),ce.subRows&&ce.subRows.length>0&&ce.subRows.forEach(Mr=>{ge.push({particular:Mr.particular,debit:Mr.debit,credit:Mr.credit,isMain:!1,hasCN:li})}),Or&&!Ke.has(cr)){Ke.add(cr);const Mr=Math.abs(Or.totalAmount||Or.credit||0);Ve-=Mr,te+=Mr,ge.push({date:Or.date,particular:H,vchType:"Credit Note",vchNo:Or.creditNoteNo||Or.vchNo,debit:0,credit:Mr,receiptDate:"",amountReceived:0,tds:0,balance:"-",status:"",isMain:!0,isCreditNote:!0,hasCN:!0}),Or.subRows&&Or.subRows.length>0&&Or.subRows.forEach(ci=>{ge.push({particular:ci.particular,credit:Math.abs(ci.credit||0),isMain:!1,isCreditNote:!0,hasCN:!0})})}}});const vt=ge.reduce((ce,Ze)=>Ze.isMain&&typeof Ze.balance=="number"&&Ze.balance>0?ce+Ze.balance:ce,0),jt=(H||"").trim().toUpperCase();let Ge={};X&&(Ge=As.find(ce=>ce.partyNameUpper===jt&&ce.normalizedState===X)||{}),Ge.state||(Ge=As.find(ce=>ce.partyNameUpper===jt)||{});const at=ve.find(ce=>{var Ze;return((Ze=ce.partyName)==null?void 0:Ze.trim().toUpperCase())===jt}),lr=Ge.state||(at==null?void 0:at.statePartyDetails)||"",tr=Ge.address||va(H,lr)||"",Vt=Ge.gstin||xa(H,lr),vr=`
<!DOCTYPE html>
<html>
<head>
  <title>Ledger Account - ${H}</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; font-size: 11px; padding: 20px; }
    .header { text-align: center; margin-bottom: 15px; }
    .firm-name { font-size: 18px; font-weight: bold; color: #1E293B; }
    .firm-address { font-size: 10px; color: #666; margin-top: 2px; }
    .party-section { text-align: center; margin: 15px 0; padding: 10px; border: 1px solid #ddd; background: #f9f9f9; }
    .party-name { font-size: 14px; font-weight: bold; }
    .ledger-title { font-size: 11px; color: #666; }
    .party-address { font-size: 10px; color: #666; margin-top: 5px; }
    .party-gstin { font-size: 10px; color: #1a5276; margin-top: 3px; font-weight: 600; }
    .period { text-align: center; font-size: 11px; margin: 10px 0; font-weight: bold; }
    .totals { display: flex; justify-content: space-around; background: #e8f4fd; padding: 8px; margin-bottom: 10px; font-size: 10px; border: 1px solid #ccc; }
    .totals div { text-align: center; }
    .totals .label { color: #666; }
    .totals .value { font-weight: bold; font-size: 11px; }
    .closing-balance { text-align: center; background: #1E293B; color: white; padding: 10px; margin-bottom: 10px; font-size: 14px; font-weight: bold; }
    table { width: 100%; border-collapse: collapse; font-size: 10px; }
    th { background: #f0f0f0; border: 1px solid #ccc; padding: 6px 4px; text-align: left; font-weight: bold; }
    td { border: 1px solid #ddd; padding: 5px 4px; }
    .text-right { text-align: right; }
    .text-center { text-align: center; }
    .main-row { background: #fff; }
    .main-row-cn { background: #fffbeb; }
    .sub-row { background: #fafafa; }
    .sub-row-cn { background: #fffbeb; }
    .sub-row td { padding-left: 20px; color: #666; font-size: 9px; }
    .opening-row { background: #fef3c7; font-weight: bold; }
    .credit-note-row { background: #fffbeb; }
    .status-received { background: #dcfce7; color: #166534; padding: 2px 6px; border-radius: 3px; font-size: 9px; }
    .status-pending { background: #fef3c7; color: #92400e; padding: 2px 6px; border-radius: 3px; font-size: 9px; }
    .debit { color: #dc2626; }
    .credit { color: #059669; }
    @media print { 
      body { padding: 10px; } 
      @page { size: landscape; margin: 10mm; }
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="firm-name">${S.name}</div>
    <div class="firm-address">${S.address}</div>
    <div class="firm-address">${S.addressLine2}, ${S.city}</div>
    <div class="firm-address">E-Mail: ${S.email}</div>
  </div>
  
  <div class="party-section">
    <div class="party-name">${H}</div>
    <div class="ledger-title">Ledger Account</div>
    ${tr?`<div class="party-address">${tr}</div>`:""}
    ${lr?`<div class="party-address"> ${lr}</div>`:""}
    ${Vt?`<div class="party-gstin">GSTIN: ${Vt}</div>`:""}
  </div>
  
  <div class="period">${yr(sn.fromDate)} to ${yr(sn.toDate)}</div>
  
  <div class="closing-balance">
    Closing Balance: ${Ut(Math.abs(vt))} ${vt>0?"(Dr)":vt<0?"(Cr)":""}
  </div>
  
  <div class="totals">
    <div><div class="label">Debit</div><div class="value">${Ut(Ie)}</div></div>
    <div><div class="label">Credit</div><div class="value">${Ut(te)}</div></div>
    <div><div class="label">Amount Received</div><div class="value credit">${Ut(Xe)}</div></div>
    <div><div class="label">TDS Received</div><div class="value">${Ut(xe)}</div></div>
  </div>
  
  <table>
    <thead>
      <tr>
        <th style="width:65px">Date</th>
        <th>Particular</th>
        <th style="width:70px" class="text-center">Vch Type</th>
        <th style="width:100px">Vch No.</th>
        <th style="width:80px" class="text-right">Debit</th>
        <th style="width:80px" class="text-right">Credit</th>
        <th style="width:70px" class="text-center">Date of Receipt</th>
        <th style="width:85px" class="text-right">Amount Received</th>
        <th style="width:70px" class="text-right">TDS Received</th>
        <th style="width:75px" class="text-right">Balance</th>
        <th style="width:70px" class="text-center">Payment Status</th>
      </tr>
    </thead>
    <tbody>
      ${ge.map(ce=>ce.isMain?`
        <tr class="${ce.isOpening?"opening-row":ce.hasCN||ce.isCreditNote?"main-row-cn":"main-row"}">
          <td>${ce.date?yr(ce.date):""}</td>
          <td style="font-weight:600">${ce.particular}</td>
          <td class="text-center">${ce.vchType||""}</td>
          <td style="color:#2874A6;font-weight:600">${ce.vchNo||""}</td>
          <td class="text-right">${ce.debit>0?Ut(ce.debit):""}</td>
          <td class="text-right" style="color:#DC2626">${ce.credit>0?Ut(ce.credit):""}</td>
          <td class="text-center">${ce.receiptDate?yr(ce.receiptDate):""}</td>
          <td class="text-right credit">${ce.amountReceived>0?Ut(ce.amountReceived):""}</td>
          <td class="text-right">${ce.tds>0?Ut(ce.tds):""}</td>
          <td class="text-right">${ce.balance==="-"?"-":ce.balance>0?Ut(ce.balance):""}</td>
          <td class="text-center">${ce.status?`<span class="${ce.status==="Received"?"status-received":"status-pending"}">${ce.status}</span>`:""}</td>
        </tr>
      `:`
        <tr class="${ce.hasCN||ce.isCreditNote?"sub-row-cn":"sub-row"}">
          <td></td>
          <td style="padding-left:20px;color:#666">${ce.particular}</td>
          <td></td>
          <td></td>
          <td class="text-right">${ce.debit?Ut(ce.debit):""}</td>
          <td class="text-right">${ce.credit?Ut(ce.credit):""}</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
      `).join("")}
    </tbody>
  </table>
  
  <script>window.onload = function() { window.print(); }<\/script>
</body>
</html>`,Ne=window.open("","_blank");Ne.document.write(vr),Ne.document.close()},rF=()=>{const m=(J,Se)=>{const ue=Ti[J]||0,ge=ve.filter(Ge=>er(Ge.partyName,J)&&Ge.invoiceGenerated&&Ge.invoiceStatus==="Approved"&&(!Se||_s(Ge.statePartyDetails)===Se)),Ie=new Map;ge.forEach(Ge=>{Ie.has(Ge.invoiceNo)?Ie.get(Ge.invoiceNo).campaigns.push(Ge):Ie.set(Ge.invoiceNo,{invoiceNo:Ge.invoiceNo,campaigns:[Ge],totalAmount:parseFloat(Ge.invoiceTotalAmount)||0})});const te=new Set(Array.from(Ie.keys())),Xe=Z.filter(Ge=>er(Ge.partyName,J)&&(!Se||te.has(Ge.invoiceNo))),xe=Be.filter(Ge=>er(Ge.partyName,J)&&(!Se||te.has(Ge.invoiceNo))),Ve=Se?[]:Ae.filter(Ge=>{var at;return er(Ge.partyName,J)&&Ge.isHistorical&&Ge.type!=="creditnote"&&!((at=Ge.vchNo)!=null&&at.toUpperCase().startsWith("CN"))}),Ke=Se?[]:Ae.filter(Ge=>{var at;return er(Ge.partyName,J)&&Ge.isHistorical&&(Ge.type==="creditnote"||((at=Ge.vchNo)==null?void 0:at.toUpperCase().startsWith("CN")))}),Qe=Ge=>{if(!Ge)return"";const at=Ge.split("/");return at.length>=3?at.slice(1).join("/"):at.length===2?at.join("/"):at[at.length-1]},vt=new Map;xe.forEach(Ge=>{const at=Qe(Ge.invoiceNo);at&&!vt.has(at)&&vt.set(at,Ge)}),Ke.forEach(Ge=>{const at=Qe(Ge.vchNo);at&&!vt.has(at)&&vt.set(at,Ge)});let jt=0;return ue>0&&(jt+=ue),Array.from(Ie.values()).forEach(Ge=>{const at=Ge.totalAmount,lr=Qe(Ge.invoiceNo),tr=vt.get(lr),Vt=tr?Math.abs(parseFloat(tr.totalAmount)||parseFloat(tr.credit)||0):0;if(!(tr&&Vt>=at)){let Ne=tr?at-Vt:at;const ce=Xe.find(Ze=>Ze.invoiceNo===Ge.invoiceNo);if(ce){const Ze=Ne-(parseFloat(ce.amount)||0)-(parseFloat(ce.tds)||0)-(parseFloat(ce.discount)||0);Ze>0&&(jt+=Ze)}else Ne>0&&(jt+=Ne)}}),Ve.forEach(Ge=>{const at=Qe(Ge.vchNo),lr=vt.get(at),tr=lr?Math.abs(parseFloat(lr.totalAmount)||parseFloat(lr.credit)||parseFloat(lr.debit)||0):0,Vt=parseFloat(Ge.debit)||0;if(!(lr&&tr>=Vt)){let Ne=lr?Vt-tr:Vt;const ce=parseFloat(Ge.amountReceived)||0,Ze=parseFloat(Ge.tdsReceived)||0,nr=Ne-ce-Ze;nr>0&&(jt+=nr)}}),jt},C=As.filter(J=>J.partyName.toLowerCase().includes(ha.toLowerCase())||J.state&&J.state.toLowerCase().includes(ha.toLowerCase())),Y=J=>{if(X){const Ie=As.find(te=>te.partyNameUpper===(J||"").trim().toUpperCase()&&te.normalizedState===X);if(Ie!=null&&Ie.state)return Ie.state}const Se=(J||"").trim().toUpperCase(),ue=ve.find(Ie=>{var te;return((te=Ie.partyName)==null?void 0:te.trim().toUpperCase())===Se});if(ue!=null&&ue.statePartyDetails)return ue.statePartyDetails;const ge=As.find(Ie=>Ie.partyNameUpper===Se);return(ge==null?void 0:ge.state)||""},ee=J=>{const Se=(J||"").trim().toUpperCase();if(X){const ge=As.find(Ie=>Ie.partyNameUpper===Se&&Ie.normalizedState===X);if(ge!=null&&ge.address)return ge.address}const ue=As.find(ge=>ge.partyNameUpper===Se);return ue!=null&&ue.address?ue.address:va(J,Y(J))},K=J=>{const Se=(J||"").trim().toUpperCase();if(X){const Ie=As.find(te=>te.partyNameUpper===Se&&te.normalizedState===X);if(Ie!=null&&Ie.gstin)return Ie.gstin}const ue=As.find(Ie=>Ie.partyNameUpper===Se);if(ue!=null&&ue.gstin)return ue.gstin;const ge=ve.find(Ie=>{var te;return((te=Ie.partyName)==null?void 0:te.trim().toUpperCase())===Se});return ge?xa(J,ge.statePartyDetails):""},ne=(()=>{if(!H)return{entries:[],totals:{debit:0,credit:0,received:0,tds:0,balance:0}};const J=Ti[H]||0,Se=Ne=>{if(!Ne)return"";const ce=Ne.split("/");return ce.length>=3?ce.slice(1).join("/"):ce.length===2?ce.join("/"):ce[ce.length-1]},ue=ve.filter(Ne=>er(Ne.partyName,H)&&Ne.invoiceGenerated&&Ne.invoiceStatus==="Approved"&&(!X||_s(Ne.statePartyDetails)===X)),ge=new Map;ue.forEach(Ne=>{ge.has(Ne.invoiceNo)?ge.get(Ne.invoiceNo).campaigns.push(Ne):ge.set(Ne.invoiceNo,{invoiceNo:Ne.invoiceNo,invoiceDate:Ne.invoiceDate,invoiceType:Ne.invoiceType,combinationCode:Ne.combinationCode,receiptStatus:Ne.receiptStatus,receiptNo:Ne.receiptNo,receiptDate:Ne.receiptDate,creditNoteNo:Ne.creditNoteNo,campaigns:[Ne],isFromMaster:!0})});const Ie=new Set(Array.from(ge.keys())),te=X?[]:Ae.filter(Ne=>{var ce;return er(Ne.partyName,H)&&Ne.isHistorical&&Ne.type!=="creditnote"&&!((ce=Ne.vchNo)!=null&&ce.toUpperCase().startsWith("CN"))}),Xe=X?[]:Ae.filter(Ne=>{var ce;return er(Ne.partyName,H)&&Ne.isHistorical&&(Ne.type==="creditnote"||((ce=Ne.vchNo)==null?void 0:ce.toUpperCase().startsWith("CN")))}),xe=Z.filter(Ne=>er(Ne.partyName,H)&&(!X||Ie.has(Ne.invoiceNo))),Ve=Be.filter(Ne=>er(Ne.partyName,H)&&(!X||Ie.has(Ne.invoiceNo))),Ke=new Map;Ve.forEach(Ne=>{const ce=Se(Ne.invoiceNo);ce&&!Ke.has(ce)&&Ke.set(ce,{...Ne,isSystemCN:!0})}),Xe.forEach(Ne=>{const ce=Se(Ne.vchNo);ce&&!Ke.has(ce)&&Ke.set(ce,{...Ne,isHistoricalCN:!0})});const Qe=[];let vt=J,jt=0,Ge=0,at=0,lr=0;const tr=new Set;J!==0&&(Qe.push({id:"opening",date:"",particular:"Opening Balance",vchType:"",vchNo:"",debit:J>0?J:0,credit:J<0?Math.abs(J):0,receiptDate:"",amountReceived:0,tdsReceived:0,balance:J,paymentStatus:"",isOpening:!0,subRows:[]}),jt+=J>0?J:0,Ge+=J<0?Math.abs(J):0);const Vt=[];Array.from(ge.values()).filter(Ne=>{const ce=new Date(Ne.invoiceDate),Ze=new Date(sn.fromDate),nr=new Date(sn.toDate);return ce>=Ze&&ce<=nr}).forEach(Ne=>{Vt.push({...Ne,entryType:"invoice",sortDate:Ne.invoiceDate})}),te.filter(Ne=>{if(!Ne.date)return!1;const ce=new Date(Ne.date),Ze=new Date(sn.fromDate),nr=new Date(sn.toDate);return ce>=Ze&&ce<=nr}).forEach(Ne=>{Vt.push({...Ne,entryType:Ne.type||"invoice",sortDate:Ne.date})}),Vt.sort((Ne,ce)=>new Date(Ne.sortDate)-new Date(ce.sortDate)),Vt.forEach(Ne=>{var ce,Ze;if(Ne.isFromMaster){const nr=Ne;let Ar=0;nr.campaigns.forEach(Hs=>{Ar+=parseFloat(Hs.invoiceAmount)||0});const Pr=(Ze=(ce=nr.campaigns[0])==null?void 0:ce.statePartyDetails)==null?void 0:Ze.toUpperCase().includes("MAHARASHTRA"),cr=Pr?Ar*.09:0,Or=Pr?Ar*.09:0,li=Pr?0:Ar*.18,Mr=Ar+cr+Or+li,ci=Se(nr.invoiceNo),ur=Ke.get(ci),an=ur?Math.abs(ur.totalAmount||ur.credit||0):0,Vn=!!ur,Ea=Vn&&an>=Mr,ao=Vn&&!Ea?Mr-an:0,Yi=xe.find(Hs=>Hs.invoiceNo===nr.invoiceNo);vt+=Mr,jt+=Mr;const ol=[{particular:"PROMOTIONAL TRADE EMAILER"+(nr.campaigns.length>1?"S":""),credit:Ar}];Pr?(ol.push({particular:"CGST",credit:cr}),ol.push({particular:"SGST",credit:Or})):ol.push({particular:"IGST",credit:li});let Ws="",ui=0,oo=0,s0="",hc=Mr;if(Yi?(Ws="Received",ui=Yi.amount||0,oo=Yi.tds||0,s0=Yi.date,at+=ui,lr+=oo,hc=Mr-ui-oo-(Yi.discount||0),vt-=ui+oo+(Yi.discount||0)):nr.receiptStatus==="Received"?(Ws="Received",hc=0):Ea?(Ws="CN Closed",hc=0):Vn&&ao>0?(Ws="Partial CN",hc=ao):Ws="Pending",Qe.push({id:nr.invoiceNo,date:nr.invoiceDate,particular:H,vchType:"Sales",vchNo:nr.invoiceNo,debit:Mr,credit:0,receiptDate:s0,amountReceived:ui,tdsReceived:oo,balance:Ea?"-":hc>0?hc:0,paymentStatus:Ws,isInvoice:!0,hasCN:Vn,subRows:ol}),ur&&!tr.has(ci)){tr.add(ci);const Hs=Math.abs(ur.totalAmount||ur.credit||0);vt-=Hs,Ge+=Hs;const ll=[];if(ur.amount&&ll.push({particular:"PROMOTIONAL TRADE EMAILER",credit:Math.abs(ur.amount)}),ur.gst&&ll.push({particular:ur.gstType||(Pr?"CGST + SGST":"IGST"),credit:Math.abs(ur.gst)}),ll.length===0&&Hs>0){const py=Hs/1.18,cF=Hs-py;ll.push({particular:"PROMOTIONAL TRADE EMAILER",credit:py}),ll.push({particular:Pr?"CGST + SGST":"IGST",credit:cF})}Qe.push({id:ur.id||ur.creditNoteNo||`cn-${ci}`,date:ur.date,particular:H,vchType:"Credit Note",vchNo:ur.creditNoteNo||ur.vchNo,debit:0,credit:Hs,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:ur.isHistoricalCN&&ur.subRows||ll})}}else if(Ne.isHistorical){const nr=Ne.debit||0,Ar=Ne.credit||0,Pr=Se(Ne.vchNo),cr=Ke.get(Pr),Or=cr?Math.abs(cr.totalAmount||cr.credit||0):0,li=!!cr,Mr=li&&Or>=nr,ci=li&&!Mr?nr-Or:0;vt+=nr-Ar,jt+=nr,Ge+=Ar,Ne.amountReceived&&(at+=Ne.amountReceived),Ne.tdsReceived&&(lr+=Ne.tdsReceived);const ur=Ne.subRows||[];let an=nr-(Ne.amountReceived||0)-(Ne.tdsReceived||0),Vn=Ne.paymentStatus||"";Mr?(an=0,Vn="CN Closed"):li&&ci>0&&(an=ci-(Ne.amountReceived||0)-(Ne.tdsReceived||0),an>0&&(Vn="Partial CN")),Qe.push({id:Ne.id,date:Ne.date,particular:Ne.particulars||H,vchType:Ne.vchType||"Sales",vchNo:Ne.vchNo,debit:nr,credit:Ar,receiptDate:Ne.receiptDate||"",amountReceived:Ne.amountReceived||0,tdsReceived:Ne.tdsReceived||0,balance:Mr?"-":an>0?an:0,paymentStatus:Vn,isInvoice:!0,isHistorical:!0,hasCN:li,subRows:ur}),cr&&!tr.has(Pr)&&(tr.add(Pr),vt-=Or,Ge+=Or,Qe.push({id:cr.id||cr.creditNoteNo||cr.vchNo||`cn-${Pr}`,date:cr.date,particular:H,vchType:"Credit Note",vchNo:cr.creditNoteNo||cr.vchNo,debit:0,credit:Or,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:cr.subRows||[]}))}});const vr=Qe.reduce((Ne,ce)=>typeof ce.balance=="number"&&ce.balance>0?Ne+ce.balance:Ne,0);return{entries:Qe,totals:{debit:jt,credit:Ge,received:at,tds:lr,balance:vr}}})();return f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[f.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Party Ledgers"}),f.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[jn&&f.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"}),Ht&&f.jsx(Ye,{icon:Xs,label:"Import Historical",variant:"brand",onClick:()=>rl(!0)}),Ht&&H&&Ae.some(J=>er(J.partyName,H)&&J.isHistorical)&&f.jsx(Ye,{icon:Ks,label:"Clear Historical",variant:"danger",onClick:k}),Ht&&f.jsx(Ye,{icon:Hm,label:"Opening Balance",variant:"primary",onClick:()=>Ki(!0)})]})]}),f.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(VB,{size:18,color:"#64748B"}),f.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Period:"})]}),f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx("input",{type:"date",value:sn.fromDate,onChange:J=>da(Se=>({...Se,fromDate:J.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}}),f.jsx("span",{style:{color:"#64748B"},children:"to"}),f.jsx("input",{type:"date",value:sn.toDate,onChange:J=>da(Se=>({...Se,toDate:J.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}})]}),f.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:"10px"},children:H&&f.jsx(Ye,{icon:Yu,label:"Download PDF",variant:"brand",onClick:tF})})]})}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr",gap:"16px"},children:[f.jsxs(Tn,{title:"Parties",noPadding:!0,children:[f.jsx("div",{style:{padding:"12px",borderBottom:"1px solid #E2E8F0"},children:f.jsxs("div",{style:{position:"relative"},children:[f.jsx(L0,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"text",placeholder:"Search party...",value:ha,onChange:J=>pa(J.target.value),style:{width:"100%",padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",boxSizing:"border-box"}})]})}),f.jsx("div",{style:{maxHeight:"450px",overflowY:"auto"},children:C.length===0?f.jsx("div",{style:{padding:"30px",textAlign:"center",color:"#94A3B8",fontSize:"14px"},children:ha?"No matching parties":"No parties yet"}):C.map((J,Se)=>{const ue=m(J.partyName,J.normalizedState),ge=er(H,J.partyName)&&X===J.normalizedState;return f.jsxs("div",{onClick:()=>{Q(J.partyName),he(J.normalizedState||null)},style:{padding:"14px 18px",borderBottom:"1px solid #F1F5F9",cursor:"pointer",backgroundColor:ge?"#EFF6FF":"transparent",borderLeft:ge?"4px solid #2874A6":"4px solid transparent"},children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"14px",color:"#1E293B"},children:J.partyName}),J.state&&f.jsxs("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"2px"},children:[" ",J.state]}),J.gstin&&f.jsxs("div",{style:{fontSize:"10px",color:"#2874A6",marginTop:"1px"},children:["GST: ",J.gstin]}),f.jsxs("div",{style:{fontSize:"14px",color:ue>0?"#DC2626":"#059669",fontWeight:"700",marginTop:"4px"},children:[ue>0?"Dr. ":"Cr. ",ft(Math.abs(ue))]})]},`${J.partyName}-${J.state}-${Se}`)})})]}),f.jsx(Tn,{title:H?"Ledger Account":"Select a Party",noPadding:!0,children:H?f.jsxs("div",{style:{fontSize:"12px"},children:[f.jsxs("div",{style:{textAlign:"center",padding:"16px",borderBottom:"2px solid #1E3A5F",backgroundColor:"#F8FAFC"},children:[f.jsx("div",{style:{fontSize:"16px",fontWeight:"700",color:"#1E3A5F"},children:S.name}),f.jsx("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"4px"},children:S.address}),f.jsxs("div",{style:{fontSize:"11px",color:"#64748B"},children:[S.addressLine2,", ",S.city]}),f.jsxs("div",{style:{fontSize:"11px",color:"#64748B"},children:["E-Mail: ",S.email]})]}),f.jsxs("div",{style:{textAlign:"center",padding:"12px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FFFFFF"},children:[f.jsx("div",{style:{fontSize:"14px",fontWeight:"700",color:"#1E293B"},children:H}),f.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#64748B"},children:"Ledger Account"}),ee(H)&&f.jsx("div",{style:{fontSize:"11px",color:"#475569",marginTop:"4px"},children:ee(H)}),Y(H)&&f.jsxs("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"2px"},children:[" ",Y(H)]}),K(H)&&f.jsxs("div",{style:{fontSize:"11px",color:"#2874A6",marginTop:"3px",fontWeight:"600"},children:["GSTIN: ",K(H)]})]}),f.jsx("div",{style:{textAlign:"center",padding:"8px",backgroundColor:"#F1F5F9",borderBottom:"1px solid #E2E8F0"},children:f.jsxs("span",{style:{fontSize:"11px",fontWeight:"600",color:"#475569"},children:[yr(sn.fromDate)," to ",yr(sn.toDate)]})}),f.jsxs("div",{style:{backgroundColor:"#1E293B",color:"white",padding:"12px 16px",display:"flex",justifyContent:"center",alignItems:"center",gap:"12px",borderBottom:"3px solid #F59E0B"},children:[f.jsx("span",{style:{fontSize:"14px",fontWeight:"600"},children:"Closing Balance:"}),f.jsxs("span",{style:{fontSize:"18px",fontWeight:"700",color:ne.totals.balance>0?"#FCA5A5":"#86EFAC"},children:[Ut(Math.abs(ne.totals.balance))," ",ne.totals.balance>0?"(Dr)":ne.totals.balance<0?"(Cr)":""]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",backgroundColor:"#EFF6FF",borderBottom:"2px solid #2874A6",fontSize:"11px"},children:[f.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[f.jsx("div",{style:{color:"#64748B"},children:"Debit"}),f.jsx("div",{style:{fontWeight:"700",color:"#1E293B"},children:Ut(ne.totals.debit)})]}),f.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[f.jsx("div",{style:{color:"#64748B"},children:"Credit"}),f.jsx("div",{style:{fontWeight:"700",color:"#DC2626"},children:Ut(ne.totals.credit)})]}),f.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[f.jsx("div",{style:{color:"#64748B"},children:"Amount Received"}),f.jsx("div",{style:{fontWeight:"700",color:"#059669"},children:Ut(ne.totals.received)})]}),f.jsxs("div",{style:{padding:"8px",textAlign:"center"},children:[f.jsx("div",{style:{color:"#64748B"},children:"TDS Received"}),f.jsx("div",{style:{fontWeight:"700",color:"#1E293B"},children:Ut(ne.totals.tds)})]})]}),f.jsx("div",{style:{overflowX:"auto"},children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px",minWidth:"1000px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[f.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",width:"75px",borderRight:"1px solid #E2E8F0"},children:"Date"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",minWidth:"150px",borderRight:"1px solid #E2E8F0"},children:"Particular"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"80px",borderRight:"1px solid #E2E8F0"},children:"Vch Type"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",width:"110px",borderRight:"1px solid #E2E8F0"},children:"Vch No."}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Debit"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Credit"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"85px",borderRight:"1px solid #E2E8F0"},children:"Date of Receipt"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Amount Received"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"80px",borderRight:"1px solid #E2E8F0"},children:"TDS Received"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"85px",borderRight:"1px solid #E2E8F0"},children:"Balance"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"75px",borderRight:"1px solid #E2E8F0"},children:"Payment Status"}),Ht&&f.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"50px"},children:"Action"})]})}),f.jsx("tbody",{children:ne.entries.length===0?f.jsx("tr",{children:f.jsx("td",{colSpan:Ht?"12":"11",style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:"No entries in selected period"})}):ne.entries.map(J=>f.jsxs(G0.Fragment,{children:[f.jsxs("tr",{style:{backgroundColor:J.isOpening?"#FEF3C7":J.hasCN||J.isCreditNote?"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #E2E8F0",borderLeft:J.hasCN||J.isCreditNote?"4px solid #F59E0B":"none"},children:[f.jsx("td",{style:{padding:"8px",borderRight:"1px solid #E2E8F0"},children:J.date?yr(J.date):""}),f.jsx("td",{style:{padding:"8px",fontWeight:"600",color:J.isCreditNote?"#DC2626":"#1E293B",borderRight:"1px solid #E2E8F0"},children:J.particular}),f.jsx("td",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #E2E8F0"},children:J.vchType&&f.jsx("span",{style:{padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:J.vchType==="Sales"?"#DCFCE7":"#FEE2E2",color:J.vchType==="Sales"?"#166534":"#991B1B"},children:J.vchType})}),f.jsx("td",{style:{padding:"8px",borderRight:"1px solid #E2E8F0"},children:J.vchNo&&J.isInvoice&&!J.isHistorical?f.jsx("button",{onClick:()=>Bu(J.vchNo),style:{background:"none",border:"none",padding:0,fontWeight:"600",color:"#2874A6",cursor:"pointer",textDecoration:"underline",fontSize:"11px"},title:"Click to view invoice",children:J.vchNo}):f.jsx("span",{style:{fontWeight:"600",color:J.isCreditNote?"#DC2626":"#2874A6"},children:J.vchNo})}),f.jsx("td",{style:{padding:"8px",textAlign:"right",fontWeight:"600",borderRight:"1px solid #E2E8F0"},children:J.debit>0?Ut(J.debit):""}),f.jsx("td",{style:{padding:"8px",textAlign:"right",color:"#DC2626",borderRight:"1px solid #E2E8F0"},children:J.credit>0?Ut(J.credit):""}),f.jsx("td",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #E2E8F0"},children:J.receiptDate?yr(J.receiptDate):""}),f.jsx("td",{style:{padding:"8px",textAlign:"right",color:"#059669",fontWeight:J.amountReceived>0?"600":"400",borderRight:"1px solid #E2E8F0"},children:J.amountReceived>0?Ut(J.amountReceived):""}),f.jsx("td",{style:{padding:"8px",textAlign:"right",borderRight:"1px solid #E2E8F0"},children:J.tdsReceived>0?Ut(J.tdsReceived):""}),f.jsx("td",{style:{padding:"8px",textAlign:"right",fontWeight:"600",color:typeof J.balance=="number"&&J.balance>0?"#DC2626":"",borderRight:"1px solid #E2E8F0"},children:J.isOpening?J.balance>0?Ut(J.balance):"":J.balance==="-"?"-":typeof J.balance=="number"&&J.balance>0?Ut(J.balance):"-"}),f.jsx("td",{style:{padding:"8px",textAlign:"center"},children:J.paymentStatus&&f.jsx("span",{style:{padding:"2px 8px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:J.paymentStatus==="Received"?"#DCFCE7":"#FEF3C7",color:J.paymentStatus==="Received"?"#166534":"#92400E"},children:J.paymentStatus})}),Ht&&f.jsx("td",{style:{padding:"8px",textAlign:"center"},children:J.isHistorical&&!J.isOpening&&f.jsx("button",{onClick:()=>v(Ae.find(Se=>Se.id===J.id)),style:{padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete historical entry",children:""})})]}),J.subRows&&J.subRows.length>0&&J.subRows.map((Se,ue)=>f.jsxs("tr",{style:{backgroundColor:J.isOpening?"#FEF3C7":J.hasCN||J.isCreditNote?"#FFFBEB":"#FFFFFF",borderBottom:ue===J.subRows.length-1?"2px solid #CBD5E1":"1px solid #E2E8F0",borderLeft:J.hasCN||J.isCreditNote?"4px solid #F59E0B":"none"},children:[f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px 6px 30px",color:"#475569",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:Se.particular}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:Se.debit?Ut(Se.debit):""}),f.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:Se.credit?Ut(Se.credit):""}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),Ht&&f.jsx("td",{style:{padding:"6px 8px"}})]},`${J.id}-sub-${ue}`))]},J.id))})]})})]}):f.jsx("div",{style:{padding:"60px",textAlign:"center",color:"#94A3B8"},children:"Select a party to view ledger"})})]})]})},[dc,fy]=ye.useState(""),n0=ye.useMemo(()=>{const m=new Map,C=K=>{if(!K)return"";const q=K.split("/");return q.length>=3?q.slice(1).join("/"):q.length===2?q.join("/"):q[q.length-1]},Y=Ni.filter(K=>{var q;return K.isHistorical&&(K.type==="creditnote"||((q=K.vchNo)==null?void 0:q.toUpperCase().startsWith("CN")))}),ee=new Map;return nc.forEach(K=>{const q=C(K.invoiceNo);q&&ee.set(q,K)}),Y.forEach(K=>{const q=C(K.vchNo);q&&!ee.has(q)&&ee.set(q,K)}),Dr.filter(K=>K.invoiceGenerated&&K.invoiceStatus==="Approved").forEach(K=>{if(m.has(K.invoiceNo))m.has(K.invoiceNo)&&m.get(K.invoiceNo).campaigns.push(K);else{const q=rc.find(ge=>ge.invoiceNo===K.invoiceNo),ne=nc.find(ge=>ge.invoiceNo===K.invoiceNo),J=parseFloat(K.invoiceTotalAmount)||0,Se=ne?Math.abs(parseFloat(ne.totalAmount)||parseFloat(ne.credit)||0):0,ue=ne&&Se>=J;if(!q&&!ue){const ge=ne?J-Se:J;m.set(K.invoiceNo,{invoiceNo:K.invoiceNo,partyName:K.partyName,invoiceDate:K.invoiceDate,invoiceTotalAmount:K.invoiceTotalAmount,pendingAmount:ge,hasPartialCN:!!ne&&!ue&&Se>0,cnAmount:Se,subject:K.subject,campaigns:[K],isHistorical:!1,invoiceType:K.invoiceType||"Individual"})}}}),Ni.filter(K=>{var q;return K.isHistorical&&K.type!=="creditnote"&&!((q=K.vchNo)!=null&&q.toUpperCase().startsWith("CN"))&&K.debit>0}).forEach(K=>{if(!m.has(K.vchNo)){const q=rc.find(Xe=>Xe.invoiceNo===K.vchNo),ne=C(K.vchNo),J=ee.get(ne),Se=J?Math.abs(parseFloat(J.totalAmount)||parseFloat(J.credit)||parseFloat(J.debit)||0):0,ue=parseFloat(K.debit)||0,ge=J&&Se>=ue;if(q||ge)return;const Ie=!(K.amountReceived>0),te=J&&Se>0&&Se<ue;if(Ie||te){const Xe=te?ue-Se:ue;m.set(K.vchNo,{invoiceNo:K.vchNo,partyName:K.partyName,invoiceDate:K.date,invoiceTotalAmount:ue,pendingAmount:Xe,hasPartialCN:te,cnAmount:Se,subject:K.particulars||K.narration,campaigns:[],isHistorical:!0})}}}),Array.from(m.values()).sort((K,q)=>K.partyName.localeCompare(q.partyName))},[Dr,rc,nc,Ni]),nF=ye.useMemo(()=>{const m={};return ic.forEach(C=>{m[C.invoiceNo]||(m[C.invoiceNo]=[]),m[C.invoiceNo].push(C)}),Object.keys(m).forEach(C=>{m[C].sort((Y,ee)=>new Date(ee.followupDate)-new Date(Y.followupDate))}),m},[ic]),dy=ye.useMemo(()=>{const m=new Date().toISOString().split("T")[0];return ic.filter(C=>C.nextFollowupDate&&C.nextFollowupDate>=m).sort((C,Y)=>new Date(C.nextFollowupDate)-new Date(Y.nextFollowupDate))},[ic]),i0=ye.useMemo(()=>{let m=n0;if(dc){const Y=dc.toLowerCase();m=n0.filter(ee=>{var K,q,ne;return((K=ee.invoiceNo)==null?void 0:K.toLowerCase().includes(Y))||((q=ee.partyName)==null?void 0:q.toLowerCase().includes(Y))||((ne=ee.subject)==null?void 0:ne.toLowerCase().includes(Y))})}const C={};return m.forEach(Y=>{C[Y.partyName]||(C[Y.partyName]={partyName:Y.partyName,invoices:[],totalAmount:0}),C[Y.partyName].invoices.push(Y),C[Y.partyName].totalAmount+=parseFloat(Y.pendingAmount||Y.invoiceTotalAmount)||0}),Object.values(C).sort((Y,ee)=>Y.partyName.localeCompare(ee.partyName))},[n0,dc]),iF=()=>{const m=i0.reduce((C,Y)=>C+Y.invoices.length,0);return f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[f.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Followups"}),f.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[f.jsxs("span",{style:{padding:"6px 12px",backgroundColor:"#EFF6FF",borderRadius:"6px",fontSize:"12px",color:"#1E40AF",fontWeight:"600"},children:[i0.length," Parties | ",m," Invoices"]}),jn&&f.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"})]})]}),f.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(zm,{size:18,color:"#64748B"}),f.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Search:"})]}),f.jsxs("div",{style:{position:"relative",flex:1,maxWidth:"300px"},children:[f.jsx(L0,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"text",placeholder:"Search party, invoice, subject...",value:dc,onChange:C=>fy(C.target.value),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"100%"}})]}),dc&&f.jsxs("button",{onClick:()=>fy(""),style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(fl,{size:14})," Clear"]}),dc&&f.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",m," of ",n0.length]})]})}),dy.length>0&&f.jsx(Tn,{title:" Upcoming Followups",style:{marginBottom:"16px"},children:f.jsx("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:dy.slice(0,5).map(C=>f.jsxs("div",{style:{padding:"10px 14px",backgroundColor:new Date(C.nextFollowupDate).toISOString().split("T")[0]===new Date().toISOString().split("T")[0]?"#FEE2E2":"#FEF3C7",borderRadius:"8px",border:"1px solid #FCD34D"},children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#92400E"},children:C.invoiceNo}),f.jsx("div",{style:{fontSize:"11px",color:"#78716C"},children:C.partyName}),f.jsxs("div",{style:{fontSize:"12px",fontWeight:"600",color:"#DC2626",marginTop:"4px"},children:[" ",yr(C.nextFollowupDate)]})]},C.id))})}),i0.length===0?f.jsx(Tn,{children:f.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:" No pending invoices! All payments received."})}):i0.map(C=>f.jsxs(Tn,{style:{marginBottom:"16px"},noPadding:!0,children:[f.jsxs("div",{style:{padding:"12px 16px",backgroundColor:"#1E293B",color:"white",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[f.jsxs("span",{style:{fontSize:"15px",fontWeight:"700"},children:[" ",C.partyName]}),f.jsxs("span",{style:{padding:"3px 10px",backgroundColor:"#3B82F6",borderRadius:"12px",fontSize:"11px",fontWeight:"600"},children:[C.invoices.length," Invoice",C.invoices.length>1?"s":""]})]}),f.jsxs("div",{style:{fontSize:"14px",fontWeight:"700",color:"#FCD34D"},children:["Total: ",ft(C.totalAmount)]})]}),f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[f.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Type"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Invoice Date"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:"Amount"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Days Pending"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Last Followup"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),f.jsx("tbody",{children:C.invoices.map(Y=>{var J,Se,ue;const ee=nF[Y.invoiceNo]||[],K=ee[0],q=Math.floor((new Date-new Date(Y.invoiceDate))/(1e3*60*60*24)),ne=Y.isHistorical?"Historical":Y.invoiceType||(((J=Y.campaigns)==null?void 0:J.length)>1?"Combined":"Individual");return f.jsxs(G0.Fragment,{children:[f.jsxs("tr",{style:{borderBottom:"1px solid #E2E8F0",backgroundColor:q>30?"#FEF2F2":q>15?"#FFFBEB":"#FFFFFF"},children:[f.jsxs("td",{style:{padding:"10px 12px",fontWeight:"600",color:"#2874A6"},children:[Y.invoiceNo,Y.hasPartialCN&&f.jsx("span",{style:{marginLeft:"6px",padding:"2px 6px",backgroundColor:"#FEF3C7",color:"#92400E",borderRadius:"4px",fontSize:"9px",fontWeight:"700"},children:"Partial CN"})]}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsx("span",{style:{padding:"3px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"600",backgroundColor:ne==="Historical"?"#E0E7FF":ne==="Combined"?"#F3E8FF":"#DCFCE7",color:ne==="Historical"?"#3730A3":ne==="Combined"?"#7C3AED":"#166534"},children:ne})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:yr(Y.invoiceDate)}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600"},children:Y.hasPartialCN?f.jsxs("div",{children:[f.jsx("div",{style:{color:"#DC2626"},children:ft(Y.pendingAmount)}),f.jsx("div",{style:{fontSize:"9px",color:"#64748B",textDecoration:"line-through"},children:ft(Y.invoiceTotalAmount)})]}):ft(Y.invoiceTotalAmount)}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsxs("span",{style:{padding:"3px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"700",backgroundColor:q>30?"#FEE2E2":q>15?"#FEF3C7":"#DCFCE7",color:q>30?"#991B1B":q>15?"#92400E":"#166534"},children:[q," days"]})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center",fontSize:"11px"},children:K?f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:"600"},children:yr(K.followupDate)}),f.jsxs("div",{style:{color:"#64748B",fontSize:"10px"},children:[(Se=K.notes)==null?void 0:Se.substring(0,30),((ue=K.notes)==null?void 0:ue.length)>30?"...":""]})]}):f.jsx("span",{style:{color:"#DC2626",fontWeight:"600"},children:"No followup yet"})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsxs("div",{style:{display:"flex",gap:"4px",justifyContent:"center"},children:[Ht&&f.jsx(Ye,{icon:Hm,small:!0,variant:"primary",onClick:()=>O(Y),title:"Add Followup"}),f.jsx(Ye,{icon:Um,small:!0,variant:"brand",onClick:()=>Wt(Y),title:"Copy Email Template"}),f.jsx(Ye,{icon:Wm,small:!0,variant:"success",onClick:()=>Jr(Y),title:"Search in Gmail"})]})})]}),ee.length>0&&f.jsx("tr",{children:f.jsxs("td",{colSpan:"7",style:{padding:"8px 12px 12px 40px",backgroundColor:"#F8FAFC"},children:[f.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#64748B",marginBottom:"6px"},children:"Followup History:"}),f.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:ee.map(ge=>f.jsxs("div",{style:{padding:"6px 10px",backgroundColor:"#FFFFFF",borderRadius:"6px",border:"1px solid #E2E8F0",fontSize:"11px"},children:[f.jsx("div",{style:{fontWeight:"600",color:"#2874A6"},children:yr(ge.followupDate)}),f.jsx("div",{style:{color:"#475569",marginTop:"2px"},children:ge.notes}),ge.nextFollowupDate&&f.jsxs("div",{style:{color:"#DC2626",marginTop:"2px",fontSize:"10px"},children:["Next: ",yr(ge.nextFollowupDate)]}),Ht&&f.jsx("button",{onClick:()=>de(ge.id),style:{background:"none",border:"none",color:"#DC2626",cursor:"pointer",fontSize:"10px",padding:"2px 0",marginTop:"4px"},children:" Delete"})]},ge.id))})]})})]},Y.invoiceNo)})})]})]},C.partyName))]})},hy=()=>{const m=ve.filter(K=>K.invoiceGenerated).reduce((K,q)=>K+(parseFloat(q.invoiceTotalAmount)||0),0),C=ve.filter(K=>K.invoiceStatus==="Paid").reduce((K,q)=>K+(parseFloat(q.invoiceTotalAmount)||0),0),Y=ve.filter(K=>K.invoiceStatus==="Approved").reduce((K,q)=>K+(parseFloat(q.invoiceTotalAmount)||0),0),ee=ve.filter(K=>K.invoiceStatus==="Need Edits").length;return f.jsxs("div",{children:[f.jsx("h1",{style:{margin:"0 0 16px",fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Reports"}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px"},children:[f.jsxs(Tn,{children:[f.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Total Invoiced"}),f.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:ft(m)})]}),f.jsxs(Tn,{children:[f.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Approved"}),f.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669"},children:ft(Y)})]}),f.jsxs(Tn,{children:[f.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Need Edits"}),f.jsxs("div",{style:{fontSize:"24px",fontWeight:"700",color:"#DC2626"},children:[ee," invoices"]})]}),f.jsxs(Tn,{children:[f.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Paid"}),f.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669"},children:ft(C)})]})]})]})},sF=()=>f.jsxs("div",{children:[f.jsx("h1",{style:{margin:"0 0 16px",fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Settings"}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[f.jsxs(Tn,{title:" Invoice Series",children:[f.jsx(_r,{label:"Invoice Prefix",value:S.invoicePrefix,onChange:m=>b(C=>({...C,invoicePrefix:m.target.value})),small:!0}),f.jsx(_r,{label:"Next Invoice Number",type:"number",value:Te,onChange:m=>Pe(parseInt(m.target.value)||1),small:!0}),f.jsx(_r,{label:"Next Combine Code",type:"number",value:ke,onChange:m=>we(parseInt(m.target.value)||1),small:!0}),f.jsxs("div",{style:{padding:"10px",backgroundColor:"#EFF6FF",borderRadius:"8px",fontSize:"14px"},children:[f.jsx("strong",{children:"Preview:"})," ",S.invoicePrefix,Te]})]}),f.jsxs(Tn,{title:" Mailer Logo",children:[f.jsx("input",{type:"file",ref:bu,accept:"image/*",style:{display:"none"},onChange:K4}),Yr?f.jsxs("div",{style:{textAlign:"center"},children:[f.jsx("img",{src:Yr,alt:"Logo",style:{maxWidth:"250px",maxHeight:"60px",marginBottom:"12px",border:"1px solid #E2E8F0",padding:"8px",borderRadius:"8px"}}),f.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"center"},children:[f.jsx(Ye,{icon:KB,label:"Change",small:!0,onClick:()=>{var m;return(m=bu.current)==null?void 0:m.click()}}),f.jsx(Ye,{icon:Ks,label:"Remove",variant:"danger",small:!0,onClick:()=>ps(null)})]})]}):f.jsxs("div",{onClick:()=>{var m;return(m=bu.current)==null?void 0:m.click()},style:{border:"2px dashed #CBD5E1",borderRadius:"10px",padding:"30px",textAlign:"center",cursor:"pointer"},children:[f.jsx(Xs,{size:32,color:"#94A3B8",style:{marginBottom:"8px"}}),f.jsx("p",{style:{margin:0,color:"#64748B",fontSize:"14px"},children:"Click to upload"})]})]}),f.jsxs(Tn,{title:" WhatsApp Notifications",children:[f.jsx("div",{style:{marginBottom:"16px"},children:f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"10px",cursor:"pointer"},children:[f.jsx("input",{type:"checkbox",checked:re.enabled,onChange:m=>le(C=>({...C,enabled:m.target.checked})),style:{width:"18px",height:"18px",cursor:"pointer"}}),f.jsx("span",{style:{fontSize:"14px",fontWeight:"600",color:"#1E293B"},children:"Enable WhatsApp Notifications"})]})}),re.enabled&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{style:{padding:"12px",backgroundColor:"#DCFCE7",borderRadius:"8px",marginBottom:"16px",fontSize:"12px",color:"#166534",border:"1px solid #86EFAC"},children:[f.jsx("strong",{children:" FREE Setup using CallMeBot:"}),f.jsx("br",{}),"1. Save this number in contacts: ",f.jsx("strong",{children:"+34 644 71 81 99"}),f.jsx("br",{}),"2. Send this message to the number on WhatsApp: ",f.jsx("strong",{children:'"I allow callmebot to send me messages"'}),f.jsx("br",{}),"3. You'll receive an API key - enter it below",f.jsx("br",{}),"4. Repeat for each phone number you want to receive notifications"]}),f.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",marginBottom:"12px",border:"1px solid #E2E8F0"},children:[f.jsxs("div",{style:{fontSize:"13px",fontWeight:"700",color:"#1E293B",marginBottom:"10px",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(M0,{size:16})," Finance Team"]}),f.jsx(_r,{label:"Phone (with country code)",value:re.financePhone,onChange:m=>le(C=>({...C,financePhone:m.target.value})),placeholder:"919876543210",small:!0}),f.jsx(_r,{label:"API Key (from CallMeBot)",value:re.financeApiKey,onChange:m=>le(C=>({...C,financeApiKey:m.target.value})),placeholder:"123456",small:!0}),re.financePhone&&re.financeApiKey&&f.jsx(Ye,{icon:U2,label:"Test Finance",variant:"success",small:!0,onClick:()=>Du(re.financePhone,re.financeApiKey)})]}),f.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",border:"1px solid #E2E8F0"},children:[f.jsxs("div",{style:{fontSize:"13px",fontWeight:"700",color:"#1E293B",marginBottom:"10px",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(M0,{size:16})," Director"]}),f.jsx(_r,{label:"Phone (with country code)",value:re.directorPhone,onChange:m=>le(C=>({...C,directorPhone:m.target.value})),placeholder:"919876543210",small:!0}),f.jsx(_r,{label:"API Key (from CallMeBot)",value:re.directorApiKey,onChange:m=>le(C=>({...C,directorApiKey:m.target.value})),placeholder:"123456",small:!0}),re.directorPhone&&re.directorApiKey&&f.jsx(Ye,{icon:U2,label:"Test Director",variant:"success",small:!0,onClick:()=>Du(re.directorPhone,re.directorApiKey)})]})]}),!re.enabled&&f.jsx("div",{style:{padding:"20px",backgroundColor:"#F8FAFC",borderRadius:"8px",textAlign:"center",color:"#64748B",fontSize:"13px"},children:"WhatsApp notifications are disabled. Enable to receive FREE alerts for invoices, approvals, and payments."})]}),f.jsxs(Tn,{title:" Default Invoice Values",children:[f.jsx("input",{type:"file",ref:Gd,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:It}),f.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[f.jsx(Ye,{icon:Xs,label:"Upload",variant:"brand",small:!0,onClick:()=>{var m;return(m=Gd.current)==null?void 0:m.click()}}),f.jsx(Ye,{icon:Yu,label:"Template",small:!0,onClick:pn})]}),Object.keys(Us).length>0&&f.jsx("div",{style:{maxHeight:"180px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"8px"},children:Object.entries(Us).map(([m,C])=>f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px 14px",borderBottom:"1px solid #F1F5F9",fontSize:"13px"},children:[f.jsx("span",{children:m}),f.jsx("span",{style:{fontWeight:"700"},children:ft(C)})]},m))})]}),f.jsxs(Tn,{title:" Party Master",children:[f.jsx("input",{type:"file",ref:Ru,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:mn}),f.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[f.jsx(Ye,{icon:Xs,label:"Upload Parties",variant:"brand",small:!0,onClick:()=>{var m;return(m=Ru.current)==null?void 0:m.click()}}),f.jsx(Ye,{icon:Yu,label:"Template",small:!0,onClick:so})]}),f.jsxs("div",{style:{padding:"10px",backgroundColor:"#EFF6FF",borderRadius:"8px",fontSize:"12px",color:"#1E40AF",marginBottom:"12px"},children:[f.jsx("strong",{children:"Upload Format:"})," Name of Ledger, Ledger Group, State Name, GST Registration Type, GSTIN/UIN"]}),Object.keys(ar).length>0&&f.jsxs("div",{style:{maxHeight:"150px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"8px"},children:[Object.entries(ar).slice(0,20).map(([m,C])=>f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 12px",borderBottom:"1px solid #F1F5F9",fontSize:"11px"},children:[f.jsx("span",{style:{fontWeight:"600"},children:m.length>30?m.substring(0,30)+"...":m}),f.jsxs("span",{style:{color:"#64748B"},children:[C.stateName||"-"," | ",C.gstin?C.gstin.substring(0,10)+"...":"-"]})]},m)),Object.keys(ar).length>20&&f.jsxs("div",{style:{padding:"8px 12px",textAlign:"center",color:"#64748B",fontSize:"11px"},children:["... and ",Object.keys(ar).length-20," more parties"]})]}),Object.keys(ar).length===0&&f.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#94A3B8",fontSize:"13px"},children:"No party master uploaded yet"})]}),f.jsxs(Tn,{title:" Data Management",children:[f.jsxs("div",{style:{padding:"16px",backgroundColor:"#FEF2F2",borderRadius:"10px",border:"1px solid #FCA5A5",marginBottom:"16px"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"14px",marginBottom:"8px"},children:" Danger Zone"}),f.jsxs("div",{style:{fontSize:"13px",color:"#7F1D1D",marginBottom:"16px"},children:["This will permanently delete all data including:",f.jsxs("ul",{style:{margin:"8px 0 0 16px",padding:0},children:[f.jsx("li",{children:"All campaigns and master data"}),f.jsx("li",{children:"All invoices and receipts"}),f.jsx("li",{children:"All ledger entries"}),f.jsx("li",{children:"All mailer images"}),f.jsx("li",{children:"Opening balances and settings"})]})]}),f.jsx(Ye,{icon:Ks,label:"Clear All Data",variant:"danger",onClick:()=>ua(!0)})]}),f.jsxs("div",{style:{fontSize:"12px",color:"#64748B"},children:[f.jsx("strong",{children:"Current Data:"}),f.jsx("br",{})," ",ve.length," campaigns",f.jsx("br",{})," ",Ae.length," ledger entries",f.jsx("br",{})," ",Z.length," receipts",f.jsx("br",{})," ",Object.keys(Xr).length," mailer images"]})]})]})]}),aF=()=>f.jsxs(f.Fragment,{children:[f.jsx(Sn,{isOpen:X4,onClose:()=>{sy(!1),oy("")},title:" Invoice Preview",width:"950px",children:ae&&ay&&f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px",padding:"14px 18px",backgroundColor:"#DCFCE7",borderRadius:"10px",border:"2px solid #22C55E"},children:[f.jsxs("div",{children:[f.jsxs("span",{style:{fontWeight:"700",fontSize:"16px",color:"#166534"},children:["Invoice: ",ae.invoiceNo]}),ae.invoiceType==="Combined"&&f.jsxs("span",{style:{marginLeft:"12px",padding:"4px 10px",backgroundColor:"#7C3AED",color:"white",borderRadius:"6px",fontSize:"12px",fontWeight:"600"},children:["Combined - C",ae.combinationCode]})]}),f.jsxs("button",{onClick:()=>q4(ae),style:{padding:"14px 28px",fontSize:"16px",fontWeight:"bold",border:"none",borderRadius:"10px",cursor:"pointer",backgroundColor:"#22C55E",color:"white",display:"flex",alignItems:"center",gap:"10px",boxShadow:"0 2px 8px rgba(34, 197, 94, 0.4)"},children:[f.jsx(Yu,{size:20}),"Download Invoice"]})]}),f.jsx("div",{style:{border:"2px solid #E2E8F0",borderRadius:"10px",overflow:"hidden",backgroundColor:"#f5f5f5"},children:f.jsx("iframe",{id:"invoice-viewer-iframe",srcDoc:ay,style:{width:"100%",height:"480px",border:"none",backgroundColor:"white"},title:"Invoice Preview"})}),f.jsxs("div",{style:{marginTop:"12px",padding:"14px 18px",backgroundColor:"#FEF3C7",borderRadius:"10px",border:"1px solid #FCD34D"},children:[f.jsx("div",{style:{fontSize:"14px",color:"#92400E",fontWeight:"600",marginBottom:"6px"},children:" How to Save as PDF:"}),f.jsxs("ol",{style:{fontSize:"13px",color:"#92400E",margin:"0",paddingLeft:"20px",lineHeight:"1.8"},children:[f.jsxs("li",{children:["Click ",f.jsx("strong",{children:'"Download Invoice"'})," button above"]}),f.jsxs("li",{children:["Open the downloaded ",f.jsx("strong",{children:".html file"})," in Chrome/Edge browser"]}),f.jsxs("li",{children:["Print dialog will open automatically - select ",f.jsx("strong",{children:'"Save as PDF"'})]}),f.jsxs("li",{children:["Click ",f.jsx("strong",{children:"Save"})," to get your PDF!"]})]})]})]})}),f.jsx(Sn,{isOpen:wr,onClose:()=>{Zt(!1),On(""),tt({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1})},title:jn?" Review & Approve Invoice":" Invoice Details",width:"550px",children:ae&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice:"})," ",ae.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Party:"})," ",ae.partyName]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Amount:"})," ",ft(ae.invoiceTotalAmount)]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Email:"})," ",ae.emailId||"Not set"]}),f.jsxs("div",{style:{fontSize:"14px"},children:[f.jsx("strong",{children:"Invoice Type:"})," ",f.jsx("span",{style:{color:ae.invoiceType==="Combined"?"#7C3AED":"#2874A6",fontWeight:"600"},children:ae.invoiceType||"Individual"})]}),ae.invoiceType==="Combined"&&f.jsxs("div",{style:{marginTop:"8px",fontSize:"13px",color:"#7C3AED"},children:[f.jsx("strong",{children:"Combined Campaigns:"})," ",zs(ae).map(m=>m.senderName).join(", ")]})]}),ae.editComments&&f.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[f.jsx("div",{style:{fontWeight:"600",color:"#991B1B",fontSize:"13px",marginBottom:"4px"},children:" Need Edits - Director Remarks:"}),f.jsx("div",{style:{fontSize:"13px",color:"#7F1D1D"},children:ae.editComments})]}),ae.approvalRemarks&&ae.invoiceStatus==="Approved"&&f.jsxs("div",{style:{backgroundColor:"#DCFCE7",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[f.jsx("div",{style:{fontWeight:"600",color:"#166534",fontSize:"13px",marginBottom:"4px"},children:" Approved - Director Remarks:"}),f.jsx("div",{style:{fontSize:"13px",color:"#15803D"},children:ae.approvalRemarks})]}),jn?f.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#166534",fontSize:"14px",marginBottom:"12px"},children:" Approval Confirmations"}),f.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",marginBottom:"12px",cursor:"pointer"},children:[f.jsx("input",{type:"checkbox",checked:ze.particularsApproved,onChange:m=>tt(C=>({...C,particularsApproved:m.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"1. Particulars & Amount Approved"}),f.jsxs("div",{style:{fontSize:"12px",color:"#15803D"},children:["I confirm that the invoice particulars and amount (",ft(ae.invoiceTotalAmount),") are correct."]})]})]}),f.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",marginBottom:"12px",cursor:"pointer"},children:[f.jsx("input",{type:"checkbox",checked:ze.emailApproved,onChange:m=>tt(C=>({...C,emailApproved:m.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"2. Email ID Approved for Mailing"}),f.jsxs("div",{style:{fontSize:"12px",color:"#15803D"},children:["I confirm that ",f.jsx("strong",{children:ae.emailId||"the specified email"})," should be used for mailing."]})]})]}),f.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",cursor:"pointer"},children:[f.jsx("input",{type:"checkbox",checked:ze.invoiceTypeApproved,onChange:m=>tt(C=>({...C,invoiceTypeApproved:m.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"3. Invoice Type Confirmed"}),f.jsx("div",{style:{fontSize:"12px",color:"#15803D"},children:ae.invoiceType==="Combined"?`I confirm that a Combined Invoice is required for these ${zs(ae).length} campaigns.`:"I confirm that an Individual Invoice is required (not combined with others)."})]})]})]}):f.jsxs("div",{style:{backgroundColor:ae.invoiceStatus==="Approved"?"#DCFCE7":ae.invoiceStatus==="Need Edits"?"#FEF3C7":"#F8FAFC",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid "+(ae.invoiceStatus==="Approved"?"#86EFAC":ae.invoiceStatus==="Need Edits"?"#FCD34D":"#E2E8F0")},children:[f.jsx("div",{style:{fontWeight:"600",color:ae.invoiceStatus==="Approved"?"#166534":ae.invoiceStatus==="Need Edits"?"#92400E":"#64748B",fontSize:"14px"},children:ae.invoiceStatus==="Approved"?" Approved by Director":ae.invoiceStatus==="Need Edits"?" Edits Required by Director":" Pending Director Approval"}),f.jsx("div",{style:{fontSize:"13px",color:ae.invoiceStatus==="Approved"?"#15803D":ae.invoiceStatus==="Need Edits"?"#A16207":"#64748B",marginTop:"6px"},children:ae.invoiceStatus==="Approved"?"This invoice has been approved and is ready for mailing.":ae.invoiceStatus==="Need Edits"?"Please make the required changes and resubmit for approval.":"This invoice is awaiting Director approval."})]}),jn&&f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:" Remarks (optional for Approve, visible to Finance)"}),f.jsx("textarea",{value:Ei,onChange:m=>On(m.target.value),placeholder:"Enter remarks or comments...",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[f.jsx(Ye,{label:"Close",onClick:()=>{Zt(!1),On(""),tt({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1})}}),jn&&f.jsxs(f.Fragment,{children:[f.jsx(Ye,{label:"Need Edits",variant:"danger",icon:GB,onClick:Jd}),f.jsx(Ye,{label:"Approve",variant:"success",icon:YB,onClick:_a})]})]})]})}),f.jsx(Sn,{isOpen:ni,onClose:()=>ut(!1),title:" Delete Invoice",width:"450px",children:ae&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"15px",marginBottom:"8px"},children:" Are you sure?"}),f.jsxs("div",{style:{fontSize:"14px",color:"#7F1D1D",lineHeight:"1.5"},children:["This will delete invoice ",f.jsx("strong",{children:ae.invoiceNo})," and reset the campaign(s) to allow re-generation.",ae.invoiceType==="Combined"&&f.jsxs("div",{style:{marginTop:"8px"},children:[f.jsxs("strong",{children:["All ",zs(ae).length," combined campaigns"]})," will be reset to Individual type for re-selection."]})]})]}),f.jsxs("div",{style:{backgroundColor:"#F8FAFC",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"13px"},children:[f.jsx("strong",{children:"Invoice:"})," ",ae.invoiceNo]}),f.jsxs("div",{style:{fontSize:"13px"},children:[f.jsx("strong",{children:"Party:"})," ",ae.partyName]}),f.jsxs("div",{style:{fontSize:"13px"},children:[f.jsx("strong",{children:"Amount:"})," ",ft(ae.invoiceTotalAmount)]})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>ut(!1)}),f.jsx(Ye,{label:"Delete Invoice",variant:"danger",icon:Ks,onClick:e0})]})]})}),f.jsx(Sn,{isOpen:_i,onClose:()=>zt(!1),title:" Add Email Address",width:"400px",children:ae&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"13px"},children:[f.jsx("strong",{children:"Campaign:"})," ",ae.senderName]}),f.jsxs("div",{style:{fontSize:"13px",marginTop:"4px"},children:[f.jsx("strong",{children:"Current:"})," ",ae.emailId||"None"]})]}),f.jsx(_r,{label:"Additional Email Address",type:"email",value:Xi,onChange:m=>fa(m.target.value),placeholder:"email@example.com",small:!0}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>zt(!1)}),f.jsx(Ye,{label:"Add Email",variant:"brand",icon:V2,onClick:()=>{Xi&&Xi.includes("@")?(lc(ae.id,Xi),zt(!1),fa("")):alert("Please enter a valid email address")}})]})]})}),f.jsx(Sn,{isOpen:A,onClose:()=>{_(!1),W({currentPassword:"",newPassword:"",confirmPassword:""}),w("")},title:" Change Password",width:"400px",children:f.jsxs("div",{children:[f.jsx("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:f.jsxs("div",{style:{fontSize:"13px"},children:[f.jsx("strong",{children:"User:"})," ",r==="director"?"Director":"Finance Team"]})}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Current Password"}),f.jsx("input",{type:"password",value:P.currentPassword,onChange:m=>W(C=>({...C,currentPassword:m.target.value})),placeholder:"Enter current password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"New Password"}),f.jsx("input",{type:"password",value:P.newPassword,onChange:m=>W(C=>({...C,newPassword:m.target.value})),placeholder:"Enter new password (min 6 characters)",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Confirm New Password"}),f.jsx("input",{type:"password",value:P.confirmPassword,onChange:m=>W(C=>({...C,confirmPassword:m.target.value})),placeholder:"Confirm new password",onKeyPress:m=>m.key==="Enter"&&ac(),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),j&&f.jsx("div",{style:{marginBottom:"16px",padding:"10px",backgroundColor:"#FEE2E2",borderRadius:"8px",color:"#991B1B",fontSize:"13px"},children:j}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>{_(!1),W({currentPassword:"",newPassword:"",confirmPassword:""}),w("")}}),f.jsx(Ye,{label:"Change Password",variant:"brand",icon:O0,onClick:ac})]})]})}),f.jsx(Sn,{isOpen:A,onClose:()=>{_(!1),w(""),W({currentPassword:"",newPassword:"",confirmPassword:""})},title:" Change Password",width:"400px",children:f.jsxs("div",{children:[f.jsx("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:f.jsxs("div",{style:{fontSize:"13px",color:"#1E40AF"},children:["Changing password for: ",f.jsx("strong",{children:r==="director"?"Director":"Finance Team"})]})}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Current Password"}),f.jsx("input",{type:"password",value:P.currentPassword,onChange:m=>W(C=>({...C,currentPassword:m.target.value})),placeholder:"Enter current password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"New Password"}),f.jsx("input",{type:"password",value:P.newPassword,onChange:m=>W(C=>({...C,newPassword:m.target.value})),placeholder:"Enter new password (min 6 chars)",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Confirm New Password"}),f.jsx("input",{type:"password",value:P.confirmPassword,onChange:m=>W(C=>({...C,confirmPassword:m.target.value})),placeholder:"Re-enter new password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),j&&f.jsx("div",{style:{marginBottom:"16px",padding:"10px",backgroundColor:"#FEE2E2",borderRadius:"8px",color:"#991B1B",fontSize:"13px"},children:j}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>{_(!1),w(""),W({currentPassword:"",newPassword:"",confirmPassword:""})}}),f.jsx(Ye,{label:"Change Password",variant:"brand",icon:O0,onClick:ac})]})]})}),f.jsx(Sn,{isOpen:yi,onClose:()=>{Nr(!1),si(new Set),Nt(null)},title:" Combine Invoices",width:"700px",children:Mt&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#F3E8FF",padding:"14px 18px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"15px",fontWeight:"700",color:"#6B21A8"},children:["Party: ",Mt]}),f.jsx("div",{style:{fontSize:"13px",color:"#7C3AED",marginTop:"4px"},children:"Select 2+ campaigns to combine into a single invoice"})]}),f.jsx("div",{style:{maxHeight:"350px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"10px"},children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#F8FAFC",position:"sticky",top:0},children:[f.jsx("th",{style:{padding:"12px",textAlign:"center",width:"50px"},children:""}),f.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Sender"}),f.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Subject"}),f.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Date"}),f.jsx("th",{style:{padding:"12px",textAlign:"right"},children:"Amount"})]})}),f.jsx("tbody",{children:sl(Mt).map(m=>{var C;return f.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:Ft.has(m.id)?"#F3E8FF":"transparent",cursor:"pointer"},onClick:()=>z4(m.id),children:[f.jsx("td",{style:{padding:"12px",textAlign:"center"},children:f.jsx("input",{type:"checkbox",checked:Ft.has(m.id),onChange:()=>{},style:{width:"18px",height:"18px",cursor:"pointer"}})}),f.jsx("td",{style:{padding:"12px",fontWeight:"600"},children:m.senderName}),f.jsxs("td",{style:{padding:"12px",color:"#64748B"},children:[(C=m.subject)==null?void 0:C.substring(0,35),"..."]}),f.jsx("td",{style:{padding:"12px"},children:yr(m.date)}),f.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:ft(m.totalWithGst)})]},m.id)})})]})}),f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px 18px",borderRadius:"10px",marginTop:"16px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsxs("div",{style:{fontSize:"14px",color:"#64748B"},children:["Selected: ",f.jsx("strong",{children:Ft.size})," | Combine Code: ",f.jsxs("strong",{children:["C",ke]})]}),f.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#2874A6"},children:["Total: ",ft(ve.filter(m=>Ft.has(m.id)).reduce((m,C)=>m+(parseFloat(C.totalWithGst)||0),0))]})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>{Nr(!1),si(new Set)}}),f.jsx(Ye,{label:"Create Combined Invoice",variant:"purple",icon:Qu,disabled:Ft.size<2,onClick:U4})]})]})}),f.jsxs(Sn,{isOpen:Rt,onClose:()=>{pt(!1),Vs(null),el(!1)},title:Zl?" Replace Mailer":" Upload Mailer",width:"550px",children:[f.jsx("input",{type:"file",ref:$d,accept:"image/*",style:{display:"none"},onChange:H4}),ae&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"14px"},children:[f.jsxs("div",{style:{fontSize:"14px"},children:[f.jsx("strong",{children:"Sender:"})," ",ae.senderName]}),f.jsxs("div",{style:{fontSize:"14px",marginTop:"4px"},children:[f.jsx("strong",{children:"Subject:"})," ",ae.subject]})]}),Zl&&Xr[ae.id]&&f.jsx("div",{style:{backgroundColor:"#FEF3C7",padding:"12px",borderRadius:"10px",marginBottom:"14px",border:"1px solid #FCD34D"},children:f.jsxs("div",{style:{fontWeight:"600",color:"#92400E",fontSize:"13px"},children:[" This will replace ",Xr[ae.id].length," existing image(s)"]})}),f.jsxs("div",{style:{backgroundColor:"#FEF3C7",padding:"14px",borderRadius:"10px",marginBottom:"14px",border:"1px solid #FCD34D"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#92400E",marginBottom:"8px",fontSize:"14px"},children:"Step 1: Find Mailer in Gmail"}),f.jsxs("button",{onClick:()=>G4(ae.subject),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 18px",backgroundColor:"#EA4335",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:[f.jsx(HB,{size:16})," Search in Gmail"]})]}),f.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"14px",borderRadius:"10px",border:"1px solid #86EFAC"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#166534",marginBottom:"8px",fontSize:"14px"},children:"Step 2: Paste Screenshot"}),f.jsx("div",{ref:Za,tabIndex:0,onPaste:$4,onClick:()=>{var m;return(m=Za.current)==null?void 0:m.focus()},style:{border:qr?"3px solid #22C55E":"3px dashed #22C55E",borderRadius:"10px",padding:qr?"8px":"30px",textAlign:"center",cursor:"pointer",backgroundColor:qr?"#FFFFFF":"#ECFDF5",minHeight:"100px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",outline:"none"},children:qr?f.jsxs(f.Fragment,{children:[f.jsx("img",{src:qr,alt:"Pasted",style:{maxWidth:"100%",maxHeight:"200px",borderRadius:"8px",marginBottom:"10px"}}),f.jsxs("div",{style:{display:"flex",gap:"8px"},children:[f.jsx(Ye,{icon:L2,label:"Save",variant:"success",onClick:()=>ny(qr)}),f.jsx(Ye,{icon:Ks,label:"Clear",variant:"danger",onClick:()=>Vs(null)})]})]}):f.jsxs(f.Fragment,{children:[f.jsx(Um,{size:36,color:"#22C55E",style:{marginBottom:"8px"}}),f.jsx("div",{style:{fontWeight:"700",fontSize:"14px",color:"#166534"},children:"Click here & Press Ctrl+V"})]})}),f.jsxs("div",{style:{textAlign:"center",marginTop:"12px"},children:[f.jsx("span",{style:{color:"#64748B",fontSize:"13px"},children:" OR "}),f.jsx("div",{style:{marginTop:"8px"},children:f.jsx(Ye,{icon:Xs,label:"Browse Files",onClick:()=>{var m;return(m=$d.current)==null?void 0:m.click()}})})]})]})]})]}),f.jsx(Sn,{isOpen:$e,onClose:()=>qt(!1),title:" Send Invoice Email",width:"600px",children:ae&&f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",gap:"0",marginBottom:"16px",border:"2px solid #E2E8F0",borderRadius:"8px",overflow:"hidden"},children:[f.jsx("button",{onClick:()=>Qa("reply"),style:{flex:1,padding:"12px",backgroundColor:ds==="reply"?"#2874A6":"#F8FAFC",color:ds==="reply"?"white":"#64748B",border:"none",cursor:"pointer",fontWeight:"700",fontSize:"14px"},children:" Reply to Thread"}),f.jsx("button",{onClick:()=>Qa("new"),style:{flex:1,padding:"12px",backgroundColor:ds==="new"?"#2874A6":"#F8FAFC",color:ds==="new"?"white":"#64748B",border:"none",cursor:"pointer",fontWeight:"700",fontSize:"14px"},children:" New Email"})]}),f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice:"})," ",ae.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Amount:"})," ",ft(ae.invoiceTotalAmount||ae.totalWithGst)]}),ae.invoiceType==="Combined"&&f.jsxs("div",{style:{fontSize:"13px",marginTop:"8px",color:"#7C3AED"},children:[f.jsx("strong",{children:"Campaigns:"})," ",zs(ae).map(m=>m.senderName).join(", ")]}),f.jsx("div",{style:{fontSize:"14px",marginTop:"8px"},children:f.jsx("strong",{children:"Recipients:"})}),f.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",marginTop:"6px"},children:[no(ae).map((m,C)=>f.jsx("span",{style:{padding:"4px 10px",backgroundColor:"#DBEAFE",borderRadius:"6px",fontSize:"13px",color:"#1E40AF"},children:m},C)),no(ae).length===0&&f.jsx("span",{style:{color:"#94A3B8"},children:"No email addresses"})]})]}),ds==="reply"?f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[f.jsx("span",{style:{fontWeight:"700",fontSize:"14px"},children:"Email Body:"}),f.jsx("button",{onClick:()=>{navigator.clipboard.writeText(r0(ae)),alert(" Copied!")},style:{padding:"6px 14px",backgroundColor:"#22C55E",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"600"},children:" Copy"})]}),f.jsx("div",{style:{fontSize:"13px",backgroundColor:"#F8FAFC",padding:"14px",borderRadius:"10px",whiteSpace:"pre-wrap",maxHeight:"200px",overflowY:"auto",fontFamily:"monospace",border:"1px solid #E2E8F0",lineHeight:"1.5"},children:r0(ae)})]}):f.jsxs("div",{style:{display:"flex",gap:"10px"},children:[f.jsx("button",{onClick:()=>{const m=no(ae),C=encodeURIComponent(m.join(",")),Y=encodeURIComponent(iy(ae)),ee=encodeURIComponent(r0(ae));window.open(`https://mail.google.com/mail/?view=cm&to=${C}&su=${Y}&body=${ee}`,"_blank")},style:{padding:"12px 20px",backgroundColor:"#EA4335",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"700"},children:" Open Gmail"}),f.jsx("button",{onClick:()=>{const m=no(ae),C=encodeURIComponent(m.join(";")),Y=encodeURIComponent(iy(ae)),ee=encodeURIComponent(r0(ae));window.open(`https://outlook.live.com/mail/0/deeplink/compose?to=${C}&subject=${Y}&body=${ee}`,"_blank")},style:{padding:"12px 20px",backgroundColor:"#0078D4",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"700"},children:" Open Outlook"})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[f.jsx(Ye,{label:"View Invoice",icon:P0,onClick:()=>{qt(!1),ju(ae)}}),f.jsx(Ye,{label:"Close",onClick:()=>qt(!1)})]})]})}),f.jsx(Sn,{isOpen:wn,onClose:()=>hn(!1),title:" Record Payment",width:"500px",children:ae&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px"},children:[f.jsx("strong",{children:"Invoice:"})," ",ae.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginTop:"4px"},children:[f.jsx("strong",{children:"Party:"})," ",ae.partyName]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[f.jsx(_r,{label:"Payment Amount",type:"number",value:xr.amount,onChange:m=>ga({...xr,amount:m.target.value}),small:!0}),f.jsx(_r,{label:"Date",type:"date",value:xr.date,onChange:m=>ga({...xr,date:m.target.value}),small:!0})]}),f.jsx(W0,{label:"Payment Mode",value:xr.mode,onChange:m=>ga({...xr,mode:m.target.value}),options:[{value:"Bank",label:"Bank Transfer"},{value:"UPI",label:"UPI"},{value:"Cheque",label:"Cheque"},{value:"Cash",label:"Cash"}],small:!0}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[f.jsx(_r,{label:"TDS Deducted",type:"number",value:xr.tds,onChange:m=>ga({...xr,tds:m.target.value}),placeholder:"0",small:!0}),f.jsx(_r,{label:"Discount",type:"number",value:xr.discount,onChange:m=>ga({...xr,discount:m.target.value}),placeholder:"0",small:!0})]}),f.jsx(_r,{label:"Narration",value:xr.narration,onChange:m=>ga({...xr,narration:m.target.value}),placeholder:"Reference",small:!0}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>hn(!1)}),f.jsx(Ye,{label:"Record Payment",variant:"success",icon:WB,onClick:Q4})]})]})}),f.jsxs(Sn,{isOpen:vi,onClose:()=>Ki(!1),title:" Set Opening Balance",width:"450px",children:[f.jsx(W0,{label:"Select Party",value:ai.partyName,onChange:m=>tl({...ai,partyName:m.target.value}),options:[{value:"",label:"Choose a party..."},...ya.map(m=>({value:m,label:m}))],small:!0}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"12px"},children:[f.jsx(_r,{label:"Amount",type:"number",value:ai.amount,onChange:m=>tl({...ai,amount:m.target.value}),small:!0}),f.jsx(W0,{label:"Type",value:ai.type,onChange:m=>tl({...ai,type:m.target.value}),options:[{value:"Dr",label:"Debit"},{value:"Cr",label:"Credit"}],small:!0})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>Ki(!1)}),f.jsx(Ye,{label:"Save",variant:"brand",onClick:()=>{ai.partyName&&ai.amount&&(ec(m=>({...m,[ai.partyName]:ai.type==="Dr"?parseFloat(ai.amount):-parseFloat(ai.amount)})),Ki(!1),tl({partyName:"",amount:"",type:"Dr"}))}})]})]}),f.jsxs(Sn,{isOpen:tc,onClose:()=>rl(!1),title:" Import Historical Ledger",width:"600px",children:[f.jsx("input",{type:"file",ref:Nu,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:Di}),f.jsxs("div",{style:{padding:"16px",backgroundColor:"#EFF6FF",borderRadius:"10px",marginBottom:"16px",border:"1px solid #BFDBFE"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#1E40AF",marginBottom:"8px",fontSize:"14px"},children:" How to Import Historical Ledger"}),f.jsxs("div",{style:{fontSize:"12px",color:"#1E3A8A",lineHeight:"1.6"},children:[f.jsx("p",{style:{margin:"0 0 8px 0"},children:"Upload your existing ledger data in the format shown in the template. This will import all historical transactions."}),f.jsxs("p",{style:{margin:0},children:[f.jsx("strong",{children:"Supported columns:"})," Date, Particular, Vch Type, Vch No., Debit, Credit, Date of Receipt, Amount Received, TDS Received, Balance, Payment Status"]})]})]}),H&&f.jsxs("div",{style:{padding:"12px",backgroundColor:"#DCFCE7",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[f.jsxs("div",{style:{fontSize:"13px",color:"#166534"},children:[f.jsx("strong",{children:" Selected Party:"})," ",H]}),f.jsx("div",{style:{fontSize:"11px",color:"#15803D",marginTop:"4px"},children:"All entries from the uploaded file will be imported for this party"})]}),!H&&f.jsxs("div",{style:{padding:"12px",backgroundColor:"#FEE2E2",borderRadius:"8px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[f.jsx("div",{style:{fontSize:"13px",color:"#991B1B"},children:f.jsx("strong",{children:" No Party Selected"})}),f.jsx("div",{style:{fontSize:"12px",color:"#B91C1C",marginTop:"4px"},children:'Please close this modal and select a party from the Parties list on the left, then click "Import Historical" again.'})]}),f.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginBottom:"16px"},children:[f.jsx(Ye,{icon:Yu,label:"Download Template",variant:"brand",onClick:fc}),H?f.jsx(Ye,{icon:Xs,label:"Upload Ledger",variant:"success",onClick:()=>{var m;return(m=Nu.current)==null?void 0:m.click()}}):f.jsxs("button",{disabled:!0,style:{padding:"8px 16px",fontSize:"13px",fontWeight:"600",border:"none",borderRadius:"8px",backgroundColor:"#E2E8F0",color:"#94A3B8",cursor:"not-allowed",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(Xs,{size:16})," Upload Ledger"]})]}),f.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",border:"1px solid #E2E8F0"},children:[f.jsx("div",{style:{fontWeight:"600",color:"#475569",marginBottom:"8px",fontSize:"13px"},children:" Expected Format (matches your ledger export):"}),f.jsx("div",{style:{overflowX:"auto"},children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#E2E8F0"},children:[f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Date"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Particular"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Vch Type"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Vch No."}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Debit"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Credit"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Amt Recd"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Status"})]})}),f.jsx("tbody",{children:f.jsxs("tr",{children:[f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"02-Jun-21"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"DB Corp Ltd"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"Sales"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"MB/2020-21/0411"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0",textAlign:"right"},children:"6,000"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0",textAlign:"right"},children:"44,371"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"Received"})]})})]})})]}),f.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:f.jsx(Ye,{label:"Close",onClick:()=>rl(!1)})})]}),f.jsx(Sn,{isOpen:sr,onClose:()=>{Tr(!1),Oe({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"})},title:" Create Receipt",width:"550px",children:ae&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice:"})," ",ae.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Party:"})," ",ae.partyName]}),f.jsxs("div",{style:{fontSize:"14px"},children:[f.jsx("strong",{children:"Invoice Amount:"})," ",ft(ae.invoiceTotalAmount)]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[f.jsx(_r,{label:"Receipt Date",type:"date",value:pe.date,onChange:m=>Oe({...pe,date:m.target.value}),small:!0}),f.jsx(W0,{label:"Payment Mode",value:pe.mode,onChange:m=>Oe({...pe,mode:m.target.value}),options:[{value:"Bank",label:"Bank Transfer"},{value:"Cash",label:"Cash"},{value:"Cheque",label:"Cheque"},{value:"UPI",label:"UPI"}],small:!0})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"12px",marginBottom:"12px"},children:[f.jsx(_r,{label:"Amount Received",type:"number",value:pe.amount,onChange:m=>Oe({...pe,amount:m.target.value}),placeholder:"0.00",small:!0}),f.jsx(_r,{label:"TDS Deducted",type:"number",value:pe.tds,onChange:m=>Oe({...pe,tds:m.target.value}),placeholder:"0.00",small:!0}),f.jsx(_r,{label:"Discount",type:"number",value:pe.discount,onChange:m=>Oe({...pe,discount:m.target.value}),placeholder:"0.00",small:!0})]}),f.jsx("div",{style:{backgroundColor:"#F0FDF4",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:f.jsxs("div",{style:{fontSize:"14px",fontWeight:"700",color:"#166534"},children:["Total Credit: ",ft((parseFloat(pe.amount)||0)+(parseFloat(pe.tds)||0)+(parseFloat(pe.discount)||0))]})}),f.jsx(_r,{label:"Narration",value:pe.narration,onChange:m=>Oe({...pe,narration:m.target.value}),placeholder:"Payment reference, remarks...",small:!0}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Payment Advisory (Optional)"}),f.jsx("input",{type:"file",ref:xs,accept:"image/*,.pdf",onChange:oi,style:{display:"none"}}),pe.paymentAdvisory?f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[f.jsx("div",{style:{flex:1,padding:"10px",backgroundColor:"#F0FDF4",borderRadius:"8px",fontSize:"13px",color:"#166534"},children:" Payment advisory attached"}),f.jsx("button",{onClick:()=>Oe(m=>({...m,paymentAdvisory:null})),style:{padding:"8px",border:"none",backgroundColor:"#FEE2E2",borderRadius:"6px",cursor:"pointer",color:"#991B1B"},children:f.jsx(fl,{size:16})})]}):f.jsxs("button",{onClick:()=>{var m;return(m=xs.current)==null?void 0:m.click()},style:{padding:"10px 16px",border:"1.5px dashed #D1D5DB",borderRadius:"8px",backgroundColor:"#F9FAFB",cursor:"pointer",fontSize:"13px",color:"#6B7280",display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(Xs,{size:16})," Attach Payment Advisory"]})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>Tr(!1)}),f.jsx(Ye,{label:"Create Receipt",variant:"success",icon:Qu,onClick:Zd})]})]})}),f.jsx(Sn,{isOpen:gr,onClose:()=>{ii(!1),be({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]})},title:" Create Credit Note",width:"500px",children:ae&&(()=>{var q;const m=(q=ae.statePartyDetails)==null?void 0:q.toUpperCase().includes("MAHARASHTRA"),C=m?"CGST + SGST (9% + 9%)":"IGST (18%)",Y=parseFloat(Le.amount)||0,ee=parseFloat(Le.gst)||0,K=Y+ee;return f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice:"})," ",ae.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Party:"})," ",ae.partyName]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice Amount:"})," ",ft(ae.invoiceTotalAmount)]}),f.jsxs("div",{style:{fontSize:"12px",color:"#2563EB"},children:[f.jsx("strong",{children:"GST Type:"})," ",m?"CGST + SGST (Intra-state)":"IGST (Inter-state)"]})]}),f.jsx("div",{style:{marginBottom:"12px"},children:f.jsx(_r,{label:"Credit Note Date",type:"date",value:Le.date,onChange:ne=>be({...Le,date:ne.target.value}),small:!0})}),f.jsxs("div",{style:{backgroundColor:"#FEF2F2",padding:"14px",borderRadius:"10px",marginBottom:"12px",border:"1px solid #FECACA"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#991B1B",marginBottom:"10px",fontSize:"13px"},children:" Credit Note Breakdown"}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[f.jsx(_r,{label:"Base Amount",type:"number",value:Le.amount,onChange:ne=>be({...Le,amount:ne.target.value}),placeholder:"0.00",small:!0}),f.jsx(_r,{label:C,type:"number",value:Le.gst,onChange:ne=>be({...Le,gst:ne.target.value}),placeholder:"0.00",small:!0})]}),f.jsxs("div",{style:{marginTop:"10px",padding:"8px",backgroundColor:"#FEE2E2",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsx("span",{style:{fontSize:"13px",fontWeight:"600",color:"#991B1B"},children:"Total Credit:"}),f.jsx("span",{style:{fontSize:"15px",fontWeight:"700",color:"#991B1B"},children:ft(K)})]})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Reason for Credit Note *"}),f.jsx("textarea",{value:Le.reason,onChange:ne=>be({...Le,reason:ne.target.value}),placeholder:"Enter reason for issuing credit note...",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>ii(!1)}),f.jsx(Ye,{label:"Create Credit Note",variant:"danger",icon:qu,onClick:cc})]})]})})()}),f.jsx(Sn,{isOpen:L,onClose:()=>{z(!1),oe(null)},title:" Add Followup",width:"500px",children:B&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice:"})," ",B.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Party:"})," ",B.partyName]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Amount:"})," ",ft(B.invoiceTotalAmount||B.totalAmount)]}),f.jsxs("div",{style:{fontSize:"14px"},children:[f.jsx("strong",{children:"Invoice Date:"})," ",yr(B.invoiceDate||B.date)]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[f.jsx(_r,{label:"Followup Date",type:"date",value:fe.date,onChange:m=>se({...fe,date:m.target.value}),small:!0}),f.jsx(_r,{label:"Next Followup Date",type:"date",value:fe.nextFollowupDate,onChange:m=>se({...fe,nextFollowupDate:m.target.value}),small:!0})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Followup Notes *"}),f.jsx("textarea",{value:fe.notes,onChange:m=>se({...fe,notes:m.target.value}),placeholder:"Enter followup notes (e.g., Spoke with accounts team, payment promised by next week)",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Status"}),f.jsxs("select",{value:fe.status,onChange:m=>se({...fe,status:m.target.value}),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px"},children:[f.jsx("option",{value:"Pending",children:"Pending"}),f.jsx("option",{value:"Promised",children:"Promised - Payment Expected"}),f.jsx("option",{value:"Disputed",children:"Disputed"}),f.jsx("option",{value:"No Response",children:"No Response"})]})]}),f.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[f.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#166534",marginBottom:"8px"},children:" Quick Actions"}),f.jsxs("div",{style:{display:"flex",gap:"8px"},children:[f.jsx(Ye,{icon:Um,label:"Copy Email Template",small:!0,variant:"brand",onClick:()=>Wt(B)}),f.jsx(Ye,{icon:Wm,label:"Search in Gmail",small:!0,variant:"success",onClick:()=>Jr(B)})]})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>z(!1)}),f.jsx(Ye,{label:"Save Followup",variant:"primary",icon:Hm,onClick:ie})]})]})}),f.jsx(Sn,{isOpen:qa,onClose:()=>ua(!1),title:" Clear All Data",width:"500px",children:f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"20px",borderRadius:"12px",marginBottom:"20px",border:"2px solid #FCA5A5"},children:[f.jsxs("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"18px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(D2,{size:24})," Warning: This action cannot be undone!"]}),f.jsxs("div",{style:{fontSize:"14px",color:"#7F1D1D",lineHeight:"1.6"},children:["This will permanently delete:",f.jsxs("ul",{style:{margin:"12px 0 0 20px",padding:0},children:[f.jsxs("li",{children:[f.jsx("strong",{children:ve.length})," campaigns from Master Sheet"]}),f.jsxs("li",{children:[f.jsx("strong",{children:ve.filter(m=>m.invoiceGenerated).length})," generated invoices"]}),f.jsxs("li",{children:[f.jsx("strong",{children:Z.length})," receipts"]}),f.jsxs("li",{children:[f.jsx("strong",{children:Be.length})," credit notes"]}),f.jsxs("li",{children:[f.jsx("strong",{children:Ae.length})," ledger entries"]}),f.jsxs("li",{children:[f.jsx("strong",{children:Object.keys(Xr).length})," mailer images"]}),f.jsx("li",{children:"All opening balances"})]})]})]}),f.jsx("div",{style:{backgroundColor:"#FEF3C7",padding:"14px",borderRadius:"8px",marginBottom:"20px",border:"1px solid #FCD34D"},children:f.jsxs("div",{style:{fontSize:"13px",color:"#92400E"},children:[f.jsx("strong",{children:"Note:"})," Invoice series numbers will be reset to 1. Your company settings and mailer logo will be preserved."]})}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>ua(!1)}),f.jsx(Ye,{label:"Yes, Clear All Data",variant:"danger",icon:Ks,onClick:B4})]})]})}),f.jsx(Sn,{isOpen:Iu,onClose:()=>I(!1),title:" Notifications",width:"550px",children:f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[f.jsx("div",{style:{fontSize:"14px",color:"#64748B"},children:Ss>0?`${Ss} unread`:"No unread notifications"}),f.jsxs("div",{style:{display:"flex",gap:"8px"},children:[Ss>0&&f.jsx("button",{onClick:Xd,style:{padding:"6px 12px",fontSize:"12px",fontWeight:"600",border:"1px solid #E2E8F0",borderRadius:"6px",backgroundColor:"#F8FAFC",color:"#475569",cursor:"pointer"},children:"Mark all as read"}),Bn.length>0&&Ht&&f.jsx("button",{onClick:Ts,style:{padding:"6px 12px",fontSize:"12px",fontWeight:"600",border:"1px solid #FCA5A5",borderRadius:"6px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer"},children:"Clear all"})]})]}),f.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:il.length===0?f.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:[f.jsx(O2,{size:40,style:{marginBottom:"12px",opacity:.5}}),f.jsx("div",{style:{fontSize:"16px",fontWeight:"600"},children:"No notifications"}),f.jsx("div",{style:{fontSize:"13px",marginTop:"4px"},children:"You're all caught up!"})]}):il.map(m=>{const C=!(m.read&&m.read[r]),Y=K=>{switch(K){case"upload":return"";case"invoice":return"";case"approval":return"";case"edit":return"";case"receipt":return"";default:return""}},ee=K=>{switch(K){case"upload":return"#EFF6FF";case"invoice":return"#FEF3C7";case"approval":return"#DCFCE7";case"edit":return"#FEE2E2";case"receipt":return"#F0FDF4";default:return"#F8FAFC"}};return f.jsx("div",{onClick:()=>sc(m.id),style:{padding:"14px",borderRadius:"10px",marginBottom:"8px",backgroundColor:C?ee(m.type):"#F8FAFC",border:C?"2px solid #2874A6":"1px solid #E2E8F0",cursor:"pointer",transition:"all 0.2s ease"},children:f.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[f.jsx("div",{style:{fontSize:"20px"},children:Y(m.type)}),f.jsxs("div",{style:{flex:1},children:[f.jsx("div",{style:{fontSize:"14px",fontWeight:C?"600":"500",color:"#1E293B",lineHeight:"1.4"},children:m.message}),f.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"8px",fontSize:"11px",color:"#64748B"},children:[f.jsxs("span",{children:["By: ",m.createdBy==="finance"?"Finance Team":"Director"]}),f.jsx("span",{children:""}),f.jsx("span",{children:new Date(m.createdAt).toLocaleString()})]})]}),C&&f.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#DC2626",flexShrink:0}})]})},m.id)})})]})})]}),oF=()=>{switch(N){case"master":return uy();case"invoices":return eF();case"ledgers":return rF();case"followups":return iF();case"reports":return hy();case"settings":return r==="finance"?sF():hy();default:return uy()}},lF=()=>f.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 50%, #1E3A5F 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',padding:"20px"},children:f.jsxs("div",{style:{backgroundColor:"#FFFFFF",padding:"0",borderRadius:"24px",boxShadow:"0 25px 50px -12px rgba(0,0,0,0.25)",width:"420px",maxWidth:"95vw",overflow:"hidden"},children:[f.jsxs("div",{style:{background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 100%)",padding:"32px 40px",textAlign:"center"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:"8px"},children:[f.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"60px",height:"auto",borderRadius:"8px",backgroundColor:"white",padding:"4px"}}),f.jsx("span",{style:{fontSize:"36px",fontWeight:"800",color:"#FFFFFF",letterSpacing:"-1px"},children:"FinMate"})]}),f.jsx("p",{style:{margin:0,color:"rgba(255,255,255,0.8)",fontSize:"14px",fontWeight:"500"},children:"Finance Management System"})]}),f.jsxs("div",{style:{padding:"32px 40px"},children:[f.jsxs("div",{style:{marginBottom:"24px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#1E3A5F",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Username"}),f.jsxs("div",{style:{position:"relative"},children:[f.jsx(W2,{size:18,style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"text",value:i.username,onChange:m=>s(C=>({...C,username:m.target.value})),placeholder:"Enter username",style:{width:"100%",padding:"14px 14px 14px 44px",borderRadius:"12px",border:"2px solid #E2E8F0",fontSize:"15px",boxSizing:"border-box",transition:"border-color 0.2s, box-shadow 0.2s",outline:"none"},onFocus:m=>{m.target.style.borderColor="#2874A6",m.target.style.boxShadow="0 0 0 3px rgba(40,116,166,0.1)"},onBlur:m=>{m.target.style.borderColor="#E2E8F0",m.target.style.boxShadow="none"}})]})]}),f.jsxs("div",{style:{marginBottom:"28px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#1E3A5F",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Password"}),f.jsxs("div",{style:{position:"relative"},children:[f.jsx(O0,{size:18,style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"password",value:i.password,onChange:m=>s(C=>({...C,password:m.target.value})),placeholder:"Enter password",onKeyPress:m=>m.key==="Enter"&&ro(),style:{width:"100%",padding:"14px 14px 14px 44px",borderRadius:"12px",border:"2px solid #E2E8F0",fontSize:"15px",boxSizing:"border-box",transition:"border-color 0.2s, box-shadow 0.2s",outline:"none"},onFocus:m=>{m.target.style.borderColor="#2874A6",m.target.style.boxShadow="0 0 0 3px rgba(40,116,166,0.1)"},onBlur:m=>{m.target.style.borderColor="#E2E8F0",m.target.style.boxShadow="none"}})]})]}),a&&f.jsxs("div",{style:{marginBottom:"20px",padding:"14px",backgroundColor:"#FEF2F2",borderRadius:"12px",color:"#DC2626",fontSize:"14px",textAlign:"center",border:"1px solid #FECACA",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[f.jsx(D2,{size:18}),a]}),f.jsx("button",{onClick:ro,style:{width:"100%",padding:"16px",fontSize:"16px",fontWeight:"700",border:"none",borderRadius:"12px",cursor:E?"pointer":"wait",background:E?"linear-gradient(135deg, #1E3A5F 0%, #2874A6 100%)":"#94A3B8",color:"white",transition:"transform 0.2s, box-shadow 0.2s",boxShadow:E?"0 4px 14px rgba(40,116,166,0.4)":"none",opacity:E?1:.7},disabled:!E,onMouseOver:m=>{E&&(m.target.style.transform="translateY(-2px)",m.target.style.boxShadow="0 6px 20px rgba(40,116,166,0.5)")},onMouseOut:m=>{E&&(m.target.style.transform="translateY(0)",m.target.style.boxShadow="0 4px 14px rgba(40,116,166,0.4)")},children:E?"Sign In":"Loading..."}),f.jsxs("div",{style:{marginTop:"24px",textAlign:"center",color:"#94A3B8",fontSize:"12px"},children:[f.jsx("span",{children:"Powered by "}),f.jsx("span",{style:{fontWeight:"600",color:"#1E3A5F"},children:"JAC"}),f.jsx("span",{children:"  Strategy | Talent | Results"})]})]})]})});return t?l?f.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 50%, #1E3A5F 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[f.jsxs("div",{style:{textAlign:"center"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:"24px"},children:[f.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"50px",height:"auto",borderRadius:"8px",backgroundColor:"white",padding:"4px"}}),f.jsx("span",{style:{fontSize:"32px",fontWeight:"800",color:"#FFFFFF",letterSpacing:"-1px"},children:"FinMate"})]}),f.jsx(j2,{size:48,style:{animation:"spin 1s linear infinite",color:"#FFFFFF",marginBottom:"16px"}}),f.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:"#FFFFFF"},children:"Loading your data..."}),f.jsx("div",{style:{fontSize:"14px",color:"rgba(255,255,255,0.7)",marginTop:"8px"},children:"Please wait while we sync with the cloud"})]}),f.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]}):f.jsxs("div",{style:{display:"flex",height:"100vh",backgroundColor:"#F1F5F9",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[J4(),f.jsx("main",{style:{flex:1,overflow:"auto",padding:"20px"},children:oF()}),aF(),f.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]}):lF()}ig.createRoot(document.getElementById("root")).render(f.jsx(G0.StrictMode,{children:f.jsx(jW,{})}));
